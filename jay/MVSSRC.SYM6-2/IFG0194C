         TITLE 'IFG0194C                      DIRECT ACCESS MOUNT VERIF*00200002
               ICATION ROUTINE'                                  Y02134 00210002
IFG0194C CSECT                                                          00800021
         ENTRY IFG0554C                 ENTRY FROM EOV           Y02134 00805002
IFG0554C EQU   IFG0194C                 ALIAS ENTRY POINT        Y02134 00810002
*********************************************************************** 01000021
*                                                                     * 01200021
* MODULE NAME = IFG0194C (OS/VS2)                                     * 01250002
*                                                                     * 01260003
* CHANGE ACTIVITY - AS FOLLOWS:                                       * 01270003
*                                                                     * 01280003
*        VS2 RELEASE 2 DELETIONS                               @ZM30032 01290032
*                                                                     * 01340032
*        VS2 RELEASE 3 DELETIONS                                      * 01390032
*0000034249,420496-420522,525424,600403-600420,609900-611020   @Y30LSBS 01440032
*0000000000                                                    @Z40RSDH 01490032
*0000477640,477680                                             @ZA02859 01540032
*0000                                                          @ZA03658 01590032
*0000                                                          @ZA02209 01640032
*0000                                                          @ZA04643 01690032
*0000                                                          @ZA02225 01740032
*0000                                                          @ZA05097 01790032
*0000                                                          @ZA08882 01840032
*0000                                                          @ZA08332 01890032
*C60660,C47404                                                 @ZA33308 01910032
*A525583-525584,C525585,A600410,607312-607323                  @ZA26665 01910160
*C515025                                                       @ZA30123 01920060
*                                                                     * 01940032
*        VS2 RELEASE 3.818 ADDITIONS/CHANGES/DELETIONS                * 01990032
*A610686,610696,610726                                         @ZA29779 02010032
*C621381                                                       @ZM44627 02040032
*A000                                                          @G18MSBS 02090032
*C000048538-048738,525702,525712,525732                        @G18MSBS 02140032
*D000034987,034991,420484-420615,420762-420777                 @G18MSBS 02190032
*                                                                       02329932
*        VS2 RELEASE 3.832 ADDITIONS/CHANGES/DELETIONS                * 02359932
*SEQUENCE LINE NUMBER RIPPLE HAS CAUSED A LARGE NUMBER OF      @G32DSMI 02389932
*LINES TO BE RE-SEQUENCED. PREVIOUS LINE REFERENCE BY SEQUENCE @G32DSFS 02419932
*NUMBERS MAY THEREFORE NOT BE MEANINGFUL                       @G32DSFS 02449932
*        VS2 RELEASE 3.860 ADDITIONS/CHANGES DELETIONS         @G60ASRB 02470060
*C404800-404880,486036-486600,492850-493200,498250-498350,     @G60ASRB 02473960
*C515015-515045,515135-515165,515300,530000-530400             @G60ASRB 02477960
*A504401-504419,548884-549412,600484-600486,608639-608898,     @G60ASRB 02481960
*A609611-609740,611081-611107,621413-621423,628961-629001,     @G60ASRB 02485960
*A629081-629411,877261-883261                                  @G60ASRB 02489960
*D498000,530600-534800,607896                                  @G60ASRB 02493960
*                                                              @ZA32427 02495960
*                                                              @ZA32427 02497960
*                                                                     * 02499932
* FUNCTION = 1. FINDS THE VOLUME LABEL READ AREA;                     * 03200002
*            2. READS THE VOLUME LABEL FROM RECORD 3 TRACK 0;         * 03250002
*            3. DETERMINES IF THERE ARE ANY OUTSTANDING MOUNT REQUESTS* 03300002
*            4. VERIFIES IF VOLUME IS ON DEVICE; CHECKS FOR ASCENDING * 03350002
*            VOLUME SEQUENCE NUMBERS, EXPIRATION DATE,                * 03360032
*            RAC AUTHORIZATION AND/OR PASSWORD;                       * 03363032
*            5. UPDATES VOLUME DISPOSITION IN UCB:                    * 03370002
*               A. PRIVATE OR NOT PRIVATE                             * 03390002
*               B. PASS OR NOT PASS                                   * 03392002
*               C. PUBLIC OR NOT PUBLIC                               * 03394002
*            6A. READ DSCB OF THE DATA SET                     @G60ASRB 03396060
*            INDICATED BY THE DSNAME IN                        @G60ASRB 03396660
*            THE JFCB FROM THE VOLUME INDICATED IN THE INPUT. THE     * 03398002
*            DSCB IS READ WITH THE EXTENTS OF THE VTOC. IT IS READ    * 03398402
*            DIRECTLY USING THE TTR IN THE JFCB OR A SEARCH IS        * 03398802
*            PERFORMED ON THE DSNAME IF THE JFCB TTR IS NOT AVAILABLE.* 03398902
*            6B. IF FORMAT 1 DSCB NOT FOUND, THEN CALL THE     @G60ASBJ 03399260
*            INSTALLATION EXIT MODULE IFG0EX0A.  RETURN CODE   @G60ASRB 03400060
*            FROM EXIT IS -                                    @G60ASRB 03400860
*                0 CONTINUE                                    @G60ASRB 03401660
*                4 RETRY ONE TIME THE READ OF THE DSCB         @G60ASRB 03402460
*                8 EXIT ERROR-ABEND                            @G60ASRB 03403260
*            7. THE JFCB DSCB TTR IS UPDATED IF NECESSARY.            * 03405260
*            8. THE EXTENTS OF THE DATA SET ARE VERIFIED.             * 03406260
*            9. THE VOLUME IS MADE SECURE IF THE DATA SET IS A        * 03412202
*            CHECKPOINT DATA SET.                                     * 03424202
*            10. ANY FORMAT 2 AND 3 DSCBS ARE READ (EXTENTS ARE       * 03424602
*            VERIFIED) AND CHAINED TO THE PREVIOUS WORK AREA.         * 03424702
*            11. ANY VERIFIED VIRTUAL VOLUME ON A JES3 MANAGED UNIT   * 03424832
*            WILL OFFER THE VOLUME CHOICE TO JES3 FOR APPROVAL.       * 03424932
*            12. LAST REFERENCED DATE OR BACKUP COPY BIT       @G60ASRB 03425160
*            UPDATED IN FORMAT 1 DSCB IF REQUIRED.  DSCB       @G60ASRB 03426160
*            WRITTEN   IF NOT THE FIRST DSCB1, SUCH AS CONCAT. @G60ASRB 03427160
*            PDS OR ISAM OR BDAM.  FIRST DSCB WRITTEN IN       @G60ASRB 03428160
*            IFG0196W.                                         @G60ASRB 03429160
*                                                              @G60ASRB 03430160
* NOTES = SEE BELOW                                                   * 03437402
*                                                                     * 03449902
*    DEPENDENCIES = CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER   * 03459902
*                   CODE WAS USED FOR ASSEMBLY.  THE MODULE MUST BE   * 03469902
*                   REASSEMBLED IF A DIFFERENT CHARACTER SET IS USED  * 03479902
*                   FOR EXECUTION.                                    * 03489902
*                                                                     * 03491902
*    RESTRICTIONS = NONE                                              * 03493902
*                                                                     * 03495902
*                                                                     * 03553202
*    PATCH LABEL = SEE NEXT TO LAST LABEL BEFORE ORG STATEMENT AT END * 03563202
*                  OF LISTING                                         * 03565202
*                                                                     * 03565602
* MODULE TYPE = CONTROL (OPEN,CLOSE,EOV DATA MANAGEMENT)              * 03566002
*                                                                     * 03566402
*    PROCESSOR = ASSEMBLER XF                                         * 03566502
*                                                                     * 03577602
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON ORG * 03587602
*                  STATEMENT AT END OF LISTING.                       * 03588002
*                                                                     * 03588402
*     ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,         * 03590802
*                  PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY, * 03591202
*                  LINK PACK AREA RESIDENT/PAGEABLE                   * 03591602
*                                                                     * 03592502
* ENTRY POINT = IFG0194C FROM OPEN                                    * 04200002
*               IFG0554C FROM EOV                                     * 04250002
*                                                                     * 04300002
*     PURPOSE = TO MOUNT AND VERIFY A SPECIFIED DIRECT ACCESS VOLUME. * 04350002
*                                                                     * 04400002
*     LINKAGE = IECRES LOAD,MODID=ID4C,BRCODE=OFFSET,BRANCH=QUEUED    * 04450002
*                                                                     * 04500002
* INPUT = STANDARD O/C/E INPUT.                                       * 04550002
*        DXVOLSR2 CONTAINS THE VOLUME SERIAL NUMBER OF THE            * 04552002
*        VOLUME SERIAL NUMBER OF THE VOLUME TO BE MOUNTED             * 04554002
*        AND DXUCBADR CONTAINS THE UCB ADDRESS OF THE UNIT            * 04556002
*        TO CONTAIN THE VOLUME. DXDSAB CONTAINS THE CURRENT           * 04558002
*        DSAB ADDRESS OF THE DATA SET BEING PROCESSED.                * 04558402
*                                                                     * 04560002
* OUTPUT = THE SPECIFIED VOLUME IS MOUNTED AND VERIFIED ON THE        * 04570002
*          SPECIFIED UNIT AND THE FORMAT 2 AND 3 DSCBS ARE            * 04572002
*          CHAINED TO THE WORK AREA CONTAING THE FORMAT 1.            * 04574002
*                                                                     * 04580002
* EXIT-NORMAL = IFG0194A - TO PARALLEL MOUNT MORE VOLUMES, OR         * 04590002
*                          TO LOOK-AHEAD MOUNT THE NEXT VOLUME, OR    * 04590402
*                          TO EXIT TO CALLER, OR                      * 04591202
*                          TO PROCESS DISP=MOD ERROR RECOVERY, OR     * 04591702
*                          TO REJECT VOLUME AND UNIT PASSED.          * 04592002
*               IFG0194J - TO ISSUE MESSAGES.                         * 04594002
*               IFG0195T - TO VERIFY PASSWORD FOR THE DATA SET.       * 04596002
*               IFG0554P - TO EXTEND THE DATA SET.                    * 04598002
*               IFG0EX0A - FORMAT 1 DSCB-NOT-FOUND             @G60ASRB 04598160
*                          INSTALLATION EXIT.                  @G60ASRB 04598260
*                                                                     * 04598402
* EXIT-ERROR = IFG0190P - PROBLEM DETERMINATION ROUTINE.              * 04598802
*                         SEE LABEL DAMVER19 FOR A LIST OF ABENDS     * 04599832
*                         PROCESS 413-30 FOR WRONG VOLUME MOUNT@Y30LSBS 04601803
*                         OPEN.                                @Y30LSBS 04602603
*                         PROCESS 737-38 FOR WRONG VOLUME MOUNT@Y30LSBS 04603003
*                         EOV.                                 @Y30LSBS 04604203
*                         PROCESS 03D-0C FOR BDAM ACCESSING    @ZA02225 04604632
*                         AN ISAM DATA SET DURING OPEN         @ZA02225 04605032
*                         PROCESS 413-34 FOR JES3 ERROR-OPEN   @ZM44627 04605432
*                         PROCESS 737-28 FOR JES3 ERROR-EOV    @G18MSBS 04605832
*                         737-04 I/O ERROR WRITING DSCB(EOV)   @G60ASRB 04606660
*                         737-3C DSCB-NOT-FOUND INSTALLATION   @G60ASRB 04607160
*                         EXIT ERROR(EOV)                      @G60ASRB 04607660
*              IFG0195G - TO PROCESS 213 ABEND.                       * 04608160
*                         213-18 I/O ERROR WRITING DSCB(OPEN)  @G60ASRB 04608660
*                         213-2C DSCB-NOT-FOUND INSTALLATION   @G60ASRB 04609160
*                         EXIT ERROR(OPEN).                    @G60ASRB 04609660
*                                                                     * 04610903
* EXTERNAL REFERENCES = AS FOLLOWS -                                  * 04614803
*                                                                     * 04618703
*    ROUTINES = IFG0190P - ALIAS IFG0550P.                            * 04622603
*               IFG0194A - ALIAS IFG0554A.                            * 04626502
*               IFG0194J - ALIAS IFG0554J.                            * 04628502
*               IFG0195T - ALIAS IFG0555T.                            * 04630502
*               IFG0195G.                                             * 04632502
*               IFG0554P.                                             * 04632902
*               IFG0EX0A.                                      @G60ASRB 04633060
*               IEAQCDSR                                       @G60ASRB 04633260
*               IEAVVMSR                                       @G60ASRB 04637260
*                                                                     * 04641260
*    DATA AREAS = SEE PARAMETERS OF IECDSECS MACRO.                   * 04649902
*                                                                     * 04659902
*    CONTROL BLOCKS = SEE PARAMETERS OF IECDSECS MACRO.               * 04669902
*                                                                     * 04671902
* TABLES = NUCLEUS UCB LOOK-UP TABLE.                                 * 04679902
*          OPEN/EOV INTERNAL ABEND CODE TABLE. ONE ERROR GENERATES A  * 04681902
*          DIFFERENT ABEND CODE FOR OPEN AND EOV.                     * 04683902
*                                                                     * 04689902
* MACROS = AS FOLLOWS -                                               * 04691902
*        IECDSECS                                                     * 04692302
*        IECEQU                                                       * 04692702
*        IECRES                                                       * 04693102
*        EXCP                                                         * 04693502
*        MODESET                                                      * 04693602
*        NIL                                                          * 04693702
*        DOM                                                          * 04693802
*        ENQ                                                          * 04743802
*        SETLOCK                                                      * 04753802
*        OIL                                                          * 04763802
*        TESTAUTH                                                     * 04773802
*        DMABCOND                                                     * 04783802
*        XCTLTABL                                                     * 04785802
*        IEFAJCTB                                              @G18MSBS 04793832
*        IEFASCTG                                              @G18MSBS 04803832
*        IEFJESCT                                              @G18MSBS 04813832
*        IEFJSSOB                                              @G18MSBS 04823832
*        IEFSSREQ                                              @G18MSBS 04833832
*                                                                     * 04843832
* CHANGE ACTIVITY = SEE CHANGE ACTIVITY BEFORE FUNCTION DESCRIPTION   * 04853832
*                                                                     * 04893802
*********************************************************************** 11400021
         EJECT                                                          35600021
         IECDSECS CVT,JSCB,TIOT,DSAB,PSA,DSCB1,DSCB4,DCB,ACB,    Y02146X35800002
               CDE,LPDE,                                       @G60ASRB*35802060
               UCB,IEZDEB,ICHACHKL,                            @Z40RSRJ*35803060
               MAIN,WTG,PREFX                                    Y02146 35805002
K213     EQU   213                      INDICATOR FOR 213 ABEND  Y02134 36450002
OUTPUT   EQU   X'0E'                    MASK FOR INPUT OR RDBACK Y02134 36500002
DSCBCKDS EQU   X'01'                    DSCB CHKPT INDICATOR     Y02083 36500102
DATAMGT  EQU   X'50'                    DM KEY                   YM3070 36500502
HIORDER  EQU   X'80'                    HI-ORDER BIT OF A BYTE @G18MSBS 36501032
SWAPREFX EQU   16                       PREFIX OF QUEUE ELEMENT@G18MSBS 36501532
         IECEQU AOS=YES,IEZDEB=YES      DEFINE EQUATES           YM3070 36502102
*                                                                       36600021
         USING FORCORE,RCORE            DEFINE BASE TO MAIN WORK AREA   36800021
         USING WTG,RWTG                 WHERE-TO-GO TABLE        Y02080 36850002
         USING USERPRML,RPARC           RPARC POINTS TO CURRENT  Y02134 36870002
         USING IHADCB,RDCB              RDCB POINTS TO DCB       Y02134 36910002
         USING TIOENTRY,RTIOT           DEFINE BASE TO TIOT DD ENTRY    37000021
         USING UCBOB,RUCB               DEFINE BASE TO MAIN UCB         37200021
*                                                                       37400021
         BALR  RBASE,R0                 ESTABLISH BASE REGISTER         37600002
         USING *,RBASE                  DEFINE BASE REGISTER            37800021
*                                                                Y02134 37805002
DAMV0000 EQU   *                        BASE ADDRESS           @Z40RSDH 37807032
         B     DAMV0010(RET)            BRANCH TO BRANCH TABLE   Y02134 37810002
*                                                                Y02134 37815002
DAMV0010 EQU   *                        BRANCH TABLE             YM1472 37820002
*                                                                Y02134 37825002
         B     DAMV0050                 BRANCH IF ENTRY FROM 4A  Y02134 37830002
         B     DAMV0100                 BRANCH ENTRY FROM REJECT Y02134 37835002
         B     DAMV2450                 RETURN FROM EXPIRATION   Y02134 37839002
         B     DAMV2550                 RETURN FROM PASSWORD     Y02083 37843802
         B     DAMV0020                 RETURN FROM CHECKPOINT   Y02083 37844202
*                                                                YM3925 37844702
DAMV0020 EQU   *                        CHECKPOINT WTOR RETURN   YM3925 37844802
*                                                                YM3925 37844902
         L     RF,CHKPTRET              GET RETURN ADDRESS       YM3925 37846902
         BR    RF                       RETURN FROM MESSAGE      YM3925 37847302
         EJECT                                                          37848902
*                                                                       40220002
DAMV0050 EQU   *                        VOLUME MOUNT/VERIFY      YM3070 40240002
*                                                                Y02134 40260002
*****************************************************************Y02134 40280002
*                                                                Y02134 40300002
*        FIND VOLUME LABEL READ AREA                             Y02134 40320002
*                                                                Y02134 40340002
*****************************************************************Y02134 40360002
*                                                                Y02134 40380002
         LA    RCORE,DXDSCB             CLEAR HI ORDER BYTE      Y02134 40381002
         LR    RB,RCORE                 INITIALIZE FOR LOOP      Y02134 40382002
*                                                                Y02134 40383002
DAMV0060 EQU   *                        LOOP TO FIND LAST AREA   YM1472 40402102
*                                                                Y02134 40413102
         C     RB,CORECH(,RB)           TEST FOR SAME AREA       YM3807 40444002
         BE    DAMV0090                 BRANCH IF REUSE REQUESTD Y02134 40448002
*                                                                Y02134 40448202
         CLI   DXDSCB-DXDSCB(RB),CHAR1  CHECK FOR F1 AREA        Y02134 40452002
         BNE   DAMV0070                 BRANCH NOT F1 AREA       Y02134 40456002
*                                                                Y02134 40456202
*        CHECK FOR PO BEFORE EXCP, DSORG FIELD EXISTS IN COPY    YM3925 40456302
*        EVEN IF NOT IN USERS DCB.                               YM3925 40456402
         TM    DCBDSORG,DCBDSGPO        BPAM & DSN = CHAR ONE    YM3925 40456502
         BO    DAMV0070                 BRANCH IF BPAM           YM3925 40456602
*                                                                YM3925 40456802
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP            Y02134 40457402
         BO    DAMV0075                 BR IF EXCP               YM3807 40457602
*                                                                Y02134 40458002
         TM    DCBDSORG,DCBDSGIS        TEST FOR ISAM            Y02134 40458102
         BNO   DAMV0075                 BRANCH IF NOT ISAM       YM3807 40458202
*                                                                Y02134 40458402
* CHECK FOR VOLUME ALREADY PROCESSED                             Y02134 40458502
* NOTE-AN AREA CHAINED FOR REUSE WILL NOT BE BYPASSED BY THE     YM1472 40460102
*      FOLLOWING CODE BECAUSE THE CONDITION BELOW WILL ALWAYS    YM1472 40462202
*      ARISE BEFORE THE CONDITION CAUSING THE RECHAINING.        YM1472 40462302
         CLC   DXUCBADR,DSCSCALO-DXDSCB(RB) VOL ALREADY PROC?    Y02134 40462402
         BE    DAMV6000                 BRANCH TO GET NEXT       Y02134 40464002
         B     DAMV0075                 BRANCH, CHECK NEXT AREA  YM3807 40465602
*                                                                Y02134 40467202
DAMV0070 EQU   *                        INCREMENT FOR AREAS      YM1472 40468802
*                                       PRECEDED WITH 44 BYTE KEYYM1472 40470402
*                                                                YM3807 40470802
         CR    RB,RCORE                 TEST IF FIRST AREA       YM3807 40471202
         BE    DAMV0075                 BRANCH IF FIRST          YM3807 40471602
*                                                                YM3807 40471702
         LA    RB,L'JFCBDSNM(,RB)       INCREMENT PASSED KEY     Y02134 40472002
*                                                                YM3807 40472402
DAMV0075 EQU   *                        INCREMENT TO NEXT AREA   YM3807 40472802
*                                                                YM3807 40473202
         NC    CORECH(K4,RB),CORECH(RB) TEST FOR END OF CHAIN    YM3807 40473302
         BZ    DAMV0080                 BRANCH IF END OF CHAIN   YM3807 40473402
*                                                                YM3807 40473502
         L     RB,CORECH(,RB)           LOAD NEXT CHAIN POINTER  YM3807 40473702
         B     DAMV0060                 BRANCH TO LOOP           Y02134 40474202
         EJECT                                                          40474402
*                                                                YM1472 40474602
*****************************************************************YM1472 40474802
*                                                                YM1472 40475002
*        GET NEXT AREA AND CHAIN TO LAST                         YM1472 40475202
*                                                                YM1472 40475402
*****************************************************************YM1472 40475602
*                                                                Y02134 40476302
DAMV0080 EQU   *                        BPAM F1 AREA GETS 44 MOREYM1472 40476802
*                                                                Y02134 40478402
*        CHECK FOR PO BEFORE EXCP, DSORG FIELD EXISTS IN COPY    YM3925 40480060
*        EVEN IF NOT IN USERS DCB.                               YM3925 40481060
         LA    R0,F1LTH                                        @G60ASRB 40482060
         TM    DCBDSORG,DCBDSGPO        BPAM CONCATENATION       Y02134 40483060
         BNO   DAMV0085                 BRANCH NOT BPAM          Y02134 40484060
         LA    R0,F1POLTH                                      @G60ASRB 40485060
*                                                                Y02134 40489602
DAMV0085 EQU   *                        GET F1 DSCB AREA         YM1472 40491202
*                                                                Y02134 40492802
         L     RF,ADDRF1                GET THE GETF1 ADDRESS  @G18MSBS 40494432
         BALR  RET,RF                   GO GET F1 DSCB AREA    @G18MSBS 40495432
*                                                                Y02134 40497602
         ST    R1,CORECH(,RB)           CHAIN AREAS              Y02134 40499202
         LR    RB,R1                    LOAD WORK AREA POINTER   Y02134 40500802
         EJECT                                                          40501202
*                                                                YM1472 40501602
*****************************************************************YM1472 40502002
*                                                                YM1472 40502102
*        MOVE DATA SET NAME TO AREA FOR BPAM CONCATENATION.      YM1472 40502202
*                                                                YM1472 40502302
*****************************************************************YM1472 40502802
*                                                                Y02134 40503502
*        CHECK FOR PO BEFORE EXCP, DSORG FIELD EXISTS IN COPY    YM3925 40506002
*        EVEN IF NOT IN USERS DCB.                               YM3925 40506402
         TM    DCBDSORG,DCBDSGPO        BPAM CONCATENATION       Y02134 40507202
         BNO   DAMV0089                 BRANCH NOT BPAM          Y02134 40508802
*                                                                Y02134 40510402
         LA    RD,INFMJFCB              LOAD POINTER TO JFCB     Y02134 40512002
         CLC   DXDSABAD,DXDSAB          CHECK IF CURRENT JFCB    Y02134 40513602
         BE    DAMV0087                 BRANCH IF CURRENT        Y02134 40515202
         LA    RD,TIOEJFCB              PTR TO CURRENT JFCB PTR  Y02134 40516802
         IECRES LOCJFCB,(RD)            LOCATE JFCB              Y02134 40518402
*                                                                YM1472 40520402
DAMV0087 EQU   *                        MOVE DSNM TO KEY OF DSCB YM1472 40531202
*                                                                Y02134 40532802
         MVC   JFCBDSNM-INFMJFCB(L'JFCBDSNM,RB),INFMJFCB-INFMJFCB(RD)   40534402
         LA    RB,L'JFCBDSNM(,RB)       POINT TO F1 AREA         Y02134 40536002
*                                                                Y02134 40537602
DAMV0089 EQU   *                        SAVE UCB ADDRESS         YM1472 40539202
*                                                                Y02134 40540802
         MVC   DXUCBSAV-DXUCBSAV+CORECH+K4(L'DXUCBADR,RB),DXUCBADR      40542402
         MVC   DXUCBSAV-DXUCBSAV+CORECH+K4(K1,RB),DXUNITOF+K1    Y02134 40544002
*                                                                Y02134 40545602
DAMV0090 EQU   *                        INDICATE END OF CHAIN    YM1472 40547202
*                                                                Y02134 40548802
         XC    CORECH(K4,RB),CORECH(RB) CLEAR CHAIN POINTER      Y02134 40550402
         EJECT                                                          40550802
*                                                                Y02134 40552002
*****************************************************************Y02134 40553602
*                                                                Y02134 40555202
*        SET UP EXTENT TO COVER THE WHOLE DISK.                  Y02134 40556802
*                                                                Y02134 40558402
*****************************************************************Y02134 40560002
*                                                                Y02134 40580002
DAMV0100 EQU   *                                                 Y02134 40600002
*                                                                Y02134 40620002
         XC    DXDEBSCC(K4),DXDEBSCC    EXTENT TO COVER DISK     Y02134 40640002
*                                                                Y02134 40660002
         L     RF,CVTPTR                GET CVT ADDR             Y02134 40680002
         L     RF,CVTZDTAB-CVT(,RF)     I/O DEVICE TABLE ADDRESS Y02134 40700002
*                                                                Y02134 40720002
         XR    R1,R1                    ZERO WORK REGISTER       Y02080 40884002
         IC    R1,UCBTBYT4              GET UCB DEVICE TYPE      Y02134 40900002
         IC    R1,0(R1,RF)              INDEX TO DEVICE OFFSET   Y02134 40920002
         AR    RF,R1                    ADDR OF DEVICE ENTRY     Y02134 40940002
         MVC   DXDEBECC(K4),0(RF)       SET MAX EXTENT FROM TBL  Y02134 40960002
         MVC   DXCCW8(K4),0(RF)         SAVE MAX PACK EXTENTS    Y02082 40980002
*                                                                Y02134 41000002
         MVC   DXDEBNTR,ODA0660K        SET TRACKS TO LARGEST NO Y02134 41020002
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 UCB ADDRESS TO DEB    Y02134 41040002
         XC    DXDEBBIN,DXDEBBIN        ZERO OUT BIN NUMBER      Y02134 41060002
*                                                                YM3192 41062002
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         YM3822 41064002
         BO    DAMV0205                 BR IF VIO                YM3192 41066002
*                                                                YM3192 41068002
         EJECT                                                          41080002
*                                                                Y02134 41100002
*****************************************************************Y02134 41120002
*                                                                Y02134 41140002
*        TEST FOR OUTSTANDING MOUNT REQUEST.                     Y02134 41160002
*                                                                Y02134 41180002
*****************************************************************Y02134 41200002
*                                                                Y02134 41220002
         TM    UCBDMCT,UCBMOUNT         OUTSTANDING MOUNT        Y02134 41240002
         BNO   DAMV0200                 BRANCH, NO MOUNT ISSUED  Y02134 41260002
*                                                                Y02134 41280002
*****************************************************************Y02134 41300002
*                                                                Y02134 41320002
*        READ THE VOLUME LABEL FROM RECORD 3 OF TRACK 0.         Y02134 41340002
*        WILL GO INTO A WAIT STATE UNTIL THE VOLUME IS MOUNTED.  Y02134 41360002
*                                                                Y02134 41380002
*****************************************************************Y02134 41400002
*                                                                Y02134 41420002
         XC    DXDAADDR,DXDAADDR        DA VOL LABEL ADDR CCHH = 0000   41440002
         MVI   DXDAADDR+K7,K3           VOL LABEL IS ALWAYS RECORD 3    41460002
*                                                                Y02134 41480002
*****************************************************************Y02134 41500002
*                                                                       41520002
*        CONSTRUCT CHANNEL PROGRAM TO READ VOLUME LABEL.                41540002
*                                                                       41560002
*        SEARCH ID EQ                                                   41580002
*        TIC *-8                                                        41600002
*        READ DATA                                                      41620002
*                                                                       41640002
*****************************************************************Y02134 41660002
*                                                                Y02134 41680002
         XC    DXCCW1(K24),DXCCW1       CLEAR CCW AREA                  41700002
         LA    RF,DXDAADDR+K3           SEARCH ADDRESS                  41720002
         ST    RF,DXCCW1                                                41740002
         LA    RF,DXCCW1                TIC ADDRESS                     41760002
         ST    RF,DXCCW2                                                41780002
         ST    RB,DXCCW3                STORE READ IN AREA PTR   Y02134 41800002
         OC    DXCCW1(K24),ODA7440K     OR IN CMND CODE, FLAGS, LENGTH  41820002
         MVC   DXCCW2+K5(K3),DXDEBUCB+K1 SAVE UCB ADDRESS        Y02134 41840002
         EJECT                                                          41842002
*****************************************************************YM7890 41846002
*                                                                YM7890 41848002
*        IF MOUNT PENDING AND UNIT NOT READY MEMORY MAY          YM7890 41848402
*        NOT BE SWAPPED OUT, BECAUSE IF OPERATOR CANCELS         YM7890 41848802
*        THE JOB, THE JOB WILL NOT TERMINATE UNTIL THE           YM7890 41849202
*        MOUNT IS SATISFIED.                                     YM7890 41849602
*                                                                YM7890 41850002
*****************************************************************YM7890 41850102
*                                                                YM7890 41850202
         TM    UCBFL1,UCBNOTRD          TEST IF READY            YM7890 41850402
         BZ    DAMV0105                 BR READY- BYPASS NOSWAP  YM7890 41850802
*                                                                YM7890 41851602
         SYSEVENT DONTSWAP              IN CASE OPERATOR CANCEL  YM7890 41852002
*                                                                YM7890 41854002
         SLL   R1,K24                   CLEAR HI 3 BYTES         YM7890 41854102
         LTR   R1,R1                    CHECK FOR ERROR          YM7890 41854202
         BNZ   DAMV0105                 BRANCH IF ERROR          YM7890 41854302
*                                                                YM8511 41856302
         OI    DXATALL,DXATSWAP         SET RECOVERY INDICATOR   YM8511 41856702
*                                                                YM7890 41857502
         EXCP  DXIOB                    READ VOLUME LABEL        YM7890 41860802
*                                                                YM7890 41862802
         IECRES WAIT                    WAIT FOR I/O TO FINISH   YM7890 41863202
*                                                                YM8511 41863402
         NI    DXATALL,ALLBITS-DXATSWAP RESET RECOVERY INDICATOR YM8511 41863502
*                                                                YM7890 41863902
         SYSEVENT OKSWAP                ALLOW SWAPOUT-UNIT READY YM7890 41864002
*                                                                YM7890 41866002
         B     DAMV0110                 BRANCH TO VERIFY LABEL   YM7890 41867202
*                                                                YM7890 41870402
DAMV0105 EQU   *                        READ LABEL - UNIT READY  YM7890 41873602
*                                                                       41876802
         EXCP  DXIOB                    READ VOLUME LABEL               41880002
*                                                                       41900002
         IECRES WAIT                    WAIT FOR MOUNT AND LABEL READ   41920002
         EJECT                                                          41922002
*                                                                Y02134 41940002
DAMV0110 EQU   *                        VERIFY MOUNTED VOLUME    YM7890 41942002
*                                                                YM7890 41942402
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 41944002
         TM    DXECB,ECBNOERR           TEST FOR I/O ERROR     @ZA08332 41945832
         BZ    DAMV0111                 BRANCH IF I/O ERROR    @G18MSBS 41946232
         MVC   UCBVOLI,VOLSERNO-DXLBL(RB) VOL SERIAL FOR REJECT  YM7023 41946632
*                                                              @ZA08332 41947032
DAMV0111 EQU   *                                               @G18MSBS 41947432
*                                                              @ZA08332 41947832
*        RESET MOUNT BIT                                         Y02134 41949202
         NIL   UCBDMCT,ALLBITS-UCBMOUNT,REF=UCBOB,WREGS=(,,RF)   Y02134 41951002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 41952802
*                                                                Y02134 41954602
         EJECT                                                          41956402
*        NO DOM SUPPORT AVAILABLE FOR DA BECAUSE OF UCB CHANGES  YM7310 42006402
         TM    DXECB,ECBNOERR           CHECK FOR I/O ERROR      Y02134 42016602
         BNZ   DAMV0112                 BR IF NO ERROR           Y02134 42020002
*                                                                Y02134 42030002
         CLC   DXVOLSR2,SCRTCH          CHECK IF SCRTCH REQUEST  Y02134 42032002
         LA    R0,K1                    OPEN=413-20 EOV=737-08   Y02080 42032402
         BNE   DAMV9900                 BRANCH IF SPECIFIC REQ   Y02134 42032802
         B     DAMV8000                 BRANCH TO GET NEW VOLUME Y02134 42032902
         EJECT                                                          42033002
*                                                                Y02134 42033202
DAMV0112 EQU   *                        VERIFY MOUNTED VOLUME    YM1472 42033602
         SPACE                                                          42040032
         CLC   DXVOLSR2,VOLSERNO-DXLBL(RB) CHECK FOR RIGHT VOL   Y02134 42041032
         BE    DAMV0115                 BRANCH, BYPASS DISMOUNT  Y02134 42042032
        SPACE                                                           42043032
         NC    DXVOLSR1,DXVOLSR1        WRONG VOL MNT INDICATOR@G18MSBS 42044032
         MVC   DXVOLSR1,VOLSERNO-DXLBL(RB) VOL SER FOR REJECT  @G18MSBS 42045032
         BNZ   DAMV0113                 BRANCH TO MSS TEST     @G18MSBS 42046032
        SPACE                                                           42047032
         CLC   DXVOLSR2,SCRTCH          SCRATCH REQUEST ?      @G18MSBS 42048032
         BE    DAMV0114                 YES, GO ENQ TO REJ VOL @G18MSBS 42049032
        SPACE                                                           42050032
DAMV0113 EQU   *                                               @G18MSBS 42051032
        SPACE                                                           42052032
         TM    UCBTBYT2,UCBRVDEV        VIRTUAL DASD ?         @G18MSBS 42053032
         BNO   DAMV8000                 NO, BRANCH TO REJ VOL  @G18MSBS 42054032
         SPACE                                                          42055032
*                      YES, SSC MOUNTED WRONG VIRTUAL VOLUME - @G18MSBS 42056032
         LA    R0,K14                   OPEN=413-30 EOV=737-38 @G18MSBS 42057032
         B     DAMV9900                 GO ABEND               @G18MSBS 42058032
        SPACE                                                           42059032
DAMV0114 EQU   *                                               @G18MSBS 42060032
        SPACE                                                           42061032
         MVC   DXWORK1(K16),ENQLIST     INIT ENQ LIST            Y02134 42076202
         L     RF,DXJSCBAD              LOAD JSCB ADDRESS        Y02134 42077402
         L     R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER    Y02134 42077502
DAMV0202 ENQ   (,DXVOLSR1),TCB=(0),RET=USE,MF=(E,DXWORK2),       Y02134X42077602
               RELATED=(SYSZVOLS,IFG0194A(VUS02450))             Y02134 42077702
*                                                                Y02134 42087202
         LTR   RF,RF                    VOLUME ALREADY IN USE    Y02134 42088802
         BNZ   DAMV8000                 BRANCH IF ERROR, REJECT  Y02134 42090702
         EJECT                                                          42091102
*                                                                Y02134 42091502
DAMV0115 EQU   *                        CONVERT MBBCCHHR TO TTR  YM1472 42092302
*                                                                Y02134 42092402
         XC    DXVOLSR1,DXVOLSR1        CLEAR REJECT VOLUME      Y02134 42092502
*                                                                Y02134 42092602
         L     RF,WTGPREFX              LOAD PREFIX ADDRESS      Y02134 42092702
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS        Y02134 42094502
*                                                                Y02134 42100002
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02082 42104002
*                                                                Y02134 42108002
DAMV0120 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02134X42120002
               RELATED=(LOCAL,IFG0194C(DAMV0190))                Y02134 42140002
*                                                                Y02134 42140802
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 42144002
*                                                                Y02134 42160002
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 42180002
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS     Y02134 42200002
         BNZ   DAMV9000                 BRANCH IF SETLOCK ERROR  Y02134 42220002
*                                                                       42300002
*********************************************************************** 42320002
*                                                                       42340002
*  CONVERT VTOC ADDR FROM MBBCCHHR TO TTR FORM                          42360002
*                                                                       42380002
*********************************************************************** 42400002
*                                                                       42420002
         MVC   DXDAADDR+K3(K5),VOLVTOC-DXLBL(RB) CCHHR VTOC ADDR Y02134 42440002
         L     RF,IECPRLTV              EPA OF IECPRLTV CONV RTN YM3070 42442002
         BALR  RET,RF                   LINK TO CONVERT ROUTINE  YM3070 42460002
         ST    R0,DXDAADDR              SAVE CONVERTED TTR       Y02134 42480002
         EJECT                                                          42482002
*                                                                       42500002
*********************************************************************** 42520002
*                                                                       42540002
*        INSERT VTOC TTR ADDR IN UCB.                            Y02134 42560002
*                                                                       42580002
*********************************************************************** 42600002
*                                                                       42620002
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 42624002
         MVC   UCBVTOC(K3),DXDAADDR     PLACE VTOC TTR INTO UCB  Y02134 42640002
         MVC   UCBVOLI,VOLSERNO-DXLBL(RB) MOVE SERIAL NO. TO UCB Y02134 42644002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02134 42649002
*                                                                Y02134 42660002
         L     RF,WTGPREFX              LOAD PREFIX ADDRESS      Y02134 42680002
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS        Y02134 42700002
*                                                                Y02134 42720002
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02134 42725002
*                                                                Y02134 42730002
DAMV0190 SETLOCK RELEASE,TYPE=LOCAL,                             Y02134X42740002
               RELATED=(LOCAL,IFG0194C(DAMV0120))                Y02134 42760002
*                                                                Y02134 42780002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 42784002
*                                                                Y02134 42788002
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 42800002
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS     Y02134 42820002
         BNZ   DAMV9000                 BRANCH IF SETLOCK ERROR  Y02134 42840002
         B     DAMV0205                 GET VOLUME DISPOSITION   Y02134 42860002
         EJECT                                                          42862002
*                                                                Y02134 42893302
*****************************************************************Y02134 42900002
*                                                                Y02134 42920002
*        VERIFY VOLUME ON DEVICE                                 Y02134 42940002
*                                                                Y02134 42960002
*****************************************************************Y02134 42980002
*                                                                Y02134 43000002
DAMV0200 EQU   *                        VERIFY PREMOUNTED VOLUME YM1472 43020002
*                                                                Y02134 43040002
         CLC   UCBVOLI,ZEROS            CHECK FOR NO VOL         Y02134 43140002
         BE    DAMV8000                 BRANCH IF NO VOL         Y02134 43160002
*                                                                Y02134 43260002
         NC    DXVOLSR1,DXVOLSR1        WRONG VOL MNT INDICATOR  YM1472 43310002
         BNZ   DAMV8000                 BRANCH TO REJECT         YM1472 43410002
*                                                                Y02134 43796802
*****************************************************************Y02134 43800002
*                                                                Y02134 43820002
*        UPDATE UCB VOLUME DISPOSITION                           Y02134 43840002
*                                                                Y02134 43860002
*****************************************************************Y02134 43880002
*                                                                Y02134 43900002
DAMV0205 EQU   *                                                 Y02134 43920002
*                                                                Y02134 43940002
         XC    DXVOLSR1,DXVOLSR1        CLEAR REJECT VOLUME      Y02134 43944002
*                                                                Y02134 43948002
         L     RF,WTGPREFX              LOAD PREFIX ADDRESS      Y02134 43960002
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS        Y02134 43980002
*                                                                Y02134 44000002
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02082 44004002
*                                                                Y02134 44008002
DAMV0210 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02134X44020002
               RELATED=(LOCAL,IFG0194C(DAMV0290))                Y02134 44040002
*                                                                Y02134 44060002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 44064002
*                                                                Y02134 44068002
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 44080002
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS     Y02134 44100002
         BNZ   DAMV9000                 BRANCH IF SETLOCK ERROR  Y02134 44120002
*                                                                Y02134 44140002
         TM    UCBDMCT,UCBDMC-K1        TEST FOR ONE USER        Y02134 44160002
         BNZ   DAMV0285                 BRANCH, MORE THAN 1 USER Y02134 44180002
         TM    UCBSTAB,UCBBSVL          TEST FOR SHAREABLE       Y02134 44200002
         BZ    DAMV0285                 BRANCH IF SHAREABLE UNIT Y02134 44220002
*                                                                Y02134 44240002
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 44257602
         NI    UCBJBNR,ALLBITS-UCBMONT  SET PASS TO 0            YM1472 44260002
         NI    UCBSTAB,ALLBITS-UCBBPRV  SET PRIVATE TO 0         YM1472 44280002
         NI    UCBSTAB,ALLBITS-UCBBPUB  SET PUBLIC TO 0          YM1472 44300002
         OI    UCBSTAT,UCBDADI          INDICATE SL VOLUME       YM1472 44320002
*                                                                Y02134 44340002
* REGISTER RB RESTORED AFTER SETLOCK RELEASE                     Y02134 44345002
         L     RB,DXDSAB                CURRENT DSAB POINTER     Y02134 44360002
         TM    DSABFLG3-DSAB(RB),DSABPASS TEST FOR PASSED DATA   Y02134 44380002
         BNO   DAMV0220                 BRANCH IF NOT PASSED     Y02134 44400002
*                                                                Y02134 44420002
         OI    UCBJBNR,UCBMONT          SET PASS INDICATOR       YM1472 44440002
*                                                                Y02134 44460002
DAMV0220 EQU   *                        TEST PRIVATE REQUEST     Y02134 44480002
*                                                                Y02134 44500002
         TM    TIOESTTA,TIOSDSP1        TEST FOR PRIVATE DATA    Y02134 44520002
         BNO   DAMV0230                 BRANCH IF NOT PRIVATE    Y02134 44540002
*                                                                Y02134 44560002
         OI    UCBSTAB,UCBBPRV          SET PRIVATE INDICATOR    YM1472 44580002
*                                                                Y02134 44600002
DAMV0230 EQU   *                        TEST PUBLIC REQUEST      Y02134 44620002
*                                                                Y02134 44640002
         TM    TIOESTTA,TIOSDSP2        TEST FOR PUBLIC DATA     Y02134 44660002
         BNO   DAMV0280                 BRANCH IF NOT PUBLIC     Y02134 44680002
*                                                                Y02134 44700002
         OI    UCBSTAB,UCBBPUB          SET PUBLIC INDICATOR     YM1472 44720002
*                                                                Y02134 44740002
DAMV0280 EQU   *                        SEE IF NOT SCRTCH        Y02134 44760002
*                                                                Y02134 44780002
         TM    TIOESTTA,TIOSDSP1        TEST FOR PRIVATE DATA    Y02134 44800002
         BNO   DAMV0285                 BRANCH IF NOT PRIVATE    Y02134 44820002
*                                                                Y02134 44840002
         L     RET,UCBEXTPT             LOAD UCB EXTENSION PTR   Y02146 44860002
         USING UCBCMEXT,RET             RET POINTS TO EXTENSION  Y02146 44865002
         OI    UCBFLP1,UCBNSRCH         SET NON-SCRTCH INDICATOR Y02146 44868002
         DROP  RET                                               Y02146 44872102
*                                                                Y02134 44872202
DAMV0285 EQU   *                        RELEASE LOCK             Y02134 44873002
*                                                                Y02134 44874002
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02082 44877002
*                                                                Y02134 44920002
DAMV0290 SETLOCK RELEASE,TYPE=LOCAL,                             Y02134X45000002
               RELATED=(LOCAL,IFG0194C(DAMV0210))                Y02134 45020002
*                                                                Y02134 45040002
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 45052002
*                                                                Y02134 45056002
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 45060002
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS     Y02134 45080002
         BNZ   DAMV9000                 BRANCH IF SETLOCK ERROR  Y02134 45100002
         EJECT                                                          46540002
*                                                                Y02134 46560002
*****************************************************************Y02132 46561502
*                                                                Y02132 46563002
*        TEST FOR VIO UCB BEFORE READING F1 OR F4 DSCB'S         Y02132 46564502
*                                                                Y02132 46566002
*****************************************************************Y02132 46566302
*                                                                Y02134 46566702
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         Y02132 46567502
         BNO   DAMV1010                 BR IF NOT                Y02132 46569002
*                                                                Y02134 46569402
*****************************************************************Y02132 46569802
*                                                                Y02132 46570202
*        READ FORMAT ONE DSCB FROM SWA FOR VIO                   Y02132 46570502
*                                                                Y02134 46570902
*****************************************************************Y02132 46571302
*                                                                Y02132 46571702
         LA    R0,K3                    OPEN=213-04 EOV=737-04   YM7888 46572202
         LA    RD,INFMJFCB              LOAD POINTER TO JFCB     YM7888 46572302
         CLC   DXDSABAD,DXDSAB          CHECK IF CURRENT JFCB    YM7888 46572402
         BE    DAMV1005                 BRANCH IF CURRENT        YM7888 46572502
         LA    RD,TIOEJFCB              POINT TO CURRENT JFCB    YM7888 46572602
         IECRES LOCJFCB,(RD)            LOCATE JFCB              YM7888 46572802
*                                                                YM7888 46572902
DAMV1005 EQU   *                        USE JFCB TTR IF VALID    YM7888 46573002
         CLC   K0(L'JFCBDSNM,RD),VDSDSCB-VDSUCB(RUCB) DSNS EQUAL YM7888 46573102
         BNE   DAMV9100                 BRANCH IF NOT CORRECT    YM7888 46573402
*                                                                Y02132 46573502
         MVC   K0(DSCEXT2-DSCFMTID,RB),VDSDSCB-VDSUCB+L'JFCBDSNM(RUCB)  46574002
*                                                                Y02132 46574502
         OC    K0(DSCEXT2-DSCFMTID,RB),K0(RB) IS DSCB = ZERO?    Y02132 46575002
         BZ    DAMV9100                 BRANCH IF DSCB NOT FOUND Y02132 46576502
*                                                                Y02132 46578002
         XC    DSCEXT2-DXDSCB(DSCBEND-DSCEXT2,RB),DSCEXT2-DXDSCB(RB)    46579502
*                                                                Y02132 46581002
         B     DAMV2000                 CONTINUE PROCESSING      Y02132 46582502
*                                                                Y02134 46582902
DAMV1010 EQU   *                        READ FORMAT 4            YM1472 46584002
*                                                                Y02134 46586002
*****************************************************************Y02134 46590002
*                                                                Y02134 46600002
*        READ THE FORMAT 4 DSCB TO INITIALIZE THE DEB            Y02134 46620002
*        EXTENTS TO THOSE OF THE VTOC                            Y02134 46640002
*                                                                Y02134 46660002
*****************************************************************Y02134 46680002
*                                                                Y02134 46700002
         LA    R1,UCBVTOC               LOAD POINTER TO VTOC TTR Y02134 46720002
         L     RF,IECPCNVT              EPA OF IECPCNVT CONV RTN YM3070 46722002
         BALR  RET,RF                   LINK TO CONVERT ROUTINE  YM3070 46740002
         EJECT                                                          46742002
*                                                                Y02134 46760002
*****************************************************************Y02134 46780002
*                                                                Y02134 46800002
*        CONSTRUCT CHANNEL PROGRAM TO READ FORMAT 4              Y02082 46820002
*        SEARCH ID EQ                                            Y02134 46840002
*        TIC *-8                                                 Y02134 46860002
*        SEARCH KEY EQ                                           Y02134 46880002
*        NOP  (NO CHAIN BIT, SLI)                                Y02134 46900002
*        READ DATA (DSCB)                                        Y02134 46920002
*                                                                Y02134 46970002
*****************************************************************Y02134 46972002
*                                                                Y02134 46980002
         XC    DXCCW1(K40),DXCCW1       CLEAR AREA (5 CCWS)      Y02134 47000002
         LA    RF,DXDAADDR+K3           SEARCH ADDRESS           Y02134 47020002
         ST    RF,DXCCW1                                         Y02134 47040002
         LA    RF,DXCCW1                TIC ADDRESS              Y02134 47060002
         ST    RF,DXCCW2                                         Y02134 47080002
         MVC   K0(K4,RB),ODA0670K       MOVE KEY TO SEARCH ON    Y02082 47100002
         ST    RB,DXCCW3                                         Y02134 47140002
         ST    RB,DXCCW5                                         Y02134 47180002
         OC    DXCCW1(K40),ODA0640K     CMND CODE, FLAGS, LENGTH Y02134 47200002
         OI    DXCCW3+K4,CCWSILI        SLI BIT ON SEARCH KEY    Y02082 47220002
         MVI   DXCCW3+K7,K4             SEARCH 4 BYTES OF KEY    Y02082 47240002
*                                                                Y02134 47260002
         EXCP  DXIOB                    READ DSCB VIA EXCP       Y02134 47280002
*                                                                Y02134 47300002
         IECRES WAIT                    WAIT FOR READ TO FINISH  Y02134 47320002
*                                                                Y02134 47340002
         LA    R0,K1                    OPEN=413-20 EOV=737-08   Y02080 47350002
         TM    DXECB,ECBNOERR           CHECK FOR IO ERROR       Y02134 47360002
         BZ    DAMV9900                 BR IF I/O ERROR          Y02082 47380002
*                                                                Y02134 47384002
         CLI   DXDSCB-DXDSCB(RB),CHAR4  CHECK FOR F4 READ        Y02134 47388002
         BNE   DAMV9900                 BRANCH IF BAD PACK       Y02134 47392002
*                                                                Y02134 47401602
         CLC   JFCBDSNM,ODA0670K        TEST FOR VTOC DSNAME   @ZA33308 47404032
         BNE   DAMV1020                 BRANCH IF NOT            Y02134 47408002
*                                                                Y02134 47408402
         TM    UCBJBNR,UCBJES3          DOES JES3 MANAGE UNIT? @G18MSBS 47409032
         BNO   DAMV1015                 NO, CONTINUE           @G18MSBS 47409132
         TM    UCBTBYT2,UCBRVDEV        YES, THEN VIRTUAL VOL? @G18MSBS 47409232
         BNO   DAMV1015                 NO, CONTINUE           @G18MSBS 47409332
         LA    RC,K4                    SET FINAL PASS SWITCH  @G18MSBS 47409432
         L     RF,JES3ROUT              GET JES3 ROUTINE ADDR  @G18MSBS 47409532
         BALR  RET,RF                   BRANCH TO JES3 ROUTINE @G18MSBS 47409632
DAMV1015 EQU     *                                             @G18MSBS 47409732
         MVC   DXCCW7(K5),DXDAADDR+K3   SAVE DSCB CCHHR TO UPDAT Y02134 47409832
         B     DAMV7000                 FORMAT 4 REQUESTED       Y02082 47410002
         EJECT                                                          47410102
*                                                                Y02134 47410402
DAMV1020 EQU   *                        SAVE CCHHR               YM1472 47411002
*                                                                Y02134 47412002
         MVC   DXCCW6(K4),DS4VTOCE+K6-DSCB4(RB) SAVE END CCHH    Y02082 47420002
         MVC   DXCCW6+K4(K1),DS4DEVDT-DSCB4(RB) SAVE R           Y02082 47440002
*                                                                Y02134 47440402
*****************************************************************Y02134 47440802
*                                                                Y02134 47442002
*        DXCCW6 CONTAINS THE CCHHR OF THE HIGHEST DSCB ON THE    Y02082 47445002
*        VTOC                                                    Y02082 47450002
*                                                                Y02134 47460002
*****************************************************************Y02134 47470002
*                                                                Y02134 47500002
         LA    RD,INFMJFCB              LOAD POINTER TO JFCB     Y02134 47504002
         CLC   DXDSABAD,DXDSAB          CHECK IF CURRENT JFCB    Y02134 47508002
         BE    DAMV1050                 BRANCH IF CURRENT        Y02134 47512002
         LA    RD,TIOEJFCB              POINT TO CURRENT JFCB    Y02134 47520002
         IECRES LOCJFCB,(RD)            LOCATE JFCB              Y02134 47540002
*                                                                Y02134 47560002
DAMV1050 EQU   *                        USE JFCB TTR IF VALID    Y02134 47564002
*                                                                Y02134 47568002
         CLC   DXVOLSR2,JFCBVOLS-INFMJFCB(RD) FIRST VOLUME       Y02134 47580002
         BNE   DAMV1100                 BR IF NOT FIRST VOLUME   Y02134 47600002
*                                                                Y02134 47620002
         CLC   JFCBDSCB-INFMJFCB(K3,RD),UCBVTOC TTR INVALID OR 0 Y02134 47640002
         BL    DAMV1100                 INVALID-SEARCH FULL VTOC Y02134 47660002
*                                                                Y02134 47680002
         LA    R1,JFCBDSCB-INFMJFCB(,RD) LOAD POINTER TO DSCB    Y02134 47700002
         L     RF,IECPCNVT              EPA OF IECPCNVT CONV RTN YM3070 47722002
         BALR  RET,RF                   LINK TO CONVERT ROUTINE  YM3070 47724002
         LTR   RF,RF                    TTR WITHIN VTOC?         Y02082 47740002
         BNZ   DAMV1100                 BR IF TTR OUTSIDE VTOC   Y02082 47760002
         CLC   DXDAADDR+K3(K4),DS4VTOCE+K6-DSCB4(RB) CCHH      @ZA02859 47764032
*                                       WITHIN THE VTOC        @ZA02859 47766032
         BH    DAMV1100                 BRANCH IF NOT            Y02082 47772002
         EJECT                                                          47774002
*                                                                Y02134 47780002
*****************************************************************Y02134 47800002
*                                                                Y02134 47820002
*        CONSTRUCT CHANNEL PROGRAM TO READ DSCB DIRECTLY         Y02134 47840002
*        SEARCH ID EQ                                            Y02134 47860002
*        TIC *-8                                                 Y02134 47880002
*        SEARCH KEY EQ                                           Y02134 47900002
*        NOP  (NO CHAIN BIT, SLI)                                Y02134 47920002
*        READ DATA (DSCB)                                        Y02134 47940002
*                                                                Y02134 47960002
*        CHANNEL PROGRAM TO READ FORMAT 4 IS CORRECT TO READ     Y02082 47980002
*        FORMAT 1 EXCPT THE SEARCH KEY EQUAL MUST SEARCH ON 44   Y02082 48000002
*        BYTES OF THE JFCB DSNAME AND OMIT THE SLI BIT           Y02082 48020002
*                                                                Y02134 48040002
*****************************************************************Y02134 48060002
*                                                                Y02082 48080002
         MVI   DXCCW3+K7,L'JFCBDSNM     COUNT OF 44              Y02082 48100002
         NI    DXCCW3+K4,ALLBITS-CCWSILI TURN OFF SLI BIT        Y02082 48120002
         LA    RF,JFCBDSNM-INFMJFCB(,RD) DATA SET NAME KEY ADDR  Y02082 48140002
         STCM  RF,B'0111',DXCCW3+K1     STORE KEY ADDR IN CCW    Y02134 48160002
*                                                                Y02082 48340002
         EXCP  DXIOB                    READ DSCB VIA EXCP       Y02134 48360002
*                                                                Y02134 48380002
         IECRES WAIT                    WAIT FOR READ TO FINISH  Y02134 48400002
*                                                                Y02134 48420002
         TM    DXECB,ECBNOERR           CHECK FOR IO ERROR       Y02134 48440002
         BZ    DAMV1100                 BR IF YES, SEARCH VTOC   Y02134 48460002
*                                                                Y02134 48480002
         LA    RF,DXCCW6                TEST IF CHANNEL PROGRAM  Y02134 48500002
         L     R1,IOBCOMAD              TERMINATED AFTER READ    Y02134 48520002
         LA    R1,0(R1)                 CCW BY EXAMINING CSW     Y02134 48540002
         CR    R1,RF                    STORED IN IOB            Y02134 48560002
         BNE   DAMV1100                 BR IF NO, SEARCH VTOC    M0033  48580002
*                                                                Y02134 48600002
*        DO NOT MOVE CCHHR INTO DXCCW7 FOR THE EXECUTORS UNLESS  Y02134 48600402
*        THIS IS THE FIRST DSCB READ                             Y02134 48600802
*                                                                Y02134 48601202
         LA    RB,K0(,RB)               CLEAR HIGH BYTE          Y02134 48602402
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE          Y02134 48602802
         CR    RB,RCORE                 IS THIS FIRST DSCB READ  Y02134 48603202
         BNE   DAMV1070                 BRANCH IF NOT          @G60ASRB 48603660
         MVC   DXCCW7(K5),DXDAADDR+K3   SAVE DSCB CCHHR TO UPDAT Y02134 48608660
*                                                                Y02134 48613660
         B     DAMV2000                 BRANCH TO PROCESS F1     Y02134 48618660
*                                                              @G60ASRB 48623660
DAMV1070 EQU   *                        SAVE CCHHR             @G60ASRB 48628660
*                                                              @G60ASRB 48633660
         MVC   F1CCHHR-F1DATA(,RB),DXDAADDR+K3 MOVE CCHHR OF   @G60ASRB*48638660
                                        F1 DSCB                @G60ASRB 48643660
         B     DAMV2000                 PROCESS F1             @G60ASRB 48648660
         EJECT                                                          48662002
*                                                                Y02134 48680002
*****************************************************************Y02134 48700002
*                                                                Y02134 48720002
*        START SEARCHING FOR DSCB FROM THE START OF THE VTOC.    Y02134 48740002
*                                                                Y02134 48760002
*****************************************************************Y02134 48780002
*                                                                Y02134 48800002
DAMV1100 EQU   *                                                 Y02134 48820002
*                                                                Y02134 48840002
         L     R1,UCBVTOC               LOAD TTR OF VTOC AND     Y02134 48860002
         SRL   R1,K8                    DECREMENT R BY ONE TO    Y02134 48880002
         BCTR  R1,R0                    READ COUNT & READ R1     Y02134 48900002
         ST    R1,DXWORK1               AFTER SEARCH FOR R0      Y02134 48920002
         LA    R1,DXWORK1+K1            POINT TO TTR             Y02134 48940002
         L     RF,IECPCNVT              EPA OF IECPCNVT CONV RTN YM3070 48962002
         BALR  RET,RF                   LINK TO CONVERT ROUTINE  YM3070 48964002
*                                                                Y02134 48980002
*****************************************************************Y02134 49000002
*                                                                Y02134 49020002
*        CONSTRUCT CHANNEL PROGRAM TO READ FORMAT 1 DSCB         Y02082 49040002
*                                                                Y02134 49060002
*DXCCW1  SEARCH ID EQUAL (VTOC CCHHR)                            Y02082 49080002
*DXCCW2  TIC *-8                                                 Y02082 49100002
*DXCCW3  TIC TO GETMAIN WORKAREA                                 Y02082 49120002
*                                                                Y02134 49130002
*        GETMAIN AREA                                            Y02082 49140002
*                                                                Y02134 49150002
*WACCW1  SEARCH ID EQ MULTI-TRACK (CCHHR OF LAST DSCB IN VTOC)   Y02082 49160002
*WACCW2  TIC WACCW6                                              Y02082 49180002
*WACCW3  SEARCH KEY EQUAL (DATA SET NAME)                        Y02082 49200002
*WACCW4  NOP (COUNT=1, SLI BIT ON)                               Y02082 49220002
*WACCW5  TIC WACCW8                                              Y02082 49240002
*WACCW6  SEARCH KEY EQUAL (DATA SET NAME)                        Y02082 49260002
*WACCW7  TIC WACCW1                                              Y02082 49280002
*WACCW8  READ DATA (96 BYTES)                                  @G60ASRB 49285060
*WACCW9  READ COUNT (DXCCW7 IF FIRST DSCB, OR F1CCHHR IF NOT)  @G60ASRB 49295060
*                                                                Y02082 49340002
*****************************************************************Y02082 49345002
*                                                                Y02134 49350002
*        GO GET STORAGE AREA FOR THE ABOVE CCW'S               @G18MSBS 49360032
*                                                              @G18MSBS 49360432
         L     RF,ADDRCCWS              GET ADDRESS OF GETCCWS @G18MSBS 49360832
         BALR  RET,RF                   GO GET THE WORK AREA   @G18MSBS 49361232
*                                                                Y02082 49362002
*****************************************************************Y02082 49364002
*                                                                Y02082 49365002
*        R1 POINTS TO CCW AREA - SAVE IN DXCCW3 AS TIC ADDRESS   Y02082 49380002
*                                                                Y02082 49390002
*****************************************************************Y02082 49392002
*                                                                Y02082 49400002
         USING WACCW,R1                                          Y02082 49420002
         ST    R1,DXCCW3                SAVE IN DXCCW3           Y02082 49440002
         MVI   DXCCW3,CCWTIC            MAKE DXCCW3 A TIC        Y02082 49460002
         XC    WACCW1(K72),WACCW1       CLEAR CCWS               Y02082 49480002
         LA    RF,DXCCW6                HIGH VTOC CCHHR          Y02082 49500002
         ST    RF,WACCW1                STORE IN SERRCH ID HIGH  Y02082 49520002
         LA    RF,WACCW6                TIC TO ADDR              Y02082 49540002
         ST    RF,WACCW2                SAVE IN TIC              Y02082 49560002
         LA    RF,JFCBDSNM-INFMJFCB(,RD) DATA SET NAME           Y02082 49580002
         ST    RF,WACCW3                SAVE IN SEARCH KEY       Y02082 49600002
         ST    RF,WACCW6                SAVE IN OTHER SEARCH KEY Y02082 49620002
         LA    RF,WACCW8                TIC TO ADDR              Y02082 49640002
         ST    RF,WACCW5                STORE IN TIC             Y02082 49660002
         LA    RF,WACCW1                TIC TO ADDR              Y02082 49680002
         ST    RF,WACCW7                STORE IN TIC             Y02082 49700002
         LA    RF,K0(,RB)               DSCB BUFFER              Y02082 49720002
         ST    RF,WACCW8                STORE IN READ DATA       Y02082 49740002
         LA    RF,DXCCW7                COUNT ADDRESS            Y02082 49760002
         ST    RF,WACCW9                STORE IN READ COUNT      Y02082 49780002
         LA    RCORE,K0(,RCORE)         CLEAR HI BYTE FOR CR     Y02082 49805002
         LA    RB,K0(,RB)               CLEAR HI BYTE FOR CR     Y02082 49810002
         CR    RB,RCORE                 IS DSCB TO BE READ INTO  Y02082 49815002
*                                       DCB WORKAREA             Y02082 49820002
         BE    DAMV1150                 BRANCH IF YES          @G60ASRB 49825060
         LA    RF,F1CCHHR-F1DATA(,RB)   CCHHR AREA             @G60ASRB 49831060
         ST    RF,WACCW9                PUT IN READ COUNT CCW  @G60ASRB 49837060
*                                                              @G60ASRB 49843060
DAMV1150 EQU   *                        OR IN OP CODES         @G60ASRB 49849060
*                                                              @G60ASRB 49855060
         OC    WACCW1(K72),ODA0650K     OR IN CMDS,FLGS,COUNTS @G60ASRB 49861060
*                                                              @G60ASRB 49867060
         NI    DXFLAG1,X'FF'-DXEX0A01   ZERO THE SECOND PASS   @G60ASRB*49873060
                                        BIT                    @G60ASRB 49879060
         EJECT                                                 @G60ASRB 49885060
*                                                                Y02134 49900002
DAMV1200 EQU   *                        READ A FORMAT 1 DSCB     YM1472 49905002
*                                                                Y02134 49910002
         EXCP  DXIOB                    READ DSCB VIA EXCP       Y02134 49920002
*                                                                Y02134 49940002
         IECRES WAIT                    WAIT FOR READ TO FINISH  Y02134 49960002
*                                                                Y02082 49980002
*****************************************************************Y02134 50000002
*                                                                Y02082 50020002
*        CHECK FOR I/O ERROR                                     Y02082 50040002
*                                                                Y02082 50060002
*****************************************************************Y02134 50080002
*                                                                Y02082 50220002
         TM    DXECB,ECBNOERR           CHECK FOR I/O ERROR      Y02082 50240002
         BO    DAMV1300                 BR IF NO                 YM1472 50260002
*                                                                YM1472 50262002
*        CHECK FOR PO BEFORE EXCP, DSORG FIELD EXISTS IN COPY    YM3925 50262102
*        EVEN IF NOT IN USERS DCB.                               YM3925 50262202
         TM    DCBDSORG,DCBDSGPO        TEST FOR BPAM DATA SET   YM3925 50262302
         LA    R0,K2                    OPEN=213-0C EOV=737-0C   YM3925 50262502
         BO    DAMV9100                 BRANCH, BPAM ERROR       YM3925 50262802
*                                                                YM3925 50263202
         LA    R0,K3                    OPEN=213-04 EOV=737-04   YM1459 50263502
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    YM1472 50264002
         BO    DAMV9100                 BRANCH EXCP, ASSUME PS   YM1472 50266002
         NC    DCBDSORG,DCBDSORG        CHECK IF DSORG SPECIFIED YM1472 50270002
         BZ    DAMV9100                 BRANCH 0, ASSUME PS      YM1472 50272002
         TM    DCBDSORG,DCBDSGPS        PHYSICAL SEQUENTIAL DCB  YM1472 50276002
         BO    DAMV9100                 BRANCH IF DSORG=PS       YM1472 50280002
*                                                                YM1472 50280102
         LA    R0,K2                    OPEN=213-0C EOV=737-0C   YM1472 50280402
         B     DAMV9100                 BRANCH IF NOT PS         YM1472 50280802
*                                                                YM1472 50281602
*****************************************************************YM1472 50281702
*                                                                YM1472 50281802
*        IF CSW INDICATES CHANNEL PROGRAM ENDED AT NOP, DSCB     YM1472 50281902
*        WAS NOT READ. THE DATA SET IS NOT ON THE VOLUME.        YM1472 50282602
*                                                                YM1472 50283502
*****************************************************************YM1472 50283602
*                                                                YM1472 50283702
DAMV1300 EQU   *                        CHECK FOR NO DSCB        YM1472 50284102
*                                                                YM1472 50284202
         L     RF,IOBCOMAD              CSW'S ENDING CCW+8       YM1472 50284602
         LA    RF,K0(,RF)               CLEAR HIGH BYTE          YM1472 50284702
         L     R1,DXCCW3                CCW AREA                 YM1472 50284802
         LA    R1,WACCW5                CCW PAST NOP             YM1472 50284902
         CR    RF,R1                    ARE THEY EQUAL           YM1472 50285002
         BE    DAMV1350                 BRANCH IF YES-NO DSCB    YM1472 50285102
         CLI   DXDSCB-DXDSCB(RB),CHAR1  FORMAT 1 ID              YM1472 50285202
         BE    DAMV1500                 BRANCH IF DATA SET FOUND YM1472 50285402
         DROP  R1                                                YM1472 50287502
*                                                                Y02134 50400002
DAMV1350 EQU   *                        PROCESS NO DSCB          YM1472 50420002
*                                                                Y02134 50440002
*                                                              @G60ASRB 50440160
*        CALL THE DSCB NOT FOUND INSTALLATION EXIT. RETURN     @G60ASRB 50440260
*        WILL CONTAIN RETURN CODE IN REG 15.                   @G60ASRB 50440360
*          0 - CONTINUE                                        @G60ASRB 50440460
*          4 - RETRY READ OF DSCB                              @G60ASRB 50440560
*          8 - EXIT ERROR                                      @G60ASRB 50440660
*                                                              @G60ASRB 50440760
         L     RF,DSNOTFA               SUBROUTINE ADDRESS     @G60ASRB 50440860
         BALR  RET,RF                                          @G60ASRB 50440960
         B     DAMV1360(RF)                                    @G60ASRB 50441060
DAMV1360 EQU   *                        TEST RESULT            @G60ASRB 50441160
         B     DAMV1370                 CONTINUE               @G60ASRB 50441460
         B     DAMV1200                 RETRY                  @G60ASRB 50441560
         B     DAMV9900                 ABEND                  @G60ASRB 50441660
*                                                              @G60ASRB 50442460
DAMV1370 EQU   *                        DSCB NOT FOUND         @G60ASRB 50442860
*                                                              @G60ASRB 50443260
*        CHECK FOR PO BEFORE EXCP, DSORG FIELD EXISTS IN COPY    YM3925 50443660
*        EVEN IF NOT IN USERS DCB.                               YM3925 50444002
         TM    DCBDSORG,DCBDSGPO        TEST FOR BPAM DATA SET   YM3925 50446002
         LA    R0,K2                    OPEN=213-0C EOV=737-0C   YM3925 50448002
         BO    DAMV9100                 BRANCH, BPAM ERROR       YM3925 50450002
*                                                                YM3925 50452002
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    Y02134 50460002
         BO    DAMV1400                 BRANCH EXCP, ASSUME PS   Y02134 50480002
*                                                                Y02134 50500002
         NC    DCBDSORG,DCBDSORG        CHECK IF DSORG SPECIFIED Y02134 50520002
         BZ    DAMV1400                 BRANCH 0, ASSUME PS      Y02134 50540002
*                                                                Y02134 50560002
         TM    DCBDSORG,DCBDSGPS        PHYSICAL SEQUENTIAL DCB  Y02134 50580002
         LA    R0,K2                    OPEN=213-0C EOV=737-0C   Y02134 50590002
         BNO   DAMV9100                 BRANCH IF NOT PS         Y02134 50600002
*                                                                Y02134 50620002
DAMV1400 EQU   *                        CHECK IF OUTPUT          YM1472 50640002
*                                                                Y02134 50660002
         TM    DXDCBLST,PLISTOIN        TEST FOR OUTPUT          YM1459 50661002
         LA    R0,K3                    OPEN=213-04 EOV=737-04   YM1459 50662002
         BNO   DAMV9100                 BRANCH IF INPUT NO DSCB  YM1459 50663002
*                                                                YM1459 50663202
         CLC   WTGMODNM+K3(K3),DAMVEOV  TEST FOR EOV             Y02134 50664002
         BNE   DAMV1450                 BRANCH IF NOT EOV        Y02134 50668002
*                                                                Y02134 50672002
         EJECT                                                          50676702
*                                                                Y02083 50676802
*****************************************************************Y02083 50676902
*                                                                Y02083 50680802
*        EOV CHECKPOINT DATA SET PROCESSING                      Y02083 50682802
*                                                                Y02083 50684802
*****************************************************************Y02083 50685002
*                                                                Y02083 50685402
         L     RF,DXDSAB                FETCH DSAB ADDRESS       YM1311 50685502
         TM    DSABFLG4-DSAB(RF),DSABCKDS TEST FOR CHKPT D/S     YM1311 50686402
         BZ    DAMV1420                 IF NOT, CONTINUE       @G18MSBS 50686832
*                                                                YM3925 50692002
         LA    RET,K52                  CAN VOL BE SECURED       YM3925 50692402
         L     RF,CHKPTWTO              GET MSG RTN ADDR         YM3925 50692502
         BALR  RC,RF                    ISSUE MESSAGE            YM3925 50692602
*                                                                YM3925 50692702
         LA    R0,K10                   OPEN=NA EOV=937-10       YM3925 50692802
         BNE   DAMV7510                 BRANCH IF NOT SECURE     YM5957 50693202
         L     RF,DXDSAB                FETCH DSAB ADDRESS       YM5957 50693302
         MODESET EXTKEY=SCHED           ASSUME DSAB KEY          YM5957 50693602
         OI    DSABFLG4-DSAB(RF),DSABCKVL SET SECURE BIT         YM5957 50693702
         MODESET EXTKEY=DATAMGT         RESUME D/M KEY           YM5957 50693802
         EJECT                                                          50694032
*                                                              @G18MSBS 50694132
***************************************************************@G18MSBS 50694232
*                                                              @G18MSBS 50694332
**       FOR JES3 MANAGED UNIT, OFFER VOLUME CHOICE TO JES3    @G18MSBS 50694432
**       FOR APPROVAL BEFORE TRYING TO EXTEND ON NEW VOLUME    @G18MSBS 50694532
*                                                              @G18MSBS 50694632
***************************************************************@G18MSBS 50694732
*                                                              @G18MSBS 50694832
DAMV1420 EQU   *                                               @G18MSBS 50694932
         TM    UCBJBNR,UCBJES3          DOES JES3 MANAGE UNIT? @G18MSBS 50695032
         BNO   DAMV1430                 NO, CONTINUE           @G18MSBS 50695132
         TM    UCBTBYT2,UCBRVDEV        YES, THEN VIRTUAL VOL? @G18MSBS 50695232
         BNO   DAMV1430                 NO, CONTINUE           @G18MSBS 50695332
         XR    RC,RC                    SET FIRST PASS SWITCH  @G18MSBS 50695432
         L     RF,JES3ROUT              GET JES3 ROUTINE ADDR  @G18MSBS 50695532
         BALR  RET,RF                   BRANCH TO JES3 ROUTINE @G18MSBS 50695632
*                                                                YM1472 50695732
*****************************************************************YM1472 50695832
*                                                                YM1472 50695932
*        TRY TO EXTEND ON NEW VOLUME                             YM1472 50696032
*                                                                YM1472 50696132
*****************************************************************YM1472 50696232
*                                                                YM1472 50696332
DAMV1430 EQU   *                                                 Y02083 50696432
*                                                              @ZA04643 50696532
***************************************************************@ZA04643 50696632
*                                                              @ZA04643 50696732
*        THE FORMAT1 DSCB HAS NOT BEEN FOUND ON THE NEW        @ZA04643 50696832
*        VOLUME. THEREFORE, SET THE 'TREAT AS NEW' INDICATOR   @ZA04643 50696932
*        IN THE DEB SO THAT THE NEXT EOV WILL TREAT THE DATA   @ZA04643 50697032
*        SET AS IF IT WERE NEW AND FOLLOW THE NORMAL RULES     @ZA04643 50697132
*        FOR OBTAINING SPACE ON THE VOLUME.                    @ZA04643 50697232
*                                                              @ZA04643 50697332
***************************************************************@ZA04643 50697432
*                                                              @ZA04643 50697532
         L     RET,DCBDEBAD             GET DEB ADDR           @ZA04643 50697632
         SR    RF,RF                    ZERO WORK REG          @ZA04643 50697732
         IC    RF,DEBNMEXT-DEBBASIC(RET) GET NUMBER OF EXTENTS @ZA04643 50697832
         SLL   RF,4                     MPY BY 16-BYTES/EXT    @ZA04643 50697932
         AR    RF,RET                   ADD DEB BASE ADDR      @ZA04643 50698032
         OI    DEBVOLSQ-DEBVOLSQ+DEBSUCBA-DEBBASIC(RF),JFCMOD  @ZA04643 50698132
*                                       TURN ON TREAT AS       @ZA04643 50698232
*                                       NEW SW IN DEB          @ZA04643 50698332
DAMV1435 EQU   *                                               @ZA04643 50698432
         MVI   DXRETCOD,K4              SET UP RETURN OFFSET     Y02134 50698532
         MVC   DXRETMOD,ID4C4C          SET UP RETURN MODULE     Y02134 50698632
         MVI   DXEXTSW,CHAR00           ZERO EXTEND SWITCH       Y02082 50698732
         LA    RCORE,K0(RCORE)          ZERO HI BYTE           @ZA08882 50698832
         ST    RCORE,CORECH(,RCORE)     REUSE W.A. FOR F1      @ZA05097 50698932
*                                                                Y02134 50699032
         IECRES LOAD,MODNM=IFG0554P,BRCODE=K8,BRANCH=QUEUED      Y02080 50699132
         EJECT                                                          50699232
*                                                                Y02134 50704402
*****************************************************************YM1472 50706402
*                                                                YM1472 50706802
*        CHECK FOR DISP=MOD AND OUTPUT                           YM1472 50707202
*                                                                YM1472 50707602
*****************************************************************YM1472 50708002
*                                                                YM1472 50708102
DAMV1450 EQU   *                                                 Y02082 50708302
*                                                                Y02134 50712202
*                                       TEST FOR DISP=MOD        Y02134 50716102
         TM    JFCBIND2-INFMJFCB(RD),JFCOLD NOT OLD OR NEW       Y02134 50720002
         LA    R0,K3                    OPEN=213-04 EOV=737-04   Y02134 50730002
         BO    DAMV9100                 BRANCH IF NOT MOD        Y02134 50740002
*                                                                Y02134 50760002
*****************************************************************Y02134 50780002
*                                                                Y02082 50800002
*        IF JFCBVLSQ IS GREATER THAN 1, IT MUST HAVE BEEN        Y02134 50820002
*        SPECIFIED IN THE DD STATEMENT.  A FAILURE TO FIND       Y02134 50840002
*        THE INITIAL DSCB ON VOLUME 1 WILL RESULT IN A 213       Y02134 50860002
*        ABEND, SINCE THERE CAN BE NO RECOVERY WHEN              Y02134 50880002
*        THE DATA SET IS NOT EVEN ON THE FIRST VOLUME.           Y02134 50900002
*                                                                Y02134 50920002
*****************************************************************Y02134 50940002
*                                                                Y02082 50960002
         CLC   JFCBVLSQ-INFMJFCB(L'JFCBVLSQ,RD),ONE VOL SEQ GE 1 Y02134 50980002
         LA    R0,K3                    OPEN=213-04 EOV=737-04   Y02134 50990002
         BNL   DAMV9100                 BR IF YES TO 213 ABEND   Y02134 51000002
*                                                                Y02134 51020002
*****************************************************************Y02134 51040002
*                                                                Y02134 51060002
*        DISP=MOD ERROR RECOVERY                                 Y02134 51080002
*                                                                Y02134 51100002
*****************************************************************Y02134 51120002
*                                                                Y02134 51140002
         ST    RB,CORECH(,RB)           CHAIN FOR REUSE          Y02134 51141002
         MVI   DXEXTSW,ALLBITS          DSCB NOT FOUND INDICATOR Y02134 51144002
*                                                                Y02134 51148002
         IECRES LOAD,MODID=ID4C4A,BRCODE=K20,BRANCH=QUEUED       Y02134 51160002
         EJECT                                                          51170002
*                                                                Y02134 51200002
*****************************************************************Y02134 51220002
*                                                                Y02134 51240002
*        IF THE VTOC DSCB SEARCH JUST DONE WAS FOR THE FIRST     Y02134 51260002
*        VOLUME, UPDATE THE JFCB DSCB TTR SO THAT THE DSCB CAN   Y02134 51280002
*        BE READ DIRECTLY THE NEXT TIME THE DATA SET IS OPENED.  Y02134 51300002
*                                                                Y02134 51320002
*****************************************************************Y02134 51340002
*                                                                Y02134 51360002
DAMV1500 EQU   *                                                 Y02134 51380002
*                                                                Y02082 51400002
*****************************************************************Y02134 51420002
*                                                                Y02082 51440002
*        IF R IN COUNT READ IS 1, THE COUNT OF THE DSCB READ IS  Y02082 51455002
*              THE LAST ON THE TRACK                             Y02082 51460002
*        OTHERWISE R MUST BE REDUCED BY ONE AS THE COUNT OF      Y02082 51460202
*              RECORD R+1 WAS READ                               Y02082 51460402
*                                                                Y02134 51461002
*****************************************************************Y02134 51462002
*                                                                Y02134 51463002
         USING WACCW,R1                 R1 POINTS TO CCWS        YM1472 51465002
         L     R1,DXCCW3                CCW AREA                 Y02082 51500302
         L     RF,WACCW9                CCHHR OF NEXT DSCB     @G60ASRB 51501560
         CLI   K4(RF),K1                IS RECORD NO. 1        @ZA30123 51502560
         BE    DAMV1550                 BR IF YES                Y02082 51506002
*                                                                Y02134 51506402
*****************************************************************Y02134 51506802
*                                                                Y02082 51507502
*        REDUCE R BY 1 AS CCHHR IS OF DSCB PAST THE ONE READ     Y02082 51509002
*                                                                Y02082 51510502
*****************************************************************Y02134 51510902
*                                                                Y02082 51511302
         SR    R1,R1                    ZERO FOR IC              Y02082 51512002
         IC    R1,K4(RF)                RECORD NUMBER          @G60ASRB 51513560
         BCTR  R1,K0                    REDUCE BY 1              Y02082 51514560
         STC   R1,K4(RF)                RESTORE                @G60ASRB 51515560
         B     DAMV1600                 BRANCH TO FREE WORKAREA  Y02082 51518002
*                                                                Y02082 51521002
*****************************************************************Y02134 51521402
*                                                                Y02082 51521802
*        R IS 1 - R SHOULD BE HIGH R ON TRACK                    Y02082 51522502
*                                                                Y02082 51522902
*****************************************************************Y02134 51523302
*                                                                Y02082 51523702
DAMV1550 EQU   *                                                 Y02082 51523802
*                                                                Y02082 51524002
         MVC   K4(K1,RF),DXCCW6+K4      HIGH R ON VTOC TRACK   @G60ASRB 51530060
         EJECT                                                          51532002
*                                                                Y02082 51560002
*****************************************************************Y02134 51580002
*                                                                Y02082 51600002
*        FREE CCW AREA                                           YM1472 51600402
*                                                                YM1472 51602002
*****************************************************************Y02134 51602402
*                                                                YM1472 51604002
DAMV1600 EQU   *                                                 Y02082 51605002
*                                                                Y02082 51607002
         L     R1,DXCCW3                WORKAREA CCW CORE ADDR   Y02082 51610002
         LA    R1,WACCW                 CLEAR HI BYTE            YM1472 51615002
         DROP  R1                                                YM1472 51615402
*                                                                YM1472 51615802
         L     RF,ADDRFREE              GET ADDRESS OF FREECCW @G18MSBS 51616032
         BALR  RET,RF                   GO FREE CCW WORKAREA   @G18MSBS 51666032
*                                                                Y02134 52060002
         LA    RCORE,K0(RCORE)          SET HI ORDER BYTE TO 0   Y02134 52080002
         LA    RB,K0(RB)                SET HI ORDER BYTE TO 0   Y02134 52100002
         CR    RCORE,RB                 CHECK FOR INCORE JFCB    Y02134 52120002
         BNE   DAMV2000                 BRANCH NOT FIRST DSCB    Y02134 52140002
*                                                                Y02134 52160002
         TM    JFCBTSDM,JFCNDSCB        DSCB-JFCB MERGE INHIBITD Y02134 52180002
         BO    DAMV2000                 BRANCH IF MERGE IHIBITED Y02134 52200002
*                                                                Y02134 52220002
         MVC   DXDAADDR+K3(K5),DXCCW7   ADD ACTUAL CCHHR TO MBB  Y02134 52240002
         L     RF,IECPRLTV              EPA OF IECPRLTV CONV RTN YM3070 52262002
         BALR  RET,RF                   LINK TO CONVERT ROUTINE  YM3070 52264002
*                                                                Y02134 52280002
         STCM  R0,B'1110',JFCBDSCB      UPDATE TTR IN JFCB       Y02134 52300002
         OI    JFCBMASK+K6,JFCMCTTR     SET RE-CATALOG DSCB TTR  Y02134 52340002
         OI    JFCBMASK+K4,JFCMJMOD     SET JFCB MOD SWITCH ON   Y02134 52360002
         EJECT                                                          52370002
*                                                                Y02072 52530002
*****************************************************************Y02072 52532002
*                                                                Y02072 52534002
*        CHECK FOR DOS COMPATIBILITY                             Y02072 52536002
*        NO SPLIT CYLINDER EXTENTS EXCEPT THE FIRST              Y02134 52536402
*        IGNORE USER LABEL EXTENT                                Y02134 52536802
*                                                                Y02072 52538002
*****************************************************************Y02072 52538402
*                                                                Y02134 52538502
DAMV2000 EQU   *                                                 Y02134 52538602
*                                                                Y02134 52538802
         XR    RF,RF                    CLEAR REG FOR IC INST    Y02134 52539202
         IC    RF,DSCNOEXT-DXDSCB(,RB)  GET NO OF EXTENTS        Y02134 52539602
         CLI   DSCEXTYP-DXDSCB(RB),X40  CHECK FOR UL EXTENT      Y02134 52539702
         BNE   DAMV2010                 BRANCH IF NOT UL EXTENT  Y02134 52539802
         LA    RF,K1(,RF)               REFLECT UL EXTENT        Y02134 52539902
         STC   RF,DXWORK                SAVE NO OF EXTENTS       Y02134 52541902
         B     DAMV2020                 BRANCH, CHECK 3RD EXTENT Y02134 52542703
*                                                                Y02134 52544902
*****************************************************************Y02072 52545002
*                                                                Y02134 52545102
*        CHECK FOR SPLIT CYLINDERS ON SECOND EXTENT              Y02134 52545202
*                                                                Y02134 52545702
*****************************************************************Y02072 52545802
*                                                                Y02134 52545902
DAMV2010 EQU   *                                                 Y02134 52546002
*                                                                Y02072 52546102
         STC   RF,DXWORK                SAVE NO OF EXTENTS       Y02134 52546202
*                                                                Y02134 52547202
         CLI   DXWORK,K2                CHECK FOR 2ND EXTENT     Y02072 52547302
         BL    DAMV2030                 BRANCH IF NO 2ND EXTENT  Y02072 52547402
*                                                                Y02134 52547502
         CLI   DSCEXT1-DXDSCB(RB),X80   IS THIS A SPLIT CYLINDER?Y02072 52547602
         LA    R0,K9                    OPEN=213-24 EOV=C37-08   Y02134 52547702
         BE    DAMV9100                 YES - GO TO PROB DET     Y02072 52547802
*                                                                Y02134 52548002
*****************************************************************Y02072 52548402
*                                                                Y02134 52548502
*        CHECK FOR SPLIT CYLINDERS ON THIRD EXTENT               Y02134 52548602
*                                                                Y02134 52548702
*****************************************************************Y02072 52548802
*                                                                Y02134 52548902
DAMV2020 EQU   *                                                 Y02072 52549002
*                                                                Y02134 52549102
         CLI   DXWORK,K3                CHECK FOR 3RD EXTENT     Y02072 52549202
         BL    DAMV2030                 BRANCH IF NO 3RD EXTENT  Y02072 52549302
*                                                                Y02134 52549602
         CLI   DSCEXT2-DXDSCB(RB),X80   IS THIS A SPLIT CYLINDER?Y02072 52549902
         LA    R0,K9                    OPEN=213-24 EOV=C37-08   Y02134 52550002
         BE    DAMV9100                 YES - GO TO PROB DET     Y02072 52550102
*                                                                Y02072 52552102
*****************************************************************Y02072 52552502
*                                                                Y02072 52552902
*        CHECK FOR DOS COMPATIBILITY                             Y02072 52553102
*                                                                Y02072 52553502
*****************************************************************Y02072 52553902
*                                                                Y02134 52554002
DAMV2030 EQU   *                                                 Y02072 52554102
*                                                                Y02134 52554202
         CLI   DXWORK,K16               MORE THAN 16 EXTENTS?    Y02072 52556202
         LA    R0,K8                    OPEN=213-20 EOV=C37-04   Y02134 52556302
         BH    DAMV9100                 YES - GO TO PROBLEM DET  Y02072 52556702
         EJECT                                                          52557002
*                                                                Y02134 52557102
*****************************************************************Y02134 52557202
*                                                                Y02134 52557302
*        F1 DSCB HAS BEEN READ                                   Y02134 52557402
*                                                                Y02134 52557502
*****************************************************************Y02134 52557602
*                                                                Y02134 52557702
DAMV2100 EQU   *                        F1 DSCB PROCESSING       Y02134 52557802
*                                                                Y02134 52557902
         L     RF,ISAMRTN                                      @ZA26665 52558332
         BALR  RET,RF                   CHK ISAM NO NEXT DSCB  @ZA26665 52558432
DAMV2105 CLC   DAMVEOV,WTGMODNM+K3      CHECK FOR EOV          @ZA26665 52558532
         BE    DAMV2150                 BRANCH IF EOV            YM3070 52558632
         LA    RCORE,DXDSCB             CLEAR HI BYTE            YM3070 52558802
         LA    RB,DXDSCB-DXDSCB(,RB)    CLEAR HI BYTE            YM3070 52558902
         CR    RCORE,RB                 CHECK FOR 1ST VOL MOUNT  YM3070 52559002
         BNE   DAMV2150                 BRANCH IF NOT FIRST      YM3070 52559102
         NC    DCBDSORG,DCBDSORG        SEE IF DSORG SPECIFIED   YM3070 52559302
         BNZ   DAMV2150                 BRANCH IF SPECIFIED      YM3070 52559402
         TM    DSCFILTY+K1,ACBDORGA     TEST FOR VSAM            YM3070 52559802
         BO    DAMV2150                 BRANCH IF VSAM           YM3070 52559902
         NC    DSCFILTY,DSCFILTY        CHECK FOR DSORG IN DSCB  YM3070 52560002
         BZ    DAMV2150                 BRANCH IF NO DSORG       YM3070 52560102
*                                                                YM3070 52560202
*        MERGE DSORG IN COPY EVEN IF FIELD DOES NOT EXIST FOR    YM3925 52560502
*        EXCP. IT WILL BE IGNORED EXCEPT FOR BPAM DSORG=PO.      YM3925 52560902
         MVC   DCBDSORG,DSCFILTY        MERGE DSORG TO DCB       YM3070 52561002
         OI    JFCBMASK+K3,X01          DSORG MERGE MASK         YM3070 52561302
*                                                                YM3070 52561402
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP ORG        YM3925 52561502
         BNO   DAMV2110                 BRANCH IF NOT EXCP       YM3925 52561902
         TM    DCBMACRF,DCBMFOUN        DOES DSORG FIELD EXIST   YM3925 52562302
         BNO   DAMV2150                 BRANCH IF NO DSORG       YM3925 52562502
*                                                                YM3925 52562902
DAMV2110 EQU   *                        DSORG=PS NEEDS NO RECOPY YM3925 52563302
*                                                                YM3925 52563402
         TM    DCBDSORG,DCBDSGPS        TEST FOR PS              YM3070 52563502
         BO    DAMV2150                 BRANCH IF SPECIFIED      YM3070 52563602
*                                                                YM3070 52563702
*****************************************************************Y02134 52563802
*                                                                Y02134 52563902
*        RECOPY DCB WITH PROPER SIZE                             YM3070 52564002
*                                                                Y02134 52564102
*****************************************************************Y02134 52564202
*                                                                YM3070 52564302
         L     RDCB,DXUDCBAD            SAVE USER DCB PTR        YM3070 52564402
         ICM   RDCB,B'1000',DXUKEY      SAVE USER KEY            YM3070 52564502
         MVC   DXUDCBAD,DXPDCBAD        SET USER=PROTECT         YM3070 52564602
         MVI   DXUKEY,DATAMGT           SET DM KEY               YM3070 52564702
*        GET PROPER SIZE AREA FOR NEW DCB (DSORG IS DIFFERENT)   YM3070 52564802
         IECRES INIT,DCBCOPY=TOWKAR,STM=(2,14,WTGPREFX),         YM3070X52564902
               PREFIX=WTGPREFX                                   YM3070 52565002
*                                                                YM3070 52565102
         STCM  RDCB,B'1000',DXUKEY      RESTORE KEY              YM3070 52565202
         STCM  RDCB,B'0111',DXUDCBAD+K1 RESTORE USER DCB ADDRESS YM3070 52565302
         L     RDCB,DXPDCBAD            LOAD COPY DCB ADDRESS    YM3070 52565402
         L     R1,DXDEBXAD              LOAD DEB EXTENSION ADDR  YM3070 52565502
         USING DEBXTN,R1                R1 POINTS TO DEB EXT     YM3070 52565602
         MVC   DEBXDSO1(L'DCBDSORG),DCBDSORG UPDATE DEBX DSORG   YM3070 52565702
         DROP  R1                                                YM3070 52565802
*                                                                YM3070 52565902
*        RESTORE DCB FROM ORIGINAL WITH PROPER LENGTH            YM3070 52566002
         IECRES INIT,DCBCOPY=TOWKAR,STM=(3,14,WTGPREFX),         YM3070X52566102
               PREFIX=WTGPREFX                                   YM3070 52566202
*                                                                YM3070 52566302
         TM    DCBDSORG,DCBDSGDA        DSORG=DA                 YM3925 52566502
         BZ    DAMV2150                 BR IF NO                 YM3070 52566702
*                                                                YM3070 52566802
         MVI   DCBDRDX,K0               INITIALIZE EXTENTS TO 0  YM3070 52566902
         EJECT                                                          52567532
*                                                                YM3070 52567632
DAMV2150 EQU   *                        CHECK AM DEPND PROCESS   YM3070 52567732
*                                                                YM3070 52567832
         CLC   WTGMODNM+K3(K3),DAMVEOV  TEST FOR EOV           @ZA02209 52567932
         BNE   DAMV2155                 NO, BR TO CONTINUE     @G18MSBS 52568032
         TM    DCBMACRF,DCBMEXCP        EXCP?                  @ZA02209 52568132
         BO    DAMV2155                 YES, BR TO CONTINUE    @G18MSBS 52568232
         TM    DCBCIND2,DCBC2PUT        TEST FOR EOV CALLED BY @ZA02209 52568332
*                                       CLOSE EXECUTORS WHEN   @ZA02209 52568432
*                                       FLUSHING THE BUFFERS   @ZA02209 52568532
         BZ    DAMV2155                 NO, BR TO CONTINUE     @G18MSBS 52568632
         L     RET,DCBDEBAD             GET DEB ADDRESS        @ZA02209 52568732
         OI    DEBFLGS1-DEBBASIC(RET),DEBF1CEV SET INDICATOR IN@ZA02209 52568832
*                                       DEB TO TELL CLOSE TO   @ZA02209 52568932
*                                       READ FORMAT1 DSCB      @ZA02209 52569032
*                                       ON NEW VOLUME          @ZA02209 52569132
         EJECT                                                          52569232
*                                                              @G18MSBS 52569332
***************************************************************@G18MSBS 52569432
*                                                              @G18MSBS 52569532
**       FOR JES3 MANAGED UNIT, OFFER VOLUME CHOICE TO JES3    @G18MSBS 52569632
**       FOR APPROVAL BEFORE CONTINUING                        @G18MSBS 52569732
*                                                              @G18MSBS 52569832
***************************************************************@G18MSBS 52569932
*                                                              @G18MSBS 52570032
DAMV2155 EQU   *                                               @G18MSBS 52570132
         TM    UCBJBNR,UCBJES3          DOES JES3 MANAGE UNIT? @G18MSBS 52570232
         BNO   DAMV2160                 NO, CONTINUE           @G18MSBS 52570332
         TM    UCBTBYT2,UCBRVDEV        YES, THEN VIRTUAL VOL? @G18MSBS 52570432
         BNO   DAMV2160                 NO, CONTINUE           @G18MSBS 52570532
         LA    RC,K4                    SET FINAL PASS SWITCH  @G18MSBS 52570632
         L     RF,JES3ROUT              GET JES3 ROUTINE ADDR  @G18MSBS 52570732
         BALR  RET,RF                   BRANCH TO JES3 ROUTINE @G18MSBS 52570832
         SPACE 3                                                        52570932
***************************************************************@G18MSBS 52571032
*        CHECK FOR PO BEFORE EXCP, DSORG FIELD EXISTS IN COPY    YM3925 52571132
*        EVEN IF NOT IN USERS DCB.                               YM3925 52571232
*                                                              @ZA02209 52571332
DAMV2160 EQU   *                                               @ZA02209 52571432
*                                                              @ZA02209 52571532
         TM    DCBDSORG,DCBDSGPO        TEST FOR BPAM DATA SET   YM3925 52571632
         BO    DAMV2300                 BRANCH IF BPAM           YM3925 52571732
*                                                                YM3925 52571832
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    Y02134 52571932
         BO    DAMV2200                 BRANCH IF EXCP           YM1228 52572032
*                                                                Y02134 52572132
         NC    DCBDSORG,DCBDSORG        CHECK IF DSORG SPECIFIED Y02134 52572232
         BZ    DAMV2200                 BRANCH 0, ASSUME PS      Y02134 52572332
*                                                                Y02134 52572432
         TM    DCBDSORG,DCBDSGPS        PHYSICAL SEQUENTIAL DCB  Y02134 52572532
         BNO   DAMV2300                 BRANCH IF NOT PS         Y02134 52572632
*                                                                Y02134 52572802
DAMV2200 EQU   *                        DSORG=PS                 YM1472 52573302
*                                                                Y02134 52573802
         CLC   WTGMODNM+K3(K3),DAMVEOV  CHECK FOR EOV            Y02134 52574302
         BNE   DAMV2210                 BRANCH IF NOT EOV        YM1108 52577402
*                                                                YM1108 52580502
         CLI   DXEXTSW,X04              CHECK IF DS EXTENDED     YM1174 52583602
         BE    DAMV3000                 BRANCH YES, CONTINUE     YM3925 52586702
*                                                                YM1108 52589802
         CLC   DXVOLSR2,SCRTCH          NON-SPECIFIC REQUEST     YM1108 52592902
         BNE   DAMV2400                 BRANCH IF SPECIFIC REQ   YM1108 52596002
         B     DAMV7500                 GET NEW VOLUME           YM6514 52599102
         EJECT                                                          52602202
*                                                                YM1108 52605302
DAMV2210 EQU   *                        TEST FOR DISP=MOD        YM1108 52608402
*                                                                Y02134 52611502
         TM    DXDCBLST,PLISTOIN        TEST FOR OUTPUT          YM1459 52614602
         BNO   DAMV2410                 BRANCH IF INPUT          YM1459 52617702
*                                                                YM1459 52620802
         TM    JFCBIND2-INFMJFCB(RD),JFCOLD NOT OLD OR NEW       Y02134 52623902
         BO    DAMV2410                 BRANCH IF NOT MOD        YM1108 52627002
         TM    DSCDSIND-DXDSCB(RB),X80  LAST VOLUME INDICATOR    Y02134 52630102
         BO    DAMV2410                 BRANCH IF LAST VOLUME    YM1108 52633202
         XR    RF,RF                    CLEAR REG FOR IC INST    Y02134 52636302
         IC    RF,JFCBNVOL              GET NUMBER OF VOLUMES    Y02134 52639402
         CH    RF,DXVOLSEQ              CHECK FOR LAST VOLUME    Y02134 52642502
         BNH   DAMV2410                 BRANCH IF LAST VOLUME    YM1108 52645602
         BCTR  RF,R0                    DECREMENT TO N-1 VOLUME  Y02134 52648702
         CH    RF,DXVOLSEQ              CHECK FOR N-1 VOLUME     Y02134 52651802
         BNH   DAMV2410                 ACCEPT IF N-1 VOLUME     YM1108 52654902
*                                                                Y02134 52658002
*****************************************************************Y02134 52661102
*                                                                Y02134 52664202
*        LAST VOLUME INDICATOR WAS NOT SET BEFORE RELEASE 17.    Y02134 52667302
*                                                                Y02134 52670402
*****************************************************************Y02134 52673502
*                                                                Y02134 52676602
         TM    DXEXTSW,ALLBITS          TEST FOR USE VOL FOR MOD Y02134 52679702
         BO    DAMV2410                 BRANCH, USE ANYWAY       YM1108 52682802
*                                                                Y02134 52685902
*****************************************************************Y02134 52689002
*                                                                Y02134 52692102
*        DISP=MOD ERROR RECOVERY                                 Y02134 52695202
*                                                                Y02134 52698302
*****************************************************************Y02134 52701402
*                                                                Y02134 52704502
         ST    RB,CORECH(,RB)           CHAIN FOR REUSE          Y02134 52707602
*                                                                Y02134 52710702
         IECRES LOAD,MODID=ID4C4A,BRCODE=K20,BRANCH=QUEUED       Y02134 52713802
         EJECT                                                          52716902
*                                                                Y02134 52720002
*****************************************************************Y02134 52721602
*                                                                Y02134 52722402
*        CHECK FOR ASCENDING VOLUME SEQUENCE NUMBER IN FORMAT 1  Y02134 52723202
*                                                                Y02134 52723302
*****************************************************************Y02134 52723402
*                                                                Y02134 52725402
DAMV2300 EQU   *                        DSORG NOT PS             YM1472 52725802
*                                                                Y02134 52726502
         CLC   DXVOLSEQ,DS1VOLSQ-DS1FMTID(RB) COMPARE VOL SEQ NO Y02134 52732802
         LA    R0,K6                    OPEN=03D-04 EOV=NA       Y02080 52735202
         BH    DAMV2360                 BR IF NOT SAME         @ZA09644 52737632
*                                                                Y02134 52738002
         TM    DSCFILTY-DXDSCB(RB),DCBDSGPO TEST FOR BPAM F1     YM7817 52738402
         BNO   DAMV2340                 BRANCH IF NOT PO         Y02134 52739702
*                                                                Y02134 52740002
         TM    DCBDSORG,DCBDSGPO        TEST FOR BPAM            YM7817 52740102
         LA    R0,K10                   OPEN=013-14 EOV=NA       Y02080 52740402
         BNO   DAMV9900                 BRANCH IF NOT SAME       Y02134 52740502
*                                                                Y02134 52740702
DAMV2340 EQU   *                        TEST FOR BDAM            YM1472 52741002
*                                                                Y02134 52741302
         TM    DCBDSORG,DCBDSGDA        TEST IF BDAM             Y02134 52742402
         BZ    DAMV2350                 BR IF NO                 Y02134 52744802
*                                                                Y02134 52747202
         SR    R0,R0                    GET NO. OF BDAM EXTENTS  Y02134 52749602
         IC    R0,DCBDRDX               SO FAR FROM DCB          Y02134 52752002
         SR    R1,R1                    GET BDAM EXTENTS ON THIS Y02134 52754402
         IC    R1,DS1NOEPV-DS1FMTID(,RB) VOL FROM FORMAT 1 DSCB  Y02134 52756802
         AR    R0,R1                    ADD TO CURRENT TOTAL     Y02134 52759202
         STC   R0,DCBDRDX               UPDATE COUNT IN DCB      Y02134 52761602
*                                                                Y02134 52764002
DAMV2350 EQU   *                        TEST FOR ISAM            YM1472 52766402
*                                                                Y02134 52768802
         TM    DCBDSORG,DCBDSGIS        TEST FOR ISAM            Y02134 52771202
         BNO   DAMV2400                 BRANCH IF NOT ISAM       YM1108 52773602
*                                                              @ZA09644 52774232
DAMV2355 EQU   *                                               @ZA09644 52774832
*                                                              @ZA09644 52775432
         MVC   DSCSCALO-DXDSCB(L'DSCSCALO,RB),DXUCBADR ISAM UCB  Y02134 52776002
         CLC   DXDSABAD,DXDSAB          COMPARE FIRST TO CURRENT Y02134 52778402
         BE    DAMV2400                 BR IF FIRST IS CURRENT   YM3807 52780802
         LA    R0,K11                   913-2C ERROR CODE        Y02082 52783202
         CLC   JFCBDSNM(L'JFCBDSNM),JFCBDSNM-INFMJFCB(RD) IS     Y02082 52783602
*                                       CURRENT DSN THE SAME AS  Y02082 52784002
*                                       THE FIRST JFCB'S         Y02082 52784402
         BNE   DAMV9900                 BRANCH IF NO TO ABEND    Y02082 52784802
         B     DAMV3000                 BRANCH TO CONTINUE       Y02082 52784902
         EJECT                                                 @ZA09644 52785232
*                                                              @ZA09644 52785332
***************************************************************@ZA09644 52785432
*                                                              @ZA09644 52785532
*      CHECK ISAM ASCENDING SEQUENCE NUMBER IN DSCB            @ZA09644 52785632
*                                                              @ZA09644 52785732
***************************************************************@ZA09644 52785832
*                                                              @ZA09644 52785932
DAMV2360 EQU   *                                               @ZA09644 52786032
*                                                              @ZA09644 52786132
         TM    DCBDSORG,DCBDSGIS        TEST FOR ISAM          @ZA09644 52786232
         BNO   DAMV9900                 NO, CONTINUE ABEND     @ZA09644 52786332
*                                                              @ZA09644 52786432
         CR    RB,RCORE                 TEST IF FIRST AREA     @ZA09644 52786532
         BE    DAMV9900                 YES, CONTINUE ABEND    @ZA09644 52786632
*                                                              @ZA09644 52786732
         LR    RB,RCORE                 GET FIRST ARE POINTER  @ZA09644 52786832
         LH    R0,DS1VOLSQ-DS1FMTID(,RB) GET VOLUME SEQUENCE   @ZA09644 52786932
*                                       NUMBER FROM FIRST DSCB @ZA09644 52787032
DAMV2370 EQU   *                                               @ZA09644 52787132
*                                                              @ZA09644 52787232
         AH    R0,ONE                   ADD ONE TO IT          @ZA09644 52787332
*                                                              @ZA09644 52787432
DAMV2380 EQU   *                                               @ZA09644 52787532
*                                                              @ZA09644 52787632
         NC    CORECH(K4,RB),CORECH(RB) IS THERE A NEXT AREA   @ZA09644 52787732
         BZ    DAMV2355                 NO, BR, DON'T ABEND    @ZA09644 52787832
         L     RB,CORECH(,RB)           POINT TO NEXT AREA     @ZA09644 52787932
         CLI   DXDSCB-DXDSCB(RB),CHAR1  IS IT A FMT 1 AREA     @ZA09644 52788032
         BNE   DAMV2390                 BRANCH IF NOT          @ZA09644 52788132
         CH    R0,DS1VOLSQ-DS1FMTID(,RB) IS VOLUME SEQUENCE    @ZA09644 52788232
*                                        NUMBER NEXT IN        @ZA09644 52788332
*                                        ASCENDING SEQUENCE    @ZA09644 52788432
         BE    DAMV2370                 YES, CHECK NEXT AREA   @ZA09644 52788532
         LA    R0,K6                    OPEN=03D-04, EOV=NA    @ZA09644 52788632
         B     DAMV9900                 BRANCH TO ABEND        @ZA09644 52788732
*                                                              @ZA09644 52788832
DAMV2390 EQU   *                                               @ZA09644 52788932
*                                                              @ZA09644 52789032
         LA    RB,L'JFCBDSNM(,RB)       INCREMENT PASSED KEY   @ZA09644 52789132
         B     DAMV2380                 CHECK NEXT AREA        @ZA09644 52789232
         EJECT                                                          52789332
*                                                                Y02134 52789432
*****************************************************************Y02134 52792802
*                                                                Y02134 52795202
*        CHECK EXPIRATION DATE                                   Y02134 52797602
*                                                                Y02134 52800002
*****************************************************************Y02134 52820002
*                                                                Y02134 52840002
DAMV2400 EQU   *                        EOV AND NON-PS ENTRY     YM1108 52841002
*                                                                YM1108 52842002
         CLC   DXVOLSR2,JFCBVOLS-INFMJFCB(RD) FIRST VOLUME       Y02134 52860002
         BNE   DAMV2500                 BR IF NOT FIRST VOLUME   Y02083 52880002
*                                       TO CHECK FOR SECURITY    Y02082 52882002
*                                                                Y02134 52884002
DAMV2410 EQU   *                        OPEN DSORG=PS ENTRY      YM1108 52888002
*                                                                Y02134 52892002
         TM    JFCBIND2-INFMJFCB(RD),JFCNEW CHECK FOR NEW        Y02134 52900002
         BO    DAMV2500                 BR IF NEW                Y02082 52920002
         TM    DXDCBLST,OUTPUT          INPUT OR RDBACK CHECK    Y02134 52940002
         BZ    DAMV2500                 BRANCH IF EITHER         Y02134 52960002
*                                                                Y02134 52980002
         L     RF,DOCVTD                 CVTDATE TO DXWORK2    @G60ASRB 53000060
         BALR  RET,RF                    CALL DATE ROUTINE     @G60ASRB 53050060
*                                                                Y02134 53500002
         CLC   DSCEXPDT-DXDSCB(K3,RB),DXWORK2+K1 BIN TO BIN VALU Y02134 53520002
         BNH   DAMV2500                 BR IF DATE HAS EXPIRED   Y02134 53540002
         EJECT                                                          53542002
*                                                                Y02134 53560002
*****************************************************************Y02134 53580002
*                                                                Y02134 53600002
*        GO TO ERROR ROUTINE TO WRITE EXPIRATION DATE            Y02134 53620002
*        ERROR MESSAGE TO THE OPERATOR, AND WAIT FOR             Y02134 53640002
*        HIS REPLY TO USE OR NOT USE THE DATA SET.               Y02134 53660002
*                                                                Y02134 53680002
*****************************************************************Y02134 53700002
*                                                                Y02134 53720002
DAMV2440 EQU   *                                                 Y02134 53724002
*                                                                Y02134 53728002
         MVC   DXRETMOD,ID4C4C          RETURN ID TO SAVE AREA   Y02134 53740002
         MVI   DXRETCOD,K8              SET RETURN INDICATOR     Y02134 53760002
*                                                                Y02134 53760102
         XC    DXWORK1,DXWORK1          SET REPLY AREA TO BLANKS Y02134 53760202
         LA    R1,DXWORK1               POINT TO REPLY AREA      Y02134 53760302
         LA    R0,K1                    SET REPLY LENGTH         Y02134 53760402
         SLL   R0,K24                   MOVE LENGTH TO HI BYTE   Y02134 53760502
         OR    R1,R0                    SET UP WTOR PARM         Y02134 53760602
         LA    R0,JFCBDSNM-INFMJFCB(,RD) GET DSNAME ADDRESS      Y02134 53760702
*                                                                Y02134 53786902
         IECRES LOAD,MODID=ID4C4J,BRCODE=K20,BRANCH=QUEUED       Y02134 53800002
*                                                                Y02134 53837602
*****************************************************************Y02134 53837702
*                                                                Y02134 53837802
*        RETURN HERE FROM EXPIRATION CHECK                       Y02134 53837902
*                                                                Y02134 53838002
*****************************************************************Y02134 53838102
*                                                                Y02134 53838202
DAMV2450 EQU   *                                                 Y02134 53838402
*                                                                Y02134 53839202
         IECRES WAIT                    WAIT FOR OPERATOR REPLY  Y02134 53839302
*                                                                Y02134 53839402
         OI    DXWORK1,BLANK            FOLD REPLY               Y02134 53841002
         CLI   DXWORK1,CHARU            CHECK FOR REPLY U        Y02134 53842602
         BE    DAMV2500                 BRANCH TO USE            Y02134 53844202
*                                                                Y02134 53845802
         CLI   DXWORK1,CHARM            CHECK IF REJECT          Y02134 53847402
         BNE   DAMV2440                 BRANCH, INCORRECT REPLY  Y02134 53849002
*                                                                Y02134 53850602
         B     DAMV7500                 BRANCH TO REJECT VOLUME  Y02134 53851402
         EJECT                                                          53851802
*                                                                Y02134 53853302
***************************************************************@Z40RSDH 53853632
*                                                              @Z40RSDH 53853932
*        TEST FOR RAC AUTHORIZATION                            @Z40RSDH 53854232
*                                                              @Z40RSDH 53854532
***************************************************************@Z40RSDH 53854832
DAMV2500 EQU   *                        RAC CHECK              @Z40RSDH 53855132
         L     RF,RACRTN                GET RAC ROUTINE        @Z40RSDH 53855432
         BALR  RET,RF                   CHK RAC AUTH TO D.S.   @Z40RSDH 53855732
*                                                              @Z40RSDH 53856032
*        RETURN CODE IN REG 15                                 @Z40RSDH 53856332
*        0     DATA SET RAC DEFINED - ENVIRONMENT OK           @Z40RSDH 53856632
*        4     DATA SET NOT RAC DEFINED                        @Z40RSDH 53856932
*        8     ERROR - ABCODE TBL OFFSET IN REG 0              @Z40RSDH 53857232
*                                                              @Z40RSDH 53857532
         B     DAMV2502(RF)             PROCESS RAC RETURN     @Z40RSDH 53857832
DAMV2502 EQU   *                        BRANCH TABLE           @Z40RSDH 53858132
         B     DAMV2550                 RAC OK - BYP PW        @Z40RSDH 53858432
         B     DAMV2504                 NO RAC - CHK PW        @Z40RSDH 53858732
         B     DAMV9900                 ABEND                  @Z40RSDH 53859032
*                                                              @Z40RSDH 53859332
*****************************************************************Y02134 53860002
*                                                                Y02134 53880002
*        TEST FOR PASSWORD NEEDED                                Y02134 53900002
*                                                                Y02134 53920002
*****************************************************************Y02134 53940002
*                                                                Y02134 53960002
DAMV2504 EQU   *                                               @Z40RSDH 53980032
*                                                                Y02134 54000002
         TM    DSCDSIND-DXDSCB(RB),DS1SECTY TEST IF PASSWORD REQ Y02134 54004002
         BNO   DAMV2550                 BRANCH IF NOT NEEDED     Y02083 54008002
         CLC   WTGMODNM+K3(K3),DAMVEOV  TEST FOR EOV             Y02082 54008102
         BE    DAMV2505                 GO TEST PASSWORD         Y02082 54008202
         TM    JFCBIND2-INFMJFCB(RD),JFCNEW IS DISP = NEW        Y02082 54008402
         BNO   DAMV2505                 BR IF NO                 Y02082 54008802
         TM    JFCBMASK+K5-INFMJFCB(RD),JFCBPWBP JFCB MODIFIED?  Y02082 54009202
         BNO   DAMV2555                 BR IF NO                 Y02083 54009602
*                                                                Y02082 54009802
         L     RF,ADDRTEST              GET ADDRESS OF TESTAUTH@G18MSBS 54010032
         BALR  RET,RF                   GO TEST AUTHORIZATION  @G18MSBS 54010132
*                                                                Y02082 54010402
         LTR   RF,RF                    WAS CALLER AUTHORIZED    Y02082 54010802
         BZ    DAMV2550                 BR IF YES                Y02083 54011202
*                                                                Y02082 54011402
DAMV2505 EQU   *                        DISP NOT NEW             Y02082 54011602
*                                                                Y02134 54012002
         TM    DSCDSIND-DXDSCB(RB),DS1WRSEC TEST IF WRITE ONLY   Y02134 54016002
         BZ    DAMV2510                 BRANCH IF NOT            Y02134 54016802
*                                                                Y02134 54017602
         TM    DXDCBLST,OUTPUT          INPUT OR RDBACK CHECK    Y02134 54020002
         BZ    DAMV2555                 BRANCH IF EITHER         Y02083 54040002
*                                                                Y02134 54740002
DAMV2510 EQU   *                        ASK OPERATOR FOR PASSWORDY02134 54744002
*                                                                Y02134 54748002
         OI    JFCBMASK+K4,JFCMPSWD     CHECK PASSWORD           YM7835 54750002
*                                                                       54752002
         MVC   DXRETMOD,ID4C4C          SET UP RETURN LOAD       Y02134 54756402
         MVI   DXRETCOD,K12             SET UP RETURN OFFSET     Y02134 54756502
*                                                                Y02134 54756602
         IECRES LOAD,MODID=ID4C5T,BRCODE=K12,BRANCH=QUEUED       Y02134 54756802
         EJECT                                                          54756902
*                                                                Y02083 54757002
*****************************************************************Y02083 54757102
*                                                                Y02083 54761602
*        CHECKPOINT DATA SET SECURITY PROCESSING                 Y02083 54763602
*                                                                Y02083 54765602
*****************************************************************Y02083 54766002
*                                                                Y02083 54766402
DAMV2550 EQU   *                        RESET PASSWORD BYPASS    YM3925 54768402
*                                                                YM3925 54770402
         NI    JFCBMASK+K5,ALLBITS-JFCBPWBP TURN OFF PW BYPASS   YM3925 54772002
*                                                                YM3925 54772402
DAMV2555 EQU   *                        CHECKPOINT PROCESSING    YM3925 54772802
*                                                                YM3925 54773202
         L     RD,DXDSAB                FETCH DSAB ADDRESS       Y02083 54791202
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP            YM1228 54793202
         BO    DAMV2557                 BRANCH EXCP TO ASSUME PS YM1228 54795202
         TM    DCBDSORG,DCBDSGPS        PHYSICAL SEQUENTIAL D/S  Y02083 54797202
         BO    DAMV2557                 IF PS, BRANCH            YM5957 54799202
         TM    DCBDSORG,DCBDSGPO        PARTITIONED D/S          YM5957 54799702
         BO    DAMV2640                 IF PO, BRANCH            YM5957 54800202
         LA    R0,K12                   ANTICIPATE 913-28 ABEND  YM5957 54800702
         TM    DSABFLG4-DSAB(RD),DSABCKDS TEST FOR CHKPT D/S     YM5957 54800802
         BO    DAMV2556                 IF CHKPT, SEE IF ERROR   YM5957 54800902
         TM    DSCDSIND-DXDSCB(RB),DSCBCKDS F1 INDICATE CHKPT    YM5957 54801002
         BO    DAMV2556                 IF CHKPT, SEE IF ERROR   YM5957 54801102
         B     DAMV3000                 CONTINUE                 YM5957 54801602
DAMV2556 EQU   *                        SEE IF USER IS AUTH      YM5957 54801702
         TM    DSABFLG4-DSAB(RD),DSABCKSI IS USER KNOWN NOT AUTH YM5957 54801902
         BO    DAMV9900                 IF YES, GO ABEND         YM5957 54802002
*                                                              @G18MSBS 54802432
         L     RF,ADDRTEST              GET ADDRESS OF TESTAUTH@G18MSBS 54802532
         BALR  RET,RF                   GO TEST AUTHORIZATION  @G18MSBS 54802632
*                                                              @G18MSBS 54802732
         LTR   RF,RF                    CHECK RETURN CODE        YM5957 54802832
         BNZ   DAMV9900                 IF NOT AUTH, GO ABEND    YM5957 54802932
*                                                                YM1228 54803032
DAMV2557 EQU   *                        PS CHECK FOR EOV OR OPEN YM1228 54803202
*                                                                YM1228 54805202
         CLC   WTGMODNM+K3(K3),DAMVEOV  TEST FOR EOV             Y02083 54807202
         BE    DAMV2610                 BR IF EOV FOR PS         Y02083 54809202
*                                                                Y02083 54829202
*        OPEN FOR PS D/S                                         Y02083 54831202
*                                                                Y02083 54833202
DAMV2570 TM    DSCDSIND-DXDSCB(RB),DSCBCKDS F1 INDICATE CHKPT    Y02083 54835202
         BO    DAMV2590                 IF YES, BRANCH           Y02083 54837202
DAMV2580 MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 54839202
         NI    DSABFLG4-DSAB(RD),X'FF'-DSABCKVL RESET            Y02083 54841202
*                                       DSAB CHKPT FLAGS         Y02083 54843202
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 54845202
         TM    DSABFLG4-DSAB(RD),DSABCKDS CHKPT DS               Y02083 54845602
         BNO   DAMV3000                 BRANCH IF NOT CHKPT      Y02083 54846002
         LA    RET,K52                  CAN VOL BE SECURED       YM3925 54848402
         L     RF,CHKPTWTO              GET MSG RTN ADDR         YM3925 54848802
         BALR  RC,RF                    ISSUE MESSAGE            YM3925 54848902
*                                                                YM3925 54849002
         BNE   DAMV3000                 BRANCH IF NOT SECURE     YM5957 54849802
         MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 54850202
         OI    DSABFLG4-DSAB(RD),DSABCKVL SET SECURE VOL FLAG    Y02083 54850302
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 54850402
         B     DAMV3000                 CONTINUE                 Y02083 54850602
DAMV2590 TM    DSABFLG4-DSAB(RD),DSABCKVL VOL ALREADY SECURE     Y02083 54851002
         BO    DAMV3000                 IF YES, CONTINUE         Y02083 54851202
         LA    RET,K56                  IS VOL SECURE            YM3925 54855602
         L     RF,CHKPTWTO              GET MSG RTN ADDR         YM3925 54856002
         BALR  RC,RF                    ISSUE MESSAGE            YM3925 54856402
*                                                                YM3925 54856802
         BNE   DAMV2580                 BRANCH IF NOT SECURE     YM3925 54857002
DAMV2600 MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 54861202
         OI    DSABFLG4-DSAB(RD),DSABCKDS+DSABCKVL SET CHKPT FLGSY02083 54863202
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 54865202
         B     DAMV3000                 CONTINUE                 Y02083 54867202
*                                                                Y02083 54869202
*        PS EOV PROCESSING                                       Y02083 54871202
*                                                                Y02083 54871902
DAMV2610 MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 54872302
         NI    DSABFLG4-DSAB(RD),X'FF'-DSABCKVL RESET SECURE     Y02083 54872402
*                                       VOLUME FLAG              Y02083 54872502
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 54872602
         TM    DSCDSIND-DXDSCB(RB),DSCBCKDS F1 INDICATE CHKPT    Y02083 54872802
         BZ    DAMV2620                 IF NOT, BRANCH           Y02083 54872902
         LA    RET,K56                  IS VOL SECURE            YM3925 54873002
         L     RF,CHKPTWTO              GET MSG RTN ADDR         YM3925 54873102
         BALR  RC,RF                    ISSUE MESSAGE            YM3925 54873202
*                                                                YM3925 54873302
         BE    DAMV2630                 BRANCH IF NOT SECURE     YM3925 54873402
DAMV2620 LA    R0,K10                   ANTICIPATE 937-10 ABEND  Y02083 54873802
         TM    DSABFLG4-DSAB(RD),DSABCKDS DSAB INDICATE CHKPT    Y02083 54873902
         BO    DAMV9900                 IF YES, IT'S AN ERROR    Y02083 54874002
*                                       VOLUME NOT SECURABLE     Y02083 54874102
         B     DAMV3000                 OTHERWISE, CONTINUE      Y02083 54874402
DAMV2630 LA    R0,K11                   ANTICIPATE 937-14 ABEND  Y02083 54874802
         TM    DSABFLG4-DSAB(RD),DSABCKDS DSAB INDICATE CHKPT    Y02083 54875202
         BZ    DAMV9900                 IF NOT, IT'S AN ERROR    Y02083 54875302
*                                       D/S USE IS NOT CONSISTANTY02083 54875602
*                                       WITH CHKPT STATUS        Y02083 54875702
         MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 54875802
         OI    DSABFLG4-DSAB(RD),DSABCKVL SET SECURE VOL FLAG    Y02083 54876102
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 54876202
         B     DAMV3000                 CONTINUE                 Y02083 54876302
*                                                                Y02083 54876602
*        PO OPEN PROCESSING                                      Y02083 54876702
*                                                                Y02083 54876802
DAMV2640 L     RF,DSABTIOT-DSAB(RD)     FETCH TIOT ENTRY ADDRESS Y02083 54876902
         CLI   TIOEDDNM-TIOENTRY(RF),BLANK CONCATENATED PO       Y02083 54877602
         BNE   DAMV2570                 IF NOT, BRANCH           Y02083 54878002
         L     RF,DSABBCHN-DSAB(RD)     FETCH PREVIOUS DSAB ADDR Y02083 54878402
         TM    DSABFLG4-DSAB(RF),DSABCKDS PREVIOUS CONCATENATED  Y02083 54878502
*                                       MEMBER A CHKPT D/S       Y02083 54878602
         BZ    DAMV2660                 IF NOT, BRANCH           Y02083 54878802
         TM    DSCDSIND-DXDSCB(RB),DSCBCKDS F1 INDICATE CHKPT    Y02083 54878902
         BZ    DAMV2670                 IF NOT, ISSUE 937-14     Y02083 54879002
         TM    DSABFLG4-DSAB(RD),DSABCKVL VOL ALREADY SECURE     Y02083 54879102
         BO    DAMV2650                 IF YES, SKIP ASKING OPER Y02083 54879302
         LA    RET,K56                  IS VOL SECURE            YM3925 54879402
         L     RF,CHKPTWTO              GET MSG RTN ADDR         YM3925 54879502
         BALR  RC,RF                    ISSUE MESSAGE            YM3925 54879602
*                                                                YM3925 54879702
         BNE   DAMV2670                 BRANCH IF NOT SECURE     YM3925 54879802
*                                       GO ISSUE 913-14 ABEND    Y02083 54880402
*                                       IF NOT SECURE            Y02083 54880502
DAMV2650 MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 54880602
         OI    DSABFLG4-DSAB(RD),DSABCKDS+DSABCKVL SET CHKPT FLGSY02083 54880702
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 54880802
         B     DAMV3000                 CONTINUE                 Y02083 54880902
DAMV2660 MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 54881002
         NI    DSABFLG4-DSAB(RD),X'FF'-DSABCKDS-DSABCKVL RESET   Y02083 54881102
*                                       CHKPT FLAGS              Y02083 54881302
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 54881702
         TM    DSCDSIND-DXDSCB(RB),DSCBCKDS F1 INDICATE CHKPT    Y02083 54882102
         BZ    DAMV3000                 IF NOT, CONTINUE         Y02083 54882302
         LA    RET,K56                  IS VOL SECURE            YM3925 54882402
         L     RF,CHKPTWTO              GET MSG RTN ADDR         YM3925 54882502
         BALR  RC,RF                    ISSUE MESSAGE            YM3925 54882602
*                                                                YM3925 54882702
         BNE   DAMV3000                 BRANCH IF NOT SECURE     YM3925 54882802
*                                       BRANCH IF NOT SECURE     Y02083 54883302
DAMV2670 LA    R0,K5                    SET 913-14 ABEND INDEX   Y02083 54883402
         B     DAMV9900                 GO ISSUE 913-14 ABEND    Y02083 54883502
         EJECT                                                          54887702
*                                                                Y02134 54887902
*****************************************************************Y02134 54888102
*                                                                Y02134 54888302
*        UPDATE ACCESSED DATE AND BACKUP COPY BIT.             @G60ASRB 54888460
*        READ IN ANY FORMAT 2 AND 3 DSCBS THAT DESCRIBE ISAM     Y02134 54888660
*        INFORMATION OR ADDITIONAL EXTENTS INTO ADDITIONAL       Y02134 54888702
*        GETMAINED CORE STORAGE.                                 Y02134 54888902
*                                                                Y02134 54892602
*****************************************************************Y02134 54896302
*                                                                Y02134 54900002
DAMV3000 EQU   *                                                 Y02134 54920002
*                                                                Y02134 54940002
         L     RF,DSCUPDA               UPDATE ROUTINE         @G60ASRB 54940160
         BALR  RET,RF                   CALL ROUTINE           @G60ASRB 54940260
*                                                              @G60ASRB 54940360
*        REG 15 CONTAINS 0 IF EXCP DONE IN THE UPDATE          @ZA32427 54940460
*        ROUTINE, AND 4 IF EXCP NOT DONE.                      @ZA32427 54940560
*                                                              @G60ASRB 54940660
         B     DAMV3001(RF)             DETERMINE PATH         @G60ASRB 54940760
DAMV3001 EQU   *                        BRANCH TABLE           @G60ASRB 54940860
         B     DAMV3002                 NO EXCP DONE           @ZA32427 54940960
         IECRES WAIT                                           @ZA32427 54941060
         TM    DXECB,ECBNOERR           CHECK I/O ERROR        @ZA32427 54941160
         BO    DAMV3002                 BRANCH IF NO           @ZA32427 54941260
         LA    R0,K24                   ABEND TABLE CODE       @ZA32427 54941360
         B     DAMV9900                 ABEND                  @ZA32427 54941460
*                                                              @G60ASRB 54941760
DAMV3002 EQU   *                                               @G60ASRB 54941860
*                                                              @G60ASRB 54942160
         XR    RD,RD                    CLEAR REG FOR IC INST    Y02072 54942402
         IC    RD,DSCNOEXT-DXDSCB(,RB)  GET NO. OF EXTENTS       Y02072 54943202
         CLI   DSCEXTYP-DXDSCB(RB),X40  CHECK FOR UL EXTENT      Y02134 54943602
         BNE   DAMV3005                 BRANCH IF NOT UL EXTENT  Y02134 54943702
         LA    RD,K1(,RD)               REFLECT UL EXTENT        Y02134 54943802
*                                                                Y02134 54943902
DAMV3005 EQU   *                        RD HAS NO. OF EXTENTS    YM1472 54944002
*                                                                Y02134 54944802
         SH    RD,THREE                 EXTENTS IN FORMAT 1      Y02072 54945202
         B     DAMV3020                 BRANCH TO READ F2 & F3   Y02134 54945602
         EJECT                                                          54945702
*                                                                Y02134 54946002
*****************************************************************Y02134 54947402
*                                                                Y02134 54948802
*        LOOP TO READ FORMAT 3 DSCB                              YM1472 54952002
*                                                                Y02134 54956002
*****************************************************************Y02134 54956802
*                                                                Y02134 54957602
DAMV3010 EQU   *                                                 Y02134 54959602
*                                                                Y02134 54959702
         LA    RB,L'JFCBDSNM(,RB)       INCREMENT PASSED KEY     Y02134 54959802
*                                                                Y02134 54961502
*****************************************************************Y02134 54961902
*                                                                Y02134 54962302
*        CHECK FOR MORE DSCB'S.                                  Y02134 54962702
*                                                                Y02134 54963102
*****************************************************************Y02134 54963702
*                                                                Y02134 54964302
DAMV3020 EQU   *                        LOOP TO READ F2 & F3     YM1472 54964902
*                                                                Y02134 54966602
         NC    DSCNEXT-DXDSCB(L'DSCNEXT,RB),DSCNEXT-DXDSCB(RB)   Y02134 54973302
         BZ    DAMV7000                 BRANCH IF NO MORE        Y02134 54980002
*                                                                Y02134 55040002
         MVC   DXDAADDR+K3(L'DSCNEXT),DSCNEXT-DXDSCB(RB) CCHHR   YM1472 55042002
*                                                                YM1472 55044002
         LA    R0,DSCBLNG+K4            LENGTH OF DSCB + PTR     Y02134 55120002
*                                                              @G18MSBS 55140032
         L     RF,ADDRF2F3              GET ADDRESS OF GETF2F3 @G18MSBS 55150032
         BALR  RET,RF                   GO GET F2F3 WORKAREA   @G18MSBS 55160032
*                                                                Y02134 55180002
         LA    R1,DXDSCB-DXDSCB(,R1)    CLEAR HIGH ORDER BYTE    Y02134 55200002
         ST    R1,CORECH(,RB)           CHAIN TO PREVIOUS CORE   Y02134 55220002
         LR    RC,RB                    SAVE LAST AREA PTR       YM1472 55222002
         LR    RB,R1                    LOAD DSCB BUFFER ADDR    Y02134 55240002
         EJECT                                                          55242002
*                                                                Y02134 55244002
*****************************************************************Y02134 55248002
*                                                                Y02134 55260002
*        MODIFY CCW TO READ NEXT FORMAT 2 OR 3 DSCB KEY & DATA   Y02134 55280002
*                                                                Y02134 55300002
*        SEARCH ID EQ                                            Y02134 55320002
*        TIC *-8                                                 Y02134 55340002
*        READ KEY & DATA                                         Y02134 55360002
*                                                                Y02134 55380002
*****************************************************************Y02134 55384002
*                                                                Y02134 55388002
         XC    DXCCW1(K16),DXCCW1       CLEAR CCW CORE         @ZA03658 55388232
         LA    RF,DXDAADDR+K3           SEARCH ADDR            @ZA03658 55388432
         ST    RF,DXCCW1                                       @ZA03658 55388632
         LA    RF,DXCCW1                TIC ADDR               @ZA03658 55388832
         ST    RF,DXCCW2                                       @ZA03658 55389032
         OC    DXCCW1(K16),ODA7440K     INIT CCWS              @ZA03658 55389232
DAMV3025 EQU   *                        READ NEXT DSCB           YM1472 55390002
*                                                                YM1472 55392002
         XC    DXCCW3,DXCCW3            CLEAR CCW                YM1472 55394002
         ST    RB,DXCCW3                DSCB BUFFER ADDRESS      YM1472 55420002
         OC    DXCCW3,ODA0630K          READ KEY & DATA/96 BYTES YM1472 55440002
*                                                                Y02134 55460002
         EXCP  DXIOB                    READ FORMAT 2 OR 3 DSCB  Y02134 55480002
*                                                                Y02134 55500002
         IECRES WAIT                    WAIT FOR READ COMPLETE   Y02134 55520002
*                                                                Y02134 55540002
         TM    DXECB,ECBNOERR           CHECK FOR I/O ERROR      Y02134 55560002
         LA    R0,K4                    OPEN=313-04 EOV=737-1C   Y02134 55570002
         BNO   DAMV9900                 BRANCH IF ERROR          Y02134 55580002
*                                                                Y02134 55580102
         CLC   DSCNEXT-DXDSCB(L'DSCNEXT,RC),L'JFCBDSNM+DSCNEXT-DXDSCB(RB55580302
               B)                       TEST FOR DSCB LOOP       YM1472 55580402
         LA    R0,K4                    OPEN=313-04 EOV=737-1C   YM1472 55580502
         BE    DAMV9900                 BRANCH IF IN LOOP        YM1472 55580602
*                                                                YM1472 55580702
         C     RB,CORECH(RCORE)         TEST FOR FIRST AREA      YM1472 55581602
         BNE   DAMV3030                 BRANCH IF NOT            YM1472 55581702
*                                                                YM1472 55581802
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP            YM1472 55581902
         BO    DAMV3030                 BR IF EXCP               YM1228 55582002
         TM    DCBDSORG,DCBDSGIS        TEST FOR ISAM            YM1472 55582102
         BNO   DAMV3030                 BRANCH IF NOT ISAM       YM1472 55582202
*                                                                YM1472 55582302
         LA    R0,K7                    OPEN=03D-08 EOV=NA       YM1228 55582402
         CLI   L'JFCBDSNM(RB),CHAR2     TEST FOR FORMAT 2        Y02134 55582502
         BNE   DAMV9900                 BRANCH IF NOT F2         YM1472 55582602
         B     DAMV3010                 BRANCH IF NO ERROR       Y02134 55593102
*                                                                YM1472 55593502
*****************************************************************YM1472 55593902
*                                                                YM1472 55594302
*        CHECK FOR FORMAT 2 AND NOT DSORG=IS                     YM1472 55594702
*                                                                YM1472 55594802
*****************************************************************YM1472 55595102
*                                                                Y02134 55595502
DAMV3030 EQU   *                        CHECK F3 EXTENTS         Y02134 55595902
*                                                                Y02134 55597302
         CLI   L'JFCBDSNM(RB),CHAR2     TEST FOR FORMAT 2        YM1472 55597702
         BNE   DAMV3035                 BRANCH TO CHECK FOR F3   YM1472 55598102
*                                                                YM1472 55598202
         LA    R0,K15                   OPEN = 03D-0C  EOV=NA  @ZA02225 55598632
         TM    DCBDSORG,DCBDSGDA        TEST IF BDAM           @ZA02225 55598732
         BO    DAMV9900                 IF YES,ERROR           @ZA02225 55598832
*                                                              @ZA02225 55598932
         NC    L'JFCBDSNM+DSCNEXT-DXDSCB(L'DSCNEXT,RB),L'JFCBDSNM+DSCNEX55599032
               XT-DXDSCB(RB)            TEST FOR MORE DSCBS      YM1472 55599132
         BZ    DAMV3060                 BRANCH IF NO MORE        YM1472 55599402
*                                                                YM1472 55599502
         MVC   DXDAADDR+K3(L'DSCNEXT),L'JFCBDSNM+DSCNEXT-DXDSCB(RB)     55599702
*                                       MOVE IN F3 CCHHR         YM1472 55600102
         B     DAMV3025                 BRANCH TO READ F3        YM1472 55600802
*                                                                YM1472 55601002
*****************************************************************YM1472 55601102
*                                                                YM1472 55601202
*        CHECK FOR SPLIT CYLINDER EXTENTS IN FORMAT 3            YM1472 55601302
*                                                                YM1472 55601402
*****************************************************************YM1472 55601802
*                                                                YM1472 55602202
DAMV3035 EQU   *                        CHECK FOR F3 DSCB        YM1472 55602302
*                                                                YM1472 55602402
         CLI   L'JFCBDSNM(RB),CHAR3     TEST FOR FORMAT 3        Y02134 55602502
         LA    R0,K4                    OPEN=313-04 EOV=737-1C   Y02134 55602602
         BNE   DAMV9900                 BRANCH IF NOT F3         Y02134 55602702
*                                                                Y02134 55602802
         LTR   RD,RD                    IS THERE ANOTHER EXT?    YM1472 55602902
         BNP   DAMV3060                 NO - CONTINUE            YM1472 55603302
*                                                                Y02134 55603802
         LA    RC,K4                    NO. OF EXTS IN FMT3 KEY  Y02072 55604302
         LR    R1,RB                    SAVE F3 POINTER          Y02134 55605702
*                                                                Y02134 55607102
DAMV3040 EQU   *                        LOOP FOR EXTENTS IN KEY  YM1472 55608502
*                                                                Y02134 55609902
         LTR   RD,RD                    IS THERE ANOTHER EXT?    Y02072 55611302
         BNP   DAMV7000                 NO - CONTINUE            YM1472 55612702
*                                                                Y02134 55614102
         CLI   DSCBEXTY-DSCBF3C(R1),X80 IS THIS A SPLIT CYLINDER?Y02072 55615502
         LA    R0,K9                    OPEN=213-24 EOV=C37-08   Y02134 55615902
         BE    DAMV9100                 YES - GO TO PROB DET     Y02072 55617502
*                                                                Y02072 55619502
         LA    R1,L'DSCEXT1(,R1)        INCREMENT TO NEXT EXT    Y02072 55620102
         BCTR  RD,R0                    DECREMENT EXTENT COUNT   Y02072 55622202
         BCT   RC,DAMV3040              CHECK ALL EXTS           Y02072 55626702
         EJECT                                                          55627102
*                                                                Y02072 55627202
         LA    RC,K9                    NO. OF EXTS IN RECORD    Y02072 55630702
*                                                                Y02134 55641002
DAMV3050 EQU   *                        LOOP FOR EXTENTS IN F3   YM1472 55643002
*                                                                Y02134 55645002
         LTR   RD,RD                    IS THERE ANOTHER EXT?    Y02072 55645402
         BNP   DAMV7000                 NO - CONTINUE            YM1472 55645802
*                                                                Y02134 55646202
         CLI   DSCBEXTY-DSCBF3C+L'DSCBFMID(R1),X80 SPLIT CYLINDR Y02072 55646302
         LA    R0,K9                    OPEN=213-24 EOV=C37-08   Y02134 55646702
         BE    DAMV9100                 YES - GO TO PROB DET     Y02072 55646802
*                                                                Y02072 55646902
         LA    R1,L'DSCEXT1(,R1)        INCREMENT TO NEXT EXT    Y02072 55648502
         BCTR  RD,R0                    DECREMENT EXTENT COUNT   Y02072 55650502
         BCT   RC,DAMV3050              CHECK ALL EXTS           Y02072 55650902
         B     DAMV7000                 BRANCH IF NO ERROR       YM1472 55651802
*                                                                YM1472 55652202
DAMV3060 EQU   *                        CLEAR LAST CHAIN PTR     YM1472 55652602
*                                                                YM1472 55653002
         XC    CORECH(K4,RC),CORECH(RC) CLEAR CHAIN PTR          YM1472 55653102
         B     DAMV7000                 EXIT                     YM1472 55653202
         EJECT                                                          55653402
*                                                                Y02134 55658002
*****************************************************************Y02134 55663502
*                                                                Y02134 55669002
*        ISAM VOLUME SPECIFIED ALREADY MOUNTED AND               Y02134 55674502
*        EXTENTS SPECIFIED ELSEWHERE.                            Y02134 55680002
*                                                                Y02134 55760002
*****************************************************************Y02134 55780002
*                                                                Y02134 55800002
DAMV6000 EQU   *                                                 Y02134 55820002
*                                                                Y02134 55840002
         LA    RF,K1                    LOAD DECREMENT VALUE     Y02134 55860002
*        SHIFT DECREMENT TO USE WITH CS INSTRUCTION              Y02134 55880002
         SLL   RF,K24-(K8*((UCBDMCT-UCBOB)-(((UCBDMCT-UCBOB)/K4)*K4)))  55900002
         L     R0,UCBOB+(((UCBDMCT-UCBOB)/K4)*K4) ALLIGN & LOAD  Y02134 55920002
*                                                                Y02134 55948002
DAMV6010 EQU   *                        LOOP FOR CS              Y02134 55960002
*                                                                Y02134 55980002
         LR    RET,R0                   SAVE CS OPERAND          Y02134 56000002
         SLL   RET,K25                  LEAVE ONLY UCBDMCT COUNT Y02134 56020002
         LTR   RET,RET                  TEST FOR COUNT OF 0      Y02134 56024002
         BZ    DAMV6020                 BRANCH IF ALREADY 0      Y02134 56028002
*                                                                Y02134 56032002
         LR    R1,R0                    LOAD OLD VALUE TO MODIFY Y02134 56040002
         SR    R1,RF                    ADD DECREMENT TO COUNT   Y02134 56060002
*                                                                Y02134 56064002
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 56068002
         CS    R0,R1,UCBOB+(((UCBDMCT-UCBOB)/K4)*K4) UPDAT COUNT Y02134 56080002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 56084002
*                                                                Y02134 56088002
         BNE   DAMV6010                 BRANCH IF NOT THE SAME   Y02134 56100002
*                                                                Y02134 56104002
DAMV6020 EQU   *                        DECREMENT COMPLETE       Y02134 56108002
*                                                                YM1472 56110002
         EJECT                                                          56110402
*                                                                Y02134 56112002
*****************************************************************Y02134 57500002
*                                                                Y02134 57520002
*        RETURN TO IFG0194A TO PARALLEL MOUNT                    Y02134 57540002
*        OR LOOK AHEAD MOUNT.                                    Y02134 57560002
*                                                                Y02134 57580002
*****************************************************************Y02134 57600002
*                                                                Y02134 57620002
DAMV7000 EQU   *                                                 Y02134 57640002
*                                                                Y02072 57641002
         LH    RF,DXUNITOF              GET UNIT OFFSET IN TIOT  Y02134 57712002
         AR    RF,RTIOT                 ADD OFFSET TO ENTRY      Y02134 57714002
         MODESET EXTKEY=SUPR            TIOT/UCB KEY             Y02082 57716002
         OI    TIOESTTB-TIOESTTB(RF),TIOSUSED DATA SET ON DEVICE Y02134 57718002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 57718402
*                                                                Y02134 57718802
         IECRES LOAD,MODID=ID4C4A,BRCODE=K12,BRANCH=QUEUED       Y02134 57719002
         EJECT                                                          57719402
*                                                                Y02134 57720002
*****************************************************************Y02134 57724002
*                                                                Y02134 57728002
*        RETURN TO IFG0194A TO REJECT VOLUME.                    Y02134 57732002
*                                                                Y02134 57736802
*****************************************************************Y02134 57737602
*                                                                Y02134 57738402
DAMV7500 EQU   *                                                 Y02134 57739202
*                                                                Y02134 57739302
         LA    R0,K13                   OPEN= 713-08 EOV= 737-08 YM6514 57743502
         B     DAMV9900                 DETERMINE ABEND CODE     YM6514 57743602
*                                                                YM1472 57743702
DAMV7510 EQU   *                        ENTRY WITH CODE IN R0    YM1472 57744302
*                                                                YM1472 57744702
         CLC   UCBVOLI,ZEROS            CHECK FOR WRONG VOLUME   YM7396 57745102
         BNZ   DAMV7520                 BYPASS REJECT SWITCH     YM7396 57745202
*                                                                YM7396 57748102
         XR    R0,R0                    CLEAR FOR REJECT         YM7396 57748502
*                                                                YM7396 57748602
DAMV7520 EQU   *                        RETURN TO ABEND OR REJECTYM7396 57750602
*                                                                YM7396 57752602
         ST    RB,CORECH(,RB)           CHAIN FOR REUSE          Y02134 57752802
         MVC   DXRETMOD,DXSAVMOD        SAVE RETURN LOAD         Y02134 57756202
         MVC   DXRETCOD,DXSAVOFF        SAVE RETURN OFFSET       Y02134 57759602
*                                                                Y02134 57763002
         IECRES LOAD,MODID=ID4C4A,BRCODE=K16,BRANCH=QUEUED       Y02134 57766402
*                                                                Y02134 57769802
*****************************************************************Y02134 57773202
*                                                                Y02134 57776602
*        REJECT WRONG VOLUME MOUNTED.                            Y02134 57780002
*                                                                Y02134 57800002
*****************************************************************Y02134 57820002
*                                                                Y02134 57840002
DAMV8000 EQU   *                                                 Y02134 57860002
*                                                                Y02134 57880002
         TM    UCBDMCT,UCBDMC-K1        TEST FOR ONE USER        YM1472 57890002
         BNZ   DAMV7500                 BRANCH, MORE THAN 1 USER YM1472 57892002
         TM    UCBSTAB,UCBBSVL          TEST FOR SHAREABLE       YM1472 57894002
         BZ    DAMV7500                 BRANCH IF SHAREABLE UNIT YM1472 57896002
*                                                                YM1472 57898002
         MVC   DXRETMOD,ID4C4C          RETURN ID TO SAVE AREA   Y02134 57900002
         MVI   DXRETCOD,K4              SET RETURN INDICATOR     Y02134 57920002
*                                                                Y02134 57940002
         IECRES LOAD,MODID=ID4C4J,BRCODE=K4,BRANCH=QUEUED        Y02134 57960002
         EJECT                                                          58280002
*                                                                Y02134 59680002
*****************************************************************Y02134 59700002
*                                                                Y02134 59720002
*        AN ERROR HAS BEEN DETECTED.                             Y02134 59740002
*                                                                Y02134 59760002
*****************************************************************Y02134 59780002
*                                                                       59800002
DAMV9000 DMABCOND PCK,SETLOCK           SETLOCK ERROR ROUTINE    Y02134 59810002
*                                                                Y02080 59862802
*****************************************************************Y02134 59864002
*                                                                Y02134 59866002
*        213 ABEND EXIT ROUTINE                                  Y02134 59866402
*                                                                Y02134 59868002
*****************************************************************Y02134 59868402
*                                                                Y02134 59868502
DAMV9100 EQU   *                                                 Y02080 59868602
*                                                                Y02134 59868802
         MVI   DXWORK,K213              SET 213 CODE             Y02134 59878802
         B     DAMV9901                 BRANCH TO ERROR ROUTINE  Y02134 59888802
*                                                                Y02080 59910002
*****************************************************************Y02134 59912002
*                                                                Y02134 59914002
*        GO TO PROBLEM DETERMINATION                             YM3111 59916002
*                                                                Y02134 59918002
*****************************************************************Y02134 59918402
*                                                                Y02134 59918502
DAMV9900 EQU   *                        REGULAR ENTRY            Y02080 59918602
*                                                                Y02134 59918802
         MVI   DXWORK,K0                SET 213 SWITCH OFF       Y02134 59918902
*                                                                Y02134 59919002
DAMV9901 EQU   *                        213 ABEND ENTRY          Y02080 59919102
*                                                                Y02134 59919202
         L     RF,ABEND                 EPA OF INTERFACE ROUTINE YM3070 59921202
         BR    RF                       BRANCH, GET INTERNAL CDE YM3070 59923202
         EJECT                                                          59927202
*                                                                       59998402
*********************************************************************** 60000002
*                                                                       60002902
*        CONSTANTS                                                      60008602
*                                                                       60014302
*********************************************************************** 60020002
*                                                                       60040002
ISAMRTN  DC    A(DAMV2103)                                     @ZA26665 60041032
RACRTN   DC    A(DAMV4500)              RAC ROUTINE            @Z40RSDH 60043432
CHKPTWTO DC    A(DAMV4000)              CHECKPOINT MSG ROUTINE   YM3925 60044432
CHKPTRET DC    A(DAMV4010)              CHECKPOINT WTOR RETURN   YM3925 60045432
JES3ROUT DC    A(DAMV5000)              JES3 INTERFACE ROUTINE @G18MSBS 60046432
IECPRLTV DC    A(DAMV8800)              IECPRLTV INTERFACE RTN   YM3070 60047432
IECPCNVT DC    A(DAMV8900)              IECPCNVT INTERFACE RTN   YM3070 60048760
ABEND    DC    A(DAMV9999)              PROB DET INTERFACE RTN   YM3070 60049432
ADDRF1   DC    A(GETF1)                 IECRES GET FOR F1 DSCB @G18MSBS 60050432
ADDRF2F3 DC    A(GETF2F3)               IECRES GET FOR F2/F3   @G18MSBS 60051432
ADDRCCWS DC    A(GETCCWS)               IECRES GET FOR CCW'S   @G18MSBS 60052432
ADDRFREE DC    A(FREECCWS)              IECRES FREE FOR CCW'S  @G18MSBS 60053432
ADDRTEST DC    A(DAMVTEST)              TEST AUTHORIZED USER   @G18MSBS 60054432
DSNOTFA  DC    A(DSNOTFND)              DSCB-NOT-FOUND ROUTINE @G60ASRB 60054660
DSCUPDA  DC    A(DSCUPD)                UPDATE DSCB ROUTINE    @G60ASRB 60054860
DOCVTD   DC    A(DOCVTDTE)              CONVERT CVT DATE RTN.  @G60ASRB 60055060
ENQLIST  DC    A(0)                     ENQ LIST                 Y02134 60055432
         ENQ   (SYSZVOLS,,E,6,SYSTEM),TCB=,RET=USE,MF=L          Y02134 60056432
DASSOBID DC    CL4'SSOB'                SSOB HEADER ID         @G18MSBS 60057432
SYSZVOLS DC    CL8'SYSZVOLS'            ENQ VOL SER MAJOR NAME   Y02134 60060002
SCRTCH   DC    CL6'SCRTCH'              SCRTCH REQUEST NAME      Y02134 60080002
KNO      DC    C'NO '                   WTOR REPLY COMPARAND     Y02083 60090002
KYES     DC    C'YES'                   WTOR REPLY COMPARAND     Y02083 60092002
BLANKS   DC    CL6' '                   BLANK VOLUME SERIAL NO.  Y02134 60100002
ZEROS    DC    XL6'00'                  ZERO VOLUME SERIAL NO.   Y02134 60120002
DAMVEOV  DC    CL3'055'                 EOV MOD ID               Y02134 60140002
ONE      DC    H'1'                     CONSTANT OF ONE          Y02134 60144002
THREE    DC    H'3'                     CONSTANT OF THREE        Y02072 60144402
         EJECT                                                          60214002
*                                                                Y02134 60218602
*********************************************************************** 60223202
*                                                                Y02134 60227802
*        CCW'S TO READ VOLUME LABEL                              Y02134 60232402
*                                                                Y02134 60237002
*********************************************************************** 60241602
*                                                                Y02134 60246202
ODA7440K DC    X'3100000040000005'      SEARCH ID EQ             Y02134 60250802
         DC    X'0800000000000000'      TIC *-8                  Y02134 60255402
         DC    X'0600000000000050'      READ DATA                Y02134 60260002
*                                                                Y02134 60450002
*********************************************************************** 60452002
*                                                                Y02134 60460002
*        CCW'S TO READ FORMAT 1 OR 4 DSCB DIRECTLY.              Y02134 60480002
*                                                                Y02134 60490002
*********************************************************************** 60492002
*                                                                Y02134 60500002
ODA0630K CCW   CCWRDKEY,K0,K0,DSCBLNG   READ KEY AND DATA        YM1472 60502002
*                                                                YM1472 60504002
ODA0640K DC    X'3100000040000005'      SEARCH ID EQ             Y02134 60520002
         DC    X'0800000000000000'      TIC *-8                  Y02134 60540002
         DC    X'290000004000002C'      SEARCH KEY EQ            Y02134 60560002
         DC    X'0300000020000001'      NOP  (NO CHAIN, SLI)     Y02134 60580002
         DC    X'0600000000000060'      READ DATA (DSCB)         Y02134 60600002
*                                                                Y02134 60620002
ODA0650K CCW   CCWMTSID,K0,CCWCMDCH+CCWSILI,K5 CCWS TO FIND F1   Y02082 60625002
         CCW   CCWTIC,K0,K0,K0                                   Y02082 60630002
         CCW   CCWSCHKE,K0,CCWCMDCH+CCWSILI,L'JFCBDSNM           Y02134 60635002
         CCW   CCWNOP,K0,CCWSILI,K1                              Y02082 60636002
         CCW   CCWTIC,K0,K0,K0                                   Y02082 60637002
         CCW   CCWSCHKE,K0,CCWCMDCH+CCWSILI,L'JFCBDSNM           Y02134 60638002
         CCW   CCWTIC,K0,K0,K0                                   Y02082 60639002
         CCW   CCWRDDA,K0,CCWCMDCH,K96                           Y02082 60639202
         CCW   CCWRDCNT,K0,K0,K8                                 Y02082 60639402
*                                                                Y02134 60639802
ODA0660K DC    X'7FFF'                  MAX NO. TRACKS IN EXTENT Y02134 60640002
ODA0670K DC    44X'04'                  KEY OF FORMAT 4 DSCB   @ZA33308 60660032
*                                                                Y02134 60680002
         EJECT                                                          60690002
         XCTLTABL ID=(ID4C0P,0P,ID4C4C,4C,ID4C4A,4A,ID4C4J,4J,   Y02134X60700002
               ID4C5T,5T,ID4C5G,5G,,IFG0554P),                   Y02134X60720002
               SVC=019,BRT=SHORT,LENGTH=4K                       YM3070 60730002
         EJECT                                                          60730402
*                                                                YM3925 60730802
***************************************************************@ZA26665 60731232
*       SETUP 03D-08 ABEND IF ISAM AND NO NEXT DSCB            @ZA26665 60731332
***************************************************************@ZA26665 60731432
*                                                              @ZA26665 60731532
DAMV2103 EQU   *                                               @ZA26665 60731632
         TM    DCBDSORG,DCBDSGIS        TEST FOR ISAM          @ZA26665 60731732
         BNO   DAMV2105                 BR IF NOT ISAM         @ZA26665 60731832
         LA    R0,K7                    OPEN=03D-08            @ZA26665 60731932
         NC    DSCNEXT,DSCNEXT          NEXT DSCB ?            @ZA26665 60732032
         BZ    DAMV9900                 NO BR TO ERROR         @ZA26665 60732132
         BR    RET                      RETURN                 @ZA26665 60732232
*                                                              @ZA26665 60732332
*****************************************************************YM3925 60732432
*                                                                YM3925 60732532
*        ISSUE CHECKPOINT MESSAGES                               YM3925 60734002
*                                                                YM3925 60734402
*        ON ENTRY -                                              YM3925 60734502
*        RC = RETURN ADDRESS                                     YM3925 60734802
*        RF = ENTRY ADDRESS                                      YM3925 60735202
*        R0,R1 = VOLATILE                                        YM3925 60735602
*        RET = 52 - CAN VOLUME BE MADE SECURE FOR CHECKPOINT     YM3925 60735702
*              56 - IS THE VOLUME A SECURE CHECKPOINT VOLUME     YM3925 60735802
*                                                                YM3925 60735902
*        ON RETURN -                                             YM3925 60736202
*        CC=8 (ZERO) MEANS SECURE VOLUME                         YM3925 60736302
*                                                                YM3925 60736502
*****************************************************************YM3925 60736802
*                                                                YM3925 60737102
DAMV4000 EQU   *                        CHECKPOINT MSGS          YM3925 60737402
*                                                                YM3925 60737702
         USING *,RF                     ESTABLISH ADDRESSABILITY YM3925 60738102
         STC   RET,DXWORK1              SAVE WTOR OFFSET         YM3925 60739702
         ICM   RC,B'1000',DXWORK1       RETREIVE OFFSET          YM3925 60741702
*                                                                YM3925 60741802
         MVC   DXWORK1(L'KYES),KYES     SET UP VIO REPLY         YM3925 60741902
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO DATA SET    YM3925 60742102
         BO    DAMV4020                 BRANCH IF VIO DATA SET   YM3925 60742502
         DROP  RF                                                YM3925 60742602
*                                                                YM3925 60742802
         XC    DXWORK1,DXWORK1          CLEAR WTOR REPLY AREA    YM3925 60743002
         LA    R1,DXWORK1               POINT TO REPLY AREA      YM3925 60743102
         LA    R0,K3                    SET REPLY LENGTH         YM3925 60743202
         SLL   R0,K24                   MOVE LENGTH TO HI BYTE   YM3925 60743302
         OR    R1,R0                    SET UP WTOR PARM         YM3925 60743402
*                                                                YM3925 60743602
         MVC   DXRETMOD,ID4C4C          SET RETURN NAME & EPA    YM3925 60743802
         MVI   DXRETCOD,K16             SET BR TABLE RETURN CODE YM3925 60744002
         IECRES LOAD,MODID=ID4C4J,BRCODE=(14),BRANCH=QUEUED      YM5957 60744802
*                                                                YM3925 60745402
*****************************************************************YM3925 60745802
*                                                                YM3925 60746202
*        RETURN HERE WITH OPERATOR REPLY                         YM3925 60746602
*                                                                YM3925 60747002
*****************************************************************YM3925 60747102
*                                                                YM3925 60747202
DAMV4010 EQU   *                        WTOR RETURN              YM3925 60747302
*                                                                YM3925 60747902
         IECRES WAIT                    WAIT FOR REPLY           YM3925 60748702
*                                                                YM3925 60749102
         USING *,RET                    ESTABLISH ADDRESSABILITY YM3925 60749202
         OC    DXWORK1,BLANKS           FOLD REPLY TO UPPER CASE YM3925 60749302
         CLC   KYES,DXWORK1             CHECK CORRECT REPLY      YM3925 60749402
         BE    DAMV4020                 BRANCH TO SET CODE       YM3925 60749502
         CLC   KNO,DXWORK1              CHECK CORRECT REPLY      YM3925 60749702
         BE    DAMV4020                 BRANCH TO SET CODE       YM3925 60750502
         L     RF,CHKPTWTO              GET MSG RTN ADDRESS      YM3925 60750602
         LR    RET,RC                   GET OFFSET IN HI BYTE    YM3925 60750702
         SRL   RET,K24                  SHIFT TO LOW BYTE        YM3925 60750802
         BR    RF                       RE-ISSUE MSG             YM3925 60752602
*                                                                YM3925 60754602
DAMV4020 EQU   *                        SET RETURN CODE          YM3925 60754702
*                                                                YM3925 60755302
         CLC   KYES,DXWORK1             REPLY = 'YES'            YM3925 60756002
         BR    RC                       RETURN                   YM3925 60756602
         DROP  RET                                               YM3925 60758402
         EJECT                                                 @Z40RSDH 60760232
*********************************************************************** 60760332
*                                                                     * 60760432
*        RAC VERIFICATION ROUTINE                                     * 60760532
*                                                                     * 60760632
*********************************************************************** 60760732
*                                                                     * 60760832
*        REG   CONTENTS AT ENTRY                                      * 60760932
*        2     PTR DCB COPY                                           * 60761032
*        4     WORK AREA ADDR                                         * 60761132
*        6     WTG TABLE                                              * 60761232
*        7     CURRENT PARM LIST ENTRY                                * 60761332
*        A     CURRENT UCB ADDRESS                                    * 60761432
*        B     CURRENT F1 DSCB AREA                                   * 60761532
*        D     CURRENT JFCB ADDR                                      * 60761632
*        E     RETURN ADDR                                            * 60761732
*        F     ENTRY POINT                                            * 60761832
*                                                                     * 60761932
*        THIS ROUTINE PERFORMS ALL CHECKS FOR RAC ON DASD DATA @Z40RSDH 60762032
*        SETS.                                                 @Z40RSDH 60762132
*              1. CHECK THE CURRENT ENVIRONMENT'S AUTHORIZATION@Z40RSDH 60762232
*                 TO RAC DEFINED DATA SETS.                    @Z40RSDH 60762332
*              2. FOR PS OUTPUT AT EOV, ENSURE THAT THE DATA   @Z40RSDH 60762432
*                 SET ON THE SUBSEQUENT VOLUME IS CONSISTENTLY @Z40RSDH 60762532
*                 DEFINED TO RAC WITH RESPECT TO THE PREVIOUS  @Z40RSDH 60762632
*                 VOLUME.                                      @Z40RSDH 60762732
*                                                                     * 60762832
*        RETURN IS VIA REG 14 WITH THE FOLLOWING IN REG 15:           * 60762932
*                                                                     * 60763032
*        0     RAC OK, BYPASS PASSWORD                                * 60763132
*        4     NO RAC, PROCESS PASSWORD                               * 60763232
*        8     ABEND - REG 0 CONTAINS INDEX TO 194C INTERNAL ABEND TBL* 60763332
*                                                                     * 60763432
*        REGISTERS 2-14 ARE PRESERVED.                                * 60763532
*********************************************************************** 60763632
         SPACE 1                                               @Z40RSDH 60763732
*                                                              @Z40RSDH 60763832
*        DATA FOR RAC                                          @Z40RSDH 60763932
*                                                              @Z40RSDH 60764032
*        THE FOLLOWING ARE OFFSETS TO THE ERROR CODE TABLES    @Z40RSDH 60764132
*        IN THIS MODULE FOR RAC ABENDS                         @Z40RSDH 60764232
OABRAC01 EQU   16                       OPEN=913-38 EOV=937-28 @Z40RSDH 60764332
OABRAC02 EQU   OABRAC01+1               EOV=937-2C             @Z40RSDH 60764432
OABRAC03 EQU   OABRAC01+2               OPEN=913-3C EOV=937-30 @Z40RSDH 60764532
OABRAC04 EQU   OABRAC01+3               OPEN=913-40 EOV=937-34 @Z40RSDH 60764632
OABRAC05 EQU   OABRAC01+4               EOV=937-3C             @Z40RSDH 60764732
OABRAC06 EQU   OABRAC01+6               EOV=937-40             @G32DSMI 60764832
*                                                                       60764932
         SPACE 2                                               @Z40RSDH 60765032
*                                                              @Z40RSDH 60765132
* RAC ROUTINE                                                  @Z40RSDH 60765232
*                                                              @Z40RSDH 60765332
DAMV4500 EQU   *                        RAC CHECK              @Z40RSDH 60765432
         L     R1,WTGPREFX              ADDR OF PREFIX         @Z40RSDH 60765532
         STM   R2,RET,IECREGSV-IECPREFX+R2*K4(R1) SAVE REGS    @Z40RSDH 60765632
         LR    RC,R1                    SAVE REG SAEA          @Z40RSDH 60765732
         LR    RBASE,RF                 SET BASE FOR RAC CODE  @Z40RSDH 60765832
         USING DAMV4500,RBASE           EPA IS BASE            @Z40RSDH 60765932
         L     R9,DXJSCBAD              PTR ACTV JSCB          @Z40RSDH 60766032
         USING IEZJSCB,R9               JSCB BASE REG          @Z40RSDH 60768832
         TM    JSCBSWT1,JSCBPASS        CHK BYPASS RAC         @Z40RSDH 60768932
         BO    DAMV4910                 BR - NO RAC CHECKING   @Z40RSDH 60769032
*                                                              @Z40RSDH 60769132
*        A VSAM DATA SPACE MAY NOT BE DEFINED TO RAC; VSAM     @Z40RSDH 60769232
*        PERMITS DATA SETS, CATALOGS, ETC. BUT NOT DATA SPACES @Z40RSDH 60769332
*                                                              @Z40RSDH 60769432
         TM    DSCFILTY+K1-DXDSCB(RB),ACBDORGA VSAM DATA SPACE @Z40RSDH 60769532
         BNO   DAMV4520                 BR NOT VSAM DATA SPACE @Z40RSDH 60769632
         LA    R0,OABRAC04              INT ABEND CODE OFFSET  @Z40RSDH 60769732
         TM    DSCDSIND-DXDSCB(RB),DS1RACDF CHK IF RAC FMT1    @Z40RSDH 60769832
         BO    DAMV4920                 OPEN=913-40 EOV=937-34 @Z40RSDH 60769932
*                                                              @Z40RSDH 60770032
DAMV4520 EQU   *                        CHECK COMPONENT        @Z40RSRJ 60771232
         MVC   DXCCW9(RACLLEN),RACLIST  SET UP RACHECK LIST    @G32DSMI 60771332
         CLC   WTGMODNM+K3(K3),DAMVEOV2 CHK IF EOV             @Z40RSDH 60771432
         BE    DAMV4600                 BR IF EOV              @Z40RSDH 60771532
*                                                              @Z40RSDH 60771632
* OPEN OR CONCATENATION - RACF                                 @G32DSMI 60771732
*                                                              @Z40RSDH 60771832
DAMV4530 EQU   *                                               @G32DSMI 60771932
         L     RET,DXDEBXAD             GET ADDRESS OF DEB EXT @G32DSMI 60772032
         USING DEBXTN,RET                                      @G32DSMI 60772132
         NI    DEBXFLG1,X'FF'-DEBXDSSI  TURN OFF RACF FLAG     @G32DSMI 60772232
         DROP  RET                                             @G32DSMI 60772332
         TM    DSCDSIND-DXDSCB(RB),DS1RACDF CHK F1 RAC DEFINED @Z40RSDH 60772432
         BNO   DAMV4910                 BR F1 NOT RAC DEFINED  @Z40RSDH 60772532
         BAL   RET,DAMV4800             PERFORM RACHECK        @Z40RSDH 60772632
         LTR   RF,RF                    CHK IF AUTH            @Z40RSDH 60772732
         BZ    DAMV4900                 BR IF RAC AUTH         @Z40RSDH 60772832
         LA    R0,OABRAC03              NO RAC PROFILE         @Z40RSDH 60772932
         CL    RF,DAMVRNAU              CHK IF NOT AUTHORIZED  @Z40RSDH 60773032
         BNE   DAMV4920                 OPEN=913-3C            @Z40RSDH 60773132
         LA    R0,OABRAC01              NOT AUTHORIZED         @Z40RSDH 60773232
         B     DAMV4920                 OPEN=913-38            @Z40RSRJ 60773332
*                                                              @Z40RSDH 60773432
* EOV - RAC                                                    @Z40RSDH 60773532
*                                                              @Z40RSDH 60773632
DAMV4600 EQU   *                        EOV RAC                @Z40RSDH 60773732
         TM    DCBOFLGS,DCBOFEOV        CONCATENATION          @G32DSMI 60773832
         BO    DAMV4530                 YES - TREAT LIKE OPEN  @G32DSMI 60773932
         TM    DXDCBLST,OUTPUT          CHK OPEN OUTPUT        @Z40RSDH 60774032
         BZ    DAMV4660                 BR INPUT ONLY          @Z40RSDH 60774132
*                                                              @Z40RSDH 60774232
*        CHECK FOR PO BEFORE EXCP, DSORG FIELD EXISTS IN COPY  @Z40RSDH 60774432
*        EVEN IF NOT IN USER DCB                               @Z40RSDH 60774632
         TM    DCBDSORG,DCBDSGPO        CHK IF PO              @Z40RSDH 60774832
         BO    DAMV4660                 BR IF PO               @Z40RSDH 60775032
         TM    DCBMACRF,DCBMEXCP        CHK IF EXCP            @Z40RSDH 60775232
         BO    DAMV4620                 EXCP ASSUME PS         @Z40RSDH 60775432
         NC    DCBDSORG,DCBDSORG        CHK IF DSORG SPECIFIED @Z40RSDH 60775632
         BZ    DAMV4620                 NO DSORG ASSUME PS     @Z40RSDH 60775832
         TM    DCBDSORG,DCBDSGPS        CHK PHYSICAL SEQ       @Z40RSDH 60776032
         BNO   DAMV4660                 BR NOT PS              @Z40RSDH 60777032
*                                                              @Z40RSDH 60777232
*        PS OUTPUT                                             @Z40RSDH 60777432
*                                                              @Z40RSDH 60777932
DAMV4620 EQU   *                        PS OUTPUT              @Z40RSDH 60778032
         L     R9,DXDEBXAD              GET CURRENT DEBX       @Z40RSDH 60778132
         USING DEBXTN,R9                DEBX ADDR              @Z40RSDH 60778232
         TM    DEBXFLG1,DEBXDSSI        CHK IF 1ST VOL RAC DEF @Z40RSRJ 60778332
         BZ    DAMV4640                 BR IF NOT RAC DATA SET @Z40RSDH 60778432
         DROP  R9                                              @Z40RSDH 60778532
*                                                              @Z40RSDH 60778632
*        ON OUTPUT IF FIRST VOLUME IS RAC DEFINED THEN ALL     @Z40RSDH 60778732
*        SUCCEEDING VOLUMES MUST BE RAC DEFINED.               @Z40RSRJ 60778832
*                                                              @Z40RSDH 60778932
         LA    R0,OABRAC02              INCONSISTENT RAC DEFN  @Z40RSDH 60780132
         TM    DSCDSIND-DXDSCB(RB),DS1RACDF CHK CURR RAC DEFN  @Z40RSDH 60780232
         BNO   DAMV4920                 EOV=937-2C             @Z40RSDH 60780332
         LA    R9,DXCCW9                ADDRESS OF THE RACHECK @G32DSMI 60780432
         USING ACHKLIST,R9              PARAMETER LIST         @G32DSMI 60780532
         LA    RET,DXOLDVOL             ADDRESS OF OLDVOL PARM @G32DSMI 60780632
         ST    RET,ACHKOVOL             STORE ADD OF OLD VOL   @G32DSMI 60780732
         DROP  R9                                              @G32DSMI 60780832
         BAL   RET,DAMV4800             GO PERFORM RACHECK     @Z40RSRJ 60780932
         B     DAMV4670                 GO CHECK RESULTS       @Z40RSRJ 60781032
*                                                              @Z40RSDH 60781132
*        ON OUTPUT IF THE FIRST VOLUME IS NOT RAC DEFINED      @Z40RSDH 60781232
*        THEN ALL SUCCEEDING VOLUMES MUST NOT BE RAC DEFINED.  @Z40RSDH 60781332
*                                                              @Z40RSDH 60781432
DAMV4640 EQU   *                        FIRST VOL NOT RAC DEF  @Z40RSDH 60782032
         LA    R0,OABRAC05              INCONSISTENT RAC DEFN  @Z40RSDH 60782132
         TM    DSCDSIND-DXDSCB(RB),DS1RACDF CHK CURR RAC DEFN  @Z40RSRJ 60782232
         BO    DAMV4920                 EOV=937-3C             @Z40RSDH 60782332
         B     DAMV4910                 NOT RAC DEFN - CONTIN  @Z40RSDH 60782432
*                                                              @Z40RSDH 60782532
*        NOT PS OUTPUT                                         @Z40RSDH 60782632
*                                                              @Z40RSDH 60782732
DAMV4660 EQU   *                        NOT PS OUTPUT          @Z40RSDH 60782832
         TM    DSCDSIND-DXDSCB(RB),DS1RACDF CHK CURR F1 RAC    @Z40RSDH 60782932
         BNO   DAMV4910                 BR CURR VOL NOT RAC    @Z40RSDH 60783032
         BAL   RET,DAMV4800             CHK RAC AUTH TO VOL    @Z40RSDH 60783132
DAMV4670 EQU   *                        CHECK RESULTS          @Z40RSRJ 60783232
         LTR   RF,RF                    CHK AUTHORIZED         @Z40RSDH 60783332
         BZ    DAMV4905                 RAC AUTH CONTIN        @Z40RSRJ 60783432
         LA    R0,OABRAC03              NO RAC PROFILE         @Z40RSDH 60783532
         CL    RF,DAMVRNAU              CHK IF NOT AUTHORIZED  @Z40RSDH 60783632
         BL    DAMV4920                 EOV=937-30 NO PROFILE  @Z40RSDH 60784432
         LA    R0,OABRAC01              NOT RAC AUTHORIZED     @Z40RSDH 60784532
         BE    DAMV4920                 EOV=937-28             @G32DSMI 60784632
         LA    R0,OABRAC06              INCONSISTANT DS        @G32DSMI 60784732
         B     DAMV4920                 EOV=937-40             @G32DSMI 60784832
         SPACE 2                                               @Z40RSDH 60784932
*                                                              @Z40RSDH 60785032
*        PERFORM RACHECK                                       @Z40RSDH 60785132
*        RETURN WITH RACHECK RETURN CODE IN REG 15             @Z40RSDH 60785232
*                                                              @Z40RSDH 60785332
DAMV4800 EQU   *                        RACHECK                @Z40RSDH 60785432
         LA    R5,ACHKTRD               CHK READ AUTH          @Z40RSRJ 60785632
         TM    DXDCBLST,OUTPUT          TEST FOR OUTPUT        @Z40RSDH 60785732
         BZ    DAMV4820                 BR READ ONLY           @Z40RSDH 60785832
         LA    R5,ACHKTUPD              CHK UPDATE AUTH        @Z40RSRJ 60785932
DAMV4820 EQU   *                        ISSUE RACHECK          @Z40RSDH 60786032
         RACHECK ENTITY=((RD)),VOLSER=UCBVOLI,ATTR=(R5),       @Z40RSDH*60786132
               MF=(E,DXCCW9)            CHK AUTHORIZATION      @Z40RSRJ 60786232
*                                                              @Z40RSDH 60786332
*        RETURN CODE FROM RACHECK                              @Z40RSDH 60786432
*          0 - AUTHORIZED                                      @Z40RSDH 60786532
*          4 - ENTITY/VOLUME NOT DEFINED TO RAC                @Z40RSDH 60786632
*          8 - NOT AUTHORIZED                                  @Z40RSDH 60786732
*                                                              @Z40RSDH 60786832
         BR    RET                      RETURN                 @Z40RSDH 60786932
*                                                              @Z40RSDH 60787032
* RETURN TO CALLER                                             @Z40RSDH 60787132
*                                                              @Z40RSDH 60787232
DAMV4900 EQU   *                        RAC OK - OPEN          @Z40RSRJ 60787332
         L     R9,DXDEBXAD              GET CURRENT DEBX       @Z40RSDH 60787432
         USING DEBXTN,R9                DEBX ADDR              @Z40RSDH 60787532
         OI    DEBXFLG1,DEBXDSSI        INDIC 1ST VOL RAC DEF  @Z40RSRJ 60787632
         DROP  R9                                              @Z40RSRJ 60787732
DAMV4905 EQU   *                        RAC OK - EOV           @Z40RSRJ 60787832
         LA    RF,K0                    RAC OK                 @Z40RSDH 60787932
         B     DAMV4950                 EXIT                   @Z40RSDH 60788032
DAMV4910 EQU   *                        NOT RAC DEFINED        @Z40RSDH 60788132
         LA    RF,K4                    NOT RAC DEFINED        @Z40RSDH 60788232
         B     DAMV4950                 EXIT                   @Z40RSDH 60788332
DAMV4920 EQU   *                        ABEND                  @Z40RSDH 60788432
         LA    RF,K8                    ABEND - TBL OFFSET R0  @Z40RSDH 60788532
         B     DAMV4950                 EXIT                   @Z40RSDH 60788632
*                                                              @Z40RSDH 60788732
DAMV4950 LM    R2,RET,IECREGSV-IECPREFX+R2*K4(RC) RESTORE REGS @Z40RSDH 60788832
         BR    RET                      RETURN                 @Z40RSDH 60788932
         SPACE 2                                               @Z40RSDH 60789032
*                                                              @Z40RSDH 60789132
* CONSTANTS FOR RAC CODE                                       @Z40RSDH 60789232
*                                                              @Z40RSDH 60789332
RACLIST  RACHECK CLASS=DATASET,DSTYPE=N,MF=L RACHECK PLIST     @Z40RSRJ 60789432
RACLLEN  EQU   *-RACLIST                LENGTH RACHECK PLIST   @Z40RSDH 60789532
DATASET  DC    AL1(7),CL7'DATASET'      CLASS NAME             @Z40RSRJ 60789732
DAMVRNAU DC    F'8'                     RACHECK RETURN CODE    @Z40RSDH*60789832
                                        FOR NOT AUTHORIZED     @Z40RSDH 60789932
         USING DAMV0000,RBASE           REESTABLISH BASE USING @Z40RSDH 60790032
         EJECT                                                          60790232
*                                                              @G18MSBS 60790332
***************************************************************@G18MSBS 60790432
*                                                              @G18MSBS 60790532
*      **************************                              @G18MSBS 60790632
*      * JES3 INTERFACE ROUTINE *                              @G18MSBS 60790732
*      **************************                              @G18MSBS 60790832
*                                                              @G18MSBS 60790932
*        ON ENTRY -                                            @G18MSBS 60791032
*        R0 AND R1 ARE VOLATILE                                @G18MSBS 60791132
*        RC  = PASS SWITCH: 0=FIRST PASS; 4=FINAL PASS         @G18MSBS 60791232
*        RET = RETURN ADDRESS                                  @G18MSBS 60791332
*        RF  = ENTRY ADDRESS                                   @G18MSBS 60791432
*                                                              @G18MSBS 60791532
*        THIS ROUTINE WILL GET SPACE FOR AND BUILD THE SSOB    @G18MSBS 60791632
*        HEADER AND EXTENSION TO PASS TO JES3 VIA THE MACRO:   @G18MSBS 60791732
*        'IEFSSREQ', OFFERING THE VOLUME CHOICE TO JES3 FOR    @G18MSBS 60791832
*        APPROVAL.  UPON RETURN, REGISTER 15 WILL CONTAIN:     @G18MSBS 60791932
*                                                              @G18MSBS 60792032
*               REGISTER 15 = 0  : JES3 RESPONDED-OK           @G18MSBS 60792132
*               REGISTER 15 = >0 : JES3 ERROR-ABEND            @G18MSBS 60792232
*                                                              @G18MSBS 60792332
*        IF REGISTER 15 CONTAINS ZERO, THEN 'SSOBRETN'         @G18MSBS 60792432
*        IS TESTED FOR ZERO.  ZERO ALLOWS OPEN/EOV TO          @G18MSBS 60792532
*        CONTINUE AND A NON-ZERO INDICATES JES3 DETERMINED     @G18MSBS 60792632
*        THAT VOLUME COULD NOT BE USED BY THIS JOB NOW. IT     @G18MSBS 60792732
*        WILL BE REJECTED BY OPEN/EOV LIKE A WRONG VOLUME.     @G18MSBS 60792832
***************************************************************@G18MSBS 60792932
***************************************************************@G18MSBS 60793032
*                                                              @G18MSBS 60793132
DAMV5000 EQU   *                        JES3 ROUTINE           @G18MSBS 60793232
        SPACE                                                           60793332
         L     RF,WTGPREFX              GET WHERE TO GO PREFIX @G18MSBS 60793432
         LA    RF,IECREGSV-IECPREFX(,RF) ADDR OF REG SAVE AREA @G18MSBS 60793532
         STM   R0,RET,K0(RF)            SAVE REGISTERS         @G18MSBS 60793632
         LR    R8,RF                    SAVE SAVEAREA          @G18MSBS 60793732
         IECRES GET,PREFIX=YES,ID=SSOB,LV=SSOBSIZE,A=(RF)      @G18MSBS 60793832
         LM    R2,RET,K8(R8)            RESTORE REGS           @G18MSBS 60793932
         USING SSOB,R1                  ESTAB ADDRESSABILITY   @G18MSBS 60794032
         ST    R1,DASSOBAD              SAVE PARM POINTER      @G18MSBS 60794132
        SPACE                                                           60794232
         MVC   SSOBID,DASSOBID          ID OF SSOB             @G18MSBS 60794332
         MVI   SSOBLEN+K1,SSOBHSIZ      LENGTH OF SSOBHEADER   @G18MSBS 60794432
         MVI   SSOBFUNC+K1,SSOBOEOV     OPEN/EOV FUNCTION ID   @G18MSBS 60794532
         LA    RF,SSMOBGN               GET FUNCTION DEPENDENT @G18MSBS 60794632
         ST    RF,SSOBINDV              AREA PTR AND SAVE IT   @G18MSBS 60794732
         MVI   SSMOLEN+K1,SSMOSIZE      LENGTH OF EXTENSION    @G18MSBS 60794832
         L     RF,DXJSCBAD              LOAD JSCB ADDR         @G18MSBS 60794932
         L     RF,JSCBJCT-IEZJSCB(,RF)  GET JCT PTR FROM JSCB  @G18MSBS 60795032
         LA    RF,SWAPREFX+JCTJNAME-JCTABLE(,RF) GET PTR OF    @G18MSBS 60795132
*                                       JOB NAME               @G18MSBS 60795232
         ST    RF,SSMOPNAM              AND SAVE IT FOR SSOB   @G18MSBS 60795332
         L     RF,DXJSCBAD              LOAD JSCB ADDR AGAIN   @G18MSBS 60795432
         L     RF,JSCSCT-IEZJSCB(,RF)   GET SCT PTR FROM JSCB  @G18MSBS 60795532
         LA    RF,SWAPREFX+SCTSNUMB-SCTABLE(,RF) GET PTR OF    @G18MSBS 60795632
*                                       STEP NUMBER            @G18MSBS 60795732
         ST    RF,SSMOPSTN              AND SAVE IT FOR SSOB   @G18MSBS 60795832
         LA    RF,UCBNAME               GET PTR OF UNIT ADDRESS@G18MSBS 60795932
         ST    RF,SSMOPUAD              AND SAVE IT FOR SSOB   @G18MSBS 60796032
         LA    RF,UCBVOLI               GET PTR OF VOLSER      @G18MSBS 60796132
         ST    RF,SSMOPVOL              AND SAVE IT FOR SSOB   @G18MSBS 60796232
         BALR  RF,R0                    ESTABLISH              @G18MSBS 60796332
         USING *,RF                        ADDRESSABILITY      @G18MSBS 60796432
         LTR   RC,RC                    FINAL REQ SWITCH ON?   @G18MSBS 60796532
         BZ    DAMV5020                 OFF, SKIP FINAL REQ FLG@G18MSBS 60796632
         OI    SSMOFLG1,SSMOFINL        ON, INDICATE FINAL REQ @G18MSBS 60796732
         DROP  RF                                              @G18MSBS 60796832
        EJECT                                                           60796932
DAMV5020 EQU   *                        PREPARE TO ISSUE       @G18MSBS 60797032
         OI    DASSOBAD,HIORDER         REQUEST FOR SSOB MACRO @G18MSBS 60797132
         LA    RD,SSOBSAVE              GET SAVE AREA FOR SSOB @G18MSBS 60797232
         LA    R1,DASSOBAD              GET ADDR OF PARM PTR   @G18MSBS 60797332
         DROP  R1                                              @G18MSBS 60797432
        SPACE                                                           60797532
*                                                              @G18MSBS 60797632
***************************************************************@G18MSBS 60797732
*                                                              @G18MSBS 60797832
**       PREPARE TO ISSUE MACRO: 'IEFSSREQ'                    @G18MSBS 60797932
*                                                              @G18MSBS 60798032
**       ON ENTRY:                                             @G18MSBS 60798132
*                                                              @G18MSBS 60798232
**       REGISTER 1 = POINTER TO SSOB PARAMETER LIST POINTER   @G18MSBS 60798332
**       REGISTER D = SAVE AREA TO BE USED BY JES3             @G18MSBS 60798432
*                                                              @G18MSBS 60798532
**       ON RETURN:                                            @G18MSBS 60798632
*                                                              @G18MSBS 60798732
**       REGISTER 0 = VOLATILE                                 @G18MSBS 60798832
**       REGISTER 1 = POINTER TO SSOB PARAMETER LIST           @G18MSBS 60798932
**       REGISTER F = RETURN CODE FROM JES3                    @G18MSBS 60799032
**                    0=JES3 RESPONDED - TEST 'SSOBRETN' CODE  @G18MSBS 60799132
*                                                              @G18MSBS 60799232
**       'SSOBRETN' CONTAINS A RETURN CODE:                    @G18MSBS 60799332
**                  0 = THIS VOLUME IS AVAILABLE FOR USE.      @G18MSBS 60799432
**                  4 = JES3 HAS SOME OTHER USE FOR THIS VOL.  @G18MSBS 60799532
***************************************************************@G18MSBS 60799632
*                                                              @G18MSBS 60799732
         IEFSSREQ                       ISSUE MACRO            @G18MSBS 60799832
        SPACE                                                           60799932
         USING *,RET                    ESTAB ADDRESSABILITY   @G18MSBS 60800032
         LTR   RF,RF                    TEST RETURN CODE       @G18MSBS 60800132
         BZ    DAMV5030                 NO JES3 ERROR - BRANCH @G18MSBS 60800232
         LA    R0,K21                   OPEN=413-34 EOV=737-28 @ZM44627 60800332
         XC    DXVOLSR2,DXVOLSR2        CLEAR VOLSER FOR ABEND @G18MSBS 60800432
         B     DAMV9900                 JES3 ERROR - ABEND     @G18MSBS 60800532
         EJECT                                                          60800632
DAMV5030 EQU   *                        JES3 PROCESSING OK     @G18MSBS 60800732
         USING SSOB,R1                  ESTAB ADDRESSABILITY   @G18MSBS 60800832
         L     R8,WTGPREFX              GET WHERE TO GO PREFIX @G18MSBS 60800932
         L     R9,SSOBRETN              GET JES3 FUNCT RET CODE@G18MSBS 60801032
         DROP  R1,RET                                          @G18MSBS 60801132
         SPACE                                                          60801232
         IECRES FREE,PREFIX=YES,A=(R1)                         @G18MSBS 60801332
         SPACE                                                          60801432
         LTR   R9,R9                    TEST RET FROM IEFSSREQ @G18MSBS 60801532
         LM    R0,RET,IECREGSV-IECPREFX(R8) RESTORE REGISTERS  @G18MSBS 60801632
         BNZ   DAMV9900                 REJECT JES3 DISAPPROVED@G18MSBS 60801732
         BR    RET                      VOLUME APPROVED-RETURN @G18MSBS 60801832
         EJECT                                                          60801932
*                                                                Y02134 60802002
*****************************************************************Y02134 60804032
*                                                                Y02134 60810032
*        INTERFACE TO IECPRLTV CONVERT ROUTINE.                  Y02134 60816032
*        MBBCCHHR IS CONVERTED TO TTR                            Y02134 60822032
*                                                                Y02134 60836002
*****************************************************************Y02134 60838002
*                                                                Y02134 60840002
*        REG   CONTENTS AT ENTRY        CONTENTS AT EXIT         Y02134 60842002
*        R0    WORK REGISTER            CONVERTED TTR            Y02134 60844032
*        R4    O/C/E WORK AREA POINTER  SAME AS ENTRY            Y02134 60846002
*        R6    POINTER TO WTGTABLE      SAME AS ENTRY            Y02134 60848002
*        R14   RETURN ADDRESS           SAME AS ENTRY            Y02134 60850002
*        R15   WORK REGISTER            RETURN CODE              Y02134 60852002
*                                                                Y02134 60854002
*        MBBCCHHR IS PASSED IN DXDAADDR                          Y02134 60856032
*                                                                Y02134 60856132
*****************************************************************Y02134 60856232
*                                                                Y02134 60856332
DAMV8800 EQU   *                                                 Y02134 60856432
*                                                                Y02134 60856532
         L     RF,WTGPREFX              LOAD POINTER TO PREFIX   Y02134 60856632
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS        Y02134 60856732
         LA    R1,DXDEB                 POINT TO OPEN WORK DEB   Y02134 60856832
         LA    R2,DXDAADDR              ADDR TO STORE MBBCCHHR   Y02134 60856932
         L     RF,CVTPTR                GET CVT ADDR             Y02134 60857032
         L     RF,CVTPRLTV-CVT(,RF)     ADDR OF IECPRLTV ROUTINE Y02134 60857132
         BALR  RET,RF                   CONVERT TTR TO MBBCCHHR  Y02134 60857232
         L     RET,WTGPREFX             LOAD POINTER TO PREFIX   Y02134 60857332
         LM    R1,RET,IECREGSV-IECPREFX+K4(RET) RESTORE REGISTRS Y02134 60857432
         BR    RET                      RETURN                   Y02134 60857532
         EJECT                                                          60857632
DSNOTFND EQU   *                        DSCB-NOT-FOUND EXIT    @G60ASRB 60857760
*                                                              @G60ASRB 60864160
***************************************************************@G60ASRB 60864260
*        CALL IFG0EX0A, THE DSCB-NOT-FOUND INSTALLATION EXIT.  @G60ASRB 60864360
*        THIS SUBROUTINE USES REGISTERS 0,1,12,14,15.          @G60ASRB 60864460
*        RETURN ON REG 14.                                     @G60ASRB 60864560
*        EXIT INTERFACE                                        @G60ASRB 60864660
*          REG1 - PARMLIST ADDRESS                             @G60ASRB 60864760
*                 FIRST WORD UCB ADDRESS                       @G60ASRB 60864860
*                 SECOND WORD DATASET NAME ADDRESS             @G60ASRB 60864960
*          REG13 - IECREGSV   ADDRESS TO SAVE REGISTERS        @G60ASRB 60865060
*          REG14 - RETURN                                      @G60ASRB 60865160
*          REG15 - IFG0EX0A ADDRESS                            @G60ASRB 60865260
*        EXIT RETURN CODE IN REGISTER 15                       @G60ASRB 60865360
*          0 - CONTINUE DSCB NOT FOUND PROCESSING              @G60ASRB 60865460
*          4 - RETRY READ OF DSCB. EXIT NOT TAKEN IF STILL     @G60ASRB 60865560
*              MISSING.                                        @G60ASRB 60865660
*          8 - EXIT ERROR - 213-2C/737-3C                      @G60ASRB 60865760
*        ACTION BASED ON EXIT RETURN CODE                      @G60ASRB 60865860
*          0 - RETURN ON REG 14 TO CONTINUE DSCB-NOT-FOUND     @G60ASRB 60865960
*              PROCESSING, WITH 0 IN REG15.                    @G60ASRB 60866160
*          4 - SET DXEX0A01 SWITCH AND RETURN TO               @G60ASRB 60866260
*              RETRY READ OF DSCB, WITH 4 IN REG15.            @G60ASRB 60866360
*          8 - RETURN ON REG14 WITH REG0 SET TO ABEND          @G60ASRB 60866460
*              INDICATOR AND 8 IN REG15.                       @G60ASRB 60866560
***************************************************************@G60ASRB 60866660
*                                                              @G60ASRB 60866760
         ST    RET,DXCCW4               SAVE RETURN            @G60ASRB 60866860
         ST    RBASE,DXCCW4+K4          SAVE FIRST BASE        @G60ASRB 60866960
         LR    RBASE,RF                 ESTABLISH NEW BASE     @G60ASRB 60867060
         USING DSNOTFND,RBASE                                  @G60ASRB 60867160
         TM    DXFLAG1,DXEX0A01         2ND DSCB-NOT-FOUND     @G60ASRB 60867260
         BO    DSNOTFN0                 BRANCH IF YES-EXIT     @G60ASRB 60867360
         MVC   DXIDENT(K7),WTGMODNM+K4  SAVE THIS MODULE ID    @G60ASRB 60867460
         IECRES LOAD,MODNM=EX0A,BRANCH=NO,PREFIX=WTGPREFX      @G60ASBJ 60868060
         L     RC,WTGMODEP              GET IFG0EX0A ENTRY PT. @G60ASBJ 60872060
         MVC   WTGMODNM+K4(K7),DXIDENT  RESTORE THIS MODULE ID @G60ASBJ 60876060
         LA    RUCB,K0(,RUCB)                                  @G60ASRB 60886560
         ST    RUCB,DXWORK              UCB ADDRESS            @G60ASRB 60886660
         LA    RD,K0(,RD)                                      @G60ASRB 60886760
         ST    RD,DXWORK1               DATA SET NAME ADDRESS  @G60ASRB 60886860
         OI    DXWORK1,X'80'            END OF LIST INDICATOR  @G60ASRB 60886960
         LA    R1,DXWORK                PARMLIST ADDRESS       @G60ASRB 60887060
         LR    RF,RC                    ENTRY ADDRESS          @G60ASRB 60887160
         LR    RC,RD                    SAVE RD                @G60ASRB 60887260
         L     RD,WTGPREFX              PREFIX ADDRESS         @G60ASRB 60887360
         LA    RD,IECREGSV-IECPREFX(,RD) REGSAVE AREA          @G60ASRB 60887460
         BALR  RET,RF                   TAKE EXIT              @G60ASRB 60887560
         LR    RD,RC                    RESTORE RD             @G60ASRB 60887660
         LTR   RC,RF                    CODE TO RC AND TEST    @G60ASRB*60887760
                                        IF CODE IS ZERO        @G60ASRB 60887860
         BE    DSNOTFN0                 EXIT IF YES            @G60ASRB 60887960
         LA    RF,K4                    COMPERAND OF FOUR      @G60ASRB 60888160
         CR    RF,RC                    IS RETURN CODE 4       @G60ASRB 60888260
         BE    DSNOTFN4                 BRANCH IF YES          @G60ASRB 60888360
         LA    R0,K23                   EXIT ERROR             @G60ASRB 60888460
         B     DSNOTFN8                 EXIT WITHOUT ZERO IN 0 @G60ASRB 60888560
DSNOTFN0 EQU   *                        NORMAL RETURN          @G60ASRB 60888660
         LA    RF,K0                    RETURN INDICATOR       @G60ASRB 60888760
         B     DSNOTFO                                         @G60ASRB 60888860
DSNOTFN4 EQU   *                        RETRY RETURN           @G60ASRB 60888960
         OI    DXFLAG1,DXEX0A01         SET SECOND TIME BIT    @G60ASRB 60889060
         LA    RF,K4                                           @G60ASRB 60889160
         B     DSNOTFO                                         @G60ASRB 60889260
DSNOTFN8 EQU   *                        ERROR RETURN           @G60ASRB 60889360
         LA    RF,8                                            @G60ASRB 60889460
DSNOTFO  EQU   *                        RETURN                 @G60ASRB 60889560
         L     RET,DXCCW4               RETURN ADDRESS         @G60ASRB 60889660
         L     RBASE,DXCCW4+K4          BASE REG               @G60ASRB 60889760
         BR    RET                                             @G60ASRB 60889860
         USING DAMV0000,RBASE           REESTABLISH BASE       @G60ASRB 60889960
         EJECT                                                          60890060
*                                                                Y02134 60891160
*****************************************************************Y02134 60891260
*                                                                Y02134 60891360
*        INTERFACE TO IECPCNVT CONVERT ROUTINE.                  Y02134 60891460
*        TTR IS CONVERTED TO MBBCCHHR                            Y02134 60891560
*                                                                Y02134 60891660
*****************************************************************Y02134 60891760
*                                                                Y02134 60891860
*        REG   CONTENTS AT ENTRY        CONTENTS AT EXIT         Y02134 60891960
*        R1    POINTER TO TTR           SAME AS ENTRY            Y02134 60892460
*        R4    O/C/E WORK AREA POINTER  SAME AS ENTRY            Y02134 60893560
*        R6    POINTER TO WTGTABLE      SAME AS ENTRY            Y02134 60894060
*        R14   RETURN ADDRESS           SAME AS ENTRY            Y02134 60896060
*        R15   WORK REGISTER            RETURN CODE              Y02134 60898060
*                                                                Y02134 60900060
*        MBBCCHHR IS RETURNED IN DXDAADDR                        Y02134 60902060
*                                                                Y02134 60904060
*****************************************************************Y02134 60906060
*                                                                Y02134 60908060
DAMV8900 EQU   *                                                 Y02134 60910060
*                                                                Y02134 60912060
         L     RF,WTGPREFX              LOAD POINTER TO PREFIX   Y02134 60914060
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS        Y02134 60916060
         XC    DXDAADDR,DXDAADDR        ZERO OUT MBBCCHHR        Y02134 60918060
         MVC   DXDAADDR(K3),K0(R1)      TTR TO WORK AREA         Y02134 60920060
         L     R0,DXDAADDR              LOAD TTR0                Y02134 60922060
         XC    DXDAADDR,DXDAADDR        ZERO OUT MBBCCHHR        Y02134 60924060
         LA    R1,DXDEB                 POINT TO OPEN WORK DEB   Y02134 60926060
         LA    R2,DXDAADDR              ADDR TO STORE MBBCCHHR   Y02134 60928060
         L     RF,CVTPTR                GET CVT ADDR             Y02134 60930060
         L     RF,CVTPCNVT-CVT(,RF)     ADDR OF IECPCNVT ROUTINE Y02134 60932060
         BALR  RET,RF                   CONVERT TTR TO MBBCCHHR  Y02134 60934060
         L     RET,WTGPREFX             LOAD POINTER TO PREFIX   Y02134 60936060
         LM    R0,RET,IECREGSV-IECPREFX(RET) RESTORE 15 REGISTRS Y02134 60938060
         BR    RET                      RETURN                   Y02134 60940060
         EJECT                                                          60942060
DSCUPD   EQU   *                        UPDATE DSCB            @G60ASRB 60961160
*                                                              @G60ASRB 60961260
***************************************************************@G60ASRB 60961360
*        THE LAST ACCESSED DATE IN THE FORMAT 1 DSCB IS        @G60ASRB 60961460
*        UPDATED IF THE DATE IS NONZERO AND THE DATE IS        @G60ASRB 60961560
*        LESS THAN TODAY'S DATE.                               @G60ASRB 60961660
*        SET THE BACKUP COPY INDICATOR IF OPEN FOR OTHER THAN  @G60ASRB 60961760
*        INPUT.                                                @G60ASRB 60961860
*        WRITE UDPATED DSCB IF EOV OR IF NOT THE FIRST DSCB.   @G60ASRB 60961960
*        SET THE DSCB-UPDATED BIT IN JFCBMASK(JFCMDMOD) IF     @G60ASRB 60964160
*        FIRST DSCB.                                           @G60ASRB 60964260
*        RETURN WITH 0 IN REG 15 IF NO ERROR.                  @G60ASRB 60964360
*        RETURN WITH 4 IN REG 15 IF I/O ERROR WRITING DSCB.    @G60ASRB 60964460
***************************************************************@G60ASRB 60964560
*                                                              @G60ASRB 60964660
         L     R1,WTGPREFX              WTG PREFIX             @G60ASRB 60964760
         STM   R2,RET,IECREGSV-IECPREFX(R1) SAVE REGISTERS     @G60ASRB 60964860
         LR    RBASE,RF                 NEW BASE               @G60ASRB 60964960
         USING DSCUPD,RBASE                                    @G60ASRB 60965060
         LA    RC,0                     INITIALIZE TO INDICATE @G60ASRB*60965160
                                        DSCB NOT MODIFIED      @G60ASRB 60965260
         TM    DXDCBLST,PLISTOP1        INPUT                  @G60ASRB 60965360
         BZ    DSCUP10                  BRANCH IF INPUT        @G60ASRB 60965460
         TM    DS1DSIND-DS1FMTID(RB),DS1DSCHA AREADY ON        @G60ASRB 60965560
         BO    DSCUP10                  BRANCH IF NEEDNT SET   @G60ASRB 60965660
         OI    DS1DSIND-DS1FMTID(RB),DS1DSCHA SET IT           @G60ASRB 60965760
         LA    RC,K1                    INDICATE DSCB UPDATED  @G60ASRB 60965860
*                                                              @G60ASRB 60965960
DSCUP10  EQU   *                        CHECK ACCESS DATE      @G60ASRB 60966060
         CLC   DS1REFD-DS1FMTID(,RB),DAMVZERO IS DATE ZERO     @G60ASRB 60966160
         BE    DSCUP20                  BRANCH IF ZERO-DATE IS @G60ASRB*60966260
                                        NOT BEING MAINTAINED   @G60ASRB 60966360
         BAL   RET,DOCVTDTE             MOVE CVTDATE TO        @G60ASRB*60966460
                                        DXWORK2 IN BINARY      @G60ASRB 60966560
         CLC   DS1REFD-DS1FMTID(,RB),DXWORK2+K1 IS DSCB DATE   @G60ASBJ*60966660
                                        DIFFERENT FROM CVT DATE@G60ASBJ 60967060
         BE    DSCUP20                  BRANCH IF DSCB DATE IS @G60ASBJ*60967560
                                        EQUAL TO CVT DATE      @G60ASRB 60968160
         MVC   DS1REFD-DS1FMTID(,RB),DXWORK2+K1 UPDATE DSCB    @G60ASRB 60969160
         LA    RC,K1                    INDICATE DSCB UPDATED  @G60ASRB 60969660
*                                                              @G60ASRB 60969760
DSCUP20  EQU   *                        CAUSE WRITE OF DSCB    @G60ASRB 60969860
*                                                              @G60ASRB 60969960
         LTR   RC,RC                    DSCB UPDATED           @G60ASRB 60970160
         BZ    DSCUP40                  BRANCH IF NO           @G60ASRB 60970260
         LA    RB,0(,RB)                CLEAR HIGH BYTE        @G60ASRB 60970360
         LA    RCORE,0(,RCORE)          CLEAR HIGH BYTE        @G60ASRB 60970460
         LA    RF,F1CCHHR-F1DATA(,RB)   CCHHR IF NOT 1ST DSCB  @G60ASRB 60970560
         CR    RB,RCORE                 FIRST DSCB             @G60ASRB 60970660
         BNE   DSCUP30                  BRANCH IF NOT          @G60ASRB 60970760
         LA    RF,DXCCW7                CCHHR IF EOV(1ST DSCB) @G60ASRB 60970860
         CLC   DAMVEOV2,WTGMODNM+K3     IS IT EOV              @G60ASRB 60970960
         BE    DSCUP30                  BRANCH IF YES          @G60ASRB 60971060
         OI    JFCBMASK+K4,JFCMDMOD     REWRITE DSCB LATER     @G60ASRB 60971160
         B     DSCUP40                  EXIT                   @G60ASRB 60971260
*                                                              @G60ASRB 60971360
DSCUP30  EQU   *                        WRITE DSCB             @G60ASRB 60971460
*                                                              @G60ASRB 60971560
         XC    DXCCW1(K24),DXCCW1       ZERO 3 CCWS            @G60ASRB 60971660
         MVC   DXDAADDR+K3(L'F1CCHHR),K0(RF) SET UP IOBSEEK    @G60ASRB 60971760
         ST    RF,DXCCW1                PUT IN SID CCW         @G60ASRB 60971860
         LA    RF,DXCCW1                                       @G60ASRB 60971960
         ST    RF,DXCCW2                TIC TO CCW1            @G60ASRB 60972060
         LA    RB,K0(,RB)                                      @G60ASRB 60972260
         ST    RB,DXCCW3                DSCB                   @G60ASRB 60972360
         OC    DXCCW1(K24),DAMVWRF1     OP CODES,FLAGS         @G60ASRB 60972460
         EXCP  DXIOB                    WRITE DSCB             @G60ASRB 60972560
         LA    RF,K4                    ERROR EXIT             @G60ASRB 60972660
         B     DSCUP50                  EXIT                   @G60ASRB 60972760
*                                                              @G60ASRB 60972860
DSCUP40  EQU   *                        NO EXCP DONE EXIT      @ZA32427 60972960
*                                                              @G60ASRB 60973460
         LA    RF,K0                                           @G60ASRB 60973560
*                                                              @G60ASRB 60973660
DSCUP50  EQU   *                        COMMON EXIT            @G60ASRB 60973760
*                                                              @G60ASRB 60973860
         L     RC,WTGPREFX              PREFIX                 @G60ASRB 60973960
         LM    R2,RET,IECREGSV-IECPREFX(RC) RESTORE REGISTERS  @G60ASRB 60974060
         BR    RET                      EXIT                   @G60ASRB 60974160
         USING DAMV0000,RBASE           REESTABLISH BASE       @G60ASRB 60974260
         EJECT                                                          60974360
*                                                                Y02080 60974460
*****************************************************************Y02134 60974560
*                                                                Y02134 60974660
*        DETERMINE PROPER RETURN CODE FOR OPEN OR EOV            YM1472 60974760
*                                                                Y02134 60976060
*****************************************************************Y02134 60976160
*                                                                Y02134 60976260
DAMV9999 EQU   *                                                 Y02080 60976360
*                                                                Y02134 60976460
         BALR  RC,R0                    ESTABLISH NEW BASE       YM3070 60976560
         USING *,RC                     ESTABLISH ADDRESSABILITY YM3070 60976660
*                                                                YM3070 60976760
         LA    RF,DAMVERFF              GET LENGTH OF CODE LIST  Y02080 60976860
         CR    RF,R0                    CHECK IF CODE IS OK      Y02134 60976960
         BNL   DAMV9902                 BRANCH IF OK             Y02080 60977060
         LA    R0,K0                    SET BAD CODE IN REG 0    Y02080 60977160
*                                                                Y02134 60977260
DAMV9902 EQU   *                        GET PROPER ABEND TABLE   YM1472 60977360
*                                                                Y02080 60977460
         LA    RF,DAMVER19              POINT TO OPEN CODES      Y02080 60977560
         CLC   DAMVEOV,WTGMODNM+K3      CHECK FOR EOV CALL       Y02080 60977660
         BNE   DAMV9905                 BRANCH IF OPEN           Y02080 60977760
         LA    RF,DAMVER55              POINT TO EOV  CODES      Y02080 60977860
*                                                                Y02134 60977960
DAMV9905 EQU   *                        GET PROPER ABEND CODE    YM1472 60978060
*                                                                Y02080 60978160
         AR    RF,R0                    ADD ERROR OFFSET         Y02080 60978260
         IC    R0,K0(RF)                INSERT PROPER PD CODE    Y02080 60978360
*                                                                Y02134 60978460
         CLC   DAMVEOV,WTGMODNM+K3      CHECK FOR EOV CALL       Y02080 60978560
         BE    DAMV9990                 BRANCH IF EOV            Y02134 60978660
*                                                                Y02134 60978760
         CLI   DXWORK,K213              CHECK FOR 213 CODE       Y02134 60978860
         BNE   DAMV9990                 BRANCH IF NOT 213        Y02134 60978960
*                                                                       60979060
         IECRES LOAD,MODID=ID4C5G,BRCODE=0,BRANCH=QUEUED         Y02080 60979160
*                                                                Y02134 60979260
DAMV9990 EQU   *                        SEE IF NEW VOL OK        YM1472 60979360
*                                                                Y02080 60979460
         MVC   DXVOLSR1,UCBVOLI         SET UP DISMOUNT          YM1472 60979560
         CLC   DXVOLSR2,SCRTCH          CHECK FOR NON-SPECIFIC   YM1472 60979660
         BE    DAMV7510                 BRANCH IF SCRTCH         YM1472 60979760
*                                                                YM1472 60979860
         MVC   DXRETMOD,ID4C4A          SET UP RETURN MOD        Y02080 60979960
         LA    RET,K24                  SET UP RETURN OFFSET     Y02080 60981960
*                                                                Y02134 60982002
*        NOTE - 4A RETURN MODULE SAVED AT DXSAVMOD               Y02080 60984002
*                                                                Y02080 60986002
         DMABCOND (0),ID4C0P                                     Y02080 60988002
         DROP  RC                                                       60990032
         EJECT                                                          60993603
GETF1    EQU   *                        GET F1 DSCB WORKAREA   @G18MSBS 60996632
         IECRES GET,LV=(0),ID=F1,                              @G18MSBSX60999632
               PREFIX=YES,STM=(R2,RET,WTGPREFX)                @G18MSBS 61002632
*                                                              @G18MSBS 61005632
         BR    RET                      RETURN TO CALLER       @G18MSBS 61008632
         SPACE 1                                               @G18MSBS 61011632
GETF2F3  EQU   *                        GET F2/F3 DSCB WKAREA  @G18MSBS 61014632
         IECRES GET,LV=(0),ID=F2F3,                            @G18MSBSX61017632
               PREFIX=YES,STM=(2,14,WTGPREFX)                  @G18MSBS 61020632
*                                                              @G18MSBS 61023632
         BR    RET                      RETURN TO CALLER       @G18MSBS 61026632
         EJECT                                                          61029632
DOCVTDTE EQU   *                        CVTDATE CONVERT RTNE   @G60ASRB 61108160
*                                                              @G60ASRB 61108260
*        CONVERT CVTDATE TO BINARY                             @G60ASRB 61108360
*        CVTDATE IN FORM X'00YYDDDF' IN PACKED DECIMAL.        @G60ASRB 61108460
*        DXWORK2 WILL CONTAIN X'00YYDDDD' IN BINARY.           @G60ASRB 61108560
*                                                              @G60ASRB 61108660
         L     R1,CVTPTR                GET ADDR OF CVT        @G60ASRB 61108760
         XC    DXWORK,DXWORK            CLEAR WORK AREA        @G60ASRB 61108860
         XC    DXWORK1,DXWORK1          CLEAR WORK AREA        @G60ASRB 61108960
         XC    DXWORK2,DXWORK2          CLEAR WORK AREA        @G60ASRB 61109060
         MVC   DXWORK+K6(K2),CVTDATE+K2-CVT(R1) CURRENT DAY    @G60ASRB*61109160
                                        AS X'000000000000DDDF' @G60ASRB*61109260
                                        IN PACKED DECIMAL      @G60ASRB 61109360
         CVB   RF,DXWORK                DAY NOW IN BINARY      @G60ASRB 61109460
         STH   RF,DXWORK2+K2            X'0000DDDD' IN BINARY  @G60ASRB 61109560
         MVO   DXWORK(K8),CVTDATE-CVT+K1(K1,R1) THE RESULT IS  @G60ASRB*61109660
                                        X'0000000000000YYF'    @G60ASRB*61109760
                                        IN PACKED DECIMAL      @G60ASRB 61109860
         CVB   RF,DXWORK                CONVERT YEAR TO BINARY @G60ASRB 61109960
         STH   RF,DXWORK2               DATE NOW X'00YYDDDD'   @G60ASRB*61110060
                                        IN BINARY              @G60ASRB 61110160
         BR    RET                      RETURN                 @G60ASRB 61110660
         EJECT                                                 @G60ASRB 61110760
GETCCWS  EQU   *                        GET CCW'S WORKAREA     @G18MSBS 61110860
         IECRES GET,LV=K72,ID=CCWS,                            @G18MSBSX61110960
               PREFIX=YES,STM=(2,14,WTGPREFX)                  @G18MSBS 61111060
*                                                              @G18MSBS 61113060
         BR    RET                      RETURN TO CALLER       @G18MSBS 61115060
         SPACE 1                                               @G18MSBS 61117060
FREECCWS EQU   *                        FREE CCW'S WORKAREA    @G18MSBS 61119060
         IECRES FREE,A=(1),PREFIX=YES,STM=(2,14,WTGPREFX)      @G18MSBS 61121060
*                                                              @G18MSBS 61123060
         BR    RET                      RETURN TO CALLER       @G18MSBS 61125060
         SPACE 1                                               @G18MSBS 61127060
DAMVTEST EQU   *                        TEST AUTHORIZED CALLER @G18MSBS 61129060
         BALR  RF,R0                   ESTABLISH ADDRESSABILITY@ZA29779 61131060
         USING *,RF                                            @ZA29779 61131460
         TESTAUTH KEY=YES,FCTN=1        TEST AUTHORIZATION     @G18MSBS 61131860
         DROP  RF                                              @ZA29779 61132260
         BR    RET                      RETURN TO CALLER       @G18MSBS 61133060
         EJECT                                                          61135060
*                                                                       61137060
*********************************************************************** 61146103
*                                                                       61196103
*        CONSTANTS                                                      61246103
*                                                                       61296103
*********************************************************************** 61346103
*                                                                Y02080 61396103
DAMVER19 DC    AL1(0)                   OPEN ERROR CODES         Y02080 61446103
         DC    AL1(27)                  CODE 1 = 413-20          Y02080 61496103
         DC    AL1(216)                 CODE 2 = 213-0C          Y02080 61546103
         DC    AL1(30)                  CODE 3 = 213-04          Y02080 61596103
         DC    AL1(36)                  CODE 4 = 313-04          Y02080 61646103
         DC    AL1(41)                  CODE 5 = 913-14          Y02083 61696103
         DC    AL1(214)                 CODE 6 = 03D-04          Y02080 61746103
         DC    AL1(215)                 CODE 7 = 03D-08          Y02080 61796103
         DC    AL1(230)                 CODE 8 = 213-20          Y02134 61846103
         DC    AL1(231)                 CODE 9 = 213-24          Y02134 61896103
         DC    AL1(53)                  CODE 10 = 013-14         Y02134 61946103
         DC    AL1(243)                 CODE 11 = 913-2C         Y02082 61996103
         DC    AL1(239)                 CODE 12 = 913-28         Y02083 62046103
         DC    AL1(28)                  CODE 13 = 713-08         YM6514 62096103
         DC    AL1(112)                 CODE 14 = 413-30       @Y30LSFY 62106103
         DC    AL1(232)                 CODE 15 = 03D-0C       @ZA02225 62110132
         DC    AL1(141)                 CODE 16 = 913-38       @Z40RSDH 62114132
         DC    AL1(0)                   CODE 17 = CANNOT OCCUR @Z40RSDH 62118132
         DC    AL1(142)                 CODE 18 = 913-3C       @Z40RSDH 62122132
         DC    AL1(143)                 CODE 19 = 913-40       @Z40RSDH 62126132
         DC    AL1(0)                   CODE 20 = CANNOT OCCUR @Z40RSDH 62130132
         DC    AL1(253)                 CODE 21 = 413-34       @ZM44627 62134132
         DC    AL1(0)                   CODE 22 = CANNOT OCCUR @G32DSMI 62140332
         DC    AL1(242)                 CODE 23 = 213-2C       @G60ASRB 62141360
         DC    AL1(31)                  CODE 24 = 213=18       @G60ASRB 62142360
*                                                                Y02134 62146103
DAMVER55 DC    AL1(0)                   EOV  ERROR CODES         Y02080 62196103
         DC    AL1(189)                 CODE 1 = 737-08          Y02080 62246103
         DC    AL1(171)                 CODE 2 = 737-0C          Y02080 62296103
         DC    AL1(190)                 CODE 3 = 737-04          Y02080 62346103
         DC    AL1(178)                 CODE 4 = 737-1C          Y02080 62396103
         DC    AL1(0)                   CODE 5 = CANNOT OCCUR    Y02080 62446103
         DC    AL1(0)                   CODE 6 = CANNOT OCCUR    Y02080 62496103
         DC    AL1(0)                   CODE 7 = CANNOT OCCUR    Y02080 62546103
         DC    AL1(230)                 CODE 8 = C37-04          Y02134 62596103
         DC    AL1(231)                 CODE 9 = C37-08          Y02134 62646103
         DC    AL1(240)                 CODE 10 = 937-10         Y02083 62696103
         DC    AL1(241)                 CODE 11 = 937-14         Y02083 62746103
         DC    AL1(0)                   CODE 12 = CANNOT OCCUR   Y02083 62796103
         DC    AL1(189)                 CODE 13 = 737-08         YM6514 62846103
         DC    AL1(112)                 CODE 14 = 737-38       @Y30LSFY 62856103
         DC    AL1(0)                   CODE 15 = CANT OCCUR   @ZA02225 62860132
         DC    AL1(1)                   CODE 16 = 937-28       @Z40RSDH 62864132
         DC    AL1(2)                   CODE 17 = 937-2C       @Z40RSDH 62868132
         DC    AL1(3)                   CODE 18 = 937-30       @Z40RSDH 62872132
         DC    AL1(4)                   CODE 19 = 937-34       @Z40RSDH 62876132
         DC    AL1(6)                   CODE 20 = 937-3C       @Z40RSDH 62880132
         DC    AL1(250)                 CODE 21 = 737-28       @G18MSBS 62884132
         DC    AL1(7)                   CODE 22 = 937-40       @G32DSMI 62890332
         DC    AL1(113)                 CODE 23 = 737-3C       @G60ASRB 62896160
         DC    AL1(190)                 CODE 24 = 737-04       @G60ASRB 62900160
DAMVERFF EQU   DAMVER55-DAMVER19        LENGTH OF CODE LIST      Y02083 62904160
DAMVZERO DC    XL3'0'                   ZEROS                  @G60ASRB 62908160
*                                                              @G60ASRB 62912160
DAMVWRF1 DS    0D                       WRITE F1DSCB CCWS      @G60ASRB 62916160
         CCW   CCWSCHID,K0,CCWCMDCH,K5  SEARCH ID EQUAL        @G60ASRB 62920160
         CCW   CCWTIC,K0,K0,K0          TIC                    @G60ASRB 62924160
         CCW   CCWWRTDA,K0,K0,DS1END-DS1FMTID WRITE DATA       @G60ASRB 62928160
LOCKERR  DMABCOND PCK,SETLOCK           SETLOCK ERROR ANALYSIS @G60ASRB*62932160
                                        ROUTINE                @G60ASRB 62934160
DAMVEOV2 DC    CL3'055'                 EOV MOD ID             @G60ASRB 62936160
IFG0EX0A DC    C'IFG0EX0A'              DSCB-NOT-FOUND EXIT    @G60ASRB 62941160
         EJECT                                                          62946103
*                                       CHANGED FOLLOWING LINE @G60ASBJ 62996160
         XCTLTABL BRT=YES,LENGTH=,ID=(EX0A,IFG0EX0A)                    63006160
         IECDSECS EXPAND=YES            EXPAND DESIRED DSECTS    YM3070 63046103
         EJECT                                                          63096103
         IDDVDSCB                                                Y02132 63146103
         EJECT                                                          63196103
WACCW    DSECT                                                   Y02082 63246103
WACCW1   DS    D                        EXTENDED CCW 1           Y02082 63296103
WACCW2   DS    D                        EXTENDED CCW 2           Y02082 63346103
WACCW3   DS    D                        EXTENDED CCW 3           Y02082 63396103
WACCW4   DS    D                        EXTENDED CCW 4           Y02082 63446103
WACCW5   DS    D                        EXTENDED CCW 5           Y02082 63496103
WACCW6   DS    D                        EXTENDED CCW 6           Y02082 63546103
WACCW7   DS    D                        EXTENDED CCW 7           Y02082 63596103
WACCW8   DS    D                        EXTENDED CCW 8           Y02082 63646103
WACCW9   DS    D                        EXTENDED CCW 9           Y02082 63696103
         EJECT                                                          63746132
         IEFJSSOB MO,CONTIG=YES                                @G18MSBS 63796132
DASSOBAD DS    A                        SSOB PARM PTR          @G18MSBS 63846132
SSOBSAVE DS    10D                      SSOB SAVE AREA         @G18MSBS 63896132
SSOBSIZE EQU   *-SSOB                   SIZE OF GETMAIN        @G18MSBS 63946132
         EJECT                                                          63996132
         IEFJESCT                                              @G18MSBS 64046132
         EJECT                                                          64096132
JCTABLE  DSECT                                                 @G18MSBS 64146132
         IEFAJCTB                                              @G18MSBS 64196132
         EJECT                                                          64246132
SCTABLE  DSECT                                                 @G18MSBS 64296132
         IEFASCTB                                              @G18MSBS 64346132
         EJECT                                                          64396132
F1AREA   DSECT                                                 @G60ASRB 87776160
*                                                              @G60ASRB 87826160
*        THIS DSECT DESCRIBES THE AREA INTO WHICH A FORMAT 1   @G60ASRB 87876160
*        DSCB IS READ.  F1DSN EXISTS ONLY IF A PDS.            @G60ASRB 87926160
*                                                              @G60ASRB 87976160
F1DSN    DS    CL(L'JFCBDSNM)           DATASET NAME           @G60ASRB 88026160
F1DATA   DS    CL(DS1END-DS1FMTID)      DATA AREA OF DSCB      @G60ASRB 88076160
F1NEXT   DS    F                        CHAIN TO NEXT DSCB     @G60ASRB 88126160
F1UCB    DS    F                        UCB                    @G60ASRB 88176160
F1CCHHR  DS    CL5                      CCHHR OF FORMAT 1 DSCB @G60ASRB 88226160
F1POLTH  EQU   *-F1DSN                  LENGTH IF A PDS        @G60ASRB 88276160
F1LTH    EQU   *-F1DATA                 LENTH IF NOT A PDS     @G60ASRB 88326160
         EJECT                                                          88376160
         END                                                            88426160
