 TITLE 'IFCSAXXX - VTAM RECORD SUMMARY'                                 00060042
*          THIS MODULE IN SUPPORT OF                            XL03004 00120042
         MACRO                                                          00180042
&NAME    DSGEN ,                                                        00240042
.*                            THIS MACRO GENERATES ONE DSECT WORD       00300042
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00360042
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  00420042
.*                                 FIRST IS THE NAME OF THE LOG ITEM    00480042
.*                                 WHILE THE SECOND IS THE # OF BITS TO 00540042
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   00600042
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 00660042
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      00720042
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  00780042
.*                                 THE LOG ITEMS MAY THEN BE USED IN    00840042
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   00900042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             00960042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  01020042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  01080042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              01140042
         GBLA  &NRENTS,&SHIFT(2600)                                     01200042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           01260042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       01320042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         01380042
         LCLB  &ONLY1,&CTIND                                            01440042
         LCLA  &START1,&START2,&END1,&END2                              01500042
         LCLC  &SYMBOL,&EQUSYM                                          01560042
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 01620042
         ACTR  100000                                                   01680042
         AIF   (&ITEMITR EQ 0).START                                    01740042
 MNOTE   20,'DSGEN MACRO OCCURRS AFTER ITEMSORT MACRO HAS BEEN ISSUED.' 01800042
         MEXIT                                                          01860042
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            01920042
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     01980042
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   02040042
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        02100042
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            02160042
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             02220042
         AGO   .SET2A                   BRANCH AROUND                   02280042
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        02340042
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              02400042
         MEXIT                                                          02460042
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X02520042
               ).SET2                   TEST FOR NO SECOND              02580042
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   02640042
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            02700042
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              02760042
         AGO   .LOOP                                                    02820042
.SET2    ANOP                                                           02880042
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 02940042
         AGO   .LOOP                                                    03000042
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             03060042
         MEXIT                                                          03120042
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               03180042
         MEXIT                                                          03240042
.LOOP    ANOP                                                           03300042
&OP      SETA  &OP+1                                                    03360042
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           03420042
&ITEMNBR SETA  &ITEMNBR+1                                               03480042
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            03540042
         MNOTE '**NULL BIT COUNT FIELD**'                               03600042
         MEXIT                                                          03660042
.OK1     ANOP                                                           03720042
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        03780042
         AIF   ('&SYMBOL' NE '').OK                                     03840042
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         03900042
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         03960042
         AGO   .START                   GET NEXT                        04020042
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        04080042
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          04140042
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        04200042
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         04260042
         AGO   .NO3                     BRANCH AROUND                   04320042
.OK2     ANOP                                                           04380042
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              04440042
.NO3     ANOP                                                           04500042
&SYMBOL  EQU   *+&BYTE                                                  04560042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             04620042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    04680042
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    04740042
.CNT     ANOP                                                           04800042
&CTIND   SETB  1                        SET COUNT INDICATOR             04860042
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   04920042
&BYTE    SETA  &COUNT/8                                                 04980042
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        05040042
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        05100042
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             05160042
&END1    SETA  &END1+1                  INCREMENT COUNT                 05220042
&OP      SETA  &OP-1                    DECREMENT INCREMENT             05280042
         AGO   .LOOP                    GENERATE NEXT                   05340042
.TSTST   ANOP                                                           05400042
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               05460042
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        05520042
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      05580042
.NSET1   ANOP                                                           05640042
&OP      SETA  &OP-1                    DECREMENT INDEX                 05700042
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           05760042
         AGO   .LOOP                    GO DO NEXT                      05820042
.LPDONE  ANOP                                                           05880042
&ONLY1   SETB  0                        CLEAR INDICATOR                 05940042
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      06000042
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 06060042
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               06120042
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             06180042
&NAME    DS    &COUNT.C                                                 06240042
.END     MEXIT                                                          06300042
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          06360042
         MEXIT                                                          06420042
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   06480042
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   06540042
         MEXIT                                                          06600042
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         06660042
*****               THE FOLLOWING STATEMENT                *****        06720042
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        06780042
.EQU2    ANOP                                                           06840042
&EQUCNT  SETA  0                        CLEAR COUNTER                   06900042
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 06960042
.EQULOP  ANOP                                                           07020042
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 07080042
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     07140042
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                07200042
         AGO   .EQULOP                  NO-GET NEXT                     07260042
.EQUOUT  ANOP                                                           07320042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  07380042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              07440042
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 07500042
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             07560042
         AGO   .START                   RETURN FOR NEXT                 07620042
         MEND                                                           07680042
         MACRO                                                          07740042
         HEX   ,                                                        07800042
.*                            THIS MACRO FACILITATES GENERATION OF THE  07860042
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    07920042
.*                                 CONVERSIONS.                         07980042
.*                            &SYSLIST(&OP,1) - NAME OF DATA ITEM TO BE 08040042
.*                                 CONVERTED                            08100042
.*                            &SYSLIST(&OP,2) - # OF SPACES TO SKIP ON  08160042
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   08220042
.*                                 BACK UP FROM COLUMN FOR START OF     08280042
.*                                 PRINTING. THE LETTER B PRECEEDS THE  08340042
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  08400042
.*                                 DESIRED. OMISSION OF THIS OPERAND    08460042
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  08520042
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  08580042
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 08640042
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    08700042
.*                                 IMPLICITLY B).                       08760042
.*                            &SYSLIST(&OP,3) - NUMBER OF BYTES TO      08820042
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     08880042
.*                                 WITH AN L,R, OR B TO STIPULATE       08940042
.*                                 PRINTING OF THE LEFT HALF, RIGHT     09000042
.*                                 HALF, OR BOTH HALVES OF THE BYTE     09060042
.*                                 RESPECTIVELY. OMISSION OF THIS       09120042
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  09180042
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 09240042
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 09300042
.*                                 SARY. THIS MACRO MUST BE THE FIRST   09360042
.*                                 MACRO INSTRUCTION ISSUED FOR THE     09420042
.*                                 SUBJECT LINE(S).                     09480042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             09540042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  09600042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  09660042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              09720042
         GBLA  &NRENTS,&SHIFT(2600)                                     09780042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           09840042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       09900042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         09960042
         LCLB  &B,&SUB                                                  10020042
         LCLA  &IBITS,&ISHIFT,&K,&T,&CODE,&BYTESP,&OP                   10080042
         LCLC  &S,&LETTER,&ARG                                          10140042
       ACTR  500000                                                     10200042
         AIF   (&DIAGTST EQ 0).NOMSG                                    10260042
         AIF   (&INITIAL EQ 0).NOMSG                                    10320042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    10380042
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  10440042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     10500042
*        LINE                                                           10560042
         LINE                                                           10620042
.NOMSG   ANOP                                                           10680042
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  10740042
&SUB     SETB  1                                                        10800042
.LOOP    ANOP                                                           10860042
&OP      SETA  &OP+1                                                    10920042
&ARG     SETC  '&SYSLIST(&OP,1)'                                        10980042
         ITEMFIND  &ARG                                                 11040042
         AIF   (&ITEMXPT EQ 0).MEXIT                                    11100042
.FOUND   ANOP                                                           11160042
&ISHIFT  SETA  &SHIFT(&ITEMXPT)                                         11220042
&IBITS   SETA  &BITS(&ITEMXPT)                                          11280042
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).ALIGN                     11340042
.ERR     MNOTE '**DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY**'          11400042
.MEXIT   MEXIT                                                          11460042
.ALIGN   ANOP                                                           11520042
&CODE    SETA  1                                                        11580042
         AIF   (&SUB EQ 1).SUBA                                         11640042
&K       SETA  K'&SYSLIST(3)                                            11700042
         AGO   .SUBB                                                    11760042
.SUBA    ANOP                                                           11820042
&K       SETA  K'&SYSLIST(&OP,3)                                        11880042
.SUBB    ANOP                                                           11940042
         AIF   (&K EQ 1).ERR3                                           12000042
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            12060042
         MNOTE '**BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL**' 12120042
         MEXIT                                                          12180042
.OK      AIF   (&SUB EQ 1).SUBC                                         12240042
         AIF   ('&SYSLIST(3)' EQ '').USEDEFN                            12300042
&LETTER  SETC  '&SYSLIST(3)'(&K,1)                                      12360042
&S       SETC  '&SYSLIST(3)'(1,&K-1)                                    12420042
         AGO   .SUBD                                                    12480042
.SUBC    ANOP                                                           12540042
         AIF   ('&SYSLIST(&OP,3)' EQ '').USEDEFN                        12600042
&LETTER  SETC  '&SYSLIST(&OP,3)'(&K,1)                                  12660042
&S       SETC  '&SYSLIST(&OP,3)'(1,&K-1)                                12720042
.SUBD    ANOP                                                           12780042
&BYTESP  SETA  &S                                                       12840042
         AIF   ('&LETTER' EQ 'B').BOTH                                  12900042
         AIF   ('&LETTER' EQ 'L').LEFT                                  12960042
         AIF   ('&LETTER' EQ 'R').RIGHT                                 13020042
.ERR3    MNOTE '**PARAMETER 3 INCOMPLETE-DSGEN DEFINITION USED**'       13080042
         AGO   .USEDEFN                                                 13140042
.RIGHT   ANOP                                                           13200042
&CODE    SETA  2                                                        13260042
         AGO   .L                                                       13320042
.LEFT    ANOP                                                           13380042
&CODE    SETA  1                                                        13440042
         AGO   .L                                                       13500042
.USEDEFN ANOP                                                           13560042
&BYTESP  SETA  &IBITS/8                                                 13620042
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       13680042
&CODE    SETA  3                                                        13740042
&T       SETA  &BYTESP*2-1                                              13800042
&S       SETC  '&T'                                                     13860042
.OK2     AIF   (&ISHIFT EQ 0).L                                         13920042
&CODE    SETA  2                                                        13980042
.L       ANOP                                                           14040042
&B       SETB  1                                                        14100042
         AIF   (&SUB EQ 1).SUBE                                         14160042
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             14220042
&K       SETA  K'&SYSLIST(2)                                            14280042
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              14340042
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                14400042
         AGO   .SUBF                                                    14460042
.SUBE    ANOP                                                           14520042
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         14580042
&K       SETA  K'&SYSLIST(&OP,2)                                        14640042
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          14700042
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            14760042
.SUBF    ANOP                                                           14820042
.BACKUP  ANOP                                                           14880042
&NRENTS  SETA  &NRENTS+1                                                14940042
         AIF   (&BYTESP GT 0 AND &BYTESP LT 16).SUB0                    15000042
         MNOTE '**NO. OF BYTES OUTSIDE RANGE OF 1-15**'                 15060042
         MEXIT                                                          15120042
.SUB0    AIF   (&SUB EQ 1).SUBG                                         15180042
         DC    AL.12(&SYSLIST(1)-&DSECT),XL.4'A'                        15240042
         AGO   .SUBH                                                    15300042
.SUBG    ANOP                                                           15360042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'A'                    15420042
.SUBH    ANOP                                                           15480042
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'              15540042
.OUT     ANOP                                                           15600042
&ITEMXPT     SETA  0                                                    15660042
         AIF   (&SUB EQ 0).OUTA                                         15720042
         AIF   (&OP LT N'&SYSLIST).LOOP                                 15780042
.OUTA    ANOP                                                           15840042
         MEND                                                           15900042
         MACRO                                                          15960042
         BIN   ,                                                        16020042
.*                                 &SYSLIST(&OP,1) - NAME OF LOG ITEM   16080042
.*                                      RECORD DSECT                    16140042
.*                                 $SYSLIST(&OP,2) - NBR OF SPACES      16200042
.*                                      TO SKIP ON MULTIPLE             16260042
.*                                      PRINT OR NBR OF SPACES          16320042
.*                                      TO BACK UP FROM COLUMN FOR      16380042
.*                                      START OF PRINTING. THE LETTER   16440042
.*                                      B PRECEEDS THE NUMBER (B5) IF   16500042
.*                                      THE LATTER IS DESIRED. OMISSION 16560042
.*                                      OF THIS OPERAND FORCES OPTION 2 16620042
.*                                      WITH BACKUP SPACING EQUAL TO    16680042
.*                                 THE NUMBER OF BITS IN THE ITEM       16740042
.*                                 DEFINITION (VIA MACRO 'DSGEN').      16800042
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     16860042
.*                                 TOTAL NUMBER OF BITS TO PRINT.       16920042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             16980042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  17040042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  17100042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              17160042
         GBLA  &NRENTS,&SHIFT(2600)                                     17220042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           17280042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       17340042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         17400042
         LCLB  &B,&SUB                                                  17460042
         LCLA  &IBITS,&ISHIFT,&K                                        17520042
         LCLA  &TEMP,&T,&OP                                             17580042
         LCLC  &S,&ARG                                                  17640042
          ACTR  500000                                                  17700042
         AIF   (&DIAGTST EQ 0).NOMSG                                    17760042
         AIF   (&INITIAL EQ 0).NOMSG                                    17820042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    17880042
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  17940042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     18000042
*        LINE                                                           18060042
         LINE                                                           18120042
.NOMSG   ANOP                                                           18180042
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  18240042
&SUB     SETB  1                                                        18300042
.LOOP    ANOP                                                           18360042
&OP      SETA  &OP+1                                                    18420042
&ARG     SETC  '&SYSLIST(&OP,1)'                                        18480042
         ITEMFIND &ARG                                                  18540042
         AIF   (&ITEMXPT EQ 0).MEXIT                                    18600042
&ISHIFT  SETA  &SHIFT(&ITEMXPT)                                         18660042
&IBITS   SETA  &BITS(&ITEMXPT)                                          18720042
         AIF   (&SUB EQ 1).SUB00                                        18780042
         AIF   ('&SYSLIST(3)' EQ '').SETT                               18840042
&IBITS   SETA  &SYSLIST(3)                                              18900042
         AGO   .SETT                                                    18960042
.SUB00   AIF   ('&SYSLIST(&OP,3)' EQ '').SETT                           19020042
&IBITS   SETA  &SYSLIST(&OP,3)                                          19080042
.SETT    ANOP                                                           19140042
&T       SETA  &IBITS-1                                                 19200042
&B       SETB  0                                                        19260042
         AIF   (&IBITS GT 0 AND &IBITS LT 16).SUB0                      19320042
         MNOTE '**NO. OF BITS OUTSIDE RANGE OF 1-15**'                  19380042
.MEXIT   MEXIT                                                          19440042
.SUB0    AIF   (&SUB EQ 1).SUBA                                         19500042
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             19560042
&K       SETA  K'&SYSLIST(2)                                            19620042
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              19680042
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                19740042
         AGO   .SUBB                                                    19800042
.SUBA    ANOP                                                           19860042
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         19920042
&K       SETA  K'&SYSLIST(&OP,2)                                        19980042
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          20040042
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            20100042
.SUBB    ANOP                                                           20160042
&T       SETA  &S                                                       20220042
.BACKUP  ANOP                                                           20280042
&NRENTS  SETA  &NRENTS+1                                                20340042
&TEMP    SETA  &ISHIFT                                                  20400042
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2                            20460042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'                20520042
         AGO   .OUT                                                     20580042
         AIF   (&SUB EQ 1).BIN2                                         20640042
         AIF   ('&SYSLIST(2)' NE '').BIN3                               20700042
         AGO   .BIN2A                                                   20760042
.BIN2    AIF   ('&SYSLIST(&OP,2)' NE '').BIN3                           20820042
.BIN2A   ANOP                                                           20880042
&B       SETB  1                                                        20940042
.BIN3    ANOP                                                           21000042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'                    21060042
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             21120042
.OUT     ANOP                                                           21180042
&ITEMXPT     SETA  0                                                    21240042
         AIF   (&SUB EQ 0).OUTA                                         21300042
         AIF   (&OP LT N'&SYSLIST).LOOP                                 21360042
.OUTA    ANOP                                                           21420042
         MEND                                                           21480042
         MACRO                                                          21540042
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      21600042
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     21660042
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    21720042
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 21780042
.*                                 ENTRIES. LASTLY IT DETERMINES THE    21840042
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    21900042
.*                                 THE PREVIOUS LINE AND STORES THAT #  21960042
.*                                 INTO THE APPROPRIATE BYTE.           22020042
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    22080042
.*                                 DATA.                                22140042
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 22200042
.*                                 DATA COLUMN STARTING CHARACTERS.     22260042
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   22320042
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 22380042
.*                                 STARTING CHARACTERS.                 22440042
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   22500042
.*                                 TO BEGIN NEXT PRINTED LINE.          22560042
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       22620042
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   22680042
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 22740042
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   22800042
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 22860042
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    22920042
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   22980042
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   23040042
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  23100042
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   23160042
.*                                 THE SUBJECT LINE                     23220042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             23280042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  23340042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  23400042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              23460042
         GBLA  &NRENTS,&SHIFT(2600)                                     23520042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           23580042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       23640042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         23700042
         LCLA  &S                                                       23760042
         AIF   (&INITIAL EQ 0 OR &DIAGTST EQ 0).DIAGSET                 23820042
         AIF   (&DIAGSET EQ 0).DIAGSET                                  23880042
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  23940042
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   24000042
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       24060042
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 24120042
.DIAGSET ANOP                                                           24180042
&DIAGSET SETB  1                                                        24240042
&DIAGLIN SETB  1                                                        24300042
&NAME    DS    0C                                                       24360042
         AIF   (&INITIAL EQ 0).FIRSTLN                                  24420042
         LINEND                                                         24480042
         AGO   .NTFIRST                                                 24540042
.FIRSTLN ANOP                                                           24600042
&NRENTSX SETC  'N&SYSNDX'                                               24660042
&INITIAL SETA  1                                                        24720042
N&SYSNDX EQU   *                                                        24780042
.NTFIRST ANOP                                                           24840042
         DC    AL1(0)                                                   24900042
         AIF   ('&DATA(1)' EQ '').CKDTABS                               24960042
         AIF   (&DATA(1) EQ &DB).CKDTABS                                25020042
&DB      SETA  &DATA(1)                                                 25080042
         AGO   .AA                                                      25140042
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                25200042
         AIF   (&DATA(2) EQ &DT).NCDATA                                 25260042
         AGO   .CC                                                      25320042
.AA      AIF   ('&DATA(2)' EQ '').BB                                    25380042
         AIF   (&DATA(2) EQ &DT).BB                                     25440042
.CC      ANOP                                                           25500042
&DT      SETA  &DATA(2)                                                 25560042
.BB      DC    XL2'FFFE'                                                25620042
         DC    FL1'&DB'                                                 25680042
         DC    FL1'&DT'                                                 25740042
&NRENTS  SETA  &NRENTS+1                                                25800042
.NCDATA  ANOP                                                           25860042
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              25920042
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               25980042
&LB      SETA  &LABEL(1)                                                26040042
         AGO   .AAA                                                     26100042
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              26160042
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               26220042
         AGO   .CCC                                                     26280042
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  26340042
         AIF   (&LABEL(2) EQ &LT).BBB                                   26400042
.CCC     ANOP                                                           26460042
&LT      SETA  &LABEL(2)                                                26520042
.BBB     DC    XL2'FFFF'                                                26580042
         DC    FL1'&LB'                                                 26640042
         DC    FL1'&LT'                                                 26700042
&NRENTS  SETA  &NRENTS+1                                                26760042
.NCLABEL ANOP                                                           26820042
         AIF   ('&SKIP' NE '').CONT                                     26880042
         AIF   (&TEST EQ 0).NOCHANG                                     26940042
         AGO   .DEFALTA                                                 27000042
.CONT    ANOP                                                           27060042
         AIF   (&TEST EQ 0).AB                                          27120042
         AIF   ('&SKIP' EQ 'E').AB                                      27180042
&S       SETA  &SKIP                                                    27240042
.DEFAULT ANOP                                                           27300042
         AIF   (&SKIP EQ &LASTCC).DEFALTA                               27360042
         ORG   &CARRCON+3                                               27420042
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 27480042
         ORG                                                            27540042
&LASTCC  SETA  &S                                                       27600042
.DEFALTA ANOP                                                           27660042
&TEST    SETB  0                                                        27720042
         AGO   .DD                                                      27780042
.AB      AIF   ('&SKIP' NE 'E').ABB                                     27840042
A&SYSNDX DC    X'FFFB8B00'              EJECT                           27900042
         AGO   .ABC                                                     27960042
.ABB     AIF   (&SKIP EQ &LASTCC).NOCHANG                               28020042
A&SYSNDX DC    XL2'FFFB'                                                28080042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              28140042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              28200042
&LASTCC  SETA  &SKIP                                                    28260042
&TEST    SETB  1                                                        28320042
.ABC     ANOP                                                           28380042
&CARRCON SETC  'A&SYSNDX'                                               28440042
&NRENTS  SETA  &NRENTS+1                                                28500042
.DD      ANOP                                                           28560042
.NOCHANG ANOP                                                           28620042
         MEND                                                           28680042
         MACRO                                                          28740042
         LINEND ,                                                       28800042
.*                                 THIS MACRO IS USED ONLY BY THE LINE  28860042
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   28920042
.*                                 ASSOCIATED WITH EACH LINE.           28980042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             29040042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  29100042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  29160042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              29220042
         GBLA  &NRENTS,&SHIFT(2600)                                     29280042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           29340042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       29400042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         29460042
         ORG   &NRENTSX                                                 29520042
         DC    FL1'&NRENTS'                                             29580042
         ORG                                                            29640042
&NRENTS  SETA  0                                                        29700042
B&SYSNDX EQU   *                                                        29760042
&NRENTSX SETC  'B&SYSNDX'                                               29820042
         MEND                                                           29880042
           MACRO                                                        29940042
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C30000042
               &LABEL7,&LABEL8                                          30060042
.*                                 THIS MACRO ALLOWS LABELS TO          30120042
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   30180042
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  30240042
.*                                 TION MARKS. THE COLUMN AND LINE END  30300042
.*                                 CONTROLS WILL BE INSERTED BY THE     30360042
.*                                 MACRO. OMITTED OPERANDS MEAN NO      30420042
.*                                 LABEL REQUIRED FOR RESPECTIVE        30480042
.*                                 COLUMN.                              30540042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             30600042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  30660042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  30720042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              30780042
         GBLA  &NRENTS,&SHIFT(2600)                                     30840042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           30900042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       30960042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         31020042
         LCLC  &MARGIN,&TACK                                            31080042
         LCLC  &TEXT                                                    31140042
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            31200042
         AIF   (&INITIAL EQ 0).DIAGCLR                                  31260042
         AIF   (&DIAGTST EQ 0).DIAGCLR                                  31320042
         AIF   (&DIAGLIN EQ 1).DIAGCLR                                  31380042
         MNOTE '**NO LINE ASSOCIATED WITH PREVIOUS LABEL**'             31440042
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   31500042
*        LINE                                                           31560042
         LINE                                                           31620042
.DIAGCLR ANOP                                                           31680042
&DIAGSET SETB  0                                                        31740042
&DIAGLIN SETB  0                                                        31800042
&MARGIN  SETC  '*'                                                      31860042
         AIF   ('&NAME' EQ '').LOOPOUT                                  31920042
&LPTR    SETA  &LPTR+1                                                  31980042
&LBL(&LPTR) SETC '&NAME'                                                32040042
&LBLCTR(&LPTR) SETA &LABELNR+1                                          32100042
.LOOPOUT ANOP                                                           32160042
&OP      SETA  &OP+1                                                    32220042
&K       SETA  K'&SYSLIST(&OP)                                          32280042
         AIF (&K GE 2).NORM                                             32340042
&K       SETA  2                                                        32400042
.NORM    ANOP                                                           32460042
&START   SETA  2                                                        32520042
         AIF (&OP LT N'&SYSLIST).NOTLAST                                32580042
&MARGIN  SETC  '$'                                                      32640042
.NOTLAST ANOP                                                           32700042
&NRCHAR  SETA  8                                                        32760042
&TACK    SETC  ''                                                       32820042
.LOOPIN  ANOP                                                           32880042
&REMAIN  SETA  &K-&START                                                32940042
         AIF (&REMAIN GE 8).MORE                                        33000042
&TACK    SETC  '&MARGIN'                                                33060042
&NRCHAR  SETA  &REMAIN                                                  33120042
.MORE    ANOP                                                           33180042
&TEXT    SETC  ''                                                       33240042
         AIF (&REMAIN EQ 0).ENDTEXT                                     33300042
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          33360042
.ENDTEXT ANOP                                                           33420042
&LABELNR SETA  &LABELNR+1                                               33480042
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  33540042
&START   SETA  &START+8                                                 33600042
         AIF ('&TACK' EQ '').LOOPIN                                     33660042
         AIF ('&TACK' EQ '*').LOOPOUT                                   33720042
         MEND                                                           33780042
         MACRO                                                          33840042
&NAME    ROUTINE &LOGITEM,&RNAME                                        33900042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             33960042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  34020042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  34080042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              34140042
         GBLA  &NRENTS,&SHIFT(2600)                                     34200042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           34260042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       34320042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         34380042
         AIF   (&DIAGTST EQ 0).NOMSG                                    34440042
         AIF   (&INITIAL EQ 0).NOMSG                                    34500042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    34560042
         MNOTE '**NO LINE ASSOCIATED WITH THIS ROUTINE**'               34620042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     34680042
*        LINE                                                           34740042
         LINE                                                           34800042
.NOMSG   ANOP                                                           34860042
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           34920042
         DC    AL2(&RNAME-&CSECT)                                       34980042
&NRENTS  SETA  &NRENTS+1                                                35040042
         MEND                                                           35100042
         MACRO                                                          35160042
         ITEMFIND &ARG,&ITFDIAG=                                        35220042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             35280042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  35340042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  35400042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              35460042
         GBLA  &NRENTS,&SHIFT(2600)                                     35520042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           35580042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       35640042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         35700042
         LCLA  &A,&B,&X,&I                                              35760042
         LCLC  &C1,&C2,&S                                               35820042
         ACTR  100000                                                   35880042
&ITEMXPT SETA  0                  INDICATE ITEM NOT FOUND.              35940042
         AIF   ('&ARG' NE '').NORM                                      36000042
         AIF   ('&ITFDIAG' EQ 'OFF'  OR  '&ITFDIAG' EQ 'ON').DIAGSET    36060042
  MNOTE 0,'ITEMFIND - OPERAND (&ITFDIAG) INVALID FOR ITFDIAG KEYWORD.'  36120042
         MEXIT                                                          36180042
.DIAGSET ANOP                                                           36240042
&DIAGITF SETB  ('&ITFDIAG' EQ 'ON')                                     36300042
         MEXIT                                                          36360042
.NORM    AIF   (&ITEMITR GT 0).SORTED                                   36420042
         ITEMSORT                                                       36480042
.SORTED  ANOP                                                           36540042
&I       SETA  &ITEMITR           COMPUTED ITTERATION COUNT.            36600042
&X       SETA  &ITEMMDX           COMPUTED MAXIMUM INDEX.               36660042
&C1      SETC  '&ARG'             ISOLATE SEARCH ARGUMENT.              36720042
&C1      SETC  '&C1'.'       '(1,8-K'&C1) PAD TO FULL 8 CHARACTERS.     36780042
.SRCHUP  ANOP                                                           36840042
&A       SETA  &A+&X              CURRENT TABLE SUBSCRIPT + INDEX.      36900042
&S       SETC  '+'                                                      36960042
         AIF   (&A  GT &ITEMNBR  AND  NOT &DIAGITF).SRCHDN1             37020042
         AIF   (&A  LE &ITEMNBR).SRCH00                                 37080042
&C2      SETC  '*-OVER-*'                                               37140042
&I       SETA  &I-1               DECREMENT ITTERATION COUNTER.         37200042
&X       SETA  &X/2               HALVE INDEX VALUE.                    37260042
 MNOTE *,'&ARG - &C2   ITRCTR = &I   PTR = &A&S &X'                     37320042
         AIF   (&I GE 0).SRCHDWN  IF ITTERATION COUNT NOT EXPIRED.      37380042
.NOFIND  MNOTE  20,' ITEMFIND FAILED FOR NAME  &C1  '                   37440042
         MEXIT                                                          37500042
.SRCH00  ANOP                                                           37560042
&I       SETA  &I-1               DECREMENT ITTERATION COUNTER.         37620042
         AIF   (&I LT 0).NOFIND   IF COUNT HAS GONE TO ZERO.            37680042
&X       SETA  &X/2               HALVE INDEX VALUE.                    37740042
&B       SETA  &ITEMNDX(&A)       GET SUBSCRIPT FROM INDEX TABLE.       37800042
&C2      SETC  '&ITEM(&B)'.'       '(1,8-K'&ITEM(&B))  PAD COMPARAND.   37860042
         AIF   (NOT &DIAGITF).COMPARE                                   37920042
 MNOTE *,'&ARG - &C2   ITRCTR = &I   PTR = &A&S &X   POS = &B'          37980042
.COMPARE AIF   ('&C1' LT '&C2').SRCHDWN   ARGUMENT LOWER, MOVE DOWN.    38040042
         AIF   ('&C1' GT '&C2').SRCHUP    ARGUMENT HIGHER, MOVE UP.     38100042
&ITEMXPT SETA  &B                 FOUND. SET INDEX POINTER FOR RETURN.  38160042
&ITEMFST(&I+1)  SETA  &ITEMFST(&I+1)+1                                  38220042
         MEXIT                                                          38280042
.SRCHDWN ANOP                                                           38340042
&A       SETA  &A-&X              CURRENT POINTER MINUS INDEX VALUE.    38400042
&S       SETC  '-'                                                      38460042
         AIF   (&A LE &ITEMNBR).SRCH00    IF WITHIN BOUNDS OF TABLE.    38520042
.SRCHDN1 ANOP                                                           38580042
&I       SETA  &I-1               DECREMENT ITTERATION COUNTER.         38640042
&X       SETA  &X/2               HALVE INDEX VALUE.                    38700042
         AIF   (&I GE 0).SRCHDWN  IF ITTERATION COUNT NOT EXPIRED.      38760042
         MNOTE  20,' ITEMFIND FAILED FOR NAME  &C1  '                   38820042
         MEND                                                           38880042
         MACRO                                                          38940042
         ITEMSORT  &DUMMY                                               39000042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             39060042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  39120042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  39180042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              39240042
         GBLA  &NRENTS,&SHIFT(2600)                                     39300042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           39360042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       39420042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         39480042
         LCLA  &R,&ZI,&I,&A1,&A2,&TEMP                                  39540042
         LCLB  &SR,&GOTO,&TB                                            39600042
         LCLB  &SW(3000)                                                39660042
         LCLC  &C1,&C2                                                  39720042
         ACTR  100000                                                   39780042
&A1      SETA  0                                                        39840042
         AIF   (&ITEMITR EQ 0).LOOP0   TEST FOR RE-ENTRY.               39900042
 MNOTE   0,'ITEMSORT MACRO OCCURRS MORE THAN ONCE. TABLE NOT RESORTED.' 39960042
         MEXIT                                                          40020042
.LOOP0   ANOP                                                           40080042
&A1      SETA  &A1+1                                                    40140042
&ITEMNDX(&A1) SETA &A1                                                  40200042
         AIF   (&A1 LT &ITEMNBR).LOOP0                                  40260042
         AIF   (&ITEMNBR LT 2).MEXIT                                    40320042
&A1      SETA  &ITEMNBR/2         HALF OF TOTAL ENTRIES.                40380042
&A2      SETA  0                                                        40440042
.LOOP1   ANOP                                                           40500042
&A2      SETA  &A2+1                                                    40560042
&SW(&A2) SETB  1                  SET FIRST HALF OF SWITCHES TO 1.      40620042
         AIF   (&A2 LT &A1).LOOP1                                       40680042
.LOOP2   ANOP                                                           40740042
&A2      SETA  &A2+1                                                    40800042
&SW(&A2) SETB  0                  SET SECOND HALF TO ZERO.              40860042
         AIF   (&A2 LT &ITEMNBR).LOOP2                                  40920042
&R       SETA  0                  SET R TO FIRST TRIAL ITEM.            40980042
&ZI      SETA  &ITEMNBR-1         SET ZI TO LAST ITEM.                  41040042
&I       SETA  &ZI-1                                                    41100042
.T3      ANOP                                                           41160042
&SR      SETB  (&SW(&R+1))        GET FLAG, WHICH WAY TO GO?            41220042
&R       SETA  (&R*2)+1+&SR       R=2R+(1 OR 2)                         41280042
         AIF   (&R LE &I).T3                                            41340042
.T4      ANOP                                                           41400042
&R       SETA  (&R-1)/2           R=(R-1)/2                             41460042
&SR      SETB  (&SW(&R+1))        GET SUBTREE SELECT FLAG.              41520042
         AIF   (&SR EQ 0).T7                                            41580042
         AIF   (&GOTO EQ 0).T5                                          41640042
.T7      ANOP                                                           41700042
&A1      SETA  &ITEMNDX(&R+1)                                           41760042
&A2      SETA  &ITEMNDX(&ZI+1)                                          41820042
&C1      SETC  '&ITEM(&A1)'.'       '(1,8-K'&ITEM(&A1))                 41880042
&C2      SETC  '&ITEM(&A2)'.'       '(1,8-K'&ITEM(&A2))                 41940042
         AIF   ('&C1' LT '&C2').T8                                      42000042
.T9      ANOP                                                           42060042
&TEMP    SETA  &ITEMNDX(&R+1)     Z(R) TO TEMP.                         42120042
&TB      SETB  (&SW(&R+1))                                              42180042
&ITEMNDX(&R+1) SETA &ITEMNDX(&ZI+1)    Z(I) TO Z(R)                     42240042
&SW(&R+1) SETB (&SW(&ZI+1))                                             42300042
&ITEMNDX(&ZI+1) SETA &TEMP        TEMP TO Z(I)                          42360042
&SW(&ZI+1) SETB (&TB)                                                   42420042
&SR      SETB  (&SR EQ 0)                                               42480042
&SW(&R+1) SETB (&SR)                                                    42540042
.T8      AIF   (&R GT 0).T4                                             42600042
&GOTO    SETB  1                  SET 'GO TO' T7                        42660042
&ZI      SETA  &ZI-1                                                    42720042
&I       SETA  &I-1                                                     42780042
         AIF   (&I GE 0).T3                                             42840042
.MEXIT   ANOP                                                           42900042
&ITEMITR SETA 1                                                         42960042
&ITEMMDX SETA 1                                                         43020042
.ITRLOOP ANOP                                                           43080042
&ITEMITR SETA &ITEMITR+1                                                43140042
&ITEMMDX SETA &ITEMMDX+&ITEMMDX                                         43200042
         AIF  (&ITEMMDX LT &ITEMNBR).ITRLOOP                            43260042
&ITEMITR SETA &ITEMITR-1                                                43320042
&ITEMMDX SETA &ITEMMDX/2                                                43380042
&A1      SETA &ITEMNBR                                                  43440042
&A2      SETA &ITEMMDX                                                  43500042
&TEMP    SETA &ITEMITR                                                  43560042
 MNOTE *,' ITEMS = &A1, MAX INDEX = &A2, ITTERATION COUNT = &TEMP'      43620042
         MEXIT                                                          43680042
.T5      ANOP                                                           43740042
&TEMP    SETA  &ITEMNDX(&R+1)     Z(R) TO TEMP.                         43800042
&TB      SETB  (&SW(&R+1))                                              43860042
&ITEMNDX(&R+1) SETA &ITEMNDX(&ZI+1)    Z(I) TO Z(R)                     43920042
&SW(&R+1) SETB (&SW(&ZI+1))                                             43980042
&ITEMNDX(&ZI+1) SETA &TEMP        TEMP TO Z(I)                          44040042
&SW(&ZI+1) SETB (&TB)                                                   44100042
&SR      SETB  (&SR EQ 0)                                               44160042
&SW(&R+1) SETB (&SR)                                                    44220042
         AGO   .T3                                                      44280042
         MEND                                                           44340042
         MACRO                                                          44400042
         LSTART ,                                                       44460042
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  44520042
.*                                 OF THE TABLE IS TO BEGIN.            44580042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             44640042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  44700042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  44760042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              44820042
         GBLA  &NRENTS,&SHIFT(2600)                                     44880042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           44940042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       45000042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         45060042
         LCLA  &NDX,&CTR                                                45120042
         ACTR  500000                                                   45180042
         AIF   (&DIAGTST EQ 0).NODIAG                                   45240042
         AIF   (&DIAGSET EQ 0).NODIAG                                   45300042
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  45360042
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   45420042
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       45480042
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 45540042
.NODIAG  ANOP                                                           45600042
         LINEND                                                         45660042
&CTR     SETA  1                                                        45720042
.LOOP    ANOP                                                           45780042
&NDX     SETA  &NDX+1                                                   45840042
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            45900042
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         45960042
&CTR     SETA  &CTR+1                                                   46020042
         AGO   .LOOPCTL                                                 46080042
.NOLBL   ANOP                                                           46140042
         DC    C'&LABELS(&NDX)'                                         46200042
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  46260042
         MEND                                                           46320042
         MACRO                                                          46380042
         CONVT ,                                                        46440042
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             46500042
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  46560042
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  46620042
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              46680042
         GBLA  &NRENTS,&SHIFT(2600)                                     46740042
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           46800042
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       46860042
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         46920042
         LCLB  &SUB                                                     46980042
         LCLA  &OP                                                      47040042
         LCLA  &OFFSET,&OUT,&IN,&IND,&IBITS,&ISHIFT                     47100042
.*                                                                      47160042
.*       CONVERT BINARY TO DECIMAL                                      47220042
.*             &NAME IS THE REFERENCE INTO THE DSECT RECORD             47280042
.*             &OUT    IS THE NUMBER OF CHARS TO BE PUT ONTO PRINT LINE 47340042
.*                                      DEFAULT IS FOUR MAXIMUM IS 8    47400042
.*             &IN       IS THE NUMBER OF BYTES AS INPUT                47460042
.*                                      ERROR DEFAULT IS 2 MAXIMUM IS 4 47520042
.*                                                                      47580042
         AIF   (&DIAGTST EQ 0).NOMSG                                    47640042
         AIF   (&INITIAL EQ 0).NOMSG                                    47700042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    47760042
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  47820042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     47880042
*        LINE                                                           47940042
         LINE                                                           48000042
.NOMSG   ANOP                                                           48060042
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LLOP                  48120042
&SUB     SETB  1                                                        48180042
.LLOP    ANOP                                                           48240042
&OP      SETA  &OP+1                                                    48300042
&OUT     SETA  4                        .BR NOT NULL ELSE SET TO 4      48360042
         AIF   (&SUB EQ 1).SUBA                                         48420042
         AIF   ('&SYSLIST(3)' EQ '').B  TEST FOR NULL INPUT             48480042
&OUT     SETA  &SYSLIST(3)             SET &OUT FROM INPUT              48540042
         AGO   .A                                                       48600042
.SUBA    AIF   ('&SYSLIST(&OP,3)' EQ '').B                              48660042
&OUT     SETA  &SYSLIST(&OP,3)          SET &OUT FROM INPUT             48720042
.A       AIF   (&OUT GT 0 AND &OUT LT 9).B   TEST RANGE                 48780042
.AERR    MNOTE '*** BYTES OUT INCORRECTLY SPECIFIED DEFAULT USED ***'   48840042
&OUT     SETA  4                                                        48900042
.B       AIF   (&SUB EQ 1).SUBB                                         48960042
         AIF   ('&SYSLIST(2)' EQ '').LOOP    BRANCH IF NULL             49020042
&IN      SETA  &SYSLIST(2)              .SET &IN FROM INPUT             49080042
         AGO   .BB                                                      49140042
.SUBB    AIF   ('&SYSLIST(&OP,2)' EQ '').LOOP                           49200042
&IN      SETA  &SYSLIST(&OP,2)          .SET &IN FROM INPUT             49260042
.BB      AIF   (&IN GT 0 AND &IN LT 5).D     TEST RANGE                 49320042
.BERR    MNOTE '*** BYTES IN INCORRECTLY SPECIFIED DEFAULT USED ***'    49380042
&IN      SETA  2                                                        49440042
         AGO   .D                                                       49500042
.LOOP    ANOP                           .LOOP TO FIND &NAME IN DSECT    49560042
&IND     SETA  &IND+1                   .SET UP LOOP COUNTER            49620042
         AIF   ('&ITEM(&IND)' EQ '&SYSLIST(&OP,1)').FOUND               49680042
         AIF   (&IND LT &ITEMNBR).LOOP  .TEST FOR END OF DSECT          49740042
         MNOTE '*** LOG ITEM NOT DEFINED ***'                           49800042
         MEXIT                                                          49860042
.FOUND   ANOP                                                           49920042
&IBITS   SETA  &BITS(&IND)              .SET UP NUMBER OF BITS SPEC     49980042
         AIF   (&IBITS-((&IBITS/8)*8) EQ 0).C  .TEST FOR MULTIPLE OF 8  50040042
         MNOTE '*** DATA NOT DEFINED A MULTIPLE OF 8 BITS ***'          50100042
         MEXIT                                                          50160042
.C       ANOP                                                           50220042
&IN      SETA  &IBITS/8                 .COMPUTE NUMBER OF BYTES        50280042
         AIF   (&IN LT 1 OR &IN GT 4).BERR  .TEST RANGE B IF IN ERROR   50340042
&ISHIFT  SETA  &SHIFT(&IND)             .SET UP FOR TEST OF BYTE BNDR   50400042
         AIF   (&ISHIFT EQ 0).D         .TEST FOR BYTE BNDRY            50460042
         MNOTE '*** DATA NOT ALIGNED ON A BYTE BOUNDARY ***'            50520042
         MEXIT                                                          50580042
.*                                                                      50640042
.D       ANOP                                                           50700042
&NRENTS  SETA  &NRENTS+1                                                50760042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),AL.4(9)                    50820042
         DC    X'&IN',X'&OUT'                                           50880042
&IND     SETA  0                                                        50940042
         AIF   (&SUB EQ 0).OUTA                                         51000042
         AIF   (&OP LT N'&SYSLIST).LLOP                                 51060042
.OUTA    ANOP                                                           51120042
         MEND                                                           51180042
****************************************************                    51240042
*    THIS ENTIRE MODULE IN SUPPORT OF  XL30040     *                    51300042
****************************************************                    51360042
         MACRO                                                          51420042
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               51480042
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 51540042
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 51600042
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   51660042
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 51720042
.*                                 INTERPRETED AS AN ARGUMENT OF THE    51780042
.*                                 SPECIAL ROUTINE.                     51840042
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  51900042
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    51960042
         GBLC  &CSECT                                                   52020042
         GBLA  &COUNTR                                                  52080042
         LCLA  &ADD                                                     52140042
         DC    AL1(128)                                                 52200042
         DC    BL.8'&PARAM'                                             52260042
         DC    AL2(&ROUTINE-&CSECT)                                     52320042
         DC    AL2(&COUNTR)                                             52380042
&ADD     SETA  1                                                        52440042
         AIF   ('&SPACE' EQ '').NORM                                    52500042
&ADD     SETA  &SPACE                                                   52560042
.NORM    ANOP                                                           52620042
&COUNTR  SETA  &COUNTR+&ADD                                             52680042
         MEND                                                           52740042
         MACRO                                                          52800042
         SUM   &LOGITEM,&MASK                                           52860042
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  52920042
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 52980042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 53040042
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  53100042
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   53160042
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   53220042
.*                                 MASK WILL BE SET ACCORDING TO THE    53280042
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     53340042
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  53400042
         GBLA  &COUNTR,&ITEMNBR,&BITS(2600),&SHIFT(2600)                53460042
         GBLC  &ITEM(2600),&DSECT                                       53520042
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           53580042
.LOOP    ANOP                                                           53640042
&NDX     SETA  &NDX+1                                                   53700042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      53760042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  53820042
         MNOTE *,'LOGITEM NOT FOUND'                                    53880042
         MEXIT                                                          53940042
.FOUND   ANOP                                                           54000042
&ISHIFT  SETA  &SHIFT(&NDX)                                             54060042
&IBITS   SETA  &BITS(&NDX)                                              54120042
         AIF  (&IBITS EQ 1).FORM1 TEST FOR OLD FORM                     54180042
         AIF  ('&MASK' NE '').FORM1 TEST FOR MASK                       54240042
         AIF  (&IBITS+&ISHIFT GT 8).MSG  TEST FOR > 8                   54300042
         DC   AL.1(0),AL.3(&ISHIFT),AL.4(&IBITS)                        54360042
         DC   AL1(0)                                                    54420042
         AGO  .ITEM                                                     54480042
.MSG     MNOTE '**BITS GREATER THAN 8**'                                54540042
        MEXIT                                                           54600042
.FORM1    ANOP                                                          54660042
          DC   AL1(0)                                                   54720042
         AIF   ('&MASK' EQ '').FORM                                     54780042
         DC    B'&MASK'                                                 54840042
         AGO   .ITEM                                                    54900042
.FORM    ANOP                                                           54960042
&BITNBR  SETA  &ISHIFT-7                                                55020042
&BITNBR  SETA  0-&BITNBR                                                55080042
&M       SETA  1                                                        55140042
.LOOP2   ANOP                                                           55200042
         AIF   (&BITNBR EQ 0).GOTIT                                     55260042
&M       SETA  &M*2                                                     55320042
&BITNBR  SETA  &BITNBR-1                                                55380042
         AGO   .LOOP2                                                   55440042
.GOTIT   ANOP                                                           55500042
         DC    AL1(&M)                                                  55560042
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     55620042
         DC    AL2(&COUNTR)                                             55680042
&COUNTR  SETA  &COUNTR+1                                                55740042
         MEND                                                           55800042
         GBLC  &DSECT,&CSECT                                            55860042
&CSECT   SETC  'IFCSAXXX'                                               55920042
&DSECT   SETC  'XVTAM'                                                  55980042
          TITLE 'IFCSAXXX- LINKNAME - IFCSAXXX'                         56040042
IFCSAXXX CSECT                                                          56100042
         USING *,R9                                                     56160042
         DC    A(SUMSTART)                                              56220042
         DC    A(PENTRY)                                                56280042
R8PTR    DS    F                                                        56340042
SCSIZE   DC    H'80'          NUMBER OF COUNTERS NEEDED        @X50DQMC 56400042
HEX00    DC    XL4'00'                                                  56460042
*                                                                       56520042
*              VTAM  SUMMARY MODULE                                     56580042
*                                                                       56640042
*                                                                       56700042
R0       EQU   0                                                        56760042
R1       EQU   1                                                        56820042
R2       EQU   2                                                        56880042
R3       EQU   3                                                        56940042
R4       EQU   4                                                        57000042
R5       EQU   5                                                        57060042
R6       EQU   6                                                        57120042
R7       EQU   7                                                        57180042
R8       EQU   8                                                        57240042
R9       EQU   9                                                        57300042
R10      EQU   10                                                       57360042
R11      EQU   11                                                       57420042
R12      EQU   12                                                       57480042
R13      EQU   13                                                       57540042
R14      EQU   14                                                       57600042
R15      EQU   15                                                       57660042
L0       EQU   0                                                        57720042
L1       EQU   1                                                        57780042
L2       EQU   2                                                        57840042
L3       EQU   3                                                        57900042
L4       EQU   4                                                        57960042
L5       EQU   5                                                        58020042
L6       EQU   6                                                        58080042
L7       EQU   7                                                        58140042
L8       EQU   8                                                        58200042
L9       EQU   9                                                        58260042
L10      EQU   10                                                       58320042
L17      EQU   17                                                P4954  58380042
HEX01    EQU   X'01'                                                    58440042
HEX02    EQU   X'02'                                                    58500042
HEX06    EQU   X'06'                                                    58560042
HEX08    EQU   X'08'                                                    58620042
HEX10    EQU   X'10'                                                    58680042
HEX20    EQU   X'20'                                                    58740042
HEX23    EQU   X'23'                                                    58800042
HEX25    EQU   X'25'                                                    58860042
HEX29    EQU   X'29'                                                    58920042
HEX32    EQU   X'32'                                                    58980042
HEX60    EQU   X'60'                                                    59040042
HEX70    EQU   X'70'                                                    59100042
HEX80    EQU   X'80'                                                    59160042
HEXE0    EQU   X'E0'                                                    59220042
*                                                                       59280042
*                                                                       59340042
*        DSGEN  FOR SUMMARY COUNTER AREA                                59400042
YVTAM    DSECT                                                          59460042
         DSGEN (TBLPTR,32),(FWDPTR,32)             HEADER PORTION       59520042
         DSGEN (TOTAL,16),(DUM1,16)                 TACKED ON BY EP009  59580042
         DSGEN (YCUA,24),(SRIAL,24),(CPUNO,16)      32 BYTES            59640042
         DS    CL2                                                      59700042
         DSGEN (TERMINAL,64)                                            59760042
*                                                                       59820042
         DSGEN (LODATE,32),(HIDATE,32)            COMMON SECT           59880042
         DSGEN (DEVTYPE,16),(UNRCEOD,16)             L COUNTERS         59940042
*                                                                       60000042
         DSGEN (UNRCSIO,32),(UNRCTE,16),(UNRCPE,16)                     60060042
         DSGEN (NB01,16),(NB02,16),(NB03,16),(NB04,16),        @X50DQMCX60066042
               (NB05,16),(NB06,16),(NB07,16),(NB08,16),        @X50DQMCX60072042
               (NB11,16),(NB12,16),(NB13,16),(NB14,16),        @X50DQMCX60078042
               (NB15,16),(NB16,16),(NB17,16),(NB18,16)         @X50DQMC 60084042
         DSGEN (NB21,16),(NB22,16),(NB23,16),(NB24,16),        @X50DQMCX60090042
               (NB25,16),(NB26,16),(NB27,16),(NB28,16),        @X50DQMCX60096042
               (NB31,16),(NB32,16),(NB33,16),(NB34,16),        @X50DQMCX60102042
               (NB35,16),(NB36,16),(NB37,16),(NB38,16)         @X50DQMC 60108042
         DSGEN (SR01,16),(SR02,16),(SR03,16),(SR04,16),                X60360042
               (SR05,16),(SR06,16),(SR07,16),(SR08,16),(SR09,16),      X60420042
               (SR10,16),(SR11,16),(SR12,16),(SR13,16),(SR14,16),      X60480042
               (SR15,16),(SR16,16),(SR17,16),(SR18,16),(SR19,16),      X60540042
               (SR20,16)                                                60600042
*                                                                       60660042
*                                                                       60720042
*              DSGEN FOR RECORD                                         60780042
*                                                                       60840042
XVTAM    DSECT                                                          60900042
         DSGEN (CLASRC,8),(SYSREL,8),(SWITCH1,8),(SWITCH2,8)   @X50DQMC 60960042
         DSGEN (SPARE1,32)                                              61020042
         DSGEN (DAY,32),(TIME,32)                                       61080042
         DSGEN (SPARE2,8),(CPUSERL,24),(CPUID,16),(SPARE3,16)           61140042
         DSGEN (JOBID1,32)                                              61200042
         DSGEN (JOBID2,32)                                              61260042
         DSGEN (FCCWCC,8),(FCCWA,24),(FCCWFL,8),(FCCW,8),(FCCWCT,16)    61320042
         DSGEN (CSWK,8),(CSWCA,24)                                      61380042
         DSGEN (CSWUS1,1),(CSWUS2,1),(CSWUS3,1),(CSWUS4,1),            X61440042
               (CSWUS5,1),(CSWUS6,1),(CSWUS7,1),(CSWUS8,1),            X61500042
               (CSWCS1,1),(CSWCS2,1),(CSWCS3,1),(CSWCS4,1),            X61560042
               (CSWCS5,1),(CSWCS6,1),(CSWCS7,1),(CSWCS8,1),(CSWCT,16)   61620042
         DSGEN (DEVDPD,8),(SECCUA,24)                                   61680042
         DSGEN (DEVTYP1,8),(DEVTYP1A,8),(DEVTYP2,16)                    61740042
         DSGEN (SPARE4,8),(CUA,24)                                      61800042
         DSGEN (IORET,16),(SBCNT,16)                           @X50DQMC 61860042
         DSGEN (SIOCNT,16),(TEMPER,8),(MASK,8),(OP1,8),(OP2,8),        X61920042
               (VTAMFL,8),(LDGRAPH,8)                                   61980042
         DSGEN (TERMNM,64)                                              62040042
         DSGEN (SDR01,4),(SDR02,4),(SDR03,4),(SDR04,4),                X62100042
               (SDR05,4),(SDR06,4),(SDR07,4),(SDR08,4),(SDR09,4),      X62160042
               (SDR10,4),(SDR11,4),(SDR12,4),(SDR13,4),(SDR14,4),      X62220042
               (SDR15,4),(SDR16,4),(SDR17,4),(SDR18,4),(SDR19,4),      X62280042
               (SDR20,4)                                                62340042
         DSGEN (SNB01,1),(SNB02,1),(SNB03,1),(SNB04,1),        @X50DQMCX62342042
               (SNB05,1),(SNB06,1),(SNB07,1),(SNB08,1),        @X50DQMCX62344042
               (SNB11,1),(SNB12,1),(SNB13,1),(SNB14,1),        @X50DQMCX62346042
               (SNB15,1),(SNB16,1),(SNB17,1),(SNB18,1),        @X50DQMCX62348042
               (SNB21,1),(SNB22,1),(SNB23,1),(SNB24,1),        @X50DQMCX62350042
               (SNB25,1),(SNB26,1),(SNB27,1),(SNB28,1),        @X50DQMCX62352042
               (SNB31,1),(SNB32,1),(SNB33,1),(SNB34,1),        @X50DQMCX62354042
               (SNB35,1),(SNB36,1),(SNB37,1),(SNB38,1)         @X50DQMC 62356042
         ORG   JOBID1                                          @X50DQMC 62358042
         DSGEN (SHRDEV1,8),(SHRDEV1A,8),(SHRDEV2,16)           @X50DQMC 62360042
         DSGEN (SHRSDRL,8),(SHRTCUA,24)                        @X50DQMC 62362042
         DSGEN (SHRSDR01,4),(SHRSDR02,4),(SHRSDR03,4),         @X50DQMCX62364042
               (SHRSDR04,4),(SHRSDR05,4),(SHRSDR06,4),         @X50DQMCX62366042
               (SHRSDR07,4),(SHRSDR08,4),(SHRSDR09,4),         @X50DQMCX62368042
               (SHRSDR10,4),(SHRSDR11,4),(SHRSDR12,4),         @X50DQMCX62370042
               (SHRSDR13,4),(SHRSDR14,4),(SHRSDR15,4),         @X50DQMCX62372042
               (SHRSDR16,4),(SHRSDR17,4),(SHRSDR18,4),         @X50DQMCX62374042
               (SHRSDR19,4),(SHRSDR20,4)                       @X50DQMC 62376042
         DSGEN (SHRSIOC,16)                                    @X50DQMC 62378042
*                                                              @X50DQMC 62380042
*                                                                       62640042
*                                                                       62700042
IFCSAXXX CSECT                                                          62760042
         USING XVTAM,R2                                                 62820042
SHRFLAG  DC    F'0'                                            @X50DQMC 62822042
ONE  DC  F'1'                                                  @X50DQMC 62824042
ZERO  DC  F'0'                                                 @X50DQMC 62826042
SIXTEEN  DC  F'16'                                             @X50DQMC 62828042
OVLYFLAG  DC  F'0'                                             @X50DQMC 62830042
*                                                              @X50DQMC 62832042
*                                                              @X50DQMC 62834042
TESTDEV  STM   R5,R8,SAVEREG                                   @X50DQMC 62836042
         TM    SWITCH2,H20       IF 3790 SHORT RECORD          @X50DQMC 62838042
         BZ    RETURN            BRANCH IF NO                  @X50DQMC 62840042
         CLC   SHRDEV2(2),UNIT90     YES-   IF 3790 FAMILY     @X50DQMC 62842042
         BNE   RETURN    NO-                                   @X50DQMC 62844042
         SR    R5,R5                                           @X50DQMC 62846042
         L     R5,ONE                                          @X50DQMC 62848042
         ST    R5,SHRFLAG    SET 3790 SHORT RECORD FLAG        @X50DQMC 62850042
         B     RETURN                                          @X50DQMC 62852042
*                                                              @X50DQMC 62854042
F3790SNB STM   R5,R8,SAVEREG                                   @X50DQMC 62856042
         CLC   DEVTYP2(2),UNIT90 IF 3790 LONG RECORD           @X50DQMC 62858042
         BE    RETURN      YES-3790 LONG RECORD,TWO SENSE BYTES         62860042
         LA    R5,UNRECEND-L6     NO-SKIP SECOND SENSE BYTE    @X50DQMC 62862042
         ST    R5,R8PTR                                        @X50DQMC 62864042
         B     RETURN                                          @X50DQMC 62866042
*                                                              @X50DQMC 62868042
*                                                              @X50DQMC 62870042
*                                                              @X50DQMC 62872042
*                                                                       62880042
SETDATE  CLC   DAY(L4),HEX00            IS DATE ZERO                    62940042
         BE    NODATE                   BR-YES                          63000042
         CLC   L0(L4,R3),HEX00          IS THIS FIRST TIME              63060042
         BNE   TESTDTE                  BR-NO                           63120042
         MVC   L0(L4,R3),DAY            MOVE IN DAY                     63180042
SAVEHI   MVC   L4(L4,R3),DAY            TO BOTH HI & LOW CNTRS          63240042
         BE    NODATE                   EXIT                            63300042
TESTDTE  CLC   L0(L4,R3),DAY            TEST FOR LOW                    63360042
         BNH   TESTHI                   BR-SAVED DATE LOW               63420042
         MVC   L0(L4,R3),DAY            NEW DATE LOW                    63480042
TESTHI   CLC   L4(L4,R3),DAY            TEST FOR HI                     63540042
         BL    SAVEHI              BR-SAVED DATE LOW                    63600042
NODATE   BR    R14                      RETURN                          63660042
*                                                                       63720042
*                                                                       63780042
*                                                                       63840042
SETDEV   CLC   SHRFLAG(4),ONE         IF 3790 SHORT RECORD     @X50DQMC 63848042
         BE    SHRDEV                 YES-                     @X50DQMC 63856042
         MVC   L0(L2,R3),DEVTYP2       NO-                     @X50DQMC 63864042
          BR    R14                                            @X50DQMC 63872042
SHRDEV   MVC   L0(L2,R3),SHRDEV2                               @X50DQMC 63880042
         BR    R14                                             @X50DQMC 63888042
*                                                                       64020042
*                                                                       64080042
TESTMODE STM   R5,R8,SAVEREG                                            64140042
         CLC   SHRFLAG(4),ONE        IF 3790 SHORT ROECORD     @X50DQMC 64150042
         BE    EODRTN       YES-                               @X50DQMC 64160042
         CLC   DEVTYP2(2),UNIT90     IF 3790 FAMILY            @X50DQMC 64170042
         BE    RETURN     YES                                  @X50DQMC 64180042
         TM    VTAMFL,HEX60                                             64200042
         BM    EODRTN                                                   64260042
RETURN   LM    R5,R8,SAVEREG                                            64320042
           BR      R14                                                  64380042
EODRTN   LH    R5,0(3)                                                  64440042
         LA    R5,1(R5)                                                 64500042
         STH   R5,0(3)                                                  64560042
         B     RETURN                                                   64620042
*                                                                       64680042
*                                                                       64740042
FWWA    DC      F'0'                                                    64800042
ADDSIO   STM   R5,R8,SAVEREG       SAVE REGS                            64860042
         SR    R5,R5                                                    64920042
         XC    FWWA(4),FWWA                                             64980042
         CLC   SHRFLAG(4),ONE    IF 3790 SHORT RECORD          @X50DQMC 65000042
         BE   ADSHRSIO                                         @X50DQMC 65020042
         MVC   FWWA+2(2),SIOCNT                                         65040042
CONTINUE L     R5,FWWA                                         @X50DQMC 65100042
         MVC   FWWA(4),L0(R3)                                           65160042
         A     R5,FWWA                                                  65220042
         ST    R5,FWWA                                                  65280042
         MVC   L0(4,R3),FWWA                                            65340042
         B     RETURN                                                   65400042
ADSHRSIO MVC   FWWA+2(2),SHRSIOC                               @X50DQMC 65420042
         B     CONTINUE                                        @X50DQMC 65440042
*                                                                       65460042
ADDTE    STM   R5,R8,SAVEREG                                            65520042
         CLC   SHRFLAG(4),ONE    IF 3790 SHORT RECORD          @X50DQMC 65540042
         BE    SHRREC         YES-                             @X50DQMC 65560042
         SR    R5,R5                    PICK UP TEMP                    65580042
         IC    R5,TEMPER                 ERR COUNT                      65640042
         AH    R5,L0(R3)                ADD SUM TO IT                   65700042
         STH   R5,L0(R3)                SAVE IT                         65760042
         CLC   DEVTYP2(2),UNIT90         IF 3790 FAMILY        @X50DQMC 65780042
         BE    PERM         YES-                               @X50DQMC 65800042
         TM    VTAMFL,HEX60             TEST FOR EOD & OVERFLOW         65820042
         BM    RECDONE                  BR YES                          65880042
PERM     LH    R5,L2(R3)                YES ADD 1 TO PER       @X50DQMC 65940042
         LA    R5,L1(R5)                COUNTER &                       66000042
         STH   R5,L2(R3)                SAVE IT                         66060042
         B     RETURN                                                   66120042
STOREPTR ST    R5,R8PTR            SAVE PTR FOR SUM MODULE              66180042
         B     RETURN                                                   66240042
RECDONE  LA    R5,UNRECEND-L6      SET PTR TO X'FF' TO SIGNAL END       66300042
         B     STOREPTR                                                 66360042
*                                                                       66420042
SHRREC   LA    R5,SHRSDR-L6                                    @X50DQMC 66422042
         B     STOREPTR                                        @X50DQMC 66424042
JUMP     STM   R5,R8,SAVEREG    SAVE REGISTERS                 @X50DQMC 66426042
         CLC   OVLYFLAG(4),ONE    CHECK IF OVERLAY IS DONE     @X50DQMC 66428042
         BE    RETURN        YES- SKIP OVERLAY                 @X50DQMC 66430042
         SR    R5,R5        NO-  SET OVLYFLAG TO ONE           @X50DQMC 66432042
         L     R5,ONE                                          @X50DQMC 66434042
         ST    R5,OVLYFLAG                                     @X50DQMC 66436042
         LA    R5,SHRSDR                                       @X50DQMC 66438042
         LA    R7,SHRSDR+102                                   @X50DQMC 66440042
OVERLAY  SR    R6,R6                                           @X50DQMC 66442042
         LH    R6,4(0,R5)      GET CURRENT COUNTER POSITION    @X50DQMC 66444042
         S     R6,SIXTEEN        REPOSITION BACK SIXTEEN       @X50DQMC 66446042
         STH   R6,4(0,R5)        OVERLAY COUNTER               @X50DQMC 66448042
         LA    R5,6(0,R5)      GET NEXT ITEM                   @X50DQMC 66450042
         CR    R5,R7               DO ALL COUNTERS             @X50DQMC 66452042
         BNH   OVERLAY                                         @X50DQMC 66454042
         B     RETURN                                          @X50DQMC 66456042
*                                                              @X50DQMC 66458042
RESTFLAG STM   R5,R8,SAVEREG       ROUTINE TO RESET FLAG       @X50DQMC 66460042
         L     R5,ZERO                                         @X50DQMC 66462042
         ST    R5,SHRFLAG                                      @X50DQMC 66464042
         LA    R5,END-L6     SET  'FF' TO INDICATE END         @X50DQMC 66466042
         B     STOREPTR                                        @X50DQMC 66468042
*                                                                       66480042
*                                                                       66540042
*                                                                       66600042
SUMSTART DS    0F                                                       66660042
         SPECIAL TESTDEV,0,SPACE=0                             @X50DQMC 66690042
         SPECIAL    SETDATE,0,SPACE=4                                   66720042
         SPECIAL    SETDEV,0,SPACE=1                                    66780042
         SPECIAL    TESTMODE,0,SPACE=1                                  66840042
*                                                                       66900042
UNRECSCT EQU   *                                                        66960042
         SPECIAL    ADDSIO,0,SPACE=2              ADD SIO CNTRS         67020042
         SPECIAL    ADDTE,0,SPACE=2               ADD TEMP/PERM ERRORS  67080042
         SUM     SNB01                                         @X50DQMC 67081042
         SUM     SNB02                                         @X50DQMC 67082042
         SUM     SNB03                                         @X50DQMC 67083042
         SUM     SNB04                                         @X50DQMC 67084042
         SUM     SNB05                                         @X50DQMC 67085042
         SUM     SNB06                                         @X50DQMC 67086042
         SUM     SNB07                                         @X50DQMC 67087042
         SUM     SNB08                                         @X50DQMC 67088042
         SUM     SNB11                                         @X50DQMC 67089042
         SUM     SNB12                                         @X50DQMC 67090042
         SUM     SNB13                                         @X50DQMC 67091042
         SUM     SNB14                                         @X50DQMC 67092042
         SUM     SNB15                                         @X50DQMC 67093042
         SUM     SNB16                                         @X50DQMC 67094042
         SUM     SNB17                                         @X50DQMC 67095042
         SUM     SNB18                                         @X50DQMC 67096042
         SPECIAL  F3790SNB,0,SPACE=0                           @X50DQMC 67097042
         SUM     SNB21                                         @X50DQMC 67098042
         SUM     SNB22                                         @X50DQMC 67099042
         SUM     SNB23                                         @X50DQMC 67100042
         SUM     SNB24                                         @X50DQMC 67101042
         SUM     SNB25                                         @X50DQMC 67102042
         SUM     SNB26                                         @X50DQMC 67103042
         SUM     SNB27                                         @X50DQMC 67104042
         SUM     SNB28                                         @X50DQMC 67105042
         SUM     SNB31                                         @X50DQMC 67106042
         SUM     SNB32                                         @X50DQMC 67107042
         SUM     SNB33                                         @X50DQMC 67108042
         SUM     SNB34                                         @X50DQMC 67109042
         SUM     SNB35                                         @X50DQMC 67110042
         SUM     SNB36                                         @X50DQMC 67111042
         SUM     SNB37                                         @X50DQMC 67112042
         SUM     SNB38                                         @X50DQMC 67113042
UNRECEND  EQU  *                                                        68100042
         SUM   SDR01                                                    68160042
         SUM   SDR02                                                    68220042
         SUM   SDR03                                                    68280042
         SUM   SDR04                                                    68340042
         SUM   SDR05                                                    68400042
         SUM   SDR06                                                    68460042
         SUM   SDR07                                                    68520042
         SUM   SDR08                                                    68580042
         SUM   SDR09                                                    68640042
         SUM   SDR10                                                    68700042
         SUM   SDR11                                                    68760042
         SUM   SDR12                                                    68820042
         SUM   SDR13                                                    68880042
         SUM   SDR14                                                    68940042
         SUM   SDR15                                                    69000042
         SUM   SDR16                                                    69060042
         SPECIAL RESTFLAG,0,SPACE=0                            @X50DQMC 69062042
SHRSDR   EQU   *                                               @X50DQMC 69064042
         SPECIAL JUMP,0,SPACE=0                                @X50DQMC 69066042
         SUM   SHRSDR01                                        @X50DQMC 69068042
         SUM   SHRSDR02                                        @X50DQMC 69070042
         SUM   SHRSDR03                                        @X50DQMC 69072042
         SUM   SHRSDR04                                        @X50DQMC 69074042
         SUM   SHRSDR05                                        @X50DQMC 69076042
         SUM   SHRSDR06                                        @X50DQMC 69078042
         SUM   SHRSDR07                                        @X50DQMC 69080042
         SUM   SHRSDR08                                        @X50DQMC 69082042
         SUM   SHRSDR09                                        @X50DQMC 69084042
         SUM   SHRSDR10                                        @X50DQMC 69086042
         SUM   SHRSDR11                                        @X50DQMC 69088042
         SUM   SHRSDR12                                        @X50DQMC 69090042
         SUM   SHRSDR13                                        @X50DQMC 69092042
         SUM   SHRSDR14                                        @X50DQMC 69094042
         SUM   SHRSDR15                                        @X50DQMC 69096042
         SUM   SHRSDR16                                        @X50DQMC 69098042
         SPECIAL RESTFLAG,0,SPACE=0                            @X50DQMC 69100042
END      DC    X'FF'           END OF SUM SECTION              @X50DQMC 69120042
*                                                                       69180042
*                                                                       69240042
*                                                                       69300042
*                                                                       69360042
*                                                                       69420042
*                                                                       69480042
*              EDIT PRINT SECTION                                       69540042
*                                                                       69600042
&CSECT   SETC  'PENTRY'                                                 69660042
&DSECT   SETC  'YVTAM'                                                  69720042
*                                                                       69780042
PENTRY   DS    0F                                                       69840042
         DC    A(PENTRIES)                                              69900042
         DC    CL8'IFCSAXXX'                                            69960042
R9PTR    DS    2F                                                       70020042
*                                                                       70080042
*              SPECIAL ROUTINES                                         70140042
*                                                                       70200042
         USING PENTRY,R9                                                70260042
         USING YVTAM,R2                                                 70320042
*                                                                       70380042
CONVERT  STM   R5,R8,SAVEREG                                            70440042
         LH    R5,L0(R4)           PICK UP CNTR                         70500042
         LTR   R5,R5               IS IT ZERO                           70560042
         BZ    RETURNA             BR-YES                               70620042
CONVT    CVD   R5,WORK                                                  70680042
         UNPK  L0(L4,R3),WORK+L4(L4) PACK IT INTO BUFF                  70740042
         MVZ   L3(L1,R3),L0(R3)    PUT ON ZONE                          70800042
RETURNA  LM    R5,R8,SAVEREG                                            70860042
SKIPPER  BR    R14                                                      70920042
*                                                                       70980042
*                                                                       71040042
SETCPUNO STM   R5,R8,SAVEREG            SAVE REGS                       71100042
         SR    R5,R5                    CLEAR R5                        71160042
         IC    R5,0(R4)                 PICK UP CPU TYPE                71220042
         SLL   R5,R8                                                    71280042
         IC    R5,L1(R4)                                                71340042
         LTR   R5,R5                    IS IT ZERO                      71400042
         BNZ   RETURNA                  NO                              71460042
         LA    R6,L64                   CORREST DATA POINTER            71520042
         SR    R3,R6                                                    71580042
         MVC   L0(L6,R3),SHARED           MOVE IN SHARED       @Z427VLS 71640042
         B     RETURNA                                                  71760042
*                                                                       71820042
SHARED   DC    C'SHARED'                                       @Z427VLS 71880042
NONE     DC    C' NONE '                                                71940042
*                                                                       72000042
SETDATE2 UNPK  WORK(L8),L0(L4,R4)                                       72060042
         MVZ   WORK+L7(L1),WORK                                         72120042
         MVC   L0(L3,R3),WORK+L5        MOVE IN DAYS                    72180042
         MVC   L5(L2,R3),WORK+L3        MOVE IN YEAR                    72240042
         BR    R14                                                      72300042
SETDEV2  MVC   L0(L4,R3),C3270     MOVE IN 3270                @XA20412 72360001
         CLC   L0(L2,R4),UNIT70    IS IT 3270                  @XA20412 72380001
         BER   R14                 YES,RETURN                  @XA20412 72400001
         CLC   L0(L2,R4),UNIT90    IS IT A 3790                @XA20412 72420001
         BNE   CHK3705             NO,CHECK FOR 3705           @XA20412 72440001
         MVC   L0(L10,R3),C3790    YES MOVE IN 3791 LOCAL      @XA20412 72460001
         BR    R14                 AND RETURN                  @XA20412 72480001
CHK3705  STM   R5,R8,SAVEREG       SAVE REGISTERS              @XA20412 72500001
         CLI   L0(R4),HEX40        IS THIS A COMM DEVICE       @XA20412 72520001
         BNE   SETUNKN             NO,DEVICE NOT SUPPORTED     @XA20412 72540001
         MVC   L0(L4,R3),C3705     MOVE 3705 TO IMAGE          @XA20412 72560001
         LA    R5,L5               TABLE SIZE                  @XA20412 72580001
         LA    R6,TYPTAB           GET KNOWN 3705 ID'S         @XA20412 72600001
SETLOOP  CLC   L1(L1,R4),L0(R6)    IS THIS ONE                 @XA20412 72620001
         BE    RETURNA             YES,RETURN                  @XA20412 72640001
         LA    R6,L1(R6)           BCT  R5,SETLOOP             @XA20412 72660001
         BCT   R5,SETLOOP                                      @XA20412 72680001
SETUNKN  MVC   L0(L4,R3),CUNKN     MOVE INUNKN                 @XA20412 72700001
         B     RETURNA                                         @XA20412 72720001
*                                                                       72840042
SETTERM  STM   R5,R8,SAVEREG                                            72900042
         LR    R5,R3               SET R5                               72960042
         SH    R5,H10              DEC BACK 10 BYTES                    73020042
         MVC   L0(L8,R5),L0(R4)    MOVE IN TERMINAL NAME                73080042
         B     RETURNA                                                  73140042
*                                                                       73200042
*                                                                       73260042
*                                                                       73320042
*                                                                       73380042
FREEALL  STM   R14,R12,L12(R13)         SAVE ALL REGS                   73440042
         LR    R12,R13                                                  73500042
         LA    R13,SAVEREG                                              73560042
         ST    R12,L4(R13)                                              73620042
         ST    R13,L8(R12)                                              73680042
FREEALLA L     R3,L4(R2)                                       @X50DQMC 73740042
         LH    R0,SIZE                                                  73800042
         LR    R1,R2                                                    73860042
         FREEMAIN R,LV=(0),A=(1)                                        73920042
         LTR   R3,R3                                                    73980042
         BZ    RETURN0                                                  74040042
         LR    R2,R3                                                    74100042
         LA    R5,PENTRIES+10                                           74160042
         ST    R5,R9PTR                                                 74220042
         LA    R5,LABELS-1                                              74280042
         ST    R5,R9PTR+4                                               74340042
         ST    R3,L28(R12)                                     @X50DQMC 74360042
RETURN0  L     R13,L4(R13)                                     @X50DQMC 74380042
         LM    R14,R12,L12(R13)                                         74520042
         BR    R14                                                      74580042
U3270    CLC   L0(L2,R4),UNIT70    IS THIS A 3270              @XA20412 74640001
         STM   R5,R8,SAVEREG       SAVE WORK REGS              @XA20412 74670001
         B     SET90               *                           @XA20412 74680001
         B     GOCHK               NO,WHATIS IT                @XA20412 74700001
*                                                              @XA20412 74730001
U3790    CLC   L0(L2,R4),UNIT90    IS IT 3790                  @XA20412 74760001
         BER   R14                 YES,RETURN                  @XA20412 74790001
         STM   R5,R8,SAVEREG       SAVE WORK REGISTERS         @XA20412 74820001
         B     SKIPOUT             *                           @XA20412 74830001
*                                                              @XA20412 74850001
U3705    STM   R5,R8,SAVEREG       SAVE WORK REGISTERS         @XA20412 74880001
         LA    R6,TYPTAB           GET KNOWN 3705 ID'S         @XA20412 74910001
         LA    R7,L5               TABLE SIZE                  @XA20412 74940001
U3705LP  CLC   L1(L1,R4),L0(R6)    IS IT A 3705                @XA20412 74970001
         BE    RETURNA             YES,RETURN                  @XA20412 75000001
         LA    R6,L1(R6)                                       @XA20412 75030001
         BCT   R7,U3705LP          AND TRY AGAIN               @XA20412 75060001
*                                                              @XA20412 75120001
GOCHK    CLC   L0(L2,R4),UNIT90    CHECK FOR 3790              @XA20412 75150001
         BNE   SET70               *                           @XA20412 75190001
         L     R6,L3790                                        @XA20412 75240001
         LA    R7,LINE3790-4                                   @XA20412 75270001
         B     GOOUT                                           @XA20412 75300001
SET70    LA    R6,LAB3270-1        *                           @XA20412 75330001
         LA    R7,LINE3270-4                                   @XA20412 75420001
         B     GOOUT                                           @XA20412 75450001
SET90    CLC   L0(L2,R4),UNIT90    *                           @XA20412 75480001
         BNE   SKIPOUT             *                           @XA20412 75510001
         L     R6,L3790            *                           @XA20412 75540001
         LA    R7,LINE3790-4       *                           @XA20412 75570001
         B     GOOUT               *                           @XA20412 75600001
SKIPOUT  L     R6,LINLAB           *                           @XA20412 75630001
         LA    R7,LASTLINE-4       *                           @XA20412 75660001
GOOUT    ST    R6,R9PTR+4          SAVE                        @XA20412 75750001
         ST    R7,R9PTR            POINTERS                    @XA20412 75780001
         B     RETURNA             AND RETURN                  @XA20412 75810001
*                                                              @X50DQMC 76008042
SAVEREG  DS    18F                                                      76020042
HSAVE    DC    CL1' '                                                   76080042
*                                                                       76140042
SAVE8    DS    F                                                        76200042
WORK     DS    D                                                        76260042
TOTREC   DS    H                                                        76320042
TOTSIO   DS    H                                                        76380042
TOTTE    DS    H                                                        76440042
TOTUNR   DS    H                                                        76500042
TOTIM    DS    H                                                        76560042
SIZE     DC    H'160'                                          @X50DQMC 76620042
H10      DC    H'10'                                                    76680042
L30      EQU   30                                                       76740042
L34      EQU   34                                                       76800042
L28      EQU   28                                                       76860042
H20      EQU   X'20'                                           @X50DQMC 76890042
HEX40    EQU   X'40'                                                    76920042
HEX03    EQU   X'03'                                                    76980042
HEX05    EQU   X'05'                                                    77040042
H0F    EQU   X'0F'                                                      77100042
L12      EQU   12                                                       77160042
LBLPTR   EQU   TBLPTR                                                   77220042
C3270    DC    C'3270'                                                  77280042
C3705    DC    C'3705'                                                  77340042
UNIT70   DC    X'1009'                                         @XA20412 77400001
L3790    DC    A(LAB3790-1)                                    @X50DQMC 77470042
LINLAB   DC    A(LABLIN-1)                                     @X50DQMC 77480042
C3790    DC    C'3791 LOCAL'                                   @X50DQMC 77490042
UNIT90   DC    X'40F1'                                         @X50DQMC 77500042
TYPTAB   DC    X'0506152535'       LIST OF KNOWN 3705 ID'S     @XA20412 77510001
CUNKN    DC    C'UNKN'             UNKNOWN OR UNSUPPORTED DEV  @XA20412 77515001
L32      EQU   32                                                       77520042
L64      EQU   64                                                       77580042
PENTRIES DS    0F                                                       77640042
         DC    XL4'00010001'                                   @X50DQMC 77760042
         DC    XL4'00010001'                                   @X50DQMC 77790042
         DC    A(LABELS)                                                77820042
         DC    H'0'                                                     77880042
*                                                                       77940042
         DC    X'01'                                                    78000042
         DC    X'000B8B00'              SKIP TP  CHANNEL 1              78060042
         LABEL ''                                                       78120042
*                                                                       78180042
         LINE  (57,32),(23,26),SKIP=1                                   78240042
         HEX   CPUNO,0,2B                                               78300042
         HEX   SRIAL,0,3B                                               78360042
         ROUTINE   CPUNO,SETCPUNO                                       78420042
         LABEL 'DAY YEAR   DAY YEAR','MODEL-','SERIAL NO.'              78480042
*                                                                       78540042
         LINE       (23,11),(1,30),SKIP=2                               78600042
         ROUTINE    LODATE,SETDATE2                                     78660042
         ROUTINE    HIDATE,SETDATE2                                     78720042
         LABEL      'OUTBOARD DATE RANGE -','TO'                        78780042
*                                                                       78840042
         LINE       (48,22),(1,57)                                      78900042
         HEX        YCUA,0,3B                                           78960042
         ROUTINE    DEVTYPE,SETDEV2                                     79020042
         LABEL      'SUMMARY OF VTAM I/O OUTBOARD RECORDS FOR CUA ',   X79080042
               'DEVICE TYPE'                                            79140042
*                                                                       79200042
         LINE       (26,1),,SKIP=3                                      79260042
         CONVT  TOTAL                                                   79320042
         LABEL      'TOTAL NUMBER OF RECORDS'                           79380042
*                                                                       79440042
         LINE       (40,67),(5,55),SKIP=1                               79500042
         CONVT  UNRCSIO,4,6                                             79560042
         CONVT  UNRCPE                                                  79620042
         LABEL      'TOTAL NUMBER OF SIO','TOTAL NUMBER OF UNRECOVERABL*79680042
               E (UNREC) ERRORS'                                        79740042
*                                                                       79800042
         LINE       ,,SKIP=3                                            79860042
         CONVT  UNRCTE                                                  79920042
         CONVT  UNRCEOD                                                 79980042
         LABEL      'TOTAL NUMBER OF TEMPORARY FAILURES',              *80040042
               'TOTAL NUMBER OF EOD/OVERFLOW RECORDS    '               80100042
*                                                                       80160042
       LINE  ,,SKIP=1                                          @X50DQMC 80165042
       ROUTINE  DEVTYPE,U3705                                  @X50DQMC 80170042
       LABEL ''                                                @X50DQMC 80175042
           LINE    ,,SKIP=3                                    @X50DQMC 80180042
           ROUTINE  TERMINAL,SETTERM                           @X50DQMC 80185042
           LABEL  'RESOURCE NAME'                              @X50DQMC 80190042
         LINE  (12,28),(3,28),SKIP=2                           @X50DQMC 80195042
        LABEL 'SENSE BYTE SUMMARY    3705'                     @X50DQMC 80200042
         LINE  (17,28),(4,28),SKIP=1                           @X50DQMC 80205042
         CONVT NB11                                            @X50DQMC 80210042
       LABEL 'CMND REJ'                                                 80820042
         LINE   ,                                                       80880042
         CONVT NB12                                            @X50DQMC 80940042
         LABEL 'INTV REQD'                                              81000042
         LINE  ,                                                        81060042
         CONVT NB13                                            @X50DQMC 81120042
         LABEL 'BUS O CHK'                                              81180042
         LINE  ,                                                        81240042
         CONVT NB14                                            @X50DQMC 81300042
           LABEL             'EQUIP CHK'                                81360042
         LINE  ,                                                        81420042
         CONVT NB15                                            @X50DQMC 81480042
         LABEL 'N/A'                                                    81540042
         LINE  ,                                                        81600042
         CONVT NB16                                            @X50DQMC 81660042
         LABEL 'N/A'                                                    81720042
         LINE  ,                                                        81780042
         CONVT NB17                                            @X50DQMC 81840042
         LABEL 'IPL REQST'                                              81900042
         LINE  ,                                                        81960042
         CONVT NB18                                            @X50DQMC 82020042
         LABEL 'ABORT'                                                  82080042
        LINE  (20,30),(6,30),SKIP=3                                     82140042
        LABEL ''                                                        82200042
        LINE  ,,SKIP=2                                                  82260042
        LABEL 'SDR SUMMARY AREA   3705'                                 82320042
        LINE  ,,SKIP=1                                                  82380042
        CONVT SR01                                                      82440042
        CONVT SR02                                                      82500042
        LABEL 'NOT USED','NOT USED'                                     82560042
        LINE  ,                                                         82620042
        CONVT SR03                                                      82680042
        CONVT SR04                                                      82740042
        LABEL 'INTV REQD','BUS OUT'                                     82800042
        LINE ,                                                          82860042
        CONVT  SR05                                                     82920042
        CONVT  SR06                                                     82980042
        LABEL 'EQUIP CHK','NOT USED'                                    83040042
        LINE  ,                                                         83100042
        CONVT  SR07                                                     83160042
        CONVT  SR08                                                     83220042
        LABEL  'IPL REQ','NOT USED'                                     83280042
        LINE  ,                                                         83340042
        CONVT  SR09                                                     83400042
        CONVT  SR10                                                     83460042
        LABEL 'NOT USED','NOT USED'                                     83520042
        LINE  ,                                                         83580042
        CONVT  SR11                                                     83640042
        CONVT  SR12                                                     83700042
        LABEL 'NOT USED','NOT USED'                                     83760042
        LINE ,                                                          83820042
        CONVT  SR13                                                     83880042
        CONVT  SR14                                                     83940042
        LABEL 'NOT USED  ','NOT USED     '                              84000042
        LINE  ,                                                         84060042
        CONVT  SR15                                                     84120042
        CONVT  SR16                                                     84180042
        LABEL  'NOT USED','CHAN DATA CHK'                               84240042
       LINE  ,                                                          84300042
       ROUTINE  DEVTYPE,U3270                                           84360042
       LABEL ''                                                         84420042
LINE3270 LINE  (40,67),(5,55),SKIP=3                           @X50DQMC 84425042
         ROUTINE TERMINAL,SETTERM                              @X50DQMC 84430042
LAB3270  LABEL 'RESOURCE NAME'                                 @X50DQMC 84435042
         LINE  (12,28),(3,28),SKIP=2                           @X50DQMC 84440042
        LABEL 'SENSE BYTE SUMMARY    3270'                     @X50DQMC 84445042
*                                                              @X50DQMC 84450042
*        SENSE BYTE SUMMARY  3270                              @X50DQMC 84455042
*                                                              @X50DQMC 84460042
         LINE  (17,28),(4,28),SKIP=1                           @X50DQMC 84465042
         CONVT NB11                                            @X50DQMC 84470042
     LABEL 'CMND REJ'                                                   84900042
         LINE  ,                                                        84960042
         CONVT NB12                                            @X50DQMC 85020042
         LABEL 'INTV REQD'                                              85080042
         LINE  ,                                                        85140042
         CONVT NB13                                            @X50DQMC 85200042
         LABEL 'BUS O CHK'                                              85260042
         LINE  ,                                                        85320042
         CONVT NB14                                            @X50DQMC 85380042
           LABEL 'EQUIP CHK'                                            85440042
         LINE  ,                                                        85500042
         CONVT NB15                                            @X50DQMC 85560042
         LABEL 'DATA CHK'                                               85620042
         LINE  ,                                                        85680042
         CONVT NB16                                            @X50DQMC 85740042
         LABEL 'UNIT SPEC'                                              85800042
         LINE  ,                                                        85860042
         CONVT NB17                                            @X50DQMC 85920042
         LABEL 'CNTL CHK'                                               85980042
         LINE  ,                                                        86040042
         CONVT NB18                                            @X50DQMC 86100042
         LABEL 'OPRTN'                                                  86160042
        LINE  (20,30),(6,30),SKIP=3                                     86220042
        LABEL ''                                                        86280042
        LINE  ,,SKIP=2                                                  86340042
        LABEL 'SDR SUMMARY AREA   3270 '                                86400042
        LINE  ,,SKIP=1                                                  86460042
        CONVT SR01                                                      86520042
        CONVT SR02                                                      86580042
        LABEL 'READ DC','WRITE DC'                                      86640042
        LINE  ,                                                         86700042
        CONVT SR03                                                      86760042
        CONVT SR04                                                      86820042
        LABEL 'INTV REQD','BUS OUT'                                     86880042
        LINE ,                                                          86940042
        CONVT  SR05                                                     87000042
        CONVT  SR06                                                     87060042
        LABEL 'EQUIP CHK','NOT USED'                                    87120042
        LINE  ,                                                         87180042
        CONVT  SR07                                                     87240042
        CONVT  SR08                                                     87300042
        LABEL  'CNTL CHK','NOT USED'                                    87360042
        LINE  ,                                                         87420042
        CONVT  SR09                                                     87480042
        CONVT  SR10                                                     87540042
        LABEL 'NOT USED','NOT USED'                                     87600042
        LINE  ,                                                         87660042
        CONVT  SR11                                                     87720042
        CONVT  SR12                                                     87780042
        LABEL 'NOT USED','DATA CHK US   '                               87840042
        LINE ,                                                          87900042
        CONVT  SR13                                                     87960042
        CONVT  SR14                                                     88020042
        LABEL 'INT REQ US  ','INT REQ EC US'                            88080042
        LINE  ,                                                         88140042
        CONVT  SR15                                                     88200042
        CONVT  SR16                                                     88260042
        LABEL  'EC US','CHAN DATA CHK'                                  88320042
         LINE  ,                                               @X50DQMC 88320542
         ROUTINE DEVTYPE,U3790                                 @X50DQMC 88321042
         LABEL ''                                              @X50DQMC 88321542
LINE3790 LINE  (12,28),(1,28),SKIP=2                           @X50DQMC 88322042
LAB3790  LABEL 'SENSE BYTE SUMMARY'                            @X50DQMC 88322542
         LINE  ,(4,28),SKIP=2                                  @X50DQMC 88323042
         LABEL 'BIT','INITIAL   FINAL'                         @X50DQMC 88323542
         LINE  (32,11),,SKIP=1                                 @X50DQMC 88324042
         CONVT NB01                                            @X50DQMC 88324542
         CONVT  NB21                                           @X50DQMC 88325042
         LABEL '0  COMMAND REJECT'                             @X50DQMC 88325542
         LINE   ,                                              @X50DQMC 88326042
         CONVT  NB02                                           @X50DQMC 88326542
         CONVT  NB22                                           @X50DQMC 88327042
         LABEL '1  INTERVENTION REQD'                          @X50DQMC 88327542
         LINE   ,                                              @X50DQMC 88328042
         CONVT  NB03                                           @X50DQMC 88328542
         CONVT  NB23                                           @X50DQMC 88329042
         LABEL '2  BUS OUT CHK'                                @X50DQMC 88329542
         LINE   ,                                              @X50DQMC 88330042
        CONVT NB04                                             @X50DQMC 88330542
        CONVT NB24                                             @X50DQMC 88331042
         LABEL '3  EQUIPMENT CHK'                              @X50DQMC 88331542
         LINE   ,                                              @X50DQMC 88332042
        CONVT NB05                                             @X50DQMC 88332542
        CONVT NB25                                             @X50DQMC 88333042
         LABEL '4  DATA CHK'                                   @X50DQMC 88333542
         LINE   ,                                              @X50DQMC 88334042
        CONVT NB06                                             @X50DQMC 88334542
        CONVT NB26                                             @X50DQMC 88335042
         LABEL '5  (NOT USED)'                                 @X50DQMC 88335542
         LINE   ,                                              @X50DQMC 88336042
        CONVT NB07                                             @X50DQMC 88336542
        CONVT NB27                                             @X50DQMC 88337042
         LABEL '6  NOT INITIALIZED'                            @X50DQMC 88337542
         LINE   ,                                              @X50DQMC 88338042
        CONVT NB08                                             @X50DQMC 88338542
        CONVT NB28                                             @X50DQMC 88339042
         LABEL '7  (NOT USED)'                                 @X50DQMC 88339542
         LINE   ,                                              @X50DQMC 88340042
        CONVT NB11                                             @X50DQMC 88340542
        CONVT NB31                                             @X50DQMC 88341042
         LABEL '8  LENGTH CHK'                                 @X50DQMC 88341542
         LINE  ,                                               @X50DQMC 88342042
        CONVT NB12                                             @X50DQMC 88342542
        CONVT NB32                                             @X50DQMC 88343042
         LABEL '9  DATA REJECT'                                @X50DQMC 88343542
         LINE  ,(3,29),SKIP=1                                  @X50DQMC 88344042
        CONVT NB13                                             @X50DQMC 88344542
        CONVT NB33                                             @X50DQMC 88345042
         LABEL '10  (NOT USED)'                                @X50DQMC 88345542
         LINE  ,                                               @X50DQMC 88346042
        CONVT NB14                                             @X50DQMC 88346542
        CONVT NB34                                             @X50DQMC 88347042
         LABEL '11  (NOT USED)'                                @X50DQMC 88347542
         LINE  ,                                               @X50DQMC 88348042
        CONVT NB15                                             @X50DQMC 88348542
        CONVT NB35                                             @X50DQMC 88349042
         LABEL '12  PARITY ERROR'                              @X50DQMC 88349542
         LINE   ,                                              @X50DQMC 88350042
        CONVT NB16                                             @X50DQMC 88350542
        CONVT NB36                                             @X50DQMC 88351042
         LABEL '13  PARITY CHK#1'                              @X50DQMC 88351542
         LINE   ,                                              @X50DQMC 88352042
        CONVT NB17                                             @X50DQMC 88352542
        CONVT NB37                                             @X50DQMC 88353042
         LABEL '14  PARITY CHK#2'                              @X50DQMC 88353542
         LINE   ,,SKIP=3                                       @X50DQMC 88354042
         CONVT NB18                                            @X50DQMC 88354542
         CONVT NB38                                            @X50DQMC 88355042
         LABEL '15  MACHINE CHECK'                             @X50DQMC 88355542
         LINE   ,(1,28),SKIP=2                                 @X50DQMC 88356042
         LABEL 'SDR COUNTER SUMMARY'                           @X50DQMC 88356542
         LINE   (33,39),(3,39),SKIP=1                          @X50DQMC 88357042
         CONVT SR01                                            @X50DQMC 88357542
         CONVT SR09                                            @X50DQMC 88358042
         LABEL '1 NOT USED',' 9 DATA CHK, LENGTH CHK'          @X50DQMC 88358542
         LINE   ,                                              @X50DQMC 88359042
         CONVT SR02                                            @X50DQMC 88359542
         CONVT SR10                                            @X50DQMC 88360042
         LABEL '2 NOT USED','10 DATA CHK, DATA REJECT'         @X50DQMC 88360542
         LINE   ,                                              @X50DQMC 88361042
         CONVT SR03                                            @X50DQMC 88361542
         CONVT SR11                                            @X50DQMC 88362042
          LABEL '3 BUS OUT, P-CHK #2','11 EQUIP CHK, MACH CHK' @X50DQMC 88362542
         LINE   ,                                              @X50DQMC 88363042
         CONVT SR04                                            @X50DQMC 88363542
         CONVT SR12                                            @X50DQMC 88364042
         LABEL '4 BUS OUT, P-CHK #1,2','12 NOT USED'           @X50DQMC 88364542
         LINE   ,                                              @X50DQMC 88365042
         CONVT SR05                                            @X50DQMC 88365542
         CONVT SR13                                            @X50DQMC 88366042
         LABEL '5 EQUIP CHK, P-CHK #1','13 NOT USED'           @X50DQMC 88366542
         LINE   ,                                              @X50DQMC 88367042
         CONVT SR06                                            @X50DQMC 88367542
         CONVT SR14                                            @X50DQMC 88368042
         LABEL '6 EQUIP CHK, P-CHK #2','14 NOT USED'           @X50DQMC 88368542
         LINE   ,                                              @X50DQMC 88369042
         CONVT SR07                                            @X50DQMC 88369542
         CONVT SR15                                            @X50DQMC 88370042
         LABEL '7 EQUIP CHK, P-ERR, P-CHK #1','15 NOT USED'    @X50DQMC 88370542
         LINE   ,                                              @X50DQMC 88371042
         CONVT SR08                                            @X50DQMC 88371542
         CONVT SR16                                            @X50DQMC 88372042
         LABEL '8 DATA CHK','16 CHANNEL DATA CHK'              @X50DQMC 88372542
LASTLINE   LINE ,                                                       88380042
           ROUTINE TBLPTR,FREEALL                                       88440042
LABLIN     LABEL ''                                                     88500042
           LINE ,                                                       88560042
           LABEL '----END OF VTAM SUMMARY----'                          88620042
           DC   X'FF'                                                   88680042
           DC   XL6'000000000000'                                       88740042
           DC    C'$'                                                   88800042
LABELS     EQU *                                                        88860042
           LSTART                                                       88920042
          END                                                           88980042
