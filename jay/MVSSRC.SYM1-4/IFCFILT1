         TITLE 'IFCFILT1-RECORD FILTER FOR EDIT AND SUMMARY            *00001000
                        '                                               00002000
IFCFILT1 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IFCFILT1  78.122'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         STM   @00,@12,20(@13)                                     0001 00011000
         BALR  @12,0                                               0001 00012000
@PSTART  LA    @11,4095(,@12)                                      0001 00013000
         LA    @10,4095(,@11)                                      0001 00014000
         LA    @09,4095(,@10)                                      0001 00015000
         USING @PSTART,@12                                         0001 00016000
         USING @PSTART+4095,@11                                    0001 00017000
         USING @PSTART+8190,@10                                    0001 00018000
         USING @PSTART+12285,@09                                   0001 00019000
         ST    @13,@SA00001+4                                      0001 00020000
         LA    @14,@SA00001                                        0001 00021000
         ST    @14,8(,@13)                                         0001 00022000
         LR    @13,@14                                             0001 00023000
*                  /*PROCESS ERROR RECORDS SEQUENTIALLY      @Z427VLS*/ 00024000
*  IF DEBUG4 = ON THEN                                             0186 00025000
         TM    DEBUG4(R2),B'00001000'                              0186 00026000
         BNO   @RF00186                                            0186 00027000
*  DO;                                                     /*@Z427VLS*/ 00028000
*   R15 = R12 - 27;                                        /*@Z427VLS*/ 00029000
         LR    R15,R12                                             0188 00030000
         SL    R15,@CF00863                                        0188 00031000
*   GEN(MVC  PRINTBDY(16),0(R15));                         /*@Z427VLS*/ 00032000
         MVC  PRINTBDY(16),0(R15)                                       00033000
*   PRINTADR = ADDR(PRINTLIN);                             /*@Z427VLS*/ 00034000
         LA    @14,PRINTLIN                                        0190 00035000
         ST    @14,PRINTADR(,R2)                                   0190 00036000
*   CALL IOHND(RITEPRTR);                                  /*@Z427VLS*/ 00037000
         L     @15,ADIOHND(,R2)                                    0191 00038000
         LA    @01,@AL00191                                        0191 00039000
         BALR  @14,@15                                             0191 00040000
*   R15 = ZERO;                                            /*@Z427VLS*/ 00041000
         SLR   R15,R15                                             0192 00042000
*  END;                                                    /*@Z427VLS*/ 00043000
*  CALL INITIATE;  /*GET CORE AND USER PROGRAM               @Z427VLS*/ 00044000
@RF00186 BAL   @14,INITIATE                                        0194 00045000
*  R15 = ERROR; /*GET ANY PROBLEMS FROM INITIATE             @Z427VLS*/ 00046000
         L     R15,ERROR                                           0195 00047000
*  DO WHILE R15 = SUCCESS & I <= MAXENT; /*DO IF ROOM I SORTABLE*/ 0196 00048000
         B     @DE00196                                            0196 00049000
@DL00196 DS    0H                                                  0197 00050000
*    CALL IOHND(READSEQ);                        /*GET A RECORD*/  0197 00051000
         L     @15,ADIOHND(,R2)                                    0197 00052000
         LA    @01,@AL00197                                        0197 00053000
         BALR  @14,@15                                             0197 00054000
*    IF R15 = SUCCESS THEN  /*CONTINUE IF NOT EOF OR UNREADABLE*/  0198 00055000
         LTR   R15,R15                                             0198 00056000
         BNZ   @RF00198                                            0198 00057000
*      DO;                                                 /*@Z427VLS*/ 00058000
*        BUG(1) = BUG(1) + 1;   /*NUMBER OF RECORDS READ     @Z427VLS*/ 00059000
         LA    @14,1                                               0200 00060000
         AL    @14,BUG                                             0200 00061000
         ST    @14,BUG                                             0200 00062000
*       IF (LRTKEY1 & GENREC) = HEXA0 | /* IF MCH OR CCH FRAME RECORD * 00063000
*        (LRTKEY1 & GENREC) = HEXB0 THEN                           0201 00064000
         MVC   @TS00001(1),LRTKEY1(R7)                             0201 00065000
         NI    @TS00001,X'F0'                                      0201 00066000
         CLI   @TS00001,X'A0'                                      0201 00067000
         BE    @RT00201                                            0201 00068000
         MVC   @TS00001(1),LRTKEY1(R7)                             0201 00069000
         NI    @TS00001,X'F0'                                      0201 00070000
         CLI   @TS00001,X'B0'                                      0201 00071000
         BNE   @RF00201                                            0201 00072000
@RT00201 DS    0H                                                  0202 00073000
*    DO;                                                   /*@G51DGGB*/ 00074000
*    BUG(39) = BUG(39) + 1;                                /*@G51DGGB*/ 00075000
         LA    @14,1                                               0203 00076000
         AL    @14,BUG+152                                         0203 00077000
         ST    @14,BUG+152                                         0203 00078000
*    IF (PMCH = ON | PCHAN = ON) THEN                              0204 00079000
         TM    PMCH(R2),B'11000000'                                0204 00080000
         BZ    @RF00204                                            0204 00081000
*       CALL CKFRAMES;             /*GO SEE IF WE DO ANY THING WITH IT* 00082000
         BAL   @14,CKFRAMES                                        0205 00083000
*     ELSE                                                         0206 00084000
*      BUG(37) = BUG(37) + ONE;                            /*@G51DGGB*/ 00085000
         B     @RC00204                                            0206 00086000
@RF00204 LA    @14,1                                               0206 00087000
         AL    @14,BUG+144                                         0206 00088000
         ST    @14,BUG+144                                         0206 00089000
*    END;                                                  /*@G51DGGB*/ 00090000
*      ELSE  /*NORMAL ERROR RECORD PROCESSING                @G51DGGB*/ 00091000
*       DO;                                                /*@G51DGGB*/ 00092000
         B     @RC00201                                            0208 00093000
@RF00201 DS    0H                                                  0209 00094000
*        CALL FILTER;          /*SELECT RECORD, BUILD SORTKEY*/    0209 00095000
         BAL   @14,FILTER                                          0209 00096000
*        IF PASSFLAG = YES THEN                                    0210 00097000
         TM    PASSFLAG(R2),B'00000001'                            0210 00098000
         BNO   @RF00210                                            0210 00099000
*          DO;                                             /*@Z427VLS*/ 00100000
*            IF PACC = YES THEN    /*HISTORY D.S. TO BE CREATED*/  0212 00101000
         TM    PACC(R2),B'01000000'                                0212 00102000
         BNO   @RF00212                                            0212 00103000
*                CALL IOHND(RITEHIST);  /*WRITE TO ACCDEV    @Z427VLS*/ 00104000
         L     @15,ADIOHND(,R2)                                    0213 00105000
         LA    @01,@AL00213                                        0213 00106000
         BALR  @14,@15                                             0213 00107000
*            IF R15 = SUCCESS & PRINTES ^= NEITHER /*RECORDS PRINTED?*/ 00108000
*              THEN DO;                                    /*@Z427VLS*/ 00109000
@RF00212 LTR   R15,R15                                             0214 00110000
         BNZ   @RF00214                                            0214 00111000
         TM    PRINTES(R2),B'00011000'                             0214 00112000
         BZ    @RF00214                                            0214 00113000
*                SORTABLE(I) = WORKTABL;                   /*@Z427VLS*/ 00114000
         L     @14,I                                               0216 00115000
         MH    @14,@CH00034                                        0216 00116000
         L     @08,SORTADR(,R2)                                    0216 00117000
         ALR   @08,@14                                             0216 00118000
         AL    @08,@CF01518                                        0216 00119000
         MVC   SORTABLE(10,@08),WORKTABL                           0216 00120000
*                IF PHIST = ON THEN /*IF HISTORY INPUT, MUST SAVE*/     00121000
         TM    PHIST(R2),B'00100000'                               0217 00122000
         BNO   @RF00217                                            0217 00123000
*                  DO;              /*RECORDS ON D.A.D.S.    @Z427VLS*/ 00124000
*                    CALL IOHND(RITESCRT);                 /*@Z427VLS*/ 00125000
         L     @15,ADIOHND(,R2)                                    0219 00126000
         LA    @01,@AL00219                                        0219 00127000
         BALR  @14,@15                                             0219 00128000
*                    IF R15 = OVERFLOW THEN /*SCRATCH D.S. TOO SMALL*/  00129000
         C     R15,@CF00066                                        0220 00130000
         BNE   @RF00220                                            0220 00131000
*                     DO;                                  /*@Z427VLS*/ 00132000
*                      ZEROALL = NO; /*DONT CLEAR SERLOG IF ALL*/  0222 00133000
         NI    ZEROALL(R2),B'10111111'                             0222 00134000
*                      PASSNUM = PASSNUM - 1; /*NO ROOM FOR RECORD*/    00135000
         L     @14,PASSNUM                                         0223 00136000
         BCTR  @14,0                                               0223 00137000
         ST    @14,PASSNUM                                         0223 00138000
*                     END;                                 /*@Z427VLS*/ 00139000
*                  END;              /*RECORDS NOT PROCESSED @Z427VLS*/ 00140000
@RF00220 DS    0H                                                  0226 00141000
*                IF R15 = SUCCESS THEN  /*SAVE RECORD LOCATION AND*/    00142000
@RF00217 LTR   R15,R15                                             0226 00143000
         BNZ   @RF00226                                            0226 00144000
*                  DO;                  /*UPDATE INDEX TO NEXT */  0227 00145000
*                    SORTCCHR(I) = RECCCHHR; /*TABLE ENTRY.  @Z427VLS*/ 00146000
         L     @14,I                                               0228 00147000
         LR    @08,@14                                             0228 00148000
         MH    @08,@CH00034                                        0228 00149000
         L     @06,SORTADR(,R2)                                    0228 00150000
         ALR   @06,@08                                             0228 00151000
         AL    @06,@CF01520                                        0228 00152000
         MVC   SORTCCHR-5(5,@06),RECCCHHR(R2)                      0228 00153000
*                    I = I + 1;                            /*@Z427VLS*/ 00154000
         AL    @14,@CF00055                                        0229 00155000
         ST    @14,I                                               0229 00156000
*                  END;                                    /*@Z427VLS*/ 00157000
*              END;                                        /*@Z427VLS*/ 00158000
@RF00226 DS    0H                                                  0232 00159000
*          END;                                            /*@Z427VLS*/ 00160000
@RF00214 DS    0H                                                  0233 00161000
* END;                                                     /*@G51DGGB*/ 00162000
@RF00210 DS    0H                                                  0234 00163000
*      END;                                                /*@Z427VLS*/ 00164000
@RC00201 DS    0H                                                  0235 00165000
*  END;                                                    /*@Z427VLS*/ 00166000
@RF00198 DS    0H                                                  0235 00167000
@DE00196 LTR   R15,R15                                             0235 00168000
         BNZ   @DC00196                                            0235 00169000
         L     @14,I                                               0235 00170000
         C     @14,MAXENT                                          0235 00171000
         BNH   @DL00196                                            0235 00172000
@DC00196 DS    0H                                                  0236 00173000
*  ERROR = R15; /*TELL ENDOFILE ERROR STATUS                 @Z427VLS*/ 00174000
         ST    R15,ERROR                                           0236 00175000
*  CALL ENDOFILE; /*SORT SORTABLE, FREE EXCESS CORE, HANDLE  @Z427VLS*/ 00176000
         BAL   @14,ENDOFILE                                        0237 00177000
*                 /*ERROR CONDITIONS                         @Z427VLS*/ 00178000
*  R15 = ERROR; /*PASS RETURN CODE TO USER                   @Z427VLS*/ 00179000
         L     R15,ERROR                                           0238 00180000
*  IF DEBUG16 = ON THEN                                            0239 00181000
         TM    DEBUG16(R2),B'10000000'                             0239 00182000
         BNO   @RF00239                                            0239 00183000
*    CALL BUGCNTS; /*PRINT COUNTS OF DIFFERENT RECORDS PROCESSED*/ 0240 00184000
         BAL   @14,BUGCNTS                                         0240 00185000
*  IF DEBUG11 = ON THEN                                            0241 00186000
@RF00239 TM    DEBUG11(R2),B'00010000'                             0241 00187000
         BNO   @RF00241                                            0241 00188000
*    GEN(ABEND 120,DUMP); /*SHOW STATUS IF TESTING SITUATION @Z427VLS*/ 00189000
         ABEND 120,DUMP                                                 00190000
*RESPECIFY (R15) UNRESTRICTED;                             /*@Z427VLS*/ 00191000
*INITIATE: PROC; /*LOAD USER PROGRAM AND GET CORE FOR SORT TABLE*/ 0244 00192000
@EL00001 L     @13,4(,@13)                                         0244 00193000
@EF00001 DS    0H                                                  0244 00194000
@ER00001 L     @14,12(,@13)                                        0244 00195000
         LM    @00,@12,20(@13)                                     0244 00196000
         BR    @14                                                 0244 00197000
INITIATE STM   @14,@12,@SA00002                                    0244 00198000
*RESPECIFY(R0,R3,R15) RESTRICTED;                          /*@Z427VLS*/ 00199000
*  R15 = ZERO;                                             /*@Z427VLS*/ 00200000
         SLR   R15,R15                                             0246 00201000
*  IF USERPGM ^= BLANKS THEN /*IF USER PROGRAM EXISTS        @Z427VLS*/ 00202000
         CLC   USERPGM(8,R2),@CC00977                              0247 00203000
         BE    @RF00247                                            0247 00204000
*    DO;                                                   /*@Z427VLS*/ 00205000
*       BLDNAME = USERPGM;                                 /*@Z427VLS*/ 00206000
         MVC   BLDNAME(8),USERPGM(R2)                              0249 00207000
*       GEN(BLDL  0,BLDLIST);                              /*@Z427VLS*/ 00208000
         BLDL  0,BLDLIST                                                00209000
*       IF R15 ^= SUCCESS THEN /* USER PROGRAM NOT IN LIBRARY IF*/ 0251 00210000
         LTR   R15,R15                                             0251 00211000
         BZ    @RF00251                                            0251 00212000
*         DO;                  /* R15 NOT SUCCESS            @Z427VLS*/ 00213000
*            MSGNO = 1; /*PRINT - CANT FIND USER PROGRAM     @Z427VLS*/ 00214000
         MVI   MSGNO,X'01'                                         0253 00215000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 00216000
         BAL   @14,ERRMSG                                          0254 00217000
*            R15 = TERMINAT;                               /*@Z427VLS*/ 00218000
         LA    R15,12                                              0255 00219000
*         END;                                             /*@Z427VLS*/ 00220000
*       ELSE                                                       0257 00221000
*         DO;                                              /*@Z427VLS*/ 00222000
         B     @RC00251                                            0257 00223000
@RF00251 DS    0H                                                  0258 00224000
*             GEN(LOADEREP EPLOC=BLDNAME);  /*LOAD USER PROGRAM INTO */ 00225000
         LOADEREP EPLOC=BLDNAME                                         00226000
*            USERLOC = R0;          /*VIRTUAL STORAGE AND    @Z427VLS*/ 00227000
         ST    R0,USERLOC                                          0259 00228000
*         END;                      /*SAVE ITS LOCATION      @Z427VLS*/ 00229000
*    END;                                                  /*@Z427VLS*/ 00230000
@RC00251 DS    0H                                                  0262 00231000
*  IF R15 = SUCCESS THEN /*IF SUCCESSFUL LOAD OR NO USER PROGRAM*/ 0262 00232000
@RF00247 LTR   R15,R15                                             0262 00233000
         BNZ   @RF00262                                            0262 00234000
*    DO;                                                   /*@Z427VLS*/ 00235000
*      IF PEDIT = ON | PSUM = ON THEN /*SORTABLE BUILT IF EDIT OR*/     00236000
         TM    PEDIT(R2),B'00011000'                               0264 00237000
         BZ    @RF00264                                            0264 00238000
*        DO;                          /*SUMMARY PRINTING     @Z427VLS*/ 00239000
*           MAXENT = TABSIZE / 10; /*MAX SORT TABLE ENTRY    @Z427VLS*/ 00240000
         L     @14,TABSIZE(,R2)                                    0266 00241000
         LR    @04,@14                                             0266 00242000
         SRDA  @04,32                                              0266 00243000
         D     @04,@CF00034                                        0266 00244000
         ST    @05,MAXENT                                          0266 00245000
*           R0     = TABSIZE; /*AMOUNT OF CORE FOR GETMAIN   @Z427VLS*/ 00246000
         LR    R0,@14                                              0267 00247000
*           GEN(GETMAIN EC,LV=(R0),A=GETADR); /*CONDITIONAL GETMAIN*/   00248000
         GETMAIN EC,LV=(R0),A=GETADR                                    00249000
*           IF R15 ^= SUCCESS THEN  /*IF CANT GET CORE, TELL WORLD*/    00250000
         LTR   R15,R15                                             0269 00251000
         BZ    @RF00269                                            0269 00252000
*             DO;                                          /*@Z427VLS*/ 00253000
*               MSGNO = 2;                                 /*@Z427VLS*/ 00254000
         MVI   MSGNO,X'02'                                         0271 00255000
*               CALL ERRMSG;                               /*@Z427VLS*/ 00256000
         BAL   @14,ERRMSG                                          0272 00257000
*               R15 = NOSRTABL;                            /*@Z427VLS*/ 00258000
         LA    R15,12                                              0273 00259000
*               GETFAIL = YES;                             /*@0001VLS*/ 00260000
         OI    GETFAIL,B'00010000'                                 0274 00261000
*             END;                                         /*@Z427VLS*/ 00262000
*           ELSE                                                   0276 00263000
*             SORTADR = GETADR; /*SET SORTABLE ADDRESS BASE  @Z427VLS*/ 00264000
         B     @RC00269                                            0276 00265000
@RF00269 L     @14,GETADR                                          0276 00266000
         ST    @14,SORTADR(,R2)                                    0276 00267000
*         END;                                             /*@Z427VLS*/ 00268000
*       ELSE                                                       0278 00269000
*         MAXENT = MAXMAX; /*IF NO TABLES, SET BIG ARBITRARY LOOP LIM*/ 00270000
         B     @RC00264                                            0278 00271000
@RF00264 MVC   MAXENT(4),@CF01046                                  0278 00272000
*     END;                                                 /*@Z427VLS*/ 00273000
*  ELSE                                                            0280 00274000
*    MAXENT = MAXMAX;     /* AVOID MSG # 64 IN EOF           @G51DGGB*/ 00275000
         B     @RC00262                                            0280 00276000
@RF00262 MVC   MAXENT(4),@CF01046                                  0280 00277000
*IF R15 = SUCCESS &  /*IF OTHER GETMAINS HAVE BEEN SUCCESSFULL  */ 0281 00278000
*         (PMCH = ON | PCHAN = ON) THEN /*IF MCH OR CCH SELECTED*/ 0281 00279000
@RC00262 LTR   R15,R15                                             0281 00280000
         BNZ   @RF00281                                            0281 00281000
         TM    PMCH(R2),B'11000000'                                0281 00282000
         BZ    @RF00281                                            0281 00283000
*  DO;                                                     /*@G51DGGB*/ 00284000
*    R0 = FRAMBENT * EVMAX; /*NUMBER OF ENTRIES TIMES BYTES PER ENTRY*/ 00285000
         LA    R0,384                                              0283 00286000
*    R0 = R0 + 4;           /*ADD FRAMENUM LENGTH            @G51DGGB*/ 00287000
         AL    R0,@CF00064                                         0284 00288000
*    GEN(GETMAIN EC,LV=(0),A=TEMPSAV,SP=21);               /*@G51DGGB*/ 00289000
         GETMAIN EC,LV=(0),A=TEMPSAV,SP=21                              00290000
*    FRAMEPTR = TEMPSAV;                                   /*@G51DGGB*/ 00291000
         L     @14,TEMPSAV                                         0286 00292000
         ST    @14,FRAMEPTR(,R2)                                   0286 00293000
*    IF R15 = SUCCESS THEN   /*IF GETMAIN SUCCESSFULL        @G51DGGB*/ 00294000
         LTR   R15,R15                                             0287 00295000
         BNZ   @RF00287                                            0287 00296000
*      DO;                                                 /*@G51DGGB*/ 00297000
*       BUG(42) = BUG(42) + 1;                             /*@G51DGGB*/ 00298000
         LA    @14,1                                               0289 00299000
         L     @08,BUG+164                                         0289 00300000
         ALR   @08,@14                                             0289 00301000
         ST    @08,BUG+164                                         0289 00302000
*        DO Y = 1 BY 1 TO EVMAX; /*CLEAR FRAMETAB TO ZEROS   @G51DGGB*/ 00303000
         ST    @14,Y                                               0290 00304000
@DL00290 DS    0H                                                  0291 00305000
*          FRAMEDTA(Y) = (FRAMEDTA(Y) && FRAMEDTA(Y));     /*@G51DGGB*/ 00306000
         LR    @08,@14                                             0291 00307000
         MH    @08,@CH00227                                        0291 00308000
         L     @01,FRAMEPTR(,R2)                                   0291 00309000
         ALR   @01,@08                                             0291 00310000
         AL    @01,@CF01522                                        0291 00311000
         XC    FRAMEDTA-4(24,@01),FRAMEDTA-4(@01)                  0291 00312000
*        END;                                              /*@G51DGGB*/ 00313000
         AL    @14,@CF00055                                        0292 00314000
         ST    @14,Y                                               0292 00315000
         C     @14,@CF00088                                        0292 00316000
         BNH   @DL00290                                            0292 00317000
*        FRAMENUM = ZERO;                                  /*@G51DGGB*/ 00318000
         L     @01,FRAMEPTR(,R2)                                   0293 00319000
         SLR   @14,@14                                             0293 00320000
         ST    @14,FRAMENUM(,@01)                                  0293 00321000
*      END;                                                /*@G51DGGB*/ 00322000
*  ELSE  /*UNSUCCESSFULL GETMAIN                             @G51DGGB*/ 00323000
*    DO;                                                   /*@G51DGGB*/ 00324000
         B     @RC00287                                            0295 00325000
@RF00287 DS    0H                                                  0296 00326000
*      MSGNO = XX;   /*ERROR MESSAGE NUMBER                  @G51DGGB*/ 00327000
         MVI   MSGNO,X'08'                                         0296 00328000
*      CALL ERRMSG;  /*PRINT ERROR MESSAGE                   @G51DGGB*/ 00329000
         BAL   @14,ERRMSG                                          0297 00330000
*      R15 = TWELVE;  /*DONT CONTINUE RETURN CODE            @G51DGGB*/ 00331000
         LA    @08,12                                              0298 00332000
         LR    R15,@08                                             0298 00333000
*      ERROR = 12;                                         /*@G51DGGB*/ 00334000
         ST    @08,ERROR                                           0299 00335000
*    END;                                                  /*@G51DGGB*/ 00336000
* END; /*END OF FRAMETAB GETMAIN                             @G51DGGB*/ 00337000
@RC00287 DS    0H                                                  0302 00338000
*ERROR = R15; /*TELL MAIN PROC IF ERROR CONDITION            @Z427VLS*/ 00339000
@RF00281 ST    R15,ERROR                                           0302 00340000
*RESPECIFY(R0,R1,R15) UNRESTRICTED;                        /*@Z427VLS*/ 00341000
*END;                                                      /*@Z427VLS*/ 00342000
@EL00002 DS    0H                                                  0304 00343000
@EF00002 DS    0H                                                  0304 00344000
@ER00002 LM    @14,@12,@SA00002                                    0304 00345000
         BR    @14                                                 0304 00346000
*ENDOFILE: PROC; /*SORT SORTABLE AND PASS RETURN CODE TO EREP1*/   0305 00347000
ENDOFILE STM   @14,@12,@SA00003                                    0305 00348000
*RESPECIFY(R15) RESTRICTED;                                /*@Z427VLS*/ 00349000
*IF ERROR = OVERFLOW & PHIST = ON & PLOGREC = OFF THEN             0307 00350000
         CLC   ERROR(4),@CF00066                                   0307 00351000
         BNE   @RF00307                                            0307 00352000
         TM    PHIST(R2),B'00100000'                               0307 00353000
         BNO   @RF00307                                            0307 00354000
         TM    PLOGREC(R2),B'00000010'                             0307 00355000
         BNZ   @RF00307                                            0307 00356000
*  DO;                                                     /*@0001VLS*/ 00357000
*    CLOSEIO = (CLOSEIO && CLOSEIO);                       /*@0001VLS*/ 00358000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0309 00359000
*    CACCIN = ON;                                          /*@0001VLS*/ 00360000
         OI    CACCIN(R2),B'00010000'                              0310 00361000
*    CALL IOHND(IOCLOSE);                                  /*@0001VLS*/ 00362000
         L     @15,ADIOHND(,R2)                                    0311 00363000
         LA    @01,@AL00311                                        0311 00364000
         BALR  @14,@15                                             0311 00365000
*  END;                                                    /*@0001VLS*/ 00366000
*R15 = ERROR; /*GET MAIN PROCEDURE ERROR STATUS              @Z427VLS*/ 00367000
@RF00307 L     R15,ERROR                                           0313 00368000
*IF R15 = OVERFLOW | R15 = ENDFILE THEN                            0314 00369000
         C     R15,@CF00066                                        0314 00370000
         BE    @RT00314                                            0314 00371000
         C     R15,@CF00064                                        0314 00372000
         BNE   @RF00314                                            0314 00373000
@RT00314 DS    0H                                                  0315 00374000
*  R15 = ZERO;          /*DOESNT NEED TO KNOW                @Z427VLS*/ 00375000
         SLR   R15,R15                                             0315 00376000
*IF MAXENT < I & ERROR ^= ENDFILE & GETFAIL = NO THEN              0316 00377000
@RF00314 L     @14,MAXENT                                          0316 00378000
         C     @14,I                                               0316 00379000
         BNL   @RF00316                                            0316 00380000
         CLC   ERROR(4),@CF00064                                   0316 00381000
         BE    @RF00316                                            0316 00382000
         TM    GETFAIL,B'00010000'                                 0316 00383000
         BNZ   @RF00316                                            0316 00384000
*  DO;                   /*WORLD, DONT TELL EREP1, DONT LET LOGREC*/    00385000
*    ZEROALL = NO;       /*BE RESET.                         @Z427VLS*/ 00386000
         NI    ZEROALL(R2),B'10111111'                             0318 00387000
*    MSGNO = 3;                                            /*@Z427VLS*/ 00388000
         MVI   MSGNO,X'03'                                         0319 00389000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00390000
         BAL   @14,ERRMSG                                          0320 00391000
*    ERROR = ZERO;                                         /*@0001VLS*/ 00392000
         SLR   @14,@14                                             0321 00393000
         ST    @14,ERROR                                           0321 00394000
*  END;                                                    /*@Z427VLS*/ 00395000
*IF ERROR = OVERFLOW | ERROR = ENDFILE THEN                        0323 00396000
@RF00316 L     @14,ERROR                                           0323 00397000
         C     @14,@CF00066                                        0323 00398000
         BE    @RT00323                                            0323 00399000
         C     @14,@CF00064                                        0323 00400000
         BNE   @RF00323                                            0323 00401000
@RT00323 DS    0H                                                  0324 00402000
*  ERROR = ZERO;                                           /*@0001VLS*/ 00403000
         SLR   @14,@14                                             0324 00404000
         ST    @14,ERROR                                           0324 00405000
* IF DEBUG16 = ON THEN                                             0325 00406000
@RF00323 TM    DEBUG16(R2),B'10000000'                             0325 00407000
         BNO   @RF00325                                            0325 00408000
*  DO;                                                     /*@0099VLS*/ 00409000
*BINWORD = BUG(1);                                         /*@G51DGGB*/ 00410000
         L     @14,BUG                                             0327 00411000
         ST    @14,BINWORD                                         0327 00412000
*CALL IFCMSG(83,ADDR(PRINTBDY));                           /*@G51DGGB*/ 00413000
         LA    @14,PRINTBDY                                        0328 00414000
         ST    @14,@AFTEMPS                                        0328 00415000
         L     @15,ADIFCMSG(,R2)                                   0328 00416000
         LA    @01,@AL00328                                        0328 00417000
         BALR  @14,@15                                             0328 00418000
*  GEN(MVC  PRINTBDY(7),BUG16);                            /*@0099VLS*/ 00419000
         MVC  PRINTBDY(7),BUG16                                         00420000
*DECADDR= ADDR(PRINTBDY) + 7;                              /*@G51DGGB*/ 00421000
         LA    @14,PRINTBDY                                        0330 00422000
         AL    @14,@CF00083                                        0330 00423000
         ST    @14,DECADDR                                         0330 00424000
*CALL CONVBIN;                                             /*@G51DGGB*/ 00425000
         BAL   @14,CONVBIN                                         0331 00426000
*CALL PRINTIT;                                             /*@G51DGGB*/ 00427000
         BAL   @14,PRINTIT                                         0332 00428000
*  END;                                                    /*@0099VLS*/ 00429000
*CALL IFCMSG(54,ADDR(PRINTBDY));                           /*@G51DGGB*/ 00430000
@RF00325 LA    @14,PRINTBDY                                        0334 00431000
         ST    @14,@AFTEMPS                                        0334 00432000
         L     @15,ADIFCMSG(,R2)                                   0334 00433000
         LA    @01,@AL00334                                        0334 00434000
         BALR  @14,@15                                             0334 00435000
*DECADDR = ADDR(PRINTBDY) + 7; /*WHERE TO PUT CONVERTED VALUE*/    0335 00436000
         LA    @14,PRINTBDY                                        0335 00437000
         AL    @14,@CF00083                                        0335 00438000
         ST    @14,DECADDR                                         0335 00439000
*DECADDR = ADDR(PRINTBDY) + 7; /*WHERE TO PUT CONVERTED VALUE*/    0336 00440000
         ST    @14,DECADDR                                         0336 00441000
*BINWORD  = PASSNUM;                                       /*@G51DGGB*/ 00442000
         L     @14,PASSNUM                                         0337 00443000
         ST    @14,BINWORD                                         0337 00444000
*CALL CONVBIN;                                             /*@G51DGGB*/ 00445000
         BAL   @14,CONVBIN                                         0338 00446000
*CALL PRINTIT;                                             /*@G51DGGB*/ 00447000
         BAL   @14,PRINTIT                                         0339 00448000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 00449000
         LA    @14,PRINTLIN                                        0340 00450000
         ST    @14,PRINTADR(,R2)                                   0340 00451000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 00452000
         L     @15,ADIOHND(,R2)                                    0341 00453000
         LA    @01,@AL00341                                        0341 00454000
         BALR  @14,@15                                             0341 00455000
*IF PHIST = ON THEN                 /*HAVE TO CLOSE THE DIRECTWK */     00456000
         TM    PHIST(R2),B'00100000'                               0342 00457000
         BNO   @RF00342                                            0342 00458000
*  DO;                                                     /*@G51DGGB*/ 00459000
*   CLOSEIO = CLOSEIO && CLOSEIO;                          /*@G51DGGB*/ 00460000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0344 00461000
*   CDRCTWRK= ON;                   /*SET THE FLAG TO ON     @G51DGGB*/ 00462000
         OI    CDRCTWRK(R2),B'00000010'                            0345 00463000
*   CALL IOHND(IOCLOSE);                                   /*@G51DGGB*/ 00464000
         L     @15,ADIOHND(,R2)                                    0346 00465000
         LA    @01,@AL00346                                        0346 00466000
         BALR  @14,@15                                             0346 00467000
*  END;                                                    /*@G51DGGB*/ 00468000
*IF FRAMEPTR ^= 0 & FRAMENUM ^= 0 THEN                             0348 00469000
@RF00342 SLR   @14,@14                                             0348 00470000
         L     @08,FRAMEPTR(,R2)                                   0348 00471000
         CR    @08,@14                                             0348 00472000
         BE    @RF00348                                            0348 00473000
         C     @14,FRAMENUM(,@08)                                  0348 00474000
         BE    @RF00348                                            0348 00475000
* DO J = 1 BY 1 TO FRAMENUM;                               /*@G51DGGB*/ 00476000
         LA    @14,1                                               0349 00477000
         ST    @14,J                                               0349 00478000
         B     @DE00349                                            0349 00479000
@DL00349 DS    0H                                                  0350 00480000
*  IF FRAMETYP(J) = ALLALL THEN                                    0350 00481000
         MH    @14,@CH00227                                        0350 00482000
         L     @08,FRAMEPTR(,R2)                                   0350 00483000
         ALR   @08,@14                                             0350 00484000
         AL    @08,@CF01524                                        0350 00485000
         CLI   FRAMETYP-17(@08),X'FF'                              0350 00486000
         BNE   @RF00350                                            0350 00487000
*   BUG(38) = BUG(38) + 1;                                 /*@G51DGGB*/ 00488000
         LA    @14,1                                               0351 00489000
         AL    @14,BUG+148                                         0351 00490000
         ST    @14,BUG+148                                         0351 00491000
* END;                                                     /*@G51DGGB*/ 00492000
@RF00350 LA    @14,1                                               0352 00493000
         AL    @14,J                                               0352 00494000
         ST    @14,J                                               0352 00495000
@DE00349 L     @08,FRAMEPTR(,R2)                                   0352 00496000
         C     @14,FRAMENUM(,@08)                                  0352 00497000
         BNH   @DL00349                                            0352 00498000
*IF ERROR < TWELVE & FRAMEPTR ^= 0                                 0353 00499000
*   &  FRAMENUM > ZERO THEN /* IF FRAMES CPUS FOUND          @G51DGGB*/ 00500000
@RF00348 L     @14,ERROR                                           0353 00501000
         C     @14,@CF00032                                        0353 00502000
         BNL   @RF00353                                            0353 00503000
         SLR   @14,@14                                             0353 00504000
         L     @08,FRAMEPTR(,R2)                                   0353 00505000
         CR    @08,@14                                             0353 00506000
         BE    @RF00353                                            0353 00507000
         C     @14,FRAMENUM(,@08)                                  0353 00508000
         BNL   @RF00353                                            0353 00509000
*    CALL WRITEFRM;                                        /*@G51DGGB*/ 00510000
         BAL   @14,WRITEFRM                                        0354 00511000
*IF ERROR ^= NOSRTABL & (PSUM = ON | PEDIT = ON) THEN              0355 00512000
@RF00353 CLC   ERROR(4),@CF00032                                   0355 00513000
         BE    @RF00355                                            0355 00514000
         TM    PSUM(R2),B'00011000'                                0355 00515000
         BZ    @RF00355                                            0355 00516000
* DO;                                                      /*@Z427VLS*/ 00517000
*   SORTNUM = PASSNUM;     /*TELL EREP1 HOW MANY RECORDS IN SORTABLE*/  00518000
         L     @14,PASSNUM                                         0357 00519000
         ST    @14,SORTNUM(,R2)                                    0357 00520000
*   EXCESS = TABSIZE - (PASSNUM * SORTELNT); /*UNUSED SORTABLE*/   0358 00521000
         L     @08,TABSIZE(,R2)                                    0358 00522000
         MH    @14,@CH00034                                        0358 00523000
         LCR   @14,@14                                             0358 00524000
         ALR   @14,@08                                             0358 00525000
         ST    @14,EXCESS                                          0358 00526000
*   IF EXCESS > 16 THEN  /*IF AT LEAST ONE DOUBLEWORD AFTER ROUNDING*/  00527000
         C     @14,@CF00088                                        0359 00528000
         BNH   @RF00359                                            0359 00529000
*   DO;                                                    /*@Z427VLS*/ 00530000
*     EXCESS = (EXCESS & DBWRD); /*ROUND DOWN TO DOUBLE WORD AMMOUNT*/  00531000
         N     @14,@CF01049                                        0361 00532000
         ST    @14,EXCESS                                          0361 00533000
*     RESPECIFY (R0,R1) RESTRICTED;                        /*@Z427VLS*/ 00534000
*     R0 = EXCESS;                                         /*@Z427VLS*/ 00535000
         LR    R0,@14                                              0363 00536000
*     R1 = SORTADR + TABSIZE - EXCESS; /*POINT TO BEGINNING OF UNUSED*/ 00537000
         AL    @08,SORTADR(,R2)                                    0364 00538000
         SLR   @08,@14                                             0364 00539000
         LR    R1,@08                                              0364 00540000
*     GEN(FREEMAIN  R,LV=(0),A=(1));                       /*@Z427VLS*/ 00541000
         FREEMAIN  R,LV=(0),A=(1)                                       00542000
*   END;                                                   /*@Z427VLS*/ 00543000
*   RESPECIFY(R0,R1) UNRESTRICTED;                         /*@Z427VLS*/ 00544000
@RF00359 DS    0H                                                  0368 00545000
*  END;                                                    /*@Z427VLS*/ 00546000
*CLOSEIO = '0000'X; /*DONT CLOSE UNNECESSARY DATA SETS       @Z427VLS*/ 00547000
@RF00355 MVC   CLOSEIO(2,R2),@CB00208                              0369 00548000
*IF PACC = YES THEN  /*IF WROTE RECORDS TO ACCDEV, THEN BETTER CLOSE*/  00549000
         TM    PACC(R2),B'01000000'                                0370 00550000
         BNO   @RF00370                                            0370 00551000
*  CACCDEV = ON;                                           /*@Z427VLS*/ 00552000
         OI    CACCDEV(R2),B'00001000'                             0371 00553000
*IF CACCDEV = ON | CDRCTWRK = ON THEN                              0372 00554000
@RF00370 TM    CACCDEV(R2),B'00001010'                             0372 00555000
         BZ    @RF00372                                            0372 00556000
*  CALL IOHND(IOCLOSE);                                    /*@Z427VLS*/ 00557000
         L     @15,ADIOHND(,R2)                                    0373 00558000
         LA    @01,@AL00373                                        0373 00559000
         BALR  @14,@15                                             0373 00560000
*IF PASSNUM = ZERO THEN     /*IF NO RECORDS, EREP1 SHOULD QUIT*/   0374 00561000
@RF00372 L     @14,PASSNUM                                         0374 00562000
         LTR   @14,@14                                             0374 00563000
         BNZ   @RF00374                                            0374 00564000
*  ERROR = TERMINAT;                                       /*@0001VLS*/ 00565000
         MVC   ERROR(4),@CF00032                                   0375 00566000
*IF ERROR = SUCCESS & PRINTES ^= NEITHER THEN                      0376 00567000
@RF00374 L     @14,ERROR                                           0376 00568000
         LTR   @14,@14                                             0376 00569000
         BNZ   @RF00376                                            0376 00570000
         TM    PRINTES(R2),B'00011000'                             0376 00571000
         BZ    @RF00376                                            0376 00572000
* DO;                                                      /*@Z427VLS*/ 00573000
*  CALL SIFTSORT;                                          /*@Z427VLS*/ 00574000
         BAL   @14,SIFTSORT                                        0378 00575000
*  CALL FREETAB; /*FREE CORE FOR PARAMETER TABLES NO LONGER USED*/ 0379 00576000
         BAL   @14,FREETAB                                         0379 00577000
* END;                                                     /*@Z427VLS*/ 00578000
*RESPECIFY    (R15) UNRESTRICTED;                          /*@Z427VLS*/ 00579000
*END;                                                      /*@Z427VLS*/ 00580000
@EL00003 DS    0H                                                  0382 00581000
@EF00003 DS    0H                                                  0382 00582000
@ER00003 LM    @14,@12,@SA00003                                    0382 00583000
         BR    @14                                                 0382 00584000
*FILTER: PROC; /*FILTER RECORDS AND SAVE SORT INFORMATION    @Z427VLS*/ 00585000
FILTER   STM   @14,@12,@SA00004                                    0383 00586000
*RESPECIFY (R15) RESTRICTED;                               /*@G51DGGB*/ 00587000
*CALL ALLREC;  /*RECORD HEADER CHECKS                        @Z427VLS*/ 00588000
         BAL   @14,ALLREC                                          0385 00589000
*IF PASSFLAG = ON THEN                                             0386 00590000
         TM    PASSFLAG(R2),B'00000001'                            0386 00591000
         BNO   @RF00386                                            0386 00592000
*  DO;                                                     /*@Z427VLS*/ 00593000
*    CALL RECDEP; /* RECORD BODY CHECKS- SOME DEVICE DEPENDENT*/   0388 00594000
         BAL   @14,RECDEP                                          0388 00595000
*    IF PASSFLAG = ON THEN                                         0389 00596000
         TM    PASSFLAG(R2),B'00000001'                            0389 00597000
         BNO   @RF00389                                            0389 00598000
*      DO;                                                 /*@Z427VLS*/ 00599000
*        /*IF FURTHER CHECKS LIKE SYMCDE, WHICH ASSUME ALL OTHER*/ 0391 00600000
*        /*SELECTIONS HAVE ALREADY BEEN DONE, LOAD SPECIAL PROGRAM*/    00601000
*        IF USERPGM ^= BLANKS THEN                                 0391 00602000
         CLC   USERPGM(8,R2),@CC00977                              0391 00603000
         BE    @RF00391                                            0391 00604000
*          DO;                                             /*@Z427VLS*/ 00605000
*            GEN(L R15,USERLOC);                           /*@Z427VLS*/ 00606000
         L R15,USERLOC                                                  00607000
*            GEN(BALR  R14,R15);                           /*@Z427VLS*/ 00608000
         BALR  R14,R15                                                  00609000
*          END;                                            /*@Z427VLS*/ 00610000
*        IF PASSFLAG = YES THEN  /*USER PROGRAM GETS PASSFLAG FROM*/    00611000
@RF00391 TM    PASSFLAG(R2),B'00000001'                            0396 00612000
         BNO   @RF00396                                            0396 00613000
*                                /*PARM TABLE ADDRESSED BY REG2*/  0397 00614000
*          PASSNUM = PASSNUM + 1;                          /*@Z427VLS*/ 00615000
         LA    @14,1                                               0397 00616000
         AL    @14,PASSNUM                                         0397 00617000
         ST    @14,PASSNUM                                         0397 00618000
*      END;                                                /*@Z427VLS*/ 00619000
*  END;                                                    /*@Z427VLS*/ 00620000
*RESPECIFY (R15) RESTRICTED;                               /*@G51DGGB*/ 00621000
*END;                                                      /*@Z427VLS*/ 00622000
@EL00004 DS    0H                                                  0401 00623000
@EF00004 DS    0H                                                  0401 00624000
@ER00004 LM    @14,@12,@SA00004                                    0401 00625000
         BR    @14                                                 0401 00626000
*ALLREC: PROC;  /*RECORD DEPENDENT SELECTION CRITTERIA       @Z427VLS*/ 00627000
ALLREC   STM   @14,@12,12(@13)                                     0402 00628000
*               /*COMPARE RECORD ITEMS PRECEEDED BY          @Z427VLS*/ 00629000
*               /* LRT TO PARAMETER TABLE SELECTION          @Z427VLS*/ 00630000
*               /*VALUES AND RANGES                          @Z427VLS*/ 00631000
*PASSFLAG = YES; /*RECORD SELECTED IF PASSFLAG NOT SET TO NO @Z427VLS*/ 00632000
         OI    PASSFLAG(R2),B'00000001'                            0403 00633000
*/*RECORD IS PASSED IF IT IS IN DATE RANGE. TIME RANGE MAY BE COM*/     00634000
*/*POSED OF TWO RANGES IF A MIDNIGHT IS CROSSED. IF TIME IS  @Z427VLS*/ 00635000
*/*SPECIFIED, THEN DATE MUST BE SPECIFIED ALSO TO ELIMINATE  @Z427VLS*/ 00636000
*/*PROBLEMS ELIMINATING INTERVALS IF THIRD SHIFT IS CROSSED  @Z427VLS*/ 00637000
*IF LRTDATE >= STDATE & LRTDATE <= ENDDATE THEN                    0404 00638000
         CLC   LRTDATE(4,R7),STDATE(R2)                            0404 00639000
         BL    @RF00404                                            0404 00640000
         CLC   LRTDATE(4,R7),ENDDATE(R2)                           0404 00641000
         BH    @RF00404                                            0404 00642000
*  DO;                                                     /*@Z427VLS*/ 00643000
*    IF (LRTTIME >= STTIME1 & LRTTIME <= ENDTIME1) |               0406 00644000
*       (LRTTIME >= STTIME2 & LRTTIME <= ENDTIME2) THEN            0406 00645000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           0406 00646000
         BL    @GL00016                                            0406 00647000
         CLC   LRTTIME(4,R7),ENDTIME1(R2)                          0406 00648000
         BNH   @RT00406                                            0406 00649000
@GL00016 CLC   LRTTIME(4,R7),STTIME2(R2)                           0406 00650000
         BL    @RF00406                                            0406 00651000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          0406 00652000
         BH    @RF00406                                            0406 00653000
@RT00406 DS    0H                                                  0407 00654000
*      DO;                                                 /*@Z427VLS*/ 00655000
*        IF CPUPTR ^= ZERO THEN /*IF TABLE OF ALLOWABLE CPU SERIAL*/    00656000
         L     @14,CPUPTR(,R2)                                     0408 00657000
         LTR   @14,@14                                             0408 00658000
         BZ    @RF00408                                            0408 00659000
*                               /*NUMBERS EXISTS THEN        @Z427VLS*/ 00660000
*          DO;                                             /*@Z427VLS*/ 00661000
*            CPUOK = NO;                                   /*@Z427VLS*/ 00662000
         NI    CPUOK,B'11011111'                                   0410 00663000
*            DO J = 1 BY 1 TO CPUNUM WHILE CPUOK = NO;     /*@Z427VLS*/ 00664000
         LA    @14,1                                               0411 00665000
         ST    @14,J                                               0411 00666000
         B     @DE00411                                            0411 00667000
@DL00411 TM    CPUOK,B'00100000'                                   0411 00668000
         BNZ   @DC00411                                            0411 00669000
*              IF CPUVAL(J) = LRTCPMOD THEN CPUOK = YES;   /*@Z427VLS*/ 00670000
         MH    @14,@CH00079                                        0412 00671000
         L     @08,CPUPTR(,R2)                                     0412 00672000
         ALR   @08,@14                                             0412 00673000
         AL    @08,@CF01528                                        0412 00674000
         CLC   CPUVAL-2(5,@08),LRTCPMOD(R7)                        0412 00675000
         BNE   @RF00412                                            0412 00676000
         OI    CPUOK,B'00100000'                                   0413 00677000
*            END;                                          /*@Z427VLS*/ 00678000
@RF00412 LA    @14,1                                               0414 00679000
         AL    @14,J                                               0414 00680000
         ST    @14,J                                               0414 00681000
@DE00411 L     @08,CPUPTR(,R2)                                     0414 00682000
         CH    @14,CPUNUM(,@08)                                    0414 00683000
         BNH   @DL00411                                            0414 00684000
@DC00411 DS    0H                                                  0415 00685000
*            IF CPUOK = NO THEN                                    0415 00686000
         TM    CPUOK,B'00100000'                                   0415 00687000
         BNZ   @RF00415                                            0415 00688000
*              DO;                                         /*@Z427VLS*/ 00689000
*                PASSFLAG = NO;                            /*@Z427VLS*/ 00690000
         NI    PASSFLAG(R2),B'11111110'                            0417 00691000
*                BUG(4) = BUG(4) + 1;                      /*@Z427VLS*/ 00692000
         LA    @14,1                                               0418 00693000
         AL    @14,BUG+12                                          0418 00694000
         ST    @14,BUG+12                                          0418 00695000
*              END;                                        /*@Z427VLS*/ 00696000
*          END;                                            /*@Z427VLS*/ 00697000
@RF00415 DS    0H                                                  0421 00698000
*        IF PASSFLAG = YES & MODPTR ^= ZERO THEN                   0421 00699000
@RF00408 TM    PASSFLAG(R2),B'00000001'                            0421 00700000
         BNO   @RF00421                                            0421 00701000
         L     @14,MODPTR(,R2)                                     0421 00702000
         LTR   @14,@14                                             0421 00703000
         BZ    @RF00421                                            0421 00704000
*          DO;     /*DO IF MODEL ID. SELECTED                @Z427VLS*/ 00705000
*            MODOK = NO;                                   /*@Z427VLS*/ 00706000
         NI    MODOK,B'11101111'                                   0423 00707000
*            DO J = 1 BY 1 TO MODNUM WHILE MODOK = NO;     /*@Z427VLS*/ 00708000
         LA    @14,1                                               0424 00709000
         ST    @14,J                                               0424 00710000
         B     @DE00424                                            0424 00711000
@DL00424 TM    MODOK,B'00010000'                                   0424 00712000
         BNZ   @DC00424                                            0424 00713000
*              IF LRTMODEL = MODVAL(J) THEN MODOK = YES;   /*@Z427VLS*/ 00714000
         ALR   @14,@14                                             0425 00715000
         L     @08,MODPTR(,R2)                                     0425 00716000
         ALR   @08,@14                                             0425 00717000
         CLC   LRTMODEL(2,R7),MODVAL-2(@08)                        0425 00718000
         BNE   @RF00425                                            0425 00719000
         OI    MODOK,B'00010000'                                   0426 00720000
*            END;                                          /*@Z427VLS*/ 00721000
@RF00425 LA    @14,1                                               0427 00722000
         AL    @14,J                                               0427 00723000
         ST    @14,J                                               0427 00724000
@DE00424 L     @08,MODPTR(,R2)                                     0427 00725000
         CH    @14,MODNUM(,@08)                                    0427 00726000
         BNH   @DL00424                                            0427 00727000
@DC00424 DS    0H                                                  0428 00728000
*            IF MODOK = NO THEN                                    0428 00729000
         TM    MODOK,B'00010000'                                   0428 00730000
         BNZ   @RF00428                                            0428 00731000
*              DO;                                         /*@Z427VLS*/ 00732000
*                PASSFLAG = NO;                            /*@Z427VLS*/ 00733000
         NI    PASSFLAG(R2),B'11111110'                            0430 00734000
*                BUG(5) = BUG(5) + 1;                      /*@Z427VLS*/ 00735000
         LA    @14,1                                               0431 00736000
         AL    @14,BUG+16                                          0431 00737000
         ST    @14,BUG+16                                          0431 00738000
*              END;                                        /*@Z427VLS*/ 00739000
*          END;                                            /*@Z427VLS*/ 00740000
@RF00428 DS    0H                                                  0434 00741000
*          /*ELIMINATE NON THIRD SHIFT INTERVALS IF MIDNIGHT @Z427VLS*/ 00742000
*          /*BOUNDARY HAS BEEN CROSSED IN TIME INTERVAL      @Z427VLS*/ 00743000
*        IF SHIFT3RD = ON & PASSFLAG = YES &                       0434 00744000
*          ((LRTDATE = STDATE & LRTTIME < STTIME1) |               0434 00745000
*           (LRTDATE = ENDDATE & LRTTIME > ENDTIME2))              0434 00746000
*           THEN                                                   0434 00747000
@RF00421 TM    SHIFT3RD(R2),B'00010000'                            0434 00748000
         BNO   @RF00434                                            0434 00749000
         TM    PASSFLAG(R2),B'00000001'                            0434 00750000
         BNO   @RF00434                                            0434 00751000
         CLC   LRTDATE(4,R7),STDATE(R2)                            0434 00752000
         BNE   @GL00022                                            0434 00753000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           0434 00754000
         BL    @RT00434                                            0434 00755000
@GL00022 CLC   LRTDATE(4,R7),ENDDATE(R2)                           0434 00756000
         BNE   @RF00434                                            0434 00757000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          0434 00758000
         BNH   @RF00434                                            0434 00759000
@RT00434 DS    0H                                                  0435 00760000
*             DO;                                          /*@Z427VLS*/ 00761000
*               PASSFLAG = NO;                             /*@Z427VLS*/ 00762000
         NI    PASSFLAG(R2),B'11111110'                            0436 00763000
*               BUG(6) = BUG(6) + 1;                       /*@Z427VLS*/ 00764000
         LA    @14,1                                               0437 00765000
         AL    @14,BUG+20                                          0437 00766000
         ST    @14,BUG+20                                          0437 00767000
*             END;                                         /*@Z427VLS*/ 00768000
*      END;                                                /*@Z427VLS*/ 00769000
*    ELSE                                                          0440 00770000
*      DO;                                                 /*@Z427VLS*/ 00771000
         B     @RC00406                                            0440 00772000
@RF00406 DS    0H                                                  0441 00773000
*        PASSFLAG = NO;                                    /*@Z427VLS*/ 00774000
         NI    PASSFLAG(R2),B'11111110'                            0441 00775000
*        BUG(3) = BUG(3) + 1;                              /*@Z427VLS*/ 00776000
         LA    @14,1                                               0442 00777000
         AL    @14,BUG+8                                           0442 00778000
         ST    @14,BUG+8                                           0442 00779000
*      END;                                                /*@Z427VLS*/ 00780000
*   END;                                                   /*@Z427VLS*/ 00781000
*  ELSE                                                            0445 00782000
*    DO;                                                   /*@Z427VLS*/ 00783000
         B     @RC00404                                            0445 00784000
@RF00404 DS    0H                                                  0446 00785000
*      PASSFLAG = NO;                                      /*@Z427VLS*/ 00786000
         NI    PASSFLAG(R2),B'11111110'                            0446 00787000
*      BUG(2) = BUG(2) + 1;                                /*@Z427VLS*/ 00788000
         LA    @14,1                                               0447 00789000
         AL    @14,BUG+4                                           0447 00790000
         ST    @14,BUG+4                                           0447 00791000
*    END;                                                  /*@Z427VLS*/ 00792000
*END;                                                      /*@Z427VLS*/ 00793000
@EL00005 DS    0H                                                  0449 00794000
@EF00005 DS    0H                                                  0449 00795000
@ER00005 LM    @14,@12,12(@13)                                     0449 00796000
         BR    @14                                                 0449 00797000
*RECDEP: PROC; /*IDENTIFY RECORD TYPE, SET SORT TABLE KEY    @Z427VLS*/ 00798000
RECDEP   STM   @14,@12,@SA00006                                    0450 00799000
*              /*PERFORM FILTERING                           @Z427VLS*/ 00800000
*WORKTABL = (WORKTABL && WORKTABL); /*CLEAR SORTABLE WORK AREA*/   0451 00801000
         XC    WORKTABL(10),WORKTABL                               0451 00802000
*WORKMOD = LRTMODEL; /*NO LONGER MASK OFF LEFTMOST HALF BYTE @Z427VLS*/ 00803000
         MVC   WORKMOD(2),LRTMODEL(R7)                             0452 00804000
*WORKTYPE = (LRTKEY1 & GENREC); /*JUST LOOK AT GENERAL RECORD TYPE*/    00805000
         MVC   WORKTYPE(1),LRTKEY1(R7)                             0453 00806000
         NI    WORKTYPE,X'F0'                                      0453 00807000
*IF LRTRUNC = ON | (WORKTYPE < HEX10) /*IF INCOMPLETE OR UNKNOWN REC*/  00808000
*                | (WORKTYPE > HEX90) THEN                         0454 00809000
         TM    LRTRUNC(R7),B'00100000'                             0454 00810000
         BO    @RT00454                                            0454 00811000
         CLI   WORKTYPE,X'10'                                      0454 00812000
         BL    @RT00454                                            0454 00813000
         CLI   WORKTYPE,X'90'                                      0454 00814000
         BNH   @RF00454                                            0454 00815000
@RT00454 DS    0H                                                  0455 00816000
*   WORKTYPE = UNKNOWN;                                    /*@Z427VLS*/ 00817000
         MVI   WORKTYPE,X'FF'                                      0455 00818000
*ELSE                                                              0456 00819000
*  DO;                                                     /*@Z427VLS*/ 00820000
         B     @RC00454                                            0456 00821000
@RF00454 DS    0H                                                  0457 00822000
*    IF WORKTYPE = HEX30 THEN                                      0457 00823000
         CLI   WORKTYPE,X'30'                                      0457 00824000
         BNE   @RF00457                                            0457 00825000
*      CALL OBRFILT;                                       /*@Z427VLS*/ 00826000
         BAL   @14,OBRFILT                                         0458 00827000
*    ELSE                                                          0459 00828000
*      DO;                                                 /*@Z427VLS*/ 00829000
         B     @RC00457                                            0459 00830000
@RF00457 DS    0H                                                  0460 00831000
*        IF WORKTYPE = HEX90 THEN                                  0460 00832000
         CLI   WORKTYPE,X'90'                                      0460 00833000
         BNE   @RF00460                                            0460 00834000
*          CALL MDRFILT;                                   /*@Z427VLS*/ 00835000
         BAL   @14,MDRFILT                                         0461 00836000
*        ELSE                                                      0462 00837000
*          DO;                                             /*@Z427VLS*/ 00838000
         B     @RC00460                                            0462 00839000
@RF00460 DS    0H                                                  0463 00840000
*            IF WORKTYPE = HEX10 THEN                              0463 00841000
         CLI   WORKTYPE,X'10'                                      0463 00842000
         BNE   @RF00463                                            0463 00843000
*              CALL MCHFILT;                               /*@Z427VLS*/ 00844000
         BAL   @14,MCHFILT                                         0464 00845000
*            ELSE                                                  0465 00846000
*             DO;                                          /*@Z427VLS*/ 00847000
         B     @RC00463                                            0465 00848000
@RF00463 DS    0H                                                  0466 00849000
*               IF WORKTYPE = HEX20 THEN                           0466 00850000
         CLI   WORKTYPE,X'20'                                      0466 00851000
         BNE   @RF00466                                            0466 00852000
*                 CALL CCHFILT;                            /*@Z427VLS*/ 00853000
         BAL   @14,CCHFILT                                         0467 00854000
*               ELSE                                               0468 00855000
*                DO;                                       /*@Z427VLS*/ 00856000
         B     @RC00466                                            0468 00857000
@RF00466 DS    0H                                                  0469 00858000
*                   IF WORKTYPE = HEX40 THEN                       0469 00859000
         CLI   WORKTYPE,X'40'                                      0469 00860000
         BNE   @RF00469                                            0469 00861000
*                     CALL SOFTFILT;                       /*@Z427VLS*/ 00862000
         BAL   @14,SOFTFILT                                        0470 00863000
*                   ELSE                                           0471 00864000
*                     DO;                                  /*@Z427VLS*/ 00865000
         B     @RC00469                                            0471 00866000
@RF00469 DS    0H                                                  0472 00867000
*                       IF WORKTYPE = HEX50 THEN                   0472 00868000
         CLI   WORKTYPE,X'50'                                      0472 00869000
         BNE   @RF00472                                            0472 00870000
*                         CALL IPLFILT;                    /*@Z427VLS*/ 00871000
         BAL   @14,IPLFILT                                         0473 00872000
*                       ELSE                                       0474 00873000
*                         DO;                              /*@Z427VLS*/ 00874000
         B     @RC00472                                            0474 00875000
@RF00472 DS    0H                                                  0475 00876000
*                           IF WORKTYPE = HEX60 THEN               0475 00877000
         CLI   WORKTYPE,X'60'                                      0475 00878000
         BNE   @RF00475                                            0475 00879000
*                             CALL DDRFILT;                /*@Z427VLS*/ 00880000
         BAL   @14,DDRFILT                                         0476 00881000
*                           ELSE                                   0477 00882000
*                             DO;                          /*@Z427VLS*/ 00883000
         B     @RC00475                                            0477 00884000
@RF00475 DS    0H                                                  0478 00885000
*                               IF WORKTYPE = HEX70 THEN           0478 00886000
         CLI   WORKTYPE,X'70'                                      0478 00887000
         BNE   @RF00478                                            0478 00888000
*                                 CALL MIHFILT;            /*@Z427VLS*/ 00889000
         BAL   @14,MIHFILT                                         0479 00890000
*                               ELSE                               0480 00891000
*                                 CALL EODFILT;            /*@Z427VLS*/ 00892000
         B     @RC00478                                            0480 00893000
@RF00478 BAL   @14,EODFILT                                         0480 00894000
*                             END;                         /*@Z427VLS*/ 00895000
*                         END;                             /*@Z427VLS*/ 00896000
*                     END;                                 /*@Z427VLS*/ 00897000
*                 END;                                     /*@Z427VLS*/ 00898000
*             END;                                         /*@Z427VLS*/ 00899000
*         END;                                             /*@Z427VLS*/ 00900000
*     END;                                                 /*@Z427VLS*/ 00901000
*   END;                                                   /*@Z427VLS*/ 00902000
*END;                                                      /*@Z427VLS*/ 00903000
@EL00006 DS    0H                                                  0489 00904000
@EF00006 DS    0H                                                  0489 00905000
@ER00006 LM    @14,@12,@SA00006                                    0489 00906000
         BR    @14                                                 0489 00907000
*SIFTSORT: PROC;                                           /*@Z427VLS*/ 00908000
SIFTSORT STM   @14,@12,@SA00007                                    0490 00909000
*/* SORT THAT ONLY EXAMINES AN ENTRY ONCE IF DATA IS IN ORDER*/    0491 00910000
*IF SORTNUM > 1 & DEBUG23 = OFF THEN /*IF AT LEAST TWO ENTRIES AND*/    00911000
         L     @14,SORTNUM(,R2)                                    0491 00912000
         C     @14,@CF00055                                        0491 00913000
         BNH   @RF00491                                            0491 00914000
         TM    DEBUG23(R2),B'00000001'                             0491 00915000
         BNZ   @RF00491                                            0491 00916000
*  DO;  /*DEBUG INPUT DATA ORDER OPTION IS ON THEN           @Z427VLS*/ 00917000
*SRTCONT =((PASSNUM - 1) * 10) + SORTADR;                  /*@Z427VLS*/ 00918000
         L     @14,PASSNUM                                         0493 00919000
         BCTR  @14,0                                               0493 00920000
         MH    @14,@CH00034                                        0493 00921000
         AL    @14,SORTADR(,R2)                                    0493 00922000
         ST    @14,SRTCONT                                         0493 00923000
*/* THIS SORT IS DONE IN BAL IN ORDER TO GET MIN PROCESSING TIME    */  00924000
*/* SOME 35 INSTRUCTIONS WERE CUT FROM THE BEST THAT PLS WOULD DO   */  00925000
*/* THIS CUT THE RUN TIME DOWN BY APP. 50 PER CENT.          @Z427VLS*/ 00926000
*         GENERATE REFS(SORTKEY,SORTABLE);                 /*@Z427VLS*/ 00927000
          LA     R15,10              LOAD THE INCREMENT VALUE           00928000
          L      R3,SORTADR(R2)      LOAD THE START OF THE TABLE        00929000
          L      R4,SRTCONT          LOAD THE MAX LIMIT                 00930000
          LR     R1,R3               SET UP THE STOP LIMIT ON BACK UP   00931000
          B      DOIT                GO AROUND THIS CODE FIRST TIME     00932000
LOOPBCK1  ALR    R3,R15              MOVE THE POINTER TO NEXT ENTRY     00933000
          CR     R3,R4               ARE WE POINTING TO LAST ENTRY      00934000
          BNL    DONE                FINISHED WITH THE SORT SO EXIT     00935000
DOIT      CLC    SORTABLE(10,R3),SORTABLE+10(R3)                        00936000
          BNH    LOOPBCK1            DONT NEED TO SORT ITEM             00937000
          XC     SORTABLE(10,R3),SORTABLE+10(R3)                        00938000
          XC     SORTABLE+10(10,R3),SORTABLE(R3)                        00939000
          XC     SORTABLE(10,R3),SORTABLE+10(R3)                        00940000
          LR     R6,R3               SET NEW POINTER(BACKWARD)          00941000
LOOPBCK2  SR     R6,R15              POINT TO LAST ENTRY                00942000
          CR     R6,R1               DONT BACK OUT OF THE TABLE         00943000
          BL     LOOPBCK1            START WITH NEXT ENTRY              00944000
          CLC    SORTABLE(10,R6),SORTABLE+10(R6)                        00945000
          BNH    LOOPBCK1            NO FUTHER SHUFFEL THIS SAMPLE      00946000
          XC     SORTABLE+10(10,R6),SORTABLE(R6)                        00947000
          XC     SORTABLE(10,R6),SORTABLE+10(R6)                        00948000
          XC     SORTABLE+10(10,R6),SORTABLE(R6)                        00949000
          B      LOOPBCK2            DOES IT NEED TO BE MOVED AGAIN     00950000
DONE      EQU    *                   COME HERE WHEN DONE                00951000
*END;                                                      /*@Z427VLS*/ 00952000
*  RESPECIFY (R3,R6,R1,R15) UNRESTRICTED;                  /*@Z427VLS*/ 00953000
*END;                                                      /*@Z427VLS*/ 00954000
@EL00007 DS    0H                                                  0497 00955000
@EF00007 DS    0H                                                  0497 00956000
@ER00007 LM    @14,@12,@SA00007                                    0497 00957000
         BR    @14                                                 0497 00958000
*FREETAB: PROC; /*FREE CORE FOR PARM SELECTION CRITERIA TABLES*/   0498 00959000
FREETAB  STM   @14,@12,@SA00008                                    0498 00960000
*IF CUAPTR ^= ZERO | LIBADPTR ^= ZERO | SYMCDPTR ^= ZERO |         0499 00961000
*   DEVPTR ^= ZERO | MODPTR ^= ZERO | SERPTR ^= ZERO |             0499 00962000
*   VOLPTR ^= ZERO | CPUPTR ^= ZERO | CPCUAPTR ^= ZERO THEN        0499 00963000
         SLR   @08,@08                                             0499 00964000
         C     @08,CUAPTR(,R2)                                     0499 00965000
         BNE   @RT00499                                            0499 00966000
         C     @08,LIBADPTR(,R2)                                   0499 00967000
         BNE   @RT00499                                            0499 00968000
         C     @08,SYMCDPTR(,R2)                                   0499 00969000
         BNE   @RT00499                                            0499 00970000
         C     @08,DEVPTR(,R2)                                     0499 00971000
         BNE   @RT00499                                            0499 00972000
         C     @08,MODPTR(,R2)                                     0499 00973000
         BNE   @RT00499                                            0499 00974000
         C     @08,SERPTR(,R2)                                     0499 00975000
         BNE   @RT00499                                            0499 00976000
         C     @08,VOLPTR(,R2)                                     0499 00977000
         BNE   @RT00499                                            0499 00978000
         C     @08,CPUPTR(,R2)                                     0499 00979000
         BNE   @RT00499                                            0499 00980000
         C     @08,CPCUAPTR(,R2)                                   0499 00981000
         BE    @RF00499                                            0499 00982000
@RT00499 DS    0H                                                  0500 00983000
*    GEN(FREEMAIN R,SP=20);                                /*@Z427VLS*/ 00984000
         FREEMAIN R,SP=20                                               00985000
*IF FRAMEPTR ^= ZERO &        /*DID WE GET THE CORE AT THE START*/ 0501 00986000
*   FRAMENUM  = ZERO  THEN    /*DID WE FIND ANY MCH | CCH MERDIAN*/     00987000
@RF00499 SLR   @08,@08                                             0501 00988000
         L     @06,FRAMEPTR(,R2)                                   0501 00989000
         CR    @06,@08                                             0501 00990000
         BE    @RF00501                                            0501 00991000
         C     @08,FRAMENUM(,@06)                                  0501 00992000
         BNE   @RF00501                                            0501 00993000
*    DO;                                                   /*@G51DGGB*/ 00994000
*    GEN(FREEMAIN R,SP=21);   /*FREE AREA FOR THE FRAME INFORMATION*/   00995000
         FREEMAIN R,SP=21                                               00996000
*    FRAMEPTR = ZERO;         /*MAKE SURE EVERY ONE KNOWS ABOUT IT*/    00997000
         SLR   @08,@08                                             0504 00998000
         ST    @08,FRAMEPTR(,R2)                                   0504 00999000
*    END;                                                  /*@G51DGGB*/ 01000000
*END;                                                      /*@Z427VLS*/ 01001000
@EL00008 DS    0H                                                  0506 01002000
@EF00008 DS    0H                                                  0506 01003000
@ER00008 LM    @14,@12,@SA00008                                    0506 01004000
         BR    @14                                                 0506 01005000
*OBRFILT: PROC;                                            /*@Z427VLS*/ 01006000
OBRFILT  STM   @14,@12,@SA00009                                    0507 01007000
*IF POBR = OFF THEN                                                0508 01008000
         TM    POBR(R2),B'00100000'                                0508 01009000
         BNZ   @RF00508                                            0508 01010000
*  DO;                                                     /*@Z427VLS*/ 01011000
*    PASSFLAG = OFF;                                       /*@Z427VLS*/ 01012000
         NI    PASSFLAG(R2),B'11111110'                            0510 01013000
*    BUG(7) = BUG(7) +1;                                   /*@Z427VLS*/ 01014000
         LA    @08,1                                               0511 01015000
         AL    @08,BUG+24                                          0511 01016000
         ST    @08,BUG+24                                          0511 01017000
*  END;                                                    /*@Z427VLS*/ 01018000
*ELSE                                                              0513 01019000
*  DO;                                                     /*@Z427VLS*/ 01020000
         B     @RC00508                                            0513 01021000
@RF00508 DS    0H                                                  0514 01022000
*    IF SHORTSW = ON THEN                                          0514 01023000
         TM    SHORTSW(R7),B'00100000'                             0514 01024000
         BNO   @RF00514                                            0514 01025000
*      DO;                                                 /*@Z427VLS*/ 01026000
*        WORKCUA = (OBRSCUA & ONLYCUA3);                   /*@Z427VLS*/ 01027000
         MVC   WORKCUA(3),OBRSCUA(R7)                              0516 01028000
         NC    WORKCUA(3),@CB01018                                 0516 01029000
*        WORKDEV = OBRSDEV2;                               /*@Z427VLS*/ 01030000
         MVC   WORKDEV(2),OBRSDEV2(R7)                             0517 01031000
*      END;                                                /*@Z427VLS*/ 01032000
*    ELSE                                                          0519 01033000
*      DO;                                                 /*@Z427VLS*/ 01034000
         B     @RC00514                                            0519 01035000
@RF00514 DS    0H                                                  0520 01036000
*        WORKCUA = (OBRPCUA & ONLYCUA3);                   /*@Z427VLS*/ 01037000
         MVC   WORKCUA(3),OBRPCUA(R7)                              0520 01038000
         NC    WORKCUA(3),@CB01018                                 0520 01039000
*        WORKDEV = OBRDEV;                                 /*@Z427VLS*/ 01040000
         MVC   WORKDEV(2),OBRDEV(R7)                               0521 01041000
*        IF WORKDEV = DEV23051 |                                   0522 01042000
*           WORKDEV = DEV23052 THEN                                0522 01043000
         CLC   WORKDEV(2),@CB00980                                 0522 01044000
         BE    @RT00522                                            0522 01045000
         CLC   WORKDEV(2),@CB00982                                 0522 01046000
         BNE   @RF00522                                            0522 01047000
@RT00522 DS    0H                                                  0523 01048000
*           WORKCUA = (WORKCUA & NOUNIT3);                 /*@Z427VLS*/ 01049000
         NC    WORKCUA(3),@CB01010                                 0523 01050000
*      END;                                                /*@Z427VLS*/ 01051000
@RF00522 DS    0H                                                  0525 01052000
*    IF CUAPTR ^= ZERO THEN                                        0525 01053000
@RC00514 L     @08,CUAPTR(,R2)                                     0525 01054000
         LTR   @08,@08                                             0525 01055000
         BZ    @RF00525                                            0525 01056000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 01057000
         BAL   @14,CUASELCT                                        0526 01058000
*    IF PASSFLAG = YES THEN                                        0527 01059000
@RF00525 TM    PASSFLAG(R2),B'00000001'                            0527 01060000
         BNO   @RF00527                                            0527 01061000
*      DO;                                                 /*@Z427VLS*/ 01062000
*         IF DEVPTR ^= ZERO THEN /*IF DEVICE SELECTION LIST EXISTS*/    01063000
         L     @08,DEVPTR(,R2)                                     0529 01064000
         LTR   @08,@08                                             0529 01065000
         BZ    @RF00529                                            0529 01066000
*           CALL DEVSEL; /*CHECK LIST OF ALLOWABLE DEVICES   @Z427VLS*/ 01067000
         BAL   @14,DEVSEL                                          0530 01068000
*         IF PASSFLAG = YES THEN                                   0531 01069000
@RF00529 TM    PASSFLAG(R2),B'00000001'                            0531 01070000
         BNO   @RF00531                                            0531 01071000
*           DO;                                            /*@Z427VLS*/ 01072000
*             IF CPCUAPTR ^= ZERO THEN /*IF CPU,CUA SELECTION LIST EX*/ 01073000
         L     @08,CPCUAPTR(,R2)                                   0533 01074000
         LTR   @08,@08                                             0533 01075000
         BZ    @RF00533                                            0533 01076000
*               CALL CPCUASEL; /*CHECK LIST OF VALID CPU,CUAS*/    0534 01077000
         BAL   @14,CPCUASEL                                        0534 01078000
*             IF PASSFLAG = YES THEN                               0535 01079000
@RF00533 TM    PASSFLAG(R2),B'00000001'                            0535 01080000
         BNO   @RF00535                                            0535 01081000
*               DO;                                        /*@Z427VLS*/ 01082000
*                  IF VOLPTR ^= ZERO THEN                          0537 01083000
         L     @08,VOLPTR(,R2)                                     0537 01084000
         LTR   @08,@08                                             0537 01085000
         BZ    @RF00537                                            0537 01086000
*                    CALL VOLID;                           /*@Z427VLS*/ 01087000
         BAL   @14,VOLID                                           0538 01088000
*                  IF PASSFLAG = YES THEN                          0539 01089000
@RF00537 TM    PASSFLAG(R2),B'00000001'                            0539 01090000
         BNO   @RF00539                                            0539 01091000
*                    DO;                                   /*@Z427VLS*/ 01092000
*                      CALL TERMID;                        /*@Z427VLS*/ 01093000
         BAL   @14,TERMID                                          0541 01094000
*                      IF PASSFLAG = YES THEN                      0542 01095000
         TM    PASSFLAG(R2),B'00000001'                            0542 01096000
         BNO   @RF00542                                            0542 01097000
*                        DO;                               /*@Z427VLS*/ 01098000
*                          IF SHAREPTR ^= ZERO THEN                0544 01099000
         L     @08,SHAREPTR(,R2)                                   0544 01100000
         LTR   @08,@08                                             0544 01101000
         BZ    @RF00544                                            0544 01102000
*                             CALL SHARCONV; /*CONVERT TO BASE CUA*/    01103000
         BAL   @14,SHARCONV                                        0545 01104000
*                          IF WORKDEV = DEV23051 |                 0546 01105000
*                             WORKDEV = DEV3330  |                 0546 01106000
*                             WORKDEV = DEV3340  |                 0546 01107000
*                             WORKDEV = DEV33301 |                 0546 01108000
*                             WORKDEV = DEV3350  |                 0546 01109000
*                             WORKDEV = DEV23052 THEN              0546 01110000
@RF00544 CLC   WORKDEV(2),@CB00980                                 0546 01111000
         BE    @RT00546                                            0546 01112000
         CLC   WORKDEV(2),@CB00984                                 0546 01113000
         BE    @RT00546                                            0546 01114000
         CLC   WORKDEV(2),@CB00986                                 0546 01115000
         BE    @RT00546                                            0546 01116000
         CLC   WORKDEV(2),@CB00990                                 0546 01117000
         BE    @RT00546                                            0546 01118000
         CLC   WORKDEV(2),@CB00988                                 0546 01119000
         BE    @RT00546                                            0546 01120000
         CLC   WORKDEV(2),@CB00982                                 0546 01121000
         BNE   @RF00546                                            0546 01122000
@RT00546 DS    0H                                                  0547 01123000
*                             WORKCUA = (WORKCUA & NOUNIT3);       0547 01124000
         NC    WORKCUA(3),@CB01010                                 0547 01125000
*                         END;                             /*@Z427VLS*/ 01126000
*                       ELSE /*IF FAILED TERMID SELECTION    @Z427VLS*/ 01127000
*                         BUG(12) = BUG(12) + 1;           /*@Z427VLS*/ 01128000
         B     @RC00542                                            0549 01129000
@RF00542 LA    @08,1                                               0549 01130000
         AL    @08,BUG+44                                          0549 01131000
         ST    @08,BUG+44                                          0549 01132000
*                     END;                                 /*@Z427VLS*/ 01133000
*                   ELSE /*IF FAILED VOLID SELECTION         @Z427VLS*/ 01134000
*                     BUG(11) = BUG(11) + 1;               /*@Z427VLS*/ 01135000
         B     @RC00539                                            0551 01136000
@RF00539 LA    @08,1                                               0551 01137000
         AL    @08,BUG+40                                          0551 01138000
         ST    @08,BUG+40                                          0551 01139000
*                 END;                                     /*@Z427VLS*/ 01140000
*               ELSE  /*IF FAILED CPU,CUA SELECTION          @Z427VLS*/ 01141000
*                 BUG(10) = BUG(10) + 1;                   /*@Z427VLS*/ 01142000
         B     @RC00535                                            0553 01143000
@RF00535 LA    @08,1                                               0553 01144000
         AL    @08,BUG+36                                          0553 01145000
         ST    @08,BUG+36                                          0553 01146000
*             END;                                         /*@Z427VLS*/ 01147000
*           ELSE /*IF FAILED DEVICE SELECTION                @Z427VLS*/ 01148000
*             BUG(9) = BUG(9) + 1;                         /*@Z427VLS*/ 01149000
         B     @RC00531                                            0555 01150000
@RF00531 LA    @08,1                                               0555 01151000
         AL    @08,BUG+32                                          0555 01152000
         ST    @08,BUG+32                                          0555 01153000
*         END;                                             /*@Z427VLS*/ 01154000
*       ELSE /*IF FAILED CUA SELECTION                       @Z427VLS*/ 01155000
*         BUG(8) = BUG(8) + 1;                             /*@Z427VLS*/ 01156000
         B     @RC00527                                            0557 01157000
@RF00527 LA    @08,1                                               0557 01158000
         AL    @08,BUG+28                                          0557 01159000
         ST    @08,BUG+28                                          0557 01160000
*      END;                                                /*@Z427VLS*/ 01161000
* END;                                                     /*@Z427VLS*/ 01162000
@EL00009 DS    0H                                                  0559 01163000
@EF00009 DS    0H                                                  0559 01164000
@ER00009 LM    @14,@12,@SA00009                                    0559 01165000
         BR    @14                                                 0559 01166000
*MDRFILT: PROC;   /*MISCELLANEOUS DATA RECORD FILTER.        @Z427VLS*/ 01167000
MDRFILT  STM   @14,@12,@SA00010                                    0560 01168000
*                 /*PASSFLAG IS TURNED OFF IF RECORD FAILS   @Z427VLS*/ 01169000
*IF PTTYP = OFF THEN  /*ARE MDR RECORDS SELECTED             @Z427VLS*/ 01170000
         TM    PTTYP(R2),B'10000000'                               0561 01171000
         BNZ   @RF00561                                            0561 01172000
*  DO;                                                     /*@Z427VLS*/ 01173000
*    PASSFLAG = OFF;                                       /*@Z427VLS*/ 01174000
         NI    PASSFLAG(R2),B'11111110'                            0563 01175000
*    BUG(13) = BUG(13) + 1;                                /*@Z427VLS*/ 01176000
         LA    @08,1                                               0564 01177000
         AL    @08,BUG+48                                          0564 01178000
         ST    @08,BUG+48                                          0564 01179000
*  END;                                                    /*@Z427VLS*/ 01180000
*ELSE                                                              0566 01181000
*  DO;                                                     /*@Z427VLS*/ 01182000
         B     @RC00561                                            0566 01183000
@RF00561 DS    0H                                                  0567 01184000
*    WORKMOD = (TPRCUA & ONLYCUA2);                        /*@Z427VLS*/ 01185000
         MVC   WORKMOD(2),TPRCUA(R7)                               0567 01186000
         NC    WORKMOD(2),@CB01014                                 0567 01187000
*    IF TPRDEV = DV23051 | TPRDEV = DV23052 THEN                   0568 01188000
         CLI   TPRDEV(R7),X'12'                                    0568 01189000
         BE    @RT00568                                            0568 01190000
         CLI   TPRDEV(R7),X'02'                                    0568 01191000
         BNE   @RF00568                                            0568 01192000
@RT00568 DS    0H                                                  0569 01193000
*      WORKMOD = (WORKMOD & NOUNIT2); /*HEAVEN ONLY KNOWS WHY*/    0569 01194000
         NC    WORKMOD(2),@CB01012                                 0569 01195000
*    IF CUAPTR ^= ZERO THEN                                        0570 01196000
@RF00568 L     @08,CUAPTR(,R2)                                     0570 01197000
         LTR   @08,@08                                             0570 01198000
         BZ    @RF00570                                            0570 01199000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 01200000
         BAL   @14,CUASELCT                                        0571 01201000
*    IF PASSFLAG = YES THEN                                        0572 01202000
@RF00570 TM    PASSFLAG(R2),B'00000001'                            0572 01203000
         BNO   @RF00572                                            0572 01204000
*     DO;                                                  /*@Z427VLS*/ 01205000
*       IF DEVPTR ^= ZERO THEN /*IF LIST OF VALID DEVICES EXISTS THEN*/ 01206000
         L     @08,DEVPTR(,R2)                                     0574 01207000
         LTR   @08,@08                                             0574 01208000
         BZ    @RF00574                                            0574 01209000
*         CALL DEVSEL; /*COMPARE RECORD DEVICE AGAINST VALID LIST*/     01210000
         BAL   @14,DEVSEL                                          0575 01211000
*       IF PASSFLAG = YES THEN                                     0576 01212000
@RF00574 TM    PASSFLAG(R2),B'00000001'                            0576 01213000
         BNO   @RF00576                                            0576 01214000
*         DO;                                              /*@Z427VLS*/ 01215000
*           IF CPCUAPTR ^= ZERO THEN /*IF LIST OF CPU,CUAS EXISTS*/     01216000
         L     @08,CPCUAPTR(,R2)                                   0578 01217000
         LTR   @08,@08                                             0578 01218000
         BZ    @RF00578                                            0578 01219000
*             CALL CPCUASEL; /*CHECK RECORD CPU,CUA AGAINST LIST*/ 0579 01220000
         BAL   @14,CPCUASEL                                        0579 01221000
*           IF PASSFLAG = YES THEN                                 0580 01222000
@RF00578 TM    PASSFLAG(R2),B'00000001'                            0580 01223000
         BNO   @RF00580                                            0580 01224000
*             DO;                                          /*@Z427VLS*/ 01225000
*               IF LIBADPTR ^= ZERO & TPRDEV  = DV3705 THEN        0582 01226000
         L     @08,LIBADPTR(,R2)                                   0582 01227000
         LTR   @08,@08                                             0582 01228000
         BZ    @RF00582                                            0582 01229000
         CLI   TPRDEV(R7),X'05'                                    0582 01230000
         BNE   @RF00582                                            0582 01231000
*                 CALL LIBSEL;                             /*@Z427VLS*/ 01232000
         BAL   @14,LIBSEL                                          0583 01233000
*               IF PASSFLAG = YES THEN                             0584 01234000
@RF00582 TM    PASSFLAG(R2),B'00000001'                            0584 01235000
         BNO   @RF00584                                            0584 01236000
*                 DO;                                      /*@Z427VLS*/ 01237000
*                   IF VOLPTR ^= ZERO THEN                         0586 01238000
         L     @08,VOLPTR(,R2)                                     0586 01239000
         LTR   @08,@08                                             0586 01240000
         BZ    @RF00586                                            0586 01241000
*                     CALL VOLID;                          /*@Z427VLS*/ 01242000
         BAL   @14,VOLID                                           0587 01243000
*                   IF PASSFLAG = YES THEN                         0588 01244000
@RF00586 TM    PASSFLAG(R2),B'00000001'                            0588 01245000
         BNO   @RF00588                                            0588 01246000
*                     DO;                                  /*@Z427VLS*/ 01247000
*                       IF SHAREPTR ^= ZERO THEN /*IF SHARED IO*/  0590 01248000
         L     @08,SHAREPTR(,R2)                                   0590 01249000
         LTR   @08,@08                                             0590 01250000
         BZ    @RF00590                                            0590 01251000
*                         CALL SHARCONV;                   /*@Z427VLS*/ 01252000
         BAL   @14,SHARCONV                                        0591 01253000
*                       WORKCHAN = TPRDEV;                 /*@Z427VLS*/ 01254000
@RF00590 MVC   WORKCHAN(1),TPRDEV(R7)                              0592 01255000
*                       IF TPRDEV = DV23052 |                      0593 01256000
*                          TPRDEV = DV3330  |                      0593 01257000
*                          TPRDEV = DV3340  |                      0593 01258000
*                          TPRDEV = DV3350  |                      0593 01259000
*                          TPRDEV = DV33302 |                      0593 01260000
*                          TPRDEV = DV23051 THEN                   0593 01261000
         CLI   TPRDEV(R7),X'02'                                    0593 01262000
         BE    @RT00593                                            0593 01263000
         CLI   TPRDEV(R7),X'01'                                    0593 01264000
         BE    @RT00593                                            0593 01265000
         CLI   TPRDEV(R7),X'09'                                    0593 01266000
         BE    @RT00593                                            0593 01267000
         CLI   TPRDEV(R7),X'11'                                    0593 01268000
         BE    @RT00593                                            0593 01269000
         CLI   TPRDEV(R7),X'0A'                                    0593 01270000
         BE    @RT00593                                            0593 01271000
         CLI   TPRDEV(R7),X'12'                                    0593 01272000
         BNE   @RF00593                                            0593 01273000
@RT00593 DS    0H                                                  0594 01274000
*                          DO;                             /*@Z427VLS*/ 01275000
*                            WORKMOD = (WORKMOD & NOUNIT2);/*@Z427VLS*/ 01276000
         NC    WORKMOD(2),@CB01012                                 0595 01277000
*                            WORKTYPE = HEX30;             /*@Z427VLS*/ 01278000
         MVI   WORKTYPE,X'30'                                      0596 01279000
*                            WORKCHAN = HEX00;             /*@Z427VLS*/ 01280000
         MVI   WORKCHAN,X'00'                                      0597 01281000
*                          END;                            /*@Z427VLS*/ 01282000
*                        IF TPRDEV = DV3800 |                      0599 01283000
*                           TPRDEV = DV3895 |                      0599 01284000
*                           TPRDEV = DV3850 THEN                   0599 01285000
@RF00593 CLI   TPRDEV(R7),X'0C'                                    0599 01286000
         BE    @RT00599                                            0599 01287000
         CLI   TPRDEV(R7),X'0D'                                    0599 01288000
         BE    @RT00599                                            0599 01289000
         CLI   TPRDEV(R7),X'0E'                                    0599 01290000
         BNE   @RF00599                                            0599 01291000
@RT00599 DS    0H                                                  0600 01292000
*                          DO;                             /*@Z427VLS*/ 01293000
*                            WORKCHAN = HEX00;             /*@Z427VLS*/ 01294000
         MVI   WORKCHAN,X'00'                                      0601 01295000
*                            WORKTYPE = HEX30;             /*@Z427VLS*/ 01296000
         MVI   WORKTYPE,X'30'                                      0602 01297000
*                          END;                            /*@Z427VLS*/ 01298000
*                     END;                                 /*@Z427VLS*/ 01299000
*                   ELSE /*IF FAILED VOLID SELECTION         @Z427VLS*/ 01300000
*                     BUG(18) = BUG(18) + 1;               /*@Z427VLS*/ 01301000
         B     @RC00588                                            0605 01302000
@RF00588 LA    @08,1                                               0605 01303000
         AL    @08,BUG+68                                          0605 01304000
         ST    @08,BUG+68                                          0605 01305000
*                 END;                                     /*@Z427VLS*/ 01306000
*               ELSE /*IF FAILED LIN.INT.BASE ADDR.SELECTION @Z427VLS*/ 01307000
*                 BUG(17) = BUG(17) + 1;                   /*@Z427VLS*/ 01308000
         B     @RC00584                                            0607 01309000
@RF00584 LA    @08,1                                               0607 01310000
         AL    @08,BUG+64                                          0607 01311000
         ST    @08,BUG+64                                          0607 01312000
*            END;                                          /*@Z427VLS*/ 01313000
*           ELSE /*IF FAILED CPU,CUA SELECTION               @Z427VLS*/ 01314000
*             BUG(16) = BUG(16) + 1;                       /*@Z427VLS*/ 01315000
         B     @RC00580                                            0609 01316000
@RF00580 LA    @08,1                                               0609 01317000
         AL    @08,BUG+60                                          0609 01318000
         ST    @08,BUG+60                                          0609 01319000
*          END;                                            /*@Z427VLS*/ 01320000
*        ELSE /*IF FAILED DEVICE SELECTION                   @Z427VLS*/ 01321000
*         BUG(15) = BUG(15) + 1;                           /*@Z427VLS*/ 01322000
         B     @RC00576                                            0611 01323000
@RF00576 LA    @08,1                                               0611 01324000
         AL    @08,BUG+56                                          0611 01325000
         ST    @08,BUG+56                                          0611 01326000
*      END;                                                /*@Z427VLS*/ 01327000
*    ELSE /*IF FAILED CUA SELECTION                          @Z427VLS*/ 01328000
*      BUG(14) = BUG(14) + 1;                              /*@Z427VLS*/ 01329000
         B     @RC00572                                            0613 01330000
@RF00572 LA    @08,1                                               0613 01331000
         AL    @08,BUG+52                                          0613 01332000
         ST    @08,BUG+52                                          0613 01333000
*  END;                                                    /*@Z427VLS*/ 01334000
*END;                                                      /*@Z427VLS*/ 01335000
@EL00010 DS    0H                                                  0615 01336000
@EF00010 DS    0H                                                  0615 01337000
@ER00010 LM    @14,@12,@SA00010                                    0615 01338000
         BR    @14                                                 0615 01339000
*DDRFILT: PROC;                                            /*@Z427VLS*/ 01340000
DDRFILT  STM   @14,@12,@SA00011                                    0616 01341000
*IF PDDR = OFF THEN                                                0617 01342000
         TM    PDDR(R2),B'00000100'                                0617 01343000
         BNZ   @RF00617                                            0617 01344000
*  DO;                                                     /*@Z427VLS*/ 01345000
*    PASSFLAG = OFF;                                       /*@Z427VLS*/ 01346000
         NI    PASSFLAG(R2),B'11111110'                            0619 01347000
*    BUG(19) = BUG(19) + 1;                                /*@Z427VLS*/ 01348000
         LA    @08,1                                               0620 01349000
         AL    @08,BUG+72                                          0620 01350000
         ST    @08,BUG+72                                          0620 01351000
*  END;                                                    /*@Z427VLS*/ 01352000
*ELSE                                                              0622 01353000
*  DO;                                                     /*@Z427VLS*/ 01354000
         B     @RC00617                                            0622 01355000
@RF00617 DS    0H                                                  0623 01356000
*    WORKCUA = DDRFCUA;                                    /*@Z427VLS*/ 01357000
         MVC   WORKCUA(3),DDRFCUA(R7)                              0623 01358000
*    WORKDEV = DDRCODE2; /*SET DEVICE                        @Z427VLS*/ 01359000
         MVC   WORKDEV(2),DDRCODE2(R7)                             0624 01360000
*    IF CUAPTR ^= ZERO THEN                                        0625 01361000
         L     @08,CUAPTR(,R2)                                     0625 01362000
         LTR   @08,@08                                             0625 01363000
         BZ    @RF00625                                            0625 01364000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 01365000
         BAL   @14,CUASELCT                                        0626 01366000
*    IF PASSFLAG = YES THEN                                        0627 01367000
@RF00625 TM    PASSFLAG(R2),B'00000001'                            0627 01368000
         BNO   @RF00627                                            0627 01369000
*      DO;                                                 /*@Z427VLS*/ 01370000
*        IF CPCUAPTR ^= ZERO THEN                                  0629 01371000
         L     @08,CPCUAPTR(,R2)                                   0629 01372000
         LTR   @08,@08                                             0629 01373000
         BZ    @RF00629                                            0629 01374000
*          CALL CPCUASEL;                                  /*@Z427VLS*/ 01375000
         BAL   @14,CPCUASEL                                        0630 01376000
*        IF PASSFLAG = YES THEN /*IF PASS CPU,CUA SELECTION  @Z427VLS*/ 01377000
@RF00629 TM    PASSFLAG(R2),B'00000001'                            0631 01378000
         BNO   @RF00631                                            0631 01379000
*          DO;                                             /*@Z427VLS*/ 01380000
*            IF DEVPTR ^= ZERO THEN /*IF DEVICE SELECION LIST*/    0633 01381000
         L     @08,DEVPTR(,R2)                                     0633 01382000
         LTR   @08,@08                                             0633 01383000
         BZ    @RF00633                                            0633 01384000
*               CALL DEVSEL;                               /*@Z427VLS*/ 01385000
         BAL   @14,DEVSEL                                          0634 01386000
*            IF PASSFLAG = NO THEN                                 0635 01387000
@RF00633 TM    PASSFLAG(R2),B'00000001'                            0635 01388000
         BNZ   @RF00635                                            0635 01389000
*               BUG(22) = BUG(22) + 1;                     /*@Z427VLS*/ 01390000
         LA    @08,1                                               0636 01391000
         AL    @08,BUG+84                                          0636 01392000
         ST    @08,BUG+84                                          0636 01393000
*          END;                                            /*@Z427VLS*/ 01394000
*        ELSE  /*IF RECORD FAILED CPU,CUA SELECTION THEN     @Z427VLS*/ 01395000
*          BUG(21) = BUG(21) + 1;                          /*@Z427VLS*/ 01396000
         B     @RC00631                                            0638 01397000
@RF00631 LA    @08,1                                               0638 01398000
         AL    @08,BUG+80                                          0638 01399000
         ST    @08,BUG+80                                          0638 01400000
*      END;                                                /*@Z427VLS*/ 01401000
*    ELSE /*IF FAILED CUA SELECTION                          @Z427VLS*/ 01402000
*      BUG(20) = BUG(20) + 1;                              /*@Z427VLS*/ 01403000
         B     @RC00627                                            0640 01404000
@RF00627 LA    @08,1                                               0640 01405000
         AL    @08,BUG+76                                          0640 01406000
         ST    @08,BUG+76                                          0640 01407000
*  END;                                                    /*@Z427VLS*/ 01408000
*END;                                                      /*@Z427VLS*/ 01409000
@EL00011 DS    0H                                                  0642 01410000
@EF00011 DS    0H                                                  0642 01411000
@ER00011 LM    @14,@12,@SA00011                                    0642 01412000
         BR    @14                                                 0642 01413000
*MIHFILT: PROC;                                            /*@Z427VLS*/ 01414000
MIHFILT  STM   @14,@12,@SA00012                                    0643 01415000
*IF PMIH = OFF THEN                                                0644 01416000
         TM    PMIH(R2),B'00000010'                                0644 01417000
         BNZ   @RF00644                                            0644 01418000
*  DO;                                                     /*@Z427VLS*/ 01419000
*    PASSFLAG = OFF;                                       /*@Z427VLS*/ 01420000
         NI    PASSFLAG(R2),B'11111110'                            0646 01421000
*    BUG(23) = BUG(23) + 1;                                /*@Z427VLS*/ 01422000
         LA    @08,1                                               0647 01423000
         AL    @08,BUG+88                                          0647 01424000
         ST    @08,BUG+88                                          0647 01425000
*  END;                                                    /*@Z427VLS*/ 01426000
*ELSE                                                              0649 01427000
*  DO;                                                     /*@Z427VLS*/ 01428000
         B     @RC00644                                            0649 01429000
@RF00644 DS    0H                                                  0650 01430000
*    WORKCUA = MIHCUA;                                     /*@Z427VLS*/ 01431000
         MVC   WORKCUA(3),MIHCUA(R7)                               0650 01432000
*    WORKDEV = MIHCODE2;                                   /*@Z427VLS*/ 01433000
         MVC   WORKDEV(2),MIHCODE2(R7)                             0651 01434000
*    IF CUAPTR ^= ZERO THEN                                        0652 01435000
         L     @08,CUAPTR(,R2)                                     0652 01436000
         LTR   @08,@08                                             0652 01437000
         BZ    @RF00652                                            0652 01438000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 01439000
         BAL   @14,CUASELCT                                        0653 01440000
*    IF PASSFLAG = YES THEN                                        0654 01441000
@RF00652 TM    PASSFLAG(R2),B'00000001'                            0654 01442000
         BNO   @RF00654                                            0654 01443000
*      DO;                                                 /*@Z427VLS*/ 01444000
*        IF CPCUAPTR ^= ZERO THEN                                  0656 01445000
         L     @08,CPCUAPTR(,R2)                                   0656 01446000
         LTR   @08,@08                                             0656 01447000
         BZ    @RF00656                                            0656 01448000
*          CALL CPCUASEL;                                  /*@Z427VLS*/ 01449000
         BAL   @14,CPCUASEL                                        0657 01450000
*        IF PASSFLAG = YES THEN /*IF PASSED CPU,CUA SELECTION*/    0658 01451000
@RF00656 TM    PASSFLAG(R2),B'00000001'                            0658 01452000
         BNO   @RF00658                                            0658 01453000
*          DO;                                             /*@Z427VLS*/ 01454000
*            IF DEVPTR ^= ZERO THEN /*IF DEVICE SELECTION LIST*/   0660 01455000
         L     @08,DEVPTR(,R2)                                     0660 01456000
         LTR   @08,@08                                             0660 01457000
         BZ    @RF00660                                            0660 01458000
*              CALL DEVSEL;                                /*@Z427VLS*/ 01459000
         BAL   @14,DEVSEL                                          0661 01460000
*            IF PASSFLAG = NO THEN /*IF NOT SELECTED DEVICE THEN*/ 0662 01461000
@RF00660 TM    PASSFLAG(R2),B'00000001'                            0662 01462000
         BNZ   @RF00662                                            0662 01463000
*              BUG(26) = BUG(26) + 1;                      /*@Z427VLS*/ 01464000
         LA    @08,1                                               0663 01465000
         AL    @08,BUG+100                                         0663 01466000
         ST    @08,BUG+100                                         0663 01467000
*          END;                                            /*@Z427VLS*/ 01468000
*        ELSE /*IF FAILED CPU,CUA SELECTION                  @Z427VLS*/ 01469000
*          BUG(25) = BUG(25) + 1;                          /*@Z427VLS*/ 01470000
         B     @RC00658                                            0665 01471000
@RF00658 LA    @08,1                                               0665 01472000
         AL    @08,BUG+96                                          0665 01473000
         ST    @08,BUG+96                                          0665 01474000
*      END;                                                /*@Z427VLS*/ 01475000
*    ELSE /*IF FAILED CUA SELECTION THEN                     @Z427VLS*/ 01476000
*     BUG(24) = BUG(24) + 1;                               /*@Z427VLS*/ 01477000
         B     @RC00654                                            0667 01478000
@RF00654 LA    @08,1                                               0667 01479000
         AL    @08,BUG+92                                          0667 01480000
         ST    @08,BUG+92                                          0667 01481000
*   END;                                                   /*@Z427VLS*/ 01482000
*END;                                                      /*@Z427VLS*/ 01483000
@EL00012 DS    0H                                                  0669 01484000
@EF00012 DS    0H                                                  0669 01485000
@ER00012 LM    @14,@12,@SA00012                                    0669 01486000
         BR    @14                                                 0669 01487000
*/*                                                          @Z427VLS*/ 01488000
*/*                                                          @Z427VLS*/ 01489000
*CCHFILT: PROC;                                            /*@Z427VLS*/ 01490000
CCHFILT  STM   @14,@12,@SA00013                                    0670 01491000
*IF PCHAN = OFF THEN                                               0671 01492000
         TM    PCHAN(R2),B'01000000'                               0671 01493000
         BNZ   @RF00671                                            0671 01494000
*  DO;                                                     /*@Z427VLS*/ 01495000
*    PASSFLAG = OFF;                                       /*@Z427VLS*/ 01496000
         NI    PASSFLAG(R2),B'11111110'                            0673 01497000
*    BUG(27) = BUG(27) + 1;                                /*@Z427VLS*/ 01498000
         LA    @08,1                                               0674 01499000
         AL    @08,BUG+104                                         0674 01500000
         ST    @08,BUG+104                                         0674 01501000
*  END;                                                    /*@Z427VLS*/ 01502000
*ELSE                                                              0676 01503000
*  DO;                                                     /*@Z427VLS*/ 01504000
         B     @RC00671                                            0676 01505000
@RF00671 DS    0H                                                  0677 01506000
*    WORKMOD = (CCHCUA & ONLYCUA2);                        /*@Z427VLS*/ 01507000
         MVC   WORKMOD(2),CCHCUA(R7)                               0677 01508000
         NC    WORKMOD(2),@CB01014                                 0677 01509000
*    WORKCHAN = (CCHCUA & ONLYCHAN);                       /*@Z427VLS*/ 01510000
         MVC   WORKCHAN(1),CCHCUA(R7)                              0678 01511000
         NI    WORKCHAN,X'0F'                                      0678 01512000
*    IF CUAPTR ^= ZERO THEN                                        0679 01513000
         L     @08,CUAPTR(,R2)                                     0679 01514000
         LTR   @08,@08                                             0679 01515000
         BZ    @RF00679                                            0679 01516000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 01517000
         BAL   @14,CUASELCT                                        0680 01518000
*    IF PASSFLAG = YES THEN                                        0681 01519000
@RF00679 TM    PASSFLAG(R2),B'00000001'                            0681 01520000
         BNO   @RF00681                                            0681 01521000
*      DO;                                                 /*@Z427VLS*/ 01522000
*        IF CPCUAPTR ^= ZERO THEN                                  0683 01523000
         L     @08,CPCUAPTR(,R2)                                   0683 01524000
         LTR   @08,@08                                             0683 01525000
         BZ    @RF00683                                            0683 01526000
*          CALL CPCUASEL;                                  /*@Z427VLS*/ 01527000
         BAL   @14,CPCUASEL                                        0684 01528000
*        IF PASSFLAG = OFF THEN /*IF FAILED CPU,CUA SELECTION*/    0685 01529000
@RF00683 TM    PASSFLAG(R2),B'00000001'                            0685 01530000
         BNZ   @RF00685                                            0685 01531000
*          BUG(29) = BUG(29) + 1;                          /*@Z427VLS*/ 01532000
         LA    @08,1                                               0686 01533000
         AL    @08,BUG+112                                         0686 01534000
         ST    @08,BUG+112                                         0686 01535000
*         ELSE                                                     0687 01536000
*          DO;                                             /*@G51DGGB*/ 01537000
         B     @RC00685                                            0687 01538000
@RF00685 DS    0H                                                  0688 01539000
*           CALL MERIDCK1;       /*IS THIS A MERIDAN CPU     @G51DGGB*/ 01540000
         BAL   @14,MERIDCK1                                        0688 01541000
*          END;                                            /*@G51DGGB*/ 01542000
*        WORKMOD = LRTMODEL; /*RESET TO WHAT IT WAS          @Z427VLS*/ 01543000
@RC00685 MVC   WORKMOD(2),LRTMODEL(R7)                             0690 01544000
*      END;                                                /*@Z427VLS*/ 01545000
*    ELSE /*IF FAILED CUA SELECTION                          @Z427VLS*/ 01546000
*      BUG(28) = BUG(28) + 1;                              /*@Z427VLS*/ 01547000
         B     @RC00681                                            0692 01548000
@RF00681 LA    @08,1                                               0692 01549000
         AL    @08,BUG+108                                         0692 01550000
         ST    @08,BUG+108                                         0692 01551000
*   END;                                                   /*@Z427VLS*/ 01552000
*END;                                                      /*@Z427VLS*/ 01553000
@EL00013 DS    0H                                                  0694 01554000
@EF00013 DS    0H                                                  0694 01555000
@ER00013 LM    @14,@12,@SA00013                                    0694 01556000
         BR    @14                                                 0694 01557000
*/*                                                          @Z427VLS*/ 01558000
*IPLFILT: PROC;                                            /*@Z427VLS*/ 01559000
IPLFILT  STM   @14,@12,12(@13)                                     0695 01560000
*IF PIPL = OFF THEN                                                0696 01561000
         TM    PIPL(R2),B'00001000'                                0696 01562000
         BNZ   @RF00696                                            0696 01563000
*  DO;                                                     /*@Z427VLS*/ 01564000
*    PASSFLAG = OFF;                                       /*@Z427VLS*/ 01565000
         NI    PASSFLAG(R2),B'11111110'                            0698 01566000
*    BUG(30) = BUG(30) + 1;                                /*@Z427VLS*/ 01567000
         LA    @08,1                                               0699 01568000
         AL    @08,BUG+116                                         0699 01569000
         ST    @08,BUG+116                                         0699 01570000
*  END;                                                    /*@Z427VLS*/ 01571000
*END;                                                      /*@Z427VLS*/ 01572000
@EL00014 DS    0H                                                  0701 01573000
@EF00014 DS    0H                                                  0701 01574000
@ER00014 LM    @14,@12,12(@13)                                     0701 01575000
         BR    @14                                                 0701 01576000
*EODFILT: PROC;                                            /*@Z427VLS*/ 01577000
EODFILT  STM   @14,@12,12(@13)                                     0702 01578000
*IF PEOD = OFF THEN                                                0703 01579000
         TM    PEOD(R2),B'00000001'                                0703 01580000
         BNZ   @RF00703                                            0703 01581000
*  DO;                                                     /*@Z427VLS*/ 01582000
*    PASSFLAG = OFF;                                       /*@Z427VLS*/ 01583000
         NI    PASSFLAG(R2),B'11111110'                            0705 01584000
*    BUG(31) = BUG(31) + 1;                                /*@Z427VLS*/ 01585000
         LA    @08,1                                               0706 01586000
         AL    @08,BUG+120                                         0706 01587000
         ST    @08,BUG+120                                         0706 01588000
*  END;                                                    /*@Z427VLS*/ 01589000
*ELSE                                                              0708 01590000
* WORKTYPE = LRTKEY1;                                      /*@Z427VLS*/ 01591000
         B     @RC00703                                            0708 01592000
@RF00703 MVC   WORKTYPE(1),LRTKEY1(R7)                             0708 01593000
*END;                                                      /*@Z427VLS*/ 01594000
@EL00015 DS    0H                                                  0709 01595000
@EF00015 DS    0H                                                  0709 01596000
@ER00015 LM    @14,@12,12(@13)                                     0709 01597000
         BR    @14                                                 0709 01598000
*MCHFILT: PROC;                                            /*@Z427VLS*/ 01599000
MCHFILT  STM   @14,@12,@SA00016                                    0710 01600000
*IF PMCH = OFF THEN                                                0711 01601000
         TM    PMCH(R2),B'10000000'                                0711 01602000
         BNZ   @RF00711                                            0711 01603000
*  DO;                                                     /*@Z427VLS*/ 01604000
*    PASSFLAG = OFF;                                       /*@Z427VLS*/ 01605000
         NI    PASSFLAG(R2),B'11111110'                            0713 01606000
*    BUG(32) = BUG(32) + 1;                                /*@Z427VLS*/ 01607000
         LA    @08,1                                               0714 01608000
         AL    @08,BUG+124                                         0714 01609000
         ST    @08,BUG+124                                         0714 01610000
*  END;                                                    /*@Z427VLS*/ 01611000
*ELSE                                                              0716 01612000
* DO;                                                      /*@Z427VLS*/ 01613000
         B     @RC00711                                            0716 01614000
@RF00711 DS    0H                                                  0717 01615000
*  IF ERRORID = ON THEN                                            0717 01616000
         TM    ERRORID(R2),B'00000100'                             0717 01617000
         BNO   @RF00717                                            0717 01618000
*    CALL ERIDFILT;                                        /*@Z427VLS*/ 01619000
         BAL   @14,ERIDFILT                                        0718 01620000
*  IF PASSFLAG = OFF THEN /*IF FAILED ERROR ID FILTERING     @Z427VLS*/ 01621000
@RF00717 TM    PASSFLAG(R2),B'00000001'                            0719 01622000
         BNZ   @RF00719                                            0719 01623000
*    BUG(33) = BUG(33) + 1;                                /*@Z427VLS*/ 01624000
         LA    @08,1                                               0720 01625000
         AL    @08,BUG+128                                         0720 01626000
         ST    @08,BUG+128                                         0720 01627000
*  ELSE                                                            0721 01628000
*   DO;                                                    /*@G51DGGB*/ 01629000
         B     @RC00719                                            0721 01630000
@RF00719 DS    0H                                                  0722 01631000
*    CALL MERIDCK1;            /*CHECK TO SEE IF THIS IS A MERDIAN*/    01632000
         BAL   @14,MERIDCK1                                        0722 01633000
*   END;                                                   /*@G51DGGB*/ 01634000
* END;                                                     /*@Z427VLS*/ 01635000
*END;                                                      /*@Z427VLS*/ 01636000
@EL00016 DS    0H                                                  0725 01637000
@EF00016 DS    0H                                                  0725 01638000
@ER00016 LM    @14,@12,@SA00016                                    0725 01639000
         BR    @14                                                 0725 01640000
*SOFTFILT: PROC;                                           /*@Z427VLS*/ 01641000
SOFTFILT STM   @14,@12,@SA00017                                    0726 01642000
*IF PSOFT = OFF THEN                                               0727 01643000
         TM    PSOFT(R2),B'00010000'                               0727 01644000
         BNZ   @RF00727                                            0727 01645000
*  DO;                                                     /*@Z427VLS*/ 01646000
*    PASSFLAG = OFF;                                       /*@Z427VLS*/ 01647000
         NI    PASSFLAG(R2),B'11111110'                            0729 01648000
*    BUG(34) = BUG(34) + 1;                                /*@Z427VLS*/ 01649000
         LA    @08,1                                               0730 01650000
         AL    @08,BUG+132                                         0730 01651000
         ST    @08,BUG+132                                         0730 01652000
*  END;                                                    /*@Z427VLS*/ 01653000
*ELSE                                                              0732 01654000
*  DO;                                                     /*@Z427VLS*/ 01655000
         B     @RC00727                                            0732 01656000
@RF00727 DS    0H                                                  0733 01657000
*    IF ERRORID = ON THEN                                          0733 01658000
         TM    ERRORID(R2),B'00000100'                             0733 01659000
         BNO   @RF00733                                            0733 01660000
*      CALL ERIDFILT;                                      /*@Z427VLS*/ 01661000
         BAL   @14,ERIDFILT                                        0734 01662000
*    IF PASSFLAG = OFF THEN /*IF FAILED ERROR ID FILTERING   @Z427VLS*/ 01663000
@RF00733 TM    PASSFLAG(R2),B'00000001'                            0735 01664000
         BNZ   @RF00735                                            0735 01665000
*      BUG(35) = BUG(35) + 1;                              /*@Z427VLS*/ 01666000
         LA    @08,1                                               0736 01667000
         AL    @08,BUG+136                                         0736 01668000
         ST    @08,BUG+136                                         0736 01669000
*  END;                                                    /*@Z427VLS*/ 01670000
*END;                                                      /*@Z427VLS*/ 01671000
@EL00017 DS    0H                                                  0738 01672000
@EF00017 DS    0H                                                  0738 01673000
@ER00017 LM    @14,@12,@SA00017                                    0738 01674000
         BR    @14                                                 0738 01675000
*ERIDFILT: PROC;                                           /*@Z427VLS*/ 01676000
ERIDFILT STM   @14,@12,12(@13)                                     0739 01677000
*IF (LRTKEY1 = MVSMCH & (LRTERRID & HEX10) = HEX10) |              0740 01678000
*   (WORKTYPE = HEX40 & (LRTERRID & HEX20) = HEX20) THEN           0740 01679000
         CLI   LRTKEY1(R7),X'13'                                   0740 01680000
         BNE   @GL00052                                            0740 01681000
         MVC   @TS00001(1),LRTERRID(R7)                            0740 01682000
         NI    @TS00001,X'10'                                      0740 01683000
         CLI   @TS00001,X'10'                                      0740 01684000
         BE    @RT00740                                            0740 01685000
@GL00052 CLI   WORKTYPE,X'40'                                      0740 01686000
         BNE   @RF00740                                            0740 01687000
         MVC   @TS00001(1),LRTERRID(R7)                            0740 01688000
         NI    @TS00001,X'20'                                      0740 01689000
         CLI   @TS00001,X'20'                                      0740 01690000
         BNE   @RF00740                                            0740 01691000
@RT00740 DS    0H                                                  0741 01692000
*  DO;                                                     /*@Z427VLS*/ 01693000
*    IF IDVALUE ^= RSEQ THEN                                       0742 01694000
         LR    @08,R7                                              0742 01695000
         AH    @08,RECLNGTH(,R2)                                   0742 01696000
         AL    @08,@CF01518                                        0742 01697000
         CLC   IDVALUE(2,R2),RSEQ(@08)                             0742 01698000
         BE    @RF00742                                            0742 01699000
*      PASSFLAG = OFF;                                     /*@Z427VLS*/ 01700000
         NI    PASSFLAG(R2),B'11111110'                            0743 01701000
*    ELSE                                                          0744 01702000
*      DO;                                                 /*@Z427VLS*/ 01703000
         B     @RC00742                                            0744 01704000
@RF00742 DS    0H                                                  0745 01705000
*        IF IDCPU ^= 'FF'X THEN /*DEFAULT UNSET FLAG IS FF   @Z427VLS*/ 01706000
         CLI   IDCPU(R2),X'FF'                                     0745 01707000
         BE    @RF00745                                            0745 01708000
*          DO;                                             /*@Z427VLS*/ 01709000
*            IF IDCPU ^= RCPU THEN                                 0747 01710000
         LR    @08,R7                                              0747 01711000
         AH    @08,RECLNGTH(,R2)                                   0747 01712000
         AL    @08,@CF01524                                        0747 01713000
         CLC   IDCPU(1,R2),RCPU-3(@08)                             0747 01714000
         BE    @RF00747                                            0747 01715000
*              PASSFLAG = OFF;                             /*@Z427VLS*/ 01716000
         NI    PASSFLAG(R2),B'11111110'                            0748 01717000
*            ELSE                                                  0749 01718000
*              DO;                                         /*@Z427VLS*/ 01719000
         B     @RC00747                                            0749 01720000
@RF00747 DS    0H                                                  0750 01721000
*                IF IDASID ^= RASID THEN                           0750 01722000
         LR    @08,R7                                              0750 01723000
         AH    @08,RECLNGTH(,R2)                                   0750 01724000
         AL    @08,@CF01532                                        0750 01725000
         CLC   IDASID(2,R2),RASID-4(@08)                           0750 01726000
         BE    @RF00750                                            0750 01727000
*                  PASSFLAG = OFF;                         /*@Z427VLS*/ 01728000
         NI    PASSFLAG(R2),B'11111110'                            0751 01729000
*                ELSE                                              0752 01730000
*                  DO;                                     /*@Z427VLS*/ 01731000
         B     @RC00750                                            0752 01732000
@RF00750 DS    0H                                                  0753 01733000
*                   TIME=(IDHOUR*CONVSECT) +                       0753 01734000
*                        (IDMIN*CST) +                             0753 01735000
*                        (IDSEC*TEN) +                             0753 01736000
*                         IDTSEC;    /* ERRID TIME TO TSEC  @XA19973 */ 01737000
         SLR   @01,@01                                             0753 01738000
         IC    @01,IDHOUR(,R2)                                     0753 01739000
         M     @00,@CF01024                                        0753 01740000
         SLR   @08,@08                                             0753 01741000
         IC    @08,IDMIN(,R2)                                      0753 01742000
         MH    @08,@CH01026                                        0753 01743000
         ALR   @01,@08                                             0753 01744000
         SLR   @05,@05                                             0753 01745000
         IC    @05,IDSEC(,R2)                                      0753 01746000
         M     @04,TEN                                             0753 01747000
         ALR   @01,@05                                             0753 01748000
         SLR   @08,@08                                             0753 01749000
         IC    @08,IDTSEC(,R2)                                     0753 01750000
         ALR   @01,@08                                             0753 01751000
         ST    @01,TIME                                            0753 01752000
*                   IF TIME^=RTIME  THEN                           0754 01753000
         LR    @08,R7                                              0754 01754000
         AH    @08,RECLNGTH(,R2)                                   0754 01755000
         AL    @08,@CF01533                                        0754 01756000
         ICM   @06,15,RTIME-6(@08)                                 0754 01757000
         CR    @01,@06                                             0754 01758000
         BE    @RF00754                                            0754 01759000
*                     PASSFLAG=NO; /* ERROR ID^=RECORD TIME @XA19973 */ 01760000
         NI    PASSFLAG(R2),B'11111110'                            0755 01761000
*                   END;                                   /*@Z427VLS*/ 01762000
*               END;                                       /*@Z427VLS*/ 01763000
*           END;                                           /*@Z427VLS*/ 01764000
*        END;                                              /*@Z427VLS*/ 01765000
*    END;                                                  /*@Z427VLS*/ 01766000
*  ELSE /*IF RECORD DOES NOT HAVE ERRORID THEN REJECT IT     @Z427VLS*/ 01767000
*    PASSFLAG = NO;                                        /*@Z427VLS*/ 01768000
         B     @RC00740                                            0761 01769000
@RF00740 NI    PASSFLAG(R2),B'11111110'                            0761 01770000
*END;                                                      /*@Z427VLS*/ 01771000
@EL00018 DS    0H                                                  0762 01772000
@EF00018 DS    0H                                                  0762 01773000
@ER00018 LM    @14,@12,12(@13)                                     0762 01774000
         BR    @14                                                 0762 01775000
*CUASELCT: PROC;                                           /*@Z427VLS*/ 01776000
CUASELCT STM   @14,@12,12(@13)                                     0763 01777000
*CUAOK = NO;                                               /*@Z427VLS*/ 01778000
         NI    CUAOK,B'11111110'                                   0764 01779000
*DO J = 1 BY 1 TO CUANUM WHILE CUAOK = NO;                 /*@Z427VLS*/ 01780000
         LA    @08,1                                               0765 01781000
         ST    @08,J                                               0765 01782000
         B     @DE00765                                            0765 01783000
@DL00765 TM    CUAOK,B'00000001'                                   0765 01784000
         BNZ   @DC00765                                            0765 01785000
*  IF WORKMOD >= CUA1(J) & WORKMOD <= CUA2(J) THEN                 0766 01786000
         SLA   @08,2                                               0766 01787000
         L     @06,CUAPTR(,R2)                                     0766 01788000
         ST    @08,@TF00001                                        0766 01789000
         ALR   @08,@06                                             0766 01790000
         BCTR  @08,0                                               0766 01791000
         BCTR  @08,0                                               0766 01792000
         CLC   WORKMOD(2),CUA1-2(@08)                              0766 01793000
         BL    @RF00766                                            0766 01794000
         AL    @06,@TF00001                                        0766 01795000
         CLC   WORKMOD(2),CUA2-4(@06)                              0766 01796000
         BH    @RF00766                                            0766 01797000
*    CUAOK = YES;                                          /*@Z427VLS*/ 01798000
         OI    CUAOK,B'00000001'                                   0767 01799000
*END;                                                      /*@Z427VLS*/ 01800000
@RF00766 LA    @08,1                                               0768 01801000
         AL    @08,J                                               0768 01802000
         ST    @08,J                                               0768 01803000
@DE00765 L     @06,CUAPTR(,R2)                                     0768 01804000
         CH    @08,CUANUM(,@06)                                    0768 01805000
         BNH   @DL00765                                            0768 01806000
@DC00765 DS    0H                                                  0769 01807000
*IF CUAOK = NO THEN                                                0769 01808000
         TM    CUAOK,B'00000001'                                   0769 01809000
         BNZ   @RF00769                                            0769 01810000
*  PASSFLAG = NO;                                          /*@Z427VLS*/ 01811000
         NI    PASSFLAG(R2),B'11111110'                            0770 01812000
*END;                                                      /*@Z427VLS*/ 01813000
@EL00019 DS    0H                                                  0771 01814000
@EF00019 DS    0H                                                  0771 01815000
@ER00019 LM    @14,@12,12(@13)                                     0771 01816000
         BR    @14                                                 0771 01817000
*/*                                                          @Z427VLS*/ 01818000
*/*                                                          @Z427VLS*/ 01819000
*CPCUASEL: PROC;                                           /*@Z427VLS*/ 01820000
CPCUASEL STM   @14,@12,12(@13)                                     0772 01821000
*WKCPU = LRTCPUS;                                          /*@Z427VLS*/ 01822000
         MVC   WKCPU(3),LRTCPUS(R7)                                0773 01823000
*WKCUA = WORKMOD;                                          /*@Z427VLS*/ 01824000
         MVC   WKCUA(2),WORKMOD                                    0774 01825000
*CPUCUAOK = NO;                                            /*@Z427VLS*/ 01826000
         NI    CPUCUAOK,B'01111111'                                0775 01827000
*DO J = 1 BY 1 TO CPCUANUM WHILE CPUCUAOK = NO ;           /*@Z427VLS*/ 01828000
         LA    @08,1                                               0776 01829000
         ST    @08,J                                               0776 01830000
         B     @DE00776                                            0776 01831000
@DL00776 TM    CPUCUAOK,B'10000000'                                0776 01832000
         BNZ   @DC00776                                            0776 01833000
*   IF CPUCUX1(J) = LRTCPUS THEN                                   0777 01834000
         MH    @08,@CH00083                                        0777 01835000
         L     @06,CPCUAPTR(,R2)                                   0777 01836000
         ST    @08,@TF00001                                        0777 01837000
         ALR   @08,@06                                             0777 01838000
         AL    @08,@CF01520                                        0777 01839000
         CLC   CPUCUX1-2(3,@08),LRTCPUS(R7)                        0777 01840000
         BNE   @RF00777                                            0777 01841000
*    DO;                                                   /*@0099VLS*/ 01842000
*     IF WKCUA >= CPUCUX2(J) &                                     0779 01843000
*        WKCUA <= CPUCUX3(J) THEN                                  0779 01844000
         LR    @08,@06                                             0779 01845000
         AL    @08,@TF00001                                        0779 01846000
         BCTR  @08,0                                               0779 01847000
         BCTR  @08,0                                               0779 01848000
         CLC   WKCUA(2),CPUCUX2-5(@08)                             0779 01849000
         BL    @RF00779                                            0779 01850000
         AL    @06,@TF00001                                        0779 01851000
         CLC   WKCUA(2),CPUCUX3-7(@06)                             0779 01852000
         BH    @RF00779                                            0779 01853000
*         CPUCUAOK = YES;                                  /*@0099VLS*/ 01854000
         OI    CPUCUAOK,B'10000000'                                0780 01855000
*    END;                                                  /*@0099VLS*/ 01856000
@RF00779 DS    0H                                                  0782 01857000
*END;                                                      /*@Z427VLS*/ 01858000
@RF00777 LA    @08,1                                               0782 01859000
         AL    @08,J                                               0782 01860000
         ST    @08,J                                               0782 01861000
@DE00776 L     @06,CPCUAPTR(,R2)                                   0782 01862000
         CH    @08,CPCUANUM(,@06)                                  0782 01863000
         BNH   @DL00776                                            0782 01864000
@DC00776 DS    0H                                                  0783 01865000
*IF CPUCUAOK = NO THEN                                             0783 01866000
         TM    CPUCUAOK,B'10000000'                                0783 01867000
         BNZ   @RF00783                                            0783 01868000
*  PASSFLAG = NO;                                          /*@Z427VLS*/ 01869000
         NI    PASSFLAG(R2),B'11111110'                            0784 01870000
*END;                                                      /*@Z427VLS*/ 01871000
@EL00020 DS    0H                                                  0785 01872000
@EF00020 DS    0H                                                  0785 01873000
@ER00020 LM    @14,@12,12(@13)                                     0785 01874000
         BR    @14                                                 0785 01875000
*/*                                                          @Z427VLS*/ 01876000
*/*                                                          @Z427VLS*/ 01877000
*VOLID: PROC;                                              /*@Z427VLS*/ 01878000
VOLID    STM   @14,@12,12(@13)                                     0786 01879000
*IF WORKTYPE = HEX90 THEN /*IF RECORD IS MDR                 @Z427VLS*/ 01880000
         CLI   WORKTYPE,X'90'                                      0787 01881000
         BNE   @RF00787                                            0787 01882000
* DO;                                                      /*@Z427VLS*/ 01883000
*    IF TPRDEV = DV3330 |    /*VOL SELECTION FOR 33XX DEVICES*/    0789 01884000
*       TPRDEV = DV3340 |                                          0789 01885000
*       TPRDEV = DV33302 |                                         0789 01886000
*       TPRDEV = DV3350 THEN                                       0789 01887000
         CLI   TPRDEV(R7),X'01'                                    0789 01888000
         BE    @RT00789                                            0789 01889000
         CLI   TPRDEV(R7),X'09'                                    0789 01890000
         BE    @RT00789                                            0789 01891000
         CLI   TPRDEV(R7),X'0A'                                    0789 01892000
         BE    @RT00789                                            0789 01893000
         CLI   TPRDEV(R7),X'11'                                    0789 01894000
         BNE   @RF00789                                            0789 01895000
@RT00789 DS    0H                                                  0790 01896000
*  DO;                                                     /*@Z427VLS*/ 01897000
*    VOLOK = NO;                                           /*@Z427VLS*/ 01898000
         NI    VOLOK,B'10111111'                                   0791 01899000
*    DO J = 1 BY 1 TO VOLNUM WHILE VOLOK = NO;             /*@Z427VLS*/ 01900000
         LA    @08,1                                               0792 01901000
         ST    @08,J                                               0792 01902000
         B     @DE00792                                            0792 01903000
@DL00792 TM    VOLOK,B'01000000'                                   0792 01904000
         BNZ   @DC00792                                            0792 01905000
*      IF VOLVAL(J) = TPRVOL THEN                                  0793 01906000
         MH    @08,@CH00081                                        0793 01907000
         L     @06,VOLPTR(,R2)                                     0793 01908000
         ALR   @06,@08                                             0793 01909000
         AL    @06,@CF01533                                        0793 01910000
         CLC   VOLVAL-2(6,@06),TPRVOL(R7)                          0793 01911000
         BNE   @RF00793                                            0793 01912000
*        VOLOK = YES;                                      /*@Z427VLS*/ 01913000
         OI    VOLOK,B'01000000'                                   0794 01914000
*    END;                                                  /*@Z427VLS*/ 01915000
@RF00793 LA    @08,1                                               0795 01916000
         AL    @08,J                                               0795 01917000
         ST    @08,J                                               0795 01918000
@DE00792 L     @06,VOLPTR(,R2)                                     0795 01919000
         CH    @08,VOLNUM(,@06)                                    0795 01920000
         BNH   @DL00792                                            0795 01921000
@DC00792 DS    0H                                                  0796 01922000
*    IF VOLOK = NO THEN                                            0796 01923000
         TM    VOLOK,B'01000000'                                   0796 01924000
         BNZ   @RF00796                                            0796 01925000
*      PASSFLAG = NO;                                      /*@Z427VLS*/ 01926000
         NI    PASSFLAG(R2),B'11111110'                            0797 01927000
*  END;                                                    /*@Z427VLS*/ 01928000
* END;                                                     /*@Z427VLS*/ 01929000
*  ELSE                                                            0800 01930000
*   DO; /*OBR BY DEFAULT                                     @Z427VLS*/ 01931000
         B     @RC00787                                            0800 01932000
@RF00787 DS    0H                                                  0801 01933000
*IF WORKDEV = DEV3330 |                                            0801 01934000
*   WORKDEV = DEV3340 |                                            0801 01935000
*   WORKDEV = DEV3350 |                                            0801 01936000
*   WORKDEV = DEV33301 THEN                                        0801 01937000
         CLC   WORKDEV(2),@CB00984                                 0801 01938000
         BE    @RT00801                                            0801 01939000
         CLC   WORKDEV(2),@CB00986                                 0801 01940000
         BE    @RT00801                                            0801 01941000
         CLC   WORKDEV(2),@CB00988                                 0801 01942000
         BE    @RT00801                                            0801 01943000
         CLC   WORKDEV(2),@CB00990                                 0801 01944000
         BNE   @RF00801                                            0801 01945000
@RT00801 DS    0H                                                  0802 01946000
*  DO;                                                     /*@Z427VLS*/ 01947000
*    VOLOK = NO;                                           /*@Z427VLS*/ 01948000
         NI    VOLOK,B'10111111'                                   0803 01949000
*    DO J = 1 BY 1 TO VOLNUM WHILE VOLOK = NO;             /*@Z427VLS*/ 01950000
         LA    @08,1                                               0804 01951000
         ST    @08,J                                               0804 01952000
         B     @DE00804                                            0804 01953000
@DL00804 TM    VOLOK,B'01000000'                                   0804 01954000
         BNZ   @DC00804                                            0804 01955000
*      IF VOLVAL(J) = OBRVOL THEN                                  0805 01956000
         MH    @08,@CH00081                                        0805 01957000
         L     @06,VOLPTR(,R2)                                     0805 01958000
         ALR   @06,@08                                             0805 01959000
         AL    @06,@CF01533                                        0805 01960000
         CLC   VOLVAL-2(6,@06),OBRVOL(R7)                          0805 01961000
         BNE   @RF00805                                            0805 01962000
*        VOLOK = YES;                                      /*@Z427VLS*/ 01963000
         OI    VOLOK,B'01000000'                                   0806 01964000
*    END;                                                  /*@Z427VLS*/ 01965000
@RF00805 LA    @08,1                                               0807 01966000
         AL    @08,J                                               0807 01967000
         ST    @08,J                                               0807 01968000
@DE00804 L     @06,VOLPTR(,R2)                                     0807 01969000
         CH    @08,VOLNUM(,@06)                                    0807 01970000
         BNH   @DL00804                                            0807 01971000
@DC00804 DS    0H                                                  0808 01972000
*    IF VOLOK = NO THEN                                            0808 01973000
         TM    VOLOK,B'01000000'                                   0808 01974000
         BNZ   @RF00808                                            0808 01975000
*      PASSFLAG = NO;                                      /*@Z427VLS*/ 01976000
         NI    PASSFLAG(R2),B'11111110'                            0809 01977000
*  END;                                                    /*@Z427VLS*/ 01978000
*   END;                                                   /*@Z427VLS*/ 01979000
*END; /*END OF VOLID PROC                                    @Z427VLS*/ 01980000
@EL00021 DS    0H                                                  0812 01981000
@EF00021 DS    0H                                                  0812 01982000
@ER00021 LM    @14,@12,12(@13)                                     0812 01983000
         BR    @14                                                 0812 01984000
*/*                                                          @Z427VLS*/ 01985000
*/*                                                          @Z427VLS*/ 01986000
* TERMID: PROC;                                            /*@Z427VLS*/ 01987000
TERMID   STM   @14,@12,12(@13)                                     0813 01988000
* IF LRTKEY1 = OBRVTAM |                                           0814 01989000
*  ((LRTKEY1=OBRCONV|OBRKEY1=OBRTCM) &                             0814 01990000
*   (OBRTCAM & '0F'X) = TCAMYES)                                   0814 01991000
*    THEN                                                  /*@XA21139*/ 01992000
         CLI   LRTKEY1(R7),X'36'                                   0814 01993000
         BE    @RT00814                                            0814 01994000
         CLI   LRTKEY1(R7),X'32'                                   0814 01995000
         BE    @GL00064                                            0814 01996000
         CLI   OBRKEY1(R7),X'34'                                   0814 01997000
         BNE   @RF00814                                            0814 01998000
@GL00064 MVC   @TS00001(1),OBRTCAM(R7)                             0814 01999000
         NI    @TS00001,X'0F'                                      0814 02000000
         CLI   @TS00001,X'0F'                                      0814 02001000
         BNE   @RF00814                                            0814 02002000
@RT00814 DS    0H                                                  0815 02003000
*      DO;                                                 /*@Z427VLS*/ 02004000
*        WORKTYPE = LRTKEY1;                               /*@Z427VLS*/ 02005000
         MVC   WORKTYPE(1),LRTKEY1(R7)                             0816 02006000
*        IF TERM  ^= BLANKS & TERM  ^= OBRTERMN THEN               0817 02007000
         CLC   TERM(8,R2),@CC00977                                 0817 02008000
         BE    @RF00817                                            0817 02009000
         CLC   TERM(8,R2),OBRTERMN(R7)                             0817 02010000
         BE    @RF00817                                            0817 02011000
*          PASSFLAG = NO;                                  /*@Z427VLS*/ 02012000
         NI    PASSFLAG(R2),B'11111110'                            0818 02013000
*      END;                                                /*@Z427VLS*/ 02014000
* END;                                                     /*@Z427VLS*/ 02015000
@EL00022 DS    0H                                                  0820 02016000
@EF00022 DS    0H                                                  0820 02017000
@ER00022 LM    @14,@12,12(@13)                                     0820 02018000
         BR    @14                                                 0820 02019000
*/*                                                          @Z427VLS*/ 02020000
*/******************************************************************/   02021000
*/*    THIS PROC WILL DETERMINE WHAT TO DO WITH THE FRAME RECORDS   */  02022000
*      RESPECIFY (R15) UNRESTRICTED;                       /*@G51DGGB*/ 02023000
*/*                                                          @G51DGGB*/ 02024000
*CKFRAMES: PROC;                                           /*@G51DGGB*/ 02025000
CKFRAMES STM   @14,@12,@SA00023                                    0822 02026000
* RESPECIFY (R15) RESTRICTED;                              /*@G51DGGB*/ 02027000
*IF DEBUG49 = ON THEN                                              0824 02028000
         TM    DEBUG49(R2),B'01000000'                             0824 02029000
         BNO   @RF00824                                            0824 02030000
* CALL HEXDUMP;                                            /*@G51DGGB*/ 02031000
         BAL   @14,HEXDUMP                                         0825 02032000
*      IF LRTCNT = ONE & FRAMENUM ^= ZERO & (LRTKEY1 & 'F0'X) = 'A0'X   02033000
*       THEN                                                       0826 02034000
@RF00824 CLI   LRTCNT(R7),1                                        0826 02035000
         BNE   @RF00826                                            0826 02036000
         L     @14,FRAMEPTR(,R2)                                   0826 02037000
         L     @14,FRAMENUM(,@14)                                  0826 02038000
         LTR   @14,@14                                             0826 02039000
         BZ    @RF00826                                            0826 02040000
         MVC   @TS00001(1),LRTKEY1(R7)                             0826 02041000
         NI    @TS00001,X'F0'                                      0826 02042000
         CLI   @TS00001,X'A0'                                      0826 02043000
         BNE   @RF00826                                            0826 02044000
*        DO;                                               /*@G51DGGB*/ 02045000
*          SAVESEQ = ONE;           /* RESET SEQUENCE CHECK  @G51DGGB*/ 02046000
         MVC   SAVESEQ(4),@CF00055                                 0828 02047000
*          CALL FRAMEREP;           /* SEE IF THIS FRAME SET MUST*/     02048000
         BAL   @14,FRAMEREP                                        0829 02049000
*          R15 = ERROR;             /* BE SAVED              @G51DGGB*/ 02050000
         L     @08,ERROR                                           0830 02051000
         LR    R15,@08                                             0830 02052000
*          IF LRTNLAST = OFF & FRAMEYES = ON & ERROR = 0 THEN      0831 02053000
         TM    LRTNLAST(R7),B'10000000'                            0831 02054000
         BNZ   @RF00831                                            0831 02055000
         TM    FRAMEYES,B'00000100'                                0831 02056000
         BNO   @RF00831                                            0831 02057000
         SLR   @14,@14                                             0831 02058000
         CR    @08,@14                                             0831 02059000
         BNE   @RF00831                                            0831 02060000
*           DO;                                            /*@G51DGGB*/ 02061000
*            FRAMETYP(CCHINDX) = ALLMCH;                   /*@G51DGGB*/ 02062000
         L     @08,CCHINDX                                         0833 02063000
         MH    @08,@CH00227                                        0833 02064000
         L     @06,FRAMEPTR(,R2)                                   0833 02065000
         ALR   @06,@08                                             0833 02066000
         AL    @06,@CF01524                                        0833 02067000
         MVI   FRAMETYP-17(@06),X'02'                              0833 02068000
*            SAVESEQ = 0;                                  /*@G51DGGB*/ 02069000
         ST    @14,SAVESEQ                                         0834 02070000
*           END;                                           /*@G51DGGB*/ 02071000
*        END;                                              /*@G51DGGB*/ 02072000
*      ELSE                         /* NON-FIRST FRAME       @G51DGGB*/ 02073000
*        DO;                                               /*@G51DGGB*/ 02074000
         B     @RC00826                                            0837 02075000
@RF00826 DS    0H                                                  0838 02076000
*          IF FRAMEYES = ON THEN    /* IF FRAME IS TO BE SAVED  */ 0838 02077000
         TM    FRAMEYES,B'00000100'                                0838 02078000
         BNO   @RF00838                                            0838 02079000
*            DO;                                           /*@G51DGGB*/ 02080000
*              SAVESEQ = SAVESEQ + 1;  /* UP SEQ CHECK       @G51DGGB*/ 02081000
         LA    @14,1                                               0840 02082000
         AL    @14,SAVESEQ                                         0840 02083000
         ST    @14,SAVESEQ                                         0840 02084000
*              IF SAVESEQ = LRTCNT THEN /* IF RECORD NOT MISSING */     02085000
         SLR   @08,@08                                             0841 02086000
         IC    @08,LRTCNT(,R7)                                     0841 02087000
         CR    @14,@08                                             0841 02088000
         BNE   @RF00841                                            0841 02089000
*                DO;                                       /*@G51DGGB*/ 02090000
*                  CALL BUILDTTR;   /* SAVE EXTERNAL LOCATION */   0843 02091000
         BAL   @14,BUILDTTR                                        0843 02092000
*                  R15 = ERROR;                            /*@G51DGGB*/ 02093000
         L     R15,ERROR                                           0844 02094000
*                  IF R15 = ZERO THEN  /* IF FRAME EXTERNAL LOC  */     02095000
         SLR   @14,@14                                             0845 02096000
         CR    R15,@14                                             0845 02097000
         BNE   @RF00845                                            0845 02098000
*                    DO;               /* SUCCESSFULLY SAVED @G51DGGB*/ 02099000
*                      IF LRTNLAST = OFF THEN /* IF LAST FRAME  */ 0847 02100000
         TM    LRTNLAST(R7),B'10000000'                            0847 02101000
         BNZ   @RF00847                                            0847 02102000
*                        DO;                               /*@G51DGGB*/ 02103000
*                          IF( LRTKEY1 & GENREC) = HEXA0 THEN      0849 02104000
         MVC   @TS00001(1),LRTKEY1(R7)                             0849 02105000
         NI    @TS00001,X'F0'                                      0849 02106000
         CLI   @TS00001,X'A0'                                      0849 02107000
         BNE   @RF00849                                            0849 02108000
*                           DO;                            /*@G51DGGB*/ 02109000
*                            FRAMETYP(CCHINDX) = ALLMCH;   /*@G51DGGB*/ 02110000
         L     @08,CCHINDX                                         0851 02111000
         MH    @08,@CH00227                                        0851 02112000
         L     @06,FRAMEPTR(,R2)                                   0851 02113000
         ALR   @06,@08                                             0851 02114000
         AL    @06,@CF01524                                        0851 02115000
         MVI   FRAMETYP-17(@06),X'02'                              0851 02116000
*                            SAVESEQ = 0;                  /*@G51DGGB*/ 02117000
         ST    @14,SAVESEQ                                         0852 02118000
*                           END;                           /*@G51DGGB*/ 02119000
*                          /*IF ALL MCH FRAMES HAVE BEEN SAVED,  */     02120000
*                          /*THEN INDICATE SUCH              @G51DGGB*/ 02121000
*                           ELSE                  /*IS CCH FRAME */     02122000
*                            DO;                           /*@G51DGGB*/ 02123000
         B     @RC00849                                            0854 02124000
@RF00849 DS    0H                                                  0855 02125000
*                            FRAMEYES = OFF;               /*@G51DGGB*/ 02126000
         NI    FRAMEYES,B'11111011'                                0855 02127000
*                            IF FRAMETYP(CCHINDX) ^= ALLMCH THEN   0856 02128000
         L     @14,CCHINDX                                         0856 02129000
         MH    @14,@CH00227                                        0856 02130000
         L     @08,FRAMEPTR(,R2)                                   0856 02131000
         ALR   @08,@14                                             0856 02132000
         AL    @08,@CF01524                                        0856 02133000
         CLI   FRAMETYP-17(@08),X'02'                              0856 02134000
         BE    @RF00856                                            0856 02135000
*                              DO; /*IF MISSING LAST MCH FRAME   */     02136000
*                                MSGNO = QQ1;              /*@G51DGGB*/ 02137000
         MVI   MSGNO,X'0A'                                         0858 02138000
*                                CALL ERRMSG;              /*@G51DGGB*/ 02139000
         BAL   @14,ERRMSG                                          0859 02140000
*                                CALL FIXENTRY; /*DELETE INCOM-  */     02141000
         BAL   @14,FIXENTRY                                        0860 02142000
*                              END;             /*PLETE SET. @G51DGGB*/ 02143000
*                             ELSE   /*IS COMPLETE SET -INDICATE  */    02144000
*                              FRAMETYP(CCHINDX) = ALLALL; /*IT IS*/    02145000
         B     @RC00856                                            0862 02146000
@RF00856 L     @14,CCHINDX                                         0862 02147000
         MH    @14,@CH00227                                        0862 02148000
         L     @08,FRAMEPTR(,R2)                                   0862 02149000
         ALR   @08,@14                                             0862 02150000
         AL    @08,@CF01524                                        0862 02151000
         MVI   FRAMETYP-17(@08),X'FF'                              0862 02152000
*                            END;                          /*@G51DGGB*/ 02153000
*                        END;                              /*@G51DGGB*/ 02154000
*                   END;                                   /*@G51DGGB*/ 02155000
*              END;                                        /*@G51DGGB*/ 02156000
*            ELSE   /*MISSING MIDDLE FRAME                   @G51DGGB*/ 02157000
*              DO;                                         /*@G51DGGB*/ 02158000
         B     @RC00841                                            0867 02159000
@RF00841 DS    0H                                                  0868 02160000
*                MSGNO = QQ1;                              /*@G51DGGB*/ 02161000
         MVI   MSGNO,X'0A'                                         0868 02162000
*                CALL ERRMSG;                              /*@G51DGGB*/ 02163000
         BAL   @14,ERRMSG                                          0869 02164000
*                FRAMEYES = OFF; /*DONT SAVE INCOMPLETE SET  @G51DGGB*/ 02165000
         NI    FRAMEYES,B'11111011'                                0870 02166000
*                CALL FIXENTRY; /*DELETE REFS TO INCOMPLETE SET*/  0871 02167000
         BAL   @14,FIXENTRY                                        0871 02168000
*              END;                                        /*@G51DGGB*/ 02169000
*           END;                                           /*@G51DGGB*/ 02170000
*          ELSE      /*FRAME NOT TO BE SAVED                 @G51DGGB*/ 02171000
*            BUG(37) = BUG(37) + 1;                        /*@G51DGGB*/ 02172000
         B     @RC00838                                            0874 02173000
@RF00838 LA    @14,1                                               0874 02174000
         AL    @14,BUG+144                                         0874 02175000
         ST    @14,BUG+144                                         0874 02176000
*      END;                                                /*@G51DGGB*/ 02177000
*RESPECIFY (R15) UNRESTRICTED;                             /*@G51DGGB*/ 02178000
*END;                                                      /*@G51DGGB*/ 02179000
@EL00023 DS    0H                                                  0877 02180000
@EF00023 DS    0H                                                  0877 02181000
@ER00023 LM    @14,@12,@SA00023                                    0877 02182000
         BR    @14                                                 0877 02183000
*/********************************************************************/ 02184000
*/*    THIS PROC WILL WRITE FRAMES TO THE ACCDEV DATA SET IF ANY WERE*/ 02185000
*/*    SAVED DURING THIS JOB STEP                            @G51DGGB*/ 02186000
*/*                                                          @G51DGGB*/ 02187000
*WRITEFRM: PROC;                                           /*@G51DGGB*/ 02188000
WRITEFRM STM   @14,@12,@SA00024                                    0878 02189000
*DCL F FIXED(31) INIT(0);                                  /*@G51DGGB*/ 02190000
*RESPECIFY (R15) RESTRICTED;                               /*@G51DGGB*/ 02191000
*         DO F = 1 BY 1 TO FRAMENUM WHILE R15 < FOUR;       /*SETS. */  02192000
         LA    @14,1                                               0881 02193000
         ST    @14,F                                               0881 02194000
         B     @DE00881                                            0881 02195000
@DL00881 C     R15,@CF00064                                        0881 02196000
         BNL   @DC00881                                            0881 02197000
*           IF FRAMETYP(F) = ALLALL THEN /*IF COMPLETE SET   @G51DGGB*/ 02198000
         MH    @14,@CH00227                                        0882 02199000
         L     @08,FRAMEPTR(,R2)                                   0882 02200000
         ST    @14,@TF00001                                        0882 02201000
         ALR   @14,@08                                             0882 02202000
         AL    @14,@CF01524                                        0882 02203000
         CLI   FRAMETYP-17(@14),X'FF'                              0882 02204000
         BNE   @RF00882                                            0882 02205000
*             DO;                                          /*@G51DGGB*/ 02206000
*              IF PACC = YES THEN                                  0884 02207000
         TM    PACC(R2),B'01000000'                                0884 02208000
         BNO   @RF00884                                            0884 02209000
*               DO;                                        /*@G51DGGB*/ 02210000
*               LISTPTR = FRAMLOCM(F);   /*ESTABLISH LISTLOC ADDR.*/    02211000
         L     @14,@TF00001                                        0886 02212000
         AL    @08,@CF01533                                        0886 02213000
         L     @14,FRAMLOCM-20(@14,@08)                            0886 02214000
         ST    @14,LISTPTR                                         0886 02215000
*               DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR ;/*@G51DGGB*/ 02216000
         LA    @14,1                                               0887 02217000
         ST    @14,Z                                               0887 02218000
         B     @DE00887                                            0887 02219000
@DL00887 C     R15,@CF00064                                        0887 02220000
         BNL   @DC00887                                            0887 02221000
*                 RECCCHHR = LISTCCHR(Z);  /*GET ALL MCH FRAMES*/  0888 02222000
         MH    @14,@CH00079                                        0888 02223000
         L     @08,LISTPTR                                         0888 02224000
         ALR   @08,@14                                             0888 02225000
         BCTR  @08,0                                               0888 02226000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      0888 02227000
*                 CALL IOHND(READIRCT);    /*READ FRAME FROM DIRECTWK*/ 02228000
         L     @15,ADIOHND(,R2)                                    0889 02229000
         LA    @01,@AL00889                                        0889 02230000
         BALR  @14,@15                                             0889 02231000
*                 IF R15 = ZERO THEN       /*WRITE FRAME TO ACCDEV*/    02232000
         LTR   R15,R15                                             0890 02233000
         BNZ   @RF00890                                            0890 02234000
*                  DO;                                     /*@G51DGGB*/ 02235000
*                   CALL IOHND(RITEHIST);                  /*@G51DGGB*/ 02236000
         L     @15,ADIOHND(,R2)                                    0892 02237000
         LA    @01,@AL00892                                        0892 02238000
         BALR  @14,@15                                             0892 02239000
*                   BUG(44) = BUG(44) + 1;                 /*@G51DGGB*/ 02240000
         LA    @14,1                                               0893 02241000
         AL    @14,BUG+172                                         0893 02242000
         ST    @14,BUG+172                                         0893 02243000
*                  END;                                    /*@G51DGGB*/ 02244000
*                 ELSE                     /*IDENTIFY MISSING FRAME*/   02245000
*                   DO;                    /*ON ACCDEV       @G51DGGB*/ 02246000
         B     @RC00890                                            0895 02247000
@RF00890 DS    0H                                                  0896 02248000
*                     MSGNO = RR;          /*FRAME LOST WRITING TO */   02249000
         MVI   MSGNO,X'09'                                         0896 02250000
*                     ERROR = 12;                          /*@G51DGGB*/ 02251000
         MVC   ERROR(4),@CF00032                                   0897 02252000
*                     CALL ERRMSG;         /*ACCDEV MESSAGE. @G51DGGB*/ 02253000
         BAL   @14,ERRMSG                                          0898 02254000
*                   END;                                   /*@G51DGGB*/ 02255000
*              END;                                        /*@G51DGGB*/ 02256000
@RC00890 LA    @14,1                                               0900 02257000
         AL    @14,Z                                               0900 02258000
         ST    @14,Z                                               0900 02259000
@DE00887 L     @08,LISTPTR                                         0900 02260000
         C     @14,LISTNUM(,@08)                                   0900 02261000
         BNH   @DL00887                                            0900 02262000
@DC00887 DS    0H                                                  0901 02263000
*              IF R15 = ZERO THEN /*IF NO ACCDEV WRITE ERROR @G51DGGB*/ 02264000
         LTR   R15,R15                                             0901 02265000
         BNZ   @RF00901                                            0901 02266000
*                DO;                                       /*@G51DGGB*/ 02267000
*                  LISTPTR = FRAMLOCC(F); /*GET CCH FRAMES   @G51DGGB*/ 02268000
         L     @14,F                                               0903 02269000
         MH    @14,@CH00227                                        0903 02270000
         L     @08,FRAMEPTR(,R2)                                   0903 02271000
         L     @14,FRAMLOCC-24(@14,@08)                            0903 02272000
         ST    @14,LISTPTR                                         0903 02273000
*                  DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR;      0904 02274000
         LA    @14,1                                               0904 02275000
         ST    @14,Z                                               0904 02276000
         B     @DE00904                                            0904 02277000
@DL00904 C     R15,@CF00064                                        0904 02278000
         BNL   @DC00904                                            0904 02279000
*                    RECCCHHR = LISTCCHR(Z);               /*@G51DGGB*/ 02280000
         MH    @14,@CH00079                                        0905 02281000
         L     @08,LISTPTR                                         0905 02282000
         ALR   @08,@14                                             0905 02283000
         BCTR  @08,0                                               0905 02284000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      0905 02285000
*                      CALL IOHND(READIRCT); /*READ FRAME OFF DRCTWK*/  02286000
         L     @15,ADIOHND(,R2)                                    0906 02287000
         LA    @01,@AL00906                                        0906 02288000
         BALR  @14,@15                                             0906 02289000
*                      IF R15 = ZERO THEN    /*IF SUCCESS THEN WRITE*/  02290000
         LTR   R15,R15                                             0907 02291000
         BNZ   @RF00907                                            0907 02292000
*                  DO;                                     /*@G51DGGB*/ 02293000
*                   CALL IOHND(RITEHIST);                  /*@G51DGGB*/ 02294000
         L     @15,ADIOHND(,R2)                                    0909 02295000
         LA    @01,@AL00909                                        0909 02296000
         BALR  @14,@15                                             0909 02297000
*                   BUG(44) = BUG(44) + 1;                 /*@G51DGGB*/ 02298000
         LA    @14,1                                               0910 02299000
         AL    @14,BUG+172                                         0910 02300000
         ST    @14,BUG+172                                         0910 02301000
*                  END;                                    /*@G51DGGB*/ 02302000
*                      ELSE /*ACCDEV WRITE ERROR             @G51DGGB*/ 02303000
*                        DO;                               /*@G51DGGB*/ 02304000
         B     @RC00907                                            0912 02305000
@RF00907 DS    0H                                                  0913 02306000
*                          MSGNO = RR; /*FRAME LOST WRITING TO ACCDEV*/ 02307000
         MVI   MSGNO,X'09'                                         0913 02308000
*                          ERROR = 12;                     /*@G51DGGB*/ 02309000
         MVC   ERROR(4),@CF00032                                   0914 02310000
*                          CALL ERRMSG;   /*MESSAGE.         @G51DGGB*/ 02311000
         BAL   @14,ERRMSG                                          0915 02312000
*                        END;                              /*@G51DGGB*/ 02313000
*                    END;                                  /*@G51DGGB*/ 02314000
@RC00907 LA    @14,1                                               0917 02315000
         AL    @14,Z                                               0917 02316000
         ST    @14,Z                                               0917 02317000
@DE00904 L     @08,LISTPTR                                         0917 02318000
         C     @14,LISTNUM(,@08)                                   0917 02319000
         BNH   @DL00904                                            0917 02320000
@DC00904 DS    0H                                                  0918 02321000
*                 END;                                     /*@G51DGGB*/ 02322000
*              END;                                        /*@G51DGGB*/ 02323000
*             END;                                         /*@G51DGGB*/ 02324000
*           ELSE  /*INCOMPLETE FRAME SET                     @G51DGGB*/ 02325000
*             DO;                                          /*@G51DGGB*/ 02326000
         B     @RC00882                                            0921 02327000
@RF00882 DS    0H                                                  0922 02328000
*               MSGNO = QQ; /*MISSING FRAME SET MESSAGE      @G51DGGB*/ 02329000
         MVI   MSGNO,X'07'                                         0922 02330000
*               CCHINDX = F;   /*CORRECT DEBUG FRAME COUNTS BY */  0923 02331000
         L     @14,F                                               0923 02332000
         ST    @14,CCHINDX                                         0923 02333000
*               CALL ERRMSG;                               /*@G51DGGB*/ 02334000
         BAL   @14,ERRMSG                                          0924 02335000
*               CALL FIXENTRY; /*PASSING ENTRY INDEX TO FIXENTRY*/ 0925 02336000
         BAL   @14,FIXENTRY                                        0925 02337000
*             END;                                         /*@G51DGGB*/ 02338000
*         END;                                             /*@G51DGGB*/ 02339000
@RC00882 LA    @14,1                                               0927 02340000
         AL    @14,F                                               0927 02341000
         ST    @14,F                                               0927 02342000
@DE00881 L     @08,FRAMEPTR(,R2)                                   0927 02343000
         C     @14,FRAMENUM(,@08)                                  0927 02344000
         BNH   @DL00881                                            0927 02345000
@DC00881 DS    0H                                                  0928 02346000
*      END;                                                /*@G51DGGB*/ 02347000
@EL00024 DS    0H                                                  0928 02348000
@EF00024 DS    0H                                                  0928 02349000
@ER00024 LM    @14,@12,@SA00024                                    0928 02350000
         BR    @14                                                 0928 02351000
*/******************************************************************/   02352000
*/*    THIS PROC WILL DETERMINE IF THE MODEL IS A MERIDAN CPU      */   02353000
*MERIDCK1: PROC;                                           /*@G51DGGB*/ 02354000
MERIDCK1 STM   @14,@12,@SA00025                                    0929 02355000
*DCL A FIXED(31) INIT(0);                                  /*@G51DGGB*/ 02356000
*ISMERD = NO;              /*SET THE FLAG PRIOR TO START     @G51DGGB*/ 02357000
         NI    ISMERD,B'10111111'                                  0931 02358000
*DO A = 1 BY 1 TO MRDNUMBR WHILE(ISMERD = NO);             /*@G51DGGB*/ 02359000
         LA    @14,1                                               0932 02360000
         ST    @14,A                                               0932 02361000
         B     @DE00932                                            0932 02362000
@DL00932 TM    ISMERD,B'01000000'                                  0932 02363000
         BNZ   @DC00932                                            0932 02364000
* IF LRTMODEL = MODEL(A) THEN                                      0933 02365000
         ALR   @14,@14                                             0933 02366000
         L     @08,MERDCPTR(,R2)                                   0933 02367000
         ALR   @08,@14                                             0933 02368000
         CLC   LRTMODEL(2,R7),MODEL-2(@08)                         0933 02369000
         BNE   @RF00933                                            0933 02370000
*  DO;                                                     /*@G51DGGB*/ 02371000
*  ISMERD = YES;          /*TELL THE CALLER IT WAS MERDIAN   @G51DGGB*/ 02372000
         OI    ISMERD,B'01000000'                                  0935 02373000
*  WORKTYPE = (WORKTYPE | '0F'X);                          /*@G51DGGB*/ 02374000
         OI    WORKTYPE,X'0F'                                      0936 02375000
*  CALL BUILDFTB;                                          /*@G51DGGB*/ 02376000
         BAL   @14,BUILDFTB                                        0937 02377000
*  END;                                                    /*@G51DGGB*/ 02378000
*END;                                                      /*@G51DGGB*/ 02379000
@RF00933 LA    @14,1                                               0939 02380000
         AL    @14,A                                               0939 02381000
         ST    @14,A                                               0939 02382000
@DE00932 L     @08,MERDCPTR(,R2)                                   0939 02383000
         CH    @14,MRDNUMBR(,@08)                                  0939 02384000
         BNH   @DL00932                                            0939 02385000
@DC00932 DS    0H                                                  0940 02386000
*END;                                                      /*@G51DGGB*/ 02387000
@EL00025 DS    0H                                                  0940 02388000
@EF00025 DS    0H                                                  0940 02389000
@ER00025 LM    @14,@12,@SA00025                                    0940 02390000
         BR    @14                                                 0940 02391000
*/******************************************************************/   02392000
*/*THIS PROC WILL EXAMINE THE MERIDIAN MCH OR CCH IN ORDER TO BUILD*/   02393000
*/*FRAMTAB ENTRIES FOR UNIQUE RECORDS                        @G51DGGB*/ 02394000
*BUILDFTB: PROC; /*BUILD NEW ENTRY IF CPU IS UNIQUE          @G51DGGB*/ 02395000
BUILDFTB STM   @14,@12,@SA00026                                    0941 02396000
*LOOPOUT = NO;                                             /*@G51DGGB*/ 02397000
         NI    LOOPOUT,B'11101111'                                 0942 02398000
*DO T = 1 BY 1 TO EVMAX WHILE LOOPOUT = NO; /*EXAMINE ALL FRAMETAB*/    02399000
         LA    @14,1                                               0943 02400000
         ST    @14,T                                               0943 02401000
@DL00943 TM    LOOPOUT,B'00010000'                                 0943 02402000
         BNZ   @DC00943                                            0943 02403000
*  IF FRAMECPU(T) = LRTCPMOD THEN  /*IF CPU ALREADY IN TABLE THEN*/     02404000
         MH    @14,@CH00227                                        0944 02405000
         L     @08,FRAMEPTR(,R2)                                   0944 02406000
         ALR   @08,@14                                             0944 02407000
         AL    @08,@CF01522                                        0944 02408000
         CLC   FRAMECPU-4(5,@08),LRTCPMOD(R7)                      0944 02409000
         BNE   @RF00944                                            0944 02410000
*    LOOPOUT = YES; /*EXIT LOOP                              @G51DGGB*/ 02411000
         OI    LOOPOUT,B'00010000'                                 0945 02412000
*  ELSE     /*IF ENTRY DOESNT MATCH THE FRAME                @G51DGGB*/ 02413000
*    DO;                                                   /*@G51DGGB*/ 02414000
         B     @RC00944                                            0946 02415000
@RF00944 DS    0H                                                  0947 02416000
*      IF FRAMECPU(T) = ZERO1 THEN/*NO MATCH,ALL SET ENTRIES EXAMINED*/ 02417000
         L     @14,T                                               0947 02418000
         MH    @14,@CH00227                                        0947 02419000
         L     @08,FRAMEPTR(,R2)                                   0947 02420000
         ST    @14,@TF00001                                        0947 02421000
         ALR   @14,@08                                             0947 02422000
         AL    @14,@CF01522                                        0947 02423000
         CLC   FRAMECPU-4(5,@14),ZERO1                             0947 02424000
         BNE   @RF00947                                            0947 02425000
*        DO;                                               /*@G51DGGB*/ 02426000
*          FRAMECPU(T) = LRTCPMOD;                         /*@G51DGGB*/ 02427000
         LR    @14,@08                                             0949 02428000
         AL    @14,@TF00001                                        0949 02429000
         AL    @14,@CF01522                                        0949 02430000
         MVC   FRAMECPU-4(5,@14),LRTCPMOD(R7)                      0949 02431000
*          FRAMENUM = FRAMENUM + 1;                        /*@G51DGGB*/ 02432000
         LA    @14,1                                               0950 02433000
         AL    @14,FRAMENUM(,@08)                                  0950 02434000
         ST    @14,FRAMENUM(,@08)                                  0950 02435000
*          LOOPOUT= YES;   /*HAVE A MATCH SO EXIT            @G51DGGB*/ 02436000
         OI    LOOPOUT,B'00010000'                                 0951 02437000
*        END;                                              /*@G51DGGB*/ 02438000
*      ELSE                                                        0953 02439000
*        IF T = EVMAX THEN /*UNIQUE ENTRY BUT NOT ROOM IN TABLE*/  0953 02440000
         B     @RC00947                                            0953 02441000
@RF00947 CLC   T(4),@CF00088                                       0953 02442000
         BNE   @RF00953                                            0953 02443000
*          DO;                                             /*@G51DGGB*/ 02444000
*            IF ONETIME = NO THEN   /*ISSUE MESSAGE ONLY ONCE*/    0955 02445000
         TM    ONETIME,B'10000000'                                 0955 02446000
         BNZ   @RF00955                                            0955 02447000
*              DO;                                         /*@G51DGGB*/ 02448000
*                MSGNO = YY;/*SET FLAG FOR OBTAINING THE MESSAGE*/ 0957 02449000
         MVI   MSGNO,X'05'                                         0957 02450000
*                CALL ERRMSG; /*GO OBTAIN THE MESSAGE AND PRINT IT*/    02451000
         BAL   @14,ERRMSG                                          0958 02452000
*                ONETIME = YES;/*SET SO AS TO NOT RETURN     @G51DGGB*/ 02453000
         OI    ONETIME,B'10000000'                                 0959 02454000
*              END;                                        /*@G51DGGB*/ 02455000
*          END;                                            /*@G51DGGB*/ 02456000
@RF00955 DS    0H                                                  0962 02457000
*    END;                                                  /*@G51DGGB*/ 02458000
@RF00953 DS    0H                                                  0962 02459000
@RC00947 DS    0H                                                  0963 02460000
* END;                                                     /*@G51DGGB*/ 02461000
@RC00944 LA    @14,1                                               0963 02462000
         AL    @14,T                                               0963 02463000
         ST    @14,T                                               0963 02464000
         C     @14,@CF00088                                        0963 02465000
         BNH   @DL00943                                            0963 02466000
@DC00943 DS    0H                                                  0964 02467000
*END; /*END OF PROC BUILDFTB                                 @G51DGGB*/ 02468000
@EL00026 DS    0H                                                  0964 02469000
@EF00026 DS    0H                                                  0964 02470000
@ER00026 LM    @14,@12,@SA00026                                    0964 02471000
         BR    @14                                                 0964 02472000
*FRAMEREP: PROC; /*REPLACE FRAME IF MORE CURRENT FRAME FOUND @G51DGGB*/ 02473000
FRAMEREP STM   @14,@12,@SA00027                                    0965 02474000
*                /*COMPLETE ENTRY IF NO DATE ETC.            @G51DGGB*/ 02475000
*                /*APPEND LOCATION OF FRAME EXTERNAL LOCATION LIST*/    02476000
*GETOUT = NO;                                              /*@G51DGGB*/ 02477000
         NI    GETOUT,B'11111101'                                  0966 02478000
*DO X = 1 BY 1 TO FRAMENUM WHILE GETOUT = NO; /*LOOP THROUGH ALL SET*/  02479000
         LA    @14,1                                               0967 02480000
         ST    @14,X                                               0967 02481000
         B     @DE00967                                            0967 02482000
@DL00967 TM    GETOUT,B'00000010'                                  0967 02483000
         BNZ   @DC00967                                            0967 02484000
*                                             /*ENTRIES OF FRAMETAB */  02485000
*  IF FRAMECPU(X) = LRTCPMOD THEN             /*IF RECORD CPU MODEL */  02486000
         LA    @08,24                                              0968 02487000
         LR    @01,@14                                             0968 02488000
         MR    @00,@08                                             0968 02489000
         L     @06,FRAMEPTR(,R2)                                   0968 02490000
         ST    @01,@TF00001                                        0968 02491000
         ALR   @01,@06                                             0968 02492000
         AL    @01,@CF01522                                        0968 02493000
         CLC   FRAMECPU-4(5,@01),LRTCPMOD(R7)                      0968 02494000
         BNE   @RF00968                                            0968 02495000
*    DO;                                      /*SERIAL MATCHES THOSE*/  02496000
*      CCHINDX = X;  /*SAVE INDEX*/           /*OF THE ENTRY @G51DGGB*/ 02497000
         ST    @14,CCHINDX                                         0970 02498000
*      IF FRAMEDT(X) < LRTDT THEN             /*IF REC DATE GREATER */  02499000
         LR    @14,@06                                             0971 02500000
         AL    @14,@TF00001                                        0971 02501000
         AL    @14,@CF01539                                        0971 02502000
         CLC   FRAMEDT-9(8,@14),LRTDT(R7)                          0971 02503000
         BNL   @RF00971                                            0971 02504000
*        DO;                                  /*THAN ENTRY DATE     */  02505000
*         IF DEBUG16 = ON & FRAMEDT(Q) ^= '0000000000000000'X THEN 0973 02506000
         TM    DEBUG16(R2),B'10000000'                             0973 02507000
         BNO   @RF00973                                            0973 02508000
         LR    @01,@08                                             0973 02509000
         M     @00,Q                                               0973 02510000
         ALR   @06,@01                                             0973 02511000
         AL    @06,@CF01539                                        0973 02512000
         CLC   FRAMEDT-9(8,@06),@CB01424                           0973 02513000
         BE    @RF00973                                            0973 02514000
*         /* DEBUG SWITCH ON AND IT IS THE FIRST TIME DONT ISSUE MES*/  02515000
*          CALL FRAMMORE; /*GO ISSUE THE FRAME REPLACED MESSAGE*/  0974 02516000
         BAL   @14,FRAMMORE                                        0974 02517000
*         ELSE                                                     0975 02518000
*          DO;                                             /*@G51DGGB*/ 02519000
         B     @RC00973                                            0975 02520000
@RF00973 DS    0H                                                  0976 02521000
*           CALL FIXENTRY;     /*SET UP TO ADD THE FRAMES TO THE TABLE* 02522000
         BAL   @14,FIXENTRY                                        0976 02523000
*           FRAMEDT(X) = LRTDT; /*SAVE THE DATE OF THIS FRAME*/    0977 02524000
         L     @14,X                                               0977 02525000
         MH    @14,@CH00227                                        0977 02526000
         L     @08,FRAMEPTR(,R2)                                   0977 02527000
         ALR   @08,@14                                             0977 02528000
         AL    @08,@CF01539                                        0977 02529000
         MVC   FRAMEDT-9(8,@08),LRTDT(R7)                          0977 02530000
*          END;                                            /*@G51DGGB*/ 02531000
*              CALL BUILDTTR;                /*SAVE FRAME LOCATION*/    02532000
@RC00973 BAL   @14,BUILDTTR                                        0979 02533000
*               FRAMEYES = YES;/*SAVE SUCCEEDING FRAMES OF THIS    */   02534000
         OI    FRAMEYES,B'00000100'                                0980 02535000
*                              /*LOGICAL SET                 @G51DGGB*/ 02536000
*         END;                                             /*@G51DGGB*/ 02537000
*       ELSE  /*IMPLIES DATE IS LOW OR EQUAL                 @G51DGGB*/ 02538000
*        DO;                                               /*@G51DGGB*/ 02539000
         B     @RC00971                                            0982 02540000
@RF00971 DS    0H                                                  0983 02541000
*         IF FRAMEDT(X) = LRTDT THEN /*IF TABLE DATE EQUALS RECORD DAT* 02542000
         L     @14,X                                               0983 02543000
         MH    @14,@CH00227                                        0983 02544000
         L     @08,FRAMEPTR(,R2)                                   0983 02545000
         ST    @14,@TF00001                                        0983 02546000
         ALR   @14,@08                                             0983 02547000
         AL    @14,@CF01539                                        0983 02548000
         CLC   FRAMEDT-9(8,@14),LRTDT(R7)                          0983 02549000
         BNE   @RF00983                                            0983 02550000
*           DO;                                            /*@G51DGGB*/ 02551000
*            IF FRAMETYP(X) ^= ALLALL THEN                         0985 02552000
         AL    @08,@TF00001                                        0985 02553000
         AL    @08,@CF01524                                        0985 02554000
         CLI   FRAMETYP-17(@08),X'FF'                              0985 02555000
         BE    @RF00985                                            0985 02556000
*             DO;                                          /*@G51DGGB*/ 02557000
*                      CALL FIXENTRY; /*DELETE INCOMPLETE SET       */  02558000
         BAL   @14,FIXENTRY                                        0987 02559000
*                      MSGNO = QQ1;/*ISSUE FRAME SET INCOMPLETE MESS*/  02560000
         MVI   MSGNO,X'0A'                                         0988 02561000
*                      CALL ERRMSG;                        /*@G51DGGB*/ 02562000
         BAL   @14,ERRMSG                                          0989 02563000
*                      CALL BUILDTTR; /*SAVE THIS FRAME      @G51DGGB*/ 02564000
         BAL   @14,BUILDTTR                                        0990 02565000
*                      FRAMEYES = YES; /*SAVE SUCCEEDING MEMBERS */     02566000
         OI    FRAMEYES,B'00000100'                                0991 02567000
*             END;                                         /*@G51DGGB*/ 02568000
*            ELSE  /*COMPLETE SET FOR THIS DATE ALREADY EXISTS      */  02569000
*               DO; /*FRAMETYP IS EQUAL TO ALLALL            @G51DGGB*/ 02570000
         B     @RC00985                                            0993 02571000
@RF00985 DS    0H                                                  0994 02572000
*                   FRAMEYES = NO;/*DELETE SUCCEEDING FRAMES OF SET */  02573000
         NI    FRAMEYES,B'11111011'                                0994 02574000
*                   BUG(37) = BUG(37) + 1; /*COUNT FRAME AS NOT USED*/  02575000
         LA    @14,1                                               0995 02576000
         AL    @14,BUG+144                                         0995 02577000
         ST    @14,BUG+144                                         0995 02578000
*               END;                                       /*@G51DGGB*/ 02579000
*        END; /*END OF CODE IF DATE IN RECORD EQUALS DATE IN TABLE*/    02580000
*       ELSE /*DATE IN TABLE GREATER THAN FRAME RECORD DATE  @G51DGGB*/ 02581000
*        BUG(37) = BUG(37)  + 1; /*INCREMENT # OF REJECTED FRAMES */    02582000
         B     @RC00983                                            0998 02583000
@RF00983 LA    @14,1                                               0998 02584000
         AL    @14,BUG+144                                         0998 02585000
         ST    @14,BUG+144                                         0998 02586000
*    END; /*END OF CODE IF DATE IN RECORD IS LOW OR EQUAL    @G51DGGB*/ 02587000
@RC00983 DS    0H                                                  1000 02588000
*  GETOUT = YES; /*GET OUT OF LOOP AFTER CPU MATCH           @G51DGGB*/ 02589000
@RC00971 OI    GETOUT,B'00000010'                                  1000 02590000
* END; /*END OF CODE FOR A RECORD TO ENTRY CPU MATCH         @G51DGGB*/ 02591000
*END; /*END OF FRAMETAB LOOP                                 @G51DGGB*/ 02592000
@RF00968 LA    @14,1                                               1002 02593000
         AL    @14,X                                               1002 02594000
         ST    @14,X                                               1002 02595000
@DE00967 L     @08,FRAMEPTR(,R2)                                   1002 02596000
         C     @14,FRAMENUM(,@08)                                  1002 02597000
         BNH   @DL00967                                            1002 02598000
@DC00967 DS    0H                                                  1003 02599000
*IF GETOUT = NO THEN /*MERIDIAN FRAME BUT NO ROOM IN TABLE   @G51DGGB*/ 02600000
         TM    GETOUT,B'00000010'                                  1003 02601000
         BNZ   @RF01003                                            1003 02602000
*  BUG(45) = BUG(45) + 1;                                  /*@G51DGGB*/ 02603000
         LA    @14,1                                               1004 02604000
         AL    @14,BUG+176                                         1004 02605000
         ST    @14,BUG+176                                         1004 02606000
*END; /*END OF PROC FRAMEREP                                 @G51DGGB*/ 02607000
@EL00027 DS    0H                                                  1005 02608000
@EF00027 DS    0H                                                  1005 02609000
@ER00027 LM    @14,@12,@SA00027                                    1005 02610000
         BR    @14                                                 1005 02611000
*BUILDTTR: PROC; /*SAVE LOCATION OF A FRAME IN LISTLOC       @G51DGGB*/ 02612000
BUILDTTR STM   @14,@12,@SA00028                                    1006 02613000
*DCL TEMPSTOR FIXED(31) INIT(0);  /*FOR STORING THE ADDRESS OF CORE*/   02614000
*DCL G FIXED(31) INIT(0);                                  /*@G51DGGB*/ 02615000
*RESPECIFY (R15) RESTRICTED;                               /*@G51DGGB*/ 02616000
*IF (LRTKEY1 & GENREC) = HEXA0 THEN /* IF MCH FRAME          @G51DGGB*/ 02617000
         MVC   @TS00001(1),LRTKEY1(R7)                             1010 02618000
         NI    @TS00001,X'F0'                                      1010 02619000
         CLI   @TS00001,X'A0'                                      1010 02620000
         BNE   @RF01010                                            1010 02621000
*  DO;                                                     /*@G51DGGB*/ 02622000
*    IF FRAMLOCM(CCHINDX) = ZERO THEN /*IF LISTLOC CORE FOR A CPU*/     02623000
         L     @14,CCHINDX                                         1012 02624000
         MH    @14,@CH00227                                        1012 02625000
         L     @08,FRAMEPTR(,R2)                                   1012 02626000
         AL    @08,@CF01533                                        1012 02627000
         L     @14,FRAMLOCM-20(@14,@08)                            1012 02628000
         LTR   @14,@14                                             1012 02629000
         BNZ   @RF01012                                            1012 02630000
*      DO;                            /*IS UNALLOCATED       @G51DGGB*/ 02631000
*       RESPECIFY (R0,R1) RESTRICTED;                      /*@G51DGGB*/ 02632000
*        R0 = LISTBENT * LISTMAX * 2; /*ALLOCATE CORE FOR BOTH CCH*/    02633000
         LA    R0,500                                              1015 02634000
*        R0 = R0 + 12;                /*AND MCH FRAME LOCATIONS   */    02635000
         AL    R0,@CF00032                                         1016 02636000
*        GEN(GETMAIN EC,LV=(0),A=TEMPSTOR,SP=21);          /*@G51DGGB*/ 02637000
         GETMAIN EC,LV=(0),A=TEMPSTOR,SP=21                             02638000
*        IF R15 = SUCCESS THEN                                     1018 02639000
         LTR   R15,R15                                             1018 02640000
         BNZ   @RF01018                                            1018 02641000
*          DO;                                             /*@G51DGGB*/ 02642000
*            BUG(42) = BUG(42) + 1;                        /*@G51DGGB*/ 02643000
         LA    @14,1                                               1020 02644000
         AL    @14,BUG+164                                         1020 02645000
         ST    @14,BUG+164                                         1020 02646000
*            R1 = TEMPSTOR;                                /*@G51DGGB*/ 02647000
         L     R1,TEMPSTOR                                         1021 02648000
*            FRAMLOCM(CCHINDX) = R1;  /*SET POINTERS TO LISTLOC   */    02649000
         L     @14,CCHINDX                                         1022 02650000
         MH    @14,@CH00227                                        1022 02651000
         L     @08,FRAMEPTR(,R2)                                   1022 02652000
         AL    @08,@CF01533                                        1022 02653000
         ST    R1,FRAMLOCM-20(@14,@08)                             1022 02654000
*            R1 = R1+LISTBENT *       /*TABLES FOR BOTH CCL AND MCH*/   02655000
*                LISTMAX+4;           /*FRAMES               @G51DGGB*/ 02656000
         AL    R1,@CF01510                                         1023 02657000
*            R0 = ZERO;          /*ENSURE THAT TABLE ON WORD BOUNDARY*/ 02658000
         SLR   R0,R0                                               1024 02659000
*            RESPECIFY (R4) RESTRICTED;                    /*@G51DGGB*/ 02660000
*            R4 = 4;             /*DIVIDE BY NUMBER OF BYTES IN WORD*/  02661000
         LA    R4,4                                                1026 02662000
*            GEN(DR R0,R4);                                /*@G51DGGB*/ 02663000
         DR R0,R4                                                       02664000
*            RESPECIFY (R4) UNRESTRICTED;                  /*@G51DGGB*/ 02665000
*            IF R0 > ZERO THEN /*REMAINDER MEANS NOT INTEGRAL NUMBER*/  02666000
         LTR   R0,R0                                               1029 02667000
         BNP   @RF01029                                            1029 02668000
*                              /*NUMBER OF DOUBLEWORDS.      @G51DGGB*/ 02669000
*              R1 = R1 + 1; /*ADD ONE EXTRA FULL WORD        @G51DGGB*/ 02670000
         AL    R1,@CF00055                                         1030 02671000
*            R1 = R1 * FOUR; /*RESET ONE TO NUMBER OF BYTES  @G51DGGB*/ 02672000
@RF01029 SLL   R1,2                                                1031 02673000
*            FRAMLOCC(CCHINDX) = R1; /*SET POINTER TO CCH CCHHR TABLE*/ 02674000
         L     @14,CCHINDX                                         1032 02675000
         MH    @14,@CH00227                                        1032 02676000
         L     @08,FRAMEPTR(,R2)                                   1032 02677000
         ST    R1,FRAMLOCC-24(@14,@08)                             1032 02678000
*            LISTPTR = R1;      /*ESTABLISH ADDRESSABILITY FOR CCH TB*/ 02679000
         ST    R1,LISTPTR                                          1033 02680000
*            LISTNUM = ZERO;    /*ZERO CCH LISTLOC TABLE     @G51DGGB*/ 02681000
         L     @14,LISTPTR                                         1034 02682000
         SLR   @08,@08                                             1034 02683000
         ST    @08,LISTNUM(,@14)                                   1034 02684000
*            DO G = 1 BY 1 TO LISTMAX;                     /*@G51DGGB*/ 02685000
         LA    @14,1                                               1035 02686000
         ST    @14,G                                               1035 02687000
@DL01035 DS    0H                                                  1036 02688000
*              LISTCCHR(G) = LISTCCHR(G) &&                        1036 02689000
*                            LISTCCHR(G);                  /*@G51DGGB*/ 02690000
         LR    @08,@14                                             1036 02691000
         MH    @08,@CH00079                                        1036 02692000
         L     @06,LISTPTR                                         1036 02693000
         ALR   @06,@08                                             1036 02694000
         BCTR  @06,0                                               1036 02695000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1036 02696000
*            END;                                          /*@G51DGGB*/ 02697000
         AL    @14,@CF00055                                        1037 02698000
         ST    @14,G                                               1037 02699000
         C     @14,@CF00293                                        1037 02700000
         BNH   @DL01035                                            1037 02701000
*            LISTPTR = FRAMLOCM(CCHINDX); /*ADDRESS OF MCH LISTLOC */   02702000
         L     @14,CCHINDX                                         1038 02703000
         MH    @14,@CH00227                                        1038 02704000
         L     @08,FRAMEPTR(,R2)                                   1038 02705000
         AL    @08,@CF01533                                        1038 02706000
         L     @14,FRAMLOCM-20(@14,@08)                            1038 02707000
         ST    @14,LISTPTR                                         1038 02708000
*            DO G = 1 BY 1 TO LISTMAX;   /* ZERO MCH LISTLOC TABLE  */  02709000
         LA    @14,1                                               1039 02710000
         ST    @14,G                                               1039 02711000
@DL01039 DS    0H                                                  1040 02712000
*            LISTCCHR(G) = LISTCCHR(G) &&                          1040 02713000
*                          LISTCCHR(G);                    /*@G51DGGB*/ 02714000
         LR    @08,@14                                             1040 02715000
         MH    @08,@CH00079                                        1040 02716000
         L     @06,LISTPTR                                         1040 02717000
         ALR   @06,@08                                             1040 02718000
         BCTR  @06,0                                               1040 02719000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1040 02720000
*            END;                                          /*@G51DGGB*/ 02721000
         AL    @14,@CF00055                                        1041 02722000
         ST    @14,G                                               1041 02723000
         C     @14,@CF00293                                        1041 02724000
         BNH   @DL01039                                            1041 02725000
*            LISTNUM = ZERO;                               /*@G51DGGB*/ 02726000
         L     @14,LISTPTR                                         1042 02727000
         SLR   @08,@08                                             1042 02728000
         ST    @08,LISTNUM(,@14)                                   1042 02729000
*          END;                                            /*@G51DGGB*/ 02730000
*        ELSE /*UNSUCCESSFUL GETMAIN                         @G51DGGB*/ 02731000
*          DO;                                             /*@G51DGGB*/ 02732000
         B     @RC01018                                            1044 02733000
@RF01018 DS    0H                                                  1045 02734000
*            MSGNO = XX;   /*TELL MESSAGE PROC WHICH ERROR MESSAGE*/    02735000
         MVI   MSGNO,X'08'                                         1045 02736000
*            CALL ERRMSG;  /*GO OBTAIN THE MESSAGE AND PRINTIT*/   1046 02737000
         BAL   @14,ERRMSG                                          1046 02738000
*            R15 = TWELVE; /*SET ERROR CODE FOR EXIT         @G51DGGB*/ 02739000
         LA    R15,12                                              1047 02740000
*            ERROR = R15;                                  /*@G51DGGB*/ 02741000
         ST    R15,ERROR                                           1048 02742000
*          END;                                            /*@G51DGGB*/ 02743000
*       RESPECIFY (R0,R1) UNRESTRICTED;                    /*@G51DGGB*/ 02744000
@RC01018 DS    0H                                                  1051 02745000
*      END;                                                /*@G51DGGB*/ 02746000
*    IF R15 = ZERO THEN /*IF GETMAIN WAS SUCCESSFUL OR NO GETMAIN*/     02747000
@RF01012 LTR   R15,R15                                             1052 02748000
         BNZ   @RF01052                                            1052 02749000
*      LISTPTR = FRAMLOCM(CCHINDX);/*ESTABLISH LISTLOC ADDRESS   */     02750000
         L     @14,CCHINDX                                         1053 02751000
         MH    @14,@CH00227                                        1053 02752000
         L     @08,FRAMEPTR(,R2)                                   1053 02753000
         AL    @08,@CF01533                                        1053 02754000
         L     @14,FRAMLOCM-20(@14,@08)                            1053 02755000
         ST    @14,LISTPTR                                         1053 02756000
*  END;                                                    /*@G51DGGB*/ 02757000
*ELSE /* IS A CCH FRAME                                      @G51DGGB*/ 02758000
*  IF R15 = ZERO THEN                                              1055 02759000
         B     @RC01010                                            1055 02760000
@RF01010 LTR   R15,R15                                             1055 02761000
         BNZ   @RF01055                                            1055 02762000
*    LISTPTR = FRAMLOCC(CCHINDX);  /*ESTABLISH CCH LISTLOC ADDRESS*/    02763000
         L     @14,CCHINDX                                         1056 02764000
         MH    @14,@CH00227                                        1056 02765000
         L     @08,FRAMEPTR(,R2)                                   1056 02766000
         L     @14,FRAMLOCC-24(@14,@08)                            1056 02767000
         ST    @14,LISTPTR                                         1056 02768000
*IF R15 = ZERO THEN  /*WAS THE I/O A SUCCESSFUL OPERATION    @G51DGGB*/ 02769000
@RF01055 DS    0H                                                  1057 02770000
@RC01010 LTR   R15,R15                                             1057 02771000
         BNZ   @RF01057                                            1057 02772000
*  DO;                                                     /*@G51DGGB*/ 02773000
*    IF LISTNUM + 1 <= LISTMAX THEN /*IF ROOM IN LISTLOC     @G51DGGB*/ 02774000
         LA    @14,1                                               1059 02775000
         L     @08,LISTPTR                                         1059 02776000
         AL    @14,LISTNUM(,@08)                                   1059 02777000
         C     @14,@CF00293                                        1059 02778000
         BH    @RF01059                                            1059 02779000
*      DO;                                                 /*@G51DGGB*/ 02780000
*        IF PHIST = ON THEN        /*IF HISTORY INPUT        @G51DGGB*/ 02781000
         TM    PHIST(R2),B'00100000'                               1061 02782000
         BNO   @RF01061                                            1061 02783000
*          CALL IOHND(RITESCRT);   /*WRITE TO SCRATCH DATA SET*/   1062 02784000
         L     @15,ADIOHND(,R2)                                    1062 02785000
         LA    @01,@AL01062                                        1062 02786000
         BALR  @14,@15                                             1062 02787000
*        IF R15 = SUCCESS THEN     /*IF SUCCESSFULL WRITE    @G51DGGB*/ 02788000
@RF01061 LTR   R15,R15                                             1063 02789000
         BNZ   @RF01063                                            1063 02790000
*          DO;                                             /*@G51DGGB*/ 02791000
*            LISTCCHR(LISTNUM+1) = RECCCHHR;/*SAVE FRAME EXTERNAL LOC*/ 02792000
         L     @14,LISTPTR                                         1065 02793000
         L     @08,LISTNUM(,@14)                                   1065 02794000
         LR    @06,@08                                             1065 02795000
         MH    @06,@CH00079                                        1065 02796000
         ALR   @06,@14                                             1065 02797000
         MVC   LISTCCHR(5,@06),RECCCHHR(R2)                        1065 02798000
*            LISTNUM = LISTNUM + 1; /*INCREMENT NO OF BUILT ENTRIES*/   02799000
         LA    @06,1                                               1066 02800000
         ALR   @08,@06                                             1066 02801000
         ST    @08,LISTNUM(,@14)                                   1066 02802000
*            BUG(36) = BUG(36) + 1;                        /*@G51DGGB*/ 02803000
         AL    @06,BUG+140                                         1067 02804000
         ST    @06,BUG+140                                         1067 02805000
*          END;                                            /*@G51DGGB*/ 02806000
*        ELSE  /*UNSUCCESSFUL WRITE TO SCRATCH D.S.          @G51DGGB*/ 02807000
*          R15 = TWELVE; /*TERMINATE FURTHER PROCESSING      @G51DGGB*/ 02808000
         B     @RC01063                                            1069 02809000
@RF01063 LA    R15,12                                              1069 02810000
*      END;                                                /*@G51DGGB*/ 02811000
*    ELSE     /*NO ROOM IN LISTLOC                           @G51DGGB*/ 02812000
*      DO;                                                 /*@G51DGGB*/ 02813000
         B     @RC01059                                            1071 02814000
@RF01059 DS    0H                                                  1072 02815000
*        MSGNO = PP;  /*MORE THAN 50 FRAMES                  @G51DGGB*/ 02816000
         MVI   MSGNO,X'06'                                         1072 02817000
*        CALL ERRMSG;                                      /*@G51DGGB*/ 02818000
         BAL   @14,ERRMSG                                          1073 02819000
*        R15 = TWELVE;                                     /*@G51DGGB*/ 02820000
         LA    R15,12                                              1074 02821000
*        ERROR = R15;                                      /*@G51DGGB*/ 02822000
         ST    R15,ERROR                                           1075 02823000
*      END;                                                /*@G51DGGB*/ 02824000
*  END;                                                    /*@G51DGGB*/ 02825000
*RESPECIFY (R0,R1,R15) UNRESTRICTED;                       /*@G51DGGB*/ 02826000
*END; /*END OF BUILDTTR PROC                                 @G51DGGB*/ 02827000
@EL00028 DS    0H                                                  1079 02828000
@EF00028 DS    0H                                                  1079 02829000
@ER00028 LM    @14,@12,@SA00028                                    1079 02830000
         BR    @14                                                 1079 02831000
*FIXENTRY: PROC;  /*RESET LISTLOC TABLE TO ZEROS BUT DONT FREE CORE*/   02832000
FIXENTRY STM   @14,@12,12(@13)                                     1080 02833000
*                 /*RESET DATE,TYPE TO ZEROS                 @G51DGGB*/ 02834000
*DCL T FIXED(31) INIT(0);                                  /*@G51DGGB*/ 02835000
*FRAMEDT(CCHINDX) = '0000000000000000'X; /*ZERO DATE,TIME    @G51DGGB*/ 02836000
         L     @08,CCHINDX                                         1082 02837000
         MH    @08,@CH00227                                        1082 02838000
         L     @06,FRAMEPTR(,R2)                                   1082 02839000
         ST    @08,@TF00001                                        1082 02840000
         ALR   @08,@06                                             1082 02841000
         AL    @08,@CF01539                                        1082 02842000
         MVC   FRAMEDT-9(8,@08),@CB01424                           1082 02843000
*FRAMETYP(CCHINDX) = '00'X; /*RESET TO NO TYPES OF FRAMES STORED*/ 1083 02844000
         LR    @08,@06                                             1083 02845000
         AL    @08,@TF00001                                        1083 02846000
         AL    @08,@CF01524                                        1083 02847000
         MVI   FRAMETYP-17(@08),X'00'                              1083 02848000
*IF FRAMLOCM(CCHINDX) > ZERO THEN /*IF MCH FRAME LOC. TAB. ALLOCATED*/  02849000
         L     @08,@TF00001                                        1084 02850000
         AL    @06,@CF01533                                        1084 02851000
         L     @08,FRAMLOCM-20(@08,@06)                            1084 02852000
         LTR   @08,@08                                             1084 02853000
         BNP   @RF01084                                            1084 02854000
*  DO;                                                     /*@G51DGGB*/ 02855000
*    LISTPTR = FRAMLOCM(CCHINDX); /*SET TABLE BASE ADDRESS   @G51DGGB*/ 02856000
         ST    @08,LISTPTR                                         1086 02857000
*    DO T = 1 BY 1 TO LISTNUM; /*CLEAR ALL STORED CCHHRS TO ZERO*/ 1087 02858000
         LA    @08,1                                               1087 02859000
         ST    @08,T                                               1087 02860000
         B     @DE01087                                            1087 02861000
@DL01087 DS    0H                                                  1088 02862000
*      LISTCCHR(T) = (LISTCCHR(T) && LISTCCHR(T));         /*@G51DGGB*/ 02863000
         LR    @06,@08                                             1088 02864000
         MH    @06,@CH00079                                        1088 02865000
         L     @03,LISTPTR                                         1088 02866000
         ALR   @03,@06                                             1088 02867000
         BCTR  @03,0                                               1088 02868000
         XC    LISTCCHR-4(5,@03),LISTCCHR-4(@03)                   1088 02869000
*      BUG(37) = BUG(37) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1089 02870000
         LA    @06,1                                               1089 02871000
         AL    @06,BUG+144                                         1089 02872000
         ST    @06,BUG+144                                         1089 02873000
*      BUG(36) = BUG(36) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRMES*/ 02874000
         L     @06,BUG+140                                         1090 02875000
         BCTR  @06,0                                               1090 02876000
         ST    @06,BUG+140                                         1090 02877000
*    END;                                                  /*@G51DGGB*/ 02878000
         AL    @08,@CF00055                                        1091 02879000
         ST    @08,T                                               1091 02880000
@DE01087 L     @06,LISTPTR                                         1091 02881000
         C     @08,LISTNUM(,@06)                                   1091 02882000
         BNH   @DL01087                                            1091 02883000
*    LISTNUM = ZERO; /*SET NUMBER OF STORED CCHHRS TO ZERO   @G51DGGB*/ 02884000
         L     @08,LISTPTR                                         1092 02885000
         SLR   @06,@06                                             1092 02886000
         ST    @06,LISTNUM(,@08)                                   1092 02887000
*   END;                                                   /*@G51DGGB*/ 02888000
*IF FRAMLOCC(CCHINDX) > ZERO THEN /*IF CCH FRAM LOC TABLE ALLOCATED*/   02889000
@RF01084 L     @08,CCHINDX                                         1094 02890000
         MH    @08,@CH00227                                        1094 02891000
         L     @06,FRAMEPTR(,R2)                                   1094 02892000
         L     @08,FRAMLOCC-24(@08,@06)                            1094 02893000
         LTR   @08,@08                                             1094 02894000
         BNP   @RF01094                                            1094 02895000
*  DO;                                                     /*@G51DGGB*/ 02896000
*    LISTPTR = FRAMLOCC(CCHINDX); /*SET BASE ADDRESS OF LISTLOC*/  1096 02897000
         ST    @08,LISTPTR                                         1096 02898000
*    DO T = 1 BY 1 TO LISTNUM; /*ZERO ALL SAVED CCHHRS       @G51DGGB*/ 02899000
         LA    @08,1                                               1097 02900000
         ST    @08,T                                               1097 02901000
         B     @DE01097                                            1097 02902000
@DL01097 DS    0H                                                  1098 02903000
*      LISTCCHR(T) = (LISTCCHR(T) && LISTCCHR(T));         /*@G51DGGB*/ 02904000
         LR    @06,@08                                             1098 02905000
         MH    @06,@CH00079                                        1098 02906000
         L     @03,LISTPTR                                         1098 02907000
         ALR   @03,@06                                             1098 02908000
         BCTR  @03,0                                               1098 02909000
         XC    LISTCCHR-4(5,@03),LISTCCHR-4(@03)                   1098 02910000
*      BUG(37) = BUG(37) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1099 02911000
         LA    @06,1                                               1099 02912000
         AL    @06,BUG+144                                         1099 02913000
         ST    @06,BUG+144                                         1099 02914000
*      BUG(36) = BUG(36) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRMES*/ 02915000
         L     @06,BUG+140                                         1100 02916000
         BCTR  @06,0                                               1100 02917000
         ST    @06,BUG+140                                         1100 02918000
*    END;                                                  /*@G51DGGB*/ 02919000
         AL    @08,@CF00055                                        1101 02920000
         ST    @08,T                                               1101 02921000
@DE01097 L     @06,LISTPTR                                         1101 02922000
         C     @08,LISTNUM(,@06)                                   1101 02923000
         BNH   @DL01097                                            1101 02924000
*    LISTNUM = ZERO; /*SET NUMBER OF  CCHHRS SAVED TO ZERO   @G51DGGB*/ 02925000
         L     @08,LISTPTR                                         1102 02926000
         SLR   @06,@06                                             1102 02927000
         ST    @06,LISTNUM(,@08)                                   1102 02928000
*  END;                                                    /*@G51DGGB*/ 02929000
*END;                                                      /*@G51DGGB*/ 02930000
@EL00029 DS    0H                                                  1104 02931000
@EF00029 DS    0H                                                  1104 02932000
@ER00029 LM    @14,@12,12(@13)                                     1104 02933000
         BR    @14                                                 1104 02934000
*DEVSEL: PROC;                                             /*@Z427VLS*/ 02935000
DEVSEL   STM   @14,@12,12(@13)                                     1105 02936000
*IF WORKTYPE = HEX90 THEN                                          1106 02937000
         CLI   WORKTYPE,X'90'                                      1106 02938000
         BNE   @RF01106                                            1106 02939000
*  DO;                                                     /*@Z427VLS*/ 02940000
*    IF DEVEXCL = ON THEN                                          1108 02941000
         TM    DEVEXCL(R2),B'00100000'                             1108 02942000
         BNO   @RF01108                                            1108 02943000
*      DO;                                                 /*@Z427VLS*/ 02944000
*        DEVOK = YES;                                      /*@Z427VLS*/ 02945000
         OI    DEVOK,B'00100000'                                   1110 02946000
*        DO J = 1 BY 1 TO MDRNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 02947000
         LA    @08,1                                               1111 02948000
         ST    @08,J                                               1111 02949000
         B     @DE01111                                            1111 02950000
@DL01111 TM    DEVOK,B'00100000'                                   1111 02951000
         BNO   @DC01111                                            1111 02952000
*        IF TPRDEV = MDRVAL(J) THEN                                1112 02953000
         L     @06,DEVPTR(,R2)                                     1112 02954000
         ALR   @06,@08                                             1112 02955000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          1112 02956000
         BNE   @RF01112                                            1112 02957000
*          DO;                                             /*@Z427VLS*/ 02958000
*            DEVOK = NO;                                   /*@Z427VLS*/ 02959000
         NI    DEVOK,B'11011111'                                   1114 02960000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 02961000
         NI    PASSFLAG(R2),B'11111110'                            1115 02962000
*          END;                                            /*@Z427VLS*/ 02963000
*        END;                                              /*@Z427VLS*/ 02964000
@RF01112 LA    @08,1                                               1117 02965000
         AL    @08,J                                               1117 02966000
         ST    @08,J                                               1117 02967000
@DE01111 L     @06,DEVPTR(,R2)                                     1117 02968000
         CH    @08,MDRNUM(,@06)                                    1117 02969000
         BNH   @DL01111                                            1117 02970000
@DC01111 DS    0H                                                  1118 02971000
*      END;                                                /*@Z427VLS*/ 02972000
*    ELSE                                                          1119 02973000
*      DO;                                                 /*@Z427VLS*/ 02974000
         B     @RC01108                                            1119 02975000
@RF01108 DS    0H                                                  1120 02976000
*        DEVOK = NO;                                       /*@Z427VLS*/ 02977000
         NI    DEVOK,B'11011111'                                   1120 02978000
*        DO J = 1 BY 1 TO MDRNUM WHILE DEVOK = NO;         /*@Z427VLS*/ 02979000
         LA    @08,1                                               1121 02980000
         ST    @08,J                                               1121 02981000
         B     @DE01121                                            1121 02982000
@DL01121 TM    DEVOK,B'00100000'                                   1121 02983000
         BNZ   @DC01121                                            1121 02984000
*        IF TPRDEV = MDRVAL(J) THEN                                1122 02985000
         L     @06,DEVPTR(,R2)                                     1122 02986000
         ALR   @06,@08                                             1122 02987000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          1122 02988000
         BNE   @RF01122                                            1122 02989000
*          DEVOK = YES;                                    /*@Z427VLS*/ 02990000
         OI    DEVOK,B'00100000'                                   1123 02991000
*        END;                                              /*@Z427VLS*/ 02992000
@RF01122 LA    @08,1                                               1124 02993000
         AL    @08,J                                               1124 02994000
         ST    @08,J                                               1124 02995000
@DE01121 L     @06,DEVPTR(,R2)                                     1124 02996000
         CH    @08,MDRNUM(,@06)                                    1124 02997000
         BNH   @DL01121                                            1124 02998000
@DC01121 DS    0H                                                  1125 02999000
*        IF DEVOK = NO THEN                                        1125 03000000
         TM    DEVOK,B'00100000'                                   1125 03001000
         BNZ   @RF01125                                            1125 03002000
*          PASSFLAG = NO;                                  /*@Z427VLS*/ 03003000
         NI    PASSFLAG(R2),B'11111110'                            1126 03004000
*       END;                                               /*@Z427VLS*/ 03005000
*    END;                                                  /*@Z427VLS*/ 03006000
*  ELSE                                                            1129 03007000
*    IF DEVEXCL = ON THEN                                          1129 03008000
         B     @RC01106                                            1129 03009000
@RF01106 TM    DEVEXCL(R2),B'00100000'                             1129 03010000
         BNO   @RF01129                                            1129 03011000
*      DO;                                                 /*@Z427VLS*/ 03012000
*        DEVOK = YES;                                      /*@Z427VLS*/ 03013000
         OI    DEVOK,B'00100000'                                   1131 03014000
*        DO J = 1 BY 1 TO DEVNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 03015000
         LA    @08,1                                               1132 03016000
         ST    @08,J                                               1132 03017000
         B     @DE01132                                            1132 03018000
@DL01132 TM    DEVOK,B'00100000'                                   1132 03019000
         BNO   @DC01132                                            1132 03020000
*          IF WORKDEV = DEVVAL(J) THEN                             1133 03021000
         ALR   @08,@08                                             1133 03022000
         L     @06,DEVPTR(,R2)                                     1133 03023000
         ALR   @06,@08                                             1133 03024000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            1133 03025000
         BNE   @RF01133                                            1133 03026000
*            DO;                                           /*@Z427VLS*/ 03027000
*              DEVOK = NO;                                 /*@Z427VLS*/ 03028000
         NI    DEVOK,B'11011111'                                   1135 03029000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 03030000
         NI    PASSFLAG(R2),B'11111110'                            1136 03031000
*            END;                                          /*@Z427VLS*/ 03032000
*        END;                                              /*@Z427VLS*/ 03033000
@RF01133 LA    @08,1                                               1138 03034000
         AL    @08,J                                               1138 03035000
         ST    @08,J                                               1138 03036000
@DE01132 L     @06,DEVPTR(,R2)                                     1138 03037000
         CH    @08,DEVNUM(,@06)                                    1138 03038000
         BNH   @DL01132                                            1138 03039000
@DC01132 DS    0H                                                  1139 03040000
*      END;                                                /*@Z427VLS*/ 03041000
*  ELSE                                                            1140 03042000
*   DO;                                                    /*@Z427VLS*/ 03043000
         B     @RC01129                                            1140 03044000
@RF01129 DS    0H                                                  1141 03045000
*     DEVOK = NO;                                          /*@Z427VLS*/ 03046000
         NI    DEVOK,B'11011111'                                   1141 03047000
*     DO J =  1 BY 1 TO DEVNUM WHILE DEVOK = NO;           /*@Z427VLS*/ 03048000
         LA    @08,1                                               1142 03049000
         ST    @08,J                                               1142 03050000
         B     @DE01142                                            1142 03051000
@DL01142 TM    DEVOK,B'00100000'                                   1142 03052000
         BNZ   @DC01142                                            1142 03053000
*       IF WORKDEV = DEVVAL(J) THEN                                1143 03054000
         ALR   @08,@08                                             1143 03055000
         L     @06,DEVPTR(,R2)                                     1143 03056000
         ALR   @06,@08                                             1143 03057000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            1143 03058000
         BNE   @RF01143                                            1143 03059000
*         DEVOK = YES;                                     /*@Z427VLS*/ 03060000
         OI    DEVOK,B'00100000'                                   1144 03061000
*     END;                                                 /*@Z427VLS*/ 03062000
@RF01143 LA    @08,1                                               1145 03063000
         AL    @08,J                                               1145 03064000
         ST    @08,J                                               1145 03065000
@DE01142 L     @06,DEVPTR(,R2)                                     1145 03066000
         CH    @08,DEVNUM(,@06)                                    1145 03067000
         BNH   @DL01142                                            1145 03068000
@DC01142 DS    0H                                                  1146 03069000
*     IF DEVOK = NO THEN                                           1146 03070000
         TM    DEVOK,B'00100000'                                   1146 03071000
         BNZ   @RF01146                                            1146 03072000
*       PASSFLAG = OFF;                                    /*@Z427VLS*/ 03073000
         NI    PASSFLAG(R2),B'11111110'                            1147 03074000
*   END;                                                   /*@Z427VLS*/ 03075000
*END;                                                      /*@Z427VLS*/ 03076000
@EL00030 DS    0H                                                  1149 03077000
@EF00030 DS    0H                                                  1149 03078000
@ER00030 LM    @14,@12,12(@13)                                     1149 03079000
         BR    @14                                                 1149 03080000
*ERRMSG: PROC;                                             /*@Z427VLS*/ 03081000
ERRMSG   STM   @14,@12,@SA00031                                    1150 03082000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 03083000
         LA    @08,PRINTLIN                                        1151 03084000
         ST    @08,PRINTADR(,R2)                                   1151 03085000
*IF MSGNO = 1 THEN                                                 1152 03086000
         CLI   MSGNO,1                                             1152 03087000
         BNE   @RF01152                                            1152 03088000
* DO;                                                      /*@Z427VLS*/ 03089000
*   CALL IFCMSG(64,ADDR(PRINTBDY));                        /*@Z427VLS*/ 03090000
         LA    @08,PRINTBDY                                        1154 03091000
         ST    @08,@AFTEMPS+4                                      1154 03092000
         L     @15,ADIFCMSG(,R2)                                   1154 03093000
         LA    @01,@AL01154                                        1154 03094000
         BALR  @14,@15                                             1154 03095000
*   LINTXT1B = USERPGM;                                    /*@Z427VLS*/ 03096000
         MVC   LINTXT1B(8),USERPGM(R2)                             1155 03097000
* END;                                                     /*@Z427VLS*/ 03098000
*IF MSGNO = 2 THEN                                                 1157 03099000
@RF01152 CLI   MSGNO,2                                             1157 03100000
         BNE   @RF01157                                            1157 03101000
*  DO;                                                     /*@GZZDGVS*/ 03102000
*    ZEROALL=NO;  /* DONT RESET LOGREC HEADER OF ALL        @XA19728 */ 03103000
         NI    ZEROALL(R2),B'10111111'                             1159 03104000
*                 /* RECORDS NOT PROCESSED                  @XA19728 */ 03105000
*    CALL IFCMSG(55,ADDR(PRINTBDY));                     /* @Z427VLS */ 03106000
         LA    @08,PRINTBDY                                        1160 03107000
         ST    @08,@AFTEMPS+4                                      1160 03108000
         L     @15,ADIFCMSG(,R2)                                   1160 03109000
         LA    @01,@AL01160                                        1160 03110000
         BALR  @14,@15                                             1160 03111000
*  END;                                                    /*@GZZDGVS*/ 03112000
*IF MSGNO = 3 THEN                                                 1162 03113000
@RF01157 CLI   MSGNO,3                                             1162 03114000
         BNE   @RF01162                                            1162 03115000
* CALL IFCMSG(53,ADDR(PRINTBDY));                          /*@Z427VLS*/ 03116000
         LA    @08,PRINTBDY                                        1163 03117000
         ST    @08,@AFTEMPS+4                                      1163 03118000
         L     @15,ADIFCMSG(,R2)                                   1163 03119000
         LA    @01,@AL01163                                        1163 03120000
         BALR  @14,@15                                             1163 03121000
*NOMESAGE = OFF;           /*SET TO NORMALLY PRINT THE MESSAGE*/   1164 03122000
@RF01162 NI    NOMESAGE,B'11110111'                                1164 03123000
* IF MSGNO = QQ1 THEN      /*SCREW UP IN THE INCOMING FRAME #S*/   1165 03124000
         CLI   MSGNO,10                                            1165 03125000
         BNE   @RF01165                                            1165 03126000
*  DO;                                                     /*@G51DGGB*/ 03127000
*  IF DEBUG16 = ON THEN    /*WAS THE USER INTRESTED IN THE RESULT*/     03128000
         TM    DEBUG16(R2),B'10000000'                             1167 03129000
         BNO   @RF01167                                            1167 03130000
*   CALL FRAMDROP;                                         /*@G51DGGB*/ 03131000
         BAL   @14,FRAMDROP                                        1168 03132000
*  ELSE                                                            1169 03133000
*  NOMESAGE = ON;                                          /*@G51DGGB*/ 03134000
         B     @RC01167                                            1169 03135000
@RF01167 OI    NOMESAGE,B'00001000'                                1169 03136000
*  END;                                                    /*@G51DGGB*/ 03137000
@RC01167 DS    0H                                                  1171 03138000
* IF MSGNO = QQ  THEN                                              1171 03139000
@RF01165 CLI   MSGNO,7                                             1171 03140000
         BNE   @RF01171                                            1171 03141000
*  DO;                                                     /*@G51DGGB*/ 03142000
*  CALL IFCMSG(78,ADDR(PRINTBDY));                         /*@G51DGGB*/ 03143000
         LA    @08,PRINTBDY                                        1173 03144000
         ST    @08,@AFTEMPS+4                                      1173 03145000
         L     @15,ADIFCMSG(,R2)                                   1173 03146000
         LA    @01,@AL01173                                        1173 03147000
         BALR  @14,@15                                             1173 03148000
*   NUMBER = 3;                                            /*@G51DGGB*/ 03149000
         MVC   NUMBER(4),@CF00076                                  1174 03150000
*   ADDNXT = ADDR(PFRAMSER);  /*WHERE TO PUT THE CONVERTED BYTES*/ 1175 03151000
         LA    @08,PFRAMSER                                        1175 03152000
         ST    @08,ADDNXT                                          1175 03153000
*   NEXTBY = ADDR(FRAMESER(CCHINDX)); /*WHERE TO GET THE BYTES FROM*/   03154000
         L     @08,CCHINDX                                         1176 03155000
         MH    @08,@CH00227                                        1176 03156000
         L     @06,FRAMEPTR(,R2)                                   1176 03157000
         AL    @06,@CF01522                                        1176 03158000
         LA    @08,FRAMESER-4(@08,@06)                             1176 03159000
         ST    @08,NEXTBY                                          1176 03160000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03161000
         BAL   @14,CONVERT                                         1177 03162000
*   NUMBER = 2;                                            /*@G51DGGB*/ 03163000
         MVC   NUMBER(4),@CF00074                                  1178 03164000
*   ADDNXT = ADDR(PFRAMMOD);  /*DISPLACEMENT FOR THE MODEL   @G51DGGB*/ 03165000
         LA    @08,PFRAMMOD                                        1179 03166000
         ST    @08,ADDNXT                                          1179 03167000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX)); /*LOCATION OF MODEL    @G51DGGB*/ 03168000
         L     @08,CCHINDX                                         1180 03169000
         MH    @08,@CH00227                                        1180 03170000
         L     @06,FRAMEPTR(,R2)                                   1180 03171000
         AL    @06,@CF01542                                        1180 03172000
         LA    @08,FRAMEMOD-7(@08,@06)                             1180 03173000
         ST    @08,NEXTBY                                          1180 03174000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03175000
         BAL   @14,CONVERT                                         1181 03176000
*  END;                                                    /*@G51DGGB*/ 03177000
* IF MSGNO = ZZ THEN                                               1183 03178000
@RF01171 CLI   MSGNO,4                                             1183 03179000
         BNE   @RF01183                                            1183 03180000
*  CALL IFCMSG(40,ADDR(PRINTBDY));                         /*@G51DGGB*/ 03181000
         LA    @08,PRINTBDY                                        1184 03182000
         ST    @08,@AFTEMPS+4                                      1184 03183000
         L     @15,ADIFCMSG(,R2)                                   1184 03184000
         LA    @01,@AL01184                                        1184 03185000
         BALR  @14,@15                                             1184 03186000
* IF MSGNO = PP THEN                                               1185 03187000
@RF01183 CLI   MSGNO,6                                             1185 03188000
         BNE   @RF01185                                            1185 03189000
*  CALL IFCMSG(5,ADDR(PRINTBDY));                          /*@G51DGGB*/ 03190000
         LA    @08,PRINTBDY                                        1186 03191000
         ST    @08,@AFTEMPS+4                                      1186 03192000
         L     @15,ADIFCMSG(,R2)                                   1186 03193000
         LA    @01,@AL01186                                        1186 03194000
         BALR  @14,@15                                             1186 03195000
* IF MSGNO = XX THEN                                               1187 03196000
@RF01185 CLI   MSGNO,8                                             1187 03197000
         BNE   @RF01187                                            1187 03198000
*  CALL IFCMSG(40,ADDR(PRINTBDY));                         /*@G51DGGB*/ 03199000
         LA    @08,PRINTBDY                                        1188 03200000
         ST    @08,@AFTEMPS+4                                      1188 03201000
         L     @15,ADIFCMSG(,R2)                                   1188 03202000
         LA    @01,@AL01188                                        1188 03203000
         BALR  @14,@15                                             1188 03204000
*IF MSGNO = YY THEN                                                1189 03205000
@RF01187 CLI   MSGNO,5                                             1189 03206000
         BNE   @RF01189                                            1189 03207000
*  CALL IFCMSG(24,ADDR(PRINTBDY));                         /*@G51DGGB*/ 03208000
         LA    @08,PRINTBDY                                        1190 03209000
         ST    @08,@AFTEMPS+4                                      1190 03210000
         L     @15,ADIFCMSG(,R2)                                   1190 03211000
         LA    @01,@AL01190                                        1190 03212000
         BALR  @14,@15                                             1190 03213000
*IF MSGNO = RR THEN                                                1191 03214000
@RF01189 CLI   MSGNO,9                                             1191 03215000
         BNE   @RF01191                                            1191 03216000
*  CALL IFCMSG(5,ADDR(PRINTBDY));                          /*@G51DGGB*/ 03217000
         LA    @08,PRINTBDY                                        1192 03218000
         ST    @08,@AFTEMPS+4                                      1192 03219000
         L     @15,ADIFCMSG(,R2)                                   1192 03220000
         LA    @01,@AL01192                                        1192 03221000
         BALR  @14,@15                                             1192 03222000
* IF NOMESAGE = OFF THEN                                           1193 03223000
@RF01191 TM    NOMESAGE,B'00001000'                                1193 03224000
         BNZ   @RF01193                                            1193 03225000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 03226000
         L     @15,ADIOHND(,R2)                                    1194 03227000
         LA    @01,@AL01194                                        1194 03228000
         BALR  @14,@15                                             1194 03229000
*END;                                                      /*@Z427VLS*/ 03230000
@EL00031 DS    0H                                                  1195 03231000
@EF00031 DS    0H                                                  1195 03232000
@ER00031 LM    @14,@12,@SA00031                                    1195 03233000
         BR    @14                                                 1195 03234000
*/*******************************************************************/  03235000
*/*   IF A DEVICE OR CONTROL UNIT IS SHARED ACROSS MULTIPLE SYSTEMS,*/  03236000
*/*   AND THE USER WANTS ALL ERRORS WHICH RELATE TO ONE PHYSICAL    */  03237000
*/*   LOCATION SUMMED TOGETHER, THEN THE CUA IN THE SORT TABLE MAY  */  03238000
*/*   HAVE TO BE CONVERTED TO A BASE CUA.                    @Z427VLS*/ 03239000
*/*******************************************************************/  03240000
*SHARCONV: PROC;                                           /*@Z427VLS*/ 03241000
SHARCONV STM   @14,@12,12(@13)                                     1196 03242000
*      SHAREYES = NO;                                      /*@Z427VLS*/ 03243000
         NI    SHAREYES,B'11110111'                                1197 03244000
*      DO J = 1 BY 1 TO SHARENUM WHILE SHAREYES = NO;      /*@Z427VLS*/ 03245000
         LA    @08,1                                               1198 03246000
         ST    @08,J                                               1198 03247000
         B     @DE01198                                            1198 03248000
@DL01198 TM    SHAREYES,B'00001000'                                1198 03249000
         BNZ   @DC01198                                            1198 03250000
*        IF LRTCPUS = SHARSERA(J) THEN                             1199 03251000
         MH    @08,@CH00033                                        1199 03252000
         L     @06,SHAREPTR(,R2)                                   1199 03253000
         ST    @08,@TF00001                                        1199 03254000
         ALR   @08,@06                                             1199 03255000
         AL    @08,@CF01524                                        1199 03256000
         CLC   LRTCPUS(3,R7),SHARSERA-4(@08)                       1199 03257000
         BNE   @RF01199                                            1199 03258000
*          DO;                                             /*@Z427VLS*/ 03259000
*            IF SHAREDX(J) = ON THEN                               1201 03260000
         LR    @08,@06                                             1201 03261000
         AL    @08,@TF00001                                        1201 03262000
         AL    @08,@CF01543                                        1201 03263000
         TM    SHAREDX-2(@08),B'10000000'                          1201 03264000
         BNO   @RF01201                                            1201 03265000
*              DO;                                         /*@Z427VLS*/ 03266000
*                IF (SHARECUA(J) & CUXOFF) = (WORKMOD & NOUNIT2) THEN   03267000
         LR    @08,@06                                             1203 03268000
         AL    @08,@TF00001                                        1203 03269000
         AL    @08,@CF01543                                        1203 03270000
         MVC   @TS00001(2),SHARECUA-2(@08)                         1203 03271000
         NC    @TS00001(2),@CB01016                                1203 03272000
         MVC   @TS00001+2(2),WORKMOD                               1203 03273000
         NC    @TS00001+2(2),@CB01012                              1203 03274000
         CLC   @TS00001(2),@TS00001+2                              1203 03275000
         BNE   @RF01203                                            1203 03276000
*                  DO;                                     /*@Z427VLS*/ 03277000
*                    WORKMOD = (WORKMOD & UNITONLY);       /*@Z427VLS*/ 03278000
         NC    WORKMOD(2),@CB01037                                 1205 03279000
*                    WORKMOD = (WORKMOD | SHARECUB(J));    /*@Z427VLS*/ 03280000
         AL    @06,@TF00001                                        1206 03281000
         AL    @06,@CF01533                                        1206 03282000
         OC    WORKMOD(2),SHARECUB-7(@06)                          1206 03283000
*                    SHAREYES = ON;                        /*@Z427VLS*/ 03284000
         OI    SHAREYES,B'00001000'                                1207 03285000
*                  END;                                    /*@Z427VLS*/ 03286000
*              END;                                        /*@Z427VLS*/ 03287000
*         ELSE                                                     1210 03288000
*           DO;                                            /*@Z427VLS*/ 03289000
         B     @RC01201                                            1210 03290000
@RF01201 DS    0H                                                  1211 03291000
*             IF SHARECUA(J) = WORKMOD THEN                        1211 03292000
         L     @08,J                                               1211 03293000
         MH    @08,@CH00033                                        1211 03294000
         L     @06,SHAREPTR(,R2)                                   1211 03295000
         ST    @08,@TF00001                                        1211 03296000
         ALR   @08,@06                                             1211 03297000
         AL    @08,@CF01543                                        1211 03298000
         CLC   SHARECUA-2(2,@08),WORKMOD                           1211 03299000
         BNE   @RF01211                                            1211 03300000
*               DO;                                        /*@Z427VLS*/ 03301000
*                 WORKMOD = SHARECUB(J);                   /*@Z427VLS*/ 03302000
         AL    @06,@TF00001                                        1213 03303000
         AL    @06,@CF01533                                        1213 03304000
         MVC   WORKMOD(2),SHARECUB-7(@06)                          1213 03305000
*                 SHAREYES = ON;                           /*@Z427VLS*/ 03306000
         OI    SHAREYES,B'00001000'                                1214 03307000
*               END;                                       /*@Z427VLS*/ 03308000
*           END;                                           /*@Z427VLS*/ 03309000
@RF01211 DS    0H                                                  1217 03310000
*          END;                                            /*@Z427VLS*/ 03311000
@RC01201 DS    0H                                                  1218 03312000
*       END;                                               /*@Z427VLS*/ 03313000
@RF01199 LA    @08,1                                               1218 03314000
         AL    @08,J                                               1218 03315000
         ST    @08,J                                               1218 03316000
@DE01198 L     @06,SHAREPTR(,R2)                                   1218 03317000
         CH    @08,SHARENUM(,@06)                                  1218 03318000
         BNH   @DL01198                                            1218 03319000
@DC01198 DS    0H                                                  1219 03320000
*END; /*CLOSING END TO SHARCONV                              @Z427VLS*/ 03321000
@EL00032 DS    0H                                                  1219 03322000
@EF00032 DS    0H                                                  1219 03323000
@ER00032 LM    @14,@12,12(@13)                                     1219 03324000
         BR    @14                                                 1219 03325000
*LIBSEL: PROC;                                             /*@Z427VLS*/ 03326000
LIBSEL   STM   @14,@12,12(@13)                                     1220 03327000
*/*SELECT MDR RECORDS BY LINE INTERFACE BASE ADDRESS IF IT IS*/    1221 03328000
*/*APPLICABLE.                                               @Z427VLS*/ 03329000
*IF TPRMODE = LINSTAT0 | TPRMODE = LINSTAT1 THEN                   1221 03330000
         CLI   TPRMODE(R7),X'00'                                   1221 03331000
         BE    @RT01221                                            1221 03332000
         CLI   TPRMODE(R7),X'01'                                   1221 03333000
         BNE   @RF01221                                            1221 03334000
@RT01221 DS    0H                                                  1222 03335000
*  DO;                                                     /*@Z427VLS*/ 03336000
*    LIBOK = NO;                                           /*@Z427VLS*/ 03337000
         NI    LIBOK,B'11110111'                                   1223 03338000
*    DO J = 1 BY 1 TO LIBADNUM WHILE LIBOK = NO;           /*@Z427VLS*/ 03339000
         LA    @08,1                                               1224 03340000
         ST    @08,J                                               1224 03341000
         B     @DE01224                                            1224 03342000
@DL01224 TM    LIBOK,B'00001000'                                   1224 03343000
         BNZ   @DC01224                                            1224 03344000
*      IF LIBVAL(J) = TPRLINAD THEN LIBOK = YES;           /*@Z427VLS*/ 03345000
         ALR   @08,@08                                             1225 03346000
         L     @06,LIBADPTR(,R2)                                   1225 03347000
         ALR   @06,@08                                             1225 03348000
         CLC   LIBVAL-2(2,@06),TPRLINAD(R7)                        1225 03349000
         BNE   @RF01225                                            1225 03350000
         OI    LIBOK,B'00001000'                                   1226 03351000
*    END;                                                  /*@Z427VLS*/ 03352000
@RF01225 LA    @08,1                                               1227 03353000
         AL    @08,J                                               1227 03354000
         ST    @08,J                                               1227 03355000
@DE01224 L     @06,LIBADPTR(,R2)                                   1227 03356000
         CH    @08,LIBADNUM(,@06)                                  1227 03357000
         BNH   @DL01224                                            1227 03358000
@DC01224 DS    0H                                                  1228 03359000
*    IF LIBOK = NO THEN                                            1228 03360000
         TM    LIBOK,B'00001000'                                   1228 03361000
         BNZ   @RF01228                                            1228 03362000
*      PASSFLAG = NO;                                      /*@Z427VLS*/ 03363000
         NI    PASSFLAG(R2),B'11111110'                            1229 03364000
*  END;                                                    /*@Z427VLS*/ 03365000
*ELSE                                                              1231 03366000
*  PASSFLAG = NO;                                          /*@Z427VLS*/ 03367000
         B     @RC01221                                            1231 03368000
@RF01221 NI    PASSFLAG(R2),B'11111110'                            1231 03369000
*END;                                                      /*@Z427VLS*/ 03370000
@EL00033 DS    0H                                                  1232 03371000
@EF00033 DS    0H                                                  1232 03372000
@ER00033 LM    @14,@12,12(@13)                                     1232 03373000
         BR    @14                                                 1232 03374000
*BUGCNTS: PROC;                                            /*@Z427VLS*/ 03375000
BUGCNTS  STM   @14,@12,@SA00034                                    1233 03376000
*/*PRINT OUT COUNTS OF RECORDS PROCESSED IF DEBUG16 IS ON    @Z427VLS*/ 03377000
*PRINTADR = ADDR(PRINTLIN); /*ADDRESS OF PRINT LINE          @Z427VLS*/ 03378000
         LA    @08,PRINTLIN                                        1234 03379000
         ST    @08,PRINTADR(,R2)                                   1234 03380000
*J = 46;                                                   /*@G51DGGB*/ 03381000
         LA    @08,46                                              1235 03382000
         ST    @08,J                                               1235 03383000
*PRINTLIN = ERRLINE(J);/*THIS WILL MAKE IT COMPUTE THE CORRECT ADDR*/   03384000
         MVI   PRINTLIN+63,C' '                                    1236 03385000
         MVC   PRINTLIN+64(70),PRINTLIN+63                         1236 03386000
         MH    @08,@CH01512                                        1236 03387000
         LA    @06,ERRLINE-63(@08)                                 1236 03388000
         MVC   PRINTLIN(63),0(@06)                                 1236 03389000
*IF FRAMEPTR ^= 0 THEN                                             1237 03390000
         L     @08,FRAMEPTR(,R2)                                   1237 03391000
         LTR   @08,@08                                             1237 03392000
         BZ    @RF01237                                            1237 03393000
* BUG(43) = FRAMENUM;                                      /*@G51DGGB*/ 03394000
         L     @08,FRAMENUM(,@08)                                  1238 03395000
         ST    @08,BUG+168                                         1238 03396000
*BUG(37) = BUG(37) + BUG(45);                              /*@G51DGGB*/ 03397000
@RF01237 L     @08,BUG+144                                         1239 03398000
         AL    @08,BUG+176                                         1239 03399000
         ST    @08,BUG+144                                         1239 03400000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 03401000
*                                                                  1240 03402000
         L     @15,ADIOHND(,R2)                                    1240 03403000
         LA    @01,@AL01240                                        1240 03404000
         BALR  @14,@15                                             1240 03405000
*DO J = 1 BY 1 TO 45;                                      /*@G51DGGB*/ 03406000
         LA    @08,1                                               1241 03407000
         ST    @08,J                                               1241 03408000
@DL01241 DS    0H                                                  1242 03409000
*  NUMREC = BUG(J);                                        /*@Z427VLS*/ 03410000
         SLA   @08,2                                               1242 03411000
         L     @08,BUG-4(@08)                                      1242 03412000
         ST    @08,NUMREC                                          1242 03413000
*  CVD(NUMREC,PACKPAS);                                    /*@Z427VLS*/ 03414000
         CVD   @08,@TS00001                                        1243 03415000
         MVC   PACKPAS(4),@TS00001+4                               1243 03416000
*  PACKPAS = (PACKPAS | '0000000F'X);                      /*@Z427VLS*/ 03417000
         OC    PACKPAS(4),@CB01459                                 1244 03418000
*  UNPK(EDFLD,PACKPAS);                                    /*@Z427VLS*/ 03419000
         UNPK  EDFLD(9),PACKPAS(4)                                 1245 03420000
*  NONBLANK = OFF;                                         /*@Z427VLS*/ 03421000
         NI    NONBLANK,B'01111111'                                1246 03422000
*  DO K = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                /*@Z427VLS*/ 03423000
         LA    @08,1                                               1247 03424000
         ST    @08,K                                               1247 03425000
@DL01247 TM    NONBLANK,B'10000000'                                1247 03426000
         BNZ   @DC01247                                            1247 03427000
*    IF EDIFILD(K) = CHARZERO THEN                                 1248 03428000
         LA    @06,EDIFILD-1(@08)                                  1248 03429000
         CLI   0(@06),X'F0'                                        1248 03430000
         BNE   @RF01248                                            1248 03431000
*      EDIFILD(K) = BLANK;                                 /*@Z427VLS*/ 03432000
         LA    @06,EDIFILD-1(@08)                                  1249 03433000
         MVI   0(@06),X'40'                                        1249 03434000
*    ELSE                                                          1250 03435000
*      NONBLANK = ON;                                      /*@Z427VLS*/ 03436000
         B     @RC01248                                            1250 03437000
@RF01248 OI    NONBLANK,B'10000000'                                1250 03438000
*  END;                                                    /*@Z427VLS*/ 03439000
@RC01248 LA    @08,1                                               1251 03440000
         AL    @08,K                                               1251 03441000
         ST    @08,K                                               1251 03442000
         C     @08,@CF00066                                        1251 03443000
         BNH   @DL01247                                            1251 03444000
@DC01247 DS    0H                                                  1252 03445000
*  ERXNUM(J) = EDFLD;                                      /*@Z427VLS*/ 03446000
         L     @08,J                                               1252 03447000
         MH    @08,@CH01512                                        1252 03448000
         LA    @06,ERXNUM-63(@08)                                  1252 03449000
         MVC   0(9,@06),EDFLD                                      1252 03450000
*  PRINTLIN = ERRLINE(J);                                  /*@Z427VLS*/ 03451000
         MVI   PRINTLIN+63,C' '                                    1253 03452000
         MVC   PRINTLIN+64(70),PRINTLIN+63                         1253 03453000
         LA    @06,ERRLINE-63(@08)                                 1253 03454000
         MVC   PRINTLIN(63),0(@06)                                 1253 03455000
*  PRINTADR = ADDR(PRINTLIN);                              /*@Z427VLS*/ 03456000
         LA    @08,PRINTLIN                                        1254 03457000
         ST    @08,PRINTADR(,R2)                                   1254 03458000
*  CALL IOHND(RITEPRTR);                                   /*@Z427VLS*/ 03459000
         L     @15,ADIOHND(,R2)                                    1255 03460000
         LA    @01,@AL01255                                        1255 03461000
         BALR  @14,@15                                             1255 03462000
* END;                                                     /*@Z427VLS*/ 03463000
         LA    @08,1                                               1256 03464000
         AL    @08,J                                               1256 03465000
         ST    @08,J                                               1256 03466000
         C     @08,@CF01427                                        1256 03467000
         BNH   @DL01241                                            1256 03468000
*END; /*CLOSING END TO PROC BUGCNTS                          @Z427VLS*/ 03469000
@EL00034 DS    0H                                                  1257 03470000
@EF00034 DS    0H                                                  1257 03471000
@ER00034 LM    @14,@12,@SA00034                                    1257 03472000
         BR    @14                                                 1257 03473000
*FRAMDROP: PROC;                                           /*@G51DGGB*/ 03474000
FRAMDROP STM   @14,@12,@SA00035                                    1258 03475000
*  PRINTBDY = ERR7816;                                     /*@G51DGGB*/ 03476000
         MVI   PRINTBDY+18,C' '                                    1259 03477000
         MVC   PRINTBDY+19(113),PRINTBDY+18                        1259 03478000
         MVC   PRINTBDY(18),ERR7816                                1259 03479000
*  TYPERROR= INCOMP;                                       /*@G51DGGB*/ 03480000
         MVC   TYPERROR(10),INCOMP                                 1260 03481000
*   NUMBER = 3;                                            /*@G51DGGB*/ 03482000
         MVC   NUMBER(4),@CF00076                                  1261 03483000
*   ADDNXT = ADDR(ZFRAMSER);  /*WHERE TO PUT THE CONVERTED BYTES*/ 1262 03484000
         LA    @08,ZFRAMSER                                        1262 03485000
         ST    @08,ADDNXT                                          1262 03486000
*   NEXTBY = ADDR(FRAMESER(CCHINDX)); /*WHERE TO GET THE BYTES FROM*/   03487000
         L     @08,CCHINDX                                         1263 03488000
         MH    @08,@CH00227                                        1263 03489000
         L     @06,FRAMEPTR(,R2)                                   1263 03490000
         AL    @06,@CF01522                                        1263 03491000
         LA    @08,FRAMESER-4(@08,@06)                             1263 03492000
         ST    @08,NEXTBY                                          1263 03493000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03494000
         BAL   @14,CONVERT                                         1264 03495000
*   NUMBER = 2;                                            /*@G51DGGB*/ 03496000
         MVC   NUMBER(4),@CF00074                                  1265 03497000
*   ADDNXT = ADDR(ZFRAMMOD);  /*DISPLACEMENT FOR THE MODEL   @G51DGGB*/ 03498000
         LA    @08,ZFRAMMOD                                        1266 03499000
         ST    @08,ADDNXT                                          1266 03500000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX)); /*LOCATION OF MODEL    @G51DGGB*/ 03501000
         L     @08,CCHINDX                                         1267 03502000
         MH    @08,@CH00227                                        1267 03503000
         L     @06,FRAMEPTR(,R2)                                   1267 03504000
         AL    @06,@CF01542                                        1267 03505000
         LA    @08,FRAMEMOD-7(@08,@06)                             1267 03506000
         ST    @08,NEXTBY                                          1267 03507000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03508000
         BAL   @14,CONVERT                                         1268 03509000
*   NUMBER = 14;                                           /*@G51DGGB*/ 03510000
         MVC   NUMBER(4),@CF01353                                  1269 03511000
*   NEXTBY = ADDR(FRAMEKEY(CCHINDX));                      /*@G51DGGB*/ 03512000
         L     @08,CCHINDX                                         1270 03513000
         MH    @08,@CH00227                                        1270 03514000
         L     @06,FRAMEPTR(,R2)                                   1270 03515000
         AL    @06,@CF01522                                        1270 03516000
         LA    @08,FRAMEKEY-4(@08,@06)                             1270 03517000
         ST    @08,NEXTBY                                          1270 03518000
*   ADDNXT = ADDR(ZFRAMKEY);                               /*@G51DGGB*/ 03519000
         LA    @08,ZFRAMKEY                                        1271 03520000
         ST    @08,ADDNXT                                          1271 03521000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03522000
         BAL   @14,CONVERT                                         1272 03523000
*END;                                                      /*@G51DGGB*/ 03524000
@EL00035 DS    0H                                                  1273 03525000
@EF00035 DS    0H                                                  1273 03526000
@ER00035 LM    @14,@12,@SA00035                                    1273 03527000
         BR    @14                                                 1273 03528000
*FRAMMORE: PROC;                                           /*@G51DGGB*/ 03529000
FRAMMORE STM   @14,@12,@SA00036                                    1274 03530000
*  CALL FRAMDROP;                                          /*@G51DGGB*/ 03531000
         BAL   @14,FRAMDROP                                        1275 03532000
*  CALL FIXENTRY;                                          /*@G51DGGB*/ 03533000
         BAL   @14,FIXENTRY                                        1276 03534000
*  FRAMEDT(CCHINDX) = LRTDT;           /*SAVE HIGH DATE      @G51DGGB*/ 03535000
         L     @08,CCHINDX                                         1277 03536000
         MH    @08,@CH00227                                        1277 03537000
         L     @06,FRAMEPTR(,R2)                                   1277 03538000
         ST    @08,@TF00001                                        1277 03539000
         ALR   @08,@06                                             1277 03540000
         AL    @08,@CF01539                                        1277 03541000
         MVC   FRAMEDT-9(8,@08),LRTDT(R7)                          1277 03542000
*  TYPERROR= REPLACED;                                     /*@G51DGGB*/ 03543000
         MVI   TYPERROR+8,C' '                                     1278 03544000
         MVI   TYPERROR+9,C' '                                     1278 03545000
         MVC   TYPERROR(8),REPLACED                                1278 03546000
*   NUMBER = 3;                                            /*@G51DGGB*/ 03547000
         MVC   NUMBER(4),@CF00076                                  1279 03548000
*   ADDNXT = ADDR(YFRAMSER);  /*WHERE TO PUT THE CONVERTED BYTES*/ 1280 03549000
         LA    @08,YFRAMSER                                        1280 03550000
         ST    @08,ADDNXT                                          1280 03551000
*   NEXTBY = ADDR(FRAMESER(CCHINDX)); /*WHERE TO GET THE BYTES FROM*/   03552000
         L     @08,@TF00001                                        1281 03553000
         AL    @06,@CF01522                                        1281 03554000
         LA    @08,FRAMESER-4(@08,@06)                             1281 03555000
         ST    @08,NEXTBY                                          1281 03556000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03557000
         BAL   @14,CONVERT                                         1282 03558000
*   NUMBER = 2;                                            /*@G51DGGB*/ 03559000
         MVC   NUMBER(4),@CF00074                                  1283 03560000
*   ADDNXT = ADDR(YFRAMMOD);  /*DISPLACEMENT FOR THE MODEL   @G51DGGB*/ 03561000
         LA    @08,YFRAMMOD                                        1284 03562000
         ST    @08,ADDNXT                                          1284 03563000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX)); /*LOCATION OF MODEL    @G51DGGB*/ 03564000
         L     @08,CCHINDX                                         1285 03565000
         MH    @08,@CH00227                                        1285 03566000
         L     @06,FRAMEPTR(,R2)                                   1285 03567000
         AL    @06,@CF01542                                        1285 03568000
         LA    @08,FRAMEMOD-7(@08,@06)                             1285 03569000
         ST    @08,NEXTBY                                          1285 03570000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03571000
         BAL   @14,CONVERT                                         1286 03572000
*   NUMBER = 14;                                           /*@G51DGGB*/ 03573000
         MVC   NUMBER(4),@CF01353                                  1287 03574000
*   NEXTBY = ADDR(FRAMEKEY(CCHINDX));                      /*@G51DGGB*/ 03575000
         L     @08,CCHINDX                                         1288 03576000
         MH    @08,@CH00227                                        1288 03577000
         L     @06,FRAMEPTR(,R2)                                   1288 03578000
         AL    @06,@CF01522                                        1288 03579000
         LA    @08,FRAMEKEY-4(@08,@06)                             1288 03580000
         ST    @08,NEXTBY                                          1288 03581000
*   ADDNXT = ADDR(YFRAMKEY);                               /*@G51DGGB*/ 03582000
         LA    @08,YFRAMKEY                                        1289 03583000
         ST    @08,ADDNXT                                          1289 03584000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03585000
         BAL   @14,CONVERT                                         1290 03586000
*   CALL PRINTIT;                                          /*@G51DGGB*/ 03587000
         BAL   @14,PRINTIT                                         1291 03588000
*END;                                                      /*@G51DGGB*/ 03589000
@EL00036 DS    0H                                                  1292 03590000
@EF00036 DS    0H                                                  1292 03591000
@ER00036 LM    @14,@12,@SA00036                                    1292 03592000
         BR    @14                                                 1292 03593000
*/*  PROC TO CONVERT TO PRINTABLE FOR ALL ROUTINES           @G51DGGB*/ 03594000
*CONVERT: PROC;                                            /*@G51DGGB*/ 03595000
CONVERT  STM   @14,@12,12(@13)                                     1293 03596000
*RESPECIFY (R4,R5) RESTRICTED;                             /*@G51DGGB*/ 03597000
*    DO J = NUMBER   BY -1 TO ONE;                         /*@G51DGGB*/ 03598000
         L     @08,NUMBER                                          1295 03599000
         ST    @08,J                                               1295 03600000
         B     @DE01295                                            1295 03601000
@DL01295 DS    0H                                                  1296 03602000
*      R4 = NEXTBYTE(J);                                   /*@G51DGGB*/ 03603000
         L     @06,NEXTBY                                          1296 03604000
         BCTR  @06,0                                               1296 03605000
         SLR   R4,R4                                               1296 03606000
         IC    R4,NEXTBYTE(@08,@06)                                1296 03607000
*      T = TWO*J;                                          /*@G51DGGB*/ 03608000
         LR    @06,@08                                             1297 03609000
         ALR   @06,@06                                             1297 03610000
         ST    @06,T                                               1297 03611000
*      SRDL (R4,FOUR);                                     /*@G51DGGB*/ 03612000
         SRDL  R4,4                                                1298 03613000
*      SRL  (R5,28);                                       /*@G51DGGB*/ 03614000
         SRL   R5,28                                               1299 03615000
*      ADDNUM(T-ONE) = CHAR1(R4+1);                        /*@G51DGGB*/ 03616000
         L     @03,ADDNXT                                          1300 03617000
         ALR   @06,@03                                             1300 03618000
         BCTR  @06,0                                               1300 03619000
         BCTR  @06,0                                               1300 03620000
         LA    @01,CHAR1(R4)                                       1300 03621000
         MVC   ADDNUM(1,@06),0(@01)                                1300 03622000
*      ADDNUM(T)     = CHAR1(R5+1);                        /*@G51DGGB*/ 03623000
         L     @06,T                                               1301 03624000
         ALR   @03,@06                                             1301 03625000
         BCTR  @03,0                                               1301 03626000
         LA    @06,CHAR1(R5)                                       1301 03627000
         MVC   ADDNUM(1,@03),0(@06)                                1301 03628000
*    END;                                                  /*@G51DGGB*/ 03629000
         BCTR  @08,0                                               1302 03630000
         ST    @08,J                                               1302 03631000
@DE01295 LTR   @08,@08                                             1302 03632000
         BP    @DL01295                                            1302 03633000
*RESPECIFY (R4,R5) UNRESTRICTED;                           /*@G51DGGB*/ 03634000
* END;                                                     /*@G51DGGB*/ 03635000
@EL00037 DS    0H                                                  1304 03636000
@EF00037 DS    0H                                                  1304 03637000
@ER00037 LM    @14,@12,12(@13)                                     1304 03638000
         BR    @14                                                 1304 03639000
*HEXDUMP: PROC;                                            /*@G51DGGB*/ 03640000
HEXDUMP  STM   @14,@12,@SA00038                                    1305 03641000
* DCL ITEM1 FIXED(31) INIT(0);                             /*@G51DGGB*/ 03642000
* NUMBER = 66;                                             /*@G51DGGB*/ 03643000
         LA    @08,66                                              1307 03644000
         ST    @08,NUMBER                                          1307 03645000
* ADDNXT = ADDR(PRINTBDY);                                 /*@G51DGGB*/ 03646000
         LA    @06,PRINTBDY                                        1308 03647000
         ST    @06,ADDNXT                                          1308 03648000
* NEXTBY = R7;                                             /*@G51DGGB*/ 03649000
         ST    R7,NEXTBY                                           1309 03650000
*DO ITEM1 = 66 BY 66 TO RECLNGTH;                          /*@G51DGGB*/ 03651000
         ST    @08,ITEM1                                           1310 03652000
         B     @DE01310                                            1310 03653000
@DL01310 DS    0H                                                  1311 03654000
* NEXTBY = NEXTBY + 66;                                    /*@G51DGGB*/ 03655000
         LA    @08,66                                              1311 03656000
         AL    @08,NEXTBY                                          1311 03657000
         ST    @08,NEXTBY                                          1311 03658000
* CALL PRINTIT;                                            /*@G51DGGB*/ 03659000
         BAL   @14,PRINTIT                                         1312 03660000
*END;                                                      /*@G51DGGB*/ 03661000
         LA    @08,66                                              1313 03662000
         AL    @08,ITEM1                                           1313 03663000
         ST    @08,ITEM1                                           1313 03664000
@DE01310 CH    @08,RECLNGTH(,R2)                                   1313 03665000
         BNH   @DL01310                                            1313 03666000
*NUMBER = RECLNGTH - (ITEM1 - 66);                         /*@G51DGGB*/ 03667000
         L     @08,ITEM1                                           1314 03668000
         SL    @08,@CF01477                                        1314 03669000
         LCR   @08,@08                                             1314 03670000
         AH    @08,RECLNGTH(,R2)                                   1314 03671000
         ST    @08,NUMBER                                          1314 03672000
*IF NUMBER > 0 THEN                                                1315 03673000
         LTR   @08,@08                                             1315 03674000
         BNP   @RF01315                                            1315 03675000
* DO;                                                      /*@G51DGGB*/ 03676000
*  CALL CONVERT;    /*GO CONVERT THE ITEM TO PRINTABLE       @G51DGGB*/ 03677000
         BAL   @14,CONVERT                                         1317 03678000
*  CALL PRINTIT;    /*GO PRINT THE LINE                      @G51DGGB*/ 03679000
         BAL   @14,PRINTIT                                         1318 03680000
* END;                                                     /*@G51DGGB*/ 03681000
*END;                                                      /*@G51DGGB*/ 03682000
@EL00038 DS    0H                                                  1320 03683000
@EF00038 DS    0H                                                  1320 03684000
@ER00038 LM    @14,@12,@SA00038                                    1320 03685000
         BR    @14                                                 1320 03686000
*PRINTIT: PROC;                                            /*@G51DGGB*/ 03687000
PRINTIT  STM   @14,@12,@SA00039                                    1321 03688000
* PRINTADR = ADDR(PRINTLIN);   /*SET THE ADDRESS OF THE PRINT LINE*/    03689000
         LA    @08,PRINTLIN                                        1322 03690000
         ST    @08,PRINTADR(,R2)                                   1322 03691000
* CALL IOHND(RITEPRTR);        /*TELL IO HANDLER TO PRINTIT  @G51DGGB*/ 03692000
         L     @15,ADIOHND(,R2)                                    1323 03693000
         LA    @01,@AL01323                                        1323 03694000
         BALR  @14,@15                                             1323 03695000
*END;                                                      /*@G51DGGB*/ 03696000
@EL00039 DS    0H                                                  1324 03697000
@EF00039 DS    0H                                                  1324 03698000
@ER00039 LM    @14,@12,@SA00039                                    1324 03699000
         BR    @14                                                 1324 03700000
*/*  PROC TO CONVERT FROM BINARY TO PRINTABLE DIGITS         @G51DGGB*/ 03701000
*CONVBIN: PROC;                                            /*@G51DGGB*/ 03702000
CONVBIN  STM   @14,@12,@SA00040                                    1325 03703000
*RESPECIFY (R4,R5) RESTRICTED;                             /*@G51DGGB*/ 03704000
*    R4 = BINWORD;           /*LOAD THE WORD TO CONVERT      @G51DGGB*/ 03705000
         L     R4,BINWORD                                          1327 03706000
*    CVD(R4,DBLWORD);        /*CONVERT TO PRINTABLE          @G51DGGB*/ 03707000
         CVD   R4,DBLWORD                                          1328 03708000
*    UNPK(WORK(1:8),DBLWORD) ;                             /*@G51DGGB*/ 03709000
         UNPK  WORK(8),DBLWORD(8)                                  1329 03710000
*    WORK(8) = WORK(8) | FOXZERO;                          /*@G51DGGB*/ 03711000
         OI    WORK+7,X'F0'                                        1330 03712000
*    SWITCH1 = OFF;    /*TURN OFF THE CONTROL FOR THE LOOP   @G51DGGB*/ 03713000
         NI    SWITCH1,B'11011111'                                 1331 03714000
*    DO J = 1 TO 7 BY 1 WHILE (SWITCH1 = OFF);/*DONT DO LAST CHAR*/     03715000
         LA    @08,1                                               1332 03716000
         ST    @08,J                                               1332 03717000
@DL01332 TM    SWITCH1,B'00100000'                                 1332 03718000
         BNZ   @DC01332                                            1332 03719000
*      IF WORK(J) = FOXZERO THEN  /*SUPPRESS ANY LEADING BLANKES*/ 1333 03720000
         LA    @06,WORK-1(@08)                                     1333 03721000
         CLI   0(@06),X'F0'                                        1333 03722000
         BNE   @RF01333                                            1333 03723000
*        WORK(J) = BLANK;    /*SET TO A BLANK                @G51DGGB*/ 03724000
         LA    @06,WORK-1(@08)                                     1334 03725000
         MVI   0(@06),X'40'                                        1334 03726000
*      ELSE                                                        1335 03727000
*        SWITCH1 = ON;     /*END OF THE LEADING ZEROS        @G51DGGB*/ 03728000
         B     @RC01333                                            1335 03729000
@RF01333 OI    SWITCH1,B'00100000'                                 1335 03730000
*    END;                                                  /*@G51DGGB*/ 03731000
@RC01333 LA    @08,1                                               1336 03732000
         AL    @08,J                                               1336 03733000
         ST    @08,J                                               1336 03734000
         C     @08,@CF00083                                        1336 03735000
         BNH   @DL01332                                            1336 03736000
@DC01332 DS    0H                                                  1337 03737000
*    IF (10-J) > NUMDIG THEN                                       1337 03738000
         LA    @08,10                                              1337 03739000
         SL    @08,J                                               1337 03740000
         C     @08,@CF00083                                        1337 03741000
         BNH   @RF01337                                            1337 03742000
*      WORK = '9999999';  /*NUMBER WAS LARGER THAN ROOM ALLOWED*/  1338 03743000
         MVI   WORK+7,C' '                                         1338 03744000
         MVC   WORK(7),@CC01484                                    1338 03745000
*    RESPECIFY (R6) RESTRICTED;                            /*@G51DGGB*/ 03746000
@RF01337 DS    0H                                                  1340 03747000
*    R6 = DECADDR;                                         /*@G51DGGB*/ 03748000
         L     R6,DECADDR                                          1340 03749000
*    R5 = 6;                                               /*@G51DGGB*/ 03750000
         LA    R5,6                                                1341 03751000
*    R4 = ADDR(WORK) + 1;                                  /*@G51DGGB*/ 03752000
         LA    R4,WORK                                             1342 03753000
         AL    R4,@CF00055                                         1342 03754000
*    GEN(EX  R5,MVCDATA);                                  /*@G51DGGB*/ 03755000
         EX  R5,MVCDATA                                                 03756000
*    GENERATE DATA;                                        /*@G51DGGB*/ 03757000
*RESPECIFY (R4,R5,R6) UNRESTRICTED;                        /*@G51DGGB*/ 03758000
* END;                                                     /*@G51DGGB*/ 03759000
@EL00040 DS    0H                                                  1346 03760000
@EF00040 DS    0H                                                  1346 03761000
@ER00040 LM    @14,@12,@SA00040                                    1346 03762000
         BR    @14                                                 1346 03763000
*END   /*CLOSING END FOR IFCFILT1 EXTERNAL PROC              @Z427VLS*/ 03764000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 03765000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 03766000
*;                                                                 1347 03767000
@DATA    DS    0H                                                       03768000
@CH00081 DC    H'6'                                                     03769000
@CH00033 DC    H'11'                                                    03770000
@CH01512 DC    H'63'                                                    03771000
@CH01026 DC    H'600'                                                   03772000
         DS    0F                                                       03773000
@AL00191 EQU   *                       LIST WITH   1 ARGUMENT(S)        03774000
@AL00341 EQU   *                       LIST WITH   1 ARGUMENT(S)        03775000
@AL01194 EQU   *                       LIST WITH   1 ARGUMENT(S)        03776000
@AL01240 EQU   *                       LIST WITH   1 ARGUMENT(S)        03777000
@AL01255 EQU   *                       LIST WITH   1 ARGUMENT(S)        03778000
@AL01323 DC    A(@CF00074+2)           LIST WITH   1 ARGUMENT(S)        03779000
@AL00197 DC    A(@CF00076+2)           LIST WITH   1 ARGUMENT(S)        03780000
@AL00213 EQU   *                       LIST WITH   1 ARGUMENT(S)        03781000
@AL00892 EQU   *                       LIST WITH   1 ARGUMENT(S)        03782000
@AL00909 DC    A(@CF00064+2)           LIST WITH   1 ARGUMENT(S)        03783000
@AL00219 EQU   *                       LIST WITH   1 ARGUMENT(S)        03784000
@AL01062 DC    A(@CF00079+2)           LIST WITH   1 ARGUMENT(S)        03785000
@AL00311 EQU   *                       LIST WITH   1 ARGUMENT(S)        03786000
@AL00346 EQU   *                       LIST WITH   1 ARGUMENT(S)        03787000
@AL00373 DC    A(@CF00083+2)           LIST WITH   1 ARGUMENT(S)        03788000
@AL00328 DC    A(@CF01306)             LIST WITH   2 ARGUMENT(S)        03789000
         DC    A(@AFTEMPS)                                              03790000
@AL00334 DC    A(@CF00643)             LIST WITH   2 ARGUMENT(S)        03791000
         DC    A(@AFTEMPS)                                              03792000
@AL00889 EQU   *                       LIST WITH   1 ARGUMENT(S)        03793000
@AL00906 DC    A(@CH00081)             LIST WITH   1 ARGUMENT(S)        03794000
@AL01154 DC    A(@CF00627)             LIST WITH   2 ARGUMENT(S)        03795000
         DC    A(@AFTEMPS+4)                                            03796000
@AL01160 DC    A(@CF01443)             LIST WITH   2 ARGUMENT(S)        03797000
         DC    A(@AFTEMPS+4)                                            03798000
@AL01163 DC    A(@CF01444)             LIST WITH   2 ARGUMENT(S)        03799000
         DC    A(@AFTEMPS+4)                                            03800000
@AL01173 DC    A(@CF01446)             LIST WITH   2 ARGUMENT(S)        03801000
         DC    A(@AFTEMPS+4)                                            03802000
@AL01184 EQU   *                       LIST WITH   2 ARGUMENT(S)        03803000
@AL01188 DC    A(@CF01152)             LIST WITH   2 ARGUMENT(S)        03804000
         DC    A(@AFTEMPS+4)                                            03805000
@AL01186 EQU   *                       LIST WITH   2 ARGUMENT(S)        03806000
@AL01192 DC    A(@CF00079)             LIST WITH   2 ARGUMENT(S)        03807000
         DC    A(@AFTEMPS+4)                                            03808000
@AL01190 DC    A(@CF00227)             LIST WITH   2 ARGUMENT(S)        03809000
         DC    A(@AFTEMPS+4)                                            03810000
         DS    0F                                                       03811000
@SA00001 DS    18F                                                      03812000
@SA00002 DS    15F                                                      03813000
@SA00023 DS    15F                                                      03814000
@SA00004 DS    15F                                                      03815000
@SA00003 DS    15F                                                      03816000
@SA00034 DS    15F                                                      03817000
@SA00031 DS    15F                                                      03818000
@SA00040 DS    15F                                                      03819000
@SA00039 DS    15F                                                      03820000
@SA00024 DS    15F                                                      03821000
@SA00007 DS    15F                                                      03822000
@SA00008 DS    15F                                                      03823000
@SA00006 DS    15F                                                      03824000
@SA00009 DS    15F                                                      03825000
@SA00010 DS    15F                                                      03826000
@SA00016 DS    15F                                                      03827000
@SA00013 DS    15F                                                      03828000
@SA00017 DS    15F                                                      03829000
@SA00011 DS    15F                                                      03830000
@SA00012 DS    15F                                                      03831000
@SA00025 DS    15F                                                      03832000
@SA00038 DS    15F                                                      03833000
@SA00027 DS    15F                                                      03834000
@SA00028 DS    15F                                                      03835000
@SA00026 DS    15F                                                      03836000
@SA00036 DS    15F                                                      03837000
@SA00035 DS    15F                                                      03838000
@TF00001 DS    F                                                        03839000
@AFTEMPS DS    2F                                                       03840000
         DS    0F                                                       03841000
@CF00055 DC    F'1'                                                     03842000
@CF00074 DC    F'2'                                                     03843000
@CH00074 EQU   @CF00074+2                                               03844000
@CF00076 DC    F'3'                                                     03845000
@CH00076 EQU   @CF00076+2                                               03846000
@CF00064 DC    F'4'                                                     03847000
@CH00064 EQU   @CF00064+2                                               03848000
@CF00079 DC    F'5'                                                     03849000
@CH00079 EQU   @CF00079+2                                               03850000
@CF00083 DC    F'7'                                                     03851000
@CH00083 EQU   @CF00083+2                                               03852000
@CF00066 DC    F'8'                                                     03853000
@CF00034 DC    F'10'                                                    03854000
@CH00034 EQU   @CF00034+2                                               03855000
@CF00032 DC    F'12'                                                    03856000
@CF01353 DC    F'14'                                                    03857000
@CF00088 DC    F'16'                                                    03858000
@CF00227 DC    F'24'                                                    03859000
@CH00227 EQU   @CF00227+2                                               03860000
@CF00863 DC    F'27'                                                    03861000
@CF01152 DC    F'40'                                                    03862000
@CF01427 DC    F'45'                                                    03863000
@CF00293 DC    F'50'                                                    03864000
@CF01444 DC    F'53'                                                    03865000
@CF00643 DC    F'54'                                                    03866000
@CF01443 DC    F'55'                                                    03867000
@CF00627 DC    F'64'                                                    03868000
@CF01477 DC    F'66'                                                    03869000
@CF01446 DC    F'78'                                                    03870000
@CF01306 DC    F'83'                                                    03871000
@CF01510 DC    F'254'                                                   03872000
@CF01024 DC    F'36000'                                                 03873000
@CF01046 DC    F'500000'                                                03874000
@CF01522 DC    F'-20'                                                   03875000
@CF01542 DC    F'-17'                                                   03876000
@CF01539 DC    F'-15'                                                   03877000
@CF01518 DC    F'-10'                                                   03878000
@CF01543 DC    F'-9'                                                    03879000
@CF01524 DC    F'-7'                                                    03880000
@CF01532 DC    F'-6'                                                    03881000
@CF01520 DC    F'-5'                                                    03882000
@CF01533 DC    F'-4'                                                    03883000
@CF01528 DC    F'-3'                                                    03884000
@CF01049 DC    XL4'FFFFFFF8'                                            03885000
         DS    0D                                                       03886000
LISTPTR  DC    A(0)                                                     03887000
TEMPSAV  DC    F'0'                                                     03888000
X        DC    A(0)                                                     03889000
Y        DC    A(0)                                                     03890000
Z        DC    A(0)                                                     03891000
Q        DC    A(0)                                                     03892000
CCHINDX  DC    A(0)                                                     03893000
SAVESEQ  DC    F'0'                                                     03894000
TIME     DC    F'0'                                                     03895000
TEN      DC    F'10'                                                    03896000
BINWORD  DC    F'0'                                                     03897000
DECADDR  DC    F'0'                                                     03898000
NUMBER   DC    F'0'                                                     03899000
ADDNXT   DC    F'0'                                                     03900000
NEXTBY   DC    F'0'                                                     03901000
F        DC    F'0'                                                     03902000
A        DC    F'0'                                                     03903000
T        DC    F'0'                                                     03904000
TEMPSTOR DC    F'0'                                                     03905000
G        DC    F'0'                                                     03906000
ITEM1    DC    F'0'                                                     03907000
SECTIME  DS    H                                                        03908000
HRTIME   DS    FL1                                                      03909000
MINTIME  DS    FL1                                                      03910000
         DS    0D                                                       03911000
@TS00001 DS    CL8                                                      03912000
@CC00977 DC    C'        '                                              03913000
@CC01484 DC    C'9999999'                                               03914000
@CB01424 DC    X'0000000000000000'                                      03915000
@CB01459 DC    X'0000000F'                                              03916000
@CB01010 DC    X'000FF0'                                                03917000
@CB01018 DC    X'000FFF'                                                03918000
@CB00208 EQU   @CB01424                                                 03919000
@CB00980 DC    X'2006'                                                  03920000
@CB00982 DC    X'2007'                                                  03921000
@CB00984 DC    X'2009'                                                  03922000
@CB00986 DC    X'200A'                                                  03923000
@CB00988 DC    X'200B'                                                  03924000
@CB00990 DC    X'200D'                                                  03925000
@CB01012 DC    X'0FF0'                                                  03926000
@CB01014 DC    X'0FFF'                                                  03927000
@CB01016 DC    X'7FFF'                                                  03928000
@CB01037 EQU   @CB01010                                                 03929000
BUG16    DC    CL9'DEBUG16- '                                           03930000
ERR7816  DC    CL18' '                                                  03931000
         ORG   ERR7816                                                  03932000
@NM00088 DC    CL18'DEBUG16 FRAME SET '                                 03933000
         ORG   ERR7816+18                                               03934000
INCOMP   DC    CL10'INCOMPLETE'                                         03935000
REPLACED DC    CL8'REPLACED'                                            03936000
SWITCHS  DC    AL2(0)                                                   03937000
         ORG   SWITCHS                                                  03938000
ONETIME  DS    BL1                                                      03939000
ISMERD   EQU   SWITCHS+0                                                03940000
SWITCH1  EQU   SWITCHS+0                                                03941000
LOOPOUT  EQU   SWITCHS+0                                                03942000
NOMESAGE EQU   SWITCHS+0                                                03943000
FRAMEYES EQU   SWITCHS+0                                                03944000
         ORG   SWITCHS+2                                                03945000
ZERO1    DC    X'0000000000'                                            03946000
WORKTABL DS    CL10                                                     03947000
         ORG   WORKTABL                                                 03948000
WORKKEY  DS    CL5                                                      03949000
         ORG   WORKKEY                                                  03950000
WORKTYPE DS    CL1                                                      03951000
WORKCHAN DS    BL1                                                      03952000
WORKCUA  DS    CL3                                                      03953000
         ORG   WORKCUA                                                  03954000
WORKCU   DS    CL1                                                      03955000
WORKMOD  DS    CL2                                                      03956000
         ORG   WORKTABL+5                                               03957000
WORKCCHR DS    CL5                                                      03958000
         ORG   WORKCCHR                                                 03959000
WORKCNT  DS    CL2                                                      03960000
         ORG   WORKTABL+10                                              03961000
BLDLIST  DS    CL62                                                     03962000
         ORG   BLDLIST                                                  03963000
BLDNUM   DC    X'0001'                                                  03964000
BLDLL    DC    X'003A'                                                  03965000
BLDNAME  DC    CL8'        '                                            03966000
BLDLOC   DC    X'000000000000'                                          03967000
BLDUSER  DS    CL44                                                     03968000
         ORG   BLDLIST+62                                               03969000
         DS    CL1                                                      03970000
FILT1ITM DS    CL77                                                     03971000
         ORG   FILT1ITM                                                 03972000
USERLOC  DC    F'0'                                                     03973000
ERROR    DC    F'0'                                                     03974000
MAXENT   DC    F'0'                                                     03975000
EXCESS   DC    F'0'                                                     03976000
FREEADR  DC    A(0)                                                     03977000
I        DC    A(1)                                                     03978000
J        DC    A(0)                                                     03979000
K        DC    A(0)                                                     03980000
M        DC    A(0)                                                     03981000
SRTCONT  DC    F'0'                                                     03982000
SRTCONT1 DC    F'0'                                                     03983000
PACKPAS  DC    CL4'    '                                                03984000
CHARPAS  DC    CL8'        '                                            03985000
PASSNUM  DC    F'0'                                                     03986000
NUMREC   DC    F'0'                                                     03987000
GETADR   DC    A(0)                                                     03988000
WORKDEV  DC    X'0000'                                                  03989000
         DS    CL2                                                      03990000
GETBYT   DC    F'0'                                                     03991000
MSGNO    DC    AL1(0)                                                   03992000
         ORG   FILT1ITM+77                                              03993000
PRINTLIN DS    CL134                                                    03994000
         ORG   PRINTLIN                                                 03995000
PRINTDS  DC    X'01'                                                    03996000
PRINTCC  DC    X'09'                                                    03997000
PRINTBDY DC    CL132' '                                                 03998000
         ORG   PRINTLIN+134                                             03999000
BITSWIT  DC    X'0000'                                                  04000000
         ORG   BITSWIT                                                  04001000
NONBLANK DS    BL1                                                      04002000
ONBOUND  EQU   BITSWIT+0                                                04003000
CPUOK    EQU   BITSWIT+0                                                04004000
MODOK    EQU   BITSWIT+0                                                04005000
LIBOK    EQU   BITSWIT+0                                                04006000
SORTSW   EQU   BITSWIT+0                                                04007000
GETOUT   EQU   BITSWIT+0                                                04008000
CUAOK    EQU   BITSWIT+0                                                04009000
CPUCUAOK DS    BL1                                                      04010000
VOLOK    EQU   BITSWIT+1                                                04011000
DEVOK    EQU   BITSWIT+1                                                04012000
GETFAIL  EQU   BITSWIT+1                                                04013000
SHAREYES EQU   BITSWIT+1                                                04014000
         ORG   BITSWIT+2                                                04015000
WKCPUCUA DC    X'0000000000'                                            04016000
         ORG   WKCPUCUA                                                 04017000
WKCPU    DS    CL3                                                      04018000
WKCUA    DS    CL2                                                      04019000
         ORG   WKCPUCUA+5                                               04020000
         DS    CL6                                                      04021000
DBLWORD  DS    CL8                                                      04022000
WORK     DS    CL8                                                      04023000
CHARS    DC    CL16'0123456789ABCDEF'                                   04024000
SUPERZAP DC    3CL10'SUPERZAP'                                          04025000
         DS    CL2                                                      04026000
PATCH    DC    25F'0'                                                   04027000
BUG      DC    46F'0'                                                   04028000
ERRLINE  DS    CL63                                                     04029000
         ORG   ERRLINE+0                                                04030000
ERRDS    DC    CL1'1'                                                   04031000
ERCC     DC    X'09'                                                    04032000
ERRMES   DC    CL10'DEBUG16  '                                          04033000
ERXNUM   DC    CL9'         '                                           04034000
@NM00096 DC    CL2'  '                                                  04035000
ERRTXT   DC    CL40'RECORDS RETRIEVED VIA READSEQ           '           04036000
         ORG   ERRLINE+63                                               04037000
         ORG   ERRLINE+63                                               04038000
         DC    CL1'1'                                                   04039000
         DC    X'09'                                                    04040000
         DC    CL10'DEBUG16  '                                          04041000
         DC    CL9'         '                                           04042000
         DC    CL2'  '                                                  04043000
         DC    CL40'RECORDS FAILED DATE FILTERING           '           04044000
         ORG   ERRLINE+126                                              04045000
         ORG   ERRLINE+126                                              04046000
         DC    CL1'1'                                                   04047000
         DC    X'09'                                                    04048000
         DC    CL10'DEBUG16  '                                          04049000
         DC    CL9'         '                                           04050000
         DC    CL2'  '                                                  04051000
         DC    CL40'RECORDS FAILED NON 3RD TIME FILTERING   '           04052000
         ORG   ERRLINE+189                                              04053000
         ORG   ERRLINE+189                                              04054000
         DC    CL1'1'                                                   04055000
         DC    X'09'                                                    04056000
         DC    CL10'DEBUG16  '                                          04057000
         DC    CL9'         '                                           04058000
         DC    CL2'  '                                                  04059000
         DC    CL40'RECORDS FAILED CPU MODEL,SERIAL FILTER  '           04060000
         ORG   ERRLINE+252                                              04061000
         ORG   ERRLINE+252                                              04062000
         DC    CL1'1'                                                   04063000
         DC    X'09'                                                    04064000
         DC    CL10'DEBUG16  '                                          04065000
         DC    CL9'         '                                           04066000
         DC    CL2'  '                                                  04067000
         DC    CL40'RECORDS FAILED CPU MODEL FILTERING      '           04068000
         ORG   ERRLINE+315                                              04069000
         ORG   ERRLINE+315                                              04070000
         DC    CL1'1'                                                   04071000
         DC    X'09'                                                    04072000
         DC    CL10'DEBUG16  '                                          04073000
         DC    CL9'         '                                           04074000
         DC    CL2'  '                                                  04075000
         DC    CL40'RECORDS FAILED 3RD SHIFT TIME FILTERING '           04076000
         ORG   ERRLINE+378                                              04077000
         ORG   ERRLINE+378                                              04078000
         DC    CL1'1'                                                   04079000
         DC    X'09'                                                    04080000
         DC    CL10'DEBUG16  '                                          04081000
         DC    CL9'         '                                           04082000
         DC    CL2'  '                                                  04083000
         DC    CL40'OBR RECORDS FAILED TYPE SELECTION       '           04084000
         ORG   ERRLINE+441                                              04085000
         ORG   ERRLINE+441                                              04086000
         DC    CL1'1'                                                   04087000
         DC    X'09'                                                    04088000
         DC    CL10'DEBUG16  '                                          04089000
         DC    CL9'         '                                           04090000
         DC    CL2'  '                                                  04091000
         DC    CL40'OBR RECORDS FAILED CUA SELECTION        '           04092000
         ORG   ERRLINE+504                                              04093000
         ORG   ERRLINE+504                                              04094000
         DC    CL1'1'                                                   04095000
         DC    X'09'                                                    04096000
         DC    CL10'DEBUG16  '                                          04097000
         DC    CL9'         '                                           04098000
         DC    CL2'  '                                                  04099000
         DC    CL40'OBR RECORDS FAILED DEVICE SELECTION     '           04100000
         ORG   ERRLINE+567                                              04101000
         ORG   ERRLINE+567                                              04102000
         DC    CL1'1'                                                   04103000
         DC    X'09'                                                    04104000
         DC    CL10'DEBUG16  '                                          04105000
         DC    CL9'         '                                           04106000
         DC    CL2'  '                                                  04107000
         DC    CL40'OBR RECORDS FAILED CPU,CUA SELECTION    '           04108000
         ORG   ERRLINE+630                                              04109000
         ORG   ERRLINE+630                                              04110000
         DC    CL1'1'                                                   04111000
         DC    X'09'                                                    04112000
         DC    CL10'DEBUG16  '                                          04113000
         DC    CL9'         '                                           04114000
         DC    CL2'  '                                                  04115000
         DC    CL40'OBR RECORDS FAILED VOLID SELECTION      '           04116000
         ORG   ERRLINE+693                                              04117000
         ORG   ERRLINE+693                                              04118000
         DC    CL1'1'                                                   04119000
         DC    X'09'                                                    04120000
         DC    CL10'DEBUG16  '                                          04121000
         DC    CL9'         '                                           04122000
         DC    CL2'  '                                                  04123000
         DC    CL40'OBR RECORDS FAILED TERMINAL ID SELECTION'           04124000
         ORG   ERRLINE+756                                              04125000
         ORG   ERRLINE+756                                              04126000
         DC    CL1'1'                                                   04127000
         DC    X'09'                                                    04128000
         DC    CL10'DEBUG16  '                                          04129000
         DC    CL9'         '                                           04130000
         DC    CL2'  '                                                  04131000
         DC    CL40'MDR RECORDS FAILED TYPE SELECTION       '           04132000
         ORG   ERRLINE+819                                              04133000
         ORG   ERRLINE+819                                              04134000
         DC    CL1'1'                                                   04135000
         DC    X'09'                                                    04136000
         DC    CL10'DEBUG16  '                                          04137000
         DC    CL9'         '                                           04138000
         DC    CL2'  '                                                  04139000
         DC    CL40'MDR RECORDS FAILED CUA SELECTION        '           04140000
         ORG   ERRLINE+882                                              04141000
         ORG   ERRLINE+882                                              04142000
         DC    CL1'1'                                                   04143000
         DC    X'09'                                                    04144000
         DC    CL10'DEBUG16  '                                          04145000
         DC    CL9'         '                                           04146000
         DC    CL2'  '                                                  04147000
         DC    CL40'MDR RECORDS FAILED DEVICE SELECTION     '           04148000
         ORG   ERRLINE+945                                              04149000
         ORG   ERRLINE+945                                              04150000
         DC    CL1'1'                                                   04151000
         DC    X'09'                                                    04152000
         DC    CL10'DEBUG16  '                                          04153000
         DC    CL9'         '                                           04154000
         DC    CL2'  '                                                  04155000
         DC    CL40'MDR RECORDS FAILED CPU,CUA SELECTION    '           04156000
         ORG   ERRLINE+1008                                             04157000
         ORG   ERRLINE+1008                                             04158000
         DC    CL1'1'                                                   04159000
         DC    X'09'                                                    04160000
         DC    CL10'DEBUG16  '                                          04161000
         DC    CL9'         '                                           04162000
         DC    CL2'  '                                                  04163000
         DC    CL40'MDR RECS FAILED LINE INT.BASE ADDR. SEL '           04164000
         ORG   ERRLINE+1071                                             04165000
         ORG   ERRLINE+1071                                             04166000
         DC    CL1'1'                                                   04167000
         DC    X'09'                                                    04168000
         DC    CL10'DEBUG16  '                                          04169000
         DC    CL9'         '                                           04170000
         DC    CL2'  '                                                  04171000
         DC    CL40'MDR RECORDS FAILED VOLID SELECTION      '           04172000
         ORG   ERRLINE+1134                                             04173000
         ORG   ERRLINE+1134                                             04174000
         DC    CL1'1'                                                   04175000
         DC    X'09'                                                    04176000
         DC    CL10'DEBUG16  '                                          04177000
         DC    CL9'         '                                           04178000
         DC    CL2'  '                                                  04179000
         DC    CL40'DDR RECORDS FAILED TYPE FILTERING       '           04180000
         ORG   ERRLINE+1197                                             04181000
         ORG   ERRLINE+1197                                             04182000
         DC    CL1'1'                                                   04183000
         DC    X'09'                                                    04184000
         DC    CL10'DEBUG16  '                                          04185000
         DC    CL9'         '                                           04186000
         DC    CL2'  '                                                  04187000
         DC    CL40'DDR RECORDS FAILED CUA SELECTION        '           04188000
         ORG   ERRLINE+1260                                             04189000
         ORG   ERRLINE+1260                                             04190000
         DC    CL1'1'                                                   04191000
         DC    X'09'                                                    04192000
         DC    CL10'DEBUG16  '                                          04193000
         DC    CL9'         '                                           04194000
         DC    CL2'  '                                                  04195000
         DC    CL40'DDR RECORDS FAILED CPU,CUA SELECTION    '           04196000
         ORG   ERRLINE+1323                                             04197000
         ORG   ERRLINE+1323                                             04198000
         DC    CL1'1'                                                   04199000
         DC    X'09'                                                    04200000
         DC    CL10'DEBUG16  '                                          04201000
         DC    CL9'         '                                           04202000
         DC    CL2'  '                                                  04203000
         DC    CL40'DDR RECORDS FAILED DEVICE SELECTION     '           04204000
         ORG   ERRLINE+1386                                             04205000
         ORG   ERRLINE+1386                                             04206000
         DC    CL1'1'                                                   04207000
         DC    X'09'                                                    04208000
         DC    CL10'DEBUG16  '                                          04209000
         DC    CL9'         '                                           04210000
         DC    CL2'  '                                                  04211000
         DC    CL40'MIH RECORDS FAILED TYPE SELECTION       '           04212000
         ORG   ERRLINE+1449                                             04213000
         ORG   ERRLINE+1449                                             04214000
         DC    CL1'1'                                                   04215000
         DC    X'09'                                                    04216000
         DC    CL10'DEBUG16  '                                          04217000
         DC    CL9'         '                                           04218000
         DC    CL2'  '                                                  04219000
         DC    CL40'MIH RECORDS FAILED CUA SELECTION        '           04220000
         ORG   ERRLINE+1512                                             04221000
         ORG   ERRLINE+1512                                             04222000
         DC    CL1'1'                                                   04223000
         DC    X'09'                                                    04224000
         DC    CL10'DEBUG16  '                                          04225000
         DC    CL9'         '                                           04226000
         DC    CL2'  '                                                  04227000
         DC    CL40'MIH RECORDS FAILED CPU,CUA SELECTION    '           04228000
         ORG   ERRLINE+1575                                             04229000
         ORG   ERRLINE+1575                                             04230000
         DC    CL1'1'                                                   04231000
         DC    X'09'                                                    04232000
         DC    CL10'DEBUG16  '                                          04233000
         DC    CL9'         '                                           04234000
         DC    CL2'  '                                                  04235000
         DC    CL40'MIH RECORDS FAILED DEVICE SELECTION     '           04236000
         ORG   ERRLINE+1638                                             04237000
         ORG   ERRLINE+1638                                             04238000
         DC    CL1'1'                                                   04239000
         DC    X'09'                                                    04240000
         DC    CL10'DEBUG16  '                                          04241000
         DC    CL9'         '                                           04242000
         DC    CL2'  '                                                  04243000
         DC    CL40'CCH RECORDS FAILED TYPE SELECTION       '           04244000
         ORG   ERRLINE+1701                                             04245000
         ORG   ERRLINE+1701                                             04246000
         DC    CL1'1'                                                   04247000
         DC    X'09'                                                    04248000
         DC    CL10'DEBUG16  '                                          04249000
         DC    CL9'         '                                           04250000
         DC    CL2'  '                                                  04251000
         DC    CL40'CCH RECORDS FAILED CUA SELECTION        '           04252000
         ORG   ERRLINE+1764                                             04253000
         ORG   ERRLINE+1764                                             04254000
         DC    CL1'1'                                                   04255000
         DC    X'09'                                                    04256000
         DC    CL10'DEBUG16  '                                          04257000
         DC    CL9'         '                                           04258000
         DC    CL2'  '                                                  04259000
         DC    CL40'CCH RECORDS FAILED CPU,CUA SELECTION    '           04260000
         ORG   ERRLINE+1827                                             04261000
         ORG   ERRLINE+1827                                             04262000
         DC    CL1'1'                                                   04263000
         DC    X'09'                                                    04264000
         DC    CL10'DEBUG16  '                                          04265000
         DC    CL9'         '                                           04266000
         DC    CL2'  '                                                  04267000
         DC    CL40'IPL RECORDS FAILED TYPE SELECTION       '           04268000
         ORG   ERRLINE+1890                                             04269000
         ORG   ERRLINE+1890                                             04270000
         DC    CL1'1'                                                   04271000
         DC    X'09'                                                    04272000
         DC    CL10'DEBUG16  '                                          04273000
         DC    CL9'         '                                           04274000
         DC    CL2'  '                                                  04275000
         DC    CL40'EOD RECORDS FAILED TYPE SELECTION       '           04276000
         ORG   ERRLINE+1953                                             04277000
         ORG   ERRLINE+1953                                             04278000
         DC    CL1'1'                                                   04279000
         DC    X'09'                                                    04280000
         DC    CL10'DEBUG16  '                                          04281000
         DC    CL9'         '                                           04282000
         DC    CL2'  '                                                  04283000
         DC    CL40'MCH RECORDS FAILED TYPE SELECTION       '           04284000
         ORG   ERRLINE+2016                                             04285000
         ORG   ERRLINE+2016                                             04286000
         DC    CL1'1'                                                   04287000
         DC    X'09'                                                    04288000
         DC    CL10'DEBUG16  '                                          04289000
         DC    CL9'         '                                           04290000
         DC    CL2'  '                                                  04291000
         DC    CL40'MCH RECORDS FAILED ERROR ID SELECTION   '           04292000
         ORG   ERRLINE+2079                                             04293000
         ORG   ERRLINE+2079                                             04294000
         DC    CL1'1'                                                   04295000
         DC    X'09'                                                    04296000
         DC    CL10'DEBUG16  '                                          04297000
         DC    CL9'         '                                           04298000
         DC    CL2'  '                                                  04299000
         DC    CL40'SOFT RECORDS FAILED TYPE SELECTION      '           04300000
         ORG   ERRLINE+2142                                             04301000
         ORG   ERRLINE+2142                                             04302000
         DC    CL1'1'                                                   04303000
         DC    X'09'                                                    04304000
         DC    CL10'DEBUG16  '                                          04305000
         DC    CL9'         '                                           04306000
         DC    CL2'  '                                                  04307000
         DC    CL40'SOFT RECORDS FAILED ERROR ID SELECTION  '           04308000
         ORG   ERRLINE+2205                                             04309000
         ORG   ERRLINE+2205                                             04310000
         DC    CL1'1'                                                   04311000
         DC    X'09'                                                    04312000
         DC    CL10'DEBUG16  '                                          04313000
         DC    CL9'         '                                           04314000
         DC    CL2'  '                                                  04315000
         DC    CL40'FRAMES THAT WERE ACCEPTED               '           04316000
         ORG   ERRLINE+2268                                             04317000
         ORG   ERRLINE+2268                                             04318000
         DC    CL1'1'                                                   04319000
         DC    X'09'                                                    04320000
         DC    CL10'DEBUG16  '                                          04321000
         DC    CL9'         '                                           04322000
         DC    CL2'  '                                                  04323000
         DC    CL40'FRAMES THAT FAILED SELECTION            '           04324000
         ORG   ERRLINE+2331                                             04325000
         ORG   ERRLINE+2331                                             04326000
         DC    CL1'1'                                                   04327000
         DC    X'09'                                                    04328000
         DC    CL10'DEBUG16  '                                          04329000
         DC    CL9'         '                                           04330000
         DC    CL2'  '                                                  04331000
         DC    CL40'FRAME SETS THAT WERE COMPLETE           '           04332000
         ORG   ERRLINE+2394                                             04333000
         ORG   ERRLINE+2394                                             04334000
         DC    CL1'1'                                                   04335000
         DC    X'09'                                                    04336000
         DC    CL10'DEBUG16  '                                          04337000
         DC    CL9'         '                                           04338000
         DC    CL2'  '                                                  04339000
         DC    CL40'FRAME RECORDS READ                      '           04340000
         ORG   ERRLINE+2457                                             04341000
         ORG   ERRLINE+2457                                             04342000
         DC    CL1'1'                                                   04343000
         DC    X'09'                                                    04344000
         DC    CL10'DEBUG16  '                                          04345000
         DC    CL9'         '                                           04346000
         DC    CL2'  '                                                  04347000
         DC    CL40'FRAME SETS REPLACED DUE TO LATER DATE   '           04348000
         ORG   ERRLINE+2520                                             04349000
         ORG   ERRLINE+2520                                             04350000
         DC    CL1'1'                                                   04351000
         DC    X'09'                                                    04352000
         DC    CL10'DEBUG16  '                                          04353000
         DC    CL9'         '                                           04354000
         DC    CL2'  '                                                  04355000
         DC    CL40'FRAME SETS REPLACED SET INCOMPLETE      '           04356000
         ORG   ERRLINE+2583                                             04357000
         ORG   ERRLINE+2583                                             04358000
         DC    CL1'1'                                                   04359000
         DC    X'09'                                                    04360000
         DC    CL10'DEBUG16  '                                          04361000
         DC    CL9'         '                                           04362000
         DC    CL2'  '                                                  04363000
         DC    CL40'NUMBER OF SUBPOOL-21 GETMAINS           '           04364000
         ORG   ERRLINE+2646                                             04365000
         ORG   ERRLINE+2646                                             04366000
         DC    CL1'1'                                                   04367000
         DC    X'09'                                                    04368000
         DC    CL10'DEBUG16  '                                          04369000
         DC    CL9'         '                                           04370000
         DC    CL2'  '                                                  04371000
         DC    CL40'ENTRIES IN FRAME TABLE                  '           04372000
         ORG   ERRLINE+2709                                             04373000
         ORG   ERRLINE+2709                                             04374000
         DC    CL1'1'                                                   04375000
         DC    X'09'                                                    04376000
         DC    CL10'DEBUG16  '                                          04377000
         DC    CL9'         '                                           04378000
         DC    CL2'  '                                                  04379000
         DC    CL40'FRAMES WRITTEN TO ACCDEV                '           04380000
         ORG   ERRLINE+2772                                             04381000
         ORG   ERRLINE+2772                                             04382000
         DC    CL1'1'                                                   04383000
         DC    X'09'                                                    04384000
         DC    CL10'DEBUG16  '                                          04385000
         DC    CL9'         '                                           04386000
         DC    CL2'  '                                                  04387000
         DC    CL40'FRAME SETS THAT FAILED NO MCH/CCH FOUND '           04388000
         ORG   ERRLINE+2835                                             04389000
         ORG   ERRLINE+2835                                             04390000
         DC    CL1'1'                                                   04391000
         DC    X'09'                                                    04392000
         DC    CL10'DEBUG16  '                                          04393000
         DC    CL9'         '                                           04394000
         DC    CL2'  '                                                  04395000
         DC    CL40'******IFCFILT1 DEBUG16 RECORD COUNTS****'           04396000
         ORG   ERRLINE+2898                                             04397000
IFCFILT1 CSECT                                                          04398000
         DC    S(SUPERZAP)                                              04399000
IFCFILT1 CSECT                                                          04400000
         DC    S(PATCH)                                                 04401000
IFCFILT1 CSECT                                                          04402000
MVCDATA  MVC  R0(R0,R6),0(R4)                                           04403000
IFCFILT1 CSECT                                                          04404000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04405000
@01      EQU   01                                                       04406000
@02      EQU   02                                                       04407000
@03      EQU   03                                                       04408000
@04      EQU   04                                                       04409000
@05      EQU   05                                                       04410000
@06      EQU   06                                                       04411000
@07      EQU   07                                                       04412000
@08      EQU   08                                                       04413000
@09      EQU   09                                                       04414000
@10      EQU   10                                                       04415000
@11      EQU   11                                                       04416000
@12      EQU   12                                                       04417000
@13      EQU   13                                                       04418000
@14      EQU   14                                                       04419000
@15      EQU   15                                                       04420000
R2       EQU   @02                                                      04421000
R7       EQU   @07                                                      04422000
R0       EQU   @00                                                      04423000
R1       EQU   @01                                                      04424000
R3       EQU   @03                                                      04425000
R4       EQU   @04                                                      04426000
R5       EQU   @05                                                      04427000
R6       EQU   @06                                                      04428000
R12      EQU   @12                                                      04429000
R15      EQU   @15                                                      04430000
R10      EQU   @10                                                      04431000
R11      EQU   @11                                                      04432000
R13      EQU   @13                                                      04433000
R14      EQU   @14                                                      04434000
R8       EQU   @08                                                      04435000
R9       EQU   @09                                                      04436000
IOHND    EQU   0                                                        04437000
IFCMSG   EQU   0                                                        04438000
PARM     EQU   0                                                        04439000
RECTYPE  EQU   PARM                                                     04440000
PMCH     EQU   RECTYPE                                                  04441000
PCHAN    EQU   RECTYPE                                                  04442000
POBR     EQU   RECTYPE                                                  04443000
PSOFT    EQU   RECTYPE                                                  04444000
PIPL     EQU   RECTYPE                                                  04445000
PDDR     EQU   RECTYPE                                                  04446000
PMIH     EQU   RECTYPE                                                  04447000
PEOD     EQU   RECTYPE                                                  04448000
PTTYP    EQU   RECTYPE+1                                                04449000
SWITCHES EQU   PARM+2                                                   04450000
ZEROALL  EQU   SWITCHES+1                                               04451000
DEVEXCL  EQU   SWITCHES+1                                               04452000
SHIFT3RD EQU   SWITCHES+1                                               04453000
DEBUG    EQU   PARM+4                                                   04454000
DEBUG4   EQU   DEBUG                                                    04455000
DEBUG11  EQU   DEBUG+1                                                  04456000
DEBUG16  EQU   DEBUG+2                                                  04457000
DEBUG23  EQU   DEBUG+2                                                  04458000
DEBUGA   EQU   PARM+8                                                   04459000
DEBUG49  EQU   DEBUGA+2                                                 04460000
MISC     EQU   PARM+12                                                  04461000
PACC     EQU   MISC                                                     04462000
PHIST    EQU   MISC                                                     04463000
PRINTES  EQU   MISC                                                     04464000
PEDIT    EQU   PRINTES                                                  04465000
PSUM     EQU   PRINTES                                                  04466000
ERRORID  EQU   MISC                                                     04467000
PLOGREC  EQU   MISC                                                     04468000
PASSFLAG EQU   MISC                                                     04469000
OPENCLSE EQU   PARM+13                                                  04470000
OPENIO   EQU   OPENCLSE                                                 04471000
CLOSEIO  EQU   OPENCLSE+2                                               04472000
CACCIN   EQU   CLOSEIO                                                  04473000
CACCDEV  EQU   CLOSEIO                                                  04474000
CDRCTWRK EQU   CLOSEIO                                                  04475000
DATENOW  EQU   PARM+17                                                  04476000
STDT     EQU   PARM+23                                                  04477000
STDATE   EQU   STDT                                                     04478000
PSTD     EQU   STDATE+1                                                 04479000
ENDDT    EQU   PARM+31                                                  04480000
ENDDATE  EQU   ENDDT                                                    04481000
PEND     EQU   ENDDATE+1                                                04482000
STTIME1  EQU   PARM+39                                                  04483000
ENDTIME1 EQU   PARM+43                                                  04484000
STTIME2  EQU   PARM+47                                                  04485000
ENDTIME2 EQU   PARM+51                                                  04486000
STRTDATE EQU   PARM+55                                                  04487000
TERM     EQU   PARM+58                                                  04488000
@NM00007 EQU   PARM+75                                                  04489000
TABSIZE  EQU   PARM+80                                                  04490000
SORTNUM  EQU   PARM+84                                                  04491000
ERRID    EQU   PARM+92                                                  04492000
IDVALUE  EQU   ERRID                                                    04493000
IDCPU    EQU   ERRID+3                                                  04494000
IDASID   EQU   ERRID+4                                                  04495000
IDTIMEA  EQU   ERRID+6                                                  04496000
IDTIME   EQU   IDTIMEA                                                  04497000
IDHOUR   EQU   IDTIME                                                   04498000
IDMIN    EQU   IDTIME+1                                                 04499000
IDSEC    EQU   IDTIME+2                                                 04500000
IDTSEC   EQU   IDTIME+3                                                 04501000
USERPGM  EQU   PARM+102                                                 04502000
CCHHRLNG EQU   PARM+112                                                 04503000
RECCCHHR EQU   CCHHRLNG                                                 04504000
RECLNGTH EQU   CCHHRLNG+6                                               04505000
ADIOHND  EQU   PARM+124                                                 04506000
ADIFCMSG EQU   PARM+128                                                 04507000
ADEDITB  EQU   PARM+132                                                 04508000
EVPTR    EQU   PARM+136                                                 04509000
SORTADR  EQU   PARM+140                                                 04510000
PRINTADR EQU   PARM+148                                                 04511000
CUAPTR   EQU   PARM+152                                                 04512000
DEVPTR   EQU   PARM+156                                                 04513000
MODPTR   EQU   PARM+160                                                 04514000
SERPTR   EQU   PARM+164                                                 04515000
VOLPTR   EQU   PARM+168                                                 04516000
CPUPTR   EQU   PARM+172                                                 04517000
CPCUAPTR EQU   PARM+176                                                 04518000
LIBADPTR EQU   PARM+180                                                 04519000
SYMCDPTR EQU   PARM+184                                                 04520000
SYSUMPTR EQU   PARM+188                                                 04521000
TRENPTR  EQU   PARM+192                                                 04522000
SHAREPTR EQU   PARM+196                                                 04523000
FRAMEPTR EQU   PARM+200                                                 04524000
MERDCPTR EQU   PARM+208                                                 04525000
DUMPTABL EQU   PARM+228                                                 04526000
DUMPINFO EQU   DUMPTABL+4                                               04527000
TRENDONE EQU   0                                                        04528000
TREGEN   EQU   TRENDONE+8                                               04529000
EVTABLE  EQU   0                                                        04530000
EVSTOP   EQU   EVTABLE                                                  04531000
EVKEY    EQU   EVTABLE+6                                                04532000
SORTABLE EQU   0                                                        04533000
SORTKEY  EQU   SORTABLE                                                 04534000
SORTCCHR EQU   SORTABLE+5                                               04535000
SYSUMONE EQU   0                                                        04536000
SHARE    EQU   0                                                        04537000
SHARENUM EQU   SHARE                                                    04538000
SHAREIO  EQU   SHARE+2                                                  04539000
SHRCUCPU EQU   SHAREIO                                                  04540000
SHARECUA EQU   SHRCUCPU                                                 04541000
SHAREDX  EQU   SHARECUA                                                 04542000
SHARSERA EQU   SHRCUCPU+2                                               04543000
SHARECUB EQU   SHAREIO+5                                                04544000
EDITLOAD EQU   0                                                        04545000
EDITABLE EQU   EDITLOAD+4                                               04546000
CUA      EQU   0                                                        04547000
CUANUM   EQU   CUA                                                      04548000
CUAVAL   EQU   CUA+2                                                    04549000
CUA1     EQU   CUAVAL                                                   04550000
CUA2     EQU   CUAVAL+2                                                 04551000
DEVICE   EQU   0                                                        04552000
DEVNUM   EQU   DEVICE                                                   04553000
DEVVAL   EQU   DEVICE+2                                                 04554000
MDRNUM   EQU   DEVICE+202                                               04555000
MDRVAL   EQU   DEVICE+204                                               04556000
MODELS   EQU   0                                                        04557000
MODNUM   EQU   MODELS                                                   04558000
MODVAL   EQU   MODELS+2                                                 04559000
DEVSERAL EQU   0                                                        04560000
VOLUME   EQU   0                                                        04561000
VOLNUM   EQU   VOLUME                                                   04562000
VOLVAL   EQU   VOLUME+2                                                 04563000
CPUS     EQU   0                                                        04564000
CPUNUM   EQU   CPUS                                                     04565000
CPUVAL   EQU   CPUS+2                                                   04566000
CPUCUAS  EQU   0                                                        04567000
CPCUANUM EQU   CPUCUAS                                                  04568000
CPUCUAV  EQU   CPUCUAS+2                                                04569000
CPUCUX1  EQU   CPUCUAV                                                  04570000
CPUCUX2  EQU   CPUCUAV+3                                                04571000
CPUCUX3  EQU   CPUCUAV+5                                                04572000
LIBADR   EQU   0                                                        04573000
LIBADNUM EQU   LIBADR                                                   04574000
LIBVAL   EQU   LIBADR+2                                                 04575000
SYMCODE  EQU   0                                                        04576000
SYMVAL   EQU   SYMCODE+2                                                04577000
TMT2     EQU   0                                                        04578000
TMTKEY   EQU   TMT2                                                     04579000
TMTSRT   EQU   TMTKEY+1                                                 04580000
TMTCPUS  EQU   TMTKEY+3                                                 04581000
TMTITEM  EQU   TMTKEY+4                                                 04582000
TMTPERM1 EQU   TMT2+8                                                   04583000
TMP2     EQU   0                                                        04584000
TMPKEY   EQU   TMP2                                                     04585000
TMPSRT   EQU   TMPKEY+1                                                 04586000
TMPCPUS  EQU   TMPKEY+3                                                 04587000
TMPITEM  EQU   TMPKEY+4                                                 04588000
TMPPERM1 EQU   TMP2+7                                                   04589000
MERIDIAN EQU   0                                                        04590000
MRDNUMBR EQU   MERIDIAN                                                 04591000
MODEL    EQU   MERIDIAN+2                                               04592000
LRTREC   EQU   0                                                        04593000
LRTKEY   EQU   LRTREC                                                   04594000
LRTKEY1  EQU   LRTKEY                                                   04595000
LRTSMS   EQU   LRTREC+2                                                 04596000
LRTNLAST EQU   LRTSMS                                                   04597000
LRTRUNC  EQU   LRTSMS                                                   04598000
LRTERRID EQU   LRTREC+3                                                 04599000
@NM00017 EQU   LRTREC+4                                                 04600000
LRTCNT   EQU   @NM00017+2                                               04601000
LRTDT    EQU   LRTREC+8                                                 04602000
LRTDATE  EQU   LRTDT                                                    04603000
LRTYRDAY EQU   LRTDATE+1                                                04604000
LRTTIME  EQU   LRTDT+4                                                  04605000
LRTCPU   EQU   LRTREC+16                                                04606000
LRTCPMOD EQU   LRTCPU+1                                                 04607000
LRTCPUS  EQU   LRTCPMOD                                                 04608000
LRTMODEL EQU   LRTCPMOD+3                                               04609000
MCHREC   EQU   0                                                        04610000
MCHHEAD  EQU   MCHREC                                                   04611000
MCHKEY   EQU   MCHHEAD                                                  04612000
MCHSMS   EQU   MCHHEAD+2                                                04613000
MCHCPUID EQU   MCHHEAD+16                                               04614000
CCHREC   EQU   0                                                        04615000
CCHHEAD  EQU   CCHREC                                                   04616000
CCHKEY   EQU   CCHHEAD                                                  04617000
CCHSMS   EQU   CCHHEAD+2                                                04618000
CCHCPUID EQU   CCHHEAD+16                                               04619000
CCHCODE  EQU   CCHREC+68                                                04620000
CCHCODE2 EQU   CCHCODE+2                                                04621000
CCHCUA   EQU   CCHREC+74                                                04622000
OBRREC   EQU   0                                                        04623000
OBRHEAD  EQU   OBRREC                                                   04624000
OBRKEY   EQU   OBRHEAD                                                  04625000
OBRKEY1  EQU   OBRKEY                                                   04626000
OBRSMS   EQU   OBRHEAD+2                                                04627000
MISCSW   EQU   OBRSMS                                                   04628000
OBRSUBTP EQU   OBRSMS+1                                                 04629000
SHORTSW  EQU   OBRSUBTP                                                 04630000
OBRCPUID EQU   OBRHEAD+16                                               04631000
OBRJOBID EQU   OBRREC+24                                                04632000
OBRSDEV2 EQU   OBRJOBID+2                                               04633000
OBRSCUA  EQU   OBRJOBID+5                                               04634000
OBRFCCW  EQU   OBRREC+32                                                04635000
OBRSRDS  EQU   OBRFCCW                                                  04636000
OBRCSW   EQU   OBRREC+40                                                04637000
OBRCODE  EQU   OBRREC+52                                                04638000
OBRDEV   EQU   OBRCODE+2                                                04639000
OBRPCUA  EQU   OBRREC+57                                                04640000
OBRVOL   EQU   OBRREC+64                                                04641000
OBRSEEK  EQU   OBRREC+70                                                04642000
OBRTCAM  EQU   OBRSEEK                                                  04643000
OBRTERMN EQU   OBRSEEK+2                                                04644000
SFTREC   EQU   0                                                        04645000
SFTHEAD  EQU   SFTREC                                                   04646000
SFTKEY   EQU   SFTHEAD                                                  04647000
SFTCPUID EQU   SFTHEAD+16                                               04648000
SFTSDWA  EQU   SFTREC+32                                                04649000
SFTAEC1  EQU   SFTSDWA+96                                               04650000
SFTFLGS  EQU   SFTSDWA+232                                              04651000
SFTRECP  EQU   SFTSDWA+292                                              04652000
IPLREC   EQU   0                                                        04653000
IPLHEAD  EQU   IPLREC                                                   04654000
IPLKEY   EQU   IPLHEAD                                                  04655000
IPLCPUID EQU   IPLHEAD+16                                               04656000
IPLSTIME EQU   IPLREC+52                                                04657000
DDRREC   EQU   0                                                        04658000
DDRHEAD  EQU   DDRREC                                                   04659000
DDRKEY   EQU   DDRHEAD                                                  04660000
DDRSMS   EQU   DDRHEAD+2                                                04661000
DDRCPUID EQU   DDRHEAD+16                                               04662000
@NM00052 EQU   DDRREC+24                                                04663000
DDRFCUA  EQU   DDRREC+45                                                04664000
DDRFDEV  EQU   DDRREC+48                                                04665000
DDRCODE2 EQU   DDRFDEV+2                                                04666000
DDRTODEV EQU   DDRREC+56                                                04667000
MIHREC   EQU   0                                                        04668000
MIHHEAD  EQU   MIHREC                                                   04669000
MIHKEY   EQU   MIHHEAD                                                  04670000
MIHCPUID EQU   MIHHEAD+16                                               04671000
@NM00058 EQU   MIHREC+24                                                04672000
MIHCUA   EQU   MIHREC+35                                                04673000
MIHDEV   EQU   MIHREC+44                                                04674000
MIHCODE2 EQU   MIHDEV+2                                                 04675000
EODREC   EQU   0                                                        04676000
EODHEAD  EQU   EODREC                                                   04677000
EODKEY   EQU   EODHEAD                                                  04678000
EODCPUID EQU   EODHEAD+16                                               04679000
TPRREC   EQU   0                                                        04680000
TPRHEAD  EQU   TPRREC                                                   04681000
TPRKEY   EQU   TPRHEAD                                                  04682000
TPRDEV   EQU   TPRHEAD+4                                                04683000
TPRBUFC  EQU   TPRHEAD+5                                                04684000
TPRCPUID EQU   TPRHEAD+16                                               04685000
TPRCUA   EQU   TPRREC+24                                                04686000
@NM00066 EQU   TPRREC+26                                                04687000
TPRVOL   EQU   @NM00066                                                 04688000
TPRLINAD EQU   TPRREC+36                                                04689000
TPRMODE  EQU   TPRREC+38                                                04690000
MCFREC   EQU   0                                                        04691000
MCFHEAD  EQU   MCFREC                                                   04692000
MCFKEY   EQU   MCFHEAD                                                  04693000
MCFSMS   EQU   MCFHEAD+2                                                04694000
@NM00074 EQU   MCFHEAD+16                                               04695000
MCFSMO   EQU   MCFHEAD+17                                               04696000
CCFREC   EQU   0                                                        04697000
CCFHEAD  EQU   CCFREC                                                   04698000
CCFKEY   EQU   CCFHEAD                                                  04699000
CCFSMS   EQU   CCFHEAD+2                                                04700000
@NM00082 EQU   CCFHEAD+16                                               04701000
CCFSMO   EQU   CCFHEAD+17                                               04702000
FRAMETAB EQU   0                                                        04703000
FRAMENUM EQU   FRAMETAB                                                 04704000
FRAMEDTA EQU   FRAMETAB+4                                               04705000
FRAMEKEY EQU   FRAMEDTA                                                 04706000
FRAMECPU EQU   FRAMEKEY                                                 04707000
FRAMESER EQU   FRAMECPU                                                 04708000
FRAMEMOD EQU   FRAMECPU+3                                               04709000
FRAMEDT  EQU   FRAMEKEY+5                                               04710000
FRAMETYP EQU   FRAMEKEY+13                                              04711000
FRAMLOCM EQU   FRAMEDTA+16                                              04712000
FRAMLOCC EQU   FRAMEDTA+20                                              04713000
LISTLOC  EQU   0                                                        04714000
LISTNUM  EQU   LISTLOC                                                  04715000
LISTCCHR EQU   LISTLOC+4                                                04716000
RERR     EQU   0                                                        04717000
RSEQ     EQU   RERR                                                     04718000
RCPU     EQU   RERR+3                                                   04719000
RASID    EQU   RERR+4                                                   04720000
RTIME    EQU   RERR+6                                                   04721000
NEXTBYTE EQU   0                                                        04722000
ADDNUM   EQU   0                                                        04723000
ERR78    EQU   PRINTBDY                                                 04724000
PFRAMMOD EQU   ERR78+27                                                 04725000
PFRAMSER EQU   ERR78+32                                                 04726000
ERR78161 EQU   PRINTBDY+19                                              04727000
TYPERROR EQU   ERR78161                                                 04728000
ZFRAMMOD EQU   ERR78161+11                                              04729000
ZFRAMSER EQU   ERR78161+16                                              04730000
ZFRAMKEY EQU   ERR78161+24                                              04731000
YFRAMMOD EQU   ERR78161+58                                              04732000
YFRAMSER EQU   ERR78161+63                                              04733000
YFRAMKEY EQU   ERR78161+71                                              04734000
SORTKEYY EQU   SORTKEY                                                  04735000
SORTCUA  EQU   SORTKEYY+2                                               04736000
LINTXT1B EQU   PRINTBDY+36                                              04737000
EDIFILD  EQU   PRINTBDY+7                                               04738000
EDFLD    EQU   EDIFILD                                                  04739000
CHAR1    EQU   CHARS                                                    04740000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04741000
SORTMOD  EQU   SORTCUA+1                                                04742000
SORTCU   EQU   SORTCUA                                                  04743000
SORTCHAN EQU   SORTKEYY+1                                               04744000
SORTYPE  EQU   SORTKEYY                                                 04745000
@NM00094 EQU   ERR78161+69                                              04746000
@NM00093 EQU   ERR78161+62                                              04747000
@NM00092 EQU   ERR78161+52                                              04748000
@NM00091 EQU   ERR78161+22                                              04749000
@NM00090 EQU   ERR78161+15                                              04750000
@NM00089 EQU   ERR78161+10                                              04751000
PFRAMKEY EQU   ERR78+44                                                 04752000
@NM00087 EQU   ERR78+38                                                 04753000
@NM00086 EQU   ERR78+31                                                 04754000
@NM00085 EQU   ERR78                                                    04755000
@NM00095 EQU   RERR+2                                                   04756000
FRAMETIM EQU   FRAMEDT+4                                                04757000
FRAMEDAT EQU   FRAMEDT                                                  04758000
CCFFRAME EQU   CCFREC+24                                                04759000
@NM00084 EQU   CCFHEAD+22                                               04760000
CCFMOD   EQU   CCFSMO+3                                                 04761000
CCFSER   EQU   CCFSMO                                                   04762000
CCFVER   EQU   @NM00082                                                 04763000
@NM00083 EQU   @NM00082                                                 04764000
CCFTIMD  EQU   CCFHEAD+12                                               04765000
CCFDAT   EQU   CCFHEAD+8                                                04766000
@NM00081 EQU   CCFHEAD+7                                                04767000
CCFCNT   EQU   CCFHEAD+6                                                04768000
@NM00080 EQU   CCFHEAD+4                                                04769000
@NM00079 EQU   CCFSMS+1                                                 04770000
CCFCPU   EQU   CCFSMS+1                                                 04771000
CCFMP    EQU   CCFSMS+1                                                 04772000
@NM00078 EQU   CCFSMS                                                   04773000
CCFTIM   EQU   CCFSMS                                                   04774000
@NM00077 EQU   CCFSMS                                                   04775000
CCFTRU   EQU   CCFSMS                                                   04776000
CCFTOD   EQU   CCFSMS                                                   04777000
CCFLST   EQU   CCFSMS                                                   04778000
CCFKEY2  EQU   CCFKEY+1                                                 04779000
CCFKEY1  EQU   CCFKEY                                                   04780000
MCFFRAME EQU   MCFREC+24                                                04781000
@NM00076 EQU   MCFHEAD+22                                               04782000
MCFMOD   EQU   MCFSMO+3                                                 04783000
MCFSER   EQU   MCFSMO                                                   04784000
MCFVER   EQU   @NM00074                                                 04785000
@NM00075 EQU   @NM00074                                                 04786000
MCFTIMD  EQU   MCFHEAD+12                                               04787000
MCFDAT   EQU   MCFHEAD+8                                                04788000
@NM00073 EQU   MCFHEAD+7                                                04789000
MCFCNT   EQU   MCFHEAD+6                                                04790000
@NM00072 EQU   MCFHEAD+4                                                04791000
@NM00071 EQU   MCFSMS+1                                                 04792000
MCFCPU   EQU   MCFSMS+1                                                 04793000
MCFMP    EQU   MCFSMS+1                                                 04794000
@NM00070 EQU   MCFSMS                                                   04795000
MCFTIM   EQU   MCFSMS                                                   04796000
@NM00069 EQU   MCFSMS                                                   04797000
MCFTRU   EQU   MCFSMS                                                   04798000
MCFTOD   EQU   MCFSMS                                                   04799000
MCFLST   EQU   MCFSMS                                                   04800000
MCFKEY2  EQU   MCFKEY+1                                                 04801000
MCFKEY1  EQU   MCFKEY                                                   04802000
DVBSDRE  EQU   TPRREC+56                                                04803000
@NM00068 EQU   TPRREC+39                                                04804000
@NM00067 EQU   TPRREC+34                                                04805000
TPRCEL   EQU   TPRCPUID+6                                               04806000
TPRMODEL EQU   TPRCPUID+4                                               04807000
TPRSER   EQU   TPRCPUID+1                                               04808000
@NM00065 EQU   TPRCPUID                                                 04809000
TPRTIME  EQU   TPRHEAD+12                                               04810000
TPRDATE  EQU   TPRHEAD+8                                                04811000
@NM00064 EQU   TPRHEAD+6                                                04812000
TPRLENGT EQU   TPRBUFC                                                  04813000
@NM00063 EQU   TPRBUFC                                                  04814000
TPRSMS   EQU   TPRHEAD+2                                                04815000
TPRKEY2  EQU   TPRKEY+1                                                 04816000
TPRKEY1  EQU   TPRKEY                                                   04817000
EODCEL   EQU   EODCPUID+6                                               04818000
EODMODEL EQU   EODCPUID+4                                               04819000
EODSER   EQU   EODCPUID+1                                               04820000
@NM00062 EQU   EODCPUID                                                 04821000
EODTIME  EQU   EODHEAD+12                                               04822000
EODDATE  EQU   EODHEAD+8                                                04823000
@NM00061 EQU   EODHEAD+5                                                04824000
EODDEV   EQU   EODHEAD+4                                                04825000
EODSMS   EQU   EODHEAD+2                                                04826000
EODKEY2  EQU   EODKEY+1                                                 04827000
EODKEY1  EQU   EODKEY                                                   04828000
MIHTYPE  EQU   MIHCODE2+1                                               04829000
MIHCLASS EQU   MIHCODE2                                                 04830000
@NM00060 EQU   MIHDEV                                                   04831000
MIHVOL   EQU   MIHREC+38                                                04832000
@NM00059 EQU   @NM00058+8                                               04833000
MIHJOBID EQU   @NM00058                                                 04834000
MIHCEL   EQU   MIHCPUID+6                                               04835000
MIHMOD   EQU   MIHCPUID+4                                               04836000
MIHSER   EQU   MIHCPUID+1                                               04837000
@NM00057 EQU   MIHCPUID                                                 04838000
MIHTIME  EQU   MIHHEAD+12                                               04839000
MIHDATE  EQU   MIHHEAD+8                                                04840000
@NM00056 EQU   MIHHEAD+6                                                04841000
@NM00055 EQU   MIHHEAD+5                                                04842000
MIHDEBIT EQU   MIHHEAD+5                                                04843000
MIHCEBIT EQU   MIHHEAD+5                                                04844000
@NM00054 EQU   MIHHEAD+4                                                04845000
MIHSMS   EQU   MIHHEAD+2                                                04846000
MIHKEY2  EQU   MIHKEY+1                                                 04847000
MIHKEY1  EQU   MIHKEY                                                   04848000
DDRDEV2  EQU   DDRTODEV+2                                               04849000
DDRDEV1  EQU   DDRTODEV                                                 04850000
DDRTOCUA EQU   DDRREC+53                                                04851000
@NM00053 EQU   DDRREC+52                                                04852000
DDRTYPE  EQU   DDRCODE2+1                                               04853000
DDRCLASS EQU   DDRCODE2                                                 04854000
DDRCODE1 EQU   DDRFDEV                                                  04855000
DDRPHD   EQU   @NM00052+20                                              04856000
DDRVOL2  EQU   @NM00052+14                                              04857000
DDRVOL1  EQU   @NM00052+8                                               04858000
DDRJOBID EQU   @NM00052                                                 04859000
DDRCEL   EQU   DDRCPUID+6                                               04860000
DDRMOD   EQU   DDRCPUID+4                                               04861000
DDRSER   EQU   DDRCPUID+1                                               04862000
@NM00051 EQU   DDRCPUID                                                 04863000
DDRTIME  EQU   DDRHEAD+12                                               04864000
DDRDATE  EQU   DDRHEAD+8                                                04865000
@NM00050 EQU   DDRHEAD+4                                                04866000
DDRDEPSW EQU   DDRSMS+1                                                 04867000
@NM00049 EQU   DDRSMS                                                   04868000
DDRKEY2  EQU   DDRKEY+1                                                 04869000
DDRKEY1  EQU   DDRKEY                                                   04870000
IPLSHSEC EQU   IPLSTIME+3                                               04871000
IPLSSEC  EQU   IPLSTIME+2                                               04872000
IPLSMIN  EQU   IPLSTIME+1                                               04873000
IPLSHOUR EQU   IPLSTIME                                                 04874000
IPLSDATE EQU   IPLREC+48                                                04875000
IPLTEMP  EQU   IPLREC+46                                                04876000
IPLHIGH  EQU   IPLREC+42                                                04877000
IPLCHAN  EQU   IPLREC+32                                                04878000
@NM00048 EQU   IPLREC+30                                                04879000
IPLREAS  EQU   IPLREC+28                                                04880000
@NM00047 EQU   IPLREC+25                                                04881000
IPLSYSID EQU   IPLREC+24                                                04882000
IPLCEL   EQU   IPLCPUID+6                                               04883000
IPLMOD   EQU   IPLCPUID+4                                               04884000
IPLSER   EQU   IPLCPUID+1                                               04885000
@NM00046 EQU   IPLCPUID                                                 04886000
IPLTIME  EQU   IPLHEAD+12                                               04887000
IPLDATE  EQU   IPLHEAD+8                                                04888000
@NM00045 EQU   IPLHEAD+4                                                04889000
IPLSMS   EQU   IPLHEAD+2                                                04890000
IPLKEY2  EQU   IPLKEY+1                                                 04891000
IPLKEY1  EQU   IPLKEY                                                   04892000
SFTXDATA EQU   SFTREC+434                                               04893000
SFTLVARA EQU   SFTREC+432                                               04894000
SFTREXN  EQU   SFTRECP+16                                               04895000
SFTCSECT EQU   SFTRECP+8                                                04896000
SFTMODN  EQU   SFTRECP                                                  04897000
@NM00044 EQU   SFTSDWA+238                                              04898000
SFTLCPUA EQU   SFTSDWA+236                                              04899000
SFTERRD  EQU   SFTFLGS+3                                                04900000
SFTERRC  EQU   SFTFLGS+2                                                04901000
SFTERRB  EQU   SFTFLGS+1                                                04902000
SFTERRA  EQU   SFTFLGS                                                  04903000
@NM00043 EQU   SFTSDWA+136                                              04904000
SFTAAEC1 EQU   SFTSDWA+120                                              04905000
@NM00042 EQU   SFTSDWA+112                                              04906000
SFTPROGC EQU   SFTAEC1+8                                                04907000
@NM00041 EQU   SFTAEC1                                                  04908000
@NM00040 EQU   SFTSDWA+88                                               04909000
SFTGRSV  EQU   SFTSDWA+24                                               04910000
SFTABNDC EQU   SFTSDWA                                                  04911000
SFTJOBID EQU   SFTREC+24                                                04912000
SFTCEL   EQU   SFTCPUID+6                                               04913000
SFTMOD   EQU   SFTCPUID+4                                               04914000
SFTSER   EQU   SFTCPUID+1                                               04915000
@NM00039 EQU   SFTCPUID                                                 04916000
SFTTIME  EQU   SFTHEAD+12                                               04917000
SFTDATE  EQU   SFTHEAD+8                                                04918000
@NM00038 EQU   SFTHEAD+4                                                04919000
SFTSMS   EQU   SFTHEAD+2                                                04920000
SFTKEY2  EQU   SFTKEY+1                                                 04921000
SFTKEY1  EQU   SFTKEY                                                   04922000
OBR34CT2 EQU   OBRTERMN+5                                               04923000
OBR34CT1 EQU   OBRTERMN+4                                               04924000
@NM00037 EQU   OBRTERMN                                                 04925000
@NM00036 EQU   OBRSEEK+1                                                04926000
OBRSBCNT EQU   OBRREC+62                                                04927000
OBRRETRY EQU   OBRREC+60                                                04928000
OBRLSDRC EQU   OBRREC+56                                                04929000
OBRTYPE  EQU   OBRDEV+1                                                 04930000
OBRCLASS EQU   OBRDEV                                                   04931000
OBRCODE1 EQU   OBRCODE                                                  04932000
OBRSECUA EQU   OBRREC+49                                                04933000
OBRDEVDC EQU   OBRREC+48                                                04934000
OBRSTAT  EQU   OBRCSW+4                                                 04935000
@NM00035 EQU   OBRCSW                                                   04936000
OBRSDRS2 EQU   OBRSRDS                                                  04937000
OBRSDRS1 EQU   OBRSRDS                                                  04938000
OBRSSDRC EQU   OBRJOBID+4                                               04939000
OBRSDEV1 EQU   OBRJOBID                                                 04940000
OBRCEL   EQU   OBRCPUID+6                                               04941000
OBRMOD   EQU   OBRCPUID+4                                               04942000
OBRSER   EQU   OBRCPUID+1                                               04943000
@NM00034 EQU   OBRCPUID                                                 04944000
OBRTIME  EQU   OBRHEAD+12                                               04945000
OBRDATE  EQU   OBRHEAD+8                                                04946000
@NM00033 EQU   OBRHEAD+4                                                04947000
@NM00032 EQU   OBRSUBTP                                                 04948000
DISMOUNT EQU   OBRSUBTP                                                 04949000
@NM00031 EQU   OBRSUBTP                                                 04950000
OBRTEMP  EQU   OBRSUBTP                                                 04951000
SDRCOUNT EQU   OBRSUBTP                                                 04952000
@NM00030 EQU   MISCSW                                                   04953000
TRUNC    EQU   MISCSW                                                   04954000
@NM00029 EQU   MISCSW                                                   04955000
OBRKEY2  EQU   OBRKEY+1                                                 04956000
CCHLOG   EQU   CCHREC+80                                                04957000
CCHMP    EQU   CCHREC+76                                                04958000
@NM00028 EQU   CCHREC+73                                                04959000
CCHID    EQU   CCHREC+72                                                04960000
CCHTYPE  EQU   CCHCODE2+1                                               04961000
CCHCLASS EQU   CCHCODE2                                                 04962000
CCHCODE1 EQU   CCHCODE                                                  04963000
CCHECSW  EQU   CCHREC+64                                                04964000
CCHCSW   EQU   CCHREC+56                                                04965000
CCHFCCW  EQU   CCHREC+48                                                04966000
CCHATIO  EQU   CCHREC+32                                                04967000
CCHJOBID EQU   CCHREC+24                                                04968000
CCHCEL   EQU   CCHCPUID+6                                               04969000
CCHMOD   EQU   CCHCPUID+4                                               04970000
CCHSER   EQU   CCHCPUID+1                                               04971000
@NM00027 EQU   CCHCPUID                                                 04972000
CCHTIME  EQU   CCHHEAD+12                                               04973000
CCHDATE  EQU   CCHHEAD+8                                                04974000
@NM00026 EQU   CCHHEAD+4                                                04975000
CCHRINC  EQU   CCHSMS+1                                                 04976000
@NM00025 EQU   CCHSMS                                                   04977000
CCHRCRH  EQU   CCHSMS                                                   04978000
@NM00024 EQU   CCHSMS                                                   04979000
CCHKEY2  EQU   CCHKEY+1                                                 04980000
CCHKEY1  EQU   CCHKEY                                                   04981000
MCHLOG   EQU   MCHREC+48                                                04982000
MCHOPSW  EQU   MCHREC+40                                                04983000
MCHJOBID EQU   MCHREC+32                                                04984000
MCHPGMID EQU   MCHREC+24                                                04985000
MCHCEL   EQU   MCHCPUID+6                                               04986000
MCHMOD   EQU   MCHCPUID+4                                               04987000
MCHSER   EQU   MCHCPUID+1                                               04988000
@NM00023 EQU   MCHCPUID                                                 04989000
MCHTIME  EQU   MCHHEAD+12                                               04990000
MCHDATE  EQU   MCHHEAD+8                                                04991000
@NM00022 EQU   MCHHEAD+4                                                04992000
MCHSYSTR EQU   MCHSMS+1                                                 04993000
@NM00021 EQU   MCHSMS                                                   04994000
MCHKEY2  EQU   MCHKEY+1                                                 04995000
MCHKEY1  EQU   MCHKEY                                                   04996000
LRTMCEL  EQU   LRTCPU+6                                                 04997000
@NM00020 EQU   LRTCPU                                                   04998000
LRTHSECS EQU   LRTTIME+3                                                04999000
LRTSEC   EQU   LRTTIME+2                                                05000000
LRTMIN   EQU   LRTTIME+1                                                05001000
LRTHOUR  EQU   LRTTIME                                                  05002000
LRTDAY   EQU   LRTYRDAY+1                                               05003000
LRTYEAR  EQU   LRTYRDAY                                                 05004000
LRTDATE0 EQU   LRTDATE                                                  05005000
@NM00019 EQU   @NM00017+3                                               05006000
@NM00018 EQU   @NM00017                                                 05007000
LRTDSMNT EQU   LRTERRID                                                 05008000
@NM00016 EQU   LRTERRID                                                 05009000
LRTSHRT  EQU   LRTERRID                                                 05010000
@NM00015 EQU   LRTERRID                                                 05011000
@NM00014 EQU   LRTSMS                                                   05012000
LRTIMCNV EQU   LRTSMS                                                   05013000
@NM00013 EQU   LRTSMS                                                   05014000
LRNS     EQU   LRTSMS                                                   05015000
LRTKEY2  EQU   LRTKEY+1                                                 05016000
TMPTEMP  EQU   TMP2+9                                                   05017000
TMPPERM  EQU   TMPPERM1+1                                               05018000
@NM00012 EQU   TMPPERM1                                                 05019000
TMPDEV   EQU   TMPKEY+5                                                 05020000
TMPOLDA  EQU   TMPITEM                                                  05021000
TMP3705  EQU   TMPITEM                                                  05022000
TMPOLD   EQU   TMPCPUS                                                  05023000
TMPCPU   EQU   TMPCPUS                                                  05024000
TMPCUA   EQU   TMPSRT                                                   05025000
TMPGROUP EQU   TMPKEY                                                   05026000
TMTTEMP  EQU   TMT2+10                                                  05027000
TMTPERM  EQU   TMTPERM1+1                                               05028000
@NM00011 EQU   TMTPERM1                                                 05029000
TMTDEV   EQU   TMTKEY+6                                                 05030000
TMTDAT   EQU   TMTKEY+5                                                 05031000
TMTOLDA  EQU   TMTITEM                                                  05032000
TMT3705  EQU   TMTITEM                                                  05033000
TMTOLD   EQU   TMTCPUS                                                  05034000
TMTCPU   EQU   TMTCPUS                                                  05035000
TMTCUA   EQU   TMTSRT                                                   05036000
TMTGROUP EQU   TMTKEY                                                   05037000
SYMVAL2  EQU   SYMVAL+2                                                 05038000
SYMVAL1  EQU   SYMVAL                                                   05039000
SYMCDNUM EQU   SYMCODE                                                  05040000
SERVAL   EQU   DEVSERAL+2                                               05041000
SERNUM   EQU   DEVSERAL                                                 05042000
LOADPTR  EQU   EDITABLE+8                                               05043000
LOADNAME EQU   EDITABLE                                                 05044000
EDITNUM  EQU   EDITLOAD                                                 05045000
SHARLET  EQU   SHAREIO+10                                               05046000
SHARSERB EQU   SHAREIO+7                                                05047000
SYSUMEOD EQU   SYSUMONE+96                                              05048000
SYSUMPER EQU   SYSUMONE+92                                              05049000
SYSUMPEA EQU   SYSUMONE+88                                              05050000
SYSUMPEI EQU   SYSUMONE+84                                              05051000
SYSUMCH  EQU   SYSUMONE+20                                              05052000
SYSUMMCN EQU   SYSUMONE+16                                              05053000
SYSUMMCR EQU   SYSUMONE+12                                              05054000
SYSUMNXT EQU   SYSUMONE+8                                               05055000
SYSUMIPL EQU   SYSUMONE+4                                               05056000
SYSUMNUM EQU   SYSUMONE                                                 05057000
SORTCORE EQU   SORTCCHR                                                 05058000
SORTTIME EQU   SORTKEY+1                                                05059000
SORTYEAR EQU   SORTKEY                                                  05060000
EVLETTER EQU   EVKEY+5                                                  05061000
EVSERIAL EQU   EVKEY+2                                                  05062000
EVMODEL  EQU   EVKEY                                                    05063000
EVNUM    EQU   EVTABLE+4                                                05064000
EVDAY    EQU   EVSTOP+1                                                 05065000
EVYEAR   EQU   EVSTOP                                                   05066000
TREPRE   EQU   TREGEN+72                                                05067000
TRECCHF  EQU   TREGEN+68                                                05068000
TRECCHE  EQU   TREGEN+64                                                05069000
TRECCHD  EQU   TREGEN+60                                                05070000
TRECCHC  EQU   TREGEN+56                                                05071000
TRECCHB  EQU   TREGEN+52                                                05072000
TRECCHA  EQU   TREGEN+48                                                05073000
TRECCH9  EQU   TREGEN+44                                                05074000
TRECCH8  EQU   TREGEN+40                                                05075000
TRECCH7  EQU   TREGEN+36                                                05076000
TRECCH6  EQU   TREGEN+32                                                05077000
TRECCH5  EQU   TREGEN+28                                                05078000
TRECCH4  EQU   TREGEN+24                                                05079000
TRECCH3  EQU   TREGEN+20                                                05080000
TRECCH2  EQU   TREGEN+16                                                05081000
TRECCH1  EQU   TREGEN+12                                                05082000
TRECCH0  EQU   TREGEN+8                                                 05083000
TREMCH   EQU   TREGEN+4                                                 05084000
TREIPL   EQU   TREGEN                                                   05085000
TRENUM   EQU   TRENDONE+4                                               05086000
TRENEXT  EQU   TRENDONE                                                 05087000
DUMPSIZE EQU   DUMPINFO+4                                               05088000
DUMPADR  EQU   DUMPINFO                                                 05089000
DUMPNUM  EQU   DUMPTABL                                                 05090000
@NM00010 EQU   PARM+212                                                 05091000
RECLNGT1 EQU   PARM+204                                                 05092000
ADCPUT   EQU   PARM+144                                                 05093000
LINECT   EQU   PARM+120                                                 05094000
@NM00009 EQU   CCHHRLNG+5                                               05095000
@NM00008 EQU   ERRID+2                                                  05096000
NUMDAYS  EQU   PARM+88                                                  05097000
SYSRETRN EQU   @NM00007                                                 05098000
@NM00006 EQU   PARM+72                                                  05099000
WRTHRSH  EQU   PARM+69                                                  05100000
RDTHRSH  EQU   PARM+66                                                  05101000
EVSDAY   EQU   STRTDATE+1                                               05102000
EVSYEAR  EQU   STRTDATE                                                 05103000
PENSEC2  EQU   ENDTIME2+2                                               05104000
PENMIN2  EQU   ENDTIME2+1                                               05105000
PENHOUR2 EQU   ENDTIME2                                                 05106000
PSTSEC2  EQU   STTIME2+2                                                05107000
PSTMIN2  EQU   STTIME2+1                                                05108000
PSTHOUR2 EQU   STTIME2                                                  05109000
PENSEC1  EQU   ENDTIME1+2                                               05110000
PENMIN1  EQU   ENDTIME1+1                                               05111000
PENHOUR1 EQU   ENDTIME1                                                 05112000
PSTSEC1  EQU   STTIME1+2                                                05113000
PSTMIN1  EQU   STTIME1+1                                                05114000
PSTHOUR1 EQU   STTIME1                                                  05115000
@NM00005 EQU   ENDDT+4                                                  05116000
PENDY    EQU   PEND+1                                                   05117000
PENYR    EQU   PEND                                                     05118000
@NM00004 EQU   ENDDATE                                                  05119000
@NM00003 EQU   STDT+4                                                   05120000
PSTDY    EQU   PSTD+1                                                   05121000
PSTYR    EQU   PSTD                                                     05122000
@NM00002 EQU   STDATE                                                   05123000
YEARNOW  EQU   DATENOW+4                                                05124000
@NM00001 EQU   DATENOW+3                                                05125000
DAYNOW   EQU   DATENOW                                                  05126000
CSNAP    EQU   CLOSEIO                                                  05127000
CSYSIN   EQU   CLOSEIO                                                  05128000
CSERLOG  EQU   CLOSEIO                                                  05129000
CEREPPT  EQU   CLOSEIO                                                  05130000
CTOURIST EQU   CLOSEIO                                                  05131000
OSNAP    EQU   OPENIO                                                   05132000
ODRCTWRK EQU   OPENIO                                                   05133000
OSYSIN   EQU   OPENIO                                                   05134000
OACCDEV  EQU   OPENIO                                                   05135000
OACCIN   EQU   OPENIO                                                   05136000
OSERLOG  EQU   OPENIO                                                   05137000
OEREPPT  EQU   OPENIO                                                   05138000
OTOURIST EQU   OPENIO                                                   05139000
PZERO    EQU   MISC                                                     05140000
DEBUG63  EQU   DEBUGA+3                                                 05141000
DEBUG62  EQU   DEBUGA+3                                                 05142000
DEBUG61  EQU   DEBUGA+3                                                 05143000
DEBUG60  EQU   DEBUGA+3                                                 05144000
DEBUG59  EQU   DEBUGA+3                                                 05145000
DEBUG58  EQU   DEBUGA+3                                                 05146000
DEBUG57  EQU   DEBUGA+3                                                 05147000
DEBUG56  EQU   DEBUGA+3                                                 05148000
DEBUG55  EQU   DEBUGA+2                                                 05149000
DEBUG54  EQU   DEBUGA+2                                                 05150000
DEBUG53  EQU   DEBUGA+2                                                 05151000
DEBUG52  EQU   DEBUGA+2                                                 05152000
DEBUG51  EQU   DEBUGA+2                                                 05153000
DEBUG50  EQU   DEBUGA+2                                                 05154000
DEBUG48  EQU   DEBUGA+2                                                 05155000
DEBUG47  EQU   DEBUGA+1                                                 05156000
DEBUG46  EQU   DEBUGA+1                                                 05157000
DEBUG45  EQU   DEBUGA+1                                                 05158000
DEBUG44  EQU   DEBUGA+1                                                 05159000
DEBUG43  EQU   DEBUGA+1                                                 05160000
DEBUG42  EQU   DEBUGA+1                                                 05161000
DEBUG41  EQU   DEBUGA+1                                                 05162000
DEBUG40  EQU   DEBUGA+1                                                 05163000
DEBUG39  EQU   DEBUGA                                                   05164000
DEBUG38  EQU   DEBUGA                                                   05165000
DEBUG37  EQU   DEBUGA                                                   05166000
DEBUG36  EQU   DEBUGA                                                   05167000
DEBUG35  EQU   DEBUGA                                                   05168000
DEBUG34  EQU   DEBUGA                                                   05169000
DEBUG33  EQU   DEBUGA                                                   05170000
DEBUG32  EQU   DEBUGA                                                   05171000
DEBUG31  EQU   DEBUG+3                                                  05172000
DEBUG30  EQU   DEBUG+3                                                  05173000
DEBUG29  EQU   DEBUG+3                                                  05174000
DEBUG28  EQU   DEBUG+3                                                  05175000
DEBUG27  EQU   DEBUG+3                                                  05176000
DEBUG26  EQU   DEBUG+3                                                  05177000
DEBUG25  EQU   DEBUG+3                                                  05178000
DEBUG24  EQU   DEBUG+3                                                  05179000
DEBUG22  EQU   DEBUG+2                                                  05180000
DEBUG21  EQU   DEBUG+2                                                  05181000
DEBUG20  EQU   DEBUG+2                                                  05182000
DEBUG19  EQU   DEBUG+2                                                  05183000
DEBUG18  EQU   DEBUG+2                                                  05184000
DEBUG17  EQU   DEBUG+2                                                  05185000
DEBUG15  EQU   DEBUG+1                                                  05186000
DEBUG14  EQU   DEBUG+1                                                  05187000
DEBUG13  EQU   DEBUG+1                                                  05188000
DEBUG12  EQU   DEBUG+1                                                  05189000
DEBUG10  EQU   DEBUG+1                                                  05190000
DEBUG9   EQU   DEBUG+1                                                  05191000
DEBUG8   EQU   DEBUG+1                                                  05192000
DEBUG7   EQU   DEBUG                                                    05193000
DEBUG6   EQU   DEBUG                                                    05194000
DEBUG5   EQU   DEBUG                                                    05195000
DEBUG3   EQU   DEBUG                                                    05196000
DEBUG2   EQU   DEBUG                                                    05197000
DEBUG1   EQU   DEBUG                                                    05198000
DEBUG0   EQU   DEBUG                                                    05199000
SORTBRK  EQU   SWITCHES+1                                               05200000
COREFAIL EQU   SWITCHES+1                                               05201000
ANALYSIS EQU   SWITCHES+1                                               05202000
NOTALL   EQU   SWITCHES+1                                               05203000
NOSDR    EQU   SWITCHES                                                 05204000
TIMESEQ  EQU   SWITCHES                                                 05205000
SYSUM    EQU   SWITCHES                                                 05206000
PARMTHR  EQU   SWITCHES                                                 05207000
TREND    EQU   SWITCHES                                                 05208000
SHORTOBR EQU   SWITCHES                                                 05209000
PARMMES  EQU   SWITCHES                                                 05210000
RDESUM   EQU   SWITCHES                                                 05211000
PCCHFRAM EQU   RECTYPE+1                                                05212000
PMCHFRAM EQU   RECTYPE+1                                                05213000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05214000
@RC00204 EQU   @RC00201                                                 05215000
@RC00264 EQU   @RC00262                                                 05216000
@RF00376 EQU   @EL00003                                                 05217000
@RF00386 EQU   @EL00004                                                 05218000
@RF00389 EQU   @EL00004                                                 05219000
@RF00396 EQU   @EL00004                                                 05220000
@RC00404 EQU   @EL00005                                                 05221000
@RC00454 EQU   @EL00006                                                 05222000
@RC00457 EQU   @EL00006                                                 05223000
@RC00460 EQU   @EL00006                                                 05224000
@RC00463 EQU   @EL00006                                                 05225000
@RC00466 EQU   @EL00006                                                 05226000
@RC00469 EQU   @EL00006                                                 05227000
@RC00472 EQU   @EL00006                                                 05228000
@RC00475 EQU   @EL00006                                                 05229000
@RC00478 EQU   @EL00006                                                 05230000
@RF00491 EQU   @EL00007                                                 05231000
@RF00501 EQU   @EL00008                                                 05232000
@RC00508 EQU   @EL00009                                                 05233000
@RC00527 EQU   @EL00009                                                 05234000
@RC00561 EQU   @EL00010                                                 05235000
@RC00572 EQU   @EL00010                                                 05236000
@RC00617 EQU   @EL00011                                                 05237000
@RC00627 EQU   @EL00011                                                 05238000
@RC00644 EQU   @EL00012                                                 05239000
@RC00654 EQU   @EL00012                                                 05240000
@RC00671 EQU   @EL00013                                                 05241000
@RC00681 EQU   @EL00013                                                 05242000
@RF00696 EQU   @EL00014                                                 05243000
@RC00703 EQU   @EL00015                                                 05244000
@RC00711 EQU   @EL00016                                                 05245000
@RC00719 EQU   @EL00016                                                 05246000
@RC00727 EQU   @EL00017                                                 05247000
@RF00735 EQU   @EL00017                                                 05248000
@RC00740 EQU   @EL00018                                                 05249000
@RF00769 EQU   @EL00019                                                 05250000
@RF00783 EQU   @EL00020                                                 05251000
@RC00787 EQU   @EL00021                                                 05252000
@RF00801 EQU   @EL00021                                                 05253000
@RF00808 EQU   @EL00021                                                 05254000
@RF00814 EQU   @EL00022                                                 05255000
@RF00817 EQU   @EL00022                                                 05256000
@RC00826 EQU   @EL00023                                                 05257000
@RC00838 EQU   @EL00023                                                 05258000
@RF00884 EQU   @RC00882                                                 05259000
@RF00901 EQU   @RC00882                                                 05260000
@RC00985 EQU   @RC00983                                                 05261000
@RF01003 EQU   @EL00027                                                 05262000
@RF01052 EQU   @RC01010                                                 05263000
@RF01057 EQU   @EL00028                                                 05264000
@RC01059 EQU   @EL00028                                                 05265000
@RF01094 EQU   @EL00029                                                 05266000
@RC01129 EQU   @EL00030                                                 05267000
@RC01106 EQU   @EL00030                                                 05268000
@RF01146 EQU   @EL00030                                                 05269000
@RF01193 EQU   @EL00031                                                 05270000
@RF01203 EQU   @RC01201                                                 05271000
@RC01221 EQU   @EL00033                                                 05272000
@RF01315 EQU   @EL00038                                                 05273000
@PB00040 EQU   @EL00001                                                 05274000
@RC00269 EQU   @RC00264                                                 05275000
@RC00406 EQU   @RC00404                                                 05276000
@RC00531 EQU   @RC00527                                                 05277000
@RC00576 EQU   @RC00572                                                 05278000
@RC00631 EQU   @RC00627                                                 05279000
@RC00658 EQU   @RC00654                                                 05280000
@RC00742 EQU   @RC00740                                                 05281000
@RF00745 EQU   @RC00740                                                 05282000
@RC00747 EQU   @RC00740                                                 05283000
@RC00750 EQU   @RC00740                                                 05284000
@RF00754 EQU   @RC00740                                                 05285000
@RF00789 EQU   @RC00787                                                 05286000
@RF00796 EQU   @RC00787                                                 05287000
@RF00831 EQU   @RC00826                                                 05288000
@RC00841 EQU   @RC00838                                                 05289000
@RC01063 EQU   @RC01059                                                 05290000
@RC01108 EQU   @RC01106                                                 05291000
@RF01125 EQU   @RC01106                                                 05292000
@RF01228 EQU   @RC01221                                                 05293000
@PB00039 EQU   @PB00040                                                 05294000
@RF00434 EQU   @RC00406                                                 05295000
@RC00535 EQU   @RC00531                                                 05296000
@RC00580 EQU   @RC00576                                                 05297000
@RF00635 EQU   @RC00631                                                 05298000
@RF00662 EQU   @RC00658                                                 05299000
@RF00845 EQU   @RC00841                                                 05300000
@RF00847 EQU   @RC00841                                                 05301000
@RC00849 EQU   @RC00841                                                 05302000
@RC00856 EQU   @RC00841                                                 05303000
@PB00038 EQU   @PB00039                                                 05304000
@RC00539 EQU   @RC00535                                                 05305000
@RC00584 EQU   @RC00580                                                 05306000
@PB00037 EQU   @PB00038                                                 05307000
@RC00542 EQU   @RC00539                                                 05308000
@RC00588 EQU   @RC00584                                                 05309000
@PB00036 EQU   @PB00037                                                 05310000
@RF00546 EQU   @RC00542                                                 05311000
@RF00599 EQU   @RC00588                                                 05312000
@PB00035 EQU   @PB00036                                                 05313000
@PB00034 EQU   @PB00035                                                 05314000
@PB00033 EQU   @PB00034                                                 05315000
@PB00032 EQU   @PB00033                                                 05316000
@PB00031 EQU   @PB00032                                                 05317000
@PB00030 EQU   @PB00031                                                 05318000
@PB00029 EQU   @PB00030                                                 05319000
@PB00028 EQU   @PB00029                                                 05320000
@PB00027 EQU   @PB00028                                                 05321000
@PB00026 EQU   @PB00027                                                 05322000
@PB00025 EQU   @PB00026                                                 05323000
@PB00024 EQU   @PB00025                                                 05324000
@PB00023 EQU   @PB00024                                                 05325000
@PB00022 EQU   @PB00023                                                 05326000
@PB00021 EQU   @PB00022                                                 05327000
@PB00020 EQU   @PB00021                                                 05328000
@PB00019 EQU   @PB00020                                                 05329000
@PB00018 EQU   @PB00019                                                 05330000
@PB00017 EQU   @PB00018                                                 05331000
@PB00016 EQU   @PB00017                                                 05332000
@PB00015 EQU   @PB00016                                                 05333000
@PB00014 EQU   @PB00015                                                 05334000
@PB00013 EQU   @PB00014                                                 05335000
@PB00012 EQU   @PB00013                                                 05336000
@PB00011 EQU   @PB00012                                                 05337000
@PB00010 EQU   @PB00011                                                 05338000
@PB00009 EQU   @PB00010                                                 05339000
@PB00008 EQU   @PB00009                                                 05340000
@PB00007 EQU   @PB00008                                                 05341000
@PB00006 EQU   @PB00007                                                 05342000
@PB00005 EQU   @PB00006                                                 05343000
@PB00004 EQU   @PB00005                                                 05344000
@PB00003 EQU   @PB00004                                                 05345000
@PB00002 EQU   @PB00003                                                 05346000
@RF00241 EQU   @PB00002                                                 05347000
@ENDDATA EQU   *                                                        05348000
         END   IFCFILT1                                                 05349000
