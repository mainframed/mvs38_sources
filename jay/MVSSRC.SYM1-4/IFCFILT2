         TITLE 'IFCFILT2-RECORD FILTER FOR SYSTEM SUMMARY REPORT       *00001000
                        '                                               00002000
IFCFILT2 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IFCFILT2  78.079'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         STM   @00,@12,20(@13)                                     0001 00011000
         BALR  @12,0                                               0001 00012000
@PSTART  LA    @11,4095(,@12)                                      0001 00013000
         LA    @10,4095(,@11)                                      0001 00014000
         LA    @09,4095(,@10)                                      0001 00015000
         USING @PSTART,@12                                         0001 00016000
         USING @PSTART+4095,@11                                    0001 00017000
         USING @PSTART+8190,@10                                    0001 00018000
         USING @PSTART+12285,@09                                   0001 00019000
         ST    @13,@SA00001+4                                      0001 00020000
         LA    @14,@SA00001                                        0001 00021000
         ST    @14,8(,@13)                                         0001 00022000
         LR    @13,@14                                             0001 00023000
* IF DEBUG4 = ON THEN    /*PRINT THE NAME AND COMPILE DATE   @Z427VLS*/ 00024000
         TM    DEBUG4(R2),B'00001000'                              0192 00025000
         BNO   @RF00192                                            0192 00026000
*  DO;                                                     /*@Z427VLS*/ 00027000
*   R15 = R12 - 27;                                        /*@Z427VLS*/ 00028000
         LR    R15,R12                                             0194 00029000
         SL    R15,@CF01102                                        0194 00030000
*   GEN(MVC  PRINTBDY(16),0(R15));                         /*@Z427VLS*/ 00031000
         MVC  PRINTBDY(16),0(R15)                                       00032000
*   PRINTADR = ADDR(PRINTLIN);  /*SET UP IOHND COMM          @Z427VLS*/ 00033000
         LA    @14,PRINTLIN                                        0196 00034000
         ST    @14,PRINTADR(,R2)                                   0196 00035000
*   CALL  IOHND(RITEPRTR);                                 /*@Z427VLS*/ 00036000
         L     @15,ADIOHND(,R2)                                    0197 00037000
         LA    @01,@AL00197                                        0197 00038000
         BALR  @14,@15                                             0197 00039000
*   R15 = ZERO;                                            /*@Z427VLS*/ 00040000
         SLR   R15,R15                                             0198 00041000
*  END;                                                    /*@Z427VLS*/ 00042000
*  ZERO5 = ZERO5 && ZERO5;/*COMPAR WILL ALWAYS WORK NO MATTER LENG*/    00043000
@RF00192 XC    ZERO5(5),ZERO5                                      0200 00044000
*                         /* OF A SORT TABLE ENTRY           @Z427VLS*/ 00045000
*                  /*PROCESS ERROR RECORDS SEQUENTIALLY      @Z427VLS*/ 00046000
*  CALL INITAB;    /*GET CORE FOR SYSUM2, EVTABLE, AND ONE ENTRY  */    00047000
         BAL   @14,INITAB                                          0201 00048000
*                  /*OF SYSUMONE AND STSUMONE.               @Z427VLS*/ 00049000
*  R15 = ERROR; /*GET RETURN CODES FROM INITAB               @Z427VLS*/ 00050000
         L     R15,ERROR                                           0202 00051000
*DO WHILE R15 = SUCCESS & ENTRIES < MAXENT;                /*@0099VLS*/ 00052000
         B     @DE00203                                            0203 00053000
@DL00203 DS    0H                                                  0204 00054000
*                                     /*DONT SET LAST ENTRY  @Z427VLS*/ 00055000
*    CALL IOHND(READSEQ);                        /*GET A RECORD*/  0204 00056000
         L     @15,ADIOHND(,R2)                                    0204 00057000
         LA    @01,@AL00204                                        0204 00058000
         BALR  @14,@15                                             0204 00059000
*    IF R15 = SUCCESS THEN  /*CONTINUE IF NOT EOF OR UNREADABLE*/  0205 00060000
         LTR   R15,R15                                             0205 00061000
         BNZ   @RF00205                                            0205 00062000
*      DO;                                                 /*@Z427VLS*/ 00063000
*        BUG(21) = BUG(21) + 1; /*NUMBER OF RECORDS RETRIEVED*/    0207 00064000
         LA    @14,1                                               0207 00065000
         AL    @14,BUG+80                                          0207 00066000
         ST    @14,BUG+80                                          0207 00067000
*IF ((LRTKEY1 & GENREC) = HEXA0)|   /* IF MCH OR CCH FRAME RECORD */    00068000
*   ((LRTKEY1 & GENREC) = HEXB0) THEN                              0208 00069000
         MVC   @TS00001(1),LRTKEY1(R7)                             0208 00070000
         NI    @TS00001,X'F0'                                      0208 00071000
         CLI   @TS00001,X'A0'                                      0208 00072000
         BE    @RT00208                                            0208 00073000
         MVC   @TS00001(1),LRTKEY1(R7)                             0208 00074000
         NI    @TS00001,X'F0'                                      0208 00075000
         CLI   @TS00001,X'B0'                                      0208 00076000
         BNE   @RF00208                                            0208 00077000
@RT00208 DS    0H                                                  0209 00078000
* DO;                                                      /*@G51DGBB*/ 00079000
*  CALL FLIMFRAM; /*PROCESS FRAME RECORDS                    @G51DGBB*/ 00080000
         BAL   @14,FLIMFRAM                                        0210 00081000
*  R15 = ERROR; /*GET FRAME PROCESSING ERROR CONDITIONS      @G51DGBB*/ 00082000
         L     R15,ERROR                                           0211 00083000
* END;                                                     /*@G51DGBB*/ 00084000
*ELSE  /*NORMAL ERROR RECORD PROCESSING                      @G51DGBB*/ 00085000
*  DO; /*NON FRAME RECORDS                                   @G51DGBB*/ 00086000
         B     @RC00208                                            0213 00087000
@RF00208 DS    0H                                                  0214 00088000
*        CALL ALLREC;          /*SELECT BY RECORD HEADER CRITERIA*/     00089000
         BAL   @14,ALLREC                                          0214 00090000
*        IF PASSFLAG = YES THEN                                    0215 00091000
         TM    PASSFLAG(R2),B'00000001'                            0215 00092000
         BNO   @RF00215                                            0215 00093000
*          DO;                                             /*@Z427VLS*/ 00094000
*            BUG(22) = BUG(22) + 1; /*PASS DATE, TIME FILTER COUNT*/    00095000
         LA    @14,1                                               0217 00096000
         AL    @14,BUG+84                                          0217 00097000
         ST    @14,BUG+84                                          0217 00098000
*            CALL RECDEP; /*ADD TO SYSUMONE,SYSUM2 IF PASS   @Z427VLS*/ 00099000
         BAL   @14,RECDEP                                          0218 00100000
*       IF LRTYRDAY > EVSTOP THEN    /*CHECK IF REC TIME > LAST*/  0219 00101000
         L     @14,EVPTR(,R2)                                      0219 00102000
         CLC   LRTYRDAY(3,R7),EVSTOP(@14)                          0219 00103000
         BNH   @RF00219                                            0219 00104000
*        EVSTOP = LRTYRDAY;        /*THEN CHANGE LAST DAY FOR REPORT*/  00105000
         MVC   EVSTOP(3,@14),LRTYRDAY(R7)                          0220 00106000
*       IF LRTYRDAY < STRTDATE THEN  /*CHECK START DAY FOR NEW LOW*/    00107000
@RF00219 CLC   LRTYRDAY(3,R7),STRTDATE(R2)                         0221 00108000
         BNL   @RF00221                                            0221 00109000
*        STRTDATE = LRTYRDAY;        /*CHANGE START DATE OF DATA */     00110000
         MVC   STRTDATE(3,R2),LRTYRDAY(R7)                         0222 00111000
*            IF PACC = YES THEN    /*HISTORY D.S. TO BE CREATED*/  0223 00112000
@RF00221 TM    PACC(R2),B'01000000'                                0223 00113000
         BNO   @RF00223                                            0223 00114000
*                CALL IOHND(RITEHIST);  /*WRITE TO ACCDEV    @Z427VLS*/ 00115000
         L     @15,ADIOHND(,R2)                                    0224 00116000
         LA    @01,@AL00224                                        0224 00117000
         BALR  @14,@15                                             0224 00118000
*               IF R15 = SUCCESS & SYSUMKEY  ^= ZERO5              0225 00119000
*               THEN DO; /*NO ERRORS PLUS ENTRY FOR NON 0 CPU CREATED*/ 00120000
@RF00223 LTR   R15,R15                                             0225 00121000
         BNZ   @RF00225                                            0225 00122000
         CLC   SYSUMKEY(5),ZERO5                                   0225 00123000
         BE    @RF00225                                            0225 00124000
*               /*IF IF RECORD HAS BEEN SAVED IN SYSUM2 THEN MUST UP*/  00125000
*                CALL ADDVALUE;   /*BUILD THE SORT TABLE ENTRY*/   0227 00126000
         BAL   @14,ADDVALUE                                        0227 00127000
*                    SYSUM2  = (SYSUM2  && SYSUM2 ); /*CLEAR @0099VLS*/ 00128000
         XC    SYSUM2(13),SYSUM2                                   0228 00129000
*               END;                                       /*@Z427VLS*/ 00130000
*            ELSE                                                  0230 00131000
*              IF R15 ^= SUCCESS THEN                              0230 00132000
         B     @RC00225                                            0230 00133000
@RF00225 LTR   R15,R15                                             0230 00134000
         BZ    @RF00230                                            0230 00135000
*                ZEROALL = NO; /*DONT RESET LOGREC HEADER OF ALL */     00136000
         NI    ZEROALL(R2),B'10111111'                             0231 00137000
*                             /*RECORDS NOT PROCESSED        @Z427VLS*/ 00138000
*          END;                                            /*@Z427VLS*/ 00139000
@RF00230 DS    0H                                                  0232 00140000
@RC00225 DS    0H                                                  0233 00141000
*   END; /*END OF NON-FRAME ERROR RECORD SEQUENTIAL PROCESSING*/   0233 00142000
@RF00215 DS    0H                                                  0234 00143000
*      END;                                                /*@Z427VLS*/ 00144000
@RC00208 DS    0H                                                  0235 00145000
*  END;                                                    /*@Z427VLS*/ 00146000
@RF00205 DS    0H                                                  0235 00147000
@DE00203 LTR   R15,R15                                             0235 00148000
         BNZ   @DC00203                                            0235 00149000
         L     @14,ENTRIES                                         0235 00150000
         C     @14,MAXENT                                          0235 00151000
         BL    @DL00203                                            0235 00152000
@DC00203 DS    0H                                                  0236 00153000
*  ERROR = R15; /*TELL ENDOFILE IF THERE ARE ERRORS          @Z427VLS*/ 00154000
         ST    R15,ERROR                                           0236 00155000
*PASSNUM = ENTRIES - 1;                                    /*@0099VLS*/ 00156000
         L     @14,ENTRIES                                         0237 00157000
         BCTR  @14,0                                               0237 00158000
         ST    @14,PASSNUM                                         0237 00159000
*  CALL ENDOFILE; /*SORT SORTABLE, FREE EXCESS CORE, HANDLE  @Z427VLS*/ 00160000
         BAL   @14,ENDOFILE                                        0238 00161000
*                 /*ERROR CONDITIONS                         @Z427VLS*/ 00162000
*  R15 = ERROR; /*PRESERVE R.C. ALTERATION FROM ENDOFILE PROC*/    0239 00163000
         L     R15,ERROR                                           0239 00164000
*  IF DEBUG16 = ON THEN                                            0240 00165000
         TM    DEBUG16(R2),B'10000000'                             0240 00166000
         BNO   @RF00240                                            0240 00167000
*    CALL BUGCNTS; /*PRINT COUNTS OF DIFFERENT RECORD TYPES PROCESSED*/ 00168000
         BAL   @14,BUGCNTS                                         0241 00169000
*  IF DEBUG11 = ON THEN                                            0242 00170000
@RF00240 TM    DEBUG11(R2),B'00010000'                             0242 00171000
         BNO   @RF00242                                            0242 00172000
*    GEN(ABEND 220,DUMP); /*SHOW STATUS IF TESTING SITUATION @Z427VLS*/ 00173000
         ABEND 220,DUMP                                                 00174000
*RESPECIFY (R15) UNRESTRICTED;                             /*@Z427VLS*/ 00175000
*INITAB: PROC;                                             /*@Z427VLS*/ 00176000
@EL00001 L     @13,4(,@13)                                         0245 00177000
@EF00001 DS    0H                                                  0245 00178000
@ER00001 L     @14,12(,@13)                                        0245 00179000
         LM    @00,@12,20(@13)                                     0245 00180000
         BR    @14                                                 0245 00181000
INITAB   STM   @14,@12,@SA00002                                    0245 00182000
*RESPECIFY(R0,R15) RESTRICTED;                             /*@Z427VLS*/ 00183000
*/*CORE IS ALLOCATED FOR SYSUM2, EVTABLE, THE SUMMARY COLUMN ENTRY OF*/ 00184000
*/*SYSUMONE. IF SHARE TABLE EXISTS, EXTRA ENTRIES OF SYSUMONE ARE  */   00185000
*/* ALLOCATED FOR EVERY UNIQUE CPU SERIAL ENCOUNTERED IN SHARE     */   00186000
*/* TABLE. ERROR MESSAGES ARE ISSUED AND A SERIOUS RETURN CODE     */   00187000
*/*     ISSUED IF CORE IS NOT AVAILABLE                      @Z427VLS*/ 00188000
*R0 = TABSIZE + EVSIZE + SUMSIZE1; /*GET CORE FOR ALL TABLES @Z427VLS*/ 00189000
         LA    R0,208                                              0247 00190000
         AL    R0,TABSIZE(,R2)                                     0247 00191000
*GEN(GETMAIN EC,LV=(R0),A=EVPTR1);                         /*@Z427VLS*/ 00192000
         GETMAIN EC,LV=(R0),A=EVPTR1                                    00193000
*IF R15 ^= SUCCESS THEN                                            0249 00194000
         LTR   R15,R15                                             0249 00195000
         BZ    @RF00249                                            0249 00196000
*  DO;                                                     /*@Z427VLS*/ 00197000
*    MSGNO = 2;                                            /*@Z427VLS*/ 00198000
         MVI   MSGNO,X'02'                                         0251 00199000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00200000
         BAL   @14,ERRMSG                                          0252 00201000
*    R15 = NOSRTABL;                                       /*@0001VLS*/ 00202000
         LA    R15,12                                              0253 00203000
*    GETFAIL = YES;                                        /*@0001VLS*/ 00204000
         OI    GETFAIL,B'00001000'                                 0254 00205000
*  END;                                                    /*@Z427VLS*/ 00206000
*ELSE                                                              0256 00207000
*  DO;                                                     /*@Z427VLS*/ 00208000
         B     @RC00249                                            0256 00209000
@RF00249 DS    0H                                                  0257 00210000
*    MAXENT = TABSIZE/13;      /*DETERMINE MAX NUMBER OF ENTRIES*/ 0257 00211000
         L     @04,TABSIZE(,R2)                                    0257 00212000
         SRDA  @04,32                                              0257 00213000
         D     @04,@CF00966                                        0257 00214000
         ST    @05,MAXENT                                          0257 00215000
*    EVPTR = EVPTR1; /*ESTABLISH EVTABLE ADDRESSIBILITY      @Z427VLS*/ 00216000
         L     @14,EVPTR1                                          0258 00217000
         ST    @14,EVPTR(,R2)                                      0258 00218000
*    EVSTOP = '00000F'X; /*INSURE VALUE ALWAYS SET FROM FIRST RECORD*/  00219000
         MVC   EVSTOP(3,@14),@CB00228                              0259 00220000
*    STRTDATE = '99366F'X; /*LIKEWISE FOR START DATE         @Z427VLS*/ 00221000
         MVC   STRTDATE(3,R2),@CB01317                             0260 00222000
*    EVTABLE = (EVTABLE && EVTABLE); /*CLEAR TO HEX ZEROS    @Z427VLS*/ 00223000
         XC    EVTABLE(102,@14),EVTABLE(@14)                       0261 00224000
*    STSUMPTR = EVPTR1 + EVSIZE; /*LOCATION JUST BEYOND EVTABLE*/  0262 00225000
         LA    @08,104                                             0262 00226000
         ALR   @14,@08                                             0262 00227000
         ST    @14,STSUMPTR                                        0262 00228000
*    SORTADR = STSUMPTR + SUMSIZE1;                        /*@Z427VLS*/ 00229000
         ALR   @08,@14                                             0263 00230000
         ST    @08,SORTADR(,R2)                                    0263 00231000
*    SYSUM2(1) = (SYSUM2(1) && SYSUM2(1));                 /*@Z427VLS*/ 00232000
         XC    SYSUM2(1),SYSUM2                                    0264 00233000
*    STSUMONE = (STSUMONE && STSUMONE);                    /*@Z427VLS*/ 00234000
         XC    STSUMONE(100,@14),STSUMONE(@14)                     0265 00235000
*    IF SHAREPTR ^= ZERO THEN                                      0266 00236000
         L     @14,SHAREPTR(,R2)                                   0266 00237000
         LTR   @14,@14                                             0266 00238000
         BZ    @RF00266                                            0266 00239000
*      DO;                                              /* @ZA17692 */  00240000
*        CALL SORTSHAR;   /* SORT SHARE TABLE CPU LETTER   @ZA17692 */  00241000
         BAL   @14,SORTSHAR                                        0268 00242000
*        DO J = 1 BY 1 TO SHARENUM WHILE R15 = SUCCESS;    /*@Z427VLS*/ 00243000
         LA    @14,1                                               0269 00244000
         ST    @14,J                                               0269 00245000
         B     @DE00269                                            0269 00246000
@DL00269 LTR   R15,R15                                             0269 00247000
         BNZ   @DC00269                                            0269 00248000
*          UNIQUE = YES;                                   /*@Z427VLS*/ 00249000
         OI    UNIQUE,B'00100000'                                  0270 00250000
*          DO K = 1 BY 1 TO EVMAX WHILE UNIQUE = YES;      /*@Z427VLS*/ 00251000
         LA    @14,1                                               0271 00252000
         ST    @14,K                                               0271 00253000
@DL00271 TM    UNIQUE,B'00100000'                                  0271 00254000
         BNO   @DC00271                                            0271 00255000
*            IF SHARSERA(J) = EVSERIAL(K) THEN                     0272 00256000
         L     @08,J                                               0272 00257000
         MH    @08,@CH00033                                        0272 00258000
         L     @01,SHAREPTR(,R2)                                   0272 00259000
         MH    @14,@CH00081                                        0272 00260000
         L     @06,EVPTR(,R2)                                      0272 00261000
         ALR   @01,@08                                             0272 00262000
         AL    @01,@CF01502                                        0272 00263000
         ALR   @06,@14                                             0272 00264000
         CLC   SHARSERA-4(3,@01),EVSERIAL-6(@06)                   0272 00265000
         BNE   @RF00272                                            0272 00266000
*              UNIQUE = NO;                                /*@Z427VLS*/ 00267000
         NI    UNIQUE,B'11011111'                                  0273 00268000
*            ELSE IF EVSERIAL(K) = ZERO THEN                       0274 00269000
         B     @RC00272                                            0274 00270000
@RF00272 L     @14,K                                               0274 00271000
         MH    @14,@CH00081                                        0274 00272000
         L     @08,EVPTR(,R2)                                      0274 00273000
         L     @06,EVSERIAL-7(@14,@08)                             0274 00274000
         LA    @06,0(,@06)                                         0274 00275000
         LTR   @06,@06                                             0274 00276000
         BNZ   @RF00274                                            0274 00277000
*              DO;                                         /*@Z427VLS*/ 00278000
*                UNIQUE = NO;                              /*@Z427VLS*/ 00279000
         NI    UNIQUE,B'11011111'                                  0276 00280000
*                EVSERIAL(K) = SHARSERA(J);                /*@Z427VLS*/ 00281000
         ST    @14,@TF00001                                        0277 00282000
         ALR   @14,@08                                             0277 00283000
         L     @06,J                                               0277 00284000
         MH    @06,@CH00033                                        0277 00285000
         L     @03,SHAREPTR(,R2)                                   0277 00286000
         ST    @06,@TF00002                                        0277 00287000
         ALR   @06,@03                                             0277 00288000
         AL    @06,@CF01502                                        0277 00289000
         MVC   EVSERIAL-6(3,@14),SHARSERA-4(@06)                   0277 00290000
*                EVLETTER(K) = SHARLET(J);                 /*@Z427VLS*/ 00291000
         LR    @14,@08                                             0278 00292000
         AL    @14,@TF00001                                        0278 00293000
         AL    @03,@TF00002                                        0278 00294000
         MVC   EVLETTER-6(1,@14),SHARLET-11(@03)                   0278 00295000
*                EVNUM = EVNUM + 1;                        /*@Z427VLS*/ 00296000
         LA    @14,1                                               0279 00297000
         AH    @14,EVNUM(,@08)                                     0279 00298000
         STH   @14,EVNUM(,@08)                                     0279 00299000
*                    R0 = SUMSIZE1; /*SYSUMONE TABLE SIZE    @Z427VLS*/ 00300000
         LA    R0,104                                              0280 00301000
*                    GEN(GETMAIN EC,LV=(R0),A=COMPLINK);   /*@Z427VLS*/ 00302000
         GETMAIN EC,LV=(R0),A=COMPLINK                                  00303000
*                    IF R15  = SUCCESS THEN                        0282 00304000
         LTR   R15,R15                                             0282 00305000
         BNZ   @RF00282                                            0282 00306000
*                      DO;                                 /*@Z427VLS*/ 00307000
*                        IF K > 1 THEN /*IF ALREADY SYSUMONE ENTRY*/    00308000
         CLC   K(4),@CF00055                                       0284 00309000
         BNH   @RF00284                                            0284 00310000
*                          SYSUMNXT = COMPLINK; /*POINT TO NEW ENTRY*/  00311000
         L     @01,SYSUMPTR(,R2)                                   0285 00312000
         L     @14,COMPLINK                                        0285 00313000
         ST    @14,SYSUMNXT(,@01)                                  0285 00314000
*                                               /*FROM OLD ENTRY*/ 0286 00315000
*                          SYSUMPTR = COMPLINK; /*ADDRESS NEW ENTRY*/   00316000
@RF00284 L     @14,COMPLINK                                        0286 00317000
         ST    @14,SYSUMPTR(,R2)                                   0286 00318000
*                          SAVEADR(K) = COMPLINK; /*SAVE ADDRESS*/ 0287 00319000
         L     @08,K                                               0287 00320000
         SLA   @08,2                                               0287 00321000
         ST    @14,SAVEADR-4(@08)                                  0287 00322000
*                          SYSUMONE = (SYSUMONE && SYSUMONE); /*CLEAR*/ 00323000
         XC    SYSUMONE(100,@14),SYSUMONE(@14)                     0288 00324000
*                      END;                                /*@Z427VLS*/ 00325000
*                    ELSE  /*IF GETMAIN FAILURE THEN         @Z427VLS*/ 00326000
*                      DO;                                 /*@Z427VLS*/ 00327000
         B     @RC00282                                            0290 00328000
@RF00282 DS    0H                                                  0291 00329000
*                        MSGNO = 1; /*SELECT ERROR TEXT      @Z427VLS*/ 00330000
         MVI   MSGNO,X'01'                                         0291 00331000
*                        CALL ERRMSG; /*GO PRINT MESSAGE TO TOURIST*/   00332000
         BAL   @14,ERRMSG                                          0292 00333000
*                        R15 = NOSRTABL;                   /*@0001VLS*/ 00334000
         LA    R15,12                                              0293 00335000
*                        GETFAIL = YES;                    /*@0001VLS*/ 00336000
         OI    GETFAIL,B'00001000'                                 0294 00337000
*                      END;                                /*@Z427VLS*/ 00338000
*              END;                                        /*@Z427VLS*/ 00339000
@RC00282 DS    0H                                                  0297 00340000
*          END;                                          /* @Z427VLS */ 00341000
@RF00274 DS    0H                                                  0297 00342000
@RC00272 LA    @14,1                                               0297 00343000
         AL    @14,K                                               0297 00344000
         ST    @14,K                                               0297 00345000
         C     @14,@CF00034                                        0297 00346000
         BNH   @DL00271                                            0297 00347000
@DC00271 DS    0H                                                  0298 00348000
*        END;                                            /* @Z427VLS */ 00349000
         LA    @14,1                                               0298 00350000
         AL    @14,J                                               0298 00351000
         ST    @14,J                                               0298 00352000
@DE00269 L     @01,SHAREPTR(,R2)                                   0298 00353000
         CH    @14,SHARENUM(,@01)                                  0298 00354000
         BNH   @DL00269                                            0298 00355000
@DC00269 DS    0H                                                  0299 00356000
*      END;                                             /* @ZA17692 */  00357000
*  END;                                                    /*@Z427VLS*/ 00358000
@RF00266 DS    0H                                                  0301 00359000
*  NUMUNSHR = EVNUM + 1;                                   /*@Z427VLS*/ 00360000
@RC00249 L     @01,EVPTR(,R2)                                      0301 00361000
         LH    @01,EVNUM(,@01)                                     0301 00362000
         LA    @01,1(,@01)                                         0301 00363000
         STH   @01,NUMUNSHR                                        0301 00364000
*IF R15 = SUCCESS &  /*IF OTHER GETMAINS HAVE BEEN SUCCESSFULL  */ 0302 00365000
*         PACC = ON &  /*ONLY CHECK FRAMES IF WRITTEN TO ACCDEV*/  0302 00366000
*         (PMCH = ON | PCHAN = ON) THEN /*IF MCH OR CCH SELECTED*/ 0302 00367000
         LTR   R15,R15                                             0302 00368000
         BNZ   @RF00302                                            0302 00369000
         TM    PACC(R2),B'01000000'                                0302 00370000
         BNO   @RF00302                                            0302 00371000
         TM    PMCH(R2),B'11000000'                                0302 00372000
         BZ    @RF00302                                            0302 00373000
*  DO;                                                     /*@G51DGBB*/ 00374000
* RESPECIFY (R1) RESTRICTED;                               /*@G51DGBB*/ 00375000
*    R0 = FRAMBENT * EVMAX; /*NUMBER OF ENTRIES TIMES BYTES PER ENTRY*/ 00376000
         LA    R0,240                                              0305 00377000
*    R0 = R0 + 4;           /*ADD FRAMENUM LENGTH            @G51DGBB*/ 00378000
         AL    R0,@CF00064                                         0306 00379000
*    GEN(GETMAIN EC,LV=(R0),A=LINKPTR,SP=21); /*GET THE STORAGE*/  0307 00380000
         GETMAIN EC,LV=(R0),A=LINKPTR,SP=21                             00381000
*    RESPECIFY (R0) UNRESTRICTED;                          /*@G51DGBB*/ 00382000
*    IF R15 = SUCCESS THEN   /*IF GETMAIN SUCCESSFULL        @G51DGBB*/ 00383000
         LTR   R15,R15                                             0309 00384000
         BNZ   @RF00309                                            0309 00385000
*      DO;                                                 /*@G51DGBB*/ 00386000
*        FRAMEPTR = LINKPTR;  /*ESTABLISH FRAMETAB BASE ADDRESS*/  0311 00387000
         L     @14,LINKPTR                                         0311 00388000
         ST    @14,FRAMEPTR(,R2)                                   0311 00389000
*        DO Y = 1 BY 1 TO EVMAX; /*CLEAR FRAMETAB TO ZEROS   @G51DGBB*/ 00390000
         LA    @14,1                                               0312 00391000
         ST    @14,Y                                               0312 00392000
@DL00312 DS    0H                                                  0313 00393000
*          FRAMEDTA(Y) = (FRAMEDTA(Y) && FRAMEDTA(Y));     /*@G51DGBB*/ 00394000
         LR    @08,@14                                             0313 00395000
         MH    @08,@CH00227                                        0313 00396000
         L     @06,FRAMEPTR(,R2)                                   0313 00397000
         ALR   @06,@08                                             0313 00398000
         AL    @06,@CF01504                                        0313 00399000
         XC    FRAMEDTA-4(24,@06),FRAMEDTA-4(@06)                  0313 00400000
*        END;                                              /*@G51DGBB*/ 00401000
         AL    @14,@CF00055                                        0314 00402000
         ST    @14,Y                                               0314 00403000
         C     @14,@CF00034                                        0314 00404000
         BNH   @DL00312                                            0314 00405000
*        FRAMENUM = ZEROS;                                 /*@G51DGBB*/ 00406000
         L     @14,FRAMEPTR(,R2)                                   0315 00407000
         SLR   @08,@08                                             0315 00408000
         ST    @08,FRAMENUM(,@14)                                  0315 00409000
*      END;                                                /*@G51DGBB*/ 00410000
*  ELSE  /*UNSUCCESSFULL GETMAIN                             @G51DGBB*/ 00411000
*    DO;                                                   /*@G51DGBB*/ 00412000
         B     @RC00309                                            0317 00413000
@RF00309 DS    0H                                                  0318 00414000
*      R15 = TWELVE;  /*DONT CONTINUE RETURN CODE            @G51DGBB*/ 00415000
         LA    R15,12                                              0318 00416000
*      MSGNO = 40;   /*CORE NOT AVAILABLE MESSAGE            @G51DGBB*/ 00417000
         MVI   MSGNO,X'28'                                         0319 00418000
*      CALL ERRMSG;  /*PRINT ERROR MESSAGE                   @G51DGBB*/ 00419000
         BAL   @14,ERRMSG                                          0320 00420000
*    END;                                                  /*@G51DGBB*/ 00421000
* END; /*END OF FRAMETAB GETMAIN                             @G51DGBB*/ 00422000
@RC00309 DS    0H                                                  0323 00423000
*  ERROR = R15; /*COMMUNICATE ERROR CONDITIONS TO CALLING PROC*/   0323 00424000
@RF00302 ST    R15,ERROR                                           0323 00425000
*RESPECIFY(R0,R15) UNRESTRICTED;                           /*@Z427VLS*/ 00426000
*END; /*END OF PROC INITAB                                   @Z427VLS*/ 00427000
@EL00002 DS    0H                                                  0325 00428000
@EF00002 DS    0H                                                  0325 00429000
@ER00002 LM    @14,@12,@SA00002                                    0325 00430000
         BR    @14                                                 0325 00431000
*CONVERT: PROC;                                            /*@Z427VLS*/ 00432000
CONVERT  STM   @14,@12,12(@13)                                     0326 00433000
*   RESPECIFY (R4,R5) RESTRICTED;                          /*@0099VLS*/ 00434000
* DCL  T      FIXED(31) INIT(0);                           /*@Z427VLS*/ 00435000
*DCL P    FIXED(31) INIT(0);                               /*@G51DGBB*/ 00436000
*DCL Q    FIXED(31) INIT(0);                               /*@G51DGBB*/ 00437000
* DCL  NUMBER FIXED(31) INIT(0);                           /*@Z427VLS*/ 00438000
* DCL  NEXTBYTE(1) CHAR(1) BASED(NEXTBY);                  /*@Z427VLS*/ 00439000
* DCL  ADDNUM(1)   CHAR(1) BASED(ADDNXT);                  /*@Z427VLS*/ 00440000
* DCL  CHARS       CHAR(16) INIT('0123456789ABCDEF');      /*@Z427VLS*/ 00441000
* DCL  NEXTBY FIXED(31) INIT(0);                           /*@Z427VLS*/ 00442000
* DCL  ADDNXT FIXED(31) INIT(0);                           /*@Z427VLS*/ 00443000
*DO Q = NUMBER BY -1 TO 1;                                 /*@G51DGBB*/ 00444000
         L     @08,NUMBER                                          0337 00445000
         ST    @08,Q                                               0337 00446000
         B     @DE00337                                            0337 00447000
@DL00337 DS    0H                                                  0338 00448000
* R4 = NEXTBYTE(Q);                                        /*@G51DGBB*/ 00449000
         L     @06,NEXTBY                                          0338 00450000
         BCTR  @06,0                                               0338 00451000
         SLR   R4,R4                                               0338 00452000
         IC    R4,NEXTBYTE(@08,@06)                                0338 00453000
* P = 2 * Q;                                               /*@G51DGBB*/ 00454000
         LR    @06,@08                                             0339 00455000
         ALR   @06,@06                                             0339 00456000
         ST    @06,P                                               0339 00457000
*  SRDL(R4,4);                                             /*@Z427VLS*/ 00458000
         SRDL  R4,4                                                0340 00459000
*  SRL(R5,28);                                             /*@Z427VLS*/ 00460000
         SRL   R5,28                                               0341 00461000
*  R5 = R5 + 1;                                            /*@Z427VLS*/ 00462000
         LA    @03,1                                               0342 00463000
         ALR   R5,@03                                              0342 00464000
*  R4 = R4 + 1;                                            /*@Z427VLS*/ 00465000
         ALR   R4,@03                                              0343 00466000
* ADDNUM(P-1) = CHARS(R4);                                 /*@G51DGBB*/ 00467000
         L     @03,ADDNXT                                          0344 00468000
         ALR   @06,@03                                             0344 00469000
         BCTR  @06,0                                               0344 00470000
         BCTR  @06,0                                               0344 00471000
         LA    @15,CHARS-1(R4)                                     0344 00472000
         MVC   ADDNUM(1,@06),0(@15)                                0344 00473000
* ADDNUM(P) = CHARS(R5);                                   /*@G51DGBB*/ 00474000
         L     @06,P                                               0345 00475000
         ALR   @03,@06                                             0345 00476000
         BCTR  @03,0                                               0345 00477000
         LA    @06,CHARS-1(R5)                                     0345 00478000
         MVC   ADDNUM(1,@03),0(@06)                                0345 00479000
* END;                                                     /*@Z427VLS*/ 00480000
         BCTR  @08,0                                               0346 00481000
         ST    @08,Q                                               0346 00482000
@DE00337 LTR   @08,@08                                             0346 00483000
         BP    @DL00337                                            0346 00484000
*END;                                                      /*@Z427VLS*/ 00485000
@EL00003 DS    0H                                                  0347 00486000
@EF00003 DS    0H                                                  0347 00487000
@ER00003 LM    @14,@12,12(@13)                                     0347 00488000
         BR    @14                                                 0347 00489000
*RESPECIFY (R4,R5) UNRESTRICTED;                           /*@Z427VLS*/ 00490000
*/*******************************************************************/  00491000
*/*    THIS PROC WILL SEARCH THE SORT TABLE FOR A ENTRY WITH THE SAME*/ 00492000
*/*    KEY AS THIS ONE THEN SUM THE PERM AND TEMP ERRORS WITH THIS REC* 00493000
*/*    IF NO MATCH CAN BE FOUND THEN CREATE A NEW ONE        @0099VLS*/ 00494000
*/*                                                          @0099VLS*/ 00495000
*ADDVALUE: PROC;                                           /*@0099VLS*/ 00496000
ADDVALUE STM   @14,@12,@SA00004                                    0349 00497000
* DCL ZZ PTR(31)  INIT(0);                                 /*@0099VLS*/ 00498000
* DCL Z1 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00499000
* DCL Z2 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00500000
* DCL Z3 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00501000
*DCL ZZ3 FIXED(31) INIT(0);                                /*@G51DGBB*/ 00502000
* DCL  1  TMPA  BASED(ZZ),                                         0355 00503000
*       2 TMPKEYA  CHAR(7),                                        0355 00504000
*       2 TMPPERMA FIXED(15) BDY(BYTE),                            0355 00505000
*       2 TMPTEMPA FIXED(31) BDY(BYTE);                    /*@0099VLS*/ 00506000
* FOUND = NO;        /*SET FLAG TO ASSUME THE WORST          @0099VLS*/ 00507000
         NI    FOUND,B'01111111'                                   0356 00508000
* ZZ3 = ZZ3 + 1;     /*NUMBER OF RECORDS FOR PART 2          @0099VLS*/ 00509000
         LA    @08,1                                               0357 00510000
         AL    @08,ZZ3                                             0357 00511000
         ST    @08,ZZ3                                             0357 00512000
* DO ZZ = SORTADR + (ENTRIES - 1) * 13 BY -13 TO SORTADR WHILE(    0358 00513000
*                                   FOUND = NO);           /*@0099VLS*/ 00514000
         L     @08,ENTRIES                                         0358 00515000
         BCTR  @08,0                                               0358 00516000
         MH    @08,@CH00966                                        0358 00517000
         AL    @08,SORTADR(,R2)                                    0358 00518000
         ST    @08,ZZ                                              0358 00519000
         B     @DE00358                                            0358 00520000
@DL00358 TM    FOUND,B'10000000'                                   0358 00521000
         BNZ   @DC00358                                            0358 00522000
*  IF TMPKEYA = SYSUMKEY THEN                                      0359 00523000
         CLC   TMPKEYA(7,@08),SYSUMKEY                             0359 00524000
         BNE   @RF00359                                            0359 00525000
*   DO;                                                    /*@0099VLS*/ 00526000
*    TMPPERMA = TMPPERMA + SYSPERM1;                       /*@0099VLS*/ 00527000
         ICM   @06,12,TMPPERMA(@08)                                0361 00528000
         SRA   @06,16                                              0361 00529000
         ICM   @03,12,SYSPERM1                                     0361 00530000
         SRA   @03,16                                              0361 00531000
         ALR   @06,@03                                             0361 00532000
         STCM  @06,3,TMPPERMA(@08)                                 0361 00533000
*    TMPTEMPA = TMPTEMPA + SYSTEMP;                        /*@0099VLS*/ 00534000
         ICM   @06,15,TMPTEMPA(@08)                                0362 00535000
         ICM   @03,15,SYSTEMP                                      0362 00536000
         ALR   @06,@03                                             0362 00537000
         STCM  @06,15,TMPTEMPA(@08)                                0362 00538000
*    FOUND = YES;                                          /*@0099VLS*/ 00539000
         OI    FOUND,B'10000000'                                   0363 00540000
*   END;                                                   /*@0099VLS*/ 00541000
* END;                                                     /*@0099VLS*/ 00542000
@RF00359 L     @08,@CF01350                                        0365 00543000
         AL    @08,ZZ                                              0365 00544000
         ST    @08,ZZ                                              0365 00545000
@DE00358 C     @08,SORTADR(,R2)                                    0365 00546000
         BNL   @DL00358                                            0365 00547000
@DC00358 DS    0H                                                  0366 00548000
* IF FOUND = NO THEN                                               0366 00549000
         TM    FOUND,B'10000000'                                   0366 00550000
         BNZ   @RF00366                                            0366 00551000
*  DO;                                                     /*@0099VLS*/ 00552000
*   TMP2(ENTRIES) = SYSUM2;                                /*@0099VLS*/ 00553000
         L     @08,ENTRIES                                         0368 00554000
         LR    @06,@08                                             0368 00555000
         MH    @06,@CH00966                                        0368 00556000
         L     @03,SORTADR(,R2)                                    0368 00557000
         ALR   @03,@06                                             0368 00558000
         AL    @03,@CF01350                                        0368 00559000
         MVC   TMP2(13,@03),SYSUM2                                 0368 00560000
*   ENTRIES = ENTRIES + 1;                                 /*@0099VLS*/ 00561000
         AL    @08,@CF00055                                        0369 00562000
         ST    @08,ENTRIES                                         0369 00563000
*  END;                                                    /*@0099VLS*/ 00564000
*IF DEBUG50 = ON THEN                                              0371 00565000
@RF00366 TM    DEBUG50(R2),B'00100000'                             0371 00566000
         BNO   @RF00371                                            0371 00567000
* DO;                                                      /*@0099VLS*/ 00568000
*  NUMBER = 13;                                            /*@0099VLS*/ 00569000
         MVC   NUMBER(4),@CF00966                                  0373 00570000
*  NEXTBY = ADDR(SYSUM2);                                  /*@0099VLS*/ 00571000
         LA    @08,SYSUM2                                          0374 00572000
         ST    @08,NEXTBY                                          0374 00573000
*  ADDNXT = ADDR(PRINTBDY);                                /*@0099VLS*/ 00574000
         LA    @08,PRINTBDY                                        0375 00575000
         ST    @08,ADDNXT                                          0375 00576000
*  CALL CONVERT;                                           /*@0099VLS*/ 00577000
         BAL   @14,CONVERT                                         0376 00578000
*  IF FOUND = YES THEN                                             0377 00579000
         TM    FOUND,B'10000000'                                   0377 00580000
         BNO   @RF00377                                            0377 00581000
*  DO;                                                     /*@0099VLS*/ 00582000
*  NEXTBY = ZZ + 13;                                       /*@0099VLS*/ 00583000
         LA    @08,13                                              0379 00584000
         AL    @08,ZZ                                              0379 00585000
         ST    @08,NEXTBY                                          0379 00586000
*  ADDNXT = ADDR(PRINTBDY) + 40;                           /*@0099VLS*/ 00587000
         LA    @08,PRINTBDY                                        0380 00588000
         AL    @08,@CF01198                                        0380 00589000
         ST    @08,ADDNXT                                          0380 00590000
*  CALL CONVERT;                                           /*@0099VLS*/ 00591000
         BAL   @14,CONVERT                                         0381 00592000
*  END;                                                    /*@0099VLS*/ 00593000
*  PRINTADR = ADDR(PRINTLIN);                              /*@0099VLS*/ 00594000
@RF00377 LA    @08,PRINTLIN                                        0383 00595000
         ST    @08,PRINTADR(,R2)                                   0383 00596000
*  CALL IOHND(RITEPRTR);                                   /*@0099VLS*/ 00597000
         L     @15,ADIOHND(,R2)                                    0384 00598000
         LA    @01,@AL00384                                        0384 00599000
         BALR  @14,@15                                             0384 00600000
* END;                                                     /*@0099VLS*/ 00601000
*SYSUM2  = SYSUM2  && SYSUM2;    /*CLEAR FOR THE NEXT ENTRY  @0099VLS*/ 00602000
@RF00371 XC    SYSUM2(13),SYSUM2                                   0386 00603000
*END;                                                      /*@0099VLS*/ 00604000
@EL00004 DS    0H                                                  0387 00605000
@EF00004 DS    0H                                                  0387 00606000
@ER00004 LM    @14,@12,@SA00004                                    0387 00607000
         BR    @14                                                 0387 00608000
*CUASELCT: PROC;                                           /*@Z427VLS*/ 00609000
CUASELCT STM   @14,@12,12(@13)                                     0388 00610000
*CUAOK = NO;                                               /*@Z427VLS*/ 00611000
         NI    CUAOK,B'10111111'                                   0389 00612000
*DO Z = 1 BY 1 TO CUANUM WHILE(CUAOK = NO);                /*@Z427VLS*/ 00613000
         LA    @08,1                                               0390 00614000
         ST    @08,Z                                               0390 00615000
         B     @DE00390                                            0390 00616000
@DL00390 TM    CUAOK,B'01000000'                                   0390 00617000
         BNZ   @DC00390                                            0390 00618000
* IF WORKDEV >= CUA1(Z) & WORKDEV <= CUA2(Z) THEN                  0391 00619000
         SLA   @08,2                                               0391 00620000
         L     @06,CUAPTR(,R2)                                     0391 00621000
         ST    @08,@TF00001                                        0391 00622000
         ALR   @08,@06                                             0391 00623000
         BCTR  @08,0                                               0391 00624000
         BCTR  @08,0                                               0391 00625000
         CLC   WORKDEV(2),CUA1-2(@08)                              0391 00626000
         BL    @RF00391                                            0391 00627000
         AL    @06,@TF00001                                        0391 00628000
         CLC   WORKDEV(2),CUA2-4(@06)                              0391 00629000
         BH    @RF00391                                            0391 00630000
*  CUAOK = YES;                                            /*@Z427VLS*/ 00631000
         OI    CUAOK,B'01000000'                                   0392 00632000
*END;                                                      /*@Z427VLS*/ 00633000
@RF00391 LA    @08,1                                               0393 00634000
         AL    @08,Z                                               0393 00635000
         ST    @08,Z                                               0393 00636000
@DE00390 L     @06,CUAPTR(,R2)                                     0393 00637000
         CH    @08,CUANUM(,@06)                                    0393 00638000
         BNH   @DL00390                                            0393 00639000
@DC00390 DS    0H                                                  0394 00640000
*IF CUAOK = NO THEN                                                0394 00641000
         TM    CUAOK,B'01000000'                                   0394 00642000
         BNZ   @RF00394                                            0394 00643000
* PASSFLAG = NO;                                           /*@Z427VLS*/ 00644000
         NI    PASSFLAG(R2),B'11111110'                            0395 00645000
*END;                                                      /*@Z427VLS*/ 00646000
@EL00005 DS    0H                                                  0396 00647000
@EF00005 DS    0H                                                  0396 00648000
@ER00005 LM    @14,@12,12(@13)                                     0396 00649000
         BR    @14                                                 0396 00650000
*DEVSEL: PROC;                                             /*@Z427VLS*/ 00651000
DEVSEL   STM   @14,@12,12(@13)                                     0397 00652000
*IF WORKTYPE = HEX90 THEN                                          0398 00653000
         CLI   WORKTYPE,X'90'                                      0398 00654000
         BNE   @RF00398                                            0398 00655000
*  DO;                                                     /*@Z427VLS*/ 00656000
*    IF DEVEXCL = ON THEN                                          0400 00657000
         TM    DEVEXCL(R2),B'00100000'                             0400 00658000
         BNO   @RF00400                                            0400 00659000
*      DO;                                                 /*@Z427VLS*/ 00660000
*        DEVOK = YES;                                      /*@Z427VLS*/ 00661000
         OI    DEVOK,B'01000000'                                   0402 00662000
*        DO Z = 1 BY 1 TO MDRNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 00663000
         LA    @08,1                                               0403 00664000
         ST    @08,Z                                               0403 00665000
         B     @DE00403                                            0403 00666000
@DL00403 TM    DEVOK,B'01000000'                                   0403 00667000
         BNO   @DC00403                                            0403 00668000
*        IF TPRDEV = MDRVAL(Z) THEN                                0404 00669000
         L     @06,DEVPTR(,R2)                                     0404 00670000
         ALR   @06,@08                                             0404 00671000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          0404 00672000
         BNE   @RF00404                                            0404 00673000
*          DO;                                             /*@Z427VLS*/ 00674000
*            DEVOK = NO;                                   /*@Z427VLS*/ 00675000
         NI    DEVOK,B'10111111'                                   0406 00676000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 00677000
         NI    PASSFLAG(R2),B'11111110'                            0407 00678000
*          END;                                            /*@Z427VLS*/ 00679000
*        END;                                              /*@Z427VLS*/ 00680000
@RF00404 LA    @08,1                                               0409 00681000
         AL    @08,Z                                               0409 00682000
         ST    @08,Z                                               0409 00683000
@DE00403 L     @06,DEVPTR(,R2)                                     0409 00684000
         CH    @08,MDRNUM(,@06)                                    0409 00685000
         BNH   @DL00403                                            0409 00686000
@DC00403 DS    0H                                                  0410 00687000
*      END;                                                /*@Z427VLS*/ 00688000
*    ELSE                                                          0411 00689000
*      DO;                                                 /*@Z427VLS*/ 00690000
         B     @RC00400                                            0411 00691000
@RF00400 DS    0H                                                  0412 00692000
*        DEVOK = NO;                                       /*@Z427VLS*/ 00693000
         NI    DEVOK,B'10111111'                                   0412 00694000
*        DO Z = 1 BY 1 TO MDRNUM WHILE DEVOK = NO;         /*@Z427VLS*/ 00695000
         LA    @08,1                                               0413 00696000
         ST    @08,Z                                               0413 00697000
         B     @DE00413                                            0413 00698000
@DL00413 TM    DEVOK,B'01000000'                                   0413 00699000
         BNZ   @DC00413                                            0413 00700000
*        IF TPRDEV = MDRVAL(Z) THEN                                0414 00701000
         L     @06,DEVPTR(,R2)                                     0414 00702000
         ALR   @06,@08                                             0414 00703000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          0414 00704000
         BNE   @RF00414                                            0414 00705000
*          DEVOK = YES;                                    /*@Z427VLS*/ 00706000
         OI    DEVOK,B'01000000'                                   0415 00707000
*        END;                                              /*@Z427VLS*/ 00708000
@RF00414 LA    @08,1                                               0416 00709000
         AL    @08,Z                                               0416 00710000
         ST    @08,Z                                               0416 00711000
@DE00413 L     @06,DEVPTR(,R2)                                     0416 00712000
         CH    @08,MDRNUM(,@06)                                    0416 00713000
         BNH   @DL00413                                            0416 00714000
@DC00413 DS    0H                                                  0417 00715000
*        IF DEVOK = NO THEN                                        0417 00716000
         TM    DEVOK,B'01000000'                                   0417 00717000
         BNZ   @RF00417                                            0417 00718000
*          PASSFLAG = NO;                                  /*@Z427VLS*/ 00719000
         NI    PASSFLAG(R2),B'11111110'                            0418 00720000
*       END;                                               /*@Z427VLS*/ 00721000
*    END;                                                  /*@Z427VLS*/ 00722000
*  ELSE                                                            0421 00723000
*    IF DEVEXCL = ON THEN                                          0421 00724000
         B     @RC00398                                            0421 00725000
@RF00398 TM    DEVEXCL(R2),B'00100000'                             0421 00726000
         BNO   @RF00421                                            0421 00727000
*      DO;                                                 /*@Z427VLS*/ 00728000
*        DEVOK = YES;                                      /*@Z427VLS*/ 00729000
         OI    DEVOK,B'01000000'                                   0423 00730000
*        DO Z = 1 BY 1 TO DEVNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 00731000
         LA    @08,1                                               0424 00732000
         ST    @08,Z                                               0424 00733000
         B     @DE00424                                            0424 00734000
@DL00424 TM    DEVOK,B'01000000'                                   0424 00735000
         BNO   @DC00424                                            0424 00736000
*          IF WORKDEV = DEVVAL(Z) THEN                             0425 00737000
         ALR   @08,@08                                             0425 00738000
         L     @06,DEVPTR(,R2)                                     0425 00739000
         ALR   @06,@08                                             0425 00740000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            0425 00741000
         BNE   @RF00425                                            0425 00742000
*            DO;                                           /*@Z427VLS*/ 00743000
*              DEVOK = NO;                                 /*@Z427VLS*/ 00744000
         NI    DEVOK,B'10111111'                                   0427 00745000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 00746000
         NI    PASSFLAG(R2),B'11111110'                            0428 00747000
*            END;                                          /*@Z427VLS*/ 00748000
*        END;                                              /*@Z427VLS*/ 00749000
@RF00425 LA    @08,1                                               0430 00750000
         AL    @08,Z                                               0430 00751000
         ST    @08,Z                                               0430 00752000
@DE00424 L     @06,DEVPTR(,R2)                                     0430 00753000
         CH    @08,DEVNUM(,@06)                                    0430 00754000
         BNH   @DL00424                                            0430 00755000
@DC00424 DS    0H                                                  0431 00756000
*      END;                                                /*@Z427VLS*/ 00757000
*  ELSE                                                            0432 00758000
*   DO;                                                    /*@Z427VLS*/ 00759000
         B     @RC00421                                            0432 00760000
@RF00421 DS    0H                                                  0433 00761000
*     DEVOK = NO;                                          /*@Z427VLS*/ 00762000
         NI    DEVOK,B'10111111'                                   0433 00763000
*     DO Z =  1 BY 1 TO DEVNUM WHILE DEVOK = NO;           /*@Z427VLS*/ 00764000
         LA    @08,1                                               0434 00765000
         ST    @08,Z                                               0434 00766000
         B     @DE00434                                            0434 00767000
@DL00434 TM    DEVOK,B'01000000'                                   0434 00768000
         BNZ   @DC00434                                            0434 00769000
*       IF WORKDEV = DEVVAL(Z) THEN                                0435 00770000
         ALR   @08,@08                                             0435 00771000
         L     @06,DEVPTR(,R2)                                     0435 00772000
         ALR   @06,@08                                             0435 00773000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            0435 00774000
         BNE   @RF00435                                            0435 00775000
*         DEVOK = YES;                                     /*@Z427VLS*/ 00776000
         OI    DEVOK,B'01000000'                                   0436 00777000
*     END;                                                 /*@Z427VLS*/ 00778000
@RF00435 LA    @08,1                                               0437 00779000
         AL    @08,Z                                               0437 00780000
         ST    @08,Z                                               0437 00781000
@DE00434 L     @06,DEVPTR(,R2)                                     0437 00782000
         CH    @08,DEVNUM(,@06)                                    0437 00783000
         BNH   @DL00434                                            0437 00784000
@DC00434 DS    0H                                                  0438 00785000
*     IF DEVOK = NO THEN                                           0438 00786000
         TM    DEVOK,B'01000000'                                   0438 00787000
         BNZ   @RF00438                                            0438 00788000
*       PASSFLAG = OFF;                                    /*@Z427VLS*/ 00789000
         NI    PASSFLAG(R2),B'11111110'                            0439 00790000
*   END;                                                   /*@Z427VLS*/ 00791000
*END;                                                      /*@Z427VLS*/ 00792000
@EL00006 DS    0H                                                  0441 00793000
@EF00006 DS    0H                                                  0441 00794000
@ER00006 LM    @14,@12,12(@13)                                     0441 00795000
         BR    @14                                                 0441 00796000
*SUMONADR: PROC;                                           /*@Z427VLS*/ 00797000
SUMONADR STM   @14,@12,@SA00007                                    0442 00798000
*RESPECIFY(R3,R15) RESTRICTED;                             /*@Z427VLS*/ 00799000
*/*ADDRESS THE SYSUMONE ENTRY THAT RELATES TO THE RECORD CPU @Z427VLS*/ 00800000
*/*SERIAL NUMBER. IF THE ENTRY DOES NOT EXIST, CREATE IT AND @Z427VLS*/ 00801000
*/*ADDRESS IT. SYSUMONE ENTRY NUMBER IS EQUAL TO EVTABLE     @Z427VLS*/ 00802000
*/*ENTRY NUMBER AT THIS STAGE OF IFCFILT2 EXECUTION. IF MORE @Z427VLS*/ 00803000
*/*THAN 16 CPUS ARE IDENTIFIED, AN ERROR MESSAGE IS ISSUED   @Z427VLS*/ 00804000
*/*THE FIRST TIME, AND THE RECORDS FOR THE EXCESS CPUS ARE   @Z427VLS*/ 00805000
*/*SUMMED INTO THE 16TH CPU BUCKET BEFORE THE BUCKETS ARE IN @Z427VLS*/ 00806000
*/*CPU SERIAL ORDER.                                         @Z427VLS*/ 00807000
*    SYSUMPTR = SAVEADR(1); /*ADDRESS 1ST ENTRY IN SYSUMONE CHAIN*/     00808000
         L     @14,SAVEADR                                         0444 00809000
         ST    @14,SYSUMPTR(,R2)                                   0444 00810000
*                           /*MAY BE ZERO IF NO ENTRIES EXIST*/    0445 00811000
*    GETOUT = NO;                                          /*@Z427VLS*/ 00812000
         NI    GETOUT,B'11110111'                                  0445 00813000
*    DO K = 1 BY 1 TO EVMAX WHILE GETOUT = NO;             /*@Z427VLS*/ 00814000
         LA    @14,1                                               0446 00815000
         ST    @14,K                                               0446 00816000
@DL00446 TM    GETOUT,B'00001000'                                  0446 00817000
         BNZ   @DC00446                                            0446 00818000
*      IF EVSERIAL(K) = LRTCPUS THEN                               0447 00819000
         MH    @14,@CH00081                                        0447 00820000
         L     @08,EVPTR(,R2)                                      0447 00821000
         ST    @14,@TF00001                                        0447 00822000
         ALR   @14,@08                                             0447 00823000
         CLC   EVSERIAL-6(3,@14),LRTCPUS(R7)                       0447 00824000
         BNE   @RF00447                                            0447 00825000
*        DO;                                               /*@Z427VLS*/ 00826000
*          EVMODEL(K) = LRTMODEL; /*SET IN CASE THIS ENTRY CREATED*/    00827000
         AL    @08,@TF00001                                        0449 00828000
         MVC   EVMODEL-6(2,@08),LRTMODEL(R7)                       0449 00829000
*          GETOUT = YES;          /*FROM EVTABLE ENTRY WHICH IS   */    00830000
         OI    GETOUT,B'00001000'                                  0450 00831000
*        END;                     /*MISSING MODEL NUMBER     @Z427VLS*/ 00832000
*      ELSE                                                        0452 00833000
*        DO;                                               /*@Z427VLS*/ 00834000
         B     @RC00447                                            0452 00835000
@RF00447 DS    0H                                                  0453 00836000
*          IF SYSUMNXT ^= ZERO & SYSUMPTR ^= ZERO THEN /*IF ANOTHER*/   00837000
         SLR   @14,@14                                             0453 00838000
         L     @08,SYSUMPTR(,R2)                                   0453 00839000
         L     @06,SYSUMNXT(,@08)                                  0453 00840000
         CR    @06,@14                                             0453 00841000
         BE    @RF00453                                            0453 00842000
         CR    @08,@14                                             0453 00843000
         BE    @RF00453                                            0453 00844000
*          /*ENTRY OF SYSUMONE AND ANOTHER ENTRY OF EVTABLE EXIST.*/    00845000
*          /*ALSO, IF AN ENTRY OF SYSUMONE HAS BEE N CREATED @Z427VLS*/ 00846000
*                  SYSUMPTR = SYSUMNXT; /*RESET BASE TO NEXT ENTRY*/    00847000
         ST    @06,SYSUMPTR(,R2)                                   0454 00848000
*          ELSE /*IMPLIES WE HAVE SCANNED ALL EV ENTRIES WITH NO MATCH* 00849000
*            DO;                                           /*@Z427VLS*/ 00850000
         B     @RC00453                                            0455 00851000
@RF00453 DS    0H                                                  0456 00852000
*              GETOUT = YES; /*EXIT LOOP IF CREATE AN ENTRY  @Z427VLS*/ 00853000
         OI    GETOUT,B'00001000'                                  0456 00854000
*              IF K < EVMAX | /*IF ROOM TO CREATE EXTRA ENTRY*/    0457 00855000
*                 (K = EVMAX & EVSERIAL(K) = ZERO) THEN /*IF LAST */    00856000
         L     @14,K                                               0457 00857000
         LA    @08,10                                              0457 00858000
         CR    @14,@08                                             0457 00859000
         BL    @RT00457                                            0457 00860000
         CR    @14,@08                                             0457 00861000
         BNE   @RF00457                                            0457 00862000
         MH    @14,@CH00081                                        0457 00863000
         L     @08,EVPTR(,R2)                                      0457 00864000
         L     @14,EVSERIAL-7(@14,@08)                             0457 00865000
         LA    @14,0(,@14)                                         0457 00866000
         LTR   @14,@14                                             0457 00867000
         BNZ   @RF00457                                            0457 00868000
@RT00457 DS    0H                                                  0458 00869000
*                 /*ENTRY BUT IT REMAINS UNSET THEN          @Z427VLS*/ 00870000
*                DO;                                       /*@Z427VLS*/ 00871000
*                  L = EVNUM + 1; /*BUILD NEXT EVTABLE ENTRY @Z427VLS*/ 00872000
         L     @14,EVPTR(,R2)                                      0459 00873000
         LA    @08,1                                               0459 00874000
         AH    @08,EVNUM(,@14)                                     0459 00875000
         ST    @08,L                                               0459 00876000
*                  R3 = SUMSIZE1; /*LENGTH OF SYSUMONE TABLE IN BYTES*/ 00877000
         LA    R3,104                                              0460 00878000
*                  GEN(GETMAIN EC,LV=(R3),A=COMPLINK); /*GET CORE FOR*/ 00879000
         GETMAIN EC,LV=(R3),A=COMPLINK                                  00880000
*                                           /*NEW SYSUMONE ENTRY*/ 0462 00881000
*                  IF R15 = SUCCESS THEN /*IF GOOD GETMAIN   @Z427VLS*/ 00882000
         SLR   @14,@14                                             0462 00883000
         CR    R15,@14                                             0462 00884000
         BNE   @RF00462                                            0462 00885000
*                  DO;                                     /*@Z427VLS*/ 00886000
*                  IF EVNUM > ZERO THEN /*DONT SET PTR IF ONLY ENTRY*/  00887000
         L     @08,EVPTR(,R2)                                      0464 00888000
         CH    @14,EVNUM(,@08)                                     0464 00889000
         BNL   @RF00464                                            0464 00890000
*                    SYSUMNXT = COMPLINK; /*SET PTR IN OLD ENT TO NEW*/ 00891000
         L     @14,SYSUMPTR(,R2)                                   0465 00892000
         L     @08,COMPLINK                                        0465 00893000
         ST    @08,SYSUMNXT(,@14)                                  0465 00894000
*                  SYSUMPTR = COMPLINK; /*ADDRESS NEW ENTRY OF SYSUMON* 00895000
@RF00464 L     @14,COMPLINK                                        0466 00896000
         ST    @14,SYSUMPTR(,R2)                                   0466 00897000
*                  SYSUMONE = (SYSUMONE && SYSUMONE); /*CLEAR ENTRY*/   00898000
         XC    SYSUMONE(100,@14),SYSUMONE(@14)                     0467 00899000
*                  EVMODEL(L) = LRTMODEL; /*SET NEW EVTABLE ENTRY FOR*/ 00900000
         L     @14,L                                               0468 00901000
         LR    @08,@14                                             0468 00902000
         MH    @08,@CH00081                                        0468 00903000
         L     @06,EVPTR(,R2)                                      0468 00904000
         ST    @08,@TF00001                                        0468 00905000
         ALR   @08,@06                                             0468 00906000
         MVC   EVMODEL-6(2,@08),LRTMODEL(R7)                       0468 00907000
*                  EVSERIAL(L) = LRTCPUS; /*CPU IDENTIFIED AS UNIQUE*/  00908000
         LR    @08,@06                                             0469 00909000
         AL    @08,@TF00001                                        0469 00910000
         MVC   EVSERIAL-6(3,@08),LRTCPUS(R7)                       0469 00911000
*                  SAVEADR(L) = SYSUMPTR; /*SAVE ADDRESS FOR SORTING*/  00912000
         SLA   @14,2                                               0470 00913000
         L     @08,SYSUMPTR(,R2)                                   0470 00914000
         ST    @08,SAVEADR-4(@14)                                  0470 00915000
*                  EVNUM = EVNUM + 1; /*ADD 1 TO NUMBER OF ENTRIES*/    00916000
         LA    @14,1                                               0471 00917000
         AH    @14,EVNUM(,@06)                                     0471 00918000
         STH   @14,EVNUM(,@06)                                     0471 00919000
*                  END;                                    /*@Z427VLS*/ 00920000
*                  ELSE  /*IF UNSUCCESSFUL GETMAIN THEN      @Z427VLS*/ 00921000
*                    DO;                                   /*@Z427VLS*/ 00922000
         B     @RC00462                                            0473 00923000
@RF00462 DS    0H                                                  0474 00924000
*                      MSGNO = 1; /*REPORT LACK OF CORE FOR SYSTB*/     00925000
         MVI   MSGNO,X'01'                                         0474 00926000
*                      CALL ERRMSG;                        /*@Z427VLS*/ 00927000
         BAL   @14,ERRMSG                                          0475 00928000
*                      R15 = NOSRTABL;                     /*@0001VLS*/ 00929000
         LA    R15,12                                              0476 00930000
*                      GETFAIL = YES;                      /*@0001VLS*/ 00931000
         OI    GETFAIL,B'00001000'                                 0477 00932000
*                    END;                                  /*@Z427VLS*/ 00933000
*                END;                                      /*@Z427VLS*/ 00934000
*              ELSE  /*HERE WE HAVE NEW CPU WITH NO ROOM IN EVTABLE*/   00935000
*                DO;                                       /*@Z427VLS*/ 00936000
         B     @RC00457                                            0480 00937000
@RF00457 DS    0H                                                  0481 00938000
*                  BUG(13) = BUG(13) + 1; /*COUNT NMBER OF TIMES*/ 0481 00939000
         LA    @14,1                                               0481 00940000
         AL    @14,BUG+48                                          0481 00941000
         ST    @14,BUG+48                                          0481 00942000
*                  IF FIRSTIME = OFF   THEN /*PRINT ERROR MESSAGE ONLY* 00943000
         TM    FIRSTIME,B'00000100'                                0482 00944000
         BNZ   @RF00482                                            0482 00945000
*                    DO;                    /*FOR FIRST EXCESS CPU*/    00946000
*                      MSGNO = 6;                          /*@Z427VLS*/ 00947000
         MVI   MSGNO,X'06'                                         0484 00948000
*                      CALL ERRMSG;                        /*@Z427VLS*/ 00949000
         BAL   @14,ERRMSG                                          0485 00950000
*                      EVSERIAL(K) = 'FFFFFF'X;            /*@Z427VLS*/ 00951000
         L     @14,K                                               0486 00952000
         MH    @14,@CH00081                                        0486 00953000
         L     @08,EVPTR(,R2)                                      0486 00954000
         ST    @14,@TF00001                                        0486 00955000
         ALR   @14,@08                                             0486 00956000
         MVC   EVSERIAL-6(3,@14),@CB00237                          0486 00957000
*                      EVMODEL(K) = 'FFFF'X;               /*@Z427VLS*/ 00958000
         AL    @08,@TF00001                                        0487 00959000
         MVC   EVMODEL-6(2,@08),@CB00261                           0487 00960000
*                      FIRSTIME = ON;       /*NEVER TO RETURN*/    0488 00961000
         OI    FIRSTIME,B'00000100'                                0488 00962000
*                    END;                                  /*@Z427VLS*/ 00963000
*                 END;                                     /*@Z427VLS*/ 00964000
@RF00482 DS    0H                                                  0491 00965000
*               END;                                       /*@Z427VLS*/ 00966000
@RC00457 DS    0H                                                  0492 00967000
*             END;                                         /*@Z427VLS*/ 00968000
@RC00453 DS    0H                                                  0493 00969000
*         END;                                             /*@Z427VLS*/ 00970000
@RC00447 LA    @14,1                                               0493 00971000
         AL    @14,K                                               0493 00972000
         ST    @14,K                                               0493 00973000
         C     @14,@CF00034                                        0493 00974000
         BNH   @DL00446                                            0493 00975000
@DC00446 DS    0H                                                  0494 00976000
* ERROR = R15; /*COMMUNICATE BAD TIDINGS TO CALLING PROC     @Z427VLS*/ 00977000
         ST    R15,ERROR                                           0494 00978000
*RESPECIFY(R3,R15) UNRESTRICTED;                           /*@Z427VLS*/ 00979000
* END; /*CLOSING END FOR SUMONADR                            @Z427VLS*/ 00980000
@EL00007 DS    0H                                                  0496 00981000
@EF00007 DS    0H                                                  0496 00982000
@ER00007 LM    @14,@12,@SA00007                                    0496 00983000
         BR    @14                                                 0496 00984000
*SORTONE: PROC; /*SORT EVTABLE IN DESCENDING ORDER BY MODEL, SERIAL*/   00985000
SORTONE  STM   @14,@12,@SA00008                                    0497 00986000
*               /*NUMBER FOR UNSHARED CPUS AND RELINK THE NEXT     */   00987000
*               /*ENTRY POINTERS FOR TABLE SYSUMONE.         @Z427VLS*/ 00988000
*               /*SET EVLETTER FOR UNSHARED CPUS             @Z427VLS*/ 00989000
*IF NUMUNSHR < EVNUM THEN  /*IF TWO OR MORE CPUS IDENTIFIED AND    */   00990000
         LH    @08,NUMUNSHR                                        0498 00991000
         L     @06,EVPTR(,R2)                                      0498 00992000
         CH    @08,EVNUM(,@06)                                     0498 00993000
         BNL   @RF00498                                            0498 00994000
*                          /*NOT IN SHARE TABLE THEN SORT.   @Z427VLS*/ 00995000
*    DO J = NUMUNSHR BY 1 TO EVNUM - 1; /*SORT IN DESCENDING ORDER */   00996000
         ST    @08,J                                               0499 00997000
         B     @DE00499                                            0499 00998000
@DL00499 DS    0H                                                  0500 00999000
*      DO K = J+1 BY 1 TO EVNUM;                           /*@Z427VLS*/ 01000000
         AL    @08,@CF00055                                        0500 01001000
         ST    @08,K                                               0500 01002000
         B     @DE00500                                            0500 01003000
@DL00500 DS    0H                                                  0501 01004000
*        IF EVKEY(J) < EVKEY(K) THEN                               0501 01005000
         L     @06,J                                               0501 01006000
         LA    @03,6                                               0501 01007000
         LR    @05,@06                                             0501 01008000
         MR    @04,@03                                             0501 01009000
         L     @04,EVPTR(,R2)                                      0501 01010000
         LR    @15,@03                                             0501 01011000
         MR    @14,@08                                             0501 01012000
         ST    @05,@TF00001                                        0501 01013000
         ALR   @05,@04                                             0501 01014000
         ST    @15,@TF00002                                        0501 01015000
         ALR   @15,@04                                             0501 01016000
         CLC   EVKEY-6(6,@05),EVKEY-6(@15)                         0501 01017000
         BNL   @RF00501                                            0501 01018000
*          DO;                                             /*@Z427VLS*/ 01019000
*            EVKEY(J) = (EVKEY(J)   &&   EVKEY(K));        /*@Z427VLS*/ 01020000
         LR    @03,@04                                             0503 01021000
         AL    @03,@TF00001                                        0503 01022000
         LR    @05,@04                                             0503 01023000
         AL    @05,@TF00001                                        0503 01024000
         MVC   @TS00001(6),EVKEY-6(@05)                            0503 01025000
         LR    @05,@04                                             0503 01026000
         AL    @05,@TF00002                                        0503 01027000
         XC    @TS00001(6),EVKEY-6(@05)                            0503 01028000
         MVC   EVKEY-6(6,@03),@TS00001                             0503 01029000
*            EVKEY(K) = (EVKEY(K)   &&   EVKEY(J));        /*@Z427VLS*/ 01030000
         LR    @03,@04                                             0504 01031000
         AL    @03,@TF00002                                        0504 01032000
         LR    @05,@04                                             0504 01033000
         AL    @05,@TF00002                                        0504 01034000
         MVC   @TS00001(6),EVKEY-6(@05)                            0504 01035000
         LR    @05,@04                                             0504 01036000
         AL    @05,@TF00001                                        0504 01037000
         XC    @TS00001(6),EVKEY-6(@05)                            0504 01038000
         MVC   EVKEY-6(6,@03),@TS00001                             0504 01039000
*            EVKEY(J) = (EVKEY(J)   &&   EVKEY(K));        /*@Z427VLS*/ 01040000
         LR    @03,@04                                             0505 01041000
         AL    @03,@TF00001                                        0505 01042000
         LR    @05,@04                                             0505 01043000
         AL    @05,@TF00001                                        0505 01044000
         MVC   @TS00001(6),EVKEY-6(@05)                            0505 01045000
         AL    @04,@TF00002                                        0505 01046000
         XC    @TS00001(6),EVKEY-6(@04)                            0505 01047000
         MVC   EVKEY-6(6,@03),@TS00001                             0505 01048000
*            SAVEADR(J) = (SAVEADR(J)  &&  SAVEADR(K));    /*@Z427VLS*/ 01049000
         LR    @03,@06                                             0506 01050000
         SLA   @03,2                                               0506 01051000
         LR    @15,@08                                             0506 01052000
         SLA   @15,2                                               0506 01053000
         L     @00,SAVEADR-4(@03)                                  0506 01054000
         X     @00,SAVEADR-4(@15)                                  0506 01055000
         ST    @00,SAVEADR-4(@03)                                  0506 01056000
*            SAVEADR(K) = (SAVEADR(K)  &&  SAVEADR(J));    /*@Z427VLS*/ 01057000
         X     @00,SAVEADR-4(@15)                                  0507 01058000
         ST    @00,SAVEADR-4(@15)                                  0507 01059000
*            SAVEADR(J) = (SAVEADR(J)  &&  SAVEADR(K));    /*@Z427VLS*/ 01060000
         X     @00,SAVEADR-4(@03)                                  0508 01061000
         ST    @00,SAVEADR-4(@03)                                  0508 01062000
*            /*MUST NOW SHOW HOW EVTABLE HAS BEEN SORTED IN ORDER TO*/  01063000
*            /*ADJUST ENTRY POINTERS TO EVTABLE IN TABLE SYSUM2*/  0509 01064000
*            FLIP(J) = (FLIP(J) && FLIP(K));               /*@Z427VLS*/ 01065000
         SLR   @15,@15                                             0509 01066000
         IC    @15,FLIP-1(@06)                                     0509 01067000
         SLR   @14,@14                                             0509 01068000
         IC    @14,FLIP-1(@08)                                     0509 01069000
         XR    @15,@14                                             0509 01070000
         STC   @15,FLIP-1(@06)                                     0509 01071000
*            FLIP(K) = (FLIP(K) && FLIP(J));               /*@Z427VLS*/ 01072000
         SLR   @14,@14                                             0510 01073000
         IC    @14,FLIP-1(@08)                                     0510 01074000
         XR    @15,@14                                             0510 01075000
         STC   @15,FLIP-1(@08)                                     0510 01076000
*            FLIP(J) = (FLIP(J) && FLIP(K));               /*@Z427VLS*/ 01077000
         SLR   @08,@08                                             0511 01078000
         IC    @08,FLIP-1(@06)                                     0511 01079000
         XR    @15,@08                                             0511 01080000
         STC   @15,FLIP-1(@06)                                     0511 01081000
*            IF J > 1 THEN                                         0512 01082000
         C     @06,@CF00055                                        0512 01083000
         BNH   @RF00512                                            0512 01084000
*             DO;                                          /*@Z427VLS*/ 01085000
*               SYSUMPTR = SAVEADR(J-1);                   /*@Z427VLS*/ 01086000
         L     @08,SAVEADR-8(@03)                                  0514 01087000
         ST    @08,SYSUMPTR(,R2)                                   0514 01088000
*               SYSUMNXT = SAVEADR(J);                     /*@Z427VLS*/ 01089000
         ST    @00,SYSUMNXT(,@08)                                  0515 01090000
*             END;                                         /*@Z427VLS*/ 01091000
*            SYSUMPTR = SAVEADR(J);                        /*@Z427VLS*/ 01092000
@RF00512 L     @08,J                                               0517 01093000
         SLA   @08,2                                               0517 01094000
         L     @06,SAVEADR-4(@08)                                  0517 01095000
         ST    @06,SYSUMPTR(,R2)                                   0517 01096000
*            SYSUMNXT = SAVEADR(J+1);                      /*@Z427VLS*/ 01097000
         L     @08,SAVEADR(@08)                                    0518 01098000
         ST    @08,SYSUMNXT(,@06)                                  0518 01099000
*            SYSUMPTR = SAVEADR(K-1);                      /*@Z427VLS*/ 01100000
         L     @08,K                                               0519 01101000
         LR    @06,@08                                             0519 01102000
         SLA   @06,2                                               0519 01103000
         L     @03,SAVEADR-8(@06)                                  0519 01104000
         ST    @03,SYSUMPTR(,R2)                                   0519 01105000
*            SYSUMNXT = SAVEADR(K);                        /*@Z427VLS*/ 01106000
         L     @15,SAVEADR-4(@06)                                  0520 01107000
         ST    @15,SYSUMNXT(,@03)                                  0520 01108000
*            IF K < EVNUM THEN                                     0521 01109000
         L     @03,EVPTR(,R2)                                      0521 01110000
         CH    @08,EVNUM(,@03)                                     0521 01111000
         BNL   @RF00521                                            0521 01112000
*              DO;                                         /*@Z427VLS*/ 01113000
*                SYSUMPTR = SAVEADR(K);                    /*@Z427VLS*/ 01114000
         ST    @15,SYSUMPTR(,R2)                                   0523 01115000
*                SYSUMNXT = SAVEADR(K+1);                  /*@Z427VLS*/ 01116000
         L     @08,SAVEADR(@06)                                    0524 01117000
         ST    @08,SYSUMNXT(,@15)                                  0524 01118000
*              END;                                        /*@Z427VLS*/ 01119000
*            IF K = EVNUM THEN /*DONT RESET LAST ENTRY FORWARD PTR*/    01120000
@RF00521 L     @08,K                                               0526 01121000
         L     @06,EVPTR(,R2)                                      0526 01122000
         CH    @08,EVNUM(,@06)                                     0526 01123000
         BNE   @RF00526                                            0526 01124000
*              DO;                                         /*@Z427VLS*/ 01125000
*                SYSUMPTR = SAVEADR(K);                    /*@Z427VLS*/ 01126000
         SLA   @08,2                                               0528 01127000
         L     @08,SAVEADR-4(@08)                                  0528 01128000
         ST    @08,SYSUMPTR(,R2)                                   0528 01129000
*                SYSUMNXT = 0; /*LAST ENTRY CANT POINT TO ANOTHER*/     01130000
         SLR   @06,@06                                             0529 01131000
         ST    @06,SYSUMNXT(,@08)                                  0529 01132000
*              END;                                        /*@Z427VLS*/ 01133000
*          END;                                            /*@Z427VLS*/ 01134000
@RF00526 DS    0H                                                  0532 01135000
*        END;                                              /*@Z427VLS*/ 01136000
@RF00501 LA    @08,1                                               0532 01137000
         AL    @08,K                                               0532 01138000
         ST    @08,K                                               0532 01139000
@DE00500 L     @06,EVPTR(,R2)                                      0532 01140000
         CH    @08,EVNUM(,@06)                                     0532 01141000
         BNH   @DL00500                                            0532 01142000
*     END;                                                 /*@Z427VLS*/ 01143000
         LA    @08,1                                               0533 01144000
         AL    @08,J                                               0533 01145000
         ST    @08,J                                               0533 01146000
@DE00499 L     @06,EVPTR(,R2)                                      0533 01147000
         LH    @06,EVNUM(,@06)                                     0533 01148000
         BCTR  @06,0                                               0533 01149000
         CR    @08,@06                                             0533 01150000
         BNH   @DL00499                                            0533 01151000
* CALL SUMTHEM; /*ADD TO SUMMARY COLUMN OF SYSUMONE          @Z427VLS*/ 01152000
@RF00498 BAL   @14,SUMTHEM                                         0534 01153000
*END; /*CLOSING END TO PROC SORTONE                          @Z427VLS*/ 01154000
@EL00008 DS    0H                                                  0535 01155000
@EF00008 DS    0H                                                  0535 01156000
@ER00008 LM    @14,@12,@SA00008                                    0535 01157000
         BR    @14                                                 0535 01158000
*SUMTHEM: PROC; /*SET SUMMARY COLUMN OF SYSUMONE AND LINK IT AS THE*/   01159000
SUMTHEM  STM   @14,@12,12(@13)                                     0536 01160000
*               /*FIRST ENTRY OF THE TABLE. SET EVLETTER FOR THOSE*/    01161000
*               /*ENTRIES IN WHICH IT IS UNSET               @Z427VLS*/ 01162000
*IF NUMUNSHR < EVNUM + 1 THEN  /*IF SOME EVLETTERS REMAIN UNSET*/  0537 01163000
         LH    @08,NUMUNSHR                                        0537 01164000
         L     @06,EVPTR(,R2)                                      0537 01165000
         LA    @03,1                                               0537 01166000
         AH    @03,EVNUM(,@06)                                     0537 01167000
         CR    @08,@03                                             0537 01168000
         BNL   @RF00537                                            0537 01169000
*  DO J = NUMUNSHR BY 1 TO EVNUM;                          /*@Z427VLS*/ 01170000
         ST    @08,J                                               0538 01171000
         B     @DE00538                                            0538 01172000
@DL00538 DS    0H                                                  0539 01173000
*    EVLETTER(J) = EVCON(J); /*GET APPROPRIATE NEXT CONSECUTIVE LETTR*/ 01174000
         LR    @06,@08                                             0539 01175000
         MH    @06,@CH00081                                        0539 01176000
         L     @03,EVPTR(,R2)                                      0539 01177000
         ALR   @03,@06                                             0539 01178000
         LA    @06,EVCON-1(@08)                                    0539 01179000
         MVC   EVLETTER-6(1,@03),0(@06)                            0539 01180000
*  END;                                                    /*@Z427VLS*/ 01181000
         AL    @08,@CF00055                                        0540 01182000
         ST    @08,J                                               0540 01183000
@DE00538 L     @06,EVPTR(,R2)                                      0540 01184000
         CH    @08,EVNUM(,@06)                                     0540 01185000
         BNH   @DL00538                                            0540 01186000
*/* ADD ALL CPU ENTRIES TO THE SUMMARY COLUMN ENTRY          @Z427VLS*/ 01187000
*  SYSUMPTR = SAVEADR(1); /*ADDRESS 1ST SYSUMONE ENTRY       @Z427VLS*/ 01188000
@RF00537 L     @08,SAVEADR                                         0541 01189000
         ST    @08,SYSUMPTR(,R2)                                   0541 01190000
*DO J = 1 BY 1 TO EVNUM;                                   /*@Z427VLS*/ 01191000
         LA    @08,1                                               0542 01192000
         ST    @08,J                                               0542 01193000
         B     @DE00542                                            0542 01194000
@DL00542 DS    0H                                                  0543 01195000
*  SYSUMNUM = EVNUM + 1; /*NUMBER OF ENTRIES INTO PARTICULAR ENTRY*/    01196000
         L     @08,SYSUMPTR(,R2)                                   0543 01197000
         LA    @06,1                                               0543 01198000
         L     @03,EVPTR(,R2)                                      0543 01199000
         LH    @03,EVNUM(,@03)                                     0543 01200000
         ALR   @03,@06                                             0543 01201000
         ST    @03,SYSUMNUM(,@08)                                  0543 01202000
*  STSUMIPL = STSUMIPL + SYSUMIPL; /*ADD IPL COUNTER         @Z427VLS*/ 01203000
         L     @03,STSUMPTR                                        0544 01204000
         L     @00,STSUMIPL(,@03)                                  0544 01205000
         AL    @00,SYSUMIPL(,@08)                                  0544 01206000
         ST    @00,STSUMIPL(,@03)                                  0544 01207000
*  STSUMMCR = STSUMMCR + SYSUMMCR; /*ADD MCH RECOVERABLE COUNTER*/ 0545 01208000
         L     @00,STSUMMCR(,@03)                                  0545 01209000
         AL    @00,SYSUMMCR(,@08)                                  0545 01210000
         ST    @00,STSUMMCR(,@03)                                  0545 01211000
*  STSUMMCN = STSUMMCN + SYSUMMCN; /*ADD MCH NON-RECOVERABLE COUNTER*/  01212000
         L     @00,STSUMMCN(,@03)                                  0546 01213000
         AL    @00,SYSUMMCN(,@08)                                  0546 01214000
         ST    @00,STSUMMCN(,@03)                                  0546 01215000
*  STSUMPEI = STSUMPEI + SYSUMPEI; /*ADD PGM INTERRUPT COUNTER*/   0547 01216000
         L     @00,STSUMPEI(,@03)                                  0547 01217000
         AL    @00,SYSUMPEI(,@08)                                  0547 01218000
         ST    @00,STSUMPEI(,@03)                                  0547 01219000
*  STSUMPEA = STSUMPEA + SYSUMPEA; /*ADD PGM ABEND COUNTER   @Z427VLS*/ 01220000
         L     @00,STSUMPEA(,@03)                                  0548 01221000
         AL    @00,SYSUMPEA(,@08)                                  0548 01222000
         ST    @00,STSUMPEA(,@03)                                  0548 01223000
*  STSUMPER = STSUMPER + SYSUMPER; /*ADD PGM RESTART COUNTER @Z427VLS*/ 01224000
         L     @00,STSUMPER(,@03)                                  0549 01225000
         AL    @00,SYSUMPER(,@08)                                  0549 01226000
         ST    @00,STSUMPER(,@03)                                  0549 01227000
*  STSUMEOD = STSUMEOD + SYSUMEOD; /*ADD EOD COUNTER         @Z427VLS*/ 01228000
         L     @00,STSUMEOD(,@03)                                  0550 01229000
         AL    @00,SYSUMEOD(,@08)                                  0550 01230000
         ST    @00,STSUMEOD(,@03)                                  0550 01231000
*  DO K = 1 BY 1 TO 16; /*LOOP THROUGH ALL POSSIBLE CHANNELS @Z427VLS*/ 01232000
         ST    @06,K                                               0551 01233000
@DL00551 DS    0H                                                  0552 01234000
*    STSUMCH(K) = STSUMCH(K) + SYSUMCH(K); /*ADD CHANNEL X TO CTR*/     01235000
         L     @08,STSUMPTR                                        0552 01236000
         LR    @03,@06                                             0552 01237000
         SLA   @03,2                                               0552 01238000
         L     @15,SYSUMPTR(,R2)                                   0552 01239000
         L     @00,STSUMCH-4(@03,@08)                              0552 01240000
         AL    @00,SYSUMCH-4(@03,@15)                              0552 01241000
         ST    @00,STSUMCH-4(@03,@08)                              0552 01242000
*  END;                                                    /*@Z427VLS*/ 01243000
         AL    @06,@CF00055                                        0553 01244000
         ST    @06,K                                               0553 01245000
         C     @06,@CF00088                                        0553 01246000
         BNH   @DL00551                                            0553 01247000
*  SYSUMPTR = SYSUMNXT; /*UPDATE SYSUMONE ENTRY ADDRESS      @Z427VLS*/ 01248000
         L     @08,SYSUMPTR(,R2)                                   0554 01249000
         L     @08,SYSUMNXT(,@08)                                  0554 01250000
         ST    @08,SYSUMPTR(,R2)                                   0554 01251000
*END;                                                      /*@Z427VLS*/ 01252000
         LA    @08,1                                               0555 01253000
         AL    @08,J                                               0555 01254000
         ST    @08,J                                               0555 01255000
@DE00542 L     @06,EVPTR(,R2)                                      0555 01256000
         CH    @08,EVNUM(,@06)                                     0555 01257000
         BNH   @DL00542                                            0555 01258000
*/* LINK STSUMONE, SUMMARY COLUMN TO THE FIRST ENTRY OF SYSUMONE*/ 0556 01259000
*SYSUMPTR = STSUMPTR; /*ADDRESS SUMMARY COLUMN AS FIRST SYSUMONE ENTRY* 01260000
         L     @08,STSUMPTR                                        0556 01261000
         ST    @08,SYSUMPTR(,R2)                                   0556 01262000
*SYSUMNXT = SAVEADR(1); /*POINT TO FIRST CPU ENTRY           @Z427VLS*/ 01263000
         L     @06,SAVEADR                                         0557 01264000
         ST    @06,SYSUMNXT(,@08)                                  0557 01265000
*SYSUMNUM = EVNUM + 1; /*NUMBER OF CPUS PLUS SUMMARY COLUMN  @Z427VLS*/ 01266000
         L     @06,EVPTR(,R2)                                      0558 01267000
         LA    @03,1                                               0558 01268000
         AH    @03,EVNUM(,@06)                                     0558 01269000
         ST    @03,SYSUMNUM(,@08)                                  0558 01270000
*END; /*CLOSING END FOR SUMTHEM                              @Z427VLS*/ 01271000
@EL00009 DS    0H                                                  0559 01272000
@EF00009 DS    0H                                                  0559 01273000
@ER00009 LM    @14,@12,12(@13)                                     0559 01274000
         BR    @14                                                 0559 01275000
*SORTSHAR: PROC;        /* SORT SHARE TABLE CPU BY LETTER  @ZA17692 */  01276000
SORTSHAR STM   @14,@12,12(@13)                                     0560 01277000
*  DO J=1 BY 1 TO SHARENUM-1;                           /* @ZA17692 */  01278000
         LA    @08,1                                               0561 01279000
         ST    @08,J                                               0561 01280000
         B     @DE00561                                            0561 01281000
@DL00561 DS    0H                                                  0562 01282000
*    DO K= J+1 BY 1 TO SHARENUM;                        /* @ZA17692 */  01283000
         AL    @08,@CF00055                                        0562 01284000
         ST    @08,K                                               0562 01285000
         B     @DE00562                                            0562 01286000
@DL00562 DS    0H                                                  0563 01287000
*      IF SHARLET(J) > SHARLET(K)  THEN               /* @ZA17692 */    01288000
         LA    @06,11                                              0563 01289000
         L     @05,J                                               0563 01290000
         MR    @04,@06                                             0563 01291000
         L     @03,SHAREPTR(,R2)                                   0563 01292000
         LR    @15,@08                                             0563 01293000
         MR    @14,@06                                             0563 01294000
         ST    @05,@TF00001                                        0563 01295000
         ALR   @05,@03                                             0563 01296000
         ST    @15,@TF00002                                        0563 01297000
         ALR   @15,@03                                             0563 01298000
         CLC   SHARLET-11(1,@05),SHARLET-11(@15)                   0563 01299000
         BNH   @RF00563                                            0563 01300000
*        DO;                                            /* @ZA17692 */  01301000
*          SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));         /* @ZA17692 */  01302000
         LR    @08,@03                                             0565 01303000
         AL    @08,@TF00001                                        0565 01304000
         AL    @08,@CF01510                                        0565 01305000
         LR    @06,@03                                             0565 01306000
         AL    @06,@TF00001                                        0565 01307000
         AL    @06,@CF01510                                        0565 01308000
         MVC   @TS00001(11),SHAREIO-2(@06)                         0565 01309000
         LR    @06,@03                                             0565 01310000
         AL    @06,@TF00002                                        0565 01311000
         AL    @06,@CF01510                                        0565 01312000
         XC    @TS00001(11),SHAREIO-2(@06)                         0565 01313000
         MVC   SHAREIO-2(11,@08),@TS00001                          0565 01314000
*          SHAREIO(K)=(SHAREIO(K)&&SHAREIO(J));         /* @ZA17692 */  01315000
         LR    @08,@03                                             0566 01316000
         AL    @08,@TF00002                                        0566 01317000
         AL    @08,@CF01510                                        0566 01318000
         LR    @06,@03                                             0566 01319000
         AL    @06,@TF00002                                        0566 01320000
         AL    @06,@CF01510                                        0566 01321000
         MVC   @TS00001(11),SHAREIO-2(@06)                         0566 01322000
         LR    @06,@03                                             0566 01323000
         AL    @06,@TF00001                                        0566 01324000
         AL    @06,@CF01510                                        0566 01325000
         XC    @TS00001(11),SHAREIO-2(@06)                         0566 01326000
         MVC   SHAREIO-2(11,@08),@TS00001                          0566 01327000
*          SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));         /* @ZA17692 */  01328000
         LR    @08,@03                                             0567 01329000
         AL    @08,@TF00001                                        0567 01330000
         AL    @08,@CF01510                                        0567 01331000
         LR    @06,@03                                             0567 01332000
         AL    @06,@TF00001                                        0567 01333000
         AL    @06,@CF01510                                        0567 01334000
         MVC   @TS00001(11),SHAREIO-2(@06)                         0567 01335000
         AL    @03,@TF00002                                        0567 01336000
         AL    @03,@CF01510                                        0567 01337000
         XC    @TS00001(11),SHAREIO-2(@03)                         0567 01338000
         MVC   SHAREIO-2(11,@08),@TS00001                          0567 01339000
*        END;                                           /* @ZA17692 */  01340000
*     END;                                              /* @ZA17692 */  01341000
@RF00563 LA    @08,1                                               0569 01342000
         AL    @08,K                                               0569 01343000
         ST    @08,K                                               0569 01344000
@DE00562 L     @06,SHAREPTR(,R2)                                   0569 01345000
         CH    @08,SHARENUM(,@06)                                  0569 01346000
         BNH   @DL00562                                            0569 01347000
*  END;                                                 /* @ZA17692 */  01348000
         LA    @08,1                                               0570 01349000
         AL    @08,J                                               0570 01350000
         ST    @08,J                                               0570 01351000
@DE00561 L     @06,SHAREPTR(,R2)                                   0570 01352000
         LH    @06,SHARENUM(,@06)                                  0570 01353000
         BCTR  @06,0                                               0570 01354000
         CR    @08,@06                                             0570 01355000
         BNH   @DL00561                                            0570 01356000
*END;                       /*  CLOSING END FOR SORTSHAR   @ZA17692 */  01357000
@EL00010 DS    0H                                                  0571 01358000
@EF00010 DS    0H                                                  0571 01359000
@ER00010 LM    @14,@12,12(@13)                                     0571 01360000
         BR    @14                                                 0571 01361000
* RECDEP: PROC; /*IDENTIFY RECORD TYPE AND ACCUMULATE RECORD OR*/  0572 01362000
RECDEP   STM   @14,@12,@SA00011                                    0572 01363000
*               /*APPROPRIATE ERRORS IN SYSUMONE OR SYSUM2   @Z427VLS*/ 01364000
* WORKTYPE = (LRTKEY1 & GENREC);                           /*@Z427VLS*/ 01365000
         MVC   WORKTYPE(1),LRTKEY1(R7)                             0573 01366000
         NI    WORKTYPE,X'F0'                                      0573 01367000
* IF LRTRUNC = ON | (WORKTYPE < HEX10)                             0574 01368000
*                 | (WORKTYPE > HEX90) THEN                        0574 01369000
         TM    LRTRUNC(R7),B'00100000'                             0574 01370000
         BO    @RT00574                                            0574 01371000
         CLI   WORKTYPE,X'10'                                      0574 01372000
         BL    @RT00574                                            0574 01373000
         CLI   WORKTYPE,X'90'                                      0574 01374000
         BNH   @RF00574                                            0574 01375000
@RT00574 DS    0H                                                  0575 01376000
*   BUG(1) = BUG(1) + 1;                                   /*@Z427VLS*/ 01377000
         LA    @08,1                                               0575 01378000
         AL    @08,BUG                                             0575 01379000
         ST    @08,BUG                                             0575 01380000
* ELSE                                                             0576 01381000
*   DO;                                                    /*@Z427VLS*/ 01382000
         B     @RC00574                                            0576 01383000
@RF00574 DS    0H                                                  0577 01384000
*     IF WORKTYPE = HEX30 | WORKTYPE = HEX90 THEN /*OBR OR MDR REC.*/   01385000
         CLI   WORKTYPE,X'30'                                      0577 01386000
         BE    @RT00577                                            0577 01387000
         CLI   WORKTYPE,X'90'                                      0577 01388000
         BNE   @RF00577                                            0577 01389000
@RT00577 DS    0H                                                  0578 01390000
*       CALL CONTERR;                                      /*@Z427VLS*/ 01391000
         BAL   @14,CONTERR                                         0578 01392000
*     ELSE                                                         0579 01393000
*       DO;                                                /*@Z427VLS*/ 01394000
         B     @RC00577                                            0579 01395000
@RF00577 DS    0H                                                  0580 01396000
*         IF WORKTYPE = HEX40 THEN                                 0580 01397000
         CLI   WORKTYPE,X'40'                                      0580 01398000
         BNE   @RF00580                                            0580 01399000
*           DO;                                            /*@Z427VLS*/ 01400000
*             CALL SUMONADR;                               /*@Z427VLS*/ 01401000
         BAL   @14,SUMONADR                                        0582 01402000
*             CALL SOFTFILT;                               /*@Z427VLS*/ 01403000
         BAL   @14,SOFTFILT                                        0583 01404000
*           END;                                           /*@Z427VLS*/ 01405000
*         ELSE                                                     0585 01406000
*           DO;                                            /*@Z427VLS*/ 01407000
         B     @RC00580                                            0585 01408000
@RF00580 DS    0H                                                  0586 01409000
*             IF WORKTYPE = HEX10 THEN                             0586 01410000
         CLI   WORKTYPE,X'10'                                      0586 01411000
         BNE   @RF00586                                            0586 01412000
*               DO;                                        /*@Z427VLS*/ 01413000
*                 CALL SUMONADR;                           /*@Z427VLS*/ 01414000
         BAL   @14,SUMONADR                                        0588 01415000
*                 CALL MCHFILT;                            /*@Z427VLS*/ 01416000
         BAL   @14,MCHFILT                                         0589 01417000
*                 BUG(3) = BUG(3) + 1;                     /*@Z427VLS*/ 01418000
         LA    @08,1                                               0590 01419000
         AL    @08,BUG+8                                           0590 01420000
         ST    @08,BUG+8                                           0590 01421000
*               END;                                       /*@Z427VLS*/ 01422000
*             ELSE                                                 0592 01423000
*               DO;                                        /*@Z427VLS*/ 01424000
         B     @RC00586                                            0592 01425000
@RF00586 DS    0H                                                  0593 01426000
*                 IF WORKTYPE = HEX20 THEN                         0593 01427000
         CLI   WORKTYPE,X'20'                                      0593 01428000
         BNE   @RF00593                                            0593 01429000
*                   DO;                                    /*@Z427VLS*/ 01430000
*                     CALL SUMONADR;                       /*@Z427VLS*/ 01431000
         BAL   @14,SUMONADR                                        0595 01432000
*                     SYSUMCH(WORKCHAN+1) = SYSUMCH(WORKCHAN+1) + 1;    01433000
         SLR   @08,@08                                             0596 01434000
         IC    @08,WORKCHAN(,R7)                                   0596 01435000
         SLA   @08,2                                               0596 01436000
         L     @06,SYSUMPTR(,R2)                                   0596 01437000
         LA    @03,1                                               0596 01438000
         L     @00,SYSUMCH(@08,@06)                                0596 01439000
         ALR   @00,@03                                             0596 01440000
         ST    @00,SYSUMCH(@08,@06)                                0596 01441000
*                     BUG(4) = BUG(4) + 1;                 /*@Z427VLS*/ 01442000
         L     @08,BUG+12                                          0597 01443000
         ALR   @08,@03                                             0597 01444000
         ST    @08,BUG+12                                          0597 01445000
*                      IF FRAMEPTR ^= ZERO THEN /*IF FRAMETAB ALLOC*/   01446000
         L     @08,FRAMEPTR(,R2)                                   0598 01447000
         LTR   @08,@08                                             0598 01448000
         BZ    @RF00598                                            0598 01449000
*                      DO;                                 /*@G51DGBB*/ 01450000
*                      GETOUT = NO;                        /*@G51DGBB*/ 01451000
         NI    GETOUT,B'11110111'                                  0600 01452000
*                      DO A = 1 BY 1 TO MRDNUMBR WHILE GETOUT = NO;     01453000
         ST    @03,A                                               0601 01454000
         B     @DE00601                                            0601 01455000
@DL00601 TM    GETOUT,B'00001000'                                  0601 01456000
         BNZ   @DC00601                                            0601 01457000
*                      /*LOOP THROUGH LIST OF MERIDIAN-LIKE CPUS*/ 0602 01458000
*                      IF MODEL(A) = LRTMODEL THEN /*IF MERID-LIKE */   01459000
         ALR   @03,@03                                             0602 01460000
         L     @08,MERDCPTR(,R2)                                   0602 01461000
         ALR   @08,@03                                             0602 01462000
         CLC   MODEL-2(2,@08),LRTMODEL(R7)                         0602 01463000
         BNE   @RF00602                                            0602 01464000
*                        DO;                               /*@G51DGBB*/ 01465000
*                          CALL BUILDFTB; /*SEE IF UNIQUE,BUILD IF IS*/ 01466000
         BAL   @14,BUILDFTB                                        0604 01467000
*                          GETOUT = YES;  /*EXIT LOOP        @G51DGBB*/ 01468000
         OI    GETOUT,B'00001000'                                  0605 01469000
*                        END;                              /*@G51DGBB*/ 01470000
*                      END;                                /*@G51DGBB*/ 01471000
@RF00602 LA    @03,1                                               0607 01472000
         AL    @03,A                                               0607 01473000
         ST    @03,A                                               0607 01474000
@DE00601 L     @08,MERDCPTR(,R2)                                   0607 01475000
         CH    @03,MRDNUMBR(,@08)                                  0607 01476000
         BNH   @DL00601                                            0607 01477000
@DC00601 DS    0H                                                  0608 01478000
*                      END;                                /*@G51DGBB*/ 01479000
*                   END;                                   /*@Z427VLS*/ 01480000
*                 ELSE                                             0610 01481000
*                   DO;                                    /*@Z427VLS*/ 01482000
         B     @RC00593                                            0610 01483000
@RF00593 DS    0H                                                  0611 01484000
*                     IF WORKTYPE = HEX50 THEN                     0611 01485000
         CLI   WORKTYPE,X'50'                                      0611 01486000
         BNE   @RF00611                                            0611 01487000
*                       DO;                                /*@Z427VLS*/ 01488000
*                         CALL SUMONADR;                   /*@Z427VLS*/ 01489000
         BAL   @14,SUMONADR                                        0613 01490000
*                         SYSUMIPL = SYSUMIPL + 1;         /*@Z427VLS*/ 01491000
         L     @08,SYSUMPTR(,R2)                                   0614 01492000
         LA    @06,1                                               0614 01493000
         L     @03,SYSUMIPL(,@08)                                  0614 01494000
         ALR   @03,@06                                             0614 01495000
         ST    @03,SYSUMIPL(,@08)                                  0614 01496000
*                         BUG(5) = BUG(5) + 1;             /*@Z427VLS*/ 01497000
         AL    @06,BUG+16                                          0615 01498000
         ST    @06,BUG+16                                          0615 01499000
*                       END;                               /*@Z427VLS*/ 01500000
*                     ELSE                                         0617 01501000
*                       DO;                                /*@Z427VLS*/ 01502000
         B     @RC00611                                            0617 01503000
@RF00611 DS    0H                                                  0618 01504000
*                         IF WORKTYPE = HEX80 THEN                 0618 01505000
         CLI   WORKTYPE,X'80'                                      0618 01506000
         BNE   @RF00618                                            0618 01507000
*                           DO;                            /*@Z427VLS*/ 01508000
*                             CALL SUMONADR;               /*@Z427VLS*/ 01509000
         BAL   @14,SUMONADR                                        0620 01510000
*                             SYSUMEOD = SYSUMEOD + 1;     /*@Z427VLS*/ 01511000
         L     @08,SYSUMPTR(,R2)                                   0621 01512000
         LA    @06,1                                               0621 01513000
         L     @03,SYSUMEOD(,@08)                                  0621 01514000
         ALR   @03,@06                                             0621 01515000
         ST    @03,SYSUMEOD(,@08)                                  0621 01516000
*                             BUG(6) = BUG(6) + 1;         /*@Z427VLS*/ 01517000
         AL    @06,BUG+20                                          0622 01518000
         ST    @06,BUG+20                                          0622 01519000
*                           END;                           /*@Z427VLS*/ 01520000
*                         ELSE /*VALID RECORD BUT NOT USED   @Z427VLS*/ 01521000
*                           BUG(8) = BUG(8) + 1;           /*@Z427VLS*/ 01522000
         B     @RC00618                                            0624 01523000
@RF00618 LA    @08,1                                               0624 01524000
         AL    @08,BUG+28                                          0624 01525000
         ST    @08,BUG+28                                          0624 01526000
*                       END;                               /*@Z427VLS*/ 01527000
*                   END;                                   /*@Z427VLS*/ 01528000
*               END;                                       /*@Z427VLS*/ 01529000
*           END;                                           /*@Z427VLS*/ 01530000
*       END;                                               /*@Z427VLS*/ 01531000
*   END;                                                   /*@Z427VLS*/ 01532000
*END; /*CLOSING END FOR RECDEP                               @Z427VLS*/ 01533000
@EL00011 DS    0H                                                  0631 01534000
@EF00011 DS    0H                                                  0631 01535000
@ER00011 LM    @14,@12,@SA00011                                    0631 01536000
         BR    @14                                                 0631 01537000
*CONTERR: PROC; /*DETERMINE IF OBR OR MDR REPRESENTS PERMANENT */  0632 01538000
CONTERR  STM   @14,@12,@SA00012                                    0632 01539000
*               /*AND/OR TEMPORARY ERRORS. IF YES, SAVE ERROR  */  0633 01540000
*               /*COUNTS IN SYSUM2                           @Z427VLS*/ 01541000
*IF WORKTYPE = HEX30 THEN                                          0633 01542000
         CLI   WORKTYPE,X'30'                                      0633 01543000
         BNE   @RF00633                                            0633 01544000
*  CALL COUNTOBR;                                          /*@Z427VLS*/ 01545000
         BAL   @14,COUNTOBR                                        0634 01546000
*ELSE                                                              0635 01547000
*  DO;                                                     /*@Z427VLS*/ 01548000
         B     @RC00633                                            0635 01549000
@RF00633 DS    0H                                                  0636 01550000
*    IF LRTKEY1 = HEX91 & (TPRDEV = DV3705 | TPRDEV = DV3705A) THEN     01551000
         CLI   LRTKEY1(R7),X'91'                                   0636 01552000
         BNE   @RF00636                                            0636 01553000
         CLI   TPRDEV(R7),X'05'                                    0636 01554000
         BE    @RT00636                                            0636 01555000
         CLI   TPRDEV(R7),X'15'                                    0636 01556000
         BNE   @RF00636                                            0636 01557000
@RT00636 DS    0H                                                  0637 01558000
*      CALL CONTMDR;                                       /*@Z427VLS*/ 01559000
         BAL   @14,CONTMDR                                         0637 01560000
*    ELSE /*MDR NOT TYPE 91 AND DEVICE TYPE 3705             @Z427VLS*/ 01561000
*      DO;                                                 /*@Z427VLS*/ 01562000
         B     @RC00636                                            0638 01563000
@RF00636 DS    0H                                                  0639 01564000
*        BUG(23) = BUG(23) + 1;                            /*@Z427VLS*/ 01565000
         LA    @08,1                                               0639 01566000
         AL    @08,BUG+88                                          0639 01567000
         ST    @08,BUG+88                                          0639 01568000
*        IF TPRDEV = DV3330 |                                      0640 01569000
*           TPRDEV = DV3340 |                                      0640 01570000
*           TPRDEV = DV33302 |                                     0640 01571000
*           TPRDEV = DV3350 THEN                                   0640 01572000
         CLI   TPRDEV(R7),X'01'                                    0640 01573000
         BE    @RT00640                                            0640 01574000
         CLI   TPRDEV(R7),X'09'                                    0640 01575000
         BE    @RT00640                                            0640 01576000
         CLI   TPRDEV(R7),X'0A'                                    0640 01577000
         BE    @RT00640                                            0640 01578000
         CLI   TPRDEV(R7),X'11'                                    0640 01579000
         BNE   @RF00640                                            0640 01580000
@RT00640 DS    0H                                                  0641 01581000
*          DO;                                             /*@Z427VLS*/ 01582000
*            SYSTEMP  = SYSTEMP  /*ADD CORRECTIBLE DATA CHECKS*/   0642 01583000
*                       + TPRS1213   /*AND RETRY DATA CHECKS AND*/ 0642 01584000
*                       + TPRS1415   /*SEEK CHECKS           @Z427VLS*/ 01585000
*                       + TPRS19;                          /*@Z427VLS*/ 01586000
         LA    @08,TPRVOL(,R7)                                     0642 01587000
         LA    @06,15                                              0642 01588000
         SLR   @03,@03                                             0642 01589000
         IC    @03,TPRBUFC(,R7)                                    0642 01590000
         NR    @06,@03                                             0642 01591000
         ALR   @08,@06                                             0642 01592000
         AL    @08,@CF01152                                        0642 01593000
         ICM   @06,15,SYSTEMP                                      0642 01594000
         SLR   @03,@03                                             0642 01595000
         ICM   @03,3,TPRS1213(@08)                                 0642 01596000
         ALR   @06,@03                                             0642 01597000
         SLR   @03,@03                                             0642 01598000
         ICM   @03,3,TPRS1415(@08)                                 0642 01599000
         ALR   @06,@03                                             0642 01600000
         SLR   @03,@03                                             0642 01601000
         IC    @03,TPRS19(,@08)                                    0642 01602000
         ALR   @06,@03                                             0642 01603000
         STCM  @06,15,SYSTEMP                                      0642 01604000
*            IF SYSTEMP  > ZERO THEN                               0643 01605000
         SLR   @08,@08                                             0643 01606000
         CR    @06,@08                                             0643 01607000
         BNH   @RF00643                                            0643 01608000
*              DO;                                         /*@Z427VLS*/ 01609000
*                WORKCUA = (TPRCUA & ONLYCUA2);            /*@Z427VLS*/ 01610000
         MVC   WORKCUA(2),TPRCUA(R7)                               0645 01611000
         NC    WORKCUA(2),@CB00936                                 0645 01612000
*                BUG(24) = BUG(24) + 1;                    /*@Z427VLS*/ 01613000
         LA    @06,1                                               0646 01614000
         AL    @06,BUG+92                                          0646 01615000
         ST    @06,BUG+92                                          0646 01616000
*                IF CUAPTR ^= ZERO THEN                            0647 01617000
         C     @08,CUAPTR(,R2)                                     0647 01618000
         BE    @RF00647                                            0647 01619000
*                 CALL CUASELCT;                           /*@Z427VLS*/ 01620000
         BAL   @14,CUASELCT                                        0648 01621000
*                IF DEVPTR ^= ZERO THEN                            0649 01622000
@RF00647 L     @08,DEVPTR(,R2)                                     0649 01623000
         LTR   @08,@08                                             0649 01624000
         BZ    @RF00649                                            0649 01625000
*                 CALL DEVSEL;                             /*@Z427VLS*/ 01626000
         BAL   @14,DEVSEL                                          0650 01627000
*                IF PASSFLAG = YES THEN                            0651 01628000
@RF00649 TM    PASSFLAG(R2),B'00000001'                            0651 01629000
         BNO   @RF00651                                            0651 01630000
*                 DO;                                      /*@Z427VLS*/ 01631000
*                SYSGROUP  = TWO; /*DASDI DEVICE GROUP     @Z427VLS*/   01632000
         MVI   SYSGROUP,X'02'                                      0653 01633000
*                SYSRT  = (TPRCUA & ONLYCUA2);           /*@Z427VLS*/   01634000
         MVC   SYSRT(2),TPRCUA(R7)                                 0654 01635000
         NC    SYSRT(2),@CB00936                                   0654 01636000
*                SYSDEV  = '3830'X;                      /*@Z427VLS*/   01637000
         MVC   SYSDEV(2),@CB01387                                  0655 01638000
*                CALL SETCPU;                              /*@Z427VLS*/ 01639000
         BAL   @14,SETCPU                                          0656 01640000
*                SYSRT  = (SYSRT  & NOU);              /*@Z427VLS*/     01641000
         NC    SYSRT(2),@CB00934                                   0657 01642000
*                 END;                                     /*@Z427VLS*/ 01643000
*              END;                                        /*@Z427VLS*/ 01644000
*          END;                                            /*@Z427VLS*/ 01645000
*        ELSE /*NOT 33XX OR OR 3705 VALID MDR                @Z427VLS*/ 01646000
*          BUG(10) = BUG(10) + 1;                          /*@Z427VLS*/ 01647000
         B     @RC00640                                            0661 01648000
@RF00640 LA    @08,1                                               0661 01649000
         AL    @08,BUG+36                                          0661 01650000
         ST    @08,BUG+36                                          0661 01651000
*       END;                                               /*@Z427VLS*/ 01652000
*  END;                                                    /*@Z427VLS*/ 01653000
*END; /*CLOSING END FOR CONTERR                              @Z427VLS*/ 01654000
@EL00012 DS    0H                                                  0664 01655000
@EF00012 DS    0H                                                  0664 01656000
@ER00012 LM    @14,@12,@SA00012                                    0664 01657000
         BR    @14                                                 0664 01658000
*CONTMDR: PROC; /*COUNT TEMPORARY ERRORS AND INDICATE PERMANENT */ 0665 01659000
CONTMDR  STM   @14,@12,@SA00013                                    0665 01660000
*               /*ERROR IF RECORD REPRESENTS SUCH.           @Z427VLS*/ 01661000
*BUG(9) = BUG(9) + 1;                                      /*@Z427VLS*/ 01662000
         LA    @08,1                                               0666 01663000
         AL    @08,BUG+32                                          0666 01664000
         ST    @08,BUG+32                                          0666 01665000
*IF TPRMODE = LINSTAT0 THEN                                        0667 01666000
         CLI   TPRMODE(R7),X'00'                                   0667 01667000
         BNE   @RF00667                                            0667 01668000
*  DO;                                                     /*@Z427VLS*/ 01669000
*    SYSTEMP  = SYSTEMP  + ERRCT1;                     /*@Z427VLS*/     01670000
         ICM   @08,15,SYSTEMP                                      0669 01671000
         SLR   @06,@06                                             0669 01672000
         IC    @06,ERRCT1(,R7)                                     0669 01673000
         ALR   @08,@06                                             0669 01674000
         STCM  @08,15,SYSTEMP                                      0669 01675000
*    SYSPERM  = ON; /*IDENTIFY ERROR AS PERMANENT          @Z427VLS*/   01676000
         OI    SYSPERM,B'00000001'                                 0670 01677000
*  END;                                                    /*@Z427VLS*/ 01678000
*ELSE                                                              0672 01679000
*  DO;                                                     /*@Z427VLS*/ 01680000
         B     @RC00667                                            0672 01681000
@RF00667 DS    0H                                                  0673 01682000
*    IF TPRMODE = LINSTAT1 THEN                                    0673 01683000
         CLI   TPRMODE(R7),X'01'                                   0673 01684000
         BNE   @RF00673                                            0673 01685000
*      SYSTEMP = ERRCT1;                                   /*@VS48722*/ 01686000
         SLR   @08,@08                                             0674 01687000
         IC    @08,ERRCT1(,R7)                                     0674 01688000
         STCM  @08,15,SYSTEMP                                      0674 01689000
*  ELSE                                                            0675 01690000
*    DO;                                                   /*@Z427VLS*/ 01691000
         B     @RC00673                                            0675 01692000
@RF00673 DS    0H                                                  0676 01693000
*      IF TPRMODE = CHANADAP | /*CHANNEL ADAPTER ERROR       @Z427VLS*/ 01694000
*         TPRMODE = COMSCAN  | /*COMMUNICATION SCANNER ERROR @Z427VLS*/ 01695000
*         TPRMODE = IOERROR  | /*I/O INSTRUCTION EXCEPTION   @Z427VLS*/ 01696000
*         TPRMODE = UNRESOLV | /*UNRESOLVED PROGRAM LEVEL ONE */   0676 01697000
*                              /*INTERRUPT                   @Z427VLS*/ 01698000
*         TPRMODE = LINKERR THEN  /* LINK ERROR              @Z427VLS*/ 01699000
         CLI   TPRMODE(R7),X'10'                                   0676 01700000
         BE    @RT00676                                            0676 01701000
         CLI   TPRMODE(R7),X'11'                                   0676 01702000
         BE    @RT00676                                            0676 01703000
         CLI   TPRMODE(R7),X'12'                                   0676 01704000
         BE    @RT00676                                            0676 01705000
         CLI   TPRMODE(R7),X'13'                                   0676 01706000
         BE    @RT00676                                            0676 01707000
         CLI   TPRMODE(R7),X'02'                                   0676 01708000
         BNE   @RF00676                                            0676 01709000
@RT00676 DS    0H                                                  0677 01710000
*           SYSPERM  = ON;                               /*@Z427VLS*/   01711000
         OI    SYSPERM,B'00000001'                                 0677 01712000
*      ELSE                                                        0678 01713000
*      DO;                                                 /*@Z427VLS*/ 01714000
         B     @RC00676                                            0678 01715000
@RF00676 DS    0H                                                  0679 01716000
*      IF TPRMODE = LINSTAT3 THEN /*IF MODE IS 03            @Z427VLS*/ 01717000
         CLI   TPRMODE(R7),X'03'                                   0679 01718000
         BNE   @RF00679                                            0679 01719000
*         DO;                                              /*@Z427VLS*/ 01720000
*           SYSTEMP  = SYSTEMP  + ERRCT1;              /*@Z427VLS*/     01721000
         ICM   @08,15,SYSTEMP                                      0681 01722000
         SLR   @06,@06                                             0681 01723000
         IC    @06,ERRCT1(,R7)                                     0681 01724000
         ALR   @08,@06                                             0681 01725000
         STCM  @08,15,SYSTEMP                                      0681 01726000
*           SYSPERM  = ON; /*ALWAYS SET TEMP BEFORE PERM   @Z427VLS*/   01727000
         OI    SYSPERM,B'00000001'                                 0682 01728000
*         END;                                             /*@Z427VLS*/ 01729000
*       END;                                               /*@Z427VLS*/ 01730000
@RF00679 DS    0H                                                  0685 01731000
*       END;                                               /*@Z427VLS*/ 01732000
@RC00676 DS    0H                                                  0686 01733000
*    END;                                                  /*@Z427VLS*/ 01734000
@RC00673 DS    0H                                                  0687 01735000
*IF SYSPERM  = ON | SYSTEMP  > ZERO THEN                           0687 01736000
@RC00667 TM    SYSPERM,B'00000001'                                 0687 01737000
         BO    @RT00687                                            0687 01738000
         ICM   @08,15,SYSTEMP                                      0687 01739000
         BNP   @RF00687                                            0687 01740000
@RT00687 DS    0H                                                  0688 01741000
*  DO;                                                     /*@Z427VLS*/ 01742000
*    WORKCUA = (TPRCUA & ONLYCUA2);                        /*@Z427VLS*/ 01743000
         MVC   WORKCUA(2),TPRCUA(R7)                               0689 01744000
         NC    WORKCUA(2),@CB00936                                 0689 01745000
*    BUG(11) = BUG(11) + 1;                                /*@Z427VLS*/ 01746000
         LA    @08,1                                               0690 01747000
         L     @06,BUG+40                                          0690 01748000
         ALR   @06,@08                                             0690 01749000
         ST    @06,BUG+40                                          0690 01750000
*    BUG(19) = BUG(19) + 1;                                /*@Z427VLS*/ 01751000
         AL    @08,BUG+72                                          0691 01752000
         ST    @08,BUG+72                                          0691 01753000
*    IF CUAPTR ^= ZERO THEN                                        0692 01754000
         L     @08,CUAPTR(,R2)                                     0692 01755000
         LTR   @08,@08                                             0692 01756000
         BZ    @RF00692                                            0692 01757000
*     CALL CUASELCT;                                       /*@Z427VLS*/ 01758000
         BAL   @14,CUASELCT                                        0693 01759000
*    IF DEVPTR ^= ZERO THEN                                        0694 01760000
@RF00692 L     @08,DEVPTR(,R2)                                     0694 01761000
         LTR   @08,@08                                             0694 01762000
         BZ    @RF00694                                            0694 01763000
*     CALL DEVSEL;                                         /*@Z427VLS*/ 01764000
         BAL   @14,DEVSEL                                          0695 01765000
*    IF PASSFLAG = YES THEN                                        0696 01766000
@RF00694 TM    PASSFLAG(R2),B'00000001'                            0696 01767000
         BNO   @RF00696                                            0696 01768000
*    DO;                                                   /*@Z427VLS*/ 01769000
*    SYSGROUP  = FIVE; /*SET GROUP TO TP CNTRL             @Z427VLS*/   01770000
         MVI   SYSGROUP,X'05'                                      0698 01771000
*    SYSRT  = (TPRCUA & ONLYCUA2);                       /*@Z427VLS*/   01772000
         MVC   SYSRT(2),TPRCUA(R7)                                 0699 01773000
         NC    SYSRT(2),@CB00936                                   0699 01774000
*    /*SYSCUA IS 4 BITS TOO FAR TO THE RIGHT FOR NOW         @Z427VLS*/ 01775000
*    SYSDEV  = '3705'X;                                  /*@Z427VLS*/   01776000
         MVC   SYSDEV(2),@CB01393                                  0700 01777000
*    CALL SETCPU;                                          /*@Z427VLS*/ 01778000
         BAL   @14,SETCPU                                          0701 01779000
*    CALL SET3705;                                         /*@Z427VLS*/ 01780000
         BAL   @14,SET3705                                         0702 01781000
*    END;                                                  /*@Z427VLS*/ 01782000
*  END;                                                    /*@Z427VLS*/ 01783000
*END; /*END FOR PROC COUNTMDR                                @Z427VLS*/ 01784000
@EL00013 DS    0H                                                  0705 01785000
@EF00013 DS    0H                                                  0705 01786000
@ER00013 LM    @14,@12,@SA00013                                    0705 01787000
         BR    @14                                                 0705 01788000
*COUNTOBR:PROC; /*IDENTIFY AND SUM PERMANENT AND TEMPORARY ERRORS*/     01789000
COUNTOBR STM   @14,@12,@SA00014                                    0706 01790000
*               /*FROM OBR RECORDS IN SYSUM2                 @Z427VLS*/ 01791000
*BUG(7) = BUG(7) + 1;                                      /*@Z427VLS*/ 01792000
         LA    @08,1                                               0707 01793000
         AL    @08,BUG+24                                          0707 01794000
         ST    @08,BUG+24                                          0707 01795000
*IF SHORTSW = ON THEN /*IF SHORT OBR                         @Z427VLS*/ 01796000
         TM    SHORTSW(R7),B'00100000'                             0708 01797000
         BNO   @RF00708                                            0708 01798000
*  DO;                                                     /*@Z427VLS*/ 01799000
*    CUA3 = (OBRSCUA & ONLYCUA3);                          /*@Z427VLS*/ 01800000
         MVC   CUA3(3),OBRSCUA(R7)                                 0710 01801000
         NC    CUA3(3),@CB00938                                    0710 01802000
*    WORKDEV = OBRSDEV2;                                   /*@Z427VLS*/ 01803000
         MVC   WORKDEV(2),OBRSDEV2(R7)                             0711 01804000
*  END;                                                    /*@Z427VLS*/ 01805000
*ELSE  /*LONG OBR BY DEFAULT                                 @Z427VLS*/ 01806000
*  DO;                                                     /*@Z427VLS*/ 01807000
         B     @RC00708                                            0713 01808000
@RF00708 DS    0H                                                  0714 01809000
*    WORKDEV = OBRDEV;                                     /*@Z427VLS*/ 01810000
         MVC   WORKDEV(2),OBRDEV(R7)                               0714 01811000
*    CUA3 = (OBRPCUA & ONLYCUA3);                          /*@Z427VLS*/ 01812000
         MVC   CUA3(3),OBRPCUA(R7)                                 0715 01813000
         NC    CUA3(3),@CB00938                                    0715 01814000
*  END;                                                    /*@Z427VLS*/ 01815000
*IF CUAPTR ^= ZERO THEN                                            0717 01816000
@RC00708 L     @08,CUAPTR(,R2)                                     0717 01817000
         LTR   @08,@08                                             0717 01818000
         BZ    @RF00717                                            0717 01819000
* CALL CUASELCT;                                           /*@Z427VLS*/ 01820000
         BAL   @14,CUASELCT                                        0718 01821000
*IF DEVPTR ^= ZERO THEN                                            0719 01822000
@RF00717 L     @08,DEVPTR(,R2)                                     0719 01823000
         LTR   @08,@08                                             0719 01824000
         BZ    @RF00719                                            0719 01825000
* CALL DEVSEL;                                             /*@Z427VLS*/ 01826000
         BAL   @14,DEVSEL                                          0720 01827000
*IF PASSFLAG = YES THEN                                            0721 01828000
@RF00719 TM    PASSFLAG(R2),B'00000001'                            0721 01829000
         BNO   @RF00721                                            0721 01830000
*DO;                                                       /*@Z427VLS*/ 01831000
*IF WORKDEV = DEV3410 |                                            0723 01832000
*   WORKDEV = DEV3420 |                                            0723 01833000
*   WORKDEV = DEV34XX THEN                                         0723 01834000
         CLC   WORKDEV(2),@CB00895                                 0723 01835000
         BE    @RT00723                                            0723 01836000
         CLC   WORKDEV(2),@CB00897                                 0723 01837000
         BE    @RT00723                                            0723 01838000
         CLC   WORKDEV(2),@CB00899                                 0723 01839000
         BNE   @RF00723                                            0723 01840000
@RT00723 DS    0H                                                  0724 01841000
*  CALL CHECK34X; /*IF 34XX TAPE THEN USE ANOTHER ALGORITM   @Z427VLS*/ 01842000
         BAL   @14,CHECK34X                                        0724 01843000
*ELSE /*OTHER THAN 34XX RECORD                               @Z427VLS*/ 01844000
*  DO;                                                     /*@Z427VLS*/ 01845000
         B     @RC00723                                            0725 01846000
@RF00723 DS    0H                                                  0726 01847000
*   IF WORKDEV = DEV3330  |                                        0726 01848000
*      WORKDEV = DEV3340  |                                        0726 01849000
*      WORKDEV = DEV3350  |                                        0726 01850000
*      WORKDEV = DEV33301 |                                        0726 01851000
*      WORKDEV = DEV23051 |                                        0726 01852000
*      WORKDEV = DEV23052 THEN /*33XX OR 2305 DEVICE TYPE    @Z427VLS*/ 01853000
         CLC   WORKDEV(2),@CB00887                                 0726 01854000
         BE    @RT00726                                            0726 01855000
         CLC   WORKDEV(2),@CB00889                                 0726 01856000
         BE    @RT00726                                            0726 01857000
         CLC   WORKDEV(2),@CB00891                                 0726 01858000
         BE    @RT00726                                            0726 01859000
         CLC   WORKDEV(2),@CB00893                                 0726 01860000
         BE    @RT00726                                            0726 01861000
         CLC   WORKDEV(2),@CB00883                                 0726 01862000
         BE    @RT00726                                            0726 01863000
         CLC   WORKDEV(2),@CB00885                                 0726 01864000
         BNE   @RF00726                                            0726 01865000
@RT00726 DS    0H                                                  0727 01866000
*     CALL CHECK33X;                                       /*@Z427VLS*/ 01867000
         BAL   @14,CHECK33X                                        0727 01868000
*    ELSE /*IF NOT 33XX OR 34XX DEVICE THEN                  @Z427VLS*/ 01869000
*      DO;                                                 /*@Z427VLS*/ 01870000
         B     @RC00726                                            0728 01871000
@RF00726 DS    0H                                                  0729 01872000
*         IF SHORTSW = YES THEN                                    0729 01873000
         TM    SHORTSW(R7),B'00100000'                             0729 01874000
         BNO   @RF00729                                            0729 01875000
*           DO;                                            /*@Z427VLS*/ 01876000
*             IF OBRSSDRC > ZERO THEN /*IF STAT COUNTERS EXIST*/   0731 01877000
         CLI   OBRSSDRC(R7),0                                      0731 01878000
         BNH   @RF00731                                            0731 01879000
*               DO;                                        /*@Z427VLS*/ 01880000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01881000
         MVI   ERRNUM,X'00'                                        0733 01882000
*                 ERRPLACE = (ERRPLACE | OBRSRDS); /*GET R,R ERRORS*/   01883000
         OC    ERRPLACE(1),OBRSRDS(R7)                             0734 01884000
*                 SRL(ERRPLACE,4); /*SHIFT TO ACCESS AS NUMERIC*/  0735 01885000
         SLR   @08,@08                                             0735 01886000
         IC    @08,ERRPLACE                                        0735 01887000
         SRL   @08,4                                               0735 01888000
         STC   @08,ERRPLACE                                        0735 01889000
*                 SYSTEMP  = SYSTEMP  + ERRNUM;        /*@Z427VLS*/     01890000
         ICM   @08,15,SYSTEMP                                      0736 01891000
         SLR   @06,@06                                             0736 01892000
         IC    @06,ERRNUM                                          0736 01893000
         ALR   @08,@06                                             0736 01894000
         STCM  @08,15,SYSTEMP                                      0736 01895000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01896000
         MVI   ERRNUM,X'00'                                        0737 01897000
*                 ERRPLACE = OBRSRDS; /*GET BOTH READ AND WRITE*/  0738 01898000
         MVC   ERRPLACE(1),OBRSRDS(R7)                             0738 01899000
*                 ERRPLACE = (ERRPLACE & NOREAD); /*REMOVE READS*/ 0739 01900000
         NI    ERRPLACE,X'0F'                                      0739 01901000
*                 SYSTEMP  = SYSTEMP  + ERRNUM;        /*@Z427VLS*/     01902000
         SLR   @06,@06                                             0740 01903000
         IC    @06,ERRNUM                                          0740 01904000
         ALR   @08,@06                                             0740 01905000
         STCM  @08,15,SYSTEMP                                      0740 01906000
*               END;                                       /*@Z427VLS*/ 01907000
*           END;                                           /*@Z427VLS*/ 01908000
*         ELSE /*LONG OBR BY DEFAULT                         @Z427VLS*/ 01909000
*           DO;                                            /*@Z427VLS*/ 01910000
         B     @RC00729                                            0743 01911000
@RF00729 DS    0H                                                  0744 01912000
*             IF DISMOUNT = ON | /*IF A DISMOUNT RECORD WITH STAT DTA*/ 01913000
*                SDRCOUNT = ON | /*SDR COUNTER DUMPED AT EOD @Z427VLS*/ 01914000
*                OBRTEMP = ON THEN /*OBR TEMPORARY ERROR FLAG ON     */ 01915000
         TM    DISMOUNT(R7),B'11000100'                            0744 01916000
         BZ    @RF00744                                            0744 01917000
*              DO;                     /*                    @XA21207*/ 01918000
*              IF OBRLSDRC > ZERO THEN /*IF STAT CNTRS EXIST @XA21207*/ 01919000
         CLI   OBRLSDRC(R7),0                                      0746 01920000
         BNH   @RF00746                                            0746 01921000
*               DO;  /*ACCUMULATE READ WRITE ERRORS          @Z427VLS*/ 01922000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01923000
         MVI   ERRNUM,X'00'                                        0748 01924000
*                 ERRPLACE = (ERRPLACE | OBRLSDR); /*GET LNG R,R ERR*/  01925000
         LA    @08,64                                              0749 01926000
         ALR   @08,R7                                              0749 01927000
         SLR   @06,@06                                             0749 01928000
         IC    @06,OBRDEVDC(,R7)                                   0749 01929000
         SLA   @06,3                                               0749 01930000
         ALR   @08,@06                                             0749 01931000
         OC    ERRPLACE(1),OBRLSDR(@08)                            0749 01932000
*                 SRL(ERRPLACE,4); /*SHIFT TO ACCESS AS NUMERIC*/  0750 01933000
         SLR   @06,@06                                             0750 01934000
         IC    @06,ERRPLACE                                        0750 01935000
         SRL   @06,4                                               0750 01936000
         STC   @06,ERRPLACE                                        0750 01937000
*                 SYSTEMP  = SYSTEMP  + ERRNUM;        /*@Z427VLS*/     01938000
         ICM   @06,15,SYSTEMP                                      0751 01939000
         SLR   @03,@03                                             0751 01940000
         IC    @03,ERRNUM                                          0751 01941000
         ALR   @06,@03                                             0751 01942000
         STCM  @06,15,SYSTEMP                                      0751 01943000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01944000
         MVI   ERRNUM,X'00'                                        0752 01945000
*                 ERRPLACE = OBRLSDR; /*GET READ, WRITE ERRORS*/   0753 01946000
         MVC   ERRPLACE(1),OBRLSDR(@08)                            0753 01947000
*                 ERRPLACE = (ERRPLACE & NOREAD); /*ELIM READ ERRORS*/  01948000
         NI    ERRPLACE,X'0F'                                      0754 01949000
*                 SYSTEMP  = SYSTEMP  + ERRNUM;        /*@Z427VLS*/     01950000
         SLR   @08,@08                                             0755 01951000
         IC    @08,ERRNUM                                          0755 01952000
         ALR   @06,@08                                             0755 01953000
         STCM  @06,15,SYSTEMP                                      0755 01954000
*               END;                                       /*@Z427VLS*/ 01955000
*              END;                    /*                    @XA21207*/ 01956000
*             ELSE /*CONTINUE CHECKING TO FIND PERM ERRORS   @Z427VLS*/ 01957000
*               DO;                                        /*@Z427VLS*/ 01958000
         B     @RC00744                                            0758 01959000
@RF00744 DS    0H                                                  0759 01960000
*                 IF OBRSENS0 ^= '40'X THEN    /* IF NOT INTERV REQ */  01961000
         LA    @08,64                                              0759 01962000
         ALR   @08,R7                                              0759 01963000
         SLR   @06,@06                                             0759 01964000
         IC    @06,OBRDEVDC(,R7)                                   0759 01965000
         SLA   @06,3                                               0759 01966000
         ALR   @08,@06                                             0759 01967000
         SLR   @06,@06                                             0759 01968000
         IC    @06,OBRLSDRC(,R7)                                   0759 01969000
         ALR   @08,@06                                             0759 01970000
         CLI   OBRSENS0(@08),X'40'                                 0759 01971000
         BE    @RF00759                                            0759 01972000
*                   SYSPERM  = ON;                       /*@Z427VLS*/   01973000
         OI    SYSPERM,B'00000001'                                 0760 01974000
*               END;                                       /*@Z427VLS*/ 01975000
@RF00759 DS    0H                                                  0762 01976000
*            END;                                          /*@Z427VLS*/ 01977000
@RC00744 DS    0H                                                  0763 01978000
*         END;                                             /*@Z427VLS*/ 01979000
@RC00729 DS    0H                                                  0764 01980000
*    END;                                                  /*@Z427VLS*/ 01981000
@RC00726 DS    0H                                                  0765 01982000
*    IF SYSPERM  = ON | SYSTEMP  > ZERO THEN                       0765 01983000
@RC00723 TM    SYSPERM,B'00000001'                                 0765 01984000
         BO    @RT00765                                            0765 01985000
         ICM   @08,15,SYSTEMP                                      0765 01986000
         BNP   @RF00765                                            0765 01987000
@RT00765 DS    0H                                                  0766 01988000
*      CALL SETSYS2;                                       /*@Z427VLS*/ 01989000
         BAL   @14,SETSYS2                                         0766 01990000
* END;                                                     /*@Z427VLS*/ 01991000
*  END; /*CLOSING END FOR PROC COUNTOBR                      @Z427VLS*/ 01992000
@EL00014 DS    0H                                                  0768 01993000
@EF00014 DS    0H                                                  0768 01994000
@ER00014 LM    @14,@12,@SA00014                                    0768 01995000
         BR    @14                                                 0768 01996000
*SETSYS2: PROC; /*CREATE SYSUM2 SORT KEY                     @Z427VLS*/ 01997000
SETSYS2  STM   @14,@12,@SA00015                                    0769 01998000
*        BUG(12) = BUG(12) + 1;                            /*@Z427VLS*/ 01999000
         LA    @08,1                                               0770 02000000
         AL    @08,BUG+44                                          0770 02001000
         ST    @08,BUG+44                                          0770 02002000
*        CALL GROUPASN;                                    /*@Z427VLS*/ 02003000
         BAL   @14,GROUPASN                                        0771 02004000
*        SYSRT  = WORKCUA; /*CUA IS 4 BITS RIGHT OF CORRECT POS NOW*/   02005000
         MVC   SYSRT(2),WORKCUA                                    0772 02006000
*        LINKDEV = (LINKDEV && LINKDEV); /*ZERO TO ELIMINATE PREV SET*/ 02007000
         XC    LINKDEV(4),LINKDEV                                  0773 02008000
*        CALL IFCDEVIC(3,WORKDEV,LINKDEV); /*GET DEVICE LABEL*/    0774 02009000
         L     @15,@CV01405                                        0774 02010000
         LA    @01,@AL00774                                        0774 02011000
         BALR  @14,@15                                             0774 02012000
*        /*IFCDEVIC IS AN EXTERNAL PROGRAM, MUST BE LINKEDITED TO FLT2* 02013000
*        SYSDEV = DEVLABEL;  /* PUT DEVICE LABEL IN SORT TABLE   */     02014000
         MVC   SYSDEV(2),DEVLABEL                                  0775 02015000
*        CALL SETCPU;                                      /*@Z427VLS*/ 02016000
         BAL   @14,SETCPU                                          0776 02017000
*        IF SYSGROUP  = TWO |                                      0777 02018000
*           SYSGROUP  = THREE |                                    0777 02019000
*           SYSGROUP  = FOUR THEN                                  0777 02020000
         CLI   SYSGROUP,2                                          0777 02021000
         BE    @RT00777                                            0777 02022000
         CLI   SYSGROUP,3                                          0777 02023000
         BE    @RT00777                                            0777 02024000
         CLI   SYSGROUP,4                                          0777 02025000
         BNE   @RF00777                                            0777 02026000
@RT00777 DS    0H                                                  0778 02027000
*          SYSRT  = (SYSRT  & NOU); /*GOODBY UNIT ADDRESS    @0099VLS*/ 02028000
         NC    SYSRT(2),@CB00934                                   0778 02029000
*      END;                                                /*@Z427VLS*/ 02030000
@EL00015 DS    0H                                                  0779 02031000
@EF00015 DS    0H                                                  0779 02032000
@ER00015 LM    @14,@12,@SA00015                                    0779 02033000
         BR    @14                                                 0779 02034000
*CHECK34X: PROC; /*FIND PERM, TEMP ERRORS IN 34XX DEVICES    @Z427VLS*/ 02035000
CHECK34X STM   @14,@12,12(@13)                                     0780 02036000
*/*TEMPORARY READ, WRITE ERRORS ARE FOUND AT LOCATION 76 INTO OBR*/     02037000
*/*RECORDS FOR 34XX DEVICES. TEMPORARY ERRORS ARE IN RECORDS WHICH*/    02038000
*/*HAVE EITHER THE DISMOUNT OR SDR COUNTER FLAG ON. SHORT OBRS ARE*/    02039000
*/*NEVER GENERATED FOR 34XX DEVICES BUT LONG RECORDS MAY MASQUERADE*/   02040000
*/*AS SHORT RECORDS SOMETIMES. PERMANENT RECORDS ARE DEFINED BY */ 0781 02041000
*/*DEFAULT AS THOSE RECORDS THAT ARENT TEMPORARY, EXCEPT THAT*/    0781 02042000
*/*INVALID RECORDS MAY BE CREATED WITH THE TEMP BIT ON BUT NEITHER*/    02043000
*/*THE DISMOUNT OR SDR COUNTER FLAG ON WHICH MUST BE ELIMINATED*/  0781 02044000
*BUG(27) = BUG(27) + 1;                                    /*@Z427VLS*/ 02045000
         LA    @08,1                                               0781 02046000
         AL    @08,BUG+104                                         0781 02047000
         ST    @08,BUG+104                                         0781 02048000
*IF SHORTSW = NO THEN /*IF NOT A SHORT OBR THEN              @Z427VLS*/ 02049000
         TM    SHORTSW(R7),B'00100000'                             0782 02050000
         BNZ   @RF00782                                            0782 02051000
*  DO;                                                     /*@Z427VLS*/ 02052000
*  IF DISMOUNT = ON | SDRCOUNT = ON THEN /*IF IS EITHER A DISMOUNT*/    02053000
         TM    DISMOUNT(R7),B'10000100'                            0784 02054000
         BZ    @RF00784                                            0784 02055000
*                         /*RECORD OR A SDR COUNTER RECORD THEN*/  0785 02056000
*    SYSTEMP  = SYSTEMP  + OBR34CT1 + OBR34CT2; /*ADD R,W ERRORS*/ 0785 02057000
         ICM   @08,15,SYSTEMP                                      0785 02058000
         SLR   @06,@06                                             0785 02059000
         IC    @06,OBR34CT1(,R7)                                   0785 02060000
         ALR   @08,@06                                             0785 02061000
         SLR   @06,@06                                             0785 02062000
         IC    @06,OBR34CT2(,R7)                                   0785 02063000
         ALR   @08,@06                                             0785 02064000
         STCM  @08,15,SYSTEMP                                      0785 02065000
*  ELSE /*PERMANENT ERROR BY DEFAULT                         @Z427VLS*/ 02066000
*   IF OBRTEMP = OFF THEN /*IF NOT INVALID TEMPORARY ERROR THEN*/  0786 02067000
         B     @RC00784                                            0786 02068000
@RF00784 TM    OBRTEMP(R7),B'01000000'                             0786 02069000
         BNZ   @RF00786                                            0786 02070000
*    SYSPERM  = ON;                                      /*@Z427VLS*/   02071000
         OI    SYSPERM,B'00000001'                                 0787 02072000
*  END;                                                    /*@Z427VLS*/ 02073000
@RF00786 DS    0H                                                  0788 02074000
@RC00784 DS    0H                                                  0789 02075000
*  IF SYSTEMP  = 1 | SYSPERM  = ON THEN                            0789 02076000
@RF00782 CLC   SYSTEMP(4),@CF00055                                 0789 02077000
         BE    @RT00789                                            0789 02078000
         TM    SYSPERM,B'00000001'                                 0789 02079000
         BNO   @RF00789                                            0789 02080000
@RT00789 DS    0H                                                  0790 02081000
*    BUG(28) = BUG(28) + 1;                                /*@Z427VLS*/ 02082000
         LA    @08,1                                               0790 02083000
         AL    @08,BUG+108                                         0790 02084000
         ST    @08,BUG+108                                         0790 02085000
*END; /*END OF 34XX PROC                                     @Z427VLS*/ 02086000
@EL00016 DS    0H                                                  0791 02087000
@EF00016 DS    0H                                                  0791 02088000
@ER00016 LM    @14,@12,12(@13)                                     0791 02089000
         BR    @14                                                 0791 02090000
*CHECK33X: PROC; /*LOCATE 33XX AND 2305 OBR PERM, TEMP ERRORS*/    0792 02091000
CHECK33X STM   @14,@12,12(@13)                                     0792 02092000
*             /*SET SYSGROUP IN TABLE SYSUM2 TO THE ENTRY NUMBER*/ 0793 02093000
*             /*IN TABLE DEVGROUP RELATING TO THIS DEVICE GROUP */ 0793 02094000
*BUG(25) = BUG(25) + 1;                                    /*@Z427VLS*/ 02095000
         LA    @08,1                                               0793 02096000
         AL    @08,BUG+96                                          0793 02097000
         ST    @08,BUG+96                                          0793 02098000
*    IF (OBRSENS1 & PERMBIT) = PERMBIT THEN                        0794 02099000
         LA    @08,64                                              0794 02100000
         ALR   @08,R7                                              0794 02101000
         SLR   @06,@06                                             0794 02102000
         IC    @06,OBRDEVDC(,R7)                                   0794 02103000
         SLA   @06,3                                               0794 02104000
         ALR   @08,@06                                             0794 02105000
         SLR   @06,@06                                             0794 02106000
         IC    @06,OBRLSDRC(,R7)                                   0794 02107000
         ALR   @08,@06                                             0794 02108000
         MVC   @TS00001(1),OBRSENS1(@08)                           0794 02109000
         NI    @TS00001,B'10000000'                                0794 02110000
         CLI   @TS00001,B'10000000'                                0794 02111000
         BNE   @RF00794                                            0794 02112000
*      SYSPERM  = ON;                                    /*@Z427VLS*/   02113000
         OI    SYSPERM,B'00000001'                                 0795 02114000
*    ELSE                                                          0796 02115000
*      DO;                                                 /*@Z427VLS*/ 02116000
         B     @RC00794                                            0796 02117000
@RF00794 DS    0H                                                  0797 02118000
*        IF OBRTEMP = ON THEN                                      0797 02119000
         TM    OBRTEMP(R7),B'01000000'                             0797 02120000
         BNO   @RF00797                                            0797 02121000
*          SYSTEMP  = SYSTEMP  + 1;                    /*@Z427VLS*/     02122000
         LA    @08,1                                               0798 02123000
         ICM   @06,15,SYSTEMP                                      0798 02124000
         ALR   @08,@06                                             0798 02125000
         STCM  @08,15,SYSTEMP                                      0798 02126000
*        ELSE                                                      0799 02127000
*          SYSPERM  = ON;                                /*@Z427VLS*/   02128000
         B     @RC00797                                            0799 02129000
@RF00797 OI    SYSPERM,B'00000001'                                 0799 02130000
*      END;                                                /*@Z427VLS*/ 02131000
@RC00797 DS    0H                                                  0801 02132000
*IF SYSTEMP  = 1  | SYSPERM  = ON THEN                             0801 02133000
@RC00794 CLC   SYSTEMP(4),@CF00055                                 0801 02134000
         BE    @RT00801                                            0801 02135000
         TM    SYSPERM,B'00000001'                                 0801 02136000
         BNO   @RF00801                                            0801 02137000
@RT00801 DS    0H                                                  0802 02138000
*  BUG(26) = BUG(26) + 1;                                  /*@Z427VLS*/ 02139000
         LA    @08,1                                               0802 02140000
         AL    @08,BUG+100                                         0802 02141000
         ST    @08,BUG+100                                         0802 02142000
*END;                                                      /*@Z427VLS*/ 02143000
@EL00017 DS    0H                                                  0803 02144000
@EF00017 DS    0H                                                  0803 02145000
@ER00017 LM    @14,@12,12(@13)                                     0803 02146000
         BR    @14                                                 0803 02147000
*GROUPASN: PROC; /*DETERMINE DEVICE GROUP FOR SYSTEM SUMMARY REPORT*/   02148000
GROUPASN STM   @14,@12,12(@13)                                     0804 02149000
*                /*SET SYSGROUP IN TABLE SYSUM2 TO THE ENTRY NUMBER*/   02150000
*                /*IN TABLE DEVGROUP RELATING TO THIS DEVICE GROUP*/    02151000
*IF (WORKDEV1 = HEX08 & WORKDEV2 ^= HEX42) |                       0805 02152000
*   WORKDEV  = HEX100C |                                           0805 02153000
*   WORKDEV  = HEX1008 THEN                                        0805 02154000
         CLI   WORKDEV1,X'08'                                      0805 02155000
         BNE   @GL00036                                            0805 02156000
         CLI   WORKDEV2,X'42'                                      0805 02157000
         BNE   @RT00805                                            0805 02158000
@GL00036 CLC   WORKDEV(2),@CB00901                                 0805 02159000
         BE    @RT00805                                            0805 02160000
         CLC   WORKDEV(2),@CB00903                                 0805 02161000
         BNE   @RF00805                                            0805 02162000
@RT00805 DS    0H                                                  0806 02163000
*  DO;                                                     /*@Z427VLS*/ 02164000
*   BUG(15) = BUG(15) + 1;                                 /*@Z427VLS*/ 02165000
         LA    @08,1                                               0807 02166000
         AL    @08,BUG+56                                          0807 02167000
         ST    @08,BUG+56                                          0807 02168000
*   SYSGROUP  = ONE;                                     /*@Z427VLS*/   02169000
         MVI   SYSGROUP,X'01'                                      0808 02170000
*  END;                                                    /*@Z427VLS*/ 02171000
*ELSE                                                              0810 02172000
*  DO;                                                     /*@Z427VLS*/ 02173000
         B     @RC00805                                            0810 02174000
@RF00805 DS    0H                                                  0811 02175000
*    IF WORKDEV1 = HEX10 THEN                                      0811 02176000
         CLI   WORKDEV1,X'10'                                      0811 02177000
         BNE   @RF00811                                            0811 02178000
*     DO;                                                  /*@Z427VLS*/ 02179000
*      BUG(18) = BUG(18) + 1;                              /*@Z427VLS*/ 02180000
         LA    @08,1                                               0813 02181000
         AL    @08,BUG+68                                          0813 02182000
         ST    @08,BUG+68                                          0813 02183000
*      SYSGROUP  = FOUR;                                 /*@Z427VLS*/   02184000
         MVI   SYSGROUP,X'04'                                      0814 02185000
*     END;                                                 /*@Z427VLS*/ 02186000
*    ELSE                                                          0816 02187000
*      DO;                                                 /*@Z427VLS*/ 02188000
         B     @RC00811                                            0816 02189000
@RF00811 DS    0H                                                  0817 02190000
*        IF WORKDEV1 = HEX20 |                                     0817 02191000
*           WORKDEV = HEX0842 THEN                                 0817 02192000
         CLI   WORKDEV1,X'20'                                      0817 02193000
         BE    @RT00817                                            0817 02194000
         CLC   WORKDEV(2),@CB00905                                 0817 02195000
         BNE   @RF00817                                            0817 02196000
@RT00817 DS    0H                                                  0818 02197000
*         DO;                                              /*@Z427VLS*/ 02198000
*          BUG(16) = BUG(16) + 1;                          /*@Z427VLS*/ 02199000
         LA    @08,1                                               0819 02200000
         AL    @08,BUG+60                                          0819 02201000
         ST    @08,BUG+60                                          0819 02202000
*          SYSGROUP  = TWO;                              /*@Z427VLS*/   02203000
         MVI   SYSGROUP,X'02'                                      0820 02204000
*         END;                                             /*@Z427VLS*/ 02205000
*        ELSE                                                      0822 02206000
*         DO;                                              /*@Z427VLS*/ 02207000
         B     @RC00817                                            0822 02208000
@RF00817 DS    0H                                                  0823 02209000
*           IF WORKDEV1 = HEX40 THEN                               0823 02210000
         CLI   WORKDEV1,X'40'                                      0823 02211000
         BNE   @RF00823                                            0823 02212000
*             DO;                                          /*@Z427VLS*/ 02213000
*               SYSGROUP  = FIVE;                        /*@Z427VLS*/   02214000
         MVI   SYSGROUP,X'05'                                      0825 02215000
*               BUG(19) = BUG(19) + 1;                     /*@Z427VLS*/ 02216000
         LA    @08,1                                               0826 02217000
         AL    @08,BUG+72                                          0826 02218000
         ST    @08,BUG+72                                          0826 02219000
*             END;                                         /*@Z427VLS*/ 02220000
*           ELSE                                                   0828 02221000
*             DO;                                          /*@Z427VLS*/ 02222000
         B     @RC00823                                            0828 02223000
@RF00823 DS    0H                                                  0829 02224000
*               IF WORKDEV1 = HEX42 |                              0829 02225000
*                  WORKDEV1 = HEX44 THEN                           0829 02226000
         CLI   WORKDEV1,X'42'                                      0829 02227000
         BE    @RT00829                                            0829 02228000
         CLI   WORKDEV1,X'44'                                      0829 02229000
         BNE   @RF00829                                            0829 02230000
@RT00829 DS    0H                                                  0830 02231000
*                DO;                                       /*@Z427VLS*/ 02232000
*                 BUG(20) = BUG(20) + 1;                   /*@Z427VLS*/ 02233000
         LA    @08,1                                               0831 02234000
         AL    @08,BUG+76                                          0831 02235000
         ST    @08,BUG+76                                          0831 02236000
*                 SYSGROUP  = SIX;                       /*@Z427VLS*/   02237000
         MVI   SYSGROUP,X'06'                                      0832 02238000
*                END;                                      /*@Z427VLS*/ 02239000
*               ELSE                                               0834 02240000
*                 DO;                                      /*@Z427VLS*/ 02241000
         B     @RC00829                                            0834 02242000
@RF00829 DS    0H                                                  0835 02243000
*                   IF WORKDEV1 = HEX80 THEN                       0835 02244000
         CLI   WORKDEV1,X'80'                                      0835 02245000
         BNE   @RF00835                                            0835 02246000
*                    DO;                                   /*@Z427VLS*/ 02247000
*                     BUG(17) = BUG(17) + 1;               /*@Z427VLS*/ 02248000
         LA    @08,1                                               0837 02249000
         AL    @08,BUG+64                                          0837 02250000
         ST    @08,BUG+64                                          0837 02251000
*                     SYSGROUP  = THREE;                 /*@Z427VLS*/   02252000
         MVI   SYSGROUP,X'03'                                      0838 02253000
*                    END;                                  /*@Z427VLS*/ 02254000
*                 END;                                     /*@Z427VLS*/ 02255000
*             END;                                         /*@Z427VLS*/ 02256000
*          END;                                            /*@Z427VLS*/ 02257000
*      END;                                                /*@Z427VLS*/ 02258000
*     END;                                                 /*@Z427VLS*/ 02259000
*    END; /*CLOSING END TO GROUPASN PROC                     @Z427VLS*/ 02260000
@EL00018 DS    0H                                                  0845 02261000
@EF00018 DS    0H                                                  0845 02262000
@ER00018 LM    @14,@12,12(@13)                                     0845 02263000
         BR    @14                                                 0845 02264000
*SET3705: PROC;                                            /*@Z427VLS*/ 02265000
SET3705  STM   @14,@12,12(@13)                                     0846 02266000
*  IF TPRMODE = LINKERR |                                          0847 02267000
*     TPRMODE = LINSTAT1 |                                         0847 02268000
*     TPRMODE = LINSTAT0 |                                         0847 02269000
*     TPRMODE = LINSTAT3 THEN                                      0847 02270000
         CLI   TPRMODE(R7),X'02'                                   0847 02271000
         BE    @RT00847                                            0847 02272000
         CLI   TPRMODE(R7),X'01'                                   0847 02273000
         BE    @RT00847                                            0847 02274000
         CLI   TPRMODE(R7),X'00'                                   0847 02275000
         BE    @RT00847                                            0847 02276000
         CLI   TPRMODE(R7),X'03'                                   0847 02277000
         BNE   @RF00847                                            0847 02278000
@RT00847 DS    0H                                                  0848 02279000
*    SYSITEM  = (SYSITEM  |   '20'X);                  /*@Z427VLS*/     02280000
         OI    SYSITEM,X'20'                                       0848 02281000
*  ELSE                                                            0849 02282000
*      IF  TPRMODE = IOERROR |                                     0849 02283000
*          TPRMODE = UNRESOLV THEN                                 0849 02284000
         B     @RC00847                                            0849 02285000
@RF00847 CLI   TPRMODE(R7),X'12'                                   0849 02286000
         BE    @RT00849                                            0849 02287000
         CLI   TPRMODE(R7),X'13'                                   0849 02288000
         BNE   @RF00849                                            0849 02289000
@RT00849 DS    0H                                                  0850 02290000
*          SYSITEM  = (SYSITEM  |   '10'X);            /*@Z427VLS*/     02291000
         OI    SYSITEM,X'10'                                       0850 02292000
*  /*IF TPRMODE IS EQUAL TO DEFAULT OF COMSCAN OR CHANADAP ERRORS*/     02293000
*  /*TREN37 NEED NOT BE SET AS ITS CORRECT VALUE IS ZERO. SYSRT */ 0851 02294000
*  /*IS SET HERE AS THE STUPID COMPILER WILL NOT ACCESS TREN37*/   0851 02295000
*END;    /*CLOSING END TO SET3705 PROC                       @Z427VLS*/ 02296000
@EL00019 DS    0H                                                  0851 02297000
@EF00019 DS    0H                                                  0851 02298000
@ER00019 LM    @14,@12,12(@13)                                     0851 02299000
         BR    @14                                                 0851 02300000
*SETCPU: PROC;                                             /*@Z427VLS*/ 02301000
SETCPU   STM   @14,@12,@SA00020                                    0852 02302000
*/* SET NEW AND OLD CPUS IN SYSUM2. CHECK AND SEE IF THE DEVICE*/  0853 02303000
*/* IS SHARED. IF SO, RESET THE NEW CPU AND ALSO THE CUA. GO TO*/  0853 02304000
*/*SUMONADR TO CREATE NEW ENTRIES OF EVTABLE AND SYSUMONE IF NEED BE*/  02305000
*CALL SUMONADR; /* IF TOO MANY CPUS ENCOUNTERED, NEW ENTRY OF EVTABLE*/ 02306000
         BAL   @14,SUMONADR                                        0853 02307000
*               /* IS NOT CREATED, AND THIS SYSUM2 ENTRY WILL NOT BE*/  02308000
*               /* CREATED                                   @Z427VLS*/ 02309000
*MISSW = OFF; /*PRESET LOOP KICKOUT SWITCH                   @Z427VLS*/ 02310000
         NI    MISSW,B'11101111'                                   0854 02311000
*DO J = 1 BY 1 TO EVNUM WHILE MISSW = OFF;                 /*@Z427VLS*/ 02312000
         LA    @08,1                                               0855 02313000
         ST    @08,J                                               0855 02314000
         B     @DE00855                                            0855 02315000
@DL00855 TM    MISSW,B'00010000'                                   0855 02316000
         BNZ   @DC00855                                            0855 02317000
*  IF EVSERIAL(J) = LRTCPUS | EVSERIAL(J) = 'FFFFFF'X THEN         0856 02318000
         MH    @08,@CH00081                                        0856 02319000
         L     @06,EVPTR(,R2)                                      0856 02320000
         ST    @08,@TF00001                                        0856 02321000
         ALR   @08,@06                                             0856 02322000
         CLC   EVSERIAL-6(3,@08),LRTCPUS(R7)                       0856 02323000
         BE    @RT00856                                            0856 02324000
         AL    @06,@TF00001                                        0856 02325000
         CLC   EVSERIAL-6(3,@06),@CB00237                          0856 02326000
         BNE   @RF00856                                            0856 02327000
@RT00856 DS    0H                                                  0857 02328000
*         /*EVSERIAL ONLY = FOXES IF 11TH OR HIGHER CPU IN INPUT*/ 0857 02329000
*    DO;                                                   /*@Z427VLS*/ 02330000
*      MISSW = ON; /*KICK OUT OF LOOP AFTER PROCESSING       @Z427VLS*/ 02331000
         OI    MISSW,B'00010000'                                   0858 02332000
*      WORKNM = J - 1; /*SET TO EVTABLE ENTRY NUMBER MINUS ONE*/   0859 02333000
         L     @08,J                                               0859 02334000
         BCTR  @08,0                                               0859 02335000
         STC   @08,WORKNM                                          0859 02336000
*      SYSCPUS  = WORKBYTE; /*REFERENCE WORKNM VIA BIT STRING AND*/     02337000
         MVC   SYSCPUS(1),WORKBYTE                                 0860 02338000
*                             /*SET SYSOLD EQUAL TO IT       @Z427VLS*/ 02339000
*      IF SHAREPTR ^= ZERO THEN                                    0861 02340000
         L     @08,SHAREPTR(,R2)                                   0861 02341000
         LTR   @08,@08                                             0861 02342000
         BZ    @RF00861                                            0861 02343000
*        DO;                                               /*@Z427VLS*/ 02344000
*          SHAREYES = NO;                                  /*@Z427VLS*/ 02345000
         NI    SHAREYES,B'01111111'                                0863 02346000
*          DO K = 1 BY 1 TO SHARENUM WHILE SHAREYES = NO;  /*@Z427VLS*/ 02347000
         LA    @08,1                                               0864 02348000
         ST    @08,K                                               0864 02349000
         B     @DE00864                                            0864 02350000
@DL00864 TM    SHAREYES,B'10000000'                                0864 02351000
         BNZ   @DC00864                                            0864 02352000
*            IF LRTCPUS = SHARSERA(K) THEN                         0865 02353000
         MH    @08,@CH00033                                        0865 02354000
         L     @06,SHAREPTR(,R2)                                   0865 02355000
         ST    @08,@TF00001                                        0865 02356000
         ALR   @08,@06                                             0865 02357000
         AL    @08,@CF01502                                        0865 02358000
         CLC   LRTCPUS(3,R7),SHARSERA-4(@08)                       0865 02359000
         BNE   @RF00865                                            0865 02360000
*              DO;                                         /*@Z427VLS*/ 02361000
*                IF SHAREDX(K) = ON THEN                           0867 02362000
         LR    @08,@06                                             0867 02363000
         AL    @08,@TF00001                                        0867 02364000
         AL    @08,@CF01510                                        0867 02365000
         TM    SHAREDX-2(@08),B'10000000'                          0867 02366000
         BNO   @RF00867                                            0867 02367000
*                  DO;                                     /*@Z427VLS*/ 02368000
*                    IF (SHARECUA(K) & CUXOFF) = (WORKCUA & NOUNIT2)    02369000
*                    THEN /*ELIMINATE CUX FLAG AND SEE IF CHANNEL AND*/ 02370000
         LR    @08,@06                                             0869 02371000
         AL    @08,@TF00001                                        0869 02372000
         AL    @08,@CF01510                                        0869 02373000
         MVC   @TS00001(2),SHARECUA-2(@08)                         0869 02374000
         NC    @TS00001(2),@CB00976                                0869 02375000
         MVC   @TS00001+2(2),WORKCUA                               0869 02376000
         NC    @TS00001+2(2),@CB00932                              0869 02377000
         CLC   @TS00001(2),@TS00001+2                              0869 02378000
         BNE   @RF00869                                            0869 02379000
*                         /*CONTROL UNIT ADDRESS HALF BYTES MATCH*/     02380000
*                      DO;                                 /*@Z427VLS*/ 02381000
*                        SYSRT  = (SYSRT  & UNITON); /*GET UNIT*/  0871 02382000
         NC    SYSRT(2),@CB00957                                   0871 02383000
*                                               /*ADDRESS UNCHANGED*/   02384000
*                        SYSRT  = (SYSRT  | SHARECUB(K));  /*@0099VLS*/ 02385000
         AL    @06,@TF00001                                        0872 02386000
         AL    @06,@CF01512                                        0872 02387000
         OC    SYSRT(2),SHARECUB-7(@06)                            0872 02388000
*                        /*CONVER CHANNEL,CONTROL UNIT TO BASE ADDRS*/  02389000
*                        MISSW1 = OFF;                     /*@Z427VLS*/ 02390000
         NI    MISSW1,B'11111101'                                  0873 02391000
*                        DO L = 1 BY 1 TO EVNUM WHILE MISSW1 = OFF;     02392000
         LA    @08,1                                               0874 02393000
         ST    @08,L                                               0874 02394000
         B     @DE00874                                            0874 02395000
@DL00874 TM    MISSW1,B'00000010'                                  0874 02396000
         BNZ   @DC00874                                            0874 02397000
*                          IF EVSERIAL(L) = SHARSERB(K) |          0875 02398000
*                             EVSERIAL(L) = 'FFFFFF'X THEN         0875 02399000
         MH    @08,@CH00081                                        0875 02400000
         L     @06,EVPTR(,R2)                                      0875 02401000
         L     @03,K                                               0875 02402000
         MH    @03,@CH00033                                        0875 02403000
         L     @15,SHAREPTR(,R2)                                   0875 02404000
         ST    @08,@TF00001                                        0875 02405000
         ALR   @08,@06                                             0875 02406000
         ALR   @15,@03                                             0875 02407000
         BCTR  @15,0                                               0875 02408000
         BCTR  @15,0                                               0875 02409000
         CLC   EVSERIAL-6(3,@08),SHARSERB-9(@15)                   0875 02410000
         BE    @RT00875                                            0875 02411000
         AL    @06,@TF00001                                        0875 02412000
         CLC   EVSERIAL-6(3,@06),@CB00237                          0875 02413000
         BNE   @RF00875                                            0875 02414000
@RT00875 DS    0H                                                  0876 02415000
*                            DO;                           /*@Z427VLS*/ 02416000
*                              WORKNM = L - 1; /*SET TO EVTABLE ENT.*/  02417000
         L     @08,L                                               0877 02418000
         BCTR  @08,0                                               0877 02419000
         STC   @08,WORKNM                                          0877 02420000
*                                              /*NUMBER MINUS ONE*/     02421000
*                              MISSW1 = ON;                /*@Z427VLS*/ 02422000
         OI    MISSW1,B'00000010'                                  0878 02423000
*                            END;                          /*@Z427VLS*/ 02424000
*                        END;                              /*@Z427VLS*/ 02425000
@RF00875 LA    @08,1                                               0880 02426000
         AL    @08,L                                               0880 02427000
         ST    @08,L                                               0880 02428000
@DE00874 L     @06,EVPTR(,R2)                                      0880 02429000
         CH    @08,EVNUM(,@06)                                     0880 02430000
         BNH   @DL00874                                            0880 02431000
@DC00874 DS    0H                                                  0881 02432000
*                        SHAREYES = ON;                    /*@Z427VLS*/ 02433000
         OI    SHAREYES,B'10000000'                                0881 02434000
*                      END;                                /*@Z427VLS*/ 02435000
*                  END;                                    /*@Z427VLS*/ 02436000
*                ELSE                                              0884 02437000
*                  DO;                                     /*@Z427VLS*/ 02438000
         B     @RC00867                                            0884 02439000
@RF00867 DS    0H                                                  0885 02440000
*                    IF SHARECUA(K) = WORKCUA THEN                 0885 02441000
         L     @08,K                                               0885 02442000
         MH    @08,@CH00033                                        0885 02443000
         L     @06,SHAREPTR(,R2)                                   0885 02444000
         ST    @08,@TF00001                                        0885 02445000
         ALR   @08,@06                                             0885 02446000
         AL    @08,@CF01510                                        0885 02447000
         CLC   SHARECUA-2(2,@08),WORKCUA                           0885 02448000
         BNE   @RF00885                                            0885 02449000
*                      DO;                                 /*@Z427VLS*/ 02450000
*                        SYSRT  = SHARECUB(K); /*GET BASE CPU*/    0887 02451000
         AL    @06,@TF00001                                        0887 02452000
         AL    @06,@CF01512                                        0887 02453000
         MVC   SYSRT(2),SHARECUB-7(@06)                            0887 02454000
*                        MISSW1 = OFF;                     /*@Z427VLS*/ 02455000
         NI    MISSW1,B'11111101'                                  0888 02456000
*                        DO L = 1 BY 1 TO EVNUM WHILE MISSW1 = OFF;     02457000
         LA    @08,1                                               0889 02458000
         ST    @08,L                                               0889 02459000
         B     @DE00889                                            0889 02460000
@DL00889 TM    MISSW1,B'00000010'                                  0889 02461000
         BNZ   @DC00889                                            0889 02462000
*                          IF EVSERIAL(L) = SHARSERB(K) |          0890 02463000
*                             EVSERIAL(L) = 'FFFFFF'X THEN         0890 02464000
         MH    @08,@CH00081                                        0890 02465000
         L     @06,EVPTR(,R2)                                      0890 02466000
         L     @03,K                                               0890 02467000
         MH    @03,@CH00033                                        0890 02468000
         L     @15,SHAREPTR(,R2)                                   0890 02469000
         ST    @08,@TF00001                                        0890 02470000
         ALR   @08,@06                                             0890 02471000
         ALR   @15,@03                                             0890 02472000
         BCTR  @15,0                                               0890 02473000
         BCTR  @15,0                                               0890 02474000
         CLC   EVSERIAL-6(3,@08),SHARSERB-9(@15)                   0890 02475000
         BE    @RT00890                                            0890 02476000
         AL    @06,@TF00001                                        0890 02477000
         CLC   EVSERIAL-6(3,@06),@CB00237                          0890 02478000
         BNE   @RF00890                                            0890 02479000
@RT00890 DS    0H                                                  0891 02480000
*                            DO;                           /*@Z427VLS*/ 02481000
*                              WORKNM = L - 1; /*SET TO EVTABLE ENT.*/  02482000
         L     @08,L                                               0892 02483000
         BCTR  @08,0                                               0892 02484000
         STC   @08,WORKNM                                          0892 02485000
*                                             /*NUMBER MINUS ONE*/ 0893 02486000
*                              MISSW1 = ON;                /*@Z427VLS*/ 02487000
         OI    MISSW1,B'00000010'                                  0893 02488000
*                            END;                          /*@Z427VLS*/ 02489000
*                        END;                              /*@Z427VLS*/ 02490000
@RF00890 LA    @08,1                                               0895 02491000
         AL    @08,L                                               0895 02492000
         ST    @08,L                                               0895 02493000
@DE00889 L     @06,EVPTR(,R2)                                      0895 02494000
         CH    @08,EVNUM(,@06)                                     0895 02495000
         BNH   @DL00889                                            0895 02496000
@DC00889 DS    0H                                                  0896 02497000
*                        SHAREYES = ON;                    /*@Z427VLS*/ 02498000
         OI    SHAREYES,B'10000000'                                0896 02499000
*                    END;                                  /*@Z427VLS*/ 02500000
*                 END;                                     /*@Z427VLS*/ 02501000
@RF00885 DS    0H                                                  0899 02502000
*              END;                                        /*@Z427VLS*/ 02503000
@RC00867 DS    0H                                                  0900 02504000
*           END;                                           /*@Z427VLS*/ 02505000
@RF00865 LA    @08,1                                               0900 02506000
         AL    @08,K                                               0900 02507000
         ST    @08,K                                               0900 02508000
@DE00864 L     @06,SHAREPTR(,R2)                                   0900 02509000
         CH    @08,SHARENUM(,@06)                                  0900 02510000
         BNH   @DL00864                                            0900 02511000
@DC00864 DS    0H                                                  0901 02512000
*        END;                                              /*@Z427VLS*/ 02513000
*        SLL(SYSRT ,4); /*SHIFT TO SYSCUA FROM SYSRT       @Z427VLS*/   02514000
@RF00861 SLR   @08,@08                                             0902 02515000
         ICM   @08,3,SYSRT                                         0902 02516000
         SLL   @08,4                                               0902 02517000
         STCM  @08,3,SYSRT                                         0902 02518000
*        SLL(WORKNM,4); /*SHIFT BASE CPU INDEX TO BYTE BOUNDARY*/  0903 02519000
         SLR   @08,@08                                             0903 02520000
         IC    @08,WORKNM                                          0903 02521000
         SLL   @08,4                                               0903 02522000
         STC   @08,WORKNM                                          0903 02523000
*        SYSCPUS  = (SYSCPUS  | WORKBYTE); /*SET SYSCPU  @Z427VLS*/     02524000
         OC    SYSCPUS(1),WORKBYTE                                 0904 02525000
*     END;                                                 /*@Z427VLS*/ 02526000
*   END;                                                   /*@Z427VLS*/ 02527000
@RF00856 LA    @08,1                                               0906 02528000
         AL    @08,J                                               0906 02529000
         ST    @08,J                                               0906 02530000
@DE00855 L     @06,EVPTR(,R2)                                      0906 02531000
         CH    @08,EVNUM(,@06)                                     0906 02532000
         BNH   @DL00855                                            0906 02533000
@DC00855 DS    0H                                                  0907 02534000
*END;/*CLOSING END TO SETCPU                                 @Z427VLS*/ 02535000
@EL00020 DS    0H                                                  0907 02536000
@EF00020 DS    0H                                                  0907 02537000
@ER00020 LM    @14,@12,@SA00020                                    0907 02538000
         BR    @14                                                 0907 02539000
*ENDOFILE: PROC; /*SORT SORTABLE AND PASS RETURN CODE TO EREP1*/   0908 02540000
ENDOFILE STM   @14,@12,@SA00021                                    0908 02541000
*RESPECIFY(R15) RESTRICTED;                                /*@Z427VLS*/ 02542000
*IF ERROR = OVERFLOW & PHIST = ON THEN                             0910 02543000
         CLC   ERROR(4),@CF00066                                   0910 02544000
         BNE   @RF00910                                            0910 02545000
         TM    PHIST(R2),B'00100000'                               0910 02546000
         BNO   @RF00910                                            0910 02547000
*  DO;                                                     /*@0001VLS*/ 02548000
*    CLOSEIO = (CLOSEIO && CLOSEIO);                       /*@0001VLS*/ 02549000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0912 02550000
*    CACCIN = ON;                                          /*@0001VLS*/ 02551000
         OI    CACCIN(R2),B'00010000'                              0913 02552000
*    CALL IOHND(IOCLOSE);                                  /*@0001VLS*/ 02553000
         L     @15,ADIOHND(,R2)                                    0914 02554000
         LA    @01,@AL00914                                        0914 02555000
         BALR  @14,@15                                             0914 02556000
*  END;                                                    /*@0001VLS*/ 02557000
*IF MAXENT <= I & ERROR ^= ENDFILE & GETFAIL = OFF THEN            0916 02558000
@RF00910 L     @14,MAXENT                                          0916 02559000
         C     @14,I                                               0916 02560000
         BH    @RF00916                                            0916 02561000
         CLC   ERROR(4),@CF00064                                   0916 02562000
         BE    @RF00916                                            0916 02563000
         TM    GETFAIL,B'00001000'                                 0916 02564000
         BNZ   @RF00916                                            0916 02565000
*  DO;            /*WORLD, DONT TELL EREP1, DONT LET LOGREC BE*/   0917 02566000
*    ZEROALL = NO;       /*RESET.                            @Z427VLS*/ 02567000
         NI    ZEROALL(R2),B'10111111'                             0918 02568000
*    MSGNO = 3;                                            /*@Z427VLS*/ 02569000
         MVI   MSGNO,X'03'                                         0919 02570000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02571000
         BAL   @14,ERRMSG                                          0920 02572000
*    ERROR = ZERO;                                         /*@0001VLS*/ 02573000
         SLR   @14,@14                                             0921 02574000
         ST    @14,ERROR                                           0921 02575000
*    IF PHIST = ON THEN                                            0922 02576000
         TM    PHIST(R2),B'00100000'                               0922 02577000
         BNO   @RF00922                                            0922 02578000
*      DO;                                                 /*@Z427VLS*/ 02579000
*        CLOSEIO = (CLOSEIO && CLOSEIO);                   /*@Z427VLS*/ 02580000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0924 02581000
*        CACCIN = ON;                                      /*@Z427VLS*/ 02582000
         OI    CACCIN(R2),B'00010000'                              0925 02583000
*        CALL IOHND(IOCLOSE);                              /*@Z427VLS*/ 02584000
         L     @15,ADIOHND(,R2)                                    0926 02585000
         LA    @01,@AL00926                                        0926 02586000
         BALR  @14,@15                                             0926 02587000
*     END;                                                 /*@G51DGBB*/ 02588000
* END;                                                     /*@G51DGBB*/ 02589000
@RF00922 DS    0H                                                  0929 02590000
* IF ERROR = FOUR THEN                                             0929 02591000
@RF00916 CLC   ERROR(4),@CF00064                                   0929 02592000
         BNE   @RF00929                                            0929 02593000
*   DO;                                                    /*@G51DGBB*/ 02594000
*     R15 = ZERO;                                          /*@G51DGBB*/ 02595000
         SLR   R15,R15                                             0931 02596000
*     ERROR = ZERO;                                        /*@G51DGBB*/ 02597000
         SLR   @14,@14                                             0932 02598000
         ST    @14,ERROR                                           0932 02599000
*   END;                                                   /*@G51DGBB*/ 02600000
*/*THE FOLLOWING CODE MUST BE ADDED TO THE END OF FILE PROC BEFORE*/    02601000
*/*CLOSING ACCDEV TO WRITE FRAMES TO ACCDEV, IF NECESSARY    @G51DGBB*/ 02602000
*IF R15 < TWELVE &             /*IF NON TERMINATE RETURN CODE */   0934 02603000
*   FRAMEPTR ^= ZERO THEN      /*IF FRAME TABLE WAS ALLOCATED */   0934 02604000
@RF00929 C     R15,@CF00032                                        0934 02605000
         BNL   @RF00934                                            0934 02606000
         SLR   @14,@14                                             0934 02607000
         L     @08,FRAMEPTR(,R2)                                   0934 02608000
         CR    @08,@14                                             0934 02609000
         BE    @RF00934                                            0934 02610000
* DO;                                                      /*@G51DGBB*/ 02611000
*    IF  FRAMENUM > ZERO THEN /* IF ENTRIES IN FRAMTAB HAVE BEEN BUILT* 02612000
         C     @14,FRAMENUM(,@08)                                  0936 02613000
         BNL   @RF00936                                            0936 02614000
*      DO;                                                 /*@G51DGBB*/ 02615000
*         IF PHIST = ON THEN /*IF DIRECTWK WAS USED TO STORE FRAMES */  02616000
         TM    PHIST(R2),B'00100000'                               0938 02617000
         BNO   @RF00938                                            0938 02618000
*           DO;                                            /*@G51DGBB*/ 02619000
*             CLOSEIO = (CLOSEIO && CLOSEIO); /*ZERO CLOSE FLAGS*/ 0940 02620000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0940 02621000
*             CDRCTWRK = ON;      /*INDICATE CLOSE OF DIRECTWK FOR  */  02622000
         OI    CDRCTWRK(R2),B'00000010'                            0941 02623000
*             CALL IOHND(IOCLOSE); /*WRITING, IMPLICITLY OPENED FOR RD* 02624000
         L     @15,ADIOHND(,R2)                                    0942 02625000
         LA    @01,@AL00942                                        0942 02626000
         BALR  @14,@15                                             0942 02627000
*           END;                                           /*@G51DGBB*/ 02628000
*         DO A = 1 BY 1 TO FRAMENUM WHILE R15 < FOUR;       /*SETS. */  02629000
@RF00938 LA    @14,1                                               0944 02630000
         ST    @14,A                                               0944 02631000
         B     @DE00944                                            0944 02632000
@DL00944 C     R15,@CF00064                                        0944 02633000
         BNL   @DC00944                                            0944 02634000
*           IF FRAMETYP(A) = ALLALL THEN /*IF COMPLETE SET   @G51DGBB*/ 02635000
         MH    @14,@CH00227                                        0945 02636000
         L     @08,FRAMEPTR(,R2)                                   0945 02637000
         ST    @14,@TF00001                                        0945 02638000
         ALR   @14,@08                                             0945 02639000
         AL    @14,@CF01502                                        0945 02640000
         CLI   FRAMETYP-17(@14),X'FF'                              0945 02641000
         BNE   @RF00945                                            0945 02642000
*             DO;                                          /*@G51DGBB*/ 02643000
*               LISTPTR = FRAMLOCM(A);   /*ESTABLISH LISTLOC ADDR.*/    02644000
         L     @14,@TF00001                                        0947 02645000
         AL    @08,@CF01512                                        0947 02646000
         L     @14,FRAMLOCM-20(@14,@08)                            0947 02647000
         ST    @14,LISTPTR                                         0947 02648000
*               DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR ;/*@G51DGBB*/ 02649000
         LA    @14,1                                               0948 02650000
         ST    @14,Z                                               0948 02651000
         B     @DE00948                                            0948 02652000
@DL00948 C     R15,@CF00064                                        0948 02653000
         BNL   @DC00948                                            0948 02654000
*                 RECCCHHR = LISTCCHR(Z);  /*GET ALL MCH FRAMES*/  0949 02655000
         MH    @14,@CH00079                                        0949 02656000
         L     @08,LISTPTR                                         0949 02657000
         ALR   @08,@14                                             0949 02658000
         BCTR  @08,0                                               0949 02659000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      0949 02660000
*                 CALL IOHND(READIRCT);    /*READ FRAME FROM DIRECTWK*/ 02661000
         L     @15,ADIOHND(,R2)                                    0950 02662000
         LA    @01,@AL00950                                        0950 02663000
         BALR  @14,@15                                             0950 02664000
*                 IF R15 = ZERO THEN       /*WRITE FRAME TO ACCDEV*/    02665000
         LTR   R15,R15                                             0951 02666000
         BNZ   @RF00951                                            0951 02667000
*                   CALL IOHND(RITEHIST);                  /*@G51DGBB*/ 02668000
         L     @15,ADIOHND(,R2)                                    0952 02669000
         LA    @01,@AL00952                                        0952 02670000
         BALR  @14,@15                                             0952 02671000
*              END;                                        /*@G51DGBB*/ 02672000
@RF00951 LA    @14,1                                               0953 02673000
         AL    @14,Z                                               0953 02674000
         ST    @14,Z                                               0953 02675000
@DE00948 L     @08,LISTPTR                                         0953 02676000
         C     @14,LISTNUM(,@08)                                   0953 02677000
         BNH   @DL00948                                            0953 02678000
@DC00948 DS    0H                                                  0954 02679000
*              IF R15 = ZERO THEN /*IF NO ACCDEV WRITE ERROR @G51DGBB*/ 02680000
         LTR   R15,R15                                             0954 02681000
         BNZ   @RF00954                                            0954 02682000
*                DO;                                       /*@G51DGBB*/ 02683000
*                  LISTPTR = FRAMLOCC(A); /*GET CCH FRAMES   @G51DGBB*/ 02684000
         L     @14,A                                               0956 02685000
         MH    @14,@CH00227                                        0956 02686000
         L     @08,FRAMEPTR(,R2)                                   0956 02687000
         L     @14,FRAMLOCC-24(@14,@08)                            0956 02688000
         ST    @14,LISTPTR                                         0956 02689000
*                  DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR;      0957 02690000
         LA    @14,1                                               0957 02691000
         ST    @14,Z                                               0957 02692000
         B     @DE00957                                            0957 02693000
@DL00957 C     R15,@CF00064                                        0957 02694000
         BNL   @DC00957                                            0957 02695000
*                    RECCCHHR = LISTCCHR(Z);               /*@G51DGBB*/ 02696000
         MH    @14,@CH00079                                        0958 02697000
         L     @08,LISTPTR                                         0958 02698000
         ALR   @08,@14                                             0958 02699000
         BCTR  @08,0                                               0958 02700000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      0958 02701000
*                      CALL IOHND(READIRCT); /*READ FRAME OFF DRCTWK*/  02702000
         L     @15,ADIOHND(,R2)                                    0959 02703000
         LA    @01,@AL00959                                        0959 02704000
         BALR  @14,@15                                             0959 02705000
*                      IF R15 = ZERO THEN    /*IF SUCCESS THEN WRITE*/  02706000
         LTR   R15,R15                                             0960 02707000
         BNZ   @RF00960                                            0960 02708000
*                        CALL IOHND(RITEHIST); /*TO ACCDEV   @G51DGBB*/ 02709000
         L     @15,ADIOHND(,R2)                                    0961 02710000
         LA    @01,@AL00961                                        0961 02711000
         BALR  @14,@15                                             0961 02712000
*                    END;                                  /*@G51DGBB*/ 02713000
@RF00960 LA    @14,1                                               0962 02714000
         AL    @14,Z                                               0962 02715000
         ST    @14,Z                                               0962 02716000
@DE00957 L     @08,LISTPTR                                         0962 02717000
         C     @14,LISTNUM(,@08)                                   0962 02718000
         BNH   @DL00957                                            0962 02719000
@DC00957 DS    0H                                                  0963 02720000
*                 END;                                     /*@G51DGBB*/ 02721000
*             END;                                         /*@G51DGBB*/ 02722000
*           ELSE  /*INCOMPLETE FRAME SET                     @G51DGBB*/ 02723000
*             DO;                                          /*@G51DGBB*/ 02724000
         B     @RC00945                                            0965 02725000
@RF00945 DS    0H                                                  0966 02726000
*               MSGNO = 78; /*MISSING FRAME SET MESSAGE      @G51DGBB*/ 02727000
         MVI   MSGNO,X'4E'                                         0966 02728000
*               CCHINDX = A;   /*CORRECT DEBUG FRAME COUNTS BY */  0967 02729000
         L     @14,A                                               0967 02730000
         ST    @14,CCHINDX                                         0967 02731000
*               CALL ERRMSG;                               /*@G51DGBB*/ 02732000
         BAL   @14,ERRMSG                                          0968 02733000
*               CALL FIXENTRY; /*PASSING ENTRY INDEX TO FIXENTRY*/ 0969 02734000
         BAL   @14,FIXENTRY                                        0969 02735000
*             END;                                         /*@G51DGBB*/ 02736000
*         END;                                             /*@G51DGBB*/ 02737000
@RC00945 LA    @14,1                                               0971 02738000
         AL    @14,A                                               0971 02739000
         ST    @14,A                                               0971 02740000
@DE00944 L     @08,FRAMEPTR(,R2)                                   0971 02741000
         C     @14,FRAMENUM(,@08)                                  0971 02742000
         BNH   @DL00944                                            0971 02743000
@DC00944 DS    0H                                                  0972 02744000
*      END;                                                /*@G51DGBB*/ 02745000
*     GEN(FREEMAIN R,SP=21);                               /*@G51DGBB*/ 02746000
@RF00936 DS    0H                                                  0973 02747000
         FREEMAIN R,SP=21                                               02748000
* END;                                                     /*@G51DGBB*/ 02749000
*IF ERROR = OVERFLOW | ERROR = ENDFILE THEN                        0975 02750000
@RF00934 L     @14,ERROR                                           0975 02751000
         C     @14,@CF00066                                        0975 02752000
         BE    @RT00975                                            0975 02753000
         C     @14,@CF00064                                        0975 02754000
         BNE   @RF00975                                            0975 02755000
@RT00975 DS    0H                                                  0976 02756000
*  ERROR = ZERO;                                           /*@0001VLS*/ 02757000
         SLR   @14,@14                                             0976 02758000
         ST    @14,ERROR                                           0976 02759000
*BUG(40) = BUG(2) + BUG(3) + BUG(4) + BUG(5) + BUG(6); /*ADD SAVED*/    02760000
@RF00975 L     @14,BUG+4                                           0977 02761000
         AL    @14,BUG+8                                           0977 02762000
         AL    @14,BUG+12                                          0977 02763000
         AL    @14,BUG+16                                          0977 02764000
         AL    @14,BUG+20                                          0977 02765000
         ST    @14,BUG+156                                         0977 02766000
*/*SOFT, MCH, CCH, IPL, AND EOD RECORDS USED IN SYSUM PART ONE*/   0978 02767000
*NUMREC = BUG(40);                                         /*@G51DGBB*/ 02768000
         ST    @14,NUMREC                                          0978 02769000
*CVD(NUMREC,PACKPAS); /*PRINT NUMBER OF RECORDS PASSED FILTERING*/ 0979 02770000
         CVD   @14,@TS00001                                        0979 02771000
         MVC   PACKPAS(4),@TS00001+4                               0979 02772000
*PACKPAS = (PACKPAS | '0000000F'X); /*CHANGE SIGN FROM C TO F*/    0980 02773000
         OC    PACKPAS(4),@CB01430                                 0980 02774000
*UNPK(EDFLD,PACKPAS);                                      /*@Z427VLS*/ 02775000
         UNPK  EDFLD(9),PACKPAS(4)                                 0981 02776000
*NONBLANK = OFF; /*INITIALIZE TO NO LEADING ZEROS            @G51DGBB*/ 02777000
         NI    NONBLANK,B'01111111'                                0982 02778000
*DO J = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                  /*@Z427VLS*/ 02779000
         LA    @14,1                                               0983 02780000
         ST    @14,J                                               0983 02781000
@DL00983 TM    NONBLANK,B'10000000'                                0983 02782000
         BNZ   @DC00983                                            0983 02783000
*  IF EDIFILD(J) = CHARZERO THEN                                   0984 02784000
         LA    @08,EDIFILD-1(@14)                                  0984 02785000
         CLI   0(@08),X'F0'                                        0984 02786000
         BNE   @RF00984                                            0984 02787000
*    EDIFILD(J) = BLANK;                                   /*@Z427VLS*/ 02788000
         LA    @08,EDIFILD-1(@14)                                  0985 02789000
         MVI   0(@08),X'40'                                        0985 02790000
*  ELSE                                                            0986 02791000
*    NONBLANK = ON;                                        /*@Z427VLS*/ 02792000
         B     @RC00984                                            0986 02793000
@RF00984 OI    NONBLANK,B'10000000'                                0986 02794000
*END;                                                      /*@Z427VLS*/ 02795000
@RC00984 LA    @14,1                                               0987 02796000
         AL    @14,J                                               0987 02797000
         ST    @14,J                                               0987 02798000
         C     @14,@CF00066                                        0987 02799000
         BNH   @DL00983                                            0987 02800000
@DC00983 DS    0H                                                  0988 02801000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 02802000
         LA    @14,PRINTLIN                                        0988 02803000
         ST    @14,PRINTADR(,R2)                                   0988 02804000
*CALL IFCMSG(75,ADDR(PRINTBDY));                           /*@Z427VLS*/ 02805000
         LA    @14,PRINTBDY                                        0989 02806000
         ST    @14,@AFTEMPS                                        0989 02807000
         L     @15,ADIFCMSG(,R2)                                   0989 02808000
         LA    @01,@AL00989                                        0989 02809000
         BALR  @14,@15                                             0989 02810000
*PRINTED=EDFLD;                                            /*@Z427VLS*/ 02811000
         MVC   PRINTED(9),EDFLD                                    0990 02812000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 02813000
         L     @15,ADIOHND(,R2)                                    0991 02814000
         LA    @01,@AL00991                                        0991 02815000
         BALR  @14,@15                                             0991 02816000
*CVD(ZZ3,PACKPAS);                                         /*@0099VLS*/ 02817000
         L     @14,ZZ3                                             0992 02818000
         CVD   @14,@TS00001                                        0992 02819000
         MVC   PACKPAS(4),@TS00001+4                               0992 02820000
*PACKPAS = (PACKPAS | '0000000F'X); /*CHANGE SIGN TO F       @Z427VLS*/ 02821000
         OC    PACKPAS(4),@CB01430                                 0993 02822000
*UNPK(EDFLD,PACKPAS); /*CONVERT PACK TO PRINTABLE            @Z427VLS*/ 02823000
         UNPK  EDFLD(9),PACKPAS(4)                                 0994 02824000
*NONBLANK = OFF; /*REINITIALIZE SWITCH                       @Z427VLS*/ 02825000
         NI    NONBLANK,B'01111111'                                0995 02826000
*DO J = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                  /*@Z427VLS*/ 02827000
         LA    @14,1                                               0996 02828000
         ST    @14,J                                               0996 02829000
@DL00996 TM    NONBLANK,B'10000000'                                0996 02830000
         BNZ   @DC00996                                            0996 02831000
*  IF EDIFILD(J) = CHARZERO THEN                                   0997 02832000
         LA    @08,EDIFILD-1(@14)                                  0997 02833000
         CLI   0(@08),X'F0'                                        0997 02834000
         BNE   @RF00997                                            0997 02835000
*    EDIFILD(J) = BLANK;                                   /*@Z427VLS*/ 02836000
         LA    @08,EDIFILD-1(@14)                                  0998 02837000
         MVI   0(@08),X'40'                                        0998 02838000
*  ELSE                                                            0999 02839000
*    NONBLANK = ON;                                        /*@Z427VLS*/ 02840000
         B     @RC00997                                            0999 02841000
@RF00997 OI    NONBLANK,B'10000000'                                0999 02842000
*END;                                                      /*@Z427VLS*/ 02843000
@RC00997 LA    @14,1                                               1000 02844000
         AL    @14,J                                               1000 02845000
         ST    @14,J                                               1000 02846000
         C     @14,@CF00066                                        1000 02847000
         BNH   @DL00996                                            1000 02848000
@DC00996 DS    0H                                                  1001 02849000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 02850000
         LA    @14,PRINTLIN                                        1001 02851000
         ST    @14,PRINTADR(,R2)                                   1001 02852000
*CALL IFCMSG(76,ADDR(PRINTBDY));                           /*@Z427VLS*/ 02853000
         LA    @14,PRINTBDY                                        1002 02854000
         ST    @14,@AFTEMPS                                        1002 02855000
         L     @15,ADIFCMSG(,R2)                                   1002 02856000
         LA    @01,@AL01002                                        1002 02857000
         BALR  @14,@15                                             1002 02858000
*PRINTED=EDFLD;                                            /*@Z427VLS*/ 02859000
         MVC   PRINTED(9),EDFLD                                    1003 02860000
*CALL IOHND(RITEPRTR);                                     /*@0001VLS*/ 02861000
         L     @15,ADIOHND(,R2)                                    1004 02862000
         LA    @01,@AL01004                                        1004 02863000
         BALR  @14,@15                                             1004 02864000
*IF ERROR ^= NOSRTABL THEN                                         1005 02865000
         CLC   ERROR(4),@CF00032                                   1005 02866000
         BE    @RF01005                                            1005 02867000
* DO;                                                      /*@Z427VLS*/ 02868000
*   SORTNUM = PASSNUM; /*TELL EREP1 HOW MANY RECORDS IN SORTABLE*/ 1007 02869000
         L     @14,PASSNUM                                         1007 02870000
         ST    @14,SORTNUM(,R2)                                    1007 02871000
*   EXCESS = TABSIZE - (SORTNUM * SORTELNT); /*UNUSED SYSUM2 TABLE*/    02872000
         L     @08,TABSIZE(,R2)                                    1008 02873000
         MH    @14,@CH00966                                        1008 02874000
         LCR   @14,@14                                             1008 02875000
         ALR   @14,@08                                             1008 02876000
         ST    @14,EXCESS                                          1008 02877000
*   IF EXCESS > 16 THEN /*IF AT LEAST A DOUBLEWORD TO FREE AFTER*/ 1009 02878000
         C     @14,@CF00088                                        1009 02879000
         BNH   @RF01009                                            1009 02880000
*     DO;               /*ROUNDING THE BYTE COUNT            @Z427VLS*/ 02881000
*       EXCESS = (EXCESS & DBWRD); /*ROUND DOWN TO DOUBLEWORD AMMOUNT*/ 02882000
         N     @14,@CF00878                                        1011 02883000
         ST    @14,EXCESS                                          1011 02884000
*       RESPECIFY (R0,R1) RESTRICTED;                      /*@Z427VLS*/ 02885000
*       R0 = EXCESS;                                       /*@Z427VLS*/ 02886000
         LR    R0,@14                                              1013 02887000
*       R1 = SORTADR + TABSIZE - EXCESS; /*POINT TO BEGINNING OF UNUSE* 02888000
         AL    @08,SORTADR(,R2)                                    1014 02889000
         SLR   @08,@14                                             1014 02890000
         LR    R1,@08                                              1014 02891000
*       GEN(FREEMAIN  R,LV=(0),A=(1));                     /*@Z427VLS*/ 02892000
         FREEMAIN  R,LV=(0),A=(1)                                       02893000
*       RESPECIFY (R0,R1) UNRESTRICTED;                    /*@Z427VLS*/ 02894000
*     END;                                                 /*@Z427VLS*/ 02895000
*     RESPECIFY(R1) UNRESTRICTED;                          /*@Z427VLS*/ 02896000
@RF01009 DS    0H                                                  1019 02897000
*  END;                                                    /*@Z427VLS*/ 02898000
*IF SORTNUM = ZERO & NUMREC = ZERO THEN                            1020 02899000
@RF01005 SLR   @14,@14                                             1020 02900000
         C     @14,SORTNUM(,R2)                                    1020 02901000
         BNE   @RF01020                                            1020 02902000
         C     @14,NUMREC                                          1020 02903000
         BNE   @RF01020                                            1020 02904000
*  ERROR = TERMINAT;                                       /*@0001VLS*/ 02905000
         MVC   ERROR(4),@CF00032                                   1021 02906000
*IF ERROR = SUCCESS THEN                                           1022 02907000
@RF01020 SLR   @14,@14                                             1022 02908000
         C     @14,ERROR                                           1022 02909000
         BNE   @RF01022                                            1022 02910000
* DO;                                                      /*@Z427VLS*/ 02911000
*  IF NUMREC > ZERO | SORTNUM > ZERO THEN /*IF SOME PART1 RECORDS*/     02912000
         C     @14,NUMREC                                          1024 02913000
         BL    @RT01024                                            1024 02914000
         C     @14,SORTNUM(,R2)                                    1024 02915000
         BNL   @RF01024                                            1024 02916000
@RT01024 DS    0H                                                  1025 02917000
*    CALL SORTONE; /*SORT EVTABLE,SYSUMONE,SET EVLETTER IF UNSET*/ 1025 02918000
         BAL   @14,SORTONE                                         1025 02919000
*  IF SORTNUM > ZERO THEN /*IF SOME OBR,MDR RECS SAVED IN SYSUM2*/ 1026 02920000
@RF01024 L     @14,SORTNUM(,R2)                                    1026 02921000
         LTR   @14,@14                                             1026 02922000
         BNP   @RF01026                                            1026 02923000
*    CALL SORTWO; /*SORT SYSUM2                              @Z427VLS*/ 02924000
         BAL   @14,SORTWO                                          1027 02925000
* END;                                                     /*@Z427VLS*/ 02926000
*RESPECIFY (R15) UNRESTRICTED;                             /*@Z427VLS*/ 02927000
*END; /*CLOSING END TO PROC ENDOFILE                         @Z427VLS*/ 02928000
@EL00021 DS    0H                                                  1030 02929000
@EF00021 DS    0H                                                  1030 02930000
@ER00021 LM    @14,@12,@SA00021                                    1030 02931000
         BR    @14                                                 1030 02932000
*ALLREC: PROC;  /*RECORD DEPENDENT SELECTION CRITTERIA       @Z427VLS*/ 02933000
ALLREC   STM   @14,@12,@SA00022                                    1031 02934000
*               /*COMPARE RECORD ITEMS PRECEEDED BY          @Z427VLS*/ 02935000
*               /* LRT TO PARAMETER TABLE SELECTION          @Z427VLS*/ 02936000
*               /*VALUES AND RANGES                          @Z427VLS*/ 02937000
*PASSFLAG = YES; /*RECORD SELECTED IF PASSFLAG NOT SET TO NO @Z427VLS*/ 02938000
         OI    PASSFLAG(R2),B'00000001'                            1032 02939000
*IF LRTDATE >= STDATE & LRTDATE <= ENDDATE THEN                    1033 02940000
         CLC   LRTDATE(4,R7),STDATE(R2)                            1033 02941000
         BL    @RF01033                                            1033 02942000
         CLC   LRTDATE(4,R7),ENDDATE(R2)                           1033 02943000
         BH    @RF01033                                            1033 02944000
*  DO;                                                     /*@Z427VLS*/ 02945000
*    IF (LRTTIME >= STTIME1 & LRTTIME <= ENDTIME1) |               1035 02946000
*       (LRTTIME >= STTIME2 & LRTTIME <= ENDTIME2) THEN            1035 02947000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           1035 02948000
         BL    @GL00055                                            1035 02949000
         CLC   LRTTIME(4,R7),ENDTIME1(R2)                          1035 02950000
         BNH   @RT01035                                            1035 02951000
@GL00055 CLC   LRTTIME(4,R7),STTIME2(R2)                           1035 02952000
         BL    @RF01035                                            1035 02953000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          1035 02954000
         BH    @RF01035                                            1035 02955000
@RT01035 DS    0H                                                  1036 02956000
*      DO;                                                 /*@Z427VLS*/ 02957000
*        IF CPUPTR ^= ZERO THEN                                    1037 02958000
         L     @08,CPUPTR(,R2)                                     1037 02959000
         LTR   @08,@08                                             1037 02960000
         BZ    @RF01037                                            1037 02961000
*         DO;                                              /*@Z427VLS*/ 02962000
*          CPUOK = NO;                                     /*@Z427VLS*/ 02963000
         NI    CPUOK,B'11011111'                                   1039 02964000
*          DO Z = 1 BY 1 TO CPUNUM WHILE CPUOK = NO;       /*@Z427VLS*/ 02965000
         LA    @08,1                                               1040 02966000
         ST    @08,Z                                               1040 02967000
         B     @DE01040                                            1040 02968000
@DL01040 TM    CPUOK,B'00100000'                                   1040 02969000
         BNZ   @DC01040                                            1040 02970000
*           IF CPUVAL(Z) = LRTCPMOD THEN CPUOK = YES;      /*@Z427VLS*/ 02971000
         MH    @08,@CH00079                                        1041 02972000
         L     @06,CPUPTR(,R2)                                     1041 02973000
         ALR   @06,@08                                             1041 02974000
         AL    @06,@CF01515                                        1041 02975000
         CLC   CPUVAL-2(5,@06),LRTCPMOD(R7)                        1041 02976000
         BNE   @RF01041                                            1041 02977000
         OI    CPUOK,B'00100000'                                   1042 02978000
*          END;                                            /*@Z427VLS*/ 02979000
@RF01041 LA    @08,1                                               1043 02980000
         AL    @08,Z                                               1043 02981000
         ST    @08,Z                                               1043 02982000
@DE01040 L     @06,CPUPTR(,R2)                                     1043 02983000
         CH    @08,CPUNUM(,@06)                                    1043 02984000
         BNH   @DL01040                                            1043 02985000
@DC01040 DS    0H                                                  1044 02986000
*          IF CPUOK = NO THEN                                      1044 02987000
         TM    CPUOK,B'00100000'                                   1044 02988000
         BNZ   @RF01044                                            1044 02989000
*           DO;                                            /*@Z427VLS*/ 02990000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 02991000
         NI    PASSFLAG(R2),B'11111110'                            1046 02992000
*           END;                                           /*@Z427VLS*/ 02993000
*         END;                                             /*@Z427VLS*/ 02994000
@RF01044 DS    0H                                                  1049 02995000
*        IF PASSFLAG = YES THEN                                    1049 02996000
@RF01037 TM    PASSFLAG(R2),B'00000001'                            1049 02997000
         BNO   @RF01049                                            1049 02998000
*        DO;                                               /*@Z427VLS*/ 02999000
*        IF SHIFT3RD = ON &                                        1051 03000000
*          ((LRTDATE = STDATE & LRTTIME < STTIME1) |               1051 03001000
*           (LRTDATE = ENDDATE & LRTTIME > ENDTIME2))              1051 03002000
*           THEN                                                   1051 03003000
         TM    SHIFT3RD(R2),B'00010000'                            1051 03004000
         BNO   @RF01051                                            1051 03005000
         CLC   LRTDATE(4,R7),STDATE(R2)                            1051 03006000
         BNE   @GL00059                                            1051 03007000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           1051 03008000
         BL    @RT01051                                            1051 03009000
@GL00059 CLC   LRTDATE(4,R7),ENDDATE(R2)                           1051 03010000
         BNE   @RF01051                                            1051 03011000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          1051 03012000
         BNH   @RF01051                                            1051 03013000
@RT01051 DS    0H                                                  1052 03014000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 03015000
         NI    PASSFLAG(R2),B'11111110'                            1052 03016000
*        END;                                              /*@Z427VLS*/ 03017000
@RF01051 DS    0H                                                  1054 03018000
*      IF PASSFLAG = YES & LRTCPUS = ZERO THEN                     1054 03019000
@RF01049 TM    PASSFLAG(R2),B'00000001'                            1054 03020000
         BNO   @RF01054                                            1054 03021000
         ICM   @08,7,LRTCPUS(R7)                                   1054 03022000
         BNZ   @RF01054                                            1054 03023000
*       DO;                                                /*@Z427VLS*/ 03024000
*        MSGNO = 5;                                        /*@Z427VLS*/ 03025000
         MVI   MSGNO,X'05'                                         1056 03026000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 03027000
         BAL   @14,ERRMSG                                          1057 03028000
*        PASSFLAG = NO;                                    /*@Z427VLS*/ 03029000
         NI    PASSFLAG(R2),B'11111110'                            1058 03030000
*       END;                                               /*@Z427VLS*/ 03031000
*      END;                                                /*@Z427VLS*/ 03032000
*    ELSE                                                          1061 03033000
*      PASSFLAG = NO;                                      /*@Z427VLS*/ 03034000
         B     @RC01035                                            1061 03035000
@RF01035 NI    PASSFLAG(R2),B'11111110'                            1061 03036000
*   END;                                                   /*@Z427VLS*/ 03037000
*  ELSE                                                            1063 03038000
*   PASSFLAG = NO;                                         /*@Z427VLS*/ 03039000
         B     @RC01033                                            1063 03040000
@RF01033 NI    PASSFLAG(R2),B'11111110'                            1063 03041000
*END;                                                      /*@Z427VLS*/ 03042000
@EL00022 DS    0H                                                  1064 03043000
@EF00022 DS    0H                                                  1064 03044000
@ER00022 LM    @14,@12,@SA00022                                    1064 03045000
         BR    @14                                                 1064 03046000
*SORTWO  : PROC;                                           /*@Z427VLS*/ 03047000
SORTWO   STM   @14,@12,@SA00023                                    1065 03048000
*  /*MUST ADJUST POINTERS TO EVTABLE, SYSCPU AND SYSOLD, AS A RESULT*/  03049000
*  /*OF SORT OF EVTABLE                                      @Z427VLS*/ 03050000
*  DO J = 1 BY 1 TO PASSNUM; /*EXAMINE ALL ENTRIES OF SYSUM2 @Z427VLS*/ 03051000
         LA    @08,1                                               1066 03052000
         ST    @08,J                                               1066 03053000
         B     @DE01066                                            1066 03054000
@DL01066 DS    0H                                                  1067 03055000
*    WORKBYTE = TMPCPUS(J); /*GET CPU,OLD FROM PARTICULAR ENTRY*/  1067 03056000
         LR    @06,@08                                             1067 03057000
         MH    @06,@CH00966                                        1067 03058000
         L     @03,SORTADR(,R2)                                    1067 03059000
         ST    @06,@TF00001                                        1067 03060000
         ALR   @06,@03                                             1067 03061000
         AL    @06,@CF01516                                        1067 03062000
         MVC   WORKBYTE(1),TMPCPUS-3(@06)                          1067 03063000
*    WORKTWO  = WORKBYTE; /*DITTO                            @Z427VLS*/ 03064000
         MVC   WORKTWO(1),WORKBYTE                                 1068 03065000
*    SRL(WORKBYTE,4); /*WORKBYTE, WORKNUM NOW ARE TMPCPU     @Z427VLS*/ 03066000
         SLR   @06,@06                                             1069 03067000
         IC    @06,WORKBYTE                                        1069 03068000
         SRL   @06,4                                               1069 03069000
         STC   @06,WORKBYTE                                        1069 03070000
*    WORKTWO = (WORKTWO & '0F'X);   /*WORKTWO, WORKNM2 NOW ARE TMPOLD*/ 03071000
         NI    WORKTWO,X'0F'                                       1070 03072000
*    WORKNM2 = WORKNM2 + 1; /*ADJUST INDEX TO START AT ONE, NOT ZERO*/  03073000
         LA    @06,1                                               1071 03074000
         SLR   @15,@15                                             1071 03075000
         IC    @15,WORKNM2                                         1071 03076000
         ALR   @15,@06                                             1071 03077000
         STC   @15,WORKNM2                                         1071 03078000
*    TMPCPUS(J) = FLIPFLOP(WORKNM2);    /*SET SORTED TMPOLD  @Z427VLS*/ 03079000
         LR    @01,@03                                             1072 03080000
         AL    @01,@TF00001                                        1072 03081000
         AL    @01,@CF01516                                        1072 03082000
         LA    @14,FLIPFLOP-1(@15)                                 1072 03083000
         MVC   TMPCPUS-3(1,@01),0(@14)                             1072 03084000
*    WORKNM = WORKNM + 1; /*ADJUST INDEX TO START AT ONE, NOT ZERO*/    03085000
         SLR   @15,@15                                             1073 03086000
         IC    @15,WORKNM                                          1073 03087000
         ALR   @06,@15                                             1073 03088000
         STC   @06,WORKNM                                          1073 03089000
*    WORKTWO = FLIPFLOP(WORKNM);     /*SET SORTED TMPCPU     @Z427VLS*/ 03090000
         LA    @01,FLIPFLOP-1(@06)                                 1074 03091000
         MVC   WORKTWO(1),0(@01)                                   1074 03092000
*    SLL(WORKTWO,4); /*SET SORTED TMPCPU TO FIRST FOUR BITS  @Z427VLS*/ 03093000
         SLR   @06,@06                                             1075 03094000
         IC    @06,WORKTWO                                         1075 03095000
         SLL   @06,4                                               1075 03096000
         STC   @06,WORKTWO                                         1075 03097000
*    TMPCPUS(J) = (TMPCPUS(J) | WORKTWO); /*PUT VALUE BACK IN RECORD*/  03098000
         LR    @06,@03                                             1076 03099000
         AL    @06,@TF00001                                        1076 03100000
         AL    @06,@CF01516                                        1076 03101000
         OC    TMPCPUS-3(1,@06),WORKTWO                            1076 03102000
*    /*CODE ADDED TO SHIFT 3705 ERROR TYPE PAST TMPCPU INDEX FOR*/ 1077 03103000
*    /*PROPER SORTING. LAST SECOND CHANGE OCT 13, 1976       @Z427VLS*/ 03104000
*    WORKTWO = (TMPCPUS(J) & '0F'X); /*GET OLD CPU INDEX     @Z427VLS*/ 03105000
         LR    @06,@03                                             1077 03106000
         AL    @06,@TF00001                                        1077 03107000
         AL    @06,@CF01516                                        1077 03108000
         MVC   WORKTWO(1),TMPCPUS-3(@06)                           1077 03109000
         NI    WORKTWO,X'0F'                                       1077 03110000
*    TMPCPUS(J) = (TMPCPUS(J) & 'F0'X); /*ZERO OLD CPU INDEX @Z427VLS*/ 03111000
         LR    @06,@03                                             1078 03112000
         AL    @06,@TF00001                                        1078 03113000
         AL    @06,@CF01516                                        1078 03114000
         NI    TMPCPUS-3(@06),X'F0'                                1078 03115000
*    TMPITEM(J) = (TMPITEM(J) | WORKTWO); /*REPLACE OLD INDEX AT TMPOD* 03116000
         AL    @03,@TF00001                                        1079 03117000
         AL    @03,@CF01510                                        1079 03118000
         OC    TMPITEM-4(1,@03),WORKTWO                            1079 03119000
*  END;                                                    /*@Z427VLS*/ 03120000
         AL    @08,@CF00055                                        1080 03121000
         ST    @08,J                                               1080 03122000
@DE01066 C     @08,PASSNUM                                         1080 03123000
         BNH   @DL01066                                            1080 03124000
*/* SORT THAT ONLY EXAMINES AN ENTRY ONCE IF DATA IS IN ORDER*/    1081 03125000
*RESPECIFY (R15,R3,R4,R6,R1) RESTRICTED;                   /*@Z427VLS*/ 03126000
*IF SORTNUM > 1 & DEBUG23 = OFF THEN /*IF AT LEAST TWO RECORDS AND*/    03127000
         L     @14,SORTNUM(,R2)                                    1082 03128000
         C     @14,@CF00055                                        1082 03129000
         BNH   @RF01082                                            1082 03130000
         TM    DEBUG23(R2),B'00000001'                             1082 03131000
         BNZ   @RF01082                                            1082 03132000
*  DO;     /*DEBUG OPTION DOESNT SAY DONT SORT THEN          @Z427VLS*/ 03133000
* SRTCONT = ((PASSNUM-1)*13) + SORTADR;                    /*@0099VLS*/ 03134000
         L     @14,PASSNUM                                         1084 03135000
         BCTR  @14,0                                               1084 03136000
         MH    @14,@CH00966                                        1084 03137000
         AL    @14,SORTADR(,R2)                                    1084 03138000
         ST    @14,SRTCONT                                         1084 03139000
*GENERATE REFS(TMP2,TMPKEY);                               /*@0099VLS*/ 03140000
    LA   R15,13                                                         03141000
    L    R3,SORTADR(R2)                                                 03142000
    L    R4,SRTCONT                                                     03143000
    LR   R1,R3                                                          03144000
    B    DOIT                                                           03145000
LOOPBCK1 ALR  R3,R15                                                    03146000
         CR   R3,R4                                                     03147000
         BNL  DONE                                                      03148000
DOIT     CLC  TMPKEY(5,R3),TMPKEY+13(R3)                                03149000
         BNH  LOOPBCK1                                                  03150000
         XC   TMP2(13,R3),TMP2+13(R3)                                   03151000
         XC   TMP2+13(13,R3),TMP2(R3)                                   03152000
         XC   TMP2(13,R3),TMP2+13(R3)                                   03153000
         LR   R6,R3                                                     03154000
LOOPBCK2 SR   R6,R15                                                    03155000
         CR   R6,R1                                                     03156000
         BL   LOOPBCK1                                                  03157000
         CLC  TMPKEY(5,R6),TMPKEY+13(R6)                                03158000
         BNH  LOOPBCK1                                                  03159000
         XC   TMP2+13(13,R6),TMP2(R6)                                   03160000
         XC   TMP2(13,R6),TMP2+13(R6)                                   03161000
         XC   TMP2+13(13,R6),TMP2(R6)                                   03162000
          B     LOOPBCK2           TRY COMPARE UP ONE MORE IN TABLE     03163000
DONE      EQU   *                                                       03164000
*END;                                                      /*@Z427VLS*/ 03165000
* RESPECIFY (R1,R3,R4,R6,R15) UNRESTRICTED;                /*@Z427VLS*/ 03166000
*END; /*CLOSING END TO PROC SORTWO                           @Z427VLS*/ 03167000
@EL00023 DS    0H                                                  1088 03168000
@EF00023 DS    0H                                                  1088 03169000
@ER00023 LM    @14,@12,@SA00023                                    1088 03170000
         BR    @14                                                 1088 03171000
*/*                                                          @Z427VLS*/ 03172000
*MCHFILT: PROC;                                            /*@Z427VLS*/ 03173000
MCHFILT  STM   @14,@12,@SA00024                                    1089 03174000
*IF MCHSYSTR = ON THEN /*IF NON-RECOVERABLE MCH              @Z427VLS*/ 03175000
         TM    MCHSYSTR(R7),B'10000000'                            1090 03176000
         BNO   @RF01090                                            1090 03177000
*  SYSUMMCN = SYSUMMCN + 1;                                /*@Z427VLS*/ 03178000
         L     @08,SYSUMPTR(,R2)                                   1091 03179000
         LA    @06,1                                               1091 03180000
         AL    @06,SYSUMMCN(,@08)                                  1091 03181000
         ST    @06,SYSUMMCN(,@08)                                  1091 03182000
*ELSE            /*IF RECOVERABLE MCH                        @Z427VLS*/ 03183000
*  SYSUMMCR = SYSUMMCR + 1;                                /*@Z427VLS*/ 03184000
         B     @RC01090                                            1092 03185000
@RF01090 L     @08,SYSUMPTR(,R2)                                   1092 03186000
         LA    @06,1                                               1092 03187000
         AL    @06,SYSUMMCR(,@08)                                  1092 03188000
         ST    @06,SYSUMMCR(,@08)                                  1092 03189000
*IF FRAMEPTR ^= ZERO THEN /*IF FRAMETAB HAS BEEN ALLOCATED   @G51DGBB*/ 03190000
@RC01090 L     @08,FRAMEPTR(,R2)                                   1093 03191000
         LTR   @08,@08                                             1093 03192000
         BZ    @RF01093                                            1093 03193000
*DO;                                                       /*@G51DGBB*/ 03194000
*GETOUT = NO;                                              /*@G51DGBB*/ 03195000
         NI    GETOUT,B'11110111'                                  1095 03196000
*DO A = 1 BY 1 TO MRDNUMBR WHILE GETOUT = NO; /*LOOP THROUGH LIST OF */ 03197000
         LA    @08,1                                               1096 03198000
         ST    @08,A                                               1096 03199000
         B     @DE01096                                            1096 03200000
@DL01096 TM    GETOUT,B'00001000'                                  1096 03201000
         BNZ   @DC01096                                            1096 03202000
*                                           /*MERIDIAN-LIKE CPUS   */   03203000
*  IF MODEL(A) = LRTMODEL THEN             /*IF MERIDIAN-LIKE CPU */    03204000
         ALR   @08,@08                                             1097 03205000
         L     @06,MERDCPTR(,R2)                                   1097 03206000
         ALR   @06,@08                                             1097 03207000
         CLC   MODEL-2(2,@06),LRTMODEL(R7)                         1097 03208000
         BNE   @RF01097                                            1097 03209000
*    DO;                                                   /*@G51DGBB*/ 03210000
*      CALL BUILDFTB; /*SEE IF UNIQUE, BUILD FRAMTAB ENTRY IF IT IS */  03211000
         BAL   @14,BUILDFTB                                        1099 03212000
*      GETOUT = YES;  /*EXIT LOOP                            @G51DGBB*/ 03213000
         OI    GETOUT,B'00001000'                                  1100 03214000
*    END;                                                  /*@G51DGBB*/ 03215000
*END;                                                      /*@G51DGBB*/ 03216000
@RF01097 LA    @08,1                                               1102 03217000
         AL    @08,A                                               1102 03218000
         ST    @08,A                                               1102 03219000
@DE01096 L     @06,MERDCPTR(,R2)                                   1102 03220000
         CH    @08,MRDNUMBR(,@06)                                  1102 03221000
         BNH   @DL01096                                            1102 03222000
@DC01096 DS    0H                                                  1103 03223000
*END;                                                      /*@G51DGBB*/ 03224000
*END;                                                      /*@Z427VLS*/ 03225000
@EL00024 DS    0H                                                  1104 03226000
@EF00024 DS    0H                                                  1104 03227000
@ER00024 LM    @14,@12,@SA00024                                    1104 03228000
         BR    @14                                                 1104 03229000
*/*                                                          @Z427VLS*/ 03230000
*/*                                                          @Z427VLS*/ 03231000
*SOFTFILT: PROC;                                           /*@Z427VLS*/ 03232000
SOFTFILT STM   @14,@12,12(@13)                                     1105 03233000
*IF SFTKEY1 = HEX40 THEN /*IF PROGRAM ABEND                  @Z427VLS*/ 03234000
         CLI   SFTKEY1(R7),X'40'                                   1106 03235000
         BNE   @RF01106                                            1106 03236000
* DO;                                                      /*@0001VLS*/ 03237000
*  SYSUMPEA = SYSUMPEA + ONE;                              /*@Z427VLS*/ 03238000
         L     @08,SYSUMPTR(,R2)                                   1108 03239000
         LA    @06,1                                               1108 03240000
         L     @03,SYSUMPEA(,@08)                                  1108 03241000
         ALR   @03,@06                                             1108 03242000
         ST    @03,SYSUMPEA(,@08)                                  1108 03243000
*  BUG(2) = BUG(2) + ONE;                                  /*@0001VLS*/ 03244000
         AL    @06,BUG+4                                           1109 03245000
         ST    @06,BUG+4                                           1109 03246000
* END;                                                     /*@0001VLS*/ 03247000
*ELSE                                                              1111 03248000
*  DO;                                                     /*@Z427VLS*/ 03249000
         B     @RC01106                                            1111 03250000
@RF01106 DS    0H                                                  1112 03251000
*    IF SFTKEY1 = HEX42 THEN /*IF PROGRAM INTERRUPT          @Z427VLS*/ 03252000
         CLI   SFTKEY1(R7),X'42'                                   1112 03253000
         BNE   @RF01112                                            1112 03254000
*     DO;                                                  /*@0001VLS*/ 03255000
*      SYSUMPEI = SYSUMPEI + ONE;                          /*@Z427VLS*/ 03256000
         L     @08,SYSUMPTR(,R2)                                   1114 03257000
         LA    @06,1                                               1114 03258000
         L     @03,SYSUMPEI(,@08)                                  1114 03259000
         ALR   @03,@06                                             1114 03260000
         ST    @03,SYSUMPEI(,@08)                                  1114 03261000
*      BUG(2) = BUG(2) + ONE;                              /*@0001VLS*/ 03262000
         AL    @06,BUG+4                                           1115 03263000
         ST    @06,BUG+4                                           1115 03264000
*     END;                                                 /*@0001VLS*/ 03265000
*    ELSE                                                          1117 03266000
*      DO;                                                 /*@Z427VLS*/ 03267000
         B     @RC01112                                            1117 03268000
@RF01112 DS    0H                                                  1118 03269000
*        IF SFTKEY1 = HEX44 THEN /*IF PROGRAM RESTART        @Z427VLS*/ 03270000
         CLI   SFTKEY1(R7),X'44'                                   1118 03271000
         BNE   @RF01118                                            1118 03272000
*          DO;                                             /*@0001VLS*/ 03273000
*          SYSUMPER = SYSUMPER + ONE;                      /*@Z427VLS*/ 03274000
         L     @08,SYSUMPTR(,R2)                                   1120 03275000
         LA    @06,1                                               1120 03276000
         L     @03,SYSUMPER(,@08)                                  1120 03277000
         ALR   @03,@06                                             1120 03278000
         ST    @03,SYSUMPER(,@08)                                  1120 03279000
*           BUG(2) = BUG(2) + ONE;                         /*@0001VLS*/ 03280000
         AL    @06,BUG+4                                           1121 03281000
         ST    @06,BUG+4                                           1121 03282000
*          END;                                            /*@0001VLS*/ 03283000
*      END;                                                /*@Z427VLS*/ 03284000
*  END;                                                    /*@Z427VLS*/ 03285000
*                                                                  1124 03286000
*END;                                                      /*@Z427VLS*/ 03287000
@EL00025 DS    0H                                                  1125 03288000
@EF00025 DS    0H                                                  1125 03289000
@ER00025 LM    @14,@12,12(@13)                                     1125 03290000
         BR    @14                                                 1125 03291000
*ERRMSG: PROC;                                             /*@Z427VLS*/ 03292000
ERRMSG   STM   @14,@12,@SA00026                                    1126 03293000
*RESPECIFY(R3) RESTRICTED;                                 /*@Z427VLS*/ 03294000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 03295000
         LA    @08,PRINTLIN                                        1128 03296000
         ST    @08,PRINTADR(,R2)                                   1128 03297000
*IF MSGNO=1  |                                           /* @XA19728 */ 03298000
*   MSGNO=2  THEN                                        /* @XA19728 */ 03299000
         CLI   MSGNO,1                                             1129 03300000
         BE    @RT01129                                            1129 03301000
         CLI   MSGNO,2                                             1129 03302000
         BNE   @RF01129                                            1129 03303000
@RT01129 DS    0H                                                  1130 03304000
*  DO;                                                     /*@GZZDGVS*/ 03305000
*    ZEROALL=NO;         /* DONT RESET LOGREC HEADER OF ALL  @GZZDGVS*/ 03306000
         NI    ZEROALL(R2),B'10111111'                             1131 03307000
*                        /* RECORDS NOT PROCESSED           @XA19728 */ 03308000
*    CALL IFCMSG(55,ADDR(PRINTBDY));  /*GET FAILED SORT TBL @Z427VLS */ 03309000
         LA    @08,PRINTBDY                                        1132 03310000
         ST    @08,@AFTEMPS+4                                      1132 03311000
         L     @15,ADIFCMSG(,R2)                                   1132 03312000
         LA    @01,@AL01132                                        1132 03313000
         BALR  @14,@15                                             1132 03314000
*  END;                                                    /*@GZZDGVS*/ 03315000
*IF MSGNO = 3 THEN                                                 1134 03316000
@RF01129 CLI   MSGNO,3                                             1134 03317000
         BNE   @RF01134                                            1134 03318000
*   CALL IFCMSG(53,ADDR(PRINTBDY));                        /*@Z427VLS*/ 03319000
         LA    @08,PRINTBDY                                        1135 03320000
         ST    @08,@AFTEMPS+4                                      1135 03321000
         L     @15,ADIFCMSG(,R2)                                   1135 03322000
         LA    @01,@AL01135                                        1135 03323000
         BALR  @14,@15                                             1135 03324000
*IF MSGNO = 6 THEN  /*TOO MANY CPU SERIAL NUMBERS IN INPUT STREAM*/     03325000
@RF01134 CLI   MSGNO,6                                             1136 03326000
         BNE   @RF01136                                            1136 03327000
*  DO;                                                     /*@Z427VLS*/ 03328000
*   CALL IFCMSG(74,ADDR(PRINTBDY));                        /*@Z427VLS*/ 03329000
         LA    @08,PRINTBDY                                        1138 03330000
         ST    @08,@AFTEMPS+4                                      1138 03331000
         L     @15,ADIFCMSG(,R2)                                   1138 03332000
         LA    @01,@AL01138                                        1138 03333000
         BALR  @14,@15                                             1138 03334000
*    ER3 = EVSERIAL(K);                                    /*@Z427VLS*/ 03335000
         L     @08,K                                               1139 03336000
         MH    @08,@CH00081                                        1139 03337000
         L     @06,EVPTR(,R2)                                      1139 03338000
         ALR   @06,@08                                             1139 03339000
         MVC   ER3(3),EVSERIAL-6(@06)                              1139 03340000
*    SLL(ERSER,4); /*SHIFT SERIAL IN ORDER TO ADD PACKED SIGN*/    1140 03341000
         L     @08,ERSER                                           1140 03342000
         SLL   @08,4                                               1140 03343000
         ST    @08,ERSER                                           1140 03344000
*    ER3 = (ER3 | '00000F'X); /*ADD SIGN FOR UNPACKING OPERATION*/ 1141 03345000
         OC    ER3(3),@CB00228                                     1141 03346000
*    UNPK(PRNTSER,ERSER);                                  /*@Z427VLS*/ 03347000
         UNPK  PRNTSER(7),ERSER(4)                                 1142 03348000
*  END;                                                    /*@Z427VLS*/ 03349000
*IF MSGNO = 5   THEN                                               1144 03350000
@RF01136 CLI   MSGNO,5                                             1144 03351000
         BNE   @RF01144                                            1144 03352000
*   CALL IFCMSG(72,ADDR(PRINTBDY));                        /*@Z427VLS*/ 03353000
         LA    @08,PRINTBDY                                        1145 03354000
         ST    @08,@AFTEMPS+4                                      1145 03355000
         L     @15,ADIFCMSG(,R2)                                   1145 03356000
         LA    @01,@AL01145                                        1145 03357000
         BALR  @14,@15                                             1145 03358000
*IF MSGNO = 78 THEN                                                1146 03359000
@RF01144 CLI   MSGNO,78                                            1146 03360000
         BNE   @RF01146                                            1146 03361000
* DO;                                                      /*@G51DGBB*/ 03362000
*   CALL IFCMSG(78,ADDR(PRINTBDY));                        /*@G51DGBB*/ 03363000
         LA    @08,PRINTBDY                                        1148 03364000
         ST    @08,@AFTEMPS+4                                      1148 03365000
         L     @15,ADIFCMSG(,R2)                                   1148 03366000
         LA    @01,@AL01148                                        1148 03367000
         BALR  @14,@15                                             1148 03368000
*   NUMBER = 3;                                            /*@G51DGBB*/ 03369000
         MVC   NUMBER(4),@CF00076                                  1149 03370000
*   ADDNXT = ADDR(PFRAMSER);                               /*@G51DGBB*/ 03371000
         LA    @08,PFRAMSER                                        1150 03372000
         ST    @08,ADDNXT                                          1150 03373000
*   NEXTBY = ADDR(FRAMESER(CCHINDX));                      /*@G51DGBB*/ 03374000
         L     @08,CCHINDX                                         1151 03375000
         MH    @08,@CH00227                                        1151 03376000
         L     @06,FRAMEPTR(,R2)                                   1151 03377000
         AL    @06,@CF01504                                        1151 03378000
         LA    @08,FRAMESER-4(@08,@06)                             1151 03379000
         ST    @08,NEXTBY                                          1151 03380000
*   CALL CONVERT;                                          /*@G51DGBB*/ 03381000
         BAL   @14,CONVERT                                         1152 03382000
*   NUMBER = 2;                                            /*@G51DGBB*/ 03383000
         MVC   NUMBER(4),@CF00074                                  1153 03384000
*   ADDNXT = ADDR(PFRAMMOD);                               /*@G51DGBB*/ 03385000
         LA    @08,PFRAMMOD                                        1154 03386000
         ST    @08,ADDNXT                                          1154 03387000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX));                      /*@G51DGBB*/ 03388000
         L     @08,CCHINDX                                         1155 03389000
         MH    @08,@CH00227                                        1155 03390000
         L     @06,FRAMEPTR(,R2)                                   1155 03391000
         AL    @06,@CF01517                                        1155 03392000
         LA    @08,FRAMEMOD-7(@08,@06)                             1155 03393000
         ST    @08,NEXTBY                                          1155 03394000
*   CALL CONVERT;                                          /*@G51DGBB*/ 03395000
         BAL   @14,CONVERT                                         1156 03396000
*  END;                                                    /*@G51DGBB*/ 03397000
*IF MSGNO = 79 & DEBUG16 = ON THEN /*IF PARTIAL FRAME SET AND DEBUG16*/ 03398000
@RF01146 CLI   MSGNO,79                                            1158 03399000
         BNE   @RF01158                                            1158 03400000
         TM    DEBUG16(R2),B'10000000'                             1158 03401000
         BNO   @RF01158                                            1158 03402000
*  DO;                                                     /*@G51DGBB*/ 03403000
*    NUMBER = 3;                                           /*@G51DGBB*/ 03404000
         MVC   NUMBER(4),@CF00076                                  1160 03405000
*    ADDNXT = ADDR(PARSER);                                /*@G51DGBB*/ 03406000
         LA    @08,PARSER                                          1161 03407000
         ST    @08,ADDNXT                                          1161 03408000
*    NEXTBY = ADDR(FRAMESER(CCHINDX));                     /*@G51DGBB*/ 03409000
         L     @08,CCHINDX                                         1162 03410000
         MH    @08,@CH00227                                        1162 03411000
         L     @06,FRAMEPTR(,R2)                                   1162 03412000
         AL    @06,@CF01504                                        1162 03413000
         LA    @08,FRAMESER-4(@08,@06)                             1162 03414000
         ST    @08,NEXTBY                                          1162 03415000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03416000
         BAL   @14,CONVERT                                         1163 03417000
*    NUMBER = 2;                                           /*@G51DGBB*/ 03418000
         MVC   NUMBER(4),@CF00074                                  1164 03419000
*    ADDNXT = ADDR(PARMOD);                                /*@G51DGBB*/ 03420000
         LA    @08,PARMOD                                          1165 03421000
         ST    @08,ADDNXT                                          1165 03422000
*    NEXTBY = ADDR(FRAMEMOD(CCHINDX));                     /*@G51DGBB*/ 03423000
         L     @08,CCHINDX                                         1166 03424000
         MH    @08,@CH00227                                        1166 03425000
         L     @06,FRAMEPTR(,R2)                                   1166 03426000
         AL    @06,@CF01517                                        1166 03427000
         LA    @08,FRAMEMOD-7(@08,@06)                             1166 03428000
         ST    @08,NEXTBY                                          1166 03429000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03430000
         BAL   @14,CONVERT                                         1167 03431000
*    NUMBER = 1;                                           /*@G51DGBB*/ 03432000
         MVC   NUMBER(4),@CF00055                                  1168 03433000
*    ADDNXT = ADDR(PARREP);                                /*@G51DGBB*/ 03434000
         LA    @08,PARREP                                          1169 03435000
         ST    @08,ADDNXT                                          1169 03436000
*    NEXTBY = ADDR(FRAMETYP(CCHINDX));                     /*@G51DGBB*/ 03437000
         L     @08,CCHINDX                                         1170 03438000
         MH    @08,@CH00227                                        1170 03439000
         L     @06,FRAMEPTR(,R2)                                   1170 03440000
         AL    @06,@CF01502                                        1170 03441000
         LA    @08,FRAMETYP-17(@08,@06)                            1170 03442000
         ST    @08,NEXTBY                                          1170 03443000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03444000
         BAL   @14,CONVERT                                         1171 03445000
*    PRINTBDY(1:58) = PARTIAL;                             /*@G51DGBB*/ 03446000
         MVC   PRINTBDY(58),PARTIAL                                1172 03447000
*  END;                                                    /*@G51DGBB*/ 03448000
*IF MSGNO = 40 THEN                                                1174 03449000
@RF01158 CLI   MSGNO,40                                            1174 03450000
         BNE   @RF01174                                            1174 03451000
* CALL IFCMSG(40,ADDR(PRINTBDY));                          /*@G51DGBB*/ 03452000
         LA    @08,PRINTBDY                                        1175 03453000
         ST    @08,@AFTEMPS+4                                      1175 03454000
         L     @15,ADIFCMSG(,R2)                                   1175 03455000
         LA    @01,@AL01175                                        1175 03456000
         BALR  @14,@15                                             1175 03457000
*IF MSGNO = 24 THEN                                                1176 03458000
@RF01174 CLI   MSGNO,24                                            1176 03459000
         BNE   @RF01176                                            1176 03460000
* CALL IFCMSG(24,ADDR(PRINTBDY));                          /*@G51DGBB*/ 03461000
         LA    @08,PRINTBDY                                        1177 03462000
         ST    @08,@AFTEMPS+4                                      1177 03463000
         L     @15,ADIFCMSG(,R2)                                   1177 03464000
         LA    @01,@AL01177                                        1177 03465000
         BALR  @14,@15                                             1177 03466000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 03467000
@RF01176 L     @15,ADIOHND(,R2)                                    1178 03468000
         LA    @01,@AL01178                                        1178 03469000
         BALR  @14,@15                                             1178 03470000
*END;                                                      /*@Z427VLS*/ 03471000
@EL00026 DS    0H                                                  1179 03472000
@EF00026 DS    0H                                                  1179 03473000
@ER00026 LM    @14,@12,@SA00026                                    1179 03474000
         BR    @14                                                 1179 03475000
*BUGCNTS: PROC;                                            /*@Z427VLS*/ 03476000
BUGCNTS  STM   @14,@12,@SA00027                                    1180 03477000
*/*PRINT OUT COUNTS OF RECORDS PROCESSED IF DEBUG16 IS ON    @Z427VLS*/ 03478000
*PRINTADR = ADDR(PRINTLIN); /*ADDRESS OF PRINT LINE TO IFCIOND*/   1181 03479000
         LA    @08,PRINTLIN                                        1181 03480000
         ST    @08,PRINTADR(,R2)                                   1181 03481000
*PRINTLIN = ERRLINE(31);                                   /*@G51DGBB*/ 03482000
         MVI   PRINTLIN+63,C' '                                    1182 03483000
         MVC   PRINTLIN+64(70),PRINTLIN+63                         1182 03484000
         MVC   PRINTLIN(63),ERRLINE+1890                           1182 03485000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 03486000
         L     @15,ADIOHND(,R2)                                    1183 03487000
         LA    @01,@AL01183                                        1183 03488000
         BALR  @14,@15                                             1183 03489000
* DO J = 1 BY 1 TO 30;                                     /*@G51DGBB*/ 03490000
         LA    @08,1                                               1184 03491000
         ST    @08,J                                               1184 03492000
@DL01184 DS    0H                                                  1185 03493000
*  NUMREC = BUG(J);                                        /*@Z427VLS*/ 03494000
         SLA   @08,2                                               1185 03495000
         L     @08,BUG-4(@08)                                      1185 03496000
         ST    @08,NUMREC                                          1185 03497000
*  CVD(NUMREC,PACKPAS);                                    /*@Z427VLS*/ 03498000
         CVD   @08,@TS00001                                        1186 03499000
         MVC   PACKPAS(4),@TS00001+4                               1186 03500000
*  PACKPAS = (PACKPAS | '0000000F'X);                      /*@Z427VLS*/ 03501000
         OC    PACKPAS(4),@CB01430                                 1187 03502000
*  UNPK(EDFLD,PACKPAS);                                    /*@Z427VLS*/ 03503000
         UNPK  EDFLD(9),PACKPAS(4)                                 1188 03504000
*  NONBLANK = OFF;                                         /*@Z427VLS*/ 03505000
         NI    NONBLANK,B'01111111'                                1189 03506000
*  DO K = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                /*@Z427VLS*/ 03507000
         LA    @08,1                                               1190 03508000
         ST    @08,K                                               1190 03509000
@DL01190 TM    NONBLANK,B'10000000'                                1190 03510000
         BNZ   @DC01190                                            1190 03511000
*    IF EDIFILD(K) = CHARZERO THEN                                 1191 03512000
         LA    @06,EDIFILD-1(@08)                                  1191 03513000
         CLI   0(@06),X'F0'                                        1191 03514000
         BNE   @RF01191                                            1191 03515000
*      EDIFILD(K) = BLANK;                                 /*@Z427VLS*/ 03516000
         LA    @06,EDIFILD-1(@08)                                  1192 03517000
         MVI   0(@06),X'40'                                        1192 03518000
*    ELSE                                                          1193 03519000
*      NONBLANK = ON;                                      /*@Z427VLS*/ 03520000
         B     @RC01191                                            1193 03521000
@RF01191 OI    NONBLANK,B'10000000'                                1193 03522000
*  END;                                                    /*@Z427VLS*/ 03523000
@RC01191 LA    @08,1                                               1194 03524000
         AL    @08,K                                               1194 03525000
         ST    @08,K                                               1194 03526000
         C     @08,@CF00066                                        1194 03527000
         BNH   @DL01190                                            1194 03528000
@DC01190 DS    0H                                                  1195 03529000
*  ERXNUM(J) = EDFLD;                                      /*@Z427VLS*/ 03530000
         L     @08,J                                               1195 03531000
         MH    @08,@CH01491                                        1195 03532000
         LA    @06,ERXNUM-63(@08)                                  1195 03533000
         MVC   0(9,@06),EDFLD                                      1195 03534000
*  PRINTLIN = ERRLINE(J);                                  /*@Z427VLS*/ 03535000
         MVI   PRINTLIN+63,C' '                                    1196 03536000
         MVC   PRINTLIN+64(70),PRINTLIN+63                         1196 03537000
         LA    @06,ERRLINE-63(@08)                                 1196 03538000
         MVC   PRINTLIN(63),0(@06)                                 1196 03539000
*  PRINTADR = ADDR(PRINTLIN);                              /*@Z427VLS*/ 03540000
         LA    @08,PRINTLIN                                        1197 03541000
         ST    @08,PRINTADR(,R2)                                   1197 03542000
*  CALL IOHND(RITEPRTR);                                   /*@Z427VLS*/ 03543000
         L     @15,ADIOHND(,R2)                                    1198 03544000
         LA    @01,@AL01198                                        1198 03545000
         BALR  @14,@15                                             1198 03546000
* END;                                                     /*@Z427VLS*/ 03547000
         LA    @08,1                                               1199 03548000
         AL    @08,J                                               1199 03549000
         ST    @08,J                                               1199 03550000
         C     @08,@CF01458                                        1199 03551000
         BNH   @DL01184                                            1199 03552000
*END; /*CLOSING END TO PROC BUGCNTS                          @Z427VLS*/ 03553000
@EL00027 DS    0H                                                  1200 03554000
@EF00027 DS    0H                                                  1200 03555000
@ER00027 LM    @14,@12,@SA00027                                    1200 03556000
         BR    @14                                                 1200 03557000
*/*THIS PROC WILL EXAMINE THE MERIDIAN MCH OR CCH IN ORDER TO BUILD*/   03558000
*/*FRAMTAB ENTRIES FOR UNIQUE RECORDS                        @G51DGBB*/ 03559000
*BUILDFTB: PROC; /*BUILD NEW ENTRY IF CPU IS UNIQUE          @G51DGBB*/ 03560000
BUILDFTB STM   @14,@12,@SA00028                                    1201 03561000
*LOOPOUT = NO;                                             /*@G51DGBB*/ 03562000
         NI    LOOPOUT,B'11111011'                                 1202 03563000
*DO Y = 1 BY 1 TO EVMAX WHILE LOOPOUT = NO; /*EXAMINE ALL FRAMETAB*/    03564000
         LA    @08,1                                               1203 03565000
         ST    @08,Y                                               1203 03566000
@DL01203 TM    LOOPOUT,B'00000100'                                 1203 03567000
         BNZ   @DC01203                                            1203 03568000
*  IF FRAMECPU(Y) = LRTCPMOD THEN  /*IF CPU ALREADY IN TABLE THEN*/     03569000
         MH    @08,@CH00227                                        1204 03570000
         L     @06,FRAMEPTR(,R2)                                   1204 03571000
         ALR   @06,@08                                             1204 03572000
         AL    @06,@CF01504                                        1204 03573000
         CLC   FRAMECPU-4(5,@06),LRTCPMOD(R7)                      1204 03574000
         BNE   @RF01204                                            1204 03575000
*    LOOPOUT = YES; /*EXIT LOOP                              @G51DGBB*/ 03576000
         OI    LOOPOUT,B'00000100'                                 1205 03577000
*  ELSE     /*IF ENTRY DOESNT MATCH THE FRAME                @G51DGBB*/ 03578000
*    DO;                                                   /*@G51DGBB*/ 03579000
         B     @RC01204                                            1206 03580000
@RF01204 DS    0H                                                  1207 03581000
*      IF FRAMECPU(Y) = '0000000000'X THEN /*NO MATCH ,ALL ENTS CHKED*/ 03582000
         L     @08,Y                                               1207 03583000
         MH    @08,@CH00227                                        1207 03584000
         L     @06,FRAMEPTR(,R2)                                   1207 03585000
         ST    @08,@TF00001                                        1207 03586000
         ALR   @08,@06                                             1207 03587000
         AL    @08,@CF01504                                        1207 03588000
         CLC   FRAMECPU-4(5,@08),@CB00288                          1207 03589000
         BNE   @RF01207                                            1207 03590000
*        DO;                                               /*@G51DGBB*/ 03591000
*          FRAMECPU(Y) = LRTCPMOD;                         /*@G51DGBB*/ 03592000
         LR    @08,@06                                             1209 03593000
         AL    @08,@TF00001                                        1209 03594000
         AL    @08,@CF01504                                        1209 03595000
         MVC   FRAMECPU-4(5,@08),LRTCPMOD(R7)                      1209 03596000
*          FRAMENUM = FRAMENUM + 1; /*ADD 1 TO SET ENTRY COUNT*/   1210 03597000
         LA    @08,1                                               1210 03598000
         AL    @08,FRAMENUM(,@06)                                  1210 03599000
         ST    @08,FRAMENUM(,@06)                                  1210 03600000
*          LOOPOUT = YES;                                  /*@G51DGBB*/ 03601000
         OI    LOOPOUT,B'00000100'                                 1211 03602000
*        END;                                              /*@G51DGBB*/ 03603000
*      ELSE                                                        1213 03604000
*        IF Y = EVMAX THEN /*UNIQUE ENTRY BUT NOT ROOM IN TABLE*/  1213 03605000
         B     @RC01207                                            1213 03606000
@RF01207 CLC   Y(4),@CF00034                                       1213 03607000
         BNE   @RF01213                                            1213 03608000
*          DO;                                             /*@G51DGBB*/ 03609000
*            IF ONETIME = NO THEN   /*ISSUE MESSAGE ONLY ONCE*/    1215 03610000
         TM    ONETIME,B'00000001'                                 1215 03611000
         BNZ   @RF01215                                            1215 03612000
*              DO;                                         /*@G51DGBB*/ 03613000
*                MSGNO = 24;                               /*@G51DGBB*/ 03614000
         MVI   MSGNO,X'18'                                         1217 03615000
*                CALL ERRMSG;                              /*@G51DGBB*/ 03616000
         BAL   @14,ERRMSG                                          1218 03617000
*                ONETIME = YES;                            /*@G51DGBB*/ 03618000
         OI    ONETIME,B'00000001'                                 1219 03619000
*              END;                                        /*@G51DGBB*/ 03620000
*          END;                                            /*@G51DGBB*/ 03621000
@RF01215 DS    0H                                                  1222 03622000
*   END;                                                   /*@G51DGBB*/ 03623000
@RF01213 DS    0H                                                  1222 03624000
@RC01207 DS    0H                                                  1223 03625000
* END;                                                     /*@G51DGBB*/ 03626000
@RC01204 LA    @08,1                                               1223 03627000
         AL    @08,Y                                               1223 03628000
         ST    @08,Y                                               1223 03629000
         C     @08,@CF00034                                        1223 03630000
         BNH   @DL01203                                            1223 03631000
@DC01203 DS    0H                                                  1224 03632000
*END; /*END OF PROC BUILDFTB                                 @G51DGBB*/ 03633000
@EL00028 DS    0H                                                  1224 03634000
@EF00028 DS    0H                                                  1224 03635000
@ER00028 LM    @14,@12,@SA00028                                    1224 03636000
         BR    @14                                                 1224 03637000
*FRAMEREP: PROC; /*REPLACE FRAME IF MORE CURRENT FRAME FOUND @G51DGBB*/ 03638000
FRAMEREP STM   @14,@12,@SA00029                                    1225 03639000
*                /*COMPLETE ENTRY IF NO DATE ETC.            @G51DGBB*/ 03640000
*                /*APPEND LOCATION OF FRAME EXTERNAL LOCATION LIST*/    03641000
*GETOUT = NO;                                              /*@G51DGBB*/ 03642000
         NI    GETOUT,B'11110111'                                  1226 03643000
*DO X = 1 BY 1 TO FRAMENUM WHILE GETOUT = NO; /*LOOP THROUGH ALL SET*/  03644000
         LA    @08,1                                               1227 03645000
         ST    @08,X                                               1227 03646000
         B     @DE01227                                            1227 03647000
@DL01227 TM    GETOUT,B'00001000'                                  1227 03648000
         BNZ   @DC01227                                            1227 03649000
*                                             /*ENTRIES OF FRAMETAB */  03650000
*  IF FRAMECPU(X) = LRTCPMOD THEN             /*IF RECORD CPU MODEL */  03651000
         LR    @06,@08                                             1228 03652000
         MH    @06,@CH00227                                        1228 03653000
         L     @15,FRAMEPTR(,R2)                                   1228 03654000
         ST    @06,@TF00001                                        1228 03655000
         ALR   @06,@15                                             1228 03656000
         AL    @06,@CF01504                                        1228 03657000
         CLC   FRAMECPU-4(5,@06),LRTCPMOD(R7)                      1228 03658000
         BNE   @RF01228                                            1228 03659000
*    DO;                                      /*SERIAL MATCHES THOSE*/  03660000
*      CCHINDX = X;  /*SAVE INDEX*/           /*OF THE ENTRY @G51DGBB*/ 03661000
         ST    @08,CCHINDX                                         1230 03662000
*      IF FRAMEDT(X) < LRTDT THEN             /*IF REC DATE GREATER */  03663000
         AL    @15,@TF00001                                        1231 03664000
         AL    @15,@CF01519                                        1231 03665000
         CLC   FRAMEDT-9(8,@15),LRTDT(R7)                          1231 03666000
         BNL   @RF01231                                            1231 03667000
*        DO;                                  /*THAN ENTRY DATE     */  03668000
*              CALL FIXENTRY;               /*DELETE OLD FRAME SET*/    03669000
         BAL   @14,FIXENTRY                                        1233 03670000
*              FRAMEDT(X) = LRTDT;           /*SAVE HIGH DATE*/    1234 03671000
         L     @08,X                                               1234 03672000
         MH    @08,@CH00227                                        1234 03673000
         L     @06,FRAMEPTR(,R2)                                   1234 03674000
         ALR   @06,@08                                             1234 03675000
         AL    @06,@CF01519                                        1234 03676000
         MVC   FRAMEDT-9(8,@06),LRTDT(R7)                          1234 03677000
*              CALL BUILDTTR;                /*SAVE FRAME LOCATION*/    03678000
         BAL   @14,BUILDTTR                                        1235 03679000
*               FRAMEYES = YES;/*SAVE SUCCEEDING FRAMES OF THIS    */   03680000
         OI    FRAMEYES,B'00000010'                                1236 03681000
*                              /*LOGICAL SET                 @G51DGBB*/ 03682000
*         END;                                             /*@G51DGBB*/ 03683000
*       ELSE  /*IMPLIES DATE IS LOW OR EQUAL                 @G51DGBB*/ 03684000
*        DO;                                               /*@G51DGBB*/ 03685000
         B     @RC01231                                            1238 03686000
@RF01231 DS    0H                                                  1239 03687000
*         IF FRAMEDT(X) = LRTDT THEN /*IF TABLE DATE EQUALS RECORD DAT* 03688000
         L     @08,X                                               1239 03689000
         MH    @08,@CH00227                                        1239 03690000
         L     @06,FRAMEPTR(,R2)                                   1239 03691000
         ST    @08,@TF00001                                        1239 03692000
         ALR   @08,@06                                             1239 03693000
         AL    @08,@CF01519                                        1239 03694000
         CLC   FRAMEDT-9(8,@08),LRTDT(R7)                          1239 03695000
         BNE   @RF01239                                            1239 03696000
*           DO;                                            /*@G51DGBB*/ 03697000
*            IF FRAMETYP(X) ^= ALLALL THEN                         1241 03698000
         AL    @06,@TF00001                                        1241 03699000
         AL    @06,@CF01502                                        1241 03700000
         CLI   FRAMETYP-17(@06),X'FF'                              1241 03701000
         BE    @RF01241                                            1241 03702000
*             DO;                                          /*@G51DGBB*/ 03703000
*                      CALL FIXENTRY; /*DELETE INCOMPLETE SET       */  03704000
         BAL   @14,FIXENTRY                                        1243 03705000
*                      MSGNO = 79; /*ISSUE FRAME SET INCOMPLETE MESS*/  03706000
         MVI   MSGNO,X'4F'                                         1244 03707000
*                      CALL ERRMSG;                        /*@G51DGBB*/ 03708000
         BAL   @14,ERRMSG                                          1245 03709000
*                      CALL BUILDTTR; /*SAVE THIS FRAME      @G51DGBB*/ 03710000
         BAL   @14,BUILDTTR                                        1246 03711000
*                      FRAMEYES = YES; /*SAVE SUCCEEDING MEMBERS */     03712000
         OI    FRAMEYES,B'00000010'                                1247 03713000
*             END;                                         /*@G51DGBB*/ 03714000
*            ELSE  /*COMPLETE SET FOR THIS DATE ALREADY EXISTS      */  03715000
*               DO; /*FRAMETYP IS EQUAL TO ALLALL            @G51DGBB*/ 03716000
         B     @RC01241                                            1249 03717000
@RF01241 DS    0H                                                  1250 03718000
*                   FRAMEYES = NO;/*DELETE SUCCEEDING FRAMES OF SET */  03719000
         NI    FRAMEYES,B'11111101'                                1250 03720000
*                   BUG(30) = BUG(30) + 1; /*COUNT FRAME AS NOT USED*/  03721000
         LA    @08,1                                               1251 03722000
         AL    @08,BUG+116                                         1251 03723000
         ST    @08,BUG+116                                         1251 03724000
*               END;                                       /*@G51DGBB*/ 03725000
*        END; /*END OF CODE IF DATE IN RECORD EQUALS DATE IN TABLE*/    03726000
*       ELSE /*DATE IN TABLE GREATER THAN FRAME RECORD DATE  @G51DGBB*/ 03727000
*        BUG(30) = BUG(30)  + 1;                           /*@G51DGBB*/ 03728000
         B     @RC01239                                            1254 03729000
@RF01239 LA    @08,1                                               1254 03730000
         AL    @08,BUG+116                                         1254 03731000
         ST    @08,BUG+116                                         1254 03732000
*    END; /*END OF CODE IF DATE IN RECORD IS LOW OR EQUAL    @G51DGBB*/ 03733000
@RC01239 DS    0H                                                  1256 03734000
*  GETOUT = YES; /*GET OUT OF LOOP AFTER CPU MATCH           @G51DGBB*/ 03735000
@RC01231 OI    GETOUT,B'00001000'                                  1256 03736000
* END; /*END OF CODE FOR A RECORD TO ENTRY CPU MATCH         @G51DGBB*/ 03737000
*END; /*END OF FRAMETAB LOOP                                 @G51DGBB*/ 03738000
@RF01228 LA    @08,1                                               1258 03739000
         AL    @08,X                                               1258 03740000
         ST    @08,X                                               1258 03741000
@DE01227 L     @06,FRAMEPTR(,R2)                                   1258 03742000
         C     @08,FRAMENUM(,@06)                                  1258 03743000
         BNH   @DL01227                                            1258 03744000
@DC01227 DS    0H                                                  1259 03745000
*IF GETOUT = NO THEN /*MERIDIAN FRAME BUT NO ROOM IN TABLE   @G51DGBB*/ 03746000
         TM    GETOUT,B'00001000'                                  1259 03747000
         BNZ   @RF01259                                            1259 03748000
*  BUG(30) = BUG(30) + 1;                                  /*@G51DGBB*/ 03749000
         LA    @08,1                                               1260 03750000
         AL    @08,BUG+116                                         1260 03751000
         ST    @08,BUG+116                                         1260 03752000
*END; /*END OF PROC FRAMEREP                                 @G51DGBB*/ 03753000
@EL00029 DS    0H                                                  1261 03754000
@EF00029 DS    0H                                                  1261 03755000
@ER00029 LM    @14,@12,@SA00029                                    1261 03756000
         BR    @14                                                 1261 03757000
*BUILDTTR: PROC; /*SAVE LOCATION OF A FRAME IN LISTLOC       @G51DGBB*/ 03758000
BUILDTTR STM   @14,@12,@SA00030                                    1262 03759000
*RESPECIFY (R0,R1,R4,R15) RESTRICTED;                      /*@G51DGBB*/ 03760000
*IF (LRTKEY1 & GENREC) = HEXA0 THEN /* IF MCH FRAME          @G51DGBB*/ 03761000
         MVC   @TS00001(1),LRTKEY1(R7)                             1264 03762000
         NI    @TS00001,X'F0'                                      1264 03763000
         CLI   @TS00001,X'A0'                                      1264 03764000
         BNE   @RF01264                                            1264 03765000
*  DO;                                                     /*@G51DGBB*/ 03766000
*    IF FRAMLOCM(CCHINDX) = ZERO THEN /*IF LISTLOC CORE FOR A CPU*/     03767000
         L     @14,CCHINDX                                         1266 03768000
         MH    @14,@CH00227                                        1266 03769000
         L     @08,FRAMEPTR(,R2)                                   1266 03770000
         AL    @08,@CF01512                                        1266 03771000
         L     @14,FRAMLOCM-20(@14,@08)                            1266 03772000
         LTR   @14,@14                                             1266 03773000
         BNZ   @RF01266                                            1266 03774000
*      DO;                            /*IS UNALLOCATED       @G51DGBB*/ 03775000
*        R0 = LISTBENT * LISTMAX * 2; /*ALLOCATE CORE FOR BOTH CCH*/    03776000
         LA    R0,500                                              1268 03777000
*        R0 = R0 + 12;                /*AND MCH FRAME LOCATIONS   */    03778000
         AL    R0,@CF00032                                         1269 03779000
*        GEN(GETMAIN EC,LV=(0),A=TMPSTORE,SP=21); /*GET STORAGE*/  1270 03780000
         GETMAIN EC,LV=(0),A=TMPSTORE,SP=21                             03781000
*        IF R15 = SUCCESS THEN                                     1271 03782000
         LTR   R15,R15                                             1271 03783000
         BNZ   @RF01271                                            1271 03784000
*          DO;                                             /*@G51DGBB*/ 03785000
*            R1 = TMPSTORE;           /*SET STORAGE ADDRESS IN REG 1*/  03786000
         L     R1,TMPSTORE                                         1273 03787000
*            FRAMLOCM(CCHINDX) = R1;  /*SET POINTERS TO LISTLOC   */    03788000
         L     @14,CCHINDX                                         1274 03789000
         MH    @14,@CH00227                                        1274 03790000
         L     @08,FRAMEPTR(,R2)                                   1274 03791000
         AL    @08,@CF01512                                        1274 03792000
         ST    R1,FRAMLOCM-20(@14,@08)                             1274 03793000
*            R1 = R1+LISTBENT *       /*TABLES FOR BOTH CCL AND MCH*/   03794000
*                LISTMAX+4;           /*FRAMES               @G51DGBB*/ 03795000
         AL    R1,@CF01495                                         1275 03796000
*            R0 = ZERO;          /*ENSURE THAT TABLE ON WORD BOUNDARY*/ 03797000
         SLR   R0,R0                                               1276 03798000
*            R4 = 4;             /*DIVIDE BY NUMBER OF BYTES IN WORD*/  03799000
         LA    R4,4                                                1277 03800000
*            GEN(DR R0,R4);                                /*@G51DGBB*/ 03801000
         DR R0,R4                                                       03802000
*            IF R0 > ZERO THEN /*REMAINDER MEANS NOT INTEGRAL NUMBER*/  03803000
         LTR   R0,R0                                               1279 03804000
         BNP   @RF01279                                            1279 03805000
*                              /*NUMBER OF DOUBLEWORDS.      @G51DGBB*/ 03806000
*              R1 = R1 + 1; /*ADD ONE EXTRA FULL WORD        @G51DGBB*/ 03807000
         AL    R1,@CF00055                                         1280 03808000
*            R1 = R1 * FOUR; /*RESET ONE TO NUMBER OF BYTES  @G51DGBB*/ 03809000
@RF01279 SLL   R1,2                                                1281 03810000
*            FRAMLOCC(CCHINDX) = R1; /*SET POINTER TO CCH CCHHR TABLE*/ 03811000
         L     @14,CCHINDX                                         1282 03812000
         MH    @14,@CH00227                                        1282 03813000
         L     @08,FRAMEPTR(,R2)                                   1282 03814000
         ST    R1,FRAMLOCC-24(@14,@08)                             1282 03815000
*            LISTPTR = R1;      /*ESTABLISH ADDRESSABILITY FOR CCH TB*/ 03816000
         ST    R1,LISTPTR                                          1283 03817000
*            LISTNUM = ZERO;    /*ZERO CCH LISTLOC TABLE     @G51DGBB*/ 03818000
         L     @14,LISTPTR                                         1284 03819000
         SLR   @08,@08                                             1284 03820000
         ST    @08,LISTNUM(,@14)                                   1284 03821000
*            DO Y = 1 BY 1 TO LISTMAX;                     /*@G51DGBB*/ 03822000
         LA    @14,1                                               1285 03823000
         ST    @14,Y                                               1285 03824000
@DL01285 DS    0H                                                  1286 03825000
*              LISTCCHR(Y) = LISTCCHR(Y) &&                        1286 03826000
*                            LISTCCHR(Y);                  /*@G51DGBB*/ 03827000
         LR    @08,@14                                             1286 03828000
         MH    @08,@CH00079                                        1286 03829000
         L     @06,LISTPTR                                         1286 03830000
         ALR   @06,@08                                             1286 03831000
         BCTR  @06,0                                               1286 03832000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1286 03833000
*            END;                                          /*@G51DGBB*/ 03834000
         AL    @14,@CF00055                                        1287 03835000
         ST    @14,Y                                               1287 03836000
         C     @14,@CF00293                                        1287 03837000
         BNH   @DL01285                                            1287 03838000
*            LISTPTR = FRAMLOCM(CCHINDX); /*ADDRESS OF MCH LISTLOC */   03839000
         L     @14,CCHINDX                                         1288 03840000
         MH    @14,@CH00227                                        1288 03841000
         L     @08,FRAMEPTR(,R2)                                   1288 03842000
         AL    @08,@CF01512                                        1288 03843000
         L     @14,FRAMLOCM-20(@14,@08)                            1288 03844000
         ST    @14,LISTPTR                                         1288 03845000
*            DO Y = 1 BY 1 TO LISTMAX;   /* ZERO MCH LISTLOC TABLE  */  03846000
         LA    @14,1                                               1289 03847000
         ST    @14,Y                                               1289 03848000
@DL01289 DS    0H                                                  1290 03849000
*            LISTCCHR(Y) = LISTCCHR(Y) &&                          1290 03850000
*                          LISTCCHR(Y);                    /*@G51DGBB*/ 03851000
         LR    @08,@14                                             1290 03852000
         MH    @08,@CH00079                                        1290 03853000
         L     @06,LISTPTR                                         1290 03854000
         ALR   @06,@08                                             1290 03855000
         BCTR  @06,0                                               1290 03856000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1290 03857000
*            END;                                          /*@G51DGBB*/ 03858000
         AL    @14,@CF00055                                        1291 03859000
         ST    @14,Y                                               1291 03860000
         C     @14,@CF00293                                        1291 03861000
         BNH   @DL01289                                            1291 03862000
*            LISTNUM = ZERO;                               /*@G51DGBB*/ 03863000
         L     @14,LISTPTR                                         1292 03864000
         SLR   @08,@08                                             1292 03865000
         ST    @08,LISTNUM(,@14)                                   1292 03866000
*          END;                                            /*@G51DGBB*/ 03867000
*        ELSE /*UNSUCCESSFUL GETMAIN                         @G51DGBB*/ 03868000
*          DO;                                             /*@G51DGBB*/ 03869000
         B     @RC01271                                            1294 03870000
@RF01271 DS    0H                                                  1295 03871000
*            MSGNO = 40;                                   /*@G51DGBB*/ 03872000
         MVI   MSGNO,X'28'                                         1295 03873000
*            CALL ERRMSG;                                  /*@G51DGBB*/ 03874000
         BAL   @14,ERRMSG                                          1296 03875000
*            R15 = TWELVE;                                 /*@G51DGBB*/ 03876000
         LA    @08,12                                              1297 03877000
         LR    R15,@08                                             1297 03878000
*            ERROR = TWELVE;                               /*@G51DGBB*/ 03879000
         ST    @08,ERROR                                           1298 03880000
*          END;                                            /*@G51DGBB*/ 03881000
*      END;                                                /*@G51DGBB*/ 03882000
@RC01271 DS    0H                                                  1301 03883000
*    IF R15 = ZERO THEN /*IF GETMAIN WAS SUCCESSFUL OR NO GETMAIN*/     03884000
@RF01266 LTR   R15,R15                                             1301 03885000
         BNZ   @RF01301                                            1301 03886000
*      LISTPTR = FRAMLOCM(CCHINDX);/*ESTABLISH LISTLOC ADDRESS   */     03887000
         L     @14,CCHINDX                                         1302 03888000
         MH    @14,@CH00227                                        1302 03889000
         L     @08,FRAMEPTR(,R2)                                   1302 03890000
         AL    @08,@CF01512                                        1302 03891000
         L     @14,FRAMLOCM-20(@14,@08)                            1302 03892000
         ST    @14,LISTPTR                                         1302 03893000
*  END;                                                    /*@G51DGBB*/ 03894000
*ELSE /* IS A CCH FRAME                                      @G51DGBB*/ 03895000
*    LISTPTR = FRAMLOCC(CCHINDX);  /*ESTABLISH CCH LISTLOC ADDRESS*/    03896000
         B     @RC01264                                            1304 03897000
@RF01264 L     @14,CCHINDX                                         1304 03898000
         MH    @14,@CH00227                                        1304 03899000
         L     @08,FRAMEPTR(,R2)                                   1304 03900000
         L     @14,FRAMLOCC-24(@14,@08)                            1304 03901000
         ST    @14,LISTPTR                                         1304 03902000
*IF ERROR = ZERO THEN                                              1305 03903000
@RC01264 L     @14,ERROR                                           1305 03904000
         LTR   @14,@14                                             1305 03905000
         BNZ   @RF01305                                            1305 03906000
*  DO;                                                     /*@G51DGBB*/ 03907000
*    IF LISTNUM + 1 <= LISTMAX THEN /*IF ROOM IN LISTLOC     @G51DGBB*/ 03908000
         LA    @14,1                                               1307 03909000
         L     @08,LISTPTR                                         1307 03910000
         AL    @14,LISTNUM(,@08)                                   1307 03911000
         C     @14,@CF00293                                        1307 03912000
         BH    @RF01307                                            1307 03913000
*      DO;                                                 /*@G51DGBB*/ 03914000
*        RESPECIFY (R1) UNRESTRICTED;                      /*@G51DGBB*/ 03915000
*        IF PHIST = ON THEN        /*IF HISTORY INPUT        @G51DGBB*/ 03916000
         TM    PHIST(R2),B'00100000'                               1310 03917000
         BNO   @RF01310                                            1310 03918000
*          CALL IOHND(RITESCRT);   /*WRITE TO SCRATCH DATA SET*/   1311 03919000
         L     @15,ADIOHND(,R2)                                    1311 03920000
         LA    @01,@AL01311                                        1311 03921000
         BALR  @14,@15                                             1311 03922000
*        IF R15 = SUCCESS THEN     /*IF SUCCESSFULL WRITE    @G51DGBB*/ 03923000
@RF01310 LTR   R15,R15                                             1312 03924000
         BNZ   @RF01312                                            1312 03925000
*          DO;                                             /*@G51DGBB*/ 03926000
*            LISTCCHR(LISTNUM+1) = RECCCHHR;/*SAVE FRAME EXTERNAL LOC*/ 03927000
         L     @14,LISTPTR                                         1314 03928000
         L     @08,LISTNUM(,@14)                                   1314 03929000
         LR    @06,@08                                             1314 03930000
         MH    @06,@CH00079                                        1314 03931000
         ALR   @06,@14                                             1314 03932000
         MVC   LISTCCHR(5,@06),RECCCHHR(R2)                        1314 03933000
*            LISTNUM = LISTNUM + 1; /*INCREMENT NO OF BUILT ENTRIES*/   03934000
         LA    @06,1                                               1315 03935000
         ALR   @08,@06                                             1315 03936000
         ST    @08,LISTNUM(,@14)                                   1315 03937000
*            BUG(29) = BUG(29) + 1; /*COUNT NUMBER OF USED FRAMES*/     03938000
         AL    @06,BUG+112                                         1316 03939000
         ST    @06,BUG+112                                         1316 03940000
*          END;                                            /*@G51DGBB*/ 03941000
*        ELSE  /*UNSUCCESSFUL WRITE TO SCRATCH D.S.          @G51DGBB*/ 03942000
*          R15 = TWELVE; /*TERMINATE FURTHER PROCESSING      @G51DGBB*/ 03943000
         B     @RC01312                                            1318 03944000
@RF01312 LA    R15,12                                              1318 03945000
*      END;                                                /*@G51DGBB*/ 03946000
@RC01312 DS    0H                                                  1320 03947000
*  END;                                                    /*@G51DGBB*/ 03948000
@RF01307 DS    0H                                                  1321 03949000
*ERROR = R15;                                              /*@G51DGBB*/ 03950000
@RF01305 ST    R15,ERROR                                           1321 03951000
*RESPECIFY (R0,R4,R15) UNRESTRICTED;                       /*@G51DGBB*/ 03952000
*END; /*END OF BUILDTTR PROC                                 @G51DGBB*/ 03953000
@EL00030 DS    0H                                                  1323 03954000
@EF00030 DS    0H                                                  1323 03955000
@ER00030 LM    @14,@12,@SA00030                                    1323 03956000
         BR    @14                                                 1323 03957000
*FIXENTRY: PROC;  /*RESET LISTLOC TABLE TO ZEROS BUT DONT FREE CORE*/   03958000
FIXENTRY STM   @14,@12,12(@13)                                     1324 03959000
*                 /*RESET DATE,TYPE TO ZEROS                 @G51DGBB*/ 03960000
*FRAMEDT(CCHINDX) = '0000000000000000'X; /*ZERO DATE,TIME    @G51DGBB*/ 03961000
         L     @08,CCHINDX                                         1325 03962000
         MH    @08,@CH00227                                        1325 03963000
         L     @06,FRAMEPTR(,R2)                                   1325 03964000
         ST    @08,@TF00001                                        1325 03965000
         ALR   @08,@06                                             1325 03966000
         AL    @08,@CF01519                                        1325 03967000
         MVC   FRAMEDT-9(8,@08),@CB01473                           1325 03968000
*FRAMETYP(CCHINDX) = '00'X; /*RESET TO NO TYPES OF FRAMES STORED*/ 1326 03969000
         LR    @08,@06                                             1326 03970000
         AL    @08,@TF00001                                        1326 03971000
         AL    @08,@CF01502                                        1326 03972000
         MVI   FRAMETYP-17(@08),X'00'                              1326 03973000
*IF FRAMLOCM(CCHINDX) > ZERO THEN /*IF MCH FRAME LOC. TAB. ALLOCATED*/  03974000
         L     @08,@TF00001                                        1327 03975000
         AL    @06,@CF01512                                        1327 03976000
         L     @08,FRAMLOCM-20(@08,@06)                            1327 03977000
         LTR   @08,@08                                             1327 03978000
         BNP   @RF01327                                            1327 03979000
*  DO;                                                     /*@G51DGBB*/ 03980000
*    LISTPTR = FRAMLOCM(CCHINDX); /*SET TABLE BASE ADDRESS   @G51DGBB*/ 03981000
         ST    @08,LISTPTR                                         1329 03982000
*    DO Y = 1 BY 1 TO LISTNUM; /*CLEAR ALL STORED CCHHRS TO ZERO*/ 1330 03983000
         LA    @08,1                                               1330 03984000
         ST    @08,Y                                               1330 03985000
         B     @DE01330                                            1330 03986000
@DL01330 DS    0H                                                  1331 03987000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGBB*/ 03988000
         LR    @06,@08                                             1331 03989000
         MH    @06,@CH00079                                        1331 03990000
         L     @01,LISTPTR                                         1331 03991000
         ALR   @01,@06                                             1331 03992000
         BCTR  @01,0                                               1331 03993000
         XC    LISTCCHR-4(5,@01),LISTCCHR-4(@01)                   1331 03994000
*      BUG(30) = BUG(30) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1332 03995000
         LA    @06,1                                               1332 03996000
         AL    @06,BUG+116                                         1332 03997000
         ST    @06,BUG+116                                         1332 03998000
*      BUG(29) = BUG(29) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRMES*/ 03999000
         L     @06,BUG+112                                         1333 04000000
         BCTR  @06,0                                               1333 04001000
         ST    @06,BUG+112                                         1333 04002000
*    END;                                                  /*@G51DGBB*/ 04003000
         AL    @08,@CF00055                                        1334 04004000
         ST    @08,Y                                               1334 04005000
@DE01330 L     @06,LISTPTR                                         1334 04006000
         C     @08,LISTNUM(,@06)                                   1334 04007000
         BNH   @DL01330                                            1334 04008000
*    LISTNUM = ZERO; /*SET NUMBER OF STORED CCHHRS TO ZERO   @G51DGBB*/ 04009000
         L     @08,LISTPTR                                         1335 04010000
         SLR   @06,@06                                             1335 04011000
         ST    @06,LISTNUM(,@08)                                   1335 04012000
*  END;                                                    /*@G51DGBB*/ 04013000
*IF FRAMLOCC(CCHINDX) > ZERO THEN /*IF CCH FRAM LOC TABLE ALLOCATED*/   04014000
@RF01327 L     @08,CCHINDX                                         1337 04015000
         MH    @08,@CH00227                                        1337 04016000
         L     @06,FRAMEPTR(,R2)                                   1337 04017000
         L     @08,FRAMLOCC-24(@08,@06)                            1337 04018000
         LTR   @08,@08                                             1337 04019000
         BNP   @RF01337                                            1337 04020000
*  DO;                                                     /*@G51DGBB*/ 04021000
*    LISTPTR = FRAMLOCC(CCHINDX); /*SET BASE ADDRESS OF LISTLOC*/  1339 04022000
         ST    @08,LISTPTR                                         1339 04023000
*    DO Y = 1 BY 1 TO LISTNUM; /*ZERO ALL SAVED CCHHRS       @G51DGBB*/ 04024000
         LA    @08,1                                               1340 04025000
         ST    @08,Y                                               1340 04026000
         B     @DE01340                                            1340 04027000
@DL01340 DS    0H                                                  1341 04028000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGBB*/ 04029000
         LR    @06,@08                                             1341 04030000
         MH    @06,@CH00079                                        1341 04031000
         L     @01,LISTPTR                                         1341 04032000
         ALR   @01,@06                                             1341 04033000
         BCTR  @01,0                                               1341 04034000
         XC    LISTCCHR-4(5,@01),LISTCCHR-4(@01)                   1341 04035000
*      BUG(30) = BUG(30) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1342 04036000
         LA    @06,1                                               1342 04037000
         AL    @06,BUG+116                                         1342 04038000
         ST    @06,BUG+116                                         1342 04039000
*      BUG(29) = BUG(29) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRAMES* 04040000
         L     @06,BUG+112                                         1343 04041000
         BCTR  @06,0                                               1343 04042000
         ST    @06,BUG+112                                         1343 04043000
*    END;                                                  /*@G51DGBB*/ 04044000
         AL    @08,@CF00055                                        1344 04045000
         ST    @08,Y                                               1344 04046000
@DE01340 L     @06,LISTPTR                                         1344 04047000
         C     @08,LISTNUM(,@06)                                   1344 04048000
         BNH   @DL01340                                            1344 04049000
*    LISTNUM = ZERO; /*SET NUMBER OF  CCHHRS SAVED TO ZERO   @G51DGBB*/ 04050000
         L     @08,LISTPTR                                         1345 04051000
         SLR   @06,@06                                             1345 04052000
         ST    @06,LISTNUM(,@08)                                   1345 04053000
*  END;                                                    /*@G51DGBB*/ 04054000
*END;                                                      /*@G51DGBB*/ 04055000
@EL00031 DS    0H                                                  1347 04056000
@EF00031 DS    0H                                                  1347 04057000
@ER00031 LM    @14,@12,12(@13)                                     1347 04058000
         BR    @14                                                 1347 04059000
*FLIMFRAM: PROC; /*PROCESS FRAME RECORDS SEQUENTIALLY        @G51DGBB*/ 04060000
FLIMFRAM STM   @14,@12,@SA00032                                    1348 04061000
*RESPECIFY (R15) RESTRICTED;                               /*@G51DGBB*/ 04062000
*   IF PACC = ON &                 /* IF NO ACCUMULATION OR NO  */ 1350 04063000
*     (PMCH = ON | PCHAN = ON) THEN /* MCH OR CCH SELECTION THEN */     04064000
         TM    PACC(R2),B'01000000'                                1350 04065000
         BNO   @RF01350                                            1350 04066000
         TM    PMCH(R2),B'11000000'                                1350 04067000
         BZ    @RF01350                                            1350 04068000
*    DO;                            /* DONT SELECT FRAMES    @G51DGBB*/ 04069000
*      IF LRTCNT = ONE &            /* IF FIRST PHYSICAL FRAME   */     04070000
*         (LRTKEY1 & GENREC) = HEXA0 THEN /*IS MCH FRAME WHICH MUST*/   04071000
         CLI   LRTCNT(R7),1                                        1352 04072000
         BNE   @RF01352                                            1352 04073000
         MVC   @TS00001(1),LRTKEY1(R7)                             1352 04074000
         NI    @TS00001,X'F0'                                      1352 04075000
         CLI   @TS00001,X'A0'                                      1352 04076000
         BNE   @RF01352                                            1352 04077000
*        DO;                         /*BE INPUT BEFORE CCH FRAMES*/     04078000
*          SAVESEQ = ONE;           /* RESET SEQUENCE CHECK  @G51DGBB*/ 04079000
         MVI   SAVESEQ,X'01'                                       1354 04080000
*          CALL FRAMEREP;           /* SEE IF THIS FRAME SET MUST*/     04081000
         BAL   @14,FRAMEREP                                        1355 04082000
*          R15 = ERROR;             /* BE SAVED              @G51DGBB*/ 04083000
         L     R15,ERROR                                           1356 04084000
*          IF LRTNLAST = OFF &      /*IF ONLY ONE MCH FRAME  @G51DGBB*/ 04085000
*             FRAMEYES = ON  &      /*FRAME SET TO BE SAVED  @G51DGBB*/ 04086000
*             R15 = ZERO THEN       /*NO ERROR CONDITIONS    @G51DGBB*/ 04087000
         TM    LRTNLAST(R7),B'10000000'                            1357 04088000
         BNZ   @RF01357                                            1357 04089000
         TM    FRAMEYES,B'00000010'                                1357 04090000
         BNO   @RF01357                                            1357 04091000
         LTR   R15,R15                                             1357 04092000
         BNZ   @RF01357                                            1357 04093000
*            DO;                                           /*@G51DGBB*/ 04094000
*              FRAMETYP(CCHINDX) = ALLMCH; /*ALL MCH FRAMES ARE IN*/    04095000
         L     @14,CCHINDX                                         1359 04096000
         MH    @14,@CH00227                                        1359 04097000
         L     @08,FRAMEPTR(,R2)                                   1359 04098000
         ALR   @08,@14                                             1359 04099000
         AL    @08,@CF01502                                        1359 04100000
         MVI   FRAMETYP-17(@08),X'02'                              1359 04101000
*              SAVESEQ = ZERO;      /*REINITIALIZE FOR CCH S @G51DGBB*/ 04102000
         MVI   SAVESEQ,X'00'                                       1360 04103000
*            END;                                          /*@G51DGBB*/ 04104000
*        END;                                              /*@G51DGBB*/ 04105000
*      ELSE                         /* NON-FIRST FRAME       @G51DGBB*/ 04106000
*        DO;                                               /*@G51DGBB*/ 04107000
         B     @RC01352                                            1363 04108000
@RF01352 DS    0H                                                  1364 04109000
*          IF FRAMEYES = ON THEN    /* IF FRAME IS TO BE SAVED  */ 1364 04110000
         TM    FRAMEYES,B'00000010'                                1364 04111000
         BNO   @RF01364                                            1364 04112000
*            DO;                                           /*@G51DGBB*/ 04113000
*              SAVESEQ = SAVESEQ + 1;  /* UP SEQ CHECK       @G51DGBB*/ 04114000
         IC    @14,SAVESEQ                                         1366 04115000
         LA    @14,1(,@14)                                         1366 04116000
         STC   @14,SAVESEQ                                         1366 04117000
*              IF SAVESEQ = LRTCNT THEN /* IF RECORD NOT MISSING */     04118000
         CLC   SAVESEQ(1),LRTCNT(R7)                               1367 04119000
         BNE   @RF01367                                            1367 04120000
*                DO;                                       /*@G51DGBB*/ 04121000
*                  CALL BUILDTTR;    /* BUILD EXTERNAL LOCATION */ 1369 04122000
         BAL   @14,BUILDTTR                                        1369 04123000
*                  R15 = ERROR;                            /*@G51DGBB*/ 04124000
         L     R15,ERROR                                           1370 04125000
*                  IF R15 = ZERO THEN  /* IF FRAME EXTERNAL LOC  */     04126000
         LTR   R15,R15                                             1371 04127000
         BNZ   @RF01371                                            1371 04128000
*                    DO;               /* SUCCESSFULLY SAVED @G51DGBB*/ 04129000
*                      IF LRTNLAST = OFF THEN /* IF LAST FRAME  */ 1373 04130000
         TM    LRTNLAST(R7),B'10000000'                            1373 04131000
         BNZ   @RF01373                                            1373 04132000
*                        DO;                               /*@G51DGBB*/ 04133000
*                          IF (LRTKEY1 & GENREC) = HEXA0 THEN      1375 04134000
         MVC   @TS00001(1),LRTKEY1(R7)                             1375 04135000
         NI    @TS00001,X'F0'                                      1375 04136000
         CLI   @TS00001,X'A0'                                      1375 04137000
         BNE   @RF01375                                            1375 04138000
*                           DO;                            /*@G51DGBB*/ 04139000
*                            SAVESEQ = ZERO;               /*@G51DGBB*/ 04140000
         MVI   SAVESEQ,X'00'                                       1377 04141000
*                            FRAMETYP(CCHINDX) = ALLMCH;   /*@G51DGBB*/ 04142000
         L     @14,CCHINDX                                         1378 04143000
         MH    @14,@CH00227                                        1378 04144000
         L     @08,FRAMEPTR(,R2)                                   1378 04145000
         ALR   @08,@14                                             1378 04146000
         AL    @08,@CF01502                                        1378 04147000
         MVI   FRAMETYP-17(@08),X'02'                              1378 04148000
*                           END;                           /*@G51DGBB*/ 04149000
*                          /*IF ALL MCH FRAMES HAVE BEEN SAVED,  */     04150000
*                          /*THEN INDICATE SUCH              @G51DGBB*/ 04151000
*                           ELSE                  /*IS CCH FRAME */     04152000
*                            DO;                           /*@G51DGBB*/ 04153000
         B     @RC01375                                            1380 04154000
@RF01375 DS    0H                                                  1381 04155000
*                            FRAMEYES = OFF;               /*@G51DGBB*/ 04156000
         NI    FRAMEYES,B'11111101'                                1381 04157000
*                            IF FRAMETYP(CCHINDX) ^= ALLMCH THEN   1382 04158000
         L     @14,CCHINDX                                         1382 04159000
         MH    @14,@CH00227                                        1382 04160000
         L     @08,FRAMEPTR(,R2)                                   1382 04161000
         ALR   @08,@14                                             1382 04162000
         AL    @08,@CF01502                                        1382 04163000
         CLI   FRAMETYP-17(@08),X'02'                              1382 04164000
         BE    @RF01382                                            1382 04165000
*                              DO; /*IF MISSING LAST MCH FRAME   */     04166000
*                                MSGNO = 79; /*FRAME SET INCOMPLET MSG* 04167000
         MVI   MSGNO,X'4F'                                         1384 04168000
*                                CALL ERRMSG;              /*@G51DGBB*/ 04169000
         BAL   @14,ERRMSG                                          1385 04170000
*                                CALL FIXENTRY; /*DELETE INCOM-  */     04171000
         BAL   @14,FIXENTRY                                        1386 04172000
*                              END;             /*PLETE SET. @G51DGBB*/ 04173000
*                            ELSE   /*IS COMPLETE SET -INDICATE  */     04174000
*                              FRAMETYP(CCHINDX) = ALLALL; /*IT IS*/    04175000
         B     @RC01382                                            1388 04176000
@RF01382 L     @14,CCHINDX                                         1388 04177000
         MH    @14,@CH00227                                        1388 04178000
         L     @08,FRAMEPTR(,R2)                                   1388 04179000
         ALR   @08,@14                                             1388 04180000
         AL    @08,@CF01502                                        1388 04181000
         MVI   FRAMETYP-17(@08),X'FF'                              1388 04182000
*                            END;                          /*@G51DGBB*/ 04183000
*                        END;                              /*@G51DGBB*/ 04184000
*                   END;                                   /*@G51DGBB*/ 04185000
*              END;                                        /*@G51DGBB*/ 04186000
*            ELSE   /*MISSING MIDDLE FRAME                   @G51DGBB*/ 04187000
*              DO;                                         /*@G51DGBB*/ 04188000
         B     @RC01367                                            1393 04189000
@RF01367 DS    0H                                                  1394 04190000
*                MSGNO = 79; /*FRAME SET INCOMPLETE          @G51DGBB*/ 04191000
         MVI   MSGNO,X'4F'                                         1394 04192000
*                CALL ERRMSG;                              /*@G51DGBB*/ 04193000
         BAL   @14,ERRMSG                                          1395 04194000
*                FRAMEYES = OFF; /*DONT SAVE INCOMPLETE SET  @G51DGBB*/ 04195000
         NI    FRAMEYES,B'11111101'                                1396 04196000
*                CALL FIXENTRY; /*DELETE REFS TO INCOMPLETE SET*/  1397 04197000
         BAL   @14,FIXENTRY                                        1397 04198000
*                BUG(30) = BUG(30) + 1;                    /*@G51DGBB*/ 04199000
         LA    @14,1                                               1398 04200000
         AL    @14,BUG+116                                         1398 04201000
         ST    @14,BUG+116                                         1398 04202000
*              END;                                        /*@G51DGBB*/ 04203000
*       END;                                               /*@G51DGBB*/ 04204000
*          ELSE      /*FRAME NOT TO BE SAVED                 @G51DGBB*/ 04205000
*            BUG(30) = BUG(30) + 1;                        /*@G51DGBB*/ 04206000
         B     @RC01364                                            1401 04207000
@RF01364 LA    @14,1                                               1401 04208000
         AL    @14,BUG+116                                         1401 04209000
         ST    @14,BUG+116                                         1401 04210000
*      END;                                                /*@G51DGBB*/ 04211000
*   END;                                                   /*@G51DGBB*/ 04212000
*  ELSE   /*NOT ACCUMULATING OR SELECTING MCH OR CCH RECORDS @G51DGBB*/ 04213000
*    BUG(30) = BUG(30) + 1; /*COUNT FRAMES REJECTED          @G51DGBB*/ 04214000
         B     @RC01350                                            1404 04215000
@RF01350 LA    @14,1                                               1404 04216000
         AL    @14,BUG+116                                         1404 04217000
         ST    @14,BUG+116                                         1404 04218000
*RESPECIFY (R15) UNRESTRICTED;                             /*@G51DGBB*/ 04219000
*END;  /*END OF PROC FLIMFRAM                                @G51DGBB*/ 04220000
@EL00032 DS    0H                                                  1406 04221000
@EF00032 DS    0H                                                  1406 04222000
@ER00032 LM    @14,@12,@SA00032                                    1406 04223000
         BR    @14                                                 1406 04224000
*END  /*CLOSING END TO IFCFILT2 EXTERNAL PROC                @Z427VLS*/ 04225000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 04226000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 04227000
*;                                                                 1407 04228000
@DATA    DS    0H                                                       04229000
@CH00079 DC    H'5'                                                     04230000
@CH00081 DC    H'6'                                                     04231000
@CH00083 DC    H'7'                                                     04232000
@CH00033 DC    H'11'                                                    04233000
@CH01491 DC    H'63'                                                    04234000
         DS    0F                                                       04235000
@AL00197 EQU   *                       LIST WITH   1 ARGUMENT(S)        04236000
@AL00384 EQU   *                       LIST WITH   1 ARGUMENT(S)        04237000
@AL00991 EQU   *                       LIST WITH   1 ARGUMENT(S)        04238000
@AL01004 EQU   *                       LIST WITH   1 ARGUMENT(S)        04239000
@AL01178 EQU   *                       LIST WITH   1 ARGUMENT(S)        04240000
@AL01183 EQU   *                       LIST WITH   1 ARGUMENT(S)        04241000
@AL01198 DC    A(@CF00074+2)           LIST WITH   1 ARGUMENT(S)        04242000
@AL00204 DC    A(@CF00076+2)           LIST WITH   1 ARGUMENT(S)        04243000
@AL00224 EQU   *                       LIST WITH   1 ARGUMENT(S)        04244000
@AL00952 EQU   *                       LIST WITH   1 ARGUMENT(S)        04245000
@AL00961 DC    A(@CF00064+2)           LIST WITH   1 ARGUMENT(S)        04246000
@AL00774 DC    A(@CF00076)             LIST WITH   3 ARGUMENT(S)        04247000
         DC    A(WORKDEV)                                               04248000
         DC    A(LINKDEV)                                               04249000
@AL00914 EQU   *                       LIST WITH   1 ARGUMENT(S)        04250000
@AL00926 EQU   *                       LIST WITH   1 ARGUMENT(S)        04251000
@AL00942 DC    A(@CH00083)             LIST WITH   1 ARGUMENT(S)        04252000
@AL00950 EQU   *                       LIST WITH   1 ARGUMENT(S)        04253000
@AL00959 DC    A(@CH00081)             LIST WITH   1 ARGUMENT(S)        04254000
@AL00989 DC    A(@CF01432)             LIST WITH   2 ARGUMENT(S)        04255000
         DC    A(@AFTEMPS)                                              04256000
@AL01002 DC    A(@CF01433)             LIST WITH   2 ARGUMENT(S)        04257000
         DC    A(@AFTEMPS)                                              04258000
@AL01132 DC    A(@CF01450)             LIST WITH   2 ARGUMENT(S)        04259000
         DC    A(@AFTEMPS+4)                                            04260000
@AL01135 DC    A(@CF01451)             LIST WITH   2 ARGUMENT(S)        04261000
         DC    A(@AFTEMPS+4)                                            04262000
@AL01138 DC    A(@CF01452)             LIST WITH   2 ARGUMENT(S)        04263000
         DC    A(@AFTEMPS+4)                                            04264000
@AL01145 DC    A(@CF01453)             LIST WITH   2 ARGUMENT(S)        04265000
         DC    A(@AFTEMPS+4)                                            04266000
@AL01148 DC    A(@CF01427)             LIST WITH   2 ARGUMENT(S)        04267000
         DC    A(@AFTEMPS+4)                                            04268000
@AL01175 DC    A(@CF01198)             LIST WITH   2 ARGUMENT(S)        04269000
         DC    A(@AFTEMPS+4)                                            04270000
@AL01177 DC    A(@CF00227)             LIST WITH   2 ARGUMENT(S)        04271000
         DC    A(@AFTEMPS+4)                                            04272000
@AL01311 DC    A(@CH00079)             LIST WITH   1 ARGUMENT(S)        04273000
         DS    0F                                                       04274000
@SA00001 DS    18F                                                      04275000
@SA00002 DS    15F                                                      04276000
@SA00032 DS    15F                                                      04277000
@SA00022 DS    15F                                                      04278000
@SA00011 DS    15F                                                      04279000
@SA00004 DS    15F                                                      04280000
@SA00021 DS    15F                                                      04281000
@SA00027 DS    15F                                                      04282000
@SA00026 DS    15F                                                      04283000
@SA00007 DS    15F                                                      04284000
@SA00008 DS    15F                                                      04285000
@SA00012 DS    15F                                                      04286000
@SA00024 DS    15F                                                      04287000
@SA00028 DS    15F                                                      04288000
@SA00014 DS    15F                                                      04289000
@SA00013 DS    15F                                                      04290000
@SA00020 DS    15F                                                      04291000
@SA00015 DS    15F                                                      04292000
@SA00023 DS    15F                                                      04293000
@SA00029 DS    15F                                                      04294000
@SA00030 DS    15F                                                      04295000
@TF00001 DS    F                                                        04296000
@TF00002 DS    F                                                        04297000
@AFTEMPS DS    2F                                                       04298000
         DS    0F                                                       04299000
@CF00055 DC    F'1'                                                     04300000
@CF00074 DC    F'2'                                                     04301000
@CH00074 EQU   @CF00074+2                                               04302000
@CF00076 DC    F'3'                                                     04303000
@CH00076 EQU   @CF00076+2                                               04304000
@CF00064 DC    F'4'                                                     04305000
@CH00064 EQU   @CF00064+2                                               04306000
@CF00066 DC    F'8'                                                     04307000
@CF00034 DC    F'10'                                                    04308000
@CF00032 DC    F'12'                                                    04309000
@CF00966 DC    F'13'                                                    04310000
@CH00966 EQU   @CF00966+2                                               04311000
@CF00088 DC    F'16'                                                    04312000
@CF01152 DC    F'18'                                                    04313000
@CF00227 DC    F'24'                                                    04314000
@CH00227 EQU   @CF00227+2                                               04315000
@CF01102 DC    F'27'                                                    04316000
@CF01458 DC    F'30'                                                    04317000
@CF01198 DC    F'40'                                                    04318000
@CF00293 DC    F'50'                                                    04319000
@CF01451 DC    F'53'                                                    04320000
@CF01450 DC    F'55'                                                    04321000
@CF01453 DC    F'72'                                                    04322000
@CF01452 DC    F'74'                                                    04323000
@CF01432 DC    F'75'                                                    04324000
@CF01433 DC    F'76'                                                    04325000
@CF01427 DC    F'78'                                                    04326000
@CF01495 DC    F'254'                                                   04327000
@CF01504 DC    F'-20'                                                   04328000
@CF01517 DC    F'-17'                                                   04329000
@CF01519 DC    F'-15'                                                   04330000
@CF01350 DC    F'-13'                                                   04331000
@CF01516 DC    F'-10'                                                   04332000
@CF01510 DC    F'-9'                                                    04333000
@CF01502 DC    F'-7'                                                    04334000
@CF01512 DC    F'-4'                                                    04335000
@CF01515 DC    F'-3'                                                    04336000
@CF00878 DC    XL4'FFFFFFF8'                                            04337000
@CV01405 DC    V(IFCDEVIC)                                              04338000
         DS    0D                                                       04339000
ENTRIES  DC    F'1'                                                     04340000
LISTPTR  DC    A(0)                                                     04341000
T        DC    F'0'                                                     04342000
P        DC    F'0'                                                     04343000
Q        DC    F'0'                                                     04344000
NUMBER   DC    F'0'                                                     04345000
NEXTBY   DC    F'0'                                                     04346000
ADDNXT   DC    F'0'                                                     04347000
ZZ       DC    A(0)                                                     04348000
Z1       DC    F'0'                                                     04349000
Z2       DC    F'0'                                                     04350000
Z3       DC    F'0'                                                     04351000
ZZ3      DC    F'0'                                                     04352000
         DS    0D                                                       04353000
@TS00001 DS    CL11                                                     04354000
@CB01473 DC    X'0000000000000000'                                      04355000
@CB00288 EQU   @CB01473                                                 04356000
@CB01430 DC    X'0000000F'                                              04357000
@CB00228 DC    X'00000F'                                                04358000
@CB00237 DC    X'FFFFFF'                                                04359000
@CB00938 DC    X'000FFF'                                                04360000
@CB01317 DC    X'99366F'                                                04361000
@CB00261 EQU   @CB00237                                                 04362000
@CB00883 DC    X'2006'                                                  04363000
@CB00885 DC    X'2007'                                                  04364000
@CB00887 DC    X'2009'                                                  04365000
@CB00889 DC    X'200A'                                                  04366000
@CB00891 DC    X'200B'                                                  04367000
@CB00893 DC    X'200D'                                                  04368000
@CB00895 DC    X'8004'                                                  04369000
@CB00897 DC    X'8005'                                                  04370000
@CB00899 DC    X'8003'                                                  04371000
@CB00901 DC    X'100C'                                                  04372000
@CB00903 DC    X'1008'                                                  04373000
@CB00905 DC    X'0842'                                                  04374000
@CB00932 DC    X'0FF0'                                                  04375000
@CB00934 DC    X'FF00'                                                  04376000
@CB00936 DC    X'0FFF'                                                  04377000
@CB00957 EQU   @CB00938                                                 04378000
@CB00976 DC    X'7FFF'                                                  04379000
@CB01387 DC    X'3830'                                                  04380000
@CB01393 DC    X'3705'                                                  04381000
         DS    CL1                                                      04382000
FILT1ITM DS    CL131                                                    04383000
         ORG   FILT1ITM                                                 04384000
MAXENT   DC    F'0'                                                     04385000
FREEADR  DC    A(0)                                                     04386000
I        DC    A(1)                                                     04387000
J        DC    A(0)                                                     04388000
K        DC    A(0)                                                     04389000
L        DC    A(0)                                                     04390000
A        DC    A(0)                                                     04391000
X        DC    A(0)                                                     04392000
Y        DC    A(0)                                                     04393000
Z        DC    A(0)                                                     04394000
TMPSTORE DC    A(0)                                                     04395000
LINKPTR  DC    A(0)                                                     04396000
CCHINDX  DC    A(0)                                                     04397000
SAVESEQ  DC    AL1(0)                                                   04398000
         DS    CL3                                                      04399000
UNKNWN   DC    F'0'                                                     04400000
ALLCORE  DC    F'0'                                                     04401000
STSUMPTR DC    A(0)                                                     04402000
COMPLINK DC    A(0)                                                     04403000
M        DC    A(0)                                                     04404000
SRTCONT  DC    F'0'                                                     04405000
SRTCONT1 DC    F'0'                                                     04406000
ERROR    DC    F'0'                                                     04407000
EVPTR1   DC    A(0)                                                     04408000
ERSER    DC    X'00000000'                                              04409000
         ORG   ERSER                                                    04410000
@NM00085 DS    CL1                                                      04411000
ER3      DS    CL3                                                      04412000
         ORG   FILT1ITM+96                                              04413000
NUMUNSHR DC    H'1'                                                     04414000
PACKPAS  DC    CL4'    '                                                04415000
CHARPAS  DC    CL8'        '                                            04416000
         DS    CL2                                                      04417000
PASSNUM  DC    F'0'                                                     04418000
NUMREC   DC    F'0'                                                     04419000
EXCESS   DC    F'0'                                                     04420000
WORKDEV  DC    X'0000'                                                  04421000
         ORG   WORKDEV                                                  04422000
WORKDEV1 DS    CL1                                                      04423000
WORKDEV2 DS    CL1                                                      04424000
         ORG   FILT1ITM+126                                             04425000
WORKTYPE DC    X'00'                                                    04426000
CUA3     DC    X'000000'                                                04427000
         ORG   CUA3                                                     04428000
@NM00086 DS    BL1                                                      04429000
WORKCUA  DS    BL2                                                      04430000
         ORG   WORKCUA                                                  04431000
WRKCUA   DS    BL2                                                      04432000
         ORG   FILT1ITM+130                                             04433000
MSGNO    DC    AL1(0)                                                   04434000
         ORG   FILT1ITM+131                                             04435000
LINKDEV  DS    CL4                                                      04436000
         ORG   LINKDEV                                                  04437000
DEVLABEL DS    CL2                                                      04438000
@NM00087 DS    CL2                                                      04439000
         ORG   LINKDEV+4                                                04440000
ERRPLACE DS    BL1                                                      04441000
         ORG   ERRPLACE                                                 04442000
ERRP1    DS    BL1                                                      04443000
ERRP2    EQU   ERRPLACE+0                                               04444000
         ORG   ERRPLACE+1                                               04445000
PRINTLIN DS    CL134                                                    04446000
         ORG   PRINTLIN                                                 04447000
PRINTDS  DC    X'F1'                                                    04448000
PRINTCC  DC    X'09'                                                    04449000
PRINTBDY DC    CL132' '                                                 04450000
         ORG   PRINTBDY                                                 04451000
@NM00088 DS    CL8                                                      04452000
PRINTED  DS    CL9                                                      04453000
@NM00089 DS    CL24                                                     04454000
PRNTSER  DS    CL7                                                      04455000
         ORG   PRINTLIN+134                                             04456000
PARTIAL  DS    CL58                                                     04457000
         ORG   PARTIAL                                                  04458000
@NM00092 DC    CL29'DEBUG16 FRAME SET INCOMPLETE '                      04459000
PARMOD   DS    CL4                                                      04460000
@NM00093 DC    CL1' '                                                   04461000
PARSER   DS    CL6                                                      04462000
@NM00094 DC    CL17' FRAMEREP SET TO '                                  04463000
PARREP   DS    CL1                                                      04464000
         ORG   PARTIAL+58                                               04465000
BITSWIT  DC    X'000000'                                                04466000
         ORG   BITSWIT                                                  04467000
NONBLANK DS    BL1                                                      04468000
SORTSW   EQU   BITSWIT+0                                                04469000
UNIQUE   EQU   BITSWIT+0                                                04470000
MISSW    EQU   BITSWIT+0                                                04471000
GETOUT   EQU   BITSWIT+0                                                04472000
FIRSTIME EQU   BITSWIT+0                                                04473000
MISSW1   EQU   BITSWIT+0                                                04474000
ONBOUND  EQU   BITSWIT+0                                                04475000
SHAREYES DS    BL1                                                      04476000
CUAOK    EQU   BITSWIT+1                                                04477000
CPUOK    EQU   BITSWIT+1                                                04478000
CPU0FLG  EQU   BITSWIT+1                                                04479000
GETFAIL  EQU   BITSWIT+1                                                04480000
LOOPOUT  EQU   BITSWIT+1                                                04481000
FRAMEYES EQU   BITSWIT+1                                                04482000
ONETIME  EQU   BITSWIT+1                                                04483000
FOUND    DS    BL1                                                      04484000
DEVOK    EQU   BITSWIT+2                                                04485000
         ORG   BITSWIT+3                                                04486000
WORKBYTE DS    BL1                                                      04487000
         ORG   WORKBYTE                                                 04488000
WORKBYT4 DS    BL1                                                      04489000
         ORG   WORKBYTE+1                                               04490000
WORKTWO  DS    BL1                                                      04491000
ZERO5    DC    X'0000000000'                                            04492000
SYSUM2   DC    X'00000000000000000000000000'                            04493000
         ORG   SYSUM2                                                   04494000
SYSUMKEY DS    CL7                                                      04495000
         ORG   SYSUMKEY                                                 04496000
SYSGROUP DS    FL1                                                      04497000
SYSRT    DS    BL2                                                      04498000
         ORG   SYSRT                                                    04499000
SYSCUA   DS    BL2                                                      04500000
         ORG   SYSUMKEY+3                                               04501000
SYSCPUS  DS    BL1                                                      04502000
         ORG   SYSCPUS                                                  04503000
SYSCPU   DS    BL1                                                      04504000
SYSOLD   EQU   SYSCPUS+0                                                04505000
         ORG   SYSUMKEY+4                                               04506000
SYSITEM  DS    BL1                                                      04507000
         ORG   SYSITEM                                                  04508000
SYS3705  DS    BL1                                                      04509000
SYSOLDA  EQU   SYSITEM+0                                                04510000
         ORG   SYSUMKEY+5                                               04511000
SYSDEV   DS    CL2                                                      04512000
         ORG   SYSUM2+7                                                 04513000
SYSPERM1 DS    FL2                                                      04514000
         ORG   SYSPERM1                                                 04515000
@NM00096 DS    BL2                                                      04516000
SYSPERM  EQU   SYSPERM1+1                                               04517000
         ORG   SYSUM2+9                                                 04518000
SYSTEMP  DS    FL4                                                      04519000
         ORG   SYSUM2+13                                                04520000
CHARS    DC    CL16'0123456789ABCDEF'                                   04521000
SUPERZAP DC    3CL10'SUPERZAP'                                          04522000
         DS    CL3                                                      04523000
SAVEADR  DC    A(0)                                                     04524000
         DS    15XL4                                                    04525000
EVCON    DC    CL1'A'                                                   04526000
         DC    CL1'B'                                                   04527000
         DC    CL1'C'                                                   04528000
         DC    CL1'D'                                                   04529000
         DC    CL1'E'                                                   04530000
         DC    CL1'F'                                                   04531000
         DC    CL1'G'                                                   04532000
         DC    CL1'H'                                                   04533000
         DC    CL1'I'                                                   04534000
         DC    CL1'J'                                                   04535000
         DC    CL1'K'                                                   04536000
         DC    CL1'L'                                                   04537000
         DC    CL1'M'                                                   04538000
         DC    CL1'N'                                                   04539000
         DC    CL1'O'                                                   04540000
         DC    CL1'P'                                                   04541000
FLIP     DC    AL1(0)                                                   04542000
         DC    AL1(1)                                                   04543000
         DC    AL1(2)                                                   04544000
         DC    AL1(3)                                                   04545000
         DC    AL1(4)                                                   04546000
         DC    AL1(5)                                                   04547000
         DC    AL1(6)                                                   04548000
         DC    AL1(7)                                                   04549000
         DC    AL1(8)                                                   04550000
         DC    AL1(9)                                                   04551000
         DC    AL1(10)                                                  04552000
         DC    AL1(11)                                                  04553000
         DC    AL1(12)                                                  04554000
         DC    AL1(13)                                                  04555000
         DC    AL1(14)                                                  04556000
         DC    AL1(15)                                                  04557000
EDIFILD  DS    9CL1                                                     04558000
         DS    CL3                                                      04559000
PATCH    DC    25F'0'                                                   04560000
BUG      DC    40F'0'                                                   04561000
ERRLINE  DS    CL63                                                     04562000
         ORG   ERRLINE+0                                                04563000
ERRDS    DC    CL1'1'                                                   04564000
ERCC     DC    X'09'                                                    04565000
ERRMES   DC    CL10'DEBUG16   '                                         04566000
ERXNUM   DC    CL9'         '                                           04567000
@NM00097 DC    CL2'  '                                                  04568000
ERRTXT   DC    CL40'UNKNOWN RECORDS IDENTIFIED              '           04569000
         ORG   ERRLINE+63                                               04570000
         ORG   ERRLINE+63                                               04571000
         DC    CL1'1'                                                   04572000
         DC    X'09'                                                    04573000
         DC    CL10'DEBUG16   '                                         04574000
         DC    CL9'         '                                           04575000
         DC    CL2'  '                                                  04576000
         DC    CL40'SOFT    RECORDS IDENTIFIED              '           04577000
         ORG   ERRLINE+126                                              04578000
         ORG   ERRLINE+126                                              04579000
         DC    CL1'1'                                                   04580000
         DC    X'09'                                                    04581000
         DC    CL10'DEBUG16   '                                         04582000
         DC    CL9'         '                                           04583000
         DC    CL2'  '                                                  04584000
         DC    CL40'MCH     RECORDS IDENTIFIED              '           04585000
         ORG   ERRLINE+189                                              04586000
         ORG   ERRLINE+189                                              04587000
         DC    CL1'1'                                                   04588000
         DC    X'09'                                                    04589000
         DC    CL10'DEBUG16   '                                         04590000
         DC    CL9'         '                                           04591000
         DC    CL2'  '                                                  04592000
         DC    CL40'CCH     RECORDS IDENTIFIED              '           04593000
         ORG   ERRLINE+252                                              04594000
         ORG   ERRLINE+252                                              04595000
         DC    CL1'1'                                                   04596000
         DC    X'09'                                                    04597000
         DC    CL10'DEBUG16   '                                         04598000
         DC    CL9'         '                                           04599000
         DC    CL2'  '                                                  04600000
         DC    CL40'IPL     RECORDS IDENTIFIED              '           04601000
         ORG   ERRLINE+315                                              04602000
         ORG   ERRLINE+315                                              04603000
         DC    CL1'1'                                                   04604000
         DC    X'09'                                                    04605000
         DC    CL10'DEBUG16   '                                         04606000
         DC    CL9'         '                                           04607000
         DC    CL2'  '                                                  04608000
         DC    CL40'EOD     RECORDS IDENTIFIED              '           04609000
         ORG   ERRLINE+378                                              04610000
         ORG   ERRLINE+378                                              04611000
         DC    CL1'1'                                                   04612000
         DC    X'09'                                                    04613000
         DC    CL10'DEBUG16   '                                         04614000
         DC    CL9'         '                                           04615000
         DC    CL2'  '                                                  04616000
         DC    CL40'OBR     RECORDS IDENTIFIED              '           04617000
         ORG   ERRLINE+441                                              04618000
         ORG   ERRLINE+441                                              04619000
         DC    CL1'1'                                                   04620000
         DC    X'09'                                                    04621000
         DC    CL10'DEBUG16   '                                         04622000
         DC    CL9'         '                                           04623000
         DC    CL2'  '                                                  04624000
         DC    CL40'OTHER VALID RECORDS IDENTIFIED          '           04625000
         ORG   ERRLINE+504                                              04626000
         ORG   ERRLINE+504                                              04627000
         DC    CL1'1'                                                   04628000
         DC    X'09'                                                    04629000
         DC    CL10'DEBUG16   '                                         04630000
         DC    CL9'         '                                           04631000
         DC    CL2'  '                                                  04632000
         DC    CL40'MDR TYPE 91 DEVICE TYPE 3705 RECORDS    '           04633000
         ORG   ERRLINE+567                                              04634000
         ORG   ERRLINE+567                                              04635000
         DC    CL1'1'                                                   04636000
         DC    X'09'                                                    04637000
         DC    CL10'DEBUG16   '                                         04638000
         DC    CL9'         '                                           04639000
         DC    CL2'  '                                                  04640000
         DC    CL40'MDR NOT DEVICE 3705 OR 33XX             '           04641000
         ORG   ERRLINE+630                                              04642000
         ORG   ERRLINE+630                                              04643000
         DC    CL1'1'                                                   04644000
         DC    X'09'                                                    04645000
         DC    CL10'DEBUG16   '                                         04646000
         DC    CL9'         '                                           04647000
         DC    CL2'  '                                                  04648000
         DC    CL40'MDR RECORDS SAVED IN SYSUM2             '           04649000
         ORG   ERRLINE+693                                              04650000
         ORG   ERRLINE+693                                              04651000
         DC    CL1'1'                                                   04652000
         DC    X'09'                                                    04653000
         DC    CL10'DEBUG16   '                                         04654000
         DC    CL9'         '                                           04655000
         DC    CL2'  '                                                  04656000
         DC    CL40'OBR RECORDS SAVED IN SYSUM2             '           04657000
         ORG   ERRLINE+756                                              04658000
         ORG   ERRLINE+756                                              04659000
         DC    CL1'1'                                                   04660000
         DC    X'09'                                                    04661000
         DC    CL10'DEBUG16   '                                         04662000
         DC    CL9'         '                                           04663000
         DC    CL2'  '                                                  04664000
         DC    CL40'RECORDS SAVED WITH CPU SERIAL NO. FFFFFF'           04665000
         ORG   ERRLINE+819                                              04666000
         ORG   ERRLINE+819                                              04667000
         DC    CL1'1'                                                   04668000
         DC    X'09'                                                    04669000
         DC    CL10'DEBUG16   '                                         04670000
         DC    CL9'         '                                           04671000
         DC    CL2'  '                                                  04672000
         DC    CL40'SORTWO FLIPS DONE                       '           04673000
         ORG   ERRLINE+882                                              04674000
         ORG   ERRLINE+882                                              04675000
         DC    CL1'1'                                                   04676000
         DC    X'09'                                                    04677000
         DC    CL10'DEBUG16   '                                         04678000
         DC    CL9'         '                                           04679000
         DC    CL2'  '                                                  04680000
         DC    CL40'DEVICE GROUP 1 RECORDS SAVED            '           04681000
         ORG   ERRLINE+945                                              04682000
         ORG   ERRLINE+945                                              04683000
         DC    CL1'1'                                                   04684000
         DC    X'09'                                                    04685000
         DC    CL10'DEBUG16   '                                         04686000
         DC    CL9'         '                                           04687000
         DC    CL2'  '                                                  04688000
         DC    CL40'DEVICE GROUP 2 RECORDS SAVED            '           04689000
         ORG   ERRLINE+1008                                             04690000
         ORG   ERRLINE+1008                                             04691000
         DC    CL1'1'                                                   04692000
         DC    X'09'                                                    04693000
         DC    CL10'DEBUG16   '                                         04694000
         DC    CL9'         '                                           04695000
         DC    CL2'  '                                                  04696000
         DC    CL40'DEVICE GROUP 3 RECORDS SAVED            '           04697000
         ORG   ERRLINE+1071                                             04698000
         ORG   ERRLINE+1071                                             04699000
         DC    CL1'1'                                                   04700000
         DC    X'09'                                                    04701000
         DC    CL10'DEBUG16   '                                         04702000
         DC    CL9'         '                                           04703000
         DC    CL2'  '                                                  04704000
         DC    CL40'DEVICE GROUP 4 RECORDS SAVED            '           04705000
         ORG   ERRLINE+1134                                             04706000
         ORG   ERRLINE+1134                                             04707000
         DC    CL1'1'                                                   04708000
         DC    X'09'                                                    04709000
         DC    CL10'DEBUG16   '                                         04710000
         DC    CL9'         '                                           04711000
         DC    CL2'  '                                                  04712000
         DC    CL40'DEVICE GROUP 5 RECORDS SAVED            '           04713000
         ORG   ERRLINE+1197                                             04714000
         ORG   ERRLINE+1197                                             04715000
         DC    CL1'1'                                                   04716000
         DC    X'09'                                                    04717000
         DC    CL10'DEBUG16   '                                         04718000
         DC    CL9'         '                                           04719000
         DC    CL2'  '                                                  04720000
         DC    CL40'DEVICE GROUP 6 RECORDS SAVED            '           04721000
         ORG   ERRLINE+1260                                             04722000
         ORG   ERRLINE+1260                                             04723000
         DC    CL1'1'                                                   04724000
         DC    X'09'                                                    04725000
         DC    CL10'DEBUG16   '                                         04726000
         DC    CL9'         '                                           04727000
         DC    CL2'  '                                                  04728000
         DC    CL40'RECORDS RETRIEVED VIA READSEQ           '           04729000
         ORG   ERRLINE+1323                                             04730000
         ORG   ERRLINE+1323                                             04731000
         DC    CL1'1'                                                   04732000
         DC    X'09'                                                    04733000
         DC    CL10'DEBUG16   '                                         04734000
         DC    CL9'         '                                           04735000
         DC    CL2'  '                                                  04736000
         DC    CL40'RECORDS PASSED DATE,TIME FILTERING      '           04737000
         ORG   ERRLINE+1386                                             04738000
         ORG   ERRLINE+1386                                             04739000
         DC    CL1'1'                                                   04740000
         DC    X'09'                                                    04741000
         DC    CL10'DEBUG16   '                                         04742000
         DC    CL9'         '                                           04743000
         DC    CL2'  '                                                  04744000
         DC    CL40'MDR 33XX RECORDS IDENTIFIED             '           04745000
         ORG   ERRLINE+1449                                             04746000
         ORG   ERRLINE+1449                                             04747000
         DC    CL1'1'                                                   04748000
         DC    X'09'                                                    04749000
         DC    CL10'DEBUG16   '                                         04750000
         DC    CL9'         '                                           04751000
         DC    CL2'  '                                                  04752000
         DC    CL40'MDR 33XX RECORDS SAVED                  '           04753000
         ORG   ERRLINE+1512                                             04754000
         ORG   ERRLINE+1512                                             04755000
         DC    CL1'1'                                                   04756000
         DC    X'09'                                                    04757000
         DC    CL10'DEBUG16   '                                         04758000
         DC    CL9'         '                                           04759000
         DC    CL2'  '                                                  04760000
         DC    CL40'OBR 33XX RECORDS IDENTIFIED             '           04761000
         ORG   ERRLINE+1575                                             04762000
         ORG   ERRLINE+1575                                             04763000
         DC    CL1'1'                                                   04764000
         DC    X'09'                                                    04765000
         DC    CL10'DEBUG16   '                                         04766000
         DC    CL9'         '                                           04767000
         DC    CL2'  '                                                  04768000
         DC    CL40'OBR 33XX RECORDS SAVED                  '           04769000
         ORG   ERRLINE+1638                                             04770000
         ORG   ERRLINE+1638                                             04771000
         DC    CL1'1'                                                   04772000
         DC    X'09'                                                    04773000
         DC    CL10'DEBUG16   '                                         04774000
         DC    CL9'         '                                           04775000
         DC    CL2'  '                                                  04776000
         DC    CL40'34XX     RECORDS FOUND                  '           04777000
         ORG   ERRLINE+1701                                             04778000
         ORG   ERRLINE+1701                                             04779000
         DC    CL1'1'                                                   04780000
         DC    X'09'                                                    04781000
         DC    CL10'DEBUG16   '                                         04782000
         DC    CL9'         '                                           04783000
         DC    CL2'  '                                                  04784000
         DC    CL40'34XX     RECORDS SAVED                  '           04785000
         ORG   ERRLINE+1764                                             04786000
         ORG   ERRLINE+1764                                             04787000
         DC    CL1'1'                                                   04788000
         DC    X'09'                                                    04789000
         DC    CL10'DEBUG16   '                                         04790000
         DC    CL9'         '                                           04791000
         DC    CL2'  '                                                  04792000
         DC    CL40'FRAMES USED IN PROCESSING               '           04793000
         ORG   ERRLINE+1827                                             04794000
         ORG   ERRLINE+1827                                             04795000
         DC    CL1'1'                                                   04796000
         DC    X'09'                                                    04797000
         DC    CL10'DEBUG16   '                                         04798000
         DC    CL9'         '                                           04799000
         DC    CL2'  '                                                  04800000
         DC    CL40'FRAMES NOT USED IN PROCESSING           '           04801000
         ORG   ERRLINE+1890                                             04802000
         ORG   ERRLINE+1890                                             04803000
         DC    CL1'1'                                                   04804000
         DC    X'09'                                                    04805000
         DC    CL10'DEBUG16   '                                         04806000
         DC    CL9'         '                                           04807000
         DC    CL2'  '                                                  04808000
         DC    CL40'****IFCFILT2 DEBUG16 RECORD COUNTS******'           04809000
         ORG   ERRLINE+1953                                             04810000
         ORG   ERRLINE+1953                                             04811000
         DC    CL1'1'                                                   04812000
         DC    X'09'                                                    04813000
         DC    CL10'DEBUG16   '                                         04814000
         DC    CL9'         '                                           04815000
         DC    CL2'  '                                                  04816000
         ORG   ERRLINE+2016                                             04817000
         ORG   ERRLINE+2016                                             04818000
         DC    CL1'1'                                                   04819000
         DC    X'09'                                                    04820000
         DC    CL10'DEBUG16   '                                         04821000
         DC    CL9'         '                                           04822000
         DC    CL2'  '                                                  04823000
         ORG   ERRLINE+2079                                             04824000
         ORG   ERRLINE+2079                                             04825000
         DC    CL1'1'                                                   04826000
         DC    X'09'                                                    04827000
         DC    CL10'DEBUG16   '                                         04828000
         DC    CL9'         '                                           04829000
         DC    CL2'  '                                                  04830000
         ORG   ERRLINE+2142                                             04831000
         ORG   ERRLINE+2142                                             04832000
         DC    CL1'1'                                                   04833000
         DC    X'09'                                                    04834000
         DC    CL10'DEBUG16   '                                         04835000
         DC    CL9'         '                                           04836000
         DC    CL2'  '                                                  04837000
         ORG   ERRLINE+2205                                             04838000
         ORG   ERRLINE+2205                                             04839000
         DC    CL1'1'                                                   04840000
         DC    X'09'                                                    04841000
         DC    CL10'DEBUG16   '                                         04842000
         DC    CL9'         '                                           04843000
         DC    CL2'  '                                                  04844000
         ORG   ERRLINE+2268                                             04845000
         ORG   ERRLINE+2268                                             04846000
         DC    CL1'1'                                                   04847000
         DC    X'09'                                                    04848000
         DC    CL10'DEBUG16   '                                         04849000
         DC    CL9'         '                                           04850000
         DC    CL2'  '                                                  04851000
         ORG   ERRLINE+2331                                             04852000
         ORG   ERRLINE+2331                                             04853000
         DC    CL1'1'                                                   04854000
         DC    X'09'                                                    04855000
         DC    CL10'DEBUG16   '                                         04856000
         DC    CL9'         '                                           04857000
         DC    CL2'  '                                                  04858000
         ORG   ERRLINE+2394                                             04859000
         ORG   ERRLINE+2394                                             04860000
         DC    CL1'1'                                                   04861000
         DC    X'09'                                                    04862000
         DC    CL10'DEBUG16   '                                         04863000
         DC    CL9'         '                                           04864000
         DC    CL2'  '                                                  04865000
         ORG   ERRLINE+2457                                             04866000
         ORG   ERRLINE+2457                                             04867000
         DC    CL1'1'                                                   04868000
         DC    X'09'                                                    04869000
         DC    CL10'DEBUG16   '                                         04870000
         DC    CL9'         '                                           04871000
         DC    CL2'  '                                                  04872000
         ORG   ERRLINE+2520                                             04873000
IFCFILT2 CSECT                                                          04874000
         DC    S(SUPERZAP)                                              04875000
IFCFILT2 CSECT                                                          04876000
         DC    S(PATCH)   BASE DISPLACEMENT ADDRESS OF PATCH AREA       04877000
IFCFILT2 CSECT                                                          04878000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04879000
@01      EQU   01                                                       04880000
@02      EQU   02                                                       04881000
@03      EQU   03                                                       04882000
@04      EQU   04                                                       04883000
@05      EQU   05                                                       04884000
@06      EQU   06                                                       04885000
@07      EQU   07                                                       04886000
@08      EQU   08                                                       04887000
@09      EQU   09                                                       04888000
@10      EQU   10                                                       04889000
@11      EQU   11                                                       04890000
@12      EQU   12                                                       04891000
@13      EQU   13                                                       04892000
@14      EQU   14                                                       04893000
@15      EQU   15                                                       04894000
R2       EQU   @02                                                      04895000
R7       EQU   @07                                                      04896000
R0       EQU   @00                                                      04897000
R1       EQU   @01                                                      04898000
R3       EQU   @03                                                      04899000
R4       EQU   @04                                                      04900000
R5       EQU   @05                                                      04901000
R6       EQU   @06                                                      04902000
R12      EQU   @12                                                      04903000
R15      EQU   @15                                                      04904000
R10      EQU   @10                                                      04905000
R11      EQU   @11                                                      04906000
R13      EQU   @13                                                      04907000
R14      EQU   @14                                                      04908000
R8       EQU   @08                                                      04909000
R9       EQU   @09                                                      04910000
IOHND    EQU   0                                                        04911000
IFCMSG   EQU   0                                                        04912000
PARM     EQU   0                                                        04913000
RECTYPE  EQU   PARM                                                     04914000
PMCH     EQU   RECTYPE                                                  04915000
PCHAN    EQU   RECTYPE                                                  04916000
SWITCHES EQU   PARM+2                                                   04917000
ZEROALL  EQU   SWITCHES+1                                               04918000
DEVEXCL  EQU   SWITCHES+1                                               04919000
SHIFT3RD EQU   SWITCHES+1                                               04920000
DEBUG    EQU   PARM+4                                                   04921000
DEBUG4   EQU   DEBUG                                                    04922000
DEBUG11  EQU   DEBUG+1                                                  04923000
DEBUG16  EQU   DEBUG+2                                                  04924000
DEBUG23  EQU   DEBUG+2                                                  04925000
DEBUGA   EQU   PARM+8                                                   04926000
DEBUG50  EQU   DEBUGA+2                                                 04927000
MISC     EQU   PARM+12                                                  04928000
PACC     EQU   MISC                                                     04929000
PHIST    EQU   MISC                                                     04930000
PRINTES  EQU   MISC                                                     04931000
PASSFLAG EQU   MISC                                                     04932000
OPENCLSE EQU   PARM+13                                                  04933000
OPENIO   EQU   OPENCLSE                                                 04934000
CLOSEIO  EQU   OPENCLSE+2                                               04935000
CACCIN   EQU   CLOSEIO                                                  04936000
CDRCTWRK EQU   CLOSEIO                                                  04937000
DATENOW  EQU   PARM+17                                                  04938000
STDT     EQU   PARM+23                                                  04939000
STDATE   EQU   STDT                                                     04940000
PSTD     EQU   STDATE+1                                                 04941000
ENDDT    EQU   PARM+31                                                  04942000
ENDDATE  EQU   ENDDT                                                    04943000
PEND     EQU   ENDDATE+1                                                04944000
STTIME1  EQU   PARM+39                                                  04945000
ENDTIME1 EQU   PARM+43                                                  04946000
STTIME2  EQU   PARM+47                                                  04947000
ENDTIME2 EQU   PARM+51                                                  04948000
STRTDATE EQU   PARM+55                                                  04949000
@NM00007 EQU   PARM+75                                                  04950000
TABSIZE  EQU   PARM+80                                                  04951000
SORTNUM  EQU   PARM+84                                                  04952000
ERRID    EQU   PARM+92                                                  04953000
IDTIMEA  EQU   ERRID+6                                                  04954000
IDTIME   EQU   IDTIMEA                                                  04955000
CCHHRLNG EQU   PARM+112                                                 04956000
RECCCHHR EQU   CCHHRLNG                                                 04957000
ADIOHND  EQU   PARM+124                                                 04958000
ADIFCMSG EQU   PARM+128                                                 04959000
ADEDITB  EQU   PARM+132                                                 04960000
EVPTR    EQU   PARM+136                                                 04961000
SORTADR  EQU   PARM+140                                                 04962000
PRINTADR EQU   PARM+148                                                 04963000
CUAPTR   EQU   PARM+152                                                 04964000
DEVPTR   EQU   PARM+156                                                 04965000
MODPTR   EQU   PARM+160                                                 04966000
SERPTR   EQU   PARM+164                                                 04967000
VOLPTR   EQU   PARM+168                                                 04968000
CPUPTR   EQU   PARM+172                                                 04969000
CPCUAPTR EQU   PARM+176                                                 04970000
LIBADPTR EQU   PARM+180                                                 04971000
SYMCDPTR EQU   PARM+184                                                 04972000
SYSUMPTR EQU   PARM+188                                                 04973000
TRENPTR  EQU   PARM+192                                                 04974000
SHAREPTR EQU   PARM+196                                                 04975000
FRAMEPTR EQU   PARM+200                                                 04976000
MERDCPTR EQU   PARM+208                                                 04977000
DUMPTABL EQU   PARM+228                                                 04978000
DUMPINFO EQU   DUMPTABL+4                                               04979000
TRENDONE EQU   0                                                        04980000
TREGEN   EQU   TRENDONE+8                                               04981000
EVTABLE  EQU   0                                                        04982000
EVSTOP   EQU   EVTABLE                                                  04983000
EVNUM    EQU   EVTABLE+4                                                04984000
EVKEY    EQU   EVTABLE+6                                                04985000
EVMODEL  EQU   EVKEY                                                    04986000
EVSERIAL EQU   EVKEY+2                                                  04987000
EVLETTER EQU   EVKEY+5                                                  04988000
SORTABLE EQU   0                                                        04989000
SORTKEY  EQU   SORTABLE                                                 04990000
SORTCCHR EQU   SORTABLE+5                                               04991000
SYSUMONE EQU   0                                                        04992000
SYSUMNUM EQU   SYSUMONE                                                 04993000
SYSUMIPL EQU   SYSUMONE+4                                               04994000
SYSUMNXT EQU   SYSUMONE+8                                               04995000
SYSUMMCR EQU   SYSUMONE+12                                              04996000
SYSUMMCN EQU   SYSUMONE+16                                              04997000
SYSUMCH  EQU   SYSUMONE+20                                              04998000
SYSUMPEI EQU   SYSUMONE+84                                              04999000
SYSUMPEA EQU   SYSUMONE+88                                              05000000
SYSUMPER EQU   SYSUMONE+92                                              05001000
SYSUMEOD EQU   SYSUMONE+96                                              05002000
SHARE    EQU   0                                                        05003000
SHARENUM EQU   SHARE                                                    05004000
SHAREIO  EQU   SHARE+2                                                  05005000
SHRCUCPU EQU   SHAREIO                                                  05006000
SHARECUA EQU   SHRCUCPU                                                 05007000
SHAREDX  EQU   SHARECUA                                                 05008000
SHARSERA EQU   SHRCUCPU+2                                               05009000
SHARECUB EQU   SHAREIO+5                                                05010000
SHARSERB EQU   SHAREIO+7                                                05011000
SHARLET  EQU   SHAREIO+10                                               05012000
EDITLOAD EQU   0                                                        05013000
EDITABLE EQU   EDITLOAD+4                                               05014000
CUA      EQU   0                                                        05015000
CUANUM   EQU   CUA                                                      05016000
CUAVAL   EQU   CUA+2                                                    05017000
CUA1     EQU   CUAVAL                                                   05018000
CUA2     EQU   CUAVAL+2                                                 05019000
DEVICE   EQU   0                                                        05020000
DEVNUM   EQU   DEVICE                                                   05021000
DEVVAL   EQU   DEVICE+2                                                 05022000
MDRNUM   EQU   DEVICE+202                                               05023000
MDRVAL   EQU   DEVICE+204                                               05024000
MODELS   EQU   0                                                        05025000
DEVSERAL EQU   0                                                        05026000
VOLUME   EQU   0                                                        05027000
CPUS     EQU   0                                                        05028000
CPUNUM   EQU   CPUS                                                     05029000
CPUVAL   EQU   CPUS+2                                                   05030000
CPUCUAS  EQU   0                                                        05031000
CPUCUAV  EQU   CPUCUAS+2                                                05032000
LIBADR   EQU   0                                                        05033000
SYMCODE  EQU   0                                                        05034000
SYMVAL   EQU   SYMCODE+2                                                05035000
TMT2     EQU   0                                                        05036000
TMTKEY   EQU   TMT2                                                     05037000
TMTSRT   EQU   TMTKEY+1                                                 05038000
TMTCPUS  EQU   TMTKEY+3                                                 05039000
TMTITEM  EQU   TMTKEY+4                                                 05040000
TMTPERM1 EQU   TMT2+8                                                   05041000
TMP2     EQU   0                                                        05042000
TMPKEY   EQU   TMP2                                                     05043000
TMPSRT   EQU   TMPKEY+1                                                 05044000
TMPCPUS  EQU   TMPKEY+3                                                 05045000
TMPITEM  EQU   TMPKEY+4                                                 05046000
TMPPERM1 EQU   TMP2+7                                                   05047000
MERIDIAN EQU   0                                                        05048000
MRDNUMBR EQU   MERIDIAN                                                 05049000
MODEL    EQU   MERIDIAN+2                                               05050000
LRTREC   EQU   0                                                        05051000
LRTKEY   EQU   LRTREC                                                   05052000
LRTKEY1  EQU   LRTKEY                                                   05053000
LRTSMS   EQU   LRTREC+2                                                 05054000
LRTNLAST EQU   LRTSMS                                                   05055000
LRTRUNC  EQU   LRTSMS                                                   05056000
LRTERRID EQU   LRTREC+3                                                 05057000
@NM00017 EQU   LRTREC+4                                                 05058000
LRTCNT   EQU   @NM00017+2                                               05059000
LRTDT    EQU   LRTREC+8                                                 05060000
LRTDATE  EQU   LRTDT                                                    05061000
LRTYRDAY EQU   LRTDATE+1                                                05062000
LRTTIME  EQU   LRTDT+4                                                  05063000
LRTCPU   EQU   LRTREC+16                                                05064000
LRTCPMOD EQU   LRTCPU+1                                                 05065000
LRTCPUS  EQU   LRTCPMOD                                                 05066000
LRTMODEL EQU   LRTCPMOD+3                                               05067000
MCHREC   EQU   0                                                        05068000
MCHHEAD  EQU   MCHREC                                                   05069000
MCHKEY   EQU   MCHHEAD                                                  05070000
MCHSMS   EQU   MCHHEAD+2                                                05071000
MCHSYSTR EQU   MCHSMS+1                                                 05072000
MCHCPUID EQU   MCHHEAD+16                                               05073000
CCHREC   EQU   0                                                        05074000
CCHHEAD  EQU   CCHREC                                                   05075000
CCHKEY   EQU   CCHHEAD                                                  05076000
CCHSMS   EQU   CCHHEAD+2                                                05077000
CCHCPUID EQU   CCHHEAD+16                                               05078000
CCHCODE  EQU   CCHREC+68                                                05079000
CCHCODE2 EQU   CCHCODE+2                                                05080000
CCHCUA   EQU   CCHREC+74                                                05081000
OBRREC   EQU   0                                                        05082000
OBRHEAD  EQU   OBRREC                                                   05083000
OBRKEY   EQU   OBRHEAD                                                  05084000
OBRSMS   EQU   OBRHEAD+2                                                05085000
MISCSW   EQU   OBRSMS                                                   05086000
OBRSUBTP EQU   OBRSMS+1                                                 05087000
SDRCOUNT EQU   OBRSUBTP                                                 05088000
OBRTEMP  EQU   OBRSUBTP                                                 05089000
SHORTSW  EQU   OBRSUBTP                                                 05090000
DISMOUNT EQU   OBRSUBTP                                                 05091000
OBRCPUID EQU   OBRHEAD+16                                               05092000
OBRJOBID EQU   OBRREC+24                                                05093000
OBRSDEV2 EQU   OBRJOBID+2                                               05094000
OBRSSDRC EQU   OBRJOBID+4                                               05095000
OBRSCUA  EQU   OBRJOBID+5                                               05096000
OBRFCCW  EQU   OBRREC+32                                                05097000
OBRSRDS  EQU   OBRFCCW                                                  05098000
OBRCSW   EQU   OBRREC+40                                                05099000
OBRDEVDC EQU   OBRREC+48                                                05100000
OBRCODE  EQU   OBRREC+52                                                05101000
OBRDEV   EQU   OBRCODE+2                                                05102000
OBRLSDRC EQU   OBRREC+56                                                05103000
OBRPCUA  EQU   OBRREC+57                                                05104000
OBRSEEK  EQU   OBRREC+70                                                05105000
OBRTERMN EQU   OBRSEEK+2                                                05106000
OBR34CT1 EQU   OBRTERMN+4                                               05107000
OBR34CT2 EQU   OBRTERMN+5                                               05108000
SFTREC   EQU   0                                                        05109000
SFTHEAD  EQU   SFTREC                                                   05110000
SFTKEY   EQU   SFTHEAD                                                  05111000
SFTKEY1  EQU   SFTKEY                                                   05112000
SFTCPUID EQU   SFTHEAD+16                                               05113000
SFTSDWA  EQU   SFTREC+32                                                05114000
SFTAEC1  EQU   SFTSDWA+96                                               05115000
SFTFLGS  EQU   SFTSDWA+232                                              05116000
SFTRECP  EQU   SFTSDWA+292                                              05117000
IPLREC   EQU   0                                                        05118000
IPLHEAD  EQU   IPLREC                                                   05119000
IPLKEY   EQU   IPLHEAD                                                  05120000
IPLCPUID EQU   IPLHEAD+16                                               05121000
IPLSTIME EQU   IPLREC+52                                                05122000
DDRREC   EQU   0                                                        05123000
DDRHEAD  EQU   DDRREC                                                   05124000
DDRKEY   EQU   DDRHEAD                                                  05125000
DDRSMS   EQU   DDRHEAD+2                                                05126000
DDRCPUID EQU   DDRHEAD+16                                               05127000
@NM00052 EQU   DDRREC+24                                                05128000
DDRFDEV  EQU   DDRREC+48                                                05129000
DDRCODE2 EQU   DDRFDEV+2                                                05130000
DDRTODEV EQU   DDRREC+56                                                05131000
MIHREC   EQU   0                                                        05132000
MIHHEAD  EQU   MIHREC                                                   05133000
MIHKEY   EQU   MIHHEAD                                                  05134000
MIHCPUID EQU   MIHHEAD+16                                               05135000
@NM00058 EQU   MIHREC+24                                                05136000
MIHDEV   EQU   MIHREC+44                                                05137000
MIHCODE2 EQU   MIHDEV+2                                                 05138000
EODREC   EQU   0                                                        05139000
EODHEAD  EQU   EODREC                                                   05140000
EODKEY   EQU   EODHEAD                                                  05141000
EODCPUID EQU   EODHEAD+16                                               05142000
TPRREC   EQU   0                                                        05143000
TPRHEAD  EQU   TPRREC                                                   05144000
TPRKEY   EQU   TPRHEAD                                                  05145000
TPRDEV   EQU   TPRHEAD+4                                                05146000
TPRBUFC  EQU   TPRHEAD+5                                                05147000
TPRCPUID EQU   TPRHEAD+16                                               05148000
TPRCUA   EQU   TPRREC+24                                                05149000
@NM00066 EQU   TPRREC+26                                                05150000
TPRVOL   EQU   @NM00066                                                 05151000
TPRMODE  EQU   TPRREC+38                                                05152000
DVBSDRE  EQU   TPRREC+56                                                05153000
MCFREC   EQU   0                                                        05154000
MCFHEAD  EQU   MCFREC                                                   05155000
MCFKEY   EQU   MCFHEAD                                                  05156000
MCFSMS   EQU   MCFHEAD+2                                                05157000
@NM00074 EQU   MCFHEAD+16                                               05158000
MCFSMO   EQU   MCFHEAD+17                                               05159000
CCFREC   EQU   0                                                        05160000
CCFHEAD  EQU   CCFREC                                                   05161000
CCFKEY   EQU   CCFHEAD                                                  05162000
CCFSMS   EQU   CCFHEAD+2                                                05163000
@NM00082 EQU   CCFHEAD+16                                               05164000
CCFSMO   EQU   CCFHEAD+17                                               05165000
STSUMONE EQU   0                                                        05166000
STSUMIPL EQU   STSUMONE+4                                               05167000
STSUMMCR EQU   STSUMONE+12                                              05168000
STSUMMCN EQU   STSUMONE+16                                              05169000
STSUMCH  EQU   STSUMONE+20                                              05170000
STSUMPEI EQU   STSUMONE+84                                              05171000
STSUMPEA EQU   STSUMONE+88                                              05172000
STSUMPER EQU   STSUMONE+92                                              05173000
STSUMEOD EQU   STSUMONE+96                                              05174000
OBRLSDR  EQU   0                                                        05175000
OBRSENSE EQU   0                                                        05176000
OBRSENS0 EQU   OBRSENSE                                                 05177000
OBRSENS1 EQU   OBRSENSE+1                                               05178000
TPRSENSE EQU   0                                                        05179000
TPRS1213 EQU   TPRSENSE                                                 05180000
TPRS1415 EQU   TPRSENSE+2                                               05181000
TPRS19   EQU   TPRSENSE+7                                               05182000
FRAMETAB EQU   0                                                        05183000
FRAMENUM EQU   FRAMETAB                                                 05184000
FRAMEDTA EQU   FRAMETAB+4                                               05185000
FRAMEKEY EQU   FRAMEDTA                                                 05186000
FRAMECPU EQU   FRAMEKEY                                                 05187000
FRAMESER EQU   FRAMECPU                                                 05188000
FRAMEMOD EQU   FRAMECPU+3                                               05189000
FRAMEDT  EQU   FRAMEKEY+5                                               05190000
FRAMETYP EQU   FRAMEKEY+13                                              05191000
FRAMLOCM EQU   FRAMEDTA+16                                              05192000
FRAMLOCC EQU   FRAMEDTA+20                                              05193000
LISTLOC  EQU   0                                                        05194000
LISTNUM  EQU   LISTLOC                                                  05195000
LISTCCHR EQU   LISTLOC+4                                                05196000
NEXTBYTE EQU   0                                                        05197000
ADDNUM   EQU   0                                                        05198000
TMPA     EQU   0                                                        05199000
TMPKEYA  EQU   TMPA                                                     05200000
TMPPERMA EQU   TMPA+7                                                   05201000
TMPTEMPA EQU   TMPA+9                                                   05202000
WORKCHAN EQU   CCHCUA                                                   05203000
FLIPFLOP EQU   FLIP                                                     05204000
EDFLD    EQU   EDIFILD                                                  05205000
ERRCT1   EQU   DVBSDRE                                                  05206000
ERRNUM   EQU   ERRPLACE                                                 05207000
ERR78    EQU   PRINTBDY                                                 05208000
PFRAMMOD EQU   ERR78+27                                                 05209000
PFRAMSER EQU   ERR78+32                                                 05210000
WORKNM   EQU   WORKBYTE                                                 05211000
WORKNM2  EQU   WORKTWO                                                  05212000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05213000
@NM00091 EQU   ERR78+31                                                 05214000
@NM00090 EQU   ERR78                                                    05215000
FRAMETIM EQU   FRAMEDT+4                                                05216000
FRAMEDAT EQU   FRAMEDT                                                  05217000
@NM00095 EQU   TPRSENSE+4                                               05218000
OBRLSDR2 EQU   OBRLSDR                                                  05219000
OBRLSDR1 EQU   OBRLSDR                                                  05220000
STSUMNXT EQU   STSUMONE+8                                               05221000
STSUMNUM EQU   STSUMONE                                                 05222000
CCFFRAME EQU   CCFREC+24                                                05223000
@NM00084 EQU   CCFHEAD+22                                               05224000
CCFMOD   EQU   CCFSMO+3                                                 05225000
CCFSER   EQU   CCFSMO                                                   05226000
CCFVER   EQU   @NM00082                                                 05227000
@NM00083 EQU   @NM00082                                                 05228000
CCFTIMD  EQU   CCFHEAD+12                                               05229000
CCFDAT   EQU   CCFHEAD+8                                                05230000
@NM00081 EQU   CCFHEAD+7                                                05231000
CCFCNT   EQU   CCFHEAD+6                                                05232000
@NM00080 EQU   CCFHEAD+4                                                05233000
@NM00079 EQU   CCFSMS+1                                                 05234000
CCFCPU   EQU   CCFSMS+1                                                 05235000
CCFMP    EQU   CCFSMS+1                                                 05236000
@NM00078 EQU   CCFSMS                                                   05237000
CCFTIM   EQU   CCFSMS                                                   05238000
@NM00077 EQU   CCFSMS                                                   05239000
CCFTRU   EQU   CCFSMS                                                   05240000
CCFTOD   EQU   CCFSMS                                                   05241000
CCFLST   EQU   CCFSMS                                                   05242000
CCFKEY2  EQU   CCFKEY+1                                                 05243000
CCFKEY1  EQU   CCFKEY                                                   05244000
MCFFRAME EQU   MCFREC+24                                                05245000
@NM00076 EQU   MCFHEAD+22                                               05246000
MCFMOD   EQU   MCFSMO+3                                                 05247000
MCFSER   EQU   MCFSMO                                                   05248000
MCFVER   EQU   @NM00074                                                 05249000
@NM00075 EQU   @NM00074                                                 05250000
MCFTIMD  EQU   MCFHEAD+12                                               05251000
MCFDAT   EQU   MCFHEAD+8                                                05252000
@NM00073 EQU   MCFHEAD+7                                                05253000
MCFCNT   EQU   MCFHEAD+6                                                05254000
@NM00072 EQU   MCFHEAD+4                                                05255000
@NM00071 EQU   MCFSMS+1                                                 05256000
MCFCPU   EQU   MCFSMS+1                                                 05257000
MCFMP    EQU   MCFSMS+1                                                 05258000
@NM00070 EQU   MCFSMS                                                   05259000
MCFTIM   EQU   MCFSMS                                                   05260000
@NM00069 EQU   MCFSMS                                                   05261000
MCFTRU   EQU   MCFSMS                                                   05262000
MCFTOD   EQU   MCFSMS                                                   05263000
MCFLST   EQU   MCFSMS                                                   05264000
MCFKEY2  EQU   MCFKEY+1                                                 05265000
MCFKEY1  EQU   MCFKEY                                                   05266000
@NM00068 EQU   TPRREC+39                                                05267000
TPRLINAD EQU   TPRREC+36                                                05268000
@NM00067 EQU   TPRREC+34                                                05269000
TPRCEL   EQU   TPRCPUID+6                                               05270000
TPRMODEL EQU   TPRCPUID+4                                               05271000
TPRSER   EQU   TPRCPUID+1                                               05272000
@NM00065 EQU   TPRCPUID                                                 05273000
TPRTIME  EQU   TPRHEAD+12                                               05274000
TPRDATE  EQU   TPRHEAD+8                                                05275000
@NM00064 EQU   TPRHEAD+6                                                05276000
TPRLENGT EQU   TPRBUFC                                                  05277000
@NM00063 EQU   TPRBUFC                                                  05278000
TPRSMS   EQU   TPRHEAD+2                                                05279000
TPRKEY2  EQU   TPRKEY+1                                                 05280000
TPRKEY1  EQU   TPRKEY                                                   05281000
EODCEL   EQU   EODCPUID+6                                               05282000
EODMODEL EQU   EODCPUID+4                                               05283000
EODSER   EQU   EODCPUID+1                                               05284000
@NM00062 EQU   EODCPUID                                                 05285000
EODTIME  EQU   EODHEAD+12                                               05286000
EODDATE  EQU   EODHEAD+8                                                05287000
@NM00061 EQU   EODHEAD+5                                                05288000
EODDEV   EQU   EODHEAD+4                                                05289000
EODSMS   EQU   EODHEAD+2                                                05290000
EODKEY2  EQU   EODKEY+1                                                 05291000
EODKEY1  EQU   EODKEY                                                   05292000
MIHTYPE  EQU   MIHCODE2+1                                               05293000
MIHCLASS EQU   MIHCODE2                                                 05294000
@NM00060 EQU   MIHDEV                                                   05295000
MIHVOL   EQU   MIHREC+38                                                05296000
MIHCUA   EQU   MIHREC+35                                                05297000
@NM00059 EQU   @NM00058+8                                               05298000
MIHJOBID EQU   @NM00058                                                 05299000
MIHCEL   EQU   MIHCPUID+6                                               05300000
MIHMOD   EQU   MIHCPUID+4                                               05301000
MIHSER   EQU   MIHCPUID+1                                               05302000
@NM00057 EQU   MIHCPUID                                                 05303000
MIHTIME  EQU   MIHHEAD+12                                               05304000
MIHDATE  EQU   MIHHEAD+8                                                05305000
@NM00056 EQU   MIHHEAD+6                                                05306000
@NM00055 EQU   MIHHEAD+5                                                05307000
MIHDEBIT EQU   MIHHEAD+5                                                05308000
MIHCEBIT EQU   MIHHEAD+5                                                05309000
@NM00054 EQU   MIHHEAD+4                                                05310000
MIHSMS   EQU   MIHHEAD+2                                                05311000
MIHKEY2  EQU   MIHKEY+1                                                 05312000
MIHKEY1  EQU   MIHKEY                                                   05313000
DDRDEV2  EQU   DDRTODEV+2                                               05314000
DDRDEV1  EQU   DDRTODEV                                                 05315000
DDRTOCUA EQU   DDRREC+53                                                05316000
@NM00053 EQU   DDRREC+52                                                05317000
DDRTYPE  EQU   DDRCODE2+1                                               05318000
DDRCLASS EQU   DDRCODE2                                                 05319000
DDRCODE1 EQU   DDRFDEV                                                  05320000
DDRFCUA  EQU   DDRREC+45                                                05321000
DDRPHD   EQU   @NM00052+20                                              05322000
DDRVOL2  EQU   @NM00052+14                                              05323000
DDRVOL1  EQU   @NM00052+8                                               05324000
DDRJOBID EQU   @NM00052                                                 05325000
DDRCEL   EQU   DDRCPUID+6                                               05326000
DDRMOD   EQU   DDRCPUID+4                                               05327000
DDRSER   EQU   DDRCPUID+1                                               05328000
@NM00051 EQU   DDRCPUID                                                 05329000
DDRTIME  EQU   DDRHEAD+12                                               05330000
DDRDATE  EQU   DDRHEAD+8                                                05331000
@NM00050 EQU   DDRHEAD+4                                                05332000
DDRDEPSW EQU   DDRSMS+1                                                 05333000
@NM00049 EQU   DDRSMS                                                   05334000
DDRKEY2  EQU   DDRKEY+1                                                 05335000
DDRKEY1  EQU   DDRKEY                                                   05336000
IPLSHSEC EQU   IPLSTIME+3                                               05337000
IPLSSEC  EQU   IPLSTIME+2                                               05338000
IPLSMIN  EQU   IPLSTIME+1                                               05339000
IPLSHOUR EQU   IPLSTIME                                                 05340000
IPLSDATE EQU   IPLREC+48                                                05341000
IPLTEMP  EQU   IPLREC+46                                                05342000
IPLHIGH  EQU   IPLREC+42                                                05343000
IPLCHAN  EQU   IPLREC+32                                                05344000
@NM00048 EQU   IPLREC+30                                                05345000
IPLREAS  EQU   IPLREC+28                                                05346000
@NM00047 EQU   IPLREC+25                                                05347000
IPLSYSID EQU   IPLREC+24                                                05348000
IPLCEL   EQU   IPLCPUID+6                                               05349000
IPLMOD   EQU   IPLCPUID+4                                               05350000
IPLSER   EQU   IPLCPUID+1                                               05351000
@NM00046 EQU   IPLCPUID                                                 05352000
IPLTIME  EQU   IPLHEAD+12                                               05353000
IPLDATE  EQU   IPLHEAD+8                                                05354000
@NM00045 EQU   IPLHEAD+4                                                05355000
IPLSMS   EQU   IPLHEAD+2                                                05356000
IPLKEY2  EQU   IPLKEY+1                                                 05357000
IPLKEY1  EQU   IPLKEY                                                   05358000
SFTXDATA EQU   SFTREC+434                                               05359000
SFTLVARA EQU   SFTREC+432                                               05360000
SFTREXN  EQU   SFTRECP+16                                               05361000
SFTCSECT EQU   SFTRECP+8                                                05362000
SFTMODN  EQU   SFTRECP                                                  05363000
@NM00044 EQU   SFTSDWA+238                                              05364000
SFTLCPUA EQU   SFTSDWA+236                                              05365000
SFTERRD  EQU   SFTFLGS+3                                                05366000
SFTERRC  EQU   SFTFLGS+2                                                05367000
SFTERRB  EQU   SFTFLGS+1                                                05368000
SFTERRA  EQU   SFTFLGS                                                  05369000
@NM00043 EQU   SFTSDWA+136                                              05370000
SFTAAEC1 EQU   SFTSDWA+120                                              05371000
@NM00042 EQU   SFTSDWA+112                                              05372000
SFTPROGC EQU   SFTAEC1+8                                                05373000
@NM00041 EQU   SFTAEC1                                                  05374000
@NM00040 EQU   SFTSDWA+88                                               05375000
SFTGRSV  EQU   SFTSDWA+24                                               05376000
SFTABNDC EQU   SFTSDWA                                                  05377000
SFTJOBID EQU   SFTREC+24                                                05378000
SFTCEL   EQU   SFTCPUID+6                                               05379000
SFTMOD   EQU   SFTCPUID+4                                               05380000
SFTSER   EQU   SFTCPUID+1                                               05381000
@NM00039 EQU   SFTCPUID                                                 05382000
SFTTIME  EQU   SFTHEAD+12                                               05383000
SFTDATE  EQU   SFTHEAD+8                                                05384000
@NM00038 EQU   SFTHEAD+4                                                05385000
SFTSMS   EQU   SFTHEAD+2                                                05386000
SFTKEY2  EQU   SFTKEY+1                                                 05387000
@NM00037 EQU   OBRTERMN                                                 05388000
@NM00036 EQU   OBRSEEK+1                                                05389000
OBRTCAM  EQU   OBRSEEK                                                  05390000
OBRVOL   EQU   OBRREC+64                                                05391000
OBRSBCNT EQU   OBRREC+62                                                05392000
OBRRETRY EQU   OBRREC+60                                                05393000
OBRTYPE  EQU   OBRDEV+1                                                 05394000
OBRCLASS EQU   OBRDEV                                                   05395000
OBRCODE1 EQU   OBRCODE                                                  05396000
OBRSECUA EQU   OBRREC+49                                                05397000
OBRSTAT  EQU   OBRCSW+4                                                 05398000
@NM00035 EQU   OBRCSW                                                   05399000
OBRSDRS2 EQU   OBRSRDS                                                  05400000
OBRSDRS1 EQU   OBRSRDS                                                  05401000
OBRSDEV1 EQU   OBRJOBID                                                 05402000
OBRCEL   EQU   OBRCPUID+6                                               05403000
OBRMOD   EQU   OBRCPUID+4                                               05404000
OBRSER   EQU   OBRCPUID+1                                               05405000
@NM00034 EQU   OBRCPUID                                                 05406000
OBRTIME  EQU   OBRHEAD+12                                               05407000
OBRDATE  EQU   OBRHEAD+8                                                05408000
@NM00033 EQU   OBRHEAD+4                                                05409000
@NM00032 EQU   OBRSUBTP                                                 05410000
@NM00031 EQU   OBRSUBTP                                                 05411000
@NM00030 EQU   MISCSW                                                   05412000
TRUNC    EQU   MISCSW                                                   05413000
@NM00029 EQU   MISCSW                                                   05414000
OBRKEY2  EQU   OBRKEY+1                                                 05415000
OBRKEY1  EQU   OBRKEY                                                   05416000
CCHLOG   EQU   CCHREC+80                                                05417000
CCHMP    EQU   CCHREC+76                                                05418000
@NM00028 EQU   CCHREC+73                                                05419000
CCHID    EQU   CCHREC+72                                                05420000
CCHTYPE  EQU   CCHCODE2+1                                               05421000
CCHCLASS EQU   CCHCODE2                                                 05422000
CCHCODE1 EQU   CCHCODE                                                  05423000
CCHECSW  EQU   CCHREC+64                                                05424000
CCHCSW   EQU   CCHREC+56                                                05425000
CCHFCCW  EQU   CCHREC+48                                                05426000
CCHATIO  EQU   CCHREC+32                                                05427000
CCHJOBID EQU   CCHREC+24                                                05428000
CCHCEL   EQU   CCHCPUID+6                                               05429000
CCHMOD   EQU   CCHCPUID+4                                               05430000
CCHSER   EQU   CCHCPUID+1                                               05431000
@NM00027 EQU   CCHCPUID                                                 05432000
CCHTIME  EQU   CCHHEAD+12                                               05433000
CCHDATE  EQU   CCHHEAD+8                                                05434000
@NM00026 EQU   CCHHEAD+4                                                05435000
CCHRINC  EQU   CCHSMS+1                                                 05436000
@NM00025 EQU   CCHSMS                                                   05437000
CCHRCRH  EQU   CCHSMS                                                   05438000
@NM00024 EQU   CCHSMS                                                   05439000
CCHKEY2  EQU   CCHKEY+1                                                 05440000
CCHKEY1  EQU   CCHKEY                                                   05441000
MCHLOG   EQU   MCHREC+48                                                05442000
MCHOPSW  EQU   MCHREC+40                                                05443000
MCHJOBID EQU   MCHREC+32                                                05444000
MCHPGMID EQU   MCHREC+24                                                05445000
MCHCEL   EQU   MCHCPUID+6                                               05446000
MCHMOD   EQU   MCHCPUID+4                                               05447000
MCHSER   EQU   MCHCPUID+1                                               05448000
@NM00023 EQU   MCHCPUID                                                 05449000
MCHTIME  EQU   MCHHEAD+12                                               05450000
MCHDATE  EQU   MCHHEAD+8                                                05451000
@NM00022 EQU   MCHHEAD+4                                                05452000
@NM00021 EQU   MCHSMS                                                   05453000
MCHKEY2  EQU   MCHKEY+1                                                 05454000
MCHKEY1  EQU   MCHKEY                                                   05455000
LRTMCEL  EQU   LRTCPU+6                                                 05456000
@NM00020 EQU   LRTCPU                                                   05457000
LRTHSECS EQU   LRTTIME+3                                                05458000
LRTSEC   EQU   LRTTIME+2                                                05459000
LRTMIN   EQU   LRTTIME+1                                                05460000
LRTHOUR  EQU   LRTTIME                                                  05461000
LRTDAY   EQU   LRTYRDAY+1                                               05462000
LRTYEAR  EQU   LRTYRDAY                                                 05463000
LRTDATE0 EQU   LRTDATE                                                  05464000
@NM00019 EQU   @NM00017+3                                               05465000
@NM00018 EQU   @NM00017                                                 05466000
LRTDSMNT EQU   LRTERRID                                                 05467000
@NM00016 EQU   LRTERRID                                                 05468000
LRTSHRT  EQU   LRTERRID                                                 05469000
@NM00015 EQU   LRTERRID                                                 05470000
@NM00014 EQU   LRTSMS                                                   05471000
LRTIMCNV EQU   LRTSMS                                                   05472000
@NM00013 EQU   LRTSMS                                                   05473000
LRNS     EQU   LRTSMS                                                   05474000
LRTKEY2  EQU   LRTKEY+1                                                 05475000
TMPTEMP  EQU   TMP2+9                                                   05476000
TMPPERM  EQU   TMPPERM1+1                                               05477000
@NM00012 EQU   TMPPERM1                                                 05478000
TMPDEV   EQU   TMPKEY+5                                                 05479000
TMPOLDA  EQU   TMPITEM                                                  05480000
TMP3705  EQU   TMPITEM                                                  05481000
TMPOLD   EQU   TMPCPUS                                                  05482000
TMPCPU   EQU   TMPCPUS                                                  05483000
TMPCUA   EQU   TMPSRT                                                   05484000
TMPGROUP EQU   TMPKEY                                                   05485000
TMTTEMP  EQU   TMT2+10                                                  05486000
TMTPERM  EQU   TMTPERM1+1                                               05487000
@NM00011 EQU   TMTPERM1                                                 05488000
TMTDEV   EQU   TMTKEY+6                                                 05489000
TMTDAT   EQU   TMTKEY+5                                                 05490000
TMTOLDA  EQU   TMTITEM                                                  05491000
TMT3705  EQU   TMTITEM                                                  05492000
TMTOLD   EQU   TMTCPUS                                                  05493000
TMTCPU   EQU   TMTCPUS                                                  05494000
TMTCUA   EQU   TMTSRT                                                   05495000
TMTGROUP EQU   TMTKEY                                                   05496000
SYMVAL2  EQU   SYMVAL+2                                                 05497000
SYMVAL1  EQU   SYMVAL                                                   05498000
SYMCDNUM EQU   SYMCODE                                                  05499000
LIBVAL   EQU   LIBADR+2                                                 05500000
LIBADNUM EQU   LIBADR                                                   05501000
CPUCUX3  EQU   CPUCUAV+5                                                05502000
CPUCUX2  EQU   CPUCUAV+3                                                05503000
CPUCUX1  EQU   CPUCUAV                                                  05504000
CPCUANUM EQU   CPUCUAS                                                  05505000
VOLVAL   EQU   VOLUME+2                                                 05506000
VOLNUM   EQU   VOLUME                                                   05507000
SERVAL   EQU   DEVSERAL+2                                               05508000
SERNUM   EQU   DEVSERAL                                                 05509000
MODVAL   EQU   MODELS+2                                                 05510000
MODNUM   EQU   MODELS                                                   05511000
LOADPTR  EQU   EDITABLE+8                                               05512000
LOADNAME EQU   EDITABLE                                                 05513000
EDITNUM  EQU   EDITLOAD                                                 05514000
SORTCORE EQU   SORTCCHR                                                 05515000
SORTTIME EQU   SORTKEY+1                                                05516000
SORTYEAR EQU   SORTKEY                                                  05517000
EVDAY    EQU   EVSTOP+1                                                 05518000
EVYEAR   EQU   EVSTOP                                                   05519000
TREPRE   EQU   TREGEN+72                                                05520000
TRECCHF  EQU   TREGEN+68                                                05521000
TRECCHE  EQU   TREGEN+64                                                05522000
TRECCHD  EQU   TREGEN+60                                                05523000
TRECCHC  EQU   TREGEN+56                                                05524000
TRECCHB  EQU   TREGEN+52                                                05525000
TRECCHA  EQU   TREGEN+48                                                05526000
TRECCH9  EQU   TREGEN+44                                                05527000
TRECCH8  EQU   TREGEN+40                                                05528000
TRECCH7  EQU   TREGEN+36                                                05529000
TRECCH6  EQU   TREGEN+32                                                05530000
TRECCH5  EQU   TREGEN+28                                                05531000
TRECCH4  EQU   TREGEN+24                                                05532000
TRECCH3  EQU   TREGEN+20                                                05533000
TRECCH2  EQU   TREGEN+16                                                05534000
TRECCH1  EQU   TREGEN+12                                                05535000
TRECCH0  EQU   TREGEN+8                                                 05536000
TREMCH   EQU   TREGEN+4                                                 05537000
TREIPL   EQU   TREGEN                                                   05538000
TRENUM   EQU   TRENDONE+4                                               05539000
TRENEXT  EQU   TRENDONE                                                 05540000
DUMPSIZE EQU   DUMPINFO+4                                               05541000
DUMPADR  EQU   DUMPINFO                                                 05542000
DUMPNUM  EQU   DUMPTABL                                                 05543000
@NM00010 EQU   PARM+212                                                 05544000
RECLNGT1 EQU   PARM+204                                                 05545000
ADCPUT   EQU   PARM+144                                                 05546000
LINECT   EQU   PARM+120                                                 05547000
RECLNGTH EQU   CCHHRLNG+6                                               05548000
@NM00009 EQU   CCHHRLNG+5                                               05549000
USERPGM  EQU   PARM+102                                                 05550000
IDTSEC   EQU   IDTIME+3                                                 05551000
IDSEC    EQU   IDTIME+2                                                 05552000
IDMIN    EQU   IDTIME+1                                                 05553000
IDHOUR   EQU   IDTIME                                                   05554000
IDASID   EQU   ERRID+4                                                  05555000
IDCPU    EQU   ERRID+3                                                  05556000
@NM00008 EQU   ERRID+2                                                  05557000
IDVALUE  EQU   ERRID                                                    05558000
NUMDAYS  EQU   PARM+88                                                  05559000
SYSRETRN EQU   @NM00007                                                 05560000
@NM00006 EQU   PARM+72                                                  05561000
WRTHRSH  EQU   PARM+69                                                  05562000
RDTHRSH  EQU   PARM+66                                                  05563000
TERM     EQU   PARM+58                                                  05564000
EVSDAY   EQU   STRTDATE+1                                               05565000
EVSYEAR  EQU   STRTDATE                                                 05566000
PENSEC2  EQU   ENDTIME2+2                                               05567000
PENMIN2  EQU   ENDTIME2+1                                               05568000
PENHOUR2 EQU   ENDTIME2                                                 05569000
PSTSEC2  EQU   STTIME2+2                                                05570000
PSTMIN2  EQU   STTIME2+1                                                05571000
PSTHOUR2 EQU   STTIME2                                                  05572000
PENSEC1  EQU   ENDTIME1+2                                               05573000
PENMIN1  EQU   ENDTIME1+1                                               05574000
PENHOUR1 EQU   ENDTIME1                                                 05575000
PSTSEC1  EQU   STTIME1+2                                                05576000
PSTMIN1  EQU   STTIME1+1                                                05577000
PSTHOUR1 EQU   STTIME1                                                  05578000
@NM00005 EQU   ENDDT+4                                                  05579000
PENDY    EQU   PEND+1                                                   05580000
PENYR    EQU   PEND                                                     05581000
@NM00004 EQU   ENDDATE                                                  05582000
@NM00003 EQU   STDT+4                                                   05583000
PSTDY    EQU   PSTD+1                                                   05584000
PSTYR    EQU   PSTD                                                     05585000
@NM00002 EQU   STDATE                                                   05586000
YEARNOW  EQU   DATENOW+4                                                05587000
@NM00001 EQU   DATENOW+3                                                05588000
DAYNOW   EQU   DATENOW                                                  05589000
CSNAP    EQU   CLOSEIO                                                  05590000
CSYSIN   EQU   CLOSEIO                                                  05591000
CACCDEV  EQU   CLOSEIO                                                  05592000
CSERLOG  EQU   CLOSEIO                                                  05593000
CEREPPT  EQU   CLOSEIO                                                  05594000
CTOURIST EQU   CLOSEIO                                                  05595000
OSNAP    EQU   OPENIO                                                   05596000
ODRCTWRK EQU   OPENIO                                                   05597000
OSYSIN   EQU   OPENIO                                                   05598000
OACCDEV  EQU   OPENIO                                                   05599000
OACCIN   EQU   OPENIO                                                   05600000
OSERLOG  EQU   OPENIO                                                   05601000
OEREPPT  EQU   OPENIO                                                   05602000
OTOURIST EQU   OPENIO                                                   05603000
PLOGREC  EQU   MISC                                                     05604000
ERRORID  EQU   MISC                                                     05605000
PSUM     EQU   PRINTES                                                  05606000
PEDIT    EQU   PRINTES                                                  05607000
PZERO    EQU   MISC                                                     05608000
DEBUG63  EQU   DEBUGA+3                                                 05609000
DEBUG62  EQU   DEBUGA+3                                                 05610000
DEBUG61  EQU   DEBUGA+3                                                 05611000
DEBUG60  EQU   DEBUGA+3                                                 05612000
DEBUG59  EQU   DEBUGA+3                                                 05613000
DEBUG58  EQU   DEBUGA+3                                                 05614000
DEBUG57  EQU   DEBUGA+3                                                 05615000
DEBUG56  EQU   DEBUGA+3                                                 05616000
DEBUG55  EQU   DEBUGA+2                                                 05617000
DEBUG54  EQU   DEBUGA+2                                                 05618000
DEBUG53  EQU   DEBUGA+2                                                 05619000
DEBUG52  EQU   DEBUGA+2                                                 05620000
DEBUG51  EQU   DEBUGA+2                                                 05621000
DEBUG49  EQU   DEBUGA+2                                                 05622000
DEBUG48  EQU   DEBUGA+2                                                 05623000
DEBUG47  EQU   DEBUGA+1                                                 05624000
DEBUG46  EQU   DEBUGA+1                                                 05625000
DEBUG45  EQU   DEBUGA+1                                                 05626000
DEBUG44  EQU   DEBUGA+1                                                 05627000
DEBUG43  EQU   DEBUGA+1                                                 05628000
DEBUG42  EQU   DEBUGA+1                                                 05629000
DEBUG41  EQU   DEBUGA+1                                                 05630000
DEBUG40  EQU   DEBUGA+1                                                 05631000
DEBUG39  EQU   DEBUGA                                                   05632000
DEBUG38  EQU   DEBUGA                                                   05633000
DEBUG37  EQU   DEBUGA                                                   05634000
DEBUG36  EQU   DEBUGA                                                   05635000
DEBUG35  EQU   DEBUGA                                                   05636000
DEBUG34  EQU   DEBUGA                                                   05637000
DEBUG33  EQU   DEBUGA                                                   05638000
DEBUG32  EQU   DEBUGA                                                   05639000
DEBUG31  EQU   DEBUG+3                                                  05640000
DEBUG30  EQU   DEBUG+3                                                  05641000
DEBUG29  EQU   DEBUG+3                                                  05642000
DEBUG28  EQU   DEBUG+3                                                  05643000
DEBUG27  EQU   DEBUG+3                                                  05644000
DEBUG26  EQU   DEBUG+3                                                  05645000
DEBUG25  EQU   DEBUG+3                                                  05646000
DEBUG24  EQU   DEBUG+3                                                  05647000
DEBUG22  EQU   DEBUG+2                                                  05648000
DEBUG21  EQU   DEBUG+2                                                  05649000
DEBUG20  EQU   DEBUG+2                                                  05650000
DEBUG19  EQU   DEBUG+2                                                  05651000
DEBUG18  EQU   DEBUG+2                                                  05652000
DEBUG17  EQU   DEBUG+2                                                  05653000
DEBUG15  EQU   DEBUG+1                                                  05654000
DEBUG14  EQU   DEBUG+1                                                  05655000
DEBUG13  EQU   DEBUG+1                                                  05656000
DEBUG12  EQU   DEBUG+1                                                  05657000
DEBUG10  EQU   DEBUG+1                                                  05658000
DEBUG9   EQU   DEBUG+1                                                  05659000
DEBUG8   EQU   DEBUG+1                                                  05660000
DEBUG7   EQU   DEBUG                                                    05661000
DEBUG6   EQU   DEBUG                                                    05662000
DEBUG5   EQU   DEBUG                                                    05663000
DEBUG3   EQU   DEBUG                                                    05664000
DEBUG2   EQU   DEBUG                                                    05665000
DEBUG1   EQU   DEBUG                                                    05666000
DEBUG0   EQU   DEBUG                                                    05667000
SORTBRK  EQU   SWITCHES+1                                               05668000
COREFAIL EQU   SWITCHES+1                                               05669000
ANALYSIS EQU   SWITCHES+1                                               05670000
NOTALL   EQU   SWITCHES+1                                               05671000
NOSDR    EQU   SWITCHES                                                 05672000
TIMESEQ  EQU   SWITCHES                                                 05673000
SYSUM    EQU   SWITCHES                                                 05674000
PARMTHR  EQU   SWITCHES                                                 05675000
TREND    EQU   SWITCHES                                                 05676000
SHORTOBR EQU   SWITCHES                                                 05677000
PARMMES  EQU   SWITCHES                                                 05678000
RDESUM   EQU   SWITCHES                                                 05679000
PCCHFRAM EQU   RECTYPE+1                                                05680000
PMCHFRAM EQU   RECTYPE+1                                                05681000
PTTYP    EQU   RECTYPE+1                                                05682000
PEOD     EQU   RECTYPE                                                  05683000
PMIH     EQU   RECTYPE                                                  05684000
PDDR     EQU   RECTYPE                                                  05685000
PIPL     EQU   RECTYPE                                                  05686000
PSOFT    EQU   RECTYPE                                                  05687000
POBR     EQU   RECTYPE                                                  05688000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05689000
@RF00394 EQU   @EL00005                                                 05690000
@RC00421 EQU   @EL00006                                                 05691000
@RC00398 EQU   @EL00006                                                 05692000
@RF00438 EQU   @EL00006                                                 05693000
@RC00462 EQU   @RC00457                                                 05694000
@RC00574 EQU   @EL00011                                                 05695000
@RC00577 EQU   @EL00011                                                 05696000
@RC00580 EQU   @EL00011                                                 05697000
@RC00586 EQU   @EL00011                                                 05698000
@RC00593 EQU   @EL00011                                                 05699000
@RC00611 EQU   @EL00011                                                 05700000
@RC00618 EQU   @EL00011                                                 05701000
@RC00633 EQU   @EL00012                                                 05702000
@RC00636 EQU   @EL00012                                                 05703000
@RC00640 EQU   @EL00012                                                 05704000
@RF00687 EQU   @EL00013                                                 05705000
@RF00696 EQU   @EL00013                                                 05706000
@RF00731 EQU   @RC00729                                                 05707000
@RF00746 EQU   @RC00744                                                 05708000
@RF00721 EQU   @EL00014                                                 05709000
@RF00765 EQU   @EL00014                                                 05710000
@RF00777 EQU   @EL00015                                                 05711000
@RF00789 EQU   @EL00016                                                 05712000
@RF00801 EQU   @EL00017                                                 05713000
@RC00805 EQU   @EL00018                                                 05714000
@RC00811 EQU   @EL00018                                                 05715000
@RC00817 EQU   @EL00018                                                 05716000
@RC00823 EQU   @EL00018                                                 05717000
@RC00829 EQU   @EL00018                                                 05718000
@RF00835 EQU   @EL00018                                                 05719000
@RF00849 EQU   @EL00019                                                 05720000
@RC00847 EQU   @EL00019                                                 05721000
@RF00869 EQU   @RC00867                                                 05722000
@RF00954 EQU   @RC00945                                                 05723000
@RF01022 EQU   @EL00021                                                 05724000
@RF01026 EQU   @EL00021                                                 05725000
@RC01033 EQU   @EL00022                                                 05726000
@RF01082 EQU   @EL00023                                                 05727000
@RF01093 EQU   @EL00024                                                 05728000
@RC01106 EQU   @EL00025                                                 05729000
@RC01112 EQU   @EL00025                                                 05730000
@RF01118 EQU   @EL00025                                                 05731000
@RC01241 EQU   @RC01239                                                 05732000
@RF01259 EQU   @EL00029                                                 05733000
@RF01301 EQU   @RC01264                                                 05734000
@RF01337 EQU   @EL00031                                                 05735000
@RC01350 EQU   @EL00032                                                 05736000
@PB00032 EQU   @EL00001                                                 05737000
@RC00400 EQU   @RC00398                                                 05738000
@RF00417 EQU   @RC00398                                                 05739000
@RF00598 EQU   @RC00593                                                 05740000
@RF00643 EQU   @RC00640                                                 05741000
@RF00651 EQU   @RC00640                                                 05742000
@RC01035 EQU   @RC01033                                                 05743000
@PB00031 EQU   @PB00032                                                 05744000
@RC01352 EQU   @RC01350                                                 05745000
@RC01364 EQU   @RC01350                                                 05746000
@RF01054 EQU   @RC01035                                                 05747000
@PB00030 EQU   @PB00031                                                 05748000
@RF01357 EQU   @RC01352                                                 05749000
@RC01367 EQU   @RC01364                                                 05750000
@PB00029 EQU   @PB00030                                                 05751000
@RF01371 EQU   @RC01367                                                 05752000
@RF01373 EQU   @RC01367                                                 05753000
@RC01375 EQU   @RC01367                                                 05754000
@RC01382 EQU   @RC01367                                                 05755000
@PB00028 EQU   @PB00029                                                 05756000
@PB00027 EQU   @PB00028                                                 05757000
@PB00026 EQU   @PB00027                                                 05758000
@PB00025 EQU   @PB00026                                                 05759000
@PB00024 EQU   @PB00025                                                 05760000
@PB00023 EQU   @PB00024                                                 05761000
@PB00022 EQU   @PB00023                                                 05762000
@PB00021 EQU   @PB00022                                                 05763000
@PB00020 EQU   @PB00021                                                 05764000
@PB00019 EQU   @PB00020                                                 05765000
@PB00018 EQU   @PB00019                                                 05766000
@PB00017 EQU   @PB00018                                                 05767000
@PB00016 EQU   @PB00017                                                 05768000
@PB00015 EQU   @PB00016                                                 05769000
@PB00014 EQU   @PB00015                                                 05770000
@PB00013 EQU   @PB00014                                                 05771000
@PB00012 EQU   @PB00013                                                 05772000
@PB00011 EQU   @PB00012                                                 05773000
@PB00010 EQU   @PB00011                                                 05774000
@PB00009 EQU   @PB00010                                                 05775000
@PB00008 EQU   @PB00009                                                 05776000
@PB00007 EQU   @PB00008                                                 05777000
@PB00006 EQU   @PB00007                                                 05778000
@PB00005 EQU   @PB00006                                                 05779000
@PB00004 EQU   @PB00005                                                 05780000
@PB00003 EQU   @PB00004                                                 05781000
@PB00002 EQU   @PB00003                                                 05782000
@RF00242 EQU   @PB00002                                                 05783000
@ENDDATA EQU   *                                                        05784000
         END   IFCFILT2                                                 05785000
