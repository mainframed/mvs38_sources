         TITLE 'IFCIOHND-IO SERVICES MODULE FOR IFCEREP1               *00001000
                        '                                               00002000
IFCIOHND CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IFCIOHND  78.012'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         STM   @00,@06,20(@13)                                     0001 00011000
         STM   @08,@12,52(@13)                                     0001 00012000
         BALR  @11,0                                               0001 00013000
@PSTART  LA    @10,4095(,@11)                                      0001 00014000
         LA    @09,4095(,@10)                                      0001 00015000
         LA    @08,4095(,@09)                                      0001 00016000
         USING @PSTART,@11                                         0001 00017000
         USING @PSTART+4095,@10                                    0001 00018000
         USING @PSTART+8190,@09                                    0001 00019000
         USING @PSTART+12285,@08                                   0001 00020000
         ST    @13,@SA00001+4                                      0001 00021000
         LA    @14,@SA00001                                        0001 00022000
         ST    @14,8(,@13)                                         0001 00023000
         LR    @13,@14                                             0001 00024000
*DCL ADDNUM(1) CHAR(1) BASED(ADDNXT);                      /*@Z427VLS*/ 00025000
*DCL NEXTBY FIXED(31) INIT(0);                             /*@Z427VLS*/ 00026000
*DCL ADDNXT FIXED(31) INIT(0);                             /*@Z427VLS*/ 00027000
*DCL NUMBER FIXED(31) INIT(0);                             /*@Z427VLS*/ 00028000
*DCL GETTIT CHAR(4) DEFINED(GETHIS); /*ALPHA ACCESS OF GETHIS*/    0069 00029000
*DCL LISTPTR PTR(31) BASED(PTRSPOT); /*POINTER TO LIST PARAMETER*/ 0070 00030000
*DCL INARG  FIXED(15) BASED(LISTPTR); /*INPUT PARAMETER WITH @Z427VLS*/ 00031000
*                                     /*SERVICE REQUESTED CODE*/   0072 00032000
*DCL LINECTT FIXED(15) INIT(0); /*RUNNING LINE COUNT FOR PAGE SKIPIN */ 00033000
*DCL LINEMAX FIXED(15) INIT(0); /*MAXIMUM LINES PER PAGE, TOURIST*/     00034000
*DCL CCSAVE  CHAR(1) INIT(' '); /*CARRIAGE CONTROL CHAR SAVE SPOT*/     00035000
*DCL BLANKS CHAR(134) INIT(' '); /*BLANKS FOR PRINT LINE     @Z427VLS*/ 00036000
*DCL MSGNO  FIXED(31)  INIT(0); /*MESSAGE TEXT INDEX         @Z427VLS*/ 00037000
*DCL BADNEWS FIXED(31) INIT(0); /*RETURN CODE SAVE ITEM      @Z427VLS*/ 00038000
*DCL PACKPAS  CHAR(4) INIT('    ');                        /*@Z427VLS*/ 00039000
*DCL CHARPAS  CHAR(8) INIT('        ');                    /*@Z427VLS*/ 00040000
*DCL PASSNUM  FIXED(31) INIT(0);                           /*@Z427VLS*/ 00041000
*DCL EDIFILD(9) CHAR(1);                                   /*@Z427VLS*/ 00042000
*DCL EDFLD CHAR(9) DEFINED(EDIFILD);                       /*@Z427VLS*/ 00043000
*DCL CTPTR(10) FIXED(31) DEFINED(CONTPTR);                 /*@Z427VLS*/ 00044000
*DCL CHARS CHAR(16) INIT('0123456789ABCDEF');              /*@Z427VLS*/ 00045000
*/********************************************************************/ 00046000
*DCL CLOSEALL BIT(16) CONSTANT('FFFF'X); /*EOF ALL CLOSED MASK*/   0085 00047000
*DCL SKIPNEW BIT(8) CONSTANT('8B'X);          /* SKIP TO CHANNEL ONE*/  00048000
*DCL NODSETS BIT(16) CONSTANT('0000'X); /*NO DATA SETS ASKED OPEN*/     00049000
*DCL DBLWORD BIT(32) CONSTANT('00000007'X); /*NO DOUBLE WORD MASK*/     00050000
*DCL NULL    BIT(32) CONSTANT('00000000'X);                /*@Z427VLS*/ 00051000
*DCL CHARZERO BIT(8) CONSTANT('F0'X);                      /*@Z427VLS*/ 00052000
*DCL BLANK    BIT(8) CONSTANT('40'X);                      /*@Z427VLS*/ 00053000
*/********************************************************************/ 00054000
*DCL  1  IOPLINE  CHAR(134)  BASED(PRINTADR), /*PRINT WORK AREA DSECT*/ 00055000
*      2 PRINTDS  CHAR(1), /*DATA SET IS ERREPT IF F0        @Z427VLS*/ 00056000
*                          /*DATA SET IS TOURIST IF F1       @Z427VLS*/ 00057000
*      2 PRINTCC  CHAR(1), /*CARRIAGE CONTROL CHARACTER, IGNORED*/ 0092 00058000
*                          /*IF FROM USER FOR TOURIST DATA SET*/   0092 00059000
*      2 PRINTBDY CHAR(132); /*LINE TO BE PRINTED, WILL BE CLEARED*/    00060000
*                            /*TO BLANKS BEFORE RETURN TO USER*/   0093 00061000
*DCL 1 ERRLINE(29), /*INTERNAL DEBUG15 MESSAGES              @G51DGBB*/ 00062000
*    2 ERRDS CHAR(1) INIT((29)'1'),                                0093 00063000
*    2 ERRCS CHAR(1) INIT((29)' '),                                0093 00064000
*    2 PRINTNM CHAR(9) INIT((29)'DEBUG15  '),                      0093 00065000
*    2 PRNTXT CHAR(40)                                             0093 00066000
*INIT('SERLOG OPEN ATTEMPTED                   ',  /*53      @Z427VLS*/ 00067000
*     'CHECK HEADER FOR MORE RECORDS ATTEMPTED ', /*54       @Z427VLS*/ 00068000
*     'RESET OF SERLOG HEADER ATTEMPTED        ', /*55       @Z427VLS*/ 00069000
*     'SERLOG CLOSE ATTEMPTED                  ', /*56       @Z427VLS*/ 00070000
*     'ZEROALL ATTEMPTED                       ', /*57       @Z427VLS*/ 00071000
*     'SDR COUNTER DUMP ATTEMPTED              ', /*58       @Z427VLS*/ 00072000
*     'SYSIN OPEN ATTEMPTED                    ', /*59       @Z427VLS*/ 00073000
*     'SYSIN CLOSE ATTEMPTED                   ', /*60       @Z427VLS*/ 00074000
*     'DIRECTWK CLOSE FOR WRITING ATTEMPTED    ', /*61       @Z427VLS*/ 00075000
*     'DIRECTWK CLOSE FOR READING ATTEMPTED    ', /*62       @Z427VLS*/ 00076000
*     'DIRECTWK OPEN FOR WRITE ATTEMPTED      ', /*63        @Z427VLS*/ 00077000
*     'ACCIN OPEN ATTEMPTED                    ', /*64       @Z427VLS*/ 00078000
*     'ACCIN CLOSE ATTEMPTED                   ', /*65       @Z427VLS*/ 00079000
*     'ACCDEV CLOSE ATTEMPTED                  ', /*66       @Z427VLS*/ 00080000
*     'EREPPT OPEN ATTEMPTED                   ', /*67       @Z427VLS*/ 00081000
*     'EREPPT CLOSE ATTEMPTED                  ', /*68       @Z427VLS*/ 00082000
*     'ACCDEV OPEN ATTEMPTED                   ',  /*69TH ENTRY*/  0093 00083000
*     'FIRST FRAME READ ATTEMPT                ',                  0093 00084000
*     'TIMES IFCIOHND EXITED WITH R.C.12       ', /*70       @Z427VLS*/ 00085000
*     'SERLOG SEQUENTIAL READ ATTEMPTS         ', /*71       @Z427VLS*/ 00086000
*     'SERLOG DIRECT READ ATTEMPTS             ', /*72       @Z427VLS*/ 00087000
*     'TIME CONVERSION NECESSARY NUM. TIMES    ', /*73       @Z427VLS*/ 00088000
*     'RECORDS SAVED DURING ZEROALL PROCESSING ', /*74       @Z427VLS*/ 00089000
*     'SYSIN READ ATTEMPTS                     ', /*75       @Z427VLS*/ 00090000
*     'DIRECTWK WRITE ATTEMPTS                 ', /*76       @Z427VLS*/ 00091000
*     'DIRECTWK READ ATTEMPTS                  ', /*77       @Z427VLS*/ 00092000
*     'ACCIN SEQUENTIAL READ ATTEMPTS          ', /*78       @Z427VLS*/ 00093000
*     'ACCDEV WRITE ATTEMPTS                   ',                  0093 00094000
*     'FRAME READ ATTEMPTS OF SYS1.LOGREC      ');         /*@G51DGBB*/ 00095000
*DCL MACHCODE(256) CHAR(1) /* ENSURE VALID MACHINE CODE      @ZA18999*/ 00096000
*INIT( (11)'09'X,'0B'X,(5)'09'X,'11'X,'09'X,'13'X,(5)'09'X,        0094 00097000
*      '19'X,'09'X,'1B'X,(109)'09'X,'89'X,'09'X,'8B'X,             0094 00098000
*       (5)'09'X,'91'X,'09'X,'93'X,(5)'09'X,'99'X,                 0094 00099000
*       '09'X,'9B'X,(5)'09'X,'A1'X,'09'X,'A3'X,                    0094 00100000
*       (5)'09'X,'A9'X,'09'X,'AB'X,(5)'09'X,'B1'X,                 0094 00101000
*       '09'X,'B3'X,(5)'09'X,'B9'X,'09'X,'BB'X,(5)'09'X,           0094 00102000
*       'C1'X,'09'X,'C3'X,(5)'09'X,'C9'X,'09'X,'CB'X,              0094 00103000
*       (5)'09'X,'D1'X,'09'X,'D3'X,(5)'09'X,'D9'X,                 0094 00104000
*        '09'X,'DB'X,(5)'09'X,'E1'X,'09'X,'E3'X,(20)'09'X);/*@ZA18999*/ 00105000
*/********************************************************************/ 00106000
*DCL PRNTBF CHAR(134) BDY(DWORD); /*INTERNAL PRINT LINE BUFFER*/   0095 00107000
*/********************************************************************/ 00108000
*DCL 1  BUF1 BDY(DWORD), /*WORK AREA FOR QSAM RECORDS        @Z427VLS*/ 00109000
*     2 BUF1RDW, /*RECORD DESCRIPTOR WORD                    @Z427VLS*/ 00110000
*     3 BUF1RDWL FIXED(15) INIT(0), /*QSAM RECORD LENGTH     @Z427VLS*/ 00111000
*     3 BUF1L    FIXED(15) INIT(0), /*QSAM ZEROS             @Z427VLS*/ 00112000
*     2 BUF1DTA  CHAR(2000);    /*MAXIMUM SYS1.LOGREC RECORD LENGTH*/   00113000
*/*******************************************************************/  00114000
*DCL  1 RECTB BASED(RUNPTR), /*ZEROALL RECORD SAVE AREA DSECT*/    0097 00115000
*     2 FORPTR  PTR(31),                                           0097 00116000
*     2 JUNK,                                                      0097 00117000
*     3 JUNK1   CHAR(5),                                           0097 00118000
*     3 JUNK2   CHAR(1),                                           0097 00119000
*     3 JUNK3   FIXED(15),                                         0097 00120000
*     2 RECSPT  CHAR(1894);                                /*@Z427VLS*/ 00121000
*/*******************************************************************/  00122000
* DCL 1 IOSWTCH CHAR(3) INIT('000000'X), /*NEW SWITCHES      @Z427VLS*/ 00123000
*     2 HISTOPN BIT(1), /*OUTPUT HIST IS OPENED FLAG         @Z427VLS*/ 00124000
*     2 SECGET   BIT(1), /*ZEROALL GETMAIN SWITCH            @Z427VLS*/ 00125000
*     2 FLIPFLOP BIT(1), /*OFF SERLOG READSEQ, ON ACCIN READSEQ*/  0098 00126000
*     2 HISTYES BIT(1), /*INDICATES ACCIN INPUT SPECIFIED    @Z427VLS*/ 00127000
*     2 DBLYES  BIT(1), /*DOUBLE WORD CREATION LOOP EXIT SWITCH*/  0098 00128000
*     2 LASTLOOP BIT(1),  /*ZEROALL PROCESSING               @Z427VLS*/ 00129000
*     2 TOURERR BIT(1), /*ERROR WITH TOURIST DATA SET        @Z427VLS*/ 00130000
*     2 INHISO  BIT(1), /*INPUT HIST IS IPENED FLAG          @Z427VLS*/ 00131000
*     2 SERLO   BIT(1), /*SERLOG IS OPENED FLAG              @Z427VLS*/ 00132000
*     2 TWOTRY  BIT(1), /*OFF IMPLIES 1ST EOF READING SERLOG SEQ.*/     00133000
*     2 INDIR   BIT(1), /*DIRECTWK IS OPENED FOR SEQ WRITE   @Z427VLS*/ 00134000
*     2 NONBLANK BIT(1), /*NONBLANK LOOP FINDER SWITCH       @Z427VLS*/ 00135000
*     2 CLOSE2  BIT(1), /*DIRECTWK IS OPENED FOR DIR WRITE   @Z427VLS*/ 00136000
*     2 SYSOPN  BIT(1), /*SYSIN IS OPENED SWITCH             @Z427VLS*/ 00137000
*     2 TOUROPN  BIT(1), /*TOURIST DS IS OPENED SWITCH       @Z427VLS*/ 00138000
*     2 ERPTOPN  BIT(1), /*REGULAR PRINT D.S. HAS BEEN OPENED*/    0098 00139000
*    2 READFR   BIT(1), /*FRAMES ARE BEING READ SWITCH       @G51DGBB*/ 00140000
*    2 SCRATCH  BIT(1), /*LAST OPERATION WAS READ DIRECT     @G51DGBB*/ 00141000
*     2 SNAPOP  BIT(1); /*SNAP DS HAS BEEN OPENED SWITCH     @Z427VLS*/ 00142000
*/********************************************************************/ 00143000
*DCL    1   HDRBUFF   CHAR(64) BDY(DWORD),   /* EXTRACTOR WORK AREA  */ 00144000
*          2   HDRSEEK             CHAR(8),  /* SEEK FIELD FOR I/O   */ 00145000
*             3   HDRM             CHAR(1) INIT('00'X),            0099 00146000
*             3   HDRBB            CHAR(2) INIT('0000'X),          0099 00147000
*             3   HDRCC            CHAR(2) INIT('0000'X),          0099 00148000
*             3   HDRHH            CHAR(2) INIT('0000'X),          0099 00149000
*             3   HDRR             CHAR(1) INIT('00'X),            0099 00150000
*          2   HEADER              CHAR(40), /* HEADER REC - LOGREC  */ 00151000
*             3   HDRKEY           CHAR(2),  /* FF00-HDR SOURCE FLD  */ 00152000
*             3   HDRSCC           CHAR(2),  /* START OF     @Z427VLS*/ 00153000
*             3   HDRSHH           CHAR(2),  /* SYS1.LOGREC  @Z427VLS*/ 00154000
*             3   HDRECC           CHAR(2),  /* END OF       @Z427VLS*/ 00155000
*             3   HDREHH           CHAR(2),  /* SYS1.LOGREC  @Z427VLS*/ 00156000
*             3   HDRCOUNT         CHAR(1),  /* COUNT OF FULL MSG */    00157000
*             3   HDRREC1          CHAR(7),  /* CCHHR OF 1ST REC     */ 00158000
*                4   HDR1BB        CHAR(2),                        0099 00159000
*                4   HDR1CC        CHAR(2),                        0099 00160000
*                4   HDR1HH        CHAR(2),                        0099 00161000
*                4   HDR1R         CHAR(1),                        0099 00162000
*             3   HDRREM           CHAR(2),  /* NO. OF BYTES REMAING */ 00163000
*             3   HDRTRKCP         CHAR(2),  /* TRK CAPACITY @Z427VLS*/ 00164000
*             3   HDRREC2          CHAR(7),  /* LAST ACTIVE RECORD   */ 00165000
*                4   HDR2BB        CHAR(2),                        0099 00166000
*                4   HDR2CC        CHAR(2),                        0099 00167000
*                4   HDR2HH        CHAR(2),                        0099 00168000
*                4   HDR2R         CHAR(1),                        0099 00169000
*             3   HDRUCBNO         CHAR(2),  /* NO. OF UCB'S @Z427VLS*/ 00170000
*             3   HDREXSZE         CHAR(2),  /* NO. OF TRK'S @Z427VLS*/ 00171000
*             3   HDRTYPE          CHAR(1),  /* RES TYPE     @Z427VLS*/ 00172000
*             3   *                CHAR(4),                        0099 00173000
*             3   *                CHAR(1),                        0099 00174000
*                4   HDRWNGBT       BIT(1),  /* 90% FULL SWITCH      */ 00175000
*                4   *              BIT(1),                        0099 00176000
*                4   FRAMES         BIT(1), /*FRAMES EXIST FLAG*/  0099 00177000
*                4   *              BIT(4),                        0099 00178000
*             3   HDRSAFE          CHAR(1),  /* X'FF' INDICATES RECOK*/ 00179000
*          2   PREVSEEK            CHAR(8),  /* PREVIOUS SEEK FIELD  */ 00180000
*             3   PREVM            CHAR(1) INIT('FF'X), /* FF=CLOSED */ 00181000
*             3   PREVBB           CHAR(2),                        0099 00182000
*             3   PREVCC           CHAR(2),                        0099 00183000
*             3   PREVHH           CHAR(2),                        0099 00184000
*             3   PREVR            CHAR(1);                /*@G51DGBB*/ 00185000
*DCL     LOGRECA    CHAR(11) INIT('SYS1.LOGREC'); /* ENQUE/DEQUE     */ 00186000
*DCL     LOGRECB    CHAR(8)  INIT('RECORDER');    /* NAMES FOR SYSTEM*/ 00187000
*DCL     RESID      CHAR(8)  INIT('SERLOG');      /* & STEP ENQ/DEQ  */ 00188000
*DCL     RESIDII    CHAR(8)  INIT('LOGREC');      /*         @Z427VLS*/ 00189000
*DCL     SDRK  FIXED(15) INIT(0);                          /*@Z427VLS*/ 00190000
*DCL     ZEROA CHAR(24);                                   /*@Z427VLS*/ 00191000
*DCL 1 SEEKSAVE CHAR(8) INIT('0000000000000000'X), /*BEGINNING OF LOG*/ 00192000
*    2 *      CHAR(7),                                             0106 00193000
*    2 SKSAVREC CHAR(1); /*R PORTION OF MBBCCHHR             @G51DGBB*/ 00194000
*DCL     BYTESREM(14) FIXED(15)                             /*XL03145*/ 00195000
*                        INIT(00000,    /* SPARE  CODE 00    @Z427VLS*/ 00196000
*                             03419,    /* 2311   CODE 01    @Z427VLS*/ 00197000
*                             20137,    /* 2301   CODE 02    @Z427VLS*/ 00198000
*                             04596,    /* 2303   CODE 03    @Z427VLS*/ 00199000
*                             04778,    /* 2302   CODE 04    @Z427VLS*/ 00200000
*                             00000,    /* SPARE  CODE 05    @Z427VLS*/ 00201000
*                             13192,    /* 2305-1 CODE 06    @Z427VLS*/ 00202000
*                             14184,    /* 2305-2 CODE 07    @Z427VLS*/ 00203000
*                             07008,    /* 2314   CODE 08    @Z427VLS*/ 00204000
*                             12680,    /* 3330   CODE 09    @Z427VLS*/ 00205000
*                             07954,    /* 3340   CODE 0A    @Z427VLS*/ 00206000
*                             18800,    /* 3350   CODE 0B    @Z40RIVS*/ 00207000
*                             00000,    /* SPARE  CODE 0C    @Z427VLS*/ 00208000
*                             12680);   /* 3330-1 CODE 0D    @Z427VLS*/ 00209000
*/********************************************************************/ 00210000
*/*                                                          @Z427VLS*/ 00211000
*/*      ECB,IOB,& CCW'S FOR EXCP                            @Z427VLS*/ 00212000
*/*                                                          @Z427VLS*/ 00213000
*/********************************************************************/ 00214000
*DCL    1   XWRECB  FIXED(31) INIT(0),  /* ECB               @Z427VLS*/ 00215000
*          2   POST      CHAR(1),                                  0108 00216000
*          2   *         CHAR(3);                          /*@Z427VLS*/ 00217000
*DCL    1   XIOB    CHAR(40) BDY(DWORD),                           0109 00218000
*          2   XIOBFL1   CHAR(1) INIT('42'X),                      0109 00219000
*          2   XIOBFL2   CHAR(1) INIT('00'X),                      0109 00220000
*          2   XIOBSNS0  CHAR(1) INIT('00'X),                      0109 00221000
*          2   XIOBSNS1  CHAR(1) INIT('00'X),                      0109 00222000
*          2   XIOBECB   PTR(31) INIT(ADDR(XWRECB)),               0109 00223000
*          2   XIOBCSW   CHAR(8) INIT('0000000000000000'X),        0109 00224000
*          2   XIOBCCW   PTR(31) INIT(ADDR(SEQ)),                  0109 00225000
*          2   XIOBDCB   PTR(31),                                  0109 00226000
*          2   XIOBRA    PTR(31) INIT(0),                          0109 00227000
*          2   XIOBBEC   FIXED(31) INIT(0),                        0109 00228000
*          2   XIOBSEEK  CHAR(8),                                  0109 00229000
*             3   XIOBM  CHAR(1)  INIT('00'X),                     0109 00230000
*             3   XIOBBB CHAR(2)  INIT('0000'X),                   0109 00231000
*             3   XIOBCC CHAR(2)  INIT('0000'X),                   0109 00232000
*             3   XIOBHH CHAR(2)  INIT('0000'X),                   0109 00233000
*             3   XIOBR  CHAR(1)  INIT('00'X);             /*@Z427VLS*/ 00234000
*DCL    1   SWITCH  BIT(8) INIT('00'X), /* INTERNAL SWITCH   @Z427VLS*/ 00235000
*          2   SBT0      BIT(1),        /* DISK OPEN         @Z427VLS*/ 00236000
*          2   SBT2      BIT(1),        /* WRITE REQUIRED    @Z427VLS*/ 00237000
*          2   SBT3      BIT(1),        /*                   @Z427VLS*/ 00238000
*          2   SBT4      BIT(1),        /* HEADER RECORD I/O @Z427VLS*/ 00239000
*          2   SBT7      BIT(1);        /* INTERNAL ENQ ISSUED       */ 00240000
*DCL    1   SEQ     CHAR(24) BDY(DWORD),/* CCW STRING        @Z427VLS*/ 00241000
*          2   SID1       CHAR(8),                /* SEARCH ID EQUAL */ 00242000
*             3   *       CHAR(1) INIT('31'X),                     0111 00243000
*             3   AREAADR PTR(24) BDY(BYTE),      /* PTR TO COUNT FLD*/ 00244000
*             3   *       CHAR(2) INIT('4000'X),                   0111 00245000
*             3   *       FIXED(15) BDY(BYTE) INIT(5),             0111 00246000
*          2   TIC1       CHAR(8),                /* TRANSFER IN CHAN*/ 00247000
*            3    *       CHAR(1) INIT('08'X),                     0111 00248000
*             3   *       PTR(24) BDY(BYTE) INIT(ADDR(SID1)),      0111 00249000
*             3   *       CHAR(2) INIT('4000'X),                   0111 00250000
*             3   *       FIXED(15) BDY(BYTE) INIT(1),             0111 00251000
*          2   CKD1       CHAR(8),                /* R/W COUNT KEY & */ 00252000
*             3   CKDCOM  CHAR(1),                /* DATA    @Z427VLS*/ 00253000
*             3   CKDAREA  PTR(24) BDY(BYTE),     /* DATA PTR        */ 00254000
*             3   CKDCHAIN CHAR(1) INIT('20'X),                    0111 00255000
*             3   *        CHAR(1) INIT('00'X),                    0111 00256000
*             3   CKDCOUNT FIXED(15) BDY(BYTE);   /* SIZE OF RECORD  */ 00257000
*/********************************************************************/ 00258000
*/*                                                          @Z427VLS*/ 00259000
*/*      CONSTANTS & WORK AREAS FOR TIME/DATE CONVERSION     @Z427VLS*/ 00260000
*/*                                                          @Z427VLS*/ 00261000
*/********************************************************************/ 00262000
*DCL    1   WORK8   CHAR(8) BDY(DWORD),                            0112 00263000
*          2   WORK         FIXED(31),                             0112 00264000
*          2   WORKB        FIXED(31),                             0112 00265000
*             3   WHOURS     CHAR(1),                              0112 00266000
*             3   WMINS      CHAR(1),                              0112 00267000
*             3   WDAYS      CHAR(2),                              0112 00268000
*                4   WSECS   CHAR(1),                              0112 00269000
*                4   WTNTHS  CHAR(1);                      /*@Z427VLS*/ 00270000
*DCL     TIMDIV     FIXED(31);                             /*@Z427VLS*/ 00271000
*DCL     MILLION    FIXED(31) INIT(1000000);               /*@Z427VLS*/ 00272000
*DCL     TWENTY4    FIXED(31) INIT(24);                    /*@Z427VLS*/ 00273000
*DCL     SIXTY      FIXED(31) INIT(60);                    /*@Z427VLS*/ 00274000
*DCL     CONSTG     FIXED(31) INIT('30040'X);              /*@Z427VLS*/ 00275000
*DCL     CONSTH     FIXED(31) INIT('24AE062'X);            /*@Z427VLS*/ 00276000
*DCL     SIXTYMIL   FIXED(31) INIT(60000000);              /*@Z427VLS*/ 00277000
*DCL     PATCH(20) FIXED(15) INIT((20)0);    /* PATCH AREA   @Z427VLS*/ 00278000
*GENERATE DATA;                                            /*@Z427VLS*/ 00279000
*/********************************************************************/ 00280000
*/*                                                          @Z427VLS*/ 00281000
*/*      BASED DCL'S                                         @Z427VLS*/ 00282000
*/*                                                          @Z427VLS*/ 00283000
*/********************************************************************/ 00284000
*/*                                                          @Z427VLS*/ 00285000
*/*      DSECT OF HEADER                                     @Z427VLS*/ 00286000
*/*                                                          @Z427VLS*/ 00287000
*DCL    1   OHEADER           CHAR(40) BASED(R4),                  0122 00288000
*          2   OHDRKEY        CHAR(2),                             0122 00289000
*          2   OHDRSCC        CHAR(2),                             0122 00290000
*          2   OHDRSHH        CHAR(2),                             0122 00291000
*          2   OHDRECC        CHAR(2),                             0122 00292000
*          2   OHDREHH        CHAR(2),                             0122 00293000
*          2   OHDRHI         CHAR(1),                             0122 00294000
*          2   OHDRREC1       CHAR(7),                             0122 00295000
*             3   OHDR1BB     CHAR(2),                             0122 00296000
*             3   OHDR1CC     CHAR(2),                             0122 00297000
*             3   OHDR1HH     CHAR(2),                             0122 00298000
*             3   OHDR1R      CHAR(1),                             0122 00299000
*          2   OHDRREM        CHAR(2),                             0122 00300000
*          2   OHDRTRXC       CHAR(2),                             0122 00301000
*          2   OHDRREC2       CHAR(7),                             0122 00302000
*             3   OHDR2BB     CHAR(2),                             0122 00303000
*             3   OHDR2CC     CHAR(2),                             0122 00304000
*             3   OHDR2HH     CHAR(2),                             0122 00305000
*             3   OHDR2R      CHAR(1),                             0122 00306000
*          2   OHDRUCBN       CHAR(2),                             0122 00307000
*          2   OHDREXSZ       CHAR(2),                             0122 00308000
*          2   OHDRTYP        CHAR(1),                             0122 00309000
*          2   *              CHAR(5),                             0122 00310000
*          2   OHDRSAFE       CHAR(1);                     /*@Z427VLS*/ 00311000
*/*                                                          @Z427VLS*/ 00312000
*/*      DSECT OF INPUT BUFFER                               @Z427VLS*/ 00313000
*/*                                                          @Z427VLS*/ 00314000
*DCL    1   BUFFER  DEFINED(BUF1), /*USE FOR SERLOP EXCP READS*/   0123 00315000
*          2   BCOUNT              CHAR(8),  /* COUNT AREA   @Z427VLS*/ 00316000
*             3   BCCHHR           CHAR(5),  /* COUNT FROM REC       */ 00317000
*             3   BKEYL            CHAR(1),  /* KEY LENGTH=0 @Z427VLS*/ 00318000
*             3   BSIZE            CHAR(2),  /* SIZE OF RECORD READ  */ 00319000
*          2   BDATA                 CHAR(1900);           /*@G51DGBB*/ 00320000
*DCL  BSZ FIXED(15) DEFINED(BSIZE); /*ACCESS BSIZE AS NUMERIC*/    0124 00321000
*DCL SAVELENT FIXED(15) INIT(0); /*DATA LENGTH + 4 FROM READSEQ*/  0125 00322000
*DCL  BBRDW CHAR(2) DEFINED(BCCHHR) POSITION(5); /*USE TO SHUFFLE*/     00323000
*                                /*LOGREC RECORD INTO V FORMAT*/   0127 00324000
*/*                                                          @Z427VLS*/ 00325000
*/*      DSCECT OF AN INPUT RECORD                           @Z427VLS*/ 00326000
*/*                                                          @Z427VLS*/ 00327000
*DCL    1   RECAREA              BASED(TIMEBASE),                  0127 00328000
*          2   RECKEY              CHAR(1),                        0127 00329000
*          2   *                   CHAR(1),                        0127 00330000
*          2   *                   CHAR(6),                        0127 00331000
*             3   *                 BIT(1),                        0127 00332000
*             3   NSSWITCH          BIT(1),  /* NS TIME INDICATOR    */ 00333000
*             3   *                 BIT(2),                        0127 00334000
*             3   LCSWITCH          BIT(1),  /* LOCAL TIME  INDICATOR*/ 00335000
*             3   *                 BIT(3),                        0127 00336000
*          2   DATETIME            CHAR(8),                        0127 00337000
*             3   DATE             CHAR(4),                        0127 00338000
*                4   DATE0         CHAR(1),                        0127 00339000
*                   5   GMTSW       BIT(1),                        0127 00340000
*                   5   *           BIT(7),                        0127 00341000
*                4   YEAR          CHAR(1),                        0127 00342000
*                4   DAYS          CHAR(2),                        0127 00343000
*             3   TIME             CHAR(4),                        0127 00344000
*                4   HOURS         CHAR(1),                        0127 00345000
*                4   MINS          CHAR(1),                        0127 00346000
*                4   SECS          CHAR(1),                        0127 00347000
*                4   TNTHS         CHAR(1);                /*@Z427VLS*/ 00348000
*/********************************************************************/ 00349000
*/*                                                          @Z427VLS*/ 00350000
*/*      EQUATES                                             @Z427VLS*/ 00351000
*/*                                                          @Z427VLS*/ 00352000
*/********************************************************************/ 00353000
*GENERATE ;                                                /*@Z427VLS*/ 00354000
L0       EQU   0                                                        00355000
L1       EQU   1                                                        00356000
L2       EQU   2                                                        00357000
L4       EQU   4                                                        00358000
L6       EQU   6                                                        00359000
L8       EQU   8                                                        00360000
L10      EQU   10                                                       00361000
L12      EQU   12                                                       00362000
L19      EQU   19                                                       00363000
L20      EQU   20                                                       00364000
L24      EQU   24                                                       00365000
L36      EQU   36                                                       00366000
L38      EQU   38                                                       00367000
L256     EQU   256                                                      00368000
OPENOK   EQU   X'10'                                                    00369000
ZR0      EQU   8                                                        00370000
*DCL THCONV FIXED(31) INIT(10000);                         /*@Z427VLS*/ 00371000
*/********************************************************************/ 00372000
*/*                                                          @Z427VLS*/ 00373000
*/*      STARTING LOCATION FOR IFCIOHND                      @Z427VLS*/ 00374000
*/*                                                          @Z427VLS*/ 00375000
*                                      /*R2 HAS COMTABLE ADDRESS*/ 0130 00376000
*PTRSPOT = R1; /*GET PARAMETER LIST ADDRESS OF ADDRESS       @Z427VLS*/ 00377000
         ST    R1,PTRSPOT                                          0130 00378000
*SAVER2 = R2; /*PRESUME THAT R2 HAS ADDRESS OF COMTABLE AT THIS POINT*/ 00379000
         ST    R2,SAVER2                                           0131 00380000
*GENERATE;                                                 /*@Z427VLS*/ 00381000
         USING IHADCB,R12      USE R12 FOR ADDRESSING DCBS              00382000
*BADNEWS = ZERO; /*RETURN CODE SAVE ITEM                     @Z427VLS*/ 00383000
         SLR   @12,@12                                             0133 00384000
         ST    @12,BADNEWS                                         0133 00385000
*RESPECIFY (R2,R1) UNRESTRICTED;                           /*@Z427VLS*/ 00386000
*/*DETERMINE SERVICE CALLER HAS REQUESTED AND BRANCH TO APPROPRIATE*/   00387000
*/*ROUTINE                                                   @Z427VLS*/ 00388000
*IF INARG = READSEQ THEN /*IF READ OF SERLOG OR ACCIN REQUESTED*/  0135 00389000
         L     @12,PTRSPOT                                         0135 00390000
         L     @12,LISTPTR(,@12)                                   0135 00391000
         CLC   INARG(2,@12),@CH00077                               0135 00392000
         BNE   @RF00135                                            0135 00393000
*  CALL READSIT;                                           /*@Z427VLS*/ 00394000
         BAL   @14,READSIT                                         0136 00395000
*ELSE                                                              0137 00396000
*  DO;                                                     /*@Z427VLS*/ 00397000
         B     @RC00135                                            0137 00398000
@RF00135 DS    0H                                                  0138 00399000
*    IF INARG = READIRCT THEN                                      0138 00400000
         L     @12,PTRSPOT                                         0138 00401000
         L     @12,LISTPTR(,@12)                                   0138 00402000
         CLC   INARG(2,@12),@CH00082                               0138 00403000
         BNE   @RF00138                                            0138 00404000
*      CALL DIRECTIT; /*EXCP READ OF SERLOG OR POINT SEQ. READ OF WORK* 00405000
         BAL   @14,DIRECTIT                                        0139 00406000
*    ELSE                                                          0140 00407000
*      DO;                                                 /*@Z427VLS*/ 00408000
         B     @RC00138                                            0140 00409000
@RF00138 DS    0H                                                  0141 00410000
*        IF INARG = RITEHIST THEN                                  0141 00411000
         L     @12,PTRSPOT                                         0141 00412000
         L     @12,LISTPTR(,@12)                                   0141 00413000
         CLC   INARG(2,@12),@CH00065                               0141 00414000
         BNE   @RF00141                                            0141 00415000
*          CALL HISTIT; /*QSAM WRITE TO ACCDEV, HISTORY OUTPUT*/   0142 00416000
         BAL   @14,HISTIT                                          0142 00417000
*        ELSE                                                      0143 00418000
*          DO;                                             /*@Z427VLS*/ 00419000
         B     @RC00141                                            0143 00420000
@RF00141 DS    0H                                                  0144 00421000
*            IF INARG = RITESCRT THEN /*SEQUENTIAL NOTE WRITE TO WORK*/ 00422000
         L     @12,PTRSPOT                                         0144 00423000
         L     @12,LISTPTR(,@12)                                   0144 00424000
         CLC   INARG(2,@12),@CH00080                               0144 00425000
         BNE   @RF00144                                            0144 00426000
*              CALL SCRCHIT;                               /*@Z427VLS*/ 00427000
         BAL   @14,SCRCHIT                                         0145 00428000
*            ELSE                                                  0146 00429000
*              DO;                                         /*@Z427VLS*/ 00430000
         B     @RC00144                                            0146 00431000
@RF00144 DS    0H                                                  0147 00432000
*                IF INARG = RITEPRTR THEN                          0147 00433000
         L     @12,PTRSPOT                                         0147 00434000
         L     @12,LISTPTR(,@12)                                   0147 00435000
         CLC   INARG(2,@12),@CH00075                               0147 00436000
         BNE   @RF00147                                            0147 00437000
*                  CALL PRINTIT;                           /*@Z427VLS*/ 00438000
         BAL   @14,PRINTIT                                         0148 00439000
*                ELSE                                              0149 00440000
*                  DO;                                     /*@Z427VLS*/ 00441000
         B     @RC00147                                            0149 00442000
@RF00147 DS    0H                                                  0150 00443000
*                    IF INARG = IOOPEN THEN                        0150 00444000
         L     @12,PTRSPOT                                         0150 00445000
         L     @12,LISTPTR(,@12)                                   0150 00446000
         CLC   INARG(2,@12),@CH00056                               0150 00447000
         BNE   @RF00150                                            0150 00448000
*                      CALL OPENIT;                        /*@Z427VLS*/ 00449000
         BAL   @14,OPENIT                                          0151 00450000
*                    ELSE                                          0152 00451000
*                      DO;                                 /*@Z427VLS*/ 00452000
         B     @RC00150                                            0152 00453000
@RF00150 DS    0H                                                  0153 00454000
*                        IF INARG = IOCLOSE THEN                   0153 00455000
         L     @12,PTRSPOT                                         0153 00456000
         L     @12,LISTPTR(,@12)                                   0153 00457000
         CLC   INARG(2,@12),@CH00037                               0153 00458000
         BNE   @RF00153                                            0153 00459000
*                          CALL CLOSIT;                    /*@Z427VLS*/ 00460000
         BAL   @14,CLOSIT                                          0154 00461000
*                        ELSE                                      0155 00462000
*                          DO;                             /*@Z427VLS*/ 00463000
         B     @RC00153                                            0155 00464000
@RF00153 DS    0H                                                  0156 00465000
*                                IF INARG = READCARD THEN          0156 00466000
         L     @12,PTRSPOT                                         0156 00467000
         L     @12,LISTPTR(,@12)                                   0156 00468000
         CLC   INARG(2,@12),@CH00034                               0156 00469000
         BNE   @RF00156                                            0156 00470000
*                                  CALL REEDSYS;           /*@Z427VLS*/ 00471000
         BAL   @14,REEDSYS                                         0157 00472000
*                                ELSE                              0158 00473000
*                                  DO;                     /*@Z427VLS*/ 00474000
         B     @RC00156                                            0158 00475000
@RF00156 DS    0H                                                  0159 00476000
*                                     MSGNO = 1;           /*@Z427VLS*/ 00477000
         MVC   MSGNO(4),@CF00056                                   0159 00478000
*                                     CALL ERRMSG;         /*@Z427VLS*/ 00479000
         BAL   @14,ERRMSG                                          0160 00480000
*                                  END;                    /*@Z427VLS*/ 00481000
*                           END;                           /*@Z427VLS*/ 00482000
@RC00156 DS    0H                                                  0163 00483000
*                       END;                               /*@Z427VLS*/ 00484000
@RC00153 DS    0H                                                  0164 00485000
*                    END;                                  /*@Z427VLS*/ 00486000
@RC00150 DS    0H                                                  0165 00487000
*                END;                                      /*@Z427VLS*/ 00488000
@RC00147 DS    0H                                                  0166 00489000
*             END;                                         /*@Z427VLS*/ 00490000
@RC00144 DS    0H                                                  0167 00491000
*          END;                                            /*@Z427VLS*/ 00492000
@RC00141 DS    0H                                                  0168 00493000
*       END;                                               /*@Z427VLS*/ 00494000
@RC00138 DS    0H                                                  0169 00495000
*GOBACK: ;                                                 /*@Z427VLS*/ 00496000
@RC00135 DS    0H                                                  0169 00497000
GOBACK   DS    0H                                                  0170 00498000
*RESPECIFY(R15) RESTRICTED;                                /*@Z427VLS*/ 00499000
*R15 = BADNEWS;                                            /*@Z427VLS*/ 00500000
         L     R15,BADNEWS                                         0171 00501000
*IF R15 > FOUR THEN /*FIND OUT IF USER CHECKING RETURN CODE  @Z427VLS*/ 00502000
         C     R15,@CF00065                                        0172 00503000
         BNH   @RF00172                                            0172 00504000
*  ERRORENT = ERRORENT + 1; /*USER BUNGLE IF MORE THAN ONE   @Z427VLS*/ 00505000
         LA    @14,1                                               0173 00506000
         AL    @14,ERRORENT                                        0173 00507000
         ST    @14,ERRORENT                                        0173 00508000
*RETURN;                                                   /*@Z427VLS*/ 00509000
@EL00001 L     @13,4(,@13)                                         0174 00510000
@EF00001 DS    0H                                                  0174 00511000
@ER00001 L     @14,12(,@13)                                        0174 00512000
         LM    @00,@06,20(@13)                                     0174 00513000
         LM    @08,@12,52(@13)                                     0174 00514000
         BR    @14                                                 0174 00515000
*     /*THIS IS A STRUCTURED PROC TO REPLACE EXCPLOOP        @G51DGBB*/ 00516000
*     /*OTHERWISE, THE ONLY CHANGES ARE THAT ALL REFERENCES  @G51DGBB*/ 00517000
*     /*TO ZEROING INDIVIDUAL RECORDS HAVE BEEN REMOVED AND  @G51DGBB*/ 00518000
*     /*THE LOCATION OF THE BEGINNING OF LOGREC FROM THE DEB @G51DGBB*/ 00519000
*     /*IS SAVED FOR INITIALIZATION TO READ FRAMES           @G51DGBB*/ 00520000
*/*EXCP LOOP THAT PERFORMS ALL IO OPERATIONS TO LOGREC. ONE CCW CHAIN*/ 00521000
*/*IS USE FOR ALL THREE TYPES OF I-O PERFORMED. IN ALL CASES, THE   */  00522000
*/*FIRST CCW  IS A SEARCH FOR A PARTICULAR MBBCCHHR ACTUAL PHYSICAL */  00523000
*/*LOCATION OF A RECORD ON LOGREC ACCROSS THE ENTIRE EXTENT ALLO-   */  00524000
*/*CATED TO LOGREC. THE NEXT CCW IS A TIC WHICH LOOPS BACK TO THE   */  00525000
*/*SEARCH IF THE SEARCH FOR A PARTICULAR RECORD WAS UNSUCCESSFUL    */  00526000
*/*THE TYPES OF OPERATIONS WHICH ARE PERFORMED ARE:          @G51DGBB*/ 00527000
*/* 1. CC= 6, READ LOGREC HEADER BY GIVING MBBCCHHR OF HEADER       */  00528000
*/* 2. CC= 5, WRITE HEADER OF SAME LENGTH BACK TO EXACT LOCATION    */  00529000
*/*           SPECIFIED IN GIVEN MBBCCHHR.                   @G51DGBB*/ 00530000
*/* 3. CC= 158, READ THE NEXT ERROR RECORD AFTER THE RECORD WHOSE   */  00531000
*/*             MBBCCHHR IS GIVEN IN THE SEARCH              @G51DGBB*/ 00532000
*/* R7 = ADDRESS OF AREA IN CORE TO PLACE THE RECORD READ    @G51DGBB*/ 00533000
*RESPECIFY (R7,R5,R12) RESTRICTED;                         /*@G51DGBB*/ 00534000
*EXCPLOOP: PROC;                                           /*@G51DGBB*/ 00535000
EXCPLOOP STM   @14,@12,@SA00002                                    0176 00536000
*CKDAREA = R7; /*SET UP CCW3 CORE ADDRESS TO READ RECORD TO  @G51DGBB*/ 00537000
         STCM  R7,7,CKDAREA                                        0177 00538000
*AREAADR = ADDR(HDRCC); /*SEARCH ID FOR FIRST CCW            @G51DGBB*/ 00539000
         LA    @14,HDRCC                                           0178 00540000
         STCM  @14,7,AREAADR                                       0178 00541000
*IF SBT4 = ON THEN     /*IF HEADER I/O HAS BEEN REQUESTED    @G51DGBB*/ 00542000
         TM    SBT4,B'00010000'                                    0179 00543000
         BNO   @RF00179                                            0179 00544000
*  DO;                                                     /*@G51DGBB*/ 00545000
*    CKDCOUNT = 40;   /*3RD CCW NUMBER OF BYTES IN HEADER TO BE READ*/  00546000
         MVC   CKDCOUNT(2),@CH00463                                0181 00547000
*    IF SBT2 = ON THEN /*IF HEADER IS TO BE WRITTEN THEN     @G51DGBB*/ 00548000
         TM    SBT2,B'01000000'                                    0182 00549000
         BNO   @RF00182                                            0182 00550000
*      CKDCOM = '05'X; /*SET 3RD CCW CHANNEL COMMAND TO WRITE IN PLACE* 00551000
         MVI   CKDCOM,X'05'                                        0183 00552000
*    ELSE              /*IF HEADER IS TO BE READ             @G51DGBB*/ 00553000
*      CKDCOM = '06'X; /*SET 3RD CCW CHANNEL COMMAND TO READ SAME */    00554000
         B     @RC00182                                            0184 00555000
@RF00182 MVI   CKDCOM,X'06'                                        0184 00556000
*                      /*RECORD AS SEARCH ID EQUAL HAS FOUND @G51DGBB*/ 00557000
*    HDRM = '00'X;                                         /*@G51DGBB*/ 00558000
@RC00182 MVI   HDRM,X'00'                                          0185 00559000
*    HDRR = '01'X;    /*HEADER RECORD IS RECORD 1            @G51DGBB*/ 00560000
         MVI   HDRR,X'01'                                          0186 00561000
*    GEN(LA R12,LOGREC); /*SET LOGREC DCB DSECT BASE ADDRESS @G51DGBB*/ 00562000
         LA R12,LOGREC                                                  00563000
*    GEN(L  R5,DCBDEBAD); /*LOAD ADDRESS OF DEB FROM DCB FOR LOGREC*/   00564000
         L  R5,DCBDEBAD                                                 00565000
*    GEN(MVC HDRBB(L6),L36(R5)); /*GET BBCCHH OF BEGINNING OF LOGREC*/  00566000
         MVC HDRBB(L6),L36(R5)                                          00567000
*      /*FROM FIRST EXTENT DIRECT ACCESS EXTENSION TO THE DEB*/    0190 00568000
*    SEEKSAVE = HDRSEEK; /*SAVE FOR USE WHEN READING FRAMES  @G51DGBB*/ 00569000
         MVC   SEEKSAVE(8),HDRSEEK                                 0190 00570000
*    SKSAVREC = '02'X; /*INDICATE TIME STAMP AS RECORD BEFORE 1ST FRM*/ 00571000
         MVI   SKSAVREC,X'02'                                      0191 00572000
*  END;                                                    /*@G51DGBB*/ 00573000
*ELSE  /*IF NORMAL, NON HEADER, READ OF LOGREC               @G51DGBB*/ 00574000
*  DO;                                                     /*@G51DGBB*/ 00575000
         B     @RC00179                                            0193 00576000
@RF00179 DS    0H                                                  0194 00577000
*    HDRSEEK = PREVSEEK; /*SET ADDRESS TO SEEK FROM COUNT FIELD OF */   00578000
         MVC   HDRSEEK(8),PREVSEEK                                 0194 00579000
*                        /*PREVIOUS RECORD                   @G51DGBB*/ 00580000
*    CKDCOM = '9E'X;  /*SET THIRD CCW CHANNEL COMMAND TO SEEK NEXT */   00581000
         MVI   CKDCOM,X'9E'                                        0195 00582000
*                     /*RECORD AFTER RECORD WHOSE SEEK ID EQUAL IS */   00583000
*                     /*FOUND AS RESULT OF CCW1. DONE FOR SPEED*/  0196 00584000
*    CKDCOUNT = 1944; /*SET NUMBER OF BYTES TO READ. INCORRECT LENGTH*/ 00585000
         MVC   CKDCOUNT(2),@CH00917                                0196 00586000
*                     /*ERRORS ARE SUPPRESSED                @G51DGBB*/ 00587000
*  END;                                                    /*@G51DGBB*/ 00588000
*XIOBSEEK = HDRSEEK; /*SET IOB SEEK ADDRESS                  @G51DGBB*/ 00589000
@RC00179 MVC   XIOBSEEK(8),HDRSEEK                                 0198 00590000
*XWRECB = 0;         /*ZERO THE EVENT CONTROL BLOCK          @G51DGBB*/ 00591000
         SLR   @14,@14                                             0199 00592000
         ST    @14,XWRECB                                          0199 00593000
*DO UNTIL POST ^= '44'X; /*LOOP UNTIL IO REQUEST NOT INTERCEPTED*/ 0200 00594000
@DL00200 DS    0H                                                  0201 00595000
*  GEN(EXCP XIOB); /*ISSUE SVC 0                             @G51DGBB*/ 00596000
         EXCP XIOB                                                      00597000
*  GEN(WAIT ECB=XWRECB); /*WAIT FOR COMPLETION OF IO         @G51DGBB*/ 00598000
         WAIT ECB=XWRECB                                                00599000
*END;                                                      /*@G51DGBB*/ 00600000
@DE00200 CLI   POST,X'44'                                          0203 00601000
         BE    @DL00200                                            0203 00602000
*RESPECIFY (R7,R5,R12) UNRESTRICTED;                       /*@G51DGBB*/ 00603000
*END;                                                      /*@G51DGBB*/ 00604000
@EL00002 DS    0H                                                  0205 00605000
@EF00002 DS    0H                                                  0205 00606000
@ER00002 LM    @14,@12,@SA00002                                    0205 00607000
         BR    @14                                                 0205 00608000
*READSER: PROC OPTIONS (DONTSAVE(7)); /*READ SYS1.LOGREC SEQUENTIALLY*/ 00609000
READSER  STM   @14,@06,@SA00003                                    0206 00610000
         STM   @08,@12,@SA00003+36                                 0206 00611000
*  /*PROC HAS BEEN REWRITTEN TO HANDLE READING OF FRAMES AT END OF   */ 00612000
*  /*OF FILE FOR ERROR RECORDS, IF FRAMES EXIST. THE PROC IS NOW     */ 00613000
*  /*STRUCTURED.                                             @G51DGBB*/ 00614000
*RESPECIFY (R7) RESTRICTED;                                /*@G51DGBB*/ 00615000
*RSEQCNT = RSEQCNT + 1; /*COUNT NUMBER OF READ ATTEMPTS      @G51DGBB*/ 00616000
         LA    @14,1                                               0208 00617000
         AL    @14,RSEQCNT                                         0208 00618000
         ST    @14,RSEQCNT                                         0208 00619000
*IF SERLO = YES THEN    /*IF SYS1.LOGREC IS OPEN THEN        @G51DGBB*/ 00620000
         TM    SERLO,B'10000000'                                   0209 00621000
         BNO   @RF00209                                            0209 00622000
*  DO;                                                     /*@G51DGBB*/ 00623000
*    IF READFR = OFF THEN /*IF READING ERROR RECORDS         @G51DGBB*/ 00624000
         TM    READFR,B'10000000'                                  0211 00625000
         BNZ   @RF00211                                            0211 00626000
*      DO;                                                 /*@G51DGBB*/ 00627000
*        IF PREVSEEK(2:8) = HDRREC2 THEN /*IF CURRENT SEEK ADDRESS IS*/ 00628000
         CLC   PREVSEEK+1(7),HDRREC2                               0213 00629000
         BNE   @RF00213                                            0213 00630000
*         /*EQUAL TO LAST ACTIVE RECORD SEEK ADDRESS, IMPLICATION IS */ 00631000
*         /*THAT THIS LAST RECORD HAS ALREADY BEEN READ      @G51DGBB*/ 00632000
*          DO;                                             /*@G51DGBB*/ 00633000
*            IF TWOTRY = NO & /*SECOND TRY FOR EOF ON SEQUENTIAL INPT*/ 00634000
*               LASTLOOP = NO THEN /*NOT AN END OF FILE SAVING OF    */ 00635000
         TM    TWOTRY,B'01000000'                                  0215 00636000
         BNZ   @RF00215                                            0215 00637000
         TM    LASTLOOP,B'00000100'                                0215 00638000
         BNZ   @RF00215                                            0215 00639000
*                                  /*RECORDS DURING ZERO ALL PROCESS*/  00640000
*              DO;                                         /*@G51DGBB*/ 00641000
*                TWOTRY = YES; /*SET SECOND SEQUENTIAL READ TRY FLAG*/  00642000
         OI    TWOTRY,B'01000000'                                  0217 00643000
*                CALL CHECKHDR; /*ANY RECORDS WRITTEN WHILE READING?*/  00644000
         BAL   @14,CHECKHDR                                        0218 00645000
*                IF BADNEWS = FOUR &    /*IF NO NEW RECORDS WRITTEN*/   00646000
*                   FRAMES  = YES THEN  /*AND FRAMES EXIST ON LOGREC*/  00647000
         CLC   BADNEWS(4),@CF00065                                 0219 00648000
         BNE   @RF00219                                            0219 00649000
         TM    FRAMES,B'00100000'                                  0219 00650000
         BNO   @RF00219                                            0219 00651000
*                  DO;                                     /*@G51DGBB*/ 00652000
*                    BADNEWS = ZERO; /*INDICATE NO END OF FILE YET*/    00653000
         SLR   @14,@14                                             0221 00654000
         ST    @14,BADNEWS                                         0221 00655000
*                    READFR = YES; /*SET READ FRAME SWITCH   @G51DGBB*/ 00656000
         OI    READFR,B'10000000'                                  0222 00657000
*                    IF DEBUG15 = ON THEN /*IF DEBUG 15 MONITORING*/    00658000
         L     @14,SAVER2                                          0223 00659000
         TM    DEBUG15(@14),B'00000001'                            0223 00660000
         BNO   @RF00223                                            0223 00661000
*                      DO;                                 /*@G51DGBB*/ 00662000
*                        MSGNO = 70; /*START OF FRAME READ MONITOR*/    00663000
         MVC   MSGNO(4),@CF00924                                   0225 00664000
*                        CALL ERRMSG; /*PRINT MESSAGE TO TOURIST*/ 0226 00665000
         BAL   @14,ERRMSG                                          0226 00666000
*                      END;                                /*@G51DGBB*/ 00667000
*                    PREVSEEK = SEEKSAVE; /*GET TIME STAMP LOCATION*/   00668000
@RF00223 MVC   PREVSEEK(8),SEEKSAVE                                0228 00669000
*                  END;                                    /*@G51DGBB*/ 00670000
*              END;                                        /*@G51DGBB*/ 00671000
*            ELSE  /*EITHER SECOND END OF FILE OR ZEROALL PROCESSING*/  00672000
*              DO;                                         /*@G51DGBB*/ 00673000
         B     @RC00215                                            0231 00674000
@RF00215 DS    0H                                                  0232 00675000
*                IF FRAMES = YES &    /*DO FRAMES EXIST ON SERLOG*/     00676000
*                   LASTLOOP = NO THEN /*NOT ZEROALL PROCESSING  */     00677000
         TM    FRAMES,B'00100000'                                  0232 00678000
         BNO   @RF00232                                            0232 00679000
         TM    LASTLOOP,B'00000100'                                0232 00680000
         BNZ   @RF00232                                            0232 00681000
*                  DO;                                     /*@G51DGBB*/ 00682000
*                    READFR = YES; /*SET READING FRAMES SWITCH*/   0234 00683000
         OI    READFR,B'10000000'                                  0234 00684000
*                    IF DEBUG15 = ON THEN /*IF DEBUG15 MONITORING*/     00685000
         L     @14,SAVER2                                          0235 00686000
         TM    DEBUG15(@14),B'00000001'                            0235 00687000
         BNO   @RF00235                                            0235 00688000
*                      DO;                                 /*@G51DGBB*/ 00689000
*                        MSGNO = 70; /*START OF FRAME READ MESSAGE*/    00690000
         MVC   MSGNO(4),@CF00924                                   0237 00691000
*                        CALL ERRMSG; /*WRITE MESSAGE TO TOURIST*/ 0238 00692000
         BAL   @14,ERRMSG                                          0238 00693000
*                      END;                                /*@G51DGBB*/ 00694000
*                    PREVSEEK = SEEKSAVE; /*GET STARTING LOCATION*/     00695000
@RF00235 MVC   PREVSEEK(8),SEEKSAVE                                0240 00696000
*                    /*OF LOGREC FROM DEB. IMPLICATION IS THAT   */     00697000
*                    /*1ST FRAME MUST BE ON SAME TRACK AS HEADER */     00698000
*                   END;                                   /*@G51DGBB*/ 00699000
*                 ELSE  /*LEGITIMATE END OF FILE             @G51DGBB*/ 00700000
*                   BADNEWS = FOUR; /*INDICATE EOF TO WORLD  @G51DGBB*/ 00701000
         B     @RC00232                                            0242 00702000
@RF00232 MVC   BADNEWS(4),@CF00065                                 0242 00703000
*               END;                                       /*@G51DGBB*/ 00704000
*           END;                                           /*@G51DGBB*/ 00705000
*      END;                                                /*@G51DGBB*/ 00706000
*    ELSE  /*FRAMES ARE BEING READ                           @G51DGBB*/ 00707000
*      DO;                                                 /*@G51DGBB*/ 00708000
         B     @RC00211                                            0246 00709000
@RF00211 DS    0H                                                  0247 00710000
*        IF PREVSEEK(2:8) = HDRREC1 THEN /*IF SEEK ADDRESS FOR */  0247 00711000
         CLC   PREVSEEK+1(7),HDRREC1                               0247 00712000
         BNE   @RF00247                                            0247 00713000
*          /*PREVIOUS RECORD IS EQUAL TO SEEK ADDRESS OF LAST FRAME*/   00714000
*          /*THEN END OF FILE ON LOGREC HAS BEEN REACHED     @G51DGBB*/ 00715000
*          BADNEWS = FOUR; /*INDICATE END OF FILE            @G51DGBB*/ 00716000
         MVC   BADNEWS(4),@CF00065                                 0248 00717000
*        ELSE  /*NOT LAST FRAME                              @G51DGBB*/ 00718000
*          RFRCOUNT = RFRCOUNT + 1; /*COUNT FRAMES FOR DEBUG16 TOTAL*/  00719000
         B     @RC00247                                            0249 00720000
@RF00247 LA    @14,1                                               0249 00721000
         AL    @14,RFRCOUNT                                        0249 00722000
         ST    @14,RFRCOUNT                                        0249 00723000
*      END;                                                /*@G51DGBB*/ 00724000
@RC00247 DS    0H                                                  0251 00725000
*    IF BADNEWS = ZERO THEN /*IF NO EOF OR ERROR CONDITIONS THEN*/ 0251 00726000
@RC00211 L     @14,BADNEWS                                         0251 00727000
         LTR   @14,@14                                             0251 00728000
         BNZ   @RF00251                                            0251 00729000
*      DO;                                                 /*@G51DGBB*/ 00730000
*        R7 = ADDR(BUF1); /*ADDRESS READ BUFFER              @G51DGBB*/ 00731000
         LA    R7,BUF1                                             0253 00732000
*        CALL EXCPLOOP; /*ISSUE EXCP READ                    @G51DGBB*/ 00733000
         BAL   @14,EXCPLOOP                                        0254 00734000
*        IF POST ^= '7F'X THEN /*IF UNSUCCESSFULL READ       @G51DGBB*/ 00735000
         CLI   POST,X'7F'                                          0255 00736000
         BE    @RF00255                                            0255 00737000
*          DO;                                             /*@G51DGBB*/ 00738000
*            IF POST = '42'X THEN /*OUT OF LOGREC EXTENT ERROR*/   0257 00739000
         CLI   POST,X'42'                                          0257 00740000
         BNE   @RF00257                                            0257 00741000
*              MSGNO = 14;                                 /*@G51DGBB*/ 00742000
         MVC   MSGNO(4),@CF00759                                   0258 00743000
*            ELSE   /* HARD I-O ERROR                        @G51DGBB*/ 00744000
*              MSGNO = 39;                                 /*@G51DGBB*/ 00745000
         B     @RC00257                                            0259 00746000
@RF00257 MVC   MSGNO(4),@CF00925                                   0259 00747000
*            CALL ERRMSG;                                  /*@G51DGBB*/ 00748000
@RC00257 BAL   @14,ERRMSG                                          0260 00749000
*            BADNEWS = TWELVE;                             /*@G51DGBB*/ 00750000
         MVC   BADNEWS(4),@CF00068                                 0261 00751000
*          END;                                            /*@G51DGBB*/ 00752000
*        ELSE /*SUCCESSFUL READ                              @G51DGBB*/ 00753000
*          DO;                                             /*@G51DGBB*/ 00754000
         B     @RC00255                                            0263 00755000
@RF00255 DS    0H                                                  0264 00756000
*            PREVCC(1:5) = BCOUNT; /*DIRECT ACCESS ADDRESS,CCHHR,*/     00757000
         MVC   PREVCC(5),BCOUNT                                    0264 00758000
*           /*OF RECORD LAST READ FROM COUNT RECORD PRECEEDING DATA*/   00759000
*           /*RECORD ON COUNT,DATA FORMATTED DIRECT ACCESS FILE*/  0265 00760000
*            FLIPFLOP = NO; /*INDICATE SEQUENTIAL INPUT FROM LOGREC,*/  00761000
         NI    FLIPFLOP,B'11011111'                                0265 00762000
*                           /* AND NOT FROM HISTORY INPUT    @G51DGBB*/ 00763000
*            RECCCHHR = BCOUNT; /*PASS SAME VALUE TO USER VIA PARM*/    00764000
         L     @14,SAVER2                                          0266 00765000
         MVC   RECCCHHR(5,@14),BCOUNT                              0266 00766000
*            RECLNGTH = BSIZE; /*PASS RECORD LENGTH FROM COUNT RECRD*/  00767000
         LH    @12,BSIZE                                           0267 00768000
         N     @12,@CF01176                                        0267 00769000
         STH   @12,RECLNGTH(,@14)                                  0267 00770000
*            SAVELENT = BSIZE + 4; /*SAVE RECORD QSAM LENGTH FOR */     00771000
         LA    @12,4(,@12)                                         0268 00772000
         STH   @12,SAVELENT                                        0268 00773000
*                                  /*RITESCRT,RITEHIST       @G51DGBB*/ 00774000
*            R7 = ADDR(BDATA); /*BKEY IS DATA PORTION OF RECORD SINCE*/ 00775000
         LA    R7,BDATA                                            0269 00776000
*            TIMEBASE = R7; /*TELL TIME CONVERSION WHERE RECORD IS*/    00777000
         ST    R7,TIMEBASE                                         0270 00778000
*            CALL CONVTIME; /*CONVERT TIME, IF NECESSARY     @G51DGBB*/ 00779000
         BAL   @14,CONVTIME                                        0271 00780000
*          END;                                            /*@G51DGBB*/ 00781000
*      END;                                                /*@G51DGBB*/ 00782000
*  END;                                                    /*@G51DGBB*/ 00783000
*ELSE /*IF LOGREC HAS NOT BEEN OPENED                        @G51DGBB*/ 00784000
*  DO;                                                     /*@G51DGBB*/ 00785000
         B     @RC00209                                            0275 00786000
@RF00209 DS    0H                                                  0276 00787000
*    MSGNO = 47;                                           /*@G51DGBB*/ 00788000
         MVC   MSGNO(4),@CF00927                                   0276 00789000
*    CALL ERRMSG;                                          /*@G51DGBB*/ 00790000
         BAL   @14,ERRMSG                                          0277 00791000
*    BADNEWS = TWELVE;                                     /*@G51DGBB*/ 00792000
         MVC   BADNEWS(4),@CF00068                                 0278 00793000
*  END;                                                    /*@G51DGBB*/ 00794000
*END; /*END OF PROC READSER                                  @G51DGBB*/ 00795000
@EL00003 DS    0H                                                  0280 00796000
@EF00003 DS    0H                                                  0280 00797000
@ER00003 LM    @14,@06,@SA00003                                    0280 00798000
         LM    @08,@12,@SA00003+36                                 0280 00799000
         BR    @14                                                 0280 00800000
*DIRRDSER: PROC OPTIONS(DONTSAVE(R7)); /*READ SERLOG DIRECTLY*/    0281 00801000
DIRRDSER STM   @14,@06,@SA00004                                    0281 00802000
         STM   @08,@12,@SA00004+36                                 0281 00803000
*RESPECIFY (R7) RESTRICTED;                                /*@Z427VLS*/ 00804000
*IF SERLO = YES THEN /*DO ONLY IF SERLOG IS OPEN             @Z427VLS*/ 00805000
         TM    SERLO,B'10000000'                                   0283 00806000
         BNO   @RF00283                                            0283 00807000
*  DO;                                                     /*@Z427VLS*/ 00808000
*    RSERDCNT = RSERDCNT + 1; /*COUNT NUMBER OF READ ATTEMPTS*/    0285 00809000
         LA    @14,1                                               0285 00810000
         AL    @14,RSERDCNT                                        0285 00811000
         ST    @14,RSERDCNT                                        0285 00812000
*    PREVCC(1:5) = RECCCHHR;                               /*@Z427VLS*/ 00813000
         L     @14,SAVER2                                          0286 00814000
         MVC   PREVCC(5),RECCCHHR(@14)                             0286 00815000
*    R7 = ADDR(BUF1);                                      /*@Z427VLS*/ 00816000
         LA    R7,BUF1                                             0287 00817000
*    PREVR = PREVR - 1;                                    /*@Z427VLS*/ 00818000
         SLR   @14,@14                                             0288 00819000
         IC    @14,PREVR                                           0288 00820000
         BCTR  @14,0                                               0288 00821000
         STC   @14,PREVR                                           0288 00822000
*    CALL EXCPLOOP;                                        /*@Z427VLS*/ 00823000
         BAL   @14,EXCPLOOP                                        0289 00824000
*    IF POST ^= '7F'X THEN                                         0290 00825000
         CLI   POST,X'7F'                                          0290 00826000
         BE    @RF00290                                            0290 00827000
*      DO;                                                 /*@Z427VLS*/ 00828000
*        MSGNO = 25;                                       /*@Z427VLS*/ 00829000
         MVC   MSGNO(4),@CF00932                                   0292 00830000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 00831000
         BAL   @14,ERRMSG                                          0293 00832000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 00833000
         MVC   BADNEWS(4),@CF00068                                 0294 00834000
*        RETURN;                                           /*@Z427VLS*/ 00835000
@EL00004 DS    0H                                                  0295 00836000
@EF00004 DS    0H                                                  0295 00837000
@ER00004 LM    @14,@06,@SA00004                                    0295 00838000
         LM    @08,@12,@SA00004+36                                 0295 00839000
         BR    @14                                                 0295 00840000
*      END;                                                /*@Z427VLS*/ 00841000
*     PREVCC(1:5) = BCOUNT;                                /*@Z427VLS*/ 00842000
@RF00290 MVC   PREVCC(5),BCOUNT                                    0297 00843000
*     RECLNGTH = BSZ;                                      /*@Z427VLS*/ 00844000
         LH    @14,BSZ                                             0298 00845000
         L     @12,SAVER2                                          0298 00846000
         STH   @14,RECLNGTH(,@12)                                  0298 00847000
*     R7 = ADDR(BDATA);                                    /*@G51DGBB*/ 00848000
         LA    R7,BDATA                                            0299 00849000
*     TIMEBASE = R7;                                       /*@Z427VLS*/ 00850000
         ST    R7,TIMEBASE                                         0300 00851000
*     CALL CONVTIME;                                       /*@Z427VLS*/ 00852000
         BAL   @14,CONVTIME                                        0301 00853000
*  END;                                                    /*@Z427VLS*/ 00854000
*ELSE /*SERLOG NOT OPEN                                      @Z427VLS*/ 00855000
*  DO;                                                     /*@Z427VLS*/ 00856000
         B     @RC00283                                            0303 00857000
@RF00283 DS    0H                                                  0304 00858000
*    MSGNO = 47;                                           /*@Z427VLS*/ 00859000
         MVC   MSGNO(4),@CF00927                                   0304 00860000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00861000
         BAL   @14,ERRMSG                                          0305 00862000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 00863000
         MVC   BADNEWS(4),@CF00068                                 0306 00864000
*  END;                                                    /*@Z427VLS*/ 00865000
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/ 00866000
*END; /*CLOSING END TO DIRRDSER PROC                         @Z427VLS*/ 00867000
         B     @EL00004                                            0309 00868000
*/********************************************************************/ 00869000
*/*                                                          @Z427VLS*/ 00870000
*/*      RESET HEADER TO INDICATE AN EMPTY DATA SET          @Z427VLS*/ 00871000
*/*                                                          @Z427VLS*/ 00872000
*/********************************************************************/ 00873000
*RESETHDR: PROC;                                           /*@Z427VLS*/ 00874000
RESETHDR STM   @14,@12,@SA00005                                    0310 00875000
*RESPECIFY (R7,R6) RESTRICTED;                             /*@Z427VLS*/ 00876000
*        IF DEBUG15 = ON THEN                                      0312 00877000
         L     @14,SAVER2                                          0312 00878000
         TM    DEBUG15(@14),B'00000001'                            0312 00879000
         BNO   @RF00312                                            0312 00880000
*          DO; /*PRINT TO TOURIST ATTEMPT TO RESET HEADER    @Z427VLS*/ 00881000
*            MSGNO = 55;                                   /*@Z427VLS*/ 00882000
         MVC   MSGNO(4),@CF00937                                   0314 00883000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 00884000
         BAL   @14,ERRMSG                                          0315 00885000
*          END;                                            /*@Z427VLS*/ 00886000
*        R7=ADDR(HEADER);               /* POINT TO HEADER AREA      */ 00887000
@RF00312 LA    R7,HEADER                                           0317 00888000
*        SBT2='1'B;                     /* SET HEADER & WRITE        */ 00889000
*        SBT4='1'B;                     /* SWITCHES ON       @Z427VLS*/ 00890000
         OI    SBT2,B'01010000'                                    0319 00891000
*        HDRREC2=HDRREC1;               /* RESET LAST REC WRITTEN    */ 00892000
         MVC   HDRREC2(7),HDRREC1                                  0320 00893000
*        R6=HDRTYPE;                    /* PICK UP DEV TYPE  @Z427VLS*/ 00894000
         SLR   R6,R6                                               0321 00895000
         IC    R6,HDRTYPE                                          0321 00896000
*        GEN(SLL   R6,L1);              /* MULTIPLY BY 2     @Z427VLS*/ 00897000
         SLL   R6,L1                                                    00898000
*        GEN(LA    R6,BYTESREM(R6));    /* INDEX INTO TABLE  @Z427VLS*/ 00899000
         LA    R6,BYTESREM(R6)                                          00900000
*        GEN(MVC   HDRREM(L2),L0(R6));  /* MOVE BYTES REM TO FLD     */ 00901000
         MVC   HDRREM(L2),L0(R6)                                        00902000
*       IF FRAMES = YES THEN /*IF FRAMES TO BE SAVED FOR MERIDIAN*/     00903000
         TM    FRAMES,B'00100000'                                  0325 00904000
         BNO   @RF00325                                            0325 00905000
*         HDRREM = 20; /*DONT LET RECORDS ON LAST FRAME TRACK*/    0326 00906000
         MVC   HDRREM(2),@CH00662                                  0326 00907000
*        HDRWNGBT='0'B;                 /* TURN OFF EARLY WARN SWITCH*/ 00908000
@RF00325 NI    HDRWNGBT,B'01111111'                                0327 00909000
*        HDRCOUNT = '00'X;             /* RESET THE MSG FIELD */   0328 00910000
         MVI   HDRCOUNT,X'00'                                      0328 00911000
*        CALL EXCPLOOP;                                    /*@Z427VLS*/ 00912000
         BAL   @14,EXCPLOOP                                        0329 00913000
*        IF POST^='7F'X THEN            /* TEST FOR NORMAL   @Z427VLS*/ 00914000
         CLI   POST,X'7F'                                          0330 00915000
         BE    @RF00330                                            0330 00916000
*          DO;                                             /*@Z427VLS*/ 00917000
*            MSGNO = 48;                                   /*@Z427VLS*/ 00918000
         MVC   MSGNO(4),@CF00938                                   0332 00919000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 00920000
         BAL   @14,ERRMSG                                          0333 00921000
*            BADNEWS = TWELVE;                             /*@Z427VLS*/ 00922000
         MVC   BADNEWS(4),@CF00068                                 0334 00923000
*            CALL IFCMSG(201,ADDR(PRNTBF));                /*@Z427VLS*/ 00924000
         LA    @14,PRNTBF                                          0335 00925000
         ST    @14,@AFTEMPS                                        0335 00926000
         L     @12,SAVER2                                          0335 00927000
         L     @15,ADIFCMSG(,@12)                                  0335 00928000
         LA    @01,@AL00335                                        0335 00929000
         BALR  @14,@15                                             0335 00930000
*            RETURN;                                       /*@Z427VLS*/ 00931000
@EL00005 DS    0H                                                  0336 00932000
@EF00005 DS    0H                                                  0336 00933000
@ER00005 LM    @14,@12,@SA00005                                    0336 00934000
         BR    @14                                                 0336 00935000
*          END;                                            /*@Z427VLS*/ 00936000
*RESPECIFY (R7,R6)  UNRESTRICTED;                          /*@Z427VLS*/ 00937000
*END; /*CLOSING END TO PROC RESETHDR                         @Z427VLS*/ 00938000
         B     @EL00005                                            0339 00939000
*/********************************************************************/ 00940000
*/*                                                          @Z427VLS*/ 00941000
*/*      OPEN  SYS1.LOGREC                                   @Z427VLS*/ 00942000
*/*                                                          @Z427VLS*/ 00943000
*/********************************************************************/ 00944000
*OPENSERL: PROC;                                           /*@Z427VLS*/ 00945000
OPENSERL STM   @14,@12,@SA00006                                    0340 00946000
*RESPECIFY(R1,R0,R7,R12) RESTRICTED;                       /*@Z427VLS*/ 00947000
*IF DEBUG15 = ON THEN                                              0342 00948000
         L     @14,SAVER2                                          0342 00949000
         TM    DEBUG15(@14),B'00000001'                            0342 00950000
         BNO   @RF00342                                            0342 00951000
*  DO;                                                     /*@Z427VLS*/ 00952000
*    MSGNO = 53;                                           /*@Z427VLS*/ 00953000
         MVC   MSGNO(4),@CF00944                                   0344 00954000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00955000
         BAL   @14,ERRMSG                                          0345 00956000
*  END;                                                    /*@Z427VLS*/ 00957000
*GENERATE;                                                 /*@Z427VLS*/ 00958000
@RF00342 DS    0H                                                  0347 00959000
         LA    R1,LOGREC                                                00960000
         ST    R1,XIOBDCB                                               00961000
*IF SERLO = YES THEN /*IF SERLOG ALREADY OPEN THEN           @Z427VLS*/ 00962000
         TM    SERLO,B'10000000'                                   0348 00963000
         BNO   @RF00348                                            0348 00964000
*  DO;                                                     /*@Z427VLS*/ 00965000
*    MSGNO = 41;                                           /*@Z427VLS*/ 00966000
         MVC   MSGNO(4),@CF00945                                   0350 00967000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00968000
         BAL   @14,ERRMSG                                          0351 00969000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 00970000
         MVC   BADNEWS(4),@CF00068                                 0352 00971000
*    RETURN;                                               /*@Z427VLS*/ 00972000
@EL00006 DS    0H                                                  0353 00973000
@EF00006 DS    0H                                                  0353 00974000
@ER00006 LM    @14,@12,@SA00006                                    0353 00975000
         BR    @14                                                 0353 00976000
*  END;                                                    /*@Z427VLS*/ 00977000
*/*                                                          @Z427VLS*/ 00978000
*/*      BLOCK  GENERATE TO INTERFACE WITH SYSTEM MACROS & CONTROL   */ 00979000
*/*                                                          @Z427VLS*/ 00980000
*ZEROA = (ZEROA && ZEROA); /*CLEAR FIELD                     @Z427VLS*/ 00981000
@RF00348 XC    ZEROA(24),ZEROA                                     0355 00982000
*IF NOSDR = NO THEN /*IF USER WANTS SDR COUNTERS DUMPED      @Z427VLS*/ 00983000
         L     @14,SAVER2                                          0356 00984000
         TM    NOSDR(@14),B'00000001'                              0356 00985000
         BNZ   @RF00356                                            0356 00986000
*DO;                                                       /*@Z427VLS*/ 00987000
*GENERATE;                                                 /*@Z427VLS*/ 00988000
         LA    R0,4                     CODE TO DUMP SDR'S              00989000
         SVC   76                       ISSUE SVC TO DUMP SDR'S         00990000
*END;                                                      /*@Z427VLS*/ 00991000
*GENERATE;                                                 /*@Z427VLS*/ 00992000
@RF00356 DS    0H                                                  0360 00993000
         ENQ   (RESID,LOGRECA,E,11,STEP) ENQ TO PREVENT OTHER ACCESS    00994000
         OPEN  (LOGREC,(OUTPUT))         FROM ANOTHER IFCEREP0 TASK     00995000
         LA    R12,LOGREC               PICK UP ADDR FOR DSECT BASE     00996000
         TM    DCBOFLGS,OPENOK          DID OPEN GO OK                  00997000
         BZ    BADOPENA                 BR-NO BAD OPEN                  00998000
*        SERLO = YES;                   /* TURN ON OPEN DISK IND     */ 00999000
         OI    SERLO,B'10000000'                                   0361 01000000
*        SBT4='1'B;                     /* TURN ON HDR READ SW       */ 01001000
         OI    SBT4,B'00010000'                                    0362 01002000
*        R7=ADDR(HEADER);               /* POINT TO HEADER AREA      */ 01003000
         LA    R7,HEADER                                           0363 01004000
*        CALL EXCPLOOP;                 /* GO DO I/O TO READ HDR     */ 01005000
         BAL   @14,EXCPLOOP                                        0364 01006000
*        SBT4='0'B;                     /* TURN OFF HDR READ SW      */ 01007000
         NI    SBT4,B'11101111'                                    0365 01008000
*        IF POST^='7F'X                 /* TEST FOR NORMAL   @Z427VLS*/ 01009000
*              THEN                     /* RETURN FROM I/O   @Z427VLS*/ 01010000
         CLI   POST,X'7F'                                          0366 01011000
         BNE   @RT00366                                            0366 01012000
*                   GOTO HDRERR0;       /* IF NOT GOTO ERROR EXIT    */ 01013000
*        IF HDRSAFE^='FF'X              /* TEST FOR SAFETY BYTE      */ 01014000
*              THEN                     /* IN HEADER RECORD  @Z427VLS*/ 01015000
         CLI   HDRSAFE,X'FF'                                       0368 01016000
         BNE   @RT00368                                            0368 01017000
*                   GOTO HDRERR1;       /* IF NOT TAKE ERROR EXIT    */ 01018000
*        GENERATE;                                         /*@Z427VLS*/ 01019000
         MVC   DCBFDAD+L3(L4),HDRECC    SET DCB HIGH EXTENT FIELD       01020000
         XC    DCBTRBAL(L2),DCBTRBAL    ZERO THE TRACK BALANCE FIELD    01021000
L3       EQU   3                                                        01022000
*PREVSEEK(2:8) = HDRREC1; /*SET START SEEK AT LAST FRAME LOCATION*/     01023000
         MVC   PREVSEEK+1(7),HDRREC1                               0371 01024000
*PREVM = '00'X; /*INDICATE DATA SET OPEN                     @G51DGBB*/ 01025000
         MVI   PREVM,X'00'                                         0372 01026000
*        RETURN;                        /* TAKE NORMAL EXIT  @Z427VLS*/ 01027000
         B     @EL00006                                            0373 01028000
*HDRERR0:     ;                                            /*@Z427VLS*/ 01029000
HDRERR0  DS    0H                                                  0375 01030000
*        IF POST='42'X                  /* TEST FOR OUT OF EXTENT    */ 01031000
*              THEN                     /* IF YES            @Z427VLS*/ 01032000
         CLI   POST,X'42'                                          0375 01033000
         BNE   @RF00375                                            0375 01034000
*                MSGNO = 14;                               /*@Z427VLS*/ 01035000
         MVC   MSGNO(4),@CF00759                                   0376 01036000
*              ELSE                                                0377 01037000
*                MSGNO = 15;                               /*@Z427VLS*/ 01038000
         B     @RC00375                                            0377 01039000
@RF00375 MVC   MSGNO(4),@CF00036                                   0377 01040000
*         CALL ERRMSG;                                     /*@Z427VLS*/ 01041000
@RC00375 BAL   @14,ERRMSG                                          0378 01042000
*         BADNEWS = TWELVE;                                /*@Z427VLS*/ 01043000
         MVC   BADNEWS(4),@CF00068                                 0379 01044000
*         RETURN;                                          /*@Z427VLS*/ 01045000
         B     @EL00006                                            0380 01046000
*HDRERR1:     ;                                            /*@Z427VLS*/ 01047000
HDRERR1  DS    0H                                                  0382 01048000
*      MSGNO = 16;                                         /*@Z427VLS*/ 01049000
         MVC   MSGNO(4),@CF00089                                   0382 01050000
*      CALL ERRMSG;                                        /*@Z427VLS*/ 01051000
         BAL   @14,ERRMSG                                          0383 01052000
*      BADNEWS = TWELVE;                                   /*@Z427VLS*/ 01053000
         MVC   BADNEWS(4),@CF00068                                 0384 01054000
*RESPECIFY (R1,R0,R7,R12) UNRESTRICTED;                    /*@Z427VLS*/ 01055000
*END; /*CLOSING END TO PROC OPENSERL, OPEN SERLOG DATA SET   @Z427VLS*/ 01056000
         B     @EL00006                                            0386 01057000
*/********************************************************************/ 01058000
*/*                                                          @Z427VLS*/ 01059000
*/*      CHECK HEADER FOR MORE RECORDS WRITTEN WHILE PROCESSING      */ 01060000
*/*                                                          @Z427VLS*/ 01061000
*/********************************************************************/ 01062000
*CHECKHDR: PROC;                                           /*@Z427VLS*/ 01063000
CHECKHDR STM   @14,@12,@SA00007                                    0387 01064000
*RESPECIFY(R1,R4,R7) RESTRICTED;                           /*@Z427VLS*/ 01065000
*        IF DEBUG15 = ON THEN                                      0389 01066000
         L     @14,SAVER2                                          0389 01067000
         TM    DEBUG15(@14),B'00000001'                            0389 01068000
         BNO   @RF00389                                            0389 01069000
*          DO;                                             /*@Z427VLS*/ 01070000
*            MSGNO = 54;                                   /*@Z427VLS*/ 01071000
         MVC   MSGNO(4),@CF00953                                   0391 01072000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 01073000
         BAL   @14,ERRMSG                                          0392 01074000
*          END;                                            /*@Z427VLS*/ 01075000
*        IF SERLO = NO THEN             /* TEST FOR DISK OPEN        */ 01076000
@RF00389 TM    SERLO,B'10000000'                                   0394 01077000
         BNZ   @RF00394                                            0394 01078000
*          DO;                                             /*@Z427VLS*/ 01079000
*            MSGNO = 49;                                   /*@Z427VLS*/ 01080000
         MVC   MSGNO(4),@CF00954                                   0396 01081000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 01082000
         BAL   @14,ERRMSG                                          0397 01083000
*            BADNEWS = TWELVE;                             /*@Z427VLS*/ 01084000
         MVC   BADNEWS(4),@CF00068                                 0398 01085000
*            RETURN;                                       /*@Z427VLS*/ 01086000
@EL00007 DS    0H                                                  0399 01087000
@EF00007 DS    0H                                                  0399 01088000
@ER00007 LM    @14,@12,@SA00007                                    0399 01089000
         BR    @14                                                 0399 01090000
*          END;                                            /*@Z427VLS*/ 01091000
*        GEN(GETMAIN R,LV=40);          /* GET STORAGE TO HOLD HEADER*/ 01092000
@RF00394 DS    0H                                                  0401 01093000
         GETMAIN R,LV=40                                                01094000
*        R4=R1;                         /* SET BASE FOR OLD HEADER   */ 01095000
         LR    R4,R1                                               0402 01096000
*        OHEADER=HEADER;                /* MOVE HEADER TO GOTTEN CORE*/ 01097000
         MVC   OHEADER(40,R4),HEADER                               0403 01098000
*        R7=ADDR(HEADER);               /* POINT TO BUFF FOR READ    */ 01099000
         LA    R7,HEADER                                           0404 01100000
*        SBT4='1'B;                     /* TURN ON READ HEADER       */ 01101000
         OI    SBT4,B'00010000'                                    0405 01102000
*        IF LASTLOOP = YES THEN /*DONT ENQUEUE EXCEPT FOR ZEROALL PRO*/ 01103000
         TM    LASTLOOP,B'00000100'                                0406 01104000
         BNO   @RF00406                                            0406 01105000
*        DO; /*CESSING. MAYBE EXTRA RECORD WRITTEN AT EOF FOR READSEQ*/ 01106000
*        SBT7='1'B;                     /* TURN ON INTERNAL ENQ SW   */ 01107000
         OI    SBT7,B'00001000'                                    0408 01108000
*        GEN(ENQ  (RESIDII,LOGRECB,E,8,SYSTEM));           /*@Z427VLS*/ 01109000
         ENQ  (RESIDII,LOGRECB,E,8,SYSTEM)                              01110000
*        END;                                              /*@Z427VLS*/ 01111000
*        CALL EXCPLOOP;                 /* GO DO I/O READ HEADER     */ 01112000
@RF00406 BAL   @14,EXCPLOOP                                        0411 01113000
*CHK01  :     ;                                            /*@Z427VLS*/ 01114000
CHK01    DS    0H                                                  0413 01115000
*        IF POST^='7F'X                 /* TEST POST CODE FOR NORMAL */ 01116000
*              THEN                     /* RETURN IF NOT     @Z427VLS*/ 01117000
         CLI   POST,X'7F'                                          0413 01118000
         BNE   @RT00413                                            0413 01119000
*                   GOTO CHK03;         /* TAKE ERROR EXIT   @Z427VLS*/ 01120000
*        IF HDRSAFE^='FF'X              /* TEST HDR REC JUST READ FOR*/ 01121000
*              THEN                     /* SAFETY BYTE       @Z427VLS*/ 01122000
         CLI   HDRSAFE,X'FF'                                       0415 01123000
         BNE   @RT00415                                            0415 01124000
*                   GOTO CHK04;         /* IF NOT FF TAKE ERR EXIT   */ 01125000
*        IF HDRREC2=OHDRREC2            /* TEST LAST REC WRITTEN FLDS*/ 01126000
*              THEN                     /* IF THEY MATCH     @Z427VLS*/ 01127000
         CLC   HDRREC2(7),OHDRREC2(R4)                             0417 01128000
         BNE   @RF00417                                            0417 01129000
*                   DO;                 /* THEN              @Z427VLS*/ 01130000
*                        BADNEWS = FOUR; /*INDICATE REAL END OF FILE */ 01131000
         MVC   BADNEWS(4),@CF00065                                 0419 01132000
*                        GOTO CHK02;    /* GO ON             @Z427VLS*/ 01133000
         B     CHK02                                               0420 01134000
*                   END;                                   /*@Z427VLS*/ 01135000
*        PREVSEEK(2:8)=OHDRREC2  ;                          /*YM01498*/ 01136000
@RF00417 MVC   PREVSEEK+1(7),OHDRREC2(R4)                          0422 01137000
*CHK02  :     ;                                            /*@Z427VLS*/ 01138000
CHK02    DS    0H                                                  0424 01139000
*        SBT4='0'B;                     /* TURN OF HEADER SW @Z427VLS*/ 01140000
         NI    SBT4,B'11101111'                                    0424 01141000
*        R1=R4;                         /* SET R1 FOR FREE MAIN      */ 01142000
         LR    R1,R4                                               0425 01143000
*        GEN(FREEMAIN R,LV=40,A=(1));   /* FREE MAIN OF GOTTEN CORE  */ 01144000
         FREEMAIN R,LV=40,A=(1)                                         01145000
*          RETURN; /*GO BACK TO CALLER                       @Z427VLS*/ 01146000
         B     @EL00007                                            0427 01147000
*CHK03  :     ;                                            /*@Z427VLS*/ 01148000
CHK03    DS    0H                                                  0429 01149000
*        IF POST = '42'X THEN /*42 MEANS OUT OF EXTENT       @Z427VLS*/ 01150000
         CLI   POST,X'42'                                          0429 01151000
         BNE   @RF00429                                            0429 01152000
*          MSGNO = 14;                                     /*@Z427VLS*/ 01153000
         MVC   MSGNO(4),@CF00759                                   0430 01154000
*        ELSE                                                      0431 01155000
*          MSGNO = 15;   /*NOT 42 MEANS IO ERROR             @Z427VLS*/ 01156000
         B     @RC00429                                            0431 01157000
@RF00429 MVC   MSGNO(4),@CF00036                                   0431 01158000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01159000
@RC00429 BAL   @14,ERRMSG                                          0432 01160000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 01161000
         MVC   BADNEWS(4),@CF00068                                 0433 01162000
*        GOTO  CHK02;     /*GO BACK TO FREE EXCESS CORE      @Z427VLS*/ 01163000
         B     CHK02                                               0434 01164000
*CHK04  :     ;                                            /*@Z427VLS*/ 01165000
CHK04    DS    0H                                                  0436 01166000
*        MSGNO = 16; /*HEADER CHECK BYTE BAD                 @Z427VLS*/ 01167000
         MVC   MSGNO(4),@CF00089                                   0436 01168000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01169000
         BAL   @14,ERRMSG                                          0437 01170000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 01171000
         MVC   BADNEWS(4),@CF00068                                 0438 01172000
*        GOTO CHK02;                     /*GO BACK TO DEQ    @Z427VLS*/ 01173000
         B     CHK02                                               0439 01174000
*RESPECIFY(R1,R4,R7) UNRESTRICTED;                         /*@Z427VLS*/ 01175000
*END; /*CLOSING END TO PROC CHECK HEADER                     @Z427VLS*/ 01176000
*/********************************************************************/ 01177000
*/*                                                          @Z427VLS*/ 01178000
*/*      CONVERT TIME ROUTINE                                @Z427VLS*/ 01179000
*/*                                                          @Z427VLS*/ 01180000
*/********************************************************************/ 01181000
*CONVTIME: PROC;                                           /*@Z427VLS*/ 01182000
CONVTIME STM   @14,@12,@SA00008                                    0442 01183000
*RESPECIFY(R3,R4,R5,R6,R7) RESTRICTED;                     /*@Z427VLS*/ 01184000
*        R7SAVE = R7;  /*SAVE RECORD ADDRESS                 @Z427VLS*/ 01185000
         ST    R7,R7SAVE                                           0444 01186000
*        IF LCSWITCH='1'B               /*  HAS TIME BEEN CONVERTED  */ 01187000
*              THEN                     /*  OR IS IT IN PROPER FORM  */ 01188000
         L     @14,TIMEBASE                                        0445 01189000
         TM    LCSWITCH(@14),B'00001000'                           0445 01190000
         BO    @RT00445                                            0445 01191000
*                   RETURN;               /*  YES EXIT TO CALLER   */   01192000
*        CONVTCT = CONVTCT + 1;         /*NUMBER OF CONVERSIONS DONE*/  01193000
         LA    @12,1                                               0447 01194000
         AL    @12,CONVTCT                                         0447 01195000
         ST    @12,CONVTCT                                         0447 01196000
*        IF NSSWITCH='1'B               /*  IS TIME FROM  NS MACHINE */ 01197000
*              THEN                     /*  IF YES           @Z427VLS*/ 01198000
         TM    NSSWITCH(@14),B'01000000'                           0448 01199000
         BO    @RT00448                                            0448 01200000
*                   GOTO                /*  GOTO NS CONVERT ROUTINE  */ 01201000
*                        CONVNS;        /*  IF NO TIME IN BINARY     */ 01202000
*/********************************************************************/ 01203000
*/*      BINARY TIME TO HHMMSSTH ROUTINE                     @Z427VLS*/ 01204000
*/********************************************************************/ 01205000
*CONVBIN:     ;                                            /*@Z427VLS*/ 01206000
CONVBIN  DS    0H                                                  0451 01207000
*        LCSWITCH='1'B;                 /* SET CONVERTED TIME SW     */ 01208000
         L     @14,TIMEBASE                                        0451 01209000
         OI    LCSWITCH(@14),B'00001000'                           0451 01210000
*        WORK=TIME;                     /* PULL TIME INTO WORK AREA  */ 01211000
         ICM   @12,15,TIME(@14)                                    0452 01212000
         ST    @12,WORK                                            0452 01213000
*        R6=0 ;                         /* SET WORK REG TO 0 @Z427VLS*/ 01214000
         SLR   R6,R6                                               0453 01215000
*        R7=WORK;                       /* PICK UP TIME      @Z427VLS*/ 01216000
         LR    R7,@12                                              0454 01217000
*        IF R7=0                        /* TEST FOR ZERO TIME        */ 01218000
*              THEN                     /* IF YES            @Z427VLS*/ 01219000
         LTR   R7,R7                                               0455 01220000
         BNZ   @RF00455                                            0455 01221000
*                DO;                                       /*@Z427VLS*/ 01222000
*                  R7 = R7SAVE;                            /*@Z427VLS*/ 01223000
         L     R7,R7SAVE                                           0457 01224000
*                  RETURN;                /* EXIT TO CALLER  @Z427VLS*/ 01225000
@EL00008 DS    0H                                                  0458 01226000
@EF00008 DS    0H                                                  0458 01227000
@ER00008 LM    @14,@12,@SA00008                                    0458 01228000
         BR    @14                                                 0458 01229000
*                END;                                      /*@Z427VLS*/ 01230000
*        GEN(SRL   R7,L1);              /* DIVIDE TIME BY 2  @Z427VLS*/ 01231000
@RF00455 DS    0H                                                  0460 01232000
         SRL   R7,L1                                                    01233000
*        R3=32;                         /* SET CONSTANT NO. OF BITS  */ 01234000
         LA    R3,32                                               0461 01235000
*        TIMDIV=10;                     /* SET DIVISOR       @Z427VLS*/ 01236000
         MVC   TIMDIV(4),@CF00033                                  0462 01237000
*        GEN(M     R6,CONSTG);          /* MULTIPLY BY BIN CLK CONST */ 01238000
         M     R6,CONSTG                                                01239000
*        GEN(D     R6,CONSTH);          /* DIVIDE   BY BIN CLK CONST */ 01240000
         D     R6,CONSTH                                                01241000
*CONVBINA:    ;                                            /*@Z427VLS*/ 01242000
CONVBINA DS    0H                                                  0466 01243000
*        R6=0 ;                                            /*@Z427VLS*/ 01244000
         SLR   R6,R6                                               0466 01245000
*        GEN(D     R6,TIMDIV);          /* DIVIDE BY CONST   @Z427VLS*/ 01246000
         D     R6,TIMDIV                                                01247000
*        R4=R6 ;                        /* SAVE REMAINDER    @Z427VLS*/ 01248000
         LR    R4,R6                                               0468 01249000
*        GEN(SRDL  R4,L4);              /* SHIFT VALUE IN REG 5      */ 01250000
         SRDL  R4,L4                                                    01251000
*        R3=R3-4 ;                      /* DEC BY 4 BITS     @Z427VLS*/ 01252000
         SL    R3,@CF00065                                         0470 01253000
*        IF R7=0                        /* HAVE WE FOUND ZERO        */ 01254000
*              THEN                     /* IF YES            @Z427VLS*/ 01255000
         LTR   R7,R7                                               0471 01256000
         BZ    @RT00471                                            0471 01257000
*                   GOTO CONVBINB;      /* GO FINISH UP CONVERSION   */ 01258000
*        IF R3<24                       /* IF R3 LESS THAN 24        */ 01259000
*              THEN                     /* AND DIVISOR WITH 12       */ 01260000
         C     R3,@CF00228                                         0473 01261000
         BNL   @RF00473                                            0473 01262000
*                   TIMDIV=(TIMDIV && 12);                 /*@Z427VLS*/ 01263000
         L     @14,TIMDIV                                          0474 01264000
         X     @14,@CF00068                                        0474 01265000
         ST    @14,TIMDIV                                          0474 01266000
*        GOTO  CONVBINA ;               /* LOOP BACK TILL DONE       */ 01267000
         B     CONVBINA                                            0475 01268000
*CONVBINB:    ;                                            /*@Z427VLS*/ 01269000
CONVBINB DS    0H                                                  0477 01270000
*        GEN(SRL   R5,L0(R3));          /* SHIFT TO RIGHT ADJUST ANS */ 01271000
         SRL   R5,L0(R3)                                                01272000
*        TIME=R5 ;                      /* PUT IT BACK INTO RECORD   */ 01273000
         L     @14,TIMEBASE                                        0478 01274000
         STCM  R5,15,TIME(@14)                                     0478 01275000
*        R7 = R7SAVE;                   /* RESET REG SEVEN   @Z427VLS*/ 01276000
         L     R7,R7SAVE                                           0479 01277000
*        RETURN;                        /* EXIT              @Z427VLS*/ 01278000
         B     @EL00008                                            0480 01279000
*/********************************************************************/ 01280000
*/*      NEW SYSTEM - TO YYDDD & HHMMSS                      @Z427VLS*/ 01281000
*/********************************************************************/ 01282000
*CONVNS :     ;                                            /*@Z427VLS*/ 01283000
CONVNS   DS    0H                                                  0482 01284000
*        WORK8=DATETIME;                /* MOVE DATE & TIME TO WORK  */ 01285000
         L     @14,TIMEBASE                                        0482 01286000
         MVC   WORK8(8),DATETIME(@14)                              0482 01287000
*        NSSWITCH='0'B;                 /* TURN OFF NS SWITCH        */ 01288000
*        LCSWITCH='1'B ;                /* TURN ON LOCAL SW  @Z427VLS*/ 01289000
         OI    LCSWITCH(@14),B'00001000'                           0484 01290000
         NI    NSSWITCH(@14),B'10111111'                           0484 01291000
*        IF WORK=0 &                    /* TEST FOR          @Z427VLS*/ 01292000
*           WORKB=0                     /* ZERO FIELD        @Z427VLS*/ 01293000
*              THEN                     /* IF YES EXIT TO CALLER     */ 01294000
         SLR   @14,@14                                             0485 01295000
         C     @14,WORK                                            0485 01296000
         BNE   @RF00485                                            0485 01297000
         C     @14,WORKB                                           0485 01298000
         BNE   @RF00485                                            0485 01299000
*                DO;                                       /*@Z427VLS*/ 01300000
*                  R7 = R7SAVE;                            /*@Z427VLS*/ 01301000
         L     R7,R7SAVE                                           0487 01302000
*                   RETURN;                                /*@Z427VLS*/ 01303000
         B     @EL00008                                            0488 01304000
*                END;                                      /*@Z427VLS*/ 01305000
*        R4=WORK ;                      /* PICK UP DATE/TIME @Z427VLS*/ 01306000
@RF00485 L     R4,WORK                                             0490 01307000
*        R5=WORKB;                      /* INTO WORK REGS    @Z427VLS*/ 01308000
         L     R5,WORKB                                            0491 01309000
*        GEN(SRDL  R4,L12);             /* CONVERT FROM NANO TO MICRO*/ 01310000
         SRDL  R4,L12                                                   01311000
*        GEN(D     R4,SIXTYMIL);        /* DIVIDE TO GET # OF MINUTES*/ 01312000
         D     R4,SIXTYMIL                                              01313000
*        R6=0 ;                         /*                   @Z427VLS*/ 01314000
         SLR   R6,R6                                               0494 01315000
*        R7=R4;                         /* MOVE REMAINDER TO OTHER RG*/ 01316000
         LR    R7,R4                                               0495 01317000
*        GEN(D    R6,MILLION);          /* DIVIDE TO GET SECONDS     */ 01318000
         D    R6,MILLION                                                01319000
*        GEN(CVD   R7,WORK8);           /* CONVERT # OF SECONDS      */ 01320000
         CVD   R7,WORK8                                                 01321000
*        R4=WORKB;                      /* PICK IT UP TO WORK REG    */ 01322000
         L     R4,WORKB                                            0498 01323000
*        SRL(R4,FOUR);                  /* MOVE IT TO HI ORDER       */ 01324000
         SRL   R4,4                                                0499 01325000
*        SECS=R4;                       /* PUT BYTE INTO RECORD      */ 01326000
         L     @14,TIMEBASE                                        0500 01327000
         STC   R4,SECS(,@14)                                       0500 01328000
*        R4=0 ;                         /*                   @Z427VLS*/ 01329000
         SLR   R4,R4                                               0501 01330000
*        R7=R6 ;                                            /*YM6362*/  01331000
         LR    R7,R6                                               0502 01332000
*        R6= 0 ;                                            /*YM6362*/  01333000
         SLR   R6,R6                                               0503 01334000
*        GEN( D  R6,THCONV);                                /*YM6362*/  01335000
          D  R6,THCONV                                                  01336000
*        GEN( CVD R7,WORK8) ;                               /*YM6362*/  01337000
          CVD R7,WORK8                                                  01338000
*        R6=WORKB ;                                         /*YM6362*/  01339000
         L     R6,WORKB                                            0506 01340000
*        SRL (R6,FOUR);                                    /*@Z427VLS*/ 01341000
         SRL   R6,4                                                0507 01342000
*        TNTHS=R6 ;                                         /*YM6362*/  01343000
         L     @14,TIMEBASE                                        0508 01344000
         STC   R6,TNTHS(,@14)                                      0508 01345000
*        GEN(D     R4,SIXTY);           /* DIVIDE MIN TO GET HOURS   */ 01346000
         D     R4,SIXTY                                                 01347000
*        GEN(CVD   R4,WORK8);           /* CONVERT # MINUTES @Z427VLS*/ 01348000
         CVD   R4,WORK8                                                 01349000
*        R4=WORKB;                      /* PICK UP CONVERTED #       */ 01350000
         L     R4,WORKB                                            0511 01351000
*        SRL (R4,FOUR);                 /* POSITION IT       @Z427VLS*/ 01352000
         SRL   R4,4                                                0512 01353000
*        MINS=R4;                       /* SET IT INTO REC AS # MINS */ 01354000
         L     @14,TIMEBASE                                        0513 01355000
         STC   R4,MINS(,@14)                                       0513 01356000
*        R4=0 ;                         /*                   @Z427VLS*/ 01357000
         SLR   R4,R4                                               0514 01358000
*        GEN(D     R4,TWENTY4);         /* DIVIDE TO GET HOURS       */ 01359000
         D     R4,TWENTY4                                               01360000
*        GEN(CVD   R4,WORK8);           /* CONVERT # OF HOURS        */ 01361000
         CVD   R4,WORK8                                                 01362000
*        R4=WORKB;                      /* PICK UP VALUE     @Z427VLS*/ 01363000
         L     R4,WORKB                                            0517 01364000
*        SRL (R4,FOUR);                 /* POSITION IT IN REG        */ 01365000
         SRL   R4,4                                                0518 01366000
*        HOURS=R4;                      /* PUT VALUE INTO RECORD     */ 01367000
         L     @14,TIMEBASE                                        0519 01368000
         STC   R4,HOURS(,@14)                                      0519 01369000
*        IF GMTSW='1'B                  /* TEST FOR BASE VALUE TO BE */ 01370000
*              THEN                     /* 1900 OR 1960      @Z427VLS*/ 01371000
         TM    GMTSW(@14),B'10000000'                              0520 01372000
         BNO   @RF00520                                            0520 01373000
*                DO;                                       /*@Z427VLS*/ 01374000
*                  R4 = 0;              /* BIT ON BASE IS 00   YM3662*/ 01375000
         SLR   R4,R4                                               0522 01376000
*                  R5 = R5 + 1;         /* INCREMENT DAY COUNT YM3662   01377000
*                                          SINCE 1900 IS NOT   YM3662   01378000
*                                          A LEAP YEAR AND     YM3662   01379000
*                                          LOOP ASSUMES IT IS  YM3662*/ 01380000
         AL    R5,@CF00056                                         0523 01381000
*                END;                                      /*@Z427VLS*/ 01382000
*              ELSE                     /* IF BIT OFF SET BASE TO 60 */ 01383000
*                   R4=60;              /*                   @Z427VLS*/ 01384000
         B     @RC00520                                            0525 01385000
@RF00520 LA    R4,60                                               0525 01386000
*LEAPYEAR:    ;                         /* R5 HAS NUMBER OF DAYS     */ 01387000
@RC00520 DS    0H                                                  0526 01388000
LEAPYEAR DS    0H                                                  0527 01389000
*        R5=R5-366;                     /* DECREMENT BY A LEAP YEAR  */ 01390000
         LA    @14,366                                             0527 01391000
         SLR   R5,@14                                              0527 01392000
*        IF R5 < ZERO                   /* IF TOO MUCH       @Z427VLS*/ 01393000
*              THEN                     /* THEN DO THE FOLLOWING     */ 01394000
         LTR   R5,R5                                               0528 01395000
         BNM   @RF00528                                            0528 01396000
*                   DO;                 /*                   @Z427VLS*/ 01397000
*                        R5=R5+366;     /* BUMP BACK # OF DAYS BY 366*/ 01398000
         ALR   R5,@14                                              0530 01399000
*                        GOTO CONVNSDN; /* EXIT CONVERSION DONE      */ 01400000
         B     CONVNSDN                                            0531 01401000
*                   END;                /*                   @Z427VLS*/ 01402000
*        R4=R4+1;                       /* ADD 1 FOR YEAR    @Z427VLS*/ 01403000
@RF00528 LA    @14,1                                               0533 01404000
         ALR   R4,@14                                              0533 01405000
*                                       /*                   @Z427VLS*/ 01406000
*                                       /*  DO LOOP FOR REG YEARS    */ 01407000
*        DO A=1 TO 3 BY 1;                                 /*@Z427VLS*/ 01408000
         ST    @14,A                                               0534 01409000
@DL00534 DS    0H                                                  0535 01410000
*              R5=R5-365;               /* DECREMENT BY 365 DAYS     */ 01411000
         LA    @14,365                                             0535 01412000
         SLR   R5,@14                                              0535 01413000
*              IF R5 < ZERO                  /* HAS VALUE    @Z427VLS*/ 01414000
*                   THEN                /* GON NEGATIVE      @Z427VLS*/ 01415000
         LTR   R5,R5                                               0536 01416000
         BNM   @RF00536                                            0536 01417000
*                        DO;            /* IF YES THEN       @Z427VLS*/ 01418000
*                             R5=R5+365;     /* ADD BACK 365 DAYS    */ 01419000
         ALR   R5,@14                                              0538 01420000
*                             GOTO CONVNSDN; /* & EXIT TO FINISH UP  */ 01421000
         B     CONVNSDN                                            0539 01422000
*                        END;                              /*@Z427VLS*/ 01423000
*              R4=R4+1;                 /* ADD 1 YEAR        @Z427VLS*/ 01424000
@RF00536 AL    R4,@CF00056                                         0541 01425000
*        END ;                          /* END OF DO LOOP REPEAT 3X  */ 01426000
         LA    @14,1                                               0542 01427000
         AL    @14,A                                               0542 01428000
         ST    @14,A                                               0542 01429000
         C     @14,@CF00077                                        0542 01430000
         BNH   @DL00534                                            0542 01431000
*        GOTO LEAPYEAR;                                    /*@Z427VLS*/ 01432000
         B     LEAPYEAR                                            0543 01433000
*CONVNSDN:    ;                         /* R4 HAS YEAR       @Z427VLS*/ 01434000
CONVNSDN DS    0H                                                  0545 01435000
*        R5=R5+1;                       /* R5 HAS DAYS ADD 1 TO YEAR */ 01436000
         AL    R5,@CF00056                                         0545 01437000
*        GEN(CVD   R4,WORK8);           /* CONVERT YEARS TO DEC      */ 01438000
         CVD   R4,WORK8                                                 01439000
*        R4=WORKB;                      /* PICK UP VALUE     @Z427VLS*/ 01440000
         L     R4,WORKB                                            0547 01441000
*        SRL (R4,FOUR);                 /* & POSITION IT IN A REG    */ 01442000
         SRL   R4,4                                                0548 01443000
*        YEAR=R4;                       /* PUT YEAR IN RECORD        */ 01444000
         L     @14,TIMEBASE                                        0549 01445000
         STC   R4,YEAR(,@14)                                       0549 01446000
*        GEN(CVD   R5,WORK8);           /* CONVERT THE NO OF DAYS    */ 01447000
         CVD   R5,WORK8                                                 01448000
*        DAYS=(WDAYS | '000F'X);        /* PUT DAYS INTO REC WTH SIGN*/ 01449000
         L     @14,TIMEBASE                                        0551 01450000
         MVC   DAYS(2,@14),WDAYS                                   0551 01451000
         OC    DAYS(2,@14),@CB00981                                0551 01452000
*        DATE0='00'X;                   /* SET HI DIGITS TO ZERO     */ 01453000
         MVI   DATE0(@14),X'00'                                    0552 01454000
*        R7 = R7SAVE;                                      /*@Z427VLS*/ 01455000
         L     R7,R7SAVE                                           0553 01456000
*RESPECIFY (R3,R4,R5,R6,R7) UNRESTRICTED;                  /*@Z427VLS*/ 01457000
* END; /*CLOSING END TO PROC CONVTIME                        @Z427VLS*/ 01458000
         B     @EL00008                                            0555 01459000
*OPENIT: PROC;                                             /*@Z427VLS*/ 01460000
OPENIT   STM   @14,@12,@SA00009                                    0556 01461000
*IF OTOURIST = YES THEN                                            0557 01462000
         L     @14,SAVER2                                          0557 01463000
         TM    OTOURIST(@14),B'10000000'                           0557 01464000
         BNO   @RF00557                                            0557 01465000
*  CALL OPENTOUR;                                          /*@Z427VLS*/ 01466000
         BAL   @14,OPENTOUR                                        0558 01467000
*IF OEREPPT = YES THEN                                             0559 01468000
@RF00557 L     @14,SAVER2                                          0559 01469000
         TM    OEREPPT(@14),B'01000000'                            0559 01470000
         BNO   @RF00559                                            0559 01471000
*  CALL OPENERPT;                                          /*@Z427VLS*/ 01472000
         BAL   @14,OPENERPT                                        0560 01473000
*IF OSERLOG = YES THEN                                             0561 01474000
@RF00559 L     @14,SAVER2                                          0561 01475000
         TM    OSERLOG(@14),B'00100000'                            0561 01476000
         BNO   @RF00561                                            0561 01477000
*  CALL OPENSERL;                                          /*@Z427VLS*/ 01478000
         BAL   @14,OPENSERL                                        0562 01479000
*IF OACCIN = YES THEN                                              0563 01480000
@RF00561 L     @14,SAVER2                                          0563 01481000
         TM    OACCIN(@14),B'00010000'                             0563 01482000
         BNO   @RF00563                                            0563 01483000
*  CALL OPENHIST;                                          /*@Z427VLS*/ 01484000
         BAL   @14,OPENHIST                                        0564 01485000
*IF OACCDEV = YES THEN                                             0565 01486000
@RF00563 L     @14,SAVER2                                          0565 01487000
         TM    OACCDEV(@14),B'00001000'                            0565 01488000
         BNO   @RF00565                                            0565 01489000
*  CALL OPENDEV;                                           /*@Z427VLS*/ 01490000
         BAL   @14,OPENDEV                                         0566 01491000
*IF OSYSIN = YES THEN                                              0567 01492000
@RF00565 L     @14,SAVER2                                          0567 01493000
         TM    OSYSIN(@14),B'00000100'                             0567 01494000
         BNO   @RF00567                                            0567 01495000
*  CALL OPENSYS;                                           /*@Z427VLS*/ 01496000
         BAL   @14,OPENSYS                                         0568 01497000
*IF ODRCTWRK = YES THEN                                            0569 01498000
@RF00567 L     @14,SAVER2                                          0569 01499000
         TM    ODRCTWRK(@14),B'00000010'                           0569 01500000
         BNO   @RF00569                                            0569 01501000
*  CALL OPENDIR;                                           /*@Z427VLS*/ 01502000
         BAL   @14,OPENDIR                                         0570 01503000
*IF OPENIO = NODSETS THEN                                          0571 01504000
@RF00569 L     @14,SAVER2                                          0571 01505000
         CLC   OPENIO(2,@14),@CB00209                              0571 01506000
         BNE   @RF00571                                            0571 01507000
*  DO;                                                     /*@Z427VLS*/ 01508000
*    MSGNO = 17;                                           /*@Z427VLS*/ 01509000
         MVC   MSGNO(4),@CF00991                                   0573 01510000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 01511000
         BAL   @14,ERRMSG                                          0574 01512000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 01513000
         MVC   BADNEWS(4),@CF00068                                 0575 01514000
*  END;                                                    /*@Z427VLS*/ 01515000
*END; /*CLOSING END TO PROC OPENIT                           @Z427VLS*/ 01516000
@EL00009 DS    0H                                                  0577 01517000
@EF00009 DS    0H                                                  0577 01518000
@ER00009 LM    @14,@12,@SA00009                                    0577 01519000
         BR    @14                                                 0577 01520000
*CLOSIT: PROC; /*SELECT DATA SET SPECIFIED AND CLOSE IT      @Z427VLS*/ 01521000
CLOSIT   STM   @14,@12,@SA00010                                    0578 01522000
*IF CEREPPT = YES THEN                                             0579 01523000
         L     @14,SAVER2                                          0579 01524000
         TM    CEREPPT(@14),B'01000000'                            0579 01525000
         BNO   @RF00579                                            0579 01526000
*  CALL CLOSERPT;                                          /*@Z427VLS*/ 01527000
         BAL   @14,CLOSERPT                                        0580 01528000
*IF CACCIN = YES THEN                                              0581 01529000
@RF00579 L     @14,SAVER2                                          0581 01530000
         TM    CACCIN(@14),B'00010000'                             0581 01531000
         BNO   @RF00581                                            0581 01532000
*  CALL CLOSHIST;                                          /*@Z427VLS*/ 01533000
         BAL   @14,CLOSHIST                                        0582 01534000
*IF CACCDEV = YES THEN                                             0583 01535000
@RF00581 L     @14,SAVER2                                          0583 01536000
         TM    CACCDEV(@14),B'00001000'                            0583 01537000
         BNO   @RF00583                                            0583 01538000
*  CALL CLOSEDEV;                                          /*@Z427VLS*/ 01539000
         BAL   @14,CLOSEDEV                                        0584 01540000
*IF CSYSIN = ON THEN                                               0585 01541000
@RF00583 L     @14,SAVER2                                          0585 01542000
         TM    CSYSIN(@14),B'00000100'                             0585 01543000
         BNO   @RF00585                                            0585 01544000
*  CALL CLOSSYS;                                           /*@Z427VLS*/ 01545000
         BAL   @14,CLOSSYS                                         0586 01546000
*IF CDRCTWRK = YES THEN                                            0587 01547000
@RF00585 L     @14,SAVER2                                          0587 01548000
         TM    CDRCTWRK(@14),B'00000010'                           0587 01549000
         BNO   @RF00587                                            0587 01550000
*  CALL CLOSDIR;                                           /*@Z427VLS*/ 01551000
         BAL   @14,CLOSDIR                                         0588 01552000
*IF CSERLOG = YES THEN                                             0589 01553000
@RF00587 L     @14,SAVER2                                          0589 01554000
         TM    CSERLOG(@14),B'00100000'                            0589 01555000
         BNO   @RF00589                                            0589 01556000
*  CALL CLOSSERL;                                          /*@Z427VLS*/ 01557000
         BAL   @14,CLOSSERL                                        0590 01558000
*IF CTOURIST = YES THEN                                            0591 01559000
@RF00589 L     @14,SAVER2                                          0591 01560000
         TM    CTOURIST(@14),B'10000000'                           0591 01561000
         BNO   @RF00591                                            0591 01562000
*  CALL CLOSTOUR;                                          /*@Z427VLS*/ 01563000
         BAL   @14,CLOSTOUR                                        0592 01564000
*/*MUST CLOSE TOURIST LAST TO GET ALL POSSIBLE ERROR MESSAGES*/    0593 01565000
*/*MUST CLOSE SERLOG SECOND TO LAST IN ORDER TO FREE UP AS MUCH*/  0593 01566000
*/*BUFFER SPACE IN ORDER TO DO A POTENTIAL ZEROALL, WHICH IMPLIES*/     01567000
*/*RECORDS WRITTEN WHILE PROCESSING MUST BE SAVED IN CORE. I HOPE*/     01568000
*/*THAT EREP1 HAD ENOUGH SENSE TO FREE UP THE SORTABLE OR ITS */   0593 01569000
*/*EQUIVALENT                                                @Z427VLS*/ 01570000
*IF CLOSEIO = NODSETS THEN                                         0593 01571000
@RF00591 L     @14,SAVER2                                          0593 01572000
         CLC   CLOSEIO(2,@14),@CB00209                             0593 01573000
         BNE   @RF00593                                            0593 01574000
*  DO;                                                     /*@Z427VLS*/ 01575000
*    MSGNO = 32;                                           /*@Z427VLS*/ 01576000
         MVC   MSGNO(4),@CF00522                                   0595 01577000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 01578000
         BAL   @14,ERRMSG                                          0596 01579000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 01580000
         MVC   BADNEWS(4),@CF00068                                 0597 01581000
*  END;                                                    /*@Z427VLS*/ 01582000
*END; /*CLOSING END TO CLOSIT                                @Z427VLS*/ 01583000
@EL00010 DS    0H                                                  0599 01584000
@EF00010 DS    0H                                                  0599 01585000
@ER00010 LM    @14,@12,@SA00010                                    0599 01586000
         BR    @14                                                 0599 01587000
*CLOSSERL: PROC; /*CLOSE THE SERLOG DATA SET AND ALL THAT IMPLIES*/     01588000
CLOSSERL STM   @14,@12,@SA00011                                    0600 01589000
*RESPECIFY (R15,R1,R0) RESTRICTED;                         /*@Z427VLS*/ 01590000
*IF SERLO = ON THEN /*ONLY ATTEMPT TO CLOSE LOGREC IF ALREADY OPEN*/    01591000
         TM    SERLO,B'10000000'                                   0602 01592000
         BNO   @RF00602                                            0602 01593000
*DO;                                                       /*@Z427VLS*/ 01594000
*IF DEBUG15 = ON THEN                                              0604 01595000
         L     @14,SAVER2                                          0604 01596000
         TM    DEBUG15(@14),B'00000001'                            0604 01597000
         BNO   @RF00604                                            0604 01598000
*  DO;                                                     /*@Z427VLS*/ 01599000
*    MSGNO = 56;                                           /*@Z427VLS*/ 01600000
         MVC   MSGNO(4),@CF01005                                   0606 01601000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 01602000
         BAL   @14,ERRMSG                                          0607 01603000
*  END;                                                    /*@Z427VLS*/ 01604000
*IF ZEROALL = YES  /*ZEROALL MEANS RESET THE HEADER TO INDICATE NO*/    01605000
*                  /*DATA. FIRST, ANY RECORDS WRITTEN WHILE PROCESS-*/  01606000
*               /*ING ARE READ INTO CORE. SECOND, THE HEADER IS */ 0609 01607000
*               /*RESET. THIRD, SVC 76 IS ISSUED TO REWRITE THE*/  0609 01608000
*               /*RECORDS BACK TO THE NEW SERLOG             @Z427VLS*/ 01609000
*  THEN DO;                                                /*@Z427VLS*/ 01610000
@RF00604 L     @14,SAVER2                                          0609 01611000
         TM    ZEROALL(@14),B'01000000'                            0609 01612000
         BNO   @RF00609                                            0609 01613000
*    IF DEBUG15 = ON THEN                                          0611 01614000
         TM    DEBUG15(@14),B'00000001'                            0611 01615000
         BNO   @RF00611                                            0611 01616000
*      DO;                                                 /*@Z427VLS*/ 01617000
*        MSGNO = 57;                                       /*@Z427VLS*/ 01618000
         MVC   MSGNO(4),@CF01006                                   0613 01619000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01620000
         BAL   @14,ERRMSG                                          0614 01621000
*      END;                                                /*@Z427VLS*/ 01622000
*    LASTLOOP = YES; /*INDICATE ZEROALL PROCESSING           @Z427VLS*/ 01623000
@RF00611 OI    LASTLOOP,B'00000100'                                0616 01624000
*    CALL CHECKHDR; /*SET UP TO READ RECORDS WRITTEN TO LOGREC WHILE*/  01625000
         BAL   @14,CHECKHDR                                        0617 01626000
*                   /*EREP HAS BEEN PROCESSING               @Z427VLS*/ 01627000
*    IF BADNEWS = ZERO THEN /*NO PROBLEMS, YES THERE ARE MORE RECORDS*/ 01628000
         L     @14,BADNEWS                                         0618 01629000
         LTR   @14,@14                                             0618 01630000
         BNZ   @RF00618                                            0618 01631000
*      DO;                                                 /*@Z427VLS*/ 01632000
*        CALL SAVEM; /*READ RECORDS INTO CORE                @Z427VLS*/ 01633000
         BAL   @14,SAVEM                                           0620 01634000
*        CALL RESETHDR;                                    /*@Z427VLS*/ 01635000
         BAL   @14,RESETHDR                                        0621 01636000
*        GEN(DEQ  (RESIDII,LOGRECB,8,SYSTEM));             /*@Z427VLS*/ 01637000
         DEQ  (RESIDII,LOGRECB,8,SYSTEM)                                01638000
*        RUNPTR = FRSPTR;                                  /*@Z427VLS*/ 01639000
         L     @14,FRSPTR                                          0623 01640000
         ST    @14,RUNPTR                                          0623 01641000
*        IF FRSPTR ^= ZERO THEN                                    0624 01642000
         LTR   @14,@14                                             0624 01643000
         BZ    @RF00624                                            0624 01644000
*         DO UNTIL RUNPTR = ZERO;                          /*@Z427VLS*/ 01645000
@DL00625 DS    0H                                                  0626 01646000
*           CALL ISSUE76;                                  /*@Z427VLS*/ 01647000
         BAL   @14,ISSUE76                                         0626 01648000
*           RUNPTR = FORPTR;                               /*@Z427VLS*/ 01649000
         L     @14,RUNPTR                                          0627 01650000
         L     @14,FORPTR(,@14)                                    0627 01651000
         ST    @14,RUNPTR                                          0627 01652000
*         END;                                             /*@Z427VLS*/ 01653000
@DE00625 L     @14,RUNPTR                                          0628 01654000
         LTR   @14,@14                                             0628 01655000
         BNZ   @DL00625                                            0628 01656000
*      END;                                                /*@Z427VLS*/ 01657000
*    ELSE                                                          0630 01658000
*      DO;     /* NO RECORDS WRITTEN WHILE PROCESSING?       @Z427VLS*/ 01659000
         B     @RC00618                                            0630 01660000
@RF00618 DS    0H                                                  0631 01661000
*        IF BADNEWS = FOUR THEN                                    0631 01662000
         CLC   BADNEWS(4),@CF00065                                 0631 01663000
         BNE   @RF00631                                            0631 01664000
*          DO;                                             /*@ZA18998*/ 01665000
*            BADNEWS=ZERO;                /* RESET RTN CODE  @ZA19017*/ 01666000
         SLR   @14,@14                                             0633 01667000
         ST    @14,BADNEWS                                         0633 01668000
*            CALL RESETHDR;               /* RESET HEADER    @Z427VLS*/ 01669000
         BAL   @14,RESETHDR                                        0634 01670000
*          END;                                            /*@ZA18998*/ 01671000
*        GEN(DEQ  (RESIDII,LOGRECB,8,SYSTEM));             /*@Z427VLS*/ 01672000
@RF00631 DS    0H                                                  0636 01673000
         DEQ  (RESIDII,LOGRECB,8,SYSTEM)                                01674000
*      END;                                                /*@Z427VLS*/ 01675000
*  END;                                                    /*@Z427VLS*/ 01676000
@RC00618 DS    0H                                                  0639 01677000
*GEN(DEQ   (RESID,LOGRECA,11,STEP)); /*LET OTHER EREPS AT LOGREC*/ 0639 01678000
@RF00609 DS    0H                                                  0639 01679000
         DEQ   (RESID,LOGRECA,11,STEP)                                  01680000
*GEN(CLOSE (LOGREC));  /*CLOSE THE DCB                       @Z427VLS*/ 01681000
         CLOSE (LOGREC)                                                 01682000
*SERLO = OFF; /*INDICATE THAT SERLOG IS CLOSED               @Z427VLS*/ 01683000
         NI    SERLO,B'01111111'                                   0641 01684000
*END;                                                      /*@Z427VLS*/ 01685000
*ELSE /*IF SERLOG WAS NOT OPEN                               @Z427VLS*/ 01686000
*  DO;                                                     /*@Z427VLS*/ 01687000
         B     @RC00602                                            0643 01688000
@RF00602 DS    0H                                                  0644 01689000
*    IF CLOSEIO ^= CLOSEALL THEN /*END OF JOB WRAPUP CLOSEALL ALLOWED*/ 01690000
         L     @14,SAVER2                                          0644 01691000
         CLC   CLOSEIO(2,@14),@CB00262                             0644 01692000
         BE    @RF00644                                            0644 01693000
*      DO;                                                 /*@Z427VLS*/ 01694000
*        MSGNO = 51;                                       /*@Z427VLS*/ 01695000
         MVC   MSGNO(4),@CF01009                                   0646 01696000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01697000
         BAL   @14,ERRMSG                                          0647 01698000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 01699000
         MVC   BADNEWS(4),@CF00068                                 0648 01700000
*      END;                                                /*@Z427VLS*/ 01701000
*  END;                                                    /*@Z427VLS*/ 01702000
*RESPECIFY (R15,R0,R1) UNRESTRICTED;                       /*@Z427VLS*/ 01703000
*END; /*CLOSING END TO PROC CLOSSERL                         @Z427VLS*/ 01704000
@EL00011 DS    0H                                                  0652 01705000
@EF00011 DS    0H                                                  0652 01706000
@ER00011 LM    @14,@12,@SA00011                                    0652 01707000
         BR    @14                                                 0652 01708000
*ISSUE76: PROC;                                            /*@Z427VLS*/ 01709000
ISSUE76  STM   @14,@12,@SA00012                                    0653 01710000
*RESPECIFY (R0,R1) RESTRICTED;                             /*@Z427VLS*/ 01711000
*IF DEBUG15 = ON THEN                                              0655 01712000
         L     @12,SAVER2                                          0655 01713000
         TM    DEBUG15(@12),B'00000001'                            0655 01714000
         BNO   @RF00655                                            0655 01715000
*  DO;                                                     /*@Z427VLS*/ 01716000
*    MSGNO = 58;                                           /*@Z427VLS*/ 01717000
         MVC   MSGNO(4),@CF01013                                   0657 01718000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 01719000
         BAL   @14,ERRMSG                                          0658 01720000
*  END;                                                    /*@Z427VLS*/ 01721000
*R0 =JUNK3;                                                /*@Z427VLS*/ 01722000
@RF00655 L     @12,RUNPTR                                          0660 01723000
         LH    R0,JUNK3(,@12)                                      0660 01724000
*R1 = ADDR(RECSPT);                                        /*@Z427VLS*/ 01725000
         LA    R1,RECSPT(,@12)                                     0661 01726000
*R0 = R0 * (-1);                                           /*@Z427VLS*/ 01727000
         LR    @12,R0                                              0662 01728000
         MH    @12,@CH01014                                        0662 01729000
         LR    R0,@12                                              0662 01730000
*SVC(76);                                                  /*@Z427VLS*/ 01731000
         SVC   76                                                  0663 01732000
*RESPECIFY (R0,R1) UNRESTRICTED;                           /*@Z427VLS*/ 01733000
*END; /*CLOSING END TO PROC ISSUE76                          @Z427VLS*/ 01734000
@EL00012 DS    0H                                                  0665 01735000
@EF00012 DS    0H                                                  0665 01736000
@ER00012 LM    @14,@12,@SA00012                                    0665 01737000
         BR    @14                                                 0665 01738000
*SAVEM: PROC;                                              /*@Z427VLS*/ 01739000
SAVEM    STM   @14,@12,@SA00013                                    0666 01740000
*RESPECIFY (R2,R3,R4,R5,R6,R15) RESTRICTED;                /*@Z427VLS*/ 01741000
*DO WHILE BADNEWS = ZERO;                                  /*@Z427VLS*/ 01742000
         B     @DE00668                                            0668 01743000
@DL00668 DS    0H                                                  0669 01744000
*  CALL READSER;                                           /*@Z427VLS*/ 01745000
         BAL   @14,READSER                                         0669 01746000
*  IF BADNEWS = ZERO THEN                                          0670 01747000
         L     @14,BADNEWS                                         0670 01748000
         LTR   @14,@14                                             0670 01749000
         BNZ   @RF00670                                            0670 01750000
*    DO;                                                   /*@Z427VLS*/ 01751000
*      DBLYES = NO;                                        /*@Z427VLS*/ 01752000
         NI    DBLYES,B'11110111'                                  0672 01753000
*      GETHIS = BSZ;                                       /*@Z427VLS*/ 01754000
         LH    @14,BSZ                                             0673 01755000
         ST    @14,GETHIS                                          0673 01756000
*      GETHIS = GETHIS + 12;                               /*@Z427VLS*/ 01757000
         AL    @14,@CF00068                                        0674 01758000
         ST    @14,GETHIS                                          0674 01759000
*      DO WHILE DBLYES = NO;                               /*@Z427VLS*/ 01760000
         B     @DE00675                                            0675 01761000
@DL00675 DS    0H                                                  0676 01762000
*        IF (GETTIT & DBLWORD) ^= NULL THEN                        0676 01763000
         MVC   @TS00001(4),GETTIT                                  0676 01764000
         NC    @TS00001(4),@CB00523                                0676 01765000
         CLC   @TS00001(4),@CB00120                                0676 01766000
         BE    @RF00676                                            0676 01767000
*          GETHIS = GETHIS + 1;                            /*@Z427VLS*/ 01768000
         LA    @14,1                                               0677 01769000
         AL    @14,GETHIS                                          0677 01770000
         ST    @14,GETHIS                                          0677 01771000
*        ELSE                                                      0678 01772000
*          DBLYES = YES;                                   /*@Z427VLS*/ 01773000
         B     @RC00676                                            0678 01774000
@RF00676 OI    DBLYES,B'00001000'                                  0678 01775000
*      END;                                                /*@Z427VLS*/ 01776000
@RC00676 DS    0H                                                  0679 01777000
@DE00675 TM    DBLYES,B'00001000'                                  0679 01778000
         BZ    @DL00675                                            0679 01779000
*      R6 = GETTIT; /*NUMBER OF BYTES NEEDED IN R6           @Z427VLS*/ 01780000
         L     R6,GETTIT                                           0680 01781000
*      GEN(GETMAIN  EC,LV=(R6),A=SAVEPTR); /*STORAGE FOR RECORD*/  0681 01782000
         GETMAIN  EC,LV=(R6),A=SAVEPTR                                  01783000
*      NUMRECSV = NUMRECSV + 1;                            /*@Z427VLS*/ 01784000
         LA    @14,1                                               0682 01785000
         AL    @14,NUMRECSV                                        0682 01786000
         ST    @14,NUMRECSV                                        0682 01787000
*      IF R15 = ZERO THEN                                          0683 01788000
         LTR   R15,R15                                             0683 01789000
         BNZ   @RF00683                                            0683 01790000
*        DO;                                               /*@Z427VLS*/ 01791000
*          IF SECGET = NO THEN /*IF FIRST RECORD SAVED THEN  @Z427VLS*/ 01792000
         TM    SECGET,B'01000000'                                  0685 01793000
         BNZ   @RF00685                                            0685 01794000
*            DO;                                           /*@Z427VLS*/ 01795000
*              SECGET = YES;                               /*@Z427VLS*/ 01796000
         OI    SECGET,B'01000000'                                  0687 01797000
*              FRSPTR = SAVEPTR; /*POINTER TO FIRST RECORD SAVED*/ 0688 01798000
         L     @14,SAVEPTR                                         0688 01799000
         ST    @14,FRSPTR                                          0688 01800000
*              RUNPTR = SAVEPTR; /*ESTABLISH ADDRESSABILITY  @Z427VLS*/ 01801000
         ST    @14,RUNPTR                                          0689 01802000
*            END;                                          /*@Z427VLS*/ 01803000
*           ELSE /*IF SAVING SECOND RECORD THEN              @Z427VLS*/ 01804000
*            DO;                                           /*@Z427VLS*/ 01805000
         B     @RC00685                                            0691 01806000
@RF00685 DS    0H                                                  0692 01807000
*              FORPTR = SAVEPTR; /*SET FORWARD POINTER FROM OLD REC*/   01808000
         L     @14,SAVEPTR                                         0692 01809000
         L     @12,RUNPTR                                          0692 01810000
         ST    @14,FORPTR(,@12)                                    0692 01811000
*                                /*TO LOCATION OF NEW RECORD SAVE ARR*/ 01812000
*              RUNPTR = SAVEPTR; /*ESTABLISH ADDRESS OF NEW RECORD*/    01813000
         ST    @14,RUNPTR                                          0693 01814000
*            END;                                          /*@Z427VLS*/ 01815000
*          R2 = ADDR(JUNK);                                /*@Z427VLS*/ 01816000
@RC00685 L     R2,RUNPTR                                           0695 01817000
         LA    R2,JUNK(,R2)                                        0695 01818000
*          R3 = GETHIS - 4;                                /*@Z427VLS*/ 01819000
         L     R3,GETHIS                                           0696 01820000
         SL    R3,@CF00065                                         0696 01821000
*          R4 = ADDR(BCOUNT); /*MAY BE WRONG                 @Z427VLS*/ 01822000
         LA    R4,BCOUNT                                           0697 01823000
*          R5 = R3;                                        /*@Z427VLS*/ 01824000
         LR    R5,R3                                               0698 01825000
*          MVCL(R2,R4);                                    /*@Z427VLS*/ 01826000
         MVCL  R2,R4                                               0699 01827000
*          FORPTR = ZERO;                                  /*@Z427VLS*/ 01828000
         L     @14,RUNPTR                                          0700 01829000
         SLR   @12,@12                                             0700 01830000
         ST    @12,FORPTR(,@14)                                    0700 01831000
*        END;                                              /*@Z427VLS*/ 01832000
*      ELSE                                                        0702 01833000
*        DO;                                               /*@Z427VLS*/ 01834000
         B     @RC00683                                            0702 01835000
@RF00683 DS    0H                                                  0703 01836000
*          MSGNO = 50;                                     /*@Z427VLS*/ 01837000
         MVC   MSGNO(4),@CF00294                                   0703 01838000
*          CALL ERRMSG;                                    /*@Z427VLS*/ 01839000
         BAL   @14,ERRMSG                                          0704 01840000
*          BADNEWS = TWELVE;                               /*@Z427VLS*/ 01841000
         MVC   BADNEWS(4),@CF00068                                 0705 01842000
*        END;                                              /*@Z427VLS*/ 01843000
*     END;                                                 /*@Z427VLS*/ 01844000
@RC00683 DS    0H                                                  0708 01845000
*   END;                                                   /*@Z427VLS*/ 01846000
@RF00670 DS    0H                                                  0708 01847000
@DE00668 L     @14,BADNEWS                                         0708 01848000
         LTR   @14,@14                                             0708 01849000
         BZ    @DL00668                                            0708 01850000
*RESPECIFY (R2,R3,R4,R5,R6,R15) UNRESTRICTED;              /*@Z427VLS*/ 01851000
*END; /*CLOSING END TO PROC SAVEM                            @Z427VLS*/ 01852000
@EL00013 DS    0H                                                  0710 01853000
@EF00013 DS    0H                                                  0710 01854000
@ER00013 LM    @14,@12,@SA00013                                    0710 01855000
         BR    @14                                                 0710 01856000
*ERRMSG: PROC; /*WRITE ERROR MESSAGES TO THE TOURIST DATA SET*/    0711 01857000
ERRMSG   STM   @14,@12,@SA00014                                    0711 01858000
*              /*IF THE PROBLEM EXISTS WITH THE TOURIST DATA SET*/ 0712 01859000
*              /*THEN WRITE TO THE OPERATOR. IF THE OPERATOR @Z427VLS*/ 01860000
*              /*CANNOT BE REACHED, THEN YOU ARE ASKING TOO MUCH*/ 0712 01861000
*              /*OF THIS PROGRAM                             @Z427VLS*/ 01862000
*RESPECIFY (R7,R12,R5) RESTRICTED;                         /*@Z427VLS*/ 01863000
*GEN(MVC PRNTBF(134),BLANKS); /*CLEAR INTERNAL PRINT BUFFER  @Z427VLS*/ 01864000
         MVC PRNTBF(134),BLANKS                                         01865000
*IF MSGNO <= 52 THEN            /* SYSTEM ERROR MESSAGE ?    @Z427VLS*/ 01866000
         L     @06,MSGNO                                           0714 01867000
         C     @06,@CF01024                                        0714 01868000
         BH    @RF00714                                            0714 01869000
*  DO;                                                     /*@Z427VLS*/ 01870000
*    CALL IFCMSG(MSGNO,ADDR(PRNTBF)+2);                    /*@Z427VLS*/ 01871000
         LA    @06,PRNTBF                                          0716 01872000
         AL    @06,@CF00075                                        0716 01873000
         ST    @06,@AFTEMPS+4                                      0716 01874000
         L     @06,SAVER2                                          0716 01875000
         L     @15,ADIFCMSG(,@06)                                  0716 01876000
         LA    @01,@AL00716                                        0716 01877000
         BALR  @14,@15                                             0716 01878000
*    PRNTBF(1:2) = '1 ';                                   /*@Z427VLS*/ 01879000
         MVC   PRNTBF(2),@CC01025                                  0717 01880000
*  END;                                                    /*@Z427VLS*/ 01881000
*ELSE                                                              0719 01882000
*  DO;                                                     /*@Z427VLS*/ 01883000
         B     @RC00714                                            0719 01884000
@RF00714 DS    0H                                                  0720 01885000
*    MSGNO = MSGNO - 52;                                   /*@Z427VLS*/ 01886000
         L     @06,MSGNO                                           0720 01887000
         SL    @06,@CF01024                                        0720 01888000
         ST    @06,MSGNO                                           0720 01889000
*    R5 = ADDR(ERRLINE) + (51 * (MSGNO - 1)); /*POINT TO MESSAGE TEXT*/ 01890000
         LA    R5,ERRLINE                                          0721 01891000
         BCTR  @06,0                                               0721 01892000
         MH    @06,@CH01009                                        0721 01893000
         ALR   R5,@06                                              0721 01894000
*    GEN(MVC PRNTBF(51),0(R5)); /*MOVE TEXT TO INTERNAL PRINT BUFFER*/  01895000
         MVC PRNTBF(51),0(R5)                                           01896000
*  END;                                                    /*@Z427VLS*/ 01897000
*PRINTADR = ADDR(PRNTBF); /*ADDRESS THE DATA SET TYPE        @Z427VLS*/ 01898000
@RC00714 LA    @06,PRNTBF                                          0724 01899000
         L     @04,SAVER2                                          0724 01900000
         ST    @06,PRINTADR(,@04)                                  0724 01901000
*IF TOUROPN = YES                 THEN /*IF TOURIST DATA SET IS OPEN*/  01902000
         TM    TOUROPN,B'00000010'                                 0725 01903000
         BNO   @RF00725                                            0725 01904000
*  DO;                                                     /*@Z427VLS*/ 01905000
*     R7 = PRINTADR + 1; /*POINT PAST DATA SET INDICATOR     @Z427VLS*/ 01906000
         LA    R7,1                                                0727 01907000
         ALR   R7,@06                                              0727 01908000
*     CCSAVE = PRINTCC; /*SAVE CARRIAGE CONTROL FROM CALLER  @Z427VLS*/ 01909000
         MVC   CCSAVE(1),PRINTCC(@06)                              0728 01910000
*     PRINTCC = '09'X; /*CARRIAGE CONTROL TO PRINT ONE LINE  @Z427VLS*/ 01911000
         MVI   PRINTCC(@06),X'09'                                  0729 01912000
*     GEN(LA R12,TOURDCB); /*ADDRESS TOURIST DCB             @Z427VLS*/ 01913000
         LA R12,TOURDCB                                                 01914000
*     GEN(PUT (12),(R7));                                  /*@Z427VLS*/ 01915000
         PUT (12),(R7)                                                  01916000
*     PRINTCC = CCSAVE; /*RESTORE CALLERS CARRIAGE CONTROL   @Z427VLS*/ 01917000
         L     @06,SAVER2                                          0732 01918000
         L     @04,PRINTADR(,@06)                                  0732 01919000
         MVC   PRINTCC(1,@04),CCSAVE                               0732 01920000
*     PRINTBDY = BLANKS; /*CLEAR PRINT LINE FOR CALLER       @Z427VLS*/ 01921000
         MVC   PRINTBDY(132,@04),BLANKS                            0733 01922000
*     LINECTT = LINECTT + 1;                               /*@Z427VLS*/ 01923000
         LA    @15,1                                               0734 01924000
         AH    @15,LINECTT                                         0734 01925000
         STH   @15,LINECTT                                         0734 01926000
*     IF LINECTT = LINECT THEN                                     0735 01927000
         CH    @15,LINECT(,@06)                                    0735 01928000
         BNE   @RF00735                                            0735 01929000
*       DO;                                                /*@Z427VLS*/ 01930000
*         LINECTT = 0;                                     /*@Z427VLS*/ 01931000
         SLR   @06,@06                                             0737 01932000
         STH   @06,LINECTT                                         0737 01933000
*         CCSAVE = PRINTCC;                                /*@Z427VLS*/ 01934000
         MVC   CCSAVE(1),PRINTCC(@04)                              0738 01935000
*         PRINTCC = SKIPNEW;                               /*@Z427VLS*/ 01936000
         MVI   PRINTCC(@04),X'8B'                                  0739 01937000
*         GEN(PUT (R12),(R7));                             /*@Z427VLS*/ 01938000
         PUT (R12),(R7)                                                 01939000
*         PRINTCC = CCSAVE;                                /*@Z427VLS*/ 01940000
         L     @06,SAVER2                                          0741 01941000
         L     @06,PRINTADR(,@06)                                  0741 01942000
         MVC   PRINTCC(1,@06),CCSAVE                               0741 01943000
*       END;                                               /*@Z427VLS*/ 01944000
*  END;                                                    /*@Z427VLS*/ 01945000
* ELSE /*IF TOURIST UNREADABLE THEN GO TO OPERATOR           @Z427VLS*/ 01946000
*   CALL IFCMSG(202,ADDR(PRNTBF));                         /*@Z427VLS*/ 01947000
         B     @RC00725                                            0744 01948000
@RF00725 LA    @06,PRNTBF                                          0744 01949000
         ST    @06,@AFTEMPS+4                                      0744 01950000
         L     @06,SAVER2                                          0744 01951000
         L     @15,ADIFCMSG(,@06)                                  0744 01952000
         LA    @01,@AL00744                                        0744 01953000
         BALR  @14,@15                                             0744 01954000
*RESPECIFY (R7,R12,R5) UNRESTRICTED;                       /*@Z427VLS*/ 01955000
* END; /*CLOSING END TO ERRMSG PROC                          @Z427VLS*/ 01956000
@EL00014 DS    0H                                                  0746 01957000
@EF00014 DS    0H                                                  0746 01958000
@ER00014 LM    @14,@12,@SA00014                                    0746 01959000
         BR    @14                                                 0746 01960000
*PRINTIT: PROC; /*SELECT PRINT DATA SET AND PRINT LINE REQUESTED*/ 0747 01961000
PRINTIT  STM   @14,@12,@SA00015                                    0747 01962000
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/ 01963000
*IF PRINTDS = 'F0'X THEN /*IF PRINT TO ERREPT THEN           @Z427VLS*/ 01964000
         L     @06,SAVER2                                          0749 01965000
         L     @06,PRINTADR(,@06)                                  0749 01966000
         CLI   PRINTDS(@06),X'F0'                                  0749 01967000
         BNE   @RF00749                                            0749 01968000
*  DO;                                                     /*@Z427VLS*/ 01969000
*    IF ERPTOPN = ON THEN /*IF ERREPT HAS BEEN OPENED THEN   @Z427VLS*/ 01970000
         TM    ERPTOPN,B'00000001'                                 0751 01971000
         BNO   @RF00751                                            0751 01972000
*      DO;                                                 /*@Z427VLS*/ 01973000
*        GEN(LA R12,EREPTDCB); /*ADDRESS ERREPT DCB          @Z427VLS*/ 01974000
         LA R12,EREPTDCB                                                01975000
*        R7 = PRINTADR + 1; /*POINT PAST THE DATA SET DEFINER*/    0754 01976000
         LA    R7,1                                                0754 01977000
         L     @06,SAVER2                                          0754 01978000
         AL    R7,PRINTADR(,@06)                                   0754 01979000
*        GEN(TR 0(1,R7),MACHCODE); /* ENSURE VALID CODE      @ZA18999*/ 01980000
         TR 0(1,R7),MACHCODE                                            01981000
*        GEN(PUT (12),(7));                                /*@Z427VLS*/ 01982000
         PUT (12),(7)                                                   01983000
*        PRINTBDY = BLANKS; /*CLEAR PRINT LINE FOR CALLER    @Z427VLS*/ 01984000
         L     @06,SAVER2                                          0757 01985000
         L     @06,PRINTADR(,@06)                                  0757 01986000
         MVC   PRINTBDY(132,@06),BLANKS                            0757 01987000
*      END;                                                /*@Z427VLS*/ 01988000
*    ELSE /*REQUEST TO WRITE TO DATA SET NOT OPEN            @Z427VLS*/ 01989000
*      DO;                                                 /*@Z427VLS*/ 01990000
         B     @RC00751                                            0759 01991000
@RF00751 DS    0H                                                  0760 01992000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 01993000
         MVC   BADNEWS(4),@CF00068                                 0760 01994000
*        MSGNO = 19;                                       /*@Z427VLS*/ 01995000
         MVC   MSGNO(4),@CF01030                                   0761 01996000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01997000
         BAL   @14,ERRMSG                                          0762 01998000
*      END;                                                /*@Z427VLS*/ 01999000
*  END;                                                    /*@Z427VLS*/ 02000000
*ELSE /*REQUEST FOR WRITE TO TOURIST DATA SET                @Z427VLS*/ 02001000
*  DO;                                                     /*@Z427VLS*/ 02002000
         B     @RC00749                                            0765 02003000
@RF00749 DS    0H                                                  0766 02004000
*    IF TOUROPN = YES THEN /*IF TOURIST DATA SET IS OPEN THEN*/    0766 02005000
         TM    TOUROPN,B'00000010'                                 0766 02006000
         BNO   @RF00766                                            0766 02007000
*      DO;                                                 /*@Z427VLS*/ 02008000
*        R7 = PRINTADR + 1; /* POINT PAST DATA SET ID        @Z427VLS*/ 02009000
         L     @01,SAVER2                                          0768 02010000
         L     @15,PRINTADR(,@01)                                  0768 02011000
         LA    R7,1                                                0768 02012000
         ALR   R7,@15                                              0768 02013000
*        CCSAVE = PRINTCC;                                 /*@Z427VLS*/ 02014000
         MVC   CCSAVE(1),PRINTCC(@15)                              0769 02015000
*        PRINTCC = '09'X; /*SET TO PRINT AND SKIP ONE        @Z427VLS*/ 02016000
         MVI   PRINTCC(@15),X'09'                                  0770 02017000
*        GEN(LA R12,TOURDCB); /*ADDRESS TOURIST DCB          @Z427VLS*/ 02018000
         LA R12,TOURDCB                                                 02019000
*        GEN(PUT (12),(7)); /*PUT TO TOURIST                 @Z427VLS*/ 02020000
         PUT (12),(7)                                                   02021000
*        PRINTCC = CCSAVE; /*RESTORE USERS CARRIAGE CONTROL  @Z427VLS*/ 02022000
         L     @06,SAVER2                                          0773 02023000
         L     @15,PRINTADR(,@06)                                  0773 02024000
         MVC   PRINTCC(1,@15),CCSAVE                               0773 02025000
*        PRINTBDY = BLANKS; /*BLANKS TO CALLERS LINE         @Z427VLS*/ 02026000
         MVC   PRINTBDY(132,@15),BLANKS                            0774 02027000
*        LINECTT = LINECTT + 1;                            /*@Z427VLS*/ 02028000
         LA    @14,1                                               0775 02029000
         AH    @14,LINECTT                                         0775 02030000
         STH   @14,LINECTT                                         0775 02031000
*        IF LINECTT = LINECT THEN                                  0776 02032000
         CH    @14,LINECT(,@06)                                    0776 02033000
         BNE   @RF00776                                            0776 02034000
*          DO;                                             /*@Z427VLS*/ 02035000
*            LINECTT = 0;                                  /*@Z427VLS*/ 02036000
         SLR   @06,@06                                             0778 02037000
         STH   @06,LINECTT                                         0778 02038000
*            CCSAVE = PRINTCC;                             /*@Z427VLS*/ 02039000
         MVC   CCSAVE(1),PRINTCC(@15)                              0779 02040000
*            PRINTCC = SKIPNEW;                            /*@Z427VLS*/ 02041000
         MVI   PRINTCC(@15),X'8B'                                  0780 02042000
*            GEN(PUT (R12),(R7));                          /*@Z427VLS*/ 02043000
         PUT (R12),(R7)                                                 02044000
*            PRINTCC = CCSAVE;                             /*@Z427VLS*/ 02045000
         L     @06,SAVER2                                          0782 02046000
         L     @06,PRINTADR(,@06)                                  0782 02047000
         MVC   PRINTCC(1,@06),CCSAVE                               0782 02048000
*          END;                                            /*@Z427VLS*/ 02049000
*     END;                                                 /*@Z427VLS*/ 02050000
*   ELSE  /*IMPLIES TOURIST DATA SET NOT OPEN                @Z427VLS*/ 02051000
*     DO;                                                  /*@Z427VLS*/ 02052000
         B     @RC00766                                            0785 02053000
@RF00766 DS    0H                                                  0786 02054000
*       CALL IFCMSG(203,ADDR(PRNTBF));                     /*@Z427VLS*/ 02055000
         LA    @06,PRNTBF                                          0786 02056000
         ST    @06,@AFTEMPS+8                                      0786 02057000
         L     @06,SAVER2                                          0786 02058000
         L     @15,ADIFCMSG(,@06)                                  0786 02059000
         LA    @01,@AL00786                                        0786 02060000
         BALR  @14,@15                                             0786 02061000
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/ 02062000
         MVC   BADNEWS(4),@CF00068                                 0787 02063000
*     END;                                                 /*@Z427VLS*/ 02064000
*  END;                                                    /*@Z427VLS*/ 02065000
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/ 02066000
*END; /*CLOSING END TO PROC PRINTIT                          @Z427VLS*/ 02067000
@EL00015 DS    0H                                                  0791 02068000
@EF00015 DS    0H                                                  0791 02069000
@ER00015 LM    @14,@12,@SA00015                                    0791 02070000
         BR    @14                                                 0791 02071000
*OPENSYS: PROC; /*OPEN SYSIN DATA SET TO READ CARDS          @Z427VLS*/ 02072000
OPENSYS  STM   @14,@12,@SA00016                                    0792 02073000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02074000
*IF SYSOPN = NO THEN /* IF ALREADY OPEN IS NO NO             @Z427VLS*/ 02075000
         TM    SYSOPN,B'00000100'                                  0794 02076000
         BNZ   @RF00794                                            0794 02077000
*  DO;                                                     /*@Z427VLS*/ 02078000
*    IF DEBUG15 = ON THEN                                          0796 02079000
         L     @01,SAVER2                                          0796 02080000
         TM    DEBUG15(@01),B'00000001'                            0796 02081000
         BNO   @RF00796                                            0796 02082000
*      DO;                                                 /*@Z427VLS*/ 02083000
*        MSGNO = 59;                                       /*@Z427VLS*/ 02084000
         MVC   MSGNO(4),@CF01035                                   0798 02085000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02086000
         BAL   @14,ERRMSG                                          0799 02087000
*      END;                                                /*@Z427VLS*/ 02088000
*    GENERATE;                                             /*@Z427VLS*/ 02089000
@RF00796 DS    0H                                                  0801 02090000
         LA    R12,SYSDCB                                               02091000
         OPEN  ((R12),(INPUT))                                          02092000
         TM    DCBOFLGS,OPENOK                                          02093000
         BZ    SYSOBAD                                                  02094000
*   SYSOPN = YES;                                          /*@Z427VLS*/ 02095000
         OI    SYSOPN,B'00000100'                                  0802 02096000
*  END;                                                    /*@Z427VLS*/ 02097000
*ELSE                                                              0804 02098000
*  DO;                                                     /*@Z427VLS*/ 02099000
         B     @RC00794                                            0804 02100000
@RF00794 DS    0H                                                  0805 02101000
*    MSGNO = 33;                                           /*@Z427VLS*/ 02102000
         MVC   MSGNO(4),@CF01036                                   0805 02103000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02104000
         BAL   @14,ERRMSG                                          0806 02105000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02106000
         MVC   BADNEWS(4),@CF00068                                 0807 02107000
*  END;                                                    /*@Z427VLS*/ 02108000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02109000
*END; /*CLOSING END TO PROC OPENSYS                          @Z427VLS*/ 02110000
@EL00016 DS    0H                                                  0810 02111000
@EF00016 DS    0H                                                  0810 02112000
@ER00016 LM    @14,@12,@SA00016                                    0810 02113000
         BR    @14                                                 0810 02114000
*CLOSSYS: PROC; /*CLOSE SYSIN DATA SET FOR READING CARDS     @Z427VLS*/ 02115000
CLOSSYS  STM   @14,@12,@SA00017                                    0811 02116000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02117000
*IF SYSOPN = YES THEN                                              0813 02118000
         TM    SYSOPN,B'00000100'                                  0813 02119000
         BNO   @RF00813                                            0813 02120000
*  DO;                                                     /*@Z427VLS*/ 02121000
*    IF DEBUG15 = ON THEN                                          0815 02122000
         L     @01,SAVER2                                          0815 02123000
         TM    DEBUG15(@01),B'00000001'                            0815 02124000
         BNO   @RF00815                                            0815 02125000
*      DO;                                                 /*@Z427VLS*/ 02126000
*        MSGNO = 60;                                       /*@Z427VLS*/ 02127000
         MVC   MSGNO(4),@CF00832                                   0817 02128000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02129000
         BAL   @14,ERRMSG                                          0818 02130000
*      END;                                                /*@Z427VLS*/ 02131000
*    GENERATE;                                             /*@Z427VLS*/ 02132000
@RF00815 DS    0H                                                  0820 02133000
         CLOSE (SYSDCB)                                                 02134000
*    SYSOPN = NO;                                          /*@Z427VLS*/ 02135000
         NI    SYSOPN,B'11111011'                                  0821 02136000
*  END;                                                    /*@Z427VLS*/ 02137000
*ELSE                                                              0823 02138000
*  DO;                                                     /*@Z427VLS*/ 02139000
         B     @RC00813                                            0823 02140000
@RF00813 DS    0H                                                  0824 02141000
*    IF CLOSEIO ^= CLOSEALL THEN                                   0824 02142000
         L     @01,SAVER2                                          0824 02143000
         CLC   CLOSEIO(2,@01),@CB00262                             0824 02144000
         BE    @RF00824                                            0824 02145000
*      DO;                                                 /*@Z427VLS*/ 02146000
*        MSGNO = 34;                                       /*@Z427VLS*/ 02147000
         MVC   MSGNO(4),@CF01040                                   0826 02148000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02149000
         BAL   @14,ERRMSG                                          0827 02150000
*        BADNEWS = 12;                                     /*@Z427VLS*/ 02151000
         MVC   BADNEWS(4),@CF00068                                 0828 02152000
*      END;                                                /*@Z427VLS*/ 02153000
*   END;                                                   /*@Z427VLS*/ 02154000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02155000
*END; /*CLOSING END TO PROC CLOSSYS                          @Z427VLS*/ 02156000
@EL00017 DS    0H                                                  0832 02157000
@EF00017 DS    0H                                                  0832 02158000
@ER00017 LM    @14,@12,@SA00017                                    0832 02159000
         BR    @14                                                 0832 02160000
*REEDSYS: PROC OPTIONS(DONTSAVE(R7)); /*READ THE SYSIN CARDS @Z427VLS*/ 02161000
REEDSYS  STM   @14,@06,@SA00018                                    0833 02162000
         STM   @08,@12,@SA00018+36                                 0833 02163000
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/ 02164000
*IF SYSOPN = YES THEN                                              0835 02165000
         TM    SYSOPN,B'00000100'                                  0835 02166000
         BNO   @RF00835                                            0835 02167000
*  DO;                                                     /*@Z427VLS*/ 02168000
*    SYSRDCT = SYSRDCT + 1; /*NUMBER OF READS ATTEMPTED      @Z427VLS*/ 02169000
         LA    @06,1                                               0837 02170000
         AL    @06,SYSRDCT                                         0837 02171000
         ST    @06,SYSRDCT                                         0837 02172000
*    GENERATE;                                             /*@Z427VLS*/ 02173000
         LA    R7,CARDSPOT                                              02174000
         LA    R12,SYSDCB                                               02175000
         GET   (12),(7)                                                 02176000
*  END;                                                    /*@Z427VLS*/ 02177000
*ELSE                                                              0840 02178000
*  DO;                                                     /*@Z427VLS*/ 02179000
         B     @RC00835                                            0840 02180000
@RF00835 DS    0H                                                  0841 02181000
*    MSGNO = 35;                                           /*@Z427VLS*/ 02182000
         MVC   MSGNO(4),@CF01044                                   0841 02183000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02184000
         BAL   @14,ERRMSG                                          0842 02185000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02186000
         MVC   BADNEWS(4),@CF00068                                 0843 02187000
*  END;                                                    /*@Z427VLS*/ 02188000
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/ 02189000
*END; /*CLOSING END TO REEDSYS PROC                          @Z427VLS*/ 02190000
@EL00018 DS    0H                                                  0846 02191000
@EF00018 DS    0H                                                  0846 02192000
@ER00018 LM    @14,@06,@SA00018                                    0846 02193000
         LM    @08,@12,@SA00018+36                                 0846 02194000
         BR    @14                                                 0846 02195000
*SCRCHIT: PROC; /*WRITE TO DIRECTWK DATA SET SEQUENTIALLY    @Z427VLS*/ 02196000
SCRCHIT  STM   @14,@12,@SA00019                                    0847 02197000
*RESPECIFY (R7,R12,R1) RESTRICTED;                         /*@Z427VLS*/ 02198000
*IF INDIR = YES & /*IF DATA SET IS OPEN AND OPEN FOR SEQUENTIAL*/  0849 02199000
*   CLOSE2 = NO THEN /*WRITING THEN                          @Z427VLS*/ 02200000
         TM    INDIR,B'00100000'                                   0849 02201000
         BNO   @RF00849                                            0849 02202000
         TM    CLOSE2,B'00001000'                                  0849 02203000
         BNZ   @RF00849                                            0849 02204000
*  DO;                                                     /*@Z427VLS*/ 02205000
*    RITEWKCT = RITEWKCT + 1; /*NUMBER OF WRITE ATTEMPTS     @Z427VLS*/ 02206000
         LA    @06,1                                               0851 02207000
         AL    @06,RITEWKCT                                        0851 02208000
         ST    @06,RITEWKCT                                        0851 02209000
*GENERATE;                                                 /*@Z427VLS*/ 02210000
         LA    R7,BUF1     GET ADDRESS OF RECORD                        02211000
*        IF FLIPFLOP = OFF THEN /*MUST REARRANGE SERLOG PRE RECORD*/    02212000
         TM    FLIPFLOP,B'00100000'                                0853 02213000
         BNZ   @RF00853                                            0853 02214000
*          DO;                                             /*@Z427VLS*/ 02215000
*            BBRDW = SAVELENT; /*GET UNMODIFIED QSAM RECORD LENGTH*/    02216000
         LH    @06,SAVELENT                                        0855 02217000
         STH   @06,BBRDW                                           0855 02218000
*            BSIZE = '0000'X;                              /*@Z427VLS*/ 02219000
         MVC   BSIZE(2),@CB00209                                   0856 02220000
*            R7 = ADDR(BBRDW);                             /*@Z427VLS*/ 02221000
         LA    R7,BBRDW                                            0857 02222000
*          END;                                            /*@Z427VLS*/ 02223000
*         GENERATE;                                        /*@Z427VLS*/ 02224000
@RF00853 DS    0H                                                  0859 02225000
         LA    R12,WORKWDCB   GET DCB ADDRESS                           02226000
         WRITE WORKWDEC,SF,(12),(7)  ISSUE WRITE SVC                    02227000
         CHECK WORKWDEC     MAKE SURE WRITE COMPLETES BEFORE PROCEED    02228000
         NOTE  (12)     RETRIEVE RELATIVE RECORD LOCATION ON DIRECTWK   02229000
         ST    R1,TTRSAVE  SAVE TTR FOR SORTABLE                        02230000
         CLC   TTRSAVE(2),MAXTRK  ARE WE ON LAST TRACK OF DATA SET      02231000
         BNL   OVERFLOW    GO TELL OF OVERFLOW CONDITION                02232000
*RECCCHHR = TTRSAVE; /*PUT IN COMTABLE FOR USER ACCESS       @Z427VLS*/ 02233000
         L     @06,SAVER2                                          0860 02234000
         MVI   RECCCHHR+4(@06),C' '                                0860 02235000
         MVC   RECCCHHR(4,@06),TTRSAVE                             0860 02236000
*END;                                                      /*@Z427VLS*/ 02237000
*ELSE /*IF DATA SET IS NOT OPEN                              @Z427VLS*/ 02238000
*  DO;                                                     /*@Z427VLS*/ 02239000
         B     @RC00849                                            0862 02240000
@RF00849 DS    0H                                                  0863 02241000
*    MSGNO = 28;                                           /*@Z427VLS*/ 02242000
         MVC   MSGNO(4),@CF01048                                   0863 02243000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02244000
         BAL   @14,ERRMSG                                          0864 02245000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02246000
         MVC   BADNEWS(4),@CF00068                                 0865 02247000
*  END;                                                    /*@Z427VLS*/ 02248000
*RESPECIFY (R7,R12,R1) UNRESTRICTED;                       /*@Z427VLS*/ 02249000
*END; /*CLOSING END TO SCRSCHT PROC                          @Z427VLS*/ 02250000
@EL00019 DS    0H                                                  0868 02251000
@EF00019 DS    0H                                                  0868 02252000
@ER00019 LM    @14,@12,@SA00019                                    0868 02253000
         BR    @14                                                 0868 02254000
*DIRRDSCR: PROC OPTIONS(DONTSAVE(R7)); /*READ DIRECTWK SEQUENTIALLY*/   02255000
DIRRDSCR STM   @14,@06,@SA00020                                    0869 02256000
         STM   @08,@12,@SA00020+36                                 0869 02257000
*                                     /*USING POINT          @Z427VLS*/ 02258000
*RESPECIFY (R7,R6,R12) RESTRICTED;                         /*@Z427VLS*/ 02259000
*IF INDIR = YES &  /*IF DATA SET OPEN AND OPEN FOR SEQUENTIAL*/    0871 02260000
*   CLOSE2 = YES THEN /*POINT READING                        @Z427VLS*/ 02261000
         TM    INDIR,B'00101000'                                   0871 02262000
         BNO   @RF00871                                            0871 02263000
*  DO;                                                     /*@Z427VLS*/ 02264000
*    READWKCT = READWKCT + 1;                              /*@Z427VLS*/ 02265000
         LA    @15,1                                               0873 02266000
         AL    @15,READWKCT                                        0873 02267000
         ST    @15,READWKCT                                        0873 02268000
*    GENERATE;                                             /*@Z427VLS*/ 02269000
         LA    R7,BUF1                                                  02270000
         LA    R12,WORKRDCB                                             02271000
         LA    R6,RECCCHHR                                              02272000
         A     R6,SAVER2                                                02273000
         POINT (12),(6)                                                 02274000
         READ  WORKRDEC,SF,(12),(7)                                     02275000
         CHECK WORKRDEC                                                 02276000
*        R7 = R7 + 4; /*POINT PAST RDW FOR RETURN TO CALLER  @Z427VLS*/ 02277000
         LA    @15,4                                               0875 02278000
         ALR   R7,@15                                              0875 02279000
*        BUF1L = BUF1RDWL; /*MOVE RECORD LENGTH TO 2 BYTES BEFORE REC*/ 02280000
         LH    @14,BUF1RDWL                                        0876 02281000
         STH   @14,BUF1L                                           0876 02282000
*        BUF1L = BUF1L - 4; /*RECORD DATA LENGTH ONLY        @0001VLS*/ 02283000
         SLR   @14,@15                                             0877 02284000
         STH   @14,BUF1L                                           0877 02285000
*        SCRATCH = YES; /*JUST READ CURRENT RECORD OFF DIRECTWK*/  0878 02286000
         OI    SCRATCH,B'01000000'                                 0878 02287000
*        RECLNGTH = BUF1L;                                 /*@Z427VLS*/ 02288000
         L     @15,SAVER2                                          0879 02289000
         STH   @14,RECLNGTH(,@15)                                  0879 02290000
*  END;                                                    /*@Z427VLS*/ 02291000
*ELSE /*DATA SET NOT OPEN                                    @Z427VLS*/ 02292000
*  DO;                                                     /*@Z427VLS*/ 02293000
         B     @RC00871                                            0881 02294000
@RF00871 DS    0H                                                  0882 02295000
*    MSGNO = 46;                                           /*@Z427VLS*/ 02296000
         MVC   MSGNO(4),@CF01053                                   0882 02297000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02298000
         BAL   @14,ERRMSG                                          0883 02299000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02300000
         MVC   BADNEWS(4),@CF00068                                 0884 02301000
*  END;                                                    /*@Z427VLS*/ 02302000
*RESPECIFY (R7,R6,R12) UNRESTRICTED;                       /*@Z427VLS*/ 02303000
*END; /*CLOSING END TO PROC DIRRDSER                         @Z427VLS*/ 02304000
@EL00020 DS    0H                                                  0887 02305000
@EF00020 DS    0H                                                  0887 02306000
@ER00020 LM    @14,@06,@SA00020                                    0887 02307000
         LM    @08,@12,@SA00020+36                                 0887 02308000
         BR    @14                                                 0887 02309000
*DIRECTIT: PROC OPTIONS(DONTSAVE(R7)); /*CHOOSE DIRECT READ OF SERLOG*/ 02310000
DIRECTIT STM   @14,@06,@SA00021                                    0888 02311000
         STM   @08,@12,@SA00021+36                                 0888 02312000
*                                     /*OR DIRECTWK          @Z427VLS*/ 02313000
*RESPECIFY (R7) RESTRICTED;                                /*@Z427VLS*/ 02314000
*IF HISTYES = YES THEN /*IS DIRECTWK DATA SET                @Z427VLS*/ 02315000
         TM    HISTYES,B'00010000'                                 0890 02316000
         BNO   @RF00890                                            0890 02317000
*  CALL DIRRDSCR;                                          /*@Z427VLS*/ 02318000
         BAL   @14,DIRRDSCR                                        0891 02319000
*ELSE /*IS SERLOG BY DEFAULT                                 @Z427VLS*/ 02320000
*  CALL DIRRDSER;                                          /*@Z427VLS*/ 02321000
         B     @RC00890                                            0892 02322000
@RF00890 BAL   @14,DIRRDSER                                        0892 02323000
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/ 02324000
*END; /*CLOSING END TO DIRECTIT                              @Z427VLS*/ 02325000
@EL00021 DS    0H                                                  0894 02326000
@EF00021 DS    0H                                                  0894 02327000
@ER00021 LM    @14,@06,@SA00021                                    0894 02328000
         LM    @08,@12,@SA00021+36                                 0894 02329000
         BR    @14                                                 0894 02330000
*CLOSDIR: PROC; /*CLOSE DIRECTWK DATA SET                    @Z427VLS*/ 02331000
CLOSDIR  STM   @14,@12,@SA00022                                    0895 02332000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02333000
*IF INDIR = YES THEN /*IF DATA SET IS OPEN THEN              @Z427VLS*/ 02334000
         TM    INDIR,B'00100000'                                   0897 02335000
         BNO   @RF00897                                            0897 02336000
*  DO;                                                     /*@Z427VLS*/ 02337000
*    IF CLOSE2 = NO THEN /*IF CLOSING DIRECTWK FOR WRITING   @Z427VLS*/ 02338000
         TM    CLOSE2,B'00001000'                                  0899 02339000
         BNZ   @RF00899                                            0899 02340000
*      DO;                                                 /*@Z427VLS*/ 02341000
*        IF DEBUG15 = ON THEN                                      0901 02342000
         L     @01,SAVER2                                          0901 02343000
         TM    DEBUG15(@01),B'00000001'                            0901 02344000
         BNO   @RF00901                                            0901 02345000
*          DO;                                             /*@Z427VLS*/ 02346000
*            MSGNO = 61;                                   /*@Z427VLS*/ 02347000
         MVC   MSGNO(4),@CF01060                                   0903 02348000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 02349000
         BAL   @14,ERRMSG                                          0904 02350000
*          END;                                            /*@Z427VLS*/ 02351000
*        CLOSE2 = YES; /*INDICATE CLOSED FOR WRITING         @Z427VLS*/ 02352000
@RF00901 OI    CLOSE2,B'00001000'                                  0906 02353000
*        GENERATE;                                         /*@Z427VLS*/ 02354000
         CLOSE (WORKWDCB) CLOSE WRITE DCB                               02355000
         LA    R12,WORKRDCB  GET READING DCB                            02356000
         OPEN  ((R12),(INPUT))     OPEN FOR READING DIRECTWK            02357000
         TM    DCBOFLGS,OPENOK   IF OPEN SUCCESSFUL                     02358000
         BZ    BADBRSEQ     IF FAILS,GO PRINT MESSAGE;     /*@Z427VLS*/ 02359000
*    INDIR = YES; /*INDICATE OPEN SUCCESSFUL                 @Z427VLS*/ 02360000
         OI    INDIR,B'00100000'                                   0908 02361000
*   END;                                                   /*@Z427VLS*/ 02362000
*  ELSE /*CLOSE FOR SEQUENTIAL POINT READING                 @Z427VLS*/ 02363000
*    DO;                                                   /*@Z427VLS*/ 02364000
         B     @RC00899                                            0910 02365000
@RF00899 DS    0H                                                  0911 02366000
*      IF DEBUG15 = ON THEN                                        0911 02367000
         L     @01,SAVER2                                          0911 02368000
         TM    DEBUG15(@01),B'00000001'                            0911 02369000
         BNO   @RF00911                                            0911 02370000
*        DO;                                               /*@Z427VLS*/ 02371000
*          MSGNO = 62;                                     /*@Z427VLS*/ 02372000
         MVC   MSGNO(4),@CF01061                                   0913 02373000
*          CALL ERRMSG;                                    /*@Z427VLS*/ 02374000
         BAL   @14,ERRMSG                                          0914 02375000
*        END;                                              /*@Z427VLS*/ 02376000
*      GEN(CLOSE (WORKRDCB)); /*ISSUE CLOSE SVC              @Z427VLS*/ 02377000
@RF00911 DS    0H                                                  0916 02378000
         CLOSE (WORKRDCB)                                               02379000
*    END;                                                  /*@Z427VLS*/ 02380000
*   END;                                                   /*@Z427VLS*/ 02381000
* ELSE  /*CLOSE REQUESTED WHEN NOT OPEN                      @Z427VLS*/ 02382000
*   DO;                                                    /*@Z427VLS*/ 02383000
         B     @RC00897                                            0919 02384000
@RF00897 DS    0H                                                  0920 02385000
*     IF CLOSEIO ^= CLOSEALL THEN /*END OF JOB WRAPUP IS ALLOWED*/ 0920 02386000
         L     @01,SAVER2                                          0920 02387000
         CLC   CLOSEIO(2,@01),@CB00262                             0920 02388000
         BE    @RF00920                                            0920 02389000
*       DO;                                                /*@Z427VLS*/ 02390000
*         MSGNO = 29;                                      /*@Z427VLS*/ 02391000
         MVC   MSGNO(4),@CF00535                                   0922 02392000
*         CALL ERRMSG;                                     /*@Z427VLS*/ 02393000
         BAL   @14,ERRMSG                                          0923 02394000
*         BADNEWS = TWELVE;                                /*@Z427VLS*/ 02395000
         MVC   BADNEWS(4),@CF00068                                 0924 02396000
*       END;                                               /*@Z427VLS*/ 02397000
*   END;                                                   /*@Z427VLS*/ 02398000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02399000
*END; /*CLOSING END TO PROC CLOSDIR                          @Z427VLS*/ 02400000
@EL00022 DS    0H                                                  0928 02401000
@EF00022 DS    0H                                                  0928 02402000
@ER00022 LM    @14,@12,@SA00022                                    0928 02403000
         BR    @14                                                 0928 02404000
*READSIT: PROC OPTIONS(DONTSAVE(R7)); /*READ FROM SERLOG OR ACCIN*/     02405000
READSIT  STM   @14,@06,@SA00023                                    0929 02406000
         STM   @08,@12,@SA00023+36                                 0929 02407000
*RESPECIFY (R7) RESTRICTED;           /*SEQUENTIALLY         @Z427VLS*/ 02408000
*IF INHISO = YES THEN /*IF ACCIN IS OPEN, READ IT. IF BOTH SERLOG */    02409000
         TM    INHISO,B'00000001'                                  0931 02410000
         BNO   @RF00931                                            0931 02411000
*  CALL READHIST;     /*AND ACCIN ARE OPEN, READ ACCIN FIRST @Z427VLS*/ 02412000
         BAL   @14,READHIST                                        0932 02413000
*ELSE           /*IMPLIES HISTORY NOT OPEN                   @Z427VLS*/ 02414000
*  DO;                                                     /*@Z427VLS*/ 02415000
         B     @RC00931                                            0933 02416000
@RF00931 DS    0H                                                  0934 02417000
*    IF SERLO = YES THEN /*IF SERLOG IS OPEN THEN IMPLIES ACCIN*/  0934 02418000
         TM    SERLO,B'10000000'                                   0934 02419000
         BNO   @RF00934                                            0934 02420000
*      CALL READSER;    /*NEVER OPEN OR ACCIN HAS BEEN READ, CLOSED*/   02421000
         BAL   @14,READSER                                         0935 02422000
*    ELSE                /*NEITHER DATA SET OPEN IMPLIED     @Z427VLS*/ 02423000
*      DO;                                                 /*@Z427VLS*/ 02424000
         B     @RC00934                                            0936 02425000
@RF00934 DS    0H                                                  0937 02426000
*        BADNEWS = TWELVE; /*SET BAD RETURN CODE             @Z427VLS*/ 02427000
         MVC   BADNEWS(4),@CF00068                                 0937 02428000
*        MSGNO = 21;     /*INDICATE ERROR MESSAGE TEXT NUMBER*/    0938 02429000
         MVC   MSGNO(4),@CF01066                                   0938 02430000
*        CALL ERRMSG; /*PRINT THE ERROR TO TOURIST           @Z427VLS*/ 02431000
         BAL   @14,ERRMSG                                          0939 02432000
*      END;                                                /*@Z427VLS*/ 02433000
*   END;                                                   /*@Z427VLS*/ 02434000
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/ 02435000
* END; /*CLOSING END TO READSIT PROC                         @Z427VLS*/ 02436000
@EL00023 DS    0H                                                  0943 02437000
@EF00023 DS    0H                                                  0943 02438000
@ER00023 LM    @14,@06,@SA00023                                    0943 02439000
         LM    @08,@12,@SA00023+36                                 0943 02440000
         BR    @14                                                 0943 02441000
*READHIST: PROC OPTIONS(DONTSAVE(R7)); /*READ ACCIN SEQUENTIALLY*/ 0944 02442000
READHIST STM   @14,@06,@SA00024                                    0944 02443000
         STM   @08,@12,@SA00024+36                                 0944 02444000
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/ 02445000
*    ACIRDCT = ACIRDCT + 1; /*ACCIN READ ATTEMPTS            @Z427VLS*/ 02446000
         LA    @06,1                                               0946 02447000
         AL    @06,ACIRDCT                                         0946 02448000
         ST    @06,ACIRDCT                                         0946 02449000
*    R7 = ADDR(BUF1RDW); /*GET ADDRESS OF WORKAREA           @Z427VLS*/ 02450000
         LA    R7,BUF1RDW                                          0947 02451000
*    GEN(LA R12,INHIST); /*GET ADDRESS OF DCB                @Z427VLS*/ 02452000
         LA R12,INHIST                                                  02453000
*    GEN(GET (R12),(R7)); /*RETRIEVE A RECORD. NOTE THAT RECORD WILL*/  02454000
         GET (R12),(R7)                                                 02455000
*                       /*WILL BE HERE FOR RITE TO SCRATCH AND FOR*/    02456000
*                       /*WRITE TO ACCDEV                    @Z427VLS*/ 02457000
*    R7 = R7 + 4; /*POINT PAST RDW FOR RETURN TO CALLER      @Z427VLS*/ 02458000
         AL    R7,@CF00065                                         0950 02459000
*    FLIPFLOP = YES;  /*TELL READIRCT WHAT STORY IS          @Z427VLS*/ 02460000
         OI    FLIPFLOP,B'00100000'                                0951 02461000
*    RECCCHHR = (RECCCHHR && RECCCHHR); /*SET TO ACCIN INPUT IN PARM*/  02462000
         L     @06,SAVER2                                          0952 02463000
         XC    RECCCHHR(5,@06),RECCCHHR(@06)                       0952 02464000
*    RECLNGTH = BUF1RDWL; /*SET REC.LNTH FROM QSAM RDW IN PARM TABLE*/  02465000
         LH    @15,BUF1RDWL                                        0953 02466000
         STH   @15,RECLNGTH(,@06)                                  0953 02467000
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/ 02468000
*END; /*CLOSING END TO READHIST PROC                         @Z427VLS*/ 02469000
@EL00024 DS    0H                                                  0955 02470000
@EF00024 DS    0H                                                  0955 02471000
@ER00024 LM    @14,@06,@SA00024                                    0955 02472000
         LM    @08,@12,@SA00024+36                                 0955 02473000
         BR    @14                                                 0955 02474000
*OPENDIR : PROC; /*OPEN DIRECTWK DATA SET FOR SEQUENTIAL LOAD*/    0956 02475000
OPENDIR  STM   @14,@12,@SA00025                                    0956 02476000
*RESPECIFY (R1,R2,R12,R3) RESTRICTED;                      /*@Z427VLS*/ 02477000
*IF INDIR  = NO THEN /*IF IT HASNT BEEN OPENED BEFORE        @Z427VLS*/ 02478000
         TM    INDIR,B'00100000'                                   0958 02479000
         BNZ   @RF00958                                            0958 02480000
*  DO;                                                     /*@Z427VLS*/ 02481000
*    IF DEBUG15 = ON THEN                                          0960 02482000
         L     @15,SAVER2                                          0960 02483000
         TM    DEBUG15(@15),B'00000001'                            0960 02484000
         BNO   @RF00960                                            0960 02485000
*      DO;                                                 /*@Z427VLS*/ 02486000
*        MSGNO = 63;                                       /*@Z427VLS*/ 02487000
         MVC   MSGNO(4),@CF01073                                   0962 02488000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02489000
         BAL   @14,ERRMSG                                          0963 02490000
*      END;                                                /*@Z427VLS*/ 02491000
*    GEN(LA R12,WORKWDCB); /*GET ADDRESS OF DCB              @Z427VLS*/ 02492000
@RF00960 DS    0H                                                  0965 02493000
         LA R12,WORKWDCB                                                02494000
*    GEN(OPEN ((R12),(OUTPUT))); /*OPEN DIRECTWK TO LOAD SEQUENTIALLY*/ 02495000
         OPEN ((R12),(OUTPUT))                                          02496000
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFUL          @Z427VLS*/ 02497000
         TM DCBOFLGS,OPENOK                                             02498000
*    GEN(BZ BADBWSEQ);  /*SET BAD RETURN CODE AND PRINT ERRMSG*/   0968 02499000
         BZ BADBWSEQ                                                    02500000
*  GENERATE;                                               /*@Z427VLS*/ 02501000
         L     R1,DCBIFLGS  FLGS NOT SET, ACTUALLY LOAD DCBEBAD         02502000
         LH    R1,46(R1) LOAD NUMBER OF TRACKS IN THIS EXTENT           02503000
         BCTR  R1,R0        SUBTRACT ONE FOR RELATIVE TRACK NUMBER      02504000
         STH   R1,MAXTRK   SAVE NUMBER OF TRACKS OF OVERFLOW CHECK      02505000
*INDIR = YES; /*SET SUCCESSFUL OPEN OF DIRECTWK FLAG         @Z427VLS*/ 02506000
         OI    INDIR,B'00100000'                                   0970 02507000
*END;                                                      /*@Z427VLS*/ 02508000
*ELSE /*IF DATA SET IS ALREADY OPEN                          @Z427VLS*/ 02509000
*  DO;                                                     /*@Z427VLS*/ 02510000
         B     @RC00958                                            0972 02511000
@RF00958 DS    0H                                                  0973 02512000
*    BADNEWS = TWELVE; /*SET RETURN CODE TO ERROR            @Z427VLS*/ 02513000
         MVC   BADNEWS(4),@CF00068                                 0973 02514000
*    MSGNO = 31;                                           /*@Z427VLS*/ 02515000
         MVC   MSGNO(4),@CF00042                                   0974 02516000
*    CALL ERRMSG; /*WRITE MESSAGE TO TOURIST DATA SET        @Z427VLS*/ 02517000
         BAL   @14,ERRMSG                                          0975 02518000
*  END;                                                    /*@Z427VLS*/ 02519000
*RESPECIFY (R1,R12,R2,R3) UNRESTRICTED;                    /*@Z427VLS*/ 02520000
*END; /*CLOSING END TO OPENDIR PROC                          @Z427VLS*/ 02521000
@EL00025 DS    0H                                                  0978 02522000
@EF00025 DS    0H                                                  0978 02523000
@ER00025 LM    @14,@12,@SA00025                                    0978 02524000
         BR    @14                                                 0978 02525000
*OPENHIST: PROC; /*OPEN ACCIN DATA SET                       @Z427VLS*/ 02526000
OPENHIST STM   @14,@12,@SA00026                                    0979 02527000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02528000
*IF INHISO = NO THEN /*IF IT HASNT BEEN OPENED BEFORE        @Z427VLS*/ 02529000
         TM    INHISO,B'00000001'                                  0981 02530000
         BNZ   @RF00981                                            0981 02531000
*  DO;                                                     /*@Z427VLS*/ 02532000
*    IF DEBUG15 = ON THEN                                          0983 02533000
         L     @01,SAVER2                                          0983 02534000
         TM    DEBUG15(@01),B'00000001'                            0983 02535000
         BNO   @RF00983                                            0983 02536000
*      DO;                                                 /*@Z427VLS*/ 02537000
*        MSGNO = 64;                                       /*@Z427VLS*/ 02538000
         MVC   MSGNO(4),@CF00700                                   0985 02539000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02540000
         BAL   @14,ERRMSG                                          0986 02541000
*      END;                                                /*@Z427VLS*/ 02542000
*    GEN(LA R12,INHIST); /*GET ADDRESS OF DCB                @Z427VLS*/ 02543000
@RF00983 DS    0H                                                  0988 02544000
         LA R12,INHIST                                                  02545000
*    GEN(OPEN ((R12),(INPUT))); /*OPEN ACCIN                 @Z427VLS*/ 02546000
         OPEN ((R12),(INPUT))                                           02547000
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFUL          @Z427VLS*/ 02548000
         TM DCBOFLGS,OPENOK                                             02549000
*    GEN(BZ BDOIHST);  /*SET BAD RETURN CODE AND PRINT ERRMSG*/    0991 02550000
         BZ BDOIHST                                                     02551000
*    GEN(TM DCBRECFM,DCBRECV); /*IS CORRECT FORMAT           @Z427VLS*/ 02552000
         TM DCBRECFM,DCBRECV                                            02553000
*    GEN(BZ BDIST);    /*IF NOT, GO TELL WORLD, SET BAD R.C. @Z427VLS*/ 02554000
         BZ BDIST                                                       02555000
*    GEN(TM DCBRECFM,DCBRECU); /*IS RECFM U                  @Z427VLS*/ 02556000
         TM DCBRECFM,DCBRECU                                            02557000
*    GEN(BO BDIST);                                        /*@Z427VLS*/ 02558000
         BO BDIST                                                       02559000
*    INHISO = YES; /*TELL OF SUCCESSFUL OPEN OF ACCIN        @Z427VLS*/ 02560000
*    HISTYES = YES;                                        /*@Z427VLS*/ 02561000
         OI    INHISO,B'00010001'                                  0997 02562000
*  END;                                                    /*@Z427VLS*/ 02563000
*ELSE /*IF OPEN ASKED WHEN ALREADY OPEN                      @Z427VLS*/ 02564000
*  DO;                                                     /*@Z427VLS*/ 02565000
         B     @RC00981                                            0999 02566000
@RF00981 DS    0H                                                  1000 02567000
*    MSGNO = 11; /*TELL WHAT MESSAGE NUMBER TO PRINT         @Z427VLS*/ 02568000
         MVC   MSGNO(4),@CF00032                                   1000 02569000
*    CALL ERRMSG; /*GO SELECT MESSAGE AND PRINT TO TOURIST   @Z427VLS*/ 02570000
         BAL   @14,ERRMSG                                          1001 02571000
*    BADNEWS = TWELVE; /*TELL USER BAD NEWS                  @Z427VLS*/ 02572000
         MVC   BADNEWS(4),@CF00068                                 1002 02573000
*  END;                                                    /*@Z427VLS*/ 02574000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02575000
*END; /*CLOSING END TO OPEN HISTORY INPUT DATA SET PROC      @Z427VLS*/ 02576000
@EL00026 DS    0H                                                  1005 02577000
@EF00026 DS    0H                                                  1005 02578000
@ER00026 LM    @14,@12,@SA00026                                    1005 02579000
         BR    @14                                                 1005 02580000
*CLOSHIST: PROC; /*CLOSE ACCIN DATA SET                      @Z427VLS*/ 02581000
CLOSHIST STM   @14,@12,@SA00027                                    1006 02582000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02583000
*IF INHISO = YES THEN /*IF DATA SET IS OPEN THEN             @Z427VLS*/ 02584000
         TM    INHISO,B'00000001'                                  1008 02585000
         BNO   @RF01008                                            1008 02586000
*  DO;                                                     /*@Z427VLS*/ 02587000
*    IF DEBUG15 = ON THEN                                          1010 02588000
         L     @01,SAVER2                                          1010 02589000
         TM    DEBUG15(@01),B'00000001'                            1010 02590000
         BNO   @RF01010                                            1010 02591000
*      DO;                                                 /*@Z427VLS*/ 02592000
*        MSGNO = 65;                                       /*@Z427VLS*/ 02593000
         MVC   MSGNO(4),@CF01080                                   1012 02594000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02595000
         BAL   @14,ERRMSG                                          1013 02596000
*      END;                                                /*@Z427VLS*/ 02597000
*    GEN(LA  R12,INHIST); /*GET ACCIN DCB ADDRESS            @Z427VLS*/ 02598000
@RF01010 DS    0H                                                  1015 02599000
         LA  R12,INHIST                                                 02600000
*    GEN(CLOSE  (INHIST));         /*ISSUE CLOSE SVC         @Z427VLS*/ 02601000
         CLOSE  (INHIST)                                                02602000
*    GEN(FREEPOOL  (R12)); /*GET RID OF ACCIN BUFFERS        @Z427VLS*/ 02603000
         FREEPOOL  (R12)                                                02604000
*    INHISO = NO; /*SAY THAT ACCIN IS CLOSED                 @Z427VLS*/ 02605000
         NI    INHISO,B'11111110'                                  1018 02606000
*  END;                                                    /*@Z427VLS*/ 02607000
*ELSE  /*IF DATA SET IS ALREADY CLOSED                       @Z427VLS*/ 02608000
*  DO;                                                     /*@Z427VLS*/ 02609000
         B     @RC01008                                            1020 02610000
@RF01008 DS    0H                                                  1021 02611000
*    IF CLOSEIO ^= CLOSEALL THEN                                   1021 02612000
         L     @01,SAVER2                                          1021 02613000
         CLC   CLOSEIO(2,@01),@CB00262                             1021 02614000
         BE    @RF01021                                            1021 02615000
*    DO;                                                   /*@Z427VLS*/ 02616000
*    MSGNO = 12;                                           /*@Z427VLS*/ 02617000
         LA    @15,12                                              1023 02618000
         ST    @15,MSGNO                                           1023 02619000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02620000
         ST    @15,BADNEWS                                         1024 02621000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02622000
         BAL   @14,ERRMSG                                          1025 02623000
*    END;                                                  /*@Z427VLS*/ 02624000
*  END;                                                    /*@Z427VLS*/ 02625000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02626000
*END; /*CLOSING END TO CLOSE ACCIN DATA SET PROC             @Z427VLS*/ 02627000
@EL00027 DS    0H                                                  1029 02628000
@EF00027 DS    0H                                                  1029 02629000
@ER00027 LM    @14,@12,@SA00027                                    1029 02630000
         BR    @14                                                 1029 02631000
*CLOSEDEV: PROC; /*PROC TO CLOSE ACCDEV DATA SET             @Z427VLS*/ 02632000
CLOSEDEV STM   @14,@12,@SA00028                                    1030 02633000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02634000
*IF HISTOPN = YES THEN                                             1032 02635000
         TM    HISTOPN,B'10000000'                                 1032 02636000
         BNO   @RF01032                                            1032 02637000
*  DO;                                                     /*@Z427VLS*/ 02638000
*    IF DEBUG15 = ON THEN                                          1034 02639000
         L     @01,SAVER2                                          1034 02640000
         TM    DEBUG15(@01),B'00000001'                            1034 02641000
         BNO   @RF01034                                            1034 02642000
*      DO;                                                 /*@Z427VLS*/ 02643000
*        MSGNO = 66;                                       /*@Z427VLS*/ 02644000
         MVC   MSGNO(4),@CF01084                                   1036 02645000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02646000
         BAL   @14,ERRMSG                                          1037 02647000
*      END;                                                /*@Z427VLS*/ 02648000
*    GEN(LA R12,OUTHIST); /*FIND ADDRESS OF DCB              @Z427VLS*/ 02649000
@RF01034 DS    0H                                                  1039 02650000
         LA R12,OUTHIST                                                 02651000
*    GEN(CLOSE (OUTHIST));       /*ISSUE CLOSE SVC           @Z427VLS*/ 02652000
         CLOSE (OUTHIST)                                                02653000
*    GEN(FREEPOOL  (R12)); /*GET RID OF ACCDEV BUFFERS       @Z427VLS*/ 02654000
         FREEPOOL  (R12)                                                02655000
*    HISTOPN = NO; /*SAY THAT DATA SET IS CLOSED             @Z427VLS*/ 02656000
         NI    HISTOPN,B'01111111'                                 1042 02657000
*  END;                                                    /*@Z427VLS*/ 02658000
*ELSE /*IF ACCDEV IS ALREADY CLOSED                          @Z427VLS*/ 02659000
* DO;                                                      /*@Z427VLS*/ 02660000
         B     @RC01032                                            1044 02661000
@RF01032 DS    0H                                                  1045 02662000
*   IF CLOSEIO ^= CLOSEALL /*END OF JOB STEP VALID REQUEST   @Z427VLS*/ 02663000
*     THEN DO;                                             /*@Z427VLS*/ 02664000
         L     @01,SAVER2                                          1045 02665000
         CLC   CLOSEIO(2,@01),@CB00262                             1045 02666000
         BE    @RF01045                                            1045 02667000
*       MSGNO = 8;                                         /*@Z427VLS*/ 02668000
         MVC   MSGNO(4),@CF00035                                   1047 02669000
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/ 02670000
         MVC   BADNEWS(4),@CF00068                                 1048 02671000
*       CALL ERRMSG;                                       /*@Z427VLS*/ 02672000
         BAL   @14,ERRMSG                                          1049 02673000
*     END;                                                 /*@Z427VLS*/ 02674000
* END;                                                     /*@Z427VLS*/ 02675000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02676000
*END; /*CLOSING END TO PROC CLOSEDEV                         @Z427VLS*/ 02677000
@EL00028 DS    0H                                                  1053 02678000
@EF00028 DS    0H                                                  1053 02679000
@ER00028 LM    @14,@12,@SA00028                                    1053 02680000
         BR    @14                                                 1053 02681000
*OPENTOUR : PROC; /*OPEN THE TOURIST DATA SET                @Z427VLS*/ 02682000
OPENTOUR STM   @14,@12,@SA00029                                    1054 02683000
*RESPECIFY (R12,R7) RESTRICTED;                            /*@Z427VLS*/ 02684000
*  IF TOUROPN = NO THEN /*ILLEGAL TO OPEN AN OPEN DATA SET   @Z427VLS*/ 02685000
         TM    TOUROPN,B'00000010'                                 1056 02686000
         BNZ   @RF01056                                            1056 02687000
*    DO;                                                   /*@Z427VLS*/ 02688000
*      GENERATE;                                           /*@Z427VLS*/ 02689000
         LA    R12,TOURDCB                                              02690000
         OPEN  ((R12),(OUTPUT))                                         02691000
         TM    DCBOFLGS,OPENOK    CHECK FOR SUCCESS                     02692000
         BZ    BADOTOUR                                                 02693000
*      TOUROPN = YES; /*HURRAY FOR SUCCESSFUL OPEN           @Z427VLS*/ 02694000
         OI    TOUROPN,B'00000010'                                 1059 02695000
*      PRINTADR = ADDR(PRNTBF);                            /*@Z427VLS*/ 02696000
         LA    @06,PRNTBF                                          1060 02697000
         L     @01,SAVER2                                          1060 02698000
         ST    @06,PRINTADR(,@01)                                  1060 02699000
*      R7 = PRINTADR + 1;                                  /*@Z427VLS*/ 02700000
         LA    R7,1                                                1061 02701000
         ALR   R7,@06                                              1061 02702000
*      PRINTCC = SKIPNEW;                                  /*@Z427VLS*/ 02703000
         MVI   PRINTCC(@06),X'8B'                                  1062 02704000
*      GEN(PUT  (R12),(R7)); /*INITIAL SKIP TO NEW PAGE      @Z427VLS*/ 02705000
         PUT  (R12),(R7)                                                02706000
*    END;                                                  /*@Z427VLS*/ 02707000
* ELSE  /*IF TOURIST ALREADY OPEN THEN                       @Z427VLS*/ 02708000
*   DO;                                                    /*@Z427VLS*/ 02709000
         B     @RC01056                                            1065 02710000
@RF01056 DS    0H                                                  1066 02711000
*     MSGNO = 23;                                          /*@Z427VLS*/ 02712000
         MVC   MSGNO(4),@CF01088                                   1066 02713000
*     CALL ERRMSG;                                         /*@Z427VLS*/ 02714000
         BAL   @14,ERRMSG                                          1067 02715000
*     BADNEWS = TWELVE;                                    /*@Z427VLS*/ 02716000
         MVC   BADNEWS(4),@CF00068                                 1068 02717000
*   END;                                                   /*@Z427VLS*/ 02718000
*RESPECIFY (R12,R7) UNRESTRICTED;                          /*@Z427VLS*/ 02719000
*END; /*CLOSING END TO PROC OPENTOUR                         @Z427VLS*/ 02720000
@EL00029 DS    0H                                                  1071 02721000
@EF00029 DS    0H                                                  1071 02722000
@ER00029 LM    @14,@12,@SA00029                                    1071 02723000
         BR    @14                                                 1071 02724000
*CLOSTOUR: PROC; /*CLOSE THE TOURIST DATA SET                @Z427VLS*/ 02725000
CLOSTOUR STM   @14,@12,@SA00030                                    1072 02726000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02727000
*IF TOUROPN = YES THEN /*IF REALLY NEEDS CLOSING             @Z427VLS*/ 02728000
         TM    TOUROPN,B'00000010'                                 1074 02729000
         BNO   @RF01074                                            1074 02730000
*  DO;                                                     /*@Z427VLS*/ 02731000
*    IF DEBUG15 = ON THEN /*PRINT SUMMARY OF IO OPERATIONS DURING RUN*/ 02732000
         L     @01,SAVER2                                          1076 02733000
         TM    DEBUG15(@01),B'00000001'                            1076 02734000
         BNO   @RF01076                                            1076 02735000
*             DO J = 1 TO 11; /*PRINT ALL DEBUG15 TOTALS     @G51DGBB*/ 02736000
         LA    @15,1                                               1077 02737000
         ST    @15,J                                               1077 02738000
@DL01077 DS    0H                                                  1078 02739000
*           MSGNO = J + 70; /*INCREMENT PAST SYSTEM MESSAGES @G51DGBB*/ 02740000
         AL    @15,@CF00924                                        1078 02741000
         ST    @15,MSGNO                                           1078 02742000
*          CALL ERRMSG; /*PRINT OUT SUMMARY MESSAGE TEXT     @Z427VLS*/ 02743000
         BAL   @14,ERRMSG                                          1079 02744000
*          PASSNUM = CTPTR(J); /*ACCESS PARTICULAR COUNT     @Z427VLS*/ 02745000
         L     @15,J                                               1080 02746000
         SLA   @15,2                                               1080 02747000
         L     @15,CTPTR-4(@15)                                    1080 02748000
         ST    @15,PASSNUM                                         1080 02749000
*          CVD(PASSNUM,PACKPAS); /*CONVERT BINARY TO PACKED  @Z427VLS*/ 02750000
         CVD   @15,@TS00001                                        1081 02751000
         MVC   PACKPAS(4),@TS00001+4                               1081 02752000
*          PACKPAS = (PACKPAS | '0000000F'X); /*TURN C TO F  @Z427VLS*/ 02753000
         OC    PACKPAS(4),@CB01093                                 1082 02754000
*          UNPK(EDFLD,PACKPAS); /*CHANGE PACKED TO PRINTABLE @Z427VLS*/ 02755000
         UNPK  EDFLD(9),PACKPAS(4)                                 1083 02756000
*          NONBLANK = OFF;                                 /*@Z427VLS*/ 02757000
         NI    NONBLANK,B'11101111'                                1084 02758000
*          DO K = 1 BY 1 TO 8 WHILE NONBLANK = OFF;        /*@Z427VLS*/ 02759000
         LA    @15,1                                               1085 02760000
         ST    @15,K                                               1085 02761000
@DL01085 TM    NONBLANK,B'00010000'                                1085 02762000
         BNZ   @DC01085                                            1085 02763000
*            IF EDIFILD(K) = CHARZERO THEN                         1086 02764000
         LA    @14,EDIFILD-1(@15)                                  1086 02765000
         CLI   0(@14),X'F0'                                        1086 02766000
         BNE   @RF01086                                            1086 02767000
*              EDIFILD(K) = BLANK;                         /*@Z427VLS*/ 02768000
         LA    @14,EDIFILD-1(@15)                                  1087 02769000
         MVI   0(@14),X'40'                                        1087 02770000
*            ELSE                                                  1088 02771000
*              NONBLANK = ON;                              /*@Z427VLS*/ 02772000
         B     @RC01086                                            1088 02773000
@RF01086 OI    NONBLANK,B'00010000'                                1088 02774000
*          END;                                            /*@Z427VLS*/ 02775000
@RC01086 LA    @15,1                                               1089 02776000
         AL    @15,K                                               1089 02777000
         ST    @15,K                                               1089 02778000
         C     @15,@CF00035                                        1089 02779000
         BNH   @DL01085                                            1089 02780000
@DC01085 DS    0H                                                  1090 02781000
*          PRINTADR = ADDR(PRNTBF);                        /*@Z427VLS*/ 02782000
         LA    @15,PRNTBF                                          1090 02783000
         L     @14,SAVER2                                          1090 02784000
         ST    @15,PRINTADR(,@14)                                  1090 02785000
*          PRINTDS = '1'; /*INDICATE PRINT TO TOURIST        @Z427VLS*/ 02786000
         MVI   PRINTDS(@15),C'1'                                   1091 02787000
*          PRINTBDY = (PRINTBDY && PRINTBDY);              /*@Z427VLS*/ 02788000
         XC    PRINTBDY(132,@15),PRINTBDY(@15)                     1092 02789000
*          GEN(MVC PRNTBF+10(9),EDFLD);                    /*@Z427VLS*/ 02790000
         MVC PRNTBF+10(9),EDFLD                                         02791000
*          CALL PRINTIT;                                   /*@Z427VLS*/ 02792000
         BAL   @14,PRINTIT                                         1094 02793000
*        END;                                              /*@Z427VLS*/ 02794000
         LA    @15,1                                               1095 02795000
         AL    @15,J                                               1095 02796000
         ST    @15,J                                               1095 02797000
         C     @15,@CF00032                                        1095 02798000
         BNH   @DL01077                                            1095 02799000
*    GENERATE;                                             /*@Z427VLS*/ 02800000
@RF01076 DS    0H                                                  1096 02801000
         LA    R12,TOURDCB                                              02802000
         CLOSE (TOURDCB)                                                02803000
         FREEPOOL (12)                                                  02804000
*    TOUROPN = NO; /*INDICATE CLOSE                          @Z427VLS*/ 02805000
         NI    TOUROPN,B'11111101'                                 1097 02806000
* END;                                                     /*@Z427VLS*/ 02807000
*ELSE /*IF ALREADY CLOSED THEN                               @Z427VLS*/ 02808000
* DO;                                                      /*@Z427VLS*/ 02809000
         B     @RC01074                                            1099 02810000
@RF01074 DS    0H                                                  1100 02811000
*   IF CLOSEIO ^= CLOSEALL THEN /*LEGAL TO DO END OF JOB WRAPUP*/  1100 02812000
         L     @15,SAVER2                                          1100 02813000
         CLC   CLOSEIO(2,@15),@CB00262                             1100 02814000
         BE    @RF01100                                            1100 02815000
*     DO;                                                  /*@Z427VLS*/ 02816000
*       CALL IFCMSG(204,ADDR(PRNTBF));                     /*@Z427VLS*/ 02817000
         LA    @14,PRNTBF                                          1102 02818000
         ST    @14,@AFTEMPS+12                                     1102 02819000
         L     @15,ADIFCMSG(,@15)                                  1102 02820000
         LA    @01,@AL01102                                        1102 02821000
         BALR  @14,@15                                             1102 02822000
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/ 02823000
         MVC   BADNEWS(4),@CF00068                                 1103 02824000
*     END;                                                 /*@Z427VLS*/ 02825000
* END;                                                     /*@Z427VLS*/ 02826000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02827000
*END; /*CLOSING END TO CLOSTOUR PROCEDURE                    @Z427VLS*/ 02828000
@EL00030 DS    0H                                                  1107 02829000
@EF00030 DS    0H                                                  1107 02830000
@ER00030 LM    @14,@12,@SA00030                                    1107 02831000
         BR    @14                                                 1107 02832000
*OPENERPT: PROC; /*OPEN THE ERREPT D.S. FOR PRINTING         @Z427VLS*/ 02833000
OPENERPT STM   @14,@12,@SA00031                                    1108 02834000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02835000
*IF ERPTOPN = NO THEN                                              1110 02836000
         TM    ERPTOPN,B'00000001'                                 1110 02837000
         BNZ   @RF01110                                            1110 02838000
*  DO;                                                     /*@Z427VLS*/ 02839000
*    IF DEBUG15 = ON THEN                                          1112 02840000
         L     @01,SAVER2                                          1112 02841000
         TM    DEBUG15(@01),B'00000001'                            1112 02842000
         BNO   @RF01112                                            1112 02843000
*      DO;                                                 /*@Z427VLS*/ 02844000
*        MSGNO = 67;                                       /*@Z427VLS*/ 02845000
         MVC   MSGNO(4),@CF01099                                   1114 02846000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02847000
         BAL   @14,ERRMSG                                          1115 02848000
*      END;                                                /*@Z427VLS*/ 02849000
*    GENERATE;                                             /*@Z427VLS*/ 02850000
@RF01112 DS    0H                                                  1117 02851000
         LA    R12,EREPTDCB                                             02852000
         OPEN  ((R12),(OUTPUT))                                         02853000
         TM    DCBOFLGS,OPENOK                                          02854000
         BZ    BADORPT                                                  02855000
*    ERPTOPN = YES; /*INDICATE SUCCESSFUL OPEN               @Z427VLS*/ 02856000
         OI    ERPTOPN,B'00000001'                                 1118 02857000
*  END;                                                    /*@Z427VLS*/ 02858000
*ELSE /*IF OPEN REQUESTED WHEN DATA SET ALREADY OPEN         @Z427VLS*/ 02859000
*  DO;                                                     /*@Z427VLS*/ 02860000
         B     @RC01110                                            1120 02861000
@RF01110 DS    0H                                                  1121 02862000
*    MSGNO = 45;                                           /*@Z427VLS*/ 02863000
         MVC   MSGNO(4),@CF01100                                   1121 02864000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02865000
         BAL   @14,ERRMSG                                          1122 02866000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02867000
         MVC   BADNEWS(4),@CF00068                                 1123 02868000
*  END;                                                    /*@Z427VLS*/ 02869000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02870000
*END; /*CLOSING END TO PROC OPENERPT                         @Z427VLS*/ 02871000
@EL00031 DS    0H                                                  1126 02872000
@EF00031 DS    0H                                                  1126 02873000
@ER00031 LM    @14,@12,@SA00031                                    1126 02874000
         BR    @14                                                 1126 02875000
*CLOSERPT : PROC; /*OPEN ERREPT DATA SET                     @Z427VLS*/ 02876000
CLOSERPT STM   @14,@12,@SA00032                                    1127 02877000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02878000
*IF ERPTOPN = YES THEN /*MUST BE OPEN IN ORDER TO CLOSE      @Z427VLS*/ 02879000
         TM    ERPTOPN,B'00000001'                                 1129 02880000
         BNO   @RF01129                                            1129 02881000
*  DO;                                                     /*@Z427VLS*/ 02882000
*    IF DEBUG15 = ON THEN                                          1131 02883000
         L     @01,SAVER2                                          1131 02884000
         TM    DEBUG15(@01),B'00000001'                            1131 02885000
         BNO   @RF01131                                            1131 02886000
*      DO;                                                 /*@Z427VLS*/ 02887000
*        MSGNO = 68;                                       /*@Z427VLS*/ 02888000
         MVC   MSGNO(4),@CF01104                                   1133 02889000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02890000
         BAL   @14,ERRMSG                                          1134 02891000
*      END;                                                /*@Z427VLS*/ 02892000
*    GENERATE;                                             /*@Z427VLS*/ 02893000
@RF01131 DS    0H                                                  1136 02894000
         LA    R12,EREPTDCB                                             02895000
         CLOSE (EREPTDCB)                                               02896000
         FREEPOOL (R12)                                                 02897000
*    ERPTOPN = NO; /*INDICATE ERREPT IS CLOSED               @Z427VLS*/ 02898000
         NI    ERPTOPN,B'11111110'                                 1137 02899000
*  END;                                                    /*@Z427VLS*/ 02900000
*ELSE /*IF CLOSE REQUESTED WHEN NOT OPEN THEN                @Z427VLS*/ 02901000
* DO;                                                      /*@Z427VLS*/ 02902000
         B     @RC01129                                            1139 02903000
@RF01129 DS    0H                                                  1140 02904000
*   IF CLOSEIO ^= CLOSEALL THEN  /*VALID POTPOURI OF CLOSES  @Z427VLS*/ 02905000
         L     @01,SAVER2                                          1140 02906000
         CLC   CLOSEIO(2,@01),@CB00262                             1140 02907000
         BE    @RF01140                                            1140 02908000
*     DO;                                                  /*@Z427VLS*/ 02909000
*       MSGNO = 22;                                        /*@Z427VLS*/ 02910000
         MVC   MSGNO(4),@CF01105                                   1142 02911000
*       CALL ERRMSG;                                       /*@Z427VLS*/ 02912000
         BAL   @14,ERRMSG                                          1143 02913000
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/ 02914000
         MVC   BADNEWS(4),@CF00068                                 1144 02915000
*     END;                                                 /*@Z427VLS*/ 02916000
*   END;                                                   /*@Z427VLS*/ 02917000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02918000
*END; /*CLOSING END TO CLOSERPT PROC                         @Z427VLS*/ 02919000
@EL00032 DS    0H                                                  1148 02920000
@EF00032 DS    0H                                                  1148 02921000
@ER00032 LM    @14,@12,@SA00032                                    1148 02922000
         BR    @14                                                 1148 02923000
*OPENDEV: PROC; /*OPEN ACCDEV DATA SET                       @Z427VLS*/ 02924000
OPENDEV  STM   @14,@12,@SA00033                                    1149 02925000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02926000
*IF HISTOPN = NO THEN /*IF DATA SET HAS NOT ALREADY BEEN OPENED*/  1151 02927000
         TM    HISTOPN,B'10000000'                                 1151 02928000
         BNZ   @RF01151                                            1151 02929000
*  DO;                                                     /*@Z427VLS*/ 02930000
*    IF DEBUG15 = ON THEN                                          1153 02931000
         L     @01,SAVER2                                          1153 02932000
         TM    DEBUG15(@01),B'00000001'                            1153 02933000
         BNO   @RF01153                                            1153 02934000
*      DO;                                                 /*@Z427VLS*/ 02935000
*        MSGNO = 69;                                       /*@Z427VLS*/ 02936000
         MVC   MSGNO(4),@CF01109                                   1155 02937000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02938000
         BAL   @14,ERRMSG                                          1156 02939000
*      END;                                                /*@Z427VLS*/ 02940000
*    GEN(LA (R12),OUTHIST); /*FIND ADDRESS OF DCB            @Z427VLS*/ 02941000
@RF01153 DS    0H                                                  1158 02942000
         LA (R12),OUTHIST                                               02943000
*    GEN(OPEN ((R12),(OUTPUT,DISP))); /*ISSUE OPEN SVC       @Z427VLS*/ 02944000
         OPEN ((R12),(OUTPUT,DISP))                                     02945000
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFULL         @Z427VLS*/ 02946000
         TM DCBOFLGS,OPENOK                                             02947000
*    GEN(BZ BADOOHST); /*GO TO ERROR ROUTINE                 @Z427VLS*/ 02948000
         BZ BADOOHST                                                    02949000
*    HISTOPN = YES;                                        /*@Z427VLS*/ 02950000
         OI    HISTOPN,B'10000000'                                 1162 02951000
*  END;                                                    /*@Z427VLS*/ 02952000
*ELSE                                                              1164 02953000
*  DO;                                                     /*@Z427VLS*/ 02954000
         B     @RC01151                                            1164 02955000
@RF01151 DS    0H                                                  1165 02956000
*    MSGNO = 2;                                            /*@Z427VLS*/ 02957000
         MVC   MSGNO(4),@CF00075                                   1165 02958000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02959000
         BAL   @14,ERRMSG                                          1166 02960000
*    BADNEWS = TWELVE; /*ABORT RETURN CODE                   @Z427VLS*/ 02961000
         MVC   BADNEWS(4),@CF00068                                 1167 02962000
*  END;                                                    /*@Z427VLS*/ 02963000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02964000
*END; /*CLOSING END TO PROC OPENDEV                          @Z427VLS*/ 02965000
@EL00033 DS    0H                                                  1170 02966000
@EF00033 DS    0H                                                  1170 02967000
@ER00033 LM    @14,@12,@SA00033                                    1170 02968000
         BR    @14                                                 1170 02969000
*HISTIT: PROC; /*WRITE TO ACCDEV USING QSAM                  @Z427VLS*/ 02970000
HISTIT   STM   @14,@12,@SA00034                                    1171 02971000
*RESPECIFY (R12,R7) RESTRICTED;                            /*@Z427VLS*/ 02972000
*IF HISTOPN = YES THEN                                             1173 02973000
         TM    HISTOPN,B'10000000'                                 1173 02974000
         BNO   @RF01173                                            1173 02975000
*  DO;                                                     /*@Z427VLS*/ 02976000
*    DEVCT = DEVCT + 1;                                    /*@Z427VLS*/ 02977000
         LA    @06,1                                               1175 02978000
         AL    @06,DEVCT                                           1175 02979000
         ST    @06,DEVCT                                           1175 02980000
*    GEN(LA (R12),OUTHIST); /*GET DCB ADDRESS                @Z427VLS*/ 02981000
         LA (R12),OUTHIST                                               02982000
*    R7 = ADDR(BUF1RDW); /*ADDRESS THE RECORD DESCRIPTOR WORD*/    1177 02983000
         LA    R7,BUF1RDW                                          1177 02984000
*    IF SCRATCH = YES THEN /*IF FRAMES FROM DIRECTWK, MUST FIX REC*/    02985000
         TM    SCRATCH,B'01000000'                                 1178 02986000
         BNO   @RF01178                                            1178 02987000
*      DO;                 /*ORD DESCRIPTOR WORD BECAUSE IT WAS   */    02988000
*                          /*MANGLED FOR EDSUM MODULES       @G51DGBB*/ 02989000
*        BUF1RDWL = BUF1L + 4; /*RE-ADD RDW LENGTH, MOVE TO RDW   */    02990000
         LH    @06,BUF1L                                           1180 02991000
         LA    @06,4(,@06)                                         1180 02992000
         STH   @06,BUF1RDWL                                        1180 02993000
*        BUF1L = '0000'X;      /*FINISH RDW RIGHTMOST TWO BYTES   */    02994000
         SLR   @06,@06                                             1181 02995000
         STH   @06,BUF1L                                           1181 02996000
*        R7 = ADDR(BUF1);      /*POINT TO RECORD FOR QSAM PUT     */    02997000
         LA    R7,BUF1                                             1182 02998000
*      END;                                                /*@G51DGBB*/ 02999000
*    ELSE   /*RECORD NOT RETRIEVED FROM DIRECTWK             @G51DGBB*/ 03000000
*      IF FLIPFLOP = OFF THEN /*IF RECORD FROM READSEQ OF LOGREC*/ 1184 03001000
         B     @RC01178                                            1184 03002000
@RF01178 TM    FLIPFLOP,B'00100000'                                1184 03003000
         BNZ   @RF01184                                            1184 03004000
*        DO;                                               /*@G51DGBB*/ 03005000
*          BBRDW = SAVELENT; /*GET UNMODIFIED QSAM LENGTH    @G51DGBB*/ 03006000
         LH    @06,SAVELENT                                        1186 03007000
         STH   @06,BBRDW                                           1186 03008000
*          BSIZE = '0000'X; /*COMPLETE RDW                   @G51DGBB*/ 03009000
         MVC   BSIZE(2),@CB00209                                   1187 03010000
*          R7 = ADDR(BBRDW);                               /*@G51DGBB*/ 03011000
         LA    R7,BBRDW                                            1188 03012000
*        END;                                              /*@G51DGBB*/ 03013000
*    GEN(PUT  (R12),(R7)); /*ISSUE WRITE SVC USING QSAM      @Z427VLS*/ 03014000
@RF01184 DS    0H                                                  1190 03015000
@RC01178 DS    0H                                                  1190 03016000
         PUT  (R12),(R7)                                                03017000
*  END;                                                    /*@Z427VLS*/ 03018000
*ELSE                                                              1192 03019000
*  DO;                                                     /*@Z427VLS*/ 03020000
         B     @RC01173                                            1192 03021000
@RF01173 DS    0H                                                  1193 03022000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 03023000
         MVC   BADNEWS(4),@CF00068                                 1193 03024000
*    MSGNO = 4;                                            /*@Z427VLS*/ 03025000
         MVC   MSGNO(4),@CF00065                                   1194 03026000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 03027000
         BAL   @14,ERRMSG                                          1195 03028000
*  END;                                                    /*@Z427VLS*/ 03029000
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/ 03030000
*END; /*CLOSING END TO PROC HISTIT                           @Z427VLS*/ 03031000
@EL00034 DS    0H                                                  1198 03032000
@EF00034 DS    0H                                                  1198 03033000
@ER00034 LM    @14,@12,@SA00034                                    1198 03034000
         BR    @14                                                 1198 03035000
*/*PROC TO CONVERT HEX DAT INTO PRINTABLE FORMAT             @Z427VLS*/ 03036000
*/* ITEM NUMBER IS NUMBER OF BYTES TO BE CONVERTED           @Z427VLS*/ 03037000
*/* ITEM NEXTBY IS THE ADDRESS OF THE DATA TO BE CONVERTED   @Z427VLS*/ 03038000
*/* ITEM ADDNXT IS THE LOCATION WHERE THE CONVERTED DATA IS TO BE PUT*/ 03039000
*CONVERT: PROC;                                            /*@Z427VLS*/ 03040000
CONVERT  STM   @14,@12,12(@13)                                     1199 03041000
*RESPECIFY (R2,R3) RESTRICTED;                             /*@Z427VLS*/ 03042000
*DO J = NUMBER BY -1 TO 1;                                 /*@Z427VLS*/ 03043000
         L     @12,NUMBER                                          1201 03044000
         ST    @12,J                                               1201 03045000
         B     @DE01201                                            1201 03046000
@DL01201 DS    0H                                                  1202 03047000
*  R2 = NEXTBYTE(J);                                       /*@Z427VLS*/ 03048000
         L     @01,NEXTBY                                          1202 03049000
         BCTR  @01,0                                               1202 03050000
         SLR   R2,R2                                               1202 03051000
         IC    R2,NEXTBYTE(@12,@01)                                1202 03052000
*  K  = 2 * J;                                             /*@Z427VLS*/ 03053000
         LR    @15,@12                                             1203 03054000
         ALR   @15,@15                                             1203 03055000
         ST    @15,K                                               1203 03056000
*  SRDL(R2,4);                                             /*@Z427VLS*/ 03057000
         SRDL  R2,4                                                1204 03058000
*  SRL(R3,28);                                             /*@Z427VLS*/ 03059000
         SRL   R3,28                                               1205 03060000
*  R3 = R3 + 1;                                            /*@Z427VLS*/ 03061000
         LA    @14,1                                               1206 03062000
         ALR   R3,@14                                              1206 03063000
*  R2 = R2 + 1;                                            /*@Z427VLS*/ 03064000
         ALR   R2,@14                                              1207 03065000
*  ADDNUM(K-1) = CHARS(R2);                                /*@Z427VLS*/ 03066000
         L     @14,ADDNXT                                          1208 03067000
         ALR   @15,@14                                             1208 03068000
         BCTR  @15,0                                               1208 03069000
         BCTR  @15,0                                               1208 03070000
         LA    @01,CHARS-1(R2)                                     1208 03071000
         MVC   ADDNUM(1,@15),0(@01)                                1208 03072000
*  ADDNUM(K) = CHARS(R3);                                  /*@Z427VLS*/ 03073000
         L     @15,K                                               1209 03074000
         ALR   @14,@15                                             1209 03075000
         BCTR  @14,0                                               1209 03076000
         LA    @15,CHARS-1(R3)                                     1209 03077000
         MVC   ADDNUM(1,@14),0(@15)                                1209 03078000
*END;                                                      /*@Z427VLS*/ 03079000
         BCTR  @12,0                                               1210 03080000
         ST    @12,J                                               1210 03081000
@DE01201 LTR   @12,@12                                             1210 03082000
         BP    @DL01201                                            1210 03083000
*RESPECIFY (R2,R3) UNRESTRICTED;                           /*@Z427VLS*/ 03084000
*END; /*CLOSING END TO PROC CONVERT                          @Z427VLS*/ 03085000
@EL00035 DS    0H                                                  1212 03086000
@EF00035 DS    0H                                                  1212 03087000
@ER00035 LM    @14,@12,12(@13)                                     1212 03088000
         BR    @14                                                 1212 03089000
*BADORPT:  ; /*ERREPT  UNSUCCESSFUL OPEN                     @Z427VLS*/ 03090000
BADORPT  DS    0H                                                  1214 03091000
*MSGNO = 44;                                               /*@Z427VLS*/ 03092000
         MVC   MSGNO(4),@CF01120                                   1214 03093000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03094000
         BAL   @14,ERRMSG                                          1215 03095000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03096000
         MVC   BADNEWS(4),@CF00068                                 1216 03097000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03098000
         B     GOBACK                                              1217 03099000
*BADOTOUR: ; /*TOURIST UNSUCCESSFUL OPEN                     @Z427VLS*/ 03100000
BADOTOUR DS    0H                                                  1219 03101000
* CALL IFCMSG(205,ADDR(PRNTBF));                           /*@Z427VLS*/ 03102000
         LA    @12,PRNTBF                                          1219 03103000
         ST    @12,@AFTEMPS+16                                     1219 03104000
         L     @12,SAVER2                                          1219 03105000
         L     @15,ADIFCMSG(,@12)                                  1219 03106000
         LA    @01,@AL01219                                        1219 03107000
         BALR  @14,@15                                             1219 03108000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03109000
         MVC   BADNEWS(4),@CF00068                                 1220 03110000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03111000
         B     GOBACK                                              1221 03112000
*HISTBAD:  ; /*ERROR EXIT WRITING TO ACCDEV                  @Z427VLS*/ 03113000
HISTBAD  DS    0H                                                  1223 03114000
*MSGNO = 6;                                                /*@Z427VLS*/ 03115000
         MVC   MSGNO(4),@CF00082                                   1223 03116000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03117000
         BAL   @14,ERRMSG                                          1224 03118000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03119000
         MVC   BADNEWS(4),@CF00068                                 1225 03120000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03121000
         B     GOBACK                                              1226 03122000
*HISTEND:  ; /*EOF EXIT FOR READING ACCIN                    @Z427VLS*/ 03123000
HISTEND  DS    0H                                                  1228 03124000
*CALL CLOSHIST;                                            /*@Z427VLS*/ 03125000
         BAL   @14,CLOSHIST                                        1228 03126000
*IF SERLO = ON THEN /*IF SERLOG IS ALSO ON WE MUST READ IT ALSO*/  1229 03127000
         TM    SERLO,B'10000000'                                   1229 03128000
         BNO   @RF01229                                            1229 03129000
* DO;                                                      /*@Z427VLS*/ 03130000
*  CALL READSER; /*WILL START READING SERLOG SEQUENTIALLY THERE*/  1231 03131000
         BAL   @14,READSER                                         1231 03132000
*  GOTO GOBACK;   /*RETURN TO CALLER                         @Z427VLS*/ 03133000
         B     GOBACK                                              1232 03134000
* END;                                                     /*@Z427VLS*/ 03135000
*ELSE                                                              1234 03136000
*  DO;                                                     /*@Z427VLS*/ 03137000
@RF01229 DS    0H                                                  1235 03138000
*    BADNEWS = FOUR; /*INDICATE EOF ON SEQUENTIAL DATA       @Z427VLS*/ 03139000
         MVC   BADNEWS(4),@CF00065                                 1235 03140000
*    GOTO GOBACK;                                          /*@Z427VLS*/ 03141000
         B     GOBACK                                              1236 03142000
*  END;                                                    /*@Z427VLS*/ 03143000
*HISTINBD:  ; /*ERROR EXIT FOR READING ACCIN                 @Z427VLS*/ 03144000
HISTINBD DS    0H                                                  1239 03145000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03146000
         MVC   BADNEWS(4),@CF00068                                 1239 03147000
*MSGNO =7;                                                 /*@Z427VLS*/ 03148000
         MVC   MSGNO(4),@CF00037                                   1240 03149000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03150000
         BAL   @14,ERRMSG                                          1241 03151000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03152000
         B     GOBACK                                              1242 03153000
*BADBRSEQ: ; /*CANT OPEN DIRECTWK FOR READ EXIT              @Z427VLS*/ 03154000
BADBRSEQ DS    0H                                                  1244 03155000
*MSGNO = 30;                                               /*@Z427VLS*/ 03156000
         MVC   MSGNO(4),@CF01132                                   1244 03157000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03158000
         BAL   @14,ERRMSG                                          1245 03159000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03160000
         MVC   BADNEWS(4),@CF00068                                 1246 03161000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03162000
         B     GOBACK                                              1247 03163000
*BADOPENA: ; /*SERLOG OPEN FAILED EXIT                       @Z427VLS*/ 03164000
BADOPENA DS    0H                                                  1249 03165000
*GEN(DEQ   (RESID,LOGRECA,11,STEP)); /*STEP DEQUEUE          @Z427VLS*/ 03166000
         DEQ   (RESID,LOGRECA,11,STEP)                                  03167000
*MSGNO = 13;                                               /*@Z427VLS*/ 03168000
         MVC   MSGNO(4),@CF01135                                   1250 03169000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03170000
         BAL   @14,ERRMSG                                          1251 03171000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03172000
         MVC   BADNEWS(4),@CF00068                                 1252 03173000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03174000
         B     GOBACK                                              1253 03175000
*BADBWSEQ:  ; /*ERROR EXIT IF CANT OPEN DIRECTWK FOR WRITING @Z427VLS*/ 03176000
BADBWSEQ DS    0H                                                  1255 03177000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03178000
         MVC   BADNEWS(4),@CF00068                                 1255 03179000
*MSGNO = 27;                                               /*@Z427VLS*/ 03180000
         MVC   MSGNO(4),@CF01138                                   1256 03181000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03182000
         BAL   @14,ERRMSG                                          1257 03183000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03184000
         B     GOBACK                                              1258 03185000
*BDIST: ; /*IMPROPER RECORD FORMAT EXIT FOR ACCIN            @Z427VLS*/ 03186000
BDIST    DS    0H                                                  1260 03187000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03188000
         MVC   BADNEWS(4),@CF00068                                 1260 03189000
*MSGNO = 10;                                               /*@Z427VLS*/ 03190000
         MVC   MSGNO(4),@CF00033                                   1261 03191000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03192000
         BAL   @14,ERRMSG                                          1262 03193000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03194000
         B     GOBACK                                              1263 03195000
*BDOIHST: ;  /*CANT OPEN ACCIN EXIT                          @Z427VLS*/ 03196000
BDOIHST  DS    0H                                                  1265 03197000
*MSGNO = 9;                                                /*@Z427VLS*/ 03198000
         MVC   MSGNO(4),@CF00034                                   1265 03199000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03200000
         BAL   @14,ERRMSG                                          1266 03201000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03202000
         MVC   BADNEWS(4),@CF00068                                 1267 03203000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03204000
         B     GOBACK                                              1268 03205000
*BADRDIR: ; /*SYNAD FOR READING DIRECTWK D.S. SEQUENTIALLY WITH POINT*/ 03206000
BADRDIR  DS    0H                                                  1270 03207000
*MSGNO = 42;                                               /*@Z427VLS*/ 03208000
         MVC   MSGNO(4),@CF01145                                   1270 03209000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03210000
         BAL   @14,ERRMSG                                          1271 03211000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03212000
         MVC   BADNEWS(4),@CF00068                                 1272 03213000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03214000
         B     GOBACK                                              1273 03215000
*BADOOHST: ; /*CANT OPEN ACCDEV EXIT                         @Z427VLS*/ 03216000
BADOOHST DS    0H                                                  1275 03217000
*MSGNO = 3;                                                /*@Z427VLS*/ 03218000
         MVC   MSGNO(4),@CF00077                                   1275 03219000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03220000
         BAL   @14,ERRMSG                                          1276 03221000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03222000
         MVC   BADNEWS(4),@CF00068                                 1277 03223000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03224000
         B     GOBACK                                              1278 03225000
*SYSOBAD: ;                                                /*@Z427VLS*/ 03226000
SYSOBAD  DS    0H                                                  1280 03227000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03228000
         MVC   BADNEWS(4),@CF00068                                 1280 03229000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03230000
         B     GOBACK                                              1281 03231000
*SYSBAD: ;                                                 /*@Z427VLS*/ 03232000
SYSBAD   DS    0H                                                  1283 03233000
*MSGNO = 36; /*SYSIN READ ERROR                              @Z427VLS*/ 03234000
         MVC   MSGNO(4),@CF01152                                   1283 03235000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03236000
         BAL   @14,ERRMSG                                          1284 03237000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03238000
         MVC   BADNEWS(4),@CF00068                                 1285 03239000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03240000
         B     GOBACK                                              1286 03241000
*OVERFLOW: ;                                               /*@Z427VLS*/ 03242000
OVERFLOW DS    0H                                                  1288 03243000
*MSGNO = 37;                                               /*@Z427VLS*/ 03244000
         MVC   MSGNO(4),@CF01155                                   1288 03245000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03246000
         BAL   @14,ERRMSG                                          1289 03247000
*MSGNO = 38;                                               /*@Z427VLS*/ 03248000
         MVC   MSGNO(4),@CF01156                                   1290 03249000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03250000
         BAL   @14,ERRMSG                                          1291 03251000
*PRINTADR = ADDR(PRNTBF);                                  /*@Z427VLS*/ 03252000
         LA    @12,PRNTBF                                          1292 03253000
         L     @01,SAVER2                                          1292 03254000
         ST    @12,PRINTADR(,@01)                                  1292 03255000
*PRINTDS = 'F1'X;                                          /*@Z427VLS*/ 03256000
         MVI   PRINTDS(@12),X'F1'                                  1293 03257000
*PRINTCC = '09'X;                                          /*@Z427VLS*/ 03258000
         MVI   PRINTCC(@12),X'09'                                  1294 03259000
*NUMBER = 40; /*NUMBER OF BYTES OF LAST RECORD WRITTEN TO BE PRINTED*/  03260000
         MVC   NUMBER(4),@CF00463                                  1295 03261000
*NEXTBY = R7 + 4; /*ADDRESS OF RECORD PAST RECORD LENGTH     @Z427VLS*/ 03262000
         LA    @06,4                                               1296 03263000
         ALR   @06,R7                                              1296 03264000
         ST    @06,NEXTBY                                          1296 03265000
*ADDNXT = PRINTADR + 2; /*PUT PRINTABLE NUMBER HERE IN PRINT BUFFER*/   03266000
         AL    @12,@CF00075                                        1297 03267000
         ST    @12,ADDNXT                                          1297 03268000
*CALL CONVERT; /*CONVERT HEXIDECIMAL RECORD HEADER TO PRINTABLE*/  1298 03269000
         BAL   @14,CONVERT                                         1298 03270000
*CALL PRINTIT; /*WRITE RECORD LAST PROCESSED TO THE TOURIST DATA SET*/  03271000
         BAL   @14,PRINTIT                                         1299 03272000
*BADNEWS = 8;                                              /*@Z427VLS*/ 03273000
         MVC   BADNEWS(4),@CF00035                                 1300 03274000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03275000
         B     GOBACK                                              1301 03276000
*SYSEOF: ;                                                 /*@Z427VLS*/ 03277000
SYSEOF   DS    0H                                                  1303 03278000
*BADNEWS = FOUR;                                           /*@Z427VLS*/ 03279000
         MVC   BADNEWS(4),@CF00065                                 1303 03280000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03281000
         B     GOBACK                                              1304 03282000
*PRINTBAD: ;                                               /*@Z427VLS*/ 03283000
PRINTBAD DS    0H                                                  1306 03284000
*MSGNO = 18;                                               /*@Z427VLS*/ 03285000
         MVC   MSGNO(4),@CF01162                                   1306 03286000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03287000
         BAL   @14,ERRMSG                                          1307 03288000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03289000
         MVC   BADNEWS(4),@CF00068                                 1308 03290000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03291000
         B     GOBACK                                              1309 03292000
*TOURBAD: ;                                                /*@Z427VLS*/ 03293000
TOURBAD  DS    0H                                                  1311 03294000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03295000
         MVC   BADNEWS(4),@CF00068                                 1311 03296000
*CALL IFCMSG(202,ADDR(PRNTBF));                            /*@Z427VLS*/ 03297000
         LA    @12,PRNTBF                                          1312 03298000
         ST    @12,@AFTEMPS+16                                     1312 03299000
         L     @12,SAVER2                                          1312 03300000
         L     @15,ADIFCMSG(,@12)                                  1312 03301000
         LA    @01,@AL01312                                        1312 03302000
         BALR  @14,@15                                             1312 03303000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03304000
         B     GOBACK                                              1313 03305000
*WRITEERR:;                                                /*@Z427VLS*/ 03306000
WRITEERR DS    0H                                                  1315 03307000
*MSGNO = 26;                                               /*@Z427VLS*/ 03308000
         MVC   MSGNO(4),@CF01167                                   1315 03309000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03310000
         BAL   @14,ERRMSG                                          1316 03311000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03312000
         MVC   BADNEWS(4),@CF00068                                 1317 03313000
*GO TO GOBACK;                                             /*@Z427VLS*/ 03314000
         B     GOBACK                                              1318 03315000
*/*                                                          @Z427VLS*/ 03316000
*/*      BLOCK GENERATE FOR CONTROL BLOCKS & DSECT           @Z427VLS*/ 03317000
*/*                                                          @Z427VLS*/ 03318000
*GENERATE ;                                                /*@Z427VLS*/ 03319000
OUTHIST  DCB   MACRF=(PM),SYNAD=HISTBAD,LRECL=2000,                    C03320000
               DSORG=PS,DDNAME=ACCDEV,BUFNO=2                           03321000
INHIST   DCB   MACRF=(GM),DSORG=PS,DDNAME=ACCIN,LRECL=2000,            C03322000
               EODAD=HISTEND,SYNAD=HISTINBD,BUFNO=2                     03323000
LOGREC   DCB   MACRF=(E),IOBAD=XIOB,DSORG=DA,DEVD=DA,RECFM=U,          C03324000
               DDNAME=SERLOG                                            03325000
* DIRECTWK IS READ WITH THE FIRST DCB USING NOTE LOGIC AND READ WITH    03326000
* THE SECOND DCB USING POINT LOGIC                                      03327000
* A CLOSE TO THE FIRST DCB MUST BE ISSUED BEFORE USING THE SECOND       03328000
WORKWDCB DCB   DDNAME=DIRECTWK,DEVD=DA,DSORG=PS,BLKSIZE=2000,          C03329000
               MACRF=(WP),RECFM=V,SYNAD=WRITEERR                        03330000
WORKRDCB DCB   DDNAME=DIRECTWK,DEVD=DA,DSORG=PS,BLKSIZE=2000,          C03331000
               MACRF=(RP),RECFM=V,SYNAD=BADRDIR                         03332000
SYSDCB   DCB   DDNAME=SYSIN,DEVD=DA,DSORG=PS,EODAD=SYSEOF,             C03333000
               LRECL=80,MACRF=GM,SYNAD=SYSBAD,EXLST=BLKEXIT    @VS48705 03334000
* NOTE THAT EREPPT COMMAND CHARACTERS HAVE FLUCTUATED BETWEEN ANSI AND  03335000
* MACHINE CHARACTERS.                                                   03336000
EREPTDCB DCB   MACRF=(PM),SYNAD=PRINTBAD,LRECL=133,DDNAME=EREPPT,      C03337000
               DEVD=DA,DSORG=PS,RECFM=FBM,EXLST=BLKEXIT        @VS48705 03338000
TOURDCB  DCB   MACRF=(PM),SYNAD=TOURBAD,LRECL=133,DDNAME=TOURIST,      C03339000
               DEVD=DA,DSORG=PS,RECFM=FBM,EXLST=BLKEXIT        @VS48705 03340000
BLKEXIT  DS    0F                         ALIGN ON A FULLWORD  @VS48705 03341000
         DC    AL1(128+5),AL3(ADDBLKSZ)   DCB OPEN EXIT        @VS48705 03342000
ADDBLKSZ EQU   *                                               @VS48705 03343000
         USING IHADCB,1                                        @VS48705 03344000
         OC    DCBBLKSI(2),DCBBLKSI   BLKSIZE SPECIFIED        @VS48705 03345000
         BNZR  R14                    YES...RETURN             @VS48705 03346000
         MVC   DCBBLKSI(2),DCBLRECL   DEFAULT BLKSIZE = LRECL  @VS48705 03347000
         BR    R14                    RETURN                   @VS48705 03348000
         DROP  1                                               @VS48705 03349000
*GENERATE DATA ;                                           /*@Z427VLS*/ 03350000
*/********************************************************************/ 03351000
*RESPECIFY (R7,R15) UNRESTRICTED;                          /*@Z427VLS*/ 03352000
*        END  /*CLOSING END TO EXTERNAL PROC IFCIOHND        @Z427VLS*/ 03353000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 03354000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 03355000
*;                                                                 1322 03356000
         B     @EL00001                                            1322 03357000
@DATA    DS    0H                                                       03358000
@CH00080 DC    H'5'                                                     03359000
@CH00662 DC    H'20'                                                    03360000
@CH00917 DC    H'1944'                                                  03361000
@CH01014 DC    H'-1'                                                    03362000
         DS    0F                                                       03363000
@AL00335 DC    A(@CF00939)             LIST WITH   2 ARGUMENT(S)        03364000
         DC    A(@AFTEMPS)                                              03365000
@AL00716 DC    A(MSGNO)                LIST WITH   2 ARGUMENT(S)        03366000
         DC    A(@AFTEMPS+4)                                            03367000
@AL00744 DC    A(@CF01026)             LIST WITH   2 ARGUMENT(S)        03368000
         DC    A(@AFTEMPS+4)                                            03369000
@AL00786 DC    A(@CF01031)             LIST WITH   2 ARGUMENT(S)        03370000
         DC    A(@AFTEMPS+8)                                            03371000
@AL01102 DC    A(@CF01095)             LIST WITH   2 ARGUMENT(S)        03372000
         DC    A(@AFTEMPS+12)                                           03373000
@AL01219 DC    A(@CF01123)             LIST WITH   2 ARGUMENT(S)        03374000
         DC    A(@AFTEMPS+16)                                           03375000
@AL01312 DC    A(@CF01026)             LIST WITH   2 ARGUMENT(S)        03376000
         DC    A(@AFTEMPS+16)                                           03377000
         DS    0F                                                       03378000
@SA00001 DS    18F                                                      03379000
@SA00023 DS    14F                                                      03380000
@SA00021 DS    14F                                                      03381000
@SA00034 DS    15F                                                      03382000
@SA00019 DS    15F                                                      03383000
@SA00015 DS    15F                                                      03384000
@SA00009 DS    15F                                                      03385000
@SA00010 DS    15F                                                      03386000
@SA00018 DS    14F                                                      03387000
@SA00014 DS    15F                                                      03388000
@SA00002 DS    15F                                                      03389000
@SA00003 DS    14F                                                      03390000
@SA00007 DS    15F                                                      03391000
@SA00008 DS    15F                                                      03392000
@SA00004 DS    14F                                                      03393000
@SA00005 DS    15F                                                      03394000
@SA00006 DS    15F                                                      03395000
@SA00029 DS    15F                                                      03396000
@SA00031 DS    15F                                                      03397000
@SA00026 DS    15F                                                      03398000
@SA00033 DS    15F                                                      03399000
@SA00016 DS    15F                                                      03400000
@SA00025 DS    15F                                                      03401000
@SA00032 DS    15F                                                      03402000
@SA00027 DS    15F                                                      03403000
@SA00028 DS    15F                                                      03404000
@SA00017 DS    15F                                                      03405000
@SA00022 DS    15F                                                      03406000
@SA00011 DS    15F                                                      03407000
@SA00030 DS    15F                                                      03408000
@SA00013 DS    15F                                                      03409000
@SA00012 DS    15F                                                      03410000
@SA00020 DS    14F                                                      03411000
@SA00024 DS    14F                                                      03412000
@AFTEMPS DS    5F                                                       03413000
         DS    0F                                                       03414000
@CF00056 DC    F'1'                                                     03415000
@CH00056 EQU   @CF00056+2                                               03416000
@CF00075 DC    F'2'                                                     03417000
@CH00075 EQU   @CF00075+2                                               03418000
@CF00077 DC    F'3'                                                     03419000
@CH00077 EQU   @CF00077+2                                               03420000
@CF00065 DC    F'4'                                                     03421000
@CH00065 EQU   @CF00065+2                                               03422000
@CF00082 DC    F'6'                                                     03423000
@CH00082 EQU   @CF00082+2                                               03424000
@CF00037 DC    F'7'                                                     03425000
@CH00037 EQU   @CF00037+2                                               03426000
@CF00035 DC    F'8'                                                     03427000
@CF00034 DC    F'9'                                                     03428000
@CH00034 EQU   @CF00034+2                                               03429000
@CF00033 DC    F'10'                                                    03430000
@CF00032 DC    F'11'                                                    03431000
@CF00068 DC    F'12'                                                    03432000
@CF01135 DC    F'13'                                                    03433000
@CF00759 DC    F'14'                                                    03434000
@CF00036 DC    F'15'                                                    03435000
@CF00089 DC    F'16'                                                    03436000
@CF00991 DC    F'17'                                                    03437000
@CF01162 DC    F'18'                                                    03438000
@CF01030 DC    F'19'                                                    03439000
@CF01066 DC    F'21'                                                    03440000
@CF01105 DC    F'22'                                                    03441000
@CF01088 DC    F'23'                                                    03442000
@CF00228 DC    F'24'                                                    03443000
@CF00932 DC    F'25'                                                    03444000
@CF01167 DC    F'26'                                                    03445000
@CF01138 DC    F'27'                                                    03446000
@CF01048 DC    F'28'                                                    03447000
@CF00535 DC    F'29'                                                    03448000
@CF01132 DC    F'30'                                                    03449000
@CF00042 DC    F'31'                                                    03450000
@CF00522 DC    F'32'                                                    03451000
@CF01036 DC    F'33'                                                    03452000
@CF01040 DC    F'34'                                                    03453000
@CF01044 DC    F'35'                                                    03454000
@CF01152 DC    F'36'                                                    03455000
@CF01155 DC    F'37'                                                    03456000
@CF01156 DC    F'38'                                                    03457000
@CF00925 DC    F'39'                                                    03458000
@CF00463 DC    F'40'                                                    03459000
@CH00463 EQU   @CF00463+2                                               03460000
@CF00945 DC    F'41'                                                    03461000
@CF01145 DC    F'42'                                                    03462000
@CF01120 DC    F'44'                                                    03463000
@CF01100 DC    F'45'                                                    03464000
@CF01053 DC    F'46'                                                    03465000
@CF00927 DC    F'47'                                                    03466000
@CF00938 DC    F'48'                                                    03467000
@CF00954 DC    F'49'                                                    03468000
@CF00294 DC    F'50'                                                    03469000
@CF01009 DC    F'51'                                                    03470000
@CH01009 EQU   @CF01009+2                                               03471000
@CF01024 DC    F'52'                                                    03472000
@CF00944 DC    F'53'                                                    03473000
@CF00953 DC    F'54'                                                    03474000
@CF00937 DC    F'55'                                                    03475000
@CF01005 DC    F'56'                                                    03476000
@CF01006 DC    F'57'                                                    03477000
@CF01013 DC    F'58'                                                    03478000
@CF01035 DC    F'59'                                                    03479000
@CF00832 DC    F'60'                                                    03480000
@CF01060 DC    F'61'                                                    03481000
@CF01061 DC    F'62'                                                    03482000
@CF01073 DC    F'63'                                                    03483000
@CF00700 DC    F'64'                                                    03484000
@CF01080 DC    F'65'                                                    03485000
@CF01084 DC    F'66'                                                    03486000
@CF01099 DC    F'67'                                                    03487000
@CF01104 DC    F'68'                                                    03488000
@CF01109 DC    F'69'                                                    03489000
@CF00924 DC    F'70'                                                    03490000
@CF00939 DC    F'201'                                                   03491000
@CF01026 DC    F'202'                                                   03492000
@CF01031 DC    F'203'                                                   03493000
@CF01095 DC    F'204'                                                   03494000
@CF01123 DC    F'205'                                                   03495000
@CF01176 DC    XL4'0000FFFF'                                            03496000
         DS    0D                                                       03497000
SAVER2   DC    A(0)                                                     03498000
PTRSPOT  DC    A(0)                                                     03499000
SAVEPTR  DC    A(0)                                                     03500000
FRSPTR   DC    A(0)                                                     03501000
RUNPTR   DC    A(0)                                                     03502000
A        DC    F'0'                                                     03503000
K        DC    F'0'                                                     03504000
J        DC    F'0'                                                     03505000
GETHIS   DC    F'0'                                                     03506000
R7SAVE   DC    F'0'                                                     03507000
TIMEBASE DC    A(0)                                                     03508000
NEXTBY   DC    F'0'                                                     03509000
ADDNXT   DC    F'0'                                                     03510000
NUMBER   DC    F'0'                                                     03511000
MSGNO    DC    F'0'                                                     03512000
BADNEWS  DC    F'0'                                                     03513000
PASSNUM  DC    F'0'                                                     03514000
XWRECB   DC    F'0'                                                     03515000
         ORG   XWRECB                                                   03516000
POST     DS    CL1                                                      03517000
@NM00017 DS    CL3                                                      03518000
         ORG   XWRECB+4                                                 03519000
TIMDIV   DS    F                                                        03520000
MILLION  DC    F'1000000'                                               03521000
TWENTY4  DC    F'24'                                                    03522000
SIXTY    DC    F'60'                                                    03523000
CONSTG   DC    XL4'30040'                                               03524000
CONSTH   DC    XL4'24AE062'                                             03525000
SIXTYMIL DC    F'60000000'                                              03526000
THCONV   DC    F'10000'                                                 03527000
SAVELNGT DC    H'0'                                                     03528000
LINECTT  DC    H'0'                                                     03529000
LINEMAX  DC    H'0'                                                     03530000
SDRK     DC    H'0'                                                     03531000
SAVELENT DC    H'0'                                                     03532000
         DS    0D                                                       03533000
@TS00001 DS    CL8                                                      03534000
@CC01025 DC    C'1 '                                                    03535000
@CB00120 DC    X'00000000'                                              03536000
@CB00523 DC    X'00000007'                                              03537000
@CB01093 DC    X'0000000F'                                              03538000
@CB00209 EQU   @CB00120                                                 03539000
@CB00262 DC    X'FFFF'                                                  03540000
@CB00981 DC    X'000F'                                                  03541000
CARDSPOT DC    CL80' '                                                  03542000
         DS    CL2                                                      03543000
MAXTRK   DC    X'00000000'                                              03544000
LOOKATIT DC    CL40'XXXXXXXXOPERATION COUNTS IFCEREP1XXXXXXX'           03545000
CONTPTR  DS    CL44                                                     03546000
         ORG   CONTPTR                                                  03547000
ERRORENT DC    F'0'                                                     03548000
RSEQCNT  DC    F'0'                                                     03549000
RSERDCNT DC    F'0'                                                     03550000
CONVTCT  DC    F'0'                                                     03551000
NUMRECSV DC    F'0'                                                     03552000
SYSRDCT  DC    F'0'                                                     03553000
RITEWKCT DC    F'0'                                                     03554000
READWKCT DC    F'0'                                                     03555000
ACIRDCT  DC    F'0'                                                     03556000
DEVCT    DC    F'0'                                                     03557000
RFRCOUNT DC    F'0'                                                     03558000
         ORG   CONTPTR+44                                               03559000
TTRSAVE  DC    X'00000000'                                              03560000
CCSAVE   DC    CL1' '                                                   03561000
BLANKS   DC    CL134' '                                                 03562000
PACKPAS  DC    CL4'    '                                                03563000
CHARPAS  DC    CL8'        '                                            03564000
CHARS    DC    CL16'0123456789ABCDEF'                                   03565000
         DS    CL5                                                      03566000
PRNTBF   DS    CL134                                                    03567000
         DS    CL2                                                      03568000
BUF1     DS    CL2004                                                   03569000
         ORG   BUF1                                                     03570000
BUF1RDW  DS    CL4                                                      03571000
         ORG   BUF1RDW                                                  03572000
BUF1RDWL DC    H'0'                                                     03573000
BUF1L    DC    H'0'                                                     03574000
         ORG   BUF1+4                                                   03575000
BUF1DTA  DS    CL2000                                                   03576000
         ORG   BUF1+2004                                                03577000
IOSWTCH  DC    X'000000'                                                03578000
         ORG   IOSWTCH                                                  03579000
HISTOPN  DS    BL1                                                      03580000
SECGET   EQU   IOSWTCH+0                                                03581000
FLIPFLOP EQU   IOSWTCH+0                                                03582000
HISTYES  EQU   IOSWTCH+0                                                03583000
DBLYES   EQU   IOSWTCH+0                                                03584000
LASTLOOP EQU   IOSWTCH+0                                                03585000
TOURERR  EQU   IOSWTCH+0                                                03586000
INHISO   EQU   IOSWTCH+0                                                03587000
SERLO    DS    BL1                                                      03588000
TWOTRY   EQU   IOSWTCH+1                                                03589000
INDIR    EQU   IOSWTCH+1                                                03590000
NONBLANK EQU   IOSWTCH+1                                                03591000
CLOSE2   EQU   IOSWTCH+1                                                03592000
SYSOPN   EQU   IOSWTCH+1                                                03593000
TOUROPN  EQU   IOSWTCH+1                                                03594000
ERPTOPN  EQU   IOSWTCH+1                                                03595000
READFR   DS    BL1                                                      03596000
SCRATCH  EQU   IOSWTCH+2                                                03597000
SNAPOP   EQU   IOSWTCH+2                                                03598000
         ORG   IOSWTCH+3                                                03599000
         DS    CL1                                                      03600000
HDRBUFF  DS    CL64                                                     03601000
         ORG   HDRBUFF                                                  03602000
HDRSEEK  DS    CL8                                                      03603000
         ORG   HDRSEEK                                                  03604000
HDRM     DC    X'00'                                                    03605000
HDRBB    DC    X'0000'                                                  03606000
HDRCC    DC    X'0000'                                                  03607000
HDRHH    DC    X'0000'                                                  03608000
HDRR     DC    X'00'                                                    03609000
         ORG   HDRBUFF+8                                                03610000
HEADER   DS    CL40                                                     03611000
         ORG   HEADER                                                   03612000
HDRKEY   DS    CL2                                                      03613000
HDRSCC   DS    CL2                                                      03614000
HDRSHH   DS    CL2                                                      03615000
HDRECC   DS    CL2                                                      03616000
HDREHH   DS    CL2                                                      03617000
HDRCOUNT DS    CL1                                                      03618000
HDRREC1  DS    CL7                                                      03619000
         ORG   HDRREC1                                                  03620000
HDR1BB   DS    CL2                                                      03621000
HDR1CC   DS    CL2                                                      03622000
HDR1HH   DS    CL2                                                      03623000
HDR1R    DS    CL1                                                      03624000
         ORG   HEADER+18                                                03625000
HDRREM   DS    CL2                                                      03626000
HDRTRKCP DS    CL2                                                      03627000
HDRREC2  DS    CL7                                                      03628000
         ORG   HDRREC2                                                  03629000
HDR2BB   DS    CL2                                                      03630000
HDR2CC   DS    CL2                                                      03631000
HDR2HH   DS    CL2                                                      03632000
HDR2R    DS    CL1                                                      03633000
         ORG   HEADER+29                                                03634000
HDRUCBNO DS    CL2                                                      03635000
HDREXSZE DS    CL2                                                      03636000
HDRTYPE  DS    CL1                                                      03637000
@NM00012 DS    CL4                                                      03638000
@NM00013 DS    CL1                                                      03639000
         ORG   @NM00013                                                 03640000
HDRWNGBT DS    BL1                                                      03641000
@NM00014 EQU   @NM00013+0                                               03642000
FRAMES   EQU   @NM00013+0                                               03643000
@NM00015 EQU   @NM00013+0                                               03644000
         ORG   HEADER+39                                                03645000
HDRSAFE  DS    CL1                                                      03646000
         ORG   HDRBUFF+48                                               03647000
PREVSEEK DS    CL8                                                      03648000
         ORG   PREVSEEK                                                 03649000
PREVM    DC    X'FF'                                                    03650000
PREVBB   DS    CL2                                                      03651000
PREVCC   DS    CL2                                                      03652000
PREVHH   DS    CL2                                                      03653000
PREVR    DS    CL1                                                      03654000
         ORG   HDRBUFF+64                                               03655000
LOGRECA  DC    CL11'SYS1.LOGREC'                                        03656000
LOGRECB  DC    CL8'RECORDER'                                            03657000
RESID    DC    CL8'SERLOG'                                              03658000
RESIDII  DC    CL8'LOGREC'                                              03659000
ZEROA    DS    CL24                                                     03660000
SEEKSAVE DC    X'0000000000000000'                                      03661000
         ORG   SEEKSAVE                                                 03662000
@NM00016 DS    CL7                                                      03663000
SKSAVREC DS    CL1                                                      03664000
         ORG   SEEKSAVE+8                                               03665000
         DS    CL5                                                      03666000
XIOB     DS    CL40                                                     03667000
         ORG   XIOB                                                     03668000
XIOBFL1  DC    X'42'                                                    03669000
XIOBFL2  DC    X'00'                                                    03670000
XIOBSNS0 DC    X'00'                                                    03671000
XIOBSNS1 DC    X'00'                                                    03672000
XIOBECB  DC    AL4(XWRECB)                                              03673000
XIOBCSW  DC    X'0000000000000000'                                      03674000
XIOBCCW  DC    AL4(SEQ)                                                 03675000
XIOBDCB  DS    AL4                                                      03676000
XIOBRA   DC    A(0)                                                     03677000
XIOBBEC  DC    F'0'                                                     03678000
XIOBSEEK DS    CL8                                                      03679000
         ORG   XIOBSEEK                                                 03680000
XIOBM    DC    X'00'                                                    03681000
XIOBBB   DC    X'0000'                                                  03682000
XIOBCC   DC    X'0000'                                                  03683000
XIOBHH   DC    X'0000'                                                  03684000
XIOBR    DC    X'00'                                                    03685000
         ORG   XIOB+40                                                  03686000
SEQ      DS    CL24                                                     03687000
         ORG   SEQ                                                      03688000
SID1     DS    CL8                                                      03689000
         ORG   SID1                                                     03690000
@NM00018 DC    X'31'                                                    03691000
AREAADR  DS    AL3                                                      03692000
@NM00019 DC    X'4000'                                                  03693000
@NM00020 DC    H'5'                                                     03694000
         ORG   SEQ+8                                                    03695000
TIC1     DS    CL8                                                      03696000
         ORG   TIC1                                                     03697000
@NM00021 DC    X'08'                                                    03698000
@NM00022 DC    AL3(SID1)                                                03699000
@NM00023 DC    X'4000'                                                  03700000
@NM00024 DC    H'1'                                                     03701000
         ORG   SEQ+16                                                   03702000
CKD1     DS    CL8                                                      03703000
         ORG   CKD1                                                     03704000
CKDCOM   DS    CL1                                                      03705000
CKDAREA  DS    AL3                                                      03706000
CKDCHAIN DC    X'20'                                                    03707000
@NM00025 DC    X'00'                                                    03708000
CKDCOUNT DS    FL2                                                      03709000
         ORG   SEQ+24                                                   03710000
SWITCH   DC    X'00'                                                    03711000
         ORG   SWITCH                                                   03712000
SBT0     DS    BL1                                                      03713000
SBT2     EQU   SWITCH+0                                                 03714000
SBT3     EQU   SWITCH+0                                                 03715000
SBT4     EQU   SWITCH+0                                                 03716000
SBT7     EQU   SWITCH+0                                                 03717000
         ORG   SWITCH+1                                                 03718000
         DS    CL7                                                      03719000
WORK8    DS    CL8                                                      03720000
         ORG   WORK8                                                    03721000
WORK     DS    FL4                                                      03722000
WORKB    DS    FL4                                                      03723000
         ORG   WORKB                                                    03724000
WHOURS   DS    CL1                                                      03725000
WMINS    DS    CL1                                                      03726000
WDAYS    DS    CL2                                                      03727000
         ORG   WDAYS                                                    03728000
WSECS    DS    CL1                                                      03729000
WTNTHS   DS    CL1                                                      03730000
         ORG   WORK8+8                                                  03731000
SUPERZAP DC    3CL10'SUPERZAP'                                          03732000
EDIFILD  DS    9CL1                                                     03733000
ERRLINE  DS    CL51                                                     03734000
         ORG   ERRLINE+0                                                03735000
ERRDS    DC    CL1'1'                                                   03736000
ERRCS    DC    CL1' '                                                   03737000
PRINTNM  DC    CL9'DEBUG15  '                                           03738000
PRNTXT   DC    CL40'SERLOG OPEN ATTEMPTED                   '           03739000
         ORG   ERRLINE+51                                               03740000
         ORG   ERRLINE+51                                               03741000
         DC    CL1'1'                                                   03742000
         DC    CL1' '                                                   03743000
         DC    CL9'DEBUG15  '                                           03744000
         DC    CL40'CHECK HEADER FOR MORE RECORDS ATTEMPTED '           03745000
         ORG   ERRLINE+102                                              03746000
         ORG   ERRLINE+102                                              03747000
         DC    CL1'1'                                                   03748000
         DC    CL1' '                                                   03749000
         DC    CL9'DEBUG15  '                                           03750000
         DC    CL40'RESET OF SERLOG HEADER ATTEMPTED        '           03751000
         ORG   ERRLINE+153                                              03752000
         ORG   ERRLINE+153                                              03753000
         DC    CL1'1'                                                   03754000
         DC    CL1' '                                                   03755000
         DC    CL9'DEBUG15  '                                           03756000
         DC    CL40'SERLOG CLOSE ATTEMPTED                  '           03757000
         ORG   ERRLINE+204                                              03758000
         ORG   ERRLINE+204                                              03759000
         DC    CL1'1'                                                   03760000
         DC    CL1' '                                                   03761000
         DC    CL9'DEBUG15  '                                           03762000
         DC    CL40'ZEROALL ATTEMPTED                       '           03763000
         ORG   ERRLINE+255                                              03764000
         ORG   ERRLINE+255                                              03765000
         DC    CL1'1'                                                   03766000
         DC    CL1' '                                                   03767000
         DC    CL9'DEBUG15  '                                           03768000
         DC    CL40'SDR COUNTER DUMP ATTEMPTED              '           03769000
         ORG   ERRLINE+306                                              03770000
         ORG   ERRLINE+306                                              03771000
         DC    CL1'1'                                                   03772000
         DC    CL1' '                                                   03773000
         DC    CL9'DEBUG15  '                                           03774000
         DC    CL40'SYSIN OPEN ATTEMPTED                    '           03775000
         ORG   ERRLINE+357                                              03776000
         ORG   ERRLINE+357                                              03777000
         DC    CL1'1'                                                   03778000
         DC    CL1' '                                                   03779000
         DC    CL9'DEBUG15  '                                           03780000
         DC    CL40'SYSIN CLOSE ATTEMPTED                   '           03781000
         ORG   ERRLINE+408                                              03782000
         ORG   ERRLINE+408                                              03783000
         DC    CL1'1'                                                   03784000
         DC    CL1' '                                                   03785000
         DC    CL9'DEBUG15  '                                           03786000
         DC    CL40'DIRECTWK CLOSE FOR WRITING ATTEMPTED    '           03787000
         ORG   ERRLINE+459                                              03788000
         ORG   ERRLINE+459                                              03789000
         DC    CL1'1'                                                   03790000
         DC    CL1' '                                                   03791000
         DC    CL9'DEBUG15  '                                           03792000
         DC    CL40'DIRECTWK CLOSE FOR READING ATTEMPTED    '           03793000
         ORG   ERRLINE+510                                              03794000
         ORG   ERRLINE+510                                              03795000
         DC    CL1'1'                                                   03796000
         DC    CL1' '                                                   03797000
         DC    CL9'DEBUG15  '                                           03798000
         DC    CL40'DIRECTWK OPEN FOR WRITE ATTEMPTED      '            03799000
         ORG   ERRLINE+561                                              03800000
         ORG   ERRLINE+561                                              03801000
         DC    CL1'1'                                                   03802000
         DC    CL1' '                                                   03803000
         DC    CL9'DEBUG15  '                                           03804000
         DC    CL40'ACCIN OPEN ATTEMPTED                    '           03805000
         ORG   ERRLINE+612                                              03806000
         ORG   ERRLINE+612                                              03807000
         DC    CL1'1'                                                   03808000
         DC    CL1' '                                                   03809000
         DC    CL9'DEBUG15  '                                           03810000
         DC    CL40'ACCIN CLOSE ATTEMPTED                   '           03811000
         ORG   ERRLINE+663                                              03812000
         ORG   ERRLINE+663                                              03813000
         DC    CL1'1'                                                   03814000
         DC    CL1' '                                                   03815000
         DC    CL9'DEBUG15  '                                           03816000
         DC    CL40'ACCDEV CLOSE ATTEMPTED                  '           03817000
         ORG   ERRLINE+714                                              03818000
         ORG   ERRLINE+714                                              03819000
         DC    CL1'1'                                                   03820000
         DC    CL1' '                                                   03821000
         DC    CL9'DEBUG15  '                                           03822000
         DC    CL40'EREPPT OPEN ATTEMPTED                   '           03823000
         ORG   ERRLINE+765                                              03824000
         ORG   ERRLINE+765                                              03825000
         DC    CL1'1'                                                   03826000
         DC    CL1' '                                                   03827000
         DC    CL9'DEBUG15  '                                           03828000
         DC    CL40'EREPPT CLOSE ATTEMPTED                  '           03829000
         ORG   ERRLINE+816                                              03830000
         ORG   ERRLINE+816                                              03831000
         DC    CL1'1'                                                   03832000
         DC    CL1' '                                                   03833000
         DC    CL9'DEBUG15  '                                           03834000
         DC    CL40'ACCDEV OPEN ATTEMPTED                   '           03835000
         ORG   ERRLINE+867                                              03836000
         ORG   ERRLINE+867                                              03837000
         DC    CL1'1'                                                   03838000
         DC    CL1' '                                                   03839000
         DC    CL9'DEBUG15  '                                           03840000
         DC    CL40'FIRST FRAME READ ATTEMPT                '           03841000
         ORG   ERRLINE+918                                              03842000
         ORG   ERRLINE+918                                              03843000
         DC    CL1'1'                                                   03844000
         DC    CL1' '                                                   03845000
         DC    CL9'DEBUG15  '                                           03846000
         DC    CL40'TIMES IFCIOHND EXITED WITH R.C.12       '           03847000
         ORG   ERRLINE+969                                              03848000
         ORG   ERRLINE+969                                              03849000
         DC    CL1'1'                                                   03850000
         DC    CL1' '                                                   03851000
         DC    CL9'DEBUG15  '                                           03852000
         DC    CL40'SERLOG SEQUENTIAL READ ATTEMPTS         '           03853000
         ORG   ERRLINE+1020                                             03854000
         ORG   ERRLINE+1020                                             03855000
         DC    CL1'1'                                                   03856000
         DC    CL1' '                                                   03857000
         DC    CL9'DEBUG15  '                                           03858000
         DC    CL40'SERLOG DIRECT READ ATTEMPTS             '           03859000
         ORG   ERRLINE+1071                                             03860000
         ORG   ERRLINE+1071                                             03861000
         DC    CL1'1'                                                   03862000
         DC    CL1' '                                                   03863000
         DC    CL9'DEBUG15  '                                           03864000
         DC    CL40'TIME CONVERSION NECESSARY NUM. TIMES    '           03865000
         ORG   ERRLINE+1122                                             03866000
         ORG   ERRLINE+1122                                             03867000
         DC    CL1'1'                                                   03868000
         DC    CL1' '                                                   03869000
         DC    CL9'DEBUG15  '                                           03870000
         DC    CL40'RECORDS SAVED DURING ZEROALL PROCESSING '           03871000
         ORG   ERRLINE+1173                                             03872000
         ORG   ERRLINE+1173                                             03873000
         DC    CL1'1'                                                   03874000
         DC    CL1' '                                                   03875000
         DC    CL9'DEBUG15  '                                           03876000
         DC    CL40'SYSIN READ ATTEMPTS                     '           03877000
         ORG   ERRLINE+1224                                             03878000
         ORG   ERRLINE+1224                                             03879000
         DC    CL1'1'                                                   03880000
         DC    CL1' '                                                   03881000
         DC    CL9'DEBUG15  '                                           03882000
         DC    CL40'DIRECTWK WRITE ATTEMPTS                 '           03883000
         ORG   ERRLINE+1275                                             03884000
         ORG   ERRLINE+1275                                             03885000
         DC    CL1'1'                                                   03886000
         DC    CL1' '                                                   03887000
         DC    CL9'DEBUG15  '                                           03888000
         DC    CL40'DIRECTWK READ ATTEMPTS                  '           03889000
         ORG   ERRLINE+1326                                             03890000
         ORG   ERRLINE+1326                                             03891000
         DC    CL1'1'                                                   03892000
         DC    CL1' '                                                   03893000
         DC    CL9'DEBUG15  '                                           03894000
         DC    CL40'ACCIN SEQUENTIAL READ ATTEMPTS          '           03895000
         ORG   ERRLINE+1377                                             03896000
         ORG   ERRLINE+1377                                             03897000
         DC    CL1'1'                                                   03898000
         DC    CL1' '                                                   03899000
         DC    CL9'DEBUG15  '                                           03900000
         DC    CL40'ACCDEV WRITE ATTEMPTS                   '           03901000
         ORG   ERRLINE+1428                                             03902000
         ORG   ERRLINE+1428                                             03903000
         DC    CL1'1'                                                   03904000
         DC    CL1' '                                                   03905000
         DC    CL9'DEBUG15  '                                           03906000
         DC    CL40'FRAME READ ATTEMPTS OF SYS1.LOGREC      '           03907000
         ORG   ERRLINE+1479                                             03908000
MACHCODE DC    11X'09'                                                  03909000
         DC    X'0B'                                                    03910000
         DC    5X'09'                                                   03911000
         DC    X'11'                                                    03912000
         DC    X'09'                                                    03913000
         DC    X'13'                                                    03914000
         DC    5X'09'                                                   03915000
         DC    X'19'                                                    03916000
         DC    X'09'                                                    03917000
         DC    X'1B'                                                    03918000
         DC    109X'09'                                                 03919000
         DC    X'89'                                                    03920000
         DC    X'09'                                                    03921000
         DC    X'8B'                                                    03922000
         DC    5X'09'                                                   03923000
         DC    X'91'                                                    03924000
         DC    X'09'                                                    03925000
         DC    X'93'                                                    03926000
         DC    5X'09'                                                   03927000
         DC    X'99'                                                    03928000
         DC    X'09'                                                    03929000
         DC    X'9B'                                                    03930000
         DC    5X'09'                                                   03931000
         DC    X'A1'                                                    03932000
         DC    X'09'                                                    03933000
         DC    X'A3'                                                    03934000
         DC    5X'09'                                                   03935000
         DC    X'A9'                                                    03936000
         DC    X'09'                                                    03937000
         DC    X'AB'                                                    03938000
         DC    5X'09'                                                   03939000
         DC    X'B1'                                                    03940000
         DC    X'09'                                                    03941000
         DC    X'B3'                                                    03942000
         DC    5X'09'                                                   03943000
         DC    X'B9'                                                    03944000
         DC    X'09'                                                    03945000
         DC    X'BB'                                                    03946000
         DC    5X'09'                                                   03947000
         DC    X'C1'                                                    03948000
         DC    X'09'                                                    03949000
         DC    X'C3'                                                    03950000
         DC    5X'09'                                                   03951000
         DC    X'C9'                                                    03952000
         DC    X'09'                                                    03953000
         DC    X'CB'                                                    03954000
         DC    5X'09'                                                   03955000
         DC    X'D1'                                                    03956000
         DC    X'09'                                                    03957000
         DC    X'D3'                                                    03958000
         DC    5X'09'                                                   03959000
         DC    X'D9'                                                    03960000
         DC    X'09'                                                    03961000
         DC    X'DB'                                                    03962000
         DC    5X'09'                                                   03963000
         DC    X'E1'                                                    03964000
         DC    X'09'                                                    03965000
         DC    X'E3'                                                    03966000
         DC    20X'09'                                                  03967000
         DS    8XL1                                                     03968000
BYTESREM DC    H'0'                                                     03969000
         DC    H'3419'                                                  03970000
         DC    H'20137'                                                 03971000
         DC    H'4596'                                                  03972000
         DC    H'4778'                                                  03973000
         DC    H'0'                                                     03974000
         DC    H'13192'                                                 03975000
         DC    H'14184'                                                 03976000
         DC    H'7008'                                                  03977000
         DC    H'12680'                                                 03978000
         DC    H'7954'                                                  03979000
         DC    H'18800'                                                 03980000
         DC    H'0'                                                     03981000
         DC    H'12680'                                                 03982000
PATCH    DC    20H'0'                                                   03983000
IFCIOHND CSECT                                                          03984000
         DC    S(SUPERZAP)                                              03985000
IFCIOHND CSECT                                                          03986000
         DC    S(PATCH)                                                 03987000
IFCIOHND CSECT                                                          03988000
         DCBD  DSORG=PS,DEVD=DA         DCB DSECT                       03989000
IFCIOHND CSECT                                                          03990000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03991000
@01      EQU   01                                                       03992000
@02      EQU   02                                                       03993000
@03      EQU   03                                                       03994000
@04      EQU   04                                                       03995000
@05      EQU   05                                                       03996000
@06      EQU   06                                                       03997000
@07      EQU   07                                                       03998000
@08      EQU   08                                                       03999000
@09      EQU   09                                                       04000000
@10      EQU   10                                                       04001000
@11      EQU   11                                                       04002000
@12      EQU   12                                                       04003000
@13      EQU   13                                                       04004000
@14      EQU   14                                                       04005000
@15      EQU   15                                                       04006000
R2       EQU   @02                                                      04007000
R1       EQU   @01                                                      04008000
R7       EQU   @07                                                      04009000
R0       EQU   @00                                                      04010000
R3       EQU   @03                                                      04011000
R4       EQU   @04                                                      04012000
R5       EQU   @05                                                      04013000
R6       EQU   @06                                                      04014000
R12      EQU   @12                                                      04015000
R15      EQU   @15                                                      04016000
R10      EQU   @10                                                      04017000
R11      EQU   @11                                                      04018000
R13      EQU   @13                                                      04019000
R14      EQU   @14                                                      04020000
R8       EQU   @08                                                      04021000
R9       EQU   @09                                                      04022000
IFCMSG   EQU   0                                                        04023000
PARM     EQU   0                                                        04024000
RECTYPE  EQU   PARM                                                     04025000
SWITCHES EQU   PARM+2                                                   04026000
NOSDR    EQU   SWITCHES                                                 04027000
ZEROALL  EQU   SWITCHES+1                                               04028000
DEBUG    EQU   PARM+4                                                   04029000
DEBUG15  EQU   DEBUG+1                                                  04030000
DEBUGA   EQU   PARM+8                                                   04031000
MISC     EQU   PARM+12                                                  04032000
PRINTES  EQU   MISC                                                     04033000
OPENCLSE EQU   PARM+13                                                  04034000
OPENIO   EQU   OPENCLSE                                                 04035000
OTOURIST EQU   OPENIO                                                   04036000
OEREPPT  EQU   OPENIO                                                   04037000
OSERLOG  EQU   OPENIO                                                   04038000
OACCIN   EQU   OPENIO                                                   04039000
OACCDEV  EQU   OPENIO                                                   04040000
OSYSIN   EQU   OPENIO                                                   04041000
ODRCTWRK EQU   OPENIO                                                   04042000
CLOSEIO  EQU   OPENCLSE+2                                               04043000
CTOURIST EQU   CLOSEIO                                                  04044000
CEREPPT  EQU   CLOSEIO                                                  04045000
CSERLOG  EQU   CLOSEIO                                                  04046000
CACCIN   EQU   CLOSEIO                                                  04047000
CACCDEV  EQU   CLOSEIO                                                  04048000
CSYSIN   EQU   CLOSEIO                                                  04049000
CDRCTWRK EQU   CLOSEIO                                                  04050000
DATENOW  EQU   PARM+17                                                  04051000
STDT     EQU   PARM+23                                                  04052000
STDATE   EQU   STDT                                                     04053000
PSTD     EQU   STDATE+1                                                 04054000
ENDDT    EQU   PARM+31                                                  04055000
ENDDATE  EQU   ENDDT                                                    04056000
PEND     EQU   ENDDATE+1                                                04057000
STTIME1  EQU   PARM+39                                                  04058000
ENDTIME1 EQU   PARM+43                                                  04059000
STTIME2  EQU   PARM+47                                                  04060000
ENDTIME2 EQU   PARM+51                                                  04061000
STRTDATE EQU   PARM+55                                                  04062000
@NM00007 EQU   PARM+75                                                  04063000
ERRID    EQU   PARM+92                                                  04064000
IDTIMEA  EQU   ERRID+6                                                  04065000
IDTIME   EQU   IDTIMEA                                                  04066000
CCHHRLNG EQU   PARM+112                                                 04067000
RECCCHHR EQU   CCHHRLNG                                                 04068000
RECLNGTH EQU   CCHHRLNG+6                                               04069000
LINECT   EQU   PARM+120                                                 04070000
ADIOHND  EQU   PARM+124                                                 04071000
ADIFCMSG EQU   PARM+128                                                 04072000
ADEDITB  EQU   PARM+132                                                 04073000
EVPTR    EQU   PARM+136                                                 04074000
SORTADR  EQU   PARM+140                                                 04075000
PRINTADR EQU   PARM+148                                                 04076000
CUAPTR   EQU   PARM+152                                                 04077000
DEVPTR   EQU   PARM+156                                                 04078000
MODPTR   EQU   PARM+160                                                 04079000
SERPTR   EQU   PARM+164                                                 04080000
VOLPTR   EQU   PARM+168                                                 04081000
CPUPTR   EQU   PARM+172                                                 04082000
CPCUAPTR EQU   PARM+176                                                 04083000
LIBADPTR EQU   PARM+180                                                 04084000
SYMCDPTR EQU   PARM+184                                                 04085000
SYSUMPTR EQU   PARM+188                                                 04086000
TRENPTR  EQU   PARM+192                                                 04087000
SHAREPTR EQU   PARM+196                                                 04088000
MERDCPTR EQU   PARM+208                                                 04089000
DUMPTABL EQU   PARM+228                                                 04090000
DUMPINFO EQU   DUMPTABL+4                                               04091000
TRENDONE EQU   0                                                        04092000
TREGEN   EQU   TRENDONE+8                                               04093000
TRECCH0  EQU   TREGEN+8                                                 04094000
TREND2   EQU   0                                                        04095000
TRENDKEY EQU   TREND2                                                   04096000
TRENDRT  EQU   TRENDKEY+1                                               04097000
TRENCPUS EQU   TRENDKEY+3                                               04098000
TRENDITM EQU   TRENDKEY+4                                               04099000
EVTABLE  EQU   0                                                        04100000
EVSTOP   EQU   EVTABLE                                                  04101000
EVKEY    EQU   EVTABLE+6                                                04102000
SORTABLE EQU   0                                                        04103000
SORTKEY  EQU   SORTABLE                                                 04104000
SORTCCHR EQU   SORTABLE+5                                               04105000
SYSUMONE EQU   0                                                        04106000
SYSUM2   EQU   0                                                        04107000
SYSUMKEY EQU   SYSUM2                                                   04108000
SYSRT    EQU   SYSUMKEY+1                                               04109000
SYSCPUS  EQU   SYSUMKEY+3                                               04110000
SYSITEM  EQU   SYSUMKEY+4                                               04111000
SHARE    EQU   0                                                        04112000
SHAREIO  EQU   SHARE+2                                                  04113000
SHRCUCPU EQU   SHAREIO                                                  04114000
SHARECUA EQU   SHRCUCPU                                                 04115000
EDITLOAD EQU   0                                                        04116000
EDITABLE EQU   EDITLOAD+4                                               04117000
CUA      EQU   0                                                        04118000
CUAVAL   EQU   CUA+2                                                    04119000
DEVICE   EQU   0                                                        04120000
MODELS   EQU   0                                                        04121000
DEVSERAL EQU   0                                                        04122000
VOLUME   EQU   0                                                        04123000
CPUS     EQU   0                                                        04124000
CPUCUAS  EQU   0                                                        04125000
CPUCUAV  EQU   CPUCUAS+2                                                04126000
LIBADR   EQU   0                                                        04127000
SYMCODE  EQU   0                                                        04128000
SYMVAL   EQU   SYMCODE+2                                                04129000
MERIDIAN EQU   0                                                        04130000
NEXTBYTE EQU   0                                                        04131000
ADDNUM   EQU   0                                                        04132000
LISTPTR  EQU   0                                                        04133000
INARG    EQU   0                                                        04134000
IOPLINE  EQU   0                                                        04135000
PRINTDS  EQU   IOPLINE                                                  04136000
PRINTCC  EQU   IOPLINE+1                                                04137000
PRINTBDY EQU   IOPLINE+2                                                04138000
RECTB    EQU   0                                                        04139000
FORPTR   EQU   RECTB                                                    04140000
JUNK     EQU   RECTB+4                                                  04141000
JUNK3    EQU   JUNK+6                                                   04142000
RECSPT   EQU   RECTB+12                                                 04143000
OHEADER  EQU   0                                                        04144000
OHDRREC1 EQU   OHEADER+11                                               04145000
OHDRREC2 EQU   OHEADER+22                                               04146000
RECAREA  EQU   0                                                        04147000
@NM00028 EQU   RECAREA+2                                                04148000
NSSWITCH EQU   @NM00028                                                 04149000
LCSWITCH EQU   @NM00028                                                 04150000
DATETIME EQU   RECAREA+8                                                04151000
DATE     EQU   DATETIME                                                 04152000
DATE0    EQU   DATE                                                     04153000
GMTSW    EQU   DATE0                                                    04154000
YEAR     EQU   DATE+1                                                   04155000
DAYS     EQU   DATE+2                                                   04156000
TIME     EQU   DATETIME+4                                               04157000
HOURS    EQU   TIME                                                     04158000
MINS     EQU   TIME+1                                                   04159000
SECS     EQU   TIME+2                                                   04160000
TNTHS    EQU   TIME+3                                                   04161000
IOHND    EQU   0                                                        04162000
GETTIT   EQU   GETHIS                                                   04163000
EDFLD    EQU   EDIFILD                                                  04164000
CTPTR    EQU   CONTPTR                                                  04165000
BUFFER   EQU   BUF1                                                     04166000
BCOUNT   EQU   BUFFER                                                   04167000
BCCHHR   EQU   BCOUNT                                                   04168000
BSIZE    EQU   BCOUNT+6                                                 04169000
BDATA    EQU   BUFFER+8                                                 04170000
BSZ      EQU   BSIZE                                                    04171000
BBRDW    EQU   BCCHHR+4                                                 04172000
TRECCH   EQU   TRECCH0                                                  04173000
TRKNUM   EQU   MAXTRK                                                   04174000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04175000
BKEYL    EQU   BCOUNT+5                                                 04176000
@NM00032 EQU   DATE0                                                    04177000
@NM00031 EQU   @NM00028                                                 04178000
@NM00030 EQU   @NM00028                                                 04179000
@NM00029 EQU   @NM00028                                                 04180000
@NM00027 EQU   RECAREA+1                                                04181000
RECKEY   EQU   RECAREA                                                  04182000
OHDRSAFE EQU   OHEADER+39                                               04183000
@NM00026 EQU   OHEADER+34                                               04184000
OHDRTYP  EQU   OHEADER+33                                               04185000
OHDREXSZ EQU   OHEADER+31                                               04186000
OHDRUCBN EQU   OHEADER+29                                               04187000
OHDR2R   EQU   OHDRREC2+6                                               04188000
OHDR2HH  EQU   OHDRREC2+4                                               04189000
OHDR2CC  EQU   OHDRREC2+2                                               04190000
OHDR2BB  EQU   OHDRREC2                                                 04191000
OHDRTRXC EQU   OHEADER+20                                               04192000
OHDRREM  EQU   OHEADER+18                                               04193000
OHDR1R   EQU   OHDRREC1+6                                               04194000
OHDR1HH  EQU   OHDRREC1+4                                               04195000
OHDR1CC  EQU   OHDRREC1+2                                               04196000
OHDR1BB  EQU   OHDRREC1                                                 04197000
OHDRHI   EQU   OHEADER+10                                               04198000
OHDREHH  EQU   OHEADER+8                                                04199000
OHDRECC  EQU   OHEADER+6                                                04200000
OHDRSHH  EQU   OHEADER+4                                                04201000
OHDRSCC  EQU   OHEADER+2                                                04202000
OHDRKEY  EQU   OHEADER                                                  04203000
JUNK2    EQU   JUNK+5                                                   04204000
JUNK1    EQU   JUNK                                                     04205000
MODEL    EQU   MERIDIAN+2                                               04206000
MRDNUMBR EQU   MERIDIAN                                                 04207000
SYMVAL2  EQU   SYMVAL+2                                                 04208000
SYMVAL1  EQU   SYMVAL                                                   04209000
SYMCDNUM EQU   SYMCODE                                                  04210000
LIBVAL   EQU   LIBADR+2                                                 04211000
LIBADNUM EQU   LIBADR                                                   04212000
CPUCUX3  EQU   CPUCUAV+5                                                04213000
CPUCUX2  EQU   CPUCUAV+3                                                04214000
CPUCUX1  EQU   CPUCUAV                                                  04215000
CPCUANUM EQU   CPUCUAS                                                  04216000
CPUVAL   EQU   CPUS+2                                                   04217000
CPUNUM   EQU   CPUS                                                     04218000
VOLVAL   EQU   VOLUME+2                                                 04219000
VOLNUM   EQU   VOLUME                                                   04220000
SERVAL   EQU   DEVSERAL+2                                               04221000
SERNUM   EQU   DEVSERAL                                                 04222000
MODVAL   EQU   MODELS+2                                                 04223000
MODNUM   EQU   MODELS                                                   04224000
MDRVAL   EQU   DEVICE+204                                               04225000
MDRNUM   EQU   DEVICE+202                                               04226000
DEVVAL   EQU   DEVICE+2                                                 04227000
DEVNUM   EQU   DEVICE                                                   04228000
CUA2     EQU   CUAVAL+2                                                 04229000
CUA1     EQU   CUAVAL                                                   04230000
CUANUM   EQU   CUA                                                      04231000
LOADPTR  EQU   EDITABLE+8                                               04232000
LOADNAME EQU   EDITABLE                                                 04233000
EDITNUM  EQU   EDITLOAD                                                 04234000
SHARLET  EQU   SHAREIO+10                                               04235000
SHARSERB EQU   SHAREIO+7                                                04236000
SHARECUB EQU   SHAREIO+5                                                04237000
SHARSERA EQU   SHRCUCPU+2                                               04238000
SHAREDX  EQU   SHARECUA                                                 04239000
SHARENUM EQU   SHARE                                                    04240000
SYSTEMP  EQU   SYSUM2+9                                                 04241000
SYSPERM  EQU   SYSUM2+7                                                 04242000
SYSDEV   EQU   SYSUM2+5                                                 04243000
SYSOLDA  EQU   SYSITEM                                                  04244000
SYS3705  EQU   SYSITEM                                                  04245000
SYSOLD   EQU   SYSCPUS                                                  04246000
SYSCPU   EQU   SYSCPUS                                                  04247000
SYSCUA   EQU   SYSRT                                                    04248000
SYSGROUP EQU   SYSUMKEY                                                 04249000
SYSUMEOD EQU   SYSUMONE+96                                              04250000
SYSUMPER EQU   SYSUMONE+92                                              04251000
SYSUMPEA EQU   SYSUMONE+88                                              04252000
SYSUMPEI EQU   SYSUMONE+84                                              04253000
SYSUMCH  EQU   SYSUMONE+20                                              04254000
SYSUMMCN EQU   SYSUMONE+16                                              04255000
SYSUMMCR EQU   SYSUMONE+12                                              04256000
SYSUMNXT EQU   SYSUMONE+8                                               04257000
SYSUMIPL EQU   SYSUMONE+4                                               04258000
SYSUMNUM EQU   SYSUMONE                                                 04259000
SORTCORE EQU   SORTCCHR                                                 04260000
SORTTIME EQU   SORTKEY+1                                                04261000
SORTYEAR EQU   SORTKEY                                                  04262000
EVLETTER EQU   EVKEY+5                                                  04263000
EVSERIAL EQU   EVKEY+2                                                  04264000
EVMODEL  EQU   EVKEY                                                    04265000
EVNUM    EQU   EVTABLE+4                                                04266000
EVDAY    EQU   EVSTOP+1                                                 04267000
EVYEAR   EQU   EVSTOP                                                   04268000
TRETMP   EQU   TREND2+10                                                04269000
TREPRM   EQU   TREND2+8                                                 04270000
TRENDDEV EQU   TREND2+6                                                 04271000
TRENDDAT EQU   TRENDKEY+5                                               04272000
TRENDOD  EQU   TRENDITM                                                 04273000
TREND037 EQU   TRENDITM                                                 04274000
TRENDOLD EQU   TRENCPUS                                                 04275000
TRENDCPU EQU   TRENCPUS                                                 04276000
@NM00011 EQU   TRENDRT+1                                                04277000
TRENDCUA EQU   TRENDRT                                                  04278000
TRENDGRP EQU   TRENDKEY                                                 04279000
TREPRE   EQU   TREGEN+72                                                04280000
TRECCHF  EQU   TREGEN+68                                                04281000
TRECCHE  EQU   TREGEN+64                                                04282000
TRECCHD  EQU   TREGEN+60                                                04283000
TRECCHC  EQU   TREGEN+56                                                04284000
TRECCHB  EQU   TREGEN+52                                                04285000
TRECCHA  EQU   TREGEN+48                                                04286000
TRECCH9  EQU   TREGEN+44                                                04287000
TRECCH8  EQU   TREGEN+40                                                04288000
TRECCH7  EQU   TREGEN+36                                                04289000
TRECCH6  EQU   TREGEN+32                                                04290000
TRECCH5  EQU   TREGEN+28                                                04291000
TRECCH4  EQU   TREGEN+24                                                04292000
TRECCH3  EQU   TREGEN+20                                                04293000
TRECCH2  EQU   TREGEN+16                                                04294000
TRECCH1  EQU   TREGEN+12                                                04295000
TREMCH   EQU   TREGEN+4                                                 04296000
TREIPL   EQU   TREGEN                                                   04297000
TRENUM   EQU   TRENDONE+4                                               04298000
TRENEXT  EQU   TRENDONE                                                 04299000
DUMPSIZE EQU   DUMPINFO+4                                               04300000
DUMPADR  EQU   DUMPINFO                                                 04301000
DUMPNUM  EQU   DUMPTABL                                                 04302000
@NM00010 EQU   PARM+212                                                 04303000
RECLNGT1 EQU   PARM+204                                                 04304000
FRAMEPTR EQU   PARM+200                                                 04305000
ADCPUT   EQU   PARM+144                                                 04306000
@NM00009 EQU   CCHHRLNG+5                                               04307000
USERPGM  EQU   PARM+102                                                 04308000
IDTSEC   EQU   IDTIME+3                                                 04309000
IDSEC    EQU   IDTIME+2                                                 04310000
IDMIN    EQU   IDTIME+1                                                 04311000
IDHOUR   EQU   IDTIME                                                   04312000
IDASID   EQU   ERRID+4                                                  04313000
IDCPU    EQU   ERRID+3                                                  04314000
@NM00008 EQU   ERRID+2                                                  04315000
IDVALUE  EQU   ERRID                                                    04316000
NUMDAYS  EQU   PARM+88                                                  04317000
SORTNUM  EQU   PARM+84                                                  04318000
TABSIZE  EQU   PARM+80                                                  04319000
SYSRETRN EQU   @NM00007                                                 04320000
@NM00006 EQU   PARM+72                                                  04321000
WRTHRSH  EQU   PARM+69                                                  04322000
RDTHRSH  EQU   PARM+66                                                  04323000
TERM     EQU   PARM+58                                                  04324000
EVSDAY   EQU   STRTDATE+1                                               04325000
EVSYEAR  EQU   STRTDATE                                                 04326000
PENSEC2  EQU   ENDTIME2+2                                               04327000
PENMIN2  EQU   ENDTIME2+1                                               04328000
PENHOUR2 EQU   ENDTIME2                                                 04329000
PSTSEC2  EQU   STTIME2+2                                                04330000
PSTMIN2  EQU   STTIME2+1                                                04331000
PSTHOUR2 EQU   STTIME2                                                  04332000
PENSEC1  EQU   ENDTIME1+2                                               04333000
PENMIN1  EQU   ENDTIME1+1                                               04334000
PENHOUR1 EQU   ENDTIME1                                                 04335000
PSTSEC1  EQU   STTIME1+2                                                04336000
PSTMIN1  EQU   STTIME1+1                                                04337000
PSTHOUR1 EQU   STTIME1                                                  04338000
@NM00005 EQU   ENDDT+4                                                  04339000
PENDY    EQU   PEND+1                                                   04340000
PENYR    EQU   PEND                                                     04341000
@NM00004 EQU   ENDDATE                                                  04342000
@NM00003 EQU   STDT+4                                                   04343000
PSTDY    EQU   PSTD+1                                                   04344000
PSTYR    EQU   PSTD                                                     04345000
@NM00002 EQU   STDATE                                                   04346000
YEARNOW  EQU   DATENOW+4                                                04347000
@NM00001 EQU   DATENOW+3                                                04348000
DAYNOW   EQU   DATENOW                                                  04349000
CSNAP    EQU   CLOSEIO                                                  04350000
OSNAP    EQU   OPENIO                                                   04351000
PASSFLAG EQU   MISC                                                     04352000
PLOGREC  EQU   MISC                                                     04353000
ERRORID  EQU   MISC                                                     04354000
PSUM     EQU   PRINTES                                                  04355000
PEDIT    EQU   PRINTES                                                  04356000
PHIST    EQU   MISC                                                     04357000
PACC     EQU   MISC                                                     04358000
PZERO    EQU   MISC                                                     04359000
DEBUG63  EQU   DEBUGA+3                                                 04360000
DEBUG62  EQU   DEBUGA+3                                                 04361000
DEBUG61  EQU   DEBUGA+3                                                 04362000
DEBUG60  EQU   DEBUGA+3                                                 04363000
DEBUG59  EQU   DEBUGA+3                                                 04364000
DEBUG58  EQU   DEBUGA+3                                                 04365000
DEBUG57  EQU   DEBUGA+3                                                 04366000
DEBUG56  EQU   DEBUGA+3                                                 04367000
DEBUG55  EQU   DEBUGA+2                                                 04368000
DEBUG54  EQU   DEBUGA+2                                                 04369000
DEBUG53  EQU   DEBUGA+2                                                 04370000
DEBUG52  EQU   DEBUGA+2                                                 04371000
DEBUG51  EQU   DEBUGA+2                                                 04372000
DEBUG50  EQU   DEBUGA+2                                                 04373000
DEBUG49  EQU   DEBUGA+2                                                 04374000
DEBUG48  EQU   DEBUGA+2                                                 04375000
DEBUG47  EQU   DEBUGA+1                                                 04376000
DEBUG46  EQU   DEBUGA+1                                                 04377000
DEBUG45  EQU   DEBUGA+1                                                 04378000
DEBUG44  EQU   DEBUGA+1                                                 04379000
DEBUG43  EQU   DEBUGA+1                                                 04380000
DEBUG42  EQU   DEBUGA+1                                                 04381000
DEBUG41  EQU   DEBUGA+1                                                 04382000
DEBUG40  EQU   DEBUGA+1                                                 04383000
DEBUG39  EQU   DEBUGA                                                   04384000
DEBUG38  EQU   DEBUGA                                                   04385000
DEBUG37  EQU   DEBUGA                                                   04386000
DEBUG36  EQU   DEBUGA                                                   04387000
DEBUG35  EQU   DEBUGA                                                   04388000
DEBUG34  EQU   DEBUGA                                                   04389000
DEBUG33  EQU   DEBUGA                                                   04390000
DEBUG32  EQU   DEBUGA                                                   04391000
DEBUG31  EQU   DEBUG+3                                                  04392000
DEBUG30  EQU   DEBUG+3                                                  04393000
DEBUG29  EQU   DEBUG+3                                                  04394000
DEBUG28  EQU   DEBUG+3                                                  04395000
DEBUG27  EQU   DEBUG+3                                                  04396000
DEBUG26  EQU   DEBUG+3                                                  04397000
DEBUG25  EQU   DEBUG+3                                                  04398000
DEBUG24  EQU   DEBUG+3                                                  04399000
DEBUG23  EQU   DEBUG+2                                                  04400000
DEBUG22  EQU   DEBUG+2                                                  04401000
DEBUG21  EQU   DEBUG+2                                                  04402000
DEBUG20  EQU   DEBUG+2                                                  04403000
DEBUG19  EQU   DEBUG+2                                                  04404000
DEBUG18  EQU   DEBUG+2                                                  04405000
DEBUG17  EQU   DEBUG+2                                                  04406000
DEBUG16  EQU   DEBUG+2                                                  04407000
DEBUG14  EQU   DEBUG+1                                                  04408000
DEBUG13  EQU   DEBUG+1                                                  04409000
DEBUG12  EQU   DEBUG+1                                                  04410000
DEBUG11  EQU   DEBUG+1                                                  04411000
DEBUG10  EQU   DEBUG+1                                                  04412000
DEBUG9   EQU   DEBUG+1                                                  04413000
DEBUG8   EQU   DEBUG+1                                                  04414000
DEBUG7   EQU   DEBUG                                                    04415000
DEBUG6   EQU   DEBUG                                                    04416000
DEBUG5   EQU   DEBUG                                                    04417000
DEBUG4   EQU   DEBUG                                                    04418000
DEBUG3   EQU   DEBUG                                                    04419000
DEBUG2   EQU   DEBUG                                                    04420000
DEBUG1   EQU   DEBUG                                                    04421000
DEBUG0   EQU   DEBUG                                                    04422000
SORTBRK  EQU   SWITCHES+1                                               04423000
COREFAIL EQU   SWITCHES+1                                               04424000
ANALYSIS EQU   SWITCHES+1                                               04425000
SHIFT3RD EQU   SWITCHES+1                                               04426000
DEVEXCL  EQU   SWITCHES+1                                               04427000
NOTALL   EQU   SWITCHES+1                                               04428000
TIMESEQ  EQU   SWITCHES                                                 04429000
SYSUM    EQU   SWITCHES                                                 04430000
PARMTHR  EQU   SWITCHES                                                 04431000
TREND    EQU   SWITCHES                                                 04432000
SHORTOBR EQU   SWITCHES                                                 04433000
PARMMES  EQU   SWITCHES                                                 04434000
RDESUM   EQU   SWITCHES                                                 04435000
PCCHFRAM EQU   RECTYPE+1                                                04436000
PMCHFRAM EQU   RECTYPE+1                                                04437000
PTTYP    EQU   RECTYPE+1                                                04438000
PEOD     EQU   RECTYPE                                                  04439000
PMIH     EQU   RECTYPE                                                  04440000
PDDR     EQU   RECTYPE                                                  04441000
PIPL     EQU   RECTYPE                                                  04442000
PSOFT    EQU   RECTYPE                                                  04443000
POBR     EQU   RECTYPE                                                  04444000
PCHAN    EQU   RECTYPE                                                  04445000
PMCH     EQU   RECTYPE                                                  04446000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04447000
@RF00172 EQU   @EL00001                                                 04448000
@RF00213 EQU   @RC00211                                                 04449000
@RC00215 EQU   @RC00211                                                 04450000
@RC00232 EQU   @RC00211                                                 04451000
@RC00209 EQU   @EL00003                                                 04452000
@RC00283 EQU   @EL00004                                                 04453000
@RF00330 EQU   @EL00005                                                 04454000
@RT00366 EQU   HDRERR0                                                  04455000
@RT00368 EQU   HDRERR1                                                  04456000
@RT00413 EQU   CHK03                                                    04457000
@RT00415 EQU   CHK04                                                    04458000
@RT00445 EQU   @EL00008                                                 04459000
@RT00448 EQU   CONVNS                                                   04460000
@RT00471 EQU   CONVBINB                                                 04461000
@RF00473 EQU   CONVBINA                                                 04462000
@RF00571 EQU   @EL00009                                                 04463000
@RF00593 EQU   @EL00010                                                 04464000
@RF00624 EQU   @RC00618                                                 04465000
@RC00602 EQU   @EL00011                                                 04466000
@RF00644 EQU   @EL00011                                                 04467000
@RC00725 EQU   @EL00014                                                 04468000
@RC00749 EQU   @EL00015                                                 04469000
@RC00766 EQU   @EL00015                                                 04470000
@RC00794 EQU   @EL00016                                                 04471000
@RC00813 EQU   @EL00017                                                 04472000
@RF00824 EQU   @EL00017                                                 04473000
@RC00835 EQU   @EL00018                                                 04474000
@RC00849 EQU   @EL00019                                                 04475000
@RC00871 EQU   @EL00020                                                 04476000
@RC00890 EQU   @EL00021                                                 04477000
@RC00897 EQU   @EL00022                                                 04478000
@RF00920 EQU   @EL00022                                                 04479000
@RC00931 EQU   @EL00023                                                 04480000
@RC00934 EQU   @EL00023                                                 04481000
@RC00958 EQU   @EL00025                                                 04482000
@RC00981 EQU   @EL00026                                                 04483000
@RC01008 EQU   @EL00027                                                 04484000
@RF01021 EQU   @EL00027                                                 04485000
@RC01032 EQU   @EL00028                                                 04486000
@RF01045 EQU   @EL00028                                                 04487000
@RC01056 EQU   @EL00029                                                 04488000
@RC01074 EQU   @EL00030                                                 04489000
@RF01100 EQU   @EL00030                                                 04490000
@RC01110 EQU   @EL00031                                                 04491000
@RC01129 EQU   @EL00032                                                 04492000
@RF01140 EQU   @EL00032                                                 04493000
@RC01151 EQU   @EL00033                                                 04494000
@RC01173 EQU   @EL00034                                                 04495000
@RF00219 EQU   @RC00215                                                 04496000
@RF00251 EQU   @RC00209                                                 04497000
@RC00255 EQU   @RC00209                                                 04498000
@RF00735 EQU   @RC00725                                                 04499000
@RC00751 EQU   @RC00749                                                 04500000
@RF00776 EQU   @RC00766                                                 04501000
@RC00899 EQU   @RC00897                                                 04502000
@ENDDATA EQU   *                                                        04503000
         END   IFCIOHND,(C'PLS2213',0701,78012)                         04504000
