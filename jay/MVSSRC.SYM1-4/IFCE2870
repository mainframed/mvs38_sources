         TITLE 'IFCE2870 - EDIT TABLE - LINKNAME=IFCE2870'              00060020
         TITLE 'IFCE2870 - EDIT TABLE - LINKNAME=IFCE2870'              00120020
         TITLE '****  2870 CHANNEL EDIT  ****'                          00180020
         MACRO                                                          00240002
&NAME    DSGEN ,                                                        00260002
.*                            THIS MACRO GENERATES ONE DSECT WORD       00280002
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00300002
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  00320002
.*                                 FIRST IS THE NAME OF THE LOG ITEM    00340002
.*                                 WHILE THE SECOND IS THE # OF BITS TO 00360002
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   00380002
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 00400002
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      00420002
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  00440002
.*                                 THE LOG ITEMS MAY THEN BE USED IN    00460002
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   00480002
         GBLC &ITEM(1500)                                      @YM2954P 00500002
         GBLA &ITEMNBR,&BITS(1500),&SHIFT(1500)                @YM2954P 00520002
         LCLB  &ONLY1,&CTIND                                   @YM2954P 00540002
         LCLA  &START1,&START2,&END1,&END2                     @YM2954P 00560002
         LCLC  &SYMBOL,&EQUSYM                                 @YM2954P 00580002
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                        @YM2954P 00600002
         ACTR  100000                                          @YM2954P 00620002
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                   @YM2954P 00640002
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     00660002
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   00680002
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        00700002
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1   @YM2954P 00720002
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT    @YM2954P 00740002
         AGO   .SET2A                   BRANCH AROUND          @YM2954P 00760002
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'     @YM2954P 00780002
         MEXIT                                                 @YM2954P 00800002
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X00820002
               ).SET2                   TEST FOR NO SECOND     @YM2954P 00840002
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   00860002
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        00880002
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2   @YM2954P 00900002
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2     @YM2954P 00920002
         AGO   .LOOP                                           @YM2954P 00940002
.SET2    ANOP                                                  @YM2954P 00960002
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 00980002
         AGO   .LOOP                                           @YM2954P 01000002
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'    @YM2954P 01020002
         MEXIT                                                 @YM2954P 01040002
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'      @YM2954P 01060002
         MEXIT                                                 @YM2954P 01080002
.LOOP    ANOP                                                  @YM2954P 01100002
&OP      SETA  &OP+1                                           @YM2954P 01120002
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE  @YM2954P 01140002
&ITEMNBR SETA  &ITEMNBR+1                                      @YM2954P 01160002
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                   @YM2954P 01180002
         MNOTE '**NULL BIT COUNT FIELD**'                      @YM2954P 01200002
         MEXIT                                                 @YM2954P 01220002
.OK1     ANOP                                                  @YM2954P 01240002
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                               @YM2954P 01260002
         AIF   ('&SYMBOL' NE '').OK                            @YM2954P 01280002
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         01300002
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                @YM2954P 01320002
         AGO   .START                   GET NEXT               @YM2954P 01340002
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        01360002
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU @YM2954P 01380002
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        01400002
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         01420002
         AGO   .NO3                     BRANCH AROUND          @YM2954P 01440002
.OK2     ANOP                                                  @YM2954P 01460002
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED     @YM2954P 01480002
.NO3     ANOP                                                  @YM2954P 01500002
&SYMBOL  EQU   *+&BYTE                                         @YM2954P 01520002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL    @YM2954P 01540002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                           @YM2954P 01560002
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                           @YM2954P 01580002
.CNT     ANOP                                                  @YM2954P 01600002
&CTIND   SETB  1                        SET COUNT INDICATOR    @YM2954P 01620002
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                          @YM2954P 01640002
&BYTE    SETA  &COUNT/8                                        @YM2954P 01660002
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        01680002
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        01700002
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END    @YM2954P 01720002
&END1    SETA  &END1+1                  INCREMENT COUNT        @YM2954P 01740002
&OP      SETA  &OP-1                    DECREMENT INCREMENT    @YM2954P 01760002
         AGO   .LOOP                    GENERATE NEXT          @YM2954P 01780002
.TSTST   ANOP                                                  @YM2954P 01800002
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END      @YM2954P 01820002
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        01840002
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      01860002
.NSET1   ANOP                                                  @YM2954P 01880002
&OP      SETA  &OP-1                    DECREMENT INDEX        @YM2954P 01900002
&START1  SETA  &START1+1                INCREMENT FIRST COUNT  @YM2954P 01920002
         AGO   .LOOP                    GO DO NEXT             @YM2954P 01940002
.LPDONE  ANOP                                                  @YM2954P 01960002
&ONLY1   SETB  0                        CLEAR INDICATOR        @YM2954P 01980002
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      02000002
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 02020002
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT      @YM2954P 02040002
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES    @YM2954P 02060002
&NAME    DS    &COUNT.C                                        @YM2954P 02080002
.END     MEXIT                                                 @YM2954P 02100002
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**' @YM2954P 02120002
         MEXIT                                                 @YM2954P 02140002
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   02160002
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'          @YM2954P 02180002
         MEXIT                                                 @YM2954P 02200002
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         02220002
*****               THE FOLLOWING STATEMENT                *****        02240002
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        02260002
.EQU2    ANOP                                                  @YM2954P 02280002
&EQUCNT  SETA  0                        CLEAR COUNTER          @YM2954P 02300002
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND        @YM2954P 02320002
.EQULOP  ANOP                                                  @YM2954P 02340002
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX        @YM2954P 02360002
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     02380002
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?       @YM2954P 02400002
         AGO   .EQULOP                  NO-GET NEXT            @YM2954P 02420002
.EQUOUT  ANOP                                                  @YM2954P 02440002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME         @YM2954P 02460002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS     @YM2954P 02480002
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT        @YM2954P 02500002
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED    @YM2954P 02520002
         AGO   .START                   RETURN FOR NEXT        @YM2954P 02540002
         MEND                                                  @YM2954P 02560002
         EJECT                                                          03240020
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 03300020
         SPACE 2                                                        03360020
         MACRO                                                          03420020
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      03480020
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     03540020
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    03600020
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 03660020
.*                                 ENTRIES. LASTLY IT DETERMINES THE    03720020
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    03780020
.*                                 THE PREVIOUS LINE AND STORES THAT #  03840020
.*                                 INTO THE APPROPRIATE BYTE.           03900020
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    03960020
.*                                 DATA.                                04020020
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 04080020
.*                                 DATA COLUMN STARTING CHARACTERS.     04140020
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   04200020
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 04260020
.*                                 STARTING CHARACTERS.                 04320020
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   04380020
.*                                 TO BEGIN NEXT PRINTED LINE.          04440020
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       04500020
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   04560020
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 04620020
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   04680020
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 04740020
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    04800020
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   04860020
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   04920020
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  04980020
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   05040020
.*                                 THE SUBJECT LINE                     05100020
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  05160020
         GBLA  &LASTCC,&INITIAL                                         05220020
         GBLC  &NRENTSX                                                 05280020
         GBLC  &CARRCON                                                 05340020
         GBLB  &TEST                                                    05400020
         LCLA  &S                                                       05460020
&NAME    DS    0C                                                       05520020
         AIF   (&INITIAL EQ 0).FIRSTLN                                  05580020
         LINEND                                                         05640020
         AGO   .NTFIRST                                                 05700020
.FIRSTLN ANOP                                                           05760020
&NRENTSX SETC  'N&SYSNDX'                                               05820020
&INITIAL SETA  1                                                        05880020
N&SYSNDX EQU   *                                                        05940020
.NTFIRST ANOP                                                           06000020
         DC    AL1(0)                                                   06060020
         AIF   ('&DATA(1)' EQ '').CKDTABS                               06120020
         AIF   (&DATA(1) EQ &DB).CKDTABS                                06180020
&DB      SETA  &DATA(1)                                                 06240020
         AGO   .AA                                                      06300020
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                06360020
         AIF   (&DATA(2) EQ &DT).NCDATA                                 06420020
         AGO   .CC                                                      06480020
.AA      AIF   ('&DATA(2)' EQ '').BB                                    06540020
         AIF   (&DATA(2) EQ &DT).BB                                     06600020
.CC      ANOP                                                           06660020
&DT      SETA  &DATA(2)                                                 06720020
.BB      DC    XL2'FFFE'                                                06780020
         DC    FL1'&DB'                                                 06840020
         DC    FL1'&DT'                                                 06900020
&NRENTS  SETA  &NRENTS+1                                                06960020
.NCDATA  ANOP                                                           07020020
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              07080020
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               07140020
&LB      SETA  &LABEL(1)                                                07200020
         AGO   .AAA                                                     07260020
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              07320020
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               07380020
         AGO   .CCC                                                     07440020
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  07500020
         AIF   (&LABEL(2) EQ &LT).BBB                                   07560020
.CCC     ANOP                                                           07620020
&LT      SETA  &LABEL(2)                                                07680020
.BBB     DC    XL2'FFFF'                                                07740020
         DC    FL1'&LB'                                                 07800020
         DC    FL1'&LT'                                                 07860020
&NRENTS  SETA  &NRENTS+1                                                07920020
.NCLABEL ANOP                                                           07980020
         AIF   ('&SKIP' NE '').CONT                                     08040020
         AIF   (&TEST EQ 0).NOCHANG                                     08100020
&S       SETA  &LASTCC                                                  08160020
         AGO   .DEFAULT                                                 08220020
.CONT    ANOP                                                           08280020
         AIF   (&TEST EQ 0).AB                                          08340020
&S       SETA  &SKIP                                                    08400020
.DEFAULT ANOP                                                           08460020
         ORG   &CARRCON+3                                               08520020
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 08580020
         ORG                                                            08640020
&LASTCC  SETA  &S                                                       08700020
&TEST    SETB  0                                                        08760020
         AGO   .DD                                                      08820020
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               08880020
A&SYSNDX DC    XL2'FFFB'                                                08940020
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              09000020
         DC    FL1'9'                                                   09060020
&LASTCC  SETA  &SKIP                                                    09120020
&TEST    SETB  1                                                        09180020
&CARRCON SETC  'A&SYSNDX'                                               09240020
&NRENTS  SETA  &NRENTS+1                                                09300020
.DD      ANOP                                                           09360020
.NOCHANG ANOP                                                           09420020
         MEND                                                           09480020
         EJECT                                                          09540020
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 09600020
         SPACE 2                                                        09660020
         MACRO                                                          09720020
         BIN   &LOGITEM,&SKIP$OR                                        09780020
.*                                 &LOGITEM - NAME OF ITEM IN LOG       09840020
.*                                      RECORD DSECT                    09900020
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  09960020
.*                                 MULTIPLE PRINT OR NBR OF SPACES      10020020
.*                                      TO BACK UP FROM COLUMN FOR      10080020
.*                                      START OF PRINTING. THE LETTER   10140020
.*                                      B PRECEEDS THE NUMBER (B5) IF   10200020
.*                                      THE LATTER IS DESIRED. OMISSION 10260020
.*                                      OF THIS OPERAND FORCES OPTION 2 10320020
.*                                      WITH BACKUP SPACING EQUAL TO    10380020
.*                                 THE NUMBER OF BITS IN THE ITEM       10440020
.*                                 DEFINITION (VIA MACRO 'DSGEN').      10500020
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     10560020
.*                                 TOTAL NUMBER OF BITS TO PRINT.       10620020
         GBLC  &ITEM(1500)                                              10680020
         GBLA  &ITEMNBR,&BITS(1500),&SHIFT(1500),&NRENTS                10740020
         GBLC  &DSECT                                                   10800020
         LCLB  &B                                                       10860020
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   10920020
         LCLA  &TEMP                                                    10980020
         LCLC  &S                                                       11040020
.LOOP    ANOP                                                           11100020
&NDX     SETA  &NDX+1                                                   11160020
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      11220020
         AIF   (&NDX LT &ITEMNBR).LOOP                                  11280020
         MNOTE *,'YOU BLEW IT'                                          11340020
         ROUTINE DUM,SKIPPER                                            11400020
         MEXIT                                                          11460020
.FOUND   ANOP                                                           11520020
&ISHIFT  SETA  &SHIFT(&NDX)                                             11580020
&IBITS   SETA  &BITS(&NDX)                                              11640020
&S       SETC  '&IBITS'                                                 11700020
&B       SETB  1                                                        11760020
         AIF   ('&SKIP$OR' EQ '').BACKUP                                11820020
&K       SETA  K'&SKIP$OR                                               11880020
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 11940020
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   12000020
.BACKUP  ANOP                                                           12060020
&NRENTS  SETA  &NRENTS+1                                                12120020
&TEMP    SETA  &ISHIFT+1                                                12180020
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       12240020
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              12300020
         ORG   A&SYSNDX                                                 12360020
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           12420020
         DC    BL.1'&B',AL.7(&S),AL.4(&IBITS),FL.4'&ISHIFT'             12480020
.OUT     ANOP                                                           12540020
         MEND                                                           12600020
         EJECT                                                          12660020
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 12720020
         SPACE 2                                                        12780020
         MACRO                                                 @YL02021 12840002
         HEX   ,                                               @YL02021 12870002
.*                            THIS MACRO FACILITATES GENERATION OF THE  12900002
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    12930002
.*                                 CONVERSIONS.                @YL02021 12960002
.*                            &SYSLIST(&OP,1) - NAME OF DATA ITEM TO BE 12990002
.*                                 CONVERTED                   @YL02021 13020002
.*                            &SYSLIST(&OP,2) - # OF SPACES TO SKIP ON  13050002
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   13080002
.*                                 BACK UP FROM COLUMN FOR START OF     13110002
.*                                 PRINTING. THE LETTER B PRECEEDS THE  13140002
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  13170002
.*                                 DESIRED. OMISSION OF THIS OPERAND    13200002
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  13230002
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  13260002
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 13290002
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    13320002
.*                                 IMPLICITLY B).              @YL02021 13350002
.*                            &SYSLIST(&OP,3) - NUMBER OF BYTES TO      13380002
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     13410002
.*                                 WITH AN L,R, OR B TO STIPULATE       13440002
.*                                 PRINTING OF THE LEFT HALF, RIGHT     13470002
.*                                 HALF, OR BOTH HALVES OF THE BYTE     13500002
.*                                 RESPECTIVELY. OMISSION OF THIS       13530002
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  13560002
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 13590002
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 13620002
.*                                 SARY. THIS MACRO MUST BE THE FIRST   13650002
.*                                 MACRO INSTRUCTION ISSUED FOR THE     13680002
.*                                 SUBJECT LINE(S).            @YL02021 13710002
         GBLC &ITEM(1500),&DSECT                               @YL02021 13740002
         GBLA &ITEMNBR,&BITS(1500),&SHIFT(1500),&NRENTS        @YL02021 13770002
         GBLA  &INITIAL                                        @YL02021 13800002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                      @YL02021 13830002
         LCLB  &B,&SUB                                         @YL02021 13860002
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP,&OP     @YL02021 13890002
         LCLC  &S,&LETTER                                      @YL02021 13920002
         AIF   (&DIAGTST EQ 0).NOMSG                           @YL02021 13950002
         AIF   (&INITIAL EQ 0).NOMSG                           @YL02021 13980002
         AIF   (&DIAGLIN EQ 1).NOMSG                           @YL02021 14010002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'         @YL02021 14040002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****            @YL02021 14070002
*        LINE                                                  @YL02021 14100002
         LINE                                                  @YL02021 14130002
.NOMSG   ANOP                                                  @YL02021 14160002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP         @YL02021 14190002
&SUB     SETB  1                                               @YL02021 14220002
.LOOP    ANOP                                                  @YL02021 14250002
&OP      SETA  &OP+1                                           @YL02021 14280002
.LOOP1   ANOP                                                  @YL02021 14310002
&NDX     SETA  &NDX+1                                          @YL02021 14340002
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND      @YL02021 14370002
         AIF   (&NDX LT &ITEMNBR).LOOP1                        @YL02021 14400002
         MNOTE '**LOG ITEM NOT DEFINED**'                      @YL02021 14430002
         MEXIT                                                 @YL02021 14460002
.FOUND   ANOP                                                  @YL02021 14490002
&ISHIFT  SETA  &SHIFT(&NDX)                                    @YL02021 14520002
&IBITS   SETA  &BITS(&NDX)                                     @YL02021 14550002
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).ALIGN            @YL02021 14580002
.ERR     MNOTE '**DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY**' @YL02021 14610002
         MEXIT                                                 @YL02021 14640002
.ALIGN   ANOP                                                  @YL02021 14670002
&CODE    SETA  1                                               @YL02021 14700002
         AIF   (&SUB EQ 1).SUBA                                @YL02021 14730002
&K       SETA  K'&SYSLIST(3)                                   @YL02021 14760002
         AGO   .SUBB                                           @YL02021 14790002
.SUBA    ANOP                                                  @YL02021 14820002
&K       SETA  K'&SYSLIST(&OP,3)                               @YL02021 14850002
.SUBB    ANOP                                                  @YL02021 14880002
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                   @YL02021 14910002
         MNOTE '**BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL**' 14940002
         MEXIT                                                 @YL02021 14970002
.OK      AIF   (&SUB EQ 1).SUBC                                @YL02021 15000002
         AIF   ('&SYSLIST(3)' EQ '').USEDEFN                   @YL02021 15030002
&LETTER  SETC  '&SYSLIST(3)'(&K,1)                             @YL02021 15060002
&S       SETC  '&SYSLIST(3)'(1,&K-1)                           @YL02021 15090002
         AGO   .SUBD                                           @YL02021 15120002
.SUBC    ANOP                                                  @YL02021 15150002
         AIF   ('&SYSLIST(&OP,3)' EQ '').USEDEFN               @YL02021 15180002
&LETTER  SETC  '&SYSLIST(&OP,3)'(&K,1)                         @YL02021 15210002
&S       SETC  '&SYSLIST(&OP,3)'(1,&K-1)                       @YL02021 15240002
.SUBD    ANOP                                                  @YL02021 15270002
&BYTESP  SETA  &S                                              @YL02021 15300002
         AIF   ('&LETTER' EQ 'B').BOTH                         @YL02021 15330002
         AIF   ('&LETTER' EQ 'L').LEFT                         @YL02021 15360002
&CODE    SETA  2                                               @YL02021 15390002
         AGO   .L                                              @YL02021 15420002
.LEFT    ANOP                                                  @YL02021 15450002
&CODE    SETA  1                                               @YL02021 15480002
         AGO   .L                                              @YL02021 15510002
.USEDEFN ANOP                                                  @YL02021 15540002
&BYTESP  SETA  &IBITS/8                                        @YL02021 15570002
.BOTH    AIF   (&ISHIFT NE 0).ERR                              @YL02021 15600002
&CODE    SETA  3                                               @YL02021 15630002
&T       SETA  &BYTESP*2-1                                     @YL02021 15660002
&S       SETC  '&T'                                            @YL02021 15690002
.OK2     AIF   (&ISHIFT EQ 0).L                                @YL02021 15720002
&CODE    SETA  2                                               @YL02021 15750002
.L       ANOP                                                  @YL02021 15780002
&B       SETB  1                                               @YL02021 15810002
         AIF   (&SUB EQ 1).SUBE                                @YL02021 15840002
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                    @YL02021 15870002
&K       SETA  K'&SYSLIST(2)                                   @YL02021 15900002
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                     @YL02021 15930002
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                       @YL02021 15960002
         AGO   .SUBF                                           @YL02021 15990002
.SUBE    ANOP                                                  @YL02021 16020002
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                @YL02021 16050002
&K       SETA  K'&SYSLIST(&OP,2)                               @YL02021 16080002
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                 @YL02021 16110002
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                   @YL02021 16140002
.SUBF    ANOP                                                  @YL02021 16170002
.BACKUP  ANOP                                                  @YL02021 16200002
&NRENTS  SETA  &NRENTS+1                                       @YL02021 16230002
         AIF   (&BYTESP GT 0 AND &BYTESP LT 16).SUB0           @YL02021 16260002
         MNOTE '**NO. OF BYTES OUTSIDE RANGE OF 1-15**'        @YL02021 16290002
         MEXIT                                                 @YL02021 16320002
.SUB0    AIF   (&SUB EQ 1).SUBG                                @YL02021 16350002
         DC    AL.12(&SYSLIST(1)-&DSECT),XL.4'A'               @YL02021 16380002
         AGO   .SUBH                                           @YL02021 16410002
.SUBG    ANOP                                                  @YL02021 16440002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'A'           @YL02021 16470002
.SUBH    ANOP                                                  @YL02021 16500002
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'     @YL02021 16530002
.OUT     ANOP                                                  @YL02021 16560002
&NDX     SETA  0                                               @YL02021 16590002
         AIF   (&SUB EQ 0).OUTA                                @YL02021 16620002
         AIF   (&OP LT N'&SYSLIST).LOOP                        @YL02021 16650002
.OUTA    ANOP                                                  @YL02021 16680002
         MEND                                                  @YL02021 16710002
         EJECT                                                          17460020
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 17520020
         SPACE 2                                                        17580020
         MACRO                                                          17640020
&NAME    ROUTINE &LOGITEM,&RNAME                                        17700020
         GBLC  &DSECT,&CSECT                                            17760020
         GBLC  &ITEM(1500)                                              17820020
         GBLA  &SHIFT(1500),&ITEMNBR                                    17880020
         GBLA  &NRENTS                                                  17940020
         LCLA  &ISHIFT,&NDX                                             18000020
.LOOP    ANOP                                                           18060020
&NDX     SETA  &NDX+1                                                   18120020
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      18180020
         AIF   (&NDX LT &ITEMNBR).LOOP                                  18240020
         MNOTE *,'LOG ITEM NOT DEFINED'                                 18300020
         MEXIT                                                          18360020
.FOUND   ANOP                                                           18420020
&ISHIFT  SETA  &SHIFT(&NDX)                                             18480020
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           18540020
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       18600020
&NRENTS  SETA  &NRENTS+1                                                18660020
         MEND                                                           18720020
         EJECT                                                          18780020
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 18840020
         SPACE 2                                                        18900020
         MACRO                                                          18960020
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C19020020
               &LABEL7,&LABEL8                                          19080020
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    19140020
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   19200020
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  19260020
.*                                 TION MARKS. THE COLUMN AND LINE END  19320020
.*                                 CONTROLS WILL BE INSERTED BY THE     19380020
.*                                 MACRO. OMITTED OPERANDS MEAN NO      19440020
.*                                 LABEL REQUIRED FOR RESPECTIVE        19500020
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   19560020
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  19620020
.*                                 TABLE MUST BE BROKEN IF NECESSARY    19680020
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 19740020
         GBLC &LABELS(2000)                                             19800020
         GBLC  &LBL(100)                                                19860020
         GBLA  &LBLCTR(100)                                             19920020
         GBLA  &LABELNR                                                 19980020
         GBLA  &NRENTS,&LPTR                                            20040020
         LCLC  &MARGIN,&TACK                                            20100020
         LCLC  &TEXT                                                    20160020
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            20220020
&MARGIN  SETC  '*'                                                      20280020
         AIF   ('&NAME' EQ '').LOOPOUT                                  20340020
&LPTR    SETA  &LPTR+1                                                  20400020
&LBL(&LPTR) SETC '&NAME'                                                20460020
&LBLCTR(&LPTR) SETA &LABELNR+1                                          20520020
.LOOPOUT ANOP                                                           20580020
&OP      SETA  &OP+1                                                    20640020
&K       SETA  K'&SYSLIST(&OP)                                          20700020
         AIF (&K GE 2).NORM                                             20760020
&K       SETA  2                                                        20820020
.NORM    ANOP                                                           20880020
&START   SETA  2                                                        20940020
         AIF (&OP LT N'&SYSLIST).NOTLAST                                21000020
&MARGIN  SETC  '$'                                                      21060020
.NOTLAST ANOP                                                           21120020
&NRCHAR  SETA  8                                                        21180020
&TACK    SETC  ''                                                       21240020
.LOOPIN  ANOP                                                           21300020
&REMAIN  SETA  &K-&START                                                21360020
         AIF (&REMAIN GE 8).MORE                                        21420020
&TACK    SETC  '&MARGIN'                                                21480020
&NRCHAR  SETA  &REMAIN                                                  21540020
.MORE    ANOP                                                           21600020
&TEXT    SETC  ''                                                       21660020
         AIF (&REMAIN EQ 0).ENDTEXT                                     21720020
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          21780020
.ENDTEXT ANOP                                                           21840020
&LABELNR SETA  &LABELNR+1                                               21900020
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  21960020
&START   SETA  &START+8                                                 22020020
         AIF ('&TACK' EQ '').LOOPIN                                     22080020
         AIF ('&TACK' EQ '*').LOOPOUT                                   22140020
         MEND                                                           22200020
         SPACE 2                                                        22260020
         MACRO                                                          22320020
         LSTART                                                         22380020
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  22440020
.*                                 OF THE TABLE IS TO BEGIN.            22500020
         GBLC &LABELS(2000)                                             22560020
         GBLA  &LABELNR                                                 22620020
         GBLC  &LBL(100)                                                22680020
         GBLA  &LBLCTR(100)                                             22740020
         LCLA  &NDX,&CTR                                                22800020
         LINEND                                                         22860020
&CTR     SETA  1                                                        22920020
.LOOP    ANOP                                                           22980020
&NDX     SETA  &NDX+1                                                   23040020
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            23100020
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         23160020
&CTR     SETA  &CTR+1                                                   23220020
         AGO   .LOOPCTL                                                 23280020
.NOLBL   ANOP                                                           23340020
         DC    C'&LABELS(&NDX)'                                         23400020
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  23460020
         MEND                                                           23520020
         SPACE 2                                                        23580020
         MACRO                                                          23640020
         LINEND                                                         23700020
.*                            THIS MACRO IS USED ONLY BY THE LINE       23760020
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   23820020
.*                                 ASSOCIATED WITH EACH LINE.           23880020
         GBLA  &NRENTS                                                  23940020
         GBLC &NRENTSX                                                  24000020
         ORG   &NRENTSX                                                 24060020
         DC    FL1'&NRENTS'                                             24120020
         ORG                                                            24180020
&NRENTS  SETA  0                                                        24240020
B&SYSNDX EQU   *                                                        24300020
&NRENTSX SETC  'B&SYSNDX'                                               24360020
         MEND                                                           24420020
         SPACE 2                                                        24480020
         MACRO                                                          24540020
         PARITY &ENTRY,&REPEAT,&SPACES,&PBITS=,&DISP=,&OFFBYTE=         24600020
         GBLC  &ITEM(1500),&DSECT                                       24660020
         GBLA  &SHIFT(1500),&ITEMNBR                                    24720020
         LCLA  &IBITS,&NDX,&ISHIFT                                      24780020
         DC    AL4(&ENTRY)                                              24840020
         DC    AL1(&REPEAT)                                             24900020
         DC    AL1(&SPACES)                                             24960020
         AIF   ('&PBITS' EQ '').HARDCD                                  25020020
.LOOP    ANOP                                                           25080020
&NDX     SETA  &NDX+1                                                   25140020
         AIF   ('&ITEM(&NDX)' EQ '&PBITS').FOUND                        25200020
         AIF   (&NDX LT &ITEMNBR).LOOP                                  25260020
         MNOTE *,'PARITY GROUP NOT FOUND'                               25320020
         MEXIT                                                          25380020
.FOUND   ANOP                                                           25440020
&ISHIFT  SETA  &SHIFT(&NDX)                                             25500020
         DC    AL.12(&PBITS-&DSECT),AL.4(&ISHIFT)                       25560020
         AGO   .OUT                                                     25620020
.HARDCD  ANOP                                                           25680020
&ISHIFT  SETA  &OFFBYTE                                                 25740020
         DC    AL.12(&DISP),AL.4(&ISHIFT)                               25800020
.OUT     ANOP                                                           25860020
         MEND                                                           25920020
         GBLC  &DSECT,&CSECT                                            25980020
&CSECT   SETC  'IFCE2870'                                               26040020
&DSECT   SETC  'C2870'                                                  26100020
IFCE2870 CSECT                                                          26160020
C2870    DSECT                                                          26220020
DUM      EQU   *                                                        26280020
         DSGEN (XKEY,8),(XRELN,8),(XSWS8,9),(XSWS9,1),(XSWS10,1),      C26320002
               (XSWS11,1),                                             C26360002
               (XSWS12,1),(XSWS13,1),(XSWS14,1),(XSWS15,1)              26400020
         DSGEN (XDUM1,13),(XCRH,1),(XDUM3,18)                  @Z30CIMC 26460002
         DSGEN (XDATE,32)                                               26520020
         DSGEN (XTIME,32)                                               26580020
         DSGEN (XDUM2,8),(XSER,24)                                      26640020
         DSGEN (XMOD,16),(MCEL,16)                                      26700020
         DSGEN (XJOBN,64)                                               26760020
         DSGEN (XAIO1,16),(XAIO2,16),(XAIO3,16),(XAIO4,16)              26820020
         DSGEN (XAIO5,16),(XAIO6,16),(XAIO7,16),(XAIO8,16)              26880020
         DSGEN (XFCCWCC,8),(XFCCWDA,24),(XFCCWFL,8),(XFCCW0,8),        C26940020
               (XFCCWCT,16)                                             27000020
         DSGEN (XCSWK,8),(XCSWCA,24)                                    27060020
         DSGEN (XCSWUS0,1),(XCSWUS1,1),(XCSWUS2,1),(XCSWUS3,1),        *27120020
               (XCSWUS4,1),(XCSWUS5,1),(XCSWUS6,1),(XCSWUS7,1),        *27180020
               (XCSWCS0,1),(XCSWCS1,1),(XCSWCS2,1),(XCSWCS3,1),        *27240020
               (XCSWCS4,1),(XCSWCS5,1),(XCSWCS6,1),(XCSWCS7,1),        *27300020
               (XCSWCT,16)                                              27360020
         DSGEN (XECSW,32)                                               27420020
         DSGEN (XDEVT1,16),(XDEVT2,16)                                  27480020
         DSGEN (XCHID,8),(XCUA,24)                                      27540020
         DSGEN (XMPIN,32)                                               27600020
         ORG   XMPIN                                           @YL02021 27620002
         DSGEN (VCUA,16),(VLGSZ,16)                            @YL02021 27640002
MPX01    DSGEN (MPXKEYW1,4),(MPXILEN,1),(MPXHLTBT,1),(MPXOPCOD,2),     X27660020
               (MPXDADR,24)                                             27720020
         SPACE 2                                                        27780020
MPX01A   DSGEN (MPXFLAGS,7),(MPXPREF,1),(MPXDAPC,1),                   X27840020
               (MPXCNCK,1),(MPXPECK,1),(MPXPROCK,1),(MPXDTACK,1),      X27900020
               (MPXBTCT,1),(MPXCNTPO,1),(MPXCNT7,1),(MPXBYCNT,16)       27960020
         SPACE 2                                                        28020020
MPX02    DSGEN (MPXKEYW2,4),(DUM70,4),(MPXCOMAD,24)                     28080020
         SPACE 2                                                        28140020
MPX02A   DSGEN (MPXUCWP,8),(MPXCMAD,24)                                 28200020
         SPACE 2                                                        28260020
MPX03    DSGEN (MPXCAW,1),(MPXCCWR,1),(MPXCCWIN,1),(MPXDTARQ,1),       X28320020
               (MPXGOIO,1),(MPXTSTIO,1),(MPXHLTIO,1),(MPXPSIO,1),      X28380020
               (MPXMOD1,1),(MPXMOD2,1),(MPXMOD3,1),(MPXMOD4,1),        X28440020
               (DUM71,1),(MPXMOD6,1),(MPXMOD7,1),(DUM72,1),(MPXMOD9,1),X28500020
               (MPXMOD10,1),(MPXMOD11,1),(DUM73,1),(MPXMCBCP,1),       X28560020
               (MPXCNLAD,3),(MPXUNAD,8)                                 28620020
         SPACE 2                                                        28680020
MPX03A   DSGEN (SELRST,1),(,2),(DISIN,1),(W3UCWCK,1),(,2),(MPXSECCK,1),X28740002
               (MPXW0UCB,1),(MPXW2UCB,1),(MPXLSA,1),(MPXSTOR,1),       X28800020
               (MPXCBTCT,1),(MPXTOUT,1),(MPXPRI,1),(DUM75,1),          X28860020
               (MPXUADCK,1),(MPXCOMCK,1),(MPXBYCTC,1),(MPXINSEL,1),    X28920020
               (MPXNOP,1),(MPXERSEQ,1),(MPXADI,1),(MPXSTI,1),          X28980020
               (MPXBCP,1),(MPXBC4,1),(MPXBC2,1),(MPXBC1,1),(MPXILI,1), X29040020
               (MPXDATAC,1),(MPXCHCK,1),(DUM76,1)                       29100020
         DSGEN (VCCHPR0,1,1,9),(VCCHPR,1,10,16)                @YM2954P 29106002
         DSGEN (VCCHPR1,16,EQU,VCCHPR01)                       @YM2954P 29108002
         DSGEN (VDUM,24),(VFLAG,8),(VNOPRO,16)                 @YM2954P 29110002
         DSGEN (VPROC01,16),(VCHST01,16),(VPROC02,16),(VCHST02,16),    X29112002
               (VPROC03,16),(VCHST03,16),(VPROC04,16),(VCHST04,16),    X29118002
               (VPROC05,16),(VCHST05,16),(VPROC06,16),(VCHST06,16),    X29124002
               (VPROC07,16),(VCHST07,16),(VPROC08,16),(VCHST08,16),    X29130002
               (VPROC09,16),(VCHST09,16),(VPROC10,16),(VCHST10,16),    X29136002
               (VPROC11,16),(VCHST11,16),(VPROC12,16),(VCHST12,16),    X29142002
               (VPROC13,16),(VCHST13,16),(VPROC14,16),(VCHST14,16),    X29148002
               (VPROC15,16),(VCHST15,16),(VPROC16,16),(VCHST16,16)      29154002
         EJECT                                                          29160020
*                                                                       29220020
IFCEP000 DSECT                                                          29280020
         DS    CL6                                                      29340020
         DS    CL1                                                      29400020
         DS    CL1                                                      29460020
XPRTBUF  DS    15CL8                                                    29520020
         DS    5CL8                                                     29580020
         DS    3CL8                                                     29640020
         DS    CL8                                                      29700020
XSWITCH  DS    CL4                                                      29760020
*                                                                       29820020
*      ROUTINE BRANCH TABLE                                             29880020
*                                                                       29940020
         DS    CL112                                                    30000020
*                                                                       30060020
*      LOAD MODULE ENTRYPOINT NAMES                                     30120020
*                                                                       30180020
         DS    CL56                                                     30240020
*                                                                       30300020
*      READ/WRITE BUFFER                                                30360020
*                                                                       30420020
XMCH     DC    XL2'00'                                                  30480020
XCNTBUF  DS    CL8                                                      30540020
XKEYBUF  DS    CL2                                                      30600020
XDADBUF  DS    197CL8                                                   30660020
XDUMMY   DS    CL1                                                      30720020
         SPACE 3                                                        30780020
ERPIB    DSECT                                                    19032 30840020
SOFWFLGS DS    CL1                 PROGRAM FLAGS FIELD IN ERPIB   19032 30900020
PROBERR  DS    CL1                 PROBABLE SOURCE OF ERROR FIELD 19032 30960020
VALFLAGS DS    CL1                 VALIDITY FLAGS FIELD           19032 31020020
CMPLBITS DS    CL1                 TERM AND RETRY CODES FIELD     19032 31080020
MPINFOFD DS    CL2                 MULTI-PROCESSING INFO FIELD    19032 31140020
CHSMS    DS    CL2                 CHANNEL STATUS FIELD           19032 31200020
         EJECT                                                          31260020
IFCE2870 CSECT                                                          31320020
ENTRYPTR DC    A(FORMAT1)                                               31380020
TABLNAME DC    CL8'IFCE2870'                                            31440020
REG9     DS    F                                                        31500020
LP       DS    F                                                        31560020
SPCLCODE EQU   *                                                        31620020
SKIPPER  EQU   *                                                        31680020
         BR    14                                                       31740020
         SPACE 2                                                        31800020
*********************************************************************** 31860020
*                                                                     * 31920020
*                                                                     * 31980020
*    ROUTINE TO PICK UP THE CHANNEL ADDRESS WHICH IS NOT ON A BYTE    * 32040020
*   BOUNDRY, CONVERT IT TO HEX AND STORE IT IN THE PRINT BUFFER.      * 32100020
*                                                                     * 32160020
*                                                                     * 32220020
*********************************************************************** 32280020
         SPACE 2                                                        32340020
@CHANADR DS    0F                                                       32400020
         USING *,15                                                     32460020
         STM   14,12,12(13)        SAVE THE REGS                        32520020
         MVC   MYWORK(1),0(4)                                           32580020
         NI    MYWORK,X'07'                                             32640020
         OI    MYWORK,X'F0'                                             32700020
         S     3,ONE                                                    32760020
         MVC   0(1,3),MYWORK                                            32820020
         LM    14,12,12(13)        RESTORE THE REGS                     32880020
         BR    14                  RETURN                               32940020
*                                                                       33000020
         DROP  R15                                                      33060020
         USING IFCE2870,R9                                              33120020
         USING C2870,R2                                                 33170002
SETSOURC STM   R5,R8,XSAVE              SAVE REGS                       33180020
         XC    NOPRO(4),NOPRO           CLEAR                           33210002
         CLI   L0(R4),HEX20             TEST REC SOURCE                 33240020
         BE    SETCCH                   CCH NORMAL                      33300020
         CLI   L0(R4),HEX21             TEST SOURCE                     33320002
         BE    SETCCH                   CCH VS2(MVM)                    33340002
         CLI   L0(R4),HEX22                                             33360020
         BE    SETCCHC                  CHH CONVERTED                   33420020
         CLI   L0(R4),HEX28                                             33480020
         BE    SETSER1                  SER1 CHAN REC                   33540020
         CLI   L0(R4),HEX2A                                             33600020
         BE    SETSER1C                 SER1 CHAN REC CONVERTED         33660020
         CLI   L0(R4),HEX29                                             33720020
         BE    SETSER0                  SER0 CHAN REC                   33780020
SETSER0C MVC   CSER0A(L9),CONVERTD      SET CONVERTED MSG               33840020
SETSER0  LA    R5,CSER0                 SET SER0 MSG PTR                33900020
         B     SETSRC                                                   33960020
SETSER1C MVC   CSER1A(L9),CONVERTD      SET CONVERTED MSG               34020020
SETSER1  LA    R5,CSER1                 SET SERC MSG PTR                34080020
         B     SETSRC                                                   34140020
SETCCHC  MVC   CCCHA(L9),CONVERTD       SET CONV MSG                    34200020
SETCCH   LA    R5,CCCH                  SET CCH PTR                     34260020
SETSRC   MVC   L0(L14,R3),L0(R5)        MOVE SOURCE TO LINE             34320020
         B     RETURN                   RETURN                          34380020
*                                                                       34440020
CONVREL  STM   R5,R8,XSAVE              SAVE WORK REGS                  34440202
         SR    R6,R6                    CLEAR R6                        34440402
         IC    R6,L0(R4)                PICK UP REL & SYS VALUES        34440602
         SRDL  R6,L5                    SAVE REL NO IN R7               34440802
        SLL   R6,L2                    MULTIPLY SYS VALUE BY 4          34441002
         L     R8,XLABELP               PICK UP LABEL POINTER           34441202
         LA    R6,RELTAB(R6)            INDEX INTO TABLE OF SYSTEMS     34441402
         MVC   L0(L4,R8),L0(R6)         MOVE SYSTEM NAME INTO LABEL     34441602
         SR    R6,R6                    CLEAR R6                        34441802
         SLDL  R6,L5                    RETREIVE REL NO.                34442002
         LTR   R6,R6                    IS IT ZERO                      34442202
         BZ    NOREL                    BR-YES                          34442402
         CVD   R6,WORK                  CONVERT IT                      34442602
         UNPK  L0(L2,R3),WORK+L6(L2)    UNPACK IT INTO PRINT BUFF       34442802
         MVZ   L1(L1,R3),L0(R3)         MOVE ON PROPER ZONE             34443002
         B     RETURN                   EXIT                            34443202
NOREL    MVC   L0(L4,R3),NONE           MOVE IN NONE FOR REL            34443402
         B     RETURN                                                   34443602
ALLFFF   STM   R5,R8,SSAVE              SAVE REGS                43068  34490002
AG       CLC   L0(L4,R4),HFFF           IS WORD ALL FF"S         43068  34492002
         BNE   OK                       BR - NO                  43068  34494002
         L     R5,NOLOGPTR              POINT AROUND           @YM2954P 34496002
         ST    R5,REG9                   LOGOUT LINES          @YM2954P 34496602
         L     R5,NOLOGLAB                AND                  @YM2954P 34497202
         ST    R5,LP                       LABELS              @YM2954P 34497802
         MVC   L0(L21,R3),NOLOG                                         34498402
OK       EQU   *                                                        34498802
OV       LM    R5,R8,SSAVE              RESTORE REGS             43068  34499202
         BR    R14                      EXIT                     43068  34499602
SSAVE    DC    4F'0'                    SMALL SAVE AREA          43068  34499702
HFFF     DC    X'FFFFFFFF'                                       43068  34499802
*                                                                       34500020
CRHACT   STM   R5,R8,XSAVE                                     @Z30CIMC 34506002
         TM    L0(R4),HEX04        CHANNEL RECONFIG ACTIVE     @Z30CIMC 34512002
         BO    RETURN              RETURN IF YES               @Z30CIMC 34518002
         L     R5,NOCRH            BYPASS CRH MESSAGE PRINTOUT @Z30CIMC 34524002
         ST    R5,REG9                                         @Z30CIMC 34530002
         L     R5,NOCRH1                                       @Z30CIMC 34536002
         ST    R5,LP                                           @Z30CIMC 34542002
         B     RETURN                                          @Z30CIMC 34548002
SETPGMN  MVC   L0(L8,R3),L0(R4)         MOVE 8 CHAR NAME TO BUFF        34560020
         BR    R14                                                      34620020
*                                                                       34680020
SPACER2  LA    R3,L2(R3)                BUMP R3 PTR BY 2                34740020
         BR    R14                                                      34800020
*                                                                       34860020
SETHEX   STM   R5,R8,XSAVE              SAVE REGS                       34920020
         LA    R8,CHARS                 CHAR TABLE PTR                  34980020
         IC    R7,L0(R4)                PICK UP CHAR                    35040020
         SLL   R7,L24                   MOVE IT TO HI POS               35100020
         SR    R6,R6                                                    35160020
         SLDL  R6,L4                    MOVE 4 BITS TO R6               35220020
         AR    R6,R8                    INDEX FOR CHARS                 35280020
         MVC   L0(L1,R3),L0(R6)         MOVE CHAR TO BUFF               35340020
         SR    R6,R6                                                    35400020
         SLDL  R6,L4                    MOVE LAST 4 BITS TO R6          35460020
         AR    R6,R8                    INDEX INTO TABLE                35520020
         MVC   L1(L1,R3),L0(R6)         MOVE CHAR                       35580020
         B     RETURN                                                   35640020
*                                                                       35700020
*                                                                       35760020
*                                                                       35820020
*                              SET ACTIVE  I/O UNITS                    35880020
SETAIO   STM   R5,R8,XSAVE              SAVE REGS                       35940020
         LR    R5,R3                    SET R5 TO BUFFER                36000020
         SH    R5,H43                   POINT R5 TO BEGGIN OF DATA      36060020
         SR    R7,R7                                                    36120020
         LA    R6,L8                    LOOP COUNT                      36180020
SETAIOLP CLC   L0(L4,R5),CZEROS         TEST FOR ALL ZEROS              36240020
         BE    BLANKOUT                 BE-TO BLANK OUT ZEROS           36300020
SETAIOL1 LA    R5,L5(R5)                BUMP COUNT                      36360020
         BCT   R6,SETAIOLP              LOOP TILL 8 TESTS               36420020
         CH    R7,H8                    ARE ALL ACTIVE IO ZERO          36480020
         BNE   RETURN                   NO RETURN                       36540020
         LR    R5,R3                    YES                             36600020
         SH    R5,H43                   PUT IN NONE                     36660020
         MVC   L0(L4,R5),NONE           INTO PRINT BUFF                 36720020
         B     RETURN                                                   36780020
BLANKOUT MVC   L0(L4,R5),BLANKS         MOVE IN BLANKS                  36840020
         LA    R7,L1(R7)                COUNT # OF ZERO FLDS            36900020
         B     SETAIOL1                 LOOP                            36960020
RETURN   LM    R5,R8,XSAVE                                              37020020
         BR    R14                                                      37080020
*                                                                       37140020
*                                                                       37200020
CHKSW9   TM    L1(R4),HEX40             TEST SWITCHES                   37260020
CHECKCC  BZ    NOPRT                    IF SWITCHES OFF                 37320020
         BR    R14                      DONOT PRINT                     37380020
CHKSW10  TM    L1(R4),HEX20             R15 RETURNED ZERO               37440020
         B     CHECKCC                  STOPS PRINTING                  37500020
CHKSW11  TM    L1(R4),HEX10                                             37560020
         B     CHECKCC                                                  37620020
CHKSW12  TM    L1(R4),HEX08                                             37680020
         B     CHECKCC                                                  37740020
CHKSW13  TM    L1(R4),HEX04                                             37800020
         B     CHECKCC                                                  37860020
CHKSW14  TM    L1(R4),HEX02                                             37920020
         B     CHECKCC                                                  37980020
CHKSW15  TM    L1(R4),HEX01                                             38040020
         B     CHECKCC                                                  38100020
NOPRT    SR    R15,R15                                                  38160020
         BR    R14                                                      38220020
*                                                                       38280020
SETDATE  UNPK  XWORK(L8),L0(L4,R4)      UNPACL DATE                     38340020
         MVZ   XWORK+L7(L1),XWORK       SET ZONE                        38400020
         MVC   L0(L3,R3),XWORK+L5       MOVE DAY                        38460020
         MVC  L6(L2,R3),XWORK+L3                                        38520020
         BR    R14                      RETURN                          38580020
*                                                                       38640020
CONVTIME TM    L0(R4),HEX48             TEST FOR NS/BIN CLOCK           38700020
         BZ    BINCLOCK                 ZERO IS BINARY CLOCK            38760020
         BO    RETURNB                  ONES IS FOR CONV TIME           38820020
         TM    L0(R4),HEX40             IF ON IS N/S CLOCK              38880020
         BO    NSCLOCK                  IF OFF TIME OK                  38940020
RETURNB  BR    R14                      RETURN                          39000020
*                                                                       39060020
         USING C2870,R2                                                 39120020
ISITVS2  STM   R5,R8,XSAVE             SAVE REGS               @YL02021 39121002
         L     R5,DUMPIT                LOCATION OF DUMP PARMS @YM2954P 39121302
         MVC   L0(L2,R5),LOGSIZV2       VS 2 RECORD SIZE       @YM2954P 39121602
         CLI   XKEY,HEX21              IS IT VS2               @YL02021 39122002
         BE    RETURN                  YES                     @YL02021 39123002
         MVC   L0(L2,R5),LOGSIZV1       VS 1 RECORD SIZE       @YM2954P 39123502
         SR    R15,R15                 ELIM. LABEL             @YL02021 39124002
         B     RETURN                                          @YL02021 39125002
VS2TEST  STM   R5,R8,XSAVE             SAVE REGS               @YL02021 39126002
         CLI   XKEY,HEX21              IS IT VS2               @YL02021 39127002
         BE    RETURN                                          @YL02021 39128002
         B     COMPL                    SET UP FOR DUMP AND RET         39129002
PROC     STM   R5,R8,XSAVE             SAVE REGS               @YL02021 39134002
         SR    R5,R5                   CLEAR REG 5             @YL02021 39135002
         L     R5,NOPRO                PLACE THE NO. OF PROC. IN REG 5  39136002
         LA    R5,1(R5)                ADD ONE TO REG. 5       @YL02021 39137002
         ST    R5,NOPRO                PLACE BACK IN CORE      @YL02021 39138002
         CLC   VNOPRO(2),NOPRO+2       COMP. WITH ACTUAL NO. OF PROC.   39139002
         BL    COMPL                   FINISHED                @YL02021 39140002
         LR    R5,R3                                           @YL02021 39141002
         LA    R6,L47                   ADJUST OFFSET          @YM2954P 39142002
         SR    R5,R6                                           @YL02021 39143002
         MVC   L0(L17,R5),MSGA                                 @YL02021 39144002
         MVC   L27(L16,R5),MSGB                                @YM2954P 39145002
PROCBIN  LH    R4,L0(R4)           FETCH DATA                  @YM2954P 39145102
         SLL   R4,L15                   POSITION DATA                   39145202
         LA    R6,L46              LENGTH OF LABEL             @YM2954P 39145302
         AR    R5,R6               SET UP POINTER              @YM2954P 39145402
         LA    R6,L16                   CHANGE COUNT           @YM2954P 39145502
TESTIT   SLL   R4,L1                    POSITION CHANNEL IND   @YM2954P 39145602
         LTR   R4,R4                    TEST FOR ON LINE       @YM2954P 39145702
         BNM   CHANACT                  BRANCH ON LINE         @YM2954P 39145802
PRINT    LA    R5,L3(R5)                UP DATE PRINT PTR               39145902
         BCT   R6,TESTIT           NEXT CHANNEL                @YM2954P 39146002
         B     RETURN                                          @YM2954P 39146102
CHANACT  MVI   L0(R5),C'X'         MOVE X TO PRINT             @YM2954P 39146202
         B     PRINT                    NEXT CHANNEL           @YM2954P 39146302
COMPL    SR    R15,R15                 CLEAR LABEL             @YL02021 39147002
         L     R5,DUMP                 LOAD ADDE OF DUMP       @YL02021 39148002
         ST    R5,REG9                                         @YL02021 39149002
         L     R5,DUMP1                                        @Z30CIMC 39149302
         ST    R5,LP                                           @Z30CIMC 39149602
         B     RETURN                                          @YL02021 39150002
NOPRO    DC    F'00'                                           @YL02021 39151002
MSGA     DC    C'PROCESSOR ADDRESS'                            @YL02021 39152002
MSGB     DC    C'CHANNELS ON LINE'                             @YM2954P 39153002
LOGSIZV1 DC    XL2'68'                                         @YM2954P 39159002
LOGSIZV2 DC    XL2'B0'                                         @YM2954P 39165002
DUMPIT   DC    A(DUMPSIZE)                                     @YM2954P 39171002
NSCLOCK  STM   R14,R12,L12(R13)         SAVE REGS                       39180020
         NI    L0(R4),HEXBF                                             39240020
         MVC   XWORK(L8),XDATE          MOVE DATE                       39300020
         LM    R4,R5,XWORK                                              39360020
         SRDL  R4,L12                   POSITION FOR MICRO SECS         39420020
         D     R4,MILLION               CONVERT TO SECONDS              39480020
         SRA   R4,L19                   POSITION FOR ROUNDING           39540020
         AR    R5,R4                    UP TO NXT SECONDS               39600020
         SR    R4,R4                                                    39660020
         D     R4,SIXTY                 CONVERT TO NINS                 39720020
         CVD   R4,XWORK                 CONVERT IT                      39780020
         LH    R6,XWORK+L6              PICK UP SECONDS                 39840020
         SRL   R6,L4                    SHIFT OFF ZONE                  39900020
         STC   R6,XDATE+L6              STORE SECONDS IN  REC           39960020
         MVI   XDATE+L7,HEX00           ZERO OUT TH'S                   40020020
         SR    R4,R4                                                    40080020
         D     R4,SIXTY                 CONVERT TO HRS                  40140020
         CVD   R4,XWORK                 CONVERT REMAINDER MINUTES       40200020
         LH    R6,XWORK+L6              PICK UP                         40260020
         SRL   R6,L4                    DROP ZONE                       40320020
         STC   R6,XDATE+L5              STORE MINUTES                   40380020
         SR    R4,R4                                                    40440020
         D     R4,T24                   DIVIDE TO GET DAYS              40500020
         CVD   R4,XWORK                 CONV REM                        40560020
         LH    R6,XWORK+L6              PICK UP                         40620020
         SRL   R6,L4                    DROP ZONE                       40680020
         STC   R6,XDATE+L4              STORE HRS                       40740020
         LA    R4,L60                   STARTINY YEAR 1960              40800020
         LA    R6,L1                    INC OF 1                        40860020
LEAPYEAR LA    R7,L3(R4)                ADD 3 YRS                       40920020
         S     R5,LPYEAR                DAYS IN LEAP YEAR 366           40980020
         BZ    THISYEAR                 BR-THIS YR+1                    41040020
         BM    OVERSHOT                 BR-TOOFAR                       41100020
         BXLE  R4,R6,REGYEAR            UPDATE YEAR BY ONE              41160020
REGYEAR  S     R5,RGYEAR                DAYS IN RG YEAR 365             41220020
         BZ    THISYEAR                 BR-YEAR+1                       41280020
         BM    OVERSHT1                 BR-TOO FAR                      41340020
         BXLE  R4,R6,REGYEAR            UPDATE AND TRY AGAIN            41400020
         B     LEAPYEAR                                                 41460020
OVERSHOT A     R5,LPYEAR                ADD BACK LEAP YEAR              41520020
         B     THISYEAR                 & USE                           41580020
OVERSHT1 A     R5,RGYEAR                ADD BACK REG YEAR               41640020
         B     THISYER                  & USE                           41700020
THISYEAR AR    R4,R6                    ADD 1                           41760020
THISYER  AR    R5,R6                    ADD 1                           41820020
         CVD   R5,XWORK                 CONVERT DAYS                    41880020
         MVC   XDATE+L2(L2),XWORK+L6    MOVE DAYS                       41940020
         CVD   R4,XWORK                 CONVERT YEAR                    42000020
         LH    R6,XWORK+L6              PICK UP                         42060020
         SRL   R6,L4                    DROP ZONE                       42120020
         STC   R6,XDATE+L1              PUT YEAR                        42180020
         MVI   XDATE,HEX00              SET TO ZERO                     42240020
RETURNC  OI    XSWS8,HEX08              TURN ON PACKED SWITCH           42300020
         LM    R14,R12,L12(R13)         RETURN                          42360020
         BR    R14                                                      42420020
*                                                                       42480020
*                                                                       42540020
BINCLOCK STM   R14,R12,L12(R13)         SAVE REGS                       42600020
         LR    R8,R2                    SAVE RECORD POINTER       P6566 42630020
         L     R3,XTIME                 PICK UP TIME IN BIN             42660020
         LTR   R3,R3                    TEST FOR ZERO                   42720020
         BZ    RETURNC                  YES-RETURN                      42780020
         SRL   R3,L1                    CONVERT                         42840020
         M     R2,CONSTG                     TO                         42900020
         D     R2,CONSTH                       DECIMAL                  42960020
         LA    R4,L32                   BIT COUNTER                     43020020
         MVI   TIMDIV+L3,DIV1           INITIAL DIVISOR (0A)            43080020
BCLOCKA  SR    R2,R2                    CLEAR                           43140020
         D     R2,TIMDIV                DEVOLP DIGIT-REMAINDER          43200020
         LR    R0,R2                    SAVE REM                        43260020
         SRDL  R0,L4                    SHIFT 4BITS                     43320020
         SH    R4,H4                    DEC BY 4                        43380020
         LTR   R3,R3                    DONE                            43440020
         BZ    BCLOCKB                  BR-YES                          43500020
         CH    R4,H24                   BITS LESS 24                    43560020
         BNL   BCLOCKA                  BR-NO                           43620020
         XI    TIMDIV+L3,DIV2           ALT DIV (0A XI 0C=06)           43680020
         B     BCLOCKA                                                  43740020
BCLOCKB  SRL   R1,L0(R4)                MOVE TO FINAL POS               43800020
         LR    R2,R8                    RESTORE RECORD POINTER    P6566 43830020
         ST    R1,XTIME                 STORE BACK                      43860020
         B     RETURNC                                                  43920020
R0       EQU   0                                                        43980020
R1       EQU   1                                                        44040020
R2       EQU   2                                                        44100020
R3       EQU   3                                                        44160020
R4       EQU   4                                                        44220020
R5       EQU   5                                                        44280020
R6       EQU   6                                                        44340020
R7       EQU   7                                                        44400020
R8       EQU   8                                                        44460020
R9       EQU   9                                                        44520020
R10      EQU   10                                                       44580020
R11      EQU   11                                                       44640020
R12      EQU   12                                                       44700020
R13      EQU   13                                                       44760020
R14      EQU   14                                                       44820020
R15      EQU   15                                                       44880020
L12      EQU   12                                                       44940020
L14      EQU   14                                                       45000020
L27      EQU   27                                              @YM2954P 45007002
L46      EQU   46                                              @YM2954P 45014002
L47      EQU   47                                              @YM2954P 45021002
L17      EQU   17                                              @YL02021 45030002
L19      EQU   19                                                       45060020
L24      EQU   24                                                       45120020
L25      EQU   25                                              @YL02021 45150002
L32      EQU   32                                                       45180020
L44      EQU   44                                              @YL02021 45210002
L60      EQU   60                                                       45240020
L66      EQU   66                                              @YL02021 45270002
HEXBF    EQU   X'BF'                                                    45300020
HEX48    EQU   X'48'                                                    45360020
HEX02    EQU   X'02'                                                    45420020
HEX04    EQU   X'04'                                                    45480020
HEX08    EQU   X'08'                                                    45540020
HEX10    EQU   X'10'                                                    45600020
HEX20    EQU   X'20'                                                    45660020
HEX21    EQU   X'21'                                           @YL02021 45690002
HEX40    EQU   X'40'                                                    45720020
HEX22    EQU   X'22'                                                    45780020
HEX28    EQU   X'28'                                                    45840020
HEX2A    EQU   X'2A'                                                    45900020
HEX29    EQU   X'29'                                                    45960020
HEX01    EQU   X'01'                                                    46020020
HEX00    EQU   X'00'                                                    46080020
DIV1     EQU   X'0A'                                                    46140020
DIV2     EQU   X'0C'                                                    46200020
L0       EQU   0                                                        46260020
L1       EQU   1                                                        46320020
L2       EQU   2                                                        46380020
L3       EQU   3                                                        46440020
L4       EQU   4                                                        46500020
L5       EQU   5                                                        46560020
L6       EQU   6                                                        46620020
L7       EQU   7                                                        46680020
L8       EQU   8                                                        46740020
L9       EQU   9                                                        46800020
L10      EQU   10                                                       46860020
XWORK    DS    D                                                        46920020
XSAVE    DS    4F                                                       46980020
CONSTG   DC    X'00030D40'                                              47040020
CONSTH   DC    X'024AE062'                                              47100020
MILLION  DC    F'1000000'                                               47160020
SIXTY    DC    F'60'                                                    47220020
T24      DC    F'24'                                                    47280020
LPYEAR   DC    F'366'                                                   47340020
RGYEAR   DC    F'365'                                                   47400020
TIMDIV   DC    F'1'                                                     47460020
H4       DC    H'4'                                                     47520020
H8       DC    H'8'                                                     47580020
H24      DC    H'24'                                                    47640020
H43      DC    H'43'                                                    47700020
CHARS    DC    C'0123456789ABCDEF'                                      47760020
NONE     DC    C'NONE'                                                  47820020
CONVERTD DC    C'CONVERTED'                                             47880020
CZEROS   DC    C'0000'                                                  47940020
BLANKS   DC    C'    '                                                  48000020
CCCH     DC    CL5'CCH'                                                 48060020
CCCHA    DC    CL9' '                                                   48120020
CSER1    DC    CL5'SER1'                                                48180020
CSER1A   DC    CL9' '                                                   48240020
CSER0    DC    CL5'SER0'                                                48300020
CSER0A   DC    CL9' '                                                   48360020
MYWORK   DC    F'0'                                                     48420020
ONE      DC    F'1'                                                     48480020
VS2FLG   DC    X'00'                                           @YL02021 48500002
DUMP     DC    A(DMPSPACE-4)                                   @Z30CIMC 48520002
DUMP1    DC    A(DMPSPC1-1)                                    @Z30CIMC 48530002
         EJECT                                                          48540020
****    NUMERICAL EQUATES                                               48600020
L13      EQU   13                                                       48660020
L15      EQU   15                                                       48720020
L16      EQU   16                                                       48780020
L20      EQU   20                                                       48840020
L21      EQU   21                                                       48900020
L22      EQU   22                                                       48960020
L26      EQU   26                                                       49020020
L31      EQU   31                                                       49080020
L40      EQU   40                                                       49140020
X01      EQU   X'01'                                                    49200020
X02      EQU   X'02'                                                    49260020
X04      EQU   X'04'                                                    49320020
X08      EQU   X'08'                                                    49380020
X09      EQU   X'09'                                                    49440020
X10      EQU   X'10'                                                    49500020
X20      EQU   X'20'                                                    49560020
X30      EQU   X'30'                                                    49620020
X40      EQU   X'40'                                                    49680020
X80      EQU   X'80'                                                    49740020
****    ADDRESS EQUATES                                                 49800020
AD0      EQU   0                                                        49860020
AD4      EQU   4                                                        49920020
AD12     EQU   12                                                       49980020
AD13     EQU   13                                                       50040020
AD14     EQU   14                                                       50100020
AD15     EQU   15                                                       50160020
AD16     EQU   16                                                       50220020
AD20     EQU   20                                                       50280020
AD37     EQU   37                                                       50340020
AD41     EQU   41                                                       50400020
AD45     EQU   45                                                       50460020
AD55     EQU   55                                                       50520020
AD63     EQU   63                                                       50580020
AD69     EQU   69                                                       50640020
AD108    EQU   108                                                      50700020
****    CONDITION CODE EQUATES                                          50760020
CC1      EQU   1                                                        50820020
CC7      EQU   7                                                        50880020
CC8      EQU   8                                                        50940020
IFCASR01 DS    0H                                                       51000020
         USING *,R15                                                    51060020
         STM   R14,R12,12(R13)          SAVE REGISTERS                  51120020
         CLI   XKEY,HEX21                                      @YL02021 51180002
         BNE   CONTIN                                          @YL02021 51190002
         OI    VS2FLG,X01                                      @YL02021 51200002
CONTIN   ST    R13,SVR13                                       @YL02021 51210002
         L     R11,NXENTRY              LOAD SUBROUTINE RETURN ADR      51240020
         LTR   R11,R11                  TEST FOR INITIAL ENTRY          51300020
         BZ    IFCASR02                 BRANCH IF 0-INITIAL ENTRY       51360020
         LM    R12,R10,MYSAVE           RELOAD SUBROUTINE REGS          51420020
         BR    R11                      CONTINUE PROCESSING             51480020
IFCASR02 DS    0H                                                       51540020
         SH    R3,TWOX                  SUBTRACT 2 FROM PRNT BFR ADR    51600020
         MVC   L0(L1,R3),L1(R3)         MOVE PRINTER CNTRL CHAR         51660020
         LA    R3,L1(R3)                INCREMENT PRNT BFR ADR          51720020
         USING XDADBUF,R4                                               51780020
         USING XPRTBUF,R3                                               51840020
         USING XKEYBUF,R2                                               51900020
NEWMOVE  CLI   XKEYBUF+1,REL19          RELEASE 19                19E03 51960020
         BE    NEWMOVE1                 BRANCH--YES               19E03 52020020
         MVC   CSWORD(8),XDADBUF+54     MOVE CSW                  19E03 52080020
         MVC   ERPIBFLD(4),XDADBUF+62   MOVE ERPIB                19E03 52140020
         MVC   MULTISYS(4),XDADBUF+74   MOVE CHANSTAT INFO        19E03 52200020
         B     CONTINUE                 CONTINUE                  19E03 52260020
NEWMOVE1 MVC   CSWORD(8),XDADBUF+46     MOVE CSW                  19E03 52320020
         MVC   ERPIBFLD(4),XDADBUF+54   MOVE ERPIB                19E03 52380020
         MVC   MULTISYS(4),XDADBUF+66   MOVE CHANSTAT INFO        19E03 52440020
CONTINUE LA    R9,ERPIBFLD              DSECT ADDRESSIBILITY      19E03 52500020
         USING ERPIB,R9                                                 52560020
         MVI   SETUPBFR+1,C'*'                                     MP   52620020
         MVC   SETUPBFR+2(78),SETUPBFR+1                           MP   52680020
         BAL   BRANPRT,XWRTPRT    MOVE BORDER TO BUFFER AND WRITE  MP   52740020
         L     R6,VS2                                          @YL02021 52750002
         CLI   0(R6),X'01'                                     @YL02021 52760002
         BE    DUMMYTST                                        @YL02021 52770002
         MVI   SETUPBFR,C'-'           SKIP TWO SPACES             MP   52800020
         TM    MPINFOFD,MSBIT      IS MULTI-SYSTEM BIT SET        19032 52860020
         BZ    DUMMYTST      IFNOT,CKECK FOR ENTRANCE FROM ASR01   MP   52920020
         LA    SETUPADR,SETUPBFR       ADDRESS OF PRINT BUFFER     MP   52980020
         MVC   24(24,SETUPADR),MSHEAD   MOVE MULTI-SYSTEM HDR TO BUFMP  53040020
         BAL   BRANPRT,XWRTPRT     WRITE HEADER                    MP   53100020
         MVI   SETUPBFR+1,C'*'                                     MP   53160020
         MVI   VDSTAR,C'*'                                         MP   53220020
         BAL   BRANPRT,XWRTPRT     WRITE LINE DIVIDER              MP   53280020
*                                                                  MP   53340020
*                                                                  MP   53400020
*              THIS ROUTINE FORMATS AND PRINTS A MESSAGE           MP   53460020
*              CONTAINING THE ID OF THE FAILING CPU AND            MP   53520020
*              THE STATUS OF THE MULTI-PROCESSING SYSTEM           MP   53580020
*                                                                  MP   53640020
*                                                                  MP   53700020
         MVC   10(12,SETUPADR),MSCPUID  MOVE CPUID MESSAGE TO BUFFERMP  53760020
         MVC   30(15,SETUPADR),MSCPUST  MOVE CPU STATUS MESSAGE    MP   53820020
         MVI   0(SETUPADR),C'-'    SKIP TWO SPACES AFTER LINE      MP   53880020
         TM    MPINFOFD,ID         TEST FOR WHICH CPU             19032 53940020
         BZ    STATEST       SKIP CPU ID                           MP   54000020
         MVI   14(SETUPADR),C'2'   INSERT CPUID=CPU2               MP   54060020
STATEST  IC    R1,MPINFOFD         GET MS BYTE IN MPINFO          19032 54120020
         SLL   R1,30               CLEAR FOR CPUSTAT               MP   54180020
         LTR   R1,R1               TEST FOR ZERO,NEGATIVE OR POSITIVEMP 54240020
         BC    12,SHARED           IS STATUS NOT PARTITION         MP   54300020
         MVC   45(11,SETUPADR),PART     STATUS WAS PARTITIONED     MP   54360020
         B     CHANTEST      GO FOR CHANNEL STATUS                 MP   54420020
SHARED   MVC   45(6,SETUPADR),SHAR      SHARED STATUS              MP   54480020
         BE    CHANTEST                 WAS CPU RECONFIGURED OUT   MP   54540020
         MVC   51(21,SETUPADR),RECON    YES                        MP   54600020
         EJECT                                                          54660020
*                                                                  MP   54720020
*                                                                  MP   54780020
*              THIS ROUTINE TESTS A TWO BYTE FIELD                 MP   54840020
*              MPINFO FIELD                          TO DETERMINE       54900020
*              THE CHANNEL STATUS FOR BOTH CPUS AND FORMAT         MP   54960020
*              A MESSAGE TO INDICATE THAT STATUS                   MP   55020020
*                                                                  MP   55080020
*                                                                  MP   55140020
CHANTEST BAL   BRANPRT,XWRTPRT          PRINT INFORMATION          MP   55200020
         MVI   0(SETUPADR),C'-'         SKIP TWO SPACES            MP   55260020
         MVC   10(27,SETUPADR),CHCNFIG  CHANNEL CONFIGURATION MESSAGEMP 55320020
         LA    UPKREG,0                                            MP   55380020
         TM    MPINFOFD,ID         WAS CPUID=CPU2                 19032 55440020
         BZ    CCHMOVE                 NO                          MP   55500020
         MVI   14(SETUPADR),C'2'        YES, ENTER ID 2            MP   55560020
CCHMOVE  BAL   BRANPRT,XWRTPRT          PRINT MESSAGE              MP   55620020
         LA    R1,7                     LOOP CONTROL               MP   55680020
         LA    R2,14(SETUPADR)          PTR TO SLOT FOR 'OFF' MESSAGEMP 55740020
         IC    R5,CHSMS(UPKREG)         GET CHANNEL STATUS BYTE    MP   55800020
         MVC   10(55,SETUPADR),CHTAB    GET LIST OF CHANNELS       MP   55860020
         SLL   R5,24                    POSITION BYTE FOR BIT TESTINGMP 55920020
MSLOOP   LTR   R5,R5         IS BIT ON (NEGATIVE REG) OR OFF       MP   55980020
         BC    10,MSUPDT                NO                         MP   56040020
         MVC   0(3,R2),OFF              CHANNEL OFFLINE            MP   56100020
MSUPDT   SLL   R5,1                     MOVE TO NEXT CHANNEL BIT   MP   56160020
         LA    R2,8(R2)                 UPDATE MESSAGE POINTER     MP   56220020
         BCT   R1,MSLOOP                EXIT AFTER 7-BITS PROCESSED MP  56280020
MSREND   BAL   BRANPRT,XWRTPRT          WRITE CHANNEL STATUS MESSAGEMP  56340020
         LTR   UPKREG,UPKREG            TEST FOR SECOND TIME THROUGH MP 56400020
         BC    7,PRTHD                  BOTH BYTES OF CHANSTAT PRINTED  56460020
         LA    UPKREG,1(UPKREG)         PTR TO 2ND.BYTE OF CHANSTATMP   56520020
         MVC   10(27,SETUPADR),CHCNFIG  MOVE IN CHANNEL CONFIGURATIONMP 56580020
*                                       MESSAGE                    MP   56640020
         MVI   0(SETUPADR),C'0'         SKIP SPACE AFTER NEXT MESSAGEMP 56700020
         TM    MPINFOFD,ID         ESTABLISH CPUID                19032 56760020
         BO    CCHMOVE                  BRANCH IF CPUID=CPU2       MP   56820020
         MVI   14(SETUPADR),C'2'        PUT CPU2 IN MESSAGE        MP   56880020
         B     CCHMOVE       PRINT MESSAGE                         MP   56940020
PRTHD    MVI   SETUPBFR+1,C'*'             SETUP TO PRINT DIVIDER       57000020
         MVC   2(78,SETUPADR),1(SETUPADR)                               57060020
         MVI   SETUPBFR,C'0'               SPACE FIRST                  57120020
         BAL   BRANPRT,XWRTPRT             PRINT DIVIDER                57180020
DUMMYTST LA    SETUPADR,SETUPBFR   GET ADDR OF BUFFER FOR PRINT    MP   57240020
         OC    ERPIBFLD+1(3),ERPIBFLD+1  TEST FOR DUMMY ERPIB     19032 57300020
         BNE   MSCONT                   CONTINUE IF MEANINGFUL ERPIB MP 57360020
         MVI   0(SETUPADR),C'-'         SKIP 2 LINES               MP   57480020
         MVC   10(17,SETUPADR),MSNERPIB ERPIB NOT CREATED MESSAGE  MP   57600020
         BAL   BRANPRT,XWRTPRT          PRINT INFORMATION          MP   57660020
         B     RETCNTL       RETURN CONTROL                        MP   57720020
*                                                                  MP   57780020
         EJECT                                                          57840020
MSCONT   EQU   *                                                   MP   57900020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  57960020
*                          INSTRUCTION ANALYSIS                       * 58020020
*        THIS PROGRAM SECTION WILL INSPECT THE FIRST FOUR(4) BITS IN  * 58080020
*        THE FIRST BYTE  OF THE              ERPIB AREA, TO DETERMINE * 58140020
*        THE INSTRUCTION CAUSING THE ERROR.                           * 58200020
         LA    SETUPADR,SETUPBFR       SET UP HEADER BOARDER.           58260020
         MVC   SETUPBFR+27(25),HEADER    SET UP HEADER MESSAGE          58320020
         MVI   0(SETUPADR),C'0'          SPACE ONE LINE                 58380020
         BAL   BRANPRT,XWRTPRT                                          58440020
*                                                                     * 58500020
*                            TEST FOR INTERRUPT                       * 58560020
*                                                                     * 58620020
         TM    SOFWFLGS,X'40'          INTERRUPT TEST.                  58680020
         BZ    INST                                                     58740020
         MVC   SETUPBFR(42),ERRINT     BUFFER INTERRUPT MESSAGE.        58800020
         B     RITEOUT                                                  58860020
*                                                                     * 58920020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  58980020
*                                                                     * 59040020
*        BITS 32-35 WILL BE TESTED                                    * 59100020
*                                                                     * 59160020
INST     MVC   SETUPBFR(33),CAUSERR    TYPE-INST ERROR HEADER.          59220020
         TM    SOFWFLGS,X'80'          TEST FOR SIO INSTRUCTION ERROR.  59280020
         BO    PRTERSIO                BRANCH TO SETUP PRINT BUFFER.    59340020
         TM    SOFWFLGS,X'20'          TEST FOR TIO INSTRUCTION.        59400020
         BO    PRTERTIO                BRANCH TO SETUP PRINT BUFFER.    59460020
*                                                                     * 59520020
PRTERHIO MVC   SET1(3),ERRHIO          MOVE HIO LABEL INTO BUFFER.      59580020
         B     RITEOUT                 PREPARE TO WRITE MESSAGE.        59640020
*                                                                     * 59700020
PRTERSIO MVC   SET1(3),ERRSIO          MOVE SIO LABEL INTO BUFFER.      59760020
         B     RITEOUT                 PREPARE TO WRITE MESSAGE.        59820020
*                                                                     * 59880020
PRTERTIO MVC   SET1(3),ERRTIO          MOVE TIO LABEL INTO BUFFER.      59940020
*                                                                     * 60000020
RITEOUT  BAL   BRANPRT,XWRTPRT         WRITE OUT APPROPRIATE MESSAGE.   60060020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  60120020
*        THE FOLLOWING PROGRAM SECTION WILL INSPECT THE ERPIBFLD        60180020
*        TO DETERMINE IF AN ERPIB IS PRESENT.   IF  ONE IS              60240020
*        NOT FOUND, CONTROL WILL BE RETURNED.                           60300020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  60360020
         OC    ERPIBFLD+1(3),ERPIBFLD+1  TEST FOR  ERPIB PRESENT  19032 60420020
         BZ    NONEXIST                WRITE MSG TO INDICATE NONEXISTS. 60480020
         B     TEST1         TEST COMPLETION CODE                  MP   60540020
SETVD    EQU   XPRTBUF+33                                          MP   60600020
*                         UCB ADDRESS NON-EXISTANT                      60660020
NONEXIST MVC   SETUPBFR(45),NOUCB        SET UP MSG FOR NO UCB          60720020
         BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   60780020
         B     RETCNTL                 RETURN TO CONTROL.               60840020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  60900020
*        THE FOLLOWING PROGRAM SECTION WILL TEST  BYTE 5     OF THE     60960020
*        ERPIB FOR A NO RETRY BIT SETTING. IF ON, CONTROL IS RETURNED   61020020
*        AFTER MESSAGE IS PRINTED OUT.                                  61080020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  61140020
*                       OUTPUT RETRY CODE VALUE                         61200020
*                                                                       61260020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  61320020
*                            TEST SOFTWARE FLAGS                        61380020
TEST     MVC   SETUPBFR(32),RETCDVAL     BUFFER THE BASIC MESSAGE       61440020
         IC    REG,CMPLBITS        CONTENTS OF BYTE 8 INTO R3     19032 61500002
         TM    VALFLAGS,X'10'            TEST FOR VALID RETRY CODE      61560020
         BO    VALFLG              IF VALID, GO SETUP MESSAGE           61620020
         MVC   33(43,SETUPADR),NOTVM  SETUP NOT ASSESSABLE MESSAGE      61680020
         B     BUFITA           GO PRINT IT                             61740020
VALFLG   N     REG,MASK            GET RID OF UNNEED BITS               61741002
         STC   REG,RCMSG+12        STORE NO. IN RETRY CODE MSG          61742002
         OI    RCMSG+12,X'F0'      MAKE PRINTABLE                       61920020
         MH    REG,CONST                                                61980002
         LA    REG,MSGSTRT(REG)    SET UP MSG INDEX                     62040002
         MVC   33(44,SETUPADR),0(REG)  MOVE MSG TO BUFFER               62100002
BUFIT    BAL   BRANPRT,XWRTPRT     PRINT IT                             62160020
         MVC   34(14,SETUPADR),RCMSG  MOVE RETRY MSG TO BUFFER          62220020
BUFITA   BAL   BRANPRT,XWRTPRT                                          62280020
         TM    CMPLBITS,X'08'      IS DISCONNECT IN SET           19032 62340020
         BNO   NOTDISIN            NO, SKIP MSG                   19032 62400020
         MVC   SETUPBFR(23),DISCIN SET UP MSG                     19032 62460020
         BAL   BRANPRT,XWRTPRT     PRINT MSG                      19032 62520020
NOTDISIN EQU   *                                                  19032 62580020
*                                                                       62640020
*                                  TEST NO-RETRY BIT                    62700020
         TM    SOFWFLGS,X'01'          IF NORETRY BIT IS NOT ON,BRANCH  62760020
*                                      TO PRINT VALID INDICATOR MSG.    62820020
         BZ    VALIDIND                                                 62880020
         MVC   SETUPBFR(28),NORETRY    INDICATES THAT THE BIT WAS ON.   62940020
         BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.               63000020
         B     RETCNTL                 RETURN CONTROL.                  63060020
VALIDIND MVC   SETUPBFR(29),VALIDITY   RECORDED DATA HEADING TO BUFFER  63120020
         BAL   BRANPRT,XWRTPRT         INDICATOR HEADER.                63180020
*                                                                       63240020
*                                  TEST VALID RETRY CODE                63300020
*                                                                       63360020
*                                                                       63420020
*                            TEST COUNT BIT                             63480020
         MVC   SETUPBFR(42),VALCOUNT   BUFFER THE BASIC MESSAGE.        63540020
         TM    SOFWFLGS,X'02'          TEST COUNT VALIDITY.             63600020
         BZ    INVCOUNT                IF OFF, PRINT INVALID MSG.       63660020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    63720020
INVCOUNT BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   63780020
*                                                                       63840020
*                            TEST FOR SENSE DATA STORED                 63900020
*                                                                       63960020
         MVC   SETUPBFR(43),SENSDATA   BUFFER THE BASIC MESSAGE.        64020020
         TM    SOFWFLGS,X'04'          TEST SENSE BIT.                  64080020
         BZ    NOSTORE                 IF OFF BRANCH TO WRITE NOSTORE.  64140020
         MVC   33(10,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.   64200020
NOSTORE  BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.               64260020
*                            TEST UNIT STATUS BIT                       64320020
         MVC   SETUPBFR(42),INVALUN    BUFFER THE BASIC MESSAGE.        64380020
         TM    VALFLAGS,X'08'          TEST FOR VALID UNIT STATUS.      64440020
         BZ    WRTOUT                  UNIT STATUS INVALID.             64500020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    64560020
WRTOUT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   64620020
*                                                                       64680020
*                            TEST COMMAND ADDRESS BIT                   64740020
*                                                                       64800020
         MVC   SETUPBFR(42),INVALCAD   MOVE INVALID COM MSG TO BUFFER.  64860020
         TM    VALFLAGS,X'04'          TEST FOR VALID COMMAND ADDRESS.  64920020
         BZ    PTOUT                   COMMAND ADDRESS INVALID.         64980020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    65040020
PTOUT    BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.               65100020
*                                                                       65160020
*                            TEST CHANNEL ADDRESS BIT                   65220020
*                                                                       65280020
         MVC   SETUPBFR(42),INVALCHA   MOVE INVALID CHN MSG TO BFR.     65340020
         TM    VALFLAGS,X'02'          TEST FOR VALID CHANNEL ADDRESS.  65400020
         BZ    OUTWRT                  INVALID CHANNEL ADDRESS.         65460020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    65520020
OUTWRT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   65580020
*                                                                       65640020
*                            TEST FOR VALID DEVICE ADDRESS              65700020
*                                                                       65760020
         MVC   SETUPBFR(42),INVALDVA   MOVE INVALID DVC ADDR MSG TO BFR 65820020
         TM    VALFLAGS,X'01'          TEST FOR VALID DEVICE ADDRESS.   65880020
         BZ    OUTPRT                  INVALID DEVICE ADDRESS.          65940020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    66000020
OUTPRT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   66060020
*                                                                       66120020
*        PROBABLE SOURCE OF ERROR                                       66180020
*                                                                       66240020
         MVC   SETUPBFR(29),PSOERR      INSERT BASE MSG IN BUFFER       66300020
         CLI   PROBERR,X'80'            TEST FOR CPU ERROR              66360020
         BE    CPUER                    BRANCH TO SET UP CPU ERR MSG    66420020
         CLI   PROBERR,X'40'            TEST FOR CHANNEL ERROR          66480020
         BE    CHNER                    BRANCH TO SETUP CHANNEL ERROR   66540020
         CLI   PROBERR,X'20'       TEST FOR SCU ERROR             19032 66600020
         BE    SCUER               YES- GO SET UP FOR SCU ERRMSG  19032 66660020
         CLI   PROBERR,X'10'            TEST FOR STORAGE ERROR          66720020
         BE    STORGER                  GO SETUP STORAGE ERROR MSG      66780020
         CLI   PROBERR,X'08'            TEST FOR I/O INTERFACE ERROR    66840020
         BE    INFER                    GO SETUP I/O INTF ERROR MSG     66900020
         MVC   30(25,SETUPADR),NOTVM    SETUP NOT ASSESSABLE MESSAGE    66960020
         B     WPRMSG                   GO PRINT MSG                    67020020
CPUER    MVC   30(3,SETUPADR),CPUERMSG  BUFFER CPU ERROR MESSAGE        67080020
         B     WPRMSG                   GO PRINT                        67140020
CHNER    MVC   30(7,SETUPADR),CHANERMS  SETUP CHANNEL ERROR MESSAGE     67200020
         B     WPRMSG                   GO PRINT                        67260020
SCUER    MVC   30(20,SETUPADR),SCUERMS  SET UP SCU MSG            19032 67320020
         B     WPRMSG                   GO PRINT IT               19032 67380020
STORGER  MVC   30(7,SETUPADR),STOGERMS  SETUP STORAGE ERROR MESSAGE     67440020
         B     WPRMSG                   GO PRINT                        67500020
INFER    MVC   30(13,SETUPADR),IOINFER  SET UP INTERFACE ERROR MESSAGE  67560020
WPRMSG   BAL   BRANPRT,XWRTPRT          PRINT MESSAGE                   67620020
         B     RETCNTL                                                  67680020
*                                                                       67740020
*                            TEST COMPLETION CODE                       67800020
*                                                                       67860020
TEST1    MVC   SETUPBFR(23),COMCODE    INSERT COMPLETION CODE MESSAGE   67920020
*                                      IN PRINT BUFFER.                 67980020
         TM    CMPLBITS,X'C0'          TEST FOR COMPLETION CODE '3'.    68040020
         BO    SYSRET                  BRANCH FOR SYS RESET MSG OUTPUT. 68100020
         TM    CMPLBITS,X'80'          TEST FOR COMPLETION CODE '2'     68160020
         BO    SELRET                  BRANCH FOR SEL RESET MSG OUTPUT. 68220020
         TM    CMPLBITS,X'40'          TEST FOR COMPLETION CODE '1'     68280020
         BO    FORENDSQ                BRANCH FOR FORCED END MSG OUTPUT 68340020
*                                                                       68400020
*                            INTERFACE DISCONNECT                       68460020
*                                                                       68520020
         MVC   SET2(29),INTDISCN      SET UP INTERFACE DISCONNECT MSG   68580020
         B     WRITER                  MESSAGE AND WRITE IT OUT.        68640020
*                                                                       68700020
*                            SYSTEM RESET                               68760020
*                                                                       68820020
SYSRET   MVC   SET2(21),SYSRES        SETUP  THE SYSTEM RESET MSG AND   68880020
         B     WRITER                  WRITE IT OUT.                    68940020
*                                                                       69000020
*                            SELECTIVE RESET                            69060020
*                                                                       69120020
SELRET   MVC   SET2(24),SELRES          SETUP SELECTIVE RESET  MSG AND  69180020
         B     WRITER                  AND WRITE IT OUT.                69240020
*                                                                       69300020
*                            FORCED ENDING SEQUENCE                     69360020
*                                                                       69420020
FORENDSQ MVC   SET2(31),FORCEND         SETUP FORCE END MESSAGE AND     69480020
*                                      WRITE IT OUT.                    69540020
*                                                                       69600020
*                            OUTPUT OF COMPLETION                       69660020
*                              CODE MESSAGES                            69720020
*                                                                       69780020
WRITER   BAL   BRANPRT,XWRTPRT                                          69840020
         B     TEST                                                     69900020
*                                                                       69960020
*                                 RETURN CONTROL                        70020020
*                                                                       70080020
RETCNTL  EQU   *                                                  19032 70140020
         MVI   SETUPBFR+1,C'*'                                          70200020
         MVC   2(78,SETUPADR),1(SETUPADR)                               70260020
         MVI   0(SETUPADR),C'-'         SETUP TO SPACE TWICE            70320020
         BAL   BRANPRT,XWRTPRT                                          70380020
         TM    CSWORD+5,X'06'           TEST FOR CHN OR INTF CTL CHK    70440020
         BC    8,MSG                   NO, PRINT LOGOUT MESSAGE.        70500020
FIN1     DS    0C                                                       70560020
         LA    R0,0                     ZERO WORK REGISTER              70620020
         ST    R0,NXENTRY               CLEAR ENTRY POINTER             70680020
         L     R13,SVR13                RESTORE REG 13                  70740020
         LM    R14,R12,12(R13)          RESTORE REGISTERS               70800020
         BR    R14                      RETURN                          70860020
*                                                                       70920020
*                            PRINT NO-LOGOUT MESSAGE                    70980020
*                                                                       71040020
MSG      MVC   SETUPBFR+1(78),ERMSG     MESSAGE IN BUFFER               71100002
         BAL   BRANPRT,XWRTPRT                                          71160020
         L     R0,NOLOGPTR              POINT                  @YM2954P 71220002
         L     R1,RG9PTR                 AROUND                @YM2954P 71250002
         ST    R0,AD0(R1)                 LOGOUT               @YM2954P 71280002
         L     R0,NOLOGLAB                 LINES               @YM2954P 71310002
         L     R1,LPPTR                     AND                @YM2954P 71340002
         ST    R0,AD0(R1)                    LABELS            @YM2954P 71370002
         B     FIN1                                                     71400020
*                                                                  MP   71460020
         SPACE                                                          71520020
****    ROUTINE TO RETURN CONTROL TO CONTROL MODULE                     71580020
XWRTPRT  DS    0C                                                       71640020
         ST    BRANPRT,NXENTRY          STORE LINK ADDRESS              71700020
         STM   R12,R10,MYSAVE           SAVE SUBROUTINE REGS            71760020
         L     R0,RTNPTR                LOAD ADCON FOR RETURN POINTER   71820020
         L     R1,RG9PTR                LOAD POINTER TO REG9            71880020
         ST    R0,AD0(R1)               STORE RETURN POINTER            71940020
         L     R0,LBLPTR                LOAD POINTER TO LABEL           72000020
         L     R1,LPPTR                 LOAD POINTER TO LP              72060020
         ST    R0,AD0(R1)               STORE LABEL POINTER             72120020
         MVI   L0(R3),X09               SET CARRIAGE CTL CHAR           72180020
         L     R13,SVR13                RESTORE REG 13                  72240020
         LM    R14,R12,12(R13)          RESTORE REGISTERS               72300020
         BR    R14                      RETURN                          72360020
*                                                                       72420020
*                            STORAGE                                    72480020
*                                                                       72540020
         DS    0F                                                       72600020
TYPE     EQU   XDADBUF+5                                           MP   72660020
ENVCH    EQU   XDADBUF+56                                          MP   72720020
ENVMS    EQU   XDADBUF+63                                          MP   72780020
GPRMS    EQU   XDADBUF+248                                         MP   72840020
ONEVD    EQU   X'01'                                               MP   72900020
TWEN     EQU   X'20'                                               MP   72960020
EIGHTY   EQU   X'80'                                               MP   73020020
VDSTAR   EQU   XPRTBUF+79                                          MP   73080020
PLACE    EQU   ENVCH+32                                            MP   73140020
F252     EQU   252                                                 MP   73200020
FROMVD   EQU   GPRMS+32                                            MP   73260020
OCTVD    EQU     80                                                MP   73320020
AREAVD   EQU   GPRMS+92                                            MP   73380020
ID       EQU   X'08'                                               MP   73440020
MSBIT    EQU   X'10'                                                MP  73500020
K0       EQU   0                                                  19E03 73560020
K1       EQU   1                                                  19E03 73620020
K2       EQU   2                                                  19E03 73680020
K4       EQU   4                                                  19E03 73740020
K8       EQU   8                                                  19E03 73800020
K10      EQU   10                                                 19E03 73860020
K20      EQU   20                                                 19E02 73920020
K21      EQU   21                                                 19E02 73980020
K24      EQU   24                                                 19E03 74040020
FOXDOG   EQU   X'FD'                                              19E03 74100020
REL19    EQU   19                                                 19E02 74160020
XPRTBUF1 EQU   XPRTBUF+1                                          19E03 74220020
*                                                                       74280020
SETUPBFR EQU   XPRTBUF                                                  74340020
CSWORD   DC    D'0'                CSW LOCATION                   19032 74400020
ERPIBFLD DC    F'0'                LAST HALF ERPIB                19032 74460020
MULTISYS DC    F'0'                MULTI-PROCESSING INFO          19032 74520020
MASK     DC    F'7'                                                     74580020
NXENTRY  DC    F'0'                                                     74640020
MYSAVE   DS    15F                                                      74700020
SVR13    DS    1F                                                       74760020
VS2      DC    A(VS2FLG)                                       @YL02021 74790002
RTNPTR   DC    A(PRTERPIB-4)                                            74820020
RG9PTR   DC    A(REG9)                                                  74880020
LBLPTR   DC    A(LABELEND-1)                                            74940020
LPPTR    DC    A(LP)                                                    75000020
NOLOGPTR DC    A(VS2LINE-4)                                    @YM2954P 75060002
NOLOGLAB DC    A(VS2LAB-1)                                     @YM2954P 75090002
NOCRH    DC    A(NOTCRH-4)                                     @Z30CIMC 75100002
NOCRH1   DC    A(NOTCRH1-1)                                    @Z30CIMC 75110002
CONST    DC    H'44'                                                    75120020
TWOX     DC    H'2'                                                     75180020
SET1     EQU   SETUPBFR+22                                              75240020
SET2     EQU   SETUPBFR+21                                              75300020
*                                                                       75360020
*                            REGISTERS                                  75420020
REG      EQU   11                                                       75480002
UPKREG   EQU   6                       ADDRESSES UNPACK AREA.           75540020
SETUPADR EQU   7                       ADDRESSES PRINT BUFFER.          75600020
PRTABREG EQU   8                       ADDRESSES CONVERSION TABLE.      75660020
BASEREG  EQU   9                       BASE REGISTER.                   75720020
BRANPRT  EQU   11                      ADDRESSES PRINT ROUTINE.         75780020
CLEAREG  EQU   12                                                       75840020
SAVADDR  EQU   13                      ADDRESSES REGISTER SAVE AREA.    75900020
BRANADDR EQU   14                      BRANCH REGISTER.                 75960020
RELTAB   DS    0C                                              @L03976  75960202
         DC    C'OS  '                                         @L03976  75960302
         DC    C'DOS '                                         @L03976  75960402
         DC    C'VS 1'                                         @L03976  75960502
         DC    C'V370'                                         @L03976  75960602
         DC    C'VS 2'                                         @L03976  75960702
         DC    C'    '                                         @L03976  75960802
         DC    C'    '                                         @L03976  75960902
         DC    C'    '                                         @L03976  75961002
XLABELP  EQU   LP                                                       75961402
WORK     EQU   XWORK                                                    75961602
*                                                                       76020020
*                            MESSAGES                                   76080020
*                                                                       76140020
*                                                                       76200020
CAUSERR  DC    C'   CSW STORED BY  --             '                     76260020
ERRINT   DC    C'   CSW STORED BY  INTERRUPT               '            76320020
ERRSIO   DC    C'SIO'                                                   76380020
ERRTIO   DC    C'TIO'                                                   76440020
ERRHIO   DC    C'HIO'                                                   76500020
NOUCB    DC    C'   NO ADDITIONAL ERROR INFORMATION AVAILABLE.'         76560020
COMCODE  DC    C'   TERMINATION BY  --  '                               76620020
SYSRES   DC    C' SYSTEM RESET- CODE 3'                                 76680020
SELRES   DC    C' SELECTIVE RESET- CODE 2'                              76740020
FORCEND  DC    C' FORCED ENDING SEQUENCE- CODE 1'                       76800020
INTDISCN DC    C' INTERFACE DISCONNECT- CODE 0'                         76860020
RETCDVAL DC    C'   TIME CHANNEL DETECTED ERROR -'                      76920020
RCMSG    DC    C'RETRY CODE    '                                        76980020
MSGSTRT  DC    C' WHILE EXECUTING TIO                        '          77040020
         DC    C' BETWEEN COMMAND OUT AND UNIT STATUS RETURN '          77100020
         DC    C' COMMAND ACCEPTED BUT BEFORE DATA TRANSFER  '          77160020
         DC    C' SOME DATA TRANSFER-CSW COMMAND ADR UPDATED '          77220020
         DC    C' COMMAND REJECTED OR COMMAND OUT NOT SENT   '          77280020
         DC    C' COMMAND ACCEPTED-DATA TRANSFER UNDETERMINED'          77340020
         DC    C' COULD NOT BE ASSESSED                      '          77400020
NOTVM    DC    C' COULD NOT BE ASSESSED                      '          77460020
NORETRY  DC    C'   PROGRAM ASSESSED NO RETRY'                          77520020
DISCIN   DC    C'   DISCONNECT IN ISSUED'                         19032 77580020
VALIDITY DC    C'   VALIDITY OF RECORDED DATA '                         77640020
VALCOUNT DC    C'            COUNT              = NOT VALID'            77700020
SENSDATA DC    C'            SENSE DATA         = NOT STORED'           77760020
INVALUN  DC    C'            UNIT STATUS        = NOT VALID'            77820020
INVALCAD DC    C'            COMMAND ADDRESS    = NOT VALID'            77880020
INVALCHA DC    C'            CHANNEL ADDRESS    = NOT VALID'            77940020
INVALDVA DC    C'            DEVICE ADDRESS     = NOT VALID'            78000020
PSOERR   DC    C'   PROBABLE SOURCE OF ERROR- '                         78060020
CPUERMSG DC    C'CPU'                                                   78120020
CHANERMS DC    C'CHANNEL'                                               78180020
SCUERMS  DC    C'STORAGE CONTROL UNIT'                            19032 78240020
STOGERMS DC    C'STORAGE'                                               78300020
IOINFER  DC    C'CONTROL UNIT '                                         78360020
HEADER   DC    C' CHANNEL  ERROR  ANALYSIS'                             78420020
ERMSG    DC    C'CHANNEL CTRL OR I/F CTRL CHECK '                       78480020
         DC    C'NOT INDICATED IN CSW-NO LOGOUT'                        78540020
         DC    C' WITH THIS RECORD'                                     78600020
NOLOG    DC    C'CHANNEL FAILED TO LOG'                                 78630002
MSHEAD   DC    C'MULTI-SYSTEM INFORMATION'              MESSAGES   MP   78660020
MSCPUID  DC    C'CPU 1 FAILED'                           FOR        MP  78720020
MSCPUST  DC    C'CPU STATUS WAS '              ONLY THE            MP   78780020
PART     DC    C'PARTITIONED'                           M65MP TO BE  MP 78840020
SHAR     DC    C'SHARED'                        ONLY                MP  78900020
RECON    DC    C' BUT RECONFIGURED OUT'                 WRITTEN ON  MP  78960020
CHCNFIG  DC    C'CPU 1 CHANNEL CONFIGURATION'            SEC       MP   79020020
CHTAB    DC    C'CH0--ON CH1--ON CH2--ON CH3--ON CH4--ON'  *       MP   79080020
         DC    C' CH5--ON CH6--ON'                    STORAGE  FOR   MP 79140020
MSNERPIB DC    C'ERPIB NOT CREATED'         EREP RECORDS           MP   79260020
OFF      DC    C'OFF'                         CONSTANTS            MP   79320020
         DC    C'LINE   '                       MESSAGES            MP  79380020
LEVELVD  EQU    3            MODULE LEVEL INDICATOR                MP   79440020
         DROP  R15                                                      79500020
         EJECT                                                          79560020
FORMAT1  DC    F'0'                                                     79620020
FORMAT2  DC    F'0'                                                     79680020
LABELPTR DC    A(LABLAREA)                                              79740020
DISP     DC    FL2'0'                                                   79800020
         EJECT                                                          79860020
         SPACE 2                                                        79920020
* * * * * * * * * 2870 MPX CHANNEL DATA FORMATTER * * * * * * * * *     79980020
         SPACE 2                                                        80040020
         DC    X'01'                                                    80100020
         DC         X'000B8B00'         SKIP TO CHANNEL 1               80160020
         LABEL ' '                                                      80220020
*                                                                       80280020
         LINE       (9,40),(1,35),SKIP=2                                80340020
         HEX        XMOD,0,2B                                           80400020
         HEX        XSER,0,3B                                           80460020
         LABEL      'MODEL','SERIAL NO.'                                80520020
*                                                                       80580020
         LINE  (10,)                                                    80580202
         ROUTINE    XRELN,CONVREL                                       80580402
         LABEL      'XXXX REL.'                                         80580602
         LINE       (21,40)                                             80640020
         ROUTINE    XKEY,SETSOURC                                       80700020
         LABEL      '--- RECORD SOURCE -','TYPE - INBOARD'              80760020
*                                                                       80820020
         LINE                                                           80880020
         ROUTINE    XJOBN,SETPGMN                                       80940020
         LABEL      'JOB NAME'                                          81000020
*                                                                       81060020
         LINE       ,(8,40),SKIP=1                                      81120020
         ROUTINE    XSWS8,CONVTIME                                      81180020
         LABEL      'DAY  YEAR','HH MM SS.TH'                           81240020
         LINE       (8,40),(1,40),SKIP=2                                81300020
         ROUTINE    XDATE,SETDATE                                       81360020
         HEX        XTIME,1,4B                                          81420020
         LABEL      'DATE _','TIME _'                                   81480020
*                                                                       81540020
         LINE       (23,1),(1,1)                                        81600020
         HEX        XCUA,0,3B                                           81660020
         LABEL      'CHANNEL/UNIT ADDRESS'                              81720020
         LINE  (30,1),(1,1),SKIP=2                             @YL02021 81730002
         ROUTINE   XKEY,ISITVS2                                @YL02021 81740002
         HEX   VCUA                                            @YL02021 81750002
         LABEL 'ADDR. STORED IN LOC 184'                       @YL02021 81760002
*                                                                       81780020
         LINE       ,(14,1),SKIP=1                                      81840020
         ROUTINE    XKEY,SKIPPER                                        81900020
         LABEL      'CC   DA    FL     CT'                              81960020
         LINE       (14,3),(1,1),SKIP=2                                 82020020
         HEX        XFCCWCC,0,1B                                        82080020
         HEX        XFCCWDA,0,3B                                        82140020
         ROUTINE    XKEY,SPACER2                                        82200020
         HEX        XFCCWFL,0,1B                                        82260020
         HEX        XFCCW0,0,1B                                         82320020
         HEX        XFCCWCT,0,2B                                        82380020
         LABEL      'FAILING CCW'                                       82440020
*                                                                       82500020
         LINE       ,(14,1),SKIP=1                                      82560020
         ROUTINE    XKEY,SKIPPER                                        82620020
         LABEL      'K    CA    US CS  CT'                              82680020
         LINE       (14,3),(1,1),SKIP=2                                 82740020
         HEX        XCSWK,0,1B                                          82800020
         HEX        XCSWCA,0,3B                                         82860020
         ROUTINE    XKEY,SPACER2                                        82920020
         ROUTINE    XCSWUS0,SETHEX                                      82980020
         ROUTINE    XCSWCS0,SETHEX                                      83040020
         HEX        XCSWCT,0,2B                                         83100020
         LABEL      'CSW'                                               83160020
*                                                                       83220020
         LINE       ,(2,38),SKIP=1                                      83280020
         ROUTINE    XKEY,SKIPPER                                        83340020
         LABEL      'UNIT STATUS','CHANNEL STATUS'                      83400020
*                                                                       83460020
         LINE       (21,38),(3,38)                                      83520020
         BIN        XCSWUS0                                             83580020
         BIN        XCSWCS0                                             83640020
         LABEL      'ATTENTION','PRGM-CTLD IRPT'                        83700020
         LINE                                                           83760020
         BIN        XCSWUS1                                             83820020
         BIN        XCSWCS1                                             83880020
         LABEL      'STATUS MODIFIER','INCORRECT LENGTH'                83940020
         LINE                                                           84000020
         BIN        XCSWUS2                                             84060020
         BIN        XCSWCS2                                             84120020
         LABEL      'CONTROL UNIT END','PROGRAM CHECK'                  84180020
         LINE                                                           84240020
         BIN        XCSWUS3                                             84300020
         BIN        XCSWCS3                                             84360020
         LABEL      'BUSY','PROTECTION CHECK'                           84420020
         LINE                                                           84480020
         BIN        XCSWUS4                                             84540020
         BIN        XCSWCS4                                             84600020
         LABEL      'CHANNEL END','CHAN DATA CHECK'                     84660020
         LINE                                                           84720020
         BIN        XCSWUS5                                             84780020
         BIN        XCSWCS5                                             84840020
         LABEL      'DEVICE END','CHAN CTRL CHECK'                      84900020
         LINE                                                           84960020
         BIN        XCSWUS6                                             85020020
         BIN        XCSWCS6                                             85080020
         LABEL      'UNIT CHECK','I/F CTRL CHECK'                       85140020
         LINE       ,,SKIP=2                                            85200020
         BIN        XCSWUS7                                             85260020
         BIN        XCSWCS7                                             85320020
         LABEL      'UNIT EXCEPTION','CHAINING CHECK'                   85380020
*                                                                       85440020
         LINE       ,(1,1),SKIP=1                                       85500020
         ROUTINE    XKEY,SKIPPER                                        85560020
         LABEL      'I/O UNIT FOUND BUSY'                               85620020
         LINE       (27,5),(2,1),SKIP=2                                 85680020
         HEX        XAIO1                                               85740020
         HEX        XAIO2                                               85800020
         HEX        XAIO3                                               85860020
         HEX        XAIO4                                               85920020
         HEX        XAIO5                                               85980020
         HEX        XAIO6                                               86040020
         HEX        XAIO7                                               86100020
         HEX        XAIO8                                               86160020
         ROUTINE    XKEY,SETAIO                                         86220020
         LABEL      'CHANNEL/UNIT ADDR'                                 86280020
*                                                                       86340020
         LINE       ,(1,1),SKIP=1                                       86400020
         LABEL      '--- CHANNEL TYPE ---'                              86460020
         LINE       ,(8,1),SKIP=2                                       86520020
         LABEL      '2870'                                              86580020
         LINE       ,(1,1),SKIP=1                                       86640020
         LABEL      'HEADER SENSE SWITCHES FOUND ON'                    86700020
         LINE       ,(2,1)                                              86760020
         ROUTINE    XSWS8,CHKSW9                                        86820020
         LABEL      'RECORD INCOMPLETE'                                 86880020
         LINE                                                           86940020
         ROUTINE    XSWS8,CHKSW10                                       87000020
         LABEL      'SYSTEM TERMINATED'                                 87060020
         LINE                                                           87120020
         ROUTINE    XSWS8,CHKSW11                                       87180020
         LABEL      'UNSUPPORTED CHANNEL'                               87240020
         LINE                                                           87300020
         ROUTINE    XSWS8,CHKSW12                                       87360020
         LABEL      'CUA ILLEGAL'                                       87420020
         LINE                                                           87480020
         ROUTINE    XSWS8,CHKSW13                                       87540020
         LABEL      'PORTION OF RECORD HAS BEEN DESTROYED'              87600020
         LINE                                                           87660020
         ROUTINE    XSWS8,CHKSW14                                       87720020
         LABEL      'ERP WERE IN PROGRESS'                              87780020
         LINE                                                           87840020
         ROUTINE    XKEY,SKIPPER                                 P0417  87900020
         LABEL      ' '                                          P0417  87960020
PRTERPIB LINE       (1,1),(1,1),SKIP=1                                  88020020
         ROUTINE    XSWS8,IFCASR01                                      88080020
LABELEND LABEL      ''                                                  88140020
         LINE                                                           88190002
         ROUTINE MPXKEYW1,ALLFFF                                 43068  88192002
         LABEL ''                                                       88194002
         LINE  ,(1,1),SKIP=2                                            88200020
         LABEL '2870 MPX CHANNEL'                                       88260020
         LINE  (45,),(22,),SKIP=1                                       88320020
         HEX   MPXKEYW1,,1L                                             88380020
         LABEL 'KEY-CCW'                                                88440020
         LINE                                                           88500020
         HEX   MPXDADR,,3B                                              88560020
         LABEL 'DATA ADR'                                               88620020
         LINE                                                           88680020
         BIN   MPXFLAGS,,7                                              88740020
         LABEL 'FLAGS'                                                  88800020
         LINE                                                           88860020
         HEX   MPXBYCNT,,2B                                             88920020
         LABEL 'BYTE COUNT'                                             88980020
         LINE                                                           89040020
         HEX   MPXKEYW2,,1L                                             89100020
         LABEL 'KEY-CAW'                                                89160020
         LINE                                                           89220020
         HEX   MPXCOMAD,,3B                                             89280020
         LABEL 'COMMAND ADR'                                            89340020
         LINE                                                           89400020
         HEX   MPXUCWP,,1B                                              89460020
         LABEL 'UCW PARITY'                                             89520020
         LINE                                                           89580020
         HEX   MPXCMAD,,3B                                              89640020
         LABEL 'RESID CMND ADR'                                         89700020
         LINE                                                           89760020
         ROUTINE MPXCNLAD,@CHANADR                                      89820020
         LABEL 'CHANNEL ADD'                                            89880020
         LINE  (45,),(22,),SKIP=2                                       89940020
         HEX   MPXUNAD,,1B                                              90000020
         LABEL 'UNIT ADD'                                               90060020
         LINE  ,(2,),SKIP=2                                             90120020
         LABEL 'OPS'                                                    90180020
         LINE  (18,20),(1,20),SKIP=2                                    90240020
         BIN   MPXILEN                                                  90300020
         BIN  MPXHLTBT                                                  90360020
         BIN   MPXOPCOD                                                 90420020
         LABEL 'INCORRECT LEN','HALT I-O BIT','OPERATION CODE'          90480020
         LINE  ,(2,),SKIP=2                                             90540020
         LABEL 'STATUS'                                                 90600020
         LINE  (18,20),(1,20),SKIP=1                                    90660020
         BIN   MPXPREF                                                  90720020
         BIN   MPXPECK                                                  90780020
         BIN   MPXBTCT                                                  90840020
         LABEL 'PREFETCH','PRG CHK','BYTE CT (MSC)'                     90900020
         LINE                                                           90960020
         BIN   MPXDAPC                                                  91020020
         BIN   MPXPROCK                                                 91080020
         BIN   MPXCNTPO                                                 91140020
         LABEL 'DT ADR PRG CHK','PROT CHK','COUNT P0 (SSC)'             91200020
         LINE  (18,20),(1,20),SKIP=2                                    91260020
         BIN   MPXCNCK                                                  91320020
         BIN   MPXDTACK                                                 91380020
         BIN   MPXCNT7                                                  91440020
         LABEL 'CTRL CHK','DATA CHK','COUNT 7 (SSC)'                    91500020
         LINE  ,(2,),SKIP=2                                             91560020
         LABEL 'CONTROL TRIGGERS'                                       91620020
         LINE  (18,20),(1,20),SKIP=1                                    91680020
         BIN   MPXCAW                                                   91740020
         BIN   MPXTSTIO                                                 91800020
         BIN   MPXMOD3                                                  91860020
         BIN   MPXMOD10                                                 91920020
         LABEL 'CAW','TEST I/O','MODE 3','MODE 10'                      91980020
         LINE                                                           92040020
         BIN   MPXCCWR                                                  92100020
         BIN  MPXHLTIO                                                  92160020
         BIN   MPXMOD4                                                  92220020
         BIN   MPXMOD11                                                 92280020
         LABEL 'CCW REQD','HALT I/O','MODE 4','MODE 11'                 92340020
         LINE                                                           92400020
         BIN   MPXCCWIN                                                 92460020
         BIN   MPXPSIO                                                  92520020
         BIN   MPXMOD6                                                  92580020
         BIN   MPXMCBCP                                                 92640020
         LABEL 'CCW IN CHAN','PSEUDO SIO','MODE 6','MC BC PARITY'       92700020
         LINE                                                           92760020
         BIN   MPXDTARQ                                                 92820020
         BIN   MPXMOD1                                                  92880020
         BIN   MPXMOD7                                                  92940020
         BIN   DUM71                                           @YM6454P 93000002
         LABEL 'DATA REQ','MODE 1','MODE 7','TRG 1 NO-OP'      @YM6454P 93030002
         LINE  (18,20),(1,20),SKIP=2                                    93060020
         BIN   MPXGOIO                                                  93120020
         BIN   MPXMOD2                                                  93180020
         BIN   MPXMOD9                                                  93240020
         LABEL 'START I/O','MODE 2','MODE 9'                            93300020
         LINE  ,(1,),SKIP=2                                             93360020
         LABEL 'MAIN CHANNEL CHECKS'                                    93420020
         LINE  (18,20),(1,20),SKIP=1                                    93480020
         BIN   MPXW0UCB                                                 93540020
         BIN   MPXLSA                                                   93600020
         BIN   MPXCBTCT                                                 93660020
         BIN   MPXPRI                                                   93720020
         LABEL 'WORD 0 UCW','LS ADR','BYTE CT','PRIORITY'               93780020
        LINE ,,SKIP=1                                          @YM6454P 93840002
         BIN   MPXW2UCB                                                 93900020
         BIN   MPXSTOR                                                  93960020
         BIN   MPXTOUT                                                  94020020
         BIN   DUM75                                           @YM6454P 94080002
         LABEL 'WORD 2 UCB','STOR','TIMEOUT','IDA FETCH'       @YM6454P 94088002
        LINE ,,SKIP=2                                          @YM6454P 94096002
         BIN  W3UCWCK                                          @YM6454P 94104002
         BIN  SELRST                                           @YM6454P 94112002
         BIN  DISIN                                            @YM6454P 94120002
         LABEL 'WORD 3 UCW','SEL RESET','DISCONNECT IN'        @YM6454P 94128002
         LINE  ,(2,),SKIP=2                                             94140020
         LABEL 'SUB CHANNEL'                                            94200020
         LINE  (18,20),(1,20),SKIP=1                                    94260020
         BIN   MPXUADCK                                                 94320020
         BIN   MPXBYCTC                                                 94380020
         BIN   MPXNOP                                                   94440020
         BIN   MPXADI                                                   94500020
         LABEL 'UNIT ADR','BYTE CT (SSC)','NO RESPONSE','AD-I'          94560020
         LINE  ,,SKIP=2                                                 94620020
         BIN   MPXCOMCK                                                 94680020
         BIN   MPXINSEL                                                 94740020
         BIN   MPXERSEQ                                                 94800020
         BIN   MPXSTI                                                   94860020
         LABEL 'CMND','ICRCT SELN','ICRCT TAG SEQ','ST-I'               94920020
         LINE  ,(2,),SKIP=2                                             94980020
         LABEL 'SELECTOR SUB CHANNEL'                                   95040020
         LINE  (18,20),(1,20),SKIP=1                                    95100020
         BIN   MPXBCP                                                   95160020
         BIN   MPXBC2                                                   95220020
         BIN   MPXILI                                                   95280020
         BIN   MPXCHCK                                                  95340020
         LABEL 'BC P','BC 2','ILI','CHAIN CHK'                          95400020
         LINE                                                           95460020
         BIN   MPXBC4                                                   95520020
         BIN   MPXBC1                                                   95580020
         BIN   MPXDATAC                                                 95640020
         LABEL 'BC 4','BC 1','DATA CHK'                                 95700020
VS2LINE  LINE  ,,SKIP=1                                        @YM2954P 95700702
         ROUTINE   XCHID,VS2TEST                               @YL02021 95701402
VS2LAB   LABEL ''                                              @YM2954P 95702102
         LINE  (30),(1),SKIP=2                                 @YM2954P 95704202
         HEX   VCCHPR1                                         @YM2954P 95734202
         LABEL 'CCH FOOTPRINTS'                                @YM2954P 95764202
         LINE  (50,1),(20,1),SKIP=1                            @YM2954P 95794202
         BIN   VCCHPR01                                        @YM2954P 95824202
         LABEL 'IOS GPRS SAVED'                                @YM2954P 95854202
         LINE  ,                                               @YM2954P 95884202
         BIN   VCCHPR02                                        @YM2954P 95914202
         LABEL 'UCB ADDRESS ZERO'                              @YM2954P 95944202
         LINE  ,                                               @YM2954P 95974202
         BIN   VCCHPR03                                        @YM2954P 96004202
         LABEL 'ERPIB EXISTS'                                  @YM2954P 96034202
         LINE  ,                                               @YM2954P 96064202
         BIN   VCCHPR04                                        @YM2954P 96094202
         LABEL 'IGFCCHSI ENTERED'                              @YM2954P 96124202
         LINE  ,                                               @YM2954P 96154202
         BIN   VCCHPR05                                        @YM2954P 96184202
         LABEL 'IGFCCHII ENTERED'                              @YM2954P 96214202
         LINE  ,                                               @YM2954P 96244202
         BIN   VCCHPR06                                        @YM2954P 96274202
         LABEL 'IGFCCHFE ENTERED'                              @YM2954P 96304202
         LINE  ,                                               @YM2954P 96334202
         BIN   VCCHPR07                                        @YM2954P 96364202
         LABEL 'IGFC60 ENTERED'                                @YM2954P 96394202
         LINE  ,                                               @YM2954P 96424202
         BIN   VCCHPR08                                        @YM2954P 96454202
         LABEL 'IGFC70 ENTERED'                                @YM2954P 96484202
         LINE  ,                                               @YM2954P 96514202
         BIN   VCCHPR09                                        @YM2954P 96544202
         LABEL 'IGDC80 ENTERED'                                @YM2954P 96574202
         LINE  ,                                               @YM2954P 96604202
         BIN   VCCHPR10                                        @YM2954P 96634202
         LABEL 'IGFCIC ENTERED'                                @YM2954P 96664202
         LINE  ,                                               @YM2954P 96694202
         BIN   VCCHPR11                                        @YM2954P 96724202
         LABEL 'IGFCCHRD ENTERED'                              @YM2954P 96754202
         LINE  ,                                               @YM2954P 96784202
         BIN   VCCHPR12                                        @YM2954P 96814202
         LABEL 'IGFCCHMP ENTERED'                              @YM2954P 96844202
         LINE  ,                                               @YM2954P 96874202
         BIN   VCCHPR13                                        @YM2954P 96904202
         LABEL 'IGFCCHUC ENTERED'                              @YM2954P 96934202
         LINE  ,                                               @YM2954P 96964202
         BIN   VCCHPR14                                        @YM2954P 96994202
         LABEL 'IGFCCHAS ENTERED'                              @YM2954P 97024202
         LINE  ,                                               @YM2954P 97054202
         BIN   VCCHPR15                                        @YM2954P 97084202
         LABEL 'IGFCCHIO ENTERED'                              @YM2954P 97114202
         LINE  ,,SKIP=2                                        @YM2954P 97144202
         BIN   VCCHPR16                                        @YM2954P 97174202
         LABEL 'IGFCCHEX ENTERED'                              @YM2954P 97204202
         LINE  ,(30,30),SKIP=2                                 @YM2954P 97234202
         ROUTINE    XCHID,SKIPPER                              @YM2954P 97264202
         LABEL 'MULTIPROCESSING INFORMATION'                   @YM2954P 97294202
         LINE  ,(22,40),SKIP=2                                 @Z30CIMC 97301202
         ROUTINE XCRH,CRHACT                                   @Z30CIMC 97308202
         LABEL 'CHANNEL RECONFIGURATION HARDWARE IS ACTIVE'    @Z30CIMC 97315202
NOTCRH   LINE  ,(49,1),SKIP=1                                  @Z30CIMC 97324202
NOTCRH1  LABEL '0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15'         97354202
         LINE  (25,25),(30,30),SKIP=1                          @YM2954P 97384202
         HEX   (VPROC01)                                       @YM2954P 97414202
         ROUTINE    VCHST01,PROC                               @YM2954P 97444202
         LABEL ''                                              @YM2954P 97474202
         LINE  ,                                               @YM2954P 97504202
         HEX   (VPROC02)                                       @YM2954P 97534202
         ROUTINE    VCHST02,PROC                               @YM2954P 97564202
         LABEL ''                                              @YM2954P 97594202
         LINE  ,                                               @YM2954P 97624202
         HEX   (VPROC03)                                       @YM2954P 97654202
         ROUTINE    VCHST03,PROC                               @YM2954P 97684202
         LABEL ''                                              @YM2954P 97714202
         LINE  ,                                               @YM2954P 97744202
         HEX   (VPROC04)                                       @YM2954P 97774202
         ROUTINE    VCHST04,PROC                               @YM2954P 97804202
         LABEL ''                                              @YM2954P 97834202
         LINE  ,                                               @YM2954P 97864202
         HEX   (VPROC05)                                       @YM2954P 97894202
         ROUTINE    VCHST05,PROC                               @YM2954P 97924202
         LABEL ''                                              @YM2954P 97954202
         LINE  ,                                               @YM2954P 97984202
         HEX   (VPROC06)                                       @YM2954P 98014202
         ROUTINE    VCHST06,PROC                               @YM2954P 98044202
         LABEL ''                                              @YM2954P 98074202
         LINE  ,                                               @YM2954P 98104202
         HEX   (VPROC07)                                       @YM2954P 98134202
         ROUTINE    VCHST07,PROC                               @YM2954P 98164202
         LABEL ''                                              @YM2954P 98194202
         LINE  ,                                               @YM2954P 98224202
         HEX   (VPROC08)                                       @YM2954P 98254202
         ROUTINE    VCHST08,PROC                               @YM2954P 98284202
         LABEL ''                                              @YM2954P 98314202
         LINE  ,                                               @YM2954P 98344202
         HEX   (VPROC09)                                       @YM2954P 98374202
         ROUTINE    VCHST09,PROC                               @YM2954P 98404202
         LABEL ''                                              @YM2954P 98434202
         LINE  ,                                               @YM2954P 98464202
         HEX   (VPROC10)                                       @YM2954P 98494202
         ROUTINE    VCHST10,PROC                               @YM2954P 98524202
         LABEL ''                                              @YM2954P 98554202
         LINE  ,                                               @YM2954P 98584202
         HEX   (VPROC11)                                       @YM2954P 98614202
         ROUTINE    VCHST11,PROC                               @YM2954P 98644202
         LABEL ''                                              @YM2954P 98674202
         LINE  ,                                               @YM2954P 98704202
         HEX   (VPROC12)                                       @YM2954P 98734202
         ROUTINE    VCHST12,PROC                               @YM2954P 98764202
         LABEL ''                                              @YM2954P 98794202
         LINE  ,                                               @YM2954P 98824202
         HEX   (VPROC13)                                       @YM2954P 98854202
         ROUTINE    VCHST13,PROC                               @YM2954P 98884202
         LABEL ''                                              @YM2954P 98914202
         LINE  ,                                               @YM2954P 98944202
         HEX   (VPROC14)                                       @YM2954P 98974202
         ROUTINE    VCHST14,PROC                               @YM2954P 99004202
         LABEL ''                                              @YM2954P 99034202
         LINE  ,                                               @YM2954P 99064202
         HEX   (VPROC15)                                       @YM2954P 99094202
         ROUTINE    VCHST15,PROC                               @YM2954P 99124202
         LABEL ''                                              @YM2954P 99154202
         LINE  ,                                               @YM2954P 99184202
         HEX   (VPROC16)                                       @YM2954P 99214202
         ROUTINE    VCHST16,PROC                               @YM2954P 99244202
         LABEL ''                                              @YM2954P 99274202
DMPSPACE LINE  ,,SKIP=2                                        @Z30CIMC 99281202
         ROUTINE XDUM1,SKIPPER                                 @Z30CIMC 99288202
DMPSPC1  LABEL ''                                              @Z30CIMC 99295202
DUMPCODE DC    XL1'FF'                                         @YM2954P 99304202
DUMPSIZE DC    XL2'1E8'                                        @YM2954P 99334202
         DC    XL2'18'                                         @YM2954P 99364202
ADDRLABL DC    XL2'0'                                          @YM2954P 99394202
LABLAREA EQU   *                                               @YM2954P 99424202
         LSTART ,                                              @YM2954P 99454202
         END   ENTRYPTR                                        @YM2954P 99484202
