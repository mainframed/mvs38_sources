         TITLE 'IFCEI135 MODEL 135 CHANNEL EDIT'                        00050002
         MACRO                                                          00100002
&NAME    DSGEN                                                          00150002
.*                            THIS MACRO GENERATES ONE DSECT WORD       00200002
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00250002
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  00300002
.*                                 FIRST IS THE NAME OF THE LOG ITEM    00350002
.*                                 WHILE THE SECOND IS THE # OF BITS TO 00400002
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   00450002
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 00500002
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      00550002
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  00600002
.*                                 THE LOG ITEMS MAY THEN BE USED IN    00650002
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   00700002
         GBLC &ITEM(1500)                                               00750002
         GBLA &ITEMNBR,&BITS(1500),&SHIFT(1500)                         00800002
         LCLB  &ONLY1,&CTIND                                            00850002
         LCLA  &START1,&START2,&END1,&END2                              00900002
         LCLC  &SYMBOL,&EQUSYM                                          00950002
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 01000002
         ACTR  100000                                                   01050002
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            01100002
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     01150002
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' AND '&SYSLIST(&OP+1,4)' EQ '').ERR1  01200002
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   01250002
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        01300002
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            01350002
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             01400002
         AGO   .SET2A                   BRANCH AROUND                   01450002
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              01500002
         MEXIT                                                          01550002
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X01600002
               ).SET2                   TEST FOR NO SECOND              01650002
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   01700002
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        01750002
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            01800002
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              01850002
         AGO   .LOOP                                                    01900002
.SET2    ANOP                                                           01950002
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 02000002
         AGO   .LOOP                                                    02050002
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             02100002
         MEXIT                                                          02150002
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               02200002
         MEXIT                                                          02250002
.LOOP    ANOP                                                           02300002
&OP      SETA  &OP+1                                                    02350002
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           02400002
&ITEMNBR SETA  &ITEMNBR+1                                               02450002
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            02500002
         MNOTE '**NULL BIT COUNT FIELD**'                               02550002
         MEXIT                                                          02600002
.OK1     ANOP                                                           02650002
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        02700002
         AIF   ('&SYMBOL' NE '').OK                                     02750002
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         02800002
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         02850002
         AGO   .START                   GET NEXT                        02900002
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        02950002
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          03000002
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        03050002
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         03100002
         AGO   .NO3                     BRANCH AROUND                   03150002
.OK2     ANOP                                                           03200002
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              03250002
.NO3     ANOP                                                           03300002
&SYMBOL  EQU   *+&BYTE                                                  03350002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             03400002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    03450002
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    03500002
.CNT     ANOP                                                           03550002
&CTIND   SETB  1                        SET COUNT INDICATOR             03600002
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   03650002
&BYTE    SETA  &COUNT/8                                                 03700002
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        03750002
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        03800002
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             03850002
&END1    SETA  &END1+1                  INCREMENT COUNT                 03900002
&OP      SETA  &OP-1                    DECREMENT INCREMENT             03950002
         AGO   .LOOP                    GENERATE NEXT                   04000002
.TSTST   ANOP                                                           04050002
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               04100002
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        04150002
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      04200002
.NSET1   ANOP                                                           04250002
&OP      SETA  &OP-1                    DECREMENT INDEX                 04300002
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           04350002
         AGO   .LOOP                    GO DO NEXT                      04400002
.LPDONE  ANOP                                                           04450002
&ONLY1   SETB  0                        CLEAR INDICATOR                 04500002
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      04550002
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 04600002
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               04650002
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             04700002
&NAME    DS    &COUNT.C                                                 04750002
.END     MEXIT                                                          04800002
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          04850002
         MEXIT                                                          04900002
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   04950002
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   05000002
         MEXIT                                                          05050002
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         05100002
*****               THE FOLLOWING STATEMENT                *****        05150002
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        05200002
.EQU2    ANOP                                                           05250002
&EQUCNT  SETA  0                        CLEAR COUNTER                   05300002
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 05350002
.EQULOP  ANOP                                                           05400002
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 05450002
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     05500002
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                05550002
         AGO   .EQULOP                  NO-GET NEXT                     05600002
.EQUOUT  ANOP                                                           05650002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  05700002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              05750002
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 05800002
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             05850002
         AGO   .START                   RETURN FOR NEXT                 05900002
         MEND                                                           05950002
         EJECT                                                          06000002
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 06050002
         SPACE 2                                                        06100002
         MACRO                                                          06150002
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      06200002
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     06250002
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    06300002
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 06350002
.*                                 ENTRIES. LASTLY IT DETERMINES THE    06400002
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    06450002
.*                                 THE PREVIOUS LINE AND STORES THAT #  06500002
.*                                 INTO THE APPROPRIATE BYTE.           06550002
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    06600002
.*                                 DATA.                                06650002
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 06700002
.*                                 DATA COLUMN STARTING CHARACTERS.     06750002
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   06800002
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 06850002
.*                                 STARTING CHARACTERS.                 06900002
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   06950002
.*                                 TO BEGIN NEXT PRINTED LINE.          07000002
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       07050002
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   07100002
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 07150002
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   07200002
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 07250002
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    07300002
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   07350002
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   07400002
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  07450002
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   07500002
.*                                 THE SUBJECT LINE                     07550002
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  07600002
         GBLA  &LASTCC,&INITIAL                                         07650002
         GBLC  &NRENTSX                                                 07700002
         GBLC  &CARRCON                                                 07750002
         GBLB  &TEST                                                    07800002
         LCLA  &S                                                       07850002
&NAME    DS    0C                                                       07900002
         AIF   (&INITIAL EQ 0).FIRSTLN                                  07950002
         LINEND                                                         08000002
         AGO   .NTFIRST                                                 08050002
.FIRSTLN ANOP                                                           08100002
&NRENTSX SETC  'N&SYSNDX'                                               08150002
&INITIAL SETA  1                                                        08200002
N&SYSNDX EQU   *                                                        08250002
.NTFIRST ANOP                                                           08300002
         DC    AL1(0)                                                   08350002
         AIF   ('&DATA(1)' EQ '').CKDTABS                               08400002
         AIF   (&DATA(1) EQ &DB).CKDTABS                                08450002
&DB      SETA  &DATA(1)                                                 08500002
         AGO   .AA                                                      08550002
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                08600002
         AIF   (&DATA(2) EQ &DT).NCDATA                                 08650002
         AGO   .CC                                                      08700002
.AA      AIF   ('&DATA(2)' EQ '').BB                                    08750002
         AIF   (&DATA(2) EQ &DT).BB                                     08800002
.CC      ANOP                                                           08850002
&DT      SETA  &DATA(2)                                                 08900002
.BB      DC    XL2'FFFE'                                                08950002
         DC    FL1'&DB'                                                 09000002
         DC    FL1'&DT'                                                 09050002
&NRENTS  SETA  &NRENTS+1                                                09100002
.NCDATA  ANOP                                                           09150002
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              09200002
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               09250002
&LB      SETA  &LABEL(1)                                                09300002
         AGO   .AAA                                                     09350002
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              09400002
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               09450002
         AGO   .CCC                                                     09500002
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  09550002
         AIF   (&LABEL(2) EQ &LT).BBB                                   09600002
.CCC     ANOP                                                           09650002
&LT      SETA  &LABEL(2)                                                09700002
.BBB     DC    XL2'FFFF'                                                09750002
         DC    FL1'&LB'                                                 09800002
         DC    FL1'&LT'                                                 09850002
&NRENTS  SETA  &NRENTS+1                                                09900002
.NCLABEL ANOP                                                           09950002
         AIF   ('&SKIP' NE '').CONT                                     10000002
         AIF   (&TEST EQ 0).NOCHANG                                     10050002
&S       SETA  &LASTCC                                                  10100002
         AGO   .DEFAULT                                                 10150002
.CONT    ANOP                                                           10200002
         AIF   (&TEST EQ 0).AB                                          10250002
&S       SETA  &SKIP                                                    10300002
.DEFAULT ANOP                                                           10350002
         ORG   &CARRCON+3                                               10400002
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 10450002
         ORG                                                            10500002
&LASTCC  SETA  &S                                                       10550002
&TEST    SETB  0                                                        10600002
         AGO   .DD                                                      10650002
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               10700002
A&SYSNDX DC    XL2'FFFB'                                                10750002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              10800002
         DC    FL1'9'                                                   10850002
&LASTCC  SETA  &SKIP                                                    10900002
&TEST    SETB  1                                                        10950002
&CARRCON SETC  'A&SYSNDX'                                               11000002
&NRENTS  SETA  &NRENTS+1                                                11050002
.DD      ANOP                                                           11100002
.NOCHANG ANOP                                                           11150002
         MEND                                                           11200002
         EJECT                                                          11250002
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 11300002
         SPACE 2                                                        11350002
         MACRO                                                          11400002
         BIN                                                            11430002
.*                                 &SYSLIST(&OP,1) - NAME OF LOG ITEM   11460002
.*                                      RECORD DSECT                    11490002
.*                                 $SYSLIST(&OP,2) - NBR OF SPACES      11520002
.*                                      TO SKIP ON MULTIPLE             11550002
.*                                      PRINT OR NBR OF SPACES          11580002
.*                                      TO BACK UP FROM COLUMN FOR      11610002
.*                                      START OF PRINTING. THE LETTER   11640002
.*                                      B PRECEEDS THE NUMBER (B5) IF   11670002
.*                                      THE LATTER IS DESIRED. OMISSION 11700002
.*                                      OF THIS OPERAND FORCES OPTION 2 11730002
.*                                      WITH BACKUP SPACING EQUAL TO    11760002
.*                                 THE NUMBER OF BITS IN THE ITEM       11790002
.*                                 DEFINITION (VIA MACRO 'DSGEN').      11820002
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     11850002
.*                                 TOTAL NUMBER OF BITS TO PRINT.       11880002
         GBLC &ITEM(1500)                                               11910002
         GBLA &ITEMNBR,&BITS(1500),&SHIFT(1500),&NRENTS                 11940002
         GBLC  &DSECT                                                   11970002
         LCLB  &B,&SUB                                                  12000002
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   12030002
         LCLA  &TEMP,&T,&OP                                             12060002
         LCLC  &S                                                       12090002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  12120002
&SUB     SETB  1                                                        12150002
.LOOP    ANOP                                                           12180002
&OP      SETA  &OP+1                                                    12210002
.LOOP1   ANOP                                                           12240002
&NDX     SETA  &NDX+1                                                   12270002
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               12300002
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 12330002
         MNOTE *,'YOU BLEW IT'                                          12360002
         ROUTINE DUM,SKIPPER                                            12390002
         MEXIT                                                          12420002
.FOUND   ANOP                                                           12450002
&ISHIFT  SETA  &SHIFT(&NDX)                                             12480002
&IBITS   SETA  &BITS(&NDX)                                              12510002
&T       SETA  &IBITS-1                                                 12540002
&B       SETB  0                                                        12570002
         AIF   (&SUB EQ 1).SUBA                                         12600002
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             12630002
&K       SETA  K'&SYSLIST(2)                                            12660002
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              12690002
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                12720002
         AGO   .SUBB                                                    12750002
.SUBA    ANOP                                                           12780002
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         12810002
&K       SETA  K'&SYSLIST(&OP,2)                                        12840002
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          12870002
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            12900002
.SUBB    ANOP                                                           12930002
&T       SETA  &S                                                       12960002
.BACKUP  ANOP                                                           12990002
&NRENTS  SETA  &NRENTS+1                                                13020002
&TEMP    SETA  &ISHIFT                                                  13050002
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2                            13080002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'                13110002
         AGO   .OUT                                                     13140002
.BIN2    AIF   ('&SYSLIST(&OP,2)' NE '').BIN3                           13170002
&B       SETB  1                                                        13200002
.BIN3    ANOP                                                           13230002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'                    13260002
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             13290002
.OUT     ANOP                                                           13320002
&NDX     SETA  0                                                        13350002
         AIF   (&SUB EQ 0).OUTA                                         13380002
         AIF   (&OP LT N'&SYSLIST).LOOP                                 13410002
.OUTA    ANOP                                                           13440002
         MEND                                                           13470002
         EJECT                                                          13850002
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 13900002
         SPACE 2                                                        13950002
         MACRO                                                          14000002
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 14050002
.*                            THIS MACRO FACILITATES GENERATION OF THE  14100002
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    14150002
.*                                 CONVERSIONS.                         14200002
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        14250002
.*                                 CONVERTED                            14300002
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    14350002
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   14400002
.*                                 BACK UP FROM COLUMN FOR START OF     14450002
.*                                 PRINTING. THE LETTER B PRECEEDS THE  14500002
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  14550002
.*                                 DESIRED. OMISSION OF THIS OPERAND    14600002
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  14650002
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  14700002
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 14750002
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    14800002
.*                                 IMPLICITLY B).                       14850002
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   14900002
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     14950002
.*                                 WITH AN L,R, OR B TO STIPULATE       15000002
.*                                 PRINTING OF THE LEFT HALF, RIGHT     15050002
.*                                 HALF, OR BOTH HALVES OF THE BYTE     15100002
.*                                 RESPECTIVELY. OMISSION OF THIS       15150002
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  15200002
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 15250002
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 15300002
.*                                 SARY. THIS MACRO MUST BE THE FIRST   15350002
.*                                 MACRO INSTRUCTION ISSUED FOR THE     15400002
.*                                 SUBJECT LINE(S).                     15450002
         GBLC  &ITEM(1500),&DSECT                                       15500002
         GBLA  &ITEMNBR,&BITS(1500),&SHIFT(1500),&NRENTS                15550002
         LCLB  &B                                                       15600002
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  15650002
         LCLC  &S,&LETTER                                               15700002
.LOOP    ANOP                                                           15750002
&NDX     SETA  &NDX+1                                                   15800002
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      15850002
         AIF   (&NDX LT &ITEMNBR).LOOP                                  15900002
         MNOTE *,'LOG ITEM NOT DEFINED'                                 15950002
         MEXIT                                                          16000002
.FOUND   ANOP                                                           16050002
&ISHIFT  SETA  &SHIFT(&NDX)                                             16100002
&IBITS   SETA  &BITS(&NDX)                                              16150002
&CODE    SETA  1                                                        16200002
&K       SETA  K'&BYTES                                                 16250002
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            16300002
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   16350002
         MEXIT                                                          16400002
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 16450002
&LETTER  SETC  '&BYTES'(&K,1)                                           16500002
&S       SETC  '&BYTES'(1,&K-1)                                         16550002
&BYTESP  SETA  &S                                                       16600002
         AIF   ('&LETTER' EQ 'B').BOTH                                  16650002
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       16700002
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            16750002
         MEXIT                                                          16800002
.USEDEFN ANOP                                                           16850002
&BYTESP  SETA  &IBITS/8                                                 16900002
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       16950002
&CODE    SETA  3                                                        17000002
&T       SETA  &BYTESP*2-1                                       XM5997 17050002
&S       SETC  '&T'                                                     17100002
.OK2     AIF   (&ISHIFT EQ 0).L                                         17150002
&CODE    SETA  2                                                        17200002
.L       ANOP                                                           17250002
&B       SETB  1                                                        17300002
         AIF   ('&SKIP$OR' EQ '').BACKUP                                17350002
&K       SETA  K'&SKIP$OR                                               17400002
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 17450002
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   17500002
.BACKUP  ANOP                                                           17550002
&NRENTS  SETA  &NRENTS+1                                                17600002
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           17650002
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              17700002
.OUT     ANOP                                                           17750002
         MEND                                                           17800002
         EJECT                                                          17850002
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 17900002
         SPACE 2                                                        17950002
         MACRO                                                          18000002
&NAME    ROUTINE &LOGITEM,&RNAME                                        18050002
         GBLC  &DSECT,&CSECT                                            18100002
         GBLC  &ITEM(1500)                                              18150002
         GBLA  &SHIFT(1500),&ITEMNBR                                    18200002
         GBLA  &NRENTS                                                  18250002
         LCLA  &ISHIFT,&NDX                                             18300002
.LOOP    ANOP                                                           18350002
&NDX     SETA  &NDX+1                                                   18400002
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      18450002
         AIF   (&NDX LT &ITEMNBR).LOOP                                  18500002
         MNOTE *,'LOG ITEM NOT DEFINED'                                 18550002
         MEXIT                                                          18600002
.FOUND   ANOP                                                           18650002
&ISHIFT  SETA  &SHIFT(&NDX)                                             18700002
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           18750002
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       18800002
&NRENTS  SETA  &NRENTS+1                                                18850002
         MEND                                                           18900002
         EJECT                                                          18950002
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 19000002
         SPACE 2                                                        19050002
         MACRO                                                          19100002
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C19150002
               &LABEL7,&LABEL8                                          19200002
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    19250002
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   19300002
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  19350002
.*                                 TION MARKS. THE COLUMN AND LINE END  19400002
.*                                 CONTROLS WILL BE INSERTED BY THE     19450002
.*                                 MACRO. OMITTED OPERANDS MEAN NO      19500002
.*                                 LABEL REQUIRED FOR RESPECTIVE        19550002
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   19600002
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  19650002
.*                                 TABLE MUST BE BROKEN IF NECESSARY    19700002
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 19750002
         GBLC &LABELS(2000)                                             19800002
         GBLC  &LBL(100)                                                19850002
         GBLA  &LBLCTR(100)                                             19900002
         GBLA  &LABELNR                                                 19950002
         GBLA  &NRENTS,&LPTR                                            20000002
         LCLC  &MARGIN,&TACK                                            20050002
         LCLC  &TEXT                                                    20100002
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            20150002
&MARGIN  SETC  '*'                                                      20200002
         AIF   ('&NAME' EQ '').LOOPOUT                                  20250002
&LPTR    SETA  &LPTR+1                                                  20300002
&LBL(&LPTR) SETC '&NAME'                                                20350002
&LBLCTR(&LPTR) SETA &LABELNR+1                                          20400002
.LOOPOUT ANOP                                                           20450002
&OP      SETA  &OP+1                                                    20500002
&K       SETA  K'&SYSLIST(&OP)                                          20550002
         AIF (&K GE 2).NORM                                             20600002
&K       SETA  2                                                        20650002
.NORM    ANOP                                                           20700002
&START   SETA  2                                                        20750002
         AIF (&OP LT N'&SYSLIST).NOTLAST                                20800002
&MARGIN  SETC  '$'                                                      20850002
.NOTLAST ANOP                                                           20900002
&NRCHAR  SETA  8                                                        20950002
&TACK    SETC  ''                                                       21000002
.LOOPIN  ANOP                                                           21050002
&REMAIN  SETA  &K-&START                                                21100002
         AIF (&REMAIN GE 8).MORE                                        21150002
&TACK    SETC  '&MARGIN'                                                21200002
&NRCHAR  SETA  &REMAIN                                                  21250002
.MORE    ANOP                                                           21300002
&TEXT    SETC  ''                                                       21350002
         AIF (&REMAIN EQ 0).ENDTEXT                                     21400002
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          21450002
.ENDTEXT ANOP                                                           21500002
&LABELNR SETA  &LABELNR+1                                               21550002
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  21600002
&START   SETA  &START+8                                                 21650002
         AIF ('&TACK' EQ '').LOOPIN                                     21700002
         AIF ('&TACK' EQ '*').LOOPOUT                                   21750002
         MEND                                                           21800002
         SPACE 2                                                        21850002
         MACRO                                                          21900002
         LSTART                                                         21950002
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  22000002
.*                                 OF THE TABLE IS TO BEGIN.            22050002
         GBLC &LABELS(2000)                                             22100002
         GBLA  &LABELNR                                                 22150002
         GBLC  &LBL(100)                                                22200002
         GBLA  &LBLCTR(100)                                             22250002
         LCLA  &NDX,&CTR                                                22300002
         LINEND                                                         22350002
&CTR     SETA  1                                                        22400002
.LOOP    ANOP                                                           22450002
&NDX     SETA  &NDX+1                                                   22500002
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            22550002
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         22600002
&CTR     SETA  &CTR+1                                                   22650002
         AGO   .LOOPCTL                                                 22700002
.NOLBL   ANOP                                                           22750002
         DC    C'&LABELS(&NDX)'                                         22800002
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  22850002
         MEND                                                           22900002
         SPACE 2                                                        22950002
         MACRO                                                          23000002
         LINEND                                                         23050002
.*                            THIS MACRO IS USED ONLY BY THE LINE       23100002
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   23150002
.*                                 ASSOCIATED WITH EACH LINE.           23200002
         GBLA  &NRENTS                                                  23250002
         GBLC &NRENTSX                                                  23300002
         ORG   &NRENTSX                                                 23350002
         DC    FL1'&NRENTS'                                             23400002
         ORG                                                            23450002
&NRENTS  SETA  0                                                        23500002
B&SYSNDX EQU   *                                                        23550002
&NRENTSX SETC  'B&SYSNDX'                                               23600002
         MEND                                                           23650002
         SPACE 2                                                        23700002
         MACRO                                                          23750002
         PARITY &ENTRY,&REPEAT,&SPACES,&PBITS=,&DISP=,&OFFBYTE=         23800002
         GBLC  &ITEM(1500),&DSECT                                       23850002
         GBLA  &SHIFT(1500),&ITEMNBR                                    23900002
         LCLA  &IBITS,&NDX,&ISHIFT                                      23950002
         DC    AL4(&ENTRY)                                              24000002
         DC    AL1(&REPEAT)                                             24050002
         DC    AL1(&SPACES)                                             24100002
         AIF   ('&PBITS' EQ '').HARDCD                                  24150002
.LOOP    ANOP                                                           24200002
&NDX     SETA  &NDX+1                                                   24250002
         AIF   ('&ITEM(&NDX)' EQ '&PBITS').FOUND                        24300002
         AIF   (&NDX LT &ITEMNBR).LOOP                                  24350002
         MNOTE *,'PARITY GROUP NOT FOUND'                               24400002
         MEXIT                                                          24450002
.FOUND   ANOP                                                           24500002
&ISHIFT  SETA  &SHIFT(&NDX)                                             24550002
         DC    AL.12(&PBITS-&DSECT),AL.4(&ISHIFT)                       24600002
         AGO   .OUT                                                     24650002
.HARDCD  ANOP                                                           24700002
&ISHIFT  SETA  &OFFBYTE                                                 24750002
         DC    AL.12(&DISP),AL.4(&ISHIFT)                               24800002
.OUT     ANOP                                                           24850002
         MEND                                                           24900002
         GBLC  &DSECT,&CSECT                                            24950002
&CSECT   SETC  'IFCEI135'                                               25000002
&DSECT   SETC  'CI135'                                                  25050002
IFCEI135 CSECT                                                          25100002
CI135    DSECT                                                          25150002
         DS    0F                                                       25200002
         DSGEN (XKEY,8),(XRELN,8),(XSWS8,9),(XSWS9,1),(XSWS10,1),      C25250002
               (XSWS11,1),                                             C25300002
               (XSWS12,1),(XSWS13,1),(XSWS14,1),(XSWS15,1)              25350002
         DSGEN (XDUM1,32)                                               25400002
         DSGEN (XDATE,32)                                               25450002
         DSGEN (XTIME,32)                                               25500002
         DSGEN (XDUM2,8),(XSER,24)                                      25550002
         DSGEN (XMOD,16),(MCEL,16)                                      25600002
         DSGEN (XJOBN,64)                                               25650002
         DSGEN (XAIO1,16),(XAIO2,16),(XAIO3,16),(XAIO4,16)              25700002
         DSGEN (XAIO5,16),(XAIO6,16),(XAIO7,16),(XAIO8,16)              25750002
         DSGEN (XFCCWCC,8),(XFCCWDA,24),(XFCCWFL,8),(XFCCW0,8),        C25800002
               (XFCCWCT,16)                                             25850002
         DSGEN (XCSWK,8),(XCSWCA,24)                                    25900002
         DSGEN (XCSWUS0,1),(XCSWUS1,1),(XCSWUS2,1),(XCSWUS3,1),        *25950002
               (XCSWUS4,1),(XCSWUS5,1),(XCSWUS6,1),(XCSWUS7,1),        *26000002
               (XCSWCS0,1),(XCSWCS1,1),(XCSWCS2,1),(XCSWCS3,1),        *26050002
               (XCSWCS4,1),(XCSWCS5,1),(XCSWCS6,1),(XCSWCS7,1),        *26100002
               (XCSWCT,16)                                              26150002
         DSGEN (XECSW,32)                                               26200002
         DSGEN (XDEVT1,16),(XDEVT2,16)                                  26250002
         DSGEN (XCHID,8),(XCUA,24)                                      26300002
         DSGEN (XMPIN,32)                                               26350002
         DSGEN (XDUM3,32)                                       XA04755 26370002
         DSGEN (MCHRG00,1),(MCHRG01,1),(MCHRG02,1),(MCHRG03,1),        X26400002
               (MCHRG04,1),(MCHRG05,1),(MCHRG06,1),(MCHRG07,1),        X26450002
               (MCHRG08,1),(MCHRG09,1),(MCHRG10,1),(MCHRG11,1),        X26500002
               (MCHRG12,1),(MCHRG13,1),(MCHRG14,1),(MCHRG15,1),        X26550002
               (MCHRG16,1),(MCHRG17,1),(MCHRG18,1),(MCHRG19,1),        X26600002
               (MCHRG20,1),(MCHRG21,1),(MCHRG22,1),(MCHRG23,1),        X26650002
               (MCHRG24,1),(MCHRG25,1),(MCHRG26,1),(MCHRG27,1),        X26700002
               (MCHRG28,1),(MCHRG29,1),(MCHRG30,1),(MCHRG31,1)          26750002
         DSGEN (BUFADRG,16)                                             26800002
         DSGEN (ZONER00,1),(ZONER01,3),(ZDUMY,1),(ZONER03,3),  @XA06108X27050002
               (SAREG00,24)                                             27100002
SEL135   DSGEN (BFCTRG00,1),(BFCTRG01,1),(BFCTRG02,1),(BFCTRG03,1),    X27150002
               (BFCTRG04,1),(BFCTRG05,1),(BFCTRG06,2),                 X27200002
               (BFCTRG08,1),(BFCTRG09,1),(BFCTRG10,1),(BFCTRG11,1),    X27250002
               (BFCTRG12,1),(BFCTRG13,3),                              X27300002
               (BFCTRG16,1),(BFCTRG17,1),(BFCTRG18,1),(BFCTRG19,1),    X27350002
               (BFCTRG20,1),(BFCTRG21,1),(BFCTRG22,1),(BFCTRG23,1),    X27400002
               (BFCTRG24,1),(BFCTRG25,1),(BFCTRG26,1),(BFCTRG27,1),    X27450002
               (BFCTRG28,1),(BFCTRG29,1),(BFCTRG30,1),(BFCTRG31,1)      27500002
         DSGEN (DUMMY00,16)                                             27520002
         DSGEN (CHANTG00,1),(CHANTG01,1),(CHANTG02,1),(CHANTG03,1),    X27550002
               (CHANTG04,1),(CHANTG05,1),(CHANTG06,1),(CHANTG07,1),    X27600002
               (CHANTG08,1),(CHANTG09,1),(CHANTG10,1),(CHANTG11,1),    X27650002
               (CHANTG12,1),(CHANTG13,1),(CHANTG14,1),(CHANTG15,1),    X27700002
               (CHANTG16,1),(CHANTG17,1),(CHANTG18,1),(CHANTG19,1),    X27750002
               (CHANTG20,1),(CHANTG21,1),(CHANTG22,1),(CHANTG23,1),    X27800002
               (CHANTG24,1),(CHANTG25,1),(CHANTG26,1),(CHANTG27,1),    X27850002
               (CHANTG28,1),(CHANTG29,1),(CHANTG30,1),(CHANTG31,1)      27900002
         DSGEN (CHCTRG00,1),(CHCTRG01,1),(CHCTRG02,1),(CHCTRG03,1),    X27950002
               (CHCTRG04,1),(CHCTRG05,1),(CHCTRG06,1),(CHCTRG07,1),    X28000002
               (CHCTRG08,1),(CHCTRG09,1),(CHCTRG10,1),(CHCTRG11,1),    X28050002
               (CHCTRG12,1),(CHCTRG13,1),(CHCTRG14,1),(CHCTRG15,1),    X28100002
               (CHCTRG16,1),(CHCTRG17,1),(CHCTRG18,1),(CHCTRG19,1),    X28150002
               (CHCTRG20,1),(CHCTRG21,1),(CHCTRG22,1),(CHCTRG23,1),    X28200002
               (CHCTRG24,1),(CHCTRG25,1),(CHCTRG26,1),(CHCTRG27,1),    X28250002
               (CHCTRG28,1),(CHCTRG29,1),(CHCTRG30,1),(DUMMY,1)         28300002
         DSGEN (CHANCK0,1,0,7),(DUM,8,0,2)                      XA00642 28320002
         DSGEN (CHK0,16,EQU,MCHRG00),(CHK1,16,EQU,MCHRG16)              28350002
         EJECT                                                          28450002
*                                                                       28500002
IFCEP000 DSECT                                                          28550002
         DS    CL6                                                      28600002
         DS    CL1                                                      28650002
         DS    CL1                                                      28700002
XPRTBUF  DS    15CL8                                                    28750002
         DS    5CL8                                                     28800002
         DS    3CL8                                                     28850002
         DS    CL8                                                      28900002
XSWITCH  DS    CL4                                                      28950002
*                                                                       29000002
*      ROUTINE BRANCH TABLE                                             29050002
*                                                                       29100002
         DS    CL112                                                    29150002
*                                                                       29200002
*      LOAD MODULE ENTRYPOINT NAMES                                     29250002
*                                                                       29300002
         DS    CL56                                                     29350002
*                                                                       29400002
*      READ/WRITE BUFFER                                                29450002
*                                                                       29500002
XMCH     DC    XL2'00'                                                  29550002
XCNTBUF  DS    CL8                                                      29600002
XKEYBUF  DS    CL2                                                      29650002
XDADBUF  DS    197CL8                                                   29700002
XDUMMY   DS    CL1                                                      29750002
         SPACE 3                                                        29800002
ERPIB    DSECT                                                    19032 29850002
SOFWFLGS DS    CL1                 PROGRAM FLAGS FIELD IN ERPIB   19032 29900002
PROBERR  DS    CL1                 PROBABLE SOURCE OF ERROR FIELD 19032 29950002
VALFLAGS DS    CL1                 VALIDITY FLAGS FIELD           19032 30000002
CMPLBITS DS    CL1                 TERM AND RETRY CODES FIELD     19032 30050002
MPINFOFD DS    CL2                 MULTI-PROCESSING INFO FIELD    19032 30100002
CHSMS    DS    CL2                 CHANNEL STATUS FIELD           19032 30150002
         EJECT                                                          30200002
IFCEI135 CSECT                                                          30250002
ENTRYPTR DC    A(FORMAT1)                                               30300002
TABLNAME DC    CL8'IFCEI135'                                            30350002
REG9     DS    F                                                        30400002
LP       DS    F                                                        30450002
         SPACE 2                                                        30500002
SPCLCODE EQU   *                                                        30550002
SKIPPER  EQU   *                                                        30600002
         BR    14                                                       30650002
R0       EQU   0                                                        30700002
R1       EQU   1                                                        30750002
R2       EQU   2                                                        30800002
R3       EQU   3                                                        30850002
R4       EQU   4                                                        30900002
R5       EQU   5                                                        30950002
R6       EQU   6                                                        31000002
R7       EQU   7                                                        31050002
R8       EQU   8                                                        31100002
R9       EQU   9                                                        31150002
R10      EQU   10                                                       31200002
R11      EQU   11                                                       31250002
R12      EQU   12                                                       31300002
R13      EQU   13                                                       31350002
R14      EQU   14                                                       31400002
R15      EQU   15                                                       31450002
****    ADDRESS EQUATES                                                 31500002
AD0      EQU   0                                                        31550002
AD1      EQU   1                                                        31600002
AD4      EQU   4                                                        31650002
AD12     EQU   12                                                       31700002
AD13     EQU   13                                                       31750002
AD14     EQU   14                                                       31800002
AD15     EQU   15                                                       31850002
AD16     EQU   16                                                       31900002
AD20     EQU   20                                                       31950002
AD37     EQU   37                                                       32000002
AD41     EQU   41                                                       32050002
AD45     EQU   45                                                       32100002
AD55     EQU   55                                                       32150002
AD63     EQU   63                                                       32200002
AD69     EQU   69                                                       32250002
AD108    EQU   108                                                      32300002
***   LENGTH EQUATES                                                    32350002
L0       EQU   0                                                        32400002
L1       EQU   1                                                        32450002
L2       EQU   2                                                        32500002
L3       EQU   3                                                        32550002
L4       EQU   4                                                        32600002
L5       EQU   5                                                        32650002
L6       EQU   6                                                        32700002
L7       EQU   7                                                        32750002
L8       EQU   8                                                        32800002
L9       EQU   9                                                        32850002
L10      EQU   10                                                       32900002
L12      EQU   12                                                       32950002
L13      EQU   13                                                       33000002
L14      EQU   14                                                       33050002
L15      EQU   15                                                       33100002
L16      EQU   16                                                       33150002
L19      EQU   19                                                       33200002
L20      EQU   20                                                       33250002
L21      EQU   21                                                       33300002
L22      EQU   22                                                       33350002
L24      EQU   24                                                       33400002
L26      EQU   26                                                       33450002
L29      EQU   29                                              @XA06108 33470002
L31      EQU   31                                                       33500002
L32      EQU   32                                                       33550002
L40      EQU   40                                                       33600002
L60      EQU   60                                                       33650002
***   CONDITION CODE EQUATES                                            33700002
CC1      EQU   1                                                        33750002
CC2      EQU   2                                                        33800002
CC4      EQU   4                                                        33850002
CC7      EQU   7                                                        33900002
CC8      EQU   8                                                        33950002
****    NUMERICAL EQUATES                                               34000002
X01      EQU   X'01'                                                    34050002
X02      EQU   X'02'                                                    34100002
X04      EQU   X'04'                                                    34150002
X08      EQU   X'08'                                                    34200002
X09      EQU   X'09'                                                    34250002
X10      EQU   X'10'                                                    34300002
X20      EQU   X'20'                                                    34350002
X30      EQU   X'30'                                                    34400002
X40      EQU   X'40'                                                    34450002
X80      EQU   X'80'                                                    34500002
HEXBF    EQU   X'BF'                                                    34550002
HEX48    EQU   X'48'                                                    34600002
HEX02    EQU   X'02'                                                    34650002
HEX04    EQU   X'04'                                                    34700002
HEX08    EQU   X'08'                                                    34750002
HEX10    EQU   X'10'                                                    34800002
HEX20    EQU   X'20'                                                    34850002
HEX40    EQU   X'40'                                                    34900002
HEX22    EQU   X'22'                                                    34950002
HEX28    EQU   X'28'                                                    35000002
HEX2A    EQU   X'2A'                                                    35050002
HEX29    EQU   X'29'                                                    35100002
HEX01    EQU   X'01'                                                    35150002
HEX00    EQU   X'00'                                                    35200002
DIV1     EQU   X'0A'                                                    35250002
DIV2     EQU   X'0C'                                                    35300002
K1       EQU   1                                                        35350002
K3       EQU   3                                                        35400002
*********************************************************************** 35450002
*                                                                     * 35500002
*                                                                     * 35550002
*    ROUTINE TO PICK UP THE CHANNEL ADDRESS WHICH IS NOT ON A BYTE    * 35600002
*   BOUNDRY, CONVERT IT TO HEX AND STORE IT IN THE PRINT BUFFER.      * 35650002
*                                                                     * 35700002
*                                                                     * 35750002
*********************************************************************** 35800002
         SPACE 2                                                        35850002
@CHANADR DS    0F                                                       35900002
         USING *,15                                                     35950002
         STM   14,12,12(13)        SAVE THE REGS                        36000002
         MVC   MYWORK(1),0(4)                                           36050002
         NI    MYWORK,X'07'                                             36100002
         OI    MYWORK,X'F0'                                             36150002
         S     R3,ONE                                                   36200002
         MVC   0(1,3),MYWORK                                            36250002
         LM    14,12,12(13)        RESTORE THE REGS                     36300002
         BR    14                  RETURN                               36350002
*                                                                       36400002
         DROP  R15                                                      36450002
         USING IFCEI135,R9                                              36500002
SETSOURC STM   R5,R8,XSAVE              SAVE REGS                       36550002
         MVC   L0(L3,R3),CCCH           MOVE CHANNEL RECORD             36600002
         CLI   L0(R4),HEX20             TEST REC SOURCE                 36650002
         BE    RETURN                                                   36700002
         MVC   L0(L3,R3),MCHH           MOVE MCH RECORD                 36750002
         B     RETURN                   RETURN                          36800002
*                                                                       36850002
CONVREL  STM   R5,R8,XSAVE              SAVE WORK REGS                  36900002
         SR    R6,R6                    CLEAR R6                        36950002
         IC    R6,L0(R4)                PICK UP REL & SYS VALUES        37000002
         SRDL  R6,L5                    SAVE REL NO IN R7               37050002
        SLL   R6,L2                    MULTIPLY SYS VALUE BY 4          37100002
         L     R8,XLABELP               PICK UP LABEL POINTER           37150002
         LA    R6,RELTAB(R6)            INDEX INTO TABLE OF SYSTEMS     37200002
         MVC   L0(L4,R8),L0(R6)         MOVE SYSTEM NAME INTO LABEL     37250002
         SR    R6,R6                    CLEAR R6                        37300002
         SLDL  R6,L5                    RETREIVE REL NO.                37350002
         LTR   R6,R6                    IS IT ZERO                      37400002
         BZ    NOREL                    BR-YES                          37450002
         CVD   R6,WORK                  CONVERT IT                      37500002
         UNPK  L0(L2,R3),WORK+L6(L2)    UNPACK IT INTO PRINT BUFF       37550002
         MVZ   L1(L1,R3),L0(R3)         MOVE ON PROPER ZONE             37600002
         B     RETURN                   EXIT                            37650002
NOREL    MVC   L0(L4,R3),NONE           MOVE IN NONE FOR REL            37700002
         B     RETURN                                                   37750002
*                                                                       37800002
SETPGMN  MVC   L0(L8,R3),L0(R4)         MOVE 8 CHAR NAME TO BUFF        37850002
         BR    R14                                                      37900002
*                                                                       37950002
SPACER2  LA    R3,L2(R3)                BUMP R3 PTR BY 2                38000002
         BR    R14                                                      38050002
*                                                                       38100002
SETHEX   STM   R5,R8,XSAVE              SAVE REGS                       38150002
         LA    R8,CHARS                 CHAR TABLE PTR                  38200002
         IC    R7,L0(R4)                PICK UP CHAR                    38250002
         SLL   R7,L24                   MOVE IT TO HI POS               38300002
         SR    R6,R6                                                    38350002
         SLDL  R6,L4                    MOVE 4 BITS TO R6               38400002
         AR    R6,R8                    INDEX FOR CHARS                 38450002
         MVC   L0(L1,R3),L0(R6)         MOVE CHAR TO BUFF               38500002
         SR    R6,R6                                                    38550002
         SLDL  R6,L4                    MOVE LAST 4 BITS TO R6          38600002
         AR    R6,R8                    INDEX INTO TABLE                38650002
         MVC   L1(L1,R3),L0(R6)         MOVE CHAR                       38700002
         B     RETURN                                                   38750002
*                                                                       38800002
*                                                                       38850002
CYCLFLG  STM   R5,R8,XSAVE         SAVE REGS                   @XA06108 38851002
         MVC   QSAVE(L1),L0(R4)    CYCLE FLAG TO WORK AREA     @XA06108 38852002
         NI    QSAVE,X'80'         SAVE ONLY CYCLE FLAG        @XA06108 38853002
         SR    R7,R7               CLEAR REG 7                 @XA06108 38854002
         IC    R7,QSAVE            CYCLE FLAG TO REG 7         @XA06108 38855002
         SRL   R7,7                CYCLE FLAG TO LOW ORDER     @XA06108 38856002
         B     ZONE10              GO TO CHARACTER MOVE        @XA06108 38857002
ZONE10   LA    R8,CHARS            GET CHARACTER STRING        @XA06108 38858002
         AR    R8,R7               INDEX INTO CHARACTER STRING @XA06108 38859002
         L     R6,XLABELP          GET LABEL ADDRESS           @XA06108 38860002
         MVC   L29(L1,R6),L0(R8)   MOVE CHARACTER TO LABEL     @XA06108 38861002
         B     RETURN                                          @XA06108 38862002
CYCLZON  STM   R5,R8,XSAVE         SAVE REGS                   @XA06108 38863002
         MVC   QSAVE(L1),L0(R4)    CYCLE ZONE TO WORK AREA     @XA06108 38864002
         NI    QSAVE,X'70'         GET CYCLE ZONE ONLY         @XA06108 38865002
         SR    R7,R7               CLEAR REG 7                 @XA06108 38866002
         IC    R7,QSAVE            CYCLE ZONE TO REG 7         @XA06108 38867002
         SRL   R7,4                SHIFT TO LOW ORDER          @XA06108 38868002
         B     ZONE10              GO TO CHARACTER MOVE        @XA06108 38869002
DATAZON  STM   R5,R8,XSAVE         SAVE REGS                   @XA06108 38870002
         MVC   QSAVE(L1),L0(R4)    DATA ZONE TO WORK AREA      @XA06108 38871002
         NI    QSAVE,X'07'         GET ONLY DATA ZONE          @XA06108 38872002
         SR    R7,R7               CLEAR REG 7                 @XA06108 38873002
         IC    R7,QSAVE            DATA ZONE TO REG 7          @XA06108 38874002
         B     ZONE10              GO TO CHARACTER MOVE        @XA06108 38875002
*                                                                       38900002
*                              SET ACTIVE  I/O UNITS                    38950002
SETAIO   STM   R5,R8,XSAVE              SAVE REGS                       39000002
         LR    R5,R3                    SET R5 TO BUFFER                39050002
         SH    R5,H43                   POINT R5 TO BEGGIN OF DATA      39100002
         SR    R7,R7                                                    39150002
         LA    R6,L8                    LOOP COUNT                      39200002
SETAIOLP CLC   L0(L4,R5),CZEROS         TEST FOR ALL ZEROS              39250002
         BE    BLANKOUT                 BE-TO BLANK OUT ZEROS           39300002
SETAIOL1 LA    R5,L5(R5)                BUMP COUNT                      39350002
         BCT   R6,SETAIOLP              LOOP TILL 8 TESTS               39400002
         CH    R7,H8                    ARE ALL ACTIVE IO ZERO          39450002
         BNE   RETURN                   NO RETURN                       39500002
         LR    R5,R3                    YES                             39550002
         SH    R5,H43                   PUT IN NONE                     39600002
         MVC   L0(L4,R5),NONE           INTO PRINT BUFF                 39650002
         B     RETURN                                                   39700002
BLANKOUT MVC   L0(L4,R5),BLANKS         MOVE IN BLANKS                  39750002
         LA    R7,L1(R7)                COUNT # OF ZERO FLDS            39800002
         B     SETAIOL1                 LOOP                            39850002
RETURN   LM    R5,R8,XSAVE                                              39900002
         BR    R14                                                      39950002
*                                                                       40000002
*                                                                       40050002
CHKSW9   TM    L1(R4),HEX40             TEST SWITCHES                   40100002
CHECKCC  BZ    NOPRT                    IF SWITCHES OFF                 40150002
         BR    R14                      DONOT PRINT                     40200002
CHKSW10  TM    L1(R4),HEX20             R15 RETURNED ZERO               40250002
         B     CHECKCC                  STOPS PRINTING                  40300002
CHKSW11  TM    L1(R4),HEX10                                             40350002
         B     CHECKCC                                                  40400002
CHKSW12  TM    L1(R4),HEX08                                             40450002
         B     CHECKCC                                                  40500002
CHKSW13  TM    L1(R4),HEX04                                             40550002
         B     CHECKCC                                                  40600002
CHKSW14  TM    L1(R4),HEX02                                             40650002
         B     CHECKCC                                                  40700002
CHKSW15  TM    L1(R4),HEX01                                             40750002
         B     CHECKCC                                                  40800002
NOPRT    SR    R15,R15                                                  40850002
         BR    R14                                                      40900002
*                                                                       40950002
SETDATE  UNPK  XWORK(L8),L0(L4,R4)      UNPACL DATE                     41000002
         MVZ   XWORK+L7(L1),XWORK       SET ZONE                        41050002
         MVC   L0(L3,R3),XWORK+L5       MOVE DAY                        41100002
         MVC  L6(L2,R3),XWORK+L3                                        41150002
         BR    R14                      RETURN                          41200002
*                                                                       41250002
CONVTIME TM    L0(R4),HEX48             TEST FOR NS/BIN CLOCK           41300002
         BZ    BINCLOCK                 ZERO IS BINARY CLOCK            41350002
         BO    RETURNB                  ONES IS FOR CONV TIME           41400002
         TM    L0(R4),HEX40             IF ON IS N/S CLOCK              41450002
         BO    NSCLOCK                  IF OFF TIME OK                  41500002
RETURNB  BR    R14                      RETURN                          41550002
*                                                                       41600002
         USING CI135,R2                                                 41650002
NSCLOCK  STM   R14,R12,L12(R13)         SAVE REGS                       41700002
         NI    L0(R4),HEXBF                                             41750002
         MVC   XWORK(L8),XDATE          MOVE DATE                       41800002
         LM    R4,R5,XWORK                                              41850002
         SRDL  R4,L12                   POSITION FOR MICRO SECS         41900002
         D     R4,MILLION               CONVERT TO SECONDS              41950002
         SRA   R4,L19                   POSITION FOR ROUNDING           42000002
         AR    R5,R4                    UP TO NXT SECONDS               42050002
         SR    R4,R4                                                    42100002
         D     R4,SIXTY                 CONVERT TO NINS                 42150002
         CVD   R4,XWORK                 CONVERT IT                      42200002
         LH    R6,XWORK+L6              PICK UP SECONDS                 42250002
         SRL   R6,L4                    SHIFT OFF ZONE                  42300002
         STC   R6,XDATE+L6              STORE SECONDS IN  REC           42350002
         MVI   XDATE+L7,HEX00           ZERO OUT TH'S                   42400002
         SR    R4,R4                                                    42450002
         D     R4,SIXTY                 CONVERT TO HRS                  42500002
         CVD   R4,XWORK                 CONVERT REMAINDER MINUTES       42550002
         LH    R6,XWORK+L6              PICK UP                         42600002
         SRL   R6,L4                    DROP ZONE                       42650002
         STC   R6,XDATE+L5              STORE MINUTES                   42700002
         SR    R4,R4                                                    42750002
         D     R4,T24                   DIVIDE TO GET DAYS              42800002
         CVD   R4,XWORK                 CONV REM                        42850002
         LH    R6,XWORK+L6              PICK UP                         42900002
         SRL   R6,L4                    DROP ZONE                       42950002
         STC   R6,XDATE+L4              STORE HRS                       43000002
         LA    R4,L60                   STARTINY YEAR 1960              43050002
         LA    R6,L1                    INC OF 1                        43100002
LEAPYEAR LA    R7,L3(R4)                ADD 3 YRS                       43150002
         S     R5,LPYEAR                DAYS IN LEAP YEAR 366           43200002
         BZ    THISYEAR                 BR-THIS YR+1                    43250002
         BM    OVERSHOT                 BR-TOOFAR                       43300002
         BXLE  R4,R6,REGYEAR            UPDATE YEAR BY ONE              43350002
REGYEAR  S     R5,RGYEAR                DAYS IN RG YEAR 365             43400002
         BZ    THISYEAR                 BR-YEAR+1                       43450002
         BM    OVERSHT1                 BR-TOO FAR                      43500002
         BXLE  R4,R6,REGYEAR            UPDATE AND TRY AGAIN            43550002
         B     LEAPYEAR                                                 43600002
OVERSHOT A     R5,LPYEAR                ADD BACK LEAP YEAR              43650002
         B     THISYEAR                 & USE                           43700002
OVERSHT1 A     R5,RGYEAR                ADD BACK REG YEAR               43750002
         B     THISYER                  & USE                           43800002
THISYEAR AR    R4,R6                    ADD 1                           43850002
THISYER  AR    R5,R6                    ADD 1                           43900002
         CVD   R5,XWORK                 CONVERT DAYS                    43950002
         MVC   XDATE+L2(L2),XWORK+L6    MOVE DAYS                       44000002
         CVD   R4,XWORK                 CONVERT YEAR                    44050002
         LH    R6,XWORK+L6              PICK UP                         44100002
         SRL   R6,L4                    DROP ZONE                       44150002
         STC   R6,XDATE+L1              PUT YEAR                        44200002
         MVI   XDATE,HEX00              SET TO ZERO                     44250002
RETURNC  OI    XSWS8,HEX08              TURN ON PACKED SWITCH           44300002
         LM    R14,R12,L12(R13)         RETURN                          44350002
         BR    R14                                                      44400002
*                                                                       44450002
*                                                                       44500002
BINCLOCK STM   R14,R12,L12(R13)         SAVE REGS                       44550002
         L     R3,XTIME                 PICK UP TIME IN BIN             44600002
         LTR   R3,R3                    TEST FOR ZERO                   44650002
         BZ    RETURNC                  YES-RETURN                      44700002
         SRL   R3,L1                    CONVERT                         44750002
         M     R2,CONSTG                     TO                         44800002
         D     R2,CONSTH                       DECIMAL                  44850002
         LA    R4,L32                   BIT COUNTER                     44900002
         MVI   TIMDIV+L3,DIV1           INITIAL DIVISOR (0A)            44950002
BCLOCKA  SR    R2,R2                    CLEAR                           45000002
         D     R2,TIMDIV                DEVOLP DIGIT-REMAINDER          45050002
         LR    R0,R2                    SAVE REM                        45100002
         SRDL  R0,L4                    SHIFT 4BITS                     45150002
         SH    R4,H4                    DEC BY 4                        45200002
         LTR   R3,R3                    DONE                            45250002
         BZ    BCLOCKB                  BR-YES                          45300002
         CH    R4,H24                   BITS LESS 24                    45350002
         BNL   BCLOCKA                  BR-NO                           45400002
         XI    TIMDIV+L3,DIV2           ALT DIV (0A XI 0C=06)           45450002
         B     BCLOCKA                                                  45500002
BCLOCKB  SRL   R1,L0(R4)                MOVE TO FINAL POS               45550002
         ST    R1,XTIME                 STORE BACK                      45600002
         B     RETURNC                                                  45650002
NOLOG0   STM   R4,R7,ZSAVE         SAVE REGISTERS                       45700002
         SH    R4,HTWO             POINTER TO KEY                       45750002
         LA    R5,HDRCNT           PICK UP RECORD SIZE                  45800002
         CLC   L0(L2,R5),L0(R4)    COMPARE FOR HDR LENGTH               45850002
         BNE   MSG2                                                     45900002
         LA    R5,QUIT0-L4         GET DATA ADDRESS                     45950002
         L     R15,RG9PTR          PICK UP R9 POINTER                   46000002
         ST    R5,0(R15)           STORE INTO R9 POINTER                46050002
         SR    R15,R15                                                  46100002
MSG2     LM    R4,R7,ZSAVE         RESTORE REGISTERS                    46150002
         BR    R14                 RETURN                               46200002
NXTBL    BR    R14                                                      46250002
NOLOG    STM   R4,R7,ZSAVE                                              46300002
         SH    R4,HTWO                                                  46350002
         LA    R5,HDRCNT                                                46400002
         CLC   L0(L2,R5),L0(R4)         TEST FOR LOGOUT PRESENT         46450002
         BE    ROUTMSG                                                  46500002
         LA    R5,L2(R5)      UPDATE POINTER                            46550002
         CLC   L0(L2,R5),L0(R4)                                         46600002
         BE    SHORTREC                                                 46650002
         SR    R15,R15                                                  46700002
ROUTMSG  LM    R4,R7,ZSAVE         RESTORE REGISTERS                    46750002
         BR    R14                                                      46800002
SHORTREC LA    R5,QUIT1-L4                                              46850002
         L     R15,RG9PTR                                               46900002
         ST    R5,0(R15)           STORE INTO R9 POINTER                46950002
         LM    R4,R7,ZSAVE                                              47000002
         BR    R14                                                      47050002
SELCHAN  STM   R4,R7,ZSAVE                                              47100002
         CLI   AD0(R4),K1         TEST FO SEL OR OTHER LOG              47150002
         BE    MPXROUT                                                  47200002
         LA    R5,NXTBL-L4         NEXT TABLE ADDRESS                   47250002
         L     R15,RG9PTR                                               47300002
         ST    R5,0(R15)           STORE INTO R9 POINTER                47350002
         SR    R15,R15                                                  47400002
MPXROUT  LM    R4,R7,ZSAVE                                              47450002
         BR    R14                                                      47500002
ZSAVE    DS    4F                                                       47550002
XLABELP  EQU   LP                                                       47600002
RELTAB   DS    0C                                                       47650002
         DC    C'OS  '                                                  47680002
         DC    C'DOS '                                                  47710002
         DC    C'VS 1'                                                  47740002
         DC    C'V370'                                                  47770002
         DC    C'VS 2'                                                  47800002
         DC    C'    '                                                  47830002
         DC    C'    '                                                  47860002
         DC    C'    '                                                  47890002
HDRCNT   DC    H'92'                                                    47950002
         DC    H'128'                                                   48000002
         DC    H'168'                                                   48050002
HTWO     DC    H'2'                                                     48100002
XWORK    DS    D                                                        48150002
XSAVE    DS    4F                                                       48200002
WORK     EQU   XWORK                                                    48250002
CONSTG   DC    X'00030D40'                                              48300002
CONSTH   DC    X'024AE062'                                              48350002
MILLION  DC    F'1000000'                                               48400002
SIXTY    DC    F'60'                                                    48450002
T24      DC    F'24'                                                    48500002
LPYEAR   DC    F'366'                                                   48550002
RGYEAR   DC    F'365'                                                   48600002
TIMDIV   DC    F'1'                                                     48650002
H4       DC    H'4'                                                     48700002
H8       DC    H'8'                                                     48750002
H24      DC    H'24'                                                    48800002
H43      DC    H'43'                                                    48850002
QUIT0    DC    X'FF'                                                    48900002
         DC    XL2'5C'             SIZE OF TOTAL RECORD                 48950002
         DC    XL2'5C'             HEADER                               49000002
         DC    XL2'0'                                                   49050002
QUIT1    DC    X'FF'                                                    49100002
         DC    XL2'80'                                                  49150002
         DC    XL2'5C'                                                  49200002
         DC    XL2'0'                                                   49250002
CHARS    DC    C'0123456789ABCDEF'                                      49300002
NONE     DC    C'NONE'                                                  49350002
CONVERTD DC    C'CONVERTED'                                             49400002
CZEROS   DC    C'0000'                                                  49450002
BLANKS   DC    C'    '                                                  49500002
CCCH     DC    CL3'CCH'                                                 49550002
MCHH     DC    CL3'MCH'                                                 49600002
QSAVE    DC    X'00'                                           @XA06108 49620002
MYWORK   DC    F'0'                                                     49650002
ONE      DC    F'1'                                                     49700002
         EJECT                                                          49750002
IFCASR01 DS    0H                                                       49800002
         USING *,R15                                                    49850002
         STM   R14,R12,12(R13)          SAVE REGISTERS                  49900002
         ST    R13,SVR13                SAVE REG 13                     49950002
         L     R11,NXENTRY              LOAD SUBROUTINE RETURN ADR      50000002
         LTR   R11,R11                  TEST FOR INITIAL ENTRY          50050002
         BZ    IFCASR02                 BRANCH IF 0-INITIAL ENTRY       50100002
         LM    R12,R10,MYSAVE           RELOAD SUBROUTINE REGS          50150002
         BR    R11                      CONTINUE PROCESSING             50200002
IFCASR02 DS    0H                                                       50250002
         SH    R3,TWOX                  SUBTRACT 2 FROM PRNT BFR ADR    50300002
         MVC   L0(L1,R3),L1(R3)         MOVE PRINTER CNTRL CHAR         50350002
         LA    R3,L1(R3)                INCREMENT PRNT BFR ADR          50400002
         USING XDADBUF,R4                                               50450002
         USING XPRTBUF,R3                                               50500002
NEWMOVE  CLI   XKEYBUF+1,REL19          RELEASE 19                19E03 50550002
         BE    NEWMOVE1                 BRANCH--YES               19E03 50600002
         MVC   CSWORD(8),XDADBUF+54     MOVE CSW                  19E03 50650002
         MVC   ERPIBFLD(4),XDADBUF+62   MOVE ERPIB                19E03 50700002
         MVC   MULTISYS(4),XDADBUF+74   MOVE CHANSTAT INFO        19E03 50750002
         B     CONTINUE                 CONTINUE                  19E03 50800002
NEWMOVE1 MVC   CSWORD(8),XDADBUF+46     MOVE CSW                  19E03 50850002
         MVC   ERPIBFLD(4),XDADBUF+54   MOVE ERPIB                19E03 50900002
         MVC   MULTISYS(4),XDADBUF+66   MOVE CHANSTAT INFO        19E03 50950002
CONTINUE ST    R9,SAVBASE               SAVE BASE REG                   51000002
         LA    R9,ERPIBFLD                                              51020002
         USING ERPIB,R9                                                 51050002
         MVI   SETUPBFR+1,C'*'                                     MP   51100002
         MVC   SETUPBFR+2(78),SETUPBFR+1                           MP   51150002
         BAL   BRANPRT,XWRTPRT    MOVE BORDER TO BUFFER AND WRITE  MP   51200002
         MVI   SETUPBFR,C'-'           SKIP TWO SPACES             MP   51250002
         TM    MPINFOFD,MSBIT      IS MULTI-SYSTEM BIT SET        19032 51300002
         BZ    DUMMYTST      IFNOT,CKECK FOR ENTRANCE FROM ASR01   MP   51350002
         LA    SETUPADR,SETUPBFR       ADDRESS OF PRINT BUFFER     MP   51400002
         MVC   24(24,SETUPADR),MSHEAD   MOVE MULTI-SYSTEM HDR TO BUFMP  51450002
         BAL   BRANPRT,XWRTPRT     WRITE HEADER                    MP   51500002
         MVI   SETUPBFR+1,C'*'                                     MP   51550002
         MVI   VDSTAR,C'*'                                         MP   51600002
         BAL   BRANPRT,XWRTPRT     WRITE LINE DIVIDER              MP   51650002
*                                                                  MP   51700002
*                                                                  MP   51750002
*              THIS ROUTINE FORMATS AND PRINTS A MESSAGE           MP   51800002
*              CONTAINING THE ID OF THE FAILING CPU AND            MP   51850002
*              THE STATUS OF THE MULTI-PROCESSING SYSTEM           MP   51900002
*                                                                  MP   51950002
*                                                                  MP   52000002
         MVC   10(12,SETUPADR),MSCPUID  MOVE CPUID MESSAGE TO BUFFERMP  52050002
         MVC   30(15,SETUPADR),MSCPUST  MOVE CPU STATUS MESSAGE    MP   52100002
         MVI   0(SETUPADR),C'-'    SKIP TWO SPACES AFTER LINE      MP   52150002
         TM    MPINFOFD,ID         TEST FOR WHICH CPU             19032 52200002
         BZ    STATEST       SKIP CPU ID                           MP   52250002
         MVI   14(SETUPADR),C'2'   INSERT CPUID=CPU2               MP   52300002
STATEST  IC    R1,MPINFOFD         GET MS BYTE IN MPINFO          19032 52350002
         SLL   R1,30               CLEAR FOR CPUSTAT               MP   52400002
         LTR   R1,R1               TEST FOR ZERO,NEGATIVE OR POSITIVEMP 52450002
         BC    12,SHARED           IS STATUS NOT PARTITION         MP   52500002
         MVC   45(11,SETUPADR),PART     STATUS WAS PARTITIONED     MP   52550002
         B     CHANTEST      GO FOR CHANNEL STATUS                 MP   52600002
SHARED   MVC   45(6,SETUPADR),SHAR      SHARED STATUS              MP   52650002
         BE    CHANTEST                 WAS CPU RECONFIGURED OUT   MP   52700002
         MVC   51(21,SETUPADR),RECON    YES                        MP   52750002
         EJECT                                                          52800002
*                                                                  MP   52850002
*                                                                  MP   52900002
*              THIS ROUTINE TESTS A TWO BYTE FIELD                 MP   52950002
*              MPINFO FIELD                          TO DETERMINE       53000002
*              THE CHANNEL STATUS FOR BOTH CPUS AND FORMAT         MP   53050002
*              A MESSAGE TO INDICATE THAT STATUS                   MP   53100002
*                                                                  MP   53150002
*                                                                  MP   53200002
CHANTEST BAL   BRANPRT,XWRTPRT          PRINT INFORMATION          MP   53250002
         MVI   0(SETUPADR),C'-'         SKIP TWO SPACES            MP   53300002
         MVC   10(27,SETUPADR),CHCNFIG  CHANNEL CONFIGURATION MESSAGEMP 53350002
         LA    UPKREG,0                                            MP   53400002
         TM    MPINFOFD,ID         WAS CPUID=CPU2                 19032 53450002
         BZ    CCHMOVE                 NO                          MP   53500002
         MVI   14(SETUPADR),C'2'        YES, ENTER ID 2            MP   53550002
CCHMOVE  BAL   BRANPRT,XWRTPRT          PRINT MESSAGE              MP   53600002
         LA    R1,7                     LOOP CONTROL               MP   53650002
         LA    R2,14(SETUPADR)          PTR TO SLOT FOR 'OFF' MESSAGEMP 53700002
         IC    R5,CHSMS(UPKREG)         GET CHANNEL STATUS BYTE    MP   53750002
         MVC   10(55,SETUPADR),CHTAB    GET LIST OF CHANNELS       MP   53800002
         SLL   R5,24                    POSITION BYTE FOR BIT TESTINGMP 53850002
MSLOOP   LTR   R5,R5         IS BIT ON (NEGATIVE REG) OR OFF       MP   53900002
         BC    10,MSUPDT                NO                         MP   53950002
         MVC   0(3,R2),OFF              CHANNEL OFFLINE            MP   54000002
MSUPDT   SLL   R5,1                     MOVE TO NEXT CHANNEL BIT   MP   54050002
         LA    R2,8(R2)                 UPDATE MESSAGE POINTER     MP   54100002
         BCT   R1,MSLOOP                EXIT AFTER 7-BITS PROCESSED MP  54150002
MSREND   BAL   BRANPRT,XWRTPRT          WRITE CHANNEL STATUS MESSAGEMP  54200002
         LTR   UPKREG,UPKREG            TEST FOR SECOND TIME THROUGH MP 54250002
         BC    7,PRTHD                  BOTH BYTES OF CHANSTAT PRINTED  54300002
         LA    UPKREG,1(UPKREG)         PTR TO 2ND.BYTE OF CHANSTATMP   54350002
         MVC   10(27,SETUPADR),CHCNFIG  MOVE IN CHANNEL CONFIGURATIONMP 54400002
         TM    MPINFOFD,ID         ESTABLISH CPUID                19032 54450002
         BO    CCHMOVE                  BRANCH IF CPUID=CPU2       MP   54500002
         MVI   14(SETUPADR),C'2'        PUT CPU2 IN MESSAGE        MP   54550002
         B     CCHMOVE       PRINT MESSAGE                         MP   54600002
PRTHD    MVI   SETUPBFR+1,C'*'             SETUP TO PRINT DIVIDER       54650002
         MVC   2(78,SETUPADR),1(SETUPADR)                               54700002
         MVI   SETUPBFR,C'0'               SPACE FIRST                  54750002
         BAL   BRANPRT,XWRTPRT             PRINT DIVIDER                54800002
DUMMYTST LA    SETUPADR,SETUPBFR   GET ADDR OF BUFFER FOR PRINT    MP   54850002
*                                       MESSAGE                    MP   54900002
         MVI   0(SETUPADR),C'0'         SKIP SPACE AFTER NEXT MESSAGEMP 54950002
         OC    ERPIBFLD+1(3),ERPIBFLD+1  TEST FOR DUMMY ERPIB     19032 55000002
         BNE   MSCONT                   CONTINUE IF MEANINGFUL ERPIB MP 55050002
         MVC   10(39,SETUPADR),MSASR    PRINT ASR01 ENTRY MESSAGE  MP   55100002
         MVI   0(SETUPADR),C'-'         SKIP 2 LINES               MP   55150002
         BAL   BRANPRT,XWRTPRT          PRINT INFORAMATION         MP   55200002
         MVC   10(17,SETUPADR),MSNERPIB ERPIB NOT CREATED MESSAGE  MP   55250002
         BAL   BRANPRT,XWRTPRT          PRINT INFORMATION          MP   55300002
         B     RETCNTL       RETURN CONTROL                        MP   55350002
*                                                                  MP   55400002
         EJECT                                                          55450002
MSCONT   EQU   *                                                   MP   55500002
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  55550002
*                          INSTRUCTION ANALYSIS                       * 55600002
*        THIS PROGRAM SECTION WILL INSPECT THE FIRST FOUR(4) BITS IN  * 55650002
*        THE FIRST BYTE  OF THE              ERPIB AREA, TO DETERMINE * 55700002
*        THE INSTRUCTION CAUSING THE ERROR.                           * 55750002
         LA    SETUPADR,SETUPBFR       SET UP HEADER BOARDER.           55800002
         MVC   SETUPBFR+27(25),HEADER    SET UP HEADER MESSAGE          55850002
         MVI   0(SETUPADR),C'0'          SPACE ONE LINE                 55900002
         BAL   BRANPRT,XWRTPRT                                          55950002
*                                                                     * 56000002
*                            TEST FOR INTERRUPT                       * 56050002
*                                                                     * 56100002
         TM    SOFWFLGS,X'40'          INTERRUPT TEST.                  56150002
         BZ    INST                                                     56200002
         MVC   SETUPBFR(42),ERRINT     BUFFER INTERRUPT MESSAGE.        56250002
         B     RITEOUT                                                  56300002
*                                                                     * 56350002
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  56400002
*                                                                     * 56450002
*        BITS 32-35 WILL BE TESTED                                    * 56500002
*                                                                     * 56550002
INST     MVC   SETUPBFR(33),CAUSERR    TYPE-INST ERROR HEADER.          56600002
         TM    SOFWFLGS,X'80'          TEST FOR SIO INSTRUCTION ERROR.  56650002
         BO    PRTERSIO                BRANCH TO SETUP PRINT BUFFER.    56700002
         TM    SOFWFLGS,X'20'          TEST FOR TIO INSTRUCTION.        56750002
         BO    PRTERTIO                BRANCH TO SETUP PRINT BUFFER.    56800002
*                                                                     * 56850002
PRTERHIO MVC   SET1(3),ERRHIO          MOVE HIO LABEL INTO BUFFER.      56900002
         B     RITEOUT                 PREPARE TO WRITE MESSAGE.        56950002
*                                                                     * 57000002
PRTERSIO MVC   SET1(3),ERRSIO          MOVE SIO LABEL INTO BUFFER.      57050002
         B     RITEOUT                 PREPARE TO WRITE MESSAGE.        57100002
*                                                                     * 57150002
PRTERTIO MVC   SET1(3),ERRTIO          MOVE TIO LABEL INTO BUFFER.      57200002
*                                                                     * 57250002
RITEOUT  BAL   BRANPRT,XWRTPRT         WRITE OUT APPROPRIATE MESSAGE.   57300002
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  57350002
*        THE FOLLOWING PROGRAM SECTION WILL INSPECT THE ERPIBFLD        57400002
*        TO DETERMINE IF AN ERPIB IS PRESENT.   IF  ONE IS              57450002
*        NOT FOUND, CONTROL WILL BE RETURNED.                           57500002
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  57550002
         OC    ERPIBFLD+1(3),ERPIBFLD+1  TEST FOR  ERPIB PRESENT  19032 57600002
         BZ    NONEXIST                WRITE MSG TO INDICATE NONEXISTS. 57650002
         B     TEST1         TEST COMPLETION CODE                  MP   57700002
SETVD    EQU   XPRTBUF+33                                          MP   57750002
*                         UCB ADDRESS NON-EXISTANT                      57800002
NONEXIST MVC   SETUPBFR(45),NOUCB        SET UP MSG FOR NO UCB          57850002
         BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   57900002
         B     RETCNTL                 RETURN TO CONTROL.               57950002
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  58000002
*        THE FOLLOWING PROGRAM SECTION WILL TEST  BYTE 5     OF THE     58050002
*        ERPIB FOR A NO RETRY BIT SETTING. IF ON, CONTROL IS RETURNED   58100002
*        AFTER MESSAGE IS PRINTED OUT.                                  58150002
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  58200002
*                       OUTPUT RETRY CODE VALUE                         58250002
*                                                                       58300002
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  58350002
*                            TEST SOFTWARE FLAGS                        58400002
TEST     MVC   SETUPBFR(32),RETCDVAL     BUFFER THE BASIC MESSAGE       58450002
         IC    REG,CMPLBITS        CONTENTS OF BYTE 8 INTO R3     19032 58500002
         TM    VALFLAGS,X'10'            TEST FOR VALID RETRY CODE      58550002
         BO    VALFLG              IF VALID, GO SETUP MESSAGE           58600002
         MVC   33(43,SETUPADR),NOTVM  SETUP NOT ASSESSABLE MESSAGE      58650002
         B     BUFITA           GO PRINT IT                             58700002
VALFLG   N     REG,MASK            GET RID OF UNNEED BITS               58750002
         STC   REG,RCMSG+12        STORE NO. IN RETRY CODE MSG          58800002
         OI    RCMSG+12,X'F0'      MAKE PRINTABLE                       58850002
         MH    REG,CONST                                                58900002
         LA    REG,MSGSTRT(REG)    SET UP MSG INDEX                     58950002
         MVC   33(44,SETUPADR),0(REG)  MOVE MSG TO BUFFER               59000002
BUFIT    BAL   BRANPRT,XWRTPRT     PRINT IT                             59050002
         MVC   34(14,SETUPADR),RCMSG  MOVE RETRY MSG TO BUFFER          59100002
BUFITA   BAL   BRANPRT,XWRTPRT                                          59150002
         TM    CMPLBITS,X'08'      IS DISCONNECT IN SET           19032 59200002
         BNO   NOTDISIN            NO, SKIP MSG                   19032 59250002
         MVC   SETUPBFR(23),DISCIN SET UP MSG                     19032 59300002
         BAL   BRANPRT,XWRTPRT     PRINT MSG                      19032 59350002
NOTDISIN EQU   *                                                  19032 59400002
*                                                                       59450002
*                                  TEST NO-RETRY BIT                    59500002
         TM    SOFWFLGS,X'01'          IF NORETRY BIT IS NOT ON,BRANCH  59550002
*                                      TO PRINT VALID INDICATOR MSG.    59600002
         BZ    VALIDIND                                                 59650002
         MVC   SETUPBFR(28),NORETRY    INDICATES THAT THE BIT WAS ON.   59700002
         BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.               59750002
         B     RETCNTL                 RETURN CONTROL.                  59800002
VALIDIND MVC   SETUPBFR(29),VALIDITY   RECORDED DATA HEADING TO BUFFER  59850002
         BAL   BRANPRT,XWRTPRT         INDICATOR HEADER.                59900002
*                                                                       59950002
*                                  TEST VALID RETRY CODE                60000002
*                                                                       60050002
*                                                                       60100002
*                            TEST COUNT BIT                             60150002
         MVC   SETUPBFR(42),VALCOUNT   BUFFER THE BASIC MESSAGE.        60200002
         TM    SOFWFLGS,X'02'          TEST COUNT VALIDITY.             60250002
         BZ    INVCOUNT                IF OFF, PRINT INVALID MSG.       60300002
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    60350002
INVCOUNT BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   60400002
*                                                                       60450002
*                            TEST FOR SENSE DATA STORED                 60500002
*                                                                       60550002
         MVC   SETUPBFR(43),SENSDATA   BUFFER THE BASIC MESSAGE.        60600002
         TM    SOFWFLGS,X'04'          TEST SENSE BIT.                  60650002
         BZ    NOSTORE                 IF OFF BRANCH TO WRITE NOSTORE.  60700002
         MVC   33(10,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.   60750002
NOSTORE  BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.               60800002
*                            TEST UNIT STATUS BIT                       60850002
         MVC   SETUPBFR(42),INVALUN    BUFFER THE BASIC MESSAGE.        60900002
         TM    VALFLAGS,X'08'          TEST FOR VALID UNIT STATUS.      60950002
         BZ    WRTOUT                  UNIT STATUS INVALID.             61000002
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    61050002
WRTOUT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   61100002
*                                                                       61150002
*                            TEST COMMAND ADDRESS BIT                   61200002
*                                                                       61250002
         MVC   SETUPBFR(42),INVALCAD   MOVE INVALID COM MSG TO BUFFER.  61300002
         TM    VALFLAGS,X'04'          TEST FOR VALID COMMAND ADDRESS.  61350002
         BZ    PTOUT                   COMMAND ADDRESS INVALID.         61400002
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    61450002
PTOUT    BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.               61500002
*                                                                       61550002
*                            TEST CHANNEL ADDRESS BIT                   61600002
*                                                                       61650002
         MVC   SETUPBFR(42),INVALCHA   MOVE INVALID CHN MSG TO BFR.     61700002
         TM    VALFLAGS,X'02'          TEST FOR VALID CHANNEL ADDRESS.  61750002
         BZ    OUTWRT                  INVALID CHANNEL ADDRESS.         61800002
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    61850002
OUTWRT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   61900002
*                                                                       61950002
*                            TEST FOR VALID DEVICE ADDRESS              62000002
*                                                                       62050002
         MVC   SETUPBFR(42),INVALDVA   MOVE INVALID DVC ADDR MSG TO BFR 62100002
         TM    VALFLAGS,X'01'          TEST FOR VALID DEVICE ADDRESS.   62150002
         BZ    OUTPRT                  INVALID DEVICE ADDRESS.          62200002
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    62250002
OUTPRT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   62300002
*                                                                       62350002
*        PROBABLE SOURCE OF ERROR                                       62400002
*                                                                       62450002
         MVC   SETUPBFR(29),PSOERR      INSERT BASE MSG IN BUFFER       62500002
         CLI   PROBERR,X'80'            TEST FOR CPU ERROR              62550002
         BE    CPUER                    BRANCH TO SET UP CPU ERR MSG    62600002
         CLI   PROBERR,X'40'            TEST FOR CHANNEL ERROR          62650002
         BE    CHNER                    BRANCH TO SETUP CHANNEL ERROR   62700002
         CLI   PROBERR,X'20'       TEST FOR SCU ERROR             19032 62750002
         BE    SCUER               YES- GO SET UP FOR SCU ERRMSG  19032 62800002
         CLI   PROBERR,X'10'            TEST FOR STORAGE ERROR          62850002
         BE    STORGER                  GO SETUP STORAGE ERROR MSG      62900002
         CLI   PROBERR,X'08'            TEST FOR I/O INTERFACE ERROR    62950002
         BE    INFER                    GO SETUP I/O INTF ERROR MSG     63000002
         MVC   30(25,SETUPADR),NOTVM    SETUP NOT ASSESSABLE MESSAGE    63050002
         B     WPRMSG                   GO PRINT MSG                    63100002
CPUER    MVC   30(3,SETUPADR),CPUERMSG  BUFFER CPU ERROR MESSAGE        63150002
         B     WPRMSG                   GO PRINT                        63200002
CHNER    MVC   30(7,SETUPADR),CHANERMS  SETUP CHANNEL ERROR MESSAGE     63250002
         B     WPRMSG                   GO PRINT                        63300002
SCUER    MVC   30(20,SETUPADR),SCUERMS  SET UP SCU MSG            19032 63350002
         B     WPRMSG                   GO PRINT IT               19032 63400002
STORGER  MVC   30(7,SETUPADR),STOGERMS  SETUP STORAGE ERROR MESSAGE     63450002
         B     WPRMSG                   GO PRINT                        63500002
INFER    MVC   30(13,SETUPADR),IOINFER  SET UP INTERFACE ERROR MESSAGE  63550002
WPRMSG   BAL   BRANPRT,XWRTPRT          PRINT MESSAGE                   63600002
         B     RETCNTL                                                  63650002
*                                                                       63700002
*                            TEST COMPLETION CODE                       63750002
*                                                                       63800002
TEST1    MVC   SETUPBFR(23),COMCODE    INSERT COMPLETION CODE MESSAGE   63850002
*                                      IN PRINT BUFFER.                 63900002
         TM    CMPLBITS,X'C0'          TEST FOR COMPLETION CODE '3'.    63950002
         BO    SYSRET                  BRANCH FOR SYS RESET MSG OUTPUT. 64000002
         TM    CMPLBITS,X'80'          TEST FOR COMPLETION CODE '2'     64050002
         BO    SELRET                  BRANCH FOR SEL RESET MSG OUTPUT. 64100002
         TM    CMPLBITS,X'40'          TEST FOR COMPLETION CODE '1'     64150002
         BO    FORENDSQ                BRANCH FOR FORCED END MSG OUTPUT 64200002
*                                                                       64250002
*                            INTERFACE DISCONNECT                       64300002
*                                                                       64350002
         MVC   SET2(29),INTDISCN      SET UP INTERFACE DISCONNECT MSG   64400002
         B     WRITER                  MESSAGE AND WRITE IT OUT.        64450002
*                                                                       64500002
*                            SYSTEM RESET                               64550002
*                                                                       64600002
SYSRET   MVC   SET2(21),SYSRES        SETUP  THE SYSTEM RESET MSG AND   64650002
         B     WRITER                  WRITE IT OUT.                    64700002
*                                                                       64750002
*                            SELECTIVE RESET                            64800002
*                                                                       64850002
SELRET   MVC   SET2(24),SELRES          SETUP SELECTIVE RESET  MSG AND  64900002
         B     WRITER                  AND WRITE IT OUT.                64950002
*                                                                       65000002
*                            FORCED ENDING SEQUENCE                     65050002
*                                                                       65100002
FORENDSQ MVC   SET2(31),FORCEND         SETUP FORCE END MESSAGE AND     65150002
*                                      WRITE IT OUT.                    65200002
*                                                                       65250002
*                            OUTPUT OF COMPLETION                       65300002
*                              CODE MESSAGES                            65350002
*                                                                       65400002
WRITER   BAL   BRANPRT,XWRTPRT                                          65450002
         B     TEST                                                     65500002
*                                                                       65550002
*                                 RETURN CONTROL                        65600002
*                                                                       65650002
RETCNTL  EQU   *                                                  19032 65700002
         MVI   SETUPBFR+1,C'*'                                          65750002
         MVC   2(78,SETUPADR),1(SETUPADR)                               65800002
         MVI   0(SETUPADR),C'-'         SETUP TO SPACE TWICE            65850002
         BAL   BRANPRT,XWRTPRT                                          65900002
         TM    CSWORD+5,X'06'           CHAN CHK OR IF CTRL CHK         65950002
         BC    8,MSG                   NO, PRINT LOGOUT MESSAGE.        66000002
FIN1     DS    0C                                                       66150002
         LA    R0,0                     ZERO WORK REGISTER              66200002
         ST    R0,NXENTRY               CLEAR ENTRY POINTER             66250002
         L     R13,SVR13                RESTORE REG 13                  66300002
         LM    R14,R12,12(R13)          RESTORE REGISTERS               66350002
         BR    R14                      RETURN                          66400002
*                                                                       66450002
*                            PRINT NO-LOGOUT MESSAGE                    66500002
*                                                                       66550002
MSG      MVC   SETUPBFR+1(79),ERMSG    BUFFER THE MESSAGE.              66600002
         BAL   BRANPRT,XWRTPRT                                          66650002
         L     R9,SAVBASE               RESTORE BASE                    66700002
         USING IFCEI135,R9                                              66800002
         LA    R7,QUIT0-4               GET END ADDRESS                 66900002
         DROP  R9                                                       67000002
         ST    R7,L12(R9)               STO9E IN TABLE                  67100002
         B     FIN1                     RETURN                          67200002
*                                                                       67300002
SAVBASE  DC    F'0'                                                     67400002
*                                                                       67500002
*                                                                  MP   68050002
***      THIS ROUTINE CONVERTS HEX CHARACTERS TO EBCDIC            MP   68100002
*                                                                  MP   68150002
*        INPUT   R1 -         LINKREG                               MP  68200002
*                CLEAREG -    COUNT OF BYTES TO BE CONVERTED        MP  68250002
*                R5 -         ADDRESS OF FIELD TO BE CONVERTED     MP   68300002
***              SETUPADR -   ADDRESS OF OUTPUT AREA               MP   68350002
*                                                                  MP   68400002
*                                                                  MP   68450002
CONVERT  SR    R2,R2                    CLEAR EVEN WORK REG (HI-ORDEMP  68500002
         IC    R2,0(R5)                 GET CHARACTER FROM INPUT FIE MP 68550002
         SRDL  R2,4                     SAVE HIGH ORDER BITS       MP   68600002
         SRL   REG,28              SAVE LOW ORDER BITS                  68650002
         IC    R2,CONTAB(R2)            GET EBCDIC EQUIVALENT      MP   68700002
         IC    REG,CONTAB(REG)           FROM TABLE                     68750002
         STC   R2,0(SETUPADR)           STORE CHARACTERS IN PRINTABL MP 68800002
         STC   REG,1(SETUPADR)           FROM IN BUFFER           MP    68850002
         LA    R5,1(R5)                 UPDATE INPUT FIELD PTR     MP   68900002
         LA    SETUPADR,2(SETUPADR)     UPDATE BUFFER POINTER      MP   68950002
         BCT   CLEAREG,CONVERT          LOOP UNTIL ALL BYTES PROCESS MP 69000002
         BR    R1                       RETURN                     MP   69050002
         SPACE                                                          69100002
****    ROUTINE TO RETURN CONTROL TO CONTROL MODULE                     69150002
XWRTPRT  DS    0C                                                       69200002
         ST    BRANPRT,NXENTRY          STORE LINK ADDRESS              69250002
         STM   R12,R10,MYSAVE           SAVE SUBROUTINE REGS            69300002
         L     R0,RTNPTR                LOAD ADCON FOR RETURN POINTER   69350002
         L     R1,RG9PTR                LOAD POINTER TO REG9            69400002
         ST    R0,AD0(R1)               STORE RETURN POINTER            69450002
         L     R0,LBLPTR                LOAD POINTER TO LABEL           69500002
         L     R1,LPPTR                 LOAD POINTER TO LP              69550002
         ST    R0,AD0(R1)               STORE LABEL POINTER             69600002
         L     R13,SVR13                RESTORE REG 13                  69650002
         MVI   AD0(R3),X09                                              69700002
         LM    R14,R12,12(R13)          RESTORE REGISTERS               69750002
         BR    R14                      RETURN                          69800002
*                                                                       69850002
*                            STORAGE                                    69900002
*                                                                       69950002
         DS    0F                                                       70000002
TYPE     EQU   XDADBUF+5                                           MP   70050002
ENVCH    EQU   XDADBUF+56                                          MP   70100002
ENVMS    EQU   XDADBUF+63                                          MP   70150002
GPRMS    EQU   XDADBUF+248                                         MP   70200002
CPULOG   EQU   GPRMS+108                                           MP   70250002
CPULOGED EQU   CPULOG+8                                            MP   70300002
CPULOGJE EQU   CPULOG+2                FRAME SIX LOW BIT           2MEG 70350002
CPULOGPP EQU   CPULOG+12                                           MP   70400002
CPULOGG  EQU   CPULOG+65                                           MP   70450002
CPULOGVD EQU   CPULOG+66                                           MP   70500002
CPULOGMO EQU   CPULOG+70        FRAME 5-8 BITS                     2MEG 70550002
ONEVD    EQU   X'01'                                               MP   70600002
TWEN     EQU   X'20'                                               MP   70650002
EIGHTY   EQU   X'80'                                               MP   70700002
VDSTAR   EQU   XPRTBUF+79                                          MP   70750002
PLACE    EQU   ENVCH+32                                            MP   70800002
F252     EQU   252                                                 MP   70850002
FROMVD   EQU   GPRMS+32                                            MP   70900002
OCTVD    EQU     80                                                MP   70950002
AREAVD   EQU   GPRMS+92                                            MP   71000002
ID       EQU   X'08'                                               MP   71050002
MSBIT    EQU   X'10'                                                MP  71100002
K0       EQU   0                                                  19E03 71150002
K2       EQU   2                                                  19E03 71200002
K4       EQU   4                                                  19E03 71250002
K8       EQU   8                                                  19E03 71300002
K10      EQU   10                                                 19E03 71350002
K20      EQU   20                                                 19E02 71400002
K21      EQU   21                                                 19E02 71450002
K24      EQU   24                                                 19E03 71500002
FOXDOG   EQU   X'FD'                                              19E03 71550002
REL19    EQU   19                                                 19E02 71600002
XPRTBUF1 EQU   XPRTBUF+1                                          19E03 71650002
MODA48   DC    X'0155'                  MODEL 155 - NS A48        19E02 71700002
REGSAV   DS    2F                                                       71750002
DECCOUNT DS    F                                                  19E03 71800002
*                                                                       71850002
SETUPBFR EQU   XPRTBUF                                                  71900002
CSWORD   DC    D'0'                CSW LOCATION                   19032 71950002
ERPIBFLD DC    F'0'                LAST HALF ERPIB                19032 72000002
MULTISYS DC    F'0'                MULTI-PROCESSING INFO          19032 72050002
MASK     DC    F'7'                                                     72100002
CONST    DC    H'44'                                                    72150002
TWOX     DC    H'2'                                                     72200002
SET1     EQU   SETUPBFR+22                                              72250002
SET2     EQU   SETUPBFR+21                                              72300002
*                                                                       72350002
*                            REGISTERS                                  72400002
REG      EQU   11                                                       72450002
UPKREG   EQU   6                       ADDRESSES UNPACK AREA.           72500002
SETUPADR EQU   7                       ADDRESSES PRINT BUFFER.          72550002
PRTABREG EQU   8                       ADDRESSES CONVERSION TABLE.      72600002
BASEREG  EQU   9                       BASE REGISTER.                   72650002
BRANPRT  EQU   11                      ADDRESSES PRINT ROUTINE.         72700002
CLEAREG  EQU   12                                                       72750002
SAVADDR  EQU   13                      ADDRESSES REGISTER SAVE AREA.    72800002
BRANADDR EQU   14                      BRANCH REGISTER.                 72850002
*                                                                       72900002
*                            MESSAGES                                   72950002
*                                                                       73000002
*                                                                       73050002
CAUSERR  DC    C'-  CSW STORED BY  --             '                     73100002
ERRINT   DC    C'-  CSW STORED BY  INTERRUPT               '            73150002
ERRSIO   DC    C'SIO'                                                   73200002
ERRTIO   DC    C'TIO'                                                   73250002
ERRHIO   DC    C'HIO'                                                   73300002
NOUCB    DC    C'   NO ADDITIONAL ERROR INFORMATION AVAILABLE.'         73350002
COMCODE  DC    C'   TERMINATION BY  --  '                               73400002
SYSRES   DC    C' SYSTEM RESET- CODE 3'                                 73450002
SELRES   DC    C' SELECTIVE RESET- CODE 2'                              73500002
FORCEND  DC    C' FORCED ENDING SEQUENCE- CODE 1'                       73550002
INTDISCN DC    C' INTERFACE DISCONNECT- CODE 0'                         73600002
RETCDVAL DC    C'   TIME CHANNEL DETECTED ERROR -'                      73650002
RCMSG    DC    C'RETRY CODE    '                                        73700002
MSGSTRT  DC    C' WHILE EXECUTING TIO                        '          73750002
         DC    C' BETWEEN COMMAND OUT AND UNIT STATUS RETURN '          73800002
         DC    C' COMMAND ACCEPTED BUT BEFORE DATA TRANSFER  '          73850002
         DC    C' SOME DATA TRANSFER-CSW COMMAND ADR UPDATED '          73900002
         DC    C' COMMAND REJECTED OR COMMAND OUT NOT SENT   '          73950002
         DC    C' COMMAND ACCEPTED-DATA TRANSFER UNDETERMINED'          74000002
         DC    C' COULD NOT BE ASSESSED                      '          74050002
NOTVM    DC    C' COULD NOT BE ASSESSED                      '          74100002
NORETRY  DC    C'0  PROGRAM ASSESSED NO RETRY'                          74150002
DISCIN   DC    C'   DISCONNECT IN ISSUED'                         19032 74200002
VALIDITY DC    C'0  VALIDITY OF RECORDED DATA '                         74250002
VALCOUNT DC    C'            COUNT              = NOT VALID'            74300002
SENSDATA DC    C'            SENSE DATA         = NOT STORED'           74350002
INVALUN  DC    C'            UNIT STATUS        = NOT VALID'            74400002
INVALCAD DC    C'            COMMAND ADDRESS    = NOT VALID'            74450002
INVALCHA DC    C'            CHANNEL ADDRESS    = NOT VALID'            74500002
INVALDVA DC    C'            DEVICE ADDRESS     = NOT VALID'            74550002
PSOERR   DC    C'0  PROBABLE SOURCE OF ERROR- '                         74600002
CPUERMSG DC    C'CPU'                                                   74650002
CHANERMS DC    C'CHANNEL'                                               74700002
SCUERMS  DC    C'STORAGE CONTROL UNIT'                            19032 74750002
STOGERMS DC    C'STORAGE'                                               74800002
IOINFER  DC    C'CONTROL UNIT '                                         74850002
HEADER   DC    C' CHANNEL  ERROR  ANALYSIS'                             74900002
ERMSG    DC    C'CHANNEL CTRL OR I/F CTRL CHECK '                       74950002
         DC    C'NOT INDICATED IN CSW-NO LOGOUT'                        75000002
         DC    C' WITH THIS RECORD'                                     75050002
MSHEAD   DC    C'MULTI-SYSTEM INFORMATION'              MESSAGES   MP   75100002
MSCPUID  DC    C'CPU 1 FAILED'                           FOR        MP  75150002
MSCPUST  DC    C'CPU STATUS WAS '              ONLY THE            MP   75200002
PART     DC    C'PARTITIONED'                           M65MP TO BE  MP 75250002
SHAR     DC    C'SHARED'                        ONLY                MP  75300002
RECON    DC    C' BUT RECONFIGURED OUT'                 WRITTEN ON  MP  75350002
CHCNFIG  DC    C'CPU 1 CHANNEL CONFIGURATION'            SEC       MP   75400002
CHTAB    DC    C'CH0--ON CH1--ON CH2--ON CH3--ON CH4--ON'  *       MP   75450002
         DC    C' CH5--ON CH6--ON'                    STORAGE  FOR   MP 75500002
MSASR    DC    C'INBOARD RECORD ENTRY CONSTRUCTED BY MCH'  *        MP  75550002
MSNERPIB DC    C'ERPIB NOT CREATED'         EREP RECORDS           MP   75600002
NXENTRY  DC    F'0'                                                     75650002
OFFMESS  DC    A(OFF)                          MULTI-PROCESSING    MP   75700002
OFF      DC    C'OFF'                         CONSTANTS            MP   75750002
         DC    C'LINE   '                       MESSAGES            MP  75800002
RG9PTR   DC    A(REG9)                                                  75850002
RTNPTR   DC    A(PRTERPIB-4)                                            75900002
LBLPTR   DC    A(LABELEND-1)                                            75950002
LPPTR    DC    A(LP)                                                    76000002
MYSAVE   DS    15F                                                      76050002
SVR13    DS    1F                                                       76100002
CONTAB   DC    C'0123456789ABCDEF'     HEX CHARACTERS F0-F6        MP   76150002
LEVELVD  EQU    3            MODULE LEVEL INDICATOR                MP   76200002
         DROP  R15                                                      76250002
CHNTYPE  DS    0C                                                       76300002
         USING *,R15                                                    76350002
         MVC   AD1(L7,R3),MSGA          MOVE UNKNOWN TYPE MSG           76400002
         CLI   AD0(R4),KA     COMPARE CCH TYPE TO  0A                   76450002
         BCR   CC2,R14                  BRANCH IF CHN TYPE HIGH         76500002
         BL    CHNTYPE0                 BRANCH IF CHN TYPE LOW          76550002
CHNTYPF  MVC   AD1(L16,R3),MSGF         CHN TYPE IS INTEGD FILE ADPTT   76600002
         BR    R14                      RETURN                          76650002
CHNTYPE0 DS    0C                                                       76700002
         CLI   AD0(R4),K2               COMPARE CHN TYPE TO A 2         76750002
         BH    CHNTYPE3                 BRANCH IF HIGH                  76800002
         BL    CHNTYPE1                 BRANCH IF CHN TYPE LOW 1        76850002
         MVC   AD1(L10,R3),MSGD         CHN TYPE IS INTGTD SEL          76900002
         BR    R14                      RETURN                          76950002
CHNTYPE3 MVC   AD1(L14,R3),MSGB         CHN TYPE IS INTGTD BLK MPX      77000002
         BR    R14                      RETURN                          77050002
CHNTYPE1 DS    0C                                                       77100002
         CLI   AD0(R4),K1               COMPARE CHN ID TO A 1           77150002
         BCR   CC4,R14                  BRANCH IF CHN TYPE LOW          77200002
         MVC   AD1(L10,R3),MSGC         CHN TYPE IS INTGTD MPX          77250002
         BR    R14                      RETURN                          77300002
KA       EQU   X'0A'                                                    77350002
MSGA     DC    C'UNKNOWN'                                               77400002
MSGB     DC    C'INTGTD BLK MPX'                                        77450002
MSGC     DC    C'INTGTD MPX'                                            77500002
MSGD     DC    C'INTGTD SEL'                                            77550002
MSGF     DC    C'INTGTD FILE ADPT'                                      77600002
         DROP  R15                                                      77650002
         EJECT                                                          77700002
FORMAT1  DC    F'0'                                                     77750002
FORMAT2  DC    F'0'                                                     77800002
LABELPTR DC    A(LABLAREA)                                              77850002
DISP     DC    FL2'0'                                                   77900002
         SPACE 2                                                        77950002
         DC    X'01'                                                    78000002
         DC         X'000B8B00'         SKIP TO CHANNEL 1               78050002
         LABEL ' '                                                      78100002
*                                                                       78150002
         LINE  (9,40),(1,35),SKIP=2                            @XA19715 78200001
         HEX   XMOD,0,2B                                       @XA19715 78240001
         HEX   XSER,0,3B                                       @XA19715 78280001
         LABEL 'MODEL','SERIAL NO.'                            @XA19715 78320001
         LINE  (10,)                                                    78370002
*                                                                       78400002
         ROUTINE    XRELN,CONVREL                                       78450002
         LABEL      'XXXX REL.'                                         78500002
         LINE       (21,40)                                             78550002
         ROUTINE    XKEY,SETSOURC                                       78600002
         LABEL      '--- RECORD SOURCE -','TYPE - INBOARD'              78650002
*                                                                       78700002
         LINE                                                           78750002
         ROUTINE    XJOBN,SETPGMN                                       78800002
         LABEL      'JOB NAME'                                          78850002
*                                                                       78900002
         LINE       ,(8,40),SKIP=1                                      78950002
         ROUTINE    XSWS8,CONVTIME                                      79000002
         LABEL      'DAY  YEAR','HH MM SS.TH'                           79050002
         LINE       (8,40),(1,40),SKIP=2                                79100002
         ROUTINE    XDATE,SETDATE                                       79150002
         HEX        XTIME,1,4B                                          79200002
         LABEL      'DATE _','TIME _'                                   79250002
*                                                                       79300002
         LINE       (23,1),(1,1)                                        79350002
         HEX        XCUA,0,3B                                           79400002
         LABEL      'CHANNEL/UNIT ADDRESS'                              79450002
*                                                                       79500002
         LINE       ,(14,1),SKIP=1                                      79550002
         ROUTINE    XKEY,SKIPPER                                        79600002
         LABEL      'CC   DA    FL     CT'                              79650002
         LINE       (14,3),(1,1),SKIP=2                                 79700002
         HEX        XFCCWCC,0,1B                                        79750002
         HEX        XFCCWDA,0,3B                                        79800002
         ROUTINE    XKEY,SPACER2                                        79850002
         HEX        XFCCWFL,0,1B                                        79900002
         HEX        XFCCW0,0,1B                                         79950002
         HEX        XFCCWCT,0,2B                                        80000002
         LABEL      'FAILING CCW'                                       80050002
*                                                                       80100002
         LINE       ,(14,1),SKIP=1                                      80150002
         ROUTINE    XKEY,SKIPPER                                        80200002
         LABEL      'K    CA    US CS  CT'                              80250002
         LINE       (14,3),(1,1),SKIP=2                                 80300002
         HEX        XCSWK,0,1B                                          80350002
         HEX        XCSWCA,0,3B                                         80400002
         ROUTINE    XKEY,SPACER2                                        80450002
         ROUTINE    XCSWUS0,SETHEX                                      80500002
         ROUTINE    XCSWCS0,SETHEX                                      80550002
         HEX        XCSWCT,0,2B                                         80600002
         LABEL      'CSW'                                               80650002
*                                                                       80700002
         LINE       ,(2,38),SKIP=1                                      80750002
         ROUTINE    XKEY,SKIPPER                                        80800002
         LABEL      'UNIT STATUS','CHANNEL STATUS'                      80850002
*                                                                       80900002
         LINE       (21,38),(3,38)                                      80950002
         BIN        XCSWUS0                                             81000002
         BIN        XCSWCS0                                             81050002
         LABEL      'ATTENTION','PRGM-CTLD IRPT'                        81100002
         LINE                                                           81150002
         BIN        XCSWUS1                                             81200002
         BIN        XCSWCS1                                             81250002
         LABEL      'STATUS MODIFIER','INCORRECT LENGTH'                81300002
         LINE                                                           81350002
         BIN        XCSWUS2                                             81400002
         BIN        XCSWCS2                                             81450002
         LABEL      'CONTROL UNIT END','PROGRAM CHECK'                  81500002
         LINE                                                           81550002
         BIN        XCSWUS3                                             81600002
         BIN        XCSWCS3                                             81650002
         LABEL      'BUSY','PROTECTION CHECK'                           81700002
         LINE                                                           81750002
         BIN        XCSWUS4                                             81800002
         BIN        XCSWCS4                                             81850002
         LABEL      'CHANNEL END','CHAN DATA CHECK'                     81900002
         LINE                                                           81950002
         BIN        XCSWUS5                                             82000002
         BIN        XCSWCS5                                             82050002
         LABEL      'DEVICE END','CHAN CTRL CHECK'                      82100002
         LINE                                                           82150002
         BIN        XCSWUS6                                             82200002
         BIN        XCSWCS6                                             82250002
         LABEL      'UNIT CHECK','I/F CTRL CHECK'                       82300002
         LINE       ,,SKIP=2                                            82350002
         BIN        XCSWUS7                                             82400002
         BIN        XCSWCS7                                             82450002
         LABEL      'UNIT EXCEPTION','CHAINING CHECK'                   82500002
*                                                                       82550002
         LINE       ,(1,1),SKIP=1                                       82600002
         ROUTINE    XKEY,SKIPPER                                        82650002
         LABEL      'I/O UNIT FOUND BUSY'                               82700002
         LINE       (27,5),(2,1),SKIP=2                                 82750002
         HEX        XAIO1                                               82800002
         HEX        XAIO2                                               82850002
         HEX        XAIO3                                               82900002
         HEX        XAIO4                                               82950002
         HEX        XAIO5                                               83000002
         HEX        XAIO6                                               83050002
         HEX        XAIO7                                               83100002
         HEX        XAIO8                                               83150002
         ROUTINE    XKEY,SETAIO                                         83200002
         LABEL      'CHANNEL/UNIT ADDR'                                 83250002
*                                                                       83300002
         LINE       ,(1,1),SKIP=1                                       83350002
         LABEL      '--- CHANNEL TYPE ---'                              83400002
         LINE  (1,1),(1,1),SKIP=2                                       83450002
         ROUTINE    XCHID,CHNTYPE                                       83500002
         LABEL      ''                                                  83550002
         LINE       ,(1,1),SKIP=1                                       83600002
         LABEL      'HEADER SENSE SWITCHES FOUND ON'                    83650002
         LINE       ,(2,1)                                              83700002
         ROUTINE    XSWS8,CHKSW9                                        83750002
         LABEL      'RECORD INCOMPLETE'                                 83800002
         LINE                                                           83850002
         ROUTINE    XSWS8,CHKSW10                                       83900002
         LABEL      'SYSTEM TERMINATED'                                 83950002
         LINE                                                           84000002
         ROUTINE    XSWS8,CHKSW11                                       84050002
         LABEL      'UNSUPPORTED CHANNEL'                               84100002
         LINE                                                           84150002
         ROUTINE    XSWS8,CHKSW12                                       84200002
         LABEL      'CUA ILLEGAL'                                       84250002
         LINE                                                           84300002
         ROUTINE    XSWS8,CHKSW13                                       84350002
         LABEL      'PORTION OF RECORD HAS BEEN DESTROYED'              84400002
         LINE                                                           84450002
         ROUTINE    XSWS8,CHKSW14                                       84500002
         LABEL 'ERP WAS IN PROGRESS'                                    84550002
         LINE                                                           84600002
         ROUTINE    XKEY,SKIPPER                                 P0417  84650002
         LABEL      ' '                                          P0417  84700002
PRTERPIB LINE  (1,1),(1,1),SKIP=1                                       84750002
         ROUTINE    XSWS8,IFCASR01                                      84800002
LABELEND LABEL     ''                                                   84850002
         DC    X'01000B8B00'                                            84900002
         LABEL  ''                                                      84950002
         LINE  ,(5,1),SKIP=2                                            85000002
         LABEL 'CPU DEPENDENT LOGOUT BYTES'                             85050002
         LINE  ,(16,60)                                                 85100002
         LABEL '--- CPU CHECKS 0 ---','--- CPU  CHECKS 1 ---'           85150002
         LINE  (25,30),(1,30),SKIP=1                                    85200002
         BIN   MCHRG00                                                  85250002
         BIN   MCHRG08                                                  85300002
         BIN   MCHRG16                                                  85350002
         LABEL 'EARLY CHECK','BUS IN','ALU BYTE 0'                      85400002
         LINE                                                           85500002
         BIN   MCHRG01                                                  85550002
         BIN   MCHRG09                                                  85600002
         BIN   MCHRG17                                                  85650002
         BIN   MCHRG25                                                  85700002
         LABEL 'LATE CHECK','DISPLAY BUS BYTE 0','ALU BYTE 1',         X85750002
               'ALU AUXILIARY'                                          85770002
         LINE                                                           85800002
         BIN   MCHRG02                                                  85850002
         BIN   MCHRG10                                                  85900002
         BIN   MCHRG18                                                  85950002
         BIN   MCHRG26                                                  86000002
         LABEL 'STOR INPUT DATA','ALU SHIFT','ALU CONTROLS',           X86050002
               'SP PROTECTION KEY'                                      86100002
         LINE                                                           86150002
         BIN   MCHRG03                                                  86200002
         BIN   MCHRG11                                                  86250002
         BIN   MCHRG19                                                  86300002
         BIN   MCHRG27                                                  86350002
         LABEL 'WS OUTPUT','SINGLE BIT ERROR','T REGISTER',      XM5997X86400002
               'SP STOR KEY'                                     XM5997 86420002
         LINE                                                           86450002
         BIN   MCHRG04                                                  86500002
         BIN   MCHRG12                                                  86550002
         BIN   MCHRG20                                                  86600002
         BIN   MCHRG28                                                  86650002
         LABEL 'SELECT LATCHES','DOUBLE BIT ERROR','CDR/CTRL',   XM5997X86700002
               'FIELD LENGTH CTR'                                       86750002
         LINE                                                           86800002
         BIN   MCHRG05                                                  86850002
         BIN   MCHRG13                                                  86900002
         BIN   MCHRG21                                                  86950002
         BIN   MCHRG29                                           XM5997 87000002
         LABEL 'WSAR','ECC ADDR CHECK','BRANCH DECODE',          XM5997X87050002
               'ASSOC ARRAY'                                     XM5997 87100002
         LINE                                                           87150002
         BIN   MCHRG06                                                  87200002
         BIN   MCHRG14                                                  87250002
         BIN   MCHRG22                                                  87300002
         BIN   MCHRG30                                           XM5997 87350002
         LABEL 'ASAR','CPU SAR CHECK','MICROPROGRAM',            XM5997X87380002
               'PHYSICAL REG'                                    XM5997 87410002
         LINE  (25,30),(1,30),SKIP=2                                    87450002
         BIN   MCHRG07                                                  87500002
         BIN   MCHRG15                                                  87550002
         LABEL 'DISP BUS BYTE 1','MS LAST ACCESS BIT'                   87600002
         LINE  (25,30),(1,30),SKIP=1                                    87800002
         HEX   BUFADRG                                           XM5997 87950002
         HEX   SAREG00                                           XM5997 88000002
         LABEL 'BACKUP ADDR REG','STOR ADDR REG'                 XM5997 88050002
         LINE  SKIP=2                                                   88150002
         BIN   ZONER00                                                  88250002
         BIN   ZONER01                                                  88350002
         BIN   ZONER03                                                  88450002
         LABEL 'CYCLE STEAL','CYCLE STEAL ZONE','DATA FLOW ZONE'        88550002
         LINE  ,(8,30)                                                  88650002
         LABEL 'RETRY THRESHOLD','CPU RETRY',                          X89350002
               '    INTERRUPT STATUS LATCHES'                           89400002
         LINE  (25,30),(1,30),SKIP=1                                    89450002
         BIN   BFCTRG00                                                 89500002
         BIN   BFCTRG08                                                 89550002
         BIN   BFCTRG16                                                 89600002
         BIN   BFCTRG24                                                 89650002
         LABEL 'GPR/STOR ALTERED','CPU RETRY FLAG','HRT OVERFLOW',     X89700002
               'TIMER ENABLE'                                           89750002
         LINE                                                           89800002
         BIN   BFCTRG01                                                 89850002
         BIN   BFCTRG13                                                 89900002
         BIN   BFCTRG17                                                 89950002
         BIN   BFCTRG25                                                 90000002
        LABEL 'SYSTEM DAMAGE','RETRY COUNT','NEW BYTE 83','START LATCH' 90050002
         LINE                                                           90100002
         BIN   BFCTRG02                                                 90150002
         ROUTINE    DUMMY,SKIPPER                                       90200002
         BIN   BFCTRG18                                                 90250002
         BIN   BFCTRG26                                                 90310002
         LABEL 'PSW/CR ALTERED','','PER REQUEST','M/C CHECK THRESHOLD'  90370002
         LINE                                                           90450002
         BIN   BFCTRG03                                                 90500002
         ROUTINE    DUMMY,SKIPPER                                       90550002
         BIN   BFCTRG19                                                 90600002
         BIN   BFCTRG27                                                 90650002
         LABEL 'SECOND ERROR','','SUCCESSFUL BRANCH','IC DUMPED'        90700002
         LINE                                                           90750002
         BIN   BFCTRG04                                                 90800002
         ROUTINE    DUMMY,SKIPPER                                       90850002
         BIN   BFCTRG20                                                 90900002
         BIN   BFCTRG28                                                 90950002
         LABEL 'PER ZONE 1','','RESTART BUTTON',                       X91000002
               'ALTER/DISPLAY REQUEST'                                  91050002
         LINE                                                           91100002
         ROUTINE DUMMY,SKIPPER                                          91150002
         ROUTINE    DUMMY,SKIPPER                                       91200002
         BIN   BFCTRG21                                                 91250002
         BIN   BFCTRG29                                                 91300002
         LABEL '','','STOP LATCH','MANUAL STATE'                        91350002
         LINE                                                           91400002
         ROUTINE    DUMMY,SKIPPER                                       91450002
         ROUTINE    DUMMY,SKIPPER                                       91500002
         BIN   BFCTRG22                                                 91550002
         BIN   BFCTRG30                                                 91580002
         LABEL '','','PRIO SAMPLE','PER LOG LATCH'                      91620002
         LINE  (85,30),(61,30),SKIP=2                                   91700002
         BIN   BFCTRG23                                                 91760002
         BIN   BFCTRG31                                                 91820002
         LABEL 'PER INSTR. FETCH','TOD CLOCK PRI'                       91880002
         LINE  ,(40,)                                                   91940002
         LABEL '-----CHANNEL LOGOUT BYTES-----'                         92050002
         LINE  (25,30),(6,30),SKIP=2                                    92100002
         LABEL 'ICA CHANNEL','SEL CHANNEL A','2319 IFA CHANNEL',       X92150002
               'SEL CHANNEL B'                                 @XA06108 92200002
         LINE  (25,30),(1,30),SKIP=1                                    92250002
         BIN   CHCTRG00                                          XM5997 92300002
         BIN   CHCTRG08                                                 92350002
         BIN   CHCTRG16                                                 92400002
         BIN   CHCTRG24                                                 92450002
         LABEL 'INTERFACE CHECK','CHAN CONTROL','CONTROL',       XM5997X92500002
               'CHAN CONTROL'                                    XM5997 92520002
         LINE                                                           92550002
         BIN   CHCTRG01                                          XM5997 92600002
         BIN   CHCTRG09                                                 92650002
         BIN   CHCTRG17                                                 92700002
         BIN   CHCTRG25                                                 92750002
         LABEL 'LSAR CHECK','I/F CONTROL CHECK','COUNT',         XM5997X92800002
               'I/F CONTROL CHECK'                               XM5997 92820002
         LINE                                                           92850002
         BIN   CHCTRG02                                          XM5997 92900002
         BIN   CHCTRG10                                                 92950002
         BIN   CHCTRG18                                                 93000002
         BIN   CHCTRG26                                                 93050002
         LABEL 'LSDR CHECK','CARD 1','FMF','CARD 1'              XM5997 93100002
         LINE                                                           93150002
         BIN   CHCTRG03                                          XM5997 93200002
         BIN   CHCTRG11                                                 93250002
         BIN   CHCTRG19                                                 93300002
         BIN   CHCTRG27                                                 93350002
         LABEL 'ALU OUTPUT CHECK','CARD 2','TIMING','CARD 2'     XM5997 93400002
         LINE                                                           93450002
         BIN   CHCTRG04                                                 93500002
         BIN   CHCTRG12                                                 93550002
         BIN   CHCTRG20                                                 93600002
         BIN   CHCTRG28                                                 93650002
         LABEL 'MINT REQUEST','CARD 3','SER/DES','CARD 3'        XM5997 93700002
         LINE                                                           93750002
         BIN   CHCTRG05                                                 93800002
         BIN   CHCTRG13                                                 93850002
         BIN   CHCTRG21                                                 93900002
         BIN   CHCTRG29                                                 93950002
         LABEL 'COMMAND END','CARD 4','FBO,FTO','CARD 4'                94000002
         LINE                                                           94010002
         BIN   CHCTRG06                                                 94020002
         BIN   CHCTRG14                                                 94150002
         BIN   CHCTRG22                                                 94200002
         BIN   CHCTRG30                                                 94250002
         LABEL 'STACK INTERRUPT','CARD 9','CCB REGS','CARD 9'    XM5997 94300002
         LINE  SKIP=2                                                   94340002
         BIN   CHCTRG07                                                 94380002
         ROUTINE DUMMY,SKIPPER                                          94420002
         BIN   CHCTRG23                                                 94421002
         LABEL 'I/O OP','','FED'                                        94422002
         LINE  (25,30),(6,30),SKIP=2                            XA00642 94423002
         ROUTINE DUMMY,SKIPPER                                  XA00642 94424002
         LABEL '3330 IFA CHANNEL'                              @XA06108 94425002
         LINE  (25,30),(1,30),SKIP=1                            XA00642 94426002
         BIN   CHANCK00                                         XA00642 94427002
         LABEL 'CONTROL CHECK'                                  XA00642 94428002
         LINE                                                           94429002
         BIN   CHANCK01                                         XA00642 94430002
         LABEL 'FMF/FCF'                                        XA00642 94431002
         LINE                                                           94432002
         BIN   CHANCK02                                         XA00642 94433002
         LABEL 'FDB0/FDB1/SUBTRACTOR'                           XA00642 94434002
         LINE                                                           94435002
         BIN   CHANCK03                                         XA00642 94436002
         LABEL 'BAR'                                            XA00642 94437002
         LINE                                                           94438002
         BIN   CHANCK04                                         XA00642 94439002
         LABEL 'OR/COMPARATOR'                                  XA00642 94440002
         LINE                                                           94441002
         BIN   CHANCK05                                         XA00642 94442002
         LABEL 'TIMING'                                         XA00642 94443002
         LINE                                                           94444002
         BIN   CHANCK06                                         XA00642 94445002
         LABEL 'FBO/FTO'                                        XA00642 94446002
         LINE  ,,SKIP=2                                         XA00642 94447002
         BIN   CHANCK07                                         XA00642 94448002
         LABEL 'FBI/FCM'                                        XA00642 94449002
         LINE  ,(5,26),SKIP=2                                           94540002
         LABEL '-----CPU CHECKS-----'                                   94580002
         LINE  (51,1),(1,1),SKIP=2                             @XA06108 94620002
         ROUTINE ZONER00,SETHEX                                @XA06108 94640002
         LABEL 'CHECKS 0   CHECKS 1   ZONE IN ERROR'           @XA06108 94660002
         LINE  (3,11),(23,1),SKIP=1                            @XA06108 94700002
         HEX   CHK0,1,2B                                                94740002
         HEX   CHK1,1,2B                                                94780002
         ROUTINE ZONER00,CYCLFLG                               @XA06108 94900002
         LABEL 'CYCLE STEAL FLAG (BIT 0)            '          @XA06108 94906002
         LINE  ,                                               @XA06108 94912002
         ROUTINE ZONER01,CYCLZON                               @XA06108 94918002
         LABEL 'CYCLE STEAL ZONE (BIT 1-3)          '          @XA06108 94924002
         LINE  SKIP=2                                          @XA06108 94930002
         ROUTINE ZONER03,DATAZON                               @XA06108 94936002
         LABEL 'DATA FLOW ZONE   (BIT 5-7)          '          @XA06108 94942002
         LINE  SKIP=1                                                   94950002
         LABEL ''                                                       95000002
DUMPCODE DC    X'FF'                                                    95050002
DUMPSIZE DC    XL2'6D'           SIZE OF LOGOUT                @XA06108 95100002
         DC    XL2'50'                  HEADER                          95150002
ADDRLABL DC    XL2'FC'           RECORD ADDRESS                @XA06108 95200002
         LABEL     ''                                                   95250002
LABLAREA EQU   *                                                        95300002
         LSTART                                                         95350002
         END                                                            95400002
