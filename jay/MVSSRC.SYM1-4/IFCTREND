         TITLE 'IFCTREND - SYSTEM SUMMARY FOR EREP PROCESSING          *00001000
                        '                                               00002000
IFCTREND CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IFCTREND  77.315'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         STM   @00,@12,20(@13)                                     0001 00011000
         BALR  @12,0                                               0001 00012000
@PSTART  LA    @11,4095(,@12)                                      0001 00013000
         LA    @10,4095(,@11)                                      0001 00014000
         USING @PSTART,@12                                         0001 00015000
         USING @PSTART+4095,@11                                    0001 00016000
         USING @PSTART+8190,@10                                    0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LA    @14,@SA00001                                        0001 00019000
         ST    @14,8(,@13)                                         0001 00020000
         LR    @13,@14                                             0001 00021000
*/********************************************************************/ 00022000
*/*                                                          @Z427VLS*/ 00023000
*/* THIS IS THE ROOT SEGMENT.                                @Z427VLS*/ 00024000
*/* IT EXECUTES THE PROCS WHICH PRINT PARTS 1 AND 2 OF THE TREND     */ 00025000
*/* REPORT.                                                  @Z427VLS*/ 00026000
*/*                                                          @Z427VLS*/ 00027000
*/* PART 1 - THE TRENDONE TABLE PROVIDES CPU ERROR DATA TO PRODUCE   */ 00028000
*/*          A SYSTEM OVERVIEW BY DAY, BY CPU.               @Z427VLS*/ 00029000
*/*                                                          @Z427VLS*/ 00030000
*  IF DEBUG4 = ON THEN       /*PRINT THE NAME AND THE COMPILE DATE   */ 00031000
         TM    DEBUG4(R2),B'00001000'                              0123 00032000
         BNO   @RF00123                                            0123 00033000
*   DO;                                                    /*@Z427VLS*/ 00034000
*R15 = R12 -27;                                            /*@0099VLS*/ 00035000
         LR    R15,R12                                             0125 00036000
         SL    R15,@CF00672                                        0125 00037000
*    DDTYPE = '1';                                         /*@Z427VLS*/ 00038000
         MVI   DDTYPE,C'1'                                         0126 00039000
*    GEN(MVC  PRTLINE(16),0(R15));                         /*@Z427VLS*/ 00040000
         MVC  PRTLINE(16),0(R15)                                        00041000
*    CALL PRINT2;                                          /*@Z427VLS*/ 00042000
         BAL   @14,PRINT2                                          0128 00043000
*    DDTYPE = '0';                                         /*@Z427VLS*/ 00044000
         MVI   DDTYPE,C'0'                                         0129 00045000
*   END;                                                   /*@Z427VLS*/ 00046000
*  IF DEBUG21 = ON THEN                                            0131 00047000
@RF00123 TM    DEBUG21(R2),B'00000100'                             0131 00048000
         BNO   @RF00131                                            0131 00049000
*   CALL HEXDUMP;                                          /*@Z427VLS*/ 00050000
         BAL   @14,HEXDUMP                                         0132 00051000
*  CALL HEADING1;            /* PRINT REPORT HEADING.        @Z427VLS*/ 00052000
@RF00131 BAL   @14,HEADING1                                        0133 00053000
*  CALL HEADING2;            /* PRINT DAY HEADING.           @Z427VLS*/ 00054000
         BAL   @14,HEADING2                                        0134 00055000
*  MYLINECT = FOUR;              /* LINECT AFTER HEADER      @ZA26429*/ 00056000
         MVC   MYLINECT(4),@CF00063                                0135 00057000
*  CALL CPUERREC;            /* PRINT ERROR COUNTS.          @Z427VLS*/ 00058000
         BAL   @14,CPUERREC                                        0136 00059000
*  CALL CPUMODSN;            /* PRINT CPU, MODEL, SERIAL NO. LIST.   */ 00060000
         BAL   @14,CPUMODSN                                        0137 00061000
*                            /* FREE TRENDONE STORAGE        @Z427VLS*/ 00062000
*/* PART 2 - THE TREND2 TABLE PROVIDES I/O SUBSYSTEM ERROR DATA TO   */ 00063000
*/*          PRODUCE A SUBSYSTEM SUMMARY BY DAY, BY CUA.     @Z427VLS*/ 00064000
*/*                                                          @Z427VLS*/ 00065000
*  IF SORTNUM ^= ZERO & DEBUG51 ^= ON THEN                         0138 00066000
         L     @03,SORTNUM(,R2)                                    0138 00067000
         LTR   @03,@03                                             0138 00068000
         BZ    @RF00138                                            0138 00069000
         TM    DEBUG51(R2),B'00010000'                             0138 00070000
         BO    @RF00138                                            0138 00071000
*    DO;                                                   /*@Z427VLS*/ 00072000
*      CALL INITPRT2;        /* INITIALIZE REPORT HEADING,PARAMETERS.*/ 00073000
         BAL   @14,INITPRT2                                        0140 00074000
*      CALL HEADING1;        /* PRINT REPORT HEADING.        @Z427VLS*/ 00075000
         BAL   @14,HEADING1                                        0141 00076000
*      CALL HEADING2;        /* PRINT DAY HEADING.           @Z427VLS*/ 00077000
         BAL   @14,HEADING2                                        0142 00078000
*      MYLINECT = FOUR;          /* LINECT AFTER HEADER      @ZA26429*/ 00079000
         MVC   MYLINECT(4),@CF00063                                0143 00080000
*      CALL CUAERREC;        /* SUMMARIZE ERROR COUNTS, PRINT.       */ 00081000
         BAL   @14,CUAERREC                                        0144 00082000
*      CALL CPUMODSN;        /* PRINT CPU, MODEL, SERIAL NO. LIST.   */ 00083000
         BAL   @14,CPUMODSN                                        0145 00084000
*    END;                                                  /*@Z427VLS*/ 00085000
*  IF DEBUG12 = ON THEN                                            0147 00086000
@RF00138 TM    DEBUG12(R2),B'00001000'                             0147 00087000
         BNO   @RF00147                                            0147 00088000
*    GEN(ABEND 340,DUMP);                                  /*@Z427VLS*/ 00089000
         ABEND 340,DUMP                                                 00090000
*  RESPECIFY (R15) RESTRICTED;                             /*@Z427VLS*/ 00091000
@RF00147 DS    0H                                                  0150 00092000
*  R15 = RETCODE;            /* NORMAL RETURN                @Z427VLS*/ 00093000
         LH    R15,RETCODE                                         0150 00094000
*  RESPECIFY (R15) UNRESTRICTED;                           /*@Z427VLS*/ 00095000
*  RETURN;                                                 /*@Z427VLS*/ 00096000
@EL00001 L     @13,4(,@13)                                         0152 00097000
@EF00001 DS    0H                                                  0152 00098000
@ER00001 L     @14,12(,@13)                                        0152 00099000
         LM    @00,@12,20(@13)                                     0152 00100000
         BR    @14                                                 0152 00101000
*/********************************************************************/ 00102000
*/*                                                          @Z427VLS*/ 00103000
*/* THIS PROC PRINTS THE REPORT HEADING FOR PARTS 1 AND 2.   @Z427VLS*/ 00104000
*/*                                                          @Z427VLS*/ 00105000
*HEADING1:  PROC;                                          /*@Z427VLS*/ 00106000
HEADING1 STM   @14,@12,@SA00002                                    0153 00107000
*  CALL PRINT2;              /* PRINT BLANK LINE - SKIP TO NEW PAGE  */ 00108000
         BAL   @14,PRINT2                                          0154 00109000
*  SPACING = SINGLE;                                       /*@Z427VLS*/ 00110000
         MVI   SPACING,X'09'                                       0155 00111000
*  LNESPACE = ONE;                                         /*@Z427VLS*/ 00112000
         MVC   LNESPACE(4),@CF00054                                0156 00113000
*  DAYSDATE = DATENOW;       /* MOVE REPORT DATE TO PRINT LINE       */ 00114000
         MVC   DAYSDATE(6),DATENOW(R2)                             0157 00115000
*  HEADMOVE = LINE1;         /* MOVE LINE 1 OF HEADING TO PRINT AREA */ 00116000
         MVC   HEADMOVE(57),LINE1                                  0158 00117000
*  CALL PRINT2;              /* PRINT HEADING - 1ST LINE  - NEW PAGE */ 00118000
         BAL   @14,PRINT2                                          0159 00119000
*  NUMBER = TWO;             /* TWO BYTES TO BE CONVERTED    @Z427VLS*/ 00120000
         MVC   NUMBER(4),@CF00073                                  0160 00121000
*  SAVEDAY = EVSDAY;                                       /*@Z427VLS*/ 00122000
         MVC   SAVEDAY(2),EVSDAY(R2)                               0161 00123000
*  SRL (SAVEDAY,FOUR);       /* REMOVE SIGN                  @Z427VLS*/ 00124000
         SLR   @03,@03                                             0162 00125000
         ICM   @03,3,SAVEDAY                                       0162 00126000
         SRL   @03,4                                               0162 00127000
         STCM  @03,3,SAVEDAY                                       0162 00128000
*  NEXTBY = ADDR(SAVEDAY);   /* DATA SOURCE                  @Z427VLS*/ 00129000
         LA    @03,SAVEDAY                                         0163 00130000
         ST    @03,NEXTBY                                          0163 00131000
*  ADDNXT = ADDR(FROMDATE)-1;/* DATA DESTINATION - 2ND PRINT LINE    */ 00132000
         LA    @03,FROMDATE                                        0164 00133000
         BCTR  @03,0                                               0164 00134000
         ST    @03,ADDNXT                                          0164 00135000
*  SWITCH1 = ON;             /* DON'T CONVERT LEFT-MOST HALF BYTE    */ 00136000
         OI    SWITCH1,B'00001000'                                 0165 00137000
*  CALL CONVERT;             /* CONVERT 'PERIOD FROM' DAY TO EBCDIC  */ 00138000
         BAL   @14,CONVERT                                         0166 00139000
*  NUMBER = ONE;             /* ONE BYTE TO BE CONVERTED     @Z427VLS*/ 00140000
         MVC   NUMBER(4),@CF00054                                  0167 00141000
*  NEXTBY = ADDR(EVSYEAR);   /* DATA SOURCE - PARM TABLE     @Z427VLS*/ 00142000
         LA    @03,EVSYEAR(,R2)                                    0168 00143000
         ST    @03,NEXTBY                                          0168 00144000
*  ADDNXT = ADDR(FROMYEAR);  /* DATA DESTINATION - 2ND PRINT LINE    */ 00145000
         LA    @03,FROMYEAR                                        0169 00146000
         ST    @03,ADDNXT                                          0169 00147000
*  CALL CONVERT;             /* CONVERT 'PERIOD FROM' YEAR TO EBCDIC */ 00148000
         BAL   @14,CONVERT                                         0170 00149000
*  HEADMOVE = LINE2;         /* MOVE LINE 2 OF HEADING TO PRINT AREA */ 00150000
         MVC   HEADMOVE(57),LINE2                                  0171 00151000
*  CALL PRINT2;              /* PRINT HEADING - 2ND LINE     @Z427VLS*/ 00152000
         BAL   @14,PRINT2                                          0172 00153000
*  NUMBER = TWO;             /* TWO BYTES TO BE CONVERTED    @Z427VLS*/ 00154000
         MVC   NUMBER(4),@CF00073                                  0173 00155000
*  SAVEDAY = EVDAY;                                        /*@Z427VLS*/ 00156000
         L     @03,EVPTR(,R2)                                      0174 00157000
         MVC   SAVEDAY(2),EVDAY(@03)                               0174 00158000
*  SRL (SAVEDAY,FOUR);       /* REMOVE SIGN                  @Z427VLS*/ 00159000
         SLR   @03,@03                                             0175 00160000
         ICM   @03,3,SAVEDAY                                       0175 00161000
         SRL   @03,4                                               0175 00162000
         STCM  @03,3,SAVEDAY                                       0175 00163000
*  NEXTBY = ADDR(SAVEDAY);   /* DATA SOURCE                  @Z427VLS*/ 00164000
         LA    @03,SAVEDAY                                         0176 00165000
         ST    @03,NEXTBY                                          0176 00166000
*  ADDNXT = ADDR(TODATE)-1;  /* DATA DESTINATION - 3RD PRINT LINE    */ 00167000
         LA    @03,TODATE                                          0177 00168000
         BCTR  @03,0                                               0177 00169000
         ST    @03,ADDNXT                                          0177 00170000
*  SWITCH1 = ON;             /* DON'T CONVERT LEFT-MOST HALF BYTE    */ 00171000
         OI    SWITCH1,B'00001000'                                 0178 00172000
*  CALL CONVERT;             /* CONVERT 'PERIOD TO' DAY TO EBCDIC    */ 00173000
         BAL   @14,CONVERT                                         0179 00174000
*  NUMBER = ONE;             /* ONE BYTE TO BE CONVERTED     @Z427VLS*/ 00175000
         MVC   NUMBER(4),@CF00054                                  0180 00176000
*  NEXTBY = ADDR(EVYEAR);    /* DATA SOURCE - PARM TABLE     @Z427VLS*/ 00177000
         L     @03,EVPTR(,R2)                                      0181 00178000
         ST    @03,NEXTBY                                          0181 00179000
*  ADDNXT = ADDR(TOYEAR);    /* DATA DESTINATION - 3RD PRINT LINE    */ 00180000
         LA    @03,TOYEAR                                          0182 00181000
         ST    @03,ADDNXT                                          0182 00182000
*  CALL CONVERT;             /* CONVERT 'PERIOD TO' YEAR TO EBCDIC   */ 00183000
         BAL   @14,CONVERT                                         0183 00184000
*  HEADMOVE = LINE3;         /* MOVE LINE 3 OF HEADING TO PRINT AREA */ 00185000
         MVC   HEADMOVE(57),LINE3                                  0184 00186000
*  CALL PRINT2;              /* PRINT HEADING - 3RD LINE     @Z427VLS*/ 00187000
         BAL   @14,PRINT2                                          0185 00188000
*END;                                                      /*@Z427VLS*/ 00189000
@EL00002 DS    0H                                                  0186 00190000
@EF00002 DS    0H                                                  0186 00191000
@ER00002 LM    @14,@12,@SA00002                                    0186 00192000
         BR    @14                                                 0186 00193000
*/********************************************************************/ 00194000
*/*                                                          @Z427VLS*/ 00195000
*/* THIS PROC PRINTS THE DAY HEADING FOR PARTS 1 AND 2.      @Z427VLS*/ 00196000
*/*                                                          @Z427VLS*/ 00197000
*HEADING2:  PROC;                                          /*@Z427VLS*/ 00198000
HEADING2 STM   @14,@12,@SA00003                                    0187 00199000
*  CALL PRINT2;              /* PRINT BLANK LINE             @Z427VLS*/ 00200000
         BAL   @14,PRINT2                                          0188 00201000
*  NUMBER = ONE;             /* ONE BYTE TO BE CONVERTED     @Z427VLS*/ 00202000
         MVC   NUMBER(4),@CF00054                                  0189 00203000
*  NEXTBY = ADDR(PSTYR);     /* DATA SOURCE - PARM TABLE     @Z427VLS*/ 00204000
         LA    @03,PSTYR(,R2)                                      0190 00205000
         ST    @03,NEXTBY                                          0190 00206000
*  ADDNXT = ADDR(JYEAR);     /* DATA DESTINATION - 1ST PRINT LINE    */ 00207000
         LA    @03,JYEAR                                           0191 00208000
         ST    @03,ADDNXT                                          0191 00209000
*  CALL CONVERT;             /* CONVERT 'PERIOD FROM' YEAR TO EBCDIC */ 00210000
         BAL   @14,CONVERT                                         0192 00211000
*                            /*                              @Z427VLS*/ 00212000
*                            /* CONVERT STARTING DAY FROM HEX PLUS   */ 00213000
*                            /* SIGN(PACKED) TO BINARY TO COMPUTE    */ 00214000
*                            /* SUCCESSIVE DAYS FOR LINE 2 OF HEADING*/ 00215000
*                            /* THEN, CONVERT DAYS TO EBCDIC AND     */ 00216000
*                            /* FILL IN PRINT LINE           @Z427VLS*/ 00217000
*  CVB  (BINWORD,PSTDY);    /* - BINWORD - INPUT TO 'CONVBIN'       */  00218000
         XC    @TS00001(8),@TS00001                                0193 00219000
         MVC   @TS00001+6(2),PSTDY(R2)                             0193 00220000
         CVB   @03,@TS00001                                        0193 00221000
         ST    @03,BINWORD                                         0193 00222000
*  DO M = 1 TO NUMDAYS;                                    /*@Z427VLS*/ 00223000
         LA    @03,1                                               0194 00224000
         B     @DE00194                                            0194 00225000
@DL00194 DS    0H                                                  0195 00226000
*    DECADDR = ADDR(DAYNO(M))+1;  /* POINT TO DAY SLOT IN PRINT LINE */ 00227000
         SLA   @03,2                                               0195 00228000
         LA    @03,DAYNO-4(@03)                                    0195 00229000
         AL    @03,@CF00054                                        0195 00230000
         ST    @03,DECADDR                                         0195 00231000
*    CALL CONVBIN;                /* CONVERT DAY TO EBCDIC   @Z427VLS*/ 00232000
         BAL   @14,CONVBIN                                         0196 00233000
*    IF BINWORD = 365 THEN                                         0197 00234000
         CLC   BINWORD(4),@CF00693                                 0197 00235000
         BNE   @RF00197                                            0197 00236000
*      DO;                                                 /*@Z427VLS*/ 00237000
*        SAVEYR(2) = EVSYEAR;                              /*@Z427VLS*/ 00238000
         MVC   SAVEYR+1(1),EVSYEAR(R2)                             0199 00239000
*        SLL (SAVEYR,FOUR);                                /*@Z427VLS*/ 00240000
         SLR   @03,@03                                             0200 00241000
         ICM   @03,3,SAVEYR                                        0200 00242000
         SLL   @03,4                                               0200 00243000
         STCM  @03,3,SAVEYR                                        0200 00244000
*        SAVEYR(2) = SAVEYR(2) | SIGNPLUS;                 /*@Z427VLS*/ 00245000
         OI    SAVEYR+1,X'0F'                                      0201 00246000
*        CVB (BINYR,SAVEYR);                               /*@Z427VLS*/ 00247000
         XC    @TS00001(8),@TS00001                                0202 00248000
         MVC   @TS00001+6(2),SAVEYR                                0202 00249000
         CVB   @03,@TS00001                                        0202 00250000
         ST    @03,BINYR                                           0202 00251000
*        IF (BINYR/4 * 4) ^= BINYR THEN                            0203 00252000
         LR    @00,@03                                             0203 00253000
         SRDA  @00,32                                              0203 00254000
         D     @00,@CF00063                                        0203 00255000
         SLA   @01,2                                               0203 00256000
         CR    @01,@03                                             0203 00257000
         BE    @RF00203                                            0203 00258000
*          BINWORD = ZERO;        /* NORMAL YEAR             @Z427VLS*/ 00259000
         SLR   @03,@03                                             0204 00260000
         ST    @03,BINWORD                                         0204 00261000
*      END;                                                /*@Z427VLS*/ 00262000
*    ELSE                                                          0206 00263000
*      DO;                                                 /*@Z427VLS*/ 00264000
         B     @RC00197                                            0206 00265000
@RF00197 DS    0H                                                  0207 00266000
*        IF BINWORD = 366 THEN                                     0207 00267000
         CLC   BINWORD(4),@CF00695                                 0207 00268000
         BNE   @RF00207                                            0207 00269000
*          BINWORD = ZERO;        /* RESET DAY TALLY         @Z427VLS*/ 00270000
         SLR   @03,@03                                             0208 00271000
         ST    @03,BINWORD                                         0208 00272000
*      END;                                                /*@Z427VLS*/ 00273000
@RF00207 DS    0H                                                  0210 00274000
*      IF BINWORD = ZERO THEN     /*GOT TO MOVE IN ANOTHER YEAR LABEL*/ 00275000
@RC00197 L     @03,BINWORD                                         0210 00276000
         LTR   @03,@03                                             0210 00277000
         BNZ   @RF00210                                            0210 00278000
*       DO;                                                /*@Z427VLS*/ 00279000
*        NUMBER = ONE;                                     /*@Z427VLS*/ 00280000
         MVC   NUMBER(4),@CF00054                                  0212 00281000
*        NEXTBY = ADDR(PENYR);/* PICK UP NEXT YEAR           @Z427VLS*/ 00282000
         LA    @03,PENYR(,R2)                                      0213 00283000
         ST    @03,NEXTBY                                          0213 00284000
*        ADDNXT =(DECADDR + 5 - ADDR(DAYNO))+ (ADDR(LN1) + EIGHT); 0214 00285000
         LA    @03,5                                               0214 00286000
         AL    @03,DECADDR                                         0214 00287000
         LA    @15,DAYNO                                           0214 00288000
         SLR   @03,@15                                             0214 00289000
         LA    @15,LN1                                             0214 00290000
         AL    @15,@CF00065                                        0214 00291000
         ALR   @03,@15                                             0214 00292000
         ST    @03,ADDNXT                                          0214 00293000
*        CALL  CONVERT;      /* GO CONVERT TO PRINT          @Z427VLS*/ 00294000
         BAL   @14,CONVERT                                         0215 00295000
*       END;                                               /*@Z427VLS*/ 00296000
*      BINWORD = BINWORD + ONE;   /* SET NEXT DAY            @Z427VLS*/ 00297000
@RF00210 LA    @03,1                                               0217 00298000
         AL    @03,BINWORD                                         0217 00299000
         ST    @03,BINWORD                                         0217 00300000
*  END;                                                    /*@Z427VLS*/ 00301000
         LA    @03,1                                               0218 00302000
         AL    @03,M                                               0218 00303000
@DE00194 ST    @03,M                                               0218 00304000
         C     @03,NUMDAYS(,R2)                                    0218 00305000
         BNH   @DL00194                                            0218 00306000
*  HD2MOVE = LN1;            /* MOVE YEAR HEADING LINE TO PRINT AREA */ 00307000
         MVC   HD2MOVE(128),LN1                                    0219 00308000
*  CALL PRINT2;              /* PRINT YEAR HEADING           @Z427VLS*/ 00309000
         BAL   @14,PRINT2                                          0220 00310000
*  HD2MOVE = LN2;            /* MOVE DAY HEADING LINE TO PRINT AREA  */ 00311000
         MVC   HD2MOVE(128),LN2                                    0221 00312000
*  CALL PRINT2;              /* PRINT DAY HEADING            @Z427VLS*/ 00313000
         BAL   @14,PRINT2                                          0222 00314000
*  CALL PRINT2;              /* BLANK LINE                   @Z427VLS*/ 00315000
         BAL   @14,PRINT2                                          0223 00316000
*END;                                                      /*@Z427VLS*/ 00317000
@EL00003 DS    0H                                                  0224 00318000
@EF00003 DS    0H                                                  0224 00319000
@ER00003 LM    @14,@12,@SA00003                                    0224 00320000
         BR    @14                                                 0224 00321000
*HEXDUMP: PROC;                                            /*@Z427VLS*/ 00322000
HEXDUMP  STM   @14,@12,@SA00004                                    0225 00323000
*DCL BYTECT FIXED(31) INIT(0);                             /*@Z427VLS*/ 00324000
*SAVEPTR = TRENPTR;                                        /*@Z427VLS*/ 00325000
         L     @03,TRENPTR(,R2)                                    0227 00326000
         ST    @03,SAVEPTR                                         0227 00327000
*DDTYPE = '1';                                             /*@Z427VLS*/ 00328000
         MVI   DDTYPE,C'1'                                         0228 00329000
*BYTECT =(76 * NUMDAYS) + EIGHT;                           /*@0099VLS*/ 00330000
         L     @03,NUMDAYS(,R2)                                    0229 00331000
         MH    @03,@CH00700                                        0229 00332000
         AL    @03,@CF00065                                        0229 00333000
         ST    @03,BYTECT                                          0229 00334000
*DO J = 1 BY 1 TO EVNUM;                                   /*@Z427VLS*/ 00335000
         LA    @03,1                                               0230 00336000
         ST    @03,J                                               0230 00337000
         B     @DE00230                                            0230 00338000
@DL00230 DS    0H                                                  0231 00339000
* NUMBER = 66;                                             /*@Z427VLS*/ 00340000
         LA    @03,66                                              0231 00341000
         ST    @03,NUMBER                                          0231 00342000
* ADDNXT =ADDR(PRTLINE);                                   /*@Z427VLS*/ 00343000
         LA    @15,PRTLINE                                         0232 00344000
         ST    @15,ADDNXT                                          0232 00345000
* NEXTBY = TRENPTR;                                        /*@Z427VLS*/ 00346000
         L     @15,TRENPTR(,R2)                                    0233 00347000
         ST    @15,NEXTBY                                          0233 00348000
* DO I = 66 BY 66 TO BYTECT;                               /*@0099VLS*/ 00349000
         ST    @03,I                                               0234 00350000
         B     @DE00234                                            0234 00351000
@DL00234 DS    0H                                                  0235 00352000
*  CALL CONVERT;                                           /*@Z427VLS*/ 00353000
         BAL   @14,CONVERT                                         0235 00354000
*  NEXTBY = NEXTBY + 66;                                   /*@Z427VLS*/ 00355000
         LA    @03,66                                              0236 00356000
         AL    @03,NEXTBY                                          0236 00357000
         ST    @03,NEXTBY                                          0236 00358000
*  CALL PRINT2;                                            /*@Z427VLS*/ 00359000
         BAL   @14,PRINT2                                          0237 00360000
* END;                                                     /*@Z427VLS*/ 00361000
         LA    @03,66                                              0238 00362000
         AL    @03,I                                               0238 00363000
         ST    @03,I                                               0238 00364000
@DE00234 C     @03,BYTECT                                          0238 00365000
         BNH   @DL00234                                            0238 00366000
* IF NUMBER = BYTECT -(J - 66) THEN                                0239 00367000
         LA    @03,66                                              0239 00368000
         SL    @03,J                                               0239 00369000
         AL    @03,BYTECT                                          0239 00370000
         C     @03,NUMBER                                          0239 00371000
         BNE   @RF00239                                            0239 00372000
*  DO;                                                     /*@Z427VLS*/ 00373000
*   CALL CONVERT;                                          /*@Z427VLS*/ 00374000
         BAL   @14,CONVERT                                         0241 00375000
*   CALL PRINT2;                                           /*@Z427VLS*/ 00376000
         BAL   @14,PRINT2                                          0242 00377000
*  END;                                                    /*@Z427VLS*/ 00378000
* TRENPTR = TRENEXT;                                       /*@Z427VLS*/ 00379000
@RF00239 L     @03,TRENPTR(,R2)                                    0244 00380000
         L     @03,TRENEXT(,@03)                                   0244 00381000
         ST    @03,TRENPTR(,R2)                                    0244 00382000
*END;                                                      /*@Z427VLS*/ 00383000
         LA    @03,1                                               0245 00384000
         AL    @03,J                                               0245 00385000
         ST    @03,J                                               0245 00386000
@DE00230 L     @01,EVPTR(,R2)                                      0245 00387000
         CH    @03,EVNUM(,@01)                                     0245 00388000
         BNH   @DL00230                                            0245 00389000
*TRENPTR = SAVEPTR;                                        /*@Z427VLS*/ 00390000
         L     @03,SAVEPTR                                         0246 00391000
         ST    @03,TRENPTR(,R2)                                    0246 00392000
*DDTYPE = '0';                                             /*@Z427VLS*/ 00393000
         MVI   DDTYPE,C'0'                                         0247 00394000
*J = ZERO;                                                 /*@Z427VLS*/ 00395000
         SLR   @03,@03                                             0248 00396000
         ST    @03,J                                               0248 00397000
*X = ZERO;                                                 /*@Z427VLS*/ 00398000
         ST    @03,X                                               0249 00399000
*END;                                                      /*@Z427VLS*/ 00400000
@EL00004 DS    0H                                                  0250 00401000
@EF00004 DS    0H                                                  0250 00402000
@ER00004 LM    @14,@12,@SA00004                                    0250 00403000
         BR    @14                                                 0250 00404000
*/********************************************************************/ 00405000
*/*                                                          @Z427VLS*/ 00406000
*/* THIS PROC PRINTS ERROR COUNTS BY DAY BY CPU BY TYPE OF CPU       */ 00407000
*/* ERROR  - I.E. - IPL, MACHINE CHECK, CHANNEL CHECK, PROGRAM ERROR */ 00408000
*/*                                                          @Z427VLS*/ 00409000
*CPUERREC:  PROC;                                          /*@Z427VLS*/ 00410000
CPUERREC STM   @14,@12,@SA00005                                    0251 00411000
*DCL TREND6(16,30) FIXED(31) INIT((480)0);                 /*@0099VLS*/ 00412000
*DCL 1 NEWSW BIT(8) INIT('00'X),                                   0253 00413000
*    2 FOUND BIT(1) ,                                              0253 00414000
*    2 OUTSWTCH BIT(1);                                    /*@0099VLS*/ 00415000
*DCL NOFOUND CHAR(29) INIT('NO ERRORS FOUND FOR THIS CPU');/*@0099VLS*/ 00416000
*DCL CHAN CHAR(4) INIT('CHAN');                            /*@0099VLS*/ 00417000
*DCL Z1 FIXED(31) INIT(0);                                 /*@0099VLS*/ 00418000
*DCL Q FIXED(31) INIT(0);                                  /*@0099VLS*/ 00419000
*DCL Z2 FIXED(31) INIT(0);                                 /*@0099VLS*/ 00420000
*DCL ZCPU CHAR(3) INIT('CPU');                             /*@0099VLS*/ 00421000
*DCL   CHANZ(16) CHAR(6)                                           0260 00422000
*   INIT(' CHN-0',                                                 0260 00423000
*        ' CHN-1',                                                 0260 00424000
*        ' CHN-2',                                                 0260 00425000
*        ' CHN-3',                                                 0260 00426000
*        ' CHN-4',                                                 0260 00427000
*        ' CHN-5',                                                 0260 00428000
*        ' CHN-6',                                                 0260 00429000
*        ' CHN-7',                                                 0260 00430000
*        ' CHN-8',                                                 0260 00431000
*        ' CHN-9',                                                 0260 00432000
*        ' CHN-A',                                                 0260 00433000
*        ' CHN-B',                                                 0260 00434000
*        ' CHN-C',                                                 0260 00435000
*        ' CHN-D',                                                 0260 00436000
*        ' CHN-E',                                                 0260 00437000
*        ' CHN-F');                                        /*@0099VLS*/ 00438000
*DCL CHANID CHAR(6) DEFINED(LIN2) POS(3);                  /*@0099VLS*/ 00439000
*  SAVEPTR = TRENPTR;        /* SAVE POINTER TO ERROR TABLE - 1ST CPU*/ 00440000
         L     @03,TRENPTR(,R2)                                    0262 00441000
         ST    @03,SAVEPTR                                         0262 00442000
*  DO I = 1 TO FOUR;         /* LOOP FOR 4 CPU ERROR TYPES   @Z427VLS*/ 00443000
         LA    @03,1                                               0263 00444000
         ST    @03,I                                               0263 00445000
@DL00263 DS    0H                                                  0264 00446000
*    CALL PRINT1;            /* PRINT BLANK LINE             @Z427VLS*/ 00447000
         BAL   @14,PRINT1                                          0264 00448000
*    DSCRPT = DESCRIPT(I);   /* MOVE ERROR TYPE TO HEADING LINE      */ 00449000
         MVI   DSCRPT+13,C' '                                      0265 00450000
         MVC   DSCRPT+14(3),DSCRPT+13                              0265 00451000
         L     @03,I                                               0265 00452000
         MH    @03,@CH00540                                        0265 00453000
         LA    @01,DESCRIPT-13(@03)                                0265 00454000
         MVC   DSCRPT(13),0(@01)                                   0265 00455000
*    HD3MOVE = LIN1;         /* MOVE PRINT LINE TO PRINT AREA        */ 00456000
         MVC   HD3MOVE(128),LIN1                                   0266 00457000
*    CALL PRINT1;            /* PRINT ERROR TYPE HEADING     @Z427VLS*/ 00458000
         BAL   @14,PRINT1                                          0267 00459000
*    NUMCPUS = EVNUM;        /* NUMBER OF CPU'S - LOOP CONTROL       */ 00460000
         L     @03,EVPTR(,R2)                                      0268 00461000
         LH    @03,EVNUM(,@03)                                     0268 00462000
         ST    @03,NUMCPUS                                         0268 00463000
*  IF I = 3 THEN                                                   0269 00464000
         CLC   I(4),@CF00075                                       0269 00465000
         BNE   @RF00269                                            0269 00466000
*   DO Q  = 1 BY 1 TO NUMCPUS;                             /*@0099VLS*/ 00467000
         LA    @03,1                                               0270 00468000
         ST    @03,Q                                               0270 00469000
         B     @DE00270                                            0270 00470000
@DL00270 DS    0H                                                  0271 00471000
*   FOUND = NO;                                            /*@0099VLS*/ 00472000
         NI    FOUND,B'01111111'                                   0271 00473000
*    DO J = 1 BY 1 TO NUMDAYS;                             /*@0099VLS*/ 00474000
         LA    @03,1                                               0272 00475000
         ST    @03,J                                               0272 00476000
         B     @DE00272                                            0272 00477000
@DL00272 DS    0H                                                  0273 00478000
*     TREND6(1,J) = TRECCH0(J);                            /*@0099VLS*/ 00479000
         LR    @15,@03                                             0273 00480000
         SLA   @15,2                                               0273 00481000
         LR    @14,@03                                             0273 00482000
         MH    @14,@CH00700                                        0273 00483000
         L     @09,TRENPTR(,R2)                                    0273 00484000
         LA    @01,0(@14,@09)                                      0273 00485000
         AL    @01,@CF00814                                        0273 00486000
         L     @08,TRECCH0-16(,@01)                                0273 00487000
         ST    @08,TREND6-4(@15)                                   0273 00488000
*     TREND6(2,J) = TRECCH1(J);                            /*@0099VLS*/ 00489000
         LA    @01,0(@14,@09)                                      0274 00490000
         AL    @01,@CF00815                                        0274 00491000
         L     @08,TRECCH1-20(,@01)                                0274 00492000
         ST    @08,TREND6+116(@15)                                 0274 00493000
*     TREND6(3,J) = TRECCH2(J);                            /*@0099VLS*/ 00494000
         LA    @01,0(@14,@09)                                      0275 00495000
         AL    @01,@CF00816                                        0275 00496000
         L     @08,TRECCH2-24(,@01)                                0275 00497000
         ST    @08,TREND6+236(@15)                                 0275 00498000
*     TREND6(4,J) = TRECCH3(J);                            /*@0099VLS*/ 00499000
         LA    @01,0(@14,@09)                                      0276 00500000
         AL    @01,@CF00817                                        0276 00501000
         L     @08,TRECCH3-28(,@01)                                0276 00502000
         ST    @08,TREND6+356(@15)                                 0276 00503000
*     TREND6(5,J) = TRECCH4(J);                            /*@0099VLS*/ 00504000
         LA    @01,0(@14,@09)                                      0277 00505000
         AL    @01,@CF00818                                        0277 00506000
         L     @08,TRECCH4-32(,@01)                                0277 00507000
         ST    @08,TREND6+476(@15)                                 0277 00508000
*     TREND6(6,J) = TRECCH5(J);                            /*@0099VLS*/ 00509000
         LA    @01,0(@14,@09)                                      0278 00510000
         AL    @01,@CF00819                                        0278 00511000
         L     @08,TRECCH5-36(,@01)                                0278 00512000
         ST    @08,TREND6+596(@15)                                 0278 00513000
*     TREND6(7,J) = TRECCH6(J);                            /*@0099VLS*/ 00514000
         LA    @01,0(@14,@09)                                      0279 00515000
         AL    @01,@CF00820                                        0279 00516000
         L     @08,TRECCH6-40(,@01)                                0279 00517000
         ST    @08,TREND6+716(@15)                                 0279 00518000
*     TREND6(8,J) = TRECCH7(J);                            /*@0099VLS*/ 00519000
         LA    @01,0(@14,@09)                                      0280 00520000
         AL    @01,@CF00821                                        0280 00521000
         L     @08,TRECCH7-44(,@01)                                0280 00522000
         ST    @08,TREND6+836(@15)                                 0280 00523000
*     TREND6(9,J) = TRECCH8(J);                            /*@0099VLS*/ 00524000
         LA    @01,0(@14,@09)                                      0281 00525000
         AL    @01,@CF00822                                        0281 00526000
         L     @08,TRECCH8-48(,@01)                                0281 00527000
         ST    @08,TREND6+956(@15)                                 0281 00528000
*     TREND6(10,J) = TRECCH9(J);                           /*@0099VLS*/ 00529000
         LA    @01,0(@14,@09)                                      0282 00530000
         AL    @01,@CF00823                                        0282 00531000
         L     @08,TRECCH9-52(,@01)                                0282 00532000
         ST    @08,TREND6+1076(@15)                                0282 00533000
*     TREND6(11,J) = TRECCHA(J);                           /*@0099VLS*/ 00534000
         LA    @01,0(@14,@09)                                      0283 00535000
         AL    @01,@CF00824                                        0283 00536000
         L     @08,TRECCHA-56(,@01)                                0283 00537000
         ST    @08,TREND6+1196(@15)                                0283 00538000
*     TREND6(12,J) = TRECCHB(J);                           /*@0099VLS*/ 00539000
         LA    @01,0(@14,@09)                                      0284 00540000
         AL    @01,@CF00825                                        0284 00541000
         L     @08,TRECCHB-60(,@01)                                0284 00542000
         ST    @08,TREND6+1316(@15)                                0284 00543000
*     TREND6(13,J) = TRECCHC(J);                           /*@0099VLS*/ 00544000
         LA    @01,0(@14,@09)                                      0285 00545000
         AL    @01,@CF00826                                        0285 00546000
         L     @08,TRECCHC-64(,@01)                                0285 00547000
         ST    @08,TREND6+1436(@15)                                0285 00548000
*     TREND6(14,J) = TRECCHD(J);                           /*@0099VLS*/ 00549000
         LA    @01,0(@14,@09)                                      0286 00550000
         AL    @01,@CF00827                                        0286 00551000
         L     @08,TRECCHD-68(,@01)                                0286 00552000
         ST    @08,TREND6+1556(@15)                                0286 00553000
*     TREND6(15,J) = TRECCHE(J);                           /*@0099VLS*/ 00554000
         LA    @01,0(@14,@09)                                      0287 00555000
         AL    @01,@CF00828                                        0287 00556000
         L     @08,TRECCHE-72(,@01)                                0287 00557000
         ST    @08,TREND6+1676(@15)                                0287 00558000
*     TREND6(16,J) = TRECCHF(J);                           /*@0099VLS*/ 00559000
         L     @14,TRECCHF-76(@14,@09)                             0288 00560000
         ST    @14,TREND6+1796(@15)                                0288 00561000
*    END;                                                  /*@0099VLS*/ 00562000
         AL    @03,@CF00054                                        0289 00563000
         ST    @03,J                                               0289 00564000
@DE00272 C     @03,NUMDAYS(,R2)                                    0289 00565000
         BNH   @DL00272                                            0289 00566000
*    DO Z1 = 1 BY 1 TO 16;                                 /*@0099VLS*/ 00567000
         LA    @03,1                                               0290 00568000
         ST    @03,Z1                                              0290 00569000
@DL00290 DS    0H                                                  0291 00570000
*    LIN2 = LIN2 && LIN2;                                  /*@0099VLS*/ 00571000
         XC    LIN2(128),LIN2                                      0291 00572000
*    OUTSWTCH = OFF;                                       /*@0099VLS*/ 00573000
         NI    OUTSWTCH,B'10111111'                                0292 00574000
*    DO Z2 = 1 BY  1 TO NUMDAYS WHILE(OUTSWTCH = OFF);     /*@0099VLS*/ 00575000
         LA    @03,1                                               0293 00576000
         ST    @03,Z2                                              0293 00577000
         B     @DE00293                                            0293 00578000
@DL00293 TM    OUTSWTCH,B'01000000'                                0293 00579000
         BNZ   @DC00293                                            0293 00580000
*     IF TREND6(Z1,Z2) ^= 0 THEN                                   0294 00581000
         L     @15,Z1                                              0294 00582000
         MH    @15,@CH00538                                        0294 00583000
         ALR   @15,@03                                             0294 00584000
         SLA   @15,2                                               0294 00585000
         L     @03,TREND6-124(@15)                                 0294 00586000
         LTR   @03,@03                                             0294 00587000
         BZ    @RF00294                                            0294 00588000
*      OUTSWTCH = ON;                                      /*@0099VLS*/ 00589000
         OI    OUTSWTCH,B'01000000'                                0295 00590000
*    END;                                                  /*@0099VLS*/ 00591000
@RF00294 LA    @03,1                                               0296 00592000
         AL    @03,Z2                                              0296 00593000
         ST    @03,Z2                                              0296 00594000
@DE00293 C     @03,NUMDAYS(,R2)                                    0296 00595000
         BNH   @DL00293                                            0296 00596000
@DC00293 DS    0H                                                  0297 00597000
*    IF OUTSWTCH = ON THEN                                         0297 00598000
         TM    OUTSWTCH,B'01000000'                                0297 00599000
         BNO   @RF00297                                            0297 00600000
*     DO;                                                  /*@0099VLS*/ 00601000
*    IF FOUND = OFF THEN                                           0299 00602000
         TM    FOUND,B'10000000'                                   0299 00603000
         BNZ   @RF00299                                            0299 00604000
*    DO;                                                   /*@0099VLS*/ 00605000
*    LIN2(3:5) = ZCPU;                                     /*@0099VLS*/ 00606000
         MVC   LIN2+2(3),ZCPU                                      0301 00607000
*    LETTER = EVLETTER(Q);                                 /*@0099VLS*/ 00608000
         L     @03,Q                                               0302 00609000
         MH    @03,@CH00080                                        0302 00610000
         L     @01,EVPTR(,R2)                                      0302 00611000
         ALR   @01,@03                                             0302 00612000
         MVC   LETTER(1),EVLETTER-6(@01)                           0302 00613000
*    HD3MOVE = LIN2;                                       /*@0099VLS*/ 00614000
         MVC   HD3MOVE(128),LIN2                                   0303 00615000
*    CALL PRINT1;                                          /*@0099VLS*/ 00616000
         BAL   @14,PRINT1                                          0304 00617000
*    END;                                                  /*@0099VLS*/ 00618000
*      FOUND = ON;                                         /*@0099VLS*/ 00619000
@RF00299 OI    FOUND,B'10000000'                                   0306 00620000
*      CHANID = CHANZ(Z1);                                 /*@0099VLS*/ 00621000
         L     @03,Z1                                              0307 00622000
         MH    @03,@CH00080                                        0307 00623000
         LA    @01,CHANZ-6(@03)                                    0307 00624000
         MVC   CHANID(6),0(@01)                                    0307 00625000
*      DO K = 1 BY 1 TO NUMDAYS;                           /*@0099VLS*/ 00626000
         LA    @03,1                                               0308 00627000
         ST    @03,K                                               0308 00628000
         B     @DE00308                                            0308 00629000
@DL00308 DS    0H                                                  0309 00630000
*       BINWORD = TREND6(Z1,K);                            /*@0099VLS*/ 00631000
         L     @15,Z1                                              0309 00632000
         MH    @15,@CH00538                                        0309 00633000
         ALR   @15,@03                                             0309 00634000
         SLA   @15,2                                               0309 00635000
         L     @15,TREND6-124(@15)                                 0309 00636000
         ST    @15,BINWORD                                         0309 00637000
*       DECADDR = ADDR(ERCNT(K)) + 1;                      /*@0099VLS*/ 00638000
         SLA   @03,2                                               0310 00639000
         LA    @03,ERCNT-4(@03)                                    0310 00640000
         AL    @03,@CF00054                                        0310 00641000
         ST    @03,DECADDR                                         0310 00642000
*       CALL CONVBIN;                                      /*@0099VLS*/ 00643000
         BAL   @14,CONVBIN                                         0311 00644000
*      END;                                                /*@0099VLS*/ 00645000
         LA    @03,1                                               0312 00646000
         AL    @03,K                                               0312 00647000
         ST    @03,K                                               0312 00648000
@DE00308 C     @03,NUMDAYS(,R2)                                    0312 00649000
         BNH   @DL00308                                            0312 00650000
*      HD3MOVE = LIN2;                                     /*@0099VLS*/ 00651000
         MVC   HD3MOVE(128),LIN2                                   0313 00652000
*      CALL PRINT1;                                        /*@0099VLS*/ 00653000
         BAL   @14,PRINT1                                          0314 00654000
*      LIN2 = HD3MOVE;                                     /*@0099VLS*/ 00655000
         MVC   LIN2(128),HD3MOVE                                   0315 00656000
*     END;                                                 /*@0099VLS*/ 00657000
*    END;                                                  /*@0099VLS*/ 00658000
@RF00297 LA    @03,1                                               0317 00659000
         AL    @03,Z1                                              0317 00660000
         ST    @03,Z1                                              0317 00661000
         C     @03,@CF00088                                        0317 00662000
         BNH   @DL00290                                            0317 00663000
*    IF FOUND = NO THEN                                            0318 00664000
         TM    FOUND,B'10000000'                                   0318 00665000
         BNZ   @RF00318                                            0318 00666000
*    DO;                                                   /*@0099VLS*/ 00667000
*    DO K = 1 BY 1 TO NUMDAYS;                             /*@0099VLS*/ 00668000
         LA    @03,1                                               0320 00669000
         ST    @03,K                                               0320 00670000
         B     @DE00320                                            0320 00671000
@DL00320 DS    0H                                                  0321 00672000
*     ERCNT(K) = '404040F0'X;                              /*@0099VLS*/ 00673000
         LR    @15,@03                                             0321 00674000
         SLA   @15,2                                               0321 00675000
         LA    @14,ERCNT-4(@15)                                    0321 00676000
         MVC   0(4,@14),@CB00741                                   0321 00677000
*    END;                                                  /*@0099VLS*/ 00678000
         AL    @03,@CF00054                                        0322 00679000
         ST    @03,K                                               0322 00680000
@DE00320 C     @03,NUMDAYS(,R2)                                    0322 00681000
         BNH   @DL00320                                            0322 00682000
*    LETTER = EVLETTER(Q);                                 /*@0099VLS*/ 00683000
         L     @03,Q                                               0323 00684000
         MH    @03,@CH00080                                        0323 00685000
         L     @01,EVPTR(,R2)                                      0323 00686000
         ALR   @01,@03                                             0323 00687000
         MVC   LETTER(1),EVLETTER-6(@01)                           0323 00688000
*    LIN2(3:5) = ZCPU;                                     /*@0099VLS*/ 00689000
         MVC   LIN2+2(3),ZCPU                                      0324 00690000
*    HD3MOVE = LIN2;                                       /*@0099VLS*/ 00691000
         MVC   HD3MOVE(128),LIN2                                   0325 00692000
*    CALL PRINT1;                                          /*@0099VLS*/ 00693000
         BAL   @14,PRINT1                                          0326 00694000
*    END;                                                  /*@0099VLS*/ 00695000
*  TRENPTR = TRENEXT;                                      /*@0099VLS*/ 00696000
@RF00318 L     @03,TRENPTR(,R2)                                    0328 00697000
         L     @03,TRENEXT(,@03)                                   0328 00698000
         ST    @03,TRENPTR(,R2)                                    0328 00699000
*  LIN2(3:5) = ZCPU;                                       /*@0099VLS*/ 00700000
         MVC   LIN2+2(3),ZCPU                                      0329 00701000
* END;                                                     /*@0099VLS*/ 00702000
         LA    @03,1                                               0330 00703000
         AL    @03,Q                                               0330 00704000
         ST    @03,Q                                               0330 00705000
@DE00270 C     @03,NUMCPUS                                         0330 00706000
         BNH   @DL00270                                            0330 00707000
* ELSE                                                             0331 00708000
* DO;                                                      /*@0099VLS*/ 00709000
         B     @RC00269                                            0331 00710000
@RF00269 DS    0H                                                  0332 00711000
*  IF I = 4 THEN I = 19; /*MAKE UP FOR CHANNEL COUNTS        @0199VLS*/ 00712000
         CLC   I(4),@CF00063                                       0332 00713000
         BNE   @RF00332                                            0332 00714000
         MVC   I(4),@CF00617                                       0333 00715000
*  LIN2(3:5) = ZCPU;                                       /*@0099VLS*/ 00716000
@RF00332 MVC   LIN2+2(3),ZCPU                                      0334 00717000
*  TRENPTR = SAVEPTR;                                      /*@0099VLS*/ 00718000
         L     @03,SAVEPTR                                         0335 00719000
         ST    @03,TRENPTR(,R2)                                    0335 00720000
*    DO J = 1 TO NUMCPUS;    /* LOOP FOR NUMBER OF CPU'S     @Z427VLS*/ 00721000
         LA    @03,1                                               0336 00722000
         B     @DE00336                                            0336 00723000
@DL00336 DS    0H                                                  0337 00724000
*      LETTER = EVLETTER(J); /* MOVE CPU LETTER TO PRINT LINE        */ 00725000
         MH    @03,@CH00080                                        0337 00726000
         L     @01,EVPTR(,R2)                                      0337 00727000
         ALR   @01,@03                                             0337 00728000
         MVC   LETTER(1),EVLETTER-6(@01)                           0337 00729000
*      DO K = 1 TO NUMDAYS;  /* LOOP FOR NUMBER OF DAYS      @Z427VLS*/ 00730000
         LA    @03,1                                               0338 00731000
         B     @DE00338                                            0338 00732000
@DL00338 DS    0H                                                  0339 00733000
*        BINWORD = TREITM(K,I);   /* ERROR COUNT DATA        @Z427VLS*/ 00734000
         LR    @15,@03                                             0339 00735000
         MH    @15,@CH00617                                        0339 00736000
         AL    @15,I                                               0339 00737000
         SLA   @15,2                                               0339 00738000
         L     @01,TRENPTR(,R2)                                    0339 00739000
         AL    @01,@CF00832                                        0339 00740000
         L     @15,TREITM-8(@15,@01)                               0339 00741000
         ST    @15,BINWORD                                         0339 00742000
*        DECADDR = ADDR(ERCNT(K)) + 1; /* DAY SLOT IN PRINT LINE     */ 00743000
         SLA   @03,2                                               0340 00744000
         LA    @03,ERCNT-4(@03)                                    0340 00745000
         AL    @03,@CF00054                                        0340 00746000
         ST    @03,DECADDR                                         0340 00747000
*        CALL CONVBIN;            /* CONVERT ERROR DATA TO EBCDIC    */ 00748000
         BAL   @14,CONVBIN                                         0341 00749000
*      END;                                                /*@Z427VLS*/ 00750000
         LA    @03,1                                               0342 00751000
         AL    @03,K                                               0342 00752000
@DE00338 ST    @03,K                                               0342 00753000
         C     @03,NUMDAYS(,R2)                                    0342 00754000
         BNH   @DL00338                                            0342 00755000
*      HD3MOVE = LIN2;       /* MOVE PRINT LINE TO PRINT AREA        */ 00756000
         MVC   HD3MOVE(128),LIN2                                   0343 00757000
*      CALL PRINT1;          /* PRINT DAILY ERROR COUNTS - THIS CPU  */ 00758000
         BAL   @14,PRINT1                                          0344 00759000
*      TRENPTR = TRENEXT;    /* POINT TO ERROR TABLE - NEXT CPU      */ 00760000
         L     @03,TRENPTR(,R2)                                    0345 00761000
         L     @03,TRENEXT(,@03)                                   0345 00762000
         ST    @03,TRENPTR(,R2)                                    0345 00763000
*    END;                                                  /*@Z427VLS*/ 00764000
         LA    @03,1                                               0346 00765000
         AL    @03,J                                               0346 00766000
@DE00336 ST    @03,J                                               0346 00767000
         C     @03,NUMCPUS                                         0346 00768000
         BNH   @DL00336                                            0346 00769000
*  END;                                                    /*@0099VLS*/ 00770000
*    TRENPTR = SAVEPTR;      /* RE-SET POINT TO ERROR TABLE - 1ST    */ 00771000
@RC00269 L     @03,SAVEPTR                                         0348 00772000
         ST    @03,TRENPTR(,R2)                                    0348 00773000
*                            /* CPU - TO PROCESS NEXT ERROR TYPE     */ 00774000
*  END;                                                    /*@Z427VLS*/ 00775000
         LA    @03,1                                               0349 00776000
         AL    @03,I                                               0349 00777000
         ST    @03,I                                               0349 00778000
         C     @03,@CF00063                                        0349 00779000
         BNH   @DL00263                                            0349 00780000
*END;                                                      /*@Z427VLS*/ 00781000
@EL00005 DS    0H                                                  0350 00782000
@EF00005 DS    0H                                                  0350 00783000
@ER00005 LM    @14,@12,@SA00005                                    0350 00784000
         BR    @14                                                 0350 00785000
*/********************************************************************/ 00786000
*/*                                                          @Z427VLS*/ 00787000
*/* THIS PROC PRINTS THE MODEL AND SERIAL NO. OF THE CPU'S FOR WHICH */ 00788000
*/* ERROR COUNTS HAVE BEEN PRINTED                           @Z427VLS*/ 00789000
*/*                                                          @Z427VLS*/ 00790000
*CPUMODSN:  PROC;                                          /*@Z427VLS*/ 00791000
CPUMODSN STM   @14,@12,@SA00006                                    0351 00792000
*  IF ((LINECT - TWO) - MYLINECT) < (FIVE + NUMCPUS) THEN          0352 00793000
         LH    @03,LINECT(,R2)                                     0352 00794000
         BCTR  @03,0                                               0352 00795000
         BCTR  @03,0                                               0352 00796000
         SL    @03,MYLINECT                                        0352 00797000
         LA    @15,5                                               0352 00798000
         AL    @15,NUMCPUS                                         0352 00799000
         CR    @03,@15                                             0352 00800000
         BNL   @RF00352                                            0352 00801000
*    DO;                     /* DATA TO BE PRINTED WILL NOT FIT IN   */ 00802000
*      MYLINECT = ZERO;      /* REMAINING VERTICAL SPACE     @Z427VLS*/ 00803000
         SLR   @03,@03                                             0354 00804000
         ST    @03,MYLINECT                                        0354 00805000
*      SPACING = UPSPACE;                                  /*@Z427VLS*/ 00806000
         MVI   SPACING,X'89'                                       0355 00807000
*      CALL HEADING1;                                      /*@Z427VLS*/ 00808000
         BAL   @14,HEADING1                                        0356 00809000
*    END;                                                  /*@Z427VLS*/ 00810000
*      MYLINECT = ZERO;      /* REMAINING VERTICAL SPACE     @Z427VLS*/ 00811000
@RF00352 SLR   @03,@03                                             0358 00812000
         ST    @03,MYLINECT                                        0358 00813000
*      SPACING = TRIPLE;                                   /*@Z427VLS*/ 00814000
         MVI   SPACING,X'19'                                       0359 00815000
*      LNESPACE = THREE;                                   /*@Z427VLS*/ 00816000
         MVC   LNESPACE(4),@CF00075                                0360 00817000
*      CALL PRINT1;          /* SKIP 3 LINES                 @Z427VLS*/ 00818000
         BAL   @14,PRINT1                                          0361 00819000
*      SPACING = SINGLE;                                   /*@Z427VLS*/ 00820000
         MVI   SPACING,X'09'                                       0362 00821000
*      LNESPACE = ONE;                                     /*@Z427VLS*/ 00822000
         MVC   LNESPACE(4),@CF00054                                0363 00823000
*      CPULINE1 = CPULINE;   /* MOVE HEADING LINE TO PRINT AREA      */ 00824000
         MVC   CPULINE1(24),CPULINE                                0364 00825000
*      CALL PRINT1;          /* PRINT HEADING                @Z427VLS*/ 00826000
         BAL   @14,PRINT1                                          0365 00827000
*      CALL PRINT1;          /* PRINT BLANK LINE             @Z427VLS*/ 00828000
         BAL   @14,PRINT1                                          0366 00829000
*      DO I = 1 TO NUMCPUS;                                /*@Z427VLS*/ 00830000
         LA    @03,1                                               0367 00831000
         B     @DE00367                                            0367 00832000
@DL00367 DS    0H                                                  0368 00833000
*        CPUTYPE = EVLETTER(I);   /* MOVE CPU LETTER TO PRINT LINE   */ 00834000
         MH    @03,@CH00080                                        0368 00835000
         L     @15,EVPTR(,R2)                                      0368 00836000
         ST    @03,@TF00001                                        0368 00837000
         ALR   @03,@15                                             0368 00838000
         MVC   CPUTYPE(1),EVLETTER-6(@03)                          0368 00839000
*        NUMBER = TWO;            /* TWO BYTES TO BE CONVERTED       */ 00840000
         MVC   NUMBER(4),@CF00073                                  0369 00841000
*        NEXTBY = ADDR(EVMODEL(I));    /* DATA SOURCE - PARM TABLE   */ 00842000
         L     @03,@TF00001                                        0370 00843000
         LA    @03,EVMODEL-6(@03,@15)                              0370 00844000
         ST    @03,NEXTBY                                          0370 00845000
*        ADDNXT = ADDR(CPUMODEL); /* DATA DESTINATION - PRINT LINE   */ 00846000
         LA    @03,CPUMODEL                                        0371 00847000
         ST    @03,ADDNXT                                          0371 00848000
*        CALL CONVERT;            /* CONVERT CPU MODEL NO. TO EBCDIC */ 00849000
         BAL   @14,CONVERT                                         0372 00850000
*        NUMBER = THREE;          /* THREE BYTES TO BE CONVERTED     */ 00851000
         MVC   NUMBER(4),@CF00075                                  0373 00852000
*        NEXTBY = ADDR(EVSERIAL(I));   /* DATA SOURCE - PARM TABLE   */ 00853000
         L     @03,I                                               0374 00854000
         MH    @03,@CH00080                                        0374 00855000
         L     @01,EVPTR(,R2)                                      0374 00856000
         LA    @03,EVSERIAL-6(@03,@01)                             0374 00857000
         ST    @03,NEXTBY                                          0374 00858000
*        ADDNXT = ADDR(CPUSERAL);  /* DATA DESTINATION - PRINT LINE  */ 00859000
         LA    @03,CPUSERAL                                        0375 00860000
         ST    @03,ADDNXT                                          0375 00861000
*        CALL CONVERT;            /* CONVERT CPU SERIAL NO. TO EBCDIC*/ 00862000
         BAL   @14,CONVERT                                         0376 00863000
*        CPULINE1 = CPUDATA;      /* MOVE PRINT LINE TO PRINT AREA   */ 00864000
         MVI   CPULINE1+20,C' '                                    0377 00865000
         MVC   CPULINE1+21(3),CPULINE1+20                          0377 00866000
         MVC   CPULINE1(20),CPUDATA                                0377 00867000
*        CALL PRINT1;             /* PRINT CPU, MODEL, SERIAL NO.    */ 00868000
         BAL   @14,PRINT1                                          0378 00869000
*      END;                                                /*@Z427VLS*/ 00870000
         LA    @03,1                                               0379 00871000
         AL    @03,I                                               0379 00872000
@DE00367 ST    @03,I                                               0379 00873000
         C     @03,NUMCPUS                                         0379 00874000
         BNH   @DL00367                                            0379 00875000
*END;                                                      /*@Z427VLS*/ 00876000
@EL00006 DS    0H                                                  0380 00877000
@EF00006 DS    0H                                                  0380 00878000
@ER00006 LM    @14,@12,@SA00006                                    0380 00879000
         BR    @14                                                 0380 00880000
*/********************************************************************/ 00881000
*/*                                                          @Z427VLS*/ 00882000
*/* THIS PROC INITIALIZES PRINT CONTROLS AND LINES 2 AND 3 OF THE    */ 00883000
*/* REPORT HEADING FOR PART 2.                               @Z427VLS*/ 00884000
*INITPRT2:  PROC OPTIONS(NOSAVEAREA);                      /*@Z427VLS*/ 00885000
INITPRT2 STM   @14,@12,12(@13)                                     0381 00886000
*  SPACING = UPSPACE;        /* SET CARRIAGE CONTROL TO NEXT PAGE    */ 00887000
         MVI   SPACING,X'89'                                       0382 00888000
*  MYLINECT = ZERO;          /* CLEAR PRINT LINE COUNTER     @Z427VLS*/ 00889000
         SLR   @03,@03                                             0383 00890000
         ST    @03,MYLINECT                                        0383 00891000
*  LNESPACE = ZERO;          /* SET LINE COUNTER INCREMENT TO 0      */ 00892000
         ST    @03,LNESPACE                                        0384 00893000
*  LINE2 = LINE2P2;          /* CHANGE LINES 2, 3 OF REPORT HEADING  */ 00894000
         MVI   LINE2+51,C' '                                       0385 00895000
         MVC   LINE2+52(5),LINE2+51                                0385 00896000
         MVC   LINE2(51),LINE2P2                                   0385 00897000
*  LINE3 = LINE3P2;          /* TO PART 2 DATA               @Z427VLS*/ 00898000
         MVI   LINE3+51,C' '                                       0386 00899000
         MVC   LINE3+52(5),LINE3+51                                0386 00900000
         MVC   LINE3(51),LINE3P2                                   0386 00901000
*  DO J = 1 TO 30;                                         /*@Z427VLS*/ 00902000
         LA    @03,1                                               0387 00903000
         ST    @03,J                                               0387 00904000
@DL00387 DS    0H                                                  0388 00905000
*    PERMCT(J) = ZERO;                                     /*@Z427VLS*/ 00906000
         SLR   @15,@15                                             0388 00907000
         LR    @14,@03                                             0388 00908000
         SLA   @14,2                                               0388 00909000
         LA    @01,PERMCT-4(@14)                                   0388 00910000
         STCM  @15,15,0(@01)                                       0388 00911000
*    TEMPCT(J) = ZERO;                                     /*@Z427VLS*/ 00912000
         LA    @01,TEMPCT-4(@14)                                   0389 00913000
         STCM  @15,15,0(@01)                                       0389 00914000
*  END;                                                    /*@Z427VLS*/ 00915000
         AL    @03,@CF00054                                        0390 00916000
         ST    @03,J                                               0390 00917000
         C     @03,@CF00538                                        0390 00918000
         BNH   @DL00387                                            0390 00919000
* END;                                                     /*@Z427VLS*/ 00920000
@EL00007 DS    0H                                                  0391 00921000
@EF00007 DS    0H                                                  0391 00922000
@ER00007 LM    @14,@12,12(@13)                                     0391 00923000
         BR    @14                                                 0391 00924000
*/********************************************************************/ 00925000
*/*                                                          @Z427VLS*/ 00926000
*/* THIS PROC PERFORMS INITIALIZATION FOR TWO OTHER PROCS - ACCUMERR */ 00927000
*/* AND PRINTALL - WHICH SUMMARIZE OBR,MDR TEMPORARY AND PERMANENT   */ 00928000
*/* ERROR COUNTS BY DAY,BY CUA AND THEN PRINT RESPECTIVELY. SHARED   */ 00929000
*/* I/O IS REFLECTED IN THE REPORT,IF REQUESTED.             @Z427VLS*/ 00930000
*/*                                                          @Z427VLS*/ 00931000
*CUAERREC:  PROC;                                          /*@Z427VLS*/ 00932000
CUAERREC STM   @14,@12,@SA00008                                    0392 00933000
*  PREVGRP = TRENDGRP(1);               /* FIRST GROUP       @Z427VLS*/ 00934000
         L     @15,SORTADR(,R2)                                    0393 00935000
         SLR   PREVGRP,PREVGRP                                     0393 00936000
         IC    PREVGRP,TRENDGRP(,@15)                              0393 00937000
*  PREVDEV = TRENDDEV(1);               /* FIRST DEVICE      @Z427VLS*/ 00938000
         MVC   PREVDEV(2),TRENDDEV(@15)                            0394 00939000
*  PREVCPU = TRENCPUS(1) & 'F0'X;       /* FIRST CPU         @Z427VLS*/ 00940000
         MVC   PREVCPU(1),TRENCPUS(@15)                            0395 00941000
         NI    PREVCPU,X'F0'                                       0395 00942000
*  PREVCUA = TRENDRT(1) & 'FFF0'X;      /* FIRST CUA         @Z427VLS*/ 00943000
         MVC   PREVCUA(2),TRENDRT(@15)                             0396 00944000
         NC    PREVCUA(2),@CB00752                                 0396 00945000
*  I = 1;                                                  /*@Z427VLS*/ 00946000
         MVC   I(4),@CF00054                                       0397 00947000
*  DO UNTIL (I > SORTNUM);                                 /*@Z427VLS*/ 00948000
@DL00398 DS    0H                                                  0399 00949000
*    CALL PRTGROUP;               /* PRINT GROUP HEADING     @Z427VLS*/ 00950000
         BAL   @14,PRTGROUP                                        0399 00951000
*    DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I));      /*@Z427VLS*/ 00952000
@DL00400 DS    0H                                                  0401 00953000
*      IF PREVGRP = 5 THEN                                         0401 00954000
         C     PREVGRP,@CF00078                                    0401 00955000
         BNE   @RF00401                                            0401 00956000
*        CALL TPCNTRL;               /* DO TP CONTROLLER     @Z427VLS*/ 00957000
         BAL   @14,TPCNTRL                                         0402 00958000
*      IF I ^> SORTNUM THEN                                        0403 00959000
@RF00401 L     @15,I                                               0403 00960000
         C     @15,SORTNUM(,R2)                                    0403 00961000
         BH    @RF00403                                            0403 00962000
*       DO;                                                /*@Z427VLS*/ 00963000
*      CALL DODEVTYP;               /* PRINT THE DEVICE TYPE @Z427VLS*/ 00964000
         BAL   @14,DODEVTYP                                        0405 00965000
*      DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |            0406 00966000
*                PREVDEV ^= TRENDDEV(I));                  /*@Z427VLS*/ 00967000
@DL00406 DS    0H                                                  0407 00968000
*        CALL DOCUA;                 /* DETERMINE THE CUA    @Z427VLS*/ 00969000
         BAL   @14,DOCUA                                           0407 00970000
*        DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |          0408 00971000
*                  PREVDEV ^= TRENDDEV(I) |                        0408 00972000
*                  PREVCUA ^= (TRENDRT(I) & 'FFF0'X));     /*@Z427VLS*/ 00973000
@DL00408 DS    0H                                                  0409 00974000
*          CPUWORK = PREVCPU;                              /*@Z427VLS*/ 00975000
         MVC   CPUWORK(1),PREVCPU                                  0409 00976000
*          SRL (CPUWORK,FOUR);                             /*@Z427VLS*/ 00977000
         SLR   @15,@15                                             0410 00978000
         IC    @15,CPUWORK                                         0410 00979000
         SRL   @15,4                                               0410 00980000
         STC   @15,CPUWORK                                         0410 00981000
*          LABELCPU(CPU+1) = 1;      /* SET FOR BASE CPU     @Z427VLS*/ 00982000
         SLR   @01,@01                                             0411 00983000
         IC    @01,CPU                                             0411 00984000
         LA    @00,1                                               0411 00985000
         STC   @00,LABELCPU(@01)                                   0411 00986000
*          DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |        0412 00987000
*                    PREVDEV ^= TRENDDEV(I) |                      0412 00988000
*                    PREVCUA ^= (TRENDRT(I) & 'FFF0'X) |           0412 00989000
*                    PREVCPU ^= (TRENCPUS(I) & 'F0'X));    /*@Z427VLS*/ 00990000
@DL00412 DS    0H                                                  0413 00991000
*            CALL ACCUMERR;           /* TOTAL INTO THE BUCKETS      */ 00992000
         BAL   @14,ACCUMERR                                        0413 00993000
*          END;                                            /*@Z427VLS*/ 00994000
@DE00412 L     @15,I                                               0414 00995000
         C     @15,SORTNUM(,R2)                                    0414 00996000
         BH    @DC00412                                            0414 00997000
         MH    @15,@CH00476                                        0414 00998000
         L     @14,SORTADR(,R2)                                    0414 00999000
         LA    @01,0(@15,@14)                                      0414 01000000
         AL    @01,@CF00833                                        0414 01001000
         SLR   @00,@00                                             0414 01002000
         IC    @00,TRENDGRP(,@01)                                  0414 01003000
         CR    PREVGRP,@00                                         0414 01004000
         BNE   @DC00412                                            0414 01005000
         ST    @15,@TF00001                                        0414 01006000
         ALR   @15,@14                                             0414 01007000
         AL    @15,@CF00827                                        0414 01008000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0414 01009000
         BNE   @DC00412                                            0414 01010000
         LR    @15,@14                                             0414 01011000
         AL    @15,@TF00001                                        0414 01012000
         AL    @15,@CF00834                                        0414 01013000
         MVC   @TS00001(2),TRENDRT-1(@15)                          0414 01014000
         NC    @TS00001(2),@CB00752                                0414 01015000
         CLC   PREVCUA(2),@TS00001                                 0414 01016000
         BNE   @DC00412                                            0414 01017000
         AL    @14,@TF00001                                        0414 01018000
         AL    @14,@CF00835                                        0414 01019000
         MVC   @TS00001(1),TRENCPUS-3(@14)                         0414 01020000
         NI    @TS00001,X'F0'                                      0414 01021000
         CLC   PREVCPU(1),@TS00001                                 0414 01022000
         BE    @DL00412                                            0414 01023000
@DC00412 DS    0H                                                  0415 01024000
*          CALL OUTCUA;               /* OUTPUT CUA AND CPU LETTERS  */ 01025000
         BAL   @14,OUTCUA                                          0415 01026000
*          CALL CNVRTPRT;             /* OUTPUT THE ERROR LINES      */ 01027000
         BAL   @14,CNVRTPRT                                        0416 01028000
*          IF I ^> SORTNUM THEN                                    0417 01029000
         L     @15,I                                               0417 01030000
         C     @15,SORTNUM(,R2)                                    0417 01031000
         BH    @RF00417                                            0417 01032000
*            PREVCPU = TRENCPUS(I) & 'F0'X;                /*@Z427VLS*/ 01033000
         MH    @15,@CH00476                                        0418 01034000
         L     @01,SORTADR(,R2)                                    0418 01035000
         ALR   @01,@15                                             0418 01036000
         AL    @01,@CF00835                                        0418 01037000
         MVC   PREVCPU(1),TRENCPUS-3(@01)                          0418 01038000
         NI    PREVCPU,X'F0'                                       0418 01039000
*        END;                                              /*@Z427VLS*/ 01040000
@RF00417 DS    0H                                                  0419 01041000
@DE00408 L     @15,I                                               0419 01042000
         C     @15,SORTNUM(,R2)                                    0419 01043000
         BH    @DC00408                                            0419 01044000
         MH    @15,@CH00476                                        0419 01045000
         L     @14,SORTADR(,R2)                                    0419 01046000
         LA    @01,0(@15,@14)                                      0419 01047000
         AL    @01,@CF00833                                        0419 01048000
         SLR   @00,@00                                             0419 01049000
         IC    @00,TRENDGRP(,@01)                                  0419 01050000
         CR    PREVGRP,@00                                         0419 01051000
         BNE   @DC00408                                            0419 01052000
         ST    @15,@TF00001                                        0419 01053000
         ALR   @15,@14                                             0419 01054000
         AL    @15,@CF00827                                        0419 01055000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0419 01056000
         BNE   @DC00408                                            0419 01057000
         AL    @14,@TF00001                                        0419 01058000
         AL    @14,@CF00834                                        0419 01059000
         MVC   @TS00001(2),TRENDRT-1(@14)                          0419 01060000
         NC    @TS00001(2),@CB00752                                0419 01061000
         CLC   PREVCUA(2),@TS00001                                 0419 01062000
         BE    @DL00408                                            0419 01063000
@DC00408 DS    0H                                                  0420 01064000
*        IF I ^> SORTNUM THEN                                      0420 01065000
         L     @15,I                                               0420 01066000
         C     @15,SORTNUM(,R2)                                    0420 01067000
         BH    @RF00420                                            0420 01068000
*          PREVCUA = TRENDRT(I) & 'FFF0'X;                 /*@Z427VLS*/ 01069000
         MH    @15,@CH00476                                        0421 01070000
         L     @01,SORTADR(,R2)                                    0421 01071000
         ALR   @01,@15                                             0421 01072000
         AL    @01,@CF00834                                        0421 01073000
         MVC   PREVCUA(2),TRENDRT-1(@01)                           0421 01074000
         NC    PREVCUA(2),@CB00752                                 0421 01075000
*      END;                                                /*@Z427VLS*/ 01076000
@RF00420 DS    0H                                                  0422 01077000
@DE00406 L     @15,I                                               0422 01078000
         C     @15,SORTNUM(,R2)                                    0422 01079000
         BH    @DC00406                                            0422 01080000
         MH    @15,@CH00476                                        0422 01081000
         L     @14,SORTADR(,R2)                                    0422 01082000
         LA    @01,0(@15,@14)                                      0422 01083000
         AL    @01,@CF00833                                        0422 01084000
         SLR   @00,@00                                             0422 01085000
         IC    @00,TRENDGRP(,@01)                                  0422 01086000
         CR    PREVGRP,@00                                         0422 01087000
         BNE   @DC00406                                            0422 01088000
         ALR   @14,@15                                             0422 01089000
         AL    @14,@CF00827                                        0422 01090000
         CLC   PREVDEV(2),TRENDDEV-6(@14)                          0422 01091000
         BE    @DL00406                                            0422 01092000
@DC00406 DS    0H                                                  0423 01093000
*      IF I ^> SORTNUM THEN                                        0423 01094000
         L     @15,I                                               0423 01095000
         C     @15,SORTNUM(,R2)                                    0423 01096000
         BH    @RF00423                                            0423 01097000
*        PREVDEV = TRENDDEV(I);                            /*@Z427VLS*/ 01098000
         MH    @15,@CH00476                                        0424 01099000
         L     @01,SORTADR(,R2)                                    0424 01100000
         ALR   @01,@15                                             0424 01101000
         AL    @01,@CF00827                                        0424 01102000
         MVC   PREVDEV(2),TRENDDEV-6(@01)                          0424 01103000
*     END;                           /*END TO THE IF  STATEMENT     */  01104000
@RF00423 DS    0H                                                  0426 01105000
*    END;                                                  /*@Z427VLS*/ 01106000
@RF00403 DS    0H                                                  0426 01107000
@DE00400 L     @15,I                                               0426 01108000
         C     @15,SORTNUM(,R2)                                    0426 01109000
         BH    @DC00400                                            0426 01110000
         MH    @15,@CH00476                                        0426 01111000
         L     @01,SORTADR(,R2)                                    0426 01112000
         AL    @01,@CF00833                                        0426 01113000
         SLR   @14,@14                                             0426 01114000
         IC    @14,TRENDGRP(@15,@01)                               0426 01115000
         CR    PREVGRP,@14                                         0426 01116000
         BE    @DL00400                                            0426 01117000
@DC00400 DS    0H                                                  0427 01118000
*    IF I ^> SORTNUM THEN                                          0427 01119000
         L     @15,I                                               0427 01120000
         C     @15,SORTNUM(,R2)                                    0427 01121000
         BH    @RF00427                                            0427 01122000
*      DO;                                                 /*@Z427VLS*/ 01123000
*        CALL PRINT1;                /* SKIP A LINE          @Z427VLS*/ 01124000
         BAL   @14,PRINT1                                          0429 01125000
*        PREVGRP = TRENDGRP(I);                            /*@Z427VLS*/ 01126000
         L     @15,I                                               0430 01127000
         MH    @15,@CH00476                                        0430 01128000
         L     @01,SORTADR(,R2)                                    0430 01129000
         AL    @01,@CF00833                                        0430 01130000
         SLR   PREVGRP,PREVGRP                                     0430 01131000
         IC    PREVGRP,TRENDGRP(@15,@01)                           0430 01132000
*      END;                                                /*@Z427VLS*/ 01133000
*  END;                                                    /*@Z427VLS*/ 01134000
@RF00427 DS    0H                                                  0432 01135000
@DE00398 L     @15,I                                               0432 01136000
         C     @15,SORTNUM(,R2)                                    0432 01137000
         BNH   @DL00398                                            0432 01138000
*END;                                                      /*@Z427VLS*/ 01139000
@EL00008 DS    0H                                                  0433 01140000
@EF00008 DS    0H                                                  0433 01141000
@ER00008 LM    @14,@12,@SA00008                                    0433 01142000
         BR    @14                                                 0433 01143000
*/********************************************************************/ 01144000
*/*                                                          @Z427VLS*/ 01145000
*/* THIS PROC TOTALS THE TEMPORARY AND PERMANENT COUNTS INTO THE     */ 01146000
*/* BUCKET FOR THE APPORPRIATE DAY.                          @Z427VLS*/ 01147000
*/*                                                          @Z427VLS*/ 01148000
*ACCUMERR:  PROC;                                          /*@Z427VLS*/ 01149000
ACCUMERR STM   @14,@12,12(@13)                                     0434 01150000
*  CPUWORK = TRENDITM(I) & '0F'X;  /* BASE CPU - LEFT JUSTIFIED      */ 01151000
         L     @03,I                                               0435 01152000
         LR    @15,@03                                             0435 01153000
         MH    @15,@CH00476                                        0435 01154000
         L     @14,SORTADR(,R2)                                    0435 01155000
         ST    @15,@TF00001                                        0435 01156000
         ALR   @15,@14                                             0435 01157000
         AL    @15,@CF00836                                        0435 01158000
         MVC   CPUWORK(1),TRENDITM-4(@15)                          0435 01159000
         NI    CPUWORK,X'0F'                                       0435 01160000
*  LABELCPU(CPU+1) = 1;                                    /*@Z427VLS*/ 01161000
         LA    @15,1                                               0436 01162000
         SLR   @01,@01                                             0436 01163000
         IC    @01,CPU                                             0436 01164000
         STC   @15,LABELCPU(@01)                                   0436 01165000
*  J = TRENDDAT(I);                    /* SET THE DATE INDEX @Z427VLS*/ 01166000
         L     @01,@TF00001                                        0437 01167000
         AL    @01,@CF00837                                        0437 01168000
         SLR   @00,@00                                             0437 01169000
         IC    @00,TRENDDAT-5(@01,@14)                             0437 01170000
         ST    @00,J                                               0437 01171000
*     PERMCT(J) = PERMCT(J) + TREPRM(I);                   /*@0099VLS*/ 01172000
         SLA   @00,2                                               0438 01173000
         LR    @01,@00                                             0438 01174000
         LA    @09,PERMCT-4(@01)                                   0438 01175000
         ICM   @08,15,0(@09)                                       0438 01176000
         LR    @09,@14                                             0438 01177000
         AL    @09,@TF00001                                        0438 01178000
         AL    @09,@CF00838                                        0438 01179000
         ICM   @09,12,TREPRM-8(@09)                                0438 01180000
         SRA   @09,16                                              0438 01181000
         ALR   @08,@09                                             0438 01182000
         LR    @09,@00                                             0438 01183000
         LA    @01,PERMCT-4(@09)                                   0438 01184000
         STCM  @08,15,0(@01)                                       0438 01185000
*     TEMPCT(J) = TEMPCT(J) + TRETMP(I);                   /*@0099VLS*/ 01186000
         LR    @01,@00                                             0439 01187000
         LA    @09,TEMPCT-4(@01)                                   0439 01188000
         ICM   @08,15,0(@09)                                       0439 01189000
         AL    @14,@TF00001                                        0439 01190000
         AL    @14,@CF00828                                        0439 01191000
         ICM   @09,15,TRETMP-10(@14)                               0439 01192000
         ALR   @08,@09                                             0439 01193000
         LR    @09,@00                                             0439 01194000
         LA    @01,TEMPCT-4(@09)                                   0439 01195000
         STCM  @08,15,0(@01)                                       0439 01196000
*  I = I + 1;                                              /*@Z427VLS*/ 01197000
         ALR   @03,@15                                             0440 01198000
         ST    @03,I                                               0440 01199000
*END;                                                      /*@Z427VLS*/ 01200000
@EL00009 DS    0H                                                  0441 01201000
@EF00009 DS    0H                                                  0441 01202000
@ER00009 LM    @14,@12,12(@13)                                     0441 01203000
         BR    @14                                                 0441 01204000
*/********************************************************************/ 01205000
*/*                                                          @Z427VLS*/ 01206000
*/* THIS PROC PRINT THE GROUP HEADING.                       @Z427VLS*/ 01207000
*/*                                                          @Z427VLS*/ 01208000
*PRTGROUP: PROC;                                           /*@Z427VLS*/ 01209000
PRTGROUP STM   @14,@12,12(@13)                                     0442 01210000
*  GROUPLBL = DEVGROUP(PREVGRP);                           /*@Z427VLS*/ 01211000
         LR    @15,PREVGRP                                         0443 01212000
         SLA   @15,3                                               0443 01213000
         LA    @14,DEVGROUP-8(@15)                                 0443 01214000
         MVC   GROUPLBL(8),0(@14)                                  0443 01215000
*  LINESPRT = LINESPRT + NUMBER1;       /* PRINT A LINE      @Z427VLS*/ 01216000
         LA    @15,1                                               0444 01217000
         AL    @15,LINESPRT                                        0444 01218000
         ST    @15,LINESPRT                                        0444 01219000
*  GRPOUT = ON;                                            /*@Z427VLS*/ 01220000
         OI    GRPOUT,B'10000000'                                  0445 01221000
*END;                                                      /*@Z427VLS*/ 01222000
@EL00010 DS    0H                                                  0446 01223000
@EF00010 DS    0H                                                  0446 01224000
@ER00010 LM    @14,@12,12(@13)                                     0446 01225000
         BR    @14                                                 0446 01226000
*/********************************************************************/ 01227000
*/*                                                          @Z427VLS*/ 01228000
*/* THIS PROC PRINT THE DEVICE TYPE HEADING.                 @Z427VLS*/ 01229000
*/*                                                          @Z427VLS*/ 01230000
*DODEVTYP: PROC;                                           /*@Z427VLS*/ 01231000
DODEVTYP STM   @14,@12,@SA00011                                    0447 01232000
*  IF PREVDEV ^= '0000'X THEN                                      0448 01233000
         CLC   PREVDEV(2),@CB00208                                 0448 01234000
         BE    @RF00448                                            0448 01235000
*  DO;                                                     /*@Z427VLS*/ 01236000
*  NUMBER = TWO;                                           /*@Z427VLS*/ 01237000
         MVC   NUMBER(4),@CF00073                                  0450 01238000
*  NEXTBY = ADDR(PREVDEV);                                 /*@Z427VLS*/ 01239000
         LA    @03,PREVDEV                                         0451 01240000
         ST    @03,NEXTBY                                          0451 01241000
*  ADDNXT = ADDR(CUDEV);                                   /*@Z427VLS*/ 01242000
         LA    @03,CUDEV                                           0452 01243000
         ST    @03,ADDNXT                                          0452 01244000
*  CALL CONVERT;                                           /*@Z427VLS*/ 01245000
         BAL   @14,CONVERT                                         0453 01246000
*  END;                                                    /*@Z427VLS*/ 01247000
*  ELSE                                                            0455 01248000
*  CUDEV = UKNO;         /*DEVICE IS UKNOWN (FROM FILTER)    @Z427VLS*/ 01249000
         B     @RC00448                                            0455 01250000
@RF00448 MVC   CUDEV(4),UKNO                                       0455 01251000
*  LINESPRT = LINESPRT + NUMBER1;        /* PRINT A LINE     @Z427VLS*/ 01252000
@RC00448 LA    @03,1                                               0456 01253000
         AL    @03,LINESPRT                                        0456 01254000
         ST    @03,LINESPRT                                        0456 01255000
*  DEVOUT = ON;                                            /*@Z427VLS*/ 01256000
         OI    DEVOUT,B'01000000'                                  0457 01257000
*END;                                                      /*@Z427VLS*/ 01258000
@EL00011 DS    0H                                                  0458 01259000
@EF00011 DS    0H                                                  0458 01260000
@ER00011 LM    @14,@12,@SA00011                                    0458 01261000
         BR    @14                                                 0458 01262000
*/********************************************************************/ 01263000
*/*                                                          @Z427VLS*/ 01264000
*/* THIS PROC CREATED THE CUA HEADING.                       @Z427VLS*/ 01265000
*/*                                                          @Z427VLS*/ 01266000
*DOCUA: PROC;                                              /*@Z427VLS*/ 01267000
DOCUA    STM   @14,@12,@SA00012                                    0459 01268000
*  CUACONV = PREVCUA;                                      /*@Z427VLS*/ 01269000
         MVC   CUACONV(2),PREVCUA                                  0460 01270000
*  SRL (CUACONV,FOUR);                                     /*@Z427VLS*/ 01271000
         SLR   @03,@03                                             0461 01272000
         ICM   @03,3,CUACONV                                       0461 01273000
         SRL   @03,4                                               0461 01274000
         STCM  @03,3,CUACONV                                       0461 01275000
*  NUMBER = TWO;                                           /*@Z427VLS*/ 01276000
         MVC   NUMBER(4),@CF00073                                  0462 01277000
*  NEXTBY = ADDR(CUACONV);                                 /*@Z427VLS*/ 01278000
         LA    @03,CUACONV                                         0463 01279000
         ST    @03,NEXTBY                                          0463 01280000
*  ADDNXT = ADDR(CUADATA);                                 /*@Z427VLS*/ 01281000
         LA    @03,CUADATA                                         0464 01282000
         ST    @03,ADDNXT                                          0464 01283000
*  SWITCH1 = ON;                                           /*@Z427VLS*/ 01284000
         OI    SWITCH1,B'00001000'                                 0465 01285000
*  CALL CONVERT;                                           /*@Z427VLS*/ 01286000
         BAL   @14,CONVERT                                         0466 01287000
*END;                                                      /*@Z427VLS*/ 01288000
@EL00012 DS    0H                                                  0467 01289000
@EF00012 DS    0H                                                  0467 01290000
@ER00012 LM    @14,@12,@SA00012                                    0467 01291000
         BR    @14                                                 0467 01292000
*/********************************************************************/ 01293000
*/*                                                          @Z427VLS*/ 01294000
*/* THIS PROC OUTPUTS THE CUA HEADING AND THE CPU LETTERS.   @Z427VLS*/ 01295000
*/*                                                          @Z427VLS*/ 01296000
*OUTCUA: PROC;                                             /*@Z427VLS*/ 01297000
OUTCUA   STM   @14,@12,12(@13)                                     0468 01298000
*  K = 1;                                                  /*@Z427VLS*/ 01299000
         LA    @03,1                                               0469 01300000
         ST    @03,K                                               0469 01301000
*  DO J = 1 TO 16;                                         /*@Z427VLS*/ 01302000
         ST    @03,J                                               0470 01303000
@DL00470 DS    0H                                                  0471 01304000
*    IF LABELCPU (J) = 1 THEN                                      0471 01305000
         LA    @15,1                                               0471 01306000
         SLR   @14,@14                                             0471 01307000
         IC    @14,LABELCPU-1(@03)                                 0471 01308000
         CR    @15,@14                                             0471 01309000
         BNE   @RF00471                                            0471 01310000
*      DO;                                                 /*@Z427VLS*/ 01311000
*        CPULBL(K) = EVLETTER(J);         /*  PLACE THE CPU LETTER   */ 01312000
         L     @14,K                                               0473 01313000
         LA    @01,CPULBL-1(@14)                                   0473 01314000
         LR    @09,@03                                             0473 01315000
         MH    @09,@CH00080                                        0473 01316000
         L     @08,EVPTR(,R2)                                      0473 01317000
         ALR   @08,@09                                             0473 01318000
         MVC   0(1,@01),EVLETTER-6(@08)                            0473 01319000
*        K = K + 1;                                        /*@Z427VLS*/ 01320000
         ALR   @14,@15                                             0474 01321000
         ST    @14,K                                               0474 01322000
*        LABELCPU(J) = ZERO;                               /*@Z427VLS*/ 01323000
         SLR   @15,@15                                             0475 01324000
         STC   @15,LABELCPU-1(@03)                                 0475 01325000
*      END;                                                /*@Z427VLS*/ 01326000
*  END;                                                    /*@Z427VLS*/ 01327000
@RF00471 LA    @03,1                                               0477 01328000
         AL    @03,J                                               0477 01329000
         ST    @03,J                                               0477 01330000
         C     @03,@CF00088                                        0477 01331000
         BNH   @DL00470                                            0477 01332000
*  LINESPRT = LINESPRT + NUMBER1;         /* PRINT ONE LINE  @Z427VLS*/ 01333000
         LA    @03,1                                               0478 01334000
         AL    @03,LINESPRT                                        0478 01335000
         ST    @03,LINESPRT                                        0478 01336000
*  CUAOUT = ON;                                            /*@Z427VLS*/ 01337000
         OI    CUAOUT,B'00100000'                                  0479 01338000
*END;                                                      /*@Z427VLS*/ 01339000
@EL00013 DS    0H                                                  0480 01340000
@EF00013 DS    0H                                                  0480 01341000
@ER00013 LM    @14,@12,12(@13)                                     0480 01342000
         BR    @14                                                 0480 01343000
*/********************************************************************/ 01344000
*/*                                                          @Z427VLS*/ 01345000
*/* THIS PROC PROCESSES THE TP CONTROLLER GROUP.             @Z427VLS*/ 01346000
*/*                                                          @Z427VLS*/ 01347000
*TPCNTRL:   PROC;                                          /*@Z427VLS*/ 01348000
TPCNTRL  STM   @14,@12,@SA00014                                    0481 01349000
*  DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I));        /*@Z427VLS*/ 01350000
@DL00482 DS    0H                                                  0483 01351000
*    PREVCPU = TRENCPUS(I) & 'F0'X;       /* CPU             @Z427VLS*/ 01352000
         L     @15,I                                               0483 01353000
         MH    @15,@CH00476                                        0483 01354000
         L     @14,SORTADR(,R2)                                    0483 01355000
         ST    @15,@TF00001                                        0483 01356000
         ALR   @15,@14                                             0483 01357000
         AL    @15,@CF00835                                        0483 01358000
         MVC   PREVCPU(1),TRENCPUS-3(@15)                          0483 01359000
         NI    PREVCPU,X'F0'                                       0483 01360000
*    PREVDEV = TRENDDEV(I);               /* DEVICE          @Z427VLS*/ 01361000
         LR    @15,@14                                             0484 01362000
         AL    @15,@TF00001                                        0484 01363000
         AL    @15,@CF00827                                        0484 01364000
         MVC   PREVDEV(2),TRENDDEV-6(@15)                          0484 01365000
*    PREVCUA = TRENDRT(I) & 'FFF0'X;      /* CUA             @Z427VLS*/ 01366000
         LR    @15,@14                                             0485 01367000
         AL    @15,@TF00001                                        0485 01368000
         AL    @15,@CF00834                                        0485 01369000
         MVC   PREVCUA(2),TRENDRT-1(@15)                           0485 01370000
         NC    PREVCUA(2),@CB00752                                 0485 01371000
*    PREV37  = TRENDITM(I) & 'F0'X;       /* 3705 FLAG       @Z427VLS*/ 01372000
         AL    @14,@TF00001                                        0486 01373000
         AL    @14,@CF00836                                        0486 01374000
         MVC   PREV37(1),TRENDITM-4(@14)                           0486 01375000
         NI    PREV37,X'F0'                                        0486 01376000
*    CALL DODEVTYP;                      /* PRINT THE DEVICE TYPE   */  01377000
         BAL   @14,DODEVTYP                                        0487 01378000
*    DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |              0488 01379000
*              PREVDEV ^= TRENDDEV(I));                    /*@Z427VLS*/ 01380000
@DL00488 DS    0H                                                  0489 01381000
*      CALL DOCUA;              /* CREATE THE CUA            @Z427VLS*/ 01382000
         BAL   @14,DOCUA                                           0489 01383000
*      DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |            0490 01384000
*                PREVDEV ^= TRENDDEV(I) |                          0490 01385000
*                PREVCUA ^= (TRENDRT(I) & 'FFF0'X));       /*@Z427VLS*/ 01386000
@DL00490 DS    0H                                                  0491 01387000
*        CPUWORK = PREVCPU;                                /*@Z427VLS*/ 01388000
         MVC   CPUWORK(1),PREVCPU                                  0491 01389000
*        SRL (CPUWORK,FOUR);                               /*@Z427VLS*/ 01390000
         SLR   @15,@15                                             0492 01391000
         IC    @15,CPUWORK                                         0492 01392000
         SRL   @15,4                                               0492 01393000
         STC   @15,CPUWORK                                         0492 01394000
*        LABELCPU(CPU+1) = 1;        /* SET CPU INDICATOR    @Z427VLS*/ 01395000
         SLR   @01,@01                                             0493 01396000
         IC    @01,CPU                                             0493 01397000
         LA    @00,1                                               0493 01398000
         STC   @00,LABELCPU(@01)                                   0493 01399000
*        DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |          0494 01400000
*                  PREVDEV ^= TRENDDEV(I) |                        0494 01401000
*                  PREVCUA ^= (TRENDRT(I) & 'FFF0'X) |             0494 01402000
*                  PREVCPU ^= (TRENCPUS(I) & 'F0'X));      /*@Z427VLS*/ 01403000
@DL00494 DS    0H                                                  0495 01404000
*          J = TRENDITM(I);                                /*@Z427VLS*/ 01405000
         L     @15,I                                               0495 01406000
         MH    @15,@CH00476                                        0495 01407000
         L     @01,SORTADR(,R2)                                    0495 01408000
         AL    @01,@CF00836                                        0495 01409000
         SLR   @14,@14                                             0495 01410000
         IC    @14,TRENDITM-4(@15,@01)                             0495 01411000
         ST    @14,J                                               0495 01412000
*          SRL (J,FOUR);                                   /*@Z427VLS*/ 01413000
         SRL   @14,4                                               0496 01414000
         ST    @14,J                                               0496 01415000
*          CONTRLBL = TPLABEL(J+1);    /* 3705 LABELS.       @Z427VLS*/ 01416000
         L     @15,J                                               0497 01417000
         SLA   @15,3                                               0497 01418000
         LA    @14,TPLABEL(@15)                                    0497 01419000
         MVC   CONTRLBL(8),0(@14)                                  0497 01420000
*          DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |        0498 01421000
*                    PREVDEV ^= TRENDDEV(I) |                      0498 01422000
*                    PREVCUA ^= (TRENDRT(I) & 'FFF0'X) |           0498 01423000
*                    PREVCPU ^= (TRENCPUS(I) & 'F0'X) |            0498 01424000
*                    PREV37 ^= (TRENDITM(I) & 'F0'X));     /*@Z427VLS*/ 01425000
@DL00498 DS    0H                                                  0499 01426000
*            CALL ACCUMERR;                                /*@Z427VLS*/ 01427000
         BAL   @14,ACCUMERR                                        0499 01428000
*          END;                                            /*@Z427VLS*/ 01429000
@DE00498 L     @15,I                                               0500 01430000
         C     @15,SORTNUM(,R2)                                    0500 01431000
         BH    @DC00498                                            0500 01432000
         MH    @15,@CH00476                                        0500 01433000
         L     @14,SORTADR(,R2)                                    0500 01434000
         LA    @01,0(@15,@14)                                      0500 01435000
         AL    @01,@CF00833                                        0500 01436000
         SLR   @00,@00                                             0500 01437000
         IC    @00,TRENDGRP(,@01)                                  0500 01438000
         CR    PREVGRP,@00                                         0500 01439000
         BNE   @DC00498                                            0500 01440000
         ST    @15,@TF00001                                        0500 01441000
         ALR   @15,@14                                             0500 01442000
         AL    @15,@CF00827                                        0500 01443000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0500 01444000
         BNE   @DC00498                                            0500 01445000
         LR    @15,@14                                             0500 01446000
         AL    @15,@TF00001                                        0500 01447000
         AL    @15,@CF00834                                        0500 01448000
         MVC   @TS00001(2),TRENDRT-1(@15)                          0500 01449000
         NC    @TS00001(2),@CB00752                                0500 01450000
         CLC   PREVCUA(2),@TS00001                                 0500 01451000
         BNE   @DC00498                                            0500 01452000
         LR    @15,@14                                             0500 01453000
         AL    @15,@TF00001                                        0500 01454000
         AL    @15,@CF00835                                        0500 01455000
         MVC   @TS00001(1),TRENCPUS-3(@15)                         0500 01456000
         NI    @TS00001,X'F0'                                      0500 01457000
         CLC   PREVCPU(1),@TS00001                                 0500 01458000
         BNE   @DC00498                                            0500 01459000
         AL    @14,@TF00001                                        0500 01460000
         AL    @14,@CF00836                                        0500 01461000
         MVC   @TS00001(1),TRENDITM-4(@14)                         0500 01462000
         NI    @TS00001,X'F0'                                      0500 01463000
         CLC   PREV37(1),@TS00001                                  0500 01464000
         BE    @DL00498                                            0500 01465000
@DC00498 DS    0H                                                  0501 01466000
*          CALL OUTCUA;           /* OUTPUT THE CUA          @Z427VLS*/ 01467000
         BAL   @14,OUTCUA                                          0501 01468000
*          N3705OUT = ON;                                  /*@Z427VLS*/ 01469000
         OI    N3705OUT,B'00010000'                                0502 01470000
*          LINESPRT = LINESPRT + 7;                        /*@Z427VLS*/ 01471000
         LA    @15,7                                               0503 01472000
         AL    @15,LINESPRT                                        0503 01473000
         ST    @15,LINESPRT                                        0503 01474000
*          CALL CNVRTPRT;         /* OUTPUT THE ERROR LINES  @Z427VLS*/ 01475000
         BAL   @14,CNVRTPRT                                        0504 01476000
*          IF I ^> SORTNUM THEN                                    0505 01477000
         L     @15,I                                               0505 01478000
         C     @15,SORTNUM(,R2)                                    0505 01479000
         BH    @RF00505                                            0505 01480000
*            PREV37 = TRENDITM(I) & 'F0'X;                 /*@Z427VLS*/ 01481000
         MH    @15,@CH00476                                        0506 01482000
         L     @01,SORTADR(,R2)                                    0506 01483000
         ALR   @01,@15                                             0506 01484000
         AL    @01,@CF00836                                        0506 01485000
         MVC   PREV37(1),TRENDITM-4(@01)                           0506 01486000
         NI    PREV37,X'F0'                                        0506 01487000
*        END;                                              /*@Z427VLS*/ 01488000
@RF00505 DS    0H                                                  0507 01489000
@DE00494 L     @15,I                                               0507 01490000
         C     @15,SORTNUM(,R2)                                    0507 01491000
         BH    @DC00494                                            0507 01492000
         MH    @15,@CH00476                                        0507 01493000
         L     @14,SORTADR(,R2)                                    0507 01494000
         LA    @01,0(@15,@14)                                      0507 01495000
         AL    @01,@CF00833                                        0507 01496000
         SLR   @00,@00                                             0507 01497000
         IC    @00,TRENDGRP(,@01)                                  0507 01498000
         CR    PREVGRP,@00                                         0507 01499000
         BNE   @DC00494                                            0507 01500000
         ST    @15,@TF00001                                        0507 01501000
         ALR   @15,@14                                             0507 01502000
         AL    @15,@CF00827                                        0507 01503000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0507 01504000
         BNE   @DC00494                                            0507 01505000
         LR    @15,@14                                             0507 01506000
         AL    @15,@TF00001                                        0507 01507000
         AL    @15,@CF00834                                        0507 01508000
         MVC   @TS00001(2),TRENDRT-1(@15)                          0507 01509000
         NC    @TS00001(2),@CB00752                                0507 01510000
         CLC   PREVCUA(2),@TS00001                                 0507 01511000
         BNE   @DC00494                                            0507 01512000
         AL    @14,@TF00001                                        0507 01513000
         AL    @14,@CF00835                                        0507 01514000
         MVC   @TS00001(1),TRENCPUS-3(@14)                         0507 01515000
         NI    @TS00001,X'F0'                                      0507 01516000
         CLC   PREVCPU(1),@TS00001                                 0507 01517000
         BE    @DL00494                                            0507 01518000
@DC00494 DS    0H                                                  0508 01519000
*        IF I ^> SORTNUM THEN                                      0508 01520000
         L     @15,I                                               0508 01521000
         C     @15,SORTNUM(,R2)                                    0508 01522000
         BH    @RF00508                                            0508 01523000
*          PREVCPU = TRENCPUS(I) & 'F0'X;                  /*@Z427VLS*/ 01524000
         MH    @15,@CH00476                                        0509 01525000
         L     @01,SORTADR(,R2)                                    0509 01526000
         ALR   @01,@15                                             0509 01527000
         AL    @01,@CF00835                                        0509 01528000
         MVC   PREVCPU(1),TRENCPUS-3(@01)                          0509 01529000
         NI    PREVCPU,X'F0'                                       0509 01530000
*      END;                                                /*@Z427VLS*/ 01531000
@RF00508 DS    0H                                                  0510 01532000
@DE00490 L     @15,I                                               0510 01533000
         C     @15,SORTNUM(,R2)                                    0510 01534000
         BH    @DC00490                                            0510 01535000
         MH    @15,@CH00476                                        0510 01536000
         L     @14,SORTADR(,R2)                                    0510 01537000
         LA    @01,0(@15,@14)                                      0510 01538000
         AL    @01,@CF00833                                        0510 01539000
         SLR   @00,@00                                             0510 01540000
         IC    @00,TRENDGRP(,@01)                                  0510 01541000
         CR    PREVGRP,@00                                         0510 01542000
         BNE   @DC00490                                            0510 01543000
         ST    @15,@TF00001                                        0510 01544000
         ALR   @15,@14                                             0510 01545000
         AL    @15,@CF00827                                        0510 01546000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0510 01547000
         BNE   @DC00490                                            0510 01548000
         AL    @14,@TF00001                                        0510 01549000
         AL    @14,@CF00834                                        0510 01550000
         MVC   @TS00001(2),TRENDRT-1(@14)                          0510 01551000
         NC    @TS00001(2),@CB00752                                0510 01552000
         CLC   PREVCUA(2),@TS00001                                 0510 01553000
         BE    @DL00490                                            0510 01554000
@DC00490 DS    0H                                                  0511 01555000
*      IF I ^> SORTNUM THEN                                        0511 01556000
         L     @15,I                                               0511 01557000
         C     @15,SORTNUM(,R2)                                    0511 01558000
         BH    @RF00511                                            0511 01559000
*        PREVCUA = TRENDRT(I) & 'FFF0'X;                   /*@Z427VLS*/ 01560000
         MH    @15,@CH00476                                        0512 01561000
         L     @01,SORTADR(,R2)                                    0512 01562000
         ALR   @01,@15                                             0512 01563000
         AL    @01,@CF00834                                        0512 01564000
         MVC   PREVCUA(2),TRENDRT-1(@01)                           0512 01565000
         NC    PREVCUA(2),@CB00752                                 0512 01566000
*    END;                                                  /*@Z427VLS*/ 01567000
@RF00511 DS    0H                                                  0513 01568000
@DE00488 L     @15,I                                               0513 01569000
         C     @15,SORTNUM(,R2)                                    0513 01570000
         BH    @DC00488                                            0513 01571000
         MH    @15,@CH00476                                        0513 01572000
         L     @14,SORTADR(,R2)                                    0513 01573000
         LA    @01,0(@15,@14)                                      0513 01574000
         AL    @01,@CF00833                                        0513 01575000
         SLR   @00,@00                                             0513 01576000
         IC    @00,TRENDGRP(,@01)                                  0513 01577000
         CR    PREVGRP,@00                                         0513 01578000
         BNE   @DC00488                                            0513 01579000
         ALR   @14,@15                                             0513 01580000
         AL    @14,@CF00827                                        0513 01581000
         CLC   PREVDEV(2),TRENDDEV-6(@14)                          0513 01582000
         BE    @DL00488                                            0513 01583000
@DC00488 DS    0H                                                  0514 01584000
*    IF I ^> SORTNUM THEN                                          0514 01585000
         L     @15,I                                               0514 01586000
         C     @15,SORTNUM(,R2)                                    0514 01587000
         BH    @RF00514                                            0514 01588000
*      PREVDEV = TRENDDEV(I);                              /*@Z427VLS*/ 01589000
         MH    @15,@CH00476                                        0515 01590000
         L     @01,SORTADR(,R2)                                    0515 01591000
         ALR   @01,@15                                             0515 01592000
         AL    @01,@CF00827                                        0515 01593000
         MVC   PREVDEV(2),TRENDDEV-6(@01)                          0515 01594000
*  END;                                                    /*@Z427VLS*/ 01595000
@RF00514 DS    0H                                                  0516 01596000
@DE00482 L     @15,I                                               0516 01597000
         C     @15,SORTNUM(,R2)                                    0516 01598000
         BH    @DC00482                                            0516 01599000
         MH    @15,@CH00476                                        0516 01600000
         L     @01,SORTADR(,R2)                                    0516 01601000
         AL    @01,@CF00833                                        0516 01602000
         SLR   @14,@14                                             0516 01603000
         IC    @14,TRENDGRP(@15,@01)                               0516 01604000
         CR    PREVGRP,@14                                         0516 01605000
         BE    @DL00482                                            0516 01606000
@DC00482 DS    0H                                                  0517 01607000
*END;                                                      /*@Z427VLS*/ 01608000
@EL00014 DS    0H                                                  0517 01609000
@EF00014 DS    0H                                                  0517 01610000
@ER00014 LM    @14,@12,@SA00014                                    0517 01611000
         BR    @14                                                 0517 01612000
*/********************************************************************/ 01613000
*/*                                                          @Z427VLS*/ 01614000
*/* THIS PROC CONVERTS THE SUMMARIZED PERMANENT AND TEMPORARY ERROR  */ 01615000
*/* COUNT DATA TO EBCDIC FOR PRINTING AND THEN PRINTS BOTH LINES.    */ 01616000
*/*                                                          @Z427VLS*/ 01617000
*CNVRTPRT:  PROC;                                          /*@Z427VLS*/ 01618000
CNVRTPRT STM   @14,@12,@SA00015                                    0518 01619000
*  LINESPRT = LINESPRT + 2;   /* TOTAL NUMBER OF LINES TO PRINT      */ 01620000
         LA    @03,2                                               0519 01621000
         L     @15,LINESPRT                                        0519 01622000
         ALR   @15,@03                                             0519 01623000
         ST    @15,LINESPRT                                        0519 01624000
*  IF LINESPRT + MYLINECT => (LINECT - TWO) THEN                   0520 01625000
         AL    @15,MYLINECT                                        0520 01626000
         LCR   @03,@03                                             0520 01627000
         AH    @03,LINECT(,R2)                                     0520 01628000
         CR    @15,@03                                             0520 01629000
         BL    @RF00520                                            0520 01630000
*    DO;                                                   /*@Z427VLS*/ 01631000
*      SPACING = UPSPACE;    /* UPSPACE TO A NEW PAGE        @Z427VLS*/ 01632000
         MVI   SPACING,X'89'                                       0522 01633000
*      CALL HEADING1;                                      /*@Z427VLS*/ 01634000
         BAL   @14,HEADING1                                        0523 01635000
*      CALL HEADING2;                                      /*@Z427VLS*/ 01636000
         BAL   @14,HEADING2                                        0524 01637000
*      MYLINECT = FOUR;                                    /*@Z427VLS*/ 01638000
         MVC   MYLINECT(4),@CF00063                                0525 01639000
*    END;                                                  /*@Z427VLS*/ 01640000
*  LINESPRT = ZERO;                                        /*@Z427VLS*/ 01641000
@RF00520 SLR   @03,@03                                             0527 01642000
         ST    @03,LINESPRT                                        0527 01643000
*  IF GRPOUT = ON THEN                                             0528 01644000
         TM    GRPOUT,B'10000000'                                  0528 01645000
         BNO   @RF00528                                            0528 01646000
*    DO;                                                   /*@Z427VLS*/ 01647000
*      LABELLNE = GROUPLBL;   /* GROUP LABEL                 @Z427VLS*/ 01648000
         MVC   LABELLNE(8),GROUPLBL                                0530 01649000
*      CALL PRINT1;                                        /*@Z427VLS*/ 01650000
         BAL   @14,PRINT1                                          0531 01651000
*      GRPOUT = OFF;                                       /*@Z427VLS*/ 01652000
         NI    GRPOUT,B'01111111'                                  0532 01653000
*    END;                                                  /*@Z427VLS*/ 01654000
*  IF DEVOUT = ON THEN                                             0534 01655000
@RF00528 TM    DEVOUT,B'01000000'                                  0534 01656000
         BNO   @RF00534                                            0534 01657000
*    DO;                                                   /*@Z427VLS*/ 01658000
*      LABELLNE = CUDVDATA;   /* DEVICE LINE                 @Z427VLS*/ 01659000
         MVC   LABELLNE(8),CUDVDATA                                0536 01660000
*      CALL PRINT1;                                        /*@Z427VLS*/ 01661000
         BAL   @14,PRINT1                                          0537 01662000
*      DEVOUT = OFF;                                       /*@Z427VLS*/ 01663000
         NI    DEVOUT,B'10111111'                                  0538 01664000
*    END;                                                  /*@Z427VLS*/ 01665000
*  IF CUAOUT = ON THEN                                             0540 01666000
@RF00534 TM    CUAOUT,B'00100000'                                  0540 01667000
         BNO   @RF00540                                            0540 01668000
*    DO;                                                   /*@Z427VLS*/ 01669000
*      LABELLNE = CUALINE;    /* CUA CPU LINE                @Z427VLS*/ 01670000
         MVC   LABELLNE(8),CUALINE                                 0542 01671000
*      CALL PRINT1;                                        /*@Z427VLS*/ 01672000
         BAL   @14,PRINT1                                          0543 01673000
*      CUAOUT = OFF;                                       /*@Z427VLS*/ 01674000
         NI    CUAOUT,B'11011111'                                  0544 01675000
*    END;                                                  /*@Z427VLS*/ 01676000
*  IF N3705OUT = ON THEN                                           0546 01677000
@RF00540 TM    N3705OUT,B'00010000'                                0546 01678000
         BNO   @RF00546                                            0546 01679000
*    DO;                                                   /*@Z427VLS*/ 01680000
*      LABELLNE = CONTRLBL;   /* 3705 FLAG LINE              @Z427VLS*/ 01681000
         MVC   LABELLNE(8),CONTRLBL                                0548 01682000
*      CALL PRINT1;                                        /*@Z427VLS*/ 01683000
         BAL   @14,PRINT1                                          0549 01684000
*      N3705OUT = OFF;                                     /*@Z427VLS*/ 01685000
         NI    N3705OUT,B'11101111'                                0550 01686000
*    END;                                                  /*@Z427VLS*/ 01687000
*  DO J = 1 TO NUMDAYS;                                    /*@Z427VLS*/ 01688000
@RF00546 LA    @03,1                                               0552 01689000
         B     @DE00552                                            0552 01690000
@DL00552 DS    0H                                                  0553 01691000
*    BINWORD = PERMCT(J);    /* PERMANENT ERROR DATA TO BE CONVERTED.*/ 01692000
         SLA   @03,2                                               0553 01693000
         LA    @01,PERMCT-4(@03)                                   0553 01694000
         ICM   @00,15,0(@01)                                       0553 01695000
         ST    @00,BINWORD                                         0553 01696000
*    DECADDR = ADDR(PERM(J)) + 1; /*  WHERE - POSITION IN PRINT LINE.*/ 01697000
         LA    @03,PERM-4(@03)                                     0554 01698000
         AL    @03,@CF00054                                        0554 01699000
         ST    @03,DECADDR                                         0554 01700000
*    CALL CONVBIN;           /* CONVERT TO EBCDIC.           @Z427VLS*/ 01701000
         BAL   @14,CONVBIN                                         0555 01702000
*    BINWORD = TEMPCT(J);    /* TEMPORARY ERROR DATA TO BE CONVERTED.*/ 01703000
         L     @03,J                                               0556 01704000
         SLA   @03,2                                               0556 01705000
         LA    @01,TEMPCT-4(@03)                                   0556 01706000
         ICM   @00,15,0(@01)                                       0556 01707000
         ST    @00,BINWORD                                         0556 01708000
*    DECADDR = ADDR(TEMP(J)) + 1; /*  WHERE - POSITION IN PRINT LINE.*/ 01709000
         LA    @03,TEMP-4(@03)                                     0557 01710000
         AL    @03,@CF00054                                        0557 01711000
         ST    @03,DECADDR                                         0557 01712000
*    CALL CONVBIN;           /* CONVERT TO EBCDIC.           @Z427VLS*/ 01713000
         BAL   @14,CONVBIN                                         0558 01714000
*  END;                                                    /*@Z427VLS*/ 01715000
         LA    @03,1                                               0559 01716000
         AL    @03,J                                               0559 01717000
@DE00552 ST    @03,J                                               0559 01718000
         C     @03,NUMDAYS(,R2)                                    0559 01719000
         BNH   @DL00552                                            0559 01720000
*  HD2MOVE = PERMELNE;       /* MOVE PRINT LINE TO PRINT AREA.       */ 01721000
         MVC   HD2MOVE(128),PERMELNE                               0560 01722000
*  CALL PRINT1;              /* PRINT PERMANENT ERROR SUMMARY LINE.  */ 01723000
         BAL   @14,PRINT1                                          0561 01724000
*  HD2MOVE = TEMPELNE;       /* MOVE PRINT LINE TO PRINT AREA.       */ 01725000
         MVC   HD2MOVE(128),TEMPELNE                               0562 01726000
*  CALL PRINT1;              /* PRINT TEMPORARY ERROR SUMMARY LINE.  */ 01727000
         BAL   @14,PRINT1                                          0563 01728000
*  DO J = 1 TO 30;                                         /*@Z427VLS*/ 01729000
         LA    @03,1                                               0564 01730000
         ST    @03,J                                               0564 01731000
@DL00564 DS    0H                                                  0565 01732000
*    PERMCT(J) = ZERO;       /* CLEAR PERM COUNT TO ZERO     @Z427VLS*/ 01733000
         SLR   @15,@15                                             0565 01734000
         LR    @14,@03                                             0565 01735000
         SLA   @14,2                                               0565 01736000
         LA    @01,PERMCT-4(@14)                                   0565 01737000
         STCM  @15,15,0(@01)                                       0565 01738000
*    TEMPCT(J) = ZERO;       /* CLEAR TEMP COUNT TO ZERO     @Z427VLS*/ 01739000
         LA    @01,TEMPCT-4(@14)                                   0566 01740000
         STCM  @15,15,0(@01)                                       0566 01741000
*    CPULBL(J) = ' ';        /* CLEAR CPU LABELS TO BLANKS   @Z427VLS*/ 01742000
         LA    @01,CPULBL-1(@03)                                   0567 01743000
         MVI   0(@01),C' '                                         0567 01744000
*  END;                                                    /*@Z427VLS*/ 01745000
         AL    @03,@CF00054                                        0568 01746000
         ST    @03,J                                               0568 01747000
         C     @03,@CF00538                                        0568 01748000
         BNH   @DL00564                                            0568 01749000
*END;                                                      /*@Z427VLS*/ 01750000
@EL00015 DS    0H                                                  0569 01751000
@EF00015 DS    0H                                                  0569 01752000
@ER00015 LM    @14,@12,@SA00015                                    0569 01753000
         BR    @14                                                 0569 01754000
*/********************************************************************/ 01755000
*/*                                                          @Z427VLS*/ 01756000
*/* THIS PROC SETS UP LINKAGE TO ACCESS I/O SERVICE PRINT -  @Z427VLS*/ 01757000
*/*                                                          @Z427VLS*/ 01758000
*PRINT1:    PROC;                                          /*@Z427VLS*/ 01759000
PRINT1   STM   @14,@12,@SA00016                                    0570 01760000
*  CALL PRINT2;                                            /*@Z427VLS*/ 01761000
         BAL   @14,PRINT2                                          0571 01762000
*  MYLINECT = MYLINECT + LNESPACE;          /* BUMP LINE COUNTER     */ 01763000
         L     @03,MYLINECT                                        0572 01764000
         AL    @03,LNESPACE                                        0572 01765000
         ST    @03,MYLINECT                                        0572 01766000
*      IF MYLINECT => (LINECT-TWO) &  /* IF PAGE OVERFLOW AND @0001VLS* 01767000
*         I ^> SORTNUM THEN           /* NOT LAST RCD, PRINT  @0001VLS* 01768000
         LH    @15,LINECT(,R2)                                     0573 01769000
         BCTR  @15,0                                               0573 01770000
         BCTR  @15,0                                               0573 01771000
         CR    @03,@15                                             0573 01772000
         BL    @RF00573                                            0573 01773000
         L     @03,I                                               0573 01774000
         C     @03,SORTNUM(,R2)                                    0573 01775000
         BH    @RF00573                                            0573 01776000
*    DO;                                    /* DAY HEADING - NEXT PG.*/ 01777000
*      SPACING = UPSPACE;                                  /*@Z427VLS*/ 01778000
         MVI   SPACING,X'89'                                       0575 01779000
*      CALL HEADING1;                                      /*@Z427VLS*/ 01780000
         BAL   @14,HEADING1                                        0576 01781000
*      CALL HEADING2;                                      /*@Z427VLS*/ 01782000
         BAL   @14,HEADING2                                        0577 01783000
*      MYLINECT = FOUR;                     /* CLEAR LINE COUNTER    */ 01784000
         MVC   MYLINECT(4),@CF00063                                0578 01785000
*    END;                                                  /*@Z427VLS*/ 01786000
*END;                                                      /*@Z427VLS*/ 01787000
@EL00016 DS    0H                                                  0580 01788000
@EF00016 DS    0H                                                  0580 01789000
@ER00016 LM    @14,@12,@SA00016                                    0580 01790000
         BR    @14                                                 0580 01791000
*/********************************************************************/ 01792000
*/*                                                          @Z427VLS*/ 01793000
*/* WRITE TO THE PRINTER                                     @Z427VLS*/ 01794000
*/*                                                          @Z427VLS*/ 01795000
*PRINT2:    PROC;                                          /*@Z427VLS*/ 01796000
PRINT2   STM   @14,@12,@SA00017                                    0581 01797000
*  PRINTADR = ADDR(PRINTLNE);               /* LINE TO BE PRINTED    */ 01798000
         LA    @03,PRINTLNE                                        0582 01799000
         ST    @03,PRINTADR(,R2)                                   0582 01800000
*  CALL IOHND(RITEPRTR);                    /* PRINT IT      @Z427VLS*/ 01801000
         L     @15,ADIOHND(,R2)                                    0583 01802000
         LA    @01,@AL00583                                        0583 01803000
         BALR  @14,@15                                             0583 01804000
*END;                                                      /*@Z427VLS*/ 01805000
@EL00017 DS    0H                                                  0584 01806000
@EF00017 DS    0H                                                  0584 01807000
@ER00017 LM    @14,@12,@SA00017                                    0584 01808000
         BR    @14                                                 0584 01809000
*/********************************************************************/ 01810000
*/*                                                          @Z427VLS*/ 01811000
*/* THIS PROC CONVERTS THE BINARY NUMBER IN ITEM BINWORD TO DISPLAY. */ 01812000
*/* IF THE CONVERTED NUMBER IS > THAN THE NUMBER OF DIGITS REQUESTED */ 01813000
*/* (IN ITEM BNDECNUM), A NINE IS PLACED IN EACH PRINT POSITION.     */ 01814000
*/* LEADING ZEROS ARE SUPPRESSED.                            @Z427VLS*/ 01815000
*/*                                                          @Z427VLS*/ 01816000
*CONVBIN:   PROC;                                          /*@Z427VLS*/ 01817000
CONVBIN  STM   @14,@12,@SA00018                                    0585 01818000
*  RESPECIFY (R8,R9) RESTRICTED;                           /*@Z427VLS*/ 01819000
*  R8 = BINWORD;             /* DATA TO BE CONVERTED.        @Z427VLS*/ 01820000
         L     R8,BINWORD                                          0587 01821000
*  GEN(CVD R8,DBLWORD);      /* CONVERT TO PACKED DECIMAL.   @Z427VLS*/ 01822000
         CVD R8,DBLWORD                                                 01823000
*  GEN(UNPK WORK(8),DBLWORD);   /* UNPACK CONVERTED NO.      @Z427VLS*/ 01824000
         UNPK WORK(8),DBLWORD                                           01825000
*  GEN(OI WORK+7,X'F0');     /* INSERT 'PLUS' SIGN.          @Z427VLS*/ 01826000
         OI WORK+7,X'F0'                                                01827000
*  SWITCH2 = OFF;            /* TURN OFF SWITCH.             @Z427VLS*/ 01828000
         NI    SWITCH2,B'11111011'                                 0591 01829000
*  DO L = 1 TO 7 WHILE (SWITCH2 = OFF);  /* SCAN NUMBER -    @Z427VLS*/ 01830000
         LA    @03,1                                               0592 01831000
         ST    @03,L                                               0592 01832000
@DL00592 TM    SWITCH2,B'00000100'                                 0592 01833000
         BNZ   @DC00592                                            0592 01834000
*    IF WORKOVER(L) = 'F0'X THEN                                   0593 01835000
         LA    @01,WORKOVER-1(@03)                                 0593 01836000
         CLI   0(@01),X'F0'                                        0593 01837000
         BNE   @RF00593                                            0593 01838000
*      WORKOVER(L) = '40'X;  /* SET LEADING 0'S TO BLANKS.   @Z427VLS*/ 01839000
         LA    @01,WORKOVER-1(@03)                                 0594 01840000
         MVI   0(@01),X'40'                                        0594 01841000
*    ELSE                                                          0595 01842000
*      SWITCH2 = ON;         /* TURN ON SWITCH TO TERMINATE LOOP     */ 01843000
         B     @RC00593                                            0595 01844000
@RF00593 OI    SWITCH2,B'00000100'                                 0595 01845000
*  END;                      /* WHEN 1ST NON-ZERO DIGIT FOUND.       */ 01846000
@RC00593 LA    @03,1                                               0596 01847000
         AL    @03,L                                               0596 01848000
         ST    @03,L                                               0596 01849000
         C     @03,@CF00082                                        0596 01850000
         BNH   @DL00592                                            0596 01851000
@DC00592 DS    0H                                                  0597 01852000
*  IF (10 - L) > BNDECNUM THEN                                     0597 01853000
         LA    @03,10                                              0597 01854000
         SL    @03,L                                               0597 01855000
         C     @03,BNDECNUM                                        0597 01856000
         BNH   @RF00597                                            0597 01857000
*    DO;                                                   /*@Z427VLS*/ 01858000
*      GEN(MVI WORKOVER,X'F9');          /* NUMBER TOO LARGE -       */ 01859000
         MVI WORKOVER,X'F9'                                             01860000
*      GEN(MVC WORKOVER+1(7),WORKOVER);  /* REPLACE WITH 9'S.        */ 01861000
         MVC WORKOVER+1(7),WORKOVER                                     01862000
*    END;                                                  /*@Z427VLS*/ 01863000
*  R8 = ADDR(WORKOVER) + (8-BNDECNUM);   /* ADDRESS - BEGIN. OF DATA.*/ 01864000
@RF00597 LA    R8,WORKOVER                                         0602 01865000
         L     @03,BNDECNUM                                        0602 01866000
         LA    @15,8                                               0602 01867000
         SLR   @15,@03                                             0602 01868000
         ALR   R8,@15                                              0602 01869000
*  R9 = BNDECNUM - ONE;                  /* NO. OF BYTES TO MOVE.    */ 01870000
         BCTR  @03,0                                               0603 01871000
         LR    R9,@03                                              0603 01872000
*  RESPECIFY (R6) RESTRICTED;                              /*@Z427VLS*/ 01873000
*  R6 = DECADDR;                         /* ADDRESS - DATA DESTINAT. */ 01874000
         L     R6,DECADDR                                          0605 01875000
*  GEN(EX R9,MVCINS);                    /* MOVE DATA.       @Z427VLS*/ 01876000
         EX R9,MVCINS                                                   01877000
*  GENERATE DATA;                                          /*@Z427VLS*/ 01878000
*  RESPECIFY (R6) UNRESTRICTED;                            /*@Z427VLS*/ 01879000
*END;                                                      /*@Z427VLS*/ 01880000
@EL00018 DS    0H                                                  0609 01881000
@EF00018 DS    0H                                                  0609 01882000
@ER00018 LM    @14,@12,@SA00018                                    0609 01883000
         BR    @14                                                 0609 01884000
*/********************************************************************/ 01885000
*/*                                                          @Z427VLS*/ 01886000
*/* THIS PROC CONVERTS HEX DATA TO DISPLAY.                  @Z427VLS*/ 01887000
*/* TO SUPPRESS CONVERSION OF LEFT-MOST HALF OF HIGH ORDER BYTE,     */ 01888000
*/* USER SHOULD SET SWITCH1 ON.                              @Z427VLS*/ 01889000
*/*                                                          @Z427VLS*/ 01890000
*CONVERT:   PROC;                                          /*@Z427VLS*/ 01891000
CONVERT  STM   @14,@12,12(@13)                                     0610 01892000
*  RESPECIFY (R8,R9) RESTRICTED;                           /*@Z427VLS*/ 01893000
*  DO P = NUMBER BY -1 TO 1; /* NUMBER OF BYTES TO CONVERT.  @Z427VLS*/ 01894000
         L     @03,NUMBER                                          0612 01895000
         ST    @03,P                                               0612 01896000
         B     @DE00612                                            0612 01897000
@DL00612 DS    0H                                                  0613 01898000
*    R8 = NEXTBYTE(P);       /* NEXT BYTE TO CONVERT.        @Z427VLS*/ 01899000
         L     @01,NEXTBY                                          0613 01900000
         BCTR  @01,0                                               0613 01901000
         SLR   R8,R8                                               0613 01902000
         IC    R8,NEXTBYTE(@03,@01)                                0613 01903000
*    X =  TWO * P;           /* OUTPUT INDEX MUST BE TWICE INPUT.    */ 01904000
         LR    @15,@03                                             0614 01905000
         ALR   @15,@15                                             0614 01906000
         ST    @15,X                                               0614 01907000
*    SRDL  (R8,FOUR);        /* MOVE 1/2 BYTE INTO NEXT REGISTER.    */ 01908000
         SRDL  R8,4                                                0615 01909000
*    SRL   (R9,TWOEIGHT);    /* SHIFT TO LOW END.            @Z427VLS*/ 01910000
         SRL   R9,28                                               0616 01911000
*    R9 = R9 + NUMBER1;                                    /*@Z427VLS*/ 01912000
         LA    @15,1                                               0617 01913000
         ALR   R9,@15                                              0617 01914000
*    R8 = R8 + NUMBER1;                                    /*@Z427VLS*/ 01915000
         ALR   R8,@15                                              0618 01916000
*    IF SWITCH1 = ON & P = ONE THEN    /* IF HIGH ORDER BYTE AND NO  */ 01917000
         TM    SWITCH1,B'00001000'                                 0619 01918000
         BNO   @RF00619                                            0619 01919000
         CR    @03,@15                                             0619 01920000
         BNE   @RF00619                                            0619 01921000
*      SWITCH1 = OFF;                  /* LEFT-HALF CONVERSION, TURN */ 01922000
         NI    SWITCH1,B'11110111'                                 0620 01923000
*                                      /* OFF SWITCH.        @Z427VLS*/ 01924000
*    ELSE                                                          0621 01925000
*      ADDNUM(X-ONE) = CHARS(R8);      /* PUT PRINT CHAR. INTO OUTPUT*/ 01926000
         B     @RC00619                                            0621 01927000
@RF00619 L     @03,ADDNXT                                          0621 01928000
         AL    @03,X                                               0621 01929000
         BCTR  @03,0                                               0621 01930000
         BCTR  @03,0                                               0621 01931000
         LA    @01,CHARS-1(R8)                                     0621 01932000
         MVC   ADDNUM(1,@03),0(@01)                                0621 01933000
*      ADDNUM(X) = CHARS(R9);          /* FINISH BYTE.       @Z427VLS*/ 01934000
@RC00619 L     @03,ADDNXT                                          0622 01935000
         AL    @03,X                                               0622 01936000
         BCTR  @03,0                                               0622 01937000
         LA    @01,CHARS-1(R9)                                     0622 01938000
         MVC   ADDNUM(1,@03),0(@01)                                0622 01939000
*  END;                                                    /*@Z427VLS*/ 01940000
         SLR   @03,@03                                             0623 01941000
         BCTR  @03,0                                               0623 01942000
         AL    @03,P                                               0623 01943000
         ST    @03,P                                               0623 01944000
@DE00612 LTR   @03,@03                                             0623 01945000
         BP    @DL00612                                            0623 01946000
*END;                                                      /*@Z427VLS*/ 01947000
@EL00019 DS    0H                                                  0624 01948000
@EF00019 DS    0H                                                  0624 01949000
@ER00019 LM    @14,@12,12(@13)                                     0624 01950000
         BR    @14                                                 0624 01951000
*END  /* CLOSING END TO IFCTREND                             @Z427VLS*/ 01952000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01953000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 01954000
*;                                                                 0625 01955000
@DATA    DS    0H                                                       01956000
@CH00080 DC    H'6'                                                     01957000
@CH00540 DC    H'13'                                                    01958000
@CH00476 DC    H'14'                                                    01959000
@CH00700 DC    H'76'                                                    01960000
         DS    0F                                                       01961000
@AL00583 DC    A(@CF00073+2)           LIST WITH   1 ARGUMENT(S)        01962000
         DS    0F                                                       01963000
@SA00001 DS    18F                                                      01964000
@SA00017 DS    15F                                                      01965000
@SA00004 DS    15F                                                      01966000
@SA00002 DS    15F                                                      01967000
@SA00003 DS    15F                                                      01968000
@SA00005 DS    15F                                                      01969000
@SA00006 DS    15F                                                      01970000
@SA00008 DS    15F                                                      01971000
@SA00018 DS    15F                                                      01972000
@SA00016 DS    15F                                                      01973000
@SA00014 DS    15F                                                      01974000
@SA00011 DS    15F                                                      01975000
@SA00012 DS    15F                                                      01976000
@SA00015 DS    15F                                                      01977000
@TF00001 DS    F                                                        01978000
         DS    0F                                                       01979000
@CF00054 DC    F'1'                                                     01980000
@CF00073 DC    F'2'                                                     01981000
@CF00075 DC    F'3'                                                     01982000
@CF00063 DC    F'4'                                                     01983000
@CF00078 DC    F'5'                                                     01984000
@CF00082 DC    F'7'                                                     01985000
@CF00065 DC    F'8'                                                     01986000
@CF00088 DC    F'16'                                                    01987000
@CF00617 DC    F'19'                                                    01988000
@CH00617 EQU   @CF00617+2                                               01989000
@CF00672 DC    F'27'                                                    01990000
@CF00538 DC    F'30'                                                    01991000
@CH00538 EQU   @CF00538+2                                               01992000
@CF00693 DC    F'365'                                                   01993000
@CF00695 DC    F'366'                                                   01994000
@CF00832 DC    F'-72'                                                   01995000
@CF00814 DC    F'-60'                                                   01996000
@CF00815 DC    F'-56'                                                   01997000
@CF00816 DC    F'-52'                                                   01998000
@CF00817 DC    F'-48'                                                   01999000
@CF00818 DC    F'-44'                                                   02000000
@CF00819 DC    F'-40'                                                   02001000
@CF00820 DC    F'-36'                                                   02002000
@CF00821 DC    F'-32'                                                   02003000
@CF00822 DC    F'-28'                                                   02004000
@CF00823 DC    F'-24'                                                   02005000
@CF00824 DC    F'-20'                                                   02006000
@CF00825 DC    F'-16'                                                   02007000
@CF00833 DC    F'-14'                                                   02008000
@CF00834 DC    F'-13'                                                   02009000
@CF00826 DC    F'-12'                                                   02010000
@CF00835 DC    F'-11'                                                   02011000
@CF00836 DC    F'-10'                                                   02012000
@CF00837 DC    F'-9'                                                    02013000
@CF00827 DC    F'-8'                                                    02014000
@CF00838 DC    F'-6'                                                    02015000
@CF00828 DC    F'-4'                                                    02016000
         DS    0D                                                       02017000
NEXTBY   DC    F'0'                                                     02018000
ADDNXT   DC    F'0'                                                     02019000
LINESPRT DC    F'0'                                                     02020000
NUMBER   DC    F'0'                                                     02021000
L        DC    F'0'                                                     02022000
MYLINECT DC    F'0'                                                     02023000
P        DC    F'0'                                                     02024000
X        DC    F'0'                                                     02025000
LNESPACE DC    F'0'                                                     02026000
I        DC    F'0'                                                     02027000
BINWORD  DC    F'0'                                                     02028000
BNDECNUM DC    F'3'                                                     02029000
DECADDR  DC    F'0'                                                     02030000
SAVEPTR  DC    F'0'                                                     02031000
J        DC    F'0'                                                     02032000
K        DC    F'1'                                                     02033000
NUMCPUS  DC    F'0'                                                     02034000
BINYR    DC    F'0'                                                     02035000
M        DC    F'0'                                                     02036000
BYTECT   DC    F'0'                                                     02037000
Z1       DC    F'0'                                                     02038000
Q        DC    F'0'                                                     02039000
Z2       DC    F'0'                                                     02040000
RETCODE  DC    H'0'                                                     02041000
         DS    0D                                                       02042000
@TS00001 DS    CL8                                                      02043000
@CB00741 DC    X'404040F0'                                              02044000
@CB00208 DC    X'0000'                                                  02045000
@CB00752 DC    X'FFF0'                                                  02046000
PRINTLNE DS    CL134                                                    02047000
         ORG   PRINTLNE                                                 02048000
DDTYPE   DC    CL1'0'                                                   02049000
SPACING  DC    X'89'                                                    02050000
PRTLINE  DC    CL132' '                                                 02051000
         ORG   PRINTLNE+134                                             02052000
HEAD1    DC    CL171' '                                                 02053000
         ORG   HEAD1                                                    02054000
LINE1    DS    CL57                                                     02055000
         ORG   LINE1                                                    02056000
@NM00012 DC    CL25'T R E N D S   R E P O R T'                          02057000
@NM00013 DC    CL14' '                                                  02058000
@NM00014 DC    CL12'REPORT DATE '                                       02059000
DAYSDATE DC    CL6'XXX XX'                                              02060000
         ORG   HEAD1+57                                                 02061000
LINE2    DS    CL57                                                     02062000
         ORG   LINE2                                                    02063000
@NM00015 DC    CL17'         (PART 1)'                                  02064000
@NM00016 DC    CL22' '                                                  02065000
@NM00017 DC    CL12'PERIOD FROM '                                       02066000
FROMDATE DS    CL3                                                      02067000
@NM00018 DC    CL1' '                                                   02068000
FROMYEAR DS    CL2                                                      02069000
         ORG   HEAD1+114                                                02070000
LINE3    DS    CL57                                                     02071000
         ORG   LINE3                                                    02072000
@NM00019 DC    CL24' CPU/CHANNEL/STORAGE/SCP'                           02073000
@NM00020 DC    CL22' '                                                  02074000
@NM00021 DC    CL5'TO   '                                               02075000
TODATE   DS    CL3                                                      02076000
@NM00022 DC    CL1' '                                                   02077000
TOYEAR   DS    CL2                                                      02078000
         ORG   HEAD1+171                                                02079000
CPULINE  DC    CL24'CPU   MODEL   SERIAL NO.'                           02080000
CPUDATA  DC    CL20' '                                                  02081000
         ORG   CPUDATA                                                  02082000
@NM00023 DC    CL1' '                                                   02083000
CPUTYPE  DS    CL1                                                      02084000
@NM00024 DC    CL5' '                                                   02085000
CPUMODEL DS    CL3                                                      02086000
@NM00025 DC    CL4' '                                                   02087000
CPUSERAL DS    CL6                                                      02088000
         ORG   CPUDATA+20                                               02089000
HEAD2    DC    CL256' '                                                 02090000
         ORG   HEAD2                                                    02091000
LN1      DS    CL128                                                    02092000
         ORG   LN1                                                      02093000
@NM00026 DC    CL10' JULIAN   '                                         02094000
JYEAR    DS    CL2                                                      02095000
@NM00027 DC    CL116' '                                                 02096000
         ORG   HEAD2+128                                                02097000
LN2      DS    CL128                                                    02098000
         ORG   LN2                                                      02099000
@NM00028 DC    CL8'   DAY  '                                            02100000
DAYNO    DC    CL4' '                                                   02101000
         DS    29XL4                                                    02102000
         ORG   HEAD2+256                                                02103000
HEAD3    DC    CL256' '                                                 02104000
         ORG   HEAD3                                                    02105000
LIN1     DS    CL128                                                    02106000
         ORG   LIN1                                                     02107000
DSCRPT   DS    CL17                                                     02108000
@NM00029 DC    CL111' '                                                 02109000
         ORG   HEAD3+128                                                02110000
LIN2     DS    CL128                                                    02111000
         ORG   LIN2                                                     02112000
@NM00030 DC    CL6'  CPU '                                              02113000
@NM00031 DC    CL1' '                                                   02114000
LETTER   DC    CL1'X'                                                   02115000
ERCNT    DC    CL4' '                                                   02116000
         DS    29XL4                                                    02117000
         ORG   HEAD3+256                                                02118000
SWITCHE  DC    AL1(0)                                                   02119000
         ORG   SWITCHE                                                  02120000
GRPOUT   DS    BL1                                                      02121000
DEVOUT   EQU   SWITCHE+0                                                02122000
CUAOUT   EQU   SWITCHE+0                                                02123000
N3705OUT EQU   SWITCHE+0                                                02124000
SWITCH1  EQU   SWITCHE+0                                                02125000
SWITCH2  EQU   SWITCHE+0                                                02126000
         ORG   SWITCHE+1                                                02127000
CHARS    DC    CL16'0123456789ABCDEF'                                   02128000
SAVEDAY  DC    CL2' '                                                   02129000
SAVEYR   DC    CL2' '                                                   02130000
         DS    CL6                                                      02131000
WORK     DS    CL8                                                      02132000
HEAD1P2  DC    CL102' '                                                 02133000
         ORG   HEAD1P2                                                  02134000
LINE2P2  DS    CL51                                                     02135000
         ORG   LINE2P2                                                  02136000
@NM00032 DC    CL17'         (PART 2)'                                  02137000
@NM00033 DS    CL22                                                     02138000
@NM00034 DC    CL12'PERIOD FROM '                                       02139000
         ORG   HEAD1P2+51                                               02140000
LINE3P2  DS    CL51                                                     02141000
         ORG   LINE3P2                                                  02142000
@NM00035 DC    CL24'     I/O SUBSYSTEM      '                           02143000
@NM00036 DS    CL22                                                     02144000
@NM00037 DC    CL5'TO   '                                               02145000
         ORG   HEAD1P2+102                                              02146000
GROUPLBL DC    CL8' '                                                   02147000
CUDVDATA DC    CL8' '                                                   02148000
         ORG   CUDVDATA                                                 02149000
CUDEV    DC    CL4' '                                                   02150000
@NM00038 DS    CL4                                                      02151000
         ORG   CUDVDATA+8                                               02152000
CUALINE  DC    CL128' '                                                 02153000
         ORG   CUALINE                                                  02154000
CUADATA  DS    CL3                                                      02155000
@NM00039 DS    CL2                                                      02156000
CPULBL   DC    CL1' '                                                   02157000
         DS    29XL1                                                    02158000
         ORG   CUALINE+128                                              02159000
         DS    CL2                                                      02160000
ERSUMLNE DC    CL256' '                                                 02161000
         ORG   ERSUMLNE                                                 02162000
PERMELNE DS    CL128                                                    02163000
         ORG   PERMELNE                                                 02164000
@NM00040 DC    CL8'  PERM  '                                            02165000
PERM     DC    CL4' '                                                   02166000
         DS    29XL4                                                    02167000
         ORG   ERSUMLNE+128                                             02168000
TEMPELNE DS    CL128                                                    02169000
         ORG   TEMPELNE                                                 02170000
@NM00041 DC    CL8'  TEMP  '                                            02171000
TEMP     DC    CL4' '                                                   02172000
         DS    29XL4                                                    02173000
         ORG   ERSUMLNE+256                                             02174000
UKNO     DC    CL4'UKNO'                                                02175000
CONTRLBL DC    CL8' '                                                   02176000
PREVCUA  DS    BL2                                                      02177000
PREV37   DS    CL1                                                      02178000
PREVCPU  DS    BL1                                                      02179000
PREVDEV  DS    CL2                                                      02180000
SAVECUA  DS    BL2                                                      02181000
CPUWORK  DS    BL1                                                      02182000
NEWSW    DC    X'00'                                                    02183000
         ORG   NEWSW                                                    02184000
FOUND    DS    BL1                                                      02185000
OUTSWTCH EQU   NEWSW+0                                                  02186000
         ORG   NEWSW+1                                                  02187000
NOFOUND  DC    CL29'NO ERRORS FOUND FOR THIS CPU'                       02188000
CHAN     DC    CL4'CHAN'                                                02189000
ZCPU     DC    CL3'CPU'                                                 02190000
         DS    CL6                                                      02191000
DBLWORD  DS    CL8                                                      02192000
OLDWORK  DS    BL1                                                      02193000
SUPERZAP DC    3CL10'SUPERZAP'                                          02194000
DEVGROUP DC    CL8'CONS+UR '                                            02195000
         DC    CL8'DASD    '                                            02196000
         DC    CL8'TAPE    '                                            02197000
         DC    CL8'DISPLAY '                                            02198000
         DC    CL8'TP CNTRL'                                            02199000
         DC    CL8'TERMINAL'                                            02200000
DESCRIPT DC    CL13'IPL          '                                      02201000
         DC    CL13'MACHINE CHECK'                                      02202000
         DC    CL13'CHANNEL CHECK'                                      02203000
         DC    CL13'PROGRAM ERROR'                                      02204000
         DS    CL1                                                      02205000
PATCH    DC    30F'0'                                                   02206000
TPLABEL  DC    CL8'  CNTRLR'                                            02207000
         DC    CL8'  NCP   '                                            02208000
         DC    CL8'  LINES '                                            02209000
LABELCPU DC    16AL1(0)                                                 02210000
TREND6   DC    480F'0'                                                  02211000
CHANZ    DC    CL6' CHN-0'                                              02212000
         DC    CL6' CHN-1'                                              02213000
         DC    CL6' CHN-2'                                              02214000
         DC    CL6' CHN-3'                                              02215000
         DC    CL6' CHN-4'                                              02216000
         DC    CL6' CHN-5'                                              02217000
         DC    CL6' CHN-6'                                              02218000
         DC    CL6' CHN-7'                                              02219000
         DC    CL6' CHN-8'                                              02220000
         DC    CL6' CHN-9'                                              02221000
         DC    CL6' CHN-A'                                              02222000
         DC    CL6' CHN-B'                                              02223000
         DC    CL6' CHN-C'                                              02224000
         DC    CL6' CHN-D'                                              02225000
         DC    CL6' CHN-E'                                              02226000
         DC    CL6' CHN-F'                                              02227000
IFCTREND CSECT                                                          02228000
         DC    S(SUPERZAP)                                              02229000
IFCTREND CSECT                                                          02230000
    DC  S(PATCH)                                                        02231000
IFCTREND CSECT                                                          02232000
MVCINS  MVC  R0(R0,R6),0(R8)                                            02233000
IFCTREND CSECT                                                          02234000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02235000
@01      EQU   01                                                       02236000
@02      EQU   02                                                       02237000
@03      EQU   03                                                       02238000
@04      EQU   04                                                       02239000
@05      EQU   05                                                       02240000
@06      EQU   06                                                       02241000
@07      EQU   07                                                       02242000
@08      EQU   08                                                       02243000
@09      EQU   09                                                       02244000
@10      EQU   10                                                       02245000
@11      EQU   11                                                       02246000
@12      EQU   12                                                       02247000
@13      EQU   13                                                       02248000
@14      EQU   14                                                       02249000
@15      EQU   15                                                       02250000
PREVGRP  EQU   @03                                                      02251000
R2       EQU   @02                                                      02252000
R6       EQU   @06                                                      02253000
R8       EQU   @08                                                      02254000
R9       EQU   @09                                                      02255000
R12      EQU   @12                                                      02256000
R15      EQU   @15                                                      02257000
R0       EQU   @00                                                      02258000
R1       EQU   @01                                                      02259000
R10      EQU   @10                                                      02260000
R11      EQU   @11                                                      02261000
R13      EQU   @13                                                      02262000
R14      EQU   @14                                                      02263000
R3       EQU   @03                                                      02264000
R4       EQU   @04                                                      02265000
R5       EQU   @05                                                      02266000
R7       EQU   @07                                                      02267000
IOHND    EQU   0                                                        02268000
PARM     EQU   0                                                        02269000
RECTYPE  EQU   PARM                                                     02270000
SWITCHES EQU   PARM+2                                                   02271000
DEBUG    EQU   PARM+4                                                   02272000
DEBUG4   EQU   DEBUG                                                    02273000
DEBUG12  EQU   DEBUG+1                                                  02274000
DEBUG21  EQU   DEBUG+2                                                  02275000
DEBUGA   EQU   PARM+8                                                   02276000
DEBUG51  EQU   DEBUGA+2                                                 02277000
MISC     EQU   PARM+12                                                  02278000
PRINTES  EQU   MISC                                                     02279000
OPENCLSE EQU   PARM+13                                                  02280000
OPENIO   EQU   OPENCLSE                                                 02281000
CLOSEIO  EQU   OPENCLSE+2                                               02282000
DATENOW  EQU   PARM+17                                                  02283000
STDT     EQU   PARM+23                                                  02284000
STDATE   EQU   STDT                                                     02285000
PSTD     EQU   STDATE+1                                                 02286000
PSTYR    EQU   PSTD                                                     02287000
PSTDY    EQU   PSTD+1                                                   02288000
ENDDT    EQU   PARM+31                                                  02289000
ENDDATE  EQU   ENDDT                                                    02290000
PEND     EQU   ENDDATE+1                                                02291000
PENYR    EQU   PEND                                                     02292000
STTIME1  EQU   PARM+39                                                  02293000
ENDTIME1 EQU   PARM+43                                                  02294000
STTIME2  EQU   PARM+47                                                  02295000
ENDTIME2 EQU   PARM+51                                                  02296000
STRTDATE EQU   PARM+55                                                  02297000
EVSYEAR  EQU   STRTDATE                                                 02298000
EVSDAY   EQU   STRTDATE+1                                               02299000
@NM00007 EQU   PARM+75                                                  02300000
SORTNUM  EQU   PARM+84                                                  02301000
NUMDAYS  EQU   PARM+88                                                  02302000
ERRID    EQU   PARM+92                                                  02303000
IDTIMEA  EQU   ERRID+6                                                  02304000
IDTIME   EQU   IDTIMEA                                                  02305000
CCHHRLNG EQU   PARM+112                                                 02306000
LINECT   EQU   PARM+120                                                 02307000
ADIOHND  EQU   PARM+124                                                 02308000
ADIFCMSG EQU   PARM+128                                                 02309000
ADEDITB  EQU   PARM+132                                                 02310000
EVPTR    EQU   PARM+136                                                 02311000
SORTADR  EQU   PARM+140                                                 02312000
PRINTADR EQU   PARM+148                                                 02313000
CUAPTR   EQU   PARM+152                                                 02314000
DEVPTR   EQU   PARM+156                                                 02315000
MODPTR   EQU   PARM+160                                                 02316000
SERPTR   EQU   PARM+164                                                 02317000
VOLPTR   EQU   PARM+168                                                 02318000
CPUPTR   EQU   PARM+172                                                 02319000
CPCUAPTR EQU   PARM+176                                                 02320000
LIBADPTR EQU   PARM+180                                                 02321000
SYMCDPTR EQU   PARM+184                                                 02322000
SYSUMPTR EQU   PARM+188                                                 02323000
TRENPTR  EQU   PARM+192                                                 02324000
SHAREPTR EQU   PARM+196                                                 02325000
MERDCPTR EQU   PARM+208                                                 02326000
DUMPTABL EQU   PARM+228                                                 02327000
DUMPINFO EQU   DUMPTABL+4                                               02328000
TRENDONE EQU   0                                                        02329000
TRENEXT  EQU   TRENDONE                                                 02330000
TREGEN   EQU   TRENDONE+8                                               02331000
TRECCH0  EQU   TREGEN+8                                                 02332000
TRECCH1  EQU   TREGEN+12                                                02333000
TRECCH2  EQU   TREGEN+16                                                02334000
TRECCH3  EQU   TREGEN+20                                                02335000
TRECCH4  EQU   TREGEN+24                                                02336000
TRECCH5  EQU   TREGEN+28                                                02337000
TRECCH6  EQU   TREGEN+32                                                02338000
TRECCH7  EQU   TREGEN+36                                                02339000
TRECCH8  EQU   TREGEN+40                                                02340000
TRECCH9  EQU   TREGEN+44                                                02341000
TRECCHA  EQU   TREGEN+48                                                02342000
TRECCHB  EQU   TREGEN+52                                                02343000
TRECCHC  EQU   TREGEN+56                                                02344000
TRECCHD  EQU   TREGEN+60                                                02345000
TRECCHE  EQU   TREGEN+64                                                02346000
TRECCHF  EQU   TREGEN+68                                                02347000
TREND2   EQU   0                                                        02348000
TRENDKEY EQU   TREND2                                                   02349000
TRENDGRP EQU   TRENDKEY                                                 02350000
TRENDRT  EQU   TRENDKEY+1                                               02351000
TRENCPUS EQU   TRENDKEY+3                                               02352000
TRENDITM EQU   TRENDKEY+4                                               02353000
TRENDDAT EQU   TRENDKEY+5                                               02354000
TRENDDEV EQU   TREND2+6                                                 02355000
TREPRM   EQU   TREND2+8                                                 02356000
TRETMP   EQU   TREND2+10                                                02357000
EVTABLE  EQU   0                                                        02358000
EVSTOP   EQU   EVTABLE                                                  02359000
EVYEAR   EQU   EVSTOP                                                   02360000
EVDAY    EQU   EVSTOP+1                                                 02361000
EVNUM    EQU   EVTABLE+4                                                02362000
EVKEY    EQU   EVTABLE+6                                                02363000
EVMODEL  EQU   EVKEY                                                    02364000
EVSERIAL EQU   EVKEY+2                                                  02365000
EVLETTER EQU   EVKEY+5                                                  02366000
SORTABLE EQU   0                                                        02367000
SORTKEY  EQU   SORTABLE                                                 02368000
SORTCCHR EQU   SORTABLE+5                                               02369000
SYSUMONE EQU   0                                                        02370000
SYSUM2   EQU   0                                                        02371000
SYSUMKEY EQU   SYSUM2                                                   02372000
SYSRT    EQU   SYSUMKEY+1                                               02373000
SYSCPUS  EQU   SYSUMKEY+3                                               02374000
SYSITEM  EQU   SYSUMKEY+4                                               02375000
SHARE    EQU   0                                                        02376000
SHAREIO  EQU   SHARE+2                                                  02377000
SHRCUCPU EQU   SHAREIO                                                  02378000
SHARECUA EQU   SHRCUCPU                                                 02379000
EDITLOAD EQU   0                                                        02380000
EDITABLE EQU   EDITLOAD+4                                               02381000
CUA      EQU   0                                                        02382000
CUAVAL   EQU   CUA+2                                                    02383000
DEVICE   EQU   0                                                        02384000
MODELS   EQU   0                                                        02385000
DEVSERAL EQU   0                                                        02386000
VOLUME   EQU   0                                                        02387000
CPUS     EQU   0                                                        02388000
CPUCUAS  EQU   0                                                        02389000
CPUCUAV  EQU   CPUCUAS+2                                                02390000
LIBADR   EQU   0                                                        02391000
SYMCODE  EQU   0                                                        02392000
SYMVAL   EQU   SYMCODE+2                                                02393000
MERIDIAN EQU   0                                                        02394000
NEXTBYTE EQU   0                                                        02395000
ADDNUM   EQU   0                                                        02396000
IFCMSG   EQU   0                                                        02397000
HEADMOVE EQU   PRTLINE                                                  02398000
CPULINE1 EQU   PRTLINE                                                  02399000
HD2MOVE  EQU   PRTLINE                                                  02400000
HD3MOVE  EQU   PRTLINE                                                  02401000
WORKOVER EQU   WORK                                                     02402000
TREITM   EQU   TREGEN                                                   02403000
LABELLNE EQU   PRTLINE                                                  02404000
PERMCT   EQU   PERM                                                     02405000
TEMPCT   EQU   TEMP                                                     02406000
CUACONV  EQU   SAVECUA                                                  02407000
CPU      EQU   CPUWORK                                                  02408000
CHANID   EQU   LIN2+2                                                   02409000
TRECCH   EQU   TRECCH0                                                  02410000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02411000
MODEL    EQU   MERIDIAN+2                                               02412000
MRDNUMBR EQU   MERIDIAN                                                 02413000
SYMVAL2  EQU   SYMVAL+2                                                 02414000
SYMVAL1  EQU   SYMVAL                                                   02415000
SYMCDNUM EQU   SYMCODE                                                  02416000
LIBVAL   EQU   LIBADR+2                                                 02417000
LIBADNUM EQU   LIBADR                                                   02418000
CPUCUX3  EQU   CPUCUAV+5                                                02419000
CPUCUX2  EQU   CPUCUAV+3                                                02420000
CPUCUX1  EQU   CPUCUAV                                                  02421000
CPCUANUM EQU   CPUCUAS                                                  02422000
CPUVAL   EQU   CPUS+2                                                   02423000
CPUNUM   EQU   CPUS                                                     02424000
VOLVAL   EQU   VOLUME+2                                                 02425000
VOLNUM   EQU   VOLUME                                                   02426000
SERVAL   EQU   DEVSERAL+2                                               02427000
SERNUM   EQU   DEVSERAL                                                 02428000
MODVAL   EQU   MODELS+2                                                 02429000
MODNUM   EQU   MODELS                                                   02430000
MDRVAL   EQU   DEVICE+204                                               02431000
MDRNUM   EQU   DEVICE+202                                               02432000
DEVVAL   EQU   DEVICE+2                                                 02433000
DEVNUM   EQU   DEVICE                                                   02434000
CUA2     EQU   CUAVAL+2                                                 02435000
CUA1     EQU   CUAVAL                                                   02436000
CUANUM   EQU   CUA                                                      02437000
LOADPTR  EQU   EDITABLE+8                                               02438000
LOADNAME EQU   EDITABLE                                                 02439000
EDITNUM  EQU   EDITLOAD                                                 02440000
SHARLET  EQU   SHAREIO+10                                               02441000
SHARSERB EQU   SHAREIO+7                                                02442000
SHARECUB EQU   SHAREIO+5                                                02443000
SHARSERA EQU   SHRCUCPU+2                                               02444000
SHAREDX  EQU   SHARECUA                                                 02445000
SHARENUM EQU   SHARE                                                    02446000
SYSTEMP  EQU   SYSUM2+9                                                 02447000
SYSPERM  EQU   SYSUM2+7                                                 02448000
SYSDEV   EQU   SYSUM2+5                                                 02449000
SYSOLDA  EQU   SYSITEM                                                  02450000
SYS3705  EQU   SYSITEM                                                  02451000
SYSOLD   EQU   SYSCPUS                                                  02452000
SYSCPU   EQU   SYSCPUS                                                  02453000
SYSCUA   EQU   SYSRT                                                    02454000
SYSGROUP EQU   SYSUMKEY                                                 02455000
SYSUMEOD EQU   SYSUMONE+96                                              02456000
SYSUMPER EQU   SYSUMONE+92                                              02457000
SYSUMPEA EQU   SYSUMONE+88                                              02458000
SYSUMPEI EQU   SYSUMONE+84                                              02459000
SYSUMCH  EQU   SYSUMONE+20                                              02460000
SYSUMMCN EQU   SYSUMONE+16                                              02461000
SYSUMMCR EQU   SYSUMONE+12                                              02462000
SYSUMNXT EQU   SYSUMONE+8                                               02463000
SYSUMIPL EQU   SYSUMONE+4                                               02464000
SYSUMNUM EQU   SYSUMONE                                                 02465000
SORTCORE EQU   SORTCCHR                                                 02466000
SORTTIME EQU   SORTKEY+1                                                02467000
SORTYEAR EQU   SORTKEY                                                  02468000
TRENDOD  EQU   TRENDITM                                                 02469000
TREND037 EQU   TRENDITM                                                 02470000
TRENDOLD EQU   TRENCPUS                                                 02471000
TRENDCPU EQU   TRENCPUS                                                 02472000
@NM00011 EQU   TRENDRT+1                                                02473000
TRENDCUA EQU   TRENDRT                                                  02474000
TREPRE   EQU   TREGEN+72                                                02475000
TREMCH   EQU   TREGEN+4                                                 02476000
TREIPL   EQU   TREGEN                                                   02477000
TRENUM   EQU   TRENDONE+4                                               02478000
DUMPSIZE EQU   DUMPINFO+4                                               02479000
DUMPADR  EQU   DUMPINFO                                                 02480000
DUMPNUM  EQU   DUMPTABL                                                 02481000
@NM00010 EQU   PARM+212                                                 02482000
RECLNGT1 EQU   PARM+204                                                 02483000
FRAMEPTR EQU   PARM+200                                                 02484000
ADCPUT   EQU   PARM+144                                                 02485000
RECLNGTH EQU   CCHHRLNG+6                                               02486000
@NM00009 EQU   CCHHRLNG+5                                               02487000
RECCCHHR EQU   CCHHRLNG                                                 02488000
USERPGM  EQU   PARM+102                                                 02489000
IDTSEC   EQU   IDTIME+3                                                 02490000
IDSEC    EQU   IDTIME+2                                                 02491000
IDMIN    EQU   IDTIME+1                                                 02492000
IDHOUR   EQU   IDTIME                                                   02493000
IDASID   EQU   ERRID+4                                                  02494000
IDCPU    EQU   ERRID+3                                                  02495000
@NM00008 EQU   ERRID+2                                                  02496000
IDVALUE  EQU   ERRID                                                    02497000
TABSIZE  EQU   PARM+80                                                  02498000
SYSRETRN EQU   @NM00007                                                 02499000
@NM00006 EQU   PARM+72                                                  02500000
WRTHRSH  EQU   PARM+69                                                  02501000
RDTHRSH  EQU   PARM+66                                                  02502000
TERM     EQU   PARM+58                                                  02503000
PENSEC2  EQU   ENDTIME2+2                                               02504000
PENMIN2  EQU   ENDTIME2+1                                               02505000
PENHOUR2 EQU   ENDTIME2                                                 02506000
PSTSEC2  EQU   STTIME2+2                                                02507000
PSTMIN2  EQU   STTIME2+1                                                02508000
PSTHOUR2 EQU   STTIME2                                                  02509000
PENSEC1  EQU   ENDTIME1+2                                               02510000
PENMIN1  EQU   ENDTIME1+1                                               02511000
PENHOUR1 EQU   ENDTIME1                                                 02512000
PSTSEC1  EQU   STTIME1+2                                                02513000
PSTMIN1  EQU   STTIME1+1                                                02514000
PSTHOUR1 EQU   STTIME1                                                  02515000
@NM00005 EQU   ENDDT+4                                                  02516000
PENDY    EQU   PEND+1                                                   02517000
@NM00004 EQU   ENDDATE                                                  02518000
@NM00003 EQU   STDT+4                                                   02519000
@NM00002 EQU   STDATE                                                   02520000
YEARNOW  EQU   DATENOW+4                                                02521000
@NM00001 EQU   DATENOW+3                                                02522000
DAYNOW   EQU   DATENOW                                                  02523000
CSNAP    EQU   CLOSEIO                                                  02524000
CDRCTWRK EQU   CLOSEIO                                                  02525000
CSYSIN   EQU   CLOSEIO                                                  02526000
CACCDEV  EQU   CLOSEIO                                                  02527000
CACCIN   EQU   CLOSEIO                                                  02528000
CSERLOG  EQU   CLOSEIO                                                  02529000
CEREPPT  EQU   CLOSEIO                                                  02530000
CTOURIST EQU   CLOSEIO                                                  02531000
OSNAP    EQU   OPENIO                                                   02532000
ODRCTWRK EQU   OPENIO                                                   02533000
OSYSIN   EQU   OPENIO                                                   02534000
OACCDEV  EQU   OPENIO                                                   02535000
OACCIN   EQU   OPENIO                                                   02536000
OSERLOG  EQU   OPENIO                                                   02537000
OEREPPT  EQU   OPENIO                                                   02538000
OTOURIST EQU   OPENIO                                                   02539000
PASSFLAG EQU   MISC                                                     02540000
PLOGREC  EQU   MISC                                                     02541000
ERRORID  EQU   MISC                                                     02542000
PSUM     EQU   PRINTES                                                  02543000
PEDIT    EQU   PRINTES                                                  02544000
PHIST    EQU   MISC                                                     02545000
PACC     EQU   MISC                                                     02546000
PZERO    EQU   MISC                                                     02547000
DEBUG63  EQU   DEBUGA+3                                                 02548000
DEBUG62  EQU   DEBUGA+3                                                 02549000
DEBUG61  EQU   DEBUGA+3                                                 02550000
DEBUG60  EQU   DEBUGA+3                                                 02551000
DEBUG59  EQU   DEBUGA+3                                                 02552000
DEBUG58  EQU   DEBUGA+3                                                 02553000
DEBUG57  EQU   DEBUGA+3                                                 02554000
DEBUG56  EQU   DEBUGA+3                                                 02555000
DEBUG55  EQU   DEBUGA+2                                                 02556000
DEBUG54  EQU   DEBUGA+2                                                 02557000
DEBUG53  EQU   DEBUGA+2                                                 02558000
DEBUG52  EQU   DEBUGA+2                                                 02559000
DEBUG50  EQU   DEBUGA+2                                                 02560000
DEBUG49  EQU   DEBUGA+2                                                 02561000
DEBUG48  EQU   DEBUGA+2                                                 02562000
DEBUG47  EQU   DEBUGA+1                                                 02563000
DEBUG46  EQU   DEBUGA+1                                                 02564000
DEBUG45  EQU   DEBUGA+1                                                 02565000
DEBUG44  EQU   DEBUGA+1                                                 02566000
DEBUG43  EQU   DEBUGA+1                                                 02567000
DEBUG42  EQU   DEBUGA+1                                                 02568000
DEBUG41  EQU   DEBUGA+1                                                 02569000
DEBUG40  EQU   DEBUGA+1                                                 02570000
DEBUG39  EQU   DEBUGA                                                   02571000
DEBUG38  EQU   DEBUGA                                                   02572000
DEBUG37  EQU   DEBUGA                                                   02573000
DEBUG36  EQU   DEBUGA                                                   02574000
DEBUG35  EQU   DEBUGA                                                   02575000
DEBUG34  EQU   DEBUGA                                                   02576000
DEBUG33  EQU   DEBUGA                                                   02577000
DEBUG32  EQU   DEBUGA                                                   02578000
DEBUG31  EQU   DEBUG+3                                                  02579000
DEBUG30  EQU   DEBUG+3                                                  02580000
DEBUG29  EQU   DEBUG+3                                                  02581000
DEBUG28  EQU   DEBUG+3                                                  02582000
DEBUG27  EQU   DEBUG+3                                                  02583000
DEBUG26  EQU   DEBUG+3                                                  02584000
DEBUG25  EQU   DEBUG+3                                                  02585000
DEBUG24  EQU   DEBUG+3                                                  02586000
DEBUG23  EQU   DEBUG+2                                                  02587000
DEBUG22  EQU   DEBUG+2                                                  02588000
DEBUG20  EQU   DEBUG+2                                                  02589000
DEBUG19  EQU   DEBUG+2                                                  02590000
DEBUG18  EQU   DEBUG+2                                                  02591000
DEBUG17  EQU   DEBUG+2                                                  02592000
DEBUG16  EQU   DEBUG+2                                                  02593000
DEBUG15  EQU   DEBUG+1                                                  02594000
DEBUG14  EQU   DEBUG+1                                                  02595000
DEBUG13  EQU   DEBUG+1                                                  02596000
DEBUG11  EQU   DEBUG+1                                                  02597000
DEBUG10  EQU   DEBUG+1                                                  02598000
DEBUG9   EQU   DEBUG+1                                                  02599000
DEBUG8   EQU   DEBUG+1                                                  02600000
DEBUG7   EQU   DEBUG                                                    02601000
DEBUG6   EQU   DEBUG                                                    02602000
DEBUG5   EQU   DEBUG                                                    02603000
DEBUG3   EQU   DEBUG                                                    02604000
DEBUG2   EQU   DEBUG                                                    02605000
DEBUG1   EQU   DEBUG                                                    02606000
DEBUG0   EQU   DEBUG                                                    02607000
SORTBRK  EQU   SWITCHES+1                                               02608000
COREFAIL EQU   SWITCHES+1                                               02609000
ANALYSIS EQU   SWITCHES+1                                               02610000
SHIFT3RD EQU   SWITCHES+1                                               02611000
DEVEXCL  EQU   SWITCHES+1                                               02612000
ZEROALL  EQU   SWITCHES+1                                               02613000
NOTALL   EQU   SWITCHES+1                                               02614000
NOSDR    EQU   SWITCHES                                                 02615000
TIMESEQ  EQU   SWITCHES                                                 02616000
SYSUM    EQU   SWITCHES                                                 02617000
PARMTHR  EQU   SWITCHES                                                 02618000
TREND    EQU   SWITCHES                                                 02619000
SHORTOBR EQU   SWITCHES                                                 02620000
PARMMES  EQU   SWITCHES                                                 02621000
RDESUM   EQU   SWITCHES                                                 02622000
PCCHFRAM EQU   RECTYPE+1                                                02623000
PMCHFRAM EQU   RECTYPE+1                                                02624000
PTTYP    EQU   RECTYPE+1                                                02625000
PEOD     EQU   RECTYPE                                                  02626000
PMIH     EQU   RECTYPE                                                  02627000
PDDR     EQU   RECTYPE                                                  02628000
PIPL     EQU   RECTYPE                                                  02629000
PSOFT    EQU   RECTYPE                                                  02630000
POBR     EQU   RECTYPE                                                  02631000
PCHAN    EQU   RECTYPE                                                  02632000
PMCH     EQU   RECTYPE                                                  02633000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02634000
@RF00203 EQU   @RC00197                                                 02635000
@RF00573 EQU   @EL00016                                                 02636000
@ENDDATA EQU   *                                                        02637000
         END   IFCTREND,(C'PLS0627',0701,77315)                         02638000
