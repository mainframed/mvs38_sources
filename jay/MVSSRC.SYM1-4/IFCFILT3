         TITLE 'IFCFILT3-RECORD FILTER FOR TREND REPORT                *00001000
                        '                                               00002000
IFCFILT3 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IFCFILT3  78.228'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         STM   @00,@12,20(@13)                                     0001 00011000
         BALR  @12,0                                               0001 00012000
@PSTART  LA    @11,4095(,@12)                                      0001 00013000
         LA    @10,4095(,@11)                                      0001 00014000
         LA    @09,4095(,@10)                                      0001 00015000
         USING @PSTART,@12                                         0001 00016000
         USING @PSTART+4095,@11                                    0001 00017000
         USING @PSTART+8190,@10                                    0001 00018000
         USING @PSTART+12285,@09                                   0001 00019000
         ST    @13,@SA00001+4                                      0001 00020000
         LA    @14,@SA00001                                        0001 00021000
         ST    @14,8(,@13)                                         0001 00022000
         LR    @13,@14                                             0001 00023000
*IF DEBUG4 = ON THEN                                               0188 00024000
         TM    DEBUG4(R2),B'00001000'                              0188 00025000
         BNO   @RF00188                                            0188 00026000
* DO;                                                      /*@Z427VLS*/ 00027000
*  R15 = R12 - 27;                                         /*@Z427VLS*/ 00028000
         LR    R15,R12                                             0190 00029000
         SL    R15,@CF01116                                        0190 00030000
*  GEN(MVC PRINTBDY(16),0(R15));                           /*@Z427VLS*/ 00031000
         MVC PRINTBDY(16),0(R15)                                        00032000
*  PRINTADR = ADDR(PRINTLIN);                              /*@Z427VLS*/ 00033000
         LA    @14,PRINTLIN                                        0192 00034000
         ST    @14,PRINTADR(,R2)                                   0192 00035000
*  CALL IOHND(RITEPRTR);                                   /*@Z427VLS*/ 00036000
         L     @15,ADIOHND(,R2)                                    0193 00037000
         LA    @01,@AL00193                                        0193 00038000
         BALR  @14,@15                                             0193 00039000
*  R15 = ZERO;                                             /*@Z427VLS*/ 00040000
         SLR   R15,R15                                             0194 00041000
* END;                                                     /*@Z427VLS*/ 00042000
*/*PROCESS ERROR RECORDS SEQUENTIALLY                        @Z427VLS*/ 00043000
*CALL INITIATE; /*ALLOCATE INITIAL TABLES                    @Z427VLS*/ 00044000
@RF00188 BAL   @14,INITIATE                                        0196 00045000
*R15 = ERROR; /*GET ERROR CONDITIONS FROM INITIATE           @Z427VLS*/ 00046000
         L     R15,ERROR                                           0197 00047000
*DO WHILE R15 = SUCCESS & ENTRIES < MAXENT;                /*@0099VLS*/ 00048000
         B     @DE00198                                            0198 00049000
@DL00198 DS    0H                                                  0199 00050000
*  CALL IOHND(READSEQ); /*GET A RECORD FROM ACCDEV OR SERLOG @Z427VLS*/ 00051000
         L     @15,ADIOHND(,R2)                                    0199 00052000
         LA    @01,@AL00199                                        0199 00053000
         BALR  @14,@15                                             0199 00054000
*  IF R15 = SUCCESS THEN /*CONTINUE IF NOT EOF OR UNREADABLE @Z427VLS*/ 00055000
         LTR   R15,R15                                             0200 00056000
         BNZ   @RF00200                                            0200 00057000
*    DO;                                                   /*@Z427VLS*/ 00058000
*      BUG(1) = BUG(1) + 1; /*NUMBER OF RECORDS RETRIEVED    @Z427VLS*/ 00059000
         LA    @14,1                                               0202 00060000
         AL    @14,BUG                                             0202 00061000
         ST    @14,BUG                                             0202 00062000
*IF ((LRTKEY1 & GENREC) = HEXA0)|   /* IF MCH OR CCH FRAME RECORD */    00063000
*   ((LRTKEY1 & GENREC) = HEXB0) THEN                              0203 00064000
         MVC   @TS00001(1),LRTKEY1(R7)                             0203 00065000
         NI    @TS00001,X'F0'                                      0203 00066000
         CLI   @TS00001,X'A0'                                      0203 00067000
         BE    @RT00203                                            0203 00068000
         MVC   @TS00001(1),LRTKEY1(R7)                             0203 00069000
         NI    @TS00001,X'F0'                                      0203 00070000
         CLI   @TS00001,X'B0'                                      0203 00071000
         BNE   @RF00203                                            0203 00072000
@RT00203 DS    0H                                                  0204 00073000
* DO;                                                      /*@G51DGBB*/ 00074000
*  CALL FLIMFRAM; /*PROCESS FRAME RECORDS SEQUENTIALLY       @G51DGBB*/ 00075000
         BAL   @14,FLIMFRAM                                        0205 00076000
*  R15 = ERROR; /*PASS ERROR CONDITIONS FROM FRAME PROCESSING*/    0206 00077000
         L     R15,ERROR                                           0206 00078000
* END;                                                     /*@G51DGBB*/ 00079000
*ELSE  /*NORMAL ERROR RECORD PROCESSING                      @G51DGBB*/ 00080000
*  DO;                                                     /*@G51DGBB*/ 00081000
         B     @RC00203                                            0208 00082000
@RF00203 DS    0H                                                  0209 00083000
*      CALL ALLREC; /*PERFORM TIME, DATE FILTERING           @Z427VLS*/ 00084000
         BAL   @14,ALLREC                                          0209 00085000
*      IF PASSFLAG = YES THEN                                      0210 00086000
         TM    PASSFLAG(R2),B'00000001'                            0210 00087000
         BNO   @RF00210                                            0210 00088000
*        DO;                                               /*@Z427VLS*/ 00089000
*          BUG(2) = BUG(2) + 1; /*NUM REC PASS DATE,TIME FILTERING*/    00090000
         LA    @14,1                                               0212 00091000
         AL    @14,BUG+4                                           0212 00092000
         ST    @14,BUG+4                                           0212 00093000
*          CALL RECDEP; /*FILTER BY DEVICE, STORE IN TABLE IF PASS*/    00094000
         BAL   @14,RECDEP                                          0213 00095000
*          IF PASSFLAG = ON THEN                                   0214 00096000
         TM    PASSFLAG(R2),B'00000001'                            0214 00097000
         BNO   @RF00214                                            0214 00098000
*            DO;                                           /*@Z427VLS*/ 00099000
*              BUG(3) = BUG(3) + ONE; /*NUMBER OF RECORDS PASS FILT*/   00100000
         LA    @14,1                                               0216 00101000
         AL    @14,BUG+8                                           0216 00102000
         ST    @14,BUG+8                                           0216 00103000
*             IF LRTYRDAY > EVSTOP THEN /*LATEST DAY IN DATA @Z427VLS*/ 00104000
         L     @14,EVPTR(,R2)                                      0217 00105000
         CLC   LRTYRDAY(3,R7),EVSTOP(@14)                          0217 00106000
         BNH   @RF00217                                            0217 00107000
*               EVSTOP = LRTYRDAY; /*SAVE FOR LATER COMPARES @Z427VLS*/ 00108000
         MVC   EVSTOP(3,@14),LRTYRDAY(R7)                          0218 00109000
*             IF LRTYRDAY < STRTDATE THEN /*IF EARLIEST DAY IN DATA*/   00110000
@RF00217 CLC   LRTYRDAY(3,R7),STRTDATE(R2)                         0219 00111000
         BNL   @RF00219                                            0219 00112000
*               STRTDATE = LRTYRDAY; /*SAVE FOR LATER COMPARES*/   0220 00113000
         MVC   STRTDATE(3,R2),LRTYRDAY(R7)                         0220 00114000
*              IF PACC = YES THEN /*HISTORY D.S. TO BE CREATED*/   0221 00115000
@RF00219 TM    PACC(R2),B'01000000'                                0221 00116000
         BNO   @RF00221                                            0221 00117000
*                CALL IOHND(RITEHIST); /*WRITE TO ACCDEV     @Z427VLS*/ 00118000
         L     @15,ADIOHND(,R2)                                    0222 00119000
         LA    @01,@AL00222                                        0222 00120000
         BALR  @14,@15                                             0222 00121000
*              IF R15 = SUCCESS & TRENDGRP  ^= ZERO & /*IF SUCCESS */   00122000
*                       CPU0FLG = OFF THEN /*NO ERRORS FOUND, CPU OK */ 00123000
@RF00221 LTR   R15,R15                                             0223 00124000
         BNZ   @RF00223                                            0223 00125000
         CLI   TRENDGRP,0                                          0223 00126000
         BE    @RF00223                                            0223 00127000
         TM    CPU0FLG,B'00001000'                                 0223 00128000
         BNZ   @RF00223                                            0223 00129000
*               DO;                                        /*@Z427VLS*/ 00130000
*                CALL ADDVALUE;   /*BUILD THE SORT TABLE ENTRY*/   0225 00131000
         BAL   @14,ADDVALUE                                        0225 00132000
*                TREND2  = (TREND2  && TREND2 ); /*CLEAR TREND2*/  0226 00133000
         XC    TREND2(14),TREND2                                   0226 00134000
*               END;                                       /*@Z427VLS*/ 00135000
*              ELSE                                                0228 00136000
*               IF R15 ^= SUCCESS THEN                             0228 00137000
         B     @RC00223                                            0228 00138000
@RF00223 LTR   R15,R15                                             0228 00139000
         BZ    @RF00228                                            0228 00140000
*                 ZEROALL = NO; /*DONT CLEAR LOGREC IF DONT PROCESS*/   00141000
         NI    ZEROALL(R2),B'10111111'                             0229 00142000
*                               /*ALL RECORDS                @Z427VLS*/ 00143000
*            END;                                          /*@Z427VLS*/ 00144000
@RF00228 DS    0H                                                  0230 00145000
@RC00223 DS    0H                                                  0231 00146000
*         END;                                             /*@Z427VLS*/ 00147000
@RF00214 DS    0H                                                  0232 00148000
*   END;                                                   /*@G51DGBB*/ 00149000
@RF00210 DS    0H                                                  0233 00150000
*      END;                                                /*@Z427VLS*/ 00151000
@RC00203 DS    0H                                                  0234 00152000
*    END;                                                  /*@Z427VLS*/ 00153000
@RF00200 DS    0H                                                  0234 00154000
@DE00198 LTR   R15,R15                                             0234 00155000
         BNZ   @DC00198                                            0234 00156000
         L     @14,ENTRIES                                         0234 00157000
         C     @14,MAXENT                                          0234 00158000
         BL    @DL00198                                            0234 00159000
@DC00198 DS    0H                                                  0235 00160000
* ERROR = R15; /*TELL ENDOFILE IF ERRORS                     @Z427VLS*/ 00161000
         ST    R15,ERROR                                           0235 00162000
*PASSNUM = ENTRIES - 1;                                    /*@0099VLS*/ 00163000
         L     @14,ENTRIES                                         0236 00164000
         BCTR  @14,0                                               0236 00165000
         ST    @14,PASSNUM                                         0236 00166000
* CALL ENDOFILE; /*SORT EVTABLE,TRENDONE, AND TREND2. HANDLE ERROR*/    00167000
         BAL   @14,ENDOFILE                                        0237 00168000
*                /*CONDITIONS, FREE EXCESS TREND2 CORE.      @Z427VLS*/ 00169000
* R15 = ERROR; /*RETURN CODE MAY HAVE BEEN MODIFIED BY ENDOFILE*/  0238 00170000
         L     R15,ERROR                                           0238 00171000
* IF DEBUG16 = ON THEN                                             0239 00172000
         TM    DEBUG16(R2),B'10000000'                             0239 00173000
         BNO   @RF00239                                            0239 00174000
*   CALL BUGCNTS; /*PRINT COUNT OF DIFFERENT RECORD TYPES    @Z427VLS*/ 00175000
         BAL   @14,BUGCNTS                                         0240 00176000
* IF DEBUG11 = ON THEN                                             0241 00177000
@RF00239 TM    DEBUG11(R2),B'00010000'                             0241 00178000
         BNO   @RF00241                                            0241 00179000
*   GEN(ABEND 320,DUMP); /*SHOW STATUS IF TESTING SITUATION  @Z427VLS*/ 00180000
         ABEND 320,DUMP                                                 00181000
*RESPECIFY(R15) UNRESTRICTED;                              /*@Z427VLS*/ 00182000
*/*******************************************************************/  00183000
*/*    THIS PROC WILL SEARCH THE SORT TABLE FOR A ENTRY WITH THE SAME*/ 00184000
*/*    KEY AS THIS ONE THEN SUM THE PERM AND TEMP ERRORS WITH THIS REC* 00185000
*/*    IF NO MATCH CAN BE FOUND THEN CREATE A NEW ONE        @0099VLS*/ 00186000
*/*                                                          @0099VLS*/ 00187000
*ADDVALUE: PROC;                                           /*@0099VLS*/ 00188000
@EL00001 L     @13,4(,@13)                                         0244 00189000
@EF00001 DS    0H                                                  0244 00190000
@ER00001 L     @14,12(,@13)                                        0244 00191000
         LM    @00,@12,20(@13)                                     0244 00192000
         BR    @14                                                 0244 00193000
ADDVALUE STM   @14,@12,@SA00002                                    0244 00194000
* DCL ZZ PTR(31)  INIT(0);                                 /*@0099VLS*/ 00195000
* DCL Z1 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00196000
* DCL Z2 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00197000
* DCL Z3 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00198000
*DCL ZZ3 FIXED(31) INIT(0);                                /*@G51DGBB*/ 00199000
* DCL  1  TMTA  BASED(ZZ),                                         0250 00200000
*       2 TMTKEYA  CHAR(8),                                        0250 00201000
*       2 TMTPERMA FIXED(15) BDY(BYTE),                            0250 00202000
*       2 TMTTEMPA FIXED(31) BDY(BYTE);                    /*@0099VLS*/ 00203000
* ZZ3 = ZZ3 + 1;  /*NUMBER OF ENTRIES IN PART 2              @0099VLS*/ 00204000
         LA    @08,1                                               0251 00205000
         AL    @08,ZZ3                                             0251 00206000
         ST    @08,ZZ3                                             0251 00207000
* FOUND = NO;        /*SET FLAG TO ASSUME THE WORST          @0099VLS*/ 00208000
         NI    FOUND,B'01111111'                                   0252 00209000
* DO ZZ = SORTADR + (ENTRIES - 1) * 14 BY -14 TO SORTADR WHILE(    0253 00210000
*                                   FOUND = NO);           /*@0099VLS*/ 00211000
         L     @08,ENTRIES                                         0253 00212000
         BCTR  @08,0                                               0253 00213000
         MH    @08,@CH00940                                        0253 00214000
         AL    @08,SORTADR(,R2)                                    0253 00215000
         ST    @08,ZZ                                              0253 00216000
         B     @DE00253                                            0253 00217000
@DL00253 TM    FOUND,B'10000000'                                   0253 00218000
         BNZ   @DC00253                                            0253 00219000
*  IF TMTKEYA = TRENDKEY THEN                                      0254 00220000
         CLC   TMTKEYA(8,@08),TRENDKEY                             0254 00221000
         BNE   @RF00254                                            0254 00222000
*   DO;                                                    /*@0099VLS*/ 00223000
*    TMTPERMA = TMTPERMA + TRENDPR1;                       /*@0099VLS*/ 00224000
         ICM   @06,12,TMTPERMA(@08)                                0256 00225000
         SRA   @06,16                                              0256 00226000
         ICM   @03,12,TRENDPR1                                     0256 00227000
         SRA   @03,16                                              0256 00228000
         ALR   @06,@03                                             0256 00229000
         STCM  @06,3,TMTPERMA(@08)                                 0256 00230000
*    TMTTEMPA = TMTTEMPA + TRENDTMP;                       /*@0099VLS*/ 00231000
         ICM   @06,15,TMTTEMPA(@08)                                0257 00232000
         ICM   @03,15,TRENDTMP                                     0257 00233000
         ALR   @06,@03                                             0257 00234000
         STCM  @06,15,TMTTEMPA(@08)                                0257 00235000
*    FOUND = YES;                                          /*@0099VLS*/ 00236000
         OI    FOUND,B'10000000'                                   0258 00237000
*   END;                                                   /*@0099VLS*/ 00238000
* END;                                                     /*@0099VLS*/ 00239000
@RF00254 L     @08,@CF01351                                        0260 00240000
         AL    @08,ZZ                                              0260 00241000
         ST    @08,ZZ                                              0260 00242000
@DE00253 C     @08,SORTADR(,R2)                                    0260 00243000
         BNL   @DL00253                                            0260 00244000
@DC00253 DS    0H                                                  0261 00245000
* IF FOUND = NO THEN                                               0261 00246000
         TM    FOUND,B'10000000'                                   0261 00247000
         BNZ   @RF00261                                            0261 00248000
*  DO;                                                     /*@0099VLS*/ 00249000
*   TMT2(ENTRIES) = TREND2;                                /*@0099VLS*/ 00250000
         L     @08,ENTRIES                                         0263 00251000
         LR    @06,@08                                             0263 00252000
         MH    @06,@CH00940                                        0263 00253000
         L     @03,SORTADR(,R2)                                    0263 00254000
         ALR   @03,@06                                             0263 00255000
         AL    @03,@CF01351                                        0263 00256000
         MVC   TMT2(14,@03),TREND2                                 0263 00257000
*   ENTRIES = ENTRIES + 1;                                 /*@0099VLS*/ 00258000
         AL    @08,@CF00055                                        0264 00259000
         ST    @08,ENTRIES                                         0264 00260000
*  END;                                                    /*@0099VLS*/ 00261000
*IF DEBUG50 = ON THEN                                              0266 00262000
@RF00261 TM    DEBUG50(R2),B'00100000'                             0266 00263000
         BNO   @RF00266                                            0266 00264000
* DO;                                                      /*@0099VLS*/ 00265000
*  NUMBER = 14;                                            /*@0099VLS*/ 00266000
         MVC   NUMBER(4),@CF00940                                  0268 00267000
*  NEXTBY = ADDR(TREND2);                                  /*@0099VLS*/ 00268000
         LA    @08,TREND2                                          0269 00269000
         ST    @08,NEXTBY                                          0269 00270000
*  ADDNXT = ADDR(PRINTBDY);                                /*@0099VLS*/ 00271000
         LA    @08,PRINTBDY                                        0270 00272000
         ST    @08,ADDNXT                                          0270 00273000
*  CALL CONVERT;                                           /*@0099VLS*/ 00274000
         BAL   @14,CONVERT                                         0271 00275000
*  IF FOUND = YES THEN                                             0272 00276000
         TM    FOUND,B'10000000'                                   0272 00277000
         BNO   @RF00272                                            0272 00278000
*  DO;                                                     /*@0099VLS*/ 00279000
*  NEXTBY = ZZ + 14;                                       /*@0099VLS*/ 00280000
         LA    @08,14                                              0274 00281000
         AL    @08,ZZ                                              0274 00282000
         ST    @08,NEXTBY                                          0274 00283000
*  ADDNXT = ADDR(PRINTBDY) + 40;                           /*@0099VLS*/ 00284000
         LA    @08,PRINTBDY                                        0275 00285000
         AL    @08,@CF01356                                        0275 00286000
         ST    @08,ADDNXT                                          0275 00287000
*  CALL CONVERT;                                           /*@0099VLS*/ 00288000
         BAL   @14,CONVERT                                         0276 00289000
*  END;                                                    /*@0099VLS*/ 00290000
*  PRINTADR = ADDR(PRINTLIN);                              /*@0099VLS*/ 00291000
@RF00272 LA    @08,PRINTLIN                                        0278 00292000
         ST    @08,PRINTADR(,R2)                                   0278 00293000
*  CALL IOHND(RITEPRTR);                                   /*@0099VLS*/ 00294000
         L     @15,ADIOHND(,R2)                                    0279 00295000
         LA    @01,@AL00279                                        0279 00296000
         BALR  @14,@15                                             0279 00297000
* END;                                                     /*@0099VLS*/ 00298000
*TREND2 = TREND2  && TREND2;    /*CLEAR FOR THE NEXT ENTRY   @0099VLS*/ 00299000
@RF00266 XC    TREND2(14),TREND2                                   0281 00300000
*END;                                                      /*@0099VLS*/ 00301000
@EL00002 DS    0H                                                  0282 00302000
@EF00002 DS    0H                                                  0282 00303000
@ER00002 LM    @14,@12,@SA00002                                    0282 00304000
         BR    @14                                                 0282 00305000
*INITIATE: PROC;                                           /*@Z427VLS*/ 00306000
INITIATE STM   @14,@12,@SA00003                                    0283 00307000
*RESPECIFY(R3,R15) RESTRICTED;                             /*@Z427VLS*/ 00308000
*/*CORE IS ALLOCATED FOR TREND2  , EVTABLE, THE INITIAL ENTRIES OF */   00309000
*/*TRENDONE. IF SHARE TABLE EXISTS, EXTRA ENTRIES OF TRENDONE ARE  */   00310000
*/* ALLOCATED FOR EVERY UNIQUE CPU SERIAL ENCOUNTERED IN SHARE     */   00311000
*/* TABLE. ERROR MESSAGES ARE ISSUED AND A SERIOUS RETURN CODE     */   00312000
*/* ISSUED IF CORE IS NOT AVAILABLE. THE LENGTH  OF A TRENDONE     */   00313000
*/* GETMAIN IS DETERMINED.                                   @Z427VLS*/ 00314000
*CALL CALCRANG; /*FIND NUMBER OF DAYS IN DAY RANGE           @Z427VLS*/ 00315000
         BAL   @14,CALCRANG                                        0285 00316000
*TREN1SIZ = (NUMDAYS * 76) + 8;                            /*@0099VLS*/ 00317000
         L     @14,NUMDAYS(,R2)                                    0286 00318000
         MH    @14,@CH01361                                        0286 00319000
         AL    @14,@CF00066                                        0286 00320000
         ST    @14,TREN1SIZ                                        0286 00321000
*R3 = TABSIZE + EVSIZE; /*LENGTH OF TREND2 PLUS EVTABLE      @Z427VLS*/ 00322000
         LA    R3,104                                              0287 00323000
         AL    R3,TABSIZE(,R2)                                     0287 00324000
*GEN(GETMAIN EC,LV=(R3),A=COMPLINK); /*ISSUE REQUEST FOR CORE*/    0288 00325000
         GETMAIN EC,LV=(R3),A=COMPLINK                                  00326000
*IF R15 ^= SUCCESS THEN /*IF GETMAIN NOT SUCCESSFULL         @Z427VLS*/ 00327000
         LTR   R15,R15                                             0289 00328000
         BZ    @RF00289                                            0289 00329000
*  DO;                                                     /*@Z427VLS*/ 00330000
*    MSGNO = 2;                                            /*@Z427VLS*/ 00331000
         MVI   MSGNO,X'02'                                         0291 00332000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00333000
         BAL   @14,ERRMSG                                          0292 00334000
*    R15 =NOSRTABL;                                        /*@0001VLS*/ 00335000
         LA    R15,12                                              0293 00336000
*    GETFAIL = YES;                                        /*@0001VLS*/ 00337000
         OI    GETFAIL,B'00000100'                                 0294 00338000
*  END;                                                    /*@Z427VLS*/ 00339000
*ELSE /*IF GETMAIN IS SUCCESSFULL                            @Z427VLS*/ 00340000
*  DO;                                                     /*@Z427VLS*/ 00341000
         B     @RC00289                                            0296 00342000
@RF00289 DS    0H                                                  0297 00343000
*    EVPTR = COMPLINK; /*ESTABLISH BASE ADDRESS OF EVTABLE   @Z427VLS*/ 00344000
         L     @14,COMPLINK                                        0297 00345000
         ST    @14,EVPTR(,R2)                                      0297 00346000
*    EVSTOP = '00000F'X; /*GRAB FIRST RECORDS DATE           @Z427VLS*/ 00347000
         MVC   EVSTOP(3,@14),@CB00228                              0298 00348000
*    STRTDATE = '99366F'X; /*LIKEWISE                        @Z427VLS*/ 00349000
         MVC   STRTDATE(3,R2),@CB01363                             0299 00350000
*    MAXENT = TABSIZE/14;      /*DETERMINE MAX NUMBER OF ENTRIES*/ 0300 00351000
         L     @00,TABSIZE(,R2)                                    0300 00352000
         SRDA  @00,32                                              0300 00353000
         D     @00,@CF00940                                        0300 00354000
         ST    @01,MAXENT                                          0300 00355000
*    SORTADR = EVPTR + EVSIZE; /*SET TREND2 BASE PAST EVTABLE*/    0301 00356000
         LA    @08,104                                             0301 00357000
         ALR   @08,@14                                             0301 00358000
         ST    @08,SORTADR(,R2)                                    0301 00359000
*    TREND2(1) = (TREND2(1) && TREND2(1)); /*CLEAR TREND2 ENT ONE*/     00360000
         XC    TREND2(1),TREND2                                    0302 00361000
*    EVTABLE  = (EVTABLE  && EVTABLE); /*CLEAR EVTABLE TO ZEROS*/  0303 00362000
         XC    EVTABLE(102,@14),EVTABLE(@14)                       0303 00363000
*    IF SHAREPTR ^= ZERO THEN                                      0304 00364000
         L     @14,SHAREPTR(,R2)                                   0304 00365000
         LTR   @14,@14                                             0304 00366000
         BZ    @RF00304                                            0304 00367000
*      DO;                                              /* @ZA17692 */  00368000
*        CALL SORTSHAR;      /* SORT SHARE TABLE CPU LETER @ZA17692 */  00369000
         BAL   @14,SORTSHAR                                        0306 00370000
*        DO J = 1 BY 1 TO SHARENUM WHILE R15 = SUCCESS;    /*@Z427VLS*/ 00371000
         LA    @14,1                                               0307 00372000
         ST    @14,J                                               0307 00373000
         B     @DE00307                                            0307 00374000
@DL00307 LTR   R15,R15                                             0307 00375000
         BNZ   @DC00307                                            0307 00376000
*          UNIQUE = YES;                                   /*@Z427VLS*/ 00377000
         OI    UNIQUE,B'00000100'                                  0308 00378000
*          DO K = 1 BY 1 TO EVMAX WHILE UNIQUE = YES;      /*@Z427VLS*/ 00379000
         LA    @14,1                                               0309 00380000
         ST    @14,K                                               0309 00381000
@DL00309 TM    UNIQUE,B'00000100'                                  0309 00382000
         BNO   @DC00309                                            0309 00383000
*            IF SHARSERA(J) = EVSERIAL(K) THEN                     0310 00384000
         L     @08,J                                               0310 00385000
         MH    @08,@CH00033                                        0310 00386000
         L     @06,SHAREPTR(,R2)                                   0310 00387000
         MH    @14,@CH00081                                        0310 00388000
         L     @01,EVPTR(,R2)                                      0310 00389000
         ALR   @06,@08                                             0310 00390000
         AL    @06,@CF01571                                        0310 00391000
         ALR   @01,@14                                             0310 00392000
         CLC   SHARSERA-4(3,@06),EVSERIAL-6(@01)                   0310 00393000
         BNE   @RF00310                                            0310 00394000
*              UNIQUE = NO;                                /*@Z427VLS*/ 00395000
         NI    UNIQUE,B'11111011'                                  0311 00396000
*            ELSE IF EVSERIAL(K) = ZERO THEN                       0312 00397000
         B     @RC00310                                            0312 00398000
@RF00310 L     @14,K                                               0312 00399000
         MH    @14,@CH00081                                        0312 00400000
         L     @08,EVPTR(,R2)                                      0312 00401000
         L     @06,EVSERIAL-7(@14,@08)                             0312 00402000
         LA    @06,0(,@06)                                         0312 00403000
         LTR   @06,@06                                             0312 00404000
         BNZ   @RF00312                                            0312 00405000
*              DO;                                         /*@Z427VLS*/ 00406000
*                UNIQUE = NO; /*ONLY BUILD ONE ENTRY PER CPU @Z427VLS*/ 00407000
         NI    UNIQUE,B'11111011'                                  0314 00408000
*                EVSERIAL(K) = SHARSERA(J);                /*@Z427VLS*/ 00409000
         ST    @14,@TF00001                                        0315 00410000
         ALR   @14,@08                                             0315 00411000
         L     @06,J                                               0315 00412000
         MH    @06,@CH00033                                        0315 00413000
         L     @05,SHAREPTR(,R2)                                   0315 00414000
         ST    @06,@TF00002                                        0315 00415000
         ALR   @06,@05                                             0315 00416000
         AL    @06,@CF01571                                        0315 00417000
         MVC   EVSERIAL-6(3,@14),SHARSERA-4(@06)                   0315 00418000
*                EVLETTER(K) = SHARLET(J);                 /*@Z427VLS*/ 00419000
         LR    @14,@08                                             0316 00420000
         AL    @14,@TF00001                                        0316 00421000
         AL    @05,@TF00002                                        0316 00422000
         MVC   EVLETTER-6(1,@14),SHARLET-11(@05)                   0316 00423000
*                EVNUM = EVNUM + 1;                        /*@Z427VLS*/ 00424000
         LA    @14,1                                               0317 00425000
         AH    @14,EVNUM(,@08)                                     0317 00426000
         STH   @14,EVNUM(,@08)                                     0317 00427000
*                    R3 = TREN1SIZ; /*LENGTH OF TRENDONE TABLE*/   0318 00428000
         L     R3,TREN1SIZ                                         0318 00429000
*                    GEN(GETMAIN EC,LV=(R3),A=COMPLINK);   /*@Z427VLS*/ 00430000
         GETMAIN EC,LV=(R3),A=COMPLINK                                  00431000
*                    IF R15  ^= SUCCESS THEN                       0320 00432000
         LTR   R15,R15                                             0320 00433000
         BZ    @RF00320                                            0320 00434000
*                      DO;                                 /*@Z427VLS*/ 00435000
*                        MSGNO = 1;                        /*@Z427VLS*/ 00436000
         MVI   MSGNO,X'01'                                         0322 00437000
*                        CALL ERRMSG;                      /*@Z427VLS*/ 00438000
         BAL   @14,ERRMSG                                          0323 00439000
*                    R15 = NOSRTABL; /*RET.CODE OF 12        @0001VLS*/ 00440000
         LA    R15,12                                              0324 00441000
*                    GETFAIL = YES; /*STOP FURTHER PROCESSING*/    0325 00442000
         OI    GETFAIL,B'00000100'                                 0325 00443000
*                      END;                                /*@Z427VLS*/ 00444000
*                    ELSE                                          0327 00445000
*                      DO;                                 /*@Z427VLS*/ 00446000
         B     @RC00320                                            0327 00447000
@RF00320 DS    0H                                                  0328 00448000
*                        IF K > 1 THEN /*IF NOT 1ST CREATED ENTRY*/     00449000
         CLC   K(4),@CF00055                                       0328 00450000
         BNH   @RF00328                                            0328 00451000
*                          TRENEXT = COMPLINK; /*POINT TO THIS NEW*/    00452000
         L     @14,TRENPTR(,R2)                                    0329 00453000
         L     @08,COMPLINK                                        0329 00454000
         ST    @08,TRENEXT(,@14)                                   0329 00455000
*                                         /*ENTRY IN THE OLD ENTRY*/    00456000
*                        TRENPTR = COMPLINK; /*ADDRESS NEW ENTRY*/ 0330 00457000
@RF00328 L     @14,COMPLINK                                        0330 00458000
         ST    @14,TRENPTR(,R2)                                    0330 00459000
*                        SAVEADR(K) = COMPLINK; /*SAVE ENTRY ADDRESS*/  00460000
         L     @08,K                                               0331 00461000
         SLA   @08,2                                               0331 00462000
         ST    @14,SAVEADR-4(@08)                                  0331 00463000
*                        DO Q = 1 BY 1 TO NUMDAYS;         /*@Z427VLS*/ 00464000
         LA    @14,1                                               0332 00465000
         ST    @14,Q                                               0332 00466000
         B     @DE00332                                            0332 00467000
@DL00332 DS    0H                                                  0333 00468000
*                          TREGEN(Q) = (TREGEN(Q) && TREGEN(Q));   0333 00469000
         LR    @08,@14                                             0333 00470000
         MH    @08,@CH01361                                        0333 00471000
         L     @06,TRENPTR(,R2)                                    0333 00472000
         ALR   @06,@08                                             0333 00473000
         AL    @06,@CF01573                                        0333 00474000
         XC    TREGEN-8(76,@06),TREGEN-8(@06)                      0333 00475000
*                        END;                              /*@Z427VLS*/ 00476000
         AL    @14,@CF00055                                        0334 00477000
         ST    @14,Q                                               0334 00478000
@DE00332 C     @14,NUMDAYS(,R2)                                    0334 00479000
         BNH   @DL00332                                            0334 00480000
*                        TRENEXT = (TRENEXT && TRENEXT);   /*@Z427VLS*/ 00481000
         L     @14,TRENPTR(,R2)                                    0335 00482000
         L     @08,TRENEXT(,@14)                                   0335 00483000
         LR    @06,@08                                             0335 00484000
         XR    @06,@08                                             0335 00485000
         ST    @06,TRENEXT(,@14)                                   0335 00486000
*                        TRENUM  = (TRENUM && TRENUM);     /*@Z427VLS*/ 00487000
         L     @08,TRENUM(,@14)                                    0336 00488000
         LR    @06,@08                                             0336 00489000
         XR    @06,@08                                             0336 00490000
         ST    @06,TRENUM(,@14)                                    0336 00491000
*                          /*SET NEW ENTRY TO ZEROS          @Z427VLS*/ 00492000
*                      END;                                /*@Z427VLS*/ 00493000
*              END;                                        /*@Z427VLS*/ 00494000
@RC00320 DS    0H                                                  0339 00495000
*      END;                                                /*@Z427VLS*/ 00496000
@RF00312 DS    0H                                                  0339 00497000
@RC00310 LA    @14,1                                               0339 00498000
         AL    @14,K                                               0339 00499000
         ST    @14,K                                               0339 00500000
         C     @14,@CF00088                                        0339 00501000
         BNH   @DL00309                                            0339 00502000
@DC00309 DS    0H                                                  0340 00503000
*        END;                                            /* @Z427VLS */ 00504000
         LA    @14,1                                               0340 00505000
         AL    @14,J                                               0340 00506000
         ST    @14,J                                               0340 00507000
@DE00307 L     @08,SHAREPTR(,R2)                                   0340 00508000
         CH    @14,SHARENUM(,@08)                                  0340 00509000
         BNH   @DL00307                                            0340 00510000
@DC00307 DS    0H                                                  0341 00511000
*      END;                                             /* @ZA17692 */  00512000
*  END;                                                    /*@Z427VLS*/ 00513000
@RF00304 DS    0H                                                  0343 00514000
*  NUMUNSHR = EVNUM + 1;                                   /*@Z427VLS*/ 00515000
@RC00289 L     @14,EVPTR(,R2)                                      0343 00516000
         LH    @14,EVNUM(,@14)                                     0343 00517000
         LA    @14,1(,@14)                                         0343 00518000
         STH   @14,NUMUNSHR                                        0343 00519000
*IF R15 = SUCCESS &  /*IF OTHER GETMAINS HAVE BEEN SUCCESSFULL  */ 0344 00520000
*         PACC = ON &  /*ONLY CHECK FRAMES IF WRITTEN TO ACCDEV*/  0344 00521000
*         (PMCH = ON | PCHAN = ON) THEN /*IF MCH OR CCH SELECTED*/ 0344 00522000
         LTR   R15,R15                                             0344 00523000
         BNZ   @RF00344                                            0344 00524000
         TM    PACC(R2),B'01000000'                                0344 00525000
         BNO   @RF00344                                            0344 00526000
         TM    PMCH(R2),B'11000000'                                0344 00527000
         BZ    @RF00344                                            0344 00528000
*  DO;                                                     /*@G51DGBB*/ 00529000
*    RESPECIFY (R1) RESTRICTED;                            /*@G51DGBB*/ 00530000
*    R0 = FRAMBENT * EVMAX; /*NUMBER OF ENTRIES TIMES BYTES PER ENTRY*/ 00531000
         LA    R0,384                                              0347 00532000
*    R0 = R0 + 4;           /*ADD FRAMENUM LENGTH            @G51DGBB*/ 00533000
         AL    R0,@CF00064                                         0348 00534000
*    GEN(GETMAIN EC,LV=(R0),A=LINKITM,SP=21); /*GET THE STORAGE*/  0349 00535000
         GETMAIN EC,LV=(R0),A=LINKITM,SP=21                             00536000
*    RESPECIFY (R0) UNRESTRICTED;                          /*@G51DGBB*/ 00537000
*    IF R15 = SUCCESS THEN   /*IF GETMAIN SUCCESSFULL        @G51DGBB*/ 00538000
         LTR   R15,R15                                             0351 00539000
         BNZ   @RF00351                                            0351 00540000
*      DO;                                                 /*@G51DGBB*/ 00541000
*        FRAMEPTR = LINKITM;  /*ESTABLISH FRAMETAB BASE ADDRESS*/  0353 00542000
         L     @14,LINKITM                                         0353 00543000
         ST    @14,FRAMEPTR(,R2)                                   0353 00544000
*        DO Y = 1 BY 1 TO EVMAX; /*CLEAR FRAMETAB TO ZEROS   @G51DGBB*/ 00545000
         LA    @14,1                                               0354 00546000
         ST    @14,Y                                               0354 00547000
@DL00354 DS    0H                                                  0355 00548000
*          FRAMEDTA(Y) = (FRAMEDTA(Y) && FRAMEDTA(Y));     /*@G51DGBB*/ 00549000
         LR    @08,@14                                             0355 00550000
         MH    @08,@CH00227                                        0355 00551000
         L     @06,FRAMEPTR(,R2)                                   0355 00552000
         ALR   @06,@08                                             0355 00553000
         AL    @06,@CF01574                                        0355 00554000
         XC    FRAMEDTA-4(24,@06),FRAMEDTA-4(@06)                  0355 00555000
*        END;                                              /*@G51DGBB*/ 00556000
         AL    @14,@CF00055                                        0356 00557000
         ST    @14,Y                                               0356 00558000
         C     @14,@CF00088                                        0356 00559000
         BNH   @DL00354                                            0356 00560000
*        FRAMENUM = ZEROS;                                 /*@G51DGBB*/ 00561000
         L     @14,FRAMEPTR(,R2)                                   0357 00562000
         SLR   @08,@08                                             0357 00563000
         ST    @08,FRAMENUM(,@14)                                  0357 00564000
*      END;                                                /*@G51DGBB*/ 00565000
*  ELSE  /*UNSUCCESSFULL GETMAIN                             @G51DGBB*/ 00566000
*    DO;                                                   /*@G51DGBB*/ 00567000
         B     @RC00351                                            0359 00568000
@RF00351 DS    0H                                                  0360 00569000
*      R15 = TWELVE;  /*DONT CONTINUE RETURN CODE            @G51DGBB*/ 00570000
         LA    R15,12                                              0360 00571000
*      MSGNO = 40;   /*CORE NOT AVAILABLE MESSAGE            @G51DGBB*/ 00572000
         MVI   MSGNO,X'28'                                         0361 00573000
*      CALL ERRMSG;  /*PRINT ERROR MESSAGE                   @G51DGBB*/ 00574000
         BAL   @14,ERRMSG                                          0362 00575000
*    END;                                                  /*@G51DGBB*/ 00576000
* END; /*END OF FRAMETAB GETMAIN                             @G51DGBB*/ 00577000
@RC00351 DS    0H                                                  0365 00578000
*  ERROR = R15; /*COMMUNICATE ERROR CONDITIONS TO CALLING PROC*/   0365 00579000
@RF00344 ST    R15,ERROR                                           0365 00580000
*RESPECIFY(R3,R15) UNRESTRICTED;                           /*@Z427VLS*/ 00581000
*END; /*END OF PROC INITAB                                   @Z427VLS*/ 00582000
@EL00003 DS    0H                                                  0367 00583000
@EF00003 DS    0H                                                  0367 00584000
@ER00003 LM    @14,@12,@SA00003                                    0367 00585000
         BR    @14                                                 0367 00586000
*CONVERT: PROC;                                            /*@Z427VLS*/ 00587000
CONVERT  STM   @14,@12,12(@13)                                     0368 00588000
* DCL  T      FIXED(31) INIT(0);                           /*@Z427VLS*/ 00589000
*DCL  P FIXED(31) INIT(0);                                 /*@G51DGBB*/ 00590000
*DCL  R FIXED(31) INIT(0);                                 /*@G51DGBB*/ 00591000
* DCL  NUMBER FIXED(31) INIT(0);                           /*@Z427VLS*/ 00592000
* DCL  NEXTBYTE(1) CHAR(1) BASED(NEXTBY);                  /*@Z427VLS*/ 00593000
* DCL  ADDNUM(1)   CHAR(1) BASED(ADDNXT);                  /*@Z427VLS*/ 00594000
* DCL  CHARS       CHAR(16) INIT('0123456789ABCDEF');      /*@Z427VLS*/ 00595000
* DCL  NEXTBY FIXED(31) INIT(0);                           /*@Z427VLS*/ 00596000
* DCL  ADDNXT FIXED(31) INIT(0);                           /*@Z427VLS*/ 00597000
*   RESPECIFY (R4,R5) RESTRICTED;                          /*@0099VLS*/ 00598000
*DO R = NUMBER BY -1 TO 1;                                 /*@G51DGBB*/ 00599000
         L     @08,NUMBER                                          0379 00600000
         ST    @08,R                                               0379 00601000
         B     @DE00379                                            0379 00602000
@DL00379 DS    0H                                                  0380 00603000
* R4 = NEXTBYTE(R);                                        /*@G51DGBB*/ 00604000
         L     @06,NEXTBY                                          0380 00605000
         BCTR  @06,0                                               0380 00606000
         SLR   R4,R4                                               0380 00607000
         IC    R4,NEXTBYTE(@08,@06)                                0380 00608000
* P = 2 * R;                                               /*@G51DGBB*/ 00609000
         LR    @06,@08                                             0381 00610000
         ALR   @06,@06                                             0381 00611000
         ST    @06,P                                               0381 00612000
*  SRDL(R4,4);                                             /*@Z427VLS*/ 00613000
         SRDL  R4,4                                                0382 00614000
*  SRL(R5,28);                                             /*@Z427VLS*/ 00615000
         SRL   R5,28                                               0383 00616000
*  R5 = R5 + 1;                                            /*@Z427VLS*/ 00617000
         LA    @03,1                                               0384 00618000
         ALR   R5,@03                                              0384 00619000
*  R4 = R4 + 1;                                            /*@Z427VLS*/ 00620000
         ALR   R4,@03                                              0385 00621000
* ADDNUM(P-1) = CHARS(R4);                                 /*@G51DGBB*/ 00622000
         L     @03,ADDNXT                                          0386 00623000
         ALR   @06,@03                                             0386 00624000
         BCTR  @06,0                                               0386 00625000
         BCTR  @06,0                                               0386 00626000
         LA    @15,CHARS-1(R4)                                     0386 00627000
         MVC   ADDNUM(1,@06),0(@15)                                0386 00628000
* ADDNUM(P)  = CHARS(R5);                                  /*@G51DGBB*/ 00629000
         L     @06,P                                               0387 00630000
         ALR   @03,@06                                             0387 00631000
         BCTR  @03,0                                               0387 00632000
         LA    @06,CHARS-1(R5)                                     0387 00633000
         MVC   ADDNUM(1,@03),0(@06)                                0387 00634000
* END;                                                     /*@Z427VLS*/ 00635000
         BCTR  @08,0                                               0388 00636000
         ST    @08,R                                               0388 00637000
@DE00379 LTR   @08,@08                                             0388 00638000
         BP    @DL00379                                            0388 00639000
*END;                                                      /*@Z427VLS*/ 00640000
@EL00004 DS    0H                                                  0389 00641000
@EF00004 DS    0H                                                  0389 00642000
@ER00004 LM    @14,@12,12(@13)                                     0389 00643000
         BR    @14                                                 0389 00644000
*RESPECIFY (R4,R5) UNRESTRICTED;                           /*@Z427VLS*/ 00645000
*SORTONE: PROC; /*SORT EVTABLE IN DESCENDING ORDER BY MODEL, SERIAL*/   00646000
SORTONE  STM   @14,@12,12(@13)                                     0391 00647000
*               /*NUMBER FOR UNSHARED CPUS AND RELINK THE NEXT     */   00648000
*               /*ENTRY POINTERS FOR TABLE TRENDONE.         @Z427VLS*/ 00649000
*               /*SET EVLETTER FOR UNSHARED CPUS             @Z427VLS*/ 00650000
*IF NUMUNSHR < EVNUM THEN  /*IF TWO OR MORE CPUS IDENTIFIED AND    */   00651000
         LH    @08,NUMUNSHR                                        0392 00652000
         L     @06,EVPTR(,R2)                                      0392 00653000
         CH    @08,EVNUM(,@06)                                     0392 00654000
         BNL   @RF00392                                            0392 00655000
*  DO;   /*NOT IN SHARE TABLE THEN SORT, RELINK POINTERS.    @Z427VLS*/ 00656000
*    DO J = NUMUNSHR BY 1 TO EVNUM - 1; /*SORT IN DESCENDING ORDER */   00657000
         ST    @08,J                                               0394 00658000
         B     @DE00394                                            0394 00659000
@DL00394 DS    0H                                                  0395 00660000
*      DO K = J+1 BY 1 TO EVNUM;                           /*@Z427VLS*/ 00661000
         AL    @08,@CF00055                                        0395 00662000
         ST    @08,K                                               0395 00663000
         B     @DE00395                                            0395 00664000
@DL00395 DS    0H                                                  0396 00665000
*        IF EVKEY(J) < EVKEY(K) THEN                               0396 00666000
         L     @06,J                                               0396 00667000
         LA    @03,6                                               0396 00668000
         LR    @05,@06                                             0396 00669000
         MR    @04,@03                                             0396 00670000
         L     @04,EVPTR(,R2)                                      0396 00671000
         LR    @15,@03                                             0396 00672000
         MR    @14,@08                                             0396 00673000
         ST    @05,@TF00001                                        0396 00674000
         ALR   @05,@04                                             0396 00675000
         ST    @15,@TF00002                                        0396 00676000
         ALR   @15,@04                                             0396 00677000
         CLC   EVKEY-6(6,@05),EVKEY-6(@15)                         0396 00678000
         BNL   @RF00396                                            0396 00679000
*          DO;                                             /*@Z427VLS*/ 00680000
*            EVKEY(J) = (EVKEY(J)   &&   EVKEY(K)); /*FLIP ENTRIES*/    00681000
         LR    @03,@04                                             0398 00682000
         AL    @03,@TF00001                                        0398 00683000
         LR    @05,@04                                             0398 00684000
         AL    @05,@TF00001                                        0398 00685000
         MVC   @TS00001(6),EVKEY-6(@05)                            0398 00686000
         LR    @05,@04                                             0398 00687000
         AL    @05,@TF00002                                        0398 00688000
         XC    @TS00001(6),EVKEY-6(@05)                            0398 00689000
         MVC   EVKEY-6(6,@03),@TS00001                             0398 00690000
*            EVKEY(K) = (EVKEY(K)   &&   EVKEY(J));        /*@Z427VLS*/ 00691000
         LR    @03,@04                                             0399 00692000
         AL    @03,@TF00002                                        0399 00693000
         LR    @05,@04                                             0399 00694000
         AL    @05,@TF00002                                        0399 00695000
         MVC   @TS00001(6),EVKEY-6(@05)                            0399 00696000
         LR    @05,@04                                             0399 00697000
         AL    @05,@TF00001                                        0399 00698000
         XC    @TS00001(6),EVKEY-6(@05)                            0399 00699000
         MVC   EVKEY-6(6,@03),@TS00001                             0399 00700000
*            EVKEY(J) = (EVKEY(J)   &&   EVKEY(K));        /*@Z427VLS*/ 00701000
         LR    @03,@04                                             0400 00702000
         AL    @03,@TF00001                                        0400 00703000
         LR    @05,@04                                             0400 00704000
         AL    @05,@TF00001                                        0400 00705000
         MVC   @TS00001(6),EVKEY-6(@05)                            0400 00706000
         AL    @04,@TF00002                                        0400 00707000
         XC    @TS00001(6),EVKEY-6(@04)                            0400 00708000
         MVC   EVKEY-6(6,@03),@TS00001                             0400 00709000
*            SAVEADR(J) = (SAVEADR(J)  &&  SAVEADR(K));    /*@Z427VLS*/ 00710000
         LR    @03,@06                                             0401 00711000
         SLA   @03,2                                               0401 00712000
         LR    @15,@08                                             0401 00713000
         SLA   @15,2                                               0401 00714000
         L     @00,SAVEADR-4(@03)                                  0401 00715000
         X     @00,SAVEADR-4(@15)                                  0401 00716000
         ST    @00,SAVEADR-4(@03)                                  0401 00717000
*            SAVEADR(K) = (SAVEADR(K)  &&  SAVEADR(J));    /*@Z427VLS*/ 00718000
         X     @00,SAVEADR-4(@15)                                  0402 00719000
         ST    @00,SAVEADR-4(@15)                                  0402 00720000
*            SAVEADR(J) = (SAVEADR(J)  &&  SAVEADR(K));    /*@Z427VLS*/ 00721000
         X     @00,SAVEADR-4(@03)                                  0403 00722000
         ST    @00,SAVEADR-4(@03)                                  0403 00723000
*            /*MUST SAVE ALTERATIONS TO EVTABLE SO THAT I CAN FIX*/     00724000
*            /*ENTRY POINTERS TO EVTABLE IN SYSUM2 AT END OF JOB*/ 0404 00725000
*            FLIP(J)    = (FLIP(J) && FLIP(K));            /*@Z427VLS*/ 00726000
         SLR   @03,@03                                             0404 00727000
         IC    @03,FLIP-1(@06)                                     0404 00728000
         SLR   @00,@00                                             0404 00729000
         IC    @00,FLIP-1(@08)                                     0404 00730000
         XR    @03,@00                                             0404 00731000
         STC   @03,FLIP-1(@06)                                     0404 00732000
*            FLIP(K)    = (FLIP(K) && FLIP(J));            /*@Z427VLS*/ 00733000
         SLR   @00,@00                                             0405 00734000
         IC    @00,FLIP-1(@08)                                     0405 00735000
         XR    @03,@00                                             0405 00736000
         STC   @03,FLIP-1(@08)                                     0405 00737000
*            FLIP(J)    = (FLIP(J) && FLIP(K));            /*@Z427VLS*/ 00738000
         SLR   @08,@08                                             0406 00739000
         IC    @08,FLIP-1(@06)                                     0406 00740000
         XR    @03,@08                                             0406 00741000
         STC   @03,FLIP-1(@06)                                     0406 00742000
*          END;                                            /*@Z427VLS*/ 00743000
*        END;                                              /*@Z427VLS*/ 00744000
@RF00396 LA    @08,1                                               0408 00745000
         AL    @08,K                                               0408 00746000
         ST    @08,K                                               0408 00747000
@DE00395 L     @06,EVPTR(,R2)                                      0408 00748000
         CH    @08,EVNUM(,@06)                                     0408 00749000
         BNH   @DL00395                                            0408 00750000
*     END;                                                 /*@Z427VLS*/ 00751000
         LA    @08,1                                               0409 00752000
         AL    @08,J                                               0409 00753000
         ST    @08,J                                               0409 00754000
@DE00394 L     @06,EVPTR(,R2)                                      0409 00755000
         LH    @06,EVNUM(,@06)                                     0409 00756000
         BCTR  @06,0                                               0409 00757000
         CR    @08,@06                                             0409 00758000
         BNH   @DL00394                                            0409 00759000
*DO J = NUMUNSHR BY 1 TO EVNUM; /*RELINK ALL TRENDONE ENTRIES*/    0410 00760000
         LH    @08,NUMUNSHR                                        0410 00761000
         ST    @08,J                                               0410 00762000
         B     @DE00410                                            0410 00763000
@DL00410 DS    0H                                                  0411 00764000
*  IF J > 1 THEN  /*IF 1ST ENTRY, CANT CHANGE PREVIOUS FORWARD PTR*/    00765000
         C     @08,@CF00055                                        0411 00766000
         BNH   @RF00411                                            0411 00767000
*    DO;                                                   /*@Z427VLS*/ 00768000
*      TRENPTR = SAVEADR(J-1); /*ADDRESS PREVIOUS ENTRY      @Z427VLS*/ 00769000
         SLA   @08,2                                               0413 00770000
         L     @06,SAVEADR-8(@08)                                  0413 00771000
         ST    @06,TRENPTR(,R2)                                    0413 00772000
*      TRENEXT = SAVEADR(J); /*CHANGE PREVIOUS FORWARD PTR   @Z427VLS*/ 00773000
         L     @08,SAVEADR-4(@08)                                  0414 00774000
         ST    @08,TRENEXT(,@06)                                   0414 00775000
*    END;                                                  /*@Z427VLS*/ 00776000
*  IF J = EVNUM THEN /*IF LAST ENTRY IN CHAIN, DONT POINT TO NEXT*/     00777000
@RF00411 L     @08,J                                               0416 00778000
         L     @06,EVPTR(,R2)                                      0416 00779000
         CH    @08,EVNUM(,@06)                                     0416 00780000
         BNE   @RF00416                                            0416 00781000
*    DO;                                                   /*@Z427VLS*/ 00782000
*      TRENPTR = SAVEADR(J); /*ADDRESS LAST ENTRY            @Z427VLS*/ 00783000
         SLA   @08,2                                               0418 00784000
         L     @08,SAVEADR-4(@08)                                  0418 00785000
         ST    @08,TRENPTR(,R2)                                    0418 00786000
*      TRENEXT = 0; /*SET LAST ENTRY FORWARD POINTER TO ZERO @Z427VLS*/ 00787000
         SLR   @06,@06                                             0419 00788000
         ST    @06,TRENEXT(,@08)                                   0419 00789000
*    END;                                                  /*@Z427VLS*/ 00790000
*  END;                                                    /*@Z427VLS*/ 00791000
@RF00416 LA    @08,1                                               0421 00792000
         AL    @08,J                                               0421 00793000
         ST    @08,J                                               0421 00794000
@DE00410 L     @06,EVPTR(,R2)                                      0421 00795000
         CH    @08,EVNUM(,@06)                                     0421 00796000
         BNH   @DL00410                                            0421 00797000
* END;                                                     /*@Z427VLS*/ 00798000
*IF NUMUNSHR < EVNUM + 1 THEN  /*IF SOME EVLETTERS REMAIN UNSET*/  0423 00799000
@RF00392 LH    @08,NUMUNSHR                                        0423 00800000
         L     @06,EVPTR(,R2)                                      0423 00801000
         LA    @03,1                                               0423 00802000
         AH    @03,EVNUM(,@06)                                     0423 00803000
         CR    @08,@03                                             0423 00804000
         BNL   @RF00423                                            0423 00805000
*  DO J = NUMUNSHR BY 1 TO EVNUM;                          /*@Z427VLS*/ 00806000
         ST    @08,J                                               0424 00807000
         B     @DE00424                                            0424 00808000
@DL00424 DS    0H                                                  0425 00809000
*    EVLETTER(J) = EVCON(J); /*GET NEXT CONSECUTIVE LETTER FOR CPU*/    00810000
         LR    @06,@08                                             0425 00811000
         MH    @06,@CH00081                                        0425 00812000
         L     @03,EVPTR(,R2)                                      0425 00813000
         ALR   @03,@06                                             0425 00814000
         LA    @06,EVCON-1(@08)                                    0425 00815000
         MVC   EVLETTER-6(1,@03),0(@06)                            0425 00816000
*  END;                                                    /*@Z427VLS*/ 00817000
         AL    @08,@CF00055                                        0426 00818000
         ST    @08,J                                               0426 00819000
@DE00424 L     @06,EVPTR(,R2)                                      0426 00820000
         CH    @08,EVNUM(,@06)                                     0426 00821000
         BNH   @DL00424                                            0426 00822000
*TRENPTR = SAVEADR(1); /*SET TRENPTR TO FIRST TABLE IN CHAIN @Z427VLS*/ 00823000
@RF00423 L     @08,SAVEADR                                         0427 00824000
         ST    @08,TRENPTR(,R2)                                    0427 00825000
*END; /*CLOSING END FOR SORTONE                              @Z427VLS*/ 00826000
@EL00005 DS    0H                                                  0428 00827000
@EF00005 DS    0H                                                  0428 00828000
@ER00005 LM    @14,@12,12(@13)                                     0428 00829000
         BR    @14                                                 0428 00830000
*SORTWO: PROC;                                             /*@Z427VLS*/ 00831000
SORTWO   STM   @14,@12,@SA00006                                    0429 00832000
*/*ADJUST POINTERS TO EVTABLE, TRENDCPU,TRENDOLD AS A RESULT OF SORT*/  00833000
*/*OF EVTABLE. MUST DO BEFORE SORTING TREND2                 @Z427VLS*/ 00834000
*  DO J = 1 BY 1 TO PASSNUM;                               /*@Z427VLS*/ 00835000
         LA    @08,1                                               0430 00836000
         ST    @08,J                                               0430 00837000
         B     @DE00430                                            0430 00838000
@DL00430 DS    0H                                                  0431 00839000
*    WORKBYTE = TMTCPUS(J);                                /*@0099VLS*/ 00840000
         LR    @06,@08                                             0431 00841000
         MH    @06,@CH00940                                        0431 00842000
         L     @03,SORTADR(,R2)                                    0431 00843000
         ST    @06,@TF00001                                        0431 00844000
         ALR   @06,@03                                             0431 00845000
         AL    @06,@CF01575                                        0431 00846000
         MVC   WORKBYTE(1),TMTCPUS-3(@06)                          0431 00847000
*    WORKTWO  = WORKBYTE; /*DITTO                            @Z427VLS*/ 00848000
         MVC   WORKTWO(1),WORKBYTE                                 0432 00849000
*    SRL(WORKBYTE,4); /*WORKBYTE,WORKNM NOW SET TO TRENDCPU  @Z427VLS*/ 00850000
         SLR   @06,@06                                             0433 00851000
         IC    @06,WORKBYTE                                        0433 00852000
         SRL   @06,4                                               0433 00853000
         STC   @06,WORKBYTE                                        0433 00854000
*    WORKTWO = (WORKTWO & '0F'X); /*WORKTWO,WORKNM2 NOW TRENDOLD*/ 0434 00855000
         NI    WORKTWO,X'0F'                                       0434 00856000
*    WORKNM2 = WORKNM2 + 1; /*REFERENCE 1ST ENTRY AS 1, NOT 0*/    0435 00857000
         LA    @06,1                                               0435 00858000
         SLR   @00,@00                                             0435 00859000
         IC    @00,WORKNM2                                         0435 00860000
         ALR   @00,@06                                             0435 00861000
         STC   @00,WORKNM2                                         0435 00862000
*    TMTCPUS(J) = FLIPFLOP(WORKNM2);                       /*@0099VLS*/ 00863000
         LR    @15,@03                                             0436 00864000
         AL    @15,@TF00001                                        0436 00865000
         AL    @15,@CF01575                                        0436 00866000
         LR    @14,@00                                             0436 00867000
         LA    @05,FLIPFLOP-1(@14)                                 0436 00868000
         MVC   TMTCPUS-3(1,@15),0(@05)                             0436 00869000
*    WORKNM = WORKNM + 1; /*REFERENCE 1ST ENTRY AS 1, NOT 0  @Z427VLS*/ 00870000
         SLR   @00,@00                                             0437 00871000
         IC    @00,WORKNM                                          0437 00872000
         ALR   @06,@00                                             0437 00873000
         STC   @06,WORKNM                                          0437 00874000
*    WORKTWO = FLIPFLOP(WORKNM);    /*TRENDCPU AFTER SORTING @Z427VLS*/ 00875000
         LA    @15,FLIPFLOP-1(@06)                                 0438 00876000
         MVC   WORKTWO(1),0(@15)                                   0438 00877000
*    SLL(WORKTWO,4); /*SORTED TRENDCPU NOW IN FIRST FOUR BITS*/    0439 00878000
         SLR   @06,@06                                             0439 00879000
         IC    @06,WORKTWO                                         0439 00880000
         SLL   @06,4                                               0439 00881000
         STC   @06,WORKTWO                                         0439 00882000
*    TMTCPUS(J) = (TMTCPUS(J) | WORKTWO);                  /*@0099VLS*/ 00883000
         LR    @06,@03                                             0440 00884000
         AL    @06,@TF00001                                        0440 00885000
         AL    @06,@CF01575                                        0440 00886000
         OC    TMTCPUS-3(1,@06),WORKTWO                            0440 00887000
*    /*FOLLOWING IS A LAST MINUTE MANIPULATION, OCT 13, 1976, TO*/ 0441 00888000
*    /*GET 3705 ERROR TYPE TO FOLLOW TRENDCPU FOR PROPER SORTING*/ 0441 00889000
*    WORKTWO = (TMTCPUS(J) & '0F'X);                       /*@0099VLS*/ 00890000
         LR    @06,@03                                             0441 00891000
         AL    @06,@TF00001                                        0441 00892000
         AL    @06,@CF01575                                        0441 00893000
         MVC   WORKTWO(1),TMTCPUS-3(@06)                           0441 00894000
         NI    WORKTWO,X'0F'                                       0441 00895000
*    TMTCPUS(J) = (TMTCPUS(J) & 'F0'X);                    /*@0099VLS*/ 00896000
         LR    @06,@03                                             0442 00897000
         AL    @06,@TF00001                                        0442 00898000
         AL    @06,@CF01575                                        0442 00899000
         NI    TMTCPUS-3(@06),X'F0'                                0442 00900000
*    TMTITEM(J) = (TMTITEM(J) | WORKTWO);                  /*@0099VLS*/ 00901000
         AL    @03,@TF00001                                        0443 00902000
         AL    @03,@CF01576                                        0443 00903000
         OC    TMTITEM-4(1,@03),WORKTWO                            0443 00904000
*                                           /*PLACE          @Z427VLS*/ 00905000
*  END;                                                    /*@Z427VLS*/ 00906000
         AL    @08,@CF00055                                        0444 00907000
         ST    @08,J                                               0444 00908000
@DE00430 C     @08,PASSNUM                                         0444 00909000
         BNH   @DL00430                                            0444 00910000
*  IF DEBUG23 ^= ON & SORTNUM > 1 THEN /*ONLY SORT IS AT LEAST TWO*/    00911000
         TM    DEBUG23(R2),B'00000001'                             0445 00912000
         BO    @RF00445                                            0445 00913000
         L     @08,SORTNUM(,R2)                                    0445 00914000
         C     @08,@CF00055                                        0445 00915000
         BNH   @RF00445                                            0445 00916000
*  DO;  /*ENTRIES AND DEBUG DOESNT SPECIFY ORIGINAL INPUT ORDER*/  0446 00917000
*/* SORT THAT ONLY EXAMINES AN ENTRY ONCE IF DATA IS IN ORDER*/    0447 00918000
* SRTCONT = ((PASSNUM-1)*14) + SORTADR;                    /*@0099VLS*/ 00919000
         L     @08,PASSNUM                                         0447 00920000
         BCTR  @08,0                                               0447 00921000
         MH    @08,@CH00940                                        0447 00922000
         AL    @08,SORTADR(,R2)                                    0447 00923000
         ST    @08,SRTCONT                                         0447 00924000
*GENERATE REFS(TMT2,TMTKEY);                               /*@0099VLS*/ 00925000
    LA   R15,14                                                         00926000
    L    R3,SORTADR(R2)                                                 00927000
    L    R4,SRTCONT                                                     00928000
    LR   R1,R3                                                          00929000
    B    DOIT                                                           00930000
LOOPBCK1 ALR  R3,R15                                                    00931000
         CR   R3,R4                                                     00932000
         BNL  DONE                                                      00933000
DOIT     CLC  TMTKEY(7,R3),TMTKEY+14(R3)                                00934000
         BNH  LOOPBCK1                                                  00935000
         XC   TMT2(14,R3),TMT2+14(R3)                                   00936000
         XC   TMT2+14(14,R3),TMT2(R3)                                   00937000
         XC   TMT2(14,R3),TMT2+14(R3)                                   00938000
         LR   R6,R3                                                     00939000
LOOPBCK2 SR   R6,R15                                                    00940000
         CR   R6,R1                                                     00941000
         BL   LOOPBCK1                                                  00942000
         CLC  TMTKEY(7,R6),TMTKEY+14(R6)                                00943000
         BNH  LOOPBCK1                                                  00944000
         XC   TMT2+14(14,R6),TMT2(R6)                                   00945000
         XC   TMT2(14,R6),TMT2+14(R6)                                   00946000
         XC   TMT2+14(14,R6),TMT2(R6)                                   00947000
          B      LOOPBCK2            DOES IT NEED TO BE MOVED AGAIN     00948000
DONE      EQU    *                                                      00949000
* END;                                                     /*@Z427VLS*/ 00950000
*END; /*CLOSING END TO PROC SORTWO                           @Z427VLS*/ 00951000
@EL00006 DS    0H                                                  0450 00952000
@EF00006 DS    0H                                                  0450 00953000
@ER00006 LM    @14,@12,@SA00006                                    0450 00954000
         BR    @14                                                 0450 00955000
*CONTMDR: PROC; /*COUNT TEMPORARY ERRORS AND INDICATE PERMANENT */ 0451 00956000
CONTMDR  STM   @14,@12,@SA00007                                    0451 00957000
*               /*ERROR IF RECORD REPRESENTS SUCH.           @Z427VLS*/ 00958000
*BUG(4) = BUG(4) + 1; /*COUNT NUMBER OF MDR 91, 3705 RECORDS @Z427VLS*/ 00959000
         LA    @08,1                                               0452 00960000
         AL    @08,BUG+12                                          0452 00961000
         ST    @08,BUG+12                                          0452 00962000
*IF TPRMODE = LINSTAT0 THEN                                        0453 00963000
         CLI   TPRMODE(R7),X'00'                                   0453 00964000
         BNE   @RF00453                                            0453 00965000
*  DO;                                                     /*@Z427VLS*/ 00966000
*    TRENDTMP  = TRENDTMP  + ERRCT1;                   /*@Z427VLS*/     00967000
         ICM   @08,15,TRENDTMP                                     0455 00968000
         SLR   @06,@06                                             0455 00969000
         IC    @06,ERRCT1(,R7)                                     0455 00970000
         ALR   @08,@06                                             0455 00971000
         STCM  @08,15,TRENDTMP                                     0455 00972000
*    TRENDPRM  = ON; /*RECORD REPRESENTS ONE PERMANENT ERROR @0099VLS*/ 00973000
         OI    TRENDPRM,B'00000001'                                0456 00974000
*  END;                                                    /*@Z427VLS*/ 00975000
*ELSE                                                              0458 00976000
*  DO;                                                     /*@Z427VLS*/ 00977000
         B     @RC00453                                            0458 00978000
@RF00453 DS    0H                                                  0459 00979000
*    IF TPRMODE = LINSTAT1 THEN                                    0459 00980000
         CLI   TPRMODE(R7),X'01'                                   0459 00981000
         BNE   @RF00459                                            0459 00982000
*      TRENDTMP = ERRCT1;                                  /*@VS48722*/ 00983000
         SLR   @08,@08                                             0460 00984000
         IC    @08,ERRCT1(,R7)                                     0460 00985000
         STCM  @08,15,TRENDTMP                                     0460 00986000
*  ELSE                                                            0461 00987000
*    DO;                                                   /*@Z427VLS*/ 00988000
         B     @RC00459                                            0461 00989000
@RF00459 DS    0H                                                  0462 00990000
*      IF TPRMODE = CHANADAP | /*CHANNEL ADAPTER ERROR       @Z427VLS*/ 00991000
*         TPRMODE = COMSCAN  | /*COMMUNICATION SCANNER ERROR @Z427VLS*/ 00992000
*         TPRMODE = IOERROR  | /*I/O INSTRUCTION EXCEPTION   @Z427VLS*/ 00993000
*         TPRMODE = UNRESOLV | /*UNRESOLVED PROGRAM LEVEL ONE */   0462 00994000
*                              /*INTERRUPT                   @Z427VLS*/ 00995000
*         TPRMODE = LINKERR THEN  /* LINK ERROR              @Z427VLS*/ 00996000
         CLI   TPRMODE(R7),X'10'                                   0462 00997000
         BE    @RT00462                                            0462 00998000
         CLI   TPRMODE(R7),X'11'                                   0462 00999000
         BE    @RT00462                                            0462 01000000
         CLI   TPRMODE(R7),X'12'                                   0462 01001000
         BE    @RT00462                                            0462 01002000
         CLI   TPRMODE(R7),X'13'                                   0462 01003000
         BE    @RT00462                                            0462 01004000
         CLI   TPRMODE(R7),X'02'                                   0462 01005000
         BNE   @RF00462                                            0462 01006000
@RT00462 DS    0H                                                  0463 01007000
*           TRENDPRM  = ON;                              /*@Z427VLS*/   01008000
         OI    TRENDPRM,B'00000001'                                0463 01009000
*      ELSE                                                        0464 01010000
*      DO;                                                 /*@Z427VLS*/ 01011000
         B     @RC00462                                            0464 01012000
@RF00462 DS    0H                                                  0465 01013000
*      IF TPRMODE = LINSTAT3 THEN /*IF MODE IS 03            @Z427VLS*/ 01014000
         CLI   TPRMODE(R7),X'03'                                   0465 01015000
         BNE   @RF00465                                            0465 01016000
*         DO;                                              /*@Z427VLS*/ 01017000
*           TRENDTMP  = TRENDTMP  + ERRCT1;            /*@Z427VLS*/     01018000
         ICM   @08,15,TRENDTMP                                     0467 01019000
         SLR   @06,@06                                             0467 01020000
         IC    @06,ERRCT1(,R7)                                     0467 01021000
         ALR   @08,@06                                             0467 01022000
         STCM  @08,15,TRENDTMP                                     0467 01023000
*           TRENDPRM  = ON;                              /*@Z427VLS*/   01024000
         OI    TRENDPRM,B'00000001'                                0468 01025000
*         END;                                             /*@Z427VLS*/ 01026000
*       END;                                               /*@Z427VLS*/ 01027000
@RF00465 DS    0H                                                  0471 01028000
*       END;                                               /*@Z427VLS*/ 01029000
@RC00462 DS    0H                                                  0472 01030000
*    END;                                                  /*@Z427VLS*/ 01031000
@RC00459 DS    0H                                                  0473 01032000
*IF TRENDPRM  = ON | TRENDTMP  > ZERO THEN                         0473 01033000
@RC00453 TM    TRENDPRM,B'00000001'                                0473 01034000
         BO    @RT00473                                            0473 01035000
         ICM   @08,15,TRENDTMP                                     0473 01036000
         BNP   @RF00473                                            0473 01037000
@RT00473 DS    0H                                                  0474 01038000
*  DO;                                                     /*@Z427VLS*/ 01039000
*    BUG(5) = BUG(5) + 1; /*MDRS SAVED IN TREND2             @Z427VLS*/ 01040000
         LA    @08,1                                               0475 01041000
         L     @06,BUG+16                                          0475 01042000
         ALR   @06,@08                                             0475 01043000
         ST    @06,BUG+16                                          0475 01044000
*    BUG(13) = BUG(13) + 1; /*DEVICE GROUP FIVE COUNT        @Z427VLS*/ 01045000
         AL    @08,BUG+48                                          0476 01046000
         ST    @08,BUG+48                                          0476 01047000
*    TRENDGRP  = FIVE; /*SET GROUP TO TP CNTRL             @Z427VLS*/   01048000
         MVI   TRENDGRP,X'05'                                      0477 01049000
*    WORKCUA  = (TPRCUA & ONLYCUA2);                       /*@Z427VLS*/ 01050000
         MVC   WORKCUA(2),TPRCUA(R7)                               0478 01051000
         NC    WORKCUA(2),@CB00910                                 0478 01052000
*    TRENDRT  = (TPRCUA & ONLYCUA2);                     /*@Z427VLS*/   01053000
         MVC   TRENDRT(2),TPRCUA(R7)                               0479 01054000
         NC    TRENDRT(2),@CB00910                                 0479 01055000
*    /*TRENDCUA IS 4 BITS TOO FAR TO THE RIGHT FOR NOW       @Z427VLS*/ 01056000
*    TRENDDEV  = '3705'X;                                /*@Z427VLS*/   01057000
         MVC   TRENDDEV(2),@CB01393                                0480 01058000
*    CALL SETCPU;                                          /*@Z427VLS*/ 01059000
         BAL   @14,SETCPU                                          0481 01060000
*    CALL SET3705;                                         /*@Z427VLS*/ 01061000
         BAL   @14,SET3705                                         0482 01062000
*    TRENDDAT  = TREIDX; /*SET RELATIVE DATE FOR SORTING   @Z427VLS*/   01063000
         IC    @08,TREIDX                                          0483 01064000
         STC   @08,TRENDDAT                                        0483 01065000
*  END;                                                    /*@Z427VLS*/ 01066000
*END; /*END FOR PROC COUNTMDR                                @Z427VLS*/ 01067000
@EL00007 DS    0H                                                  0485 01068000
@EF00007 DS    0H                                                  0485 01069000
@ER00007 LM    @14,@12,@SA00007                                    0485 01070000
         BR    @14                                                 0485 01071000
*COUNTOBR:PROC; /*IDENTIFY AND SUM PERMANENT AND TEMPORARY ERRORS*/     01072000
COUNTOBR STM   @14,@12,@SA00008                                    0486 01073000
*               /*FROM OBR RECORDS IN TREND2                 @Z427VLS*/ 01074000
*BUG(7) = BUG(7) + 1; /*OBR RECORDS PASSED FILTERING         @Z427VLS*/ 01075000
         LA    @08,1                                               0487 01076000
         AL    @08,BUG+24                                          0487 01077000
         ST    @08,BUG+24                                          0487 01078000
*IF WORKDEV = DEV3410 |                                            0488 01079000
*   WORKDEV = DEV3420 |                                            0488 01080000
*   WORKDEV = DEV34XX THEN                                         0488 01081000
         CLC   WORKDEV(2),@CB00884                                 0488 01082000
         BE    @RT00488                                            0488 01083000
         CLC   WORKDEV(2),@CB00886                                 0488 01084000
         BE    @RT00488                                            0488 01085000
         CLC   WORKDEV(2),@CB00888                                 0488 01086000
         BNE   @RF00488                                            0488 01087000
@RT00488 DS    0H                                                  0489 01088000
*  CALL CHECK34X; /*IF 34XX TAPE THEN USE ANOTHER ALGORITHM  @Z427VLS*/ 01089000
         BAL   @14,CHECK34X                                        0489 01090000
*ELSE /*IF NON 34XX DEVICE RECORD                            @Z427VLS*/ 01091000
*   DO;                                                    /*@Z427VLS*/ 01092000
         B     @RC00488                                            0490 01093000
@RF00488 DS    0H                                                  0491 01094000
*     IF WORKDEV = DEV3330 |                                       0491 01095000
*        WORKDEV = DEV3340 |                                       0491 01096000
*        WORKDEV = DEV3350 |                                       0491 01097000
*        WORKDEV = DEV33301 |                                      0491 01098000
*        WORKDEV = DEV23051 |                                      0491 01099000
*        WORKDEV = DEV23052 THEN                                   0491 01100000
         CLC   WORKDEV(2),@CB00968                                 0491 01101000
         BE    @RT00491                                            0491 01102000
         CLC   WORKDEV(2),@CB00970                                 0491 01103000
         BE    @RT00491                                            0491 01104000
         CLC   WORKDEV(2),@CB00972                                 0491 01105000
         BE    @RT00491                                            0491 01106000
         CLC   WORKDEV(2),@CB00974                                 0491 01107000
         BE    @RT00491                                            0491 01108000
         CLC   WORKDEV(2),@CB00964                                 0491 01109000
         BE    @RT00491                                            0491 01110000
         CLC   WORKDEV(2),@CB00966                                 0491 01111000
         BNE   @RF00491                                            0491 01112000
@RT00491 DS    0H                                                  0492 01113000
*       CALL CHECK33X;                                     /*@Z427VLS*/ 01114000
         BAL   @14,CHECK33X                                        0492 01115000
*     ELSE                                                         0493 01116000
*       DO;                                                /*@Z427VLS*/ 01117000
         B     @RC00491                                            0493 01118000
@RF00491 DS    0H                                                  0494 01119000
*         IF SHORTSW = YES THEN                                    0494 01120000
         TM    SHORTSW(R7),B'00100000'                             0494 01121000
         BNO   @RF00494                                            0494 01122000
*           DO;                                            /*@Z427VLS*/ 01123000
*             IF OBRSSDRC > ZERO THEN /*IF STAT COUNTERS EXIST*/   0496 01124000
         CLI   OBRSSDRC(R7),0                                      0496 01125000
         BNH   @RF00496                                            0496 01126000
*               DO;                                        /*@Z427VLS*/ 01127000
*                 ERRNUM = NULLIT; /*CLEAR WORK AREA TO ZERO @Z427VLS*/ 01128000
         MVI   ERRNUM,X'00'                                        0498 01129000
*                 ERRPLACE = (ERRPLACE | OBRSRDS); /*GET R,R ERRORS*/   01130000
         OC    ERRPLACE(1),OBRSRDS(R7)                             0499 01131000
*                 SRL(ERRPLACE,4); /*SHIFT OUT WRITE ERRORS  @Z427VLS*/ 01132000
         SLR   @08,@08                                             0500 01133000
         IC    @08,ERRPLACE                                        0500 01134000
         SRL   @08,4                                               0500 01135000
         STC   @08,ERRPLACE                                        0500 01136000
*                 TRENDTMP  = TRENDTMP  + ERRNUM;      /*@Z427VLS*/     01137000
         ICM   @08,15,TRENDTMP                                     0501 01138000
         SLR   @06,@06                                             0501 01139000
         IC    @06,ERRNUM                                          0501 01140000
         ALR   @08,@06                                             0501 01141000
         STCM  @08,15,TRENDTMP                                     0501 01142000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01143000
         MVI   ERRNUM,X'00'                                        0502 01144000
*                 ERRPLACE = OBRSRDS; /*GET BOTH READ AND WRITE*/  0503 01145000
         MVC   ERRPLACE(1),OBRSRDS(R7)                             0503 01146000
*                 ERRPLACE = (ERRPLACE & NOREAD); /*REMOVE READS*/ 0504 01147000
         NI    ERRPLACE,X'0F'                                      0504 01148000
*                 TRENDTMP  = TRENDTMP  + ERRNUM;      /*@Z427VLS*/     01149000
         SLR   @06,@06                                             0505 01150000
         IC    @06,ERRNUM                                          0505 01151000
         ALR   @08,@06                                             0505 01152000
         STCM  @08,15,TRENDTMP                                     0505 01153000
*               END;                                       /*@Z427VLS*/ 01154000
*           END;                                           /*@Z427VLS*/ 01155000
*         ELSE /*LONG OBR BY DEFAULT                         @Z427VLS*/ 01156000
*           DO;                                            /*@Z427VLS*/ 01157000
         B     @RC00494                                            0508 01158000
@RF00494 DS    0H                                                  0509 01159000
*             IF DISMOUNT = ON | /*IF A DISMOUNT RECORD WITH STAT DTA*/ 01160000
*                SDRCOUNT = ON | /*SDR COUNTER DUMPED AT EOD @Z427VLS*/ 01161000
*                OBRTEMP = ON THEN /*OBR TEMPORARY ERROR FLAG ON     */ 01162000
         TM    DISMOUNT(R7),B'11000100'                            0509 01163000
         BZ    @RF00509                                            0509 01164000
*              DO;                     /*                    @XA21207*/ 01165000
*              IF OBRLSDRC > ZERO THEN /*IF STAT CNTRS EXIST @XA21207*/ 01166000
         CLI   OBRLSDRC(R7),0                                      0511 01167000
         BNH   @RF00511                                            0511 01168000
*               DO;                                        /*@Z427VLS*/ 01169000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01170000
         MVI   ERRNUM,X'00'                                        0513 01171000
*                 ERRPLACE = (ERRPLACE | OBRLSDR); /*GET LNG R,R ERR*/  01172000
         LA    @08,64                                              0514 01173000
         ALR   @08,R7                                              0514 01174000
         SLR   @06,@06                                             0514 01175000
         IC    @06,OBRDEVDC(,R7)                                   0514 01176000
         SLA   @06,3                                               0514 01177000
         ALR   @08,@06                                             0514 01178000
         OC    ERRPLACE(1),OBRLSDR(@08)                            0514 01179000
*                 SRL(ERRPLACE,4); /*SHIFT TO ACCESS AS NUMERIC*/  0515 01180000
         SLR   @06,@06                                             0515 01181000
         IC    @06,ERRPLACE                                        0515 01182000
         SRL   @06,4                                               0515 01183000
         STC   @06,ERRPLACE                                        0515 01184000
*                 TRENDTMP  = TRENDTMP  + ERRNUM;      /*@Z427VLS*/     01185000
         ICM   @06,15,TRENDTMP                                     0516 01186000
         SLR   @03,@03                                             0516 01187000
         IC    @03,ERRNUM                                          0516 01188000
         ALR   @06,@03                                             0516 01189000
         STCM  @06,15,TRENDTMP                                     0516 01190000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01191000
         MVI   ERRNUM,X'00'                                        0517 01192000
*                 ERRPLACE = OBRLSDR; /*GET READ, WRITE ERRORS*/   0518 01193000
         MVC   ERRPLACE(1),OBRLSDR(@08)                            0518 01194000
*                 ERRPLACE = (ERRPLACE & NOREAD); /*ELIM READ ERRORS*/  01195000
         NI    ERRPLACE,X'0F'                                      0519 01196000
*                 TRENDTMP  = TRENDTMP  + ERRNUM;      /*@Z427VLS*/     01197000
         SLR   @08,@08                                             0520 01198000
         IC    @08,ERRNUM                                          0520 01199000
         ALR   @06,@08                                             0520 01200000
         STCM  @06,15,TRENDTMP                                     0520 01201000
*               END;                                       /*@Z427VLS*/ 01202000
*              END;                    /*                    @XA21207*/ 01203000
*             ELSE /*CONTINUE CHECKING TO FIND PERM ERRORS   @Z427VLS*/ 01204000
*               DO;                                        /*@Z427VLS*/ 01205000
         B     @RC00509                                            0523 01206000
@RF00509 DS    0H                                                  0524 01207000
*                 IF OBRSENS0 ^= '40'X THEN   /* IF NOT INTERV. REQ  */ 01208000
         LA    @08,64                                              0524 01209000
         ALR   @08,R7                                              0524 01210000
         SLR   @06,@06                                             0524 01211000
         IC    @06,OBRDEVDC(,R7)                                   0524 01212000
         SLA   @06,3                                               0524 01213000
         ALR   @08,@06                                             0524 01214000
         SLR   @06,@06                                             0524 01215000
         IC    @06,OBRLSDRC(,R7)                                   0524 01216000
         ALR   @08,@06                                             0524 01217000
         CLI   OBRSENS0(@08),X'40'                                 0524 01218000
         BE    @RF00524                                            0524 01219000
*                   TRENDPRM  = ON;                      /*@Z427VLS*/   01220000
         OI    TRENDPRM,B'00000001'                                0525 01221000
*               END;                                       /*@Z427VLS*/ 01222000
@RF00524 DS    0H                                                  0527 01223000
*            END;                                          /*@Z427VLS*/ 01224000
@RC00509 DS    0H                                                  0528 01225000
*         END;                                             /*@Z427VLS*/ 01226000
@RC00494 DS    0H                                                  0529 01227000
*       END;                                               /*@Z427VLS*/ 01228000
@RC00491 DS    0H                                                  0530 01229000
*    IF TRENDPRM  = ON | TRENDTMP  > ZERO THEN                     0530 01230000
@RC00488 TM    TRENDPRM,B'00000001'                                0530 01231000
         BO    @RT00530                                            0530 01232000
         ICM   @08,15,TRENDTMP                                     0530 01233000
         BNP   @RF00530                                            0530 01234000
@RT00530 DS    0H                                                  0531 01235000
*      DO;                                                 /*@Z427VLS*/ 01236000
*        BUG(8) = BUG(8) + 1; /*OBRS STORED IN TREND2        @Z427VLS*/ 01237000
         LA    @08,1                                               0532 01238000
         AL    @08,BUG+28                                          0532 01239000
         ST    @08,BUG+28                                          0532 01240000
*        CALL GROUPASN;                                    /*@Z427VLS*/ 01241000
         BAL   @14,GROUPASN                                        0533 01242000
*        TRENDRT  = WORKCUA; /*CUA IS 4 BITS RIGHT OF CORRECT POS*/     01243000
         MVC   TRENDRT(2),WORKCUA                                  0534 01244000
*      LINKDEV = (LINKDEV && LINKDEV); /*CLEAR ITEM FROM LAST VALUE*/   01245000
         XC    LINKDEV(4),LINKDEV                                  0535 01246000
*      CALL IFCDEVIC(4,WORKDEV,LINKDEV); /*GET DEVICE LABEL  @G51DGBB*/ 01247000
         L     @15,@CV01403                                        0536 01248000
         LA    @01,@AL00536                                        0536 01249000
         BALR  @14,@15                                             0536 01250000
*       TRENDDEV = DEVLABEL;  /* SET TREND2 ENTRY WITH DEVICE LABEL */  01251000
         MVC   TRENDDEV(2),DEVLABEL                                0537 01252000
*        CALL SETCPU;                                      /*@Z427VLS*/ 01253000
         BAL   @14,SETCPU                                          0538 01254000
*        TRENDDAT  = TREIDX; /*SET RELATIVE DATE FOR SORTING @0099VLS*/ 01255000
         IC    @08,TREIDX                                          0539 01256000
         STC   @08,TRENDDAT                                        0539 01257000
*      END;                                                /*@Z427VLS*/ 01258000
*  END; /*CLOSING END FOR PROC COUNTOBR                      @Z427VLS*/ 01259000
@EL00008 DS    0H                                                  0541 01260000
@EF00008 DS    0H                                                  0541 01261000
@ER00008 LM    @14,@12,@SA00008                                    0541 01262000
         BR    @14                                                 0541 01263000
*CHECK34X: PROC; /*FIND PERM, TEMP ERRORS IN 34XX DEVICES    @Z427VLS*/ 01264000
CHECK34X STM   @14,@12,12(@13)                                     0542 01265000
*     BUG(38) = BUG(38) + 1;                               /*@Z427VLS*/ 01266000
         LA    @08,1                                               0543 01267000
         AL    @08,BUG+148                                         0543 01268000
         ST    @08,BUG+148                                         0543 01269000
*     IF SHORTSW = NO THEN                                         0544 01270000
         TM    SHORTSW(R7),B'00100000'                             0544 01271000
         BNZ   @RF00544                                            0544 01272000
*       DO;                                                /*@Z427VLS*/ 01273000
*         IF DISMOUNT = ON | SDRCOUNT = ON THEN /*IF IS EITHER A */     01274000
         TM    DISMOUNT(R7),B'10000100'                            0546 01275000
         BZ    @RF00546                                            0546 01276000
*           TRENDTMP  = TRENDTMP  + OBR34CT1 + OBR34CT2;   /*@0099VLS*/ 01277000
         ICM   @08,15,TRENDTMP                                     0547 01278000
         SLR   @06,@06                                             0547 01279000
         IC    @06,OBR34CT1(,R7)                                   0547 01280000
         ALR   @08,@06                                             0547 01281000
         SLR   @06,@06                                             0547 01282000
         IC    @06,OBR34CT2(,R7)                                   0547 01283000
         ALR   @08,@06                                             0547 01284000
         STCM  @08,15,TRENDTMP                                     0547 01285000
*         ELSE /*PERM ERROR BY DEFAULT                       @Z427VLS*/ 01286000
*          IF OBRTEMP = OFF THEN /*TEMP GARBAGE RECORDS MAY EXIST*/     01287000
         B     @RC00546                                            0548 01288000
@RF00546 TM    OBRTEMP(R7),B'01000000'                             0548 01289000
         BNZ   @RF00548                                            0548 01290000
*           TRENDPRM  = ON;                              /*@Z427VLS*/   01291000
         OI    TRENDPRM,B'00000001'                                0549 01292000
*        END;                                              /*@Z427VLS*/ 01293000
@RF00548 DS    0H                                                  0550 01294000
@RC00546 DS    0H                                                  0551 01295000
*      IF TRENDTMP  = 1 | TRENDPRM  = ON THEN                      0551 01296000
@RF00544 CLC   TRENDTMP(4),@CF00055                                0551 01297000
         BE    @RT00551                                            0551 01298000
         TM    TRENDPRM,B'00000001'                                0551 01299000
         BNO   @RF00551                                            0551 01300000
@RT00551 DS    0H                                                  0552 01301000
*        BUG(39) = BUG(39) + 1;                            /*@Z427VLS*/ 01302000
         LA    @08,1                                               0552 01303000
         AL    @08,BUG+152                                         0552 01304000
         ST    @08,BUG+152                                         0552 01305000
*END; /*CLOSING END TO CHECK34X                              @Z427VLS*/ 01306000
@EL00009 DS    0H                                                  0553 01307000
@EF00009 DS    0H                                                  0553 01308000
@ER00009 LM    @14,@12,12(@13)                                     0553 01309000
         BR    @14                                                 0553 01310000
*CHECK33X: PROC;                                           /*@Z427VLS*/ 01311000
CHECK33X STM   @14,@12,12(@13)                                     0554 01312000
*BUG(36) = BUG(36) + 1;                                    /*@Z427VLS*/ 01313000
         LA    @08,1                                               0555 01314000
         AL    @08,BUG+140                                         0555 01315000
         ST    @08,BUG+140                                         0555 01316000
*IF (OBRSENS1 & PERMBIT) = PERMBIT THEN                            0556 01317000
         LA    @08,64                                              0556 01318000
         ALR   @08,R7                                              0556 01319000
         SLR   @06,@06                                             0556 01320000
         IC    @06,OBRDEVDC(,R7)                                   0556 01321000
         SLA   @06,3                                               0556 01322000
         ALR   @08,@06                                             0556 01323000
         SLR   @06,@06                                             0556 01324000
         IC    @06,OBRLSDRC(,R7)                                   0556 01325000
         ALR   @08,@06                                             0556 01326000
         MVC   @TS00001(1),OBRSENS1(@08)                           0556 01327000
         NI    @TS00001,B'10000000'                                0556 01328000
         CLI   @TS00001,B'10000000'                                0556 01329000
         BNE   @RF00556                                            0556 01330000
*  TRENDPRM  = ON;                                       /*@Z427VLS*/   01331000
         OI    TRENDPRM,B'00000001'                                0557 01332000
*ELSE                                                              0558 01333000
*  DO;                                                     /*@Z427VLS*/ 01334000
         B     @RC00556                                            0558 01335000
@RF00556 DS    0H                                                  0559 01336000
*    IF OBRTEMP = ON THEN                                          0559 01337000
         TM    OBRTEMP(R7),B'01000000'                             0559 01338000
         BNO   @RF00559                                            0559 01339000
*      TRENDTMP  = TRENDTMP  + 1;                      /*@Z427VLS*/     01340000
         LA    @08,1                                               0560 01341000
         ICM   @06,15,TRENDTMP                                     0560 01342000
         ALR   @08,@06                                             0560 01343000
         STCM  @08,15,TRENDTMP                                     0560 01344000
*    ELSE                                                          0561 01345000
*      TRENDPRM  = ON;                                   /*@Z427VLS*/   01346000
         B     @RC00559                                            0561 01347000
@RF00559 OI    TRENDPRM,B'00000001'                                0561 01348000
*   END;                                                   /*@Z427VLS*/ 01349000
@RC00559 DS    0H                                                  0563 01350000
*IF TRENDTMP  = 1 | TRENDPRM  = ON THEN                            0563 01351000
@RC00556 CLC   TRENDTMP(4),@CF00055                                0563 01352000
         BE    @RT00563                                            0563 01353000
         TM    TRENDPRM,B'00000001'                                0563 01354000
         BNO   @RF00563                                            0563 01355000
@RT00563 DS    0H                                                  0564 01356000
*  BUG(37) = BUG(37) + 1;                                  /*@Z427VLS*/ 01357000
         LA    @08,1                                               0564 01358000
         AL    @08,BUG+144                                         0564 01359000
         ST    @08,BUG+144                                         0564 01360000
*END; /*CLOSING END TO CHECK33X                              @Z427VLS*/ 01361000
@EL00010 DS    0H                                                  0565 01362000
@EF00010 DS    0H                                                  0565 01363000
@ER00010 LM    @14,@12,12(@13)                                     0565 01364000
         BR    @14                                                 0565 01365000
*GROUPASN: PROC; /*DETERMINE DEVICE GROUP FOR TREND REPORT   @Z427VLS*/ 01366000
GROUPASN STM   @14,@12,12(@13)                                     0566 01367000
*                /*SET TRENDGRP IN TABLE TREND2 TO THE ENTRY NUMBER*/   01368000
*                /*IN TABLE DEVGROUP RELATING TO THIS DEVICE GROUP*/    01369000
*IF (WORKDEV1 = HEX08 & WORKDEV2 ^= HEX42) |                       0567 01370000
*   WORKDEV  = HEX100C |                                           0567 01371000
*   WORKDEV  = HEX1008 THEN                                        0567 01372000
         CLI   WORKDEV1,X'08'                                      0567 01373000
         BNE   @GL00024                                            0567 01374000
         CLI   WORKDEV2,X'42'                                      0567 01375000
         BNE   @RT00567                                            0567 01376000
@GL00024 CLC   WORKDEV(2),@CB00890                                 0567 01377000
         BE    @RT00567                                            0567 01378000
         CLC   WORKDEV(2),@CB00892                                 0567 01379000
         BNE   @RF00567                                            0567 01380000
@RT00567 DS    0H                                                  0568 01381000
*  DO;                                                     /*@Z427VLS*/ 01382000
*    BUG(9) = BUG(9) + 1;                                  /*@Z427VLS*/ 01383000
         LA    @08,1                                               0569 01384000
         AL    @08,BUG+32                                          0569 01385000
         ST    @08,BUG+32                                          0569 01386000
*    TRENDGRP  = ONE;  /*CONSOLE AND UNIT RECORD GROUP     @Z427VLS*/   01387000
         MVI   TRENDGRP,X'01'                                      0570 01388000
*  END;                                                    /*@Z427VLS*/ 01389000
*ELSE                                                              0572 01390000
*  DO;                                                     /*@Z427VLS*/ 01391000
         B     @RC00567                                            0572 01392000
@RF00567 DS    0H                                                  0573 01393000
*    IF WORKDEV1 = HEX10 THEN                                      0573 01394000
         CLI   WORKDEV1,X'10'                                      0573 01395000
         BNE   @RF00573                                            0573 01396000
*      DO;                                                 /*@Z427VLS*/ 01397000
*        TRENDGRP  = FOUR;                               /*@Z427VLS*/   01398000
         MVI   TRENDGRP,X'04'                                      0575 01399000
*        BUG(12) = BUG(12) + 1;                            /*@Z427VLS*/ 01400000
         LA    @08,1                                               0576 01401000
         AL    @08,BUG+44                                          0576 01402000
         ST    @08,BUG+44                                          0576 01403000
*      END;                                                /*@Z427VLS*/ 01404000
*    ELSE                                                          0578 01405000
*      DO;                                                 /*@Z427VLS*/ 01406000
         B     @RC00573                                            0578 01407000
@RF00573 DS    0H                                                  0579 01408000
*        IF WORKDEV1 = HEX20 |                                     0579 01409000
*           WORKDEV = HEX0842 THEN                                 0579 01410000
         CLI   WORKDEV1,X'20'                                      0579 01411000
         BE    @RT00579                                            0579 01412000
         CLC   WORKDEV(2),@CB00894                                 0579 01413000
         BNE   @RF00579                                            0579 01414000
@RT00579 DS    0H                                                  0580 01415000
*          DO;                                             /*@Z427VLS*/ 01416000
*            TRENDGRP  = TWO;                            /*@Z427VLS*/   01417000
         MVI   TRENDGRP,X'02'                                      0581 01418000
*            BUG(10) = BUG(10) + 1;                        /*@Z427VLS*/ 01419000
         LA    @08,1                                               0582 01420000
         AL    @08,BUG+36                                          0582 01421000
         ST    @08,BUG+36                                          0582 01422000
*          END;                                            /*@Z427VLS*/ 01423000
*        ELSE                                                      0584 01424000
*         DO;                                              /*@Z427VLS*/ 01425000
         B     @RC00579                                            0584 01426000
@RF00579 DS    0H                                                  0585 01427000
*           IF WORKDEV1 = HEX40 THEN                               0585 01428000
         CLI   WORKDEV1,X'40'                                      0585 01429000
         BNE   @RF00585                                            0585 01430000
*             DO;                                          /*@Z427VLS*/ 01431000
*               TRENDGRP  = FIVE;                        /*@Z427VLS*/   01432000
         MVI   TRENDGRP,X'05'                                      0587 01433000
*               BUG(13) = BUG(13) + 1;                     /*@Z427VLS*/ 01434000
         LA    @08,1                                               0588 01435000
         AL    @08,BUG+48                                          0588 01436000
         ST    @08,BUG+48                                          0588 01437000
*             END;                                         /*@Z427VLS*/ 01438000
*           ELSE                                                   0590 01439000
*             DO;                                          /*@Z427VLS*/ 01440000
         B     @RC00585                                            0590 01441000
@RF00585 DS    0H                                                  0591 01442000
*               IF WORKDEV1 = HEX42 |                              0591 01443000
*                  WORKDEV1 = HEX44 THEN                           0591 01444000
         CLI   WORKDEV1,X'42'                                      0591 01445000
         BE    @RT00591                                            0591 01446000
         CLI   WORKDEV1,X'44'                                      0591 01447000
         BNE   @RF00591                                            0591 01448000
@RT00591 DS    0H                                                  0592 01449000
*                 DO;                                      /*@Z427VLS*/ 01450000
*                   TRENDGRP  = SIX;                     /*@Z427VLS*/   01451000
         MVI   TRENDGRP,X'06'                                      0593 01452000
*                   BUG(14) = BUG(14) + 1;                 /*@Z427VLS*/ 01453000
         LA    @08,1                                               0594 01454000
         AL    @08,BUG+52                                          0594 01455000
         ST    @08,BUG+52                                          0594 01456000
*                 END;                                     /*@Z427VLS*/ 01457000
*               ELSE                                               0596 01458000
*                 DO;                                      /*@Z427VLS*/ 01459000
         B     @RC00591                                            0596 01460000
@RF00591 DS    0H                                                  0597 01461000
*                   IF WORKDEV1 = HEX80 THEN                       0597 01462000
         CLI   WORKDEV1,X'80'                                      0597 01463000
         BNE   @RF00597                                            0597 01464000
*                     DO;                                  /*@Z427VLS*/ 01465000
*                       TRENDGRP  = THREE;               /*@Z427VLS*/   01466000
         MVI   TRENDGRP,X'03'                                      0599 01467000
*                       BUG(11) = BUG(11) + 1;             /*@Z427VLS*/ 01468000
         LA    @08,1                                               0600 01469000
         AL    @08,BUG+40                                          0600 01470000
         ST    @08,BUG+40                                          0600 01471000
*                     END;                                 /*@Z427VLS*/ 01472000
*                 END;                                     /*@Z427VLS*/ 01473000
*             END;                                         /*@Z427VLS*/ 01474000
*          END;                                            /*@Z427VLS*/ 01475000
*      END;                                                /*@Z427VLS*/ 01476000
*     END;                                                 /*@Z427VLS*/ 01477000
*    END; /*CLOSING END TO GROUPASN PROC                     @Z427VLS*/ 01478000
@EL00011 DS    0H                                                  0607 01479000
@EF00011 DS    0H                                                  0607 01480000
@ER00011 LM    @14,@12,12(@13)                                     0607 01481000
         BR    @14                                                 0607 01482000
*SET3705: PROC;                                            /*@Z427VLS*/ 01483000
SET3705  STM   @14,@12,12(@13)                                     0608 01484000
*  IF TPRMODE = LINKERR |                                          0609 01485000
*     TPRMODE = LINSTAT1 |                                         0609 01486000
*     TPRMODE = LINSTAT0 |                                         0609 01487000
*     TPRMODE = LINSTAT3 THEN                                      0609 01488000
         CLI   TPRMODE(R7),X'02'                                   0609 01489000
         BE    @RT00609                                            0609 01490000
         CLI   TPRMODE(R7),X'01'                                   0609 01491000
         BE    @RT00609                                            0609 01492000
         CLI   TPRMODE(R7),X'00'                                   0609 01493000
         BE    @RT00609                                            0609 01494000
         CLI   TPRMODE(R7),X'03'                                   0609 01495000
         BNE   @RF00609                                            0609 01496000
@RT00609 DS    0H                                                  0610 01497000
*    TRENDITM = (TRENDITM |   '20'X);                  /*@Z427VLS*/     01498000
         OI    TRENDITM,X'20'                                      0610 01499000
*  ELSE IF TPRMODE = IOERROR |                                     0611 01500000
*          TPRMODE = UNRESOLV THEN                                 0611 01501000
         B     @RC00609                                            0611 01502000
@RF00609 CLI   TPRMODE(R7),X'12'                                   0611 01503000
         BE    @RT00611                                            0611 01504000
         CLI   TPRMODE(R7),X'13'                                   0611 01505000
         BNE   @RF00611                                            0611 01506000
@RT00611 DS    0H                                                  0612 01507000
*          TRENDITM = (TRENDITM |   '10'X);            /*@Z427VLS*/     01508000
         OI    TRENDITM,X'10'                                      0612 01509000
*  /*IF TPRMODE IS EQUAL TO DEFAULT OF COMSCAN OR CHANADAP ERRORS*/     01510000
*  /*TREN37 NEED NOT BE SET AS ITS CORRECT VALUE IS ZERO. TRENDRT */    01511000
*  /*IS SET HERE AS THE STUPID COMPILER WILL NOT ACCESS TREN37*/   0613 01512000
*END;                                                      /*@Z427VLS*/ 01513000
@EL00012 DS    0H                                                  0613 01514000
@EF00012 DS    0H                                                  0613 01515000
@ER00012 LM    @14,@12,12(@13)                                     0613 01516000
         BR    @14                                                 0613 01517000
*SETCPU: PROC;                                             /*@Z427VLS*/ 01518000
SETCPU   STM   @14,@12,@SA00013                                    0614 01519000
*/* SET NEW AND OLD CPUS IN TREND2. IF SHARED IO, ADJUST TRENCPU AND*/  01520000
*/*AND TRENCUA TO THE RESPECTIVE BASE ITEMS.                 @Z427VLS*/ 01521000
*CALL TREADR;   /*CREATE EVTABLE, TRENDONE ENTRIES IF UNIQUE CPU    */  01522000
         BAL   @14,TREADR                                          0615 01523000
*MISSW = OFF;                                              /*@Z427VLS*/ 01524000
         NI    MISSW,B'11111101'                                   0616 01525000
*DO J = 1 BY 1 TO EVNUM WHILE MISSW = OFF;                 /*@Z427VLS*/ 01526000
         LA    @08,1                                               0617 01527000
         ST    @08,J                                               0617 01528000
         B     @DE00617                                            0617 01529000
@DL00617 TM    MISSW,B'00000010'                                   0617 01530000
         BNZ   @DC00617                                            0617 01531000
*  IF EVSERIAL(J) = LRTCPUS | EVSERIAL(J) = 'FFFFFF'X THEN         0618 01532000
         MH    @08,@CH00081                                        0618 01533000
         L     @06,EVPTR(,R2)                                      0618 01534000
         ST    @08,@TF00001                                        0618 01535000
         ALR   @08,@06                                             0618 01536000
         CLC   EVSERIAL-6(3,@08),LRTCPUS(R7)                       0618 01537000
         BE    @RT00618                                            0618 01538000
         AL    @06,@TF00001                                        0618 01539000
         CLC   EVSERIAL-6(3,@06),@CB00237                          0618 01540000
         BNE   @RF00618                                            0618 01541000
@RT00618 DS    0H                                                  0619 01542000
*      /*EVSERIAL ONLY = FOXES IF 16TH OR HIGHER CPU IN INPUT*/    0619 01543000
*    DO;                                                   /*@Z427VLS*/ 01544000
*      MISSW = ON; /*LOOK KICK OUT FLAG IF A MATCH IS FOUND  @Z427VLS*/ 01545000
         OI    MISSW,B'00000010'                                   0620 01546000
*      WORKNM = J - 1; /*SET TO EVTABLE ENTRY NUMBER MINUS ONE*/   0621 01547000
         L     @08,J                                               0621 01548000
         BCTR  @08,0                                               0621 01549000
         STC   @08,WORKNM                                          0621 01550000
*      TRENCPUS  = WORKBYTE; /*REFERENCE WORKNM VIA BIT STRING AND*/    01551000
         MVC   TRENCPUS(1),WORKBYTE                                0622 01552000
*                             /*SET SYSOLD EQUAL TO IT       @Z427VLS*/ 01553000
*      IF SHAREPTR ^= ZERO THEN                                    0623 01554000
         L     @08,SHAREPTR(,R2)                                   0623 01555000
         LTR   @08,@08                                             0623 01556000
         BZ    @RF00623                                            0623 01557000
*        DO;                                               /*@Z427VLS*/ 01558000
*          SHAREYES = NO;                                  /*@Z427VLS*/ 01559000
         NI    SHAREYES,B'10111111'                                0625 01560000
*          DO K = 1 BY 1 TO SHARENUM WHILE SHAREYES = NO;  /*@Z427VLS*/ 01561000
         LA    @08,1                                               0626 01562000
         ST    @08,K                                               0626 01563000
         B     @DE00626                                            0626 01564000
@DL00626 TM    SHAREYES,B'01000000'                                0626 01565000
         BNZ   @DC00626                                            0626 01566000
*            IF LRTCPUS = SHARSERA(K) THEN                         0627 01567000
         MH    @08,@CH00033                                        0627 01568000
         L     @06,SHAREPTR(,R2)                                   0627 01569000
         ST    @08,@TF00001                                        0627 01570000
         ALR   @08,@06                                             0627 01571000
         AL    @08,@CF01571                                        0627 01572000
         CLC   LRTCPUS(3,R7),SHARSERA-4(@08)                       0627 01573000
         BNE   @RF00627                                            0627 01574000
*              DO;                                         /*@Z427VLS*/ 01575000
*                IF SHAREDX(K) = ON THEN                           0629 01576000
         LR    @08,@06                                             0629 01577000
         AL    @08,@TF00001                                        0629 01578000
         AL    @08,@CF01580                                        0629 01579000
         TM    SHAREDX-2(@08),B'10000000'                          0629 01580000
         BNO   @RF00629                                            0629 01581000
*                  DO;                                     /*@Z427VLS*/ 01582000
*                    IF (SHARECUA(K) & CUXOFF) = (WORKCUA & NOUNIT2)    01583000
*                    THEN /*ELIMINATE CUX FLAG AND SEE IF CHANNEL AND*/ 01584000
         LR    @08,@06                                             0631 01585000
         AL    @08,@TF00001                                        0631 01586000
         AL    @08,@CF01580                                        0631 01587000
         MVC   @TS00001(2),SHARECUA-2(@08)                         0631 01588000
         NC    @TS00001(2),@CB00942                                0631 01589000
         MVC   @TS00001+2(2),WORKCUA                               0631 01590000
         NC    @TS00001+2(2),@CB00908                              0631 01591000
         CLC   @TS00001(2),@TS00001+2                              0631 01592000
         BNE   @RF00631                                            0631 01593000
*                         /*CONTROL UNIT ADDRESS HALF BYTES MATCH*/     01594000
*                      DO;                                 /*@Z427VLS*/ 01595000
*                        TRENDRT  = (TRENDRT  & UNITON);   /*@0099VLS*/ 01596000
         NC    TRENDRT(2),@CB00930                                 0633 01597000
*                                     /*GET UNIT ADDRESS UNCHANGED*/    01598000
*                        TRENDRT  = (TRENDRT  | SHARECUB(K));      0634 01599000
         AL    @06,@TF00001                                        0634 01600000
         AL    @06,@CF01581                                        0634 01601000
         OC    TRENDRT(2),SHARECUB-7(@06)                          0634 01602000
*                        /*CONVER CHANNEL,CONTROL UNIT TO BASE ADDRS*/  01603000
*                        MISSW1 = OFF;                     /*@Z427VLS*/ 01604000
         NI    MISSW1,B'11111110'                                  0635 01605000
*                        DO L = 1 BY 1 TO EVNUM WHILE MISSW1 = OFF;     01606000
         LA    @08,1                                               0636 01607000
         ST    @08,L                                               0636 01608000
         B     @DE00636                                            0636 01609000
@DL00636 TM    MISSW1,B'00000001'                                  0636 01610000
         BNZ   @DC00636                                            0636 01611000
*                          IF EVSERIAL(L) = SHARSERB(K) |          0637 01612000
*                             EVSERIAL(L) = 'FFFFFF'X THEN         0637 01613000
         MH    @08,@CH00081                                        0637 01614000
         L     @06,EVPTR(,R2)                                      0637 01615000
         L     @03,K                                               0637 01616000
         MH    @03,@CH00033                                        0637 01617000
         L     @15,SHAREPTR(,R2)                                   0637 01618000
         ST    @08,@TF00001                                        0637 01619000
         ALR   @08,@06                                             0637 01620000
         ALR   @15,@03                                             0637 01621000
         BCTR  @15,0                                               0637 01622000
         BCTR  @15,0                                               0637 01623000
         CLC   EVSERIAL-6(3,@08),SHARSERB-9(@15)                   0637 01624000
         BE    @RT00637                                            0637 01625000
         AL    @06,@TF00001                                        0637 01626000
         CLC   EVSERIAL-6(3,@06),@CB00237                          0637 01627000
         BNE   @RF00637                                            0637 01628000
@RT00637 DS    0H                                                  0638 01629000
*                            DO;                           /*@Z427VLS*/ 01630000
*                              WORKNM = L - 1; /*SET TO EVTABLE ENT.*/  01631000
         L     @08,L                                               0639 01632000
         BCTR  @08,0                                               0639 01633000
         STC   @08,WORKNM                                          0639 01634000
*                                              /*NUMBER MINUS ONE*/     01635000
*                              MISSW1 = ON;                /*@Z427VLS*/ 01636000
         OI    MISSW1,B'00000001'                                  0640 01637000
*                            END;                          /*@Z427VLS*/ 01638000
*                        END;                              /*@Z427VLS*/ 01639000
@RF00637 LA    @08,1                                               0642 01640000
         AL    @08,L                                               0642 01641000
         ST    @08,L                                               0642 01642000
@DE00636 L     @06,EVPTR(,R2)                                      0642 01643000
         CH    @08,EVNUM(,@06)                                     0642 01644000
         BNH   @DL00636                                            0642 01645000
@DC00636 DS    0H                                                  0643 01646000
*                        SHAREYES = ON;                    /*@Z427VLS*/ 01647000
         OI    SHAREYES,B'01000000'                                0643 01648000
*                      END;                                /*@Z427VLS*/ 01649000
*                  END;                                    /*@Z427VLS*/ 01650000
*                ELSE                                              0646 01651000
*                  DO;                                     /*@Z427VLS*/ 01652000
         B     @RC00629                                            0646 01653000
@RF00629 DS    0H                                                  0647 01654000
*                    IF SHARECUA(K) = WORKCUA THEN                 0647 01655000
         L     @08,K                                               0647 01656000
         MH    @08,@CH00033                                        0647 01657000
         L     @06,SHAREPTR(,R2)                                   0647 01658000
         ST    @08,@TF00001                                        0647 01659000
         ALR   @08,@06                                             0647 01660000
         AL    @08,@CF01580                                        0647 01661000
         CLC   SHARECUA-2(2,@08),WORKCUA                           0647 01662000
         BNE   @RF00647                                            0647 01663000
*                      DO;                                 /*@Z427VLS*/ 01664000
*                        TRENDRT  = SHARECUB(K); /*GET BASE CPU*/  0649 01665000
         AL    @06,@TF00001                                        0649 01666000
         AL    @06,@CF01581                                        0649 01667000
         MVC   TRENDRT(2),SHARECUB-7(@06)                          0649 01668000
*                        MISSW1 = OFF;                     /*@Z427VLS*/ 01669000
         NI    MISSW1,B'11111110'                                  0650 01670000
*                        DO L = 1 BY 1 TO EVNUM WHILE MISSW1 = OFF;     01671000
         LA    @08,1                                               0651 01672000
         ST    @08,L                                               0651 01673000
         B     @DE00651                                            0651 01674000
@DL00651 TM    MISSW1,B'00000001'                                  0651 01675000
         BNZ   @DC00651                                            0651 01676000
*                          IF EVSERIAL(L) = SHARSERB(K) |          0652 01677000
*                             EVSERIAL(L) = 'FFFFFF'X THEN         0652 01678000
         MH    @08,@CH00081                                        0652 01679000
         L     @06,EVPTR(,R2)                                      0652 01680000
         L     @03,K                                               0652 01681000
         MH    @03,@CH00033                                        0652 01682000
         L     @15,SHAREPTR(,R2)                                   0652 01683000
         ST    @08,@TF00001                                        0652 01684000
         ALR   @08,@06                                             0652 01685000
         ALR   @15,@03                                             0652 01686000
         BCTR  @15,0                                               0652 01687000
         BCTR  @15,0                                               0652 01688000
         CLC   EVSERIAL-6(3,@08),SHARSERB-9(@15)                   0652 01689000
         BE    @RT00652                                            0652 01690000
         AL    @06,@TF00001                                        0652 01691000
         CLC   EVSERIAL-6(3,@06),@CB00237                          0652 01692000
         BNE   @RF00652                                            0652 01693000
@RT00652 DS    0H                                                  0653 01694000
*                            DO;                           /*@Z427VLS*/ 01695000
*                              WORKNM = L - 1; /*SET TO EVTABLE ENT.*/  01696000
         L     @08,L                                               0654 01697000
         BCTR  @08,0                                               0654 01698000
         STC   @08,WORKNM                                          0654 01699000
*                                             /*NUMBER MINUS ONE*/ 0655 01700000
*                              MISSW1 = ON;                /*@Z427VLS*/ 01701000
         OI    MISSW1,B'00000001'                                  0655 01702000
*                            END;                          /*@Z427VLS*/ 01703000
*                        END;                              /*@Z427VLS*/ 01704000
@RF00652 LA    @08,1                                               0657 01705000
         AL    @08,L                                               0657 01706000
         ST    @08,L                                               0657 01707000
@DE00651 L     @06,EVPTR(,R2)                                      0657 01708000
         CH    @08,EVNUM(,@06)                                     0657 01709000
         BNH   @DL00651                                            0657 01710000
@DC00651 DS    0H                                                  0658 01711000
*                        SHAREYES = ON;                    /*@Z427VLS*/ 01712000
         OI    SHAREYES,B'01000000'                                0658 01713000
*                    END;                                  /*@Z427VLS*/ 01714000
*                 END;                                     /*@Z427VLS*/ 01715000
@RF00647 DS    0H                                                  0661 01716000
*              END;                                        /*@Z427VLS*/ 01717000
@RC00629 DS    0H                                                  0662 01718000
*           END;                                           /*@Z427VLS*/ 01719000
@RF00627 LA    @08,1                                               0662 01720000
         AL    @08,K                                               0662 01721000
         ST    @08,K                                               0662 01722000
@DE00626 L     @06,SHAREPTR(,R2)                                   0662 01723000
         CH    @08,SHARENUM(,@06)                                  0662 01724000
         BNH   @DL00626                                            0662 01725000
@DC00626 DS    0H                                                  0663 01726000
*        END;                                              /*@Z427VLS*/ 01727000
*        SLL(TRENDRT ,4); /*SHIFT INTO TRENDCUA            @Z427VLS*/   01728000
@RF00623 SLR   @08,@08                                             0664 01729000
         ICM   @08,3,TRENDRT                                       0664 01730000
         SLL   @08,4                                               0664 01731000
         STCM  @08,3,TRENDRT                                       0664 01732000
*        SLL(WORKNM,4); /*SHIFT BASE CPU INDEX TO BYTE BOUNDARY*/  0665 01733000
         SLR   @08,@08                                             0665 01734000
         IC    @08,WORKNM                                          0665 01735000
         SLL   @08,4                                               0665 01736000
         STC   @08,WORKNM                                          0665 01737000
*        TRENCPUS  = (TRENCPUS  | WORKBYTE); /*SET TRENCPU   @0099VLS*/ 01738000
         OC    TRENCPUS(1),WORKBYTE                                0666 01739000
*     END;                                                 /*@Z427VLS*/ 01740000
*   END;                                                   /*@Z427VLS*/ 01741000
@RF00618 LA    @08,1                                               0668 01742000
         AL    @08,J                                               0668 01743000
         ST    @08,J                                               0668 01744000
@DE00617 L     @06,EVPTR(,R2)                                      0668 01745000
         CH    @08,EVNUM(,@06)                                     0668 01746000
         BNH   @DL00617                                            0668 01747000
@DC00617 DS    0H                                                  0669 01748000
*END;/*CLOSING END TO SETCPU                                 @Z427VLS*/ 01749000
@EL00013 DS    0H                                                  0669 01750000
@EF00013 DS    0H                                                  0669 01751000
@ER00013 LM    @14,@12,@SA00013                                    0669 01752000
         BR    @14                                                 0669 01753000
*ENDOFILE: PROC; /*SORT EVTABLE, TRENDONE, TREND2, FREE EXCESS*/   0670 01754000
ENDOFILE STM   @14,@12,@SA00014                                    0670 01755000
*                /*TREND2 CORE, PRINT TOURIST INFO, SET RETURN CODES*/  01756000
*RESPECIFY(R15) RESTRICTED;                                /*@Z427VLS*/ 01757000
*IF R15 = OVERFLOW & PHIST = ON THEN /*IF DIRECTWK OVERFLOW AND */ 0672 01758000
         C     R15,@CF00066                                        0672 01759000
         BNE   @RF00672                                            0672 01760000
         TM    PHIST(R2),B'00100000'                               0672 01761000
         BNO   @RF00672                                            0672 01762000
*  DO; /*HISTORY INPUT THEN IFCIOHND HAS NOT CLOSED HISTORY INPUT*/     01763000
*    CLOSEIO = (CLOSEIO && CLOSEIO); /*DONT CLOSE OTHER DATA SETS*/     01764000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0674 01765000
*    CACCIN = ON; /*SET ACCIN CLOSE REQUESTED FLAG           @Z427VLS*/ 01766000
         OI    CACCIN(R2),B'00010000'                              0675 01767000
*    CALL IOHND(IOCLOSE); /*REQUEST CLOSE                    @Z427VLS*/ 01768000
         L     @15,ADIOHND(,R2)                                    0676 01769000
         LA    @01,@AL00676                                        0676 01770000
         BALR  @14,@15                                             0676 01771000
*  END;                                                    /*@Z427VLS*/ 01772000
*IF MAXENT <= I & ERROR ^= ENDFILE & GETFAIL = NO THEN             0678 01773000
@RF00672 L     @14,MAXENT                                          0678 01774000
         C     @14,I                                               0678 01775000
         BH    @RF00678                                            0678 01776000
         CLC   ERROR(4),@CF00064                                   0678 01777000
         BE    @RF00678                                            0678 01778000
         TM    GETFAIL,B'00000100'                                 0678 01779000
         BNZ   @RF00678                                            0678 01780000
*  DO;            /*WORLD, DONT TELL EREP1, DONT LET LOGREC BE RESET*/  01781000
*     ZEROALL = NO;                                        /*@Z427VLS*/ 01782000
         NI    ZEROALL(R2),B'10111111'                             0680 01783000
*     MSGNO = 3;                                           /*@Z427VLS*/ 01784000
         MVI   MSGNO,X'03'                                         0681 01785000
*     CALL ERRMSG;                                         /*@Z427VLS*/ 01786000
         BAL   @14,ERRMSG                                          0682 01787000
*     ERROR = ZERO;                                        /*@0001VLS*/ 01788000
         SLR   @14,@14                                             0683 01789000
         ST    @14,ERROR                                           0683 01790000
*     IF PHIST = ON THEN /*IF HISTORY INPUT                  @Z427VLS*/ 01791000
         TM    PHIST(R2),B'00100000'                               0684 01792000
         BNO   @RF00684                                            0684 01793000
*       DO;                                                /*@Z427VLS*/ 01794000
*         CLOSEIO = (CLOSEIO && CLOSEIO);                  /*@Z427VLS*/ 01795000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0686 01796000
*         CACCIN = ON;                                     /*@Z427VLS*/ 01797000
         OI    CACCIN(R2),B'00010000'                              0687 01798000
*         CALL IOHND(IOCLOSE);                             /*@Z427VLS*/ 01799000
         L     @15,ADIOHND(,R2)                                    0688 01800000
         LA    @01,@AL00688                                        0688 01801000
         BALR  @14,@15                                             0688 01802000
*       END;                                               /*@G51DGBB*/ 01803000
* END;                                                     /*@G51DGBB*/ 01804000
@RF00684 DS    0H                                                  0691 01805000
* IF ERROR = FOUR THEN                                             0691 01806000
@RF00678 CLC   ERROR(4),@CF00064                                   0691 01807000
         BNE   @RF00691                                            0691 01808000
*   DO;                                                    /*@G51DGBB*/ 01809000
*     R15 = ZERO;                                          /*@G51DGBB*/ 01810000
         SLR   R15,R15                                             0693 01811000
*     ERROR = ZERO;                                        /*@G51DGBB*/ 01812000
         SLR   @14,@14                                             0694 01813000
         ST    @14,ERROR                                           0694 01814000
*   END;                                                   /*@G51DGBB*/ 01815000
*/*THE FOLLOWING CODE MUST BE ADDED TO THE END OF FILE PROC BEFORE*/    01816000
*/*CLOSING ACCDEV TO WRITE FRAMES TO ACCDEV, IF NECESSARY    @G51DGBB*/ 01817000
*IF R15 < TWELVE &             /*IF NON TERMINATE RETURN CODE */   0696 01818000
*   FRAMEPTR ^= ZERO THEN      /*IF FRAMETAB IS ALLOCATED    @G51DGBB*/ 01819000
@RF00691 C     R15,@CF00032                                        0696 01820000
         BNL   @RF00696                                            0696 01821000
         SLR   @14,@14                                             0696 01822000
         L     @08,FRAMEPTR(,R2)                                   0696 01823000
         CR    @08,@14                                             0696 01824000
         BE    @RF00696                                            0696 01825000
* DO;                                                      /*@G51DGBB*/ 01826000
*    IF  FRAMENUM > ZERO THEN /* IF FRAMETAB ENTRIES BUILD.  @G51DGBB*/ 01827000
         C     @14,FRAMENUM(,@08)                                  0698 01828000
         BNL   @RF00698                                            0698 01829000
*      DO;                                                 /*@G51DGBB*/ 01830000
*         IF PHIST = ON THEN /*IF DIRECTWK WAS USED TO STORE FRAMES */  01831000
         TM    PHIST(R2),B'00100000'                               0700 01832000
         BNO   @RF00700                                            0700 01833000
*           DO;                                            /*@G51DGBB*/ 01834000
*             CLOSEIO = (CLOSEIO && CLOSEIO); /*ZERO CLOSE FLAGS*/ 0702 01835000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0702 01836000
*             CDRCTWRK = ON;      /*INDICATE CLOSE OF DIRECTWK FOR  */  01837000
         OI    CDRCTWRK(R2),B'00000010'                            0703 01838000
*             CALL IOHND(IOCLOSE); /*WRITING, IMPLICITLY OPENED FOR RD* 01839000
         L     @15,ADIOHND(,R2)                                    0704 01840000
         LA    @01,@AL00704                                        0704 01841000
         BALR  @14,@15                                             0704 01842000
*           END;                                           /*@G51DGBB*/ 01843000
*         DO A = 1 BY 1 TO FRAMENUM WHILE R15 < FOUR;       /*SETS. */  01844000
@RF00700 LA    @14,1                                               0706 01845000
         ST    @14,A                                               0706 01846000
         B     @DE00706                                            0706 01847000
@DL00706 C     R15,@CF00064                                        0706 01848000
         BNL   @DC00706                                            0706 01849000
*           IF FRAMETYP(A) = ALLALL THEN /*IF COMPLETE SET   @G51DGBB*/ 01850000
         MH    @14,@CH00227                                        0707 01851000
         L     @08,FRAMEPTR(,R2)                                   0707 01852000
         ST    @14,@TF00001                                        0707 01853000
         ALR   @14,@08                                             0707 01854000
         AL    @14,@CF01571                                        0707 01855000
         CLI   FRAMETYP-17(@14),X'FF'                              0707 01856000
         BNE   @RF00707                                            0707 01857000
*             DO;                                          /*@G51DGBB*/ 01858000
*               LISTPTR = FRAMLOCM(A);   /*ESTABLISH LISTLOC ADDR.*/    01859000
         L     @14,@TF00001                                        0709 01860000
         AL    @08,@CF01581                                        0709 01861000
         L     @14,FRAMLOCM-20(@14,@08)                            0709 01862000
         ST    @14,LISTPTR                                         0709 01863000
*               DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR ;/*@G51DGBB*/ 01864000
         LA    @14,1                                               0710 01865000
         ST    @14,Z                                               0710 01866000
         B     @DE00710                                            0710 01867000
@DL00710 C     R15,@CF00064                                        0710 01868000
         BNL   @DC00710                                            0710 01869000
*                 RECCCHHR = LISTCCHR(Z);  /*GET ALL MCH FRAMES*/  0711 01870000
         MH    @14,@CH00079                                        0711 01871000
         L     @08,LISTPTR                                         0711 01872000
         ALR   @08,@14                                             0711 01873000
         BCTR  @08,0                                               0711 01874000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      0711 01875000
*                 CALL IOHND(READIRCT);    /*READ FRAME FROM DIRECTWK*/ 01876000
         L     @15,ADIOHND(,R2)                                    0712 01877000
         LA    @01,@AL00712                                        0712 01878000
         BALR  @14,@15                                             0712 01879000
*                 IF R15 = ZERO THEN       /*WRITE FRAME TO ACCDEV*/    01880000
         LTR   R15,R15                                             0713 01881000
         BNZ   @RF00713                                            0713 01882000
*                   CALL IOHND(RITEHIST);                  /*@G51DGBB*/ 01883000
         L     @15,ADIOHND(,R2)                                    0714 01884000
         LA    @01,@AL00714                                        0714 01885000
         BALR  @14,@15                                             0714 01886000
*              END;                                        /*@G51DGBB*/ 01887000
@RF00713 LA    @14,1                                               0715 01888000
         AL    @14,Z                                               0715 01889000
         ST    @14,Z                                               0715 01890000
@DE00710 L     @08,LISTPTR                                         0715 01891000
         C     @14,LISTNUM(,@08)                                   0715 01892000
         BNH   @DL00710                                            0715 01893000
@DC00710 DS    0H                                                  0716 01894000
*              IF R15 = ZERO THEN /*IF NO ACCDEV WRITE ERROR @G51DGBB*/ 01895000
         LTR   R15,R15                                             0716 01896000
         BNZ   @RF00716                                            0716 01897000
*                DO;                                       /*@G51DGBB*/ 01898000
*                  LISTPTR = FRAMLOCC(A); /*GET CCH FRAMES   @G51DGBB*/ 01899000
         L     @14,A                                               0718 01900000
         MH    @14,@CH00227                                        0718 01901000
         L     @08,FRAMEPTR(,R2)                                   0718 01902000
         L     @14,FRAMLOCC-24(@14,@08)                            0718 01903000
         ST    @14,LISTPTR                                         0718 01904000
*                  DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR;      0719 01905000
         LA    @14,1                                               0719 01906000
         ST    @14,Z                                               0719 01907000
         B     @DE00719                                            0719 01908000
@DL00719 C     R15,@CF00064                                        0719 01909000
         BNL   @DC00719                                            0719 01910000
*                    RECCCHHR = LISTCCHR(Z);               /*@G51DGBB*/ 01911000
         MH    @14,@CH00079                                        0720 01912000
         L     @08,LISTPTR                                         0720 01913000
         ALR   @08,@14                                             0720 01914000
         BCTR  @08,0                                               0720 01915000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      0720 01916000
*                      CALL IOHND(READIRCT); /*READ FRAME OFF DRCTWK*/  01917000
         L     @15,ADIOHND(,R2)                                    0721 01918000
         LA    @01,@AL00721                                        0721 01919000
         BALR  @14,@15                                             0721 01920000
*                      IF R15 = ZERO THEN    /*IF SUCCESS THEN WRITE*/  01921000
         LTR   R15,R15                                             0722 01922000
         BNZ   @RF00722                                            0722 01923000
*                        CALL IOHND(RITEHIST); /*TO ACCDEV   @G51DGBB*/ 01924000
         L     @15,ADIOHND(,R2)                                    0723 01925000
         LA    @01,@AL00723                                        0723 01926000
         BALR  @14,@15                                             0723 01927000
*                    END;                                  /*@G51DGBB*/ 01928000
@RF00722 LA    @14,1                                               0724 01929000
         AL    @14,Z                                               0724 01930000
         ST    @14,Z                                               0724 01931000
@DE00719 L     @08,LISTPTR                                         0724 01932000
         C     @14,LISTNUM(,@08)                                   0724 01933000
         BNH   @DL00719                                            0724 01934000
@DC00719 DS    0H                                                  0725 01935000
*                 END;                                     /*@G51DGBB*/ 01936000
*             END;                                         /*@G51DGBB*/ 01937000
*           ELSE  /*INCOMPLETE FRAME SET                     @G51DGBB*/ 01938000
*             DO;                                          /*@G51DGBB*/ 01939000
         B     @RC00707                                            0727 01940000
@RF00707 DS    0H                                                  0728 01941000
*               MSGNO = 78; /*MISSING FRAME SET MESSAGE      @G51DGBB*/ 01942000
         MVI   MSGNO,X'4E'                                         0728 01943000
*               CCHINDX = A;   /*CORRECT DEBUG FRAME COUNTS BY */  0729 01944000
         L     @14,A                                               0729 01945000
         ST    @14,CCHINDX                                         0729 01946000
*               CALL ERRMSG;                               /*@G51DGBB*/ 01947000
         BAL   @14,ERRMSG                                          0730 01948000
*               CALL FIXENTRY; /*PASSING ENTRY INDEX TO FIXENTRY*/ 0731 01949000
         BAL   @14,FIXENTRY                                        0731 01950000
*             END;                                         /*@G51DGBB*/ 01951000
*         END;                                             /*@G51DGBB*/ 01952000
@RC00707 LA    @14,1                                               0733 01953000
         AL    @14,A                                               0733 01954000
         ST    @14,A                                               0733 01955000
@DE00706 L     @08,FRAMEPTR(,R2)                                   0733 01956000
         C     @14,FRAMENUM(,@08)                                  0733 01957000
         BNH   @DL00706                                            0733 01958000
@DC00706 DS    0H                                                  0734 01959000
*      END;                                                /*@G51DGBB*/ 01960000
*     GEN(FREEMAIN R,SP=21);                               /*@G51DGBB*/ 01961000
@RF00698 DS    0H                                                  0735 01962000
         FREEMAIN R,SP=21                                               01963000
* END;                                                     /*@G51DGBB*/ 01964000
*IF ERROR = OVERFLOW | ERROR = ENDFILE THEN                        0737 01965000
@RF00696 L     @14,ERROR                                           0737 01966000
         C     @14,@CF00066                                        0737 01967000
         BE    @RT00737                                            0737 01968000
         C     @14,@CF00064                                        0737 01969000
         BNE   @RF00737                                            0737 01970000
@RT00737 DS    0H                                                  0738 01971000
*  ERROR = ZERO;                                           /*@0001VLS*/ 01972000
         SLR   @14,@14                                             0738 01973000
         ST    @14,ERROR                                           0738 01974000
*BUG(50) = BUG(23) + BUG(17) + BUG(19) + BUG(21);          /*@G51DGBB*/ 01975000
@RF00737 L     @14,BUG+88                                          0739 01976000
         AL    @14,BUG+64                                          0739 01977000
         AL    @14,BUG+72                                          0739 01978000
         AL    @14,BUG+80                                          0739 01979000
         ST    @14,BUG+196                                         0739 01980000
*NUMREC = BUG(50);                                         /*@G51DGBB*/ 01981000
         ST    @14,NUMREC                                          0740 01982000
*CVD(NUMREC,PACKPAS); /*PRINT NUMBER OF RECORDS PASSED FILTERING*/ 0741 01983000
         CVD   @14,@TS00001                                        0741 01984000
         MVC   PACKPAS(4),@TS00001+4                               0741 01985000
*PACKPAS = (PACKPAS | '0000000F'X); /*CHANGE SIGN FROM C TO F*/    0742 01986000
         OC    PACKPAS(4),@CB01432                                 0742 01987000
*UNPK(EDFLD,PACKPAS);                                      /*@Z427VLS*/ 01988000
         UNPK  EDFLD(9),PACKPAS(4)                                 0743 01989000
*NONBLANK = OFF; /*INITIALIZE TO NO LEADING BLANKS           @G51DGBB*/ 01990000
         NI    NONBLANK,B'10111111'                                0744 01991000
*DO J = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                  /*@Z427VLS*/ 01992000
         LA    @14,1                                               0745 01993000
         ST    @14,J                                               0745 01994000
@DL00745 TM    NONBLANK,B'01000000'                                0745 01995000
         BNZ   @DC00745                                            0745 01996000
*  IF EDIFILD(J) = CHARZERO THEN                                   0746 01997000
         LA    @08,EDIFILD-1(@14)                                  0746 01998000
         CLI   0(@08),X'F0'                                        0746 01999000
         BNE   @RF00746                                            0746 02000000
*    EDIFILD(J) = BLANK;                                   /*@Z427VLS*/ 02001000
         LA    @08,EDIFILD-1(@14)                                  0747 02002000
         MVI   0(@08),X'40'                                        0747 02003000
*  ELSE                                                            0748 02004000
*    NONBLANK = ON;                                        /*@Z427VLS*/ 02005000
         B     @RC00746                                            0748 02006000
@RF00746 OI    NONBLANK,B'01000000'                                0748 02007000
*END;                                                      /*@Z427VLS*/ 02008000
@RC00746 LA    @14,1                                               0749 02009000
         AL    @14,J                                               0749 02010000
         ST    @14,J                                               0749 02011000
         C     @14,@CF00066                                        0749 02012000
         BNH   @DL00745                                            0749 02013000
@DC00745 DS    0H                                                  0750 02014000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 02015000
         LA    @14,PRINTLIN                                        0750 02016000
         ST    @14,PRINTADR(,R2)                                   0750 02017000
*CALL IFCMSG(70,ADDR(PRINTBDY));                           /*@Z427VLS*/ 02018000
         LA    @14,PRINTBDY                                        0751 02019000
         ST    @14,@AFTEMPS                                        0751 02020000
         L     @15,ADIFCMSG(,R2)                                   0751 02021000
         LA    @01,@AL00751                                        0751 02022000
         BALR  @14,@15                                             0751 02023000
*PRINTED = EDFLD;                                          /*@Z427VLS*/ 02024000
         MVC   PRINTED(9),EDFLD                                    0752 02025000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 02026000
         L     @15,ADIOHND(,R2)                                    0753 02027000
         LA    @01,@AL00753                                        0753 02028000
         BALR  @14,@15                                             0753 02029000
*CVD(ZZ3,PACKPAS);                                         /*@0099VLS*/ 02030000
         L     @14,ZZ3                                             0754 02031000
         CVD   @14,@TS00001                                        0754 02032000
         MVC   PACKPAS(4),@TS00001+4                               0754 02033000
*PACKPAS = (PACKPAS | '0000000F'X); /*CHANGE SIGN FROM C TO F*/    0755 02034000
         OC    PACKPAS(4),@CB01432                                 0755 02035000
*UNPK(EDFLD,PACKPAS); /*CONVERT PACKED TO PRINTABLE          @Z427VLS*/ 02036000
         UNPK  EDFLD(9),PACKPAS(4)                                 0756 02037000
*NONBLANK = OFF; /*REINITIALIZE THE SWITCH                   @Z427VLS*/ 02038000
         NI    NONBLANK,B'10111111'                                0757 02039000
*DO J = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                  /*@Z427VLS*/ 02040000
         LA    @14,1                                               0758 02041000
         ST    @14,J                                               0758 02042000
@DL00758 TM    NONBLANK,B'01000000'                                0758 02043000
         BNZ   @DC00758                                            0758 02044000
*  IF EDIFILD(J) = CHARZERO THEN                                   0759 02045000
         LA    @08,EDIFILD-1(@14)                                  0759 02046000
         CLI   0(@08),X'F0'                                        0759 02047000
         BNE   @RF00759                                            0759 02048000
*    EDIFILD(J) = BLANK;                                   /*@Z427VLS*/ 02049000
         LA    @08,EDIFILD-1(@14)                                  0760 02050000
         MVI   0(@08),X'40'                                        0760 02051000
*  ELSE /*NON BLANK BY DEFAULT                               @Z427VLS*/ 02052000
*    NONBLANK = ON;                                        /*@Z427VLS*/ 02053000
         B     @RC00759                                            0761 02054000
@RF00759 OI    NONBLANK,B'01000000'                                0761 02055000
*END;                                                      /*@Z427VLS*/ 02056000
@RC00759 LA    @14,1                                               0762 02057000
         AL    @14,J                                               0762 02058000
         ST    @14,J                                               0762 02059000
         C     @14,@CF00066                                        0762 02060000
         BNH   @DL00758                                            0762 02061000
@DC00758 DS    0H                                                  0763 02062000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 02063000
         LA    @14,PRINTLIN                                        0763 02064000
         ST    @14,PRINTADR(,R2)                                   0763 02065000
*CALL IFCMSG(71,ADDR(PRINTBDY));                           /*@Z427VLS*/ 02066000
         LA    @14,PRINTBDY                                        0764 02067000
         ST    @14,@AFTEMPS                                        0764 02068000
         L     @15,ADIFCMSG(,R2)                                   0764 02069000
         LA    @01,@AL00764                                        0764 02070000
         BALR  @14,@15                                             0764 02071000
*PRINTED = EDFLD;                                          /*@Z427VLS*/ 02072000
         MVC   PRINTED(9),EDFLD                                    0765 02073000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 02074000
         L     @15,ADIOHND(,R2)                                    0766 02075000
         LA    @01,@AL00766                                        0766 02076000
         BALR  @14,@15                                             0766 02077000
*IF PACC = YES THEN                                                0767 02078000
         TM    PACC(R2),B'01000000'                                0767 02079000
         BNO   @RF00767                                            0767 02080000
*  DO;                                                     /*@Z427VLS*/ 02081000
*    CLOSEIO = CLOSEIO && CLOSEIO;                         /*@Z427VLS*/ 02082000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0769 02083000
*    CACCDEV = ON;                                         /*@Z427VLS*/ 02084000
         OI    CACCDEV(R2),B'00001000'                             0770 02085000
*    CALL IOHND(IOCLOSE);                                  /*@Z427VLS*/ 02086000
         L     @15,ADIOHND(,R2)                                    0771 02087000
         LA    @01,@AL00771                                        0771 02088000
         BALR  @14,@15                                             0771 02089000
*  END;                                                    /*@Z427VLS*/ 02090000
*IF ERROR ^= NOSRTABL THEN                                         0773 02091000
@RF00767 CLC   ERROR(4),@CF00032                                   0773 02092000
         BE    @RF00773                                            0773 02093000
* DO;                                                      /*@Z427VLS*/ 02094000
*   SORTNUM = PASSNUM; /*TELL EREP1 HOW MANY RECORDS IN TREND2  */ 0775 02095000
         L     @14,PASSNUM                                         0775 02096000
         ST    @14,SORTNUM(,R2)                                    0775 02097000
*   EXCESS = TABSIZE - (PASSNUM * SORTELNT); /*CORE UNUSED BY TREND2*/  02098000
         L     @08,TABSIZE(,R2)                                    0776 02099000
         MH    @14,@CH00940                                        0776 02100000
         LCR   @14,@14                                             0776 02101000
         ALR   @14,@08                                             0776 02102000
         ST    @14,EXCESS                                          0776 02103000
*   IF EXCESS > 16 THEN /*IF ONE DOUBLEWORD TO FREE AFTER ROUNDING*/    02104000
         C     @14,@CF00088                                        0777 02105000
         BNH   @RF00777                                            0777 02106000
*     DO;                                                  /*@Z427VLS*/ 02107000
*       EXCESS = (EXCESS & DBWRD1); /*ROUND DOWN TO DBWORD AMOUNT*/     02108000
         N     @14,@CF00881                                        0779 02109000
         ST    @14,EXCESS                                          0779 02110000
*       RESPECIFY (R0,R1) RESTRICTED;                      /*@Z427VLS*/ 02111000
*       R0 = EXCESS;                                       /*@Z427VLS*/ 02112000
         LR    R0,@14                                              0781 02113000
*       R1 = SORTADR + TABSIZE - EXCESS;                   /*@Z427VLS*/ 02114000
         AL    @08,SORTADR(,R2)                                    0782 02115000
         SLR   @08,@14                                             0782 02116000
         LR    R1,@08                                              0782 02117000
*       GEN(FREEMAIN R,LV=(0),A=(1));                      /*@Z427VLS*/ 02118000
         FREEMAIN R,LV=(0),A=(1)                                        02119000
*     END;                                                 /*@Z427VLS*/ 02120000
*     RESPECIFY(R1) UNRESTRICTED;                          /*@Z427VLS*/ 02121000
@RF00777 DS    0H                                                  0786 02122000
*  END;                                                    /*@Z427VLS*/ 02123000
*IF SORTNUM = ZERO & NUMREC = ZERO THEN  /*IF NO RECDS, EREP1 QUIT*/    02124000
@RF00773 SLR   @14,@14                                             0787 02125000
         C     @14,SORTNUM(,R2)                                    0787 02126000
         BNE   @RF00787                                            0787 02127000
         C     @14,NUMREC                                          0787 02128000
         BNE   @RF00787                                            0787 02129000
*  ERROR = TERMINAT;                                       /*@0001VLS*/ 02130000
         MVC   ERROR(4),@CF00032                                   0788 02131000
*IF ERROR = SUCCESS THEN                                           0789 02132000
@RF00787 L     @14,ERROR                                           0789 02133000
         LTR   @14,@14                                             0789 02134000
         BNZ   @RF00789                                            0789 02135000
* DO;                                                      /*@Z427VLS*/ 02136000
*  CALL SORTONE; /*SORT EVTABLE,TRENDONE,SET EVLETTER IF UNSET*/   0791 02137000
         BAL   @14,SORTONE                                         0791 02138000
*  IF SORTNUM > ZERO THEN /*IF ANY SAVED OBR, MDR RECORDS    @Z427VLS*/ 02139000
         L     @14,SORTNUM(,R2)                                    0792 02140000
         LTR   @14,@14                                             0792 02141000
         BNP   @RF00792                                            0792 02142000
*    CALL SORTWO;                                          /*@Z427VLS*/ 02143000
         BAL   @14,SORTWO                                          0793 02144000
* END;                                                     /*@Z427VLS*/ 02145000
*RESPECIFY (R0,R1,R15) UNRESTRICTED;                       /*@Z427VLS*/ 02146000
*END; /*CLOSING END TO ENDOFILE                              @Z427VLS*/ 02147000
@EL00014 DS    0H                                                  0796 02148000
@EF00014 DS    0H                                                  0796 02149000
@ER00014 LM    @14,@12,@SA00014                                    0796 02150000
         BR    @14                                                 0796 02151000
*ALLREC: PROC;  /*RECORD DEPENDENT SELECTION CRITTERIA       @Z427VLS*/ 02152000
ALLREC   STM   @14,@12,12(@13)                                     0797 02153000
*               /*COMPARE RECORD ITEMS PRECEEDED BY          @Z427VLS*/ 02154000
*               /* LRT TO PARAMETER TABLE SELECTION          @Z427VLS*/ 02155000
*               /*VALUES AND RANGES                          @Z427VLS*/ 02156000
*PASSFLAG = YES; /*RECORD SELECTED IF PASSFLAG NOT SET TO NO @Z427VLS*/ 02157000
         OI    PASSFLAG(R2),B'00000001'                            0798 02158000
*IF LRTDATE >= STDATE & LRTDATE <= ENDDATE THEN                    0799 02159000
         CLC   LRTDATE(4,R7),STDATE(R2)                            0799 02160000
         BL    @RF00799                                            0799 02161000
         CLC   LRTDATE(4,R7),ENDDATE(R2)                           0799 02162000
         BH    @RF00799                                            0799 02163000
*  DO;                                                     /*@Z427VLS*/ 02164000
*    IF (LRTTIME >= STTIME1 & LRTTIME <= ENDTIME1) |               0801 02165000
*       (LRTTIME >= STTIME2 & LRTTIME <= ENDTIME2) THEN            0801 02166000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           0801 02167000
         BL    @GL00042                                            0801 02168000
         CLC   LRTTIME(4,R7),ENDTIME1(R2)                          0801 02169000
         BNH   @RT00801                                            0801 02170000
@GL00042 CLC   LRTTIME(4,R7),STTIME2(R2)                           0801 02171000
         BL    @RF00801                                            0801 02172000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          0801 02173000
         BH    @RF00801                                            0801 02174000
@RT00801 DS    0H                                                  0802 02175000
*      DO;                                                 /*@Z427VLS*/ 02176000
*        IF SHIFT3RD = ON &                                        0803 02177000
*          ((LRTDATE = STDATE & LRTTIME < STTIME1) |               0803 02178000
*           (LRTDATE = ENDDATE & LRTTIME > ENDTIME2))              0803 02179000
*           THEN                                                   0803 02180000
         TM    SHIFT3RD(R2),B'00010000'                            0803 02181000
         BNO   @RF00803                                            0803 02182000
         CLC   LRTDATE(4,R7),STDATE(R2)                            0803 02183000
         BNE   @GL00046                                            0803 02184000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           0803 02185000
         BL    @RT00803                                            0803 02186000
@GL00046 CLC   LRTDATE(4,R7),ENDDATE(R2)                           0803 02187000
         BNE   @RF00803                                            0803 02188000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          0803 02189000
         BNH   @RF00803                                            0803 02190000
@RT00803 DS    0H                                                  0804 02191000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 02192000
         NI    PASSFLAG(R2),B'11111110'                            0804 02193000
*      END;                                                /*@Z427VLS*/ 02194000
*    ELSE                                                          0806 02195000
*      PASSFLAG = NO;                                      /*@Z427VLS*/ 02196000
         B     @RC00801                                            0806 02197000
@RF00801 NI    PASSFLAG(R2),B'11111110'                            0806 02198000
*   END;                                                   /*@Z427VLS*/ 02199000
*  ELSE                                                            0808 02200000
*   PASSFLAG = NO;                                         /*@Z427VLS*/ 02201000
         B     @RC00799                                            0808 02202000
@RF00799 NI    PASSFLAG(R2),B'11111110'                            0808 02203000
*END;                                                      /*@Z427VLS*/ 02204000
@EL00015 DS    0H                                                  0809 02205000
@EF00015 DS    0H                                                  0809 02206000
@ER00015 LM    @14,@12,12(@13)                                     0809 02207000
         BR    @14                                                 0809 02208000
*RECDEP: PROC; /*IDENTIFY RECORD TYPE, SET SORT TABLE KEY    @Z427VLS*/ 02209000
RECDEP   STM   @14,@12,@SA00016                                    0810 02210000
*              /*PERFORM FILTERING                           @Z427VLS*/ 02211000
*WORKTYPE = (LRTKEY1 & GENREC);                            /*@Z427VLS*/ 02212000
         MVC   WORKTYPE(1),LRTKEY1(R7)                             0811 02213000
         NI    WORKTYPE,X'F0'                                      0811 02214000
*IF LRTRUNC = ON | (WORKTYPE < HEX10)                              0812 02215000
*                | (WORKTYPE > HEX90) THEN                         0812 02216000
         TM    LRTRUNC(R7),B'00100000'                             0812 02217000
         BO    @RT00812                                            0812 02218000
         CLI   WORKTYPE,X'10'                                      0812 02219000
         BL    @RT00812                                            0812 02220000
         CLI   WORKTYPE,X'90'                                      0812 02221000
         BNH   @RF00812                                            0812 02222000
@RT00812 DS    0H                                                  0813 02223000
*  BUG(15) = BUG(15) + ONE;                                /*@Z427VLS*/ 02224000
         LA    @08,1                                               0813 02225000
         AL    @08,BUG+56                                          0813 02226000
         ST    @08,BUG+56                                          0813 02227000
*ELSE                                                              0814 02228000
*  DO;                                                     /*@Z427VLS*/ 02229000
         B     @RC00812                                            0814 02230000
@RF00812 DS    0H                                                  0815 02231000
*    IF WORKTYPE = HEX30 THEN                                      0815 02232000
         CLI   WORKTYPE,X'30'                                      0815 02233000
         BNE   @RF00815                                            0815 02234000
*      DO;                                                 /*@Z427VLS*/ 02235000
*        CALL OBRFILT;                                     /*@Z427VLS*/ 02236000
         BAL   @14,OBRFILT                                         0817 02237000
*        BUG(6) = BUG(6) + 1; /*NUMBER OF OBRS IDENTIFIED    @Z427VLS*/ 02238000
         LA    @08,1                                               0818 02239000
         AL    @08,BUG+20                                          0818 02240000
         ST    @08,BUG+20                                          0818 02241000
*      END;                                                /*@Z427VLS*/ 02242000
*    ELSE                                                          0820 02243000
*      DO;                                                 /*@Z427VLS*/ 02244000
         B     @RC00815                                            0820 02245000
@RF00815 DS    0H                                                  0821 02246000
*        IF WORKTYPE = HEX90 THEN                                  0821 02247000
         CLI   WORKTYPE,X'90'                                      0821 02248000
         BNE   @RF00821                                            0821 02249000
*          CALL MDRFILT;                                   /*@Z427VLS*/ 02250000
         BAL   @14,MDRFILT                                         0822 02251000
*        ELSE                                                      0823 02252000
*          DO;                                             /*@Z427VLS*/ 02253000
         B     @RC00821                                            0823 02254000
@RF00821 DS    0H                                                  0824 02255000
*            IF WORKTYPE = HEX10 THEN                              0824 02256000
         CLI   WORKTYPE,X'10'                                      0824 02257000
         BNE   @RF00824                                            0824 02258000
*              CALL MCHFILT;                               /*@Z427VLS*/ 02259000
         BAL   @14,MCHFILT                                         0825 02260000
*            ELSE                                                  0826 02261000
*             DO;                                          /*@Z427VLS*/ 02262000
         B     @RC00824                                            0826 02263000
@RF00824 DS    0H                                                  0827 02264000
*               IF WORKTYPE = HEX20 THEN                           0827 02265000
         CLI   WORKTYPE,X'20'                                      0827 02266000
         BNE   @RF00827                                            0827 02267000
*                 CALL CCHFILT;                            /*@Z427VLS*/ 02268000
         BAL   @14,CCHFILT                                         0828 02269000
*               ELSE                                               0829 02270000
*                DO;                                       /*@Z427VLS*/ 02271000
         B     @RC00827                                            0829 02272000
@RF00827 DS    0H                                                  0830 02273000
*                   IF WORKTYPE = HEX40 THEN                       0830 02274000
         CLI   WORKTYPE,X'40'                                      0830 02275000
         BNE   @RF00830                                            0830 02276000
*                     CALL SOFTFILT;                       /*@Z427VLS*/ 02277000
         BAL   @14,SOFTFILT                                        0831 02278000
*                   ELSE                                           0832 02279000
*                     DO;                                  /*@Z427VLS*/ 02280000
         B     @RC00830                                            0832 02281000
@RF00830 DS    0H                                                  0833 02282000
*                       IF WORKTYPE = HEX50 THEN                   0833 02283000
         CLI   WORKTYPE,X'50'                                      0833 02284000
         BNE   @RF00833                                            0833 02285000
*                         CALL IPLFILT;                    /*@Z427VLS*/ 02286000
         BAL   @14,IPLFILT                                         0834 02287000
*                       ELSE                                       0835 02288000
*                         DO;                              /*@Z427VLS*/ 02289000
         B     @RC00833                                            0835 02290000
@RF00833 DS    0H                                                  0836 02291000
*                           IF WORKTYPE = HEX60 THEN               0836 02292000
         CLI   WORKTYPE,X'60'                                      0836 02293000
         BNE   @RF00836                                            0836 02294000
*                             CALL DDRFILT;                /*@Z427VLS*/ 02295000
         BAL   @14,DDRFILT                                         0837 02296000
*                           ELSE                                   0838 02297000
*                             DO;                          /*@Z427VLS*/ 02298000
         B     @RC00836                                            0838 02299000
@RF00836 DS    0H                                                  0839 02300000
*                               IF WORKTYPE = HEX70 THEN           0839 02301000
         CLI   WORKTYPE,X'70'                                      0839 02302000
         BNE   @RF00839                                            0839 02303000
*                                 CALL MIHFILT;            /*@Z427VLS*/ 02304000
         BAL   @14,MIHFILT                                         0840 02305000
*                               ELSE                               0841 02306000
*                                 CALL EODFILT;            /*@Z427VLS*/ 02307000
         B     @RC00839                                            0841 02308000
@RF00839 BAL   @14,EODFILT                                         0841 02309000
*                             END;                         /*@Z427VLS*/ 02310000
*                         END;                             /*@Z427VLS*/ 02311000
*                     END;                                 /*@Z427VLS*/ 02312000
*                 END;                                     /*@Z427VLS*/ 02313000
*             END;                                         /*@Z427VLS*/ 02314000
*         END;                                             /*@Z427VLS*/ 02315000
*     END;                                                 /*@Z427VLS*/ 02316000
*   END;                                                   /*@Z427VLS*/ 02317000
*END;                                                      /*@Z427VLS*/ 02318000
@EL00016 DS    0H                                                  0850 02319000
@EF00016 DS    0H                                                  0850 02320000
@ER00016 LM    @14,@12,@SA00016                                    0850 02321000
         BR    @14                                                 0850 02322000
*TREADR: PROC;                                             /*@Z427VLS*/ 02323000
TREADR   STM   @14,@12,@SA00017                                    0851 02324000
*RESPECIFY(R3,R15) RESTRICTED;                             /*@Z427VLS*/ 02325000
*/*ADDRESS THE TRENDONE ENTRY THAT RELATES TO THE RECORD CPU @Z427VLS*/ 02326000
*/*SERIAL NUMBER. IF THE ENTRY DOES NOT EXIST, CREATE IT AND @Z427VLS*/ 02327000
*/*ADDRESS IT. TRENDONE ENTRY NUMBER IS EQUAL TO EVTABLE     @Z427VLS*/ 02328000
*/*ENTRY NUMBER.                                     IF MORE @Z427VLS*/ 02329000
*/*THAN 16 CPUS ARE IDENTIFIED, AN ERROR MESSAGE IS ISSUED   @Z427VLS*/ 02330000
*/*THE FIRST TIME, AND THE RECORDS FOR THE EXCESS CPUS ARE   @Z427VLS*/ 02331000
*/*SUMMED INTO THE 16TH CPU BUCKET BEFORE THE BUCKETS ARE IN @Z427VLS*/ 02332000
*/*CPU SERIAL ORDER. AN INDEX TO THE BUCKETS FOR THE RELATIVE*/    0853 02333000
*/*DATE IN TRENDONE IS CREATED.                              @Z427VLS*/ 02334000
*CPU0FLG = OFF; /*CPU INNOCENT UNTIL PROVEN GUILTY           @Z427VLS*/ 02335000
         NI    CPU0FLG,B'11110111'                                 0853 02336000
*CVB(BINDAY,LRTDAY); /*CONVERT RECORD DAY TO BINARY FROM PACKED*/  0854 02337000
         XC    @TS00001(8),@TS00001                                0854 02338000
         MVC   @TS00001+6(2),LRTDAY(R7)                            0854 02339000
         CVB   @14,@TS00001                                        0854 02340000
         ST    @14,BINDAY                                          0854 02341000
*IF CROSSFLG = YES THEN /*IF YEAR BOUNDARY IS CROSSED        @Z427VLS*/ 02342000
         TM    CROSSFLG,B'10000000'                                0855 02343000
         BNO   @RF00855                                            0855 02344000
*  DO;                                                     /*@Z427VLS*/ 02345000
*    IF BINDAY >  DEC335 THEN  /*IS DAY FROM OLD YEAR        @Z427VLS*/ 02346000
         C     @14,@CF00960                                        0857 02347000
         BNH   @RF00857                                            0857 02348000
*      TREIDX = BINDAY - DSTART + ONE; /*SET RELATIVE INDEX  @Z427VLS*/ 02349000
         SL    @14,DSTART                                          0858 02350000
         LA    @14,1(,@14)                                         0858 02351000
         STC   @14,TREIDX                                          0858 02352000
*    ELSE  /*DAY FROM NEW YEAR                               @Z427VLS*/ 02353000
*      TREIDX = BINDAY + ADDAFT; /*ADD OLD YEAR DAYS FOR PROPER INDEX*/ 02354000
         B     @RC00857                                            0859 02355000
@RF00857 L     @14,BINDAY                                          0859 02356000
         AL    @14,ADDAFT                                          0859 02357000
         STC   @14,TREIDX                                          0859 02358000
*  END;                                                    /*@Z427VLS*/ 02359000
*ELSE /*IF ALL DAYS IN SAME YEAR                             @Z427VLS*/ 02360000
*  TREIDX = BINDAY - DSTART + ONE;                         /*@Z427VLS*/ 02361000
         B     @RC00855                                            0861 02362000
@RF00855 L     @14,BINDAY                                          0861 02363000
         SL    @14,DSTART                                          0861 02364000
         LA    @14,1(,@14)                                         0861 02365000
         STC   @14,TREIDX                                          0861 02366000
*IF LRTCPUS = ZEROS THEN /*PROTECT AGAINST ZERO SERIAL NO. IN RECORD*/  02367000
@RC00855 CLC   LRTCPUS(3,R7),@CB00944                              0862 02368000
         BNE   @RF00862                                            0862 02369000
*  DO;                                                     /*@Z427VLS*/ 02370000
*    CPU0FLG = ON; /*DONT SAVE THIS RECORD                   @Z427VLS*/ 02371000
         OI    CPU0FLG,B'00001000'                                 0864 02372000
*    MSGNO = 5;                                            /*@Z427VLS*/ 02373000
         MVI   MSGNO,X'05'                                         0865 02374000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02375000
         BAL   @14,ERRMSG                                          0866 02376000
*  END;                                                    /*@Z427VLS*/ 02377000
*ELSE                                                              0868 02378000
*  DO;                                                     /*@Z427VLS*/ 02379000
         B     @RC00862                                            0868 02380000
@RF00862 DS    0H                                                  0869 02381000
*    TRENPTR = SAVEADR(1);                                 /*@Z427VLS*/ 02382000
         L     @14,SAVEADR                                         0869 02383000
         ST    @14,TRENPTR(,R2)                                    0869 02384000
*    GETOUT = NO;                                          /*@Z427VLS*/ 02385000
         NI    GETOUT,B'10111111'                                  0870 02386000
*    DO K = 1 BY 1 TO EVMAX WHILE GETOUT = NO;             /*@Z427VLS*/ 02387000
         LA    @14,1                                               0871 02388000
         ST    @14,K                                               0871 02389000
@DL00871 TM    GETOUT,B'01000000'                                  0871 02390000
         BNZ   @DC00871                                            0871 02391000
*      IF EVSERIAL(K) = LRTCPUS THEN                               0872 02392000
         MH    @14,@CH00081                                        0872 02393000
         L     @08,EVPTR(,R2)                                      0872 02394000
         ST    @14,@TF00001                                        0872 02395000
         ALR   @14,@08                                             0872 02396000
         CLC   EVSERIAL-6(3,@14),LRTCPUS(R7)                       0872 02397000
         BNE   @RF00872                                            0872 02398000
*        DO;                                               /*@Z427VLS*/ 02399000
*          EVMODEL(K) = LRTMODEL; /*SET IN CASE THIS ENTRY CREATED*/    02400000
         AL    @08,@TF00001                                        0874 02401000
         MVC   EVMODEL-6(2,@08),LRTMODEL(R7)                       0874 02402000
*          GETOUT = YES;          /*FROM EVTABLE ENTRY WHICH IS   */    02403000
         OI    GETOUT,B'01000000'                                  0875 02404000
*        END;                     /*MISSING MODEL NUMBER     @Z427VLS*/ 02405000
*      ELSE                                                        0877 02406000
*        DO;                                               /*@Z427VLS*/ 02407000
         B     @RC00872                                            0877 02408000
@RF00872 DS    0H                                                  0878 02409000
*          IF TRENEXT ^= ZERO & TRENPTR ^= ZERO THEN /*IF ANOTHER*/     02410000
         SLR   @14,@14                                             0878 02411000
         L     @08,TRENPTR(,R2)                                    0878 02412000
         L     @06,TRENEXT(,@08)                                   0878 02413000
         CR    @06,@14                                             0878 02414000
         BE    @RF00878                                            0878 02415000
         CR    @08,@14                                             0878 02416000
         BE    @RF00878                                            0878 02417000
*          /*ENTRY OF TRENDONE AND ANOTHER ENTRY OF EVTABLE EXIST.*/    02418000
*          /*ALSO, IF AN ENTRY OS TRENDONE HAS BEEN CREATED  @Z427VLS*/ 02419000
*                TRENPTR = TRENEXT; /*RESET BASE TO NEXT ENTRY*/   0879 02420000
         ST    @06,TRENPTR(,R2)                                    0879 02421000
*          ELSE                                                    0880 02422000
*            DO;                                           /*@Z427VLS*/ 02423000
         B     @RC00878                                            0880 02424000
@RF00878 DS    0H                                                  0881 02425000
*              GETOUT = YES; /*ONLY CREATE ONE ENTRY PER CPU @Z427VLS*/ 02426000
         OI    GETOUT,B'01000000'                                  0881 02427000
*              IF K < EVMAX | /*IF ROOM FOR ANOTHER EVTABLE ENTRY OR*/  02428000
*                (K = EVMAX & EVSERIAL(K) = ZERO) THEN /*LAST ENTRY*/   02429000
         L     @14,K                                               0882 02430000
         LA    @08,16                                              0882 02431000
         CR    @14,@08                                             0882 02432000
         BL    @RT00882                                            0882 02433000
         CR    @14,@08                                             0882 02434000
         BNE   @RF00882                                            0882 02435000
         MH    @14,@CH00081                                        0882 02436000
         L     @08,EVPTR(,R2)                                      0882 02437000
         L     @14,EVSERIAL-7(@14,@08)                             0882 02438000
         LA    @14,0(,@14)                                         0882 02439000
         LTR   @14,@14                                             0882 02440000
         BNZ   @RF00882                                            0882 02441000
@RT00882 DS    0H                                                  0883 02442000
*                  /*OF EVTABLE BUT IT HAS NOT BEEN SET THEN @Z427VLS*/ 02443000
*                DO;                                       /*@Z427VLS*/ 02444000
*                  L = EVNUM + 1; /*INDEX TO UNBUILT ENTRY   @Z427VLS*/ 02445000
         L     @14,EVPTR(,R2)                                      0884 02446000
         LA    @08,1                                               0884 02447000
         AH    @08,EVNUM(,@14)                                     0884 02448000
         ST    @08,L                                               0884 02449000
*                  R3 = TREN1SIZ; /*LENGTH OF TRENDONE IN BYTES*/  0885 02450000
         L     R3,TREN1SIZ                                         0885 02451000
*                  GEN(GETMAIN EC,LV=(R3),A=COMPLINK); /*GET CORE FOR*/ 02452000
         GETMAIN EC,LV=(R3),A=COMPLINK                                  02453000
*                                           /*NEW TRENDONE ENTRY*/ 0887 02454000
*                  IF R15 = ZERO THEN /*IF GETMAIN IS SUCCESSFUL*/ 0887 02455000
         SLR   @14,@14                                             0887 02456000
         CR    R15,@14                                             0887 02457000
         BNE   @RF00887                                            0887 02458000
*                  DO;                                     /*@Z427VLS*/ 02459000
*                  IF EVNUM > ZERO THEN /*IF NOT ONLY ENTRY EXISTANT*/  02460000
         L     @08,EVPTR(,R2)                                      0889 02461000
         CH    @14,EVNUM(,@08)                                     0889 02462000
         BNL   @RF00889                                            0889 02463000
*                    TRENEXT = COMPLINK; /*FORWARD PTR TO CREATED ENT*/ 02464000
         L     @14,TRENPTR(,R2)                                    0890 02465000
         L     @08,COMPLINK                                        0890 02466000
         ST    @08,TRENEXT(,@14)                                   0890 02467000
*                  TRENPTR = COMPLINK; /*ADDRESS NEW ENTRY OF TRENDONE* 02468000
@RF00889 L     @14,COMPLINK                                        0891 02469000
         ST    @14,TRENPTR(,R2)                                    0891 02470000
*                  DO Q = 1 BY 1 TO NUMDAYS; /*CLEAR NEW ENTRY*/   0892 02471000
         LA    @14,1                                               0892 02472000
         ST    @14,Q                                               0892 02473000
         B     @DE00892                                            0892 02474000
@DL00892 DS    0H                                                  0893 02475000
*                    TREGEN(Q) = (TREGEN(Q) && TREGEN(Q)); /*@Z427VLS*/ 02476000
         LR    @08,@14                                             0893 02477000
         MH    @08,@CH01361                                        0893 02478000
         L     @06,TRENPTR(,R2)                                    0893 02479000
         ALR   @06,@08                                             0893 02480000
         AL    @06,@CF01573                                        0893 02481000
         XC    TREGEN-8(76,@06),TREGEN-8(@06)                      0893 02482000
*                  END;                                    /*@Z427VLS*/ 02483000
         AL    @14,@CF00055                                        0894 02484000
         ST    @14,Q                                               0894 02485000
@DE00892 C     @14,NUMDAYS(,R2)                                    0894 02486000
         BNH   @DL00892                                            0894 02487000
*                  TRENEXT = (TRENEXT && TRENEXT);         /*@Z427VLS*/ 02488000
         L     @14,TRENPTR(,R2)                                    0895 02489000
         L     @08,TRENEXT(,@14)                                   0895 02490000
         LR    @06,@08                                             0895 02491000
         XR    @06,@08                                             0895 02492000
         ST    @06,TRENEXT(,@14)                                   0895 02493000
*                  TRENUM = (TRENUM && TRENUM);            /*@Z427VLS*/ 02494000
         L     @08,TRENUM(,@14)                                    0896 02495000
         LR    @06,@08                                             0896 02496000
         XR    @06,@08                                             0896 02497000
         ST    @06,TRENUM(,@14)                                    0896 02498000
*                  EVMODEL(L) = LRTMODEL; /*SET NEW EVTABLE ENTRY FOR*/ 02499000
         L     @08,L                                               0897 02500000
         LR    @06,@08                                             0897 02501000
         MH    @06,@CH00081                                        0897 02502000
         L     @05,EVPTR(,R2)                                      0897 02503000
         ST    @06,@TF00001                                        0897 02504000
         ALR   @06,@05                                             0897 02505000
         MVC   EVMODEL-6(2,@06),LRTMODEL(R7)                       0897 02506000
*                  EVSERIAL(L) = LRTCPUS; /*CPU IDENTIFIED AS UNIQUE*/  02507000
         LR    @06,@05                                             0898 02508000
         AL    @06,@TF00001                                        0898 02509000
         MVC   EVSERIAL-6(3,@06),LRTCPUS(R7)                       0898 02510000
*                  SAVEADR(L) = TRENPTR; /*SAVE ADDRESS FOR SORTING*/   02511000
         SLA   @08,2                                               0899 02512000
         ST    @14,SAVEADR-4(@08)                                  0899 02513000
*                  EVNUM = EVNUM + 1; /*ADD 1 TO NUMBER OF ENTRIES*/    02514000
         LA    @14,1                                               0900 02515000
         AH    @14,EVNUM(,@05)                                     0900 02516000
         STH   @14,EVNUM(,@05)                                     0900 02517000
*                  END;                                    /*@Z427VLS*/ 02518000
*                  ELSE                                            0902 02519000
*                    DO;                                   /*@Z427VLS*/ 02520000
         B     @RC00887                                            0902 02521000
@RF00887 DS    0H                                                  0903 02522000
*                      MSGNO = ONE; /*TELL NOT ENOUGH CORE FOR TABLE*/  02523000
         MVI   MSGNO,X'01'                                         0903 02524000
*                      CALL ERRMSG;                        /*@Z427VLS*/ 02525000
         BAL   @14,ERRMSG                                          0904 02526000
*                      R15 = NOSRTABL;                     /*@0001VLS*/ 02527000
         LA    R15,12                                              0905 02528000
*                      GETFAIL = YES;                      /*@0001VLS*/ 02529000
         OI    GETFAIL,B'00000100'                                 0906 02530000
*                    END;                                  /*@Z427VLS*/ 02531000
*                END;                                      /*@Z427VLS*/ 02532000
*              ELSE  /*HERE WE HAVE NEW CPU WITH NO ROOM IN EVTABLE*/   02533000
*                DO;                                       /*@Z427VLS*/ 02534000
         B     @RC00882                                            0909 02535000
@RF00882 DS    0H                                                  0910 02536000
*                  BUG(30) = BUG(30) + 1; /*RECORD FOR EXCESS CPU*/     02537000
         LA    @14,1                                               0910 02538000
         AL    @14,BUG+116                                         0910 02539000
         ST    @14,BUG+116                                         0910 02540000
*                  IF FIRSTIME = OFF   THEN /*PRINT ERROR MESSAGE ONLY* 02541000
         TM    FIRSTIME,B'00100000'                                0911 02542000
         BNZ   @RF00911                                            0911 02543000
*                    DO;                    /*FOR FIRST EXCESS CPU*/    02544000
*                      MSGNO = 6;                          /*@Z427VLS*/ 02545000
         MVI   MSGNO,X'06'                                         0913 02546000
*                      CALL ERRMSG;                        /*@Z427VLS*/ 02547000
         BAL   @14,ERRMSG                                          0914 02548000
*                      FIRSTIME = ON;       /*NEVER TO RETURN*/    0915 02549000
         OI    FIRSTIME,B'00100000'                                0915 02550000
*                      EVSERIAL(K) = 'FFFFFF'X; /*RESET TO NO ROOM ID*/ 02551000
         L     @14,K                                               0916 02552000
         MH    @14,@CH00081                                        0916 02553000
         L     @08,EVPTR(,R2)                                      0916 02554000
         ST    @14,@TF00001                                        0916 02555000
         ALR   @14,@08                                             0916 02556000
         MVC   EVSERIAL-6(3,@14),@CB00237                          0916 02557000
*                      EVMODEL(K) = 'FFFF'X; /*WILL SORT 1ST @Z427VLS*/ 02558000
         AL    @08,@TF00001                                        0917 02559000
         MVC   EVMODEL-6(2,@08),@CB00261                           0917 02560000
*                    END;                                  /*@Z427VLS*/ 02561000
*                 END;                                     /*@Z427VLS*/ 02562000
@RF00911 DS    0H                                                  0920 02563000
*               END;                                       /*@Z427VLS*/ 02564000
@RC00882 DS    0H                                                  0921 02565000
*             END;                                         /*@Z427VLS*/ 02566000
@RC00878 DS    0H                                                  0922 02567000
*         END;                                             /*@Z427VLS*/ 02568000
@RC00872 LA    @14,1                                               0922 02569000
         AL    @14,K                                               0922 02570000
         ST    @14,K                                               0922 02571000
         C     @14,@CF00088                                        0922 02572000
         BNH   @DL00871                                            0922 02573000
@DC00871 DS    0H                                                  0923 02574000
*      END;                                                /*@Z427VLS*/ 02575000
*ERROR = R15; /*COMMUNICATE ERROR CONDITIONS TO CALLING PROC @Z427VLS*/ 02576000
@RC00862 ST    R15,ERROR                                           0924 02577000
*RESPECIFY(R3,R15) UNRESTRICTED;                           /*@Z427VLS*/ 02578000
* END; /*CLOSING END FOR SUMONADR                            @Z427VLS*/ 02579000
@EL00017 DS    0H                                                  0926 02580000
@EF00017 DS    0H                                                  0926 02581000
@ER00017 LM    @14,@12,@SA00017                                    0926 02582000
         BR    @14                                                 0926 02583000
*CALCRANG: PROC; /*CALCULATE NUMBER OF DAYS IN DATE RANGE    @Z427VLS*/ 02584000
CALCRANG STM   @14,@12,12(@13)                                     0927 02585000
*CVB(DSTART,PSTDY); /*CHANGE PACKED START DAY TO BINARY      @Z427VLS*/ 02586000
         XC    @TS00001(8),@TS00001                                0928 02587000
         MVC   @TS00001+6(2),PSTDY(R2)                             0928 02588000
         CVB   @08,@TS00001                                        0928 02589000
         ST    @08,DSTART                                          0928 02590000
*CVB(DEND,PENDY); /*CHANGE PACKED END DAY TO BINARY          @Z427VLS*/ 02591000
         XC    @TS00001(8),@TS00001                                0929 02592000
         MVC   @TS00001+6(2),PENDY(R2)                             0929 02593000
         CVB   @06,@TS00001                                        0929 02594000
         ST    @06,DEND                                            0929 02595000
*IF DSTART > DEND THEN /*IF CROSS YEAR BOUNDARY              @Z427VLS*/ 02596000
         CR    @08,@06                                             0930 02597000
         BNH   @RF00930                                            0930 02598000
*  DO;                                                     /*@Z427VLS*/ 02599000
*    CROSSFLG = YES; /*YEAR BOUNDARY CROSSED FLAG            @Z427VLS*/ 02600000
         OI    CROSSFLG,B'10000000'                                0932 02601000
*    ADDAFT = DEC366 - DSTART; /*CREATE RELATIVE INDEX IF AFTER END*/   02602000
         LCR   @08,@08                                             0933 02603000
         AL    @08,@CF00936                                        0933 02604000
         ST    @08,ADDAFT                                          0933 02605000
*                              /*OF YEAR                     @Z427VLS*/ 02606000
*    NUMDAYS = DEC366 - DSTART + DEND;                     /*@Z427VLS*/ 02607000
         ALR   @06,@08                                             0934 02608000
         ST    @06,NUMDAYS(,R2)                                    0934 02609000
*    YRSAVE1 = (YRSAVE1 && YRSAVE1); /*ZERO HIGH BYTE        @Z427VLS*/ 02610000
         XC    YRSAVE1(1),YRSAVE1                                  0935 02611000
*    YRSAVE2 = PSTYR; /*GET DECIMAL YEAR FROM RECORD         @Z427VLS*/ 02612000
         MVC   YRSAVE2(1),PSTYR(R2)                                0936 02613000
*    SLL(YRSAVE,4); /*SHIFT 4 BITS TO MAKE ROOM FOR SIGN     @Z427VLS*/ 02614000
         SLR   @03,@03                                             0937 02615000
         ICM   @03,3,YRSAVE                                        0937 02616000
         SLL   @03,4                                               0937 02617000
         STCM  @03,3,YRSAVE                                        0937 02618000
*    YRSAVE2 = (YRSAVE2 | '0F'X); /*INSERT SIGN, NUMBER NOW PACKED*/    02619000
         OI    YRSAVE2,X'0F'                                       0938 02620000
*    CVB(YEAR,YRSAVE); /*CHANGE PACKED TO BINARY             @Z427VLS*/ 02621000
         XC    @TS00001(8),@TS00001                                0939 02622000
         MVC   @TS00001+6(2),YRSAVE                                0939 02623000
         CVB   @03,@TS00001                                        0939 02624000
         STH   @03,YEAR                                            0939 02625000
*    IF (YEARC & LEAPMASK) = HEX0000 THEN /*IF LEAP YEARC THEN*/   0940 02626000
         MVC   @TS00001(2),YEARC                                   0940 02627000
         NC    @TS00001(2),@CB00995                                0940 02628000
         CLC   @TS00001(2),@CB00208                                0940 02629000
         BNE   @RF00940                                            0940 02630000
*     DO;                                                  /*@Z427VLS*/ 02631000
*      NUMDAYS = NUMDAYS + ONE;                            /*@Z427VLS*/ 02632000
         LA    @03,1                                               0942 02633000
         ALR   @06,@03                                             0942 02634000
         ST    @06,NUMDAYS(,R2)                                    0942 02635000
*      ADDAFT = ADDAFT + ONE; /*ONE MORE DAT IN LEAPYEAR     @Z427VLS*/ 02636000
         ALR   @08,@03                                             0943 02637000
         ST    @08,ADDAFT                                          0943 02638000
*     END;                                                 /*@Z427VLS*/ 02639000
*  END;                                                    /*@Z427VLS*/ 02640000
*ELSE /*IF SAME YEAR                                         @Z427VLS*/ 02641000
*  NUMDAYS = DEND - DSTART + ONE;                          /*@Z427VLS*/ 02642000
         B     @RC00930                                            0946 02643000
@RF00930 L     @08,DEND                                            0946 02644000
         SL    @08,DSTART                                          0946 02645000
         AL    @08,@CF00055                                        0946 02646000
         ST    @08,NUMDAYS(,R2)                                    0946 02647000
*END; /*CLOSING END TO CALCRANGE                             @Z427VLS*/ 02648000
@EL00018 DS    0H                                                  0947 02649000
@EF00018 DS    0H                                                  0947 02650000
@ER00018 LM    @14,@12,12(@13)                                     0947 02651000
         BR    @14                                                 0947 02652000
*OBRFILT: PROC;                                            /*@Z427VLS*/ 02653000
OBRFILT  STM   @14,@12,@SA00019                                    0948 02654000
*IF POBR = OFF THEN                                                0949 02655000
         TM    POBR(R2),B'00100000'                                0949 02656000
         BNZ   @RF00949                                            0949 02657000
*  PASSFLAG=OFF;                                           /*@Z427VLS*/ 02658000
         NI    PASSFLAG(R2),B'11111110'                            0950 02659000
*ELSE                                                              0951 02660000
*  DO;                                                     /*@Z427VLS*/ 02661000
         B     @RC00949                                            0951 02662000
@RF00949 DS    0H                                                  0952 02663000
*    IF SHORTSW = ON THEN /*IF SHORT OBR THEN                @Z427VLS*/ 02664000
         TM    SHORTSW(R7),B'00100000'                             0952 02665000
         BNO   @RF00952                                            0952 02666000
*      DO;                                                 /*@Z427VLS*/ 02667000
*         WORKDEV = OBRSDEV2; /*GET DEVICE CODE FROM SHORT LOCATION*/   02668000
         MVC   WORKDEV(2),OBRSDEV2(R7)                             0954 02669000
*         WWCUA = (OBRSCUA & ONLYCUA3);                    /*@Z427VLS*/ 02670000
         MVC   WWCUA(3),OBRSCUA(R7)                                0955 02671000
         NC    WWCUA(3),@CB00912                                   0955 02672000
*         CUA3 = WWCUA;                                    /*@Z427VLS*/ 02673000
         MVC   CUA3(3),WWCUA                                       0956 02674000
*      END;                                                /*@Z427VLS*/ 02675000
*    ELSE /*LONG OBR BY DEFAULT                              @Z427VLS*/ 02676000
*      DO;                                                 /*@Z427VLS*/ 02677000
         B     @RC00952                                            0958 02678000
@RF00952 DS    0H                                                  0959 02679000
*        WORKDEV = OBRDEV; /*GET DEVICE CODE FROM LONG LOCATION*/  0959 02680000
         MVC   WORKDEV(2),OBRDEV(R7)                               0959 02681000
*        WWCUA = (OBRPCUA & ONLYCUA3);                     /*@Z427VLS*/ 02682000
         MVC   WWCUA(3),OBRPCUA(R7)                                0960 02683000
         NC    WWCUA(3),@CB00912                                   0960 02684000
*        CUA3 = WWCUA;                                     /*@Z427VLS*/ 02685000
         MVC   CUA3(3),WWCUA                                       0961 02686000
*      END;                                                /*@Z427VLS*/ 02687000
*    IF CUAPTR ^= ZERO THEN /*IF CUA SELECTION SPECIFIED THEN*/    0963 02688000
@RC00952 L     @08,CUAPTR(,R2)                                     0963 02689000
         LTR   @08,@08                                             0963 02690000
         BZ    @RF00963                                            0963 02691000
*      CALL CUASELCT; /*EXAMINE LIST OF VALID CUAS           @Z427VLS*/ 02692000
         BAL   @14,CUASELCT                                        0964 02693000
*    IF PASSFLAG = YES THEN                                        0965 02694000
@RF00963 TM    PASSFLAG(R2),B'00000001'                            0965 02695000
         BNO   @RF00965                                            0965 02696000
*      DO;                                                 /*@Z427VLS*/ 02697000
*        IF DEVPTR ^= ZERO THEN /*IF DEVICE SELECTION SPECIFIED THEN*/  02698000
         L     @08,DEVPTR(,R2)                                     0967 02699000
         LTR   @08,@08                                             0967 02700000
         BZ    @RF00967                                            0967 02701000
*          CALL DEVSEL; /*EXAMINE LIST OF VALID DEVICES      @Z427VLS*/ 02702000
         BAL   @14,DEVSEL                                          0968 02703000
*        IF PASSFLAG = YES THEN                                    0969 02704000
@RF00967 TM    PASSFLAG(R2),B'00000001'                            0969 02705000
         BNO   @RF00969                                            0969 02706000
*          CALL COUNTOBR; /*COUNT PERM,TEMP ERRS IF IN RECORD*/    0970 02707000
         BAL   @14,COUNTOBR                                        0970 02708000
*      END;                                                /*@Z427VLS*/ 02709000
*  END;                                                    /*@Z427VLS*/ 02710000
*END; /*CLOSING END OF OBRFILT                               @Z427VLS*/ 02711000
@EL00019 DS    0H                                                  0973 02712000
@EF00019 DS    0H                                                  0973 02713000
@ER00019 LM    @14,@12,@SA00019                                    0973 02714000
         BR    @14                                                 0973 02715000
*MDRFILT: PROC;   /*MISCELLANEOUS DATA RECORD FILTER.        @Z427VLS*/ 02716000
MDRFILT  STM   @14,@12,@SA00020                                    0974 02717000
*                 /*PASSFLAG IS TURNED OFF IF RECORD FAILS   @Z427VLS*/ 02718000
*IF PTTYP = OFF THEN  /*ARE MDR RECORDS SELECTED             @Z427VLS*/ 02719000
         TM    PTTYP(R2),B'10000000'                               0975 02720000
         BNZ   @RF00975                                            0975 02721000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02722000
         NI    PASSFLAG(R2),B'11111110'                            0976 02723000
*ELSE /*IF MDR RECORDS HAVE BEEN SELECTED THEN               @Z427VLS*/ 02724000
*  DO;                                                     /*@Z427VLS*/ 02725000
         B     @RC00975                                            0977 02726000
@RF00975 DS    0H                                                  0978 02727000
*    WWCUA2 = (TPRCUA & ONLYCUA2);                         /*@XA22630*/ 02728000
         MVC   WWCUA2(2),TPRCUA(R7)                                0978 02729000
         NC    WWCUA2(2),@CB00910                                  0978 02730000
*    WORKDEV = TPRDEV; /*SET WORK ITEM TO RECORD DEVICE CODE @Z427VLS*/ 02731000
         MVI   WORKDEV+1,C' '                                      0979 02732000
         MVC   WORKDEV(1),TPRDEV(R7)                               0979 02733000
*    IF CUAPTR ^= ZERO THEN /*IF CUA SELECTION SPECIFIED THEN*/    0980 02734000
         L     @08,CUAPTR(,R2)                                     0980 02735000
         LTR   @08,@08                                             0980 02736000
         BZ    @RF00980                                            0980 02737000
*      CALL CUASELCT; /*EXAMINE LIST OF VALID CUAS           @Z427VLS*/ 02738000
         BAL   @14,CUASELCT                                        0981 02739000
*    IF PASSFLAG = YES THEN                                        0982 02740000
@RF00980 TM    PASSFLAG(R2),B'00000001'                            0982 02741000
         BNO   @RF00982                                            0982 02742000
*      DO;                                                 /*@Z427VLS*/ 02743000
*         IF DEVPTR ^= ZERO THEN /*IF DEVICE SELECTION SPECIFIED*/ 0984 02744000
         L     @08,DEVPTR(,R2)                                     0984 02745000
         LTR   @08,@08                                             0984 02746000
         BZ    @RF00984                                            0984 02747000
*           CALL DEVSEL; /*EXAMINE DEVICE SELECTION LIST     @Z427VLS*/ 02748000
         BAL   @14,DEVSEL                                          0985 02749000
*         IF PASSFLAG = YES THEN /*IF VALID DEVICE TYPE THEN @Z427VLS*/ 02750000
@RF00984 TM    PASSFLAG(R2),B'00000001'                            0986 02751000
         BNO   @RF00986                                            0986 02752000
*           DO;                                            /*@Z427VLS*/ 02753000
*    IF LRTKEY1 = HEX91 & (TPRDEV = DV3705 | TPRDEV = DV3705A) THEN     02754000
         CLI   LRTKEY1(R7),X'91'                                   0988 02755000
         BNE   @RF00988                                            0988 02756000
         CLI   TPRDEV(R7),X'05'                                    0988 02757000
         BE    @RT00988                                            0988 02758000
         CLI   TPRDEV(R7),X'15'                                    0988 02759000
         BNE   @RF00988                                            0988 02760000
@RT00988 DS    0H                                                  0989 02761000
*               CALL CONTMDR; /*PERM,TEMP ERRORS IF FROM MVS SYSTEM*/   02762000
         BAL   @14,CONTMDR                                         0989 02763000
*             ELSE                                                 0990 02764000
*               DO;                                        /*@Z427VLS*/ 02765000
         B     @RC00988                                            0990 02766000
@RF00988 DS    0H                                                  0991 02767000
*                 IF TPRDEV = DV3330 |                             0991 02768000
*                    TPRDEV = DV3340 |                             0991 02769000
*                    TPRDEV = DV33302 |                            0991 02770000
*                    TPRDEV = DV3350 THEN                          0991 02771000
         CLI   TPRDEV(R7),X'01'                                    0991 02772000
         BE    @RT00991                                            0991 02773000
         CLI   TPRDEV(R7),X'09'                                    0991 02774000
         BE    @RT00991                                            0991 02775000
         CLI   TPRDEV(R7),X'0A'                                    0991 02776000
         BE    @RT00991                                            0991 02777000
         CLI   TPRDEV(R7),X'11'                                    0991 02778000
         BNE   @RF00991                                            0991 02779000
@RT00991 DS    0H                                                  0992 02780000
*                   DO;                                    /*@Z427VLS*/ 02781000
*                     TRENDTMP  = TRENDTMP                         0993 02782000
*                                 + TPRS1213                       0993 02783000
*                                 + TPRS1415                       0993 02784000
*                                 + TPRS19;                /*@Z427VLS*/ 02785000
         LA    @08,TPRVOL(,R7)                                     0993 02786000
         LA    @06,15                                              0993 02787000
         SLR   @03,@03                                             0993 02788000
         IC    @03,TPRBUFC(,R7)                                    0993 02789000
         NR    @06,@03                                             0993 02790000
         ALR   @08,@06                                             0993 02791000
         AL    @08,@CF01167                                        0993 02792000
         ICM   @06,15,TRENDTMP                                     0993 02793000
         SLR   @03,@03                                             0993 02794000
         ICM   @03,3,TPRS1213(@08)                                 0993 02795000
         ALR   @06,@03                                             0993 02796000
         SLR   @03,@03                                             0993 02797000
         ICM   @03,3,TPRS1415(@08)                                 0993 02798000
         ALR   @06,@03                                             0993 02799000
         SLR   @03,@03                                             0993 02800000
         IC    @03,TPRS19(,@08)                                    0993 02801000
         ALR   @06,@03                                             0993 02802000
         STCM  @06,15,TRENDTMP                                     0993 02803000
*                     BUG(34) = BUG(34) + 1;               /*@Z427VLS*/ 02804000
         LA    @08,1                                               0994 02805000
         L     @03,BUG+132                                         0994 02806000
         ALR   @03,@08                                             0994 02807000
         ST    @03,BUG+132                                         0994 02808000
*                     IF TRENDTMP   > ZERO THEN                    0995 02809000
         LTR   @06,@06                                             0995 02810000
         BNP   @RF00995                                            0995 02811000
*                       DO;                                /*@Z427VLS*/ 02812000
*                         BUG(35) = BUG(35) + 1;           /*@Z427VLS*/ 02813000
         AL    @08,BUG+136                                         0997 02814000
         ST    @08,BUG+136                                         0997 02815000
*                         TRENDGRP  = TWO;               /*@Z427VLS*/   02816000
         MVI   TRENDGRP,X'02'                                      0998 02817000
*                         TRENDRT   = (TPRCUA & ONLYCUA2); /*@0099VLS*/ 02818000
         MVC   TRENDRT(2),TPRCUA(R7)                               0999 02819000
         NC    TRENDRT(2),@CB00910                                 0999 02820000
*                         WORKCUA = (TPRCUA & ONLYCUA2);   /*@Z427VLS*/ 02821000
         MVC   WORKCUA(2),TPRCUA(R7)                               1000 02822000
         NC    WORKCUA(2),@CB00910                                 1000 02823000
*                         IF TPRDEV    = DV3330 |                  1001 02824000
*                            TPRDEV    = DV33302 THEN              1001 02825000
         CLI   TPRDEV(R7),X'01'                                    1001 02826000
         BE    @RT01001                                            1001 02827000
         CLI   TPRDEV(R7),X'0A'                                    1001 02828000
         BNE   @RF01001                                            1001 02829000
@RT01001 DS    0H                                                  1002 02830000
*                           TRENDDEV  = '3330'X;         /*@Z427VLS*/   02831000
         MVC   TRENDDEV(2),@CB01469                                1002 02832000
*                         ELSE                                     1003 02833000
*                           DO;                            /*@Z427VLS*/ 02834000
         B     @RC01001                                            1003 02835000
@RF01001 DS    0H                                                  1004 02836000
*                             IF TPRDEV = DV3340 THEN              1004 02837000
         CLI   TPRDEV(R7),X'09'                                    1004 02838000
         BNE   @RF01004                                            1004 02839000
*                               TRENDDEV  = '3340'X;     /*@Z427VLS*/   02840000
         MVC   TRENDDEV(2),@CB01470                                1005 02841000
*                             ELSE                                 1006 02842000
*                               TRENDDEV  = '3350'X;     /*@Z427VLS*/   02843000
         B     @RC01004                                            1006 02844000
@RF01004 MVC   TRENDDEV(2),@CB01471                                1006 02845000
*                           END;                           /*@Z427VLS*/ 02846000
@RC01004 DS    0H                                                  1008 02847000
*                         CALL SETCPU;                     /*@Z427VLS*/ 02848000
@RC01001 BAL   @14,SETCPU                                          1008 02849000
*                         TRENDDAT  = TREIDX;            /*@Z427VLS*/   02850000
         IC    @08,TREIDX                                          1009 02851000
         STC   @08,TRENDDAT                                        1009 02852000
*                       END;                               /*@Z427VLS*/ 02853000
*                     END;                                 /*@Z427VLS*/ 02854000
*                   ELSE                                           1012 02855000
*                     BUG(31) = BUG(31) +1;                /*@Z427VLS*/ 02856000
         B     @RC00991                                            1012 02857000
@RF00991 LA    @08,1                                               1012 02858000
         AL    @08,BUG+120                                         1012 02859000
         ST    @08,BUG+120                                         1012 02860000
*                 END;                                     /*@Z427VLS*/ 02861000
*           END;                                           /*@Z427VLS*/ 02862000
*       END;                                               /*@Z427VLS*/ 02863000
*  END;                                                    /*@Z427VLS*/ 02864000
*END;/*CLOSING END FOR MDRFILT PROC                          @Z427VLS*/ 02865000
@EL00020 DS    0H                                                  1017 02866000
@EF00020 DS    0H                                                  1017 02867000
@ER00020 LM    @14,@12,@SA00020                                    1017 02868000
         BR    @14                                                 1017 02869000
*DDRFILT: PROC;                                            /*@Z427VLS*/ 02870000
DDRFILT  STM   @14,@12,@SA00021                                    1018 02871000
*BUG(24) = BUG(24) + 1; /*DDRS IDENTIFIED                    @Z427VLS*/ 02872000
         LA    @08,1                                               1019 02873000
         AL    @08,BUG+92                                          1019 02874000
         ST    @08,BUG+92                                          1019 02875000
*IF PDDR = OFF THEN                                                1020 02876000
         TM    PDDR(R2),B'00000100'                                1020 02877000
         BNZ   @RF01020                                            1020 02878000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02879000
         NI    PASSFLAG(R2),B'11111110'                            1021 02880000
*ELSE                                                              1022 02881000
*  DO;                                                     /*@Z427VLS*/ 02882000
         B     @RC01020                                            1022 02883000
@RF01020 DS    0H                                                  1023 02884000
*    IF CUAPTR ^= ZERO THEN /*IF CUA SELECTION SPECIFIED THEN*/    1023 02885000
         L     @08,CUAPTR(,R2)                                     1023 02886000
         LTR   @08,@08                                             1023 02887000
         BZ    @RF01023                                            1023 02888000
*      DO;                                                 /*@Z427VLS*/ 02889000
*      WWCUA = DDRFCUA; /*GET FROM CUA FROM RECORD           @Z427VLS*/ 02890000
         MVC   WWCUA(3),DDRFCUA(R7)                                1025 02891000
*      CALL CUASELCT; /*EXAMINE LIST OF VALID CUA RANGES     @Z427VLS*/ 02892000
         BAL   @14,CUASELCT                                        1026 02893000
*      END;                                                /*@Z427VLS*/ 02894000
*    IF PASSFLAG = YES THEN /*IF CUA ON LIST THEN            @Z427VLS*/ 02895000
@RF01023 TM    PASSFLAG(R2),B'00000001'                            1028 02896000
         BNO   @RF01028                                            1028 02897000
*      DO;                                                 /*@Z427VLS*/ 02898000
*        IF DEVPTR ^= ZERO THEN                                    1030 02899000
         L     @08,DEVPTR(,R2)                                     1030 02900000
         LTR   @08,@08                                             1030 02901000
         BZ    @RF01030                                            1030 02902000
*          DO;                                             /*@Z427VLS*/ 02903000
*          WORKDEV = DDRCODE2;                             /*@Z427VLS*/ 02904000
         MVC   WORKDEV(2),DDRCODE2(R7)                             1032 02905000
*          CALL DEVSEL;                                    /*@Z427VLS*/ 02906000
         BAL   @14,DEVSEL                                          1033 02907000
*          END;                                            /*@Z427VLS*/ 02908000
*        IF PASSFLAG = YES THEN                                    1035 02909000
@RF01030 TM    PASSFLAG(R2),B'00000001'                            1035 02910000
         BNO   @RF01035                                            1035 02911000
*          BUG(25) = BUG(25) + 1;                          /*@Z427VLS*/ 02912000
         LA    @08,1                                               1036 02913000
         AL    @08,BUG+96                                          1036 02914000
         ST    @08,BUG+96                                          1036 02915000
*      END;                                                /*@Z427VLS*/ 02916000
*  END;                                                    /*@Z427VLS*/ 02917000
*END;                                                      /*@Z427VLS*/ 02918000
@EL00021 DS    0H                                                  1039 02919000
@EF00021 DS    0H                                                  1039 02920000
@ER00021 LM    @14,@12,@SA00021                                    1039 02921000
         BR    @14                                                 1039 02922000
*MIHFILT: PROC;                                            /*@Z427VLS*/ 02923000
MIHFILT  STM   @14,@12,@SA00022                                    1040 02924000
*BUG(26) = BUG(26) + 1; /*NUMBER OF MIH RECORDS IDENTIFIED   @Z427VLS*/ 02925000
         LA    @08,1                                               1041 02926000
         AL    @08,BUG+100                                         1041 02927000
         ST    @08,BUG+100                                         1041 02928000
*IF PMIH = OFF THEN                                                1042 02929000
         TM    PMIH(R2),B'00000010'                                1042 02930000
         BNZ   @RF01042                                            1042 02931000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02932000
         NI    PASSFLAG(R2),B'11111110'                            1043 02933000
*ELSE                                                              1044 02934000
*  DO;                                                     /*@Z427VLS*/ 02935000
         B     @RC01042                                            1044 02936000
@RF01042 DS    0H                                                  1045 02937000
*    IF CUAPTR ^= ZERO THEN                                        1045 02938000
         L     @08,CUAPTR(,R2)                                     1045 02939000
         LTR   @08,@08                                             1045 02940000
         BZ    @RF01045                                            1045 02941000
*      DO;                                                 /*@Z427VLS*/ 02942000
*        WWCUA = MIHCUA;                                   /*@Z427VLS*/ 02943000
         MVC   WWCUA(3),MIHCUA(R7)                                 1047 02944000
*        CALL CUASELCT;                                    /*@Z427VLS*/ 02945000
         BAL   @14,CUASELCT                                        1048 02946000
*      END;                                                /*@Z427VLS*/ 02947000
*    IF PASSFLAG = YES THEN                                        1050 02948000
@RF01045 TM    PASSFLAG(R2),B'00000001'                            1050 02949000
         BNO   @RF01050                                            1050 02950000
*      DO;                                                 /*@Z427VLS*/ 02951000
*        IF DEVPTR ^= ZERO THEN /*IF DEVICE SELECTION SPECIFIED*/  1052 02952000
         L     @08,DEVPTR(,R2)                                     1052 02953000
         LTR   @08,@08                                             1052 02954000
         BZ    @RF01052                                            1052 02955000
*          DO;                                             /*@Z427VLS*/ 02956000
*            WORKDEV = MIHCODE2;                           /*@Z427VLS*/ 02957000
         MVC   WORKDEV(2),MIHCODE2(R7)                             1054 02958000
*            CALL DEVSEL; /*EXAMINE LIST OF VALID DEVICES    @Z427VLS*/ 02959000
         BAL   @14,DEVSEL                                          1055 02960000
*           END;                                           /*@Z427VLS*/ 02961000
*        IF PASSFLAG = YES THEN                                    1057 02962000
@RF01052 TM    PASSFLAG(R2),B'00000001'                            1057 02963000
         BNO   @RF01057                                            1057 02964000
*          BUG(27) = BUG(27) + 1;                          /*@Z427VLS*/ 02965000
         LA    @08,1                                               1058 02966000
         AL    @08,BUG+104                                         1058 02967000
         ST    @08,BUG+104                                         1058 02968000
*       END;                                               /*@Z427VLS*/ 02969000
*   END;                                                   /*@Z427VLS*/ 02970000
*END;                                                      /*@Z427VLS*/ 02971000
@EL00022 DS    0H                                                  1061 02972000
@EF00022 DS    0H                                                  1061 02973000
@ER00022 LM    @14,@12,@SA00022                                    1061 02974000
         BR    @14                                                 1061 02975000
*CCHFILT: PROC;                                            /*@Z427VLS*/ 02976000
CCHFILT  STM   @14,@12,@SA00023                                    1062 02977000
*DCL  INDEX   FIXED(31);                                   /*@0099VLS*/ 02978000
*BUG(18) = BUG(18) + 1; /*NUMBER OF CCH RECORDS IDENTIFIED   @Z427VLS*/ 02979000
         LA    @08,1                                               1064 02980000
         AL    @08,BUG+68                                          1064 02981000
         ST    @08,BUG+68                                          1064 02982000
*IF PCHAN = OFF THEN                                               1065 02983000
         TM    PCHAN(R2),B'01000000'                               1065 02984000
         BNZ   @RF01065                                            1065 02985000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02986000
         NI    PASSFLAG(R2),B'11111110'                            1066 02987000
*ELSE                                                              1067 02988000
*  DO;                                                     /*@Z427VLS*/ 02989000
         B     @RC01065                                            1067 02990000
@RF01065 DS    0H                                                  1068 02991000
*    IF CUAPTR ^= ZERO THEN /*IF CUA SELECTION SPECIFIED THEN*/    1068 02992000
         L     @08,CUAPTR(,R2)                                     1068 02993000
         LTR   @08,@08                                             1068 02994000
         BZ    @RF01068                                            1068 02995000
*      DO;                                                 /*@Z427VLS*/ 02996000
*        WWCUA2 = (WWCUA2 & ONLYCUA2);                     /*@Z427VLS*/ 02997000
         NC    WWCUA2(2),@CB00910                                  1070 02998000
*        CALL CUASELCT;                                    /*@Z427VLS*/ 02999000
         BAL   @14,CUASELCT                                        1071 03000000
*      END;                                                /*@Z427VLS*/ 03001000
*        IF PASSFLAG = YES THEN                                    1073 03002000
@RF01068 TM    PASSFLAG(R2),B'00000001'                            1073 03003000
         BNO   @RF01073                                            1073 03004000
*          DO;                                             /*@Z427VLS*/ 03005000
*            CALL TREADR;  /*ADDR CCH ENT REL TO  CPU SER    @XA20474*/ 03006000
         BAL   @14,TREADR                                          1075 03007000
*           IF CPU0FLG = OFF THEN                                  1076 03008000
         TM    CPU0FLG,B'00001000'                                 1076 03009000
         BNZ   @RF01076                                            1076 03010000
*            DO;                                           /*@Z427VLS*/ 03011000
*    INDEX = CCHCUA;                                       /*@0099VLS*/ 03012000
         SLR   @08,@08                                             1078 03013000
         ICM   @08,3,CCHCUA(R7)                                    1078 03014000
         ST    @08,INDEX                                           1078 03015000
*    SRL(INDEX,8);                                         /*@0001VLS*/ 03016000
         SRL   @08,8                                               1079 03017000
         ST    @08,INDEX                                           1079 03018000
*    IF INDEX = 0 THEN                                             1080 03019000
         L     @08,INDEX                                           1080 03020000
         LTR   @08,@08                                             1080 03021000
         BNZ   @RF01080                                            1080 03022000
*       TRECCH0(TREIDX) = TRECCH0(TREIDX) + 1;             /*@G51DGVS*/ 03023000
         SLR   @08,@08                                             1081 03024000
         IC    @08,TREIDX                                          1081 03025000
         MH    @08,@CH01361                                        1081 03026000
         L     @06,TRENPTR(,R2)                                    1081 03027000
         LA    @03,1                                               1081 03028000
         LA    @01,0(@08,@06)                                      1081 03029000
         AL    @01,@CF01588                                        1081 03030000
         AL    @03,TRECCH0-16(,@01)                                1081 03031000
         AL    @06,@CF01588                                        1081 03032000
         ST    @03,TRECCH0-16(@08,@06)                             1081 03033000
*    ELSE                                                          1082 03034000
*     IF INDEX = 1 THEN                                            1082 03035000
         B     @RC01080                                            1082 03036000
@RF01080 LA    @08,1                                               1082 03037000
         C     @08,INDEX                                           1082 03038000
         BNE   @RF01082                                            1082 03039000
*        TRECCH1(TREIDX) = TRECCH1(TREIDX) + 1;            /*@G51DGVS*/ 03040000
         SLR   @06,@06                                             1083 03041000
         IC    @06,TREIDX                                          1083 03042000
         MH    @06,@CH01361                                        1083 03043000
         L     @03,TRENPTR(,R2)                                    1083 03044000
         LA    @01,0(@06,@03)                                      1083 03045000
         AL    @01,@CF01589                                        1083 03046000
         AL    @08,TRECCH1-20(,@01)                                1083 03047000
         AL    @03,@CF01589                                        1083 03048000
         ST    @08,TRECCH1-20(@06,@03)                             1083 03049000
*     ELSE                                                         1084 03050000
*      IF INDEX = 2 THEN                                           1084 03051000
         B     @RC01082                                            1084 03052000
@RF01082 CLC   INDEX(4),@CF00074                                   1084 03053000
         BNE   @RF01084                                            1084 03054000
*         TRECCH2(TREIDX) = TRECCH2(TREIDX) + 1;           /*@G51DGVS*/ 03055000
         SLR   @08,@08                                             1085 03056000
         IC    @08,TREIDX                                          1085 03057000
         MH    @08,@CH01361                                        1085 03058000
         L     @06,TRENPTR(,R2)                                    1085 03059000
         LA    @03,1                                               1085 03060000
         LA    @01,0(@08,@06)                                      1085 03061000
         AL    @01,@CF01590                                        1085 03062000
         AL    @03,TRECCH2-24(,@01)                                1085 03063000
         AL    @06,@CF01590                                        1085 03064000
         ST    @03,TRECCH2-24(@08,@06)                             1085 03065000
*      ELSE                                                        1086 03066000
*       IF INDEX = 3 THEN                                          1086 03067000
         B     @RC01084                                            1086 03068000
@RF01084 CLC   INDEX(4),@CF00076                                   1086 03069000
         BNE   @RF01086                                            1086 03070000
*          TRECCH3(TREIDX) = TRECCH3(TREIDX) + 1;          /*@G51DGVS*/ 03071000
         SLR   @08,@08                                             1087 03072000
         IC    @08,TREIDX                                          1087 03073000
         MH    @08,@CH01361                                        1087 03074000
         L     @06,TRENPTR(,R2)                                    1087 03075000
         LA    @03,1                                               1087 03076000
         LA    @01,0(@08,@06)                                      1087 03077000
         AL    @01,@CF01591                                        1087 03078000
         AL    @03,TRECCH3-28(,@01)                                1087 03079000
         AL    @06,@CF01591                                        1087 03080000
         ST    @03,TRECCH3-28(@08,@06)                             1087 03081000
*       ELSE                                                       1088 03082000
*        IF INDEX = 4 THEN                                         1088 03083000
         B     @RC01086                                            1088 03084000
@RF01086 CLC   INDEX(4),@CF00064                                   1088 03085000
         BNE   @RF01088                                            1088 03086000
*           TRECCH4(TREIDX) = TRECCH4(TREIDX) + 1;         /*@G51DGVS*/ 03087000
         SLR   @08,@08                                             1089 03088000
         IC    @08,TREIDX                                          1089 03089000
         MH    @08,@CH01361                                        1089 03090000
         L     @06,TRENPTR(,R2)                                    1089 03091000
         LA    @03,1                                               1089 03092000
         LA    @01,0(@08,@06)                                      1089 03093000
         AL    @01,@CF01592                                        1089 03094000
         AL    @03,TRECCH4-32(,@01)                                1089 03095000
         AL    @06,@CF01592                                        1089 03096000
         ST    @03,TRECCH4-32(@08,@06)                             1089 03097000
*        ELSE                                                      1090 03098000
*         IF INDEX = 5 THEN                                        1090 03099000
         B     @RC01088                                            1090 03100000
@RF01088 CLC   INDEX(4),@CF00079                                   1090 03101000
         BNE   @RF01090                                            1090 03102000
*            TRECCH5(TREIDX) = TRECCH5(TREIDX) + 1;        /*@G51DGVS*/ 03103000
         SLR   @08,@08                                             1091 03104000
         IC    @08,TREIDX                                          1091 03105000
         MH    @08,@CH01361                                        1091 03106000
         L     @06,TRENPTR(,R2)                                    1091 03107000
         LA    @03,1                                               1091 03108000
         LA    @01,0(@08,@06)                                      1091 03109000
         AL    @01,@CF01593                                        1091 03110000
         AL    @03,TRECCH5-36(,@01)                                1091 03111000
         AL    @06,@CF01593                                        1091 03112000
         ST    @03,TRECCH5-36(@08,@06)                             1091 03113000
*         ELSE                                                     1092 03114000
*          IF INDEX = 6 THEN                                       1092 03115000
         B     @RC01090                                            1092 03116000
@RF01090 CLC   INDEX(4),@CF00081                                   1092 03117000
         BNE   @RF01092                                            1092 03118000
*             TRECCH6(TREIDX) = TRECCH6(TREIDX) + 1;       /*@G51DGVS*/ 03119000
         SLR   @08,@08                                             1093 03120000
         IC    @08,TREIDX                                          1093 03121000
         MH    @08,@CH01361                                        1093 03122000
         L     @06,TRENPTR(,R2)                                    1093 03123000
         LA    @03,1                                               1093 03124000
         LA    @01,0(@08,@06)                                      1093 03125000
         AL    @01,@CF01594                                        1093 03126000
         AL    @03,TRECCH6-40(,@01)                                1093 03127000
         AL    @06,@CF01594                                        1093 03128000
         ST    @03,TRECCH6-40(@08,@06)                             1093 03129000
*          ELSE                                                    1094 03130000
*           IF INDEX = 7 THEN                                      1094 03131000
         B     @RC01092                                            1094 03132000
@RF01092 CLC   INDEX(4),@CF00083                                   1094 03133000
         BNE   @RF01094                                            1094 03134000
*              TRECCH7(TREIDX) = TRECCH7(TREIDX) + 1;      /*@G51DGVS*/ 03135000
         SLR   @08,@08                                             1095 03136000
         IC    @08,TREIDX                                          1095 03137000
         MH    @08,@CH01361                                        1095 03138000
         L     @06,TRENPTR(,R2)                                    1095 03139000
         LA    @03,1                                               1095 03140000
         LA    @01,0(@08,@06)                                      1095 03141000
         AL    @01,@CF01595                                        1095 03142000
         AL    @03,TRECCH7-44(,@01)                                1095 03143000
         AL    @06,@CF01595                                        1095 03144000
         ST    @03,TRECCH7-44(@08,@06)                             1095 03145000
*           ELSE                                                   1096 03146000
*            IF INDEX = 8 THEN                                     1096 03147000
         B     @RC01094                                            1096 03148000
@RF01094 CLC   INDEX(4),@CF00066                                   1096 03149000
         BNE   @RF01096                                            1096 03150000
*               TRECCH8(TREIDX) = TRECCH8(TREIDX) + 1;     /*@G51DGVS*/ 03151000
         SLR   @08,@08                                             1097 03152000
         IC    @08,TREIDX                                          1097 03153000
         MH    @08,@CH01361                                        1097 03154000
         L     @06,TRENPTR(,R2)                                    1097 03155000
         LA    @03,1                                               1097 03156000
         LA    @01,0(@08,@06)                                      1097 03157000
         AL    @01,@CF01596                                        1097 03158000
         AL    @03,TRECCH8-48(,@01)                                1097 03159000
         AL    @06,@CF01596                                        1097 03160000
         ST    @03,TRECCH8-48(@08,@06)                             1097 03161000
*            ELSE                                                  1098 03162000
*             IF INDEX = 9 THEN                                    1098 03163000
         B     @RC01096                                            1098 03164000
@RF01096 CLC   INDEX(4),@CF00035                                   1098 03165000
         BNE   @RF01098                                            1098 03166000
*                TRECCH9(TREIDX) = TRECCH9(TREIDX) + 1;    /*@G51DGVS*/ 03167000
         SLR   @08,@08                                             1099 03168000
         IC    @08,TREIDX                                          1099 03169000
         MH    @08,@CH01361                                        1099 03170000
         L     @06,TRENPTR(,R2)                                    1099 03171000
         LA    @03,1                                               1099 03172000
         LA    @01,0(@08,@06)                                      1099 03173000
         AL    @01,@CF01597                                        1099 03174000
         AL    @03,TRECCH9-52(,@01)                                1099 03175000
         AL    @06,@CF01597                                        1099 03176000
         ST    @03,TRECCH9-52(@08,@06)                             1099 03177000
*             ELSE                                                 1100 03178000
*              IF INDEX = 10 THEN                                  1100 03179000
         B     @RC01098                                            1100 03180000
@RF01098 CLC   INDEX(4),@CF00034                                   1100 03181000
         BNE   @RF01100                                            1100 03182000
*                 TRECCHA(TREIDX) = TRECCHA(TREIDX) + 1;   /*@G51DGVS*/ 03183000
         SLR   @08,@08                                             1101 03184000
         IC    @08,TREIDX                                          1101 03185000
         MH    @08,@CH01361                                        1101 03186000
         L     @06,TRENPTR(,R2)                                    1101 03187000
         LA    @03,1                                               1101 03188000
         LA    @01,0(@08,@06)                                      1101 03189000
         AL    @01,@CF01574                                        1101 03190000
         AL    @03,TRECCHA-56(,@01)                                1101 03191000
         AL    @06,@CF01574                                        1101 03192000
         ST    @03,TRECCHA-56(@08,@06)                             1101 03193000
*               IF INDEX = 11 THEN /*TO MANY IFS HAVE TO GO THIS WAY*/  03194000
@RF01100 DS    0H                                                  1102 03195000
@RC01098 DS    0H                                                  1102 03196000
@RC01096 DS    0H                                                  1102 03197000
@RC01094 DS    0H                                                  1102 03198000
@RC01092 DS    0H                                                  1102 03199000
@RC01090 DS    0H                                                  1102 03200000
@RC01088 DS    0H                                                  1102 03201000
@RC01086 DS    0H                                                  1102 03202000
@RC01084 DS    0H                                                  1102 03203000
@RC01082 DS    0H                                                  1102 03204000
@RC01080 CLC   INDEX(4),@CF00033                                   1102 03205000
         BNE   @RF01102                                            1102 03206000
*                  TRECCHB(TREIDX) = TRECCHB(TREIDX) + 1;  /*@G51DGVS*/ 03207000
         SLR   @08,@08                                             1103 03208000
         IC    @08,TREIDX                                          1103 03209000
         MH    @08,@CH01361                                        1103 03210000
         L     @06,TRENPTR(,R2)                                    1103 03211000
         LA    @03,1                                               1103 03212000
         LA    @01,0(@08,@06)                                      1103 03213000
         AL    @01,@CF01598                                        1103 03214000
         AL    @03,TRECCHB-60(,@01)                                1103 03215000
         AL    @06,@CF01598                                        1103 03216000
         ST    @03,TRECCHB-60(@08,@06)                             1103 03217000
*               ELSE                                               1104 03218000
*                IF INDEX = 12 THEN                                1104 03219000
         B     @RC01102                                            1104 03220000
@RF01102 CLC   INDEX(4),@CF00032                                   1104 03221000
         BNE   @RF01104                                            1104 03222000
*                   TRECCHC(TREIDX) = TRECCHC(TREIDX) + 1; /*@G51DGVS*/ 03223000
         SLR   @08,@08                                             1105 03224000
         IC    @08,TREIDX                                          1105 03225000
         MH    @08,@CH01361                                        1105 03226000
         L     @06,TRENPTR(,R2)                                    1105 03227000
         LA    @03,1                                               1105 03228000
         LA    @01,0(@08,@06)                                      1105 03229000
         AL    @01,@CF01599                                        1105 03230000
         AL    @03,TRECCHC-64(,@01)                                1105 03231000
         AL    @06,@CF01599                                        1105 03232000
         ST    @03,TRECCHC-64(@08,@06)                             1105 03233000
*                ELSE                                              1106 03234000
*                 IF INDEX = 13 THEN                               1106 03235000
         B     @RC01104                                            1106 03236000
@RF01104 CLC   INDEX(4),@CF01015                                   1106 03237000
         BNE   @RF01106                                            1106 03238000
*                    TRECCHD(TREIDX) = TRECCHD(TREIDX) + 1;/*@G51DGVS*/ 03239000
         SLR   @08,@08                                             1107 03240000
         IC    @08,TREIDX                                          1107 03241000
         MH    @08,@CH01361                                        1107 03242000
         L     @06,TRENPTR(,R2)                                    1107 03243000
         LA    @03,1                                               1107 03244000
         LA    @01,0(@08,@06)                                      1107 03245000
         AL    @01,@CF01600                                        1107 03246000
         AL    @03,TRECCHD-68(,@01)                                1107 03247000
         AL    @06,@CF01600                                        1107 03248000
         ST    @03,TRECCHD-68(@08,@06)                             1107 03249000
*                 ELSE                                             1108 03250000
*                  IF INDEX = 14 THEN                              1108 03251000
         B     @RC01106                                            1108 03252000
@RF01106 CLC   INDEX(4),@CF00940                                   1108 03253000
         BNE   @RF01108                                            1108 03254000
*                     TRECCHE(TREIDX) = TRECCHE(TREIDX) + 1;       1109 03255000
         SLR   @08,@08                                             1109 03256000
         IC    @08,TREIDX                                          1109 03257000
         MH    @08,@CH01361                                        1109 03258000
         L     @06,TRENPTR(,R2)                                    1109 03259000
         LA    @03,1                                               1109 03260000
         LA    @01,0(@08,@06)                                      1109 03261000
         AL    @01,@CF01581                                        1109 03262000
         AL    @03,TRECCHE-72(,@01)                                1109 03263000
         AL    @06,@CF01581                                        1109 03264000
         ST    @03,TRECCHE-72(@08,@06)                             1109 03265000
*                  ELSE                                            1110 03266000
*          IF INDEX = 15 THEN                                      1110 03267000
         B     @RC01108                                            1110 03268000
@RF01108 CLC   INDEX(4),@CF00036                                   1110 03269000
         BNE   @RF01110                                            1110 03270000
*                      TRECCHF(TREIDX) = TRECCHF(TREIDX) + 1;      1111 03271000
         SLR   @08,@08                                             1111 03272000
         IC    @08,TREIDX                                          1111 03273000
         MH    @08,@CH01361                                        1111 03274000
         L     @06,TRENPTR(,R2)                                    1111 03275000
         LA    @03,1                                               1111 03276000
         AL    @03,TRECCHF-76(@08,@06)                             1111 03277000
         ST    @03,TRECCHF-76(@08,@06)                             1111 03278000
*            BUG(19) = BUG(19) + 1;                        /*@Z427VLS*/ 03279000
@RF01110 DS    0H                                                  1112 03280000
@RC01108 DS    0H                                                  1112 03281000
@RC01106 DS    0H                                                  1112 03282000
@RC01104 DS    0H                                                  1112 03283000
@RC01102 LA    @08,1                                               1112 03284000
         L     @06,BUG+72                                          1112 03285000
         ALR   @06,@08                                             1112 03286000
         ST    @06,BUG+72                                          1112 03287000
*           IF FRAMEPTR ^= ZERO THEN /*IF FRAMETAB IS ALLOCATED*/  1113 03288000
         L     @06,FRAMEPTR(,R2)                                   1113 03289000
         LTR   @06,@06                                             1113 03290000
         BZ    @RF01113                                            1113 03291000
*            DO;                                           /*@G51DGBB*/ 03292000
*           GETOUT = NO;                                   /*@G51DGBB*/ 03293000
         NI    GETOUT,B'10111111'                                  1115 03294000
*            DO A = 1 BY 1 TO MRDNUMBR WHILE GETOUT = NO;  /*@G51DGBB*/ 03295000
         ST    @08,A                                               1116 03296000
         B     @DE01116                                            1116 03297000
@DL01116 TM    GETOUT,B'01000000'                                  1116 03298000
         BNZ   @DC01116                                            1116 03299000
*              IF MODEL(A) = LRTMODEL THEN                         1117 03300000
         ALR   @08,@08                                             1117 03301000
         L     @06,MERDCPTR(,R2)                                   1117 03302000
         ALR   @06,@08                                             1117 03303000
         CLC   MODEL-2(2,@06),LRTMODEL(R7)                         1117 03304000
         BNE   @RF01117                                            1117 03305000
*                DO;                                       /*@G51DGBB*/ 03306000
*                  CALL BUILDFTB; /*IF UNIQUE,BUILD FRAMTAB ENTRY*/     03307000
         BAL   @14,BUILDFTB                                        1119 03308000
*                  GETOUT = YES;  /*EXIT LOOP                @G51DGBB*/ 03309000
         OI    GETOUT,B'01000000'                                  1120 03310000
*                END;                                      /*@G51DGBB*/ 03311000
*            END;                                          /*@G51DGBB*/ 03312000
@RF01117 LA    @08,1                                               1122 03313000
         AL    @08,A                                               1122 03314000
         ST    @08,A                                               1122 03315000
@DE01116 L     @06,MERDCPTR(,R2)                                   1122 03316000
         CH    @08,MRDNUMBR(,@06)                                  1122 03317000
         BNH   @DL01116                                            1122 03318000
@DC01116 DS    0H                                                  1123 03319000
*            END;                                          /*@G51DGBB*/ 03320000
*            END;                                          /*@Z427VLS*/ 03321000
*           END;                                           /*@Z427VLS*/ 03322000
*   END;                                                   /*@Z427VLS*/ 03323000
*END;                                                      /*@Z427VLS*/ 03324000
@EL00023 DS    0H                                                  1127 03325000
@EF00023 DS    0H                                                  1127 03326000
@ER00023 LM    @14,@12,@SA00023                                    1127 03327000
         BR    @14                                                 1127 03328000
*IPLFILT: PROC;                                            /*@Z427VLS*/ 03329000
IPLFILT  STM   @14,@12,@SA00024                                    1128 03330000
*BUG(22) = BUG(22) + 1;                                    /*@Z427VLS*/ 03331000
         LA    @08,1                                               1129 03332000
         AL    @08,BUG+84                                          1129 03333000
         ST    @08,BUG+84                                          1129 03334000
*IF PIPL = OFF THEN                                                1130 03335000
         TM    PIPL(R2),B'00001000'                                1130 03336000
         BNZ   @RF01130                                            1130 03337000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 03338000
         NI    PASSFLAG(R2),B'11111110'                            1131 03339000
*ELSE                                                              1132 03340000
*  DO;                                                     /*@Z427VLS*/ 03341000
         B     @RC01130                                            1132 03342000
@RF01130 DS    0H                                                  1133 03343000
*   CALL TREADR;  /*ADDRESS IPL ENT RELATING TO REC CPU SER  @XA20474*/ 03344000
         BAL   @14,TREADR                                          1133 03345000
*   IF CPU0FLG = OFF THEN                                          1134 03346000
         TM    CPU0FLG,B'00001000'                                 1134 03347000
         BNZ   @RF01134                                            1134 03348000
*    DO;                                                   /*@Z427VLS*/ 03349000
*    BUG(23) = BUG(23) + 1;                                /*@Z427VLS*/ 03350000
         LA    @08,1                                               1136 03351000
         L     @06,BUG+88                                          1136 03352000
         ALR   @06,@08                                             1136 03353000
         ST    @06,BUG+88                                          1136 03354000
*    TREIPL(TREIDX) = TREIPL(TREIDX) + ONE; /*ADD TO MCH REC. COUNT*/   03355000
         SLR   @06,@06                                             1137 03356000
         IC    @06,TREIDX                                          1137 03357000
         MH    @06,@CH01361                                        1137 03358000
         L     @03,TRENPTR(,R2)                                    1137 03359000
         LA    @01,0(@06,@03)                                      1137 03360000
         AL    @01,@CF01573                                        1137 03361000
         AL    @08,TREIPL-8(,@01)                                  1137 03362000
         AL    @03,@CF01573                                        1137 03363000
         ST    @08,TREIPL-8(@06,@03)                               1137 03364000
*    END;                                                  /*@Z427VLS*/ 03365000
*  END;                                                    /*@Z427VLS*/ 03366000
*END;                                                      /*@Z427VLS*/ 03367000
@EL00024 DS    0H                                                  1140 03368000
@EF00024 DS    0H                                                  1140 03369000
@ER00024 LM    @14,@12,@SA00024                                    1140 03370000
         BR    @14                                                 1140 03371000
*EODFILT: PROC;                                            /*@Z427VLS*/ 03372000
EODFILT  STM   @14,@12,12(@13)                                     1141 03373000
*BUG(28) = BUG(28) + 1;                                    /*@Z427VLS*/ 03374000
         LA    @08,1                                               1142 03375000
         AL    @08,BUG+108                                         1142 03376000
         ST    @08,BUG+108                                         1142 03377000
*IF PEOD = OFF THEN                                                1143 03378000
         TM    PEOD(R2),B'00000001'                                1143 03379000
         BNZ   @RF01143                                            1143 03380000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 03381000
         NI    PASSFLAG(R2),B'11111110'                            1144 03382000
*ELSE /*IF PASSED FILTERING                                  @Z427VLS*/ 03383000
*  BUG(29) = BUG(29) + 1;                                  /*@Z427VLS*/ 03384000
         B     @RC01143                                            1145 03385000
@RF01143 LA    @08,1                                               1145 03386000
         AL    @08,BUG+112                                         1145 03387000
         ST    @08,BUG+112                                         1145 03388000
*END;                                                      /*@Z427VLS*/ 03389000
@EL00025 DS    0H                                                  1146 03390000
@EF00025 DS    0H                                                  1146 03391000
@ER00025 LM    @14,@12,12(@13)                                     1146 03392000
         BR    @14                                                 1146 03393000
*MCHFILT: PROC;                                            /*@Z427VLS*/ 03394000
MCHFILT  STM   @14,@12,@SA00026                                    1147 03395000
*BUG(16) = BUG(16) + 1;                                    /*@Z427VLS*/ 03396000
         LA    @08,1                                               1148 03397000
         AL    @08,BUG+60                                          1148 03398000
         ST    @08,BUG+60                                          1148 03399000
*IF PMCH = OFF THEN                                                1149 03400000
         TM    PMCH(R2),B'10000000'                                1149 03401000
         BNZ   @RF01149                                            1149 03402000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 03403000
         NI    PASSFLAG(R2),B'11111110'                            1150 03404000
*ELSE                                                              1151 03405000
*  DO;                                                     /*@Z427VLS*/ 03406000
         B     @RC01149                                            1151 03407000
@RF01149 DS    0H                                                  1152 03408000
*   CALL TREADR;  /*ADDRESS MCH ENT RELATING TO REC CPU SER  @XA20474*/ 03409000
         BAL   @14,TREADR                                          1152 03410000
*   IF CPU0FLG = OFF THEN                                          1153 03411000
         TM    CPU0FLG,B'00001000'                                 1153 03412000
         BNZ   @RF01153                                            1153 03413000
*    DO;                                                   /*@Z427VLS*/ 03414000
*    TREMCH(TREIDX) = TREMCH(TREIDX) + ONE; /*ADD 1 TO MCH REC. CNT*/   03415000
         SLR   @08,@08                                             1155 03416000
         IC    @08,TREIDX                                          1155 03417000
         MH    @08,@CH01361                                        1155 03418000
         L     @06,TRENPTR(,R2)                                    1155 03419000
         LA    @03,1                                               1155 03420000
         LA    @01,0(@08,@06)                                      1155 03421000
         AL    @01,@CF01601                                        1155 03422000
         L     @15,TREMCH-12(,@01)                                 1155 03423000
         ALR   @15,@03                                             1155 03424000
         AL    @06,@CF01601                                        1155 03425000
         ST    @15,TREMCH-12(@08,@06)                              1155 03426000
*    BUG(17) = BUG(17) + 1;                                /*@Z427VLS*/ 03427000
         L     @08,BUG+64                                          1156 03428000
         ALR   @08,@03                                             1156 03429000
         ST    @08,BUG+64                                          1156 03430000
*IF FRAMEPTR ^= ZERO THEN /*IF FRAMETAB IS ALLOCATED         @G51DGBB*/ 03431000
         L     @08,FRAMEPTR(,R2)                                   1157 03432000
         LTR   @08,@08                                             1157 03433000
         BZ    @RF01157                                            1157 03434000
*DO;                                                       /*@G51DGBB*/ 03435000
*    GETOUT = NO;                                          /*@G51DGBB*/ 03436000
         NI    GETOUT,B'10111111'                                  1159 03437000
*DO A = 1 BY 1 TO MRDNUMBR WHILE GETOUT = NO; /*LOOP THROUGH LIST OF */ 03438000
         ST    @03,A                                               1160 03439000
         B     @DE01160                                            1160 03440000
@DL01160 TM    GETOUT,B'01000000'                                  1160 03441000
         BNZ   @DC01160                                            1160 03442000
*                                           /*MERIDIAN-LIKE CPUS   */   03443000
*  IF MODEL(A) = LRTMODEL THEN             /*IF MERIDIAN-LIKE CPU */    03444000
         ALR   @03,@03                                             1161 03445000
         L     @08,MERDCPTR(,R2)                                   1161 03446000
         ALR   @08,@03                                             1161 03447000
         CLC   MODEL-2(2,@08),LRTMODEL(R7)                         1161 03448000
         BNE   @RF01161                                            1161 03449000
*    DO;                                                   /*@G51DGBB*/ 03450000
*      CALL BUILDFTB; /*SEE IF UNIQUE, BUILD FRAMTAB ENTRY IF IT IS */  03451000
         BAL   @14,BUILDFTB                                        1163 03452000
*      GETOUT = YES;  /*EXIT LOOP                            @G51DGBB*/ 03453000
         OI    GETOUT,B'01000000'                                  1164 03454000
*    END;                                                  /*@G51DGBB*/ 03455000
*END;                                                      /*@G51DGBB*/ 03456000
@RF01161 LA    @03,1                                               1166 03457000
         AL    @03,A                                               1166 03458000
         ST    @03,A                                               1166 03459000
@DE01160 L     @08,MERDCPTR(,R2)                                   1166 03460000
         CH    @03,MRDNUMBR(,@08)                                  1166 03461000
         BNH   @DL01160                                            1166 03462000
@DC01160 DS    0H                                                  1167 03463000
*END;                                                      /*@G51DGBB*/ 03464000
*    END;                                                  /*@Z427VLS*/ 03465000
*  END;                                                    /*@Z427VLS*/ 03466000
*END;                                                      /*@Z427VLS*/ 03467000
@EL00026 DS    0H                                                  1170 03468000
@EF00026 DS    0H                                                  1170 03469000
@ER00026 LM    @14,@12,@SA00026                                    1170 03470000
         BR    @14                                                 1170 03471000
*SOFTFILT: PROC;                                           /*@Z427VLS*/ 03472000
SOFTFILT STM   @14,@12,@SA00027                                    1171 03473000
*BUG(20) = BUG(20) + 1;                                    /*@Z427VLS*/ 03474000
         LA    @08,1                                               1172 03475000
         AL    @08,BUG+76                                          1172 03476000
         ST    @08,BUG+76                                          1172 03477000
*IF PSOFT = OFF THEN                                               1173 03478000
         TM    PSOFT(R2),B'00010000'                               1173 03479000
         BNZ   @RF01173                                            1173 03480000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 03481000
         NI    PASSFLAG(R2),B'11111110'                            1174 03482000
*ELSE                                                              1175 03483000
*  DO;                                                     /*@Z427VLS*/ 03484000
         B     @RC01173                                            1175 03485000
@RF01173 DS    0H                                                  1176 03486000
*   CALL TREADR;  /*ADDRESS SOFT ENT RELATING TO REC CPU SER @XA20474*/ 03487000
         BAL   @14,TREADR                                          1176 03488000
*   IF CPU0FLG = OFF THEN                                          1177 03489000
         TM    CPU0FLG,B'00001000'                                 1177 03490000
         BNZ   @RF01177                                            1177 03491000
*    DO;                                                   /*@Z427VLS*/ 03492000
*    TREPRE(TREIDX) = TREPRE(TREIDX) + ONE; /*ADD 1 TO SOFT REC. CT */  03493000
         SLR   @08,@08                                             1179 03494000
         IC    @08,TREIDX                                          1179 03495000
         MH    @08,@CH01361                                        1179 03496000
         L     @06,TRENPTR(,R2)                                    1179 03497000
         LA    @03,1                                               1179 03498000
         L     @15,TREPRE-76(@08,@06)                              1179 03499000
         ALR   @15,@03                                             1179 03500000
         ST    @15,TREPRE-76(@08,@06)                              1179 03501000
*    BUG(21) = BUG(21) + 1;                                /*@Z427VLS*/ 03502000
         AL    @03,BUG+80                                          1180 03503000
         ST    @03,BUG+80                                          1180 03504000
*    END;                                                  /*@Z427VLS*/ 03505000
*  END;                                                    /*@Z427VLS*/ 03506000
*END;                                                      /*@Z427VLS*/ 03507000
@EL00027 DS    0H                                                  1183 03508000
@EF00027 DS    0H                                                  1183 03509000
@ER00027 LM    @14,@12,@SA00027                                    1183 03510000
         BR    @14                                                 1183 03511000
*DEVSEL: PROC;                                             /*@Z427VLS*/ 03512000
DEVSEL   STM   @14,@12,12(@13)                                     1184 03513000
*IF WORKTYPE = HEX90 THEN                                          1185 03514000
         CLI   WORKTYPE,X'90'                                      1185 03515000
         BNE   @RF01185                                            1185 03516000
*  DO;                                                     /*@Z427VLS*/ 03517000
*    IF DEVEXCL = ON THEN                                          1187 03518000
         TM    DEVEXCL(R2),B'00100000'                             1187 03519000
         BNO   @RF01187                                            1187 03520000
*      DO;                                                 /*@Z427VLS*/ 03521000
*        DEVOK = YES;                                      /*@Z427VLS*/ 03522000
         OI    DEVOK,B'00100000'                                   1189 03523000
*        DO J = 1 BY 1 TO MDRNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 03524000
         LA    @08,1                                               1190 03525000
         ST    @08,J                                               1190 03526000
         B     @DE01190                                            1190 03527000
@DL01190 TM    DEVOK,B'00100000'                                   1190 03528000
         BNO   @DC01190                                            1190 03529000
*        IF TPRDEV = MDRVAL(J) THEN                                1191 03530000
         L     @06,DEVPTR(,R2)                                     1191 03531000
         ALR   @06,@08                                             1191 03532000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          1191 03533000
         BNE   @RF01191                                            1191 03534000
*          DO;                                             /*@Z427VLS*/ 03535000
*            DEVOK = NO;                                   /*@Z427VLS*/ 03536000
         NI    DEVOK,B'11011111'                                   1193 03537000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 03538000
         NI    PASSFLAG(R2),B'11111110'                            1194 03539000
*            BUG(32) = BUG(32) + 1;                        /*@Z427VLS*/ 03540000
         LA    @08,1                                               1195 03541000
         AL    @08,BUG+124                                         1195 03542000
         ST    @08,BUG+124                                         1195 03543000
*          END;                                            /*@Z427VLS*/ 03544000
*        END;                                              /*@Z427VLS*/ 03545000
@RF01191 LA    @08,1                                               1197 03546000
         AL    @08,J                                               1197 03547000
         ST    @08,J                                               1197 03548000
@DE01190 L     @06,DEVPTR(,R2)                                     1197 03549000
         CH    @08,MDRNUM(,@06)                                    1197 03550000
         BNH   @DL01190                                            1197 03551000
@DC01190 DS    0H                                                  1198 03552000
*      END;                                                /*@Z427VLS*/ 03553000
*    ELSE                                                          1199 03554000
*      DO;                                                 /*@Z427VLS*/ 03555000
         B     @RC01187                                            1199 03556000
@RF01187 DS    0H                                                  1200 03557000
*        DEVOK = NO;                                       /*@Z427VLS*/ 03558000
         NI    DEVOK,B'11011111'                                   1200 03559000
*        DO J = 1 BY 1 TO MDRNUM WHILE DEVOK = NO;         /*@Z427VLS*/ 03560000
         LA    @08,1                                               1201 03561000
         ST    @08,J                                               1201 03562000
         B     @DE01201                                            1201 03563000
@DL01201 TM    DEVOK,B'00100000'                                   1201 03564000
         BNZ   @DC01201                                            1201 03565000
*        IF TPRDEV = MDRVAL(J) THEN                                1202 03566000
         L     @06,DEVPTR(,R2)                                     1202 03567000
         ALR   @06,@08                                             1202 03568000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          1202 03569000
         BNE   @RF01202                                            1202 03570000
*          DEVOK = YES;                                    /*@Z427VLS*/ 03571000
         OI    DEVOK,B'00100000'                                   1203 03572000
*        END;                                              /*@Z427VLS*/ 03573000
@RF01202 LA    @08,1                                               1204 03574000
         AL    @08,J                                               1204 03575000
         ST    @08,J                                               1204 03576000
@DE01201 L     @06,DEVPTR(,R2)                                     1204 03577000
         CH    @08,MDRNUM(,@06)                                    1204 03578000
         BNH   @DL01201                                            1204 03579000
@DC01201 DS    0H                                                  1205 03580000
*        IF DEVOK = NO THEN                                        1205 03581000
         TM    DEVOK,B'00100000'                                   1205 03582000
         BNZ   @RF01205                                            1205 03583000
*          DO;                                             /*@Z427VLS*/ 03584000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 03585000
         NI    PASSFLAG(R2),B'11111110'                            1207 03586000
*            BUG(32) = BUG(32) + 1;                        /*@Z427VLS*/ 03587000
         LA    @08,1                                               1208 03588000
         AL    @08,BUG+124                                         1208 03589000
         ST    @08,BUG+124                                         1208 03590000
*          END;                                            /*@Z427VLS*/ 03591000
*       END;                                               /*@Z427VLS*/ 03592000
*    END;                                                  /*@Z427VLS*/ 03593000
*  ELSE                                                            1212 03594000
*    IF DEVEXCL = ON THEN                                          1212 03595000
         B     @RC01185                                            1212 03596000
@RF01185 TM    DEVEXCL(R2),B'00100000'                             1212 03597000
         BNO   @RF01212                                            1212 03598000
*      DO;                                                 /*@Z427VLS*/ 03599000
*        DEVOK = YES;                                      /*@Z427VLS*/ 03600000
         OI    DEVOK,B'00100000'                                   1214 03601000
*        DO J = 1 BY 1 TO DEVNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 03602000
         LA    @08,1                                               1215 03603000
         ST    @08,J                                               1215 03604000
         B     @DE01215                                            1215 03605000
@DL01215 TM    DEVOK,B'00100000'                                   1215 03606000
         BNO   @DC01215                                            1215 03607000
*          IF WORKDEV = DEVVAL(J) THEN                             1216 03608000
         ALR   @08,@08                                             1216 03609000
         L     @06,DEVPTR(,R2)                                     1216 03610000
         ALR   @06,@08                                             1216 03611000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            1216 03612000
         BNE   @RF01216                                            1216 03613000
*            DO;                                           /*@Z427VLS*/ 03614000
*              DEVOK = NO;                                 /*@Z427VLS*/ 03615000
         NI    DEVOK,B'11011111'                                   1218 03616000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 03617000
         NI    PASSFLAG(R2),B'11111110'                            1219 03618000
*              BUG(32) = BUG(32) + 1;                      /*@Z427VLS*/ 03619000
         LA    @08,1                                               1220 03620000
         AL    @08,BUG+124                                         1220 03621000
         ST    @08,BUG+124                                         1220 03622000
*            END;                                          /*@Z427VLS*/ 03623000
*        END;                                              /*@Z427VLS*/ 03624000
@RF01216 LA    @08,1                                               1222 03625000
         AL    @08,J                                               1222 03626000
         ST    @08,J                                               1222 03627000
@DE01215 L     @06,DEVPTR(,R2)                                     1222 03628000
         CH    @08,DEVNUM(,@06)                                    1222 03629000
         BNH   @DL01215                                            1222 03630000
@DC01215 DS    0H                                                  1223 03631000
*      END;                                                /*@Z427VLS*/ 03632000
*  ELSE                                                            1224 03633000
*   DO;                                                    /*@Z427VLS*/ 03634000
         B     @RC01212                                            1224 03635000
@RF01212 DS    0H                                                  1225 03636000
*     DEVOK = NO;                                          /*@Z427VLS*/ 03637000
         NI    DEVOK,B'11011111'                                   1225 03638000
*     DO J =  1 BY 1 TO DEVNUM WHILE DEVOK = NO;           /*@Z427VLS*/ 03639000
         LA    @08,1                                               1226 03640000
         ST    @08,J                                               1226 03641000
         B     @DE01226                                            1226 03642000
@DL01226 TM    DEVOK,B'00100000'                                   1226 03643000
         BNZ   @DC01226                                            1226 03644000
*       IF WORKDEV = DEVVAL(J) THEN                                1227 03645000
         ALR   @08,@08                                             1227 03646000
         L     @06,DEVPTR(,R2)                                     1227 03647000
         ALR   @06,@08                                             1227 03648000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            1227 03649000
         BNE   @RF01227                                            1227 03650000
*         DEVOK = YES;                                     /*@Z427VLS*/ 03651000
         OI    DEVOK,B'00100000'                                   1228 03652000
*     END;                                                 /*@Z427VLS*/ 03653000
@RF01227 LA    @08,1                                               1229 03654000
         AL    @08,J                                               1229 03655000
         ST    @08,J                                               1229 03656000
@DE01226 L     @06,DEVPTR(,R2)                                     1229 03657000
         CH    @08,DEVNUM(,@06)                                    1229 03658000
         BNH   @DL01226                                            1229 03659000
@DC01226 DS    0H                                                  1230 03660000
*     IF DEVOK = NO THEN                                           1230 03661000
         TM    DEVOK,B'00100000'                                   1230 03662000
         BNZ   @RF01230                                            1230 03663000
*       DO;                                                /*@Z427VLS*/ 03664000
*         PASSFLAG = OFF;                                  /*@Z427VLS*/ 03665000
         NI    PASSFLAG(R2),B'11111110'                            1232 03666000
*         BUG(32) = BUG(32) + 1;                           /*@Z427VLS*/ 03667000
         LA    @08,1                                               1233 03668000
         AL    @08,BUG+124                                         1233 03669000
         ST    @08,BUG+124                                         1233 03670000
*       END;                                               /*@Z427VLS*/ 03671000
*    END;                                                  /*@Z427VLS*/ 03672000
*END;                                                      /*@Z427VLS*/ 03673000
@EL00028 DS    0H                                                  1236 03674000
@EF00028 DS    0H                                                  1236 03675000
@ER00028 LM    @14,@12,12(@13)                                     1236 03676000
         BR    @14                                                 1236 03677000
*CUASELCT: PROC; /*CHECK RECORD CUA AGAINST LIST OF VALID CUAS*/   1237 03678000
CUASELCT STM   @14,@12,12(@13)                                     1237 03679000
*CUAOK = NO;                                               /*@Z427VLS*/ 03680000
         NI    CUAOK,B'11101111'                                   1238 03681000
*DO M = 1 BY 1 TO CUANUM WHILE CUAOK = NO;                 /*@Z427VLS*/ 03682000
         LA    @08,1                                               1239 03683000
         ST    @08,M                                               1239 03684000
         B     @DE01239                                            1239 03685000
@DL01239 TM    CUAOK,B'00010000'                                   1239 03686000
         BNZ   @DC01239                                            1239 03687000
*  IF WWCUA2 >= CUA1(M) & WWCUA2 <= CUA2(M) THEN                   1240 03688000
         SLA   @08,2                                               1240 03689000
         L     @06,CUAPTR(,R2)                                     1240 03690000
         ST    @08,@TF00001                                        1240 03691000
         ALR   @08,@06                                             1240 03692000
         BCTR  @08,0                                               1240 03693000
         BCTR  @08,0                                               1240 03694000
         CLC   WWCUA2(2),CUA1-2(@08)                               1240 03695000
         BL    @RF01240                                            1240 03696000
         AL    @06,@TF00001                                        1240 03697000
         CLC   WWCUA2(2),CUA2-4(@06)                               1240 03698000
         BH    @RF01240                                            1240 03699000
*    CUAOK = YES;                                          /*@Z427VLS*/ 03700000
         OI    CUAOK,B'00010000'                                   1241 03701000
*END;                                                      /*@Z427VLS*/ 03702000
@RF01240 LA    @08,1                                               1242 03703000
         AL    @08,M                                               1242 03704000
         ST    @08,M                                               1242 03705000
@DE01239 L     @06,CUAPTR(,R2)                                     1242 03706000
         CH    @08,CUANUM(,@06)                                    1242 03707000
         BNH   @DL01239                                            1242 03708000
@DC01239 DS    0H                                                  1243 03709000
*IF CUAOK = NO THEN                                                1243 03710000
         TM    CUAOK,B'00010000'                                   1243 03711000
         BNZ   @RF01243                                            1243 03712000
*  DO;                                                     /*@Z427VLS*/ 03713000
*    PASSFLAG = NO;                                        /*@Z427VLS*/ 03714000
         NI    PASSFLAG(R2),B'11111110'                            1245 03715000
*    BUG(33) = BUG(33) + 1;                                /*@Z427VLS*/ 03716000
         LA    @08,1                                               1246 03717000
         AL    @08,BUG+128                                         1246 03718000
         ST    @08,BUG+128                                         1246 03719000
*  END;                                                    /*@Z427VLS*/ 03720000
*END; /*CLOSING END OF PROC CUASELCT                         @Z427VLS*/ 03721000
@EL00029 DS    0H                                                  1248 03722000
@EF00029 DS    0H                                                  1248 03723000
@ER00029 LM    @14,@12,12(@13)                                     1248 03724000
         BR    @14                                                 1248 03725000
*ERRMSG: PROC;                                             /*@Z427VLS*/ 03726000
ERRMSG   STM   @14,@12,@SA00030                                    1249 03727000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 03728000
         LA    @08,PRINTLIN                                        1250 03729000
         ST    @08,PRINTADR(,R2)                                   1250 03730000
*IF MSGNO=1  |                                           /* @XA19728 */ 03731000
*   MSGNO=2  THEN                                        /* @XA19728 */ 03732000
         CLI   MSGNO,1                                             1251 03733000
         BE    @RT01251                                            1251 03734000
         CLI   MSGNO,2                                             1251 03735000
         BNE   @RF01251                                            1251 03736000
@RT01251 DS    0H                                                  1252 03737000
*  DO;                                                     /*@GZZDGVS*/ 03738000
*    ZEROALL=NO;         /* DONT RESET LOGREC HEADER OF ALL  @GZZDGVS*/ 03739000
         NI    ZEROALL(R2),B'10111111'                             1253 03740000
*                        /* RECORDS NOT PROCESSED           @XA19728 */ 03741000
*    CALL IFCMSG(55,ADDR(PRINTBDY));  /*GET FAILED SORT TBL @Z427VLS */ 03742000
         LA    @08,PRINTBDY                                        1254 03743000
         ST    @08,@AFTEMPS+4                                      1254 03744000
         L     @15,ADIFCMSG(,R2)                                   1254 03745000
         LA    @01,@AL01254                                        1254 03746000
         BALR  @14,@15                                             1254 03747000
*  END;                                                    /*@GZZDGVS*/ 03748000
*IF MSGNO = 3 THEN                                                 1256 03749000
@RF01251 CLI   MSGNO,3                                             1256 03750000
         BNE   @RF01256                                            1256 03751000
*   CALL IFCMSG(53,ADDR(PRINTBDY));                        /*@Z427VLS*/ 03752000
         LA    @08,PRINTBDY                                        1257 03753000
         ST    @08,@AFTEMPS+4                                      1257 03754000
         L     @15,ADIFCMSG(,R2)                                   1257 03755000
         LA    @01,@AL01257                                        1257 03756000
         BALR  @14,@15                                             1257 03757000
*IF MSGNO = 6 THEN                                                 1258 03758000
@RF01256 CLI   MSGNO,6                                             1258 03759000
         BNE   @RF01258                                            1258 03760000
*  DO;                                                     /*@Z427VLS*/ 03761000
*    CALL IFCMSG(73,ADDR(PRINTBDY));                       /*@Z427VLS*/ 03762000
         LA    @08,PRINTBDY                                        1260 03763000
         ST    @08,@AFTEMPS+4                                      1260 03764000
         L     @15,ADIFCMSG(,R2)                                   1260 03765000
         LA    @01,@AL01260                                        1260 03766000
         BALR  @14,@15                                             1260 03767000
*    ER3 = EVSERIAL(K);                                    /*@Z427VLS*/ 03768000
         L     @08,K                                               1261 03769000
         MH    @08,@CH00081                                        1261 03770000
         L     @06,EVPTR(,R2)                                      1261 03771000
         ALR   @06,@08                                             1261 03772000
         MVC   ER3(3),EVSERIAL-6(@06)                              1261 03773000
*    SLL(ERSER,4); /*SHIFT SERIAL IN ORDER TO ADD PACKED SIGN*/    1262 03774000
         L     @08,ERSER                                           1262 03775000
         SLL   @08,4                                               1262 03776000
         ST    @08,ERSER                                           1262 03777000
*    ER3 = (ER3 | '00000F'X);   /*ADD SIGN FOR PROPER UNPACKING*/  1263 03778000
         OC    ER3(3),@CB00228                                     1263 03779000
*    UNPK(PRNTSER,ERSER);                                  /*@Z427VLS*/ 03780000
         UNPK  PRNTSER(7),ERSER(4)                                 1264 03781000
*  END;                                                    /*@Z427VLS*/ 03782000
*IF MSGNO = FIVE THEN                                              1266 03783000
@RF01258 CLI   MSGNO,5                                             1266 03784000
         BNE   @RF01266                                            1266 03785000
*  CALL IFCMSG(72,ADDR(PRINTBDY));                         /*@Z427VLS*/ 03786000
         LA    @08,PRINTBDY                                        1267 03787000
         ST    @08,@AFTEMPS+4                                      1267 03788000
         L     @15,ADIFCMSG(,R2)                                   1267 03789000
         LA    @01,@AL01267                                        1267 03790000
         BALR  @14,@15                                             1267 03791000
*IF MSGNO = 78 THEN                                                1268 03792000
@RF01266 CLI   MSGNO,78                                            1268 03793000
         BNE   @RF01268                                            1268 03794000
* DO;                                                      /*@G51DGBB*/ 03795000
*   CALL IFCMSG(78,ADDR(PRINTBDY));                        /*@G51DGBB*/ 03796000
         LA    @08,PRINTBDY                                        1270 03797000
         ST    @08,@AFTEMPS+4                                      1270 03798000
         L     @15,ADIFCMSG(,R2)                                   1270 03799000
         LA    @01,@AL01270                                        1270 03800000
         BALR  @14,@15                                             1270 03801000
*   NUMBER = 3;                                            /*@G51DGBB*/ 03802000
         MVC   NUMBER(4),@CF00076                                  1271 03803000
*   ADDNXT = ADDR(PFRAMSER);                               /*@G51DGBB*/ 03804000
         LA    @08,PFRAMSER                                        1272 03805000
         ST    @08,ADDNXT                                          1272 03806000
*   NEXTBY = ADDR(FRAMESER(CCHINDX));                      /*@G51DGBB*/ 03807000
         L     @08,CCHINDX                                         1273 03808000
         MH    @08,@CH00227                                        1273 03809000
         L     @06,FRAMEPTR(,R2)                                   1273 03810000
         AL    @06,@CF01574                                        1273 03811000
         LA    @08,FRAMESER-4(@08,@06)                             1273 03812000
         ST    @08,NEXTBY                                          1273 03813000
*   CALL CONVERT;                                          /*@G51DGBB*/ 03814000
         BAL   @14,CONVERT                                         1274 03815000
*   NUMBER = 2;                                            /*@G51DGBB*/ 03816000
         MVC   NUMBER(4),@CF00074                                  1275 03817000
*   ADDNXT = ADDR(PFRAMMOD);                               /*@G51DGBB*/ 03818000
         LA    @08,PFRAMMOD                                        1276 03819000
         ST    @08,ADDNXT                                          1276 03820000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX));                      /*@G51DGBB*/ 03821000
         L     @08,CCHINDX                                         1277 03822000
         MH    @08,@CH00227                                        1277 03823000
         L     @06,FRAMEPTR(,R2)                                   1277 03824000
         AL    @06,@CF01604                                        1277 03825000
         LA    @08,FRAMEMOD-7(@08,@06)                             1277 03826000
         ST    @08,NEXTBY                                          1277 03827000
*   CALL CONVERT;                                          /*@G51DGBB*/ 03828000
         BAL   @14,CONVERT                                         1278 03829000
* END;                                                     /*@G51DGBB*/ 03830000
*IF MSGNO = 79  &   /*IF MISSING FRAME SET MESSAGE           @G51DGBB*/ 03831000
*   DEBUG16 = ON THEN  /*IF DEBUG16 ERROR MESSAGES TO BE PRINTED*/ 1280 03832000
@RF01268 CLI   MSGNO,79                                            1280 03833000
         BNE   @RF01280                                            1280 03834000
         TM    DEBUG16(R2),B'10000000'                             1280 03835000
         BNO   @RF01280                                            1280 03836000
*  DO;                                                     /*@G51DGBB*/ 03837000
*    NUMBER = 3;                                           /*@G51DGBB*/ 03838000
         MVC   NUMBER(4),@CF00076                                  1282 03839000
*    ADDNXT = ADDR(PARSER);                                /*@G51DGBB*/ 03840000
         LA    @08,PARSER                                          1283 03841000
         ST    @08,ADDNXT                                          1283 03842000
*    NEXTBY = ADDR(FRAMESER(CCHINDX));                     /*@G51DGBB*/ 03843000
         L     @08,CCHINDX                                         1284 03844000
         MH    @08,@CH00227                                        1284 03845000
         L     @06,FRAMEPTR(,R2)                                   1284 03846000
         AL    @06,@CF01574                                        1284 03847000
         LA    @08,FRAMESER-4(@08,@06)                             1284 03848000
         ST    @08,NEXTBY                                          1284 03849000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03850000
         BAL   @14,CONVERT                                         1285 03851000
*    NUMBER = 2;                                           /*@G51DGBB*/ 03852000
         MVC   NUMBER(4),@CF00074                                  1286 03853000
*    ADDNXT = ADDR(PARMOD);                                /*@G51DGBB*/ 03854000
         LA    @08,PARMOD                                          1287 03855000
         ST    @08,ADDNXT                                          1287 03856000
*    NEXTBY = ADDR(FRAMEMOD(CCHINDX));                     /*@G51DGBB*/ 03857000
         L     @08,CCHINDX                                         1288 03858000
         MH    @08,@CH00227                                        1288 03859000
         L     @06,FRAMEPTR(,R2)                                   1288 03860000
         AL    @06,@CF01604                                        1288 03861000
         LA    @08,FRAMEMOD-7(@08,@06)                             1288 03862000
         ST    @08,NEXTBY                                          1288 03863000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03864000
         BAL   @14,CONVERT                                         1289 03865000
*    NUMBER = 1;                                           /*@G51DGBB*/ 03866000
         MVC   NUMBER(4),@CF00055                                  1290 03867000
*    ADDNXT = ADDR(PARREP);                                /*@G51DGBB*/ 03868000
         LA    @08,PARREP                                          1291 03869000
         ST    @08,ADDNXT                                          1291 03870000
*    NEXTBY = ADDR(FRAMETYP(CCHINDX));                     /*@G51DGBB*/ 03871000
         L     @08,CCHINDX                                         1292 03872000
         MH    @08,@CH00227                                        1292 03873000
         L     @06,FRAMEPTR(,R2)                                   1292 03874000
         AL    @06,@CF01571                                        1292 03875000
         LA    @08,FRAMETYP-17(@08,@06)                            1292 03876000
         ST    @08,NEXTBY                                          1292 03877000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03878000
         BAL   @14,CONVERT                                         1293 03879000
*    PRINTBDY(1:58) = PARTIAL;                             /*@G51DGBB*/ 03880000
         MVC   PRINTBDY(58),PARTIAL                                1294 03881000
*  END;                                                    /*@G51DGBB*/ 03882000
*IF MSGNO = 40 THEN                                                1296 03883000
@RF01280 CLI   MSGNO,40                                            1296 03884000
         BNE   @RF01296                                            1296 03885000
* CALL IFCMSG(40,ADDR(PRINTBDY));                          /*@G51DGBB*/ 03886000
         LA    @08,PRINTBDY                                        1297 03887000
         ST    @08,@AFTEMPS+4                                      1297 03888000
         L     @15,ADIFCMSG(,R2)                                   1297 03889000
         LA    @01,@AL01297                                        1297 03890000
         BALR  @14,@15                                             1297 03891000
*IF MSGNO = 24 THEN                                                1298 03892000
@RF01296 CLI   MSGNO,24                                            1298 03893000
         BNE   @RF01298                                            1298 03894000
* CALL IFCMSG(24,ADDR(PRINTBDY));                          /*@G51DGBB*/ 03895000
         LA    @08,PRINTBDY                                        1299 03896000
         ST    @08,@AFTEMPS+4                                      1299 03897000
         L     @15,ADIFCMSG(,R2)                                   1299 03898000
         LA    @01,@AL01299                                        1299 03899000
         BALR  @14,@15                                             1299 03900000
*CALL IOHND(RITEPRTR); /*CALL IFCIOHND TO WRITE TO TOURIST D.S.*/  1300 03901000
@RF01298 L     @15,ADIOHND(,R2)                                    1300 03902000
         LA    @01,@AL01300                                        1300 03903000
         BALR  @14,@15                                             1300 03904000
*END;  /*CLOSING END FOR PROC ERRMSG                         @Z427VLS*/ 03905000
@EL00030 DS    0H                                                  1301 03906000
@EF00030 DS    0H                                                  1301 03907000
@ER00030 LM    @14,@12,@SA00030                                    1301 03908000
         BR    @14                                                 1301 03909000
*SORTSHAR: PROC;        /* SORT SHARE TABLE CPU BY LETTER  @ZA17692 */  03910000
SORTSHAR STM   @14,@12,12(@13)                                     1302 03911000
*  DO J=1 BY 1 TO SHARENUM-1;                           /* @ZA17692 */  03912000
         LA    @08,1                                               1303 03913000
         ST    @08,J                                               1303 03914000
         B     @DE01303                                            1303 03915000
@DL01303 DS    0H                                                  1304 03916000
*    DO K= J+1 BY 1 TO SHARENUM;                        /* @ZA17692 */  03917000
         AL    @08,@CF00055                                        1304 03918000
         ST    @08,K                                               1304 03919000
         B     @DE01304                                            1304 03920000
@DL01304 DS    0H                                                  1305 03921000
*      IF SHARLET(J) > SHARLET(K)  THEN                 /* @ZA17692 */  03922000
         LA    @06,11                                              1305 03923000
         L     @01,J                                               1305 03924000
         MR    @00,@06                                             1305 03925000
         L     @03,SHAREPTR(,R2)                                   1305 03926000
         LR    @05,@08                                             1305 03927000
         MR    @04,@06                                             1305 03928000
         ST    @01,@TF00001                                        1305 03929000
         ALR   @01,@03                                             1305 03930000
         ST    @05,@TF00002                                        1305 03931000
         ALR   @05,@03                                             1305 03932000
         CLC   SHARLET-11(1,@01),SHARLET-11(@05)                   1305 03933000
         BNH   @RF01305                                            1305 03934000
*        DO;                                            /* @ZA17692 */  03935000
*          SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));         /* @ZA17692 */  03936000
         LR    @08,@03                                             1307 03937000
         AL    @08,@TF00001                                        1307 03938000
         AL    @08,@CF01580                                        1307 03939000
         LR    @06,@03                                             1307 03940000
         AL    @06,@TF00001                                        1307 03941000
         AL    @06,@CF01580                                        1307 03942000
         MVC   @TS00001(11),SHAREIO-2(@06)                         1307 03943000
         LR    @06,@03                                             1307 03944000
         AL    @06,@TF00002                                        1307 03945000
         AL    @06,@CF01580                                        1307 03946000
         XC    @TS00001(11),SHAREIO-2(@06)                         1307 03947000
         MVC   SHAREIO-2(11,@08),@TS00001                          1307 03948000
*          SHAREIO(K)=(SHAREIO(K)&&SHAREIO(J));         /* @ZA17692 */  03949000
         LR    @08,@03                                             1308 03950000
         AL    @08,@TF00002                                        1308 03951000
         AL    @08,@CF01580                                        1308 03952000
         LR    @06,@03                                             1308 03953000
         AL    @06,@TF00002                                        1308 03954000
         AL    @06,@CF01580                                        1308 03955000
         MVC   @TS00001(11),SHAREIO-2(@06)                         1308 03956000
         LR    @06,@03                                             1308 03957000
         AL    @06,@TF00001                                        1308 03958000
         AL    @06,@CF01580                                        1308 03959000
         XC    @TS00001(11),SHAREIO-2(@06)                         1308 03960000
         MVC   SHAREIO-2(11,@08),@TS00001                          1308 03961000
*          SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));         /* @ZA17692 */  03962000
         LR    @08,@03                                             1309 03963000
         AL    @08,@TF00001                                        1309 03964000
         AL    @08,@CF01580                                        1309 03965000
         LR    @06,@03                                             1309 03966000
         AL    @06,@TF00001                                        1309 03967000
         AL    @06,@CF01580                                        1309 03968000
         MVC   @TS00001(11),SHAREIO-2(@06)                         1309 03969000
         AL    @03,@TF00002                                        1309 03970000
         AL    @03,@CF01580                                        1309 03971000
         XC    @TS00001(11),SHAREIO-2(@03)                         1309 03972000
         MVC   SHAREIO-2(11,@08),@TS00001                          1309 03973000
*        END;                                           /* @ZA17692 */  03974000
*     END;                                              /* @ZA17692 */  03975000
@RF01305 LA    @08,1                                               1311 03976000
         AL    @08,K                                               1311 03977000
         ST    @08,K                                               1311 03978000
@DE01304 L     @06,SHAREPTR(,R2)                                   1311 03979000
         CH    @08,SHARENUM(,@06)                                  1311 03980000
         BNH   @DL01304                                            1311 03981000
*  END;                                                 /* @ZA17692 */  03982000
         LA    @08,1                                               1312 03983000
         AL    @08,J                                               1312 03984000
         ST    @08,J                                               1312 03985000
@DE01303 L     @06,SHAREPTR(,R2)                                   1312 03986000
         LH    @06,SHARENUM(,@06)                                  1312 03987000
         BCTR  @06,0                                               1312 03988000
         CR    @08,@06                                             1312 03989000
         BNH   @DL01303                                            1312 03990000
*END;                       /*  CLOSING END FOR SORTSHAR   @ZA17692 */  03991000
@EL00031 DS    0H                                                  1313 03992000
@EF00031 DS    0H                                                  1313 03993000
@ER00031 LM    @14,@12,12(@13)                                     1313 03994000
         BR    @14                                                 1313 03995000
*BUGCNTS: PROC;                                            /*@Z427VLS*/ 03996000
BUGCNTS  STM   @14,@12,@SA00032                                    1314 03997000
*/*PRINT COUNTS OF RECORDS PROCESSED IF DEBUG16 IS ON        @Z427VLS*/ 03998000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 03999000
         LA    @08,PRINTLIN                                        1315 04000000
         ST    @08,PRINTADR(,R2)                                   1315 04001000
*M = 42; /*DONT SET ERRLINE EXPLICITLY OR COMPILER WILL CHOKE*/    1316 04002000
         LA    @08,42                                              1316 04003000
         ST    @08,M                                               1316 04004000
*PRINTLIN = ERRLINE(M);  /*PLACE DEBUG COUNTS HEADER MESSAGE IN PRINT*/ 04005000
         MVI   PRINTLIN+73,C' '                                    1317 04006000
         MVC   PRINTLIN+74(60),PRINTLIN+73                         1317 04007000
         MH    @08,@CH01510                                        1317 04008000
         LA    @06,ERRLINE-73(@08)                                 1317 04009000
         MVC   PRINTLIN(73),0(@06)                                 1317 04010000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 04011000
         L     @15,ADIOHND(,R2)                                    1318 04012000
         LA    @01,@AL01318                                        1318 04013000
         BALR  @14,@15                                             1318 04014000
* DO M = 1 BY 1 TO 41;   /*PRINT ALL DEBUG COUNTS            @G51DGBB*/ 04015000
         LA    @08,1                                               1319 04016000
         ST    @08,M                                               1319 04017000
@DL01319 DS    0H                                                  1320 04018000
*  NUMREC = BUG(M);                                        /*@Z427VLS*/ 04019000
         SLA   @08,2                                               1320 04020000
         L     @08,BUG-4(@08)                                      1320 04021000
         ST    @08,NUMREC                                          1320 04022000
*  CVD(NUMREC,PACKPAS);                                    /*@Z427VLS*/ 04023000
         CVD   @08,@TS00001                                        1321 04024000
         MVC   PACKPAS(4),@TS00001+4                               1321 04025000
*  PACKPAS = (PACKPAS | '0000000F'X);                      /*@Z427VLS*/ 04026000
         OC    PACKPAS(4),@CB01432                                 1322 04027000
*  UNPK(EDFLD,PACKPAS);                                    /*@Z427VLS*/ 04028000
         UNPK  EDFLD(9),PACKPAS(4)                                 1323 04029000
*  NONBLANK = OFF;                                         /*@Z427VLS*/ 04030000
         NI    NONBLANK,B'10111111'                                1324 04031000
*  DO L = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                /*@Z427VLS*/ 04032000
         LA    @08,1                                               1325 04033000
         ST    @08,L                                               1325 04034000
@DL01325 TM    NONBLANK,B'01000000'                                1325 04035000
         BNZ   @DC01325                                            1325 04036000
*    IF EDIFILD(L) = CHARZERO THEN                                 1326 04037000
         LA    @06,EDIFILD-1(@08)                                  1326 04038000
         CLI   0(@06),X'F0'                                        1326 04039000
         BNE   @RF01326                                            1326 04040000
*      EDIFILD(L) = BLANK;                                 /*@Z427VLS*/ 04041000
         LA    @06,EDIFILD-1(@08)                                  1327 04042000
         MVI   0(@06),X'40'                                        1327 04043000
*    ELSE                                                          1328 04044000
*      NONBLANK = ON;                                      /*@Z427VLS*/ 04045000
         B     @RC01326                                            1328 04046000
@RF01326 OI    NONBLANK,B'01000000'                                1328 04047000
*  END;                                                    /*@Z427VLS*/ 04048000
@RC01326 LA    @08,1                                               1329 04049000
         AL    @08,L                                               1329 04050000
         ST    @08,L                                               1329 04051000
         C     @08,@CF00066                                        1329 04052000
         BNH   @DL01325                                            1329 04053000
@DC01325 DS    0H                                                  1330 04054000
*  ERXNUM(M) = EDFLD;                                      /*@Z427VLS*/ 04055000
         L     @08,M                                               1330 04056000
         MH    @08,@CH01510                                        1330 04057000
         LA    @06,ERXNUM-73(@08)                                  1330 04058000
         MVC   0(9,@06),EDFLD                                      1330 04059000
*  PRINTLIN = ERRLINE(M);                                  /*@Z427VLS*/ 04060000
         MVI   PRINTLIN+73,C' '                                    1331 04061000
         MVC   PRINTLIN+74(60),PRINTLIN+73                         1331 04062000
         LA    @06,ERRLINE-73(@08)                                 1331 04063000
         MVC   PRINTLIN(73),0(@06)                                 1331 04064000
*  PRINTADR = ADDR(PRINTLIN);                              /*@Z427VLS*/ 04065000
         LA    @08,PRINTLIN                                        1332 04066000
         ST    @08,PRINTADR(,R2)                                   1332 04067000
*  CALL IOHND(RITEPRTR);                                   /*@Z427VLS*/ 04068000
         L     @15,ADIOHND(,R2)                                    1333 04069000
         LA    @01,@AL01333                                        1333 04070000
         BALR  @14,@15                                             1333 04071000
*END; /*END OF M LOOP                                        @Z427VLS*/ 04072000
         LA    @08,1                                               1334 04073000
         AL    @08,M                                               1334 04074000
         ST    @08,M                                               1334 04075000
         C     @08,@CF01520                                        1334 04076000
         BNH   @DL01319                                            1334 04077000
*END; /*CLOSING END TO PROC BUGCNTS                          @Z427VLS*/ 04078000
@EL00032 DS    0H                                                  1335 04079000
@EF00032 DS    0H                                                  1335 04080000
@ER00032 LM    @14,@12,@SA00032                                    1335 04081000
         BR    @14                                                 1335 04082000
*/*THIS PROC WILL EXAMINE THE MERIDIAN MCH OR CCH IN ORDER TO BUILD*/   04083000
*/*FRAMTAB ENTRIES FOR UNIQUE RECORDS                        @G51DGBB*/ 04084000
*BUILDFTB: PROC; /*BUILD NEW ENTRY IF CPU IS UNIQUE          @G51DGBB*/ 04085000
BUILDFTB STM   @14,@12,@SA00033                                    1336 04086000
*LOOPOUT = NO;                                             /*@G51DGBB*/ 04087000
         NI    LOOPOUT,B'11111101'                                 1337 04088000
*DO Y = 1 BY 1 TO EVMAX WHILE LOOPOUT = NO; /*EXAMINE ALL FRAMETAB*/    04089000
         LA    @08,1                                               1338 04090000
         ST    @08,Y                                               1338 04091000
@DL01338 TM    LOOPOUT,B'00000010'                                 1338 04092000
         BNZ   @DC01338                                            1338 04093000
*  IF FRAMECPU(Y) = LRTCPMOD THEN  /*IF CPU ALREADY IN TABLE THEN*/     04094000
         MH    @08,@CH00227                                        1339 04095000
         L     @06,FRAMEPTR(,R2)                                   1339 04096000
         ALR   @06,@08                                             1339 04097000
         AL    @06,@CF01574                                        1339 04098000
         CLC   FRAMECPU-4(5,@06),LRTCPMOD(R7)                      1339 04099000
         BNE   @RF01339                                            1339 04100000
*    LOOPOUT = YES; /*EXIT LOOP                              @G51DGBB*/ 04101000
         OI    LOOPOUT,B'00000010'                                 1340 04102000
*  ELSE     /*IF ENTRY DOESNT MATCH THE FRAME                @G51DGBB*/ 04103000
*    DO;                                                   /*@G51DGBB*/ 04104000
         B     @RC01339                                            1341 04105000
@RF01339 DS    0H                                                  1342 04106000
*      IF FRAMECPU(Y) = '0000000000'X THEN /*NO MATCH, ALL SET */  1342 04107000
         L     @08,Y                                               1342 04108000
         MH    @08,@CH00227                                        1342 04109000
         L     @06,FRAMEPTR(,R2)                                   1342 04110000
         ST    @08,@TF00001                                        1342 04111000
         ALR   @08,@06                                             1342 04112000
         AL    @08,@CF01574                                        1342 04113000
         CLC   FRAMECPU-4(5,@08),@CB00288                          1342 04114000
         BNE   @RF01342                                            1342 04115000
*        DO;                              /*ENTRIES EXAMINED @G51DGBB*/ 04116000
*          FRAMECPU(Y) = LRTCPMOD;                         /*@G51DGBB*/ 04117000
         LR    @08,@06                                             1344 04118000
         AL    @08,@TF00001                                        1344 04119000
         AL    @08,@CF01574                                        1344 04120000
         MVC   FRAMECPU-4(5,@08),LRTCPMOD(R7)                      1344 04121000
*          FRAMENUM = FRAMENUM + 1; /*COUNT NUMBER OF ENTRIES BUILT*/   04122000
         LA    @08,1                                               1345 04123000
         AL    @08,FRAMENUM(,@06)                                  1345 04124000
         ST    @08,FRAMENUM(,@06)                                  1345 04125000
*          LOOPOUT = YES;                                  /*@G51DGBB*/ 04126000
         OI    LOOPOUT,B'00000010'                                 1346 04127000
*        END;                                              /*@G51DGBB*/ 04128000
*      ELSE                                                        1348 04129000
*        IF Y = EVMAX THEN /*UNIQUE ENTRY BUT NOT ROOM IN TABLE*/  1348 04130000
         B     @RC01342                                            1348 04131000
@RF01342 CLC   Y(4),@CF00088                                       1348 04132000
         BNE   @RF01348                                            1348 04133000
*          DO;                                             /*@G51DGBB*/ 04134000
*            IF ONETIME = NO THEN   /*ISSUE MESSAGE ONLY ONCE*/    1350 04135000
         TM    ONETIME,B'10000000'                                 1350 04136000
         BNZ   @RF01350                                            1350 04137000
*              DO;                                         /*@G51DGBB*/ 04138000
*                MSGNO = 24;                               /*@G51DGBB*/ 04139000
         MVI   MSGNO,X'18'                                         1352 04140000
*                CALL ERRMSG;                              /*@G51DGBB*/ 04141000
         BAL   @14,ERRMSG                                          1353 04142000
*                ONETIME = YES;                            /*@G51DGBB*/ 04143000
         OI    ONETIME,B'10000000'                                 1354 04144000
*              END;                                        /*@G51DGBB*/ 04145000
*          END;                                            /*@G51DGBB*/ 04146000
@RF01350 DS    0H                                                  1357 04147000
*   END;                                                   /*@G51DGBB*/ 04148000
@RF01348 DS    0H                                                  1357 04149000
@RC01342 DS    0H                                                  1358 04150000
*  END;                                                    /*@G51DGBB*/ 04151000
@RC01339 LA    @08,1                                               1358 04152000
         AL    @08,Y                                               1358 04153000
         ST    @08,Y                                               1358 04154000
         C     @08,@CF00088                                        1358 04155000
         BNH   @DL01338                                            1358 04156000
@DC01338 DS    0H                                                  1359 04157000
*END; /*END OF PROC BUILDFTB                                 @G51DGBB*/ 04158000
@EL00033 DS    0H                                                  1359 04159000
@EF00033 DS    0H                                                  1359 04160000
@ER00033 LM    @14,@12,@SA00033                                    1359 04161000
         BR    @14                                                 1359 04162000
*FRAMEREP: PROC; /*REPLACE FRAME IF MORE CURRENT FRAME FOUND @G51DGBB*/ 04163000
FRAMEREP STM   @14,@12,@SA00034                                    1360 04164000
*                /*COMPLETE ENTRY IF NO DATE ETC.            @G51DGBB*/ 04165000
*                /*APPEND LOCATION OF FRAME EXTERNAL LOCATION LIST*/    04166000
*GETOUT = NO;                                              /*@G51DGBB*/ 04167000
         NI    GETOUT,B'10111111'                                  1361 04168000
*DO X = 1 BY 1 TO FRAMENUM WHILE GETOUT = NO; /*LOOP THROUGH ALL SET*/  04169000
         LA    @08,1                                               1362 04170000
         ST    @08,X                                               1362 04171000
         B     @DE01362                                            1362 04172000
@DL01362 TM    GETOUT,B'01000000'                                  1362 04173000
         BNZ   @DC01362                                            1362 04174000
*                                             /*ENTRIES OF FRAMETAB */  04175000
*  IF FRAMECPU(X) = LRTCPMOD THEN             /*IF RECORD CPU MODEL */  04176000
         LR    @06,@08                                             1363 04177000
         MH    @06,@CH00227                                        1363 04178000
         L     @03,FRAMEPTR(,R2)                                   1363 04179000
         ST    @06,@TF00001                                        1363 04180000
         ALR   @06,@03                                             1363 04181000
         AL    @06,@CF01574                                        1363 04182000
         CLC   FRAMECPU-4(5,@06),LRTCPMOD(R7)                      1363 04183000
         BNE   @RF01363                                            1363 04184000
*    DO;                                      /*SERIAL MATCHES THOSE*/  04185000
*      CCHINDX = X;  /*SAVE INDEX*/           /*OF THE ENTRY @G51DGBB*/ 04186000
         ST    @08,CCHINDX                                         1365 04187000
*      IF FRAMEDT(X) < LRTDT THEN             /*IF REC DATE GREATER */  04188000
         AL    @03,@TF00001                                        1366 04189000
         AL    @03,@CF01605                                        1366 04190000
         CLC   FRAMEDT-9(8,@03),LRTDT(R7)                          1366 04191000
         BNL   @RF01366                                            1366 04192000
*        DO;                                  /*THAN ENTRY DATE     */  04193000
*              CALL FIXENTRY;               /*DELETE OLD FRAME SET*/    04194000
         BAL   @14,FIXENTRY                                        1368 04195000
*              FRAMEDT(X) = LRTDT;           /*SAVE HIGH DATE*/    1369 04196000
         L     @08,X                                               1369 04197000
         MH    @08,@CH00227                                        1369 04198000
         L     @06,FRAMEPTR(,R2)                                   1369 04199000
         ALR   @06,@08                                             1369 04200000
         AL    @06,@CF01605                                        1369 04201000
         MVC   FRAMEDT-9(8,@06),LRTDT(R7)                          1369 04202000
*              CALL BUILDTTR;                /*SAVE FRAME LOCATION*/    04203000
         BAL   @14,BUILDTTR                                        1370 04204000
*               FRAMEYES = YES;/*SAVE SUCCEEDING FRAMES OF THIS    */   04205000
         OI    FRAMEYES,B'00000001'                                1371 04206000
*                              /*LOGICAL SET                 @G51DGBB*/ 04207000
*         END;                                             /*@G51DGBB*/ 04208000
*       ELSE  /*IMPLIES DATE IS LOW OR EQUAL                 @G51DGBB*/ 04209000
*        DO;                                               /*@G51DGBB*/ 04210000
         B     @RC01366                                            1373 04211000
@RF01366 DS    0H                                                  1374 04212000
*         IF FRAMEDT(X) = LRTDT THEN /*IF TABLE DATE EQUALS RECORD DAT* 04213000
         L     @08,X                                               1374 04214000
         MH    @08,@CH00227                                        1374 04215000
         L     @06,FRAMEPTR(,R2)                                   1374 04216000
         ST    @08,@TF00001                                        1374 04217000
         ALR   @08,@06                                             1374 04218000
         AL    @08,@CF01605                                        1374 04219000
         CLC   FRAMEDT-9(8,@08),LRTDT(R7)                          1374 04220000
         BNE   @RF01374                                            1374 04221000
*           DO;                                            /*@G51DGBB*/ 04222000
*            IF FRAMETYP(X) ^= ALLALL THEN                         1376 04223000
         AL    @06,@TF00001                                        1376 04224000
         AL    @06,@CF01571                                        1376 04225000
         CLI   FRAMETYP-17(@06),X'FF'                              1376 04226000
         BE    @RF01376                                            1376 04227000
*             DO;                                          /*@G51DGBB*/ 04228000
*                      CALL FIXENTRY; /*DELETE INCOMPLETE SET       */  04229000
         BAL   @14,FIXENTRY                                        1378 04230000
*                      MSGNO = 79; /*INCOMPLETE FRAME SET MESSAGE*/     04231000
         MVI   MSGNO,X'4F'                                         1379 04232000
*                      CALL ERRMSG;                        /*@G51DGBB*/ 04233000
         BAL   @14,ERRMSG                                          1380 04234000
*                      CALL BUILDTTR; /*SAVE NEW FIRST GOOD FRAME*/     04235000
         BAL   @14,BUILDTTR                                        1381 04236000
*                      FRAMEYES = YES; /*SAVE SUCCEEDING MEMBERS */     04237000
         OI    FRAMEYES,B'00000001'                                1382 04238000
*             END;                                         /*@G51DGBB*/ 04239000
*            ELSE  /*COMPLETE SET FOR THIS DATE ALREADY EXISTS      */  04240000
*               DO; /*FRAMETYP IS EQUAL TO ALLALL            @G51DGBB*/ 04241000
         B     @RC01376                                            1384 04242000
@RF01376 DS    0H                                                  1385 04243000
*                   FRAMEYES = NO;/*DELETE SUCCEEDING FRAMES OF SET */  04244000
         NI    FRAMEYES,B'11111110'                                1385 04245000
*                   BUG(41) = BUG(41) + 1; /*COUNT FRAME AS NOT USED*/  04246000
         LA    @08,1                                               1386 04247000
         AL    @08,BUG+160                                         1386 04248000
         ST    @08,BUG+160                                         1386 04249000
*               END;                                       /*@G51DGBB*/ 04250000
*        END; /*END OF CODE IF DATE IN RECORD EQUALS DATE IN TABLE*/    04251000
*       ELSE /*DATE IN TABLE GREATER THAN FRAME RECORD DATE  @G51DGBB*/ 04252000
*        BUG(41) = BUG(41)  + 1;                           /*@G51DGBB*/ 04253000
         B     @RC01374                                            1389 04254000
@RF01374 LA    @08,1                                               1389 04255000
         AL    @08,BUG+160                                         1389 04256000
         ST    @08,BUG+160                                         1389 04257000
*    END; /*END OF CODE IF DATE IN RECORD IS LOW OR EQUAL    @G51DGBB*/ 04258000
@RC01374 DS    0H                                                  1391 04259000
*  GETOUT = YES; /*GET OUT OF LOOP AFTER CPU MATCH           @G51DGBB*/ 04260000
@RC01366 OI    GETOUT,B'01000000'                                  1391 04261000
* END; /*END OF CODE FOR A RECORD TO ENTRY CPU MATCH         @G51DGBB*/ 04262000
*END; /*END OF FRAMETAB LOOP                                 @G51DGBB*/ 04263000
@RF01363 LA    @08,1                                               1393 04264000
         AL    @08,X                                               1393 04265000
         ST    @08,X                                               1393 04266000
@DE01362 L     @06,FRAMEPTR(,R2)                                   1393 04267000
         C     @08,FRAMENUM(,@06)                                  1393 04268000
         BNH   @DL01362                                            1393 04269000
@DC01362 DS    0H                                                  1394 04270000
*IF GETOUT = NO THEN /*MERIDIAN FRAME BUT NO ROOM IN TABLE   @G51DGBB*/ 04271000
         TM    GETOUT,B'01000000'                                  1394 04272000
         BNZ   @RF01394                                            1394 04273000
*  BUG(41) = BUG(41) + 1;                                  /*@G51DGBB*/ 04274000
         LA    @08,1                                               1395 04275000
         AL    @08,BUG+160                                         1395 04276000
         ST    @08,BUG+160                                         1395 04277000
*END; /*END OF PROC FRAMEREP                                 @G51DGBB*/ 04278000
@EL00034 DS    0H                                                  1396 04279000
@EF00034 DS    0H                                                  1396 04280000
@ER00034 LM    @14,@12,@SA00034                                    1396 04281000
         BR    @14                                                 1396 04282000
*BUILDTTR: PROC; /*SAVE LOCATION OF A FRAME IN LISTLOC       @G51DGBB*/ 04283000
BUILDTTR STM   @14,@12,@SA00035                                    1397 04284000
*RESPECIFY (R0,R1,R4,R15) RESTRICTED;                      /*@G51DGBB*/ 04285000
*IF (LRTKEY1 & GENREC) = HEXA0 THEN /* IF MCH FRAME          @G51DGBB*/ 04286000
         MVC   @TS00001(1),LRTKEY1(R7)                             1399 04287000
         NI    @TS00001,X'F0'                                      1399 04288000
         CLI   @TS00001,X'A0'                                      1399 04289000
         BNE   @RF01399                                            1399 04290000
*  DO;                                                     /*@G51DGBB*/ 04291000
*    IF FRAMLOCM(CCHINDX) = ZERO THEN /*IF LISTLOC CORE FOR A CPU*/     04292000
         L     @14,CCHINDX                                         1401 04293000
         MH    @14,@CH00227                                        1401 04294000
         L     @08,FRAMEPTR(,R2)                                   1401 04295000
         AL    @08,@CF01581                                        1401 04296000
         L     @14,FRAMLOCM-20(@14,@08)                            1401 04297000
         LTR   @14,@14                                             1401 04298000
         BNZ   @RF01401                                            1401 04299000
*      DO;                            /*IS UNALLOCATED       @G51DGBB*/ 04300000
*        R0 = LISTBENT * LISTMAX * 2; /*ALLOCATE CORE FOR BOTH CCH*/    04301000
         LA    R0,500                                              1403 04302000
*        R0 = R0 + 12;                /*AND MCH FRAME LOCATIONS   */    04303000
         AL    R0,@CF00032                                         1404 04304000
*        GEN(GETMAIN EC,LV=(R0),A=LINKITM,SP=21);          /*@G51DGBB*/ 04305000
         GETMAIN EC,LV=(R0),A=LINKITM,SP=21                             04306000
*        IF R15 = SUCCESS THEN                                     1406 04307000
         LTR   R15,R15                                             1406 04308000
         BNZ   @RF01406                                            1406 04309000
*          DO;                                             /*@G51DGBB*/ 04310000
*            R1 = LINKITM;  /*GRAB GOTTEN CORE ADDRESS FROM GETMAIN*/   04311000
         L     R1,LINKITM                                          1408 04312000
*            FRAMLOCM(CCHINDX) = R1;  /*SET POINTERS TO LISTLOC   */    04313000
         L     @14,CCHINDX                                         1409 04314000
         MH    @14,@CH00227                                        1409 04315000
         L     @08,FRAMEPTR(,R2)                                   1409 04316000
         AL    @08,@CF01581                                        1409 04317000
         ST    R1,FRAMLOCM-20(@14,@08)                             1409 04318000
*            R1 = R1+LISTBENT *       /*TABLES FOR BOTH CCL AND MCH*/   04319000
*                LISTMAX+4;           /*FRAMES               @G51DGBB*/ 04320000
         AL    R1,@CF01563                                         1410 04321000
*            R0 = ZERO;          /*ENSURE THAT TABLE ON WORD BOUNDARY*/ 04322000
         SLR   R0,R0                                               1411 04323000
*            R4 = 4;             /*DIVIDE BY NUMBER OF BYTES IN WORD*/  04324000
         LA    R4,4                                                1412 04325000
*            GEN(DR R0,R4);                                /*@G51DGBB*/ 04326000
         DR R0,R4                                                       04327000
*            IF R0 > ZERO THEN /*REMAINDER MEANS NOT INTEGRAL NUMBER*/  04328000
         LTR   R0,R0                                               1414 04329000
         BNP   @RF01414                                            1414 04330000
*                              /*NUMBER OF DOUBLEWORDS.      @G51DGBB*/ 04331000
*              R1 = R1 + 1; /*ADD ONE EXTRA FULL WORD        @G51DGBB*/ 04332000
         AL    R1,@CF00055                                         1415 04333000
*            R1 = R1 * FOUR; /*RESET ONE TO NUMBER OF BYTES  @G51DGBB*/ 04334000
@RF01414 SLL   R1,2                                                1416 04335000
*            FRAMLOCC(CCHINDX) = R1; /*SET POINTER TO CCH CCHHR TABLE*/ 04336000
         L     @14,CCHINDX                                         1417 04337000
         MH    @14,@CH00227                                        1417 04338000
         L     @08,FRAMEPTR(,R2)                                   1417 04339000
         ST    R1,FRAMLOCC-24(@14,@08)                             1417 04340000
*            LISTPTR = R1;      /*ESTABLISH ADDRESSABILITY FOR CCH TB*/ 04341000
         ST    R1,LISTPTR                                          1418 04342000
*            LISTNUM = ZERO;    /*ZERO CCH LISTLOC TABLE     @G51DGBB*/ 04343000
         L     @14,LISTPTR                                         1419 04344000
         SLR   @08,@08                                             1419 04345000
         ST    @08,LISTNUM(,@14)                                   1419 04346000
*            DO Y = 1 BY 1 TO LISTMAX;                     /*@G51DGBB*/ 04347000
         LA    @14,1                                               1420 04348000
         ST    @14,Y                                               1420 04349000
@DL01420 DS    0H                                                  1421 04350000
*              LISTCCHR(Y) = LISTCCHR(Y) &&                        1421 04351000
*                            LISTCCHR(Y);                  /*@G51DGBB*/ 04352000
         LR    @08,@14                                             1421 04353000
         MH    @08,@CH00079                                        1421 04354000
         L     @06,LISTPTR                                         1421 04355000
         ALR   @06,@08                                             1421 04356000
         BCTR  @06,0                                               1421 04357000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1421 04358000
*            END;                                          /*@G51DGBB*/ 04359000
         AL    @14,@CF00055                                        1422 04360000
         ST    @14,Y                                               1422 04361000
         C     @14,@CF00293                                        1422 04362000
         BNH   @DL01420                                            1422 04363000
*            LISTPTR = FRAMLOCM(CCHINDX); /*ADDRESS OF MCH LISTLOC */   04364000
         L     @14,CCHINDX                                         1423 04365000
         MH    @14,@CH00227                                        1423 04366000
         L     @08,FRAMEPTR(,R2)                                   1423 04367000
         AL    @08,@CF01581                                        1423 04368000
         L     @14,FRAMLOCM-20(@14,@08)                            1423 04369000
         ST    @14,LISTPTR                                         1423 04370000
*            DO Y = 1 BY 1 TO LISTMAX;   /* ZERO MCH LISTLOC TABLE  */  04371000
         LA    @14,1                                               1424 04372000
         ST    @14,Y                                               1424 04373000
@DL01424 DS    0H                                                  1425 04374000
*            LISTCCHR(Y) = LISTCCHR(Y) &&                          1425 04375000
*                          LISTCCHR(Y);                    /*@G51DGBB*/ 04376000
         LR    @08,@14                                             1425 04377000
         MH    @08,@CH00079                                        1425 04378000
         L     @06,LISTPTR                                         1425 04379000
         ALR   @06,@08                                             1425 04380000
         BCTR  @06,0                                               1425 04381000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1425 04382000
*            END;                                          /*@G51DGBB*/ 04383000
         AL    @14,@CF00055                                        1426 04384000
         ST    @14,Y                                               1426 04385000
         C     @14,@CF00293                                        1426 04386000
         BNH   @DL01424                                            1426 04387000
*            LISTNUM = ZERO;                               /*@G51DGBB*/ 04388000
         L     @14,LISTPTR                                         1427 04389000
         SLR   @08,@08                                             1427 04390000
         ST    @08,LISTNUM(,@14)                                   1427 04391000
*          END;                                            /*@G51DGBB*/ 04392000
*        ELSE /*UNSUCCESSFUL GETMAIN                         @G51DGBB*/ 04393000
*          DO;                                             /*@G51DGBB*/ 04394000
         B     @RC01406                                            1429 04395000
@RF01406 DS    0H                                                  1430 04396000
*            MSGNO = 40;                                   /*@G51DGBB*/ 04397000
         MVI   MSGNO,X'28'                                         1430 04398000
*            CALL ERRMSG;                                  /*@G51DGBB*/ 04399000
         BAL   @14,ERRMSG                                          1431 04400000
*            R15 = TWELVE;                                 /*@G51DGBB*/ 04401000
         LA    @08,12                                              1432 04402000
         LR    R15,@08                                             1432 04403000
*            ERROR = TWELVE;                               /*@G51DGBB*/ 04404000
         ST    @08,ERROR                                           1433 04405000
*          END;                                            /*@G51DGBB*/ 04406000
*      END;                                                /*@G51DGBB*/ 04407000
@RC01406 DS    0H                                                  1436 04408000
*    IF R15 = ZERO THEN /*IF GETMAIN WAS SUCCESSFUL OR NO GETMAIN*/     04409000
@RF01401 LTR   R15,R15                                             1436 04410000
         BNZ   @RF01436                                            1436 04411000
*      LISTPTR = FRAMLOCM(CCHINDX);/*ESTABLISH LISTLOC ADDRESS   */     04412000
         L     @14,CCHINDX                                         1437 04413000
         MH    @14,@CH00227                                        1437 04414000
         L     @08,FRAMEPTR(,R2)                                   1437 04415000
         AL    @08,@CF01581                                        1437 04416000
         L     @14,FRAMLOCM-20(@14,@08)                            1437 04417000
         ST    @14,LISTPTR                                         1437 04418000
*  END;                                                    /*@G51DGBB*/ 04419000
*ELSE /* IS A CCH FRAME                                      @G51DGBB*/ 04420000
*    LISTPTR = FRAMLOCC(CCHINDX);  /*ESTABLISH CCH LISTLOC ADDRESS*/    04421000
         B     @RC01399                                            1439 04422000
@RF01399 L     @14,CCHINDX                                         1439 04423000
         MH    @14,@CH00227                                        1439 04424000
         L     @08,FRAMEPTR(,R2)                                   1439 04425000
         L     @14,FRAMLOCC-24(@14,@08)                            1439 04426000
         ST    @14,LISTPTR                                         1439 04427000
*IF ERROR = ZERO THEN                                              1440 04428000
@RC01399 L     @14,ERROR                                           1440 04429000
         LTR   @14,@14                                             1440 04430000
         BNZ   @RF01440                                            1440 04431000
*  DO;                                                     /*@G51DGBB*/ 04432000
*    IF LISTNUM + 1 <= LISTMAX THEN /*IF ROOM IN LISTLOC     @G51DGBB*/ 04433000
         LA    @14,1                                               1442 04434000
         L     @08,LISTPTR                                         1442 04435000
         AL    @14,LISTNUM(,@08)                                   1442 04436000
         C     @14,@CF00293                                        1442 04437000
         BH    @RF01442                                            1442 04438000
*      DO;                                                 /*@G51DGBB*/ 04439000
*        RESPECIFY (R1) UNRESTRICTED; /*FOR PARM LIST        @G51DGBB*/ 04440000
*        IF PHIST = ON THEN        /*IF HISTORY INPUT        @G51DGBB*/ 04441000
         TM    PHIST(R2),B'00100000'                               1445 04442000
         BNO   @RF01445                                            1445 04443000
*          CALL IOHND(RITESCRT);   /*WRITE TO SCRATCH DATA SET*/   1446 04444000
         L     @15,ADIOHND(,R2)                                    1446 04445000
         LA    @01,@AL01446                                        1446 04446000
         BALR  @14,@15                                             1446 04447000
*        IF R15 = SUCCESS THEN     /*IF SUCCESSFULL WRITE    @G51DGBB*/ 04448000
@RF01445 LTR   R15,R15                                             1447 04449000
         BNZ   @RF01447                                            1447 04450000
*          DO;                                             /*@G51DGBB*/ 04451000
*            LISTCCHR(LISTNUM+1) = RECCCHHR;/*SAVE FRAME EXTERNAL LOC*/ 04452000
         L     @14,LISTPTR                                         1449 04453000
         L     @08,LISTNUM(,@14)                                   1449 04454000
         LR    @06,@08                                             1449 04455000
         MH    @06,@CH00079                                        1449 04456000
         ALR   @06,@14                                             1449 04457000
         MVC   LISTCCHR(5,@06),RECCCHHR(R2)                        1449 04458000
*            LISTNUM = LISTNUM + 1; /*INCREMENT NO OF BUILT ENTRIES*/   04459000
         LA    @06,1                                               1450 04460000
         ALR   @08,@06                                             1450 04461000
         ST    @08,LISTNUM(,@14)                                   1450 04462000
*            BUG(40) = BUG(40) + 1;                        /*@G51DGBB*/ 04463000
         AL    @06,BUG+156                                         1451 04464000
         ST    @06,BUG+156                                         1451 04465000
*          END;                                            /*@G51DGBB*/ 04466000
*        ELSE  /*UNSUCCESSFUL WRITE TO SCRATCH D.S.          @G51DGBB*/ 04467000
*          R15 = TWELVE; /*TERMINATE FURTHER PROCESSING      @G51DGBB*/ 04468000
         B     @RC01447                                            1453 04469000
@RF01447 LA    R15,12                                              1453 04470000
*      END;                                                /*@G51DGBB*/ 04471000
@RC01447 DS    0H                                                  1455 04472000
*  END;                                                    /*@G51DGBB*/ 04473000
@RF01442 DS    0H                                                  1456 04474000
*ERROR = R15;                                              /*@G51DGBB*/ 04475000
@RF01440 ST    R15,ERROR                                           1456 04476000
*RESPECIFY (R0,R4,R15) UNRESTRICTED;                       /*@G51DGBB*/ 04477000
*END; /*END OF BUILDTTR PROC                                 @G51DGBB*/ 04478000
@EL00035 DS    0H                                                  1458 04479000
@EF00035 DS    0H                                                  1458 04480000
@ER00035 LM    @14,@12,@SA00035                                    1458 04481000
         BR    @14                                                 1458 04482000
*FIXENTRY: PROC;  /*RESET LISTLOC TABLE TO ZEROS BUT DONT FREE CORE*/   04483000
FIXENTRY STM   @14,@12,12(@13)                                     1459 04484000
*                 /*RESET DATE,TYPE TO ZEROS                 @G51DGBB*/ 04485000
*FRAMEDT(CCHINDX) = '0000000000000000'X; /*ZERO DATE,TIME    @G51DGBB*/ 04486000
         L     @08,CCHINDX                                         1460 04487000
         MH    @08,@CH00227                                        1460 04488000
         L     @06,FRAMEPTR(,R2)                                   1460 04489000
         ST    @08,@TF00001                                        1460 04490000
         ALR   @08,@06                                             1460 04491000
         AL    @08,@CF01605                                        1460 04492000
         MVC   FRAMEDT-9(8,@08),@CB01535                           1460 04493000
*FRAMETYP(CCHINDX) = '00'X; /*RESET TO NO TYPES OF FRAMES STORED*/ 1461 04494000
         LR    @08,@06                                             1461 04495000
         AL    @08,@TF00001                                        1461 04496000
         AL    @08,@CF01571                                        1461 04497000
         MVI   FRAMETYP-17(@08),X'00'                              1461 04498000
*IF FRAMLOCM(CCHINDX) > ZERO THEN /*IF MCH FRAME LOC. TAB. ALLOCATED*/  04499000
         L     @08,@TF00001                                        1462 04500000
         AL    @06,@CF01581                                        1462 04501000
         L     @08,FRAMLOCM-20(@08,@06)                            1462 04502000
         LTR   @08,@08                                             1462 04503000
         BNP   @RF01462                                            1462 04504000
*  DO;                                                     /*@G51DGBB*/ 04505000
*    LISTPTR = FRAMLOCM(CCHINDX); /*SET TABLE BASE ADDRESS   @G51DGBB*/ 04506000
         ST    @08,LISTPTR                                         1464 04507000
*    DO Y = 1 BY 1 TO LISTNUM; /*CLEAR ALL STORED CCHHRS TO ZERO*/ 1465 04508000
         LA    @08,1                                               1465 04509000
         ST    @08,Y                                               1465 04510000
         B     @DE01465                                            1465 04511000
@DL01465 DS    0H                                                  1466 04512000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGBB*/ 04513000
         LR    @06,@08                                             1466 04514000
         MH    @06,@CH00079                                        1466 04515000
         L     @03,LISTPTR                                         1466 04516000
         ALR   @03,@06                                             1466 04517000
         BCTR  @03,0                                               1466 04518000
         XC    LISTCCHR-4(5,@03),LISTCCHR-4(@03)                   1466 04519000
*      BUG(41) = BUG(41) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1467 04520000
         LA    @06,1                                               1467 04521000
         AL    @06,BUG+160                                         1467 04522000
         ST    @06,BUG+160                                         1467 04523000
*      BUG(40) = BUG(40) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRMES*/ 04524000
         L     @06,BUG+156                                         1468 04525000
         BCTR  @06,0                                               1468 04526000
         ST    @06,BUG+156                                         1468 04527000
*    END;                                                  /*@G51DGBB*/ 04528000
         AL    @08,@CF00055                                        1469 04529000
         ST    @08,Y                                               1469 04530000
@DE01465 L     @06,LISTPTR                                         1469 04531000
         C     @08,LISTNUM(,@06)                                   1469 04532000
         BNH   @DL01465                                            1469 04533000
*    LISTNUM = ZERO; /*SET NUMBER OF STORED CCHHRS TO ZERO   @G51DGBB*/ 04534000
         L     @08,LISTPTR                                         1470 04535000
         SLR   @06,@06                                             1470 04536000
         ST    @06,LISTNUM(,@08)                                   1470 04537000
*  END;                                                    /*@G51DGBB*/ 04538000
*IF FRAMLOCC(CCHINDX) > ZERO THEN /*IF CCH FRAM LOC TABLE ALLOCATED*/   04539000
@RF01462 L     @08,CCHINDX                                         1472 04540000
         MH    @08,@CH00227                                        1472 04541000
         L     @06,FRAMEPTR(,R2)                                   1472 04542000
         L     @08,FRAMLOCC-24(@08,@06)                            1472 04543000
         LTR   @08,@08                                             1472 04544000
         BNP   @RF01472                                            1472 04545000
*  DO;                                                     /*@G51DGBB*/ 04546000
*    LISTPTR = FRAMLOCC(CCHINDX); /*SET BASE ADDRESS OF LISTLOC*/  1474 04547000
         ST    @08,LISTPTR                                         1474 04548000
*    DO Y = 1 BY 1 TO LISTNUM; /*ZERO ALL SAVED CCHHRS       @G51DGBB*/ 04549000
         LA    @08,1                                               1475 04550000
         ST    @08,Y                                               1475 04551000
         B     @DE01475                                            1475 04552000
@DL01475 DS    0H                                                  1476 04553000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGBB*/ 04554000
         LR    @06,@08                                             1476 04555000
         MH    @06,@CH00079                                        1476 04556000
         L     @03,LISTPTR                                         1476 04557000
         ALR   @03,@06                                             1476 04558000
         BCTR  @03,0                                               1476 04559000
         XC    LISTCCHR-4(5,@03),LISTCCHR-4(@03)                   1476 04560000
*      BUG(41) = BUG(41) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1477 04561000
         LA    @06,1                                               1477 04562000
         AL    @06,BUG+160                                         1477 04563000
         ST    @06,BUG+160                                         1477 04564000
*      BUG(40) = BUG(40) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRAMES* 04565000
         L     @06,BUG+156                                         1478 04566000
         BCTR  @06,0                                               1478 04567000
         ST    @06,BUG+156                                         1478 04568000
*    END;                                                  /*@G51DGBB*/ 04569000
         AL    @08,@CF00055                                        1479 04570000
         ST    @08,Y                                               1479 04571000
@DE01475 L     @06,LISTPTR                                         1479 04572000
         C     @08,LISTNUM(,@06)                                   1479 04573000
         BNH   @DL01475                                            1479 04574000
*    LISTNUM = ZERO; /*SET NUMBER OF  CCHHRS SAVED TO ZERO   @G51DGBB*/ 04575000
         L     @08,LISTPTR                                         1480 04576000
         SLR   @06,@06                                             1480 04577000
         ST    @06,LISTNUM(,@08)                                   1480 04578000
*  END;                                                    /*@G51DGBB*/ 04579000
*END;                                                      /*@G51DGBB*/ 04580000
@EL00036 DS    0H                                                  1482 04581000
@EF00036 DS    0H                                                  1482 04582000
@ER00036 LM    @14,@12,12(@13)                                     1482 04583000
         BR    @14                                                 1482 04584000
*FLIMFRAM: PROC; /*PROCESS FRAME RECORDS SEQUENTIALLY        @G51DGBB*/ 04585000
FLIMFRAM STM   @14,@12,@SA00037                                    1483 04586000
* RESPECIFY (R15) RESTRICTED;                              /*@G51DGBB*/ 04587000
*   IF PACC = ON &                 /* IF NO ACCUMULATION OR NO  */ 1485 04588000
*     (PMCH = ON | PCHAN = ON) THEN /* MCH OR CCH SELECTION THEN */     04589000
         TM    PACC(R2),B'01000000'                                1485 04590000
         BNO   @RF01485                                            1485 04591000
         TM    PMCH(R2),B'11000000'                                1485 04592000
         BZ    @RF01485                                            1485 04593000
*    DO;                            /* DONT SELECT FRAMES    @G51DGBB*/ 04594000
*      IF LRTCNT = ONE &            /* IF FIRST PHYSICAL FRAME   */     04595000
*         (LRTKEY1 & GENREC) = HEXA0 THEN /*IS MCF           @G51DGBB*/ 04596000
         CLI   LRTCNT(R7),1                                        1487 04597000
         BNE   @RF01487                                            1487 04598000
         MVC   @TS00001(1),LRTKEY1(R7)                             1487 04599000
         NI    @TS00001,X'F0'                                      1487 04600000
         CLI   @TS00001,X'A0'                                      1487 04601000
         BNE   @RF01487                                            1487 04602000
*        DO;                                               /*@G51DGBB*/ 04603000
*          SAVESEQ = ONE;           /* RESET SEQUENCE CHECK  @G51DGBB*/ 04604000
         MVI   SAVESEQ,X'01'                                       1489 04605000
*          CALL FRAMEREP;           /* SEE IF THIS FRAME SET MUST*/     04606000
         BAL   @14,FRAMEREP                                        1490 04607000
*          R15 = ERROR;             /* BE SAVED              @G51DGBB*/ 04608000
         L     R15,ERROR                                           1491 04609000
*          IF LRTNLAST = OFF &      /*IF FIRST FRAME IS LAST OF SET*/   04610000
*             FRAMEYES = YES &     /*IF FRAME SET TO BE SAVED   */ 1492 04611000
*             R15 = ZERO THEN      /*NO ERROR CONDITIONS     @G51DGBB*/ 04612000
         TM    LRTNLAST(R7),B'10000000'                            1492 04613000
         BNZ   @RF01492                                            1492 04614000
         TM    FRAMEYES,B'00000001'                                1492 04615000
         BNO   @RF01492                                            1492 04616000
         LTR   R15,R15                                             1492 04617000
         BNZ   @RF01492                                            1492 04618000
*            DO;                                           /*@G51DGBB*/ 04619000
*              SAVESEQ = ZERO;    /*INITIALIZE SEQUENCE CHECK*/    1494 04620000
         MVI   SAVESEQ,X'00'                                       1494 04621000
*              FRAMETYP(CCHINDX) = ALLMCH; /*ONLY ONE BUT ALL IN*/ 1495 04622000
         L     @14,CCHINDX                                         1495 04623000
         MH    @14,@CH00227                                        1495 04624000
         L     @08,FRAMEPTR(,R2)                                   1495 04625000
         ALR   @08,@14                                             1495 04626000
         AL    @08,@CF01571                                        1495 04627000
         MVI   FRAMETYP-17(@08),X'02'                              1495 04628000
*            END;                                          /*@G51DGBB*/ 04629000
*        END;                                              /*@G51DGBB*/ 04630000
*      ELSE                         /* NON-FIRST FRAME       @G51DGBB*/ 04631000
*        DO;                                               /*@G51DGBB*/ 04632000
         B     @RC01487                                            1498 04633000
@RF01487 DS    0H                                                  1499 04634000
*          IF FRAMEYES = ON THEN    /* IF FRAME IS TO BE SAVED  */ 1499 04635000
         TM    FRAMEYES,B'00000001'                                1499 04636000
         BNO   @RF01499                                            1499 04637000
*            DO;                                           /*@G51DGBB*/ 04638000
*              SAVESEQ = SAVESEQ + 1;  /* UP SEQ CHECK       @G51DGBB*/ 04639000
         IC    @14,SAVESEQ                                         1501 04640000
         LA    @14,1(,@14)                                         1501 04641000
         STC   @14,SAVESEQ                                         1501 04642000
*              IF SAVESEQ = LRTCNT THEN /* IF RECORD NOT MISSING */     04643000
         CLC   SAVESEQ(1),LRTCNT(R7)                               1502 04644000
         BNE   @RF01502                                            1502 04645000
*                DO;                                       /*@G51DGBB*/ 04646000
*                  CALL BUILDTTR;    /* BUILD EXTERNAL LOCATION */ 1504 04647000
         BAL   @14,BUILDTTR                                        1504 04648000
*                  R15 = ERROR;                            /*@G51DGBB*/ 04649000
         L     R15,ERROR                                           1505 04650000
*                  IF R15 = ZERO THEN  /* IF FRAME EXTERNAL LOC  */     04651000
         LTR   R15,R15                                             1506 04652000
         BNZ   @RF01506                                            1506 04653000
*                    DO;               /* SUCCESSFULLY SAVED @G51DGBB*/ 04654000
*                      IF LRTNLAST = OFF THEN /* IF LAST FRAME  */ 1508 04655000
         TM    LRTNLAST(R7),B'10000000'                            1508 04656000
         BNZ   @RF01508                                            1508 04657000
*                        DO;                               /*@G51DGBB*/ 04658000
*                          IF (LRTKEY1 & GENREC) = HEXA0 THEN      1510 04659000
         MVC   @TS00001(1),LRTKEY1(R7)                             1510 04660000
         NI    @TS00001,X'F0'                                      1510 04661000
         CLI   @TS00001,X'A0'                                      1510 04662000
         BNE   @RF01510                                            1510 04663000
*                            DO;                           /*@G51DGBB*/ 04664000
*                              SAVESEQ = ZERO; /*REINITIALIZE SEQ CNT*/ 04665000
         MVI   SAVESEQ,X'00'                                       1512 04666000
*                              FRAMETYP(CCHINDX) = ALLMCH; /*@G51DGBB*/ 04667000
         L     @14,CCHINDX                                         1513 04668000
         MH    @14,@CH00227                                        1513 04669000
         L     @08,FRAMEPTR(,R2)                                   1513 04670000
         ALR   @08,@14                                             1513 04671000
         AL    @08,@CF01571                                        1513 04672000
         MVI   FRAMETYP-17(@08),X'02'                              1513 04673000
*                            END;                          /*@G51DGBB*/ 04674000
*                          /*IF ALL MCH FRAMES HAVE BEEN SAVED,  */     04675000
*                          /*THEN INDICATE SUCH              @G51DGBB*/ 04676000
*                           ELSE                  /*IS CCH FRAME */     04677000
*                            DO;                           /*@G51DGBB*/ 04678000
         B     @RC01510                                            1515 04679000
@RF01510 DS    0H                                                  1516 04680000
*                            FRAMEYES = OFF; /*RESET FRAME ACCEPT SW*/  04681000
         NI    FRAMEYES,B'11111110'                                1516 04682000
*                            IF FRAMETYP(CCHINDX) ^= ALLMCH THEN   1517 04683000
         L     @14,CCHINDX                                         1517 04684000
         MH    @14,@CH00227                                        1517 04685000
         L     @08,FRAMEPTR(,R2)                                   1517 04686000
         ALR   @08,@14                                             1517 04687000
         AL    @08,@CF01571                                        1517 04688000
         CLI   FRAMETYP-17(@08),X'02'                              1517 04689000
         BE    @RF01517                                            1517 04690000
*                              DO; /*IF MISSING LAST MCH FRAME   */     04691000
*                                MSGNO = 79; /*INCOMPLETE FRAME SET*/   04692000
         MVI   MSGNO,X'4F'                                         1519 04693000
*                                CALL ERRMSG;              /*@G51DGBB*/ 04694000
         BAL   @14,ERRMSG                                          1520 04695000
*                                CALL FIXENTRY; /*DELETE INCOM-  */     04696000
         BAL   @14,FIXENTRY                                        1521 04697000
*                              END;             /*PLETE SET. @G51DGBB*/ 04698000
*                            ELSE   /*IS COMPLETE SET -INDICATE  */     04699000
*                              FRAMETYP(CCHINDX) = ALLALL; /*IT IS*/    04700000
         B     @RC01517                                            1523 04701000
@RF01517 L     @14,CCHINDX                                         1523 04702000
         MH    @14,@CH00227                                        1523 04703000
         L     @08,FRAMEPTR(,R2)                                   1523 04704000
         ALR   @08,@14                                             1523 04705000
         AL    @08,@CF01571                                        1523 04706000
         MVI   FRAMETYP-17(@08),X'FF'                              1523 04707000
*                            END;                          /*@G51DGBB*/ 04708000
*                        END;                              /*@G51DGBB*/ 04709000
*                   END;                                   /*@G51DGBB*/ 04710000
*              END;                                        /*@G51DGBB*/ 04711000
*            ELSE   /*MISSING MIDDLE FRAME                   @G51DGBB*/ 04712000
*              DO;                                         /*@G51DGBB*/ 04713000
         B     @RC01502                                            1528 04714000
@RF01502 DS    0H                                                  1529 04715000
*                MSGNO = 79; /*INCOMPLETE FRAME SET MESSAGE  @G51DGBB*/ 04716000
         MVI   MSGNO,X'4F'                                         1529 04717000
*                CALL ERRMSG;                              /*@G51DGBB*/ 04718000
         BAL   @14,ERRMSG                                          1530 04719000
*                FRAMEYES = OFF; /*DONT SAVE INCOMPLETE SET  @G51DGBB*/ 04720000
         NI    FRAMEYES,B'11111110'                                1531 04721000
*                CALL FIXENTRY; /*DELETE REFS TO INCOMPLETE SET*/  1532 04722000
         BAL   @14,FIXENTRY                                        1532 04723000
*                BUG(41) = BUG(41) + 1;                    /*@G51DGBB*/ 04724000
         LA    @14,1                                               1533 04725000
         AL    @14,BUG+160                                         1533 04726000
         ST    @14,BUG+160                                         1533 04727000
*              END;                                        /*@G51DGBB*/ 04728000
*       END;                                               /*@G51DGBB*/ 04729000
*          ELSE      /*FRAME NOT TO BE SAVED                 @G51DGBB*/ 04730000
*            BUG(41) = BUG(41) + 1;                        /*@G51DGBB*/ 04731000
         B     @RC01499                                            1536 04732000
@RF01499 LA    @14,1                                               1536 04733000
         AL    @14,BUG+160                                         1536 04734000
         ST    @14,BUG+160                                         1536 04735000
*      END;                                                /*@G51DGBB*/ 04736000
*   END;                                                   /*@G51DGBB*/ 04737000
*  ELSE   /*NOT ACCUMULATING OR SELECTING MCH OR CCH RECORDS @G51DGBB*/ 04738000
*    BUG(41) = BUG(41) + 1; /*COUNT FRAMES REJECTED          @G51DGBB*/ 04739000
         B     @RC01485                                            1539 04740000
@RF01485 LA    @14,1                                               1539 04741000
         AL    @14,BUG+160                                         1539 04742000
         ST    @14,BUG+160                                         1539 04743000
*RESPECIFY (R15) UNRESTRICTED;                             /*@G51DGBB*/ 04744000
*END; /*CLOSING END TO PROC FLIMFRAM                         @G51DGBB*/ 04745000
@EL00037 DS    0H                                                  1541 04746000
@EF00037 DS    0H                                                  1541 04747000
@ER00037 LM    @14,@12,@SA00037                                    1541 04748000
         BR    @14                                                 1541 04749000
*END  /*CLOSING END TO EXTERNAL PROC, IFCFILT3               @Z427VLS*/ 04750000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 04751000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 04752000
*;                                                                 1542 04753000
@DATA    DS    0H                                                       04754000
@CH01361 DC    H'76'                                                    04755000
         DS    0F                                                       04756000
@AL00193 EQU   *                       LIST WITH   1 ARGUMENT(S)        04757000
@AL00279 EQU   *                       LIST WITH   1 ARGUMENT(S)        04758000
@AL00753 EQU   *                       LIST WITH   1 ARGUMENT(S)        04759000
@AL00766 EQU   *                       LIST WITH   1 ARGUMENT(S)        04760000
@AL01300 EQU   *                       LIST WITH   1 ARGUMENT(S)        04761000
@AL01318 EQU   *                       LIST WITH   1 ARGUMENT(S)        04762000
@AL01333 DC    A(@CF00074+2)           LIST WITH   1 ARGUMENT(S)        04763000
@AL00199 DC    A(@CF00076+2)           LIST WITH   1 ARGUMENT(S)        04764000
@AL00222 EQU   *                       LIST WITH   1 ARGUMENT(S)        04765000
@AL00714 EQU   *                       LIST WITH   1 ARGUMENT(S)        04766000
@AL00723 DC    A(@CF00064+2)           LIST WITH   1 ARGUMENT(S)        04767000
@AL00536 DC    A(@CF00064)             LIST WITH   3 ARGUMENT(S)        04768000
         DC    A(WORKDEV)                                               04769000
         DC    A(LINKDEV)                                               04770000
@AL00676 EQU   *                       LIST WITH   1 ARGUMENT(S)        04771000
@AL00688 EQU   *                       LIST WITH   1 ARGUMENT(S)        04772000
@AL00704 EQU   *                       LIST WITH   1 ARGUMENT(S)        04773000
@AL00771 DC    A(@CF00083+2)           LIST WITH   1 ARGUMENT(S)        04774000
@AL00712 EQU   *                       LIST WITH   1 ARGUMENT(S)        04775000
@AL00721 DC    A(@CF00081+2)           LIST WITH   1 ARGUMENT(S)        04776000
@AL00751 DC    A(@CF01434)             LIST WITH   2 ARGUMENT(S)        04777000
         DC    A(@AFTEMPS)                                              04778000
@AL00764 DC    A(@CF01435)             LIST WITH   2 ARGUMENT(S)        04779000
         DC    A(@AFTEMPS)                                              04780000
@AL01254 DC    A(@CF01508)             LIST WITH   2 ARGUMENT(S)        04781000
         DC    A(@AFTEMPS+4)                                            04782000
@AL01257 DC    A(@CF01509)             LIST WITH   2 ARGUMENT(S)        04783000
         DC    A(@AFTEMPS+4)                                            04784000
@AL01260 DC    A(@CF01510)             LIST WITH   2 ARGUMENT(S)        04785000
         DC    A(@AFTEMPS+4)                                            04786000
@AL01267 DC    A(@CF01511)             LIST WITH   2 ARGUMENT(S)        04787000
         DC    A(@AFTEMPS+4)                                            04788000
@AL01270 DC    A(@CF01427)             LIST WITH   2 ARGUMENT(S)        04789000
         DC    A(@AFTEMPS+4)                                            04790000
@AL01297 DC    A(@CF01356)             LIST WITH   2 ARGUMENT(S)        04791000
         DC    A(@AFTEMPS+4)                                            04792000
@AL01299 DC    A(@CF00227)             LIST WITH   2 ARGUMENT(S)        04793000
         DC    A(@AFTEMPS+4)                                            04794000
@AL01446 DC    A(@CF00079+2)           LIST WITH   1 ARGUMENT(S)        04795000
         DS    0F                                                       04796000
@SA00001 DS    18F                                                      04797000
@SA00003 DS    15F                                                      04798000
@SA00037 DS    15F                                                      04799000
@SA00016 DS    15F                                                      04800000
@SA00002 DS    15F                                                      04801000
@SA00014 DS    15F                                                      04802000
@SA00032 DS    15F                                                      04803000
@SA00030 DS    15F                                                      04804000
@SA00006 DS    15F                                                      04805000
@SA00007 DS    15F                                                      04806000
@SA00013 DS    15F                                                      04807000
@SA00008 DS    15F                                                      04808000
@SA00017 DS    15F                                                      04809000
@SA00019 DS    15F                                                      04810000
@SA00020 DS    15F                                                      04811000
@SA00026 DS    15F                                                      04812000
@SA00023 DS    15F                                                      04813000
@SA00027 DS    15F                                                      04814000
@SA00024 DS    15F                                                      04815000
@SA00021 DS    15F                                                      04816000
@SA00022 DS    15F                                                      04817000
@SA00033 DS    15F                                                      04818000
@SA00034 DS    15F                                                      04819000
@SA00035 DS    15F                                                      04820000
@TF00001 DS    F                                                        04821000
@TF00002 DS    F                                                        04822000
@AFTEMPS DS    2F                                                       04823000
         DS    0F                                                       04824000
@CF00055 DC    F'1'                                                     04825000
@CF00074 DC    F'2'                                                     04826000
@CH00074 EQU   @CF00074+2                                               04827000
@CF00076 DC    F'3'                                                     04828000
@CH00076 EQU   @CF00076+2                                               04829000
@CF00064 DC    F'4'                                                     04830000
@CH00064 EQU   @CF00064+2                                               04831000
@CF00079 DC    F'5'                                                     04832000
@CH00079 EQU   @CF00079+2                                               04833000
@CF00081 DC    F'6'                                                     04834000
@CH00081 EQU   @CF00081+2                                               04835000
@CF00083 DC    F'7'                                                     04836000
@CH00083 EQU   @CF00083+2                                               04837000
@CF00066 DC    F'8'                                                     04838000
@CF00035 DC    F'9'                                                     04839000
@CF00034 DC    F'10'                                                    04840000
@CF00033 DC    F'11'                                                    04841000
@CH00033 EQU   @CF00033+2                                               04842000
@CF00032 DC    F'12'                                                    04843000
@CF01015 DC    F'13'                                                    04844000
@CF00940 DC    F'14'                                                    04845000
@CH00940 EQU   @CF00940+2                                               04846000
@CF00036 DC    F'15'                                                    04847000
@CF00088 DC    F'16'                                                    04848000
@CF01167 DC    F'18'                                                    04849000
@CF00227 DC    F'24'                                                    04850000
@CH00227 EQU   @CF00227+2                                               04851000
@CF01116 DC    F'27'                                                    04852000
@CF01356 DC    F'40'                                                    04853000
@CF01520 DC    F'41'                                                    04854000
@CF00293 DC    F'50'                                                    04855000
@CF01509 DC    F'53'                                                    04856000
@CF01508 DC    F'55'                                                    04857000
@CF01434 DC    F'70'                                                    04858000
@CF01435 DC    F'71'                                                    04859000
@CF01511 DC    F'72'                                                    04860000
@CF01510 DC    F'73'                                                    04861000
@CH01510 EQU   @CF01510+2                                               04862000
@CF01427 DC    F'78'                                                    04863000
@CF01563 DC    F'254'                                                   04864000
@CF00960 DC    F'335'                                                   04865000
@CF00936 DC    F'366'                                                   04866000
@CF01573 DC    F'-68'                                                   04867000
@CF01601 DC    F'-64'                                                   04868000
@CF01588 DC    F'-60'                                                   04869000
@CF01589 DC    F'-56'                                                   04870000
@CF01590 DC    F'-52'                                                   04871000
@CF01591 DC    F'-48'                                                   04872000
@CF01592 DC    F'-44'                                                   04873000
@CF01593 DC    F'-40'                                                   04874000
@CF01594 DC    F'-36'                                                   04875000
@CF01595 DC    F'-32'                                                   04876000
@CF01596 DC    F'-28'                                                   04877000
@CF01597 DC    F'-24'                                                   04878000
@CF01574 DC    F'-20'                                                   04879000
@CF01604 DC    F'-17'                                                   04880000
@CF01598 DC    F'-16'                                                   04881000
@CF01605 DC    F'-15'                                                   04882000
@CF01351 DC    F'-14'                                                   04883000
@CF01599 DC    F'-12'                                                   04884000
@CF01575 DC    F'-11'                                                   04885000
@CF01576 DC    F'-10'                                                   04886000
@CF01580 DC    F'-9'                                                    04887000
@CF01600 DC    F'-8'                                                    04888000
@CF01571 DC    F'-7'                                                    04889000
@CF01581 DC    F'-4'                                                    04890000
@CF00881 DC    XL4'FFFFFFF8'                                            04891000
@CV01403 DC    V(IFCDEVIC)                                              04892000
         DS    0D                                                       04893000
ENTRIES  DC    F'1'                                                     04894000
LISTPTR  DC    A(0)                                                     04895000
ZZ       DC    A(0)                                                     04896000
Z1       DC    F'0'                                                     04897000
Z2       DC    F'0'                                                     04898000
Z3       DC    F'0'                                                     04899000
ZZ3      DC    F'0'                                                     04900000
NUMBER   DC    F'0'                                                     04901000
NEXTBY   DC    F'0'                                                     04902000
ADDNXT   DC    F'0'                                                     04903000
T        DC    F'0'                                                     04904000
P        DC    F'0'                                                     04905000
R        DC    F'0'                                                     04906000
INDEX    DS    F                                                        04907000
YEAR     DC    H'0'                                                     04908000
         DS    0D                                                       04909000
@TS00001 DS    CL11                                                     04910000
@CB01535 DC    X'0000000000000000'                                      04911000
@CB00288 EQU   @CB01535                                                 04912000
@CB01432 DC    X'0000000F'                                              04913000
@CB00228 DC    X'00000F'                                                04914000
@CB00237 DC    X'FFFFFF'                                                04915000
@CB00912 DC    X'000FFF'                                                04916000
@CB00944 EQU   @CB01535                                                 04917000
@CB01363 DC    X'99366F'                                                04918000
@CB00208 EQU   @CB01535                                                 04919000
@CB00261 EQU   @CB00237                                                 04920000
@CB00884 DC    X'8004'                                                  04921000
@CB00886 DC    X'8005'                                                  04922000
@CB00888 DC    X'8003'                                                  04923000
@CB00890 DC    X'100C'                                                  04924000
@CB00892 DC    X'1008'                                                  04925000
@CB00894 DC    X'0842'                                                  04926000
@CB00908 DC    X'0FF0'                                                  04927000
@CB00910 DC    X'0FFF'                                                  04928000
@CB00930 EQU   @CB00912                                                 04929000
@CB00942 DC    X'7FFF'                                                  04930000
@CB00964 DC    X'2006'                                                  04931000
@CB00966 DC    X'2007'                                                  04932000
@CB00968 DC    X'2009'                                                  04933000
@CB00970 DC    X'200A'                                                  04934000
@CB00972 DC    X'200B'                                                  04935000
@CB00974 DC    X'200D'                                                  04936000
@CB00995 DC    X'0003'                                                  04937000
@CB01393 DC    X'3705'                                                  04938000
@CB01469 DC    X'3330'                                                  04939000
@CB01470 DC    X'3340'                                                  04940000
@CB01471 DC    X'3350'                                                  04941000
TREND2   DC    X'0000000000000000000000000000'                          04942000
         ORG   TREND2                                                   04943000
TRENDKEY DS    CL8                                                      04944000
         ORG   TRENDKEY                                                 04945000
TRENDGRP DS    FL1                                                      04946000
TRENDRT  DS    BL2                                                      04947000
         ORG   TRENDRT                                                  04948000
TRENDCUA DS    BL2                                                      04949000
         ORG   TRENDKEY+3                                               04950000
TRENCPUS DS    BL1                                                      04951000
         ORG   TRENCPUS                                                 04952000
TRENDCPU DS    BL1                                                      04953000
TRENDOLD EQU   TRENCPUS+0                                               04954000
         ORG   TRENDKEY+4                                               04955000
TRENDITM DS    BL1                                                      04956000
         ORG   TRENDITM                                                 04957000
TREND037 DS    BL1                                                      04958000
TRENDOD  EQU   TRENDITM+0                                               04959000
         ORG   TRENDKEY+5                                               04960000
TRENDDAT DS    FL1                                                      04961000
TRENDDEV DS    CL2                                                      04962000
         ORG   TREND2+8                                                 04963000
TRENDPR1 DS    FL2                                                      04964000
         ORG   TRENDPR1                                                 04965000
@NM00084 DS    BL2                                                      04966000
TRENDPRM EQU   TRENDPR1+1                                               04967000
         ORG   TREND2+10                                                04968000
TRENDTMP DS    FL4                                                      04969000
         ORG   TREND2+14                                                04970000
         DS    CL3                                                      04971000
FILT1ITM DS    CL139                                                    04972000
         ORG   FILT1ITM                                                 04973000
MAXENT   DC    F'0'                                                     04974000
FREEADR  DC    A(0)                                                     04975000
I        DC    A(1)                                                     04976000
J        DC    A(0)                                                     04977000
K        DC    A(0)                                                     04978000
L        DC    A(0)                                                     04979000
M        DC    A(0)                                                     04980000
Q        DC    A(0)                                                     04981000
A        DC    A(0)                                                     04982000
X        DC    A(0)                                                     04983000
Y        DC    A(0)                                                     04984000
Z        DC    A(0)                                                     04985000
LINKITM  DC    A(0)                                                     04986000
CCHINDX  DC    A(0)                                                     04987000
SAVESEQ  DS    FL1                                                      04988000
         DS    CL3                                                      04989000
ADDAFT   DC    F'0'                                                     04990000
SRTCONT  DC    F'0'                                                     04991000
SRTCONT1 DC    F'0'                                                     04992000
DSTART   DC    F'0'                                                     04993000
DEND     DC    F'0'                                                     04994000
UNKNWN   DC    F'0'                                                     04995000
COMPLINK DC    F'0'                                                     04996000
ALLCORE  DC    F'0'                                                     04997000
TREN1SIZ DC    F'0'                                                     04998000
BINDAY   DC    F'0'                                                     04999000
ERROR    DC    F'0'                                                     05000000
ERSER    DC    X'00000000'                                              05001000
         ORG   ERSER                                                    05002000
@NM00085 DS    CL1                                                      05003000
ER3      DS    CL3                                                      05004000
         ORG   FILT1ITM+108                                             05005000
NUMUNSHR DC    H'1'                                                     05006000
PACKPAS  DC    CL4'    '                                                05007000
         DS    CL2                                                      05008000
PASSNUM  DC    F'0'                                                     05009000
NUMREC   DC    F'0'                                                     05010000
EXCESS   DC    F'0'                                                     05011000
WORKDEV  DC    X'0000'                                                  05012000
         ORG   WORKDEV                                                  05013000
WORKDEV1 DS    CL1                                                      05014000
WORKDEV2 DS    CL1                                                      05015000
         ORG   FILT1ITM+130                                             05016000
WORKTYPE DC    X'00'                                                    05017000
CUA3     DC    X'000000'                                                05018000
         ORG   CUA3                                                     05019000
@NM00086 DS    BL1                                                      05020000
WORKCUA  DS    BL2                                                      05021000
         ORG   WORKCUA                                                  05022000
WRKCUA   DS    BL2                                                      05023000
         ORG   FILT1ITM+134                                             05024000
WWCUA    DS    CL3                                                      05025000
         ORG   WWCUA                                                    05026000
@NM00087 DS    CL1                                                      05027000
WWCUA2   DS    CL2                                                      05028000
         ORG   FILT1ITM+137                                             05029000
TREIDX   DC    AL1(0)                                                   05030000
MSGNO    DC    AL1(0)                                                   05031000
         ORG   FILT1ITM+139                                             05032000
LINKDEV  DS    CL4                                                      05033000
         ORG   LINKDEV                                                  05034000
DEVLABEL DS    CL2                                                      05035000
@NM00088 DS    CL2                                                      05036000
         ORG   LINKDEV+4                                                05037000
YRSAVE   DC    X'0000'                                                  05038000
         ORG   YRSAVE                                                   05039000
YRSAVE1  DS    BL1                                                      05040000
YRSAVE2  DS    BL1                                                      05041000
         ORG   YRSAVE+2                                                 05042000
ERRPLACE DS    BL1                                                      05043000
         ORG   ERRPLACE                                                 05044000
ERRP1    DS    BL1                                                      05045000
ERRP2    EQU   ERRPLACE+0                                               05046000
         ORG   ERRPLACE+1                                               05047000
PRINTLIN DS    CL134                                                    05048000
         ORG   PRINTLIN                                                 05049000
PRINTDS  DC    X'F1'                                                    05050000
PRINTCC  DC    X'09'                                                    05051000
PRINTBDY DC    CL132' '                                                 05052000
         ORG   PRINTBDY                                                 05053000
@NM00089 DS    CL8                                                      05054000
PRINTED  DS    CL9                                                      05055000
@NM00090 DS    CL24                                                     05056000
PRNTSER  DS    CL7                                                      05057000
         ORG   PRINTLIN+134                                             05058000
PARTIAL  DS    CL58                                                     05059000
         ORG   PARTIAL                                                  05060000
@NM00093 DC    CL29'DEBUG16 FRAME SET INCOMPLETE '                      05061000
PARMOD   DS    CL4                                                      05062000
@NM00094 DC    CL1' '                                                   05063000
PARSER   DS    CL6                                                      05064000
@NM00095 DC    CL17' FRAMEREP SET TO '                                  05065000
PARREP   DS    CL1                                                      05066000
         ORG   PARTIAL+58                                               05067000
BITSWIT  DC    X'000000'                                                05068000
         ORG   BITSWIT                                                  05069000
FOUND    DS    BL1                                                      05070000
NONBLANK EQU   BITSWIT+0                                                05071000
DEVOK    EQU   BITSWIT+0                                                05072000
CUAOK    EQU   BITSWIT+0                                                05073000
SORTSW   EQU   BITSWIT+0                                                05074000
UNIQUE   EQU   BITSWIT+0                                                05075000
MISSW    EQU   BITSWIT+0                                                05076000
MISSW1   EQU   BITSWIT+0                                                05077000
CROSSFLG DS    BL1                                                      05078000
GETOUT   EQU   BITSWIT+1                                                05079000
FIRSTIME EQU   BITSWIT+1                                                05080000
ONBOUND  EQU   BITSWIT+1                                                05081000
CPU0FLG  EQU   BITSWIT+1                                                05082000
GETFAIL  EQU   BITSWIT+1                                                05083000
LOOPOUT  EQU   BITSWIT+1                                                05084000
FRAMEYES EQU   BITSWIT+1                                                05085000
ONETIME  DS    BL1                                                      05086000
SHAREYES EQU   BITSWIT+2                                                05087000
         ORG   BITSWIT+3                                                05088000
WORKBYTE DS    BL1                                                      05089000
         ORG   WORKBYTE                                                 05090000
WORKBYT4 DS    BL1                                                      05091000
         ORG   WORKBYTE+1                                               05092000
WORKTWO  DS    BL1                                                      05093000
DEVCDLNK DC    X'00000000'                                              05094000
         ORG   DEVCDLNK                                                 05095000
DEVLINK  DS    CL2                                                      05096000
@NM00097 DS    CL2                                                      05097000
         ORG   DEVCDLNK+4                                               05098000
CHARS    DC    CL16'0123456789ABCDEF'                                   05099000
SUPERZAP DC    3CL10'SUPERZAP'                                          05100000
         DS    CL3                                                      05101000
SAVEADR  DC    A(0)                                                     05102000
         DS    15XL4                                                    05103000
EVCON    DC    CL1'A'                                                   05104000
         DC    CL1'B'                                                   05105000
         DC    CL1'C'                                                   05106000
         DC    CL1'D'                                                   05107000
         DC    CL1'E'                                                   05108000
         DC    CL1'F'                                                   05109000
         DC    CL1'G'                                                   05110000
         DC    CL1'H'                                                   05111000
         DC    CL1'I'                                                   05112000
         DC    CL1'J'                                                   05113000
         DC    CL1'K'                                                   05114000
         DC    CL1'L'                                                   05115000
         DC    CL1'M'                                                   05116000
         DC    CL1'N'                                                   05117000
         DC    CL1'O'                                                   05118000
         DC    CL1'P'                                                   05119000
FLIP     DC    AL1(0)                                                   05120000
         DC    AL1(1)                                                   05121000
         DC    AL1(2)                                                   05122000
         DC    AL1(3)                                                   05123000
         DC    AL1(4)                                                   05124000
         DC    AL1(5)                                                   05125000
         DC    AL1(6)                                                   05126000
         DC    AL1(7)                                                   05127000
         DC    AL1(8)                                                   05128000
         DC    AL1(9)                                                   05129000
         DC    AL1(10)                                                  05130000
         DC    AL1(11)                                                  05131000
         DC    AL1(12)                                                  05132000
         DC    AL1(13)                                                  05133000
         DC    AL1(14)                                                  05134000
         DC    AL1(15)                                                  05135000
PATCH    DC    25F'0'                                                   05136000
EDIFILD  DS    9CL1                                                     05137000
         DS    CL3                                                      05138000
BUG      DC    50F'0'                                                   05139000
ERRLINE  DS    CL73                                                     05140000
         ORG   ERRLINE+0                                                05141000
ERRDS    DC    CL1'1'                                                   05142000
ERCC     DC    X'09'                                                    05143000
ERRMES   DC    CL10'DEBUG16   '                                         05144000
ERXNUM   DC    CL9'         '                                           05145000
@NM00098 DC    CL2'  '                                                  05146000
ERRTXT   DC    CL50'RECORDS RETRIEVED VIA READSEQ           '           05147000
         ORG   ERRLINE+73                                               05148000
         ORG   ERRLINE+73                                               05149000
         DC    CL1'1'                                                   05150000
         DC    X'09'                                                    05151000
         DC    CL10'DEBUG16   '                                         05152000
         DC    CL9'         '                                           05153000
         DC    CL2'  '                                                  05154000
         DC    CL50'RECORDS PASSED DATE, TIME FILTERING     '           05155000
         ORG   ERRLINE+146                                              05156000
         ORG   ERRLINE+146                                              05157000
         DC    CL1'1'                                                   05158000
         DC    X'09'                                                    05159000
         DC    CL10'DEBUG16   '                                         05160000
         DC    CL9'         '                                           05161000
         DC    CL2'  '                                                  05162000
         DC    CL50'RECORDS PASSED ALL FILTERING            '           05163000
         ORG   ERRLINE+219                                              05164000
         ORG   ERRLINE+219                                              05165000
         DC    CL1'1'                                                   05166000
         DC    X'09'                                                    05167000
         DC    CL10'DEBUG16   '                                         05168000
         DC    CL9'         '                                           05169000
         DC    CL2'  '                                                  05170000
         DC    CL50'MDR TYPE 91 DEVICE TYPE 3705 RECS FOUND '           05171000
         ORG   ERRLINE+292                                              05172000
         ORG   ERRLINE+292                                              05173000
         DC    CL1'1'                                                   05174000
         DC    X'09'                                                    05175000
         DC    CL10'DEBUG16   '                                         05176000
         DC    CL9'         '                                           05177000
         DC    CL2'  '                                                  05178000
         DC    CL50'MDR TYPE 91, DV3705 RECS SAVED IN TREND2'           05179000
         ORG   ERRLINE+365                                              05180000
         ORG   ERRLINE+365                                              05181000
         DC    CL1'1'                                                   05182000
         DC    X'09'                                                    05183000
         DC    CL10'DEBUG16   '                                         05184000
         DC    CL9'         '                                           05185000
         DC    CL2'  '                                                  05186000
         DC    CL50'OBR RECORDS IDENTIFIED                  '           05187000
         ORG   ERRLINE+438                                              05188000
         ORG   ERRLINE+438                                              05189000
         DC    CL1'1'                                                   05190000
         DC    X'09'                                                    05191000
         DC    CL10'DEBUG16   '                                         05192000
         DC    CL9'         '                                           05193000
         DC    CL2'  '                                                  05194000
         DC    CL50'OBR RECORDS PASSED FILTERING            '           05195000
         ORG   ERRLINE+511                                              05196000
         ORG   ERRLINE+511                                              05197000
         DC    CL1'1'                                                   05198000
         DC    X'09'                                                    05199000
         DC    CL10'DEBUG16   '                                         05200000
         DC    CL9'         '                                           05201000
         DC    CL2'  '                                                  05202000
         DC    CL50'OBR RECORDS STORED IN TREND2            '           05203000
         ORG   ERRLINE+584                                              05204000
         ORG   ERRLINE+584                                              05205000
         DC    CL1'1'                                                   05206000
         DC    X'09'                                                    05207000
         DC    CL10'DEBUG16   '                                         05208000
         DC    CL9'         '                                           05209000
         DC    CL2'  '                                                  05210000
         DC    CL50'GROUP 1 RECORDS IDENTIFIED              '           05211000
         ORG   ERRLINE+657                                              05212000
         ORG   ERRLINE+657                                              05213000
         DC    CL1'1'                                                   05214000
         DC    X'09'                                                    05215000
         DC    CL10'DEBUG16   '                                         05216000
         DC    CL9'         '                                           05217000
         DC    CL2'  '                                                  05218000
         DC    CL50'GROUP 2 RECORDS IDENTIFIED              '           05219000
         ORG   ERRLINE+730                                              05220000
         ORG   ERRLINE+730                                              05221000
         DC    CL1'1'                                                   05222000
         DC    X'09'                                                    05223000
         DC    CL10'DEBUG16   '                                         05224000
         DC    CL9'         '                                           05225000
         DC    CL2'  '                                                  05226000
         DC    CL50'GROUP 3 RECORDS IDENTIFIED              '           05227000
         ORG   ERRLINE+803                                              05228000
         ORG   ERRLINE+803                                              05229000
         DC    CL1'1'                                                   05230000
         DC    X'09'                                                    05231000
         DC    CL10'DEBUG16   '                                         05232000
         DC    CL9'         '                                           05233000
         DC    CL2'  '                                                  05234000
         DC    CL50'GROUP 4 RECORDS IDENTIFIED              '           05235000
         ORG   ERRLINE+876                                              05236000
         ORG   ERRLINE+876                                              05237000
         DC    CL1'1'                                                   05238000
         DC    X'09'                                                    05239000
         DC    CL10'DEBUG16   '                                         05240000
         DC    CL9'         '                                           05241000
         DC    CL2'  '                                                  05242000
         DC    CL50'GROUP 5 RECORDS IDENTIFIED              '           05243000
         ORG   ERRLINE+949                                              05244000
         ORG   ERRLINE+949                                              05245000
         DC    CL1'1'                                                   05246000
         DC    X'09'                                                    05247000
         DC    CL10'DEBUG16   '                                         05248000
         DC    CL9'         '                                           05249000
         DC    CL2'  '                                                  05250000
         DC    CL50'GROUP 6 RECORDS IDENTIFIED              '           05251000
         ORG   ERRLINE+1022                                             05252000
         ORG   ERRLINE+1022                                             05253000
         DC    CL1'1'                                                   05254000
         DC    X'09'                                                    05255000
         DC    CL10'DEBUG16   '                                         05256000
         DC    CL9'         '                                           05257000
         DC    CL2'  '                                                  05258000
         DC    CL50'RECORDS IDENTIFIED FOR CPU FFFFFF       '           05259000
         ORG   ERRLINE+1095                                             05260000
         ORG   ERRLINE+1095                                             05261000
         DC    CL1'1'                                                   05262000
         DC    X'09'                                                    05263000
         DC    CL10'DEBUG16   '                                         05264000
         DC    CL9'         '                                           05265000
         DC    CL2'  '                                                  05266000
         DC    CL50'MCH RECORDS IDENTIFIED                  '           05267000
         ORG   ERRLINE+1168                                             05268000
         ORG   ERRLINE+1168                                             05269000
         DC    CL1'1'                                                   05270000
         DC    X'09'                                                    05271000
         DC    CL10'DEBUG16   '                                         05272000
         DC    CL9'         '                                           05273000
         DC    CL2'  '                                                  05274000
         DC    CL50'MCH RECORDS PASSED FILTERING            '           05275000
         ORG   ERRLINE+1241                                             05276000
         ORG   ERRLINE+1241                                             05277000
         DC    CL1'1'                                                   05278000
         DC    X'09'                                                    05279000
         DC    CL10'DEBUG16   '                                         05280000
         DC    CL9'         '                                           05281000
         DC    CL2'  '                                                  05282000
         DC    CL50'CCH RECORDS IDENTIFIED                  '           05283000
         ORG   ERRLINE+1314                                             05284000
         ORG   ERRLINE+1314                                             05285000
         DC    CL1'1'                                                   05286000
         DC    X'09'                                                    05287000
         DC    CL10'DEBUG16   '                                         05288000
         DC    CL9'         '                                           05289000
         DC    CL2'  '                                                  05290000
         DC    CL50'CCH RECORDS PASSED FILTERING            '           05291000
         ORG   ERRLINE+1387                                             05292000
         ORG   ERRLINE+1387                                             05293000
         DC    CL1'1'                                                   05294000
         DC    X'09'                                                    05295000
         DC    CL10'DEBUG16   '                                         05296000
         DC    CL9'         '                                           05297000
         DC    CL2'  '                                                  05298000
         DC    CL50'SOFTWARE RECORDS IDENTIFIED             '           05299000
         ORG   ERRLINE+1460                                             05300000
         ORG   ERRLINE+1460                                             05301000
         DC    CL1'1'                                                   05302000
         DC    X'09'                                                    05303000
         DC    CL10'DEBUG16   '                                         05304000
         DC    CL9'         '                                           05305000
         DC    CL2'  '                                                  05306000
         DC    CL50'SOFTWARE RECORDS PASSED FILTERING       '           05307000
         ORG   ERRLINE+1533                                             05308000
         ORG   ERRLINE+1533                                             05309000
         DC    CL1'1'                                                   05310000
         DC    X'09'                                                    05311000
         DC    CL10'DEBUG16   '                                         05312000
         DC    CL9'         '                                           05313000
         DC    CL2'  '                                                  05314000
         DC    CL50'IPL RECORDS IDENTIFIED                  '           05315000
         ORG   ERRLINE+1606                                             05316000
         ORG   ERRLINE+1606                                             05317000
         DC    CL1'1'                                                   05318000
         DC    X'09'                                                    05319000
         DC    CL10'DEBUG16   '                                         05320000
         DC    CL9'         '                                           05321000
         DC    CL2'  '                                                  05322000
         DC    CL50'IPL RECORDS PASSED FILTERING            '           05323000
         ORG   ERRLINE+1679                                             05324000
         ORG   ERRLINE+1679                                             05325000
         DC    CL1'1'                                                   05326000
         DC    X'09'                                                    05327000
         DC    CL10'DEBUG16   '                                         05328000
         DC    CL9'         '                                           05329000
         DC    CL2'  '                                                  05330000
         DC    CL50'DDR RECORDS IDENTIFIED                  '           05331000
         ORG   ERRLINE+1752                                             05332000
         ORG   ERRLINE+1752                                             05333000
         DC    CL1'1'                                                   05334000
         DC    X'09'                                                    05335000
         DC    CL10'DEBUG16   '                                         05336000
         DC    CL9'         '                                           05337000
         DC    CL2'  '                                                  05338000
         DC    CL50'DDR RECORDS PASSED FILTERING            '           05339000
         ORG   ERRLINE+1825                                             05340000
         ORG   ERRLINE+1825                                             05341000
         DC    CL1'1'                                                   05342000
         DC    X'09'                                                    05343000
         DC    CL10'DEBUG16   '                                         05344000
         DC    CL9'         '                                           05345000
         DC    CL2'  '                                                  05346000
         DC    CL50'MIH RECORDS IDENTIFIED                  '           05347000
         ORG   ERRLINE+1898                                             05348000
         ORG   ERRLINE+1898                                             05349000
         DC    CL1'1'                                                   05350000
         DC    X'09'                                                    05351000
         DC    CL10'DEBUG16   '                                         05352000
         DC    CL9'         '                                           05353000
         DC    CL2'  '                                                  05354000
         DC    CL50'MIH RECORDS PASSED FILTERING            '           05355000
         ORG   ERRLINE+1971                                             05356000
         ORG   ERRLINE+1971                                             05357000
         DC    CL1'1'                                                   05358000
         DC    X'09'                                                    05359000
         DC    CL10'DEBUG16   '                                         05360000
         DC    CL9'         '                                           05361000
         DC    CL2'  '                                                  05362000
         DC    CL50'EOD RECORDS IDENTIFIED                  '           05363000
         ORG   ERRLINE+2044                                             05364000
         ORG   ERRLINE+2044                                             05365000
         DC    CL1'1'                                                   05366000
         DC    X'09'                                                    05367000
         DC    CL10'DEBUG16   '                                         05368000
         DC    CL9'         '                                           05369000
         DC    CL2'  '                                                  05370000
         DC    CL50'EOD RECORDS PASSED FILTERING            '           05371000
         ORG   ERRLINE+2117                                             05372000
         ORG   ERRLINE+2117                                             05373000
         DC    CL1'1'                                                   05374000
         DC    X'09'                                                    05375000
         DC    CL10'DEBUG16   '                                         05376000
         DC    CL9'         '                                           05377000
         DC    CL2'  '                                                  05378000
         DC    CL50'RECORDS SAVED FROM CPU FFFFFF MODEL FFFF'           05379000
         ORG   ERRLINE+2190                                             05380000
         ORG   ERRLINE+2190                                             05381000
         DC    CL1'1'                                                   05382000
         DC    X'09'                                                    05383000
         DC    CL10'DEBUG16   '                                         05384000
         DC    CL9'         '                                           05385000
         DC    CL2'  '                                                  05386000
         DC    CL50'MDRS NOT TYPE 91 NOT DEVICE TYPE 3705   '           05387000
         ORG   ERRLINE+2263                                             05388000
         ORG   ERRLINE+2263                                             05389000
         DC    CL1'1'                                                   05390000
         DC    X'09'                                                    05391000
         DC    CL10'DEBUG16   '                                         05392000
         DC    CL9'         '                                           05393000
         DC    CL2'  '                                                  05394000
         DC    CL50'RECORDS FAILED DEVICE SELECTION         '           05395000
         ORG   ERRLINE+2336                                             05396000
         ORG   ERRLINE+2336                                             05397000
         DC    CL1'1'                                                   05398000
         DC    X'09'                                                    05399000
         DC    CL10'DEBUG16   '                                         05400000
         DC    CL9'         '                                           05401000
         DC    CL2'  '                                                  05402000
         DC    CL50'RECORDS FAILED CUA SELECTION            '           05403000
         ORG   ERRLINE+2409                                             05404000
         ORG   ERRLINE+2409                                             05405000
         DC    CL1'1'                                                   05406000
         DC    X'09'                                                    05407000
         DC    CL10'DEBUG16   '                                         05408000
         DC    CL9'         '                                           05409000
         DC    CL2'  '                                                  05410000
         DC    CL50'MDR 33XX RECORDS IDENTIFIED             '           05411000
         ORG   ERRLINE+2482                                             05412000
         ORG   ERRLINE+2482                                             05413000
         DC    CL1'1'                                                   05414000
         DC    X'09'                                                    05415000
         DC    CL10'DEBUG16   '                                         05416000
         DC    CL9'         '                                           05417000
         DC    CL2'  '                                                  05418000
         DC    CL50'MDR 33XX RECORDS SAVED                  '           05419000
         ORG   ERRLINE+2555                                             05420000
         ORG   ERRLINE+2555                                             05421000
         DC    CL1'1'                                                   05422000
         DC    X'09'                                                    05423000
         DC    CL10'DEBUG16   '                                         05424000
         DC    CL9'         '                                           05425000
         DC    CL2'  '                                                  05426000
         DC    CL50'OBR 33XX, 2305 RECORDS IDENTIFIED       '           05427000
         ORG   ERRLINE+2628                                             05428000
         ORG   ERRLINE+2628                                             05429000
         DC    CL1'1'                                                   05430000
         DC    X'09'                                                    05431000
         DC    CL10'DEBUG16   '                                         05432000
         DC    CL9'         '                                           05433000
         DC    CL2'  '                                                  05434000
         DC    CL50'OBR 33XX, 2305 RECORDS SAVED            '           05435000
         ORG   ERRLINE+2701                                             05436000
         ORG   ERRLINE+2701                                             05437000
         DC    CL1'1'                                                   05438000
         DC    X'09'                                                    05439000
         DC    CL10'DEBUG16   '                                         05440000
         DC    CL9'         '                                           05441000
         DC    CL2'  '                                                  05442000
         DC    CL50'OBR 34XX RECORDS IDENTIFIED             '           05443000
         ORG   ERRLINE+2774                                             05444000
         ORG   ERRLINE+2774                                             05445000
         DC    CL1'1'                                                   05446000
         DC    X'09'                                                    05447000
         DC    CL10'DEBUG16   '                                         05448000
         DC    CL9'         '                                           05449000
         DC    CL2'  '                                                  05450000
         DC    CL50'OBR 34XX RECORDS SAVED                  '           05451000
         ORG   ERRLINE+2847                                             05452000
         ORG   ERRLINE+2847                                             05453000
         DC    CL1'1'                                                   05454000
         DC    X'09'                                                    05455000
         DC    CL10'DEBUG16   '                                         05456000
         DC    CL9'         '                                           05457000
         DC    CL2'  '                                                  05458000
         DC    CL50'FRAMES USED IN PROCESSING               '           05459000
         ORG   ERRLINE+2920                                             05460000
         ORG   ERRLINE+2920                                             05461000
         DC    CL1'1'                                                   05462000
         DC    X'09'                                                    05463000
         DC    CL10'DEBUG16   '                                         05464000
         DC    CL9'         '                                           05465000
         DC    CL2'  '                                                  05466000
         DC    CL50'FRAMES NOT USED IN PROCESSING           '           05467000
         ORG   ERRLINE+2993                                             05468000
         ORG   ERRLINE+2993                                             05469000
         DC    CL1'1'                                                   05470000
         DC    X'09'                                                    05471000
         DC    CL10'DEBUG16   '                                         05472000
         DC    CL9'         '                                           05473000
         DC    CL2'  '                                                  05474000
         DC    CL50'****IFCFILT3 DEBUG16 RECORD COUNTS******'           05475000
         ORG   ERRLINE+3066                                             05476000
         ORG   ERRLINE+3066                                             05477000
         DC    CL1'1'                                                   05478000
         DC    X'09'                                                    05479000
         DC    CL10'DEBUG16   '                                         05480000
         DC    CL9'         '                                           05481000
         DC    CL2'  '                                                  05482000
         ORG   ERRLINE+3139                                             05483000
         ORG   ERRLINE+3139                                             05484000
         DC    CL1'1'                                                   05485000
         DC    X'09'                                                    05486000
         DC    CL10'DEBUG16   '                                         05487000
         DC    CL9'         '                                           05488000
         DC    CL2'  '                                                  05489000
         ORG   ERRLINE+3212                                             05490000
         ORG   ERRLINE+3212                                             05491000
         DC    CL1'1'                                                   05492000
         DC    X'09'                                                    05493000
         DC    CL10'DEBUG16   '                                         05494000
         DC    CL9'         '                                           05495000
         DC    CL2'  '                                                  05496000
         ORG   ERRLINE+3285                                             05497000
         ORG   ERRLINE+3285                                             05498000
         DC    CL1'1'                                                   05499000
         DC    X'09'                                                    05500000
         DC    CL10'DEBUG16   '                                         05501000
         DC    CL9'         '                                           05502000
         DC    CL2'  '                                                  05503000
         ORG   ERRLINE+3358                                             05504000
         ORG   ERRLINE+3358                                             05505000
         DC    CL1'1'                                                   05506000
         DC    X'09'                                                    05507000
         DC    CL10'DEBUG16   '                                         05508000
         DC    CL9'         '                                           05509000
         DC    CL2'  '                                                  05510000
         ORG   ERRLINE+3431                                             05511000
         ORG   ERRLINE+3431                                             05512000
         DC    CL1'1'                                                   05513000
         DC    X'09'                                                    05514000
         DC    CL10'DEBUG16   '                                         05515000
         DC    CL9'         '                                           05516000
         DC    CL2'  '                                                  05517000
         ORG   ERRLINE+3504                                             05518000
         ORG   ERRLINE+3504                                             05519000
         DC    CL1'1'                                                   05520000
         DC    X'09'                                                    05521000
         DC    CL10'DEBUG16   '                                         05522000
         DC    CL9'         '                                           05523000
         DC    CL2'  '                                                  05524000
         ORG   ERRLINE+3577                                             05525000
         ORG   ERRLINE+3577                                             05526000
         DC    CL1'1'                                                   05527000
         DC    X'09'                                                    05528000
         DC    CL10'DEBUG16   '                                         05529000
         DC    CL9'         '                                           05530000
         DC    CL2'  '                                                  05531000
         ORG   ERRLINE+3650                                             05532000
IFCFILT3 CSECT                                                          05533000
         DC    S(SUPERZAP)                                              05534000
IFCFILT3 CSECT                                                          05535000
         DC    S(PATCH)     BASE DISPLACEMENT OF PATCH AREA             05536000
IFCFILT3 CSECT                                                          05537000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05538000
@01      EQU   01                                                       05539000
@02      EQU   02                                                       05540000
@03      EQU   03                                                       05541000
@04      EQU   04                                                       05542000
@05      EQU   05                                                       05543000
@06      EQU   06                                                       05544000
@07      EQU   07                                                       05545000
@08      EQU   08                                                       05546000
@09      EQU   09                                                       05547000
@10      EQU   10                                                       05548000
@11      EQU   11                                                       05549000
@12      EQU   12                                                       05550000
@13      EQU   13                                                       05551000
@14      EQU   14                                                       05552000
@15      EQU   15                                                       05553000
R2       EQU   @02                                                      05554000
R7       EQU   @07                                                      05555000
R0       EQU   @00                                                      05556000
R1       EQU   @01                                                      05557000
R3       EQU   @03                                                      05558000
R4       EQU   @04                                                      05559000
R5       EQU   @05                                                      05560000
R12      EQU   @12                                                      05561000
R15      EQU   @15                                                      05562000
R10      EQU   @10                                                      05563000
R11      EQU   @11                                                      05564000
R13      EQU   @13                                                      05565000
R14      EQU   @14                                                      05566000
R6       EQU   @06                                                      05567000
R8       EQU   @08                                                      05568000
R9       EQU   @09                                                      05569000
IOHND    EQU   0                                                        05570000
IFCMSG   EQU   0                                                        05571000
PARM     EQU   0                                                        05572000
RECTYPE  EQU   PARM                                                     05573000
PMCH     EQU   RECTYPE                                                  05574000
PCHAN    EQU   RECTYPE                                                  05575000
POBR     EQU   RECTYPE                                                  05576000
PSOFT    EQU   RECTYPE                                                  05577000
PIPL     EQU   RECTYPE                                                  05578000
PDDR     EQU   RECTYPE                                                  05579000
PMIH     EQU   RECTYPE                                                  05580000
PEOD     EQU   RECTYPE                                                  05581000
PTTYP    EQU   RECTYPE+1                                                05582000
SWITCHES EQU   PARM+2                                                   05583000
ZEROALL  EQU   SWITCHES+1                                               05584000
DEVEXCL  EQU   SWITCHES+1                                               05585000
SHIFT3RD EQU   SWITCHES+1                                               05586000
DEBUG    EQU   PARM+4                                                   05587000
DEBUG4   EQU   DEBUG                                                    05588000
DEBUG11  EQU   DEBUG+1                                                  05589000
DEBUG16  EQU   DEBUG+2                                                  05590000
DEBUG23  EQU   DEBUG+2                                                  05591000
DEBUGA   EQU   PARM+8                                                   05592000
DEBUG50  EQU   DEBUGA+2                                                 05593000
MISC     EQU   PARM+12                                                  05594000
PACC     EQU   MISC                                                     05595000
PHIST    EQU   MISC                                                     05596000
PRINTES  EQU   MISC                                                     05597000
PASSFLAG EQU   MISC                                                     05598000
OPENCLSE EQU   PARM+13                                                  05599000
OPENIO   EQU   OPENCLSE                                                 05600000
CLOSEIO  EQU   OPENCLSE+2                                               05601000
CACCIN   EQU   CLOSEIO                                                  05602000
CACCDEV  EQU   CLOSEIO                                                  05603000
CDRCTWRK EQU   CLOSEIO                                                  05604000
DATENOW  EQU   PARM+17                                                  05605000
STDT     EQU   PARM+23                                                  05606000
STDATE   EQU   STDT                                                     05607000
PSTD     EQU   STDATE+1                                                 05608000
PSTYR    EQU   PSTD                                                     05609000
PSTDY    EQU   PSTD+1                                                   05610000
ENDDT    EQU   PARM+31                                                  05611000
ENDDATE  EQU   ENDDT                                                    05612000
PEND     EQU   ENDDATE+1                                                05613000
PENDY    EQU   PEND+1                                                   05614000
STTIME1  EQU   PARM+39                                                  05615000
ENDTIME1 EQU   PARM+43                                                  05616000
STTIME2  EQU   PARM+47                                                  05617000
ENDTIME2 EQU   PARM+51                                                  05618000
STRTDATE EQU   PARM+55                                                  05619000
@NM00007 EQU   PARM+75                                                  05620000
TABSIZE  EQU   PARM+80                                                  05621000
SORTNUM  EQU   PARM+84                                                  05622000
NUMDAYS  EQU   PARM+88                                                  05623000
ERRID    EQU   PARM+92                                                  05624000
IDTIMEA  EQU   ERRID+6                                                  05625000
IDTIME   EQU   IDTIMEA                                                  05626000
CCHHRLNG EQU   PARM+112                                                 05627000
RECCCHHR EQU   CCHHRLNG                                                 05628000
ADIOHND  EQU   PARM+124                                                 05629000
ADIFCMSG EQU   PARM+128                                                 05630000
ADEDITB  EQU   PARM+132                                                 05631000
EVPTR    EQU   PARM+136                                                 05632000
SORTADR  EQU   PARM+140                                                 05633000
PRINTADR EQU   PARM+148                                                 05634000
CUAPTR   EQU   PARM+152                                                 05635000
DEVPTR   EQU   PARM+156                                                 05636000
MODPTR   EQU   PARM+160                                                 05637000
SERPTR   EQU   PARM+164                                                 05638000
VOLPTR   EQU   PARM+168                                                 05639000
CPUPTR   EQU   PARM+172                                                 05640000
CPCUAPTR EQU   PARM+176                                                 05641000
LIBADPTR EQU   PARM+180                                                 05642000
SYMCDPTR EQU   PARM+184                                                 05643000
SYSUMPTR EQU   PARM+188                                                 05644000
TRENPTR  EQU   PARM+192                                                 05645000
SHAREPTR EQU   PARM+196                                                 05646000
FRAMEPTR EQU   PARM+200                                                 05647000
MERDCPTR EQU   PARM+208                                                 05648000
DUMPTABL EQU   PARM+228                                                 05649000
DUMPINFO EQU   DUMPTABL+4                                               05650000
TRENDONE EQU   0                                                        05651000
TRENEXT  EQU   TRENDONE                                                 05652000
TRENUM   EQU   TRENDONE+4                                               05653000
TREGEN   EQU   TRENDONE+8                                               05654000
TREIPL   EQU   TREGEN                                                   05655000
TREMCH   EQU   TREGEN+4                                                 05656000
TRECCH0  EQU   TREGEN+8                                                 05657000
TRECCH1  EQU   TREGEN+12                                                05658000
TRECCH2  EQU   TREGEN+16                                                05659000
TRECCH3  EQU   TREGEN+20                                                05660000
TRECCH4  EQU   TREGEN+24                                                05661000
TRECCH5  EQU   TREGEN+28                                                05662000
TRECCH6  EQU   TREGEN+32                                                05663000
TRECCH7  EQU   TREGEN+36                                                05664000
TRECCH8  EQU   TREGEN+40                                                05665000
TRECCH9  EQU   TREGEN+44                                                05666000
TRECCHA  EQU   TREGEN+48                                                05667000
TRECCHB  EQU   TREGEN+52                                                05668000
TRECCHC  EQU   TREGEN+56                                                05669000
TRECCHD  EQU   TREGEN+60                                                05670000
TRECCHE  EQU   TREGEN+64                                                05671000
TRECCHF  EQU   TREGEN+68                                                05672000
TREPRE   EQU   TREGEN+72                                                05673000
EVTABLE  EQU   0                                                        05674000
EVSTOP   EQU   EVTABLE                                                  05675000
EVNUM    EQU   EVTABLE+4                                                05676000
EVKEY    EQU   EVTABLE+6                                                05677000
EVMODEL  EQU   EVKEY                                                    05678000
EVSERIAL EQU   EVKEY+2                                                  05679000
EVLETTER EQU   EVKEY+5                                                  05680000
SORTABLE EQU   0                                                        05681000
SORTKEY  EQU   SORTABLE                                                 05682000
SORTCCHR EQU   SORTABLE+5                                               05683000
SYSUMONE EQU   0                                                        05684000
SHARE    EQU   0                                                        05685000
SHARENUM EQU   SHARE                                                    05686000
SHAREIO  EQU   SHARE+2                                                  05687000
SHRCUCPU EQU   SHAREIO                                                  05688000
SHARECUA EQU   SHRCUCPU                                                 05689000
SHAREDX  EQU   SHARECUA                                                 05690000
SHARSERA EQU   SHRCUCPU+2                                               05691000
SHARECUB EQU   SHAREIO+5                                                05692000
SHARSERB EQU   SHAREIO+7                                                05693000
SHARLET  EQU   SHAREIO+10                                               05694000
EDITLOAD EQU   0                                                        05695000
EDITABLE EQU   EDITLOAD+4                                               05696000
CUA      EQU   0                                                        05697000
CUANUM   EQU   CUA                                                      05698000
CUAVAL   EQU   CUA+2                                                    05699000
CUA1     EQU   CUAVAL                                                   05700000
CUA2     EQU   CUAVAL+2                                                 05701000
DEVICE   EQU   0                                                        05702000
DEVNUM   EQU   DEVICE                                                   05703000
DEVVAL   EQU   DEVICE+2                                                 05704000
MDRNUM   EQU   DEVICE+202                                               05705000
MDRVAL   EQU   DEVICE+204                                               05706000
MODELS   EQU   0                                                        05707000
DEVSERAL EQU   0                                                        05708000
VOLUME   EQU   0                                                        05709000
CPUS     EQU   0                                                        05710000
CPUCUAS  EQU   0                                                        05711000
CPUCUAV  EQU   CPUCUAS+2                                                05712000
LIBADR   EQU   0                                                        05713000
SYMCODE  EQU   0                                                        05714000
SYMVAL   EQU   SYMCODE+2                                                05715000
TMT2     EQU   0                                                        05716000
TMTKEY   EQU   TMT2                                                     05717000
TMTSRT   EQU   TMTKEY+1                                                 05718000
TMTCPUS  EQU   TMTKEY+3                                                 05719000
TMTITEM  EQU   TMTKEY+4                                                 05720000
TMTPERM1 EQU   TMT2+8                                                   05721000
TMP2     EQU   0                                                        05722000
TMPKEY   EQU   TMP2                                                     05723000
TMPSRT   EQU   TMPKEY+1                                                 05724000
TMPCPUS  EQU   TMPKEY+3                                                 05725000
TMPITEM  EQU   TMPKEY+4                                                 05726000
TMPPERM1 EQU   TMP2+7                                                   05727000
MERIDIAN EQU   0                                                        05728000
MRDNUMBR EQU   MERIDIAN                                                 05729000
MODEL    EQU   MERIDIAN+2                                               05730000
LRTREC   EQU   0                                                        05731000
LRTKEY   EQU   LRTREC                                                   05732000
LRTKEY1  EQU   LRTKEY                                                   05733000
LRTSMS   EQU   LRTREC+2                                                 05734000
LRTNLAST EQU   LRTSMS                                                   05735000
LRTRUNC  EQU   LRTSMS                                                   05736000
LRTERRID EQU   LRTREC+3                                                 05737000
@NM00017 EQU   LRTREC+4                                                 05738000
LRTCNT   EQU   @NM00017+2                                               05739000
LRTDT    EQU   LRTREC+8                                                 05740000
LRTDATE  EQU   LRTDT                                                    05741000
LRTYRDAY EQU   LRTDATE+1                                                05742000
LRTDAY   EQU   LRTYRDAY+1                                               05743000
LRTTIME  EQU   LRTDT+4                                                  05744000
LRTCPU   EQU   LRTREC+16                                                05745000
LRTCPMOD EQU   LRTCPU+1                                                 05746000
LRTCPUS  EQU   LRTCPMOD                                                 05747000
LRTMODEL EQU   LRTCPMOD+3                                               05748000
MCHREC   EQU   0                                                        05749000
MCHHEAD  EQU   MCHREC                                                   05750000
MCHKEY   EQU   MCHHEAD                                                  05751000
MCHSMS   EQU   MCHHEAD+2                                                05752000
MCHCPUID EQU   MCHHEAD+16                                               05753000
CCHREC   EQU   0                                                        05754000
CCHHEAD  EQU   CCHREC                                                   05755000
CCHKEY   EQU   CCHHEAD                                                  05756000
CCHSMS   EQU   CCHHEAD+2                                                05757000
CCHCPUID EQU   CCHHEAD+16                                               05758000
CCHCODE  EQU   CCHREC+68                                                05759000
CCHCODE2 EQU   CCHCODE+2                                                05760000
CCHCUA   EQU   CCHREC+74                                                05761000
OBRREC   EQU   0                                                        05762000
OBRHEAD  EQU   OBRREC                                                   05763000
OBRKEY   EQU   OBRHEAD                                                  05764000
OBRSMS   EQU   OBRHEAD+2                                                05765000
MISCSW   EQU   OBRSMS                                                   05766000
OBRSUBTP EQU   OBRSMS+1                                                 05767000
SDRCOUNT EQU   OBRSUBTP                                                 05768000
OBRTEMP  EQU   OBRSUBTP                                                 05769000
SHORTSW  EQU   OBRSUBTP                                                 05770000
DISMOUNT EQU   OBRSUBTP                                                 05771000
OBRCPUID EQU   OBRHEAD+16                                               05772000
OBRJOBID EQU   OBRREC+24                                                05773000
OBRSDEV2 EQU   OBRJOBID+2                                               05774000
OBRSSDRC EQU   OBRJOBID+4                                               05775000
OBRSCUA  EQU   OBRJOBID+5                                               05776000
OBRFCCW  EQU   OBRREC+32                                                05777000
OBRSRDS  EQU   OBRFCCW                                                  05778000
OBRCSW   EQU   OBRREC+40                                                05779000
OBRDEVDC EQU   OBRREC+48                                                05780000
OBRCODE  EQU   OBRREC+52                                                05781000
OBRDEV   EQU   OBRCODE+2                                                05782000
OBRLSDRC EQU   OBRREC+56                                                05783000
OBRPCUA  EQU   OBRREC+57                                                05784000
OBRSEEK  EQU   OBRREC+70                                                05785000
OBRTERMN EQU   OBRSEEK+2                                                05786000
OBR34CT1 EQU   OBRTERMN+4                                               05787000
OBR34CT2 EQU   OBRTERMN+5                                               05788000
SFTREC   EQU   0                                                        05789000
SFTHEAD  EQU   SFTREC                                                   05790000
SFTKEY   EQU   SFTHEAD                                                  05791000
SFTCPUID EQU   SFTHEAD+16                                               05792000
SFTSDWA  EQU   SFTREC+32                                                05793000
SFTAEC1  EQU   SFTSDWA+96                                               05794000
SFTFLGS  EQU   SFTSDWA+232                                              05795000
SFTRECP  EQU   SFTSDWA+292                                              05796000
IPLREC   EQU   0                                                        05797000
IPLHEAD  EQU   IPLREC                                                   05798000
IPLKEY   EQU   IPLHEAD                                                  05799000
IPLCPUID EQU   IPLHEAD+16                                               05800000
IPLSTIME EQU   IPLREC+52                                                05801000
DDRREC   EQU   0                                                        05802000
DDRHEAD  EQU   DDRREC                                                   05803000
DDRKEY   EQU   DDRHEAD                                                  05804000
DDRSMS   EQU   DDRHEAD+2                                                05805000
DDRCPUID EQU   DDRHEAD+16                                               05806000
@NM00052 EQU   DDRREC+24                                                05807000
DDRFCUA  EQU   DDRREC+45                                                05808000
DDRFDEV  EQU   DDRREC+48                                                05809000
DDRCODE2 EQU   DDRFDEV+2                                                05810000
DDRTODEV EQU   DDRREC+56                                                05811000
MIHREC   EQU   0                                                        05812000
MIHHEAD  EQU   MIHREC                                                   05813000
MIHKEY   EQU   MIHHEAD                                                  05814000
@NM00054 EQU   MIHHEAD+4                                                05815000
MIHCPUID EQU   MIHHEAD+16                                               05816000
@NM00057 EQU   MIHREC+24                                                05817000
MIHCUA   EQU   MIHREC+35                                                05818000
MIHDEV   EQU   MIHREC+44                                                05819000
MIHCODE2 EQU   MIHDEV+2                                                 05820000
EODREC   EQU   0                                                        05821000
EODHEAD  EQU   EODREC                                                   05822000
EODKEY   EQU   EODHEAD                                                  05823000
EODCPUID EQU   EODHEAD+16                                               05824000
TPRREC   EQU   0                                                        05825000
TPRHEAD  EQU   TPRREC                                                   05826000
TPRKEY   EQU   TPRHEAD                                                  05827000
TPRDEV   EQU   TPRHEAD+4                                                05828000
TPRBUFC  EQU   TPRHEAD+5                                                05829000
TPRCPUID EQU   TPRHEAD+16                                               05830000
TPRCUA   EQU   TPRREC+24                                                05831000
@NM00065 EQU   TPRREC+26                                                05832000
TPRVOL   EQU   @NM00065                                                 05833000
TPRMODE  EQU   TPRREC+38                                                05834000
DVBSDRE  EQU   TPRREC+56                                                05835000
MCFREC   EQU   0                                                        05836000
MCFHEAD  EQU   MCFREC                                                   05837000
MCFKEY   EQU   MCFHEAD                                                  05838000
MCFSMS   EQU   MCFHEAD+2                                                05839000
@NM00073 EQU   MCFHEAD+16                                               05840000
MCFSMO   EQU   MCFHEAD+17                                               05841000
CCFREC   EQU   0                                                        05842000
CCFHEAD  EQU   CCFREC                                                   05843000
CCFKEY   EQU   CCFHEAD                                                  05844000
CCFSMS   EQU   CCFHEAD+2                                                05845000
@NM00081 EQU   CCFHEAD+16                                               05846000
CCFSMO   EQU   CCFHEAD+17                                               05847000
OBRLSDR  EQU   0                                                        05848000
OBRSENSE EQU   0                                                        05849000
OBRSENS0 EQU   OBRSENSE                                                 05850000
OBRSENS1 EQU   OBRSENSE+1                                               05851000
TPRSENSE EQU   0                                                        05852000
TPRS1213 EQU   TPRSENSE                                                 05853000
TPRS1415 EQU   TPRSENSE+2                                               05854000
TPRS19   EQU   TPRSENSE+7                                               05855000
FRAMETAB EQU   0                                                        05856000
FRAMENUM EQU   FRAMETAB                                                 05857000
FRAMEDTA EQU   FRAMETAB+4                                               05858000
FRAMEKEY EQU   FRAMEDTA                                                 05859000
FRAMECPU EQU   FRAMEKEY                                                 05860000
FRAMESER EQU   FRAMECPU                                                 05861000
FRAMEMOD EQU   FRAMECPU+3                                               05862000
FRAMEDT  EQU   FRAMEKEY+5                                               05863000
FRAMETYP EQU   FRAMEKEY+13                                              05864000
FRAMLOCM EQU   FRAMEDTA+16                                              05865000
FRAMLOCC EQU   FRAMEDTA+20                                              05866000
LISTLOC  EQU   0                                                        05867000
LISTNUM  EQU   LISTLOC                                                  05868000
LISTCCHR EQU   LISTLOC+4                                                05869000
TMTA     EQU   0                                                        05870000
TMTKEYA  EQU   TMTA                                                     05871000
TMTPERMA EQU   TMTA+8                                                   05872000
TMTTEMPA EQU   TMTA+10                                                  05873000
NEXTBYTE EQU   0                                                        05874000
ADDNUM   EQU   0                                                        05875000
FLIPFLOP EQU   FLIP                                                     05876000
YEARC    EQU   YEAR                                                     05877000
EDFLD    EQU   EDIFILD                                                  05878000
ERRCT1   EQU   DVBSDRE                                                  05879000
ERRNUM   EQU   ERRPLACE                                                 05880000
ERR78    EQU   PRINTBDY                                                 05881000
PFRAMMOD EQU   ERR78+27                                                 05882000
PFRAMSER EQU   ERR78+32                                                 05883000
WORKNM   EQU   WORKBYTE                                                 05884000
WORKNM2  EQU   WORKTWO                                                  05885000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05886000
@NM00092 EQU   ERR78+31                                                 05887000
@NM00091 EQU   ERR78                                                    05888000
FRAMETIM EQU   FRAMEDT+4                                                05889000
FRAMEDAT EQU   FRAMEDT                                                  05890000
@NM00096 EQU   TPRSENSE+4                                               05891000
OBRLSDR2 EQU   OBRLSDR                                                  05892000
OBRLSDR1 EQU   OBRLSDR                                                  05893000
CCFFRAME EQU   CCFREC+24                                                05894000
@NM00083 EQU   CCFHEAD+22                                               05895000
CCFMOD   EQU   CCFSMO+3                                                 05896000
CCFSER   EQU   CCFSMO                                                   05897000
CCFVER   EQU   @NM00081                                                 05898000
@NM00082 EQU   @NM00081                                                 05899000
CCFTIMD  EQU   CCFHEAD+12                                               05900000
CCFDAT   EQU   CCFHEAD+8                                                05901000
@NM00080 EQU   CCFHEAD+7                                                05902000
CCFCNT   EQU   CCFHEAD+6                                                05903000
@NM00079 EQU   CCFHEAD+4                                                05904000
@NM00078 EQU   CCFSMS+1                                                 05905000
CCFCPU   EQU   CCFSMS+1                                                 05906000
CCFMP    EQU   CCFSMS+1                                                 05907000
@NM00077 EQU   CCFSMS                                                   05908000
CCFTIM   EQU   CCFSMS                                                   05909000
@NM00076 EQU   CCFSMS                                                   05910000
CCFTRU   EQU   CCFSMS                                                   05911000
CCFTOD   EQU   CCFSMS                                                   05912000
CCFLST   EQU   CCFSMS                                                   05913000
CCFKEY2  EQU   CCFKEY+1                                                 05914000
CCFKEY1  EQU   CCFKEY                                                   05915000
MCFFRAME EQU   MCFREC+24                                                05916000
@NM00075 EQU   MCFHEAD+22                                               05917000
MCFMOD   EQU   MCFSMO+3                                                 05918000
MCFSER   EQU   MCFSMO                                                   05919000
MCFVER   EQU   @NM00073                                                 05920000
@NM00074 EQU   @NM00073                                                 05921000
MCFTIMD  EQU   MCFHEAD+12                                               05922000
MCFDAT   EQU   MCFHEAD+8                                                05923000
@NM00072 EQU   MCFHEAD+7                                                05924000
MCFCNT   EQU   MCFHEAD+6                                                05925000
@NM00071 EQU   MCFHEAD+4                                                05926000
@NM00070 EQU   MCFSMS+1                                                 05927000
MCFCPU   EQU   MCFSMS+1                                                 05928000
MCFMP    EQU   MCFSMS+1                                                 05929000
@NM00069 EQU   MCFSMS                                                   05930000
MCFTIM   EQU   MCFSMS                                                   05931000
@NM00068 EQU   MCFSMS                                                   05932000
MCFTRU   EQU   MCFSMS                                                   05933000
MCFTOD   EQU   MCFSMS                                                   05934000
MCFLST   EQU   MCFSMS                                                   05935000
MCFKEY2  EQU   MCFKEY+1                                                 05936000
MCFKEY1  EQU   MCFKEY                                                   05937000
RMSSCBRY EQU   TPRREC+58                                                05938000
@NM00067 EQU   TPRREC+39                                                05939000
TPRLINAD EQU   TPRREC+36                                                05940000
@NM00066 EQU   TPRREC+34                                                05941000
TPRCEL   EQU   TPRCPUID+6                                               05942000
TPRMODEL EQU   TPRCPUID+4                                               05943000
TPRSER   EQU   TPRCPUID+1                                               05944000
@NM00064 EQU   TPRCPUID                                                 05945000
TPRTIME  EQU   TPRHEAD+12                                               05946000
TPRDATE  EQU   TPRHEAD+8                                                05947000
@NM00063 EQU   TPRHEAD+6                                                05948000
TPRLENGT EQU   TPRBUFC                                                  05949000
@NM00062 EQU   TPRBUFC                                                  05950000
TPRSMS   EQU   TPRHEAD+2                                                05951000
TPRKEY2  EQU   TPRKEY+1                                                 05952000
TPRKEY1  EQU   TPRKEY                                                   05953000
EODCEL   EQU   EODCPUID+6                                               05954000
EODMODEL EQU   EODCPUID+4                                               05955000
EODSER   EQU   EODCPUID+1                                               05956000
@NM00061 EQU   EODCPUID                                                 05957000
EODTIME  EQU   EODHEAD+12                                               05958000
EODDATE  EQU   EODHEAD+8                                                05959000
@NM00060 EQU   EODHEAD+5                                                05960000
EODDEV   EQU   EODHEAD+4                                                05961000
EODSMS   EQU   EODHEAD+2                                                05962000
EODKEY2  EQU   EODKEY+1                                                 05963000
EODKEY1  EQU   EODKEY                                                   05964000
MIHTYPE  EQU   MIHCODE2+1                                               05965000
MIHCLASS EQU   MIHCODE2                                                 05966000
@NM00059 EQU   MIHDEV                                                   05967000
MIHVOL   EQU   MIHREC+38                                                05968000
@NM00058 EQU   @NM00057+8                                               05969000
MIHJOBID EQU   @NM00057                                                 05970000
MIHCEL   EQU   MIHCPUID+6                                               05971000
MIHMOD   EQU   MIHCPUID+4                                               05972000
MIHSER   EQU   MIHCPUID+1                                               05973000
@NM00056 EQU   MIHCPUID                                                 05974000
MIHTIME  EQU   MIHHEAD+12                                               05975000
MIHDATE  EQU   MIHHEAD+8                                                05976000
@NM00055 EQU   MIHHEAD+6                                                05977000
MIHCSID  EQU   MIHHEAD+5                                                05978000
MIHDEBIT EQU   @NM00054                                                 05979000
MIHCEBIT EQU   @NM00054                                                 05980000
MIHSMS   EQU   MIHHEAD+2                                                05981000
MIHKEY2  EQU   MIHKEY+1                                                 05982000
MIHKEY1  EQU   MIHKEY                                                   05983000
DDRDEV2  EQU   DDRTODEV+2                                               05984000
DDRDEV1  EQU   DDRTODEV                                                 05985000
DDRTOCUA EQU   DDRREC+53                                                05986000
@NM00053 EQU   DDRREC+52                                                05987000
DDRTYPE  EQU   DDRCODE2+1                                               05988000
DDRCLASS EQU   DDRCODE2                                                 05989000
DDRCODE1 EQU   DDRFDEV                                                  05990000
DDRPHD   EQU   @NM00052+20                                              05991000
DDRVOL2  EQU   @NM00052+14                                              05992000
DDRVOL1  EQU   @NM00052+8                                               05993000
DDRJOBID EQU   @NM00052                                                 05994000
DDRCEL   EQU   DDRCPUID+6                                               05995000
DDRMOD   EQU   DDRCPUID+4                                               05996000
DDRSER   EQU   DDRCPUID+1                                               05997000
@NM00051 EQU   DDRCPUID                                                 05998000
DDRTIME  EQU   DDRHEAD+12                                               05999000
DDRDATE  EQU   DDRHEAD+8                                                06000000
@NM00050 EQU   DDRHEAD+4                                                06001000
DDRDEPSW EQU   DDRSMS+1                                                 06002000
@NM00049 EQU   DDRSMS                                                   06003000
DDRKEY2  EQU   DDRKEY+1                                                 06004000
DDRKEY1  EQU   DDRKEY                                                   06005000
IPLSHSEC EQU   IPLSTIME+3                                               06006000
IPLSSEC  EQU   IPLSTIME+2                                               06007000
IPLSMIN  EQU   IPLSTIME+1                                               06008000
IPLSHOUR EQU   IPLSTIME                                                 06009000
IPLSDATE EQU   IPLREC+48                                                06010000
IPLTEMP  EQU   IPLREC+46                                                06011000
IPLHIGH  EQU   IPLREC+42                                                06012000
IPLCHAN  EQU   IPLREC+32                                                06013000
@NM00048 EQU   IPLREC+30                                                06014000
IPLREAS  EQU   IPLREC+28                                                06015000
@NM00047 EQU   IPLREC+25                                                06016000
IPLSYSID EQU   IPLREC+24                                                06017000
IPLCEL   EQU   IPLCPUID+6                                               06018000
IPLMOD   EQU   IPLCPUID+4                                               06019000
IPLSER   EQU   IPLCPUID+1                                               06020000
@NM00046 EQU   IPLCPUID                                                 06021000
IPLTIME  EQU   IPLHEAD+12                                               06022000
IPLDATE  EQU   IPLHEAD+8                                                06023000
@NM00045 EQU   IPLHEAD+4                                                06024000
IPLSMS   EQU   IPLHEAD+2                                                06025000
IPLKEY2  EQU   IPLKEY+1                                                 06026000
IPLKEY1  EQU   IPLKEY                                                   06027000
SFTXDATA EQU   SFTREC+434                                               06028000
SFTLVARA EQU   SFTREC+432                                               06029000
SFTREXN  EQU   SFTRECP+16                                               06030000
SFTCSECT EQU   SFTRECP+8                                                06031000
SFTMODN  EQU   SFTRECP                                                  06032000
@NM00044 EQU   SFTSDWA+238                                              06033000
SFTLCPUA EQU   SFTSDWA+236                                              06034000
SFTERRD  EQU   SFTFLGS+3                                                06035000
SFTERRC  EQU   SFTFLGS+2                                                06036000
SFTERRB  EQU   SFTFLGS+1                                                06037000
SFTERRA  EQU   SFTFLGS                                                  06038000
@NM00043 EQU   SFTSDWA+136                                              06039000
SFTAAEC1 EQU   SFTSDWA+120                                              06040000
@NM00042 EQU   SFTSDWA+112                                              06041000
SFTPROGC EQU   SFTAEC1+8                                                06042000
@NM00041 EQU   SFTAEC1                                                  06043000
@NM00040 EQU   SFTSDWA+88                                               06044000
SFTGRSV  EQU   SFTSDWA+24                                               06045000
SFTABNDC EQU   SFTSDWA                                                  06046000
SFTJOBID EQU   SFTREC+24                                                06047000
SFTCEL   EQU   SFTCPUID+6                                               06048000
SFTMOD   EQU   SFTCPUID+4                                               06049000
SFTSER   EQU   SFTCPUID+1                                               06050000
@NM00039 EQU   SFTCPUID                                                 06051000
SFTTIME  EQU   SFTHEAD+12                                               06052000
SFTDATE  EQU   SFTHEAD+8                                                06053000
@NM00038 EQU   SFTHEAD+4                                                06054000
SFTSMS   EQU   SFTHEAD+2                                                06055000
SFTKEY2  EQU   SFTKEY+1                                                 06056000
SFTKEY1  EQU   SFTKEY                                                   06057000
@NM00037 EQU   OBRTERMN                                                 06058000
@NM00036 EQU   OBRSEEK+1                                                06059000
OBRTCAM  EQU   OBRSEEK                                                  06060000
OBRVOL   EQU   OBRREC+64                                                06061000
OBRSBCNT EQU   OBRREC+62                                                06062000
OBRRETRY EQU   OBRREC+60                                                06063000
OBRTYPE  EQU   OBRDEV+1                                                 06064000
OBRCLASS EQU   OBRDEV                                                   06065000
OBRCODE1 EQU   OBRCODE                                                  06066000
OBRSECUA EQU   OBRREC+49                                                06067000
OBRSTAT  EQU   OBRCSW+4                                                 06068000
@NM00035 EQU   OBRCSW                                                   06069000
OBRSDRS2 EQU   OBRSRDS                                                  06070000
OBRSDRS1 EQU   OBRSRDS                                                  06071000
OBRSDEV1 EQU   OBRJOBID                                                 06072000
OBRCEL   EQU   OBRCPUID+6                                               06073000
OBRMOD   EQU   OBRCPUID+4                                               06074000
OBRSER   EQU   OBRCPUID+1                                               06075000
@NM00034 EQU   OBRCPUID                                                 06076000
OBRTIME  EQU   OBRHEAD+12                                               06077000
OBRDATE  EQU   OBRHEAD+8                                                06078000
@NM00033 EQU   OBRHEAD+4                                                06079000
@NM00032 EQU   OBRSUBTP                                                 06080000
@NM00031 EQU   OBRSUBTP                                                 06081000
@NM00030 EQU   MISCSW                                                   06082000
TRUNC    EQU   MISCSW                                                   06083000
@NM00029 EQU   MISCSW                                                   06084000
OBRKEY2  EQU   OBRKEY+1                                                 06085000
OBRKEY1  EQU   OBRKEY                                                   06086000
CCHLOG   EQU   CCHREC+80                                                06087000
CCHMP    EQU   CCHREC+76                                                06088000
@NM00028 EQU   CCHREC+73                                                06089000
CCHID    EQU   CCHREC+72                                                06090000
CCHTYPE  EQU   CCHCODE2+1                                               06091000
CCHCLASS EQU   CCHCODE2                                                 06092000
CCHCODE1 EQU   CCHCODE                                                  06093000
CCHECSW  EQU   CCHREC+64                                                06094000
CCHCSW   EQU   CCHREC+56                                                06095000
CCHFCCW  EQU   CCHREC+48                                                06096000
CCHATIO  EQU   CCHREC+32                                                06097000
CCHJOBID EQU   CCHREC+24                                                06098000
CCHCEL   EQU   CCHCPUID+6                                               06099000
CCHMOD   EQU   CCHCPUID+4                                               06100000
CCHSER   EQU   CCHCPUID+1                                               06101000
@NM00027 EQU   CCHCPUID                                                 06102000
CCHTIME  EQU   CCHHEAD+12                                               06103000
CCHDATE  EQU   CCHHEAD+8                                                06104000
@NM00026 EQU   CCHHEAD+4                                                06105000
CCHRINC  EQU   CCHSMS+1                                                 06106000
@NM00025 EQU   CCHSMS                                                   06107000
CCHRCRH  EQU   CCHSMS                                                   06108000
@NM00024 EQU   CCHSMS                                                   06109000
CCHKEY2  EQU   CCHKEY+1                                                 06110000
CCHKEY1  EQU   CCHKEY                                                   06111000
MCHLOG   EQU   MCHREC+48                                                06112000
MCHOPSW  EQU   MCHREC+40                                                06113000
MCHJOBID EQU   MCHREC+32                                                06114000
MCHPGMID EQU   MCHREC+24                                                06115000
MCHCEL   EQU   MCHCPUID+6                                               06116000
MCHMOD   EQU   MCHCPUID+4                                               06117000
MCHSER   EQU   MCHCPUID+1                                               06118000
@NM00023 EQU   MCHCPUID                                                 06119000
MCHTIME  EQU   MCHHEAD+12                                               06120000
MCHDATE  EQU   MCHHEAD+8                                                06121000
@NM00022 EQU   MCHHEAD+4                                                06122000
MCHSYSTR EQU   MCHSMS+1                                                 06123000
@NM00021 EQU   MCHSMS                                                   06124000
MCHKEY2  EQU   MCHKEY+1                                                 06125000
MCHKEY1  EQU   MCHKEY                                                   06126000
LRTMCEL  EQU   LRTCPU+6                                                 06127000
@NM00020 EQU   LRTCPU                                                   06128000
LRTHSECS EQU   LRTTIME+3                                                06129000
LRTSEC   EQU   LRTTIME+2                                                06130000
LRTMIN   EQU   LRTTIME+1                                                06131000
LRTHOUR  EQU   LRTTIME                                                  06132000
LRTYEAR  EQU   LRTYRDAY                                                 06133000
LRTDATE0 EQU   LRTDATE                                                  06134000
@NM00019 EQU   @NM00017+3                                               06135000
@NM00018 EQU   @NM00017                                                 06136000
LRTDSMNT EQU   LRTERRID                                                 06137000
@NM00016 EQU   LRTERRID                                                 06138000
LRTSHRT  EQU   LRTERRID                                                 06139000
@NM00015 EQU   LRTERRID                                                 06140000
@NM00014 EQU   LRTSMS                                                   06141000
LRTIMCNV EQU   LRTSMS                                                   06142000
@NM00013 EQU   LRTSMS                                                   06143000
LRNS     EQU   LRTSMS                                                   06144000
LRTKEY2  EQU   LRTKEY+1                                                 06145000
TMPTEMP  EQU   TMP2+9                                                   06146000
TMPPERM  EQU   TMPPERM1+1                                               06147000
@NM00012 EQU   TMPPERM1                                                 06148000
TMPDEV   EQU   TMPKEY+5                                                 06149000
TMPOLDA  EQU   TMPITEM                                                  06150000
TMP3705  EQU   TMPITEM                                                  06151000
TMPOLD   EQU   TMPCPUS                                                  06152000
TMPCPU   EQU   TMPCPUS                                                  06153000
TMPCUA   EQU   TMPSRT                                                   06154000
TMPGROUP EQU   TMPKEY                                                   06155000
TMTTEMP  EQU   TMT2+10                                                  06156000
TMTPERM  EQU   TMTPERM1+1                                               06157000
@NM00011 EQU   TMTPERM1                                                 06158000
TMTDEV   EQU   TMTKEY+6                                                 06159000
TMTDAT   EQU   TMTKEY+5                                                 06160000
TMTOLDA  EQU   TMTITEM                                                  06161000
TMT3705  EQU   TMTITEM                                                  06162000
TMTOLD   EQU   TMTCPUS                                                  06163000
TMTCPU   EQU   TMTCPUS                                                  06164000
TMTCUA   EQU   TMTSRT                                                   06165000
TMTGROUP EQU   TMTKEY                                                   06166000
SYMVAL2  EQU   SYMVAL+2                                                 06167000
SYMVAL1  EQU   SYMVAL                                                   06168000
SYMCDNUM EQU   SYMCODE                                                  06169000
LIBVAL   EQU   LIBADR+2                                                 06170000
LIBADNUM EQU   LIBADR                                                   06171000
CPUCUX3  EQU   CPUCUAV+5                                                06172000
CPUCUX2  EQU   CPUCUAV+3                                                06173000
CPUCUX1  EQU   CPUCUAV                                                  06174000
CPCUANUM EQU   CPUCUAS                                                  06175000
CPUVAL   EQU   CPUS+2                                                   06176000
CPUNUM   EQU   CPUS                                                     06177000
VOLVAL   EQU   VOLUME+2                                                 06178000
VOLNUM   EQU   VOLUME                                                   06179000
SERVAL   EQU   DEVSERAL+2                                               06180000
SERNUM   EQU   DEVSERAL                                                 06181000
MODVAL   EQU   MODELS+2                                                 06182000
MODNUM   EQU   MODELS                                                   06183000
LOADPTR  EQU   EDITABLE+8                                               06184000
LOADNAME EQU   EDITABLE                                                 06185000
EDITNUM  EQU   EDITLOAD                                                 06186000
SYSUMEOD EQU   SYSUMONE+96                                              06187000
SYSUMPER EQU   SYSUMONE+92                                              06188000
SYSUMPEA EQU   SYSUMONE+88                                              06189000
SYSUMPEI EQU   SYSUMONE+84                                              06190000
SYSUMCH  EQU   SYSUMONE+20                                              06191000
SYSUMMCN EQU   SYSUMONE+16                                              06192000
SYSUMMCR EQU   SYSUMONE+12                                              06193000
SYSUMNXT EQU   SYSUMONE+8                                               06194000
SYSUMIPL EQU   SYSUMONE+4                                               06195000
SYSUMNUM EQU   SYSUMONE                                                 06196000
SORTCORE EQU   SORTCCHR                                                 06197000
SORTTIME EQU   SORTKEY+1                                                06198000
SORTYEAR EQU   SORTKEY                                                  06199000
EVDAY    EQU   EVSTOP+1                                                 06200000
EVYEAR   EQU   EVSTOP                                                   06201000
DUMPSIZE EQU   DUMPINFO+4                                               06202000
DUMPADR  EQU   DUMPINFO                                                 06203000
DUMPNUM  EQU   DUMPTABL                                                 06204000
@NM00010 EQU   PARM+212                                                 06205000
RECLNGT1 EQU   PARM+204                                                 06206000
ADCPUT   EQU   PARM+144                                                 06207000
LINECT   EQU   PARM+120                                                 06208000
RECLNGTH EQU   CCHHRLNG+6                                               06209000
@NM00009 EQU   CCHHRLNG+5                                               06210000
USERPGM  EQU   PARM+102                                                 06211000
IDTSEC   EQU   IDTIME+3                                                 06212000
IDSEC    EQU   IDTIME+2                                                 06213000
IDMIN    EQU   IDTIME+1                                                 06214000
IDHOUR   EQU   IDTIME                                                   06215000
IDASID   EQU   ERRID+4                                                  06216000
IDCPU    EQU   ERRID+3                                                  06217000
@NM00008 EQU   ERRID+2                                                  06218000
IDVALUE  EQU   ERRID                                                    06219000
SYSRETRN EQU   @NM00007                                                 06220000
@NM00006 EQU   PARM+72                                                  06221000
WRTHRSH  EQU   PARM+69                                                  06222000
RDTHRSH  EQU   PARM+66                                                  06223000
TERM     EQU   PARM+58                                                  06224000
EVSDAY   EQU   STRTDATE+1                                               06225000
EVSYEAR  EQU   STRTDATE                                                 06226000
PENSEC2  EQU   ENDTIME2+2                                               06227000
PENMIN2  EQU   ENDTIME2+1                                               06228000
PENHOUR2 EQU   ENDTIME2                                                 06229000
PSTSEC2  EQU   STTIME2+2                                                06230000
PSTMIN2  EQU   STTIME2+1                                                06231000
PSTHOUR2 EQU   STTIME2                                                  06232000
PENSEC1  EQU   ENDTIME1+2                                               06233000
PENMIN1  EQU   ENDTIME1+1                                               06234000
PENHOUR1 EQU   ENDTIME1                                                 06235000
PSTSEC1  EQU   STTIME1+2                                                06236000
PSTMIN1  EQU   STTIME1+1                                                06237000
PSTHOUR1 EQU   STTIME1                                                  06238000
@NM00005 EQU   ENDDT+4                                                  06239000
PENYR    EQU   PEND                                                     06240000
@NM00004 EQU   ENDDATE                                                  06241000
@NM00003 EQU   STDT+4                                                   06242000
@NM00002 EQU   STDATE                                                   06243000
YEARNOW  EQU   DATENOW+4                                                06244000
@NM00001 EQU   DATENOW+3                                                06245000
DAYNOW   EQU   DATENOW                                                  06246000
CSNAP    EQU   CLOSEIO                                                  06247000
CSYSIN   EQU   CLOSEIO                                                  06248000
CSERLOG  EQU   CLOSEIO                                                  06249000
CEREPPT  EQU   CLOSEIO                                                  06250000
CTOURIST EQU   CLOSEIO                                                  06251000
OSNAP    EQU   OPENIO                                                   06252000
ODRCTWRK EQU   OPENIO                                                   06253000
OSYSIN   EQU   OPENIO                                                   06254000
OACCDEV  EQU   OPENIO                                                   06255000
OACCIN   EQU   OPENIO                                                   06256000
OSERLOG  EQU   OPENIO                                                   06257000
OEREPPT  EQU   OPENIO                                                   06258000
OTOURIST EQU   OPENIO                                                   06259000
PLOGREC  EQU   MISC                                                     06260000
ERRORID  EQU   MISC                                                     06261000
PSUM     EQU   PRINTES                                                  06262000
PEDIT    EQU   PRINTES                                                  06263000
PZERO    EQU   MISC                                                     06264000
DEBUG63  EQU   DEBUGA+3                                                 06265000
DEBUG62  EQU   DEBUGA+3                                                 06266000
DEBUG61  EQU   DEBUGA+3                                                 06267000
DEBUG60  EQU   DEBUGA+3                                                 06268000
DEBUG59  EQU   DEBUGA+3                                                 06269000
DEBUG58  EQU   DEBUGA+3                                                 06270000
DEBUG57  EQU   DEBUGA+3                                                 06271000
DEBUG56  EQU   DEBUGA+3                                                 06272000
DEBUG55  EQU   DEBUGA+2                                                 06273000
DEBUG54  EQU   DEBUGA+2                                                 06274000
DEBUG53  EQU   DEBUGA+2                                                 06275000
DEBUG52  EQU   DEBUGA+2                                                 06276000
DEBUG51  EQU   DEBUGA+2                                                 06277000
DEBUG49  EQU   DEBUGA+2                                                 06278000
DEBUG48  EQU   DEBUGA+2                                                 06279000
DEBUG47  EQU   DEBUGA+1                                                 06280000
DEBUG46  EQU   DEBUGA+1                                                 06281000
DEBUG45  EQU   DEBUGA+1                                                 06282000
DEBUG44  EQU   DEBUGA+1                                                 06283000
DEBUG43  EQU   DEBUGA+1                                                 06284000
DEBUG42  EQU   DEBUGA+1                                                 06285000
DEBUG41  EQU   DEBUGA+1                                                 06286000
DEBUG40  EQU   DEBUGA+1                                                 06287000
DEBUG39  EQU   DEBUGA                                                   06288000
DEBUG38  EQU   DEBUGA                                                   06289000
DEBUG37  EQU   DEBUGA                                                   06290000
DEBUG36  EQU   DEBUGA                                                   06291000
DEBUG35  EQU   DEBUGA                                                   06292000
DEBUG34  EQU   DEBUGA                                                   06293000
DEBUG33  EQU   DEBUGA                                                   06294000
DEBUG32  EQU   DEBUGA                                                   06295000
DEBUG31  EQU   DEBUG+3                                                  06296000
DEBUG30  EQU   DEBUG+3                                                  06297000
DEBUG29  EQU   DEBUG+3                                                  06298000
DEBUG28  EQU   DEBUG+3                                                  06299000
DEBUG27  EQU   DEBUG+3                                                  06300000
DEBUG26  EQU   DEBUG+3                                                  06301000
DEBUG25  EQU   DEBUG+3                                                  06302000
DEBUG24  EQU   DEBUG+3                                                  06303000
DEBUG22  EQU   DEBUG+2                                                  06304000
DEBUG21  EQU   DEBUG+2                                                  06305000
DEBUG20  EQU   DEBUG+2                                                  06306000
DEBUG19  EQU   DEBUG+2                                                  06307000
DEBUG18  EQU   DEBUG+2                                                  06308000
DEBUG17  EQU   DEBUG+2                                                  06309000
DEBUG15  EQU   DEBUG+1                                                  06310000
DEBUG14  EQU   DEBUG+1                                                  06311000
DEBUG13  EQU   DEBUG+1                                                  06312000
DEBUG12  EQU   DEBUG+1                                                  06313000
DEBUG10  EQU   DEBUG+1                                                  06314000
DEBUG9   EQU   DEBUG+1                                                  06315000
DEBUG8   EQU   DEBUG+1                                                  06316000
DEBUG7   EQU   DEBUG                                                    06317000
DEBUG6   EQU   DEBUG                                                    06318000
DEBUG5   EQU   DEBUG                                                    06319000
DEBUG3   EQU   DEBUG                                                    06320000
DEBUG2   EQU   DEBUG                                                    06321000
DEBUG1   EQU   DEBUG                                                    06322000
DEBUG0   EQU   DEBUG                                                    06323000
SORTBRK  EQU   SWITCHES+1                                               06324000
COREFAIL EQU   SWITCHES+1                                               06325000
ANALYSIS EQU   SWITCHES+1                                               06326000
NOTALL   EQU   SWITCHES+1                                               06327000
NOSDR    EQU   SWITCHES                                                 06328000
TIMESEQ  EQU   SWITCHES                                                 06329000
SYSUM    EQU   SWITCHES                                                 06330000
PARMTHR  EQU   SWITCHES                                                 06331000
TREND    EQU   SWITCHES                                                 06332000
SHORTOBR EQU   SWITCHES                                                 06333000
PARMMES  EQU   SWITCHES                                                 06334000
RDESUM   EQU   SWITCHES                                                 06335000
PCCHFRAM EQU   RECTYPE+1                                                06336000
PMCHFRAM EQU   RECTYPE+1                                                06337000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      06338000
@RF00445 EQU   @EL00006                                                 06339000
@RF00473 EQU   @EL00007                                                 06340000
@RF00496 EQU   @RC00494                                                 06341000
@RF00511 EQU   @RC00509                                                 06342000
@RF00530 EQU   @EL00008                                                 06343000
@RF00551 EQU   @EL00009                                                 06344000
@RF00563 EQU   @EL00010                                                 06345000
@RC00567 EQU   @EL00011                                                 06346000
@RC00573 EQU   @EL00011                                                 06347000
@RC00579 EQU   @EL00011                                                 06348000
@RC00585 EQU   @EL00011                                                 06349000
@RC00591 EQU   @EL00011                                                 06350000
@RF00597 EQU   @EL00011                                                 06351000
@RF00611 EQU   @EL00012                                                 06352000
@RC00609 EQU   @EL00012                                                 06353000
@RF00631 EQU   @RC00629                                                 06354000
@RF00716 EQU   @RC00707                                                 06355000
@RF00789 EQU   @EL00014                                                 06356000
@RF00792 EQU   @EL00014                                                 06357000
@RC00799 EQU   @EL00015                                                 06358000
@RC00812 EQU   @EL00016                                                 06359000
@RC00815 EQU   @EL00016                                                 06360000
@RC00821 EQU   @EL00016                                                 06361000
@RC00824 EQU   @EL00016                                                 06362000
@RC00827 EQU   @EL00016                                                 06363000
@RC00830 EQU   @EL00016                                                 06364000
@RC00833 EQU   @EL00016                                                 06365000
@RC00836 EQU   @EL00016                                                 06366000
@RC00839 EQU   @EL00016                                                 06367000
@RC00857 EQU   @RC00855                                                 06368000
@RC00887 EQU   @RC00882                                                 06369000
@RC00930 EQU   @EL00018                                                 06370000
@RC00949 EQU   @EL00019                                                 06371000
@RF00965 EQU   @EL00019                                                 06372000
@RF00969 EQU   @EL00019                                                 06373000
@RC00975 EQU   @EL00020                                                 06374000
@RF00982 EQU   @EL00020                                                 06375000
@RF00986 EQU   @EL00020                                                 06376000
@RC00988 EQU   @EL00020                                                 06377000
@RC00991 EQU   @EL00020                                                 06378000
@RC01020 EQU   @EL00021                                                 06379000
@RF01028 EQU   @EL00021                                                 06380000
@RF01035 EQU   @EL00021                                                 06381000
@RC01042 EQU   @EL00022                                                 06382000
@RF01050 EQU   @EL00022                                                 06383000
@RF01057 EQU   @EL00022                                                 06384000
@RC01065 EQU   @EL00023                                                 06385000
@RF01073 EQU   @EL00023                                                 06386000
@RF01076 EQU   @EL00023                                                 06387000
@RF01113 EQU   @EL00023                                                 06388000
@RC01130 EQU   @EL00024                                                 06389000
@RF01134 EQU   @EL00024                                                 06390000
@RC01143 EQU   @EL00025                                                 06391000
@RC01149 EQU   @EL00026                                                 06392000
@RF01153 EQU   @EL00026                                                 06393000
@RF01157 EQU   @EL00026                                                 06394000
@RC01173 EQU   @EL00027                                                 06395000
@RF01177 EQU   @EL00027                                                 06396000
@RC01212 EQU   @EL00028                                                 06397000
@RC01185 EQU   @EL00028                                                 06398000
@RF01230 EQU   @EL00028                                                 06399000
@RF01243 EQU   @EL00029                                                 06400000
@RC01376 EQU   @RC01374                                                 06401000
@RF01394 EQU   @EL00034                                                 06402000
@RF01436 EQU   @RC01399                                                 06403000
@RF01472 EQU   @EL00036                                                 06404000
@RC01485 EQU   @EL00037                                                 06405000
@PB00037 EQU   @EL00001                                                 06406000
@RC00801 EQU   @RC00799                                                 06407000
@RF00940 EQU   @RC00930                                                 06408000
@RF00995 EQU   @RC00991                                                 06409000
@RC01187 EQU   @RC01185                                                 06410000
@RF01205 EQU   @RC01185                                                 06411000
@PB00036 EQU   @PB00037                                                 06412000
@RC01487 EQU   @RC01485                                                 06413000
@RC01499 EQU   @RC01485                                                 06414000
@RF00803 EQU   @RC00801                                                 06415000
@PB00035 EQU   @PB00036                                                 06416000
@RF01492 EQU   @RC01487                                                 06417000
@RC01502 EQU   @RC01499                                                 06418000
@PB00034 EQU   @PB00035                                                 06419000
@RF01506 EQU   @RC01502                                                 06420000
@RF01508 EQU   @RC01502                                                 06421000
@RC01510 EQU   @RC01502                                                 06422000
@RC01517 EQU   @RC01502                                                 06423000
@PB00033 EQU   @PB00034                                                 06424000
@PB00032 EQU   @PB00033                                                 06425000
@PB00031 EQU   @PB00032                                                 06426000
@PB00030 EQU   @PB00031                                                 06427000
@PB00029 EQU   @PB00030                                                 06428000
@PB00028 EQU   @PB00029                                                 06429000
@PB00027 EQU   @PB00028                                                 06430000
@PB00026 EQU   @PB00027                                                 06431000
@PB00025 EQU   @PB00026                                                 06432000
@PB00024 EQU   @PB00025                                                 06433000
@PB00023 EQU   @PB00024                                                 06434000
@PB00022 EQU   @PB00023                                                 06435000
@PB00021 EQU   @PB00022                                                 06436000
@PB00020 EQU   @PB00021                                                 06437000
@PB00019 EQU   @PB00020                                                 06438000
@PB00018 EQU   @PB00019                                                 06439000
@PB00017 EQU   @PB00018                                                 06440000
@PB00016 EQU   @PB00017                                                 06441000
@PB00015 EQU   @PB00016                                                 06442000
@PB00014 EQU   @PB00015                                                 06443000
@PB00013 EQU   @PB00014                                                 06444000
@PB00012 EQU   @PB00013                                                 06445000
@PB00011 EQU   @PB00012                                                 06446000
@PB00010 EQU   @PB00011                                                 06447000
@PB00009 EQU   @PB00010                                                 06448000
@PB00008 EQU   @PB00009                                                 06449000
@PB00007 EQU   @PB00008                                                 06450000
@PB00006 EQU   @PB00007                                                 06451000
@PB00005 EQU   @PB00006                                                 06452000
@PB00004 EQU   @PB00005                                                 06453000
@PB00003 EQU   @PB00004                                                 06454000
@PB00002 EQU   @PB00003                                                 06455000
@RF00241 EQU   @PB00002                                                 06456000
@ENDDATA EQU   *                                                        06457000
         END   IFCFILT3                                                 06458000
