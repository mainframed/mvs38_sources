         TITLE 'I F C E T 0 0 C --- ARGONAUT MDR RECORD SUPPORT'        00060002
         MACRO                                                          00120002
         BIN   ,                                                        00180002
.*                                 &SYSLIST(&OP,1) - NAME OF LOG ITEM   00240002
.*                                      RECORD DSECT                    00300002
.*                                 $SYSLIST(&OP,2) - NBR OF SPACES      00360002
.*                                      TO SKIP ON MULTIPLE             00420002
.*                                      PRINT OR NBR OF SPACES          00480002
.*                                      TO BACK UP FROM COLUMN FOR      00540002
.*                                      START OF PRINTING. THE LETTER   00600002
.*                                      B PRECEEDS THE NUMBER (B5) IF   00660002
.*                                      THE LATTER IS DESIRED. OMISSION 00720002
.*                                      OF THIS OPERAND FORCES OPTION 2 00780002
.*                                      WITH BACKUP SPACING EQUAL TO    00840002
.*                                 THE NUMBER OF BITS IN THE ITEM       00900002
.*                                 DEFINITION (VIA MACRO 'DSGEN').      00960002
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     01020002
.*                                 TOTAL NUMBER OF BITS TO PRINT.       01080002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             01140002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  01200002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  01260002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              01320002
         GBLA  &NRENTS,&SHIFT(3000)                                     01380002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           01440002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       01500002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         01560002
         LCLB  &B,&SUB                                                  01620002
         LCLA  &IBITS,&ISHIFT,&K                                        01680002
         LCLA  &TEMP,&T,&OP                                             01740002
         LCLC  &S,&ARG                                                  01800002
          ACTR  500000                                                  01860002
         AIF   (&DIAGTST EQ 0).NOMSG                                    01920002
         AIF   (&INITIAL EQ 0).NOMSG                                    01980002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    02040002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  02100002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     02160002
*        LINE                                                           02220002
         LINE                                                           02280002
.NOMSG   ANOP                                                           02340002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  02400002
&SUB     SETB  1                                                        02460002
.LOOP    ANOP                                                           02520002
&OP      SETA  &OP+1                                                    02580002
&ARG     SETC  '&SYSLIST(&OP,1)'                                        02640002
         ITEMFIND &ARG                                                  02700002
         AIF   (&ITEMXPT EQ 0).MEXIT                                    02760002
&ISHIFT  SETA  &SHIFT(&ITEMXPT)                                         02820002
&IBITS   SETA  &BITS(&ITEMXPT)                                          02880002
         AIF   (&SUB EQ 1).SUB00                                        02940002
         AIF   ('&SYSLIST(3)' EQ '').SETT                               03000002
&IBITS   SETA  &SYSLIST(3)                                              03060002
         AGO   .SETT                                                    03120002
.SUB00   AIF   ('&SYSLIST(&OP,3)' EQ '').SETT                           03180002
&IBITS   SETA  &SYSLIST(&OP,3)                                          03240002
.SETT    ANOP                                                           03300002
&T       SETA  &IBITS-1                                                 03360002
&B       SETB  0                                                        03420002
         AIF   (&IBITS GT 0 AND &IBITS LT 16).SUB0                      03480002
         MNOTE '**NO. OF BITS OUTSIDE RANGE OF 1-15**'                  03540002
.MEXIT   MEXIT                                                          03600002
.SUB0    AIF   (&SUB EQ 1).SUBA                                         03660002
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             03720002
&K       SETA  K'&SYSLIST(2)                                            03780002
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              03840002
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                03900002
         AGO   .SUBB                                                    03960002
.SUBA    ANOP                                                           04020002
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         04080002
&K       SETA  K'&SYSLIST(&OP,2)                                        04140002
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          04200002
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            04260002
.SUBB    ANOP                                                           04320002
&T       SETA  &S                                                       04380002
.BACKUP  ANOP                                                           04440002
&NRENTS  SETA  &NRENTS+1                                                04500002
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2                            04560002
&TEMP    SETA  &ISHIFT                                                  04620002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'                04680002
         AGO   .OUT                                                     04740002
         AIF   (&SUB EQ 1).BIN2                                         04800002
         AIF   ('&SYSLIST(2)' NE '').BIN3                               04860002
         AGO   .BIN2A                                                   04920002
.BIN2    AIF   ('&SYSLIST(&OP,2)' NE '').BIN3                           04980002
.BIN2A   ANOP                                                           05040002
&B       SETB  1                                                        05100002
.BIN3    ANOP                                                           05160002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'                    05220002
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             05280002
.OUT     ANOP                                                           05340002
&ITEMXPT     SETA  0                                                    05400002
         AIF   (&SUB EQ 0).OUTA                                         05460002
         AIF   (&OP LT N'&SYSLIST).LOOP                                 05520002
.OUTA    ANOP                                                           05580002
         MEND                                                           05640002
         MACRO                                                          05700002
&NAME    DSGEN ,                                                        05760002
.*                            THIS MACRO GENERATES ONE DSECT WORD       05820002
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 05880002
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  05940002
.*                                 FIRST IS THE NAME OF THE LOG ITEM    06000002
.*                                 WHILE THE SECOND IS THE # OF BITS TO 06060002
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   06120002
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 06180002
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      06240002
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  06300002
.*                                 THE LOG ITEMS MAY THEN BE USED IN    06360002
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   06420002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             06480002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  06540002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  06600002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              06660002
         GBLA  &NRENTS,&SHIFT(3000)                                     06720002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           06780002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       06840002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         06900002
         LCLB  &ONLY1,&CTIND                                            06960002
         LCLA  &START1,&START2,&END1,&END2                              07020002
         LCLC  &SYMBOL,&EQUSYM                                          07080002
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 07140002
         ACTR  100000                                                   07200002
         AIF   (&ITEMITR EQ 0).START                                    07260002
 MNOTE   20,'DSGEN MACRO OCCURRS AFTER ITEMSORT MACRO HAS BEEN ISSUED.' 07320002
         MEXIT                                                          07380002
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            07440002
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     07500002
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   07560002
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        07620002
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            07680002
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             07740002
         AGO   .SET2A                   BRANCH AROUND                   07800002
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        07860002
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              07920002
         MEXIT                                                          07980002
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X08040002
               ).SET2                   TEST FOR NO SECOND              08100002
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   08160002
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            08220002
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              08280002
         AGO   .LOOP                                                    08340002
.SET2    ANOP                                                           08400002
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 08460002
         AGO   .LOOP                                                    08520002
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             08580002
         MEXIT                                                          08640002
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               08700002
         MEXIT                                                          08760002
.LOOP    ANOP                                                           08820002
&OP      SETA  &OP+1                                                    08880002
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           08940002
&ITEMNBR SETA  &ITEMNBR+1                                               09000002
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            09060002
         MNOTE '**NULL BIT COUNT FIELD**'                               09120002
         MEXIT                                                          09180002
.OK1     ANOP                                                           09240002
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        09300002
         AIF   ('&SYMBOL' NE '').OK                                     09360002
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         09420002
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         09480002
         AGO   .START                   GET NEXT                        09540002
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        09600002
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          09660002
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        09720002
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         09780002
         AGO   .NO3                     BRANCH AROUND                   09840002
.OK2     ANOP                                                           09900002
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              09960002
.NO3     ANOP                                                           10020002
&SYMBOL  EQU   *+&BYTE                                                  10080002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             10140002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    10200002
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    10260002
.CNT     ANOP                                                           10320002
&CTIND   SETB  1                        SET COUNT INDICATOR             10380002
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   10440002
&BYTE    SETA  &COUNT/8                                                 10500002
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        10560002
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        10620002
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             10680002
&END1    SETA  &END1+1                  INCREMENT COUNT                 10740002
&OP      SETA  &OP-1                    DECREMENT INCREMENT             10800002
         AGO   .LOOP                    GENERATE NEXT                   10860002
.TSTST   ANOP                                                           10920002
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               10980002
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        11040002
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      11100002
.NSET1   ANOP                                                           11160002
&OP      SETA  &OP-1                    DECREMENT INDEX                 11220002
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           11280002
         AGO   .LOOP                    GO DO NEXT                      11340002
.LPDONE  ANOP                                                           11400002
&ONLY1   SETB  0                        CLEAR INDICATOR                 11460002
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      11520002
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 11580002
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               11640002
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             11700002
&NAME    DS    &COUNT.C                                                 11760002
.END     MEXIT                                                          11820002
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          11880002
         MEXIT                                                          11940002
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   12000002
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   12060002
         MEXIT                                                          12120002
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         12180002
*****               THE FOLLOWING STATEMENT                *****        12240002
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        12300002
.EQU2    ANOP                                                           12360002
&EQUCNT  SETA  0                        CLEAR COUNTER                   12420002
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 12480002
.EQULOP  ANOP                                                           12540002
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 12600002
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     12660002
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                12720002
         AGO   .EQULOP                  NO-GET NEXT                     12780002
.EQUOUT  ANOP                                                           12840002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  12900002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              12960002
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 13020002
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             13080002
         AGO   .START                   RETURN FOR NEXT                 13140002
         MEND                                                           13200002
         MACRO                                                          13260002
         CONVT ,                                                        13320002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             13380002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  13440002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  13500002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              13560002
         GBLA  &NRENTS,&SHIFT(3000)                                     13620002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           13680002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       13740002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         13800002
         LCLB  &SUB                                                     13860002
         LCLA  &OP                                                      13920002
         LCLA  &OFFSET,&OUT,&IN,&IND,&IBITS,&ISHIFT                     13980002
.*                                                                      14040002
.*       CONVERT BINARY TO DECIMAL                                      14100002
.*             &NAME IS THE REFERENCE INTO THE DSECT RECORD             14160002
.*             &OUT    IS THE NUMBER OF CHARS TO BE PUT ONTO PRINT LINE 14220002
.*                                      DEFAULT IS FOUR MAXIMUM IS 8    14280002
.*             &IN       IS THE NUMBER OF BYTES AS INPUT                14340002
.*                                      ERROR DEFAULT IS 2 MAXIMUM IS 4 14400002
.*                                                                      14460002
         AIF   (&DIAGTST EQ 0).NOMSG                                    14520002
         AIF   (&INITIAL EQ 0).NOMSG                                    14580002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    14640002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  14700002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     14760002
*        LINE                                                           14820002
         LINE                                                           14880002
.NOMSG   ANOP                                                           14940002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LLOP                  15000002
&SUB     SETB  1                                                        15060002
.LLOP    ANOP                                                           15120002
&OP      SETA  &OP+1                                                    15180002
&OUT     SETA  4                        .BR NOT NULL ELSE SET TO 4      15240002
         AIF   (&SUB EQ 1).SUBA                                         15300002
         AIF   ('&SYSLIST(3)' EQ '').B  TEST FOR NULL INPUT             15360002
&OUT     SETA  &SYSLIST(3)             SET &OUT FROM INPUT              15420002
         AGO   .A                                                       15480002
.SUBA    AIF   ('&SYSLIST(&OP,3)' EQ '').B                              15540002
&OUT     SETA  &SYSLIST(&OP,3)          SET &OUT FROM INPUT             15600002
.A       AIF   (&OUT GT 0 AND &OUT LT 9).B   TEST RANGE                 15660002
.AERR    MNOTE '*** BYTES OUT INCORRECTLY SPECIFIED DEFAULT USED ***'   15720002
&OUT     SETA  4                                                        15780002
.B       AIF   (&SUB EQ 1).SUBB                                         15840002
         AIF   ('&SYSLIST(2)' EQ '').LOOP    BRANCH IF NULL             15900002
&IN      SETA  &SYSLIST(2)              .SET &IN FROM INPUT             15960002
         AGO   .BB                                                      16020002
.SUBB    AIF   ('&SYSLIST(&OP,2)' EQ '').LOOP                           16080002
&IN      SETA  &SYSLIST(&OP,2)          .SET &IN FROM INPUT             16140002
.BB      AIF   (&IN GT 0 AND &IN LT 5).D     TEST RANGE                 16200002
.BERR    MNOTE '*** BYTES IN INCORRECTLY SPECIFIED DEFAULT USED ***'    16260002
&IN      SETA  2                                                        16320002
         AGO   .D                                                       16380002
.LOOP    ANOP                           .LOOP TO FIND &NAME IN DSECT    16440002
&IND     SETA  &IND+1                   .SET UP LOOP COUNTER            16500002
         AIF   ('&ITEM(&IND)' EQ '&SYSLIST(&OP,1)').FOUND               16560002
         AIF   (&IND LT &ITEMNBR).LOOP  .TEST FOR END OF DSECT          16620002
         MNOTE '*** LOG ITEM NOT DEFINED ***'                           16680002
         MEXIT                                                          16740002
.FOUND   ANOP                                                           16800002
&IBITS   SETA  &BITS(&IND)              .SET UP NUMBER OF BITS SPEC     16860002
         AIF   (&IBITS-((&IBITS/8)*8) EQ 0).C  .TEST FOR MULTIPLE OF 8  16920002
         MNOTE '*** DATA NOT DEFINED A MULTIPLE OF 8 BITS ***'          16980002
         MEXIT                                                          17040002
.C       ANOP                                                           17100002
&IN      SETA  &IBITS/8                 .COMPUTE NUMBER OF BYTES        17160002
         AIF   (&IN LT 1 OR &IN GT 4).BERR  .TEST RANGE B IF IN ERROR   17220002
&ISHIFT  SETA  &SHIFT(&IND)             .SET UP FOR TEST OF BYTE BNDR   17280002
         AIF   (&ISHIFT EQ 0).D         .TEST FOR BYTE BNDRY            17340002
         MNOTE '*** DATA NOT ALIGNED ON A BYTE BOUNDARY ***'            17400002
         MEXIT                                                          17460002
.*                                                                      17520002
.D       ANOP                                                           17580002
&NRENTS  SETA  &NRENTS+1                                                17640002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),AL.4(9)                    17700002
         DC    X'&IN',X'&OUT'                                           17760002
&IND     SETA  0                                                        17820002
         AIF   (&SUB EQ 0).OUTA                                         17880002
         AIF   (&OP LT N'&SYSLIST).LLOP                                 17940002
.OUTA    ANOP                                                           18000002
         MEND                                                           18060002
         MACRO                                                          18120002
         ITEMFIND &ARG,&ITFDIAG=                                        18180002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             18240002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  18300002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  18360002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              18420002
         GBLA  &NRENTS,&SHIFT(3000)                                     18480002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           18540002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       18600002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         18660002
         LCLA  &A,&B,&X,&I                                              18720002
         LCLC  &C1,&C2,&S                                               18780002
         ACTR  100000                                                   18840002
&ITEMXPT SETA  0                  INDICATE ITEM NOT FOUND.              18900002
         AIF   ('&ARG' NE '').NORM                                      18960002
         AIF   ('&ITFDIAG' EQ 'OFF'  OR  '&ITFDIAG' EQ 'ON').DIAGSET    19020002
  MNOTE 0,'ITEMFIND - OPERAND (&ITFDIAG) INVALID FOR ITFDIAG KEYWORD.'  19080002
         MEXIT                                                          19140002
.DIAGSET ANOP                                                           19200002
&DIAGITF SETB  ('&ITFDIAG' EQ 'ON')                                     19260002
         MEXIT                                                          19320002
.NORM    AIF   (&ITEMITR GT 0).SORTED                                   19380002
         ITEMSORT                                                       19440002
.SORTED  ANOP                                                           19500002
&I       SETA  &ITEMITR           COMPUTED ITTERATION COUNT.            19560002
&X       SETA  &ITEMMDX           COMPUTED MAXIMUM INDEX.               19620002
&C1      SETC  '&ARG'             ISOLATE SEARCH ARGUMENT.              19680002
&C1      SETC  '&C1'.'       '(1,8-K'&C1) PAD TO FULL 8 CHARACTERS.     19740002
.SRCHUP  ANOP                                                           19800002
&A       SETA  &A+&X              CURRENT TABLE SUBSCRIPT + INDEX.      19860002
&S       SETC  '+'                                                      19920002
         AIF   (&A  GT &ITEMNBR  AND  NOT &DIAGITF).SRCHDN1             19980002
         AIF   (&A  LE &ITEMNBR).SRCH00                                 20040002
&C2      SETC  '*-OVER-*'                                               20100002
&I       SETA  &I-1               DECREMENT ITTERATION COUNTER.         20160002
&X       SETA  &X/2               HALVE INDEX VALUE.                    20220002
 MNOTE *,'&ARG - &C2   ITRCTR = &I   PTR = &A&S &X'                     20280002
         AIF   (&I GE 0).SRCHDWN  IF ITTERATION COUNT NOT EXPIRED.      20340002
.NOFIND  MNOTE  20,' ITEMFIND FAILED FOR NAME  &C1  '                   20400002
         MEXIT                                                          20460002
.SRCH00  ANOP                                                           20520002
&I       SETA  &I-1               DECREMENT ITTERATION COUNTER.         20580002
         AIF   (&I LT 0).NOFIND   IF COUNT HAS GONE TO ZERO.            20640002
&X       SETA  &X/2               HALVE INDEX VALUE.                    20700002
&B       SETA  &ITEMNDX(&A)       GET SUBSCRIPT FROM INDEX TABLE.       20760002
&C2      SETC  '&ITEM(&B)'.'       '(1,8-K'&ITEM(&B))  PAD COMPARAND.   20820002
         AIF   (NOT &DIAGITF).COMPARE                                   20880002
 MNOTE *,'&ARG - &C2   ITRCTR = &I   PTR = &A&S &X   POS = &B'          20940002
.COMPARE AIF   ('&C1' LT '&C2').SRCHDWN   ARGUMENT LOWER, MOVE DOWN.    21000002
         AIF   ('&C1' GT '&C2').SRCHUP    ARGUMENT HIGHER, MOVE UP.     21060002
&ITEMXPT SETA  &B                 FOUND. SET INDEX POINTER FOR RETURN.  21120002
&ITEMFST(&I+1)  SETA  &ITEMFST(&I+1)+1                                  21180002
         MEXIT                                                          21240002
.SRCHDWN ANOP                                                           21300002
&A       SETA  &A-&X              CURRENT POINTER MINUS INDEX VALUE.    21360002
&S       SETC  '-'                                                      21420002
         AIF   (&A LE &ITEMNBR).SRCH00    IF WITHIN BOUNDS OF TABLE.    21480002
.SRCHDN1 ANOP                                                           21540002
&I       SETA  &I-1               DECREMENT ITTERATION COUNTER.         21600002
&X       SETA  &X/2               HALVE INDEX VALUE.                    21660002
         AIF   (&I GE 0).SRCHDWN  IF ITTERATION COUNT NOT EXPIRED.      21720002
         MNOTE  20,' ITEMFIND FAILED FOR NAME  &C1  '                   21780002
         MEND                                                           21840002
         MACRO                                                          21900002
         ITEMSORT  &DUMMY                                               21960002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             22020002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  22080002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  22140002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              22200002
         GBLA  &NRENTS,&SHIFT(3000)                                     22260002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           22320002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       22380002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         22440002
         LCLA  &R,&ZI,&I,&A1,&A2,&TEMP                                  22500002
         LCLB  &SR,&GOTO,&TB                                            22560002
         LCLB   &SW(4000)                                               22620002
         LCLC  &C1,&C2                                                  22680002
         ACTR   200000                                                  22740002
&A1      SETA  0                                                        22800002
         AIF   (&ITEMITR EQ 0).LOOP0   TEST FOR RE-ENTRY.               22860002
 MNOTE   0,'ITEMSORT MACRO OCCURRS MORE THAN ONCE. TABLE NOT RESORTED.' 22920002
         MEXIT                                                          22980002
.LOOP0   ANOP                                                           23040002
&A1      SETA  &A1+1                                                    23100002
&ITEMNDX(&A1) SETA &A1                                                  23160002
         AIF   (&A1 LT &ITEMNBR).LOOP0                                  23220002
         AIF   (&ITEMNBR LT 2).MEXIT                                    23280002
&A1      SETA  &ITEMNBR/2         HALF OF TOTAL ENTRIES.                23340002
&A2      SETA  0                                                        23400002
.LOOP1   ANOP                                                           23460002
&A2      SETA  &A2+1                                                    23520002
&SW(&A2) SETB  1                  SET FIRST HALF OF SWITCHES TO 1.      23580002
         AIF   (&A2 LT &A1).LOOP1                                       23640002
.LOOP2   ANOP                                                           23700002
&A2      SETA  &A2+1                                                    23760002
&SW(&A2) SETB  0                  SET SECOND HALF TO ZERO.              23820002
         AIF   (&A2 LT &ITEMNBR).LOOP2                                  23880002
&R       SETA  0                  SET R TO FIRST TRIAL ITEM.            23940002
&ZI      SETA  &ITEMNBR-1         SET ZI TO LAST ITEM.                  24000002
&I       SETA  &ZI-1                                                    24060002
.T3      ANOP                                                           24120002
&SR      SETB  (&SW(&R+1))        GET FLAG, WHICH WAY TO GO?            24180002
&R       SETA  (&R*2)+1+&SR       R=2R+(1 OR 2)                         24240002
         AIF   (&R LE &I).T3                                            24300002
.T4      ANOP                                                           24360002
&R       SETA  (&R-1)/2           R=(R-1)/2                             24420002
&SR      SETB  (&SW(&R+1))        GET SUBTREE SELECT FLAG.              24480002
         AIF   (&SR EQ 0).T7                                            24540002
         AIF   (&GOTO EQ 0).T5                                          24600002
.T7      ANOP                                                           24660002
&A1      SETA  &ITEMNDX(&R+1)                                           24720002
&A2      SETA  &ITEMNDX(&ZI+1)                                          24780002
&C1      SETC  '&ITEM(&A1)'.'       '(1,8-K'&ITEM(&A1))                 24840002
&C2      SETC  '&ITEM(&A2)'.'       '(1,8-K'&ITEM(&A2))                 24900002
         AIF   ('&C1' LT '&C2').T8                                      24960002
.T9      ANOP                                                           25020002
&TEMP    SETA  &ITEMNDX(&R+1)     Z(R) TO TEMP.                         25080002
&TB      SETB  (&SW(&R+1))                                              25140002
&ITEMNDX(&R+1) SETA &ITEMNDX(&ZI+1)    Z(I) TO Z(R)                     25200002
&SW(&R+1) SETB (&SW(&ZI+1))                                             25260002
&ITEMNDX(&ZI+1) SETA &TEMP        TEMP TO Z(I)                          25320002
&SW(&ZI+1) SETB (&TB)                                                   25380002
&SR      SETB  (&SR EQ 0)                                               25440002
&SW(&R+1) SETB (&SR)                                                    25500002
.T8      AIF   (&R GT 0).T4                                             25560002
&GOTO    SETB  1                  SET 'GO TO' T7                        25620002
&ZI      SETA  &ZI-1                                                    25680002
&I       SETA  &I-1                                                     25740002
         AIF   (&I GE 0).T3                                             25800002
.MEXIT   ANOP                                                           25860002
&ITEMITR SETA 1                                                         25920002
&ITEMMDX SETA 1                                                         25980002
.ITRLOOP ANOP                                                           26040002
&ITEMITR SETA &ITEMITR+1                                                26100002
&ITEMMDX SETA &ITEMMDX+&ITEMMDX                                         26160002
         AIF  (&ITEMMDX LT &ITEMNBR).ITRLOOP                            26220002
&ITEMITR SETA &ITEMITR-1                                                26280002
&ITEMMDX SETA &ITEMMDX/2                                                26340002
&A1      SETA &ITEMNBR                                                  26400002
&A2      SETA &ITEMMDX                                                  26460002
&TEMP    SETA &ITEMITR                                                  26520002
 MNOTE *,' ITEMS = &A1, MAX INDEX = &A2, ITTERATION COUNT = &TEMP'      26580002
         MEXIT                                                          26640002
.T5      ANOP                                                           26700002
&TEMP    SETA  &ITEMNDX(&R+1)     Z(R) TO TEMP.                         26760002
&TB      SETB  (&SW(&R+1))                                              26820002
&ITEMNDX(&R+1) SETA &ITEMNDX(&ZI+1)    Z(I) TO Z(R)                     26880002
&SW(&R+1) SETB (&SW(&ZI+1))                                             26940002
&ITEMNDX(&ZI+1) SETA &TEMP        TEMP TO Z(I)                          27000002
&SW(&ZI+1) SETB (&TB)                                                   27060002
&SR      SETB  (&SR EQ 0)                                               27120002
&SW(&R+1) SETB (&SR)                                                    27180002
         AGO   .T3                                                      27240002
         MEND                                                           27300002
           MACRO                                                        27360002
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C27420002
               &LABEL7,&LABEL8                                          27480002
.*                                 THIS MACRO ALLOWS LABELS TO          27540002
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   27600002
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  27660002
.*                                 TION MARKS. THE COLUMN AND LINE END  27720002
.*                                 CONTROLS WILL BE INSERTED BY THE     27780002
.*                                 MACRO. OMITTED OPERANDS MEAN NO      27840002
.*                                 LABEL REQUIRED FOR RESPECTIVE        27900002
.*                                 COLUMN.                              27960002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             28020002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  28080002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  28140002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              28200002
         GBLA  &NRENTS,&SHIFT(3000)                                     28260002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           28320002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       28380002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         28440002
         LCLC  &MARGIN,&TACK                                            28500002
         LCLC  &TEXT                                                    28560002
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            28620002
         AIF   (&INITIAL EQ 0).DIAGCLR                                  28680002
         AIF   (&DIAGTST EQ 0).DIAGCLR                                  28740002
         AIF   (&DIAGLIN EQ 1).DIAGCLR                                  28800002
         MNOTE '**NO LINE ASSOCIATED WITH PREVIOUS LABEL**'             28860002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   28920002
*        LINE                                                           28980002
         LINE                                                           29040002
.DIAGCLR ANOP                                                           29100002
&DIAGSET SETB  0                                                        29160002
&DIAGLIN SETB  0                                                        29220002
&MARGIN  SETC  '*'                                                      29280002
         AIF   ('&NAME' EQ '').LOOPOUT                                  29340002
&LPTR    SETA  &LPTR+1                                                  29400002
&LBL(&LPTR) SETC '&NAME'                                                29460002
&LBLCTR(&LPTR) SETA &LABELNR+1                                          29520002
.LOOPOUT ANOP                                                           29580002
&OP      SETA  &OP+1                                                    29640002
&K       SETA  K'&SYSLIST(&OP)                                          29700002
         AIF (&K GE 2).NORM                                             29760002
&K       SETA  2                                                        29820002
.NORM    ANOP                                                           29880002
&START   SETA  2                                                        29940002
         AIF (&OP LT N'&SYSLIST).NOTLAST                                30000002
&MARGIN  SETC  '$'                                                      30060002
.NOTLAST ANOP                                                           30120002
&NRCHAR  SETA  8                                                        30180002
&TACK    SETC  ''                                                       30240002
.LOOPIN  ANOP                                                           30300002
&REMAIN  SETA  &K-&START                                                30360002
         AIF (&REMAIN GE 8).MORE                                        30420002
&TACK    SETC  '&MARGIN'                                                30480002
&NRCHAR  SETA  &REMAIN                                                  30540002
.MORE    ANOP                                                           30600002
&TEXT    SETC  ''                                                       30660002
         AIF (&REMAIN EQ 0).ENDTEXT                                     30720002
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          30780002
.ENDTEXT ANOP                                                           30840002
&LABELNR SETA  &LABELNR+1                                               30900002
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  30960002
&START   SETA  &START+8                                                 31020002
         AIF ('&TACK' EQ '').LOOPIN                                     31080002
         AIF ('&TACK' EQ '*').LOOPOUT                                   31140002
         MEND                                                           31200002
         MACRO                                                          31260002
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      31320002
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     31380002
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    31440002
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 31500002
.*                                 ENTRIES. LASTLY IT DETERMINES THE    31560002
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    31620002
.*                                 THE PREVIOUS LINE AND STORES THAT #  31680002
.*                                 INTO THE APPROPRIATE BYTE.           31740002
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    31800002
.*                                 DATA.                                31860002
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 31920002
.*                                 DATA COLUMN STARTING CHARACTERS.     31980002
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   32040002
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 32100002
.*                                 STARTING CHARACTERS.                 32160002
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   32220002
.*                                 TO BEGIN NEXT PRINTED LINE.          32280002
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       32340002
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   32400002
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 32460002
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   32520002
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 32580002
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    32640002
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   32700002
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   32760002
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  32820002
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   32880002
.*                                 THE SUBJECT LINE                     32940002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             33000002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  33060002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  33120002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              33180002
         GBLA  &NRENTS,&SHIFT(3000)                                     33240002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           33300002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       33360002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         33420002
         LCLA  &S                                                       33480002
         AIF   (&INITIAL EQ 0 OR &DIAGTST EQ 0).DIAGSET                 33540002
         AIF   (&DIAGSET EQ 0).DIAGSET                                  33600002
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  33660002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   33720002
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       33780002
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 33840002
.DIAGSET ANOP                                                           33900002
&DIAGSET SETB  1                                                        33960002
&DIAGLIN SETB  1                                                        34020002
&NAME    DS    0C                                                       34080002
         AIF   (&INITIAL EQ 0).FIRSTLN                                  34140002
         LINEND                                                         34200002
         AGO   .NTFIRST                                                 34260002
.FIRSTLN ANOP                                                           34320002
&NRENTSX SETC  'N&SYSNDX'                                               34380002
&INITIAL SETA  1                                                        34440002
N&SYSNDX EQU   *                                                        34500002
.NTFIRST ANOP                                                           34560002
         DC    AL1(0)                                                   34620002
         AIF   ('&DATA(1)' EQ '').CKDTABS                               34680002
         AIF   (&DATA(1) EQ &DB).CKDTABS                                34740002
&DB      SETA  &DATA(1)                                                 34800002
         AGO   .AA                                                      34860002
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                34920002
         AIF   (&DATA(2) EQ &DT).NCDATA                                 34980002
         AGO   .CC                                                      35040002
.AA      AIF   ('&DATA(2)' EQ '').BB                                    35100002
         AIF   (&DATA(2) EQ &DT).BB                                     35160002
.CC      ANOP                                                           35220002
&DT      SETA  &DATA(2)                                                 35280002
.BB      DC    XL2'FFFE'                                                35340002
         DC    FL1'&DB'                                                 35400002
         DC    FL1'&DT'                                                 35460002
&NRENTS  SETA  &NRENTS+1                                                35520002
.NCDATA  ANOP                                                           35580002
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              35640002
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               35700002
&LB      SETA  &LABEL(1)                                                35760002
         AGO   .AAA                                                     35820002
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              35880002
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               35940002
         AGO   .CCC                                                     36000002
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  36060002
         AIF   (&LABEL(2) EQ &LT).BBB                                   36120002
.CCC     ANOP                                                           36180002
&LT      SETA  &LABEL(2)                                                36240002
.BBB     DC    XL2'FFFF'                                                36300002
         DC    FL1'&LB'                                                 36360002
         DC    FL1'&LT'                                                 36420002
&NRENTS  SETA  &NRENTS+1                                                36480002
.NCLABEL ANOP                                                           36540002
         AIF   ('&SKIP' NE '').CONT                                     36600002
         AIF   (&TEST EQ 0).NOCHANG                                     36660002
         AGO   .DEFALTA                                                 36720002
.CONT    ANOP                                                           36780002
         AIF   (&TEST EQ 0).AB                                          36840002
         AIF   ('&SKIP' EQ 'E').AB                                      36900002
&S       SETA  &SKIP                                                    36960002
.DEFAULT ANOP                                                           37020002
         AIF   (&SKIP EQ &LASTCC).DEFALTA                               37080002
         ORG   &CARRCON+3                                               37140002
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 37200002
         ORG                                                            37260002
&LASTCC  SETA  &S                                                       37320002
.DEFALTA ANOP                                                           37380002
&TEST    SETB  0                                                        37440002
         AGO   .DD                                                      37500002
.AB      AIF   ('&SKIP' NE 'E').ABB                                     37560002
A&SYSNDX DC    X'FFFB8B00'              EJECT                           37620002
&LASTCC  SETA  184                                                      37680002
&TEST    SETB  1                                                        37740002
         AGO   .ABC                                                     37800002
.ABB     AIF   (&SKIP EQ &LASTCC).NOCHANG                               37860002
A&SYSNDX DC    XL2'FFFB'                                                37920002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              37980002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              38040002
&LASTCC  SETA  &SKIP                                                    38100002
&TEST    SETB  1                                                        38160002
.ABC     ANOP                                                           38220002
&CARRCON SETC  'A&SYSNDX'                                               38280002
&NRENTS  SETA  &NRENTS+1                                                38340002
.DD      ANOP                                                           38400002
.NOCHANG ANOP                                                           38460002
         MEND                                                           38520002
         MACRO                                                          38580002
         LINEND ,                                                       38640002
.*                                 THIS MACRO IS USED ONLY BY THE LINE  38700002
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   38760002
.*                                 ASSOCIATED WITH EACH LINE.           38820002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             38880002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  38940002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  39000002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              39060002
         GBLA  &NRENTS,&SHIFT(3000)                                     39120002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           39180002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       39240002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         39300002
         ORG   &NRENTSX                                                 39360002
         DC    FL1'&NRENTS'                                             39420002
         ORG                                                            39480002
&NRENTS  SETA  0                                                        39540002
B&SYSNDX EQU   *                                                        39600002
&NRENTSX SETC  'B&SYSNDX'                                               39660002
         MEND                                                           39720002
         MACRO                                                          39780002
         LSTART ,                                                       39840002
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  39900002
.*                                 OF THE TABLE IS TO BEGIN.            39960002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             40020002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  40080002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  40140002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              40200002
         GBLA  &NRENTS,&SHIFT(3000)                                     40260002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           40320002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       40380002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         40440002
         LCLA  &NDX,&CTR                                                40500002
         ACTR  500000                                                   40560002
         AIF   (&DIAGTST EQ 0).NODIAG                                   40620002
         AIF   (&DIAGSET EQ 0).NODIAG                                   40680002
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  40740002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   40800002
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       40860002
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 40920002
.NODIAG  ANOP                                                           40980002
         LINEND                                                         41040002
&CTR     SETA  1                                                        41100002
.LOOP    ANOP                                                           41160002
&NDX     SETA  &NDX+1                                                   41220002
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            41280002
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         41340002
&CTR     SETA  &CTR+1                                                   41400002
         AGO   .LOOPCTL                                                 41460002
.NOLBL   ANOP                                                           41520002
         DC    C'&LABELS(&NDX)'                                         41580002
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  41640002
         MEND                                                           41700002
         MACRO                                                          41760002
&NAME    ROUTINE &LOGITEM,&RNAME                                        41820002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             41880002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  41940002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  42000002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              42060002
         GBLA  &NRENTS,&SHIFT(3000)                                     42120002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           42180002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       42240002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         42300002
         AIF   (&DIAGTST EQ 0).NOMSG                                    42360002
         AIF   (&INITIAL EQ 0).NOMSG                                    42420002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    42480002
         MNOTE '**NO LINE ASSOCIATED WITH THIS ROUTINE**'               42540002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     42600002
*        LINE                                                           42660002
         LINE                                                           42720002
.NOMSG   ANOP                                                           42780002
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           42840002
         DC    AL2(&RNAME-&CSECT)                                       42900002
&NRENTS  SETA  &NRENTS+1                                                42960002
         MEND                                                           43020002
         MACRO                                                          43080002
         SPECIAL &ROUTINE,&PARAM,&SPACE=                                43140002
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    43200002
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 43260002
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 43320002
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   43380002
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 43440002
.*                                 INTERPRETED AS AN ARGUMENT OF THE    43500002
.*                                 SPECIAL ROUTINE.                     43560002
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  43620002
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    43680002
         GBLC  &CSECT                                                   43740002
         GBLA  &COUNTR                                                  43800002
         LCLA  &ADD                                                     43860002
         DC    AL1(128)                                                 43920002
         DC    BL.8'&PARAM'                                             43980002
         DC    AL2(&ROUTINE-&CSECT)                                     44040002
         DC    AL2(&COUNTR)                                             44100002
&ADD     SETA  1                                                        44160002
         AIF   ('&SPACE' EQ '').NORM                                    44220002
&ADD     SETA  &SPACE                                                   44280002
.NORM    ANOP                                                           44340002
&COUNTR  SETA  &COUNTR+&ADD                                             44400002
         MEND                                                           44460002
         MACRO                                                          44520002
         HEX   ,                                                        44580002
.*                            THIS MACRO FACILITATES GENERATION OF THE  44640002
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    44700002
.*                                 CONVERSIONS.                         44760002
.*                            &SYSLIST(&OP,1) - NAME OF DATA ITEM TO BE 44820002
.*                                 CONVERTED                            44880002
.*                            &SYSLIST(&OP,2) - # OF SPACES TO SKIP ON  44940002
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   45000002
.*                                 BACK UP FROM COLUMN FOR START OF     45060002
.*                                 PRINTING. THE LETTER B PRECEEDS THE  45120002
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  45180002
.*                                 DESIRED. OMISSION OF THIS OPERAND    45240002
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  45300002
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  45360002
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 45420002
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    45480002
.*                                 IMPLICITLY B).                       45540002
.*                            &SYSLIST(&OP,3) - NUMBER OF BYTES TO      45600002
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     45660002
.*                                 WITH AN L,R, OR B TO STIPULATE       45720002
.*                                 PRINTING OF THE LEFT HALF, RIGHT     45780002
.*                                 HALF, OR BOTH HALVES OF THE BYTE     45840002
.*                                 RESPECTIVELY. OMISSION OF THIS       45900002
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  45960002
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 46020002
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 46080002
.*                                 SARY. THIS MACRO MUST BE THE FIRST   46140002
.*                                 MACRO INSTRUCTION ISSUED FOR THE     46200002
.*                                 SUBJECT LINE(S).                     46260002
         GBLA  &BITS(3000),&DB,&DT,&INITIAL                             46320002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  46380002
         GBLA  &ITEMNDX(3000),&ITEMXPT                                  46440002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              46500002
         GBLA  &NRENTS,&SHIFT(3000)                                     46560002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           46620002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(3000)                       46680002
         GBLC  &LABELS(3000),&LBL(100),&NRENTSX                         46740002
         LCLB  &B,&SUB                                                  46800002
         LCLA  &IBITS,&ISHIFT,&K,&T,&CODE,&BYTESP,&OP                   46860002
         LCLC  &S,&LETTER,&ARG                                          46920002
       ACTR  500000                                                     46980002
         AIF   (&DIAGTST EQ 0).NOMSG                                    47040002
         AIF   (&INITIAL EQ 0).NOMSG                                    47100002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    47160002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  47220002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     47280002
*        LINE                                                           47340002
         LINE                                                           47400002
.NOMSG   ANOP                                                           47460002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  47520002
&SUB     SETB  1                                                        47580002
.LOOP    ANOP                                                           47640002
&OP      SETA  &OP+1                                                    47700002
&ARG     SETC  '&SYSLIST(&OP,1)'                                        47760002
         ITEMFIND  &ARG                                                 47820002
         AIF   (&ITEMXPT EQ 0).MEXIT                                    47880002
.FOUND   ANOP                                                           47940002
&ISHIFT  SETA  &SHIFT(&ITEMXPT)                                         48000002
&IBITS   SETA  &BITS(&ITEMXPT)                                          48060002
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).ALIGN                     48120002
.ERR     MNOTE '**DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY**'          48180002
.MEXIT   MEXIT                                                          48240002
.ALIGN   ANOP                                                           48300002
&CODE    SETA  1                                                        48360002
         AIF   (&SUB EQ 1).SUBA                                         48420002
&K       SETA  K'&SYSLIST(3)                                            48480002
         AGO   .SUBB                                                    48540002
.SUBA    ANOP                                                           48600002
&K       SETA  K'&SYSLIST(&OP,3)                                        48660002
.SUBB    ANOP                                                           48720002
         AIF   (&K EQ 1).ERR3                                           48780002
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            48840002
         MNOTE '**BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL**' 48900002
         MEXIT                                                          48960002
.OK      AIF   (&SUB EQ 1).SUBC                                         49020002
         AIF   ('&SYSLIST(3)' EQ '').USEDEFN                            49080002
&LETTER  SETC  '&SYSLIST(3)'(&K,1)                                      49140002
&S       SETC  '&SYSLIST(3)'(1,&K-1)                                    49200002
         AGO   .SUBD                                                    49260002
.SUBC    ANOP                                                           49320002
         AIF   ('&SYSLIST(&OP,3)' EQ '').USEDEFN                        49380002
&LETTER  SETC  '&SYSLIST(&OP,3)'(&K,1)                                  49440002
&S       SETC  '&SYSLIST(&OP,3)'(1,&K-1)                                49500002
.SUBD    ANOP                                                           49560002
&BYTESP  SETA  &S                                                       49620002
         AIF   ('&LETTER' EQ 'B').BOTH                                  49680002
         AIF   ('&LETTER' EQ 'L').LEFT                                  49740002
         AIF   ('&LETTER' EQ 'R').RIGHT                                 49800002
.ERR3    MNOTE '**PARAMETER 3 INCOMPLETE-DSGEN DEFINITION USED**'       49860002
         AGO   .USEDEFN                                                 49920002
.RIGHT   ANOP                                                           49980002
&CODE    SETA  2                                                        50040002
         AGO   .L                                                       50100002
.LEFT    ANOP                                                           50160002
&CODE    SETA  1                                                        50220002
         AGO   .L                                                       50280002
.USEDEFN ANOP                                                           50340002
&BYTESP  SETA  &IBITS/8                                                 50400002
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       50460002
&CODE    SETA  3                                                        50520002
&T       SETA  &BYTESP*2-1                                              50580002
&S       SETC  '&T'                                                     50640002
.OK2     AIF   (&ISHIFT EQ 0).L                                         50700002
&CODE    SETA  2                                                        50760002
.L       ANOP                                                           50820002
&B       SETB  1                                                        50880002
         AIF   (&SUB EQ 1).SUBE                                         50940002
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             51000002
&K       SETA  K'&SYSLIST(2)                                            51060002
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              51120002
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                51180002
         AGO   .SUBF                                                    51240002
.SUBE    ANOP                                                           51300002
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         51360002
&K       SETA  K'&SYSLIST(&OP,2)                                        51420002
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          51480002
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            51540002
.SUBF    ANOP                                                           51600002
.BACKUP  ANOP                                                           51660002
&NRENTS  SETA  &NRENTS+1                                                51720002
         AIF   (&BYTESP GT 0 AND &BYTESP LT 16).SUB0                    51780002
         MNOTE '**NO. OF BYTES OUTSIDE RANGE OF 1-15**'                 51840002
         MEXIT                                                          51900002
.SUB0    AIF   (&SUB EQ 1).SUBG                                         51960002
         DC    AL.12(&SYSLIST(1)-&DSECT),XL.4'A'                        52020002
         AGO   .SUBH                                                    52080002
.SUBG    ANOP                                                           52140002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'A'                    52200002
.SUBH    ANOP                                                           52260002
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'              52320002
.OUT     ANOP                                                           52380002
&ITEMXPT     SETA  0                                                    52440002
         AIF   (&SUB EQ 0).OUTA                                         52500002
         AIF   (&OP LT N'&SYSLIST).LOOP                                 52560002
.OUTA    ANOP                                                           52620002
         MEND                                                           52680002
         MACRO                                                          52740002
         SUM   &LOGITEM,&MASK                                           52800002
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  52860002
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 52920002
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 52980002
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  53040002
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   53100002
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   53160002
.*                                 MASK WILL BE SET ACCORDING TO THE    53220002
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     53280002
.*                                 ITEM AS DEFINED BY THE MACRO 'DSGEN' 53340002
         GBLA  &COUNTR,&ITEMNBR,&BITS(3000),&SHIFT(3000)                53400002
         GBLC  &ITEM(3000),&DSECT                                       53460002
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           53520002
.LOOP    ANOP                                                           53580002
&NDX     SETA  &NDX+1                                                   53640002
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      53700002
         AIF   (&NDX LT &ITEMNBR).LOOP                                  53760002
         MNOTE *,'LOGITEM NOT FOUND'                                    53820002
         MEXIT                                                          53880002
.FOUND   ANOP                                                           53940002
&ISHIFT  SETA  &SHIFT(&NDX)                                             54000002
&IBITS   SETA  &BITS(&NDX)                                              54060002
         AIF   (&IBITS EQ 1).FORM1      TEST FOR OLD FORM               54120002
         AIF   ('&MASK' NE '').FORM1    TEST FOR MASK                   54180002
         AIF   (&IBITS+&ISHIFT GT 8).MSG     TEST FOR MORE THAN EIGHT   54240002
         DC    AL.1(0),AL.3(&ISHIFT),AL.4(&IBITS)                       54300002
         DC    AL1(0)                                                   54360002
         AGO   .ITEM                                                    54420002
.MSG     MNOTE '**BITS GREATER THAN 8**'                                54480002
         MEXIT                                                          54540002
.FORM1   ANOP                                                           54600002
         DC    AL1(0)                                                   54660002
         AIF   ('&MASK' EQ '').FORM                                     54720002
         DC    B'&MASK'                                                 54780002
         AGO   .ITEM                                                    54840002
.FORM    ANOP                                                           54900002
&BITNBR  SETA  &ISHIFT-7                                                54960002
&BITNBR  SETA  0-&BITNBR                                                55020002
&M       SETA  1                                                        55080002
.LOOP2   ANOP                                                           55140002
         AIF   (&BITNBR EQ 0).GOTIT                                     55200002
&M       SETA  &M*2                                                     55260002
&BITNBR  SETA  &BITNBR-1                                                55320002
         AGO   .LOOP2                                                   55380002
.GOTIT   ANOP                                                           55440002
         DC    AL1(&M)                                                  55500002
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     55560002
         DC    AL2(&COUNTR)                                             55620002
&COUNTR  SETA  &COUNTR+1                                                55680002
         MEND                                                           55740002
* THIS MODULE SUPPORTS ARGONAUT DEVICE --- SUPPORT CODE =               55800002
         GBLC  &DSECT,&CSECT                                            55860002
&DSECT   SETC  'RECORD'                                                 55920002
&CSECT   SETC  'IFCET00C'                                               55980002
IFCET00C CSECT                                                          56040002
*****       D S E C T   G E N E R A T I O N  E N T R I E S        ***** 56100002
RECORD   DSECT                                                          56160002
         DS    0F                                                       56220002
         DSGEN (CLASRC,8),              RECORD TYPE                    X56280002
               (SYSREL,8),              SYSTEM & RELEASE LEVEL         X56340002
               (SWITCH,8,0,3),          SWITCHES (4 BYTES OF EM)       X56400002
               (RCDCNT,8),              COUNT & MULTI PART INDICATION  X56460002
               (SPARE1,8),              SPACE (1 BYTE)                 X56520002
               (DATE,32),               DATE                           X56580002
               (TIME,32),               TIME                           X56640002
               (VERNO,8),               MACHINE VERSION                X56700002
               (CPUSER,24),             C P U SERIAL NO.               X56760002
               (CPUID,16),              C P U IDENTIFICATION           X56820002
               (SPACE2,16),             SPARE (2 BYTES)                X56880002
               (DEVCUA,16),             DEVICE CHANNEL UNIT ADDR       X56940002
               (CNT,8),                 COUNT                          X57000002
               (SPARE,8),               SPACE (1 BYTE)                 X57060002
               (SENSE01,64),            SENSE AREA  1                  X57120002
               (SENSE02,64),            SENSE AREA  2                  X57180002
               (SENSE03,64),            SENSE AREA  3                  X57240002
               (SENSE04,64),            SENSE AREA  4                  X57300002
               (SENSE05,64),            SENSE AREA  5                  X57360002
               (SENSE06,64),            SENSE AREA  6                  X57420002
               (SENSE07,64),            SENSE AREA  7                  X57480002
               (SENSE08,64),            SENSE AREA  8                  X57540002
               (SENSE09,64),            SENSE AREA  9                  X57600002
               (SENSE10,64),            SENSE AREA 10                  X57660002
               (SENSE11,64),            SENSE AREA 11                  X57720002
               (SENSE12,64),            SENSE AREA 12                  X57780002
               (SENSE13,64),            SENSE AREA 13                  X57840002
               (SENSE14,64),            SENSE AREA 14                  X57900002
               (SENSE15,64),            SENSE AREA 15                  X57960002
               (SENSE16,64)             SENSE AREA 16                   58020002
         DSGEN (BTSSHTS,16),            BTSS SHEETS                    X58080002
               (CFSFOLDS,16),           CFS FOLDS                      X58140002
               (PAPERPRS,16),           PAPER PROCESSED                X58200002
               (SERIALNO,16),           SERIAL NUMBER          @Y17CSWTX58260002
               (RECORDWK,72)            RECORD WORK AREA                58320002
         ORG   RECORDWK                                                 58380002
         DSGEN (ERRCODE,8)              SENSE BYTE 4                    58440002
         DSGEN (SNS05,1,0,7),           SENSE BYTE 5                   X58500002
               (SNS06,1,0,7),           SENSE BYTE 6                   X58560002
               (SNS07,1,0,7),           SENSE BYTE 7                   X58620002
               (SNS08,1,0,7),           SENSE BYTE 8                   X58680002
               (SNS09,1,0,7),           SENSE BYTE 9                   X58740002
               (SNS10,1,0,7),           SENSE BYTE 10                  X58800002
               (SNS11,1,0,7),           SENSE BYTE 11                  X58860002
               (SENSECNT,8)             COUNT OF SENSE AREAS            58920002
         DSGEN (SNS05,8,EQU,SNS050),                                   X58980002
               (SNS06,8,EQU,SNS060),                                   X59040002
               (SNS07,8,EQU,SNS070),                                   X59100002
               (SNS08,8,EQU,SNS080),                                   X59160002
               (SNS09,8,EQU,SNS090),                                   X59220002
               (SNS10,8,EQU,SNS100),                                   X59280002
               (SNS11,8,EQU,SNS110)                                     59340002
IFCET00C CSECT                                                          59400002
         USING *,R9                     SET UP BASE REG                 59460002
         USING RECORD,R2                SET UP DSECT PTR                59520002
         DC    A(ENTRY)                 LINE/LABEL SET ADDR             59580002
         DC    CL8'IFCET00C'            MODULE NAME                     59640002
R9PTR    DC    F'0'                                                     59700002
LABELPTR DC    F'0'                                                     59760002
         DS    0F                                                       59820002
CNTSAVE  DC    F'0'                     ENTRY COUNT SAVE AREA           59880002
ENTRYNO  DC    F'0'                     COUNTER SAVE                    59940002
WORK     DC    D'0'                     WORK SPACE                      60000002
ENTRYCNT DC    F'0'                                                     60060002
REGSAVE  DC    4F'0'                                                    60120002
LOOP21   DC    A(LOOP2-4)               LINE                            60180002
ENTRYLB2 DC    A(ENTRYLB-1)             LABEL                           60240002
LINEXIT1 DC    A(LINEXIT-4)             LINE FOR EXIT                   60300002
LBLEXIT1 DC    A(LBLEXIT-1)             LABEL FOR EXIT                  60360002
FMT5ALN1 DC    A(FMT5ALN-4)             LINE FOR FORMAT 5A              60420002
FMT6ALN1 DC    A(FMT6ALN-4)             LINE FOR FORMAT 6A              60480002
FMT3ALN1 DC    A(FMT3ALN-4)             LINE FOR FORMAT 3A              60540002
FMT7ALN1 DC    A(FMT7ALN-4)             LINE FOR FORMAT 7A              60600002
FMT5ALB1 DC    A(FMT5ALB-1)             LABEL FOR FORMAT 5A             60660002
FMT6ALB1 DC    A(FMT6ALB-1)             LABEL FOR FORMAT 6A             60720002
FMT3ALB1 DC    A(FMT3ALB-1)             LABEL FOR FORMAT 3A             60780002
FMT7ALB1 DC    A(FMT7ALB-1)             LABEL FOR FORMAT 7A             60840002
GETOUTLN DC    A(EXITLN-4)              TO MDR MODULE                   60900002
GETOUTLB DC    A(EXITLB-1)              TO MDR MODULE                   60960002
DEVTYPE  EQU   SWITCH2                                                  61020002
SUPPORT  EQU   1                        COUNT OF XDEVTBL ENTRIES        61080002
XDEVTBL  EQU   *                                                        61140002
         DC    X'0C',C'3800'       ARGONAUT CLASS/TYPE CVT              61200002
RELTAB   EQU   *                                                        61260002
         DC    CL4'  OS'                SYSTEM/RELEASE CONV TBL         61320002
         DC    CL4' DOS'                                                61380002
         DC    CL4' VS1'                                                61440002
         DC    CL4'  VM'                                                61500002
         DC    CL4' VS2'                                                61560002
         DC   3CL4'    '                                                61620002
R0       EQU   0                                                        61680002
R1       EQU   1                                                        61740002
R2       EQU   2                        DSECT PTR                       61800002
R3       EQU   3                        PRINT BUFFR PTR                 61860002
R4       EQU   4                        RECORD POINTER                  61920002
R5       EQU   5                                                        61980002
R6       EQU   6                                                        62040002
R7       EQU   7                                                        62100002
R8       EQU   8                                                        62160002
R9       EQU   9                        MODULE BASE REG                 62220002
R10      EQU   10                                                       62280002
R11      EQU   11                                                       62340002
R12      EQU   12                                                       62400002
R13      EQU   13                                                       62460002
R14      EQU   14                                                       62520002
R15      EQU   15                                                       62580002
L0       EQU   0                        ZERO                            62640002
L1       EQU   1                        ONE                             62700002
L2       EQU   2                        TWO                             62760002
L3       EQU   3                        THREE                           62820002
L4       EQU   4                        FOUR                            62880002
L5       EQU   5                        FIVE                            62940002
L6       EQU   6                        SIX                             63000002
L7       EQU   7                        SEVEN                           63060002
L8       EQU   8                        EIGHT                           63120002
L9       EQU   9                                                        63180002
L23      EQU   23                       TWENTY THREE                    63240002
L46      EQU   46                       FOURTY SIX                      63300002
ZERO     EQU   0                                                        63360002
HW01     DC    H'1'                                                     63420002
EIGHT    DC    H'8'                     EIGHT                           63480002
HW16     DC    H'16'                                                    63540002
NONE     DC    C'NONE  '                                                63600002
UNIV     DC    C'UNIVERSAL'                                             63660002
F3       DC    C'FORMAT 3A'                                             63720002
F5       DC    C'FORMAT 5A'                                             63780002
F6       DC    C'FORMAT 6A'                                             63840002
F7       DC    C'FORMAT 7A'                                             63900002
X80      EQU   X'80'                                                    63960002
X81      EQU   X'81'                                                    64020002
X89      EQU   X'89'                                                    64080002
X8A      EQU   X'8A'                                                    64140002
X8B      EQU   X'8B'                                                    64200002
X8C      EQU   X'8C'                                                    64260002
X90      EQU   X'90'                                                    64320002
X9F      EQU   X'9F'                                                    64380002
X50      EQU   X'50'                                                    64440002
ENTRYNO1 EQU   ENTRYNO+2                                                64500002
         EJECT                                                          64560002
         DS    0F                                                       64620002
COUNTEM  EQU   *                                                        64680002
         STM   R5,R8,REGSAVE            SAVE REGS                       64740002
         XC    ENTRYNO(4),ENTRYNO       INITIALIZE ENTRY NO.            64800002
         XC    SENSECNT(L8),SENSECNT    INTLZE SENSE COUNT AREA         64860002
         LR    R6,R4                    GET RECORD POINTER              64920002
         SR    R5,R5                    ZERO R5                         64980002
COUNTEM1 EQU   *                                                        65040002
         OC    L0(L8,R6),L0(R6)         ANY SENSE INFO?                 65100002
         BZ    RETURN                   NO, BRANCH                      65160002
         LA    R5,L1(R5)                YES, BUMP COUNTER               65220002
         STC   R5,SENSECNT              STORE COUNTER                   65280002
         CH    R5,HW16                  REACHED MAX ?                   65340002
         BE    RETURN                   YES, BRANCH                     65400002
         LA    R6,L8(R6)                NO, BUMP POINTER                65460002
         B     COUNTEM1                 AND GO BACK TO TOP              65520002
SETCPUNO EQU   *                                                        65580002
         STM   R5,R8,REGSAVE            SAVE REGS                       65640002
         SR    R5,R5                    CLEAR R5                        65700002
         IC    R5,L0(R4)                GET CPU TYPE                    65760002
         SLL   R5,L8                                                    65820002
         IC    R5,L1(R4)                                                65880002
         LTR   R5,R5                    IS IT ZERO ?                    65940002
         BNZ   RETURN                   NO, RETURN                      66000002
         LA    R6,L46                   BACK UP POINTER 46 BYTES        66060002
         SR    R3,R6                                                    66120002
         MVC   L0(L9,R3),UNIV           SAY MODEL=UNIVERSAL             66180002
         MVC   L23(L6,R3),NONE          SAY SERIAL=NONE                 66240002
         B     RETURN                                                   66300002
NEXT     EQU   *                                                        66360002
         STM   R5,R8,REGSAVE            SAVE REGS                       66420002
         L     R5,LOOP21                SET UP POINTERS                 66480002
         ST    R5,R9PTR                  V                              66540002
         L     R5,ENTRYLB2               V                              66600002
         ST    R5,LABELPTR               V                              66660002
         B     RETURN                   RETURN                          66720002
SKIP     SR    R15,R15                  SUPRESS PRINT OF LINE           66780002
RETURN   LM    R5,R8,REGSAVE            RESTORE REGS                    66840002
SKIPIT   BR    R14                      RETURN                          66900002
TOPOLOOP EQU   *                                                        66960002
         STM   R5,R8,REGSAVE            SAVE REGS                       67020002
         L     R6,ENTRYNO               GET ENTRY NO.                   67080002
         LA    R6,L1(R6)                INCREMENT BY 1                  67140002
         ST    R6,ENTRYNO               SAVE ENTRY NO.                  67200002
         CH    R6,HW16                  FINISHED W/SENSE INFO ?         67260002
         BH    EXIT                     YES, BRANCH                     67320002
         MH    R6,EIGHT                 CALC OFFSET(ENTRYNO X 8)        67380002
         SH    R6,EIGHT                 AND BACK-UP EIGHT               67440002
         AR    R6,R4                    ADD RECORD POINTER TO IT        67500002
         MVC   RECORDWK(L8),L0(R6)      MOVE SENSE INFO TO WORK         67560002
         OC    RECORDWK(L8),RECORDWK    ANY SENSE INFO ?                67620002
         BZ    EXIT                     NO, BRANCH                      67680002
         L     R6,ENTRYNO               GET ENTRY NO.                   67740002
         CVD   R6,WORK                  CONVERT ENTRYNO TO DEC          67800002
         UNPK  WORK(L4),WORK+6(L2)      UNPACK IT                       67860002
         MVZ   WORK+3(L1),WORK+2         FIX ZONE BITS                  67920002
         MVC   ENTRYLB1(L2),WORK+2      MOVE TO PRINT LINE              67980002
         B     RETURN                                                   68040002
EXIT     EQU   *                                                        68100002
         L     R5,LINEXIT1              NO, SET UP POINTERS             68160002
         ST    R5,R9PTR                  V                              68220002
         L     R5,LBLEXIT1                   V                          68280002
         ST    R5,LABELPTR               V                              68340002
         B     RETURN                   BRANCH                          68400002
TYPE1    EQU   *                                                        68460002
         SR    R15,R15                  INDICATE NO PRINT               68520002
         STM   R5,R8,REGSAVE            SAVE REGISTERS                  68580002
         TM    L0(R2),X90               RECORD TYPE = MDR ?             68640002
         BO    RETURN                   YES, BRANCH                     68700002
*                                       NO                              68760002
         L     R5,GETOUTLN              SET UP POINTERS                 68820002
         ST    R5,R9PTR                      V                          68880002
         L     R5,GETOUTLB               V                              68940002
         ST    R5,LABELPTR                   V                          69000002
         B     RETURN                                                   69060002
TYPELBL  EQU   *                                                        69120002
         STM   R5,R8,REGSAVE            SAVE REGS                       69180002
         L     R6,ENTRYNO               ENTRY NUMBER IN R6              69240002
         MH    R6,EIGHT                 MULT ENTRY NO BY 8              69300002
         AR    R6,R4                    ADD DSECT PTR TO R6             69360002
         SH    R6,EIGHT                 R6 NOW POINTS TO CURRENT SNS    69420002
         CLI   L0(R6),X81               FMT 5 REQD ?                    69480002
         BL    TLBL2                    NO, GO TO NEXT CHECK            69540002
         CLI   L0(R6),X8A               FMT 6A REQD ?                   69600002
         BE    MVCLBL6                  YES, BRANCH                     69660002
         CLI   L0(R6),X89               FMT 5A REQD ?                   69720002
         BNH   MVCLBL5                  YES, BRANCH                     69780002
TLBL2    EQU   *                                                        69840002
         CLI   L0(R6),X50               FMT 3A REQD ?                   69900002
         BL    MVCLBL7                  NO, BRANCH                      69960002
         CLI   L0(R6),X9F               FMT 3A REQD ?                   70020002
         BH    MVCLBL7                  NO, BRANCH                      70080002
         MVC   ERRLBL+33(L8),F3         YES, MOVE IN FORMAT 3           70140002
         B     RETURN                   RETURN                          70200002
MVCLBL6  EQU   *                                                        70260002
         MVC   ERRLBL+33(L8),F6         MOVE IN FORMAT 6                70320002
         B     RETURN                   RETURN                          70380002
MVCLBL5  EQU   *                                                        70440002
         MVC   ERRLBL+33(L8),F5         MOVE IN FORMAT 5                70500002
         B     RETURN                   RETURN                          70560002
MVCLBL7  EQU   *                                                        70620002
         MVC   ERRLBL+33(L8),F7         MOVE IN UNKNOWN(FORMAT 7A)      70680002
         B     RETURN                   RETURN                          70740002
*        THE FOLLOWING CHECKS ARE MADE TO DETERMINE THE FORMATS         70800002
*          TO USE WHEN PRINTING MDR RECORDS. THE FOLLOWING LIST         70860002
*          GIVES THE FORMAT USED FOR SPECIFIC ERROR CODES:              70920002
*                                                                       70980002
*              FORMAT    ERROR CODES                                    71040002
*                                                                       71100002
*                3A        5X-7F WHERE X = 0-F                          71160002
*                3A        8B                                           71220002
*                3A        9X                                           71280002
*                5A        81-89                                        71340002
*                6A        8A                                           71400002
********                                                                71460002
TYPE     EQU   *                                                        71520002
         STM   R5,R8,REGSAVE            SAVE REGISTERS                  71580002
         L     R6,ENTRYNO               ENTRY NUM IN R6                 71640002
         MH    R6,EIGHT                 MULT ENTRY NUM BY 8             71700002
         AR    R6,R4                    ADD DSECT PTR TO R6             71760002
         SH    R6,EIGHT                 R6 NOW POINTS TO CURRENT SNS    71820002
         CLI   L0(R6),X81               FMT 5A REQD ?                   71880002
         BL    TYPE2                    NO, BRANCH TO NEXT CHECK        71940002
         CLI   L0(R6),X8A               FMT 6A REQD ?                   72000002
         BE    FMT6A                    YES, BRANCH TO SET-UP           72060002
         CLI   L0(R6),X89               FMT 5A REQD ?                   72120002
         BNH   FMT5A                    YES, BRANCH TO SET-UP           72180002
TYPE2    EQU   *                                                        72240002
         CLI   L0(R6),X50               FMT 3A REQD ?                   72300002
         BL    FMT7A                    NO, UNKNOWN ERR CODE, BR        72360002
         CLI   L0(R6),X9F               FMT 3A REQD ?                   72420002
         BH    FMT7A                    NO, UNKNOWN ERR CODE, BR        72480002
*                                       YES, DROP THRU & GO             72540002
FMT3A    EQU   *                                                        72600002
         L     R5,FMT3ALN1              SET UP POINTERS                 72660002
         ST    R5,R9PTR                   V                             72720002
         L     R5,FMT3ALB1               V                              72780002
         ST    R5,LABELPTR                V                             72840002
         B     RETURN                    RETURN                         72900002
FMT5A    EQU   *                        ASSUME FORMAT 5A REQD           72960002
         L     R5,FMT5ALN1              SET UP POINTERS                 73020002
         ST    R5,R9PTR                   V                             73080002
         L     R5,FMT5ALB1               V                              73140002
         ST    R5,LABELPTR                V                             73200002
         B     RETURN                    RETURN                         73260002
FMT6A    EQU   *                                                        73320002
         L     R5,FMT6ALN1              SET UP POINTERS                 73380002
         ST    R5,R9PTR                   V                             73440002
         L     R5,FMT6ALB1               V                              73500002
         ST    R5,LABELPTR                V                             73560002
         B     RETURN                    RETURN                         73620002
FMT7A    EQU   *                                                        73680002
         L     R5,FMT7ALN1              SET UP POINTERS                 73740002
         ST    R5,R9PTR                  V                              73800002
         L     R5,FMT7ALB1               V                              73860002
         ST    R5,LABELPTR               V                              73920002
         B     RETURN                   RETURN                          73980002
CONVTYPE EQU   *                                                        74040002
         STM   R5,R8,REGSAVE            SAVE REGS                       74100002
         LA    R5,SUPPORT               BCT COUNT, CONV DEV TYPE TBL    74160002
*        LA    R4,L2(R4)                R4 POINTS TO CLASS/TYPE 2 BYTES 74220002
         LA    R6,XDEVTBL               ADDR OF CLASS/TYPE XLATE TABLE  74280002
NEXT2     EQU   *                                                       74340002
         CLC   L0(L1,R4),L0(R6)         IS THIS CLASS/TYPE WE LOOKIN FO 74400002
         BNE   BUMP                     NO, BRANCH                      74460002
         MVC   L0(L4,R3),L1(R6)         YES, MOVE CLASS/TYPE TO BUFF    74520002
         B     RETURN                   RETURN                          74580002
BUMP     DS    0H                                                       74640002
         LA    R6,L5(R6)                BUMP CONVERT TBL PTR            74700002
         BCT   R5,NEXT2                KEEP LOOKING                     74760002
         MVC   L0(L7,R3),F7                                             74820002
         B     RETURN                  RETURN FROM WENCE YOU CAME       74880002
CONVREL  EQU   *                                                        74940002
         STM   R5,R8,REGSAVE            SAVE REGS                       75000002
         SR    R6,R6                    ZERO R6                         75060002
         IC    R6,L0(R4)                GET REL & SYS VALUES            75120002
         SRDL  R6,L5                    PUT REL NO. INTO R7             75180002
         SLL   R6,L2                    MULT SYS VALUE BY 4             75240002
         L     R8,LABELPTR              GET LABEL PTR                   75300002
         LA    R6,RELTAB(R6)            INDEX TO SYS TBL                75360002
         MVC   L0(L4,R8),L0(R6)         MOVE SYS NAME TO LABEL          75420002
         SR    R6,R6                    ZERO R6                         75480002
         SLDL  R6,L5                    RETRIEVE REL NO.                75540002
         LTR   R6,R6                    IS IT ZERO ?                    75600002
         BZ    NOREL                    YES, BRANCH                     75660002
         CVD   R6,WORK                  NO, CONVERT IT                  75720002
         UNPK  L0(L2,R3),WORK+L6(R2)    UNPACK IT INTO PRT BUFF         75780002
         MVZ   L1(L1,R3),L0(R3)         FIX THE ZONE                    75840002
         B     RETURN                   RETURN                          75900002
NOREL    EQU   *                                                        75960002
         MVC   L0(L4,R3),NONE           MOVE 'NONE' TO REL MSG          76020002
         B     RETURN                   RETURN                          76080002
DATESET  EQU   *                                                        76140002
         UNPK  WORK(L8),L1(L3,R4)       UNPACK THE DATE                 76200002
         MVC   L0(L3,R3),WORK+L5        MOVE DAY                        76260002
         MVC   L5(L2,R3),WORK+L3        MOVE YEAR                       76320002
         B     RETURN                   RETURN                          76380002
         EJECT                                                          76440002
         DS    0F                                                       76500002
ENTRY    EQU   *                                                        76560002
         DC    XL4'0'                                                   76620002
         DC    XL4'0'                                                   76680002
         DC    A(LABELS)                                                76740002
         DC    H'0'                                                     76800002
         LINE  (1,1),(1,1),SKIP=1                                       76860002
         ROUTINE SPARE1,TYPE1                                           76920002
         LABEL ''                                                       76980002
         LINE  SKIP=E                   EJECT                           77040002
         LABEL ''                                                       77100002
         LINE  (78,23),(1,89),SKIP=1                                    77160002
         HEX   CPUID,0,2B                                               77220002
         HEX   CPUSER,0,3B                                              77280002
         ROUTINE CPUID,SETCPUNO                                         77340002
         LABEL '---RECORD ENTRY TYPE - MDR              SOURCE - MISC  X77400002
                         CPU MODEL','SERIAL NO.'                        77460002
         LINE  (17,1),(4,1),SKIP=1                                      77520002
         ROUTINE SYSREL,CONVREL                                         77580002
         LABEL 'XXXX RELEASE'                                           77640002
         LINE  ,(25,23),SKIP=1                                          77700002
         LABEL 'DAY YEAR','HH.MM.SS.TH'                                 77760002
         LINE  (25,23),(18,23),SKIP=2                                   77820002
         ROUTINE DATE,DATESET                                           77880002
         HEX   TIME,1,4B                                                77940002
         LABEL 'DATE -','TIME -'                                        78000002
         LINE  (24),(2),SKIP=1                                          78060002
         ROUTINE DEVTYPE,CONVTYPE                                       78120002
         LABEL 'DEVICE TYPE'                                            78180002
         LINE  (24),(2),SKIP=2                                          78240002
         HEX   DEVCUA,0,2B                                              78300002
         LABEL 'CHANNEL UNIT ADDRESS'                                   78360002
         LINE  (45,1),(1),SKIP=1                                        78600002
         ROUTINE SENSE01,COUNTEM                                        78660002
         CONVT SENSECNT,1,2                                             78720002
         LABEL 'NUMBER OF ENTRIES IN THIS RECORD (DECIMAL) -'           78780002
         LINE  (45,1),(1),SKIP=2                                        78800002
         LABEL 'INTERNAL LOG ENTRY BYTES 0-7 ARE SAME AS SENSE BYTES 4-X78820002
               11'                                                      78830002
LOOP2    LINE  (11),(1),SKIP=1                                          78840002
         ROUTINE SENSE01,TOPOLOOP                                       78900002
ENTRYLB  LABEL 'ENTRY NO.    '                                          78960002
         LINE  ,(1),SKIP=1                                              79020002
         LABEL '|---------------------------------------|'              79080002
         LINE  (31),(1,40),SKIP=1                                       79140002
         HEX   ERRCODE,0,1B                                             79200002
         ROUTINE SENSE01,TYPELBL                                        79260002
ERRLBL   LABEL '| STATUS CODE (SENSE BYTE 4) -','| XXXXXXXX'            79320002
         LINE  ,(1),SKIP=2                                              79380002
         LABEL '|---------------------------------------|'              79440002
         LINE  ,(3,17),SKIP=1                                           79680002
         LABEL 'SENSE','SENSE','SENSE','SENSE','SENSE','SENSE','SENSE'  79740002
         LINE  (12,17),(3,17),SKIP=0                                    79800002
         HEX   SNS05,0,1B                                               79860002
         HEX   SNS06,0,1B                                               79920002
         HEX   SNS07,0,1B                                               79980002
         HEX   SNS08,0,1B                                               80040002
         HEX   SNS09,0,1B                                               80100002
         HEX   SNS10,0,1B                                               80160002
         HEX   SNS11,0,1B                                               80220002
         LABEL 'BYTE 5 -','BYTE 6 -','BYTE 7 -','BYTE 8 -','BYTE 9 -','X80280002
               BYTE 10 -','BYTE 11 -'                                   80340002
         LINE  (14,17),(1),SKIP=1                                       80400002
         ROUTINE SENSE01,TYPE                                           80460002
         LABEL ''                                                       80520002
FMT3ALN  LINE  ,(2,17),SKIP=2                                           80580002
FMT3ALB  LABEL 'RETRY COUNT','FO STAT(6-3)','CORNA STAT(6-8)','PRCS STAX80640002
               T(6-9)','CGEN STAT1(4-0)','CGEN STAT2(4-1)','CGEN STAT3(X80700002
               4-2)'                                                    80760002
         LINE  (14,17),(1,17),SKIP=1                                    80820002
         BIN   (SNS050,0,1),                                           X80880002
               (SNS060,0,1),                                           X80940002
               (SNS070,0,1),                                           X81000002
               (SNS080,0,1),                                           X81060002
               (SNS090,0,1),                                           X81120002
               (SNS100,0,1),                                           X81180002
               (SNS110,0,1)                                             81240002
         LABEL 'RETRY CT 8','FOF OCCURRED','ERAS LMP OFF',             X81300002
               'CONTR BIT 4','DRUM/MIRR TH','SSYS CLK ER','UPGM AHEAD'  81360002
         LINE                                                           81420002
         BIN   (SNS051,0,1),                                           X81480002
               (SNS061,0,1),                                           X81540002
               (SNS071,0,1),                                           X81600002
               (SNS081,0,1),                                           X81660002
               (SNS091,0,1),                                           X81720002
               (SNS101,0,1),                                           X81780002
               (SNS111,0,1)                                             81840002
         LABEL 'RETRY CT 4','FO INT HI','CLNR NOT RUN','CONTR BIT 2',  X81900002
               'MIRR MTR TH','BIT TIME CLK','PRT LIN SYNC'              81960002
         LINE                                                           82020002
         BIN   (SNS052,0,1),                                           X82080002
               (SNS062,0,1),                                           X82140002
               (SNS072,0,1),                                           X82200002
               (SNS082,0,1),                                           X82260002
               (SNS092,0,1),                                           X82320002
               (SNS102,0,1),                                           X82380002
               (SNS112,0,1)                                             82440002
         LABEL 'RETRY CT 2','FO INT LO','PRECLN COR','CONTR BIT 1',    X82500002
               'MIRR DRV AMP','WCGM INP PE','LIN BUF INTF'              82560002
         LINE                                                           82620002
         BIN   (SNS053,0,1),                                           X82680002
               (SNS063,0,1),                                           X82740002
               (SNS073,0,1),                                           X82800002
               (SNS083,0,1),                                           X82860002
               (SNS093,0,1),                                           X82920002
               (SNS103,0,1),                                           X82980002
               (SNS113,0,1)                                             83040002
         LABEL 'RETRY CT 1','FO HLD INTLK','CHG COR CK','DVLPR INTLK', X83100002
               'MIRR CURR HI','LIN BUF PE','LIN BUF ORUN'               83160002
         LINE                                                           83220002
         BIN   (SNS054,0,1),                                           X83280002
               (SNS064,0,1),                                           X83340002
               (SNS074,0,1),                                           X83400002
               (SNS084,0,1),                                           X83460002
               (SNS094,0,1),                                           X83520002
               (SNS104,0,1),                                           X83580002
               (SNS114,0,1)                                             83640002
         LABEL 'RESERVED','RESERVED','XFR COR CK','TNR HPR EMPT',      X83700002
               'MIRR SYNC','SERIALZR PE','UNDSCORE PE'                  83760002
         LINE                                                           83820002
         BIN   (SNS055,0,1),                                           X83880002
               (SNS065,0,1),                                           X83940002
               (SNS075,0,1),                                           X84000002
               (SNS085,0,1),                                           X84060002
               (SNS095,0,1),                                           X84120002
               (SNS105,0,1),                                           X84180002
               (SNS115,0,1)                                             84240002
         LABEL 'RESERVED','RESERVED','POSXFR COR ','TNR COL FULL','LASRX84300002
                SYNC','ANY WCGM PE','UNDSCORE BIT'                      84360002
         LINE                                                           84420002
         BIN   (SNS056,0,1),                                           X84480002
               (SNS066,0,1),                                           X84540002
               (SNS076,0,1),                                           X84600002
               (SNS086,0,1),                                           X84660002
               (SNS096,0,1),                                           X84720002
               (SNS106,0,1),                                           X84780002
               (SNS116,0,1)                                             84840002
         LABEL 'RESERVED','RESERVED','DRUM SVO ER','CYCLONE VAC','LASR X84900002
               LOW PWR','CAR BIT 0','BIT CTR OFLO'                      84960002
         LINE                                                           85020002
         BIN   (SNS057,0,1),                                           X85080002
               (SNS067,0,1),                                           X85140002
               (SNS077,0,1),                                           X85200002
               (SNS087,0,1),                                           X85260002
               (SNS097,0,1),                                           X85320002
               (SNS107,0,1),                                           X85380002
               (SNS117,0,1)                                             85440002
         LABEL 'RESERVED','RESERVED','DVLPR BIAS','COL HANDL CK',      X85500002
               'RESERVED','CAR BIT 1','PRT/HOR CT=0'                    85560002
******                                  FORMAT 3A COMPLETE ******       85620002
FMT3AEND LINE  (11),(1),SKIP=1                                          85680002
         ROUTINE SPARE1,NEXT                                            85740002
         LABEL ''                                                       85800002
FMT5ALN  LINE  (14,17),(2,17),SKIP=2                                    85860002
FMT5ALB  LABEL 'INTRPT REQ','MAR HI','MAR LO','IEU REG 1(0-2)','IEU REGX85920002
                2(0-3)','INST/SOREG HI','INST/SOREG LO'                 85980002
         LINE  (14,17),(1,17),SKIP=1                                    86040002
         BIN   (SNS050,0,1)                                             86100002
         ROUTINE SPARE1,SKIPIT                                          86160002
         ROUTINE SPARE1,SKIPIT                                          86220002
         BIN   (SNS080,0,1),                                           X86280002
               (SNS090,0,1)                                             86340002
         LABEL 'SO REG',' ',' ','MIRH PE','SAR PE'                      86400002
         LINE                                                           86460002
         BIN   (SNS051,0,1)                                             86520002
         ROUTINE SPARE1,SKIPIT                                          86580002
         ROUTINE SPARE1,SKIPIT                                          86640002
         BIN   (SNS081,0,1),                                           X86700002
               (SNS091,0,1)                                             86760002
         LABEL 'LEVEL 1',' ',' ','MIRL PE','LSR PE'                     86820002
         LINE                                                           86880002
         BIN   (SNS052,0,1)                                             86940002
         ROUTINE SPARE1,SKIPIT                                          87000002
         ROUTINE SPARE1,SKIPIT                                          87060002
         BIN   (SNS082,0,1),                                           X87120002
               (SNS092,0,1)                                             87180002
         LABEL 'LEVEL 2',' ',' ','MDR PE','INBUS PE'                    87240002
               LINE                                                     87300002
         BIN   (SNS053,0,1)                                             87360002
         ROUTINE SPARE1,SKIPIT                                          87420002
         ROUTINE SPARE1,SKIPIT                                          87480002
         BIN   (SNS083,0,1),                                           X87540002
               (SNS093,0,1)                                             87600002
         LABEL 'LEVEL 3',' ',' ','WCS DBL BIT','NO DEV RSP'             87660002
         LINE                                                           87720002
         BIN   (SNS054,0,1)                                             87780002
         ROUTINE SPARE1,SKIPIT                                          87840002
         ROUTINE SPARE1,SKIPIT                                          87900002
         BIN   (SNS084,0,1),                                           X87960002
               (SNS094,0,1)                                             88020002
         LABEL 'LEVEL 4',' ',' ','ALUA PE','I-CYCLE'                    88080002
         LINE                                                           88140002
         BIN   (SNS055,0,1)                                             88200002
         ROUTINE SPARE1,SKIPIT                                          88260002
         ROUTINE SPARE1,SKIPIT                                          88320002
         BIN   (SNS085,0,1),                                           X88380002
               (SNS095,0,1)                                             88440002
         LABEL 'LEVEL 5',' ',' ','ALUB PE','E-CYCLE'                    88500002
         LINE                                                           88560002
         BIN   (SNS056,0,1)                                             88620002
         ROUTINE SPARE1,SKIPIT                                          88680002
         ROUTINE SPARE1,SKIPIT                                          88740002
         BIN   (SNS086,0,1),                                           X88800002
               (SNS096,0,1)                                             88860002
         LABEL 'LEVEL 6',' ',' ','SDRH PE','ROS HSL'                    88920002
         LINE                                                           88980002
         BIN   (SNS057,0,1)                                             89040002
         ROUTINE SPARE1,SKIPIT                                          89100002
         ROUTINE SPARE1,SKIPIT                                          89160002
         BIN   (SNS087,0,1),                                           X89220002
               (SNS097,0,1)                                             89280002
         LABEL 'RESERVED',' ',' ','SDRL PE','ANY ERROR'                 89340002
******                                  FORMAT 5A COMPLETE ******       89400002
FMT5AEND LINE                                                           89460002
         ROUTINE SPARE1,NEXT                                            89520002
         LABEL ''                                                       89580002
FMT6ALN  LINE  ,(2,17),SKIP=2                                           89640002
FMT6ALB  LABEL 'RETRY COUNT','CNTRL FLAGS','TRACK ADDR','RESERVED','RESX89700002
               ERVED','RESERVED','RESERVED'                             89760002
         LINE  (31),(18),SKIP=1                                         89820002
         BIN   (SNS070,0,1)                                             89880002
         LABEL 'INTF RTN RQD'                                           89940002
         LINE                                                           90000002
         BIN   (SNS071,0,1)                                             90060002
         LABEL 'RESERVED'                                               90120002
         LINE                                                           90180002
         BIN   (SNS072,0,1)                                             90240002
         LABEL 'ALT TRK USED'                                           90300002
         LINE                                                           90360002
         BIN   (SNS073,0,1)                                             90420002
         LABEL 'PERMANENT'                                              90480002
         LINE                                                           90540002
         BIN   (SNS074,0,1)                                             90600002
         LABEL 'NO ALT AVAIL'                                           90660002
         LINE                                                           90720002
         BIN   (SNS075,0,1)                                             90780002
         LABEL 'RETAIN PWR'                                             90840002
         LINE                                                           90900002
         BIN   (SNS076,0,1)                                             90960002
         LABEL 'DIAG LD MODE'                                           91020002
         LINE                                                           91080002
         BIN   (SNS077,0,1)                                             91140002
         LABEL 'IMPL MODE'                                              91200002
******                                  FORMAT 6A COMPLETE ******       91260002
FMT6AEND LINE  (11),(1),SKIP=1                                          91320002
         ROUTINE SPARE1,NEXT                                            91380002
         LABEL ''                                                       91440002
FMT7ALN  LINE  (14,17),(2,17),SKIP=2                                    91500002
FMT7ALB  LABEL 'RESERVED','RESERVED','RESERVED','RESERVED','RESERVED','X91560002
               RESERVED','RESERVED'                                     91620002
FMT7AEND LINE  (11),(1),SKIP=1                                          91680002
         ROUTINE SPARE1,NEXT                                            91740002
         LABEL ''                                                       91800002
LINEXIT  LINE  (40,1),(1,45),SKIP=1                                     91860002
         CONVT BTSSHTS,2,6                                              91920002
LBLEXIT  LABEL 'BTS COUNT                    (DECIMAL)','00'            91980002
         LINE  (40,1),(1,45),SKIP=1                                     92040002
         CONVT CFSFOLDS,2,6                                             92100002
         LABEL 'CFS COUNT                    (DECIMAL)','00'            92160002
         LINE  (40,1),(1,45),SKIP=2                                     92220002
         CONVT PAPERPRS,2,6                                             92280002
         LABEL 'PAPER COUNT                  (DECIMAL)','00'            92340002
         LINE  (40,1),(1,1),SKIP=3                                      92350002
         CONVT SERIALNO,2,4                                             92360002
         LABEL 'DEVICE SERIAL NO.'                                      92370002
         LINE  SKIP=1                                                   92400002
         LABEL ''                                                       92460002
         DC    X'FF'                    BAIL OUT                        92520002
         DC    X'00A4'                                                  92580002
         DC    X'0018'                  OFFSET IN THE RECORD            92640002
         DC    X'0018'                                                  92700002
EXITLN   LINE                                                           92760002
EXITLB   LABEL ''                                                       92820002
         DC    X'FE'                                                    92880002
         DC    C'IFCEXXXF'                                              92940002
LABELS   DS    0F                                                       93000002
         LSTART                                                         93060002
ENTRYLB1 EQU   ENTRYLB+10               LABEL FOR MOVE (MVC)            93120002
         END                                                            93180002
