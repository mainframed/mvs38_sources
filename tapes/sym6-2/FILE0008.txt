./  ADD  SSI=71800337,NAME=IFG0552X
         TITLE 'IFG0552X - EOV INPUT END-OF-DATA FUNCTION'              00100021
IFG0552X CSECT                                                          00400021
*********************************************************************** 00450002
*                                                                     * 00500002
*                                                                     * 00500402
*          VS2 RELEASE 02 DELETIONS                                   * 00500802
*          VS2 RELEASE 03 DELETIONS                                   * 00504502
*0000338500                                                     ZA00120 00509602
*0000655000                                                     ZA01289 00514502
*          VS2 RELEASE 04 DELETIONS/CHANGES                           * 00516003
*0000483020-483160,483300-465500                               @ZA01344 00517003
*0000                                                          @ZA06440 00519003
*                                                                     * 00521202
*                                                                     * 00526102
*********************************************************************** 00531002
*                                                                     * 00535902
* MODULE NAME = IFG0552X (OS/VS2)                                     * 00540802
*                                                                     * 00545702
* DESCRIPTIVE NAME = EOV INPUT END-OF-DATA FUNCTION                   * 00550602
*                                                                     * 00555502
* COPYRIGHT = NONE                                                    * 00560402
*                                                                     * 00565302
* STATUS = RELEASE 4, LEVEL 0                                         * 00570203
*                                                                     * 00575102
* FUNCTION =                                                          * 00580002
*        1. DETERMINES WHETHER END-OF-DATA (EOD) HAS BEEN REACHED OR  * 00584902
*        IF THERE ARE CONCATENATED DATA SETS TO BE PROCESSED.         * 00589802
*        AT ENTRY WITH THE TIOT INDICATING A SPOOLED DATA SET OR      * 00594702
*        WITH REG 14 ZERO, END OF DATA/CONCATENATION IS INDICATED.    * 00599602
*                                                                     * 00604502
*        1A. IF EOD HAS BEEN REACHED, THE USER'S EODAD ADDRESS IS     * 00609402
*        PLACED IN THE RESUME (OLD) PSW, AND CONTROL IS RETURNED      * 00614302
*        TO THE USER                                                  * 00619202
*                                                                     * 00624102
*        1B. IF THERE ARE CONCATENATED DATA SETS WITH UNLIKE          * 00629002
*        ATTRIBUTES, CONTROL IS TRANSFERRED TO THE FIRST LOAD OF      * 00633902
*        CLOSE TO CLOSE THE DCB AND THEN REOPEN IT WITH NEW           * 00638802
*        ATTRIBUTES.                                                  * 00643702
*                                                                     * 00648602
*        1C. IF THERE ARE CONCATENATED DATA SETS WITH LIKE ATTRIBUTES,* 00653502
*        THIS FUNCTION FIRST DETERMINES WHETHER OR NOT SMF RECORDS    * 00658402
*        ARE TO BE WRITTEN, TRANSFERRING CONTROL TO THE CLOSE SMF     * 00663302
*        PROCESSING MODULE IF REQUIRED. THAT MODULE RETURNS CONTROL   * 00713302
*        TO THIS MODULE (WITH REGISER 14 CONTAINING 4)                * 00773302
*        UNLESS THE DATA SET AT EOF IS ON A TAPE VOLUME               * 00783302
*        IN WHICH CASE CONTROL IS RETURNED TO THE EOV TAPE INPUT      * 00813302
*        VOLUME POSITIONING FUNCTION. IF SMF RECORDS ARE NOT REQUIRED * 00863302
*        AND THE CURRENT DATA SET IS ON TAPE, CONTROL IS TRANSFERRED  * 00913302
*        DIRECTLY TO THE VOLUME POSITIONING FUNCTION. FOLLOWING SMF   * 00963302
         EJECT                                                          00964502
*        UPON RETURN FROM SMF PROCESSING FOR NON-TAPE DEVICES,        * 00965302
*        OR IF THAT IS NOT REQUIRED, THE NEXT DSAB                    * 01013302
*        IS OBTAINED BY FORWARD CHAINING FROM THE CURRENT DSAB;       * 01063302
*        WORKAREA POINTERS, THE USER'S DCB, DEB, DEB EXTENSION        * 01113302
*        AND UCB ARE UPDATED TO REFLECT THE CONCATENATED DATA SET AND * 01163302
*        CONTROL IS TRANSFERRED TO THE INITIALIZATION FUNCTION TO     * 01213302
*        BEGIN PROCESSING THE CONCATENATED DATA SET.                  * 01263302
*                                                                     * 01264302
*        2. IF ENTRY IS FROM THE INITIAL FUNCTION WITH THE CONCAT.    * 01363302
*        BIT ON IN FIELD 'DCBOFLGS' (INDICATED BY REG 14 CONTINING    * 01423302
*        16 AT ENTRY), THEN VARIOUS RETURN INDICATORS                 * 01433302
*        ARE SET AND CONTROL IS PASSED TO THE USER VIA SVC 3 (EXCP)   * 01463302
*        OR TO THE EOV ACCESS METHOD EXECUTOR (BSAM OR QSAM           * 01513302
*        ACCESS METHOD) TO READ THE CONCATENATED DATA SET.            * 01563302
*        NOTE- THIS ENTRY CAN ONLY OCCUR WHEN THE CONCATENATED DATA   * 01613302
*        SET RESIDES ON/IN A UNIT RECORD DEVICE.                      * 01663302
*                                                                     * 01713302
*        3. IF ENTRY IS FROM THE PROBLEM DETERMINATION FUNCTION,      * 01763302
*        (INDICATED BY THE BUSY BIT, DCBOBUSY IN DCBOFLGS, SET TO 0), * 01783302
*        AN ERROR HAS PREVIOUSLY OCCURRED IN SOME EOV FUNCTION AND THE* 01813302
*        USER HAS INDICATED THAT IT IS TO BE IGNORED. EOV WILL THEN   * 01863302
*        CLOSE THE DCB AS IN THE CASE OF CONCATENATION WITH UNLIKE    * 01913302
*        ATTRIBUTES (REFER TO (3) ABOVE), AND CLOSE WILL EXIT TO THE  * 01963302
*        USER.                                                        * 02013302
*                                                                     * 02673302
*        BEFORE EITHER EXITING TO THE USER OR TRANSFERRING       Y02082 02713302
*        CONTROL TO IFG0551L OR IGC01020, THE DCB ADDRESS IN THE Y02082 02763302
*        DEB (DEBDCBAD) IS SET TO POINT TO THE USER'S DCB.       Y02082 02813302
*                                                                     * 02863302
* NOTES = SEE BELOW                                                   * 02913302
*                                                                     * 02963302
*    DEPENDENCIES =                                                   * 03013302
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 03063302
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03113302
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03163302
*                                                                     * 03213302
*    RESTRICTIONS = NONE                                              * 03263302
         EJECT                                                          03313302
*    REGISTER CONVENTIONS =                                           * 03363302
*            R2 POINTS TO COPIED DCB                                  * 03413302
*            R4 POINTS TO OPEN WORK AREA                              * 03463302
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 03513302
*            R6 POINTS TO THE WTG TABLE                               * 03563302
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 03613302
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 03663302
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 03713302
*            R10 POINTS TO THE UCB                                    * 03763302
*            R11 POINTS TO THE DEB                                    * 03813302
*                                                                     * 04163302
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 04213302
*        END OF LISTING.                                              * 04263302
*                                                                     * 04313302
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 04363302
*                                                                     * 04413302
*    PROCESSOR = ASSEMBLER XF                                         * 04463302
*                                                                     * 04513302
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 04563302
*                  ORG STATEMENT AT END OF LISTING                    * 04613302
*                                                                     * 04663302
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 04713302
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 04763302
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 04813302
*                                                                     * 04863302
* ENTRY POINT = IFG0552X FROM (REG 14 ENTRY POINT IN PARENTHESIS)     * 04913302
*               IFG0551F - INITIAL READ JFCB FUNCTION (SPOOLED TIOT)  * 04963302
*               IFG0551H DEVICE TYPE DETERMINATION (0,16)             * 05013302
*               IFG0552R TAPE INPUT STANDARD TRAILER LABEL (0)        * 05063302
*               IFG0552T TAPE INPUT VOLUME POSITIONING (0)            * 05113302
*               IFG0553P DA INPUT INITAL MODULE (0)                   * 05163302
*               IFG0194A VOLUME MOUNTING MODULE (0)                   * 05173302
*               IFG0559E PROBLEM DETERMINATION MODULE (BUSY BIT ZERO) * 05193302
*               IFG0553B SMF MODULE (4)                               * 05203302
*                                                                     * 05213302
*    PURPOSE = SEE FUNCTION                                           * 05263302
*                                                                     * 05313302
*    LINKAGE =                                                        * 05363302
*        TRANSFERRED CONTROL THROUGH IECRES MACRO                     * 05373302
         EJECT                                                          05413302
* INPUT =                                                             * 05463302
*        CONTROL PASSED IN PROTECT KEY 5                              * 05465302
*        REGISTER 2 POINTS TO COPIED DCB                              * 05473302
*        DEBDCBAD POINTS TO COPIED DCB EXCEPT FOR SPOOLED DCB         * 05475302
*        REGISTER 4 POINTS TO EOV WORKAREA                            * 05483302
*        REGISTER 14 CONTAINS ENTRY BRANCH OFFSET                     * 05493302
*              0 - TO PROCESS EOF                                     * 05505302
*              4 - RETURN FROM SMF                                    * 05507302
*              16 - TO FINISH UNIT RECORD CONCATENATION               * 05509302
*        BUSY BIT IN DCBOFLGS INDICATES ENTRY FROM PROBLEM            * 05512102
*              DETERMINATION.                                         * 05512502
*        SPOOLED BITS IN TIOT INDICATES ENTRY FROM IFG0551F.          * 05512902
*                                                                     * 05513302
* OUTPUT =                                                            * 05563302
*        RESUME PSW IN SVRB POINTING TO EODAD ADDRESS. REGISTERS IN   * 05565302
*        THE SVRB HAVE ALREADY BEEN SWAPPED TO BE THE USER'S REGS.    * 05565403
*        REGISTERS AT EXIT TO USER'S EODAD ROUTINE -                  * 05565503
*            0-1 - RESERVED                                           * 05565603
*           2-13 - CONTENTS BEFORE EXECUTION OF GET, CHECK, FEOV, OR  * 05565703
*                  EOV (EXCP)                                         * 05565803
*             14 - RETURN ADDRESS FOR GET OR CHECK MACRO INSTRUCTION, * 05565903
*                  OR CONTENTS BEFORE EXECUTION OF FEOV OR EOV (EXCP) * 05566003
*             15 - RESERVED                                           * 05566103
*        EOV WORKAREA AND ALL OTHER WORKAREAS FREED.                  * 05566403
*        USER DCB UPDATED FROM PROTECTED DCB.                         * 05566502
*              EODAD EXIT                                             * 05567302
*        REGISTER 2 POINTS TO COPIED DCB                              * 05573302
*              IFG0551L                                               * 05583302
*              IFG0551F                                               * 05603302
*              IFG0553B                                               * 05605302
*              IFG0552V                                               * 05607302
*        REGISTER 2 POINTS TO USER'S DCB AND                     YM3190 05609302
*        USER DCB UPDATED FROM PROTECTED DCB.                    YM3190 05609702
*              IGC00020 (ENTRY POINT IGC01020)                        * 05611302
*        REGISTER 4 POINTS TO EOV WORKAREA AND CONTROL PASSED         * 05611702
*        IN PROTECT KEY 5                                             * 05611802
*              ALL MODULES TRANSFERRED CONTROL                        * 05612102
*        DXRETMOD INDICATING RETURN MODULE ID FOR IFG0552X OR         * 05612502
*        IFG0552V                                                     * 05612802
*              IFG0553B                                               * 05612902
*        DXRETCOD INDICATING RETURN CONTENTS OF REGISTER 14           * 05613102
*              IFG0553B - 4                                           * 05613202
*        REGISTER 0 CONTAINING INTERNAL ABEND CODE                    * 05639902
*              IFG0550P                                               * 05641902
*        DEBDCBAD POINTING TO USER DCB                                * 05646302
*              IFG0551L                                               * 05646402
*              IGC00020 (ENTRY POINT IGC01020)                        * 05646502
*        DXDSABAD, DXDSAB, DXTIOTAD, DEB EXTENSION DSAB ADDRESS       * 05652102
*        UPDATED TO NEXT CONCATENATED DATA SET                        * 05654102
*              IFG0551F                                               * 05656102
*        DCBOCON BIT SET IN DCBOFLGS INDICATING CONCATENATION         * 05656902
*              IFG0551F                                               * 05657302
*              IFG0552V                                               * 05657402
*              IGC00020 (ENTRY POINT IFG01020)                        * 05657502
         EJECT                                                          05657702
* EXIT-NORMAL = IFG0551L SAM EOV EXECUTOR, TO COMPLETE UR CONCAT.     * 05663302
*               IGC00020 (ENTRY POINT IGC01020) FOR UNLIKE ATTRUBUTES * 05723302
*               CONCATENATION, OR IF THE IGNORE OPTION WERE CHOSEN    * 05733302
*               FROM AN EOV ABEND EXIT.                               * 05753302
*               IFG0551F INITIAL READ JFCB OR CONCAT. OF LIKE ATTRIB. * 05763302
*               IFG0553B SMF RECORD PROCESSING                        * 05813302
*               IFG0552V TAPE INPUT VOLUME POSITIONING                * 05863302
*               RETURN TO CALLER                                      * 05913302
*                                                                     * 05963302
* EXIT-ERROR =                                                        * 06013302
*        IFG0550P PROBLEM DETERMINATION WITH ONE OF THE FOLLOWING     * 06073302
*        INTERNAL ABEND CODES IN REGISTER 0                           * 06123302
*                                                                     * 06173302
*        174-CAUSING 337-04 ABEND, NO FOUNDATION EXTENSION IN EXCP    * 06223302
*        DCB OR NO EODAD ROUTINE AT END OF DATA.                      * 06233302
*                                                                     * 06243302
*        176-CAUSING 637-0C ABEND, CONCATENATION OF UNLIKE DEVICES    * 06253302
*        AND THE UNLIKE ATTRIBUTES BIT NOT SET IN THE DCBOFLGS.       * 06255302
*                                                                     * 06263302
* EXTERNAL REFERENCES = SEE BELOW                                     * 06313302
*                                                                     * 06363302
*    ROUTINES =                                                       * 06413302
*        IFG019RA THROUGH THE IECRES MACRO.                           * 06423302
*                                                                     * 06463302
*    DATA AREAS =                                                     * 06513302
*        EOV WORKAREA.                                                * 06523302
*                                                                     * 06563302
*    CONTROL BLOCK =                                                  * 06613302
*        CVT                                                          * 06623302
*        TCB                                                          * 06633302
*        SVRB                                                         * 06643302
*        DCB                                                          * 06653302
*        TIOT                                                         * 06655302
*        DEB                                                          * 06657302
*        DEB EXTENSION                                                * 06659302
*        DSAB                                                         * 06661302
*        UCB                                                          * 06661702
*        VDSCB                                                        * 06662102
         EJECT                                                          06663302
* TABLES =                                                            * 06713302
*        NONE.                                                        * 06723302
*                                                                     * 06763302
* MACROS =                                                            * 06813302
*        MODESET                                                      * 06823302
*        SETLOCK                                                      * 06833302
*        DMABCOND                                                     * 06843302
*        WICLOSE                                                      * 06853302
*        IECRES LOAD                                                  * 06855302
*        IECRES INIT                                                  * 06857302
*        IECRES FREE                                                  * 06859302
*        IECRES EXIT                                                  * 06861302
*        XCTLTABL                                                     * 06861702
*        IECDSECS                                                     * 06862102
*        IECEQU                                                       * 06862502
*                                                                     * 06863302
* CHANGE ACTIVITY =                                                   * 06913302
*        SEE 'CHANGES/DELETIONS' SECTION JUST AFTER CSECT CARD        * 06923302
*                                                                     * 06963302
*********************************************************************** 07063302
         EJECT                                                          07113302
*                                                                       21400021
*****    INTERNAL ERROR CODES                                           21500021
*                                                                       21600021
EABD174  EQU   174                      NO EOD ADDRESS WAS PROVIDED     21700021
EABD176  EQU   176                      CONCATENATION OF DATA SETS WITH 21800021
*                                       ..LIKE ATTRIBUTES WAS SPECIFIED 21900021
*                                       ..BUT UNLIKE DEV WERE ALLOCATED 22000021
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        22100021
         USING *,RBASE                                                  22200021
*                                                                       22300003
         USING FORCORE,RCORE                                            22400021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 22450002
         USING TIOENTRY,RTIOT                                           22600021
         USING DEBBASIC,RDEB                                     Y02134 22700002
         USING IHADCB,RDCB                                              22800021
         USING UCB,RUCB                                                 22900021
*                                                                       23000021
*****          POINT TO THE SVRB FOR LATER PROCESSING                   23100021
*                                                                       23200021
         L     RC,CVTPTR                LOAD ADDRESS OF CVT      M0017  23260021
         USING CVT,RC                   ESTABLISH CVT BASE ADDR  M0017  23320021
         L     RC,CVTTCBP               LOAD ADDR OF TCB POINTERS       23400021
         DROP  RC                                                M0017  23450021
         L     RC,K4(,RC)               LOAD ADDR OF ACTIVE TCB         23500021
         USING TCB,RC                   ESTABLISH TCB ADDRESSABILITY    23600021
         L     R0,TCBTIO                LOAD TIOT PTR                   23640000
         L     RC,TCBRBP                LOAD ADDRESS OF CURRENT SVRB    23700021
         USING RBSECT,RC                ESTABLISH RB ADDRESSABILITY     23800021
         TM    DCBMACRF,DCBMEXCP        EXCP ACCESS METHOD              23808000
         BO    ECM60050                 YES BYPASS SPOOL TEST           23812000
         LH    RTIOT,DCBTIOT            GET TIOT OFFSET          Y02120 23816002
         AR    RTIOT,R0                 GET TIOT ENTRY           Y02120 23816402
         TM    TIOELINK,TIOESYIN+TIOESYOT  SPOOLED DCB?          Y02120 23816503
         BZ    ECM60050                 NO, CONTINUE NORMAL PROCESS     23820000
         OI    DCBOFLGS,DCBOBUSY        SET BUSY BIT ON                 23868000
         L     RDCB,DXUDCBAD            USER DCB ADDRESS         YM7883 23870002
         MODESET KEYADDR=DXUKEY,WORKREG=10 ASSUME USER KEY       YM7883 23872002
         OI    DCBOFLGS,DCBOBUSY        SET BUSY BIT ON          YM7883 23874002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM7883 23876002
         L     RDCB,DXPDCBAD            DCB COPY ADDRESS         YM7883 23878002
         SR    RUCB,RUCB                SET UCB REG TO 0                23880000
         B     ECM60400                 BR TO CONTINUE                  23892000
         EJECT                                                          23894002
*                                                                       23900021
*****          DETERMINE TYPE OF ENTRY TO MODULE IF NOT SPOOLED         24000002
*                                                                       24100021
ECM60050 EQU   *                        SEE IF PROBLEM DETERMINATION    24140002
*                                       ENTRY - IGNORE ABEND PROCESSING 24192002
         TM    DCBOFLGS,DCBOBUSY        TEST FOR ENTRY FROM PROBLEM     24200021
*                                       ..DETERMINATION FUNCTION-       24300021
         BO    ECM60100(RET)            ..BR IF NO TO CONTINUE   YM3970 24400002
         L     RDEB,DCBDEBAD            GET DEB ADDRESS          YM3970 24450002
         OI    DCBOFLGS,DCBOBUSY        TURN ON THE BUSY BIT   @ZA06440 24550003
         NI    DCBOFLGS,ALLBITS-DCBOCON TURN OFF CONCAT BIT    @ZA06440 24650003
         B     ECM61800                 BRANCH TO CLOSE DCB      YM3970 24900002
*                                                                       24950002
ECM60100 EQU   *                        BRANCH TABLE                    25000002
         B     ECM60200                 0-BR IF ENTERED TO PROCESS EOF  25100002
         B     ECM61200                 4-RETURN FROM SMF MODULE Y02134 25200002
         B     *                        NEVER ENTERED. WAS ENTRY TRACE  25300002
*                                       ..TERMINATION MODULE            25400021
         B     *                        NEVER ENTERED. WAS ENTRY Y02082 25450002
*                                       FOR ANSI HEADER MSG      Y02082 25500002
         B     ECM61600                 16-BR IF ENTERED FOR     M0015  25630002
*                                       ..UNIT RCD CONCATENATION M0015  25660021
         EJECT                                                          25698002
*                                                                       25700021
*********************************************************************** 25800021
*              END-OF-FILE FROCESSING                                 * 25900021
*********************************************************************** 26000021
*                                                                       26100021
ECM60200 EQU   *                        REG 14 = 0 ENTRY POINT          26200002
*               TURN ON DEB EOF INDICATORS                       Y02080 26250002
         OI    DEBOFLGS,DEBOFEOF                                 Y02080 26700002
*    INDICATE THAT DEFERRED USER LBL PROCESSING CAN TAKE PLACE   Y02080 26750002
         OI    DEBFLGS1,DEBF1EOF                                 Y02080 26800002
         TM    DCBMACRF,DCBMEXCP        IS EXCP BEING USED?             27040000
         BO    ECM60400                 ..BRANCH IF NOT                 27060000
         TM    DCBCIND2,DCBC2FEO        IS THIS AN FEOV ENTRY-          27100021
         BNO   ECM60400                 ..BR IF NOT FEOV                27200021
*               TURN OFF DEB EOF INDICATORS                      Y02080 27250002
         NI    DEBOFLGS,X'FF'-DEBOFEOF                           Y02080 27300002
         NI    DEBFLGS1,X'FF'-DEBF1EOF                           Y02080 27400002
*                                                                       27500021
*****          TEST FOR CONCATENATED DATA SETS                          27600021
*                                                                       27700021
ECM60400 EQU   *                        SPOOLED DCB ENTRY               27800002
         L     R1,DXDSABAD              GET CURRENT DSAB         Y02134 27900002
         USING DSAB,R1                                           Y02134 27950002
         L     R1,DSABFCHN              GET NEXT (CONCATENATED?) Y02134 28000002
*                                       DSAB                            28050002
         LTR   R1,R1                    IS THERE ANOTHER ONE?    Y02134 28100002
         BZ    ECM60500                 NO MORE-NO CONCATENATION Y02134 28150002
         L     R1,DSABTIOT              GET NEXT TIOT ENTRY      Y02134 28200002
         LR    RD,R1                    SAVE NEXT TIOT ENTRY     Y02134 28250002
         CLI   TIOEDDNM-TIOENTRY(R1),BLANK TEST FOR A BLANK DDNAME      28400021
         BE    ECM60850                 ..BR IF BLANK- CONCAT    Y02083 28500002
         EJECT                                                          28600021
*********************************************************************** 28700021
*              END-OF-DATA PROCESSING                                 * 28800021
*********************************************************************** 28900021
*                                                                       29000021
ECM60500 EQU   *                        ABEND IF NO EODAD               29100002
         NI    DXATALL,X'FF'-DXATFC     RESET FORCE CLOSE INDIC  YM7099 29150002
         LA    R0,EABD174               LOAD INTERNAL ERROR CODE        29200003
         TM    DCBMACRF,DCBMEXCP        IS THE ACCESS METHOD EXCP-      29300021
         BZ    ECM60600                 ..BRANCH IF NOT                 29400021
         TM    DCBMACRF,DCBMFOUN        IS FOUNDATION EXT PRESENT-      29500021
         BZ    ECM62800                 ..BR IF NOT TO ERROR RTN        29600021
ECM60600 EQU   *                        IS EODAD SPECIFIED              29700002
         L     RF,DCBEODAD              LOAD ADDRESS OF EODAD RTN       29800021
         LA    RF,0(,RF)                CLEAR THE HIGH-ORDER BYTE       29900021
         CH    RF,HALFWD1               IS THERE AN EODAD RTN ADDR-     30000021
         BE    ECM62800                 ..BR IF NOT TO ERROR RTN        30100021
         TM    DCBMACRF,DCBMEXCP        IS THE ACCESS METHOD EXCP-      30200021
         BO    ECM60700                 ..BRANCH IF YES                 30300021
         TM    DCBCIND2,DCBC2QSM        IS THE ACCESS METHOD QSAM-      30400021
         BZ    ECM60650                 ..BR IF NO-BSAM DOESN'T YA02398 30500002
*                                       ..REQUIRE THE FOLLOWING INST    30600021
         TM    TIOELINK,TIOESYIN+TIOESYOT  TEST FOR SPOOLED      Y02120 30650003
         BM    ECM60700                 BRANCH IF SPOOLED        Y02120 30660002
         L     RF,DCBIOBA               LOAD IOB ADDRESS FROM DCB       30700021
         MODESET KEYADDR=DXUKEY,WORKREG=1 USER KEY FOR IOB       Y02082 30750002
         L     RF,K0(,RF)               LOAD ADDRESS OF NEXT IOB        30800021
         MVI   K4(RF),PUTCCODE          INDICATE IN SECOND IOB THAT     30900021
*                                       ..EODAD EXIT WAS TAKEN          31000021
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGT KEY   Y02082 31050002
         B     ECM60700                 SET UP EODAD ADDR       YA02398 31052002
         EJECT                                                          31060002
ECM60650 EQU   *                        TEST FOR PS, DA         YA02398 31061002
*                                                                       31062002
*        RESET CURRENT (LAST SCHEDULED) BSAM IOB ADDR TO THE    YA02398 31063002
*        IOB IN ERROR IF MORE THAN ONE IOB, DSORG PS, AND DA.   YA02398 31064002
*        RESET DCBFDAD TO MBBCCHHR OF 'FILE MARK'.              YA02398 31065002
*                                                                       31066002
         TM    DCBDEVT,DCBDEVDA         IS IT DA DEVICE         YA02398 31067002
         BNO   ECM60700                 BRANCH IF NO            YA02398 31068002
         TM    DCBDSORG,DCBORGPS        PHYSICAL SEQUENTIAL     YA02398 31069002
         BNO   ECM60700                 BRANCH IF NOT           YA02398 31070002
         CLI   DCBNCP,K1                IS THERE ONE CHAN PGM   YA02398 31071002
         BNH   ECM60700                 BRANCH IF YES           YA02398 31072002
         L     RD,DCBIOBA               GET LAST SCHED. IOB     YA02398 31073002
         LA    RD,K0(,RD)               CLEAR HIGH BYTE FOR CR  YA02398 31074002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME USER KEY       YA02398 31075002
         L     RUCB,K4(,RD)             GET IOB IN ERROR        YA02398 31076002
         LA    RUCB,K0(,RUCB)           CLARE HIGH BYTE FOR CR  YA02398 31077002
         CR    RUCB,RD                  IS ERROR IOB CURRENT    YA02398 31078002
         BE    ECM60700                 BRANCH IF YES           YA02398 31079002
*                                                                       31080002
*        MOVE ERROR IOB/ICBSEEK TO DCBFDAD                      YM05966 31081002
*                                                                       31082002
         TM    DCBCIND2,DCBC2CHN        CHAINED SCHEDULING      YM05966 31082202
         BZ    ECM60660                 BRANCH IF NO            YM05966 31082402
         LM    R0,R1,K32(RUCB)          GET ICBSEEK IN R0, R1   YM05966 31082602
         B     ECM60670                 UPDATE DCBFDAD          YM05966 31082802
ECM60660 EQU   *                        GET IOBSEEK             YM05966 31082902
         LM    R0,R1,K40(RUCB)          GET IOBSEEK IN R0, R1   YA02398 31083002
ECM60670 EQU   *                        UPDATE DCBFDAD          YM05966 31083202
         MODESET EXTKEY=DATAMGT         RETURN TO D. M. KEY     YA02398 31084002
         STCM  R0,B'1111',DCBFDAD       STICK IN FIRST 4 BYTES  YA02398 31085002
         STCM  R1,B'1111',DCBFDAD+K4    STICK IN LAST 4 BYTES   YA02398 31086002
         ST    RUCB,DCBIOBA             CURRENT IOB = ERROR IOB YA02398 31087002
         LR    RD,RUCB                  ERROR IOB IN RD         YA02398 31088002
         SR    RUCB,RUCB                ZERO RUCB FOR IC        YA02398 31089002
         IC    RUCB,DCBFDAD+K7          GET R FROM FDAD         YA02398 31090002
         LA    RUCB,K1(,RUCB)           INCREMENT R BY 1        YA02398 31091002
         STC   RUCB,DCBFDAD+K7          STORE R+1               YA02398 31092002
         MODESET KEYADDR=DXUKEY,WORKREG=1 GET IN USER KEY       YA02398 31093002
         L     RD,K0(,RD)               GET NEXT IOB            YA02398 31094002
         TM    DCBCIND2,DCBC2CHN        CHAINED SCHEDULING      YM05966 31094202
         BZ    ECM60680                 BRANCH IF NO            YM05966 31094402
         MVC   K32(L'DCBFDAD,RD),DCBFDAD PUT FILE MARK ADDR IN  YM05966 31094602
*                                       NEXT ICB                YM05966 31094702
         B     ECM60690                 CONTINUE                YM05966 31094802
ECM60680 EQU   *                        UPDATE IOBSEEK          YM05966 31094902
         MVC   K40(L'DCBFDAD,RD),DCBFDAD PUT FILE MARK ADDR IN  YA02398 31095002
*                                       NEXT IOB                YA02398 31096002
ECM60690 EQU   *                        GET IOBSEEK             YM05966 31096202
         EJECT                                                          31097002
*                                                                       31100021
*****          SET UP 'EOV' RETURN INDICATOR                            31200021
*                                                                       31300021
ECM60700 EQU   *                        SET EOV RETURN CODE             31400002
         MODESET EXTKEY=DATAMGT         GET IN KEY 5            YA02398 31401002
         SR    RUCB,RUCB                SET THE RETURN CODE TO ZERO     31500021
         CLC   FL1LABI(K3),EOVMARK      WAS ANY LABEL PROCESSED-        31600021
         BNE   ECM60800                 ..BR IF NOT- RETURN CODE EQ 0   31700021
         LA    RUCB,K4(,RUCB)           SET THE RETURN CODE TO 4        31800021
ECM60800 EQU   *                        PUT EODAD ADDRESS IN RESUME PSW 31900002
*                                                                       31950003
         L     RD,RBLINK                LOAD USER'S PRB ADDR FROM SVRB  32000021
         MODESET EXTKEY=SUPR            SUPERVISOR KEY           Y02082 32050002
         MVC   RBOPSW+K5-RBSECT(K3,RD),DCBEODAD+K1  MOVE EOD ADDR INTO  32600002
*                                       ..ADDR PORTION OF OLD PSW       32700021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 32750002
         TM    DCBMACRF,DCBMEXCP        EXCP BEING USED?                32840000
         BO    ECM62000                 ..BRANCH IF YES                 32860000
*                                                                       32860503
*  SET UP REG 14 FOR EODAD EXIT AS GET OR CHECK RETURN ADDR.            32861003
*  ALREADY OK FOR EXCP AND FEOV.                                        32861503
*                                                                       32862003
         TM    DCBCIND2,DCBC2FEO        WAS FEOV ISSUED        @ZA01344 32862503
         BO    ECM60810                 BR IF YES, REG 14 OK   @ZA01344 32863003
         L     RET,RBGRS13              ADDR OF USER SAVE AREA @ZA01344 32863503
         MODESET KEYADDR=DXUKEY,WORKREG=15  ASSUME USER KEY    @ZA01344 32864003
         L     RET,K20(,RET)            COPY REG 14 FROM       @ZA01344 32865003
*                                       USER SAVE AREA         @ZA01344 32866003
         MODESET EXTKEY=SUPR            SVRB KEY               @ZA01344 32867003
         ST    RET,RBGRS14              TO RB RESUME REG 14    @ZA01344 32868003
         MODESET EXTKEY=DATAMGT         RESUME DATA MGT KEY    @ZA01344 32869003
ECM60810 EQU   *                                               @ZA01344 32869203
*                                                                       32869503
         TM    DCBCIND2,DCBC2CHN        CHAINED SCHEDULING      ZA01289 32870002
         BZ    ECM60820                 BRANCH IF NO            ZA01289 32880002
*                                                                       32890002
         L     RD,DCBIOBAD              GET CHAIN SCH IOB       ZA01289 32892002
         MODESET KEYADDR=DXUKEY,WORKREG=1  USER KEY             ZA01289 32894002
         OI    IOBCNOPA-IOBPREFX(RD),ALLOWIO SET TO RESTART I/O ZA01289 32894402
         MODESET EXTKEY=DATAMGT         GET IN KEY 5            ZA01289 32894802
*                                                                       32896002
ECM60820 EQU   *                        CONTINUE EOF            ZA01289 32898002
*                                                                       32898402
         TM    DCBCIND2,DCBC2QSM        IS THE ACCESS METHOD QSAM-      32900021
         BZ    ECM62000                 ..BRANCH IF NOT                 33000021
         OI    DCBIFLGS,DCBIFPIO        TURN ON PERM ERROR IND IN DCB   33100021
         B     ECM62000                 BR TO RETURN TO CALLER          33200021
         EJECT                                                          33201002
*****************************************************************Y02083 33202002
*        CONCATENATION-CHECK FOR CHECKPOINT DATA SET PROCESSING  Y02083 33203002
*****************************************************************Y02083 33204002
*                                                                Y02083 33205002
ECM60850 EQU   *                        CHECKPOINT BIT IN DSAB   Y02083 33205402
         L     R1,DXDSABAD              FETCH CURRENT DSAB ADDR  Y02083 33206002
         TM    DSABFLG4-DSAB(R1),DSABCKDS TEST FOR CHKPT D/S     Y02083 33207002
         BZ    ECM60900                 IF NOT, CONTINUE         Y02083 33208002
         L     R1,DSABFCHN-DSAB(R1)     FETCH NEXT DSAB ADDRESS  Y02083 33209002
         MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 33210002
         OI    DSABFLG4-DSAB(R1),DSABCKDS PROPAGATE CHKPT STATUS Y02083 33211002
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 33212002
*********************************************************************** 33400021
*              CONCATENATED DATA SET PROCESSING                       * 33500021
*********************************************************************** 33600021
*                                                                       33700021
ECM60900 EQU   *                        RESET INDICATOR BITS            33800002
         OI    DCBOFLGS,DCBOCON         TURN ON EOV CONCATENATION IND   33900021
*                                                                       33920000
         TM    DCBOFLGS,DCBOUNLK        TEST FOR UNLIKE ATTRIBUTES-     34000021
         BO    ECM61900                 ..BR IF YES TO CLOSE DCB M0018  34100021
*                                                                       34105003
* TEST FOR JES SPOOLED SYSIN DATA SETS, MUST TREAT AS UNLIKE            34115003
* ATTRIBUTES IF ONE DATA SET IN A CONCATENTATED GROUP IS SPOOLED.       34120003
* NOTE THAT INPUT CONCATENATION TO SYSOUT IS INVALID, BUT               34125003
* IT IS ALLOWED TO SLIP THROUGH AND WILL BE ABENDED IN OPEN.            34130003
*                                                                       34135003
* TEST CURRENT DATA SET FOR SPOOLED INDICATOR                           34140003
         TM    TIOELINK,TIOESYIN+TIOESYOT  IS CURRENT SYSIN OR SYSOUT   34145003
         BM    ECM61900                 BR IF YES TO CLOSE AND OPEN     34150003
* TEST NEXT DATA SET                                                    34155003
         LR    R1,RD                    STEP TO NEXT ENTRY       Y02134 34160003
         TM    TIOELINK-TIOENTRY(R1),TIOESYIN+TIOESYOT  SYSIN OR SYSOUT 34165003
         BM    ECM61900                 BR IF YES TO CLOSE AND OPEN     34170003
*                                                                       34175003
         L     RET,TIOESTTB-TIOENTRY(,R1) LOAD NEXT UCB ADDRESS         34200021
         LA    RET,K0(,RET)             ZERO HIGH BYTE           YM5364 34250002
         LTR   RET,RET                  IS THE NEXT UCB A 'DUMMY'-      34300021
         BNZ   ECM61000                 ..BRANCH IF NOT                 34400021
         NI    DCBOFLGS,X'FF'-DCBOCON   TURN OFF CONCATENATION SWITCH   34500021
         B     ECM60500                 BR TO PROCESS AS EOD            34600021
         EJECT                                                          34700002
*********************************************************************** 34800021
*              PROCESS CONCATENATED DATA SETS WITH LIKE ATTRIBUTES    * 34900021
*********************************************************************** 35000021
*                                                                       35100021
ECM61000 EQU   *                        TURN OFF INDICATOR FOR EOD      35200002
         NI    DEBFLGS1,X'FF'-DEBF1EOF                           Y02080 35250002
         NI    DEBOFLGS,ALLBITS-DEBOFEOF TURN OFF EOF INDIC     ZA00120 35300002
*                                                                       36100003
         LA    R0,EABD176               LOAD INTERNAL ERROR CODE        36200003
         CLC   UCBTBYT3(K1),UCBTBYT3-UCB(RET) TEST FOR UNLIKE DEVICES-  36300021
         BNE   ECM62800                 ..BRANCH IF UNLIKE              36400021
*                                                                       36500021
         TM    UCBTBYT3,UCB3TAPE+UCB3DACC IS THIS A UNIT RECORD DEVICE- 36800021
         BZ    ECM61400                 ..BR IF YES- BYPASS SMF         36900021
*                                                                       36950021
*****          DETERMINE WHETHER OR NOT SMF PROCESSING IS REQUIRED      37000021
*                                                                       37050021
ECM61080 EQU   *                        GO TO SMF MODULE         M1782  37100002
         TM    DXXPATHS,WTGSMF          IS SMF PROCESSING REQ'D- A38013 37600021
         BNO   ECM61200                 ..BR IF NOT TO CONTINUE  A38013 38300021
         LA    RF,MODSMF2X              PT TO SMF MODULE'S NAME         39100021
         LA    RET,K4                   LD BR TABLE OFFSET FOR THAT MOD 39200021
         MVC   DXRETMOD,MOD2X2X         MOVE THIS MODULE'S ID/TTR       39300003
*                                       ..INTO RETURN ADDRESS SAVE AREA 39400021
         TM    UCBTBYT3,UCB3TAPE        IS THIS A TAPE DEVICE-          39500021
         BZ    ECM62300                 ..BR IF NOT TO GO TO SMF MODULE 39600021
         MVC   DXRETMOD,MOD2V2X         MOVE POSITIONING MOD ID/TTR     39700003
*                                       ..INTO RETURN ADDRESS SAVE AREA 39800021
         B     ECM62300                 BR TO LEAVE THIS MOD            39900021
*                                                                       40000021
*****          CONTINUE CONCATENATION FOLLOWING SMF PROCESSING          40100021
*                                                                       40200021
ECM61200 EQU   *                        REG 14 = 4 ENTRY - SMF RETURN   40500002
         LA    RF,MOD2V2X               PT TO POSITIONING MOD ID/TTR    40600021
         SR    RET,RET                  LD BR TABLE OFFSET FOR THAT MOD 40700021
         TM    UCBTBYT3,UCB3TAPE        IS THIS A TAPE DEVICE-          40800021
         BO    ECM62300                 ..BR IF YES- GO TO TAPE POS MOD 40900021
         L     RUCB,DXUCBADR            LOAD CURRENT UCB ADDRESS Y02134 41000002
         EJECT                                                          41050002
*****************************************************************Y02134 41150002
*                                                                Y02134 41200002
*        DECREMENT DATA MANAGEMENT COUNT                         Y02134 41250002
*                                                                Y02134 41300002
*****************************************************************Y02134 41500002
*                                                                Y02134 41550002
         L     R0,UCBOB+(((UCBDMCT-UCBOB)/K4)*K4) ALLIGN & LOAD  Y02134 41700002
*                                                                Y02134 41750002
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 41800002
*                                                                Y02134 41810002
         L     RF,DXXPREFX              LOAD PREFIX POINTER      Y02134 41812002
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE 15 REGS          Y02134 41814002
*                                                                Y02134 41816002
ECM61300 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02134X41820002
               RELATED=(LOCAL,IFG0552X(ECM61380))                Y02134 41830002
*                                                                Y02135 41840002
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 41842002
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGS          Y02134 41844002
         BZ    ECM61320                 BRANCH, NO ERROR         Y02134 41846002
*                                                                Y02134 41848002
         DMABCOND PCK,SETLOCK           SETLOCK ERROR            Y02134 41848402
*                                                                Y02134 41850002
ECM61320 EQU   *                        DECREMENT COUNT          Y02134 41900002
*                                                                Y02134 41950002
         LR    RF,R0                    SAVE CS OPERAND          Y02134 42000002
         SLL   RF,K25                   LEAVE ONLY UCBDMCT COUNT Y02134 42050002
         LTR   RF,RF                    TEST FOR COUNT OF 0      Y02134 42100002
         BZ    ECM61340                 BRANCH IF ALREADY 0      Y02134 42150002
*                                                                Y02134 42200002
         LR    R1,R0                    LOAD OLD VALUE TO MODIFY Y02134 42250002
         SH    R1,HALFWD1               ADD DECREMENT TO COUNT   Y02134 42300002
         CS    R0,R1,UCBOB+(((UCBDMCT-UCBOB)/K4)*K4) UPDAT COUNT Y02134 42350002
         BNE   ECM61320                 BRANCH IF NOT THE SAME   Y02134 42400002
         OI    DXATEOV,DXATNVOL         INDIC CURR UNIT INACTIVE YM6520 42410002
         EJECT                                                          42450002
ECM61340 EQU   *                        LOCAL LOCK STILL HELD    Y02134 42460002
*                                                                       42461002
*        WICLOSE VIO UNIT IF D. M. COUNT NOW ZERO                Y02132 42462002
*                                                                       42470002
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         Y02134 42470402
         BNO   ECM61360                 BRANCH IF NOT VIO        Y02134 42470802
*                                                                Y02134 42471202
         TM    UCBDMCT,UCBDMC           TEST FOR ANY USERS       Y02134 42471602
         BNZ   ECM61360                 BRANCH IF STILL IN USE   Y02134 42471702
         L     RD,DXXPREFX              LOAD SAVE AREA POINTER   Y02134 42474202
         LA    RD,IECREGSV-IECPREFX(,RD) PT TO REGSAVE AREA      Y02132 42474302
         LA    R1,VDSUCB-VDSCB(,RUCB)   GET VDSCB POINTER        Y02134 42474402
*                                                                Y02134 42474502
         WICLOSE VDSCB=(1)              CALL VIO CLOSE           Y02134 42474802
*                                                                Y02134 42475602
ECM61360 EQU   *                        RELEASE LOCK             Y02134 42475702
*                                                                Y02134 42475902
         L     RF,DXXPREFX              LOAD PREFIX POINTER      Y02134 42476302
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE 15 REGS          Y02134 42476702
*                                                                Y02134 42477102
ECM61380 SETLOCK RELEASE,TYPE=LOCAL,                             Y02134X42478002
               RELATED=(LOCAL,IFG0552X(ECM61300))                Y02134 42478402
*                                                                Y02135 42478802
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 42479202
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGS          Y02134 42479602
         BZ    ECM61390                 BRANCH, NO ERROR         Y02134 42479702
*                                                                Y02134 42479902
         DMABCOND PCK,SETLOCK           SETLOCK ERROR            Y02134 42480002
*                                                                Y02134 42483202
ECM61390 EQU   *                        RETURN TO DM KEY         Y02134 42485202
*                                                                Y02134 42485602
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 42486702
*                                                                Y02134 42490002
         EJECT                                                          42494002
*                                                                M0071  42500021
*****          INITIALIZE DCB AND DEB FOR NEW DATA SET           M0071  42550021
*                                                                M0071  42600021
         SR    RD,RD                    CLEAR WORK REGISTER             42700021
         IC    RD,DEBNMEXT              LOAD TOTAL NO. OF EXTENTS       42800021
         SLL   RD,K4                    CALC LENGTH OF THESE EXTENTS    43000021
         AR    RD,RDEB                  ..AND ADD DEB BASE ADDRESS      43100021
         MVI   DEBBASND-DEBBASIC+(DEBVOLSQ-DEBACSMD)+K1(RD),K1   Y02134 43200002
*                                       SET DEB VOLUME SEQ. TO 1 Y02134 43220002
*                                                                       43250003
ECM61400 EQU   *                        GET CURRENT DSAB ADDRESS        43300002
         L     R1,DXDSABAD              GET CURRENT DSAB         Y02134 43420002
         USING DSAB,R1                                           Y02134 43440002
*                                                                       43860002
*   CHAIN TO NEXT DSAB: UPDATE WORKAREA POINTERS, DCB,DEB, DEBX  Y02134 43880002
*                                                                       43900002
         L     R1,DSABFCHN              GET NEXT DSAB            Y02134 43920002
         ST    R1,DXDSABAD              STORE IN WORKAREA        Y02134 43940002
         ST    R1,DXDSAB                CURRENT DSAB ADDR        Y02134 43960002
         L     RTIOT,DSABTIOT           NEW TIOT ENTRY ADDR      Y02134 43980002
         ST    RTIOT,DXTIOTAD           STORE IN WORKAREA        Y02134 44000002
         L     RUCB,TIOESTTB            GET FIRST UCB ADDR       YM5741 44050002
         LA    RUCB,K0(,RUCB)           CLEAR HIGH BYTE          YM5741 44060002
         ST    RUCB,DXUCBADR            UPDATE UNIT ADDRESS      YM5741 44070002
         L     RF,DXDEBXAD              GET DEB EXTENSION        Y02134 44080002
         USING DEBXTN,RF                                         Y02134 44100002
         MVC   DEBXDSAB,DXDSABAD        UPDATE DEB EXTENSION'S   Y02134 44120002
*                                       DSAB ADDRESS             Y02134 44140002
         DROP  RF                                                Y02134 44160002
         L     RF,DXTCBADR              GET CURRENT TCB ADD      Y02134 44180002
         L     RF,TCBTIO-TCB(RF)        START OF TIOT ADDRESS    Y02134 44200002
         SR    RTIOT,RF                 NEW TIOT ENTRY OFFSET    Y02134 44220002
         STH   RTIOT,DCBTIOT            STORE IN DCB             Y02134 44240002
         L     RTIOT,DXTIOTAD           RESTORE TIOT ADDRESS     Y02134 44260002
         MODESET EXTKEY=SCHED           ASSUME SCHED KEY         Y02082 44650002
         OI    DSABFLG2,DSABOPEN        SET OPEN BIT IN DSAB     Y02134 44680002
         MODESET EXTKEY=DATAMGT         ASSUME DATA MGT KEY      Y02082 44730002
         LA    RF,MOD1F2X               PT TO INITIAL MODULE'S ID/TTR   44900021
         LA    RET,K8                   BR TABLE ENTRY           YM5364 45000002
         B     ECM62300                 BR TO RETURN TO INITIAL ROUTINE 45100021
*                                       ..TO INITIALIZE WORK AREA FOR   45200021
*                                       ..CONCATENATED DCB              45300021
         EJECT                                                          45350002
*                                                                       45400021
*****          RETURN FROM THE INITIAL ROUTINE- COMPLETE PROCESSING     45500021
*****          ON UNIT RECORD CONCATENATION                             45550002
*****          AND RETURN TO THE CALLER OR THE ACCESS METHOD EXECUTOR   45600021
*                                                                       45700021
ECM61600 EQU   *                        REG 14 = 16 ENTRY               45800002
         NI    DEBOFLGS,X'FF'-DEBOFEOF  RESET DEB EOF INDICATOR         45900021
         L     RTIOT,DXTIOTAD           GET CURRENT TIOT ENTRY   YM1278 45950002
         MVC   DEBSUCBA+K1(L'TIOEFSRT),TIOEFSRT PLACE NEW UNIT   YM1278 45960002
*                                       ADDRESS IN DEB           YM1278 45970002
         NI    DCBOFLGS,X'FF'-DCBOCON   CLEAR CONCATENATION INDICATOR   46100021
         TM    DCBMACRF,DCBMEXCP        IS THE ACCESS METHOD EXCP-      46200021
         BO    ECM62000                 ..BR IF YES TO RETURN TO CALLER 46300021
         MVC   DXXMODID,MOD1L2X         MOVE ACCESS METHOD EXECUTOR     46400003
*                                       ..ID INTO WTG TABLE      Y02080 46500002
         MVC   DXXMODEP+K1(K3),MOD1L2X+K2 MOVE ACCESS METHOD EX. Y02080 46550003
*                                       ..EPA INTO WTG TABLE     Y02080 46560002
         B     ECM62200                 BR TO XCTL TO A/M EXECUTOR      46600002
         EJECT                                                          47800002
*                                                                       47920021
*********************************************************************** 47940021
*              MODIFY THE USER'S RESUME PSW SO THAT AN 'EXIT' IS TO   * 47960021
*              TO THE USER RATHER THAN AN ACCESS METHOD MODULE        * 47980021
*********************************************************************** 48000021
*                                                                       48020021
ECM61800 EQU   *                        BUSY BIT OFF ENTRY/RETURN       48040002
*                                       FROM IFG0554J ENTRY             48054002
         TM    DCBMACRF,DCBMEXCP        IS THIS AN EXCP DCB-     A45247 48060021
         BO    ECM61900                 ..BR IF YES- RESUME PSW  A45247 48080021
*                                       ..ADDRESS IS CORRECT     A45247 48100021
         TM    DCBCIND2,DCBC2FEO        WAS FEOV ISSUED-         A45247 48120021
         BO    ECM61900                 ..BR IF YES- RESUME PSW  A45247 48140021
*                                       ..ADDRESS IS CORRECT     A45247 48160021
         L     RD,RBLINK                PT TO THE PREVIOUS REQUEST BLK  48300021
         L     RC,RBGRS13               USER SAVE AREA ADDRESS  YA01870 48318002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY      YA01870 48320002
         L     RC,K20(,RC)              REG 14 IN USER SAVEAREA YA01870 48322002
         MODESET EXTKEY=SUPR            SVRB KEY                YA01870 48324002
         STCM  RC,B'0111',RBOPSW+K5-RBSECT(RD) STORE RETURN     YA01870 48326002
*                                       ADDR IN RESUME PSW      YA01870 48328002
         EJECT                                                          48600003
ECM61900 EQU   *                        UNLIKE ATTRIBUTES CONCATENATION 49700002
         MODESET EXTKEY=DATAMGT         ASSUME DATA MGT KEY     YA01870 49702002
         L     RF,DXXPREFX              GET PTR TO PREFIX        Y02082 49999702
         USING IECPREFX,RF              DEFINE WORK AREA PREFIX  Y02080 50049702
         L     R1,IECUPRML              CLOSE PARM LIST PT IN R1 Y02080 50099702
         L     RF,IECRRPRM-IECPREFX(RF) GET ADDR OF RECOVERY     Y02144 50109702
         USING RRPLIST,RF               ESTABLISH BASE           Y02144 50119702
         XC    RRPLIST+K1(K23),RRPLIST+K1  ZERO RECOVERY PARMS   Y02144 50129702
         XC    DXATCOM1(K8),DXATCOM1    EXCEPT RRFUNCTN          Y02144 50139702
         XC    DXATCOM4(K12),DXATCOM4   AND ADDR OF RRPLIST      Y02144 50141702
         DROP  RF                                                Y02080 50149702
*                                                                Y02082 50150102
*****    SET UP FOR ENTRY TO THE 'CLOSE' ROUTINE AT SECONDARY    Y02082 50150502
*****    ENTRY POINT IGC01020.  BIT 7 OF DCBOFLGS IS NOT RESET.  Y02082 50150902
*                                                                Y02082 50151402
         MVC   DXXMODNM(K12),CONLOAD    MOVE MODULE NAME AND EPA Y02082 50153602
         OI    DXATCOM2,DXATCCAT        EOV GOING TO CLOSE       Y02144 50201702
         B     ECM62200                 BR TO GO TO 'CLOSE'      Y02082 51700002
*                                                                Y02082 51710002
         USING UCB,RUCB                 ESTABLISH UCB ADDRESSABILITY    51800021
         EJECT                                                          51900021
*********************************************************************** 52000021
*              EXITS                                                  * 52100021
*********************************************************************** 52200021
*                                                                       52300021
*****          EXIT TO THE USER                                         52400021
*                                                                       52500021
ECM62000 EQU   *                        FREE WORKAREA                   52600002
*                                                                Y02080 52753202
         TM    TIOELINK,TIOESYIN+TIOESYOT  TEST FOR SPOOLED DS   YM1306 52763603
         BM    ECM62050                 AVOID POINTING DEB       YM1306 52764002
*                                                                Y02080 52765202
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXUDCBAD+K1 POINT DEB  Y02082*52766202
                                        TO USER DCB              Y02082 52767202
         L     RF,DXDEBXAD              GET PTR TO DEB EXTN      YM1272 52787202
         NI    DEBXFLG1-DEBXTN(RF),ALLBITS-DEBXCDCB DEB PT USER  YM1272 52797202
ECM62050 EQU   *                        REFRESH USER DCB         Y01018 52817202
         NI    DCBOFLGS,X'FF'-DCBOBUSY  RESET I/O SUPPORT BIT IN DCB    53200021
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,DXXPREFX)          Y02082 53210002
         IECRES FREE,A=(RCORE),PREFIX=EOV RELEASE EOV WORK AREA  Y02080 53250002
         LR    RF,RUCB                  PLACE RET CODE IN REG 15 (ONLY  53260002
*                                       ..MEANINGFUL FOR THE EOD EXIT)  53270002
         IECRES EXIT                    RETURN                   Y02080 53460002
         EJECT                                                          53470002
*                                                                Y02080 53490002
*****          XCTL TO THE 'CLOSE' ROUTINES TO CLOSE THE DATA SET       54300021
*                                                                       54400021
ECM62200 EQU   *                        UPDATE DEBDCBAD IF NOT SPOOLED  54500002
         TM    TIOELINK,TIOESYIN+TIOESYOT  CHECK FOR SPOOLED     YM1272 54550003
         BM    ECM62250                 BR IF SPOOLED            YM1272 54560002
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXUDCBAD+K1 POINT DEB  YM1272*54570002
                                        TO USER DCB              YM1272 54580002
         L     RF,DXDEBXAD              GET PTR TO DEB EXTN      YM1272 54590402
         NI    DEBXFLG1-DEBXTN(RF),ALLBITS-DEBXCDCB DEB PT USER  YM1272 54590802
ECM62250 EQU   *                        ENTER CLOSE              YM1272 54591202
*                                                                       54591602
*        COPY BACK PROTECTED DCB TO USER DCB TO UPDATE THE       YM3190 54642002
*        USER DCB WITH THE MODIFICATIONS MADE TO IT BY EOV,      YM3190 54692002
*        SUCH AS THE CONCATENATION BIT IN DCBOFLGS               YM3190 54694002
*                                                                       54696002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(0,14,DXXPREFX)          YM3190 54698002
*                                                                       54698802
*        GIVE CLOSE CONTROL                                      YM3190 54699202
*                                                                       54699602
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               YM3190 54699702
         EJECT                                                          54700002
*                                                                       54800021
*****          XCTL TO ANOTHER END-OF-VOLUME MODULE                     54900021
*                                                                       55000021
ECM62300 EQU   *                        GO TO NEXT MODULE               55100002
         IECRES LOAD,MODID=(RF),BRCODE=(RET),BRANCH=QUEUED       Y02080*55250002
                                     INVOKE IECRES MACRO TO XCTL Y02080 55260002
         SPACE 2                                                        55300002
*                                                                       61200002
*****          ERROR PROCESSING EXIT                                    61300002
*                                                                       61500021
ECM62800 EQU   *                        GO TO PROBLEM DETERMINATION     61600002
         DMABCOND (0),ABEND2X           INVOKE ERROR PROCESSING RTNS    61700003
         EJECT                                                          61800002
*********************************************************************** 61900021
*              CONSTANTS                                              * 62000021
*********************************************************************** 62100021
*                                                                       62200021
HALFWD1  DC    H'1'                     EXIT LIST AND DM COUNT   Y02132 62300002
EOVMARK  DC    C'EOV'                   END-OF-VOLUME LABEL IDENTIFIER  62700021
         EJECT                                                          63900021
*********************************************************************** 64000021
*              XCTL TABLE                                             * 64100021
*********************************************************************** 64200021
*                                                                       64300021
XCTLTB2X XCTLTABL ID=(ABEND2X,0P,MOD1F2X,1F,MOD1L2X,1L,MOD2V2X,2V,     C64530000
               MOD2X2X,2X,MODSMF2X,3B,CONLOAD,IGC01020),         Y02082C64540002
               SVC=055,BRT=YES,LENGTH=                           Y02082 64542002
         SPACE 2                                                        64600021
         IECDSECS CVT,                                                 C64700021
               TCB,                                                    C64800021
               RB,                                                     C64900021
               TIOT,                                                   C65000021
               DCB,                                                    C65200021
               IEZDEB,                                           Y02134*65300002
               UCB,                                                    C65400021
               (MAIN,(IOB,NO)),                                 ZA01289X65500002
               IOB,                                             ZA01289X65550002
               WTG,                                                    C65600021
               DSAB,                                             Y02134*65620002
               PREFX,                                            Y02080*65650002
               PSA,                                              Y02132*65650202
               RRPL,                                             Y02144*65660202
               EXPAND=YES                                               65700021
         IDDVDSCB                                                Y02132 65700202
ALLOWIO  EQU   X'80'                    ALLOW CHAINED SCHED I/O ZA01289 65932002
         IECEQU IEZDEB=YES                                       Y02134 65950003
         END                                                            66100021
./  ADD  SSI=63090531,NAME=IFG0553C
         TITLE 'IFG0553C                      MICROFICHE NAME FOR EMODVO00050002
               OL1 - LABEL EDITOR ROUTINE'                       Y02134 00060002
IFG0553C CSECT                                                          00150002
         ENTRY EMODVOL1                                          Y02080 00200002
EMODVOL1 EQU   IFG0553C                 ALLIAS ENTRY POINT       Y02080 00250002
*                                                                Y02134 00260002
*********************************************************************** 00262002
*            VS2 RELEASE 3 ADDITIONS/DELETIONS                        * 00264037
*0000                                                         @ZA11116* 00264637
*            VS2 SU32 DELETIONS                                       * 00264832
*                                                              @G32DSMI 00265032
*********************************************************************** 00265237
* MODULE NAME = IFG0553C (OS/VS2)                                     * 00266002
*                                                                     * 00268002
* DESCRIPTIVE NAME = EMODVOL1 - STANDARD LABEL EDITING ROUTINE        * 00270002
*                                                                     * 00272002
* COPYRIGHT = NONE                                                    * 00274002
*                                                                     * 00276002
* STATUS = RELEASE 2, LEVEL 0                                         * 00278002
*                                                                     * 00280002
* FUNCTION =                                                          * 00282002
*                                                                     * 00284002
*        REGISTERS ARE INITIALIZED FROM REG 5 & 6 TO PROCESS EACH DCB * 00286002
*        THAT REQUIRES LABEL PROCESSING AS INDICATED BY JFCBMASK+5    * 00288002
*        NOTE - FOR EOV THERE IS ONLY ONE DCB                         * 00288402
*                                                                     * 00290002
*        1. DETERMINES PROCESSING TO BE PERFORMED:                    * 00292002
*           A. FOR SPECIFIC REQUESTS - SETS REJECT VOLUME INDICATOR   * 00294002
*           ON (UCBDMCT BIT 0) AND GOES TO PROCESS NEXT DCB. IF       * 00296002
*           THE LABEL IS CHANGED ON A TAPE WHICH IS SPECIFICALLY      * 00298002
*           REQUESTED, THIS MAY CAUSE PROBLEMS IN SUBSEQUENT          * 00300002
*           STEPS WHICH REFER TO THE TAPE BY ITS ORIGINAL LABEL.      * 00302002
*                                                                     * 00304002
*           B. FOR NON-SPECIFIC REQUESTS - CHECKS FOR LABEL OR        * 00306002
*           DENSITY CONFLICTS;                                        * 00308002
*                                                                     * 00310002
*           C. IF A LABEL CONFLICT EXISTS AND A SL IS TO BE           * 00312002
*           DESTROYED, WRITES A TAPE MARK, RESETS THE LABEL           * 00314002
*           DESTROY BIT JFCSLDES IN THE JFCBMASK+5 FIELD,             * 00316002
*           AND GOES TO PROCESS THE NEXT DCB.                         * 00318002
*                                                                     * 00320002
*           D. IF A LABEL CONFLICT EXISTS AND A SL IS TO BE           * 00322002
*           CREATED, CREATES A VOL1 LABEL, RESETS THE LABEL           * 00324002
*           CREATE BIT JFCSLCRE IN THE JFCBMASK+5 FIELD,              * 00326002
*           AND GOES TO PROCESS THE NEXT DCB.                         * 00328002
*                                                                     * 00330002
*           E. FOR DENSITY CONFLICTS, RESOLVES THE DENSITY            * 00332002
*           CONFLICT, RESETS THE DENSITY CONFLICT BIT                 * 00334002
*           JFCDUAL IN THE JFCBMASK+5 FIELD,                          * 00336002
*           AND GOES TO PROCESS THE NEXT DCB.                         * 00338002
*                                                                     * 00340002
*           F. IF A SITAUTION IS ENCOUNTERED WHERE IT BECOMES         * 00342002
*           DESIREABLE TO HAVE A NEW TAPE MOUNTED, SET THE            * 00344002
*           UCBMOUNT BIT IN THE UCBDMCT FIELD OF THE UCB.             * 00346002
*                                                                     * 00348002
* NOTES = IF THE JFCSLDES BIT IS NOT RESET IN THE JFCBMASK+5          * 00350002
*         THE LABEL ON THE TAPE WILL BE DESTROYED                     * 00352002
*         WHEN YOU RETURN TO IGG0550P.                                * 00354002
*       * IF THE JFCSLCRE BIT IS NOT RESET IN THE JFCBMASK+5          * 00356002
*         A LABEL WILL BE CREATED ON THE TAPE                         * 00358002
*         WHEN YOU RETURN TO IGG0550P.                                * 00360002
*       * IF THE JFCDUAL BIT IS NOT RESET IN THE JFCBMASK+5           * 00362002
*         THIS ROUTINE WILL NOT BE REENTERED IF A SUBSEQUENT          * 00364002
*         DENSITY CONFLICT OCCURS IN LABEL VERIFICATION.              * 00366002
*       * THE LABELS ARE ALWAYS REWRITTEN AT THE DENSITY              * 00368002
*         INDICATED IN THE DXDEBMOD FIELD OF THE WORK AREA.           * 00370002
*       * BOTH JFCSLDES AND JFCSLCRE MAY BE ON IF SWITCHING           * 00372002
*         FROM SL TO AL OR AL TO SL.                                  * 00374002
*       * THIS MODULE IS A DUPLICATE FOR OMODVOL1.                    * 00374402
*       * **NOTE** IGG0550P WILL CHECK FOR PASSWORD PROTECTION @G32DSMI 00374632
*         OR RACF PROTECTION ON THE TAPE PRIOR TO PERFORMING   @G32DSMI 00374932
*         THE LABEL EDITING ACTION REQUESTED. A SECURITY       @G32DSMI 00375232
*         FAILURE WILL CAUSE NO EDITING ACTION TO OCCUR.       @G32DSMI 00375532
*                                                                     * 00376002
*    DEPENDENCIES =                                                   * 00378002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 00380002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 00382002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 00384002
*            THIS ROUTINE USES REGISTER CONVENTIONS AND WORK AREAS    * 00386002
*            DEFINED FOR OPEN/CLOSE/EOV ROUTINES.                     * 00388002
*            OPEN/CLOSE/EOV DEPEND ON THIS ROUTINE FOR UPHOLDING      * 00390002
*            THE SECURITY AND THE INTEGRITY OF THE MACHINE.           * 00392002
*                                                                     * 00394002
*    RESTRICTIONS = NONE                                              * 00396002
*                                                                     * 00398002
*    REGISTER CONVENTIONS =                                           * 00400002
*            R2 POINTS TO DCB                                         * 00402002
*            R4 POINTS TO OPEN WORK AREA                              * 00404002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 00406002
*            R6 POINTS TO THE WTG TABLE                               * 00408002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 00410002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 00412002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 00414002
*            R10 POINTS TO THE UCB                                    * 00416002
*                                                                     * 00418002
*    PATCH LABEL = SEE NEXT TO LAST LABEL BEFORE ORG STATEMENT AT END * 00420002
*                  OF LISTING.                                        * 00422002
*                                                                     * 00424002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 00426002
*                                                                     * 00428002
*    PROCESSOR = ASSEMBLER XF                                         * 00430002
*                                                                     * 00432002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 00434002
*                  ORG STATEMENT AT END OF LISTING                    * 00436002
*                                                                     * 00438002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 00440002
*                 PRIVILEGED, SUPERVISOR STATE, KEY 0,                * 00442002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 00444002
*                                                                     * 00446002
* ENTRY POINT = IFG0553C                                              * 00448002
*               EMODVOL1                                              * 00450002
*                                                                     * 00452002
*    PURPOSE = TO RESOLVE LABEL AND DENSITY CONFLICTS IN A MANNER     * 00454002
*              APPROPRIATE WITH THE OPERATING CHARACTERISTICS         * 00456002
*              PARTICULAR TO THE INSTALLATION.                        * 00458002
*                                                                     * 00460002
*    LINKAGE = AS FOLLOWS -                                           * 00462002
*        LA    RPAR,PARMLIST            GET PARM LIST POINTER         * 00464002
*        LA    RWTG,WTG                 GET WTG TABLE POINTER         * 00466002
*        MODESET EXTKEY=ZERO            KEY 0                         * 00468002
*        IECRES LOAD,MODNM=EMODVOL1,BRANCH=DIRECT,PREFIX=WTGPREFX     * 00470002
*                                                                     * 00472002
* INPUT = RWTG (REG 6) POINTS TO WTG TABLE,                           * 00474002
*            R2 POINTS TO DCB                                         * 00476402
*            R4 POINTS TO OPEN WORK AREA                              * 00476802
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 00477202
*            R6 POINTS TO THE WTG TABLE                               * 00477602
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 00477702
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 00477802
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 00477902
*            R10 POINTS TO THE UCB                                    * 00478602
*                                                                     * 00479302
* OUTPUT = THE JFCBMASK+5 BITS MUST BE SET AS STATED ABOVE.           * 00480002
*          UCBDMCT - UCBMOUNT SET ON IF VOLUME DISMOUNT DESIRED.      * 00482002
*                                                                     * 00484002
* EXIT-NORMAL = IGG0550P (IFG0553D) LABEL EDITOR AND DESTROY          * 00486002
*               STANDARD LABEL                                        * 00488002
*                                                                     * 00490002
* EXIT-ERROR = NONE                                                   * 00492002
*                                                                     * 00494002
* EXTERNAL REFERENCES = SEE BELOW                                     * 00496002
*                                                                     * 00498002
*    ROUTINES = IGG0550P,IFG019RA.                                    * 00500002
*                                                                     * 00502002
*    DATA AREAS = WTG TABLE, OPEN WORK AREA.                          * 00504002
*                SEE PARAMETERS OF THE IECDSECS MACRO.                * 00506002
*                                                                     * 00508002
*    CONTROL BLOCK = UCB, JFCB.                                       * 00510002
*                SEE PARAMETERS OF THE IECDSECS MACRO.                * 00512002
*                                                                     * 00514002
* TABLES = SEE XCTLTABL MACRO.                                        * 00516002
*                                                                     * 00518002
* MACROS = IECDSECS,IECEQU,IECRES,XCTLTABL.                           * 00520002
*                                                                     * 00522002
* CHANGE ACTIVITY = NEW RELEASE (LEVEL 0)                             * 00524002
*                                                                     * 00526002
*********************************************************************** 00528002
         EJECT                                                          07000002
*                  SYMBOLIC REGISTER USAGE                              07050002
*                                                                       07100002
*                                                                       07150002
*                  ESTABLISH ADDRESSABILITY                             07200002
         BALR  RBASE,R0                 SET BASE REGISTER               07250002
         USING *,RBASE                                                  07300002
         USING FORCORE,RCORE            WORK AREA                       07350002
         USING WTG,RWTG                 WHERE-TO-GO TABLE        Y02080 07400002
         USING WTGENTRY,RWTGC           RWTGC POINTS TO CURRENT  Y02134 07450002
         USING USERPRML,RPARC           RPARC POINTS TO CURRENT  Y02134 07500002
         USING IHADCB,RDCB              DCB                             07550002
         USING UCBOB,RUCB               UCB                             07600002
         USING TIOENTRY,RTIOT           TIOT ENTRY                      07650002
*                                                                Y02134 07700002
*****************************************************************Y02134 07750002
*                                                                Y02134 07800002
*        INITIALIZE REGISTERS                                    Y02134 07850002
*                                                                Y02134 07900002
*****************************************************************Y02134 07950002
*                                                                Y02134 08000002
         LR    RPARC,RPAR               POINT TO FIRST ENTRY     Y02134 08050002
         LA    RWTGC,DXXENTRY           POINT TO FIRST ENTRY   @ZA11116 08100037
*                                                                Y02134 08150002
EMO01000 EQU   *                        PROCESS DCB IN THIS LOAD Y02134 08200002
*                                                                Y02134 08250002
         CLC   WTGIDTTR(K2),ID3C3C      CHECK IF RIGHT DCB       Y02134 08300002
         BNE   EMO09000                 BRANCH IF ENTRY NOT SAME Y02134 08350002
*                                                                Y02134 08400002
         L     RDCB,DXDCBLST            LOAD DCB POINTER         Y02134 08450002
         L     RCORE,WTGCORE-K1         LOAD WORK AREA POINTER   Y02134 08500002
         L     RTIOT,DXDSAB             LOAD POINTER TO DSAB     Y02134 08550002
         L     RTIOT,DSABTIOT-DSAB(,RTIOT) GET TIOENTRY POINTER  Y02134 08600002
*                                                                Y02134 08650002
*****************************************************************Y02134 08700002
*                                                                Y02134 08750002
*        GET UCB ADDRESS FROM WORK AREA                          Y02134 08800002
*        FIRST ENTRY IN TIOT MAY NOT BE VALID                    Y02134 08850002
*                                                                Y02134 08900002
*****************************************************************Y02134 08950002
*                                                                Y02134 09000002
         L     RUCB,DXUCBADR            GET CURRENT UCB ADDRESS  Y02134 09050002
*                                                                       09100002
*****************************************************************Y02134 09150002
*                                                                Y02134 09200002
*CHECK JFCB MASK TO DETERMINE IF PROCESSING IS REQUIRED ON THIS DCB     09250002
*                                                                Y02134 09300002
*****************************************************************Y02134 09350002
*                                                                Y02134 09400002
         TM    JFCBMASK+K5,LBLERR       TEST FOR CONFLICT IN LABEL      09600002
         BNZ   EMO02000                 BRANCH IF LABEL CONFLICT Y02134 09650002
*                                                                Y02134 09700002
         TM    JFCBMASK+K5,JFCDUAL      TEST IF CONFLICT IN DENS Y02134 09750002
         BNO   EMO08000                 BRANCH IF NO CONFLICT    Y02134 09800002
*                                                                Y02134 09850002
*****************************************************************Y02134 09900002
*                                                                Y02134 09950002
*        DENSITY CONFLICTS TO BE RESOLVED HERE                   Y02134 10000002
*                                                                Y02134 10050002
*****************************************************************Y02134 10100002
*                                                                Y02134 10150002
*        THE FOLLOWING TWO INSTRUCTIONS, IF ACTIVATED, WILL      YM3819 10155002
*        CAUSE A SPECIFICALLY REQUESTED TAPE TO BE REJECTED      YM3819 10156002
*        WHEN A DENSITY CONFLICT OCCURS. IF THE TAPE IS          YM3819 10157002
*        REMOUNTED BY THE OPERATOR WITHOUT TAMPERING WITH        YM3819 10158002
*        THE LABEL, THE TAPE WILL BE ACCEPTED AND THIS ROUTINE   YM3819 10159002
*        WILL NOT RECEIVE CONTROL AGAIN. THE LABEL ON THE TAPE   YM3819 10159202
*        WILL BE REWRITTEN AT THE USER REQUESTED DENSITY.        YM3819 10159402
*                                                                YM3819 10159602
*        IF THE FOLLOWING TWO INSTRUCTIONS ARE NOT ACTIVATED     YM3819 10159802
*        THE LABEL ON THE TAPE WILL BE REWRITTEN AT THE USER     YM3819 10159902
*        REQUESTED DENSITY WITHOUT AN INTERVENING DISMOUNT.      YM3819 10164902
*                                                                YM3819 10165902
*****************************************************************YM3819 10166902
*                                                                YM3819 10167902
         CLC   DXVOLSR2,SCRTCH          CHECK IF SCRATCH REQUEST YM3819 10168902
*        BNE   EMO08000                 BRANCH IF NOT SCRTCH     YM3819 10169102
*        FOLLOWING INSTRUCTION MAY BE ZAPPED TO 4770             YM3819 10169302
         NOP   EMO08000                 BRANCH IF NOT SCRTCH     YM3819 10169502
*                                                                YM3819 10169702
*****************************************************************YM3819 10169802
*                                                                YM3819 10173202
* INSERT YOUR INSTRUCTIONS TO RESOLVE DENSITY CONFLICTS,         Y02134 10176602
* AND REMOVE ASTERISKS TO ACTIVATE THE NEXT INSTRUCTION          Y02134 10180002
* AND REASSEMBLE THIS MODULE.                                    Y02134 10190002
*                                                                Y02134 10192002
******** NI    JFCBMASK+K5,ALLBITS-JFCDUAL SET DENSITY RESOLVED  Y02134 10200002
*                                                                Y02134 10350002
         B     EMO09000                 BRANCH TO GET NEXT ENTRY Y02134 10400002
*                                                                Y02134 10450002
*****************************************************************Y02134 10500002
*                                                                Y02134 10550002
*        RESOLVE LABEL CONFLICTS HERE                            Y02134 10600002
*                                                                Y02134 10650002
*****************************************************************Y02134 10700002
*                                                                Y02134 10750002
EMO02000 EQU   *                        CHECK LABEL CONFLICT            10800002
*                                                                Y02134 10850002
         TM    JFCBMASK+K5,JFCSLDES     DESTROY SL LABEL         Y02134 10900002
         BNO   EMO04000                 NO, CHECK IF CREATE      YM4647 10950002
*                                                                Y02134 11250002
*****************************************************************Y02134 11300002
*                                                                Y02134 11350002
*        DESTROY STANDARD LABEL HERE                             Y02134 11400002
*                                                                Y02134 11450002
*****************************************************************Y02134 11500002
*                                                                Y02134 11550002
EMO03000 EQU   *                        USER ROUTINE HERE        Y02134 11600002
*                                                                Y02134 11602002
*****************************************************************YM3819 11607002
*                                                                YM3819 11608002
*        THE FOLLOWING TWO INSTRUCTIONS, IF ACTIVATED, WILL      YM3819 11609002
*        CAUSE A SPECIFICALLY REQUESTED TAPE TO BE REJECTED      YM3819 11609202
*        WHEN A LABEL CONFLICT OCCURS (NL REQUESTED & SL         YM3819 11609402
*        MOUNTED).                                               YM3819 11609602
*                                                                YM3819 11609802
*        IF THE FOLLOWING TWO INSTRUCTIONS ARE NOT ACTIVATED     YM3819 11609902
*        THE LABEL ON THE TAPE WILL BE REWRITTEN AT THE USER     YM3819 11614902
*        REQUESTED LABEL TYPE WITHOUT AN INTERVENING DISMOUNT,   YM3819 11615902
*        REGARDLESS IF THE REQUEST IS SPECIFIC OR NOT.           YM3819 11616902
*                                                                YM3819 11617902
*****************************************************************YM3819 11618902
*                                                                YM3819 11619102
         CLC   DXVOLSR2,SCRTCH          CHECK IF SCRATCH REQUEST YM3819 11619302
*        BNE   EMO08000                 BRANCH IF NOT SCRTCH     YM3819 11619502
*        FOLLOWING INSTRUCTION MAY BE ZAPPED TO 4770             YM3819 11619702
         NOP   EMO08000                 BRANCH IF NOT SCRTCH     YM3819 11619802
*                                                                YM3819 11623202
*****************************************************************YM3819 11624202
*                                                                YM3819 11625202
* INSERT YOUR INSTRUCTIONS TO DESTROY THE VOLUME LABEL           Y02134 11626602
* ACCORDING TO PUBLICATION GC28-6680,                            Y02134 11630002
* AND REMOVE ASTERISKS TO ACTIVATE THE NEXT INSTRUCTION,         Y02134 11640002
* AND REASSEMBLE THIS MODULE.                                    Y02134 11642002
*                                                                Y02134 11650002
******** NI    JFCBMASK+K5,ALLBITS-JFCSLDES SET DESTROY SL OFF   Y02134 11700002
*                                                                Y02134 11850002
*                                                                Y02134 11950002
*****************************************************************Y02134 12000002
*                                                                Y02134 12050002
*        CREATE STANDARD LABEL HERE                              Y02134 12100002
*                                                                Y02134 12150002
*****************************************************************Y02134 12200002
*                                                                Y02134 12250002
EMO04000 EQU   *                        USER ROUTINE HERE        Y02134 12300002
*                                                                Y02134 12302002
         TM    JFCBMASK+K5,JFCSLCRE     CREATE SL LABEL          YM4647 12306002
         BNO   EMO09000                 NO, RETURN TO REVERIFY   YM4647 12306402
*                                                                YM4647 12306802
*****************************************************************YM3819 12307002
*                                                                YM3819 12308002
*        THE FOLLOWING TWO INSTRUCTIONS WILL                     YM3819 12309002
*        CAUSE A SPECIFICALLY REQUESTED TAPE TO BE REJECTED      YM3819 12309202
*        WHEN A LABEL CONFLICT OCCURS (SL REQUESTED & NL         YM3819 12309402
*        MOUNTED).                                               YM3819 12309602
*                                                                YM3819 12309802
*        IF THE FOLLOWING TWO INSTRUCTIONS ARE NOT ACTIVATED     YM4647 12311302
*        THE LABEL ON THE TAPE WILL BE REWRITTEN AT THE USER     YM4647 12313302
*        REQUESTED LABEL TYPE WITHOUT AN INTERVENING DISMOUNT,   YM4647 12313702
*        REGARDLESS IF THE REQUEST IS SPECIFIC OR NOT.           YM4647 12314102
*                                                                YM3819 12322002
*****************************************************************YM3819 12323502
*                                                                YM3819 12325002
         CLC   DXVOLSR2,SCRTCH          CHECK IF SCRATCH REQUEST YM3819 12326502
*        BNE   EMO08000                 BRANCH IF NOT SCRTCH     YM4647 12327802
*        FOLLOWING INSTRUCTION MAY BE ZAPPED TO 4770             YM4647 12327902
         NOP   EMO08000                 BRANCH IF NOT SCRTCH     YM4647 12328402
*                                                                YM3819 12331002
*****************************************************************YM3819 12332502
*                                                                YM3819 12334002
* INSERT YOUR INSTRUCTIONS TO CREATE A STANDARD LABEL            Y02134 12335502
* ACCORDING TO PUBLICATION GC28-6680,                            Y02134 12337002
* AND REMOVE ASTERISKS TO ACTIVATE THE NEXT INSTRUCTION,         Y02134 12338502
* AND REASSEMBLE THIS MODULE.                                    Y02134 12340002
*                                                                Y02134 12350002
******** NI    JFCBMASK+K5,ALLBITS-JFCSLCRE SET CREATE SL OFF    Y02134 12400002
*                                                                Y02134 12550002
         B     EMO09000                 BRANCH TO GET NEXT ENTRY Y02134 12600002
*                                                                Y02134 12650002
*****************************************************************Y02134 12700002
*                                                                Y02134 12750002
*        REJECT MOUNTED VOLUME HERE                              Y02134 12800002
*                                                                Y02134 12850002
*****************************************************************Y02134 12900002
*                                                                Y02134 12950002
EMO08000 EQU   *                        REJECT VOLUME HERE       Y02134 13000002
*                                                                Y02134 13050002
         OI    UCBDMCT,UCBMOUNT         SET REJECT ON            Y02134 13052002
*                                                                Y02134 13150002
*****************************************************************Y02134 13200002
*                                                                Y02134 13250002
*        GET NEXT ENTRY IN PARM LIST                             Y02134 13300002
*        ONLY ONE ENTRY FOR EOV                                  Y02134 13350002
*****************************************************************Y02134 13400002
*                                                                Y02134 13450002
EMO09000 EQU   *                        GET NEXT DCB             Y02134 13500002
*                                                                Y02134 13550002
******** TM    DXDCBLST,LASTNTRY        TEST FOR LAST ENTRY      Y02134 13600002
******** LA    RPARC,DXDCBLST+L'DXDCBLST GET NEXT ENTRY          Y02134 13650002
******** LA    RWTGC,WTGENTRY+L'WTGENTRY GET NEXT ENTRY          Y02134 13700002
******** BNO   EMO01000                 BR TO PROCESS NEXT ENTRY Y02134 13750002
*                                                                Y02134 13800002
*****************************************************************Y02134 13850002
*                                                                Y02134 13900002
*        RETURN TO IGG0550P                                      Y02134 13950002
*                                                                Y02134 14000002
*****************************************************************Y02134 14050002
*                                                                Y02134 14100002
         IECRES LOAD,MODNM=IDRETURN,PREFIX=WTGPREFX,             Y02134X14150002
               BRANCH=DIRECT                                     Y02134 14200002
*                                                                Y02134 14250002
*****************************************************************Y02134 14300002
*                                                                Y02134 14350002
*        CONSTANTS                                               Y02134 14400002
*                                                                Y02134 14450002
*****************************************************************Y02134 14500002
*                                                                Y02134 14550002
ID3C3C   DC    CL2'3C'                  ID OF OMODVOL1/EMODVOL1  Y02134 14600002
SCRTCH   DC    CL6'SCRTCH'              NON SPECIFIC REQUEST     Y02134 14650002
*                                                                Y02134 14700002
         XCTLTABL ID=(IDRETURN,IGG0550P),BRT=YES,LENGTH=         Y02134 14750002
*                                                                Y02134 14800002
         IECDSECS CVT,TCB,DSAB,TIOT,DCB,UCB,MAIN,WTG,PREFX,      Y02134X14850002
               EXPAND=YES                                        Y02134 14900002
         IECEQU                                                         14950002
         END                                                            15000002
./  ADD  SSI=81660174,NAME=IFG0553F
         TITLE 'IFG0553F - NEW VOLUME HEADER LABEL VERIFICATION'        00100021
         COPY  LCGASMSW                                                 00110002
IFG0553F CSECT                                                          00115002
*********************************************************************** 00165002
*                                                                     * 00215002
*          VS2 RELEASE 03 DELETIONS                                   * 00325000
*0000297556                                                     ZA00011 00335000
*                                                                     * 00335437
*          VS2-037 ADDITIONS, CHANGES, AND DELETIONS                  * 00335837
*0000A012993-013013,A019706-019726,A538000-538880              @ZA28943 00336237
*                                                                     * 00336637
*          VS2 RELEASE 04 DELETIONS                                   * 00337037
*0000022200                                                    @ZA03660 00345037
*                                                                     * 00365002
*                                                                     * 00415002
*********************************************************************** 00417002
*                                                                     * 00419002
* MODULE NAME = IFG0553F (OS/VS2)                                     * 00421002
*                                                                     * 00423002
* DESCRIPTIVE NAME = NEW VOLUME HEADER LABEL VERIFICATION             * 00423402
*                                                                     * 00423802
* COPYRIGHT = NONE                                                    * 00424202
*                                                                     * 00424602
* STATUS = RELEASE 2, LEVEL 0                                         * 00424702
*                                                                     * 00424802
* FUNCTION =                                                          * 00424902
*        1) THIS FUNCTION POSITIONS DATA SETS ON AL, NL, AND SL TAPE  * 00427702
*        TO THE DESIRED DATA SET AS INDICATED BELOW. AT THIS POINT,   * 00429702
*        THE MOUNT/VERIFY ROUTINE HAS COMPLETED BUT THE TAPE MAY      * 00431702
*        NOT BE POSITIONED CORRECTLY.                                 * 00432102
*        1A) NL TAPES ARE POSITIONED TO EITHER THE INTERBLOCK GAP     * 00432502
*        PRECEDING THE FIRST DATA RECORD (READ FORWARD) OR TO THE     * 00432902
*        INTERBLOCK GAP FOLLOWING THE LAST DATA RECORD(RDBACK).       * 00433302
*        1B) AL AND SL TAPES ARE POSITIONED TO EITHER THE INTERBLOCK  * 00433802
*        GAP PRECEDING HEADER LABEL 1 (READ FORWARD) OR PRECEDING     * 00434202
*        TRAILER LABEL 1 (READBACK).                                  * 00434602
*        2) WHEN A CONCATENATED DATA SET IS TO BE PROCESSED, THE JFCB * 00434702
*        FILE SEQUENCE NUMBER (JFCBFLSQ) INDICATES THAT DATA SET'S    * 00434802
*        POSITION ON THE TAPE; THIS FIELD IS UTILIZED AS FOLLOWS:     * 00434902
*        3A) FOR NL TAPES OR DATA SETS ON AL OR SL TAPE WITH A JFCB   * 00435802
*        FILE SEQUENCE NO. OF 1, THE DESIRED POSITION (JFCBFLSQ) IS   * 00437802
*        COMPARED TO THE CURRENT TAPE POSITION (SRTEFSCT) AND THE     * 00437902
*        TAPE IS MOVED BACKWARD OR FORWARD AS REQUIRED. POSITION      * 00438102
*        WITHIN THE DATA SET IS AS SPECIFIED IN SECTION (1) ABOVE.    * 00438502
*        3B) FOR DATA SETS ON AL OR SL TAPE WITH A JFCB FILE SEQUENCE * 00438602
*        NUMBER GREATER THAN 1, HEADER LABEL 1 OF THE FIRST DATA      * 00438702
*        SET ON THE TAPE IS READ TO OBTAIN THE FILE SEQUENCE NO.      * 00438802
*        (IE. LOGICAL POSITION) ON THE TAPE OF THAT DATA SET. IF      * 00439002
*        THAT FILE SEQUENCE NO. IS '1', THEN THE TAPE IS POSITIONED   * 00439402
*        AS IN (3A) ABOVE. IF THAT FILE SEQUENCE NO. IS GREATER       * 00439502
*        THAN '1', THEN THE DIFFERENCE BETWEEN THIS FILE SEQUENCE     * 00439602
*        NO. AND THAT OF THE DESIRED DATA SET INDICATES THE PHY-      * 00440002
*        SICAL POSITION OF THE DESIRED DATA SET ON THE TAPE. POSI-    * 00440402
*        TIONING WITHIN THE DATA SET IS AS SPECIFIED IN SECTION(1).   * 00440502
*        4) CONTROL IS TRANSFERRED TO IFG0553H (BRANCH CODE=24) FOR   * 00440602
*        NL TAPES.                                                    * 00440702
*        5) FOR NSL, A DCB COPY IS PERFORMED FROM THE WORK AREA TO    * 00441002
*        THE CALLER'S CORE, AND CONTROL IS PASSED TO NSLEHDRI WITH    * 00441402
*        A BRANCH CODE OF 20.                                         * 00441802
*        6) READ FILE LABEL 1 AND VERIFY IT IS HDR1, EOV1, OR EOF1.   * 00441902
*        7) COMPARE THE LEAST SIGNIFICANT (IE. LAST) 17 CHARACTERS    * 00442002
*        OF THE DATA SET NAME IN THE JFCB TO THE DATA SET NAME IN     * 00442102
*        FILE LABEL 1. IF THE NAMES ARE NOT IDENTICAL AND THE DATA    * 00442202
*        SET IS A MEMBER OF A GENERATION DATA GROUP, THEN THE UN-     * 00443902
*        QUALIFIED DATA SET NAME, THE GENERATION NUMBER, AND THE      * 00445902
*        VERSION NUMBER ARE ALL VERIFIED SEPARATELY. AN ERROR EXIT    * 00446002
*        IS TAKEN WHEN THE VARIOUS COMPARANDS ARE NOT IDENTICAL;      * 00449702
*        8) IF THE DCB CONTAINS A TAPE-DEPENDENT SECTION, THE BLOCK   * 00451702
*        COUNT FROM THE LABEL IS CONVERTED TO BINARY AND PLACED       * 00453702
*        IN THE DCB.                                                  * 00455702
*        9) PERFORM CHECKPOINT DATA SET PROCESSING.                   * 00456102
*        10) PROCESS INPUT USER HEADER LABELS, IF REQUIRED-           * 00456502
*        10A) GET 2 USER LABEL WORK AREAS. A 152 BYTE AREA FROM FETCH * 00456902
*        PROTECTED SUBPOOL 229 IN DATA MANAGEMENT KEY FOR EOV, AND A  * 00457302
*        96 BYTE AREA FROM THE SAME SUBPOOL IN CALLER'S KEY FOR THE   * 00457502
*        CALLER.                                                      * 00457902
*        10B) A LABEL IS READ AND CONTROL IS PASSED TO THE USER VIA A * 00458402
*        IECRES-UEXIT MACRO. ADDITIONAL LABELS ARE READ IF THE USER   * 00458802
*        PASSES A RETURN CODE OF '4'; THIS CONTINUES UNTIL EITHER THE * 00459202
*        MAXIMUM NUMBER OF LABELS HAS BEEN READ OR UNTIL THE USER     * 00459302
*        INDICATES THAT PROCESSING IS TO TERMINATE. THE RETURN CODES  * 00459802
*        THAT THE USER PASSES IN REG 15 ARE AS FOLLOWS:               * 00460202
*        0 - CONTINUE READING USER LABELS;                            * 00460602
*        4 - DISCONTINUE PROCESSING USER LABELS;                      * 00460702
*        11) POSITION THE TAPE TO THE FIRST DATA RECORD; IE. AT THE   * 00461002
*        INTERBLOCK GAP PRECEDING THE FIRST DATA RECORD (READ FORWARD)* 00461402
*        OR AT THE INTERBLOCK GAP FOLLOWING THE LAST DATA RECORD      * 00461802
*        (READ BACKWARD).                                             * 00462202
*        12) TRANSFER CONTROL TO IFG0553H WITH A BRANCH CODE = 0.     * 00462602
*                                                                     * 00463002
* NOTES = SEE BELOW                                                   * 00463102
*                                                                     * 00463402
*    DEPENDENCIES =                                                   * 00463802
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 00464202
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 00464302
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 00464402
*                                                                     * 00464502
*    RESTRICTIONS = NONE                                              * 00464602
*                                                                     * 00465502
*    REGISTER CONVENTIONS =                                           * 00465902
*            R2 POINTS TO DCB                                         * 00466302
*            R4 POINTS TO OPEN WORK AREA                              * 00466702
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 00467102
*            R6 POINTS TO THE WTG TABLE                               * 00467202
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 00467502
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 00467902
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 00468002
*            R10 POINTS TO THE UCB                                    * 00468102
*                                                                     * 00468702
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 00469102
*                  END OF LISTING.                                    * 00469502
*                                                                     * 00469902
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 00470002
*                                                                     * 00470102
*    PROCESSOR = ASSEMBLER XF                                         * 00470602
*                                                                     * 00471002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 00471402
*                  ORG STATEMENT AT END OF LISTING                    * 00471802
*                                                                     * 00471902
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 00472002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 00472102
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 00472402
*                                                                     * 00472802
* ENTRY POINT =                                                       * 00472902
*        IFG0553F                                                     * 00473002
*                                                                     * 00473102
*    PURPOSE = SEE FUNCTION                                           * 00473202
*                                                                     * 00473602
*    LINKAGE =                                                        * 00473702
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 00473802
*        MACRO INSTRUCTION.                                           * 00474202
*                                                                     * 00474302
* INPUT =                                                             * 00474402
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 00474502
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 00475102
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 00475502
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 00475902
*                                                                     * 00476302
* OUTPUT =                                                            * 00476702
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 00477102
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 00477502
*        DEBDCBAD POINTING TO THE COPIED DCB,                         * 00477602
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 00478002
*                                                                     * 00478202
* EXIT-NORMAL =                                                       * 00478302
*        IFG0553H - NORMAL EXIT, BRANCH CODE = 0                      * 00478402
*                   NL LOOK-AHEAD MOUNT, BRANCH CODE = 24             * 00478502
*        IFG0554J - ISSUE SECURE VOLUME MESSAGE, BRANCH CODE = 56     * 00479102
*           RETURN MODULE - IFG0553F, BRANCH CODE = 4                 * 00479502
*                                                                     * 00479902
* EXIT-ERROR =                                                        * 00480302
*        IFG0550P - PROBLEM DETERMINATION                             * 00480702
*             INTERNAL CODE = 162, ERROR POS CONCAT DATA SET          * 00481002
*             INTERNAL CODE = 163, ERROR POS NEW VOL FOR READ FORWARD * 00481402
*             INTERNAL CODE = 164, ERROR READING HEADER LABEL         * 00481802
*             INTERNAL CODE = 165, INCORRECT DATA SET NAME            * 00481902
*             INTERNAL CODE = 191, ERR POS TO FIRST DATA RECORD       * 00482002
*             INTERNAL CODE = 194, ERROR POS NEW VOL FOR RDBACK       * 00482102
*             INTERNAL CODE = 195, INVALID HEADER LABEL READ          * 00482202
*             INTERNAL CODE = 196, ERR POS AFTER USER LABEL PROCESSING* 00482302
*             INTERNAL CODE = 240, CHK PT DS ON NON SEC VOL           * 00482402
*             INTERNAL CODE = 241, NON CHK PT DS ON SECURE VOL        * 00482502
*                                                                     * 00482602
* EXTERNAL REFERENCES = SEE BELOW                                     * 00482702
*                                                                     * 00482802
*    ROUTINES =                                                       * 00483402
*        IFG019RA THROUGH THE IECRES MACRO.                           * 00483802
*                                                                     * 00484202
*    DATA AREAS =                                                     * 00484602
*        EOV WORKAREA.                                                * 00485002
*                                                                     * 00485102
*    CONTROL BLOCK =                                                  * 00485802
*        CVT                                                          * 00487802
*        DEB                                                          * 00487902
*        DSAB                                                         * 00488002
*        JFCB                                                         * 00488102
*        PSA                                                          * 00488202
*        TCB                                                          * 00488602
*        UCB                                                          * 00488802
*        RB                                                           * 00489202
*                                                                     * 00489302
* TABLES =                                                            * 00489402
*                                                                     * 00489502
* MACROS =                                                            * 00489702
*        IECRES LOAD                                                  * 00489802
*        IECRES GET                                                   * 00489902
*        IECRES INIT                                                  * 00490002
*        IECRES FREE                                                  * 00490302
*        IECRES WAIT                                                  * 00490702
*        IECRES UEXIT                                                 * 00491102
*        DMABCOND                                                     * 00491502
*        EXCP                                                         * 00491602
*        DEBCHK                                                       * 00491702
*        XLATE                                                        * 00491802
*        SETLOCK                                                      * 00491902
*                                                                     * 00492002
* CHANGE ACTIVITY =                                                   * 00492102
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 00492502
*                                                                     * 00492902
*********************************************************************** 00493002
         EJECT                                                          00493402
*                                                                       00493502
*****          INTERNAL ERROR CODES                                     00493602
*                                                                       00493702
EABD162  EQU   162                      ERROR POS CONCATENATED DATA SET 00493802
EABD163  EQU   163                      ERROR POS NEW VOL FOR RD FWD    00493902
EABD194  EQU   194                      ERROR POS NEW VOL FOR RDBACK    00494002
*                                                                       00494102
EABD164  EQU   164                      ERROR READING HEADER LABEL      00494202
EABD165  EQU   165                      INCORRECT DATA SET NAME         00494302
EABD191  EQU   191                      ERROR POSITIONING TO            00494402
*                                       ..FIRST DATA RECORD             00495002
EABD195  EQU   195                      INVALID HEADER LABEL READ       00498102
EABD196  EQU   196                      ERR POSITIONING FOLLOWING USER  00501802
*                                       ..HEADER LABEL PROCESSING       00505502
EABD240  EQU   240                      CHK PT DS ON NON SEC VOL Y02083 00509202
EABD241  EQU   241                      NON CHK PT DS ON SEC VOL Y02083 00512902
EABD249  EQU   249                      937-20 ABEND CODE        YM5950 00514902
CHARC    EQU   C'C'                     CHARACTER C              Y02083 00516602
*                                                                       00520302
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        00524002
         USING *,RBASE                                                  00527702
         USING FORCORE,RCORE                                            00531402
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 00535102
         USING IHADCB,RDCB                                              00538802
         USING UCB,RUCB                                                 00542502
*                                                                       00545702
         USING DEB,RDEB                                                 00546202
         B     LABEL00(RET)             BR ON REG 14 CODE        Y02083 00549902
LABEL00  B     ETI18700                 NORMAL ENTRY             Y02083 00553602
         B     ETI24030                 RETURN FROM IFG0554J     Y02083 00557302
         B     ETI24016                 RETURN FROM SECURITY     YM5950 00559302
         B     ETI24011                 ASCII DISMOUNT RETURN    YM5950 00559702
*                                                                       00561002
*                                                                       01115002
*****    NOTE- 'RTIOT' AND 'RDEB' ARE NOW USED AS WORK REGISTERS        01120002
*                                                                       01125002
ETI18700 EQU   *                        CHECK FOR READBACK              01130002
         L     RDEB,DCBDEBAD            GET DEB ADDRESS          YM3929 01132002
         STCM  RUCB,B'0111',DEBUCBAD+K1 PUT UNIT ADDR INTO DEB   YM3929 01134002
         LH    RD,SRTEFSCT              GET UCB FILE SEQ CT      YM4646 01134402
         LTR   RD,RD                    IS UCBFSCT EQ ZERO       YM4646 01134802
         BNZ   ETI18750                 BR IF NOT                YM4646 01134902
         MODESET EXTKEY=ZERO            ASSUME UCB KEY           YM4646 01139802
         MVI   SRTEFSCT+K1,K1           SET UCB FSCT TO ONE      YM4646 01149802
         MVI   SRTEFSEQ+K1,K1           SET LOGICAL CT TO 1      YM5950 01151802
         MODESET EXTKEY=DATAMGT         ASSUME DATA MGT KEY      YM4646 01159802
ETI18750 EQU   *                        UCB FSCT NOT ZERO        YM4646 01160202
         TM    DCBOFLGS,DCBORDBK        IS THE DCB OPENED FOR 'RDBACK'- 01161102
         BO    ETI20300                 ..BR IF YES TO POS FOR 'RDBACK' 01166002
         LA    RD,EABD163               LOAD INTERNAL ERROR CODE        01170902
         TM    DCBOFLGS,DCBOCON         IS CONCATENATION IN PROGRESS-   01175802
         BZ    ETI19900                 ..BRANCH IF NOT                 01180702
*                                                                       01185602
*********************************************************************** 01190502
*              POSITIONING FOR A CONCATENATED DATA SET                * 01195402
*********************************************************************** 01200302
*                                                                       01205202
ETI18800 EQU   *                        CONCATENATION POSITIONING       01207202
         LA    RD,EABD162               LOAD INTERNAL ERROR CODE        01215002
         LH    RET,JFCBFLSQ             LOAD FILE SEQ NO. FROM JFCB     01219902
         CH    RET,REWND+6              IS JFCB FILE SEQ NO. EQ 1-      01224802
         BE    ETI18900                 ..BR IF YES                     01229702
         BH    ETI19000                 ..BR IF GREATER THAN 1          01234602
*                                                                       01239502
*****          PROCESS FILE SEQUENCE NUMBER EQUAL TO 0                  01244402
*                                                                       01249302
         LA    RET,K1                   INITLZ FOR FILE SEQ NO. EQUAL 1 01254202
         MVI   JFCBFLSQ+K1,K1           SET JFCB FILE SEQ NO. TO 1      01256202
         OI    DXXPATHS,WTGJFCBW        TURN ON JFCB 'WRITE-BACK' IND   01258202
*                                                                       01268902
*****          PROCESS FILE SEQUENCE NUMBER EQUAL TO 1                  01273802
*                                                                       01278702
ETI18900 EQU   *                        FILE SEQUENCE EQ ONE            01280702
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 01288502
         STH   RET,SRTEFSEQ             ST LOGICAL FILE SEQ NO. IN UCB  01293402
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 01298302
         TM    JFCBLTYP,JFCBLTM         LTM SPECIFIED ?        @2A28943 01299337
         BZ    ETI19900                 NO, BRANCH             @ZA28943 01300337
         BAL   RB,ETI26600              BR TO BYPASS LTM       @ZA28943 01301337
         B     ETI19900                 BR TO PERFORM POSITIONING       01303202
*                                                                       01308102
*****          PROCESS FILE SEQUENCE NUMBER GREATER THAN 1              01313002
*                                                                       01317902
ETI19000 EQU   *                        FILE SEQUENCE GT ONE            01319902
         TM    JFCBLTYP,JFCBAL+JFCSL    WAS SL OR AL SPECIFIED-         01327702
         BZ    ETI19500                 ..BR IF NOT- PERFORM NL POS     01332602
         CLC   SRTEFSCT(K2),REWND+K6    IS THE CURRENT POSITION '1'-    01334602
         BNE   ETI19300                 ..BR IF NOT TO POSITION         01342402
*                                                                       01347302
*****          AN SL TAPE IS CURRENTLY POSITIONED TO THE FIRST          01352202
*****          PHYSICAL DATA SET ON THE TAPE- USE THE DATA SET          01357102
*****          SEQUENCE NUMBER ( LOGICAL ) FROM THE HEADER 1 LABEL      01362002
*****          OF THAT DATA SET TO CALCULATE THE RELATIVE OFFSET        01366902
*****          ( PHYSICAL ) OF THE DESIRED DATA SET                     01371802
*                                                                       01376702
         LA    RC,DXLBL                 LOAD ADDRESS OF LABEL BUFFER,   01381602
         ST    RC,DXCCW1                ..STORE IT INTO 'READ' CCW      01386502
         MVI   DXCCW1,CCWRDTAP          INITLZ CCW FOR 'READ' COMMAND   01391402
         MVC   DXCCW1+K4(K4),ARDCCW0C   IND NO FLAGS, LNG EQ 80 BYTES   01395402
         TM    JFCBLTYP,JFCBAL          WERE 'ANSI' LABELS SPECIFIED-   01401202
         BZ    ETI19100                 ..BR IF NOT TO READ LABEL       01406102
         OI    DXCCW1+K4,CCWSILI        TURN ON 'SILI' INDICATOR        01408102
ETI19100 EQU   *                        GO READ LABEL                   01410102
         BAL   RC,ETI26400              BR AND LINK TO READ LABEL       01420802
         BNO   ETI26500                 BR TO ERROR RTN IF I/O ERROR    01425702
         TM    SRTESTAB,UCBBSTR         IS AN 'ANSI' VOLUME MOUNTED-    01430602
         BZ    ETI19200                 ..BR IF NOT TO CHK LABEL TYPE   01435502
         XLATE DXLBL,K80                TRANSLATE 'ANSI' LABEL DATA     01440402
ETI19200 EQU   *                        VERIFY HEADER1 READ             01442402
         CLC   FL1LABI,AVOL0C           IS THIS A VOLUME LABEL-         01450202
         BE    ETI19100                 ..BR IF YES- READ ANOTHER LABEL 01455102
         CLC   FL1LABI,UVOL3D           IS THIS A USER VOLUME LABEL-    01460002
         BE    ETI19100                 ..BR IF YES- READ ANOTHER LABEL 01464902
         CLC   FL1LABI,AHDR             IS THIS A HEADER LABEL-         01469802
         BNE   ETI26500                 ..BR IF NOT- ERROR              01474702
         MVI   DXCCW1,CCWBSR            INITLZ CCW FOR BSR COMMAND      01479602
         BAL   RC,ETI26400              BR AND LINK TO BSR PAST LABEL   01484502
         BNO   ETI26500                 BR IF ERROR TO ERROR RTN        01489402
         PACK  DXCCW2,FL1FILSQ          PACK LABEL FILE SEQ NO., THEN   01494302
         CVB   RET,DXCCW2               ..CONVERT IT TO BINARY AND      01499202
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 01504102
         STH   RET,SRTEFSEQ             ..STORE IT IN THE UCB           01509002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 01513902
         CH    RET,JFCBFLSQ             IS DESIRED DATA SET 1ST ON TAPE 01518802
*                                       ..(PHYSICAL POS EQ 1, LOGICAL   01523702
*                                       ..POSITION EQUAL ANYTHING )-    01528602
         BE    ETI20900                 ..BR IF YES- POS COMPLETE       01533502
         BH    ETI26500                 ..BR IF SPECIFIED SEQ NO. IS    01538402
*                                       ..LESS THAN THAT OF 1ST         01543302
*                                       ..PHYSICAL DATA SET- ERROR      01548202
*                                                                       01553102
*****          DETERMINE HOW TO POSITION AN SL DATA SET                 01558002
*                                                                       01562902
ETI19300 EQU   *                        SL POSITIONING                  01564902
         LH    RTIOT,SRTEFSEQ           LOAD CURRENT LOGICAL SEQ NO.    01572702
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 01577602
         MVC   SRTEFSEQ,JFCBFLSQ        ST DESIRED LOG SEQ NO. IN UCB   01582502
         SH    RTIOT,SRTEFSEQ           CALC RELATIVE OFFSET OF THE 2   01587402
*                                       ..DATA SETS-                    01592302
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 01597202
         BZ    ETI20900                 ..BR IF 0- POS COMPLETE         01602102
         BP    ETI19400                 ..BR IF POSITIVE TO BACKSPACE   01607002
*                                                                       01611902
*****          FORWARD SPACE TO AN SL DATA SET                          01616802
*                                                                       01621702
         LPR   RET,RTIOT                CALC NEW PHYSICAL SEQ NO.-      01626602
         AH    RET,SRTEFSCT             ..ADD RELATIVE OFFSET TO CUR    01631502
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 01636402
         STH   RET,SRTEFSCT             ..PHYSICAL POS AND STORE IN UCB 01641302
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 01646202
         B     ETI19600                 BR TO ACTUALLY PERFORM POS      01651102
*                                                                       01656002
*****          BACKSPACE TO A SL DATA SET                               01660902
*                                                                       01665802
ETI19400 EQU   *                        BSF                             01667802
         LR    RET,RTIOT                SAVE RELATIVE OFFSET            01675602
         SH    RET,SRTEFSCT             CALC NEW PHYSICAL SEQ NO.-      01680502
         BNM   ETI26500                 ..BR IF NOT MINUS- ERROR        01685402
         LPR   RET,RET                  INSURE POSITIVE SEQ NUMBER      01690302
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 01695202
         STH   RET,SRTEFSCT             ..AND STORE IN UCB              01700102
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 01705002
         B     ETI19600                 BR TO ACTUALLY PERFORM POS      01709902
*                                                                       01714802
*****          DETERMINE HOW TO POSITION AN NL DATA SET                 01719702
*                                                                       01724602
ETI19500 EQU   *                        NL POSITIONING                  01726602
         LH    RTIOT,SRTEFSCT           LOAD CURRENT PHYSICAL SEQ NO.   01734402
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 01739302
         STH   RET,SRTEFSEQ             STORE DESIRED LOGICAL AND       01744202
         STH   RET,SRTEFSCT             ..PHYSICAL SEQ NOS. IN UCB      01749102
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 01754002
         SR    RTIOT,RET                GET POSITIONING FACTOR          01758902
*                                                                       01763802
*****          PERFORM ACTUAL TAPE POSITIONING                          01768702
*                                                                       01773602
ETI19600 EQU   *                        POSITION TAPE                   01775602
         TM    JFCBLTYP,JFCBLP+JFCNL    WAS NL OR BLP SPECIFIED-        01783402
         BNZ   ETI19700                 ..BR IF YES TO CONTINUE         01788302
         MH    RTIOT,CONTHREE           MULTIPLY POSITIONING FACTOR BY  01793202
*                                       ..3 TO ACCOUNT FOR STD LABELS   01798102
ETI19700 EQU   *                        NL/BLP SPECIFIED                01802002
         MVI   DXCCW1,CCWBSF            INITLZ CCW FOR BSF COMMAND      01807902
         LTR   RTIOT,RTIOT              WHICH WAY DO WE POSITION-       01809902
         BM    ETI19800                 ..BR IF POSITIONING FORWARD     01817702
         BZ    ETI20900                 ..BR IF POSITIONING COMPLETE    01822602
         LA    RTIOT,K1(,RTIOT)         INCREASE NO. OF BSF BY 1        01827502
         BAL   RDEB,ETI21300            BR TO EXECUTE THE I/O LOOP      01832402
         TM    IOBSENSE+K1,UCBLDPT      WAS LOAD POINT REACHED-         01834402
         BO    ETI20900                 ..BR IF YES- POS COMPLETE       01842202
         LA    RTIOT,K1                 INITLZ FOR 1 FWD SPACE FILE     01847102
ETI19800 EQU   *                        FORWARD POSITIONING             01849102
         LPR   RTIOT,RTIOT              INSURE POSITIVE POS FACTOR      01856902
         MVI   DXCCW1,CCWFSF            INITLZ CCW FOR FSF COMMAND      01861802
         BAL   RDEB,ETI21300            BR TO EXECUTE THE I/O LOOP      01866702
         B     ETI20900                 ..BR- CONCATENATION POS DONE    01871602
*                                                                       01876502
*****          POSITIONING FOR READ FORWARD ON THE SAME DATA SET        01881402
*                                                                       01886302
ETI19900 EQU   *                        CHECK FILE SEQUENCE             01888302
         CLC   SRTEFSCT(K2),CONSTONE    IS CURRENT POSITION EQUAL '1'-  01896102
         BE    ETI20200                 ..BR IF YES- POS COMPLETE       01901002
ETI20000 EQU   *                        FILE SEQUENCE NOT EQUAL TO ONE  01903002
         MVI   DXCCW1,CCWREW            INITLZ CCW FOR REWIND COMMAND   01910802
         BAL   RC,ETI26400              BR AND LINK TO REWIND TAPE      01915702
         BNO   ETI26500                 BR IF ERROR TO ERROR RTN        01920602
         MVI   DXCCW1,CCWNOP            INITLZ CCW FOR A 'NOP'          01925502
         BAL   RC,ETI26400              BR AND LINK TO INITIATE 'NOP'   01930402
         BNO   ETI26500                 BR IF ERROR TO ERROR RTN        01935302
ETI20200 EQU   *                        FILE SEQUENCE EQUAL ONE         01937302
         TM    DCBOFLGS,DCBOCON         IS CONCATENATION TAKING PLACE-  01945102
         BO    ETI20900                 BR IF YES TO FINISH             01947102
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 01954902
         MVC   SRTEFSEQ(K2),DXCCW7+K6   UPDATE LOG SEQ NO. FROM WK AREA 01956902
         MVC   SRTEFSCT(K2),CONSTONE    INITLZ PHYSICAL SEQ NO. TO 1    01964702
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 01969602
         TM    JFCBLTYP,JFCBLTM         LTM SPECIFIED ?        @ZA28943 01970637
         BZ    ETI20900                 NO, BRANCH             @ZA28943 01971637
         BAL   RB,ETI26600              BAL TO POS PAST LTM    @ZA28943 01972637
         B     ETI20900                 BR TO FINISH                    01974502
*                                                                       01979402
*****          POSITIONING FOR 'RDBACK' ON THE SAME DATA SET            01984302
*                                                                       01989202
ETI20300 EQU   *                        READBACK POSITIONING            01991202
         LA    RD,EABD194               INTERNAL CODE FOR POS ERROR     01999002
         LH    RTIOT,DXCCW7+K4          LOAD OLD PHYSICAL SEQ NO.       02001002
         LH    RET,SRTEFSCT             LOAD CURRENT PHYSICAL SEQ NO.   02008802
         TM    JFCBLTYP,JFCBLP+JFCNL    WAS NL OR BLP SPECIFIED-        02013702
         BM    ETI20600                 ..BR IF YES                     02018602
         SR    RTIOT,RET                CALC POSITIONING FACTOR         02023502
         BNM   ETI20400                 BR TO POSITION FORWARD          02028402
         LA    RTIOT,K2                 INITLZ POS FACTOR FOR 2 BSF     02033302
         MVI   DXCCW1,CCWBSF            INITLZ CCW FOR BSF COMMAND      02038202
         BAL   RDEB,ETI21300            BR TO EXECUTE THE I/O LOOP      02043102
         LA    RTIOT,K2                 INITLZ POS FACTOR FOR FSF       02048002
         B     ETI20500                 BR TO FORWARD SPACE FILE        02052902
ETI20400 EQU   *                        FORWARD POSITIONING             02054902
         AH    RTIOT,CONSTONE           PLUS ONE TO POSITIONING FACTOR  02062702
         MH    RTIOT,CONTHREE           MULTIPLY POSITIONING FACTOR BY  02067602
*                                       ..3 TO ACCOUNT FOR STD LABELS   02072502
ETI20500 EQU   *                        FSF                             02074502
         MVI   DXCCW1,CCWFSF            INITLZ CCW FOR FSF COMMAND      02082302
         BAL   RDEB,ETI21400            BR TO EXECUTE THE I/O LOOP      02087202
         B     ETI20800                 BR TO UPDATE UCB FILE SEQUENCE  02092102
*                                       ..COUNT AND NUMBER              02097002
ETI20600 EQU   *                        NL/BLP                          02099002
         SR    RTIOT,RET                CALCULATE POSITIONING FACTOR    02106802
         BM    ETI20700                 BR TO POSITION BACKWARD         02111702
         AH    RTIOT,CONSTONE           PLUS ONE TO POSITIONING FACTOR  02116602
         MVI   DXCCW1,CCWFSF            INITLZ CCW FOR FSF COMMAND      02121502
         BAL   RDEB,ETI21300            BR TO EXECUTE THE I/O LOOP      02126402
ETI20700 EQU   *                        BACKWARD POSITIONING            02128402
         MVI   DXCCW1,CCWBSF            INITLZ CCW FOR BSF COMMAND      02136202
         LA    RTIOT,K1                 INITLZ POSITIONING FACTOR TO 1  02141102
         BAL   RDEB,ETI21300            BR TO EXECUTE THE I/O LOOP      02146002
ETI20800 EQU   *                        UPDATE UCB FILE SEQUENCE        02148002
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 02155802
         MVC   SRTEFSCT(K4),DXCCW7+K4   INITLZ PHYSICAL AND LOGICAL SEQ 02157802
*                                       ..NOS. FROM SAVE AREA           02165602
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 02170502
*                                                                       02175402
*****    NOTE- 'RDEB' AND 'RTIOT' ARE NO LONGER USED AS WORK REGS       02180302
*                                                                       02185202
ETI20900 EQU   *                        INIT DM COUNT TO ONE            02187202
         L     RDEB,DCBDEBAD            RESTORE DEB ADDRESS FROM DCB    02195002
         L     RTIOT,DXTIOTAD           RESTORE TIOT ADDR      @ZA03660 02220037
         NI    DCBOFLGS,X'FF'-DCBOEOF   RESET 'TAPE MARK READ' IND      02225002
         SPACE 2                                                        02250002
*********************************************************************** 02255002
*              EXITS                                                  * 02260002
*********************************************************************** 02265002
*                                                                       02270002
         TM    JFCBLTYP,JFCBAL+JFCSL    WAS AL OR SL SPECIFIED-         02275002
         BZ    ETI21000                 ..BRANCH IF NOT                 02280002
*                                                                       02285002
*****          EXIT TO PROCESS STANDARD HEADER LABELS                   02290002
*                                                                       02295002
         B     ETI23100                 BRANCH, PROCESS SL TAPE  Y02134 02310002
*                                                                       02315002
*****          NL AND NSL EXIT DETERMINATION                            02320002
*                                                                       02325002
ETI21000 EQU   *                        EXIT DETERMINATION              02330002
         LA    RF,MOD3F3H               ID/VCON OF MT-AHEAD MOD  Y02134 02335002
         TM    JFCBLTYP,JFCNSL          WAS NSL SPECIFIED-              02340002
         BO    ETI21200                 ..BRANCH IF YES                 02345002
         LA    RET,K24                  BR TABLE OFFSET FOR NL          02350002
ETI21100 EQU   *                        EXIT                            02355002
         L     RTIOT,DXTIOTAD           RELOAD TIOT PRT        @ZA03660 02357037
         IECRES LOAD,MODID=(RF),BRCODE=(RET),BRANCH=QUEUED       Y02080 02360002
*                                    INVOKE IECRES MACRO TO XCTL Y02080 02365002
         EJECT                                                          02370002
*                                                                       02375002
*****          XCTL TO 'NSLEHDRI' TO PROCESS HEADER LABELS              02380002
*                                                                       02385002
ETI21200 EQU   *                        PROCESS NSL                     02390002
*                                                                Y02082 02394002
* COPY THE DCB FROM THE WORK AREA TO USER'S STORAGE              Y02082 02394802
*                                                                Y02082 02394902
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,WTGPREFX)          Y02082 02396602
*                                                                Y02082 02397402
         L     RDCB,DXPDCBAD            GET COPIED DCB ADDR      YM5702 02397802
         MVC   DXXMODNM(K12),NSLEHDRI   NSL HEADER LABEL MODULE  Y02134 02398302
*                                       ..NAME INTO XCTL AREA           02400002
         LA    RET,K20                  BR TABLE OFFSET FOR NSL RETURN  02405002
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          YM2866 02407002
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               Y02080 02410002
         SPACE 2                                                        02415002
*********************************************************************** 02420002
*              SUBROUTINES FOR VOLUME/DATA SET VERIFICATION           * 02425002
*********************************************************************** 02430002
*                                                                       02435002
*****          CLOSED SUBROUTINE TO ISSUE MULTIPLE POSITIONING CMDS     02440002
*                                                                       02445002
ETI21300 EQU   *                        SUBROUTINE FOR VOL/DS VER       02450002
         BAL   RC,ETI26400              BR AND LINK TO DO I/O           02455002
         BO    ETI21400                 BR IF NO ERROR TO CONTINUE      02460002
         TM    IOBSENS1,UCBLDPT         IS THE TAPE AT LOAD POINT-      02465002
         BNO   ETI26500                 ..BR IF NOT TO ERROR RTN        02470002
ETI21400 EQU   *                        NO ERROR                        02475002
         BCT   RTIOT,ETI21300           DECREMENT THE POSITIONING       02480002
*                                       ..FACTOR- CONTINUE IF MORE I/O, 02485002
         BR    RDEB                     ..ELSE RETURN TO CALLER         02490002
*                                                                       18700021
*********************************************************************** 18800021
*              VERIFY HEADER LABEL ( TRAILER LABEL IF READBACK )      * 18900021
*********************************************************************** 19000021
*                                                                       19100021
*****          READ LABEL                                               19200021
*                                                                       19300021
ETI23100 EQU   *                        READ LABEL                      19400002
         LA    RC,DXLBL                 LOAD ADDRESS OF LABEL BUFFER    19500021
         ST    RC,DXCCW1                ..STORE IT INTO 'READ' CCW      19600021
         MVI   DXCCW1,CCWRDTAP          INITLZ CCW FOR 'READ' COMMAND   19700021
         MVC   DXCCW1+K4(K4),ARDCCW7    IND NO FLAGS, LNG EQ 80 BYTES   19800002
         TM    JFCBLTYP,JFCBAL          WERE 'ANSI' LABELS SPECIFIED-   19900021
         BZ    ETI23200                 ..BR IF NOT TO READ LABEL       20000021
         MVI   DXCCW1+K4,CCWSILI        TURN ON SILI INDICATOR          20100002
ETI23200 EQU   *                        READ LABEL                      20200002
         LA    RD,EABD164               LOAD INTERNAL ERROR CODE        20300021
         BAL   RC,ETI26400              BR AND LINK TO READ LABEL       20400021
         BNO   ETI26500                 BR TO ERROR RTN IF I/O ERROR    20500021
         TM    SRTESTAB,UCBBSTR         IS AN 'ANSI' VOLUME MOUNTED-    20600021
         BZ    ETI23300                 ..BR IF NOT TO VERIFY LABEL     20700021
         XLATE DXLBL,K80                TRANSLATE 'ANSI' LABEL DATA     20800021
*                                                                       20900021
*****          PERFORM FILE LABEL 1 VERIFICATION                        21000021
*                                                                       21100021
ETI23300 EQU   *                        HEADER 1 VERIFY                 21200002
         LA    RD,EABD195               LOAD INTERNAL ERROR CODE        21300021
         CLC   FL1LABI,AVOL7            IS THIS A VOLUME LABEL-         21400021
         BE    ETI23200                 ..BR IF YES- READ ANOTHER LABEL 21500021
         CLC   FL1LABI,UVOL0C           IS THIS A USER VOLUME LABEL-    21600021
         BE    ETI23200                 ..BR IF YES READ ANOTHER LABEL  21700021
         BAL   RC,ETI26420              GO CHECK LABEL            99223 21750002
         B     ETI26500                 BRANCH TO ERROR ROUT      99223 21760002
*                                                                       22400021
****           DETERMINE 17 LEAST SIGNIFICANT NON-BLANK                 22500021
****           CHARACTERS IN DATA SET NAME IN JFCB                      22600021
*                                                                       22700021
*              NOTE- RDEB ( 'RB' ) IS NOW USED AS A WORK REGISTER       22800021
ETI23400 EQU   *                        DSNAME PROCESSING               22900002
         LA    R0,JFCBDSNM              PT TO JFCB DSNAME FIELD  A41622 23000021
         LA    RC,JFCBDSNM+K27          POINT TO FIRST POSSIBLE  A41662 23100021
*                                       ..SIGNIFICANT CHARACTER  A41662 23200021
ETI23500 EQU   *                        DETERMINE 17 CHAR DSN    A41662 23300002
         CLI   K16(RC),BLANK            IS THE 17TH SIGNIFICANT  A41662 23400021
*                                       ..CHARACTER A BLANK-     A41662 23500021
         BNE   ETI23600                 ..BR IF NOT- 'RC' PTS TO A41662 23600021
*                                       ..FIRST SIGNIFICANT CHAR A41662 23700021
         BCT   RC,ETI23500              DECR STARTING ADDR AND   A41662 23800021
*                                       ..BR TO CHECK AGAIN      A41662 23900021
ETI23600 EQU   *                        SIGNIFICANT CHAR         A41662 24000002
         LA    RB,K17(,RC)              PT TO FIRST BLANK BEYOND A41662 24100021
*                                       ..17 SIGNIFICANT CHARS   A41662 24200021
         CLR   RC,R0                    IS DSNAME STARTING ADDR  A41662 24300021
*                                       ..WITHIN JFCB DSN FIELD- A41662 24400021
         BNL   ETI23700                 ..BR IF YES- USE 'RC'    A41662 24500021
         LR    RC,R0                    ..ELSE USE JFCBDSNM      A41662 24600021
*                                       ..AS STARTING ADDRESS    A41662 24700021
*                                                                A41662 24800021
*****          COMPARE THE 17 LEAST SIGNIFICANT CHARACTERS IN    A41662 24900021
*****          THE JFCB DSNAME TO THE DATA SET LABEL DSNAME      A41662 25000021
*****          INCLUDING THE GENERATION AND VERSION NUMBERS      A41662 25100021
*                                                                A41662 25200021
ETI23700 EQU   *                        COMPARE DATA SET NAMES   A41662 25300002
         CLC   FL1ID,K0(RC)             ARE THE NAMES IDENTICAL- A41662 25400021
         BE    ETI23900                 ..BR IF CORRECT DATA SET NAME   25500021
*                                                                       25600021
*****          THE DSNAMES IN THE JFCB AND THE HEADER LABEL ARE NOT     25700021
*****          THE SAME. IN THE EVENT THAT THIS IS A 'DOS' TAPE,        25800021
*****          VERIFY THE DATA SET NAME, GENERATION NUMBER, AND         25900021
*****          VERSION NUMBER SEPARATELY. OTHERWISE, EXIT TO THE        26000021
*****          ERROR ROUTINE.                                           26100021
*                                                                       26200021
ETI23800 EQU   *                        DSNAMES NOT EQUAL A41662        26250002
         TM    JFCBIND1,JFCGDG          IS THIS A GENERATION DATA SET-  26300021
         BZ    ETI26450                 ..BR IF NOT TO ERROR RTN        26400021
         LA    RET,K9                   LD LENGTH OF GENERATION  A41662 26440021
*                                       ..AND VERSION NUMBER     A41662 26480021
         SR    RB,RET                   POINT TO THE PERIOD PRE- A41662 26520021
*                                       ..CEDING GENERATION NO.  A41662 26560021
         CLC   FL1GNO,K2(RB)            IS THE GENERATION NO. CORRECT-  26600021
         BNE   ETI26450                 ..BR IF NOT TO ERROR RTN        26700021
         CLC   FL1VNG,K7(RB)            IS THE VERSION NUMBER CORRECT-  26800021
         BNE   ETI26450                 ..BR IF NOT TO ERROR RTN        26900021
*                                                                A41662 26910021
*****          'R0' NOW POINTS TO 'JFCBDSNM'                     A41662 26920021
*****          'RB' NOW POINTS TO THE PERIOD PRECEDING THE       A41662 26930021
*****             GENERATION AND VERSION NUMBERS                 A41662 26940021
*****          'RC' NOW POINTS TO THE BEGINNING OF THE 17 LEAST  A41662 26950021
*****             SIGNIFICANT CHARACTERS- INCLUDING THE GENER-   A41662 26960021
*****             ATION AND VERSION NUMBERS                      A41662 26970021
*                                                                A41662 26980021
         LA    RD,K17                   LD LENGTH OF LABEL NAME  A41662 26990021
         SR    RB,R0                    CALC LENGTH OF DSN WITHOUT GDG  27000021
         CR    RB,RD                    IS THIS NAME GREATER THAN 17    27100021
*                                       ..CHARACTERS-                   27200021
         BH    ETI23840                 ..BR IF YES TO ADJUST ADDRESS   27300021
*                                       ..OF START OF JFCB DSNAME       27400021
         LR    RC,R0                    POINT TO START OF        A41662 27460021
*                                       ..JFCBDSNM FIELD         A41662 27520021
         B     ETI23860                 BRANCH TO COMPARE DSNAMES       27600021
*                                                                A41662 27610021
*****          THE FOLLOWING INSTRUCTION IS USED TO COMPARE THE  A41662 27620021
*****          DATA SET LABEL'S DSNAME TO THE DSNAME IN THE JFCB A41662 27630021
*****          WITHOUT THE GENERATION AND VERSION NUMBERS        A41662 27640021
*                                                                A41662 27650021
ETI23820 CLC   FL1ID(K0),K0(RC)         COMPARE DSNAMES          A41662 27660021
*                                                                A41662 27670021
ETI23840 EQU   *                        ADJUST ADDRESS                  27700002
         SR    RC,RET                   CALC STARTING ADDR OF    A41662 27770021
*                                       ..DSNAME GREATER THAN    A41662 27840021
*                                       ..17 CHARACTERS LONG     A41662 27910021
         LR    RB,RD                    LOAD DSNAME LENGTH OF 17 CHARS  28000021
ETI23860 EQU   *                        COMPARE DSNAMES                 28100002
         BCTR  RB,R0                    DECR LNG FOR USE IN 'CLC' INST  28200002
         EX    RB,ETI23820              IS THE DSNAME CORRECT-   A41662 28300021
         BNE   ETI26450                 ..BR IF NOT TO ERROR RTN        28400021
*                                                                       28500021
****           PLACE BLOCK COUNT INTO THE DCB                           28600021
*                                                                       28700021
ETI23900 EQU   *                        CHECK FOR EXCP                  28800002
         TM    DCBMACRF,DCBMEXCP        IS THE ACCESS METHOD EXCP-      28900021
         BNO   ETI24000                 ..BR IF NOT - BLK CT EXISTS     29000021
         TM    DCBMACRF+K1,DCBMDEV      IS THERE A TAPE SECTION-        29100002
         BZ    ETI24010                 BR IF NOT- BYPASS BLK CT Y02083 29200002
ETI24000 EQU   *                        BLOCK COUNT PROCESSING          29300002
         PACK  DXCCW6,FL1BLKCT          CONVERT BLK CT FROM EBCDIC TO   29400021
         OI    DXCCW6+K7,K15            UNPACKED, INSURE PROPER SIGN,   29500002
         CVB   RC,DXCCW6                ..CONVERT TO BINARY, AND STORE  29600021
         ST    RC,DCBBLKCT              ..BLOCK COUNT INTO THE DCB      29700021
         EJECT                                                          29701202
*********************************************************************** 29701302
*                                                                     * 29704402
*                          FUNCTION PROLOG                            * 29706402
*                                                                     * 29708402
*********************************************************************** 29708802
*                                                                     * 29709202
* FUNCTION NAME -                                                     * 29709302
*    'EOV TAPE INPUT STANDARD HEADER LABEL FUNCTION', PART II.        * 29709402
*                                                                     * 29709702
* (STATUS) -                                                          * 29710102
*    NOT APPLICABLE                                                   * 29710202
*                                                                     * 29711602
* FUNCTION -                                                          * 29713602
*    1. FOR DATA SETS ON AL OR SL TAPE, TEST FOR DATA SET SECURITY.   * 29714002
*       A DATA SET MAY BE BOTH READ AND WRITE PROTECTED, IN WHICH     * 29714102
*       CASE THE PASSWORD IS ALWAYS REQUIRED, OR IT MAY BE WRITE-     * 29714202
*       PROTECTED, IN WHICH CASE THE PASSWORD IS ONLY REQUIRED IF     * 29714302
*       THE DATA SET IS OPENED FOR 'INOUT'.CONTROL IS TRANSFERRED TO  * 29714702
*       OPEN/EOV SECURITY MODULE TO DETERMINE WHETHER OR NOT ACCESS   * 29715102
*       IS AUTHORIZED. IF AN ANSI TAPE HAS AN UNRECOGNIZABLE SECURITY * 29715502
*       INDICATOR, CONTROL IS TRANSFERRED TO MODULE IFG0552X TO       * 29715602
*       ISSUE AN ACCESSABILITY MESSAGE AND CLOSE THE DATA SET.        * 29716702
*                                                                     * 29718702
* ENTRY POINTS -                                                      * 29718802
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 29718902
*                                                                     * 29719502
* INPUT -                                                             * 29719902
*    1. REGISTER CONTENTS AT ENTRY ARE AS FOLLOWS-                    * 29720302
*       'RDCB' - ADDRESS OF THE DCB BEING PROCESSED;                  * 29720402
*       'RCORE'- ADDRESS OF THE WORK AREA FOR THAT DCB;               * 29720502
*       'RES'  - ADDRESS OF THE OPEN/CLOSE/EOV RESIDENT ROUTINE;      * 29720602
*       'RWTG' - ADDRESS OF THE WHERE-TO-GO TABLE;                    * 29720802
*       'RPARC'- ADDRESS OF THE EOV PSEUDO PARAMETER LIST ENTRY;      * 29720902
*       'RWTGC'- ADDRESS OF THE CURRENT WHERE-TO-GO TABLE ENTRY;      * 29721002
*       'RTIOT'- ADDRESS OF THE CURRENT TIOT ENTRY FOR THE DCB;       * 29721102
*       'RUCB' - ADDRESS OF THE CURRENT UCB FOR THE DCB;              * 29722002
*       'RDEB' - ADDRESS OF THE DCB'S DEB;                            * 29724002
*    2. CONTROL BLOCK INDICATORS-                                     * 29724102
*       'DCBOFLGS' - X'20', ON - INDICATES THAT CONCATENATION IS      * 29724402
*                                TAKING PLACE.                        * 29724802
*       'DEBFLGS1' - X'80', ON - INDICATES THAT 'OPEN' OR 'EOV' HAS   * 29724902
*                                PREVIOUSLY VERIFIED THE PASSWORD     * 29725302
*                                FOR THIS PROTECTED DATA SET.         * 29725702
*                                                                     * 29726102
* OUTPUT -                                                            * 29726202
*    1. AT EXIT TO IFG0195T (OPEN/EOV SECURITY MODULE)-               * 29726302
*       REGISTER CONTENTS ARE THE SAME AS AT ENTRY EXCEPT THAT        * 29726402
*          REGISTER 'RET' CONTAINS A BRANCH TABLE OFFSET OF '0';      * 29726602
*       CONTROL BLOCK INDICATORS-                                     * 29727002
*          'DCBOFLGS' - X'20', OFF - INDICATES THAT CONCATENATION     * 29727102
*                                    HAS BEEN COMPLETED.              * 29727202
*          'DEBFLGS1' - X'80', OFF - INDICATES THAT THE PASSWORD HAS  * 29727302
*                                    NOT PREVIOULY BEEN VERIFIED.     * 29727402
*    2. AT EXIT TO IFG0552X (EOD FUNCTION)-                           * 29728102
*       REGISTER CONTENTS ARE THE SAME AS AT ENTRY EXCEPT THAT        * 29730102
*          REGISTER 'RET' CONTAINS A BRANCH TABLE OFFSET OF '12'.     * 29730302
*    3. AT EXIT TO THE 'EOV TAPE INPUT VOLUME MOUNT-AHEAD FUNCTION',  * 29730702
*       OUTPUT IS VIRTUALLY THE SAME AS AT INPUT.                     * 29730802
*       BEFORE EITHER EXITING TO THE USER TO TO IFG0551L THE     Y02082 29730902
*       DCB ADDRESS IN THE DEB IS SET TO POINT TO THE USER DCB   Y02082 29731302
*                                                                     * 29731702
* EXTERNAL REFERENCES -                                               * 29732102
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 29732202
*                                                                     * 29732402
* EXITS, NORMAL -                                                     * 29732502
*         IFG0195T - TO VERIFY THAT A SECURITY-PROTECTED DATA SET MAY * 29732602
*                    BE ACCESSED;                                     * 29732702
*                                                                     * 29733202
* EXITS, ERROR -                                                      * 29733302
*         IFG0554A - TO ISSUE ANSI ACCESSABILITY MESSAGE (-2)         * 29733902
*                                                                     * 29735902
*         REFER TO THE PRECEEDING MODULE PROLOG.                      * 29736202
*                                                                     * 29736602
* TABLES/WORK AREAS -                                                 * 29736702
*    THE OPEN, CLOSE, OR EOV WORK AREA AND THE WHERE-TO-GO (WTG)      * 29736802
*    TABLE ARE DESCRIBED BY THE DSECTS AT THE END OF THE LISTING.     * 29736902
*                                                                     * 29737002
* ATTRIBUTES -                                                        * 29737302
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 29737702
*                                                                     * 29738102
* CHARACTER CODE DEPENDENCY -                                         * 29738202
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 29738302
*                                                                     * 29738902
* NOTES -                                                             * 29740902
*                                                                     * 29741002
*********************************************************************** 29741102
*                                                                       29741202
*********************************************************************** 29741302
*              TEST FOR DATA SET SECURITY                             * 29741402
*********************************************************************** 29741802
*                                                                       29742002
ETI24010 EQU   *                        TEST DATA SET SECURITY   YM5950 29742402
*                                                                YM5950 29742602
         TM    JFCBLTYP,JFCBAL          ANSI LABELS SPECIFIED-   YM5950 29742902
         BZ    ETI24012                 IF NOT- TEST SL SECURITY YM5950 29743002
*                                                                YM5950 29743102
*****          PERFORM SECURITY TESTS FOR ANSI ( AL ) DATA SET   YM5950 29743202
*                                                                YM5950 29743402
         CLI   FL1FSEC,BLANK            IS ACCESSIBILITY LIMITED YM5950 29743802
         BE    ETI24018                 ..BR IF NOT TO CONTINUE  YM5950 29743902
         CLI   FL1FSEC,FL1SECTY         SECURITY = READ/WRITE    YM5950 29744502
         BE    ETI24012                 ..BR YES TO TEST DEB FOR YM5950 29744902
*                                       ..PREVIOUS AUTHORIZATION YM5950 29745302
*                                                                YM5950 29745702
*        THE ANSI DATA SET LABEL CONTAINS AN INVALID SECURITY    YM5950 29745802
*        INDICATOR GO TO ISSUE ACCESSIBILITY MESSAGE             YM5950 29745902
*                                                                YM5950 29746102
         MVC   DXRETMOD,ID553F          SET UP RETURN MOD        YM5950 29746202
         MVI   DXRETCOD,K12             SET UP RETURN OFFSET     YM5950 29746302
*                                                                YM5950 29746402
         LA    R1,K2                    ACCESSABILITY CODE       YM5950 29746602
         L     RTIOT,DXTIOTAD           RELOAD TIOT PTR        @ZA03660 29746737
*                                                                YM5950 29746837
         IECRES LOAD,MODID=ID554J,BRCODE=K8,BRANCH=QUEUED        YM5950 29746937
*                                                                YM5950 29747037
ETI24011 EQU   *                        RETURN FROM DISMOUNT     YM5950 29747137
*                                                                YM5950 29747237
*        REJECT VOLUME AND ABEND                                 YM5950 29747337
         L     RTIOT,DXTIOTAD           RELOAD TIOT PTR        @ZA03660 29747437
         LA    R0,EABD249               937-20 ABEND             YM5950 29747537
         MVC   DXRETMOD,ID553F          SET UP RETURN MOD        YM5950 29747637
         MVI   DXRETCOD,K0              SET UP RETURN OFFSET     YM5950 29747737
*                                                                YM5950 29747837
         IECRES LOAD,MODID=ID3F4A,BRCODE=K16,BRANCH=QUEUED       YM5950 29747937
*                                                                YM5950 29748037
*****          CONTINUE SECURITY TESTS FOR SL AND AL DATA SETS   YM5950 29748137
*                                                                YM5950 29748237
ETI24012 EQU   *                        TEST LABEL SECURITY      YM5950 29748337
*                                                                YM5950 29748437
         NI    DEBFLGS1,X'FF'-DEBPWCKD  CLEAR THE                YM5950 29748537
*                                       'PASSWORD ..CHECKED'     YM5950 29748637
*                                       INDICATOR                YM5950 29748737
*                                                                YM5950 29748837
         CLI   FL1FSEC,FL1SECTY         SECURITY FOR READ/WRITE  YM5950 29748937
         BE    ETI24014                 BRANCH YES, GET PASSWORD YM5950 29749037
         CLI   FL1FSEC,FL1WRSEC         SECURITY FOR WRITE ONLY  YM5950 29749137
         BNE   ETI24018                 ..BR IF NOT TO CONTINUE  YM5950 29749237
*                                                                YM5950 29749337
*****          A PASSWORD IS REQUIRED IF THE USER HAS OPENED FOR YM5950 29749437
*****          'INOUT' AND THE DATA SET IS PROTECTED FOR OUTPUT  YM5950 29749537
*                                                                YM5950 29749637
         TM    DEBOPATB,DEBOPOUT-DEBOPRBK INPUT OR READBACK      YM5950 29749737
         BZ    ETI24018                 ..BRANCH IF YES          YM5950 29749837
*                                                                YM5950 29750002
*                                       ..MODE IS 'INOUT'        YM5950 29750202
ETI24014 EQU   *                        MODE IS INOUT            YM5950 29752202
*                                                                YM5950 29752302
         NI    DCBOFLGS,ALLBITS-DCBOCON SET OFF CONCATENATION    YM5950 29752602
*                                                                YM5950 29752702
         MVC   DXRETMOD,ID553F          SET UP RETURN LOAD       YM5950 29752802
         MVI   DXRETCOD,K8              SET UP RETURN OFFSET     YM5950 29752902
         L     RTIOT,DXTIOTAD           RELOAD TIOT PTR        @ZA03660 29753037
*                                                                YM5950 29753137
         IECRES LOAD,MODID=ID3F5T,BRCODE=K0,BRANCH=QUEUED        YM5950 29753237
*                                                                YM5950 29753502
ETI24016 EQU   *                        RETURN FROM PASSWORD     YM5950 29753602
*                                                                YM5950 29753902
         L     RDEB,DCBDEBAD            RESTORE PTR TO DEB       YM5950 29754002
         OI    DEBFLGS1,DEBPWCKD        TURN ON PASSWORD CHECK   YM5950 29754202
*                                                                YM5950 29754702
ETI24018 EQU   *                        READ HDR2 LABEL          YM5950 29754802
*                                                                YM5950 29754902
         TM    SRTESTAB,UCBBSTR         IS ANSI VOL MOUNTED       99223 29755002
         BO    ETI24100                 ..YES,CHECK FOR USER LABS 99223 29755102
         LA    RD,EABD164               LOAD ERROR CODE           99223 29755202
         BAL   RC,ETI26400              GO READ LABEL             99223 29755402
         BO    ETI24019                 BR, NO ERROR            ZA00011 29755600
         TM    IOBSTAT0,CSWUNITX        WAS A TAPE MARK READ    ZA00011 29755700
         BNO   ETI26500                 NO,BR TO ERROR ROUTINE  ZA00011 29757100
         MVC   DXCCW1(K16),BSFNOP1      SET UP 'BSF,NOP' CCWS   ZA00011 29761100
         LA    RD,EABD196               LOAD INT ERROR CODE     ZA00011 29761500
         BAL   RC,ETI26400              GO BACKSPACE FILE       ZA00011 29761600
         BNO   ETI26500                 BR IF I/O ERROR         ZA00011 29761700
         B     ETI24100                 BR,TEST FOR USER LABELS ZA00011 29761800
ETI24019 EQU   *                                                ZA00011 29761900
         BAL   RC,ETI26420              GO VERIFY LABEL TYPE      99223 29762000
*                                                                       29763202
         B     ETI24050                 GO BACKSPACE,NO LAB 2     99223 29764602
**                                        RETURN +4 IF LABEL OK   99223 29766002
         CLI   FL2ID+K4,BLANK           IS ID FIELD BLANK         99223 29767402
         BE    ETI24020                 .YES,CHECK FOR CHKPT DS  YM7820 29768802
         CLI   UCBTBYT4,UCB3400         TEST FOR 3400 DRIVE      YM1491 29770202
         BNE   ETI24020                 ..NO,CHECK FOR CHKPT DS  YM1491 29771602
         L     RC,UCBEXTPT              GET UCB EXTEN PTR        Y02146 29773002
         CLI   UCBSNSCT-UCBCMEXT(RC),K24 IS IT 3420?             Y02146 29774402
         BNE   ETI24020                 BR IF NOT                YM1491 29775802
*********************************************************************** 29777202
* IF THE TAPE UNIT IS A 6250 BPI UNIT AND IBM STANDARD LABELS ARE     * 29778602
* BEING PROCESSED,THE SERIAL NUMBER OF THE CREATING TAPE DEVICE       * 29780002
* IS OBTAINED FROM THE HDR2/EOF2/EOV2 LABEL AND PLACED IN THE UCB     * 29781402
* EXTENSION AREA ON THE TAPE UNIT THAT IS PROCESSING THE TAPE.        * 29783202
*********************************************************************** 29786202
         PACK  DXCCW6,FL2ID             CONVERT TAPE ID FROM      99223 29789202
         CVB   RB,DXCCW6                --INSURE PROPER SIGN      99223 29795202
         L     RC,UCBXTN                POINT TO UCB EXTENSION    99223 29798202
         MODESET EXTKEY=SUPR            SET KEY TO UCB KEY        99223 29801202
         USING UCBMT,RC                                           99223 29804202
         STH   RB,UCBCTD                STORE TAPE ID            YM8550 29807202
         DROP  RC                                                 99223 29810202
ETI24020 EQU   *                        BEGIN CHKPT DS TEST      Y02083 29813202
         L     RC,DXDSAB                ADDRESS OF DSAB          Y02083 29816202
         USING DSAB,RC                  ADDRESS DSAB             Y02083 29819202
         MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 29822202
         NI    DSABFLG4,X'FF'-DSABCKVL  ZERO DSAB CHKPT VOL IND  Y02083 29825202
         MODESET EXTKEY=DATAMGT         RETURN TO D/M KEY        Y02083 29828202
*****************************************************************Y02083 29831202
* IF THIS IS A CHECKPOINT DATA SET, MAKE SURE THE VOLUME IS      Y02083 29834202
* SECURE. IF IT IS NOT OR A NON-CHECKPOINT DATA SET IS           Y02083 29837202
* ATTEMPTING TO USE A SECURE VOLUME, ABORT.                      Y02083 29840202
*****************************************************************Y02083 29843202
         CLI   FL2DSIND,CHARC           FL2DSIND=C (CHKPT DS)    Y02083 29843602
         BNE   ETI24035                 NO, FIND DATA SET TYPE   Y02083 29843702
*****************************************************************Y02083 29843802
* ASK OPERATOR IF THIS IS AN OLD SECURE VOLUME                   Y02083 29843902
*****************************************************************Y02083 29846202
ETI24025 EQU   *                        START WTOR LOGIC         Y02083 29846402
         MVC   DXRETMOD,ID553F          SET RETURN NAME & EPA    Y02083 29846602
         MVI   DXRETCOD,K4              SET BR TAB RETURN VALUE  Y02083 29846802
         XC    DXWORK1,DXWORK1          CLEAR WTOR REPLY AREA    Y02083 29847002
         LA    R1,DXWORK1               POINT TO REPLY AREA      Y02083 29847202
         LA    R0,K3                    SET REPLY LENGTH         Y02083 29847402
         SLL   R0,K24                   MOVE LENGTH TO HI BYTE   Y02083 29847602
         OR    R1,R0                    SET UP WTOR PARMS        Y02083 29847802
         L     RTIOT,DXTIOTAD           RELOAD TIOT PTR        @ZA03660 29847937
         IECRES LOAD,MODID=ID554J,BRCODE=K56,BRANCH=QUEUED       Y02083 29848002
ETI24030 EQU   *                        WAIT RETURN ENTRY        Y02083 29848202
         IECRES WAIT                    WAIT FOR REPLY           Y02083 29848402
         OC    DXWORK1(K3),BLANKS       FOLD REPLY TO UPPER CASE Y02083 29848602
         CLC   KYES,DXWORK1             REPLY=YES                Y02083 29848802
         BE    ETI24040                 IF YES, CONTINUE         Y02083 29849002
         CLC   KNO,DXWORK1              REPLY=NO                 Y02083 29849202
         BNE   ETI24025                 IF NOT, ISSUE MSG AGAIN  Y02083 29849402
*****************************************************************Y02083 29849602
* DATA SET NOT IDENTIFIED AS CHECKPOINT DATA SET                 Y02083 29849802
*****************************************************************Y02083 29850002
ETI24035 EQU   *                        BEGIN TEST FOR ERROR     Y02083 29850202
         TM    DSABFLG4,DSABCKDS        CHKPT DS IND ON IN DSAB  Y02083 29850402
         BNO   ETI24100                 IF NOT, CONTINUE         Y02083 29850602
         LA    R0,EABD240               LOAD INTERNAL ABEND CODE Y02038 29850802
         DMABCOND (R0),ID3D0P           ISSUE 937-10 ABEND       Y02083 29850902
*****************************************************************Y02083 29851402
* DATA SET WAS IDENTIFIED AS A CHECKPOINT DATA SET               Y02083 29852802
*****************************************************************Y02083 29854202
ETI24040 EQU   *                        BEGIN TEST FOR ERROR     Y02083 29855602
         L     RTIOT,DXTIOTAD           RELOAD TIOT PTR        @ZA03660 29855737
         TM    DSABFLG4,DSABCKDS        CHKPT DS IND ON IN DSAB  Y02083 29857002
         BO    ETI24045                 IF YES, CONTINUE         Y02083 29858402
         LA    R0,EABD241               LOAD INTERNAL ABEND CODE Y02083 29859802
         DMABCOND (R0),ID3D0P           ISSUE 937-14 ABEND       Y02083 29861202
*****************************************************************Y02083 29862602
* SET SECURE CHECKPOINT VOLUME INDICATOR IN DSAB                 Y02083 29864002
*****************************************************************Y02083 29865402
ETI24045 EQU   *                        SET DSAB VOL IND         Y02083 29866802
         MODESET EXTKEY=SCHED           SHIFT TO DSAB KEY        Y02083 29868202
         OI    DSABFLG4,DSABCKVL        SET DSAB CHKPT VOL IND   Y02083 29869602
         MODESET EXTKEY=DATAMGT         RETURN TO D/M KEY        Y02083 29871002
         B     ETI24100                 GO CHECK USER LABELS      99223 29872402
ETI24050 EQU   *                        BACKSPACE RECORD          99223 29873802
         MVI   DXCCW1,CCWBSR            SET 'BSR' OP CODE         99223 29875202
         LA    RD,EABD196               LOAD INT ERROR CODE       99223 29890802
         MVC   DXCCW1+K1(K15),BSFNOP1+K1  COMPLETE CCW FOR BSR    99223 29906402
*                                       --AND INSERT 'NOP'        99223 29922002
         BAL   RC,ETI26400              GO BACKSPACE RECORD       99223 29937602
         BNO   ETI26500                 BR IF I/O ERROR           99223 29953202
*                                                                       29968802
*********************************************************************** 29984402
*              USER HEADER LABEL PROCESSING                           * 30000021
*********************************************************************** 30100021
*                                                                       30200021
****           DETERMINE IF USER LABELS ARE TO BE PROCESSED             30300021
*                                                                       30400021
ETI24100 EQU   *                        CHECK FOR USER LABELS           30500002
         L     RDEB,DCBDEBAD            RESTORE THE DEB ADDRESS         30600021
         TM    JFCBLTYP,JFCBUL          WERE USER LABELS SPECIFIED-     30700021
         BNO   ETI26100                 ..BR IF NOT- BYPASS USER LBLS   30800021
         TM    DCBMACRF,DCBMEXCP        IS THE ACCESS METHOD EXCP-      30900021
         BZ    ETI24200                 ..BR IF NOT- TEST FOR EXIT LIST 31000021
         TM    DCBMACRF,DCBMFOUN        IS THERE A TAPE DEPEND SECTION- 31100021
         BZ    ETI26100                 ..BR IF NOT- BYPASS USER LBLS   31200021
ETI24200 EQU   *                        TEST FOR EXIT LIST              31300002
         L     RC,DCBEXLST              LOAD EXIT LIST ADDR FROM DCB    31400021
         LA    RC,K0(,RC)               ZERO HIGH ORDER BYTE            31500021
         LTR   RC,RC                    IS THERE A DCB EXIT LIST-       31600021
         BE    ETI26100                 ..BR IF NOT- BYPASS USER LBLS   31700021
ETI24300 EQU   *                        USER LABEL PROCESSING           31800002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 31805002
         CLI   K0(RC),XLIUHL            IS THERE AN INPUT HDR LBL EXIT- 31900021
         BE    ETI24500                 ..BR IF YES- CHECK FOR ADDR     32000021
         CLI   K0(RC),LASTNTRY+XLIUHL   IS 'LAST ENTRY' IND ALSO ON-    32100021
         BE    ETI24500                 ..BR IF YES- CHECK FOR ADDR     32200021
ETI24400 EQU   *                        CHECK FOR LAST ENTRY            32300002
         TM    K0(RC),LASTNTRY          IS THIS THE LAST LIST ENTRY-    32400021
         LA    RC,K4(,RC)               POINT TO NEXT ENTRY             32500021
         BNO   ETI24300                 ..BR IF NOT- CHECK NEXT ENTRY   32600021
         B     ETI26100                 ..ELSE BYPASS USER LABELS       32700021
ETI24500 EQU   *                        CHECK FOR VALID EXIT ADDRESS    32800002
         L     RC,K0(,RC)               LOAD EXIT LIST ADDRESS          32900021
         LA    RC,K0(,RC)               ZERO THE HIGH ORDER BYTE        33000021
         LTR   RC,RC                    IS THERE A VALID ADDRESS-       33100021
         BZ    ETI26100                 ..BR IF NOT- BYPASS USER LABELS 33200021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 33205002
*                                                                       33300021
*****          PROCESS USER HEADER LABELS                               33400021
*                                                                       33500021
ETI24600 EQU   *                        PROCESS USER HEADER LABELS      33600002
* OBTAIN MAIN STORAGE FOR USER LABEL WORK AREA                   Y02080 33650002
         IECRES GET,LV=USERLDM,PREFIX=YES,SP=K229,               Y02082*33655002
               STM=(2,14,WTGPREFX),ID=ULWA                       Y02144 33657002
         USING ULDMWK,R1                                         Y02082 33665002
         STM   RES,RC,ULREGSAV          SAVE REGS 5 - 12         Y02082 33670002
         DROP  R1                                                       34200021
*                                                                       34300021
*****          RUCB IS NOW USED AS THE USER LABEL WORK AREA BASE REG    34400021
*                                                                       34500021
         LR    RUCB,R1                  PT TO GOTTEN CORE        Y02082 34510002
         USING ULDMWK,RA                ESTAB ADDRESSABILITY     Y02082 34520002
*    GET USER'S USER LABEL WORK AREA                             Y02082 34530002
         IECRES GET,LV=USERLU,PREFIX=NO,KEY=USER,SP=K229,        Y02082*34540002
               STM=(2,14,WTGPREFX)                               Y02082 34550002
         USING ULUWK,R9                 ESTAB ADDRESSABILITY     Y02082 34560002
         LR    R9,R1                    PT TO GOTTEN CORE        Y02082 34570002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 34580002
         LA    R1,CHAR0                 INITIALIZE LABEL COUNT          34800021
         STH   R1,ULCNT                 ..AND SAVE FOR LATER USE        34900021
ETI24700 EQU   *                        SET UP READ CCW                 35000002
         LA    R1,ULDMBUFR              ADDR OF LABEL BUFFER     Y02082 35010002
         ST    R1,DXCCW1                ..AND STORE IN READ CCW         35200021
         MVI   DXCCW1,CCWRDTAP          INITLZ CCW FOR READ COMMAND     35300021
*                                       INDICATOR ON LNG STILL IN CCW)  35400021
         MVI   DXCCW1+K4,CCWSILI        SET 'SILI' FLAG ON              35500002
ETI24800 EQU   *                        READ LABEL                      35600002
         BAL   RC,ETI26400              BR AND LINK TO READ A LABEL     35700021
         BO    ETI24900                 BR IF NO I/O ERROR              35800021
         TM    IOBSTAT0,CSWUNITX        WAS A TAPE MARK READ-           35900021
         BO    ETI25700                 ..BR IF YES                     36000021
         B     ETI25600                 ..ELSE BR RO PROCESS ERROR      36100021
ETI24900 EQU   *                        NO TAPE MARK READ               36200002
         TM    JFCBLTYP,JFCBAL+JFCBUL   WERE ANSI USER LBLS SPECIFIED-  36300021
         BNO   ETI25000                 ..BR IF NOT- BYPASS TRANSLATION 36400021
         XLATE ULDMBUFR,K80             TRANSLATE ANSI LABEL     Y02082 36410002
ETI25000 EQU   *                        CHECK FOR HDR/TRLR              36600002
         CLC   ULDMBUFR(K3),AUHL7       USER HRD LABEL READ?     Y02082 36700002
         BE    ETI25100                 ..BR IF YES                     36800021
         CLC   ULDMBUFR(K3),AUTL7       USER TRLR LABEL READ?    Y02082 36900002
         BE    ETI25100                 ..BR IF YES                     37000021
*                                                                       37100021
*              NOTE - INPUT TRAILER LABEL PROCESSING LEAVES THE TAPE    37200021
*              POSITIONED BETWEEN THE FIRST AND SECOND DATA SET         37300021
*              TRAILER LABELS. THE FOLLOWING ALLOWS PROCESSING OF USER  37400021
*              LABELS EVEN THOUGH THE TAPE MAY CONTAIN MORE DATA SET    37500021
*              LABELS THAN CAN CURRENTLY BE CREATED UNDER O/S.          37600021
*                                                                       37700021
         BAL   RC,ETI26420              GO VERIFY LABEL TYPE      99223 37750002
         B     ETI25050                 WRONG LABEL TYPE          99223 37760002
         B     ETI24800                 GO READ NEXT LABEL        99223 37770002
ETI25050 EQU   *                        BACKSPACE RECORD          99223 37780002
         MVI   DXCCW1,CCWBSR            INITLZ CCW FOR 'BSR' COMMAND    38400021
         B     ETI25900                 BR- AN 'UNKNOWN' LABEL WAS READ 38500021
ETI25100 EQU   *                        HEADER/TRAILER READ             38600002
         MVC   ULCNT+K1(K1),ULDMBUFR+K3 SAVE LABEL NUMBER        Y02082 38603002
*                                                                Y02082 38606002
*    COPY LABEL TO USER'S BUFFER                                 Y02082 38609002
*                                                                Y02082 38612002
         L     RF,WTGPREFX              POINT TO PREFIX          Y02082 38615002
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y02082 38618002
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          Y02082 38621002
*    OBTAIN LOCAL LOCK                                           Y02082 38624002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*38627002
               RELATED=('PREVENT FREE USER CORE-RELEASED BELOW') Y02082 38630002
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 38633002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 38636002
*    VERIFY USER STILL HOLDS USER LABEL WORK AREA                Y02082 38639002
         OC    ULUWK(USERLU),ULUWK      PGM CHECK IF NOT         Y02082 38642002
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          Y02082 38645002
         MVC   ULBUFR,ULDMBUFR          COPY LABEL TO USER       Y02082 38648002
         L     RF,WTGPREFX              PT TO PREFIX             Y02082 38651002
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y02082 38654002
*    RELEASE LOCAL LOCK                                          Y02082 38657002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=('SEE ABOVE')        Y02082 38660002
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 38663002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 38666002
         XC    ULPARM+K8(K4),ULPARM+K8  ZERO ERROR IND                  38800002
*                                                                       38900021
*****          PASS CONTROL TO USER FOR USER PROCESSING                 39000021
*                                                                       39100021
ETI25200 EQU   *                        GIVE CONTROL TO CALLER          39200002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 39210002
         NI    DCBOFLGS,X'FF'-DCBOLOCK  IND USER EXIT TAKEN      Y02082 39220002
*                                                                Y02082 39240002
* COPY THE DCB FROM THE WORK AREA TO USER'S STORAGE              Y02082 39260002
*                                                                Y02082 39280002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,WTGPREFX)          Y02082 39284002
*                                                                Y02082 39288002
         LA    R1,ULBUFR                POINT TO LABEL BUFFER           39300021
         LA    RD,ETI25500              LOAD ADDR FOR RETURN FROM SYNCH 39400021
ETI25300 EQU   *                        SYNCH TO CALLER                 39500002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 39550002
         ST    R1,ULPARM                PTR TO LABEL BUFFER      Y02082 39600002
         L     R1,DXUDCBAD              GET USER'S DCB ADDR      Y02082 39650002
         ST    R1,ULPARM+K4             PUT IN PARM LIST         Y02082 39700002
         XC    ULTOTPTR(K4),ULTOTPTR    ZERO THE USER TOTALING ENTRY    39800021
         MVI   ULDCBPTR,K0              CLEAR FLAG BYTE                 39900021
         LA    R1,ULPARM                POINT TO PARAMETER LIST         40000021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 40050002
         IECRES UEXIT,EXITAD=ULREQ,STM=(2,13,WTGPREFX)           Y02082 40100002
         L     RDCB,DXUDCBAD            PT TO CALLER'S DCB       YM3005 42762002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME CALLER'S KEY    YM3005 42772002
         OI    DCBOFLGS,DCBOLOCK        INDICATE RETURN FR USER  Y02082 42774002
         LA    R0,ALLBITS-DCBOBUSY      ISOLATE BUSY BIT MASK    YM3005 42776002
         IC    R1,DCBOFLGS              GET CALLER'S OFLGS       YM3005 42776402
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM3005 42813602
         L     RDCB,DXPDCBAD            PT TO COPIED DCB         YM3005 42823602
         OR    R0,R1                    ISOLATE CALLER BUSY BIT  YM3005 42833602
         IC    R1,DCBOFLGS              GET COPIED DCBOFLGS      YM3005 42843602
         NR    R1,R0                    UPDTE BUSY BIT TO CALLER YM3005 42845602
         STC   R1,DCBOFLGS              UPDATE OFLGS FIELD       YM3005 42847602
         OI    DCBOFLGS,DCBOLOCK        INDICATE RETURN FR USER  YM5981 42897602
         BR    RD                       RETURN TO CALLER                43100021
ETI25500 EQU   *                        RETURN FROM SYNCH               43200002
         CH    RF,RDAGAIN1              SHOULD ADD'L LABELS BE READ-    43300021
         BNE   ETI26000                 ..BR IF NOT- ALL DONE           43400021
         TM    JFCBLTYP,JFCBAL+JFCBUL   WERE ANSI USER LBLS SPECIFIED-  43500021
         BO    ETI24800                 ..BR IF YES- READ ANOTHER LABEL 43600021
         CLI   ULCNT+K1,MAXNOLAB        HAS MAX NO. OF LABELS BEEN READ 43700002
         BNL   ETI26000                 ..BR IF YES- ALL DONE           43800021
         B     ETI24800                 ..BR IF NOT TO READ NEXT LABEL  43900021
*                                                                       44000021
*****          ERROR ENCOUNTERED DURING READ                            44100021
*                                                                       44200021
ETI25600 EQU   *                        READ ERROR                      44300002
         LH    R1,ULCNT                 LOAD THE CURRENT LABEL NUMBER,  44700021
         LA    R1,K1(,R1)               ..INCREMENT IT BY 1, AND        44800021
         STH   R1,ULCNT                 ..SAVE IT IN THE WORK AREA      44900021
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 44903002
         STC   R1,ULBUFR+K3             SAVE NO. OF LABEL WHICH COULD   45000002
*                                       ..NOT BE READ                   45100021
         LA    R1,DXIOB                 PTR TO STATUS INFO       Y02082 45103002
         ST    R1,ULPARM+K8             PUT IN PARM LIST         Y02082 45106002
         OI    ULPARM+K8,ERROR          INDICATE ERROR           Y02082 45109002
         B     ETI25200                 BR TO SYNCH TO USER             45200021
*                                                                       45300021
*              A TAPE MARK HAS BEEN READ. IF USER HAS PREVIOUSLY        45400021
*              PROCESSED ANY LABELS,  REPOSITION TAPE, FREEMAIN,        45500021
*              AND RETURN TO CALLER. IF USER HAS NOT PREVIOUSLY         45600021
*              PROCESSED ANY LABELS, SYNCH TO USER WITH LABEL           45700021
*              BUFFER POINTER SET TO ZERO, THEN REPOSITION              45800021
*              TAPE, FREEMAIN, AND RETURN TO CALLER.                    45900021
*                                                                       46000021
ETI25700 EQU   *                        TAPE MARK READ                  46100002
         CLI   ULCNT+K1,CHAR0           HAVE ANY LABELS BEEN PROCESSED- 46200002
         BH    ETI25800                 ..BR IF YES- ALL DONE           46300021
         TM    JFCBLTYP,JFCBAL+JFCBUL   WERE ANSI USER LBLS SPECIFIED-  46400021
         BO    ETI25800                 ..BR IF YES- ALL DONE           46500021
         MODESET EXTKEY=SUPR            SUPERVISOR KEY           Y02082 46503002
         XC    ULPARM+K8(K4),ULPARM+K8  ZERO ERROR PARAMETER            46600002
         SR    R1,R1                    ZERO BUFFER POINTER             46700021
         BAL   RD,ETI25300              BR AND LINK TO SYNCH TO USER    46800021
ETI25800 EQU   *                        BSF                             46900002
         MVI   DXCCW1,CCWBSF            INITLZ CCW FOR 'BSF' CMD M0961  47000021
ETI25900 EQU   *                        BSF                             47100002
         LA    RD,EABD196               LOAD INTERNAL ERROR CODE        47200021
         MVC   DXCCW1+K1(K15),BSFNOP1+K1 COMPLETE BACKSPACE CCW  M0961  47300002
*                                       ..AND INSERT 'NOP' CCW   M0961  47350021
         BAL   RC,ETI26400              BR AND LINK TO BACKSPACE        47400021
         BNO   ETI26500                 BR IF I/O ERROR                 47500021
ETI26000 EQU   *                        NO I/O ERROR                    47600002
*                                                                Y02082 47620002
*    FREEMAIN USER LABEL WORK AREAS                              Y02082 47640002
*                                                                Y02082 47660002
         IECRES FREE,A=(9),LV=USERLU,PREFIX=NO,SP=K229,          Y02082*47680002
               KEY=USER,STM=(2,14,WTGPREFX)                      Y02082 47700002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 47720002
         DROP  R9                                                Y02082 47740002
         LR    R1,RUCB                  CORE ADDR TO BE FREED    Y02082 47760002
         LM    RES,RC,ULREGSAV          RESTORE REGS 5 - 12      Y02082 47780002
         IECRES FREE,A=(1),PREFIX=YES,STM=(2,14,WTGPREFX)        Y02082 47800002
         USING UCB,RUCB                 RE-ESTABLISH UCB ADDRESSABILITY 48100021
*                                                                       48200021
*********************************************************************** 48300021
*              POSITION NEW VOLUME TO FIRST DATA RECORD               * 48400021
*********************************************************************** 48500021
*                                                                       48600021
ETI26100 EQU   *                        POSITION TO DATA RECORD         48700002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 48705002
         LA    RD,EABD191               LOAD INTERNAL ERROR CODE        48800021
         MVC   DXCCW1,AFSFCCW           INITLZ CCW FOR FSF COMMAND      48900021
         TM    DCBOFLGS,DCBORDBK        IS THE DCB OPENED FOR 'RDBACK'- 49000021
         BNO   ETI26200                 ..BR IF NOT TO ISSUE FSF        49100021
         MVI   DXCCW1,CCWBSF            INITLZ CCW FOR BSF COMMAND      49200021
ETI26200 EQU   *                        POSITION TAPE                   49300002
         BAL   RC,ETI26400              BR AND LINK TO POSITION TAPE    49400021
         BNO   ETI26500                 BR IF I/O ERROR                 49500021
         MVI   DXCCW1,CCWNOP            INITLZ CCW FOR 'NOP' COMMAND    49600021
         BAL   RC,ETI26400              BR TO WAIT FOR DEVICE END       49700021
         BO    ETI26300                 BR IF NO I/O ERROR              49800021
         TM    IOBSENS1,UCBLDPT         IS THE TAPE AT 'LOAD POINT'-    49900021
         BNO   ETI26500                 ..BR IF NOT TO ERR RTN          50000021
*                                       ..ELSE DROP THROUGH TO EXIT     50100021
         SPACE 2                                                        50200021
*********************************************************************** 50300021
*              EXIT                                                   * 50400021
*********************************************************************** 50500021
*                                                                       50600021
ETI26300 EQU   *                        EXIT                            50700002
         L     RTIOT,DXTIOTAD           RELOAD TIOT PTR        @ZA03660 50700137
         IECRES LOAD,MODID=MOD3F3H,BRCODE=K0,BRANCH=QUEUED       Y02080 50850002
*                                    INVOKE IECRES MACRO TO XCTL Y02080 50900002
         EJECT                                                          51400021
*********************************************************************** 51500021
*              SUBROUTINES                                            * 51600021
*********************************************************************** 51700021
*                                                                       51800021
*****          CLOSED SUBROUTINE TO PERFORM I/O OPERATIONS              51900021
*****          ENTRY TO THE SUBROUTINE IS VIA A 'BAL  RC,ETI26400'      52000021
*                                                                       52100021
ETI26400 EQU   *                        I/O SUBROUTINE                  52200002
         EXCP  DXIOB                    INITIATE I/O OPERATION          52300021
         IECRES WAIT                    INVOKE IECRES MACRO TO 'WAIT'   52400021
         TM    DXECB,ECBNOERR           TEST FOR AN I/O ERROR-          52500021
         BR    RC                       RETURN TO CALLER WITH           52600021
*                                       ..CONDITION CODE SET            52700021
         SPACE 2                                                        52800021
*  CLOSED SUBROUTINE USED TO VERIFY THAT LABEL IS HDR,EOF,OR EOV. 99223 52810002
*  RETURN TO CALLER VIA REGISTER RC.RETURN IS RC+4 IF PROPER TYPE.99223 52820002
ETI26420 EQU   *                        VERIFY HDR,EOF,EOV        99223 52830002
         CLC   FL1LABI,AHDR7            HEADER LABEL              99223 52840002
         BE    ETI26430                 YES,RETURN PLUS FOUR      99223 52850002
         CLC   FL1LABI,AEOF7            E-O-F LABEL               99223 52860002
         BE    ETI26430                 YES,RETURN PLUS FOUR      99223 52870002
         CLC   FL1LABI,EOV7             E-O-V LABEL               99223 52880002
         BNE   ETI26440                 YES,TAKE NORMAL RETURN    99223 52890002
ETI26430 EQU   *                        RETURN PLUS FOUR          99223 52892002
         LA    RC,K4(RC)                ADD 4 TO RETURN ADDR      99223 52894002
ETI26440 EQU   *                        NORMAL RETURN             99223 52896002
         BR    RC                       RETURN TO CALLER          99223 52898002
         SPACE 2                                                        52898402
*********************************************************************** 52900021
*              ERROR PROCESSING                                       * 53000021
*********************************************************************** 53100021
*                                                                       53200021
ETI26450 EQU   *                        ERROR PROCESSING                53300002
         LA    RD,EABD165               LOAD INTERNAL ERROR CODE        53400021
ETI26500 EQU   *                        ABEND                           53500002
         DMABCOND (RD),ABEND3F          EXIT TO PROB DETERMINATION RTN  53600021
         SPACE 2                                                        53700021
*********************************************************************** 53800021
*                                                                     * 53804037
*           CLOSED SUBROUTINE TO BYPASS LEADING TAPE MARK.            * 53808037
*      READ ONE RECORD. TEST TO SEE IF A TAPE MARK WAS READ. IF SO,   * 53812037
*      THE TAPE IS PROPERLY POSITIONED. IF A TAPE MARK WAS NOT READ   * 53816037
*      BACKSPACE ONE RECORD.                                          * 53820037
*                                                                     * 53824037
*********************************************************************** 53828037
ETI26600 MVC   DXCCW1,BSFNOP1+K8        MOVE IN CCW            @ZA28943 53832037
         LA    RF,DXLBL                 GET READ ADDRESS       @ZA28943 53836037
         ST    RF,DXCCW1                STORE ADDR IN CCW      @ZA28943 53838037
         MVI   DXCCW1,CCWRDTAP          INSERT READ OP         @ZA28943 53844037
         MVI   DXCCW1+K7,K12            SET READ LENGTH TO 12  @ZA28943 53848037
         BAL   RC,ETI26400              GO READ A RECORD       @ZA28943 53852037
         BO    ETI26650                 ECB=3F GO BSR          @ZA28943 53856037
         TM    IOBSTAT0,CSWUNITX        WAS A TAPE MARK READ ? @ZA28943 53860037
         BCR   1,RB                     YES RETURN             @ZA28943 53864037
         B     ETI26500                 NO ! BR I/O ERROR      @ZA28943 53868037
ETI26650 MVC   DXCCW1,BSFNOP1+K8        MOVE IN NEW CCW        @ZA28943 53872037
         MVI   DXCCW1,CCWBSR            INSERT BSR OP          @ZA28943 53876037
         BAL   RC,ETI26400              BACKSPACE THE RECORD   @ZA28943 53880037
         BNO   ETI26500                 I/O ERROR              @ZA28943 53884037
         BR    RB                       RETURN                 @ZA28943 53888037
         SPACE 2                                                        53892037
*********************************************************************** 53896037
*              CONSTANTS                                              * 53900021
*********************************************************************** 54000021
*                                                                       54100021
REWND    CCW   X'07',0,X'20',1          REWIND CCW                      54120002
ARDCCW0C DC    X'00000050'              CCW FOR READ OP - NO FLAGS,80 C 54160002
AFSFCCW  CCW   X'3F',0,X'20',1          FORWARD SPACE FILE              54200021
BSFNOP1  DC    X'2F00000060000001'      BSF COMMAND, CMD CHAIN,  M0961  54300021
*                                       ..SILI, AND LNG EQUAL 1  M0961  54350021
         DC    X'0300000020000001'      NOP CMD, SILI, LNG EQ 1  M0961  54400021
ARDCCW7  DC    X'00000050'              LENGTH EQ 50 FOR RD DATA M0961  54500021
RDAGAIN1 DC    H'4'                     'READ LABEL AGAIN' CODE  M0961  54600021
CONSTONE DC    X'0001'                  CONSTANT ONE             Y02134 54620002
CONTHREE DC    X'0003'                  HALFWORD CONSTANT OF 3   Y02134 54640002
AVOL0C   DC    C'VOL'                   VOLUME LABEL IDENTIFIER  Y02134 54660002
AHDR     DC    C'HDR'                   HEADER LABEL IDENTIFIER  Y02134 54680002
UVOL3D   DC    C'UVOL'                  USER VOLUME LABEL ID     Y02134 54700002
AVOL7    DC    C'VOL'                   VOLUME IDENTIFIER               54800021
AHDR7    DC    C'HDR'                   HEADER LABEL IDENTIFIER         54900021
EOV7     DC    C'EOV'                   END OF VOLUME IDENTIFIER        55000021
AEOF7    DC    C'EOF'                   END OF FILE IDENTIFIER          55100021
AUHL7    DC    C'UHL'                   USER HEADER LABEL IDENTIFIER    55200021
AUTL7    DC    C'UTL'                   USER TRAILER LABEL IDENTIFIER   55300021
UVOL0C   DC    C'UVL'                   USER VOLUME LABEL               55400021
BLANKS   DC    C'   '                   3 BLANK CHARACTERS       Y02083 55400202
KYES     DC    C'YES'                   'YES' REPLY MASK         Y02083 55400402
KNO      DC    C'NO '                   'NO ' REPLY MASK         Y02083 55400602
         EJECT                                                          55500021
*********************************************************************** 55600021
*              XCTL TABLE                                             * 55700021
*********************************************************************** 55800021
*                                                                       55900021
XCTLTB3F XCTLTABL ID=(ABEND3F,0P,MOD3F3H,3H,,NSLEHDRI,           Y02134X56000002
               ID3F4A,4A,                                        YM5950X56000102
               ID3D0P,0P,ID553F,3F,ID554J,4J,ID3F5T,5T),         YM5950X56000202
               SVC=055,BRT=YES,LENGTH=                           Y02134 56050002
         SPACE 2                                                        56100021
         IECDSECS CVT,                                                 C56200021
               TCB,                                                    C56300021
               TIOT,                                             Y02134X56320002
               RB,                                                     C56400021
               DCB,                                                    C56500021
               DEB,                                                    C56600021
               UCB,                                                    C56700021
               PSA,                                              Y02082X56720002
               MAIN,                                                   C56800021
               USERLAB,                                                C56900021
               WTG,                                              Y02080*56950002
               PREFX,                                            Y02080*56960002
               RRPL,                                             Y02144*56970002
               DSAB,                                             Y02083*56970202
               EXPAND=YES                                               57000021
         IECEQU ,                       INVOKE OPEN/CLOSE/EOV EQUATES   57100021
         SPACE 2                                                        57200021
         END                                                            57300021
./  ADD  SSI=81430231,NAME=IFG0553H
         TITLE 'IFG0553H - EOV TAPE INPUT STD HEADER LABEL FUNCTION'    00100021
         COPY  LCGASMSW                                                 00150000
IFG0553H CSECT                                                          00400021
         ENTRY IGG0550D                                          Y02080 00450002
IGG0550D EQU   IFG0553H                 ALLIAS ENTRY POINT       Y02080 00500002
*********************************************************************** 00550002
*                                                                     * 00600002
*                                                                     * 00650002
*          VS2 RELEASE 03 DELETIONS/CHANGES                           * 00660037
*                                                                     * 00665037
*101700,104980                                                 @ZA03195 00670037
*0000                                                          @ZA13589 00675037
*                                                                     * 00680037
*          VS2 RELEASE 02 DELETIONS                                   * 00700002
*                                                                     * 00750002
*                                                                     * 00800002
*********************************************************************** 00850002
*                                                                     * 00900002
* MODULE NAME = IFG0553H (OS/VS2)                                     * 00950002
*                                                                     * 01000002
* DESCRIPTIVE NAME = INPUT TAPE - STANDARD HEADER LABEL FUNCTION      * 01050002
*                                                                     * 01100002
* COPYRIGHT = NONE                                                    * 01150002
*                                                                     * 01200002
* STATUS = RELEASE 2, LEVEL 0                                         * 01250037
*                                                                     * 01300002
* FUNCTION =                                                          * 01350002
*        1) ENTRY FROM NSLEHDRI- IF NSLEHDRI INDICATED THAT THE       * 01400002
*        WRONG NSL VOLUME HAD BEEN MOUNTED, CONTROL IS TRANSFERRED    * 01450002
*        TO IFG0194A TO PERFORM THE DISMOUNT/REMOUNT FUNCTION         * 01500002
*        AGAIN.                                                       * 01550002
*        2) FOR EXCP, THE DCB COPY IS PERFORMED, THE EOV WORK AREA    * 02050002
*        IS FREED, AND CONTROL IS RETURNED TO THE CALLER OF EOV.      * 02100002
*        3) IN ALL OTHER CASES, CONTROL IS PASSED TO IFG0551L,        * 02150002
*        THE ACCESS METHOD EXECUTOR.                                  * 02200002
*                                                                     * 02250002
* NOTES = SEE BELOW                                                   * 02300002
*                                                                     * 02350002
*    DEPENDENCIES =                                                   * 02400002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 02450002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 02500002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 02550002
*                                                                     * 02600002
*    RESTRICTIONS = NONE                                              * 02650002
*                                                                     * 02700002
*    REGISTER CONVENTIONS =                                           * 02750002
*            R2 POINTS TO DCB                                         * 02800002
*            R4 POINTS TO OPEN WORK AREA                              * 02850002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 02900002
*            R6 POINTS TO THE WTG TABLE                               * 02950002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 03000002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 03050002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 03100002
*            R10 POINTS TO THE UCB                                    * 03150002
*                                                                     * 03200002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 03250002
*                  END OF LISTING.                                    * 03300002
*                                                                     * 03350002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 03400002
*                                                                     * 03450002
*    PROCESSOR = ASSEMBLER XF                                         * 03500002
*                                                                     * 03550002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 03600002
*                  ORG STATEMENT AT END OF LISTING                    * 03650002
*                                                                     * 03700002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 03750002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 03800002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 03850002
*                                                                     * 03900002
* ENTRY POINT =                                                       * 03950002
*        IFG0553H                                                     * 04000002
*        IGG0550D - ALIAS                                             * 04050002
*                                                                     * 04100002
*    PURPOSE = SEE FUNCTION                                           * 04150002
*                                                                     * 04200002
*    LINKAGE =                                                        * 04250002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 04300002
*        MACRO INSTRUCTION.                                           * 04350002
*                                                                     * 04400002
* INPUT =                                                             * 04450002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 04500002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 04550002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 04600002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 04650002
*                                                                     * 04700002
* OUTPUT =                                                            * 04750002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 04800002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 04850002
*        DEBDCBAD POINTING TO THE COPIED DCB,                         * 04900002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 04950002
*                                                                     * 05000002
* EXIT-NORMAL =                                                       * 05050002
*        IFG0551L - ACCESS METHOD EXECUTOR, BRANCH CODE = 0           * 05100002
*        IFG0554A - MOUNT/VERIFY FUNCTION, BRANCH CODE = 16           * 05150002
*           RETURN MODULE - IFG0553F                                  * 05200002
*                                                                     * 05350002
* EXIT-ERROR =                                                        * 05400002
*                                                                     * 05550002
* EXTERNAL REFERENCES = SEE BELOW                                     * 05600002
*                                                                     * 05650002
*    ROUTINES =                                                       * 05700002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 05750002
*                                                                     * 05800002
*    DATA AREAS =                                                     * 05850002
*        EOV WORKAREA.                                                * 05900002
*                                                                     * 05950002
*    CONTROL BLOCK =                                                  * 06000002
*        CVT                                                          * 06050002
*        DEB                                                          * 06100002
*        JFCB                                                         * 06150002
*        TCB                                                          * 06200002
*        UCB                                                          * 06250002
*        TIOT                                                         * 06300002
*        RB                                                           * 06350002
*                                                                     * 06400002
* TABLES =                                                            * 06450002
*                                                                     * 06500002
* MACROS =                                                            * 06550002
*        IECRES LOAD                                                  * 06600002
*        IECRES INIT                                                  * 06650002
*        IECRES FREE                                                  * 06700002
*        IECRES EXIT                                                  * 06750002
*                                                                     * 06850002
* CHANGE ACTIVITY =                                                   * 06900002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 06950002
*                                                                     * 07000002
*********************************************************************** 07050002
         EJECT                                                          07100002
*                                                                       07300021
*****    INTERNAL ERROR CODES                                           07400021
*                                                                       07500021
EABD193  EQU   193                      ERROR UNLOADING MT AHEAD UNIT   07600002
*                                                                       07700021
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY FOR    07800021
         USING *,RBASE                  THIS SECTION OF CODE            07900021
         USING FORCORE,RCORE                                            08000021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 08050002
         USING IHADCB,RDCB                                              08100021
         USING UCB,RUCB                                                 08200021
         USING TIOENTRY,RTIOT                                           08300021
         USING DEBBASIC,RDEB                                     YM1272 08400002
*                                                                       08500021
*                                                                       08600021
         B     ETI28000(RET)            DETERMINE TYPE OF ENTRY TO MOD  08700021
ETI28000 EQU   *                        BRANCH TABLE                    08800002
         B     ETI30200                 NORMAL ENTRY FOR 553F           08900002
         NOP   K0                       ENTRY NOT IN USE         Y02134 09100002
         NOP   K0                       ENTRY NOT IN USE         Y02134 09250002
         NOP   K0                       ENTRY NOT IN USE         YM1193 09610002
         NOP   K0                       ENTRY NOT IN USE         YM5950 09620002
         B     ETI28100                 BR IF RET FROM NSLEHDRI (20)    09800002
         B     ETI30200                 ENTRY FOR NL (24)        Y02134 09900002
*                                                                       10000021
ETI28100 EQU   *                        NSLEHDRI RETURN                 10100002
         STM   R5,R6,DXREGSAV           SAVE MODESET REGISTERS   Y02082 10100102
         L     RDCB,DXUDCBAD            PT TO CALLER'S DCB       YM3005 10110102
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME CALLER'S KEY    YM3005 10110502
         OC    DCBOFLGS,DCBOFLGS        PGM CHK IF NOT CALLER'S  YM3005 10110902
         LA    R0,ALLBITS-DCBOBUSY      ISOLATE BUSY BIT MASK    YM3005 10120602
         IC    R1,DCBOFLGS              GET CALLER'S OFLGS       YM3005 10122602
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM3005 10124602
         MVI   DXECB,K32                RESTORE DXECB          @ZA13589 10125637
         L     RDCB,DXPDCBAD            PT TO COPIED DCB         YM3005 10126602
         OR    R0,R1                    ISOLATE CALLER BUSY BIT  YM3005 10128602
         IC    R1,DCBOFLGS              GET COPIED DCBOFLGS      YM3005 10129002
         NR    R1,R0                    UPDTE BUSY BIT TO CALLER YM3005 10129402
         STC   R1,DCBOFLGS              UPDATE OFLGS FIELD       YM3005 10129802
         MVC   DXXMODNM(L'IFG055NM),IFG055NM  MOVE IN MOD PREFIX YM3271 10130302
         MVC   DXXMODID,ID3H3H          CHANGE WTG MODULE NAME   YM5950 10140002
         MVC   DXXIDTTR,ID3H3H          ..AND ENTRY IDS TO '3H'  YM5950 10160002
         L     RTIOT,DXTIOTAD           RELOAD TIOT ADDRESS    @ZA03195 10170037
         TM    SRTEDMCT,UCBMOUNT        WAS NSL VOLUME THE CORRECT ONE- 10200021
         BZ    ETI30200                 ..BR IF YES TO EXIT      YM5950 10300002
*                                       ..NO- EXIT TO DISMT/MOUNT RTN   10400021
*                                                                Y02134 10410002
         MODESET EXTKEY=SUPR            UCB KEY                  Y02134 10450002
*                                                                Y02134 10460002
         NI    UCBDMCT,ALLBITS-UCBMOUNT SET OFF NSL REJECT       Y02134 10470002
         XC    UCBVOLI,UCBVOLI          CLEAR WRONG VOL SER      Y02134 10480002
*                                                                Y02134 10490002
         MODESET EXTKEY=DATAMGT         RESET TO DATA MNGMNT KEY Y02134 10492002
*                                                                Y02134 10496002
         SR    R0,R0                    VOL VERIFICATION ERROR @ZA03195 10498037
         MVC   DXRETMOD,ID3H3F          SET RETURN MODULE        Y02134 10500002
         MVI   DXRETCOD,K0              SET OFFSET TO ZERO       YM5950 10550002
*                                                                Y02134 10600002
         LA    RF,ID3H4A                POINT TO REJECT MOD ID   YM5950 10610002
         LA    RET,K16                  LOAD REJECT OFFSET       YM5950 10620002
*                                                                Y02134 10700002
*********************************************************************** 24900002
*              EXITS                                                  * 24950002
*********************************************************************** 25000002
*                                                                       25050002
*****          XCTL VIA THE RESIDENT ROUTINE                            25100002
*                                                                       25150002
ETI30100 EQU   *                        TRANSFER CONTROL VIA RES RTN    25200002
*                                                                Y02134 25210002
         IECRES LOAD,MODID=(RF),BRCODE=(RET),BRANCH=QUEUED       Y02080 25250002
         EJECT                                                          25252002
*                                                                Y02134 25260002
*****          EXIT TO USER OR ACCESS METHOD EXECUTOR                   51600021
*                                                                       51700021
ETI30200 EQU   *                        NOT WRITE ONLY PASSWORD         51800002
         NI    DCBOFLGS,ALLBITS-DCBOCON TURN OFF CONCAT INDIC           51900002
*                                                                       54700021
*****          DETERMINE APPROPRIATE EXIT                               54800021
*                                                                       54900021
ETI30300 EQU   *                        DETERMINE EXIT           Y02080 54950002
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXUDCBAD+K1 POINT DEB  Y02082*54960002
                                        TO USER DCB              Y02082 54970002
         L     RF,DXDEBXAD              GET PTR TO DEB EXTN      YM1272 54992002
         NI    DEBXFLG1-DEBXTN(RF),ALLBITS-DEBXCDCB INDIC PT USERYM1272 54994002
         TM    DCBMACRF,DCBMEXCP        IS THE ACCESS METHOD EXCP-      55000021
         BNZ   ETI30600                 ..BR IF YES TO EXIT             55100021
*                                                                       55200021
*****          EXIT TO THE ACCESS METHOD EXECUTOR                       55300021
*                                                                       55400021
         LA    RF,MOD1L3H               PT TO EXECUTOR ID/TTR    M0110  55440021
         LA    RET,K0                   LOAD ENTRY OFFSET        Y02134 55450002
         B     ETI30100                 BRANCH TO EXECUTOR       Y02134 55470002
         SPACE 2                                                        55920021
*                                                                       56000021
*****          RETURN TO USER                                           56100021
*                                                                       56200021
ETI30600 EQU   *                        RETURN TO CALLER                56300002
         LR    R1,RCORE                 PT TO BEGINNING OF EOV WK AREA  56466700
         NI    DCBOFLGS,ALLBITS-DCBOBUSY RESET I/O SUPPORT BIT          56700002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(0,14,DXXPREFX)          Y02082 56702002
         IECRES FREE,A=(1),PREFIX=EOV   FREE EOV WORK AREA       Y02080 56710002
*                                                                Y02080 56750002
*        RETURN TO CALLER                                        Y02080 56800002
*                                                                Y02080 56802002
         IECRES EXIT                    RETURN                   Y02080 56804002
         EJECT                                                          56890021
         SPACE 2                                                        59200021
*********************************************************************** 59300021
*              CONSTANTS                                              * 59400021
*********************************************************************** 59500021
*                                                                       59600021
IFG055NM DC    C'IFG055'                PREFIX FOR XCTL  (EOV)   YM3271 59690400
*                                                                YM5950 60250002
*********************************************************************** 61400021
*              XCTL TABLE                                             * 61500021
*********************************************************************** 61600021
*                                                                       61700021
XCTLTB3H XCTLTABL ID=(MOD1L3H,1L,ID3H4A,4A,ID3H3F,3F,ID3H3H,3H), YM5950X61800002
               SVC=055,BRT=YES,LENGTH=                           Y02080 61950002
         SPACE 2                                                        62000021
         IECDSECS CVT,                                                 C62100021
               TCB,                                                    C62200021
               RB,                                                     C62300021
               TIOT,                                                   C62400021
               DCB,                                                    C62500021
               IEZDEB,                                           YM1272C62600002
               UCB,                                                    C62700021
               MAIN,                                                   C62800021
               WTG,                                                    C62900021
               PREFX,                                            Y02080*62950002
               EXPAND=YES                                               63000021
         IECEQU IEZDEB=YES              INVOKE OPEN/CLOSE/EOV EQUYM1272 63100002
         SPACE 2                                                        63200021
         END                                                            63300021
./  ADD  SSI=81800185,NAME=IFG0553P
         TITLE 'IFG0553P                      EOV INPUT DA INITIAL MODUL00400002
               LE'                                               Y02134 00450002
IFG0553P CSECT                                                          00650002
*********************************************************************** 00700002
*                                                                     * 00750002
*                                                                     * 00800002
*          VS2 RELEASE 03 DELETIONS                                   * 00810037
*0000450420,451960,457800                                      @ZA01342 00820037
*0000                                                          @ZA08315 00830037
*0000                                                          @ZA13566 00840037
*A45190803,45190804                                            @ZA33029 00845037
*          VS2 RELEASE 02 DELETIONS                                   * 00850002
*                                                                     * 00900002
*                                                                     * 00950002
*********************************************************************** 01000002
*                                                                     * 01050002
* MODULE NAME = IFG0553P (OS/VS2)                                     * 01100002
*                                                                     * 01150002
* DESCRIPTIVE NAME = EOV INPUT DA INITIAL MODULE                      * 01200002
*                                                                     * 01250002
* COPYRIGHT = NONE                                                    * 01300002
*                                                                     * 01350002
* STATUS = RELEASE 2, LEVEL 0                                         * 01400002
*                                                                     * 01450002
* FUNCTION =                                                          * 01500002
*        ENTERED FROM IFG0551H - EOV INITIALIZATION                   * 01550002
*        IFG0554L - RETURN FROM USER TRAILER LABEL PROCESSING         * 01600002
*        IFG0202I - RETURN FROM SMF PROCESSING                        * 01650002
*                                                                     * 01700002
*        1) SETUP WORKAREA DEB REFLECTING UNIT CURRENTLY              * 01750002
*        BEING PROCESSED.                                             * 01800002
*                                                                     * 01850002
*        2) EXIT TO IFG0554L TO PROCESS USER TRAILER LABELS,          * 01900002
*        SETTING BITS 5 AND 6 OF JFCBMASK+5 TO ONE. USER LABEL        * 01950002
*        PROCESSING IS BYPASSED IF FEOV, DCBDSORG IS NOT PS, OR       * 02000002
*        USER LABELS HAVE ALREADY BEEN PROCESSED IN A                 * 02050002
*        PREVIOUS PASS THROUGH EOV FOR VBS UPDATE.                    * 02100002
*                                                                     * 02150002
*        IFG0554L IS GIVEN CONTROL IF -                               * 02200002
*        AN 03 EXIT EXISTS IN THE EXIT LIST AND EITHER AN             * 02250002
*        EOF CONDITION IS NOT PRESENT, OR AN EOF CONDITION IS         * 02300002
*        PRESENT AND AN 0C EXIT DOES NOT EXIST.                       * 02350002
*        AN 0C EXIT EXISTS IN THE EXIT LIST AND AN 03 EXIT DOES       * 02400002
*        NOT EXIST.                                                   * 02450002
*                                                                     * 02500002
*        3) AFTER RETURNING FROM IFG0554L OR IF USER LABEL            * 02550002
*        PROCESSING IS NOT REQUIRED, AN EXIT IS MADE TO IFG0552X      * 02600002
*        IF NO MORE VOLUMES ARE PRESENT IN THE JFCB OR, AFTER         * 02650002
*        READING THE FORMAT 1 DSCB, IF THE LAST VOLUME BIT (BIT 0     * 02700002
*        IN DSCDSIND) IS ON IN THE DSCB.                              * 02750002
*                                                                     * 02760002
*        4) IF NOT EOF AND SMF PROCESSING IS REQUIRED, MODULE         * 02800002
*        IFG0553B (ALIAS NAME FOR IFG0202H) IS GIVEN CONTROL.         * 02850002
         EJECT                                                          02900002
*        5) AFTER RETURNING FROM SMF PROCESSING (MODULE IFG0202I)     * 02950002
*        OR IF SMF PROCESSING IS NOT REQUIRED, THE DATA MANAGEMENT    * 03000002
*        COUNT IN THE CURRENT VOLUME'S UNIT IS DECREMENTED.           * 03050002
*        IF THE DATA MANAGEMENT COUNT DROPS TO ZERO FOR A VIO         * 03050202
*        UNIT, A WICLOSE IS ISSUED.                                   * 03050402
*                                                                     * 03060002
*        6) DXVOLSEQ IS INCREMENTED BY ONE AND MODULE IFG0554A (ALIAS * 03100002
*        NAME FOR IFG0194A) IS GIVEN CONTROL TO MOUNT AND VERIFY THE  * 03150002
*        NEXT VOLUME AND READ THE DSCB(S), AND PASS CONTROL TO        * 03200002
*        MODULE IFG0553X.                                             * 03250002
*                                                                     * 03300002
* NOTES = SEE BELOW                                                   * 03350002
*                                                                     * 03400002
*    DEPENDENCIES =                                                   * 03450002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 03500002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03550002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03600002
*                                                                     * 03650002
*    RESTRICTIONS = NONE                                              * 03700002
*                                                                     * 03750002
*    REGISTER CONVENTIONS =                                           * 03800002
*            R2 POINTS TO DCB                                         * 03850002
*            R4 POINTS TO OPEN WORK AREA                              * 03900002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 03950002
*            R6 POINTS TO THE WTG TABLE                               * 04000002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 04050002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 04100002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 04150002
*            R10 POINTS TO THE UCB                                    * 04200002
*                                                                     * 04250002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 04300002
*                  END OF LISTING.                                    * 04350002
*                                                                     * 04400002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 04450002
*                                                                     * 04500002
*    PROCESSOR = ASSEMBLER XF                                         * 04550002
*                                                                     * 04600002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 04650002
*                  ORG STATEMENT AT END OF LISTING                    * 04700002
*                                                                     * 04750002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 04800002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 04850002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 04900002
*                                                                     * 04950002
* ENTRY POINT = IFG0553P                                              * 05000002
*                                                                     * 05050002
*    PURPOSE = SEE FUNCTION                                           * 05100002
*                                                                     * 05150002
*    LINKAGE =                                                        * 05200002
*        THIS MODULE IS PASSED CONTROL THROUGH THE IECRES-LOAD MACRO. * 05250002
         EJECT                                                          05300002
* INPUT =                                                             * 05350002
*        ENTERED IN PROTECT KEY 5.                                    * 05400002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 05450002
*        REGISTER 4 POINTS TO THE EOV WORKAREA.                       * 05500002
*        THE DEBDCBAD POINTS TO THE COPIED DCB.                       * 05550002
*        JFCBMASK+5 BITS 5 AND 6 SET TO ONE IF RETURN FROM IFG0554L.  * 05600002
*        REGISTER 14 CONTAINS ENTRY CODE -                            * 05650002
*              0 - ENTERED FROM IFG0551H.                             * 05700002
*              4 - RETURN FROM SMF PROCESSING MODULE IFG0202I.        * 05750002
*                                                                     * 05800002
* OUTPUT =                                                            * 05850002
*        CURRENT VOLUME'S DSCB READ (EXCEPT TO IFG0552X)              * 05900002
*        DXVOLSEQ UPDATED (IFG0554A)                                  * 05950002
*        DATA MANAGEMENT COUNT DECREMENTED ON CURRENT                 * 06000002
*              VOLUME AND WICLOSE IF VIO (IFG0554A)                   * 06050002
*        REGISTER 14 CONTAINING ENTRY CODE -                          * 06100002
*              IFG0552X - 0                                           * 06150002
*              IFG0553B - 4, ALSO USED AS RETURN CONTENTS OF REG 14   * 06200002
*        DXRETMOD INDICATING IFG0553P (IFG0554L, IFG0553B)            * 06250002
*        DXRETMOD INDICATING IFG0553X (IFG0554A)                      * 06300002
*                                                                     * 06350002
* EXIT-NORMAL =                                                       * 06400002
*        IFG0552X - END OF FILE CONDITION.                            * 06450002
*        IFG0554L - USER TRAILER LABEL PROCESSING.                    * 06500002
*        IFG0553B - SMF PROCESSING.                                   * 06550002
*        IFG0554A - MOUNT AND VERIFY NEXT VOLUME.                     * 06600002
*                                                                     * 06650002
* EXIT-ERROR =                                                        * 06700002
*        IFG0550P - PROBLEM DETERMINATION WITH INTERNAL ABEND CODE    * 06750002
*        IN REGISTER 0 -                                              * 06800002
*        175 - INDICATING 737-14 ABEND, I/O ERROR READING DSCB.       * 06850002
         EJECT                                                          06900002
* EXTERNAL REFERENCES = SEE BELOW                                     * 06950002
*                                                                     * 07000002
*    ROUTINES = IFG019RA THROUGH IECRES MACRO.                        * 07050002
*                                                                     * 07100002
*    DATA AREAS =                                                     * 07150002
*        EOV WORKAREA.                                                * 07200002
*                                                                     * 07250002
*    CONTROL BLOCK =                                                  * 07300002
*        DEB                                                          * 07350002
*        UCB                                                          * 07400002
*        CVT                                                          * 07450002
*        DCB                                                          * 07500002
*        VDSCB                                                        * 07550002
*                                                                     * 07600002
* TABLES =                                                            * 07650002
*        DEVICE CHARACTERISTICS TABLE                                 * 07700002
*        DCB EXIT LIST                                                * 07750002
*                                                                     * 07800002
* MACROS =                                                            * 07850002
*        MODESET                                                      * 07900002
*        EXCP                                                         * 07950002
*        IECRES WAIT                                                  * 08000002
*        IECRES-LOAD                                                  * 08050002
*        DMABCOND                                                     * 08100002
*        XCTL                                                         * 08150002
*        IECDSECS                                                     * 08200002
*        IECEQU                                                       * 08250002
*        IDDVDSCB                                                     * 08300002
*                                                                     * 08350002
* CHANGE ACTIVITY =                                                   * 08400002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD          * 08450002
*                                                                     * 08500002
*********************************************************************** 08550002
         EJECT                                                          08600002
ERR175   EQU   175                      ABEND CODE - 737-04             08650002
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        31200021
         USING FORCORE,RCORE                                            31400021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 31450002
         USING TIOENTRY,RTIOT                                           31600021
         USING UCB,RUCB                                                 31800021
         USING DEB,RDEB                                                 32000021
         USING IHADCB,RDCB                                              32200021
         USING *,RBASE                                                  32400021
         SPACE 2                                                        32450002
         L     RDEB,DCBDEBAD            ADDRESS OF USER'S DEB           32600021
         TM    JFCBMASK+K5,K6           TEST,BR IF RETURNING FROM       32800021
         BO    EDI00600                 UL PROCESSING                   33000021
         B     EDI00000(RET)            BR, ACCORDING TO RETURN CODE    33200021
EDI00000 B     EDI00050                 FROM EOV BASIC                  33400021
         B     EDI01450                 FROM SMF                        33600021
EDI00050 EQU   *                        INITIAL ENTRY                   33800002
         L     RUCB,DXUCBADR            LOAD CURRENT UCB         Y02134 34200002
         SPACE 1                                                        34400021
*                                                                       39000021
*                   SET UP THE WORK AREA DEB FOR OTHER DA DEVICES       39200021
*                                                                       39400021
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1                       Y02134 39800002
*                                       PLACE UCB ADDRESS IN WORK DEB   40000021
         MVC   DXDEBSCC(K10),COLCDU0I   CREATE DUMMY EXTENT IN WORK DEB 40200021
         L     R7,CVTPTR                GET CVT ADDRESS          M0983  40250021
         L     R7,CVTZDTAB-CVT(,R7)     GET ADDR OF I/O DEVICE   M0983  40300021
*                                       TABLE                    M0983  40350021
         XR    R1,R1                    CLEAR REG FOR OFFSET     M0983  40352021
         IC    R1,UCBTBYT4              GET UCB DEVICE TYPE      M0983  40360021
         IC    R1,0(R1,R7)              INDEX TO DEVICE OFFSET   M0983  40370021
*                                       BYTE                     M0983  40380021
         AR    R7,R1                    ADDR OF DEVICE ENTRY IN  M0983  40390021
*                                       TABLE                    M0983  40392021
         MVC   DXDEBECC(K4),0(R7)       SET MAX EXTENT FROM      M0983  40394021
*                                       DEVICE TABLE             M0983  40396021
         EJECT                                                          40446002
*                                                                       41000021
*****    FORCE END VOLUME PROCESS - SKIP USER LABEL PROCESSING          41200002
*                                                                       41400021
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP           SA59750 41450002
         BO    EDI00075                 BRANCH IF EXCP          SA59750 41500002
         TM    DCBCIND2,DCBC2FEO        IS THIS FEOV- FORCE END OF VOL  41800021
         BO    EDI00800                 YES,GO TO EOV                   42000021
*                                                                       43200021
***********    USER TRAILER LABEL PROCESSING SECTION                    43400021
*                                                                       43600021
*        DCBIOBAD CAN BE TESTED ONLY IF NOT CHAINED SCHEDULING   YM1194 43650002
*        AND NOT EXCP                                            YM1194 43700002
*                                                                       43710002
         TM    DCBCIND2,DCBC2CHN        CHAINED SCHEDULING TEST  YM1194 43770002
         BO    EDI00075                 BRANCH IF YES            YM1194 43780002
         CLC   DCBIOBAD,MASKFL0I        HAS UL BEEN PROCESSED           43800021
         BNE   EDI00800                 BRANCH IF YES                   44000021
EDI00075 EQU   *                        TEST FOR USER LABELS     YM1194 44050002
         TM    JFCBLTYP,JFCSUL          TEST,BR IF USER HAS NOT         44200021
*                                       SPECIFIED                       44400021
         BNO   EDI00800                 'SUL' LABEL TYPE                44600021
         TM    DCBMACRF,DCBMEXCP        IS IT EXCP               YM1194 44610002
         BNO   EDI00077                 BRANCH IF NO             YM1194 44620002
         TM    DCBMACRF,DCBMRFE         IS DCBEXLST PRESENT      Y02080 44630002
         BNO   EDI00800                 BRANCH IF NO             Y02080 44640002
         TM    DCBMACRF,DCBMRCI         IS DSORG PRESENT         YM1194 44650002
         BO    EDI00080                 BRANCH IF NO             YM1194 44700002
EDI00077 EQU   *                        SUL ONLY FOR PS          YM1194 44750002
         TM    DCBDSORG,DCBORGPS        TEST,BR IF DSORG IS NOT         44800021
         BZ    EDI00800                 PHYSICAL SEQUENTIAL             45000021
         EJECT                                                          45000302
*                                                                       45001102
*        USER LABEL PROCESSING - CHECK FOR END OF FILE                  45001402
*                                                                       45001702
EDI00080 EQU   *                        EOF TEST                 YM1194 45002002
*                                                                Y02134 45030002
         CLC   JFCBNVOL,DXVOLSEQ+K1     CHECK FOR EOF            Y02134 45040002
         BNH   EDI00235                 BRANCH IF EOF          @ZA01342 45042037
EDI00150 EQU   *                        NOT EOF                  Y01234 45049802
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         Y02132 45064802
         BNO   EDI00175                 BR IF NOT                Y02132 45067802
*        CALL SUBROUTINE TO READ VIO DSCB FROM SWA               Y02132 45070802
         BAL   RD,EDI01250              GO READ VIO DSCB         Y02132 45073802
*                                                                Y02132 45076802
         B     EDI00200                 CONTINUE PROCESSING      Y02132 45077402
EDI00175 EQU   *                        READ REAL DSCB           Y02132 45078002
*                                                                Y02134 45079802
         BAL   RD,EDI02200              BUILD CHANNEL PROGRAM   SA57255 45170021
*                                       TO READ F1 DSCB         SA57255 45180021
         BAL   RD,EDI01200              READ F1 DSCB            SA57255 45190021
         BNO   EDI01300                 BR IF I/O ERROR ON READ SA57255 45190421
EDI00200 EQU   *                        SEE IF LAST VOLUME       Y02132 45190502
         OI    DXATDACC,DXATRDDB        SHOW DSCB READ           Y02144 45190802
         CLI   DSCFMTID,CHAR4           CHECK IF OPEN TO VTOC  @ZA33029 45191237
         BE    EDI00240                 TREAT AS EOV IF YES    @ZA33029 45191637
         TM    DSCDSIND,LASTNTRY        TEST LAST VOLUME BIT    SA57255 45192021
*                                       TO DETERMINE EOF OR EOV SA57255 45194021
         BNO   EDI00240                 IF NOT LAST VOL-EOV    @ZA01342 45196037
EDI00235 EQU   *                                               @ZA01342 45196437
         L     R1,DXDSABAD              GET CURRENT DSAB       @ZA01342 45196837
         USING DSAB,R1                                         @ZA01342 45197237
         L     R1,DSABFCHN              GET NEXT DSAB          @ZA01342 45197637
         LTR   R1,R1                    IS THERE ANOTHER DSAB? @ZA01342 45197737
         BZ    EDI00250                 NO, BR (EOF)           @ZA01342 45197837
         L     R1,DSABTIOT              GET NEXT TIOT ENTRY    @ZA01342 45197937
         CLI   TIOEDDNM-TIOENTRY(R1),BLANK IS DDNAME BLANK?    @ZA01342 45231537
         BNE   EDI00250                 NO, BR (EOF)           @ZA01342 45251537
         TM    TIOELINK-TIOENTRY(R1),TIOESYIN+TIOESYOT IS IT   @ZA01342 45261537
*                                       A SPOOLED DATA SET?    @ZA01342 45263537
         BM    EDI00250                 YES, BR (EOF)          @ZA01342 45265537
         TM    DCBOFLGS,DCBOUNLK        UNLIKE CONCATENATION?  @ZA01342 45276737
         BO    EDI00250                 YES, BR (EOF)          @ZA01342 45286737
         L     RF,TIOESTTB-TIOENTRY(R1) GET CONC UCB ADDR      @ZA01342 45287137
         LA    RF,K0(RF)                CLEAR HIGH ORDER BYTE  @ZA01342 45287537
         LTR   RF,RF                    DUMMY DATA SET?        @ZA01342 45287937
         BZ    EDI00250                 YES, BR (EOF)          @ZA01342 45291637
EDI00240 EQU   *                                               @ZA01342 45293637
*                                                                       45295537
*        NOT EOF - SETUP TO SEARCH FOR 03 EXIT, THEN 0C                 45299237
*                                                                       45332837
         LA    RF,EDI01000              RETURN ADDR IF NOT SUR EXIT 03  45366437
         LA    R7,ULEXIT                ADDR OF UL EXIT CODE BYTE 03    45400021
         LA    R1,EDI00500              EXIT ADDR IF CODE MATCH         45600021
         LA    RET,K2                   SET INCR VALUE TO 1     SA55619 45650002
         B     EDI00300                 BR TO TEST UL EXIT      SA55619 45700000
*                                                                       45710002
*        EOF - SETUP TO SEARCH FOR 0C EXIT, THEN 03                     45720002
*                                                                       45730002
EDI00250 EQU   *                        SETUP IF EOF            SA55619 45750002
         LA    RF,EDI01000              RETURN ADDR IF          SA55619 45760000
*                                       NOT UL EXIT             SA55619 45762000
         LA    R7,SULDFR0I              ADDR OF UL DEFER CODE   SA55619 45770000
         LA    R1,EDI00900              EXIT ADDR IF CODE MATCH@ZA01342 45780037
         LA    RET,K2                   SET INCR VALUE TO -2    SA55619 45790002
         LNR   RET,RET                                          SA55619 45792000
         EJECT                                                          45794002
EDI00300 EQU   *                        GET EXIT LIST ENTRIES FOR       45800021
*                                       COMPARE                         46000021
         L     RC,DCBEXLST              PICK UP EXIT LIST FROM DCB      46200021
         LA    RC,0(,RC)                ZERO HI ORDER BYTE OF EXIT LIST 46400021
         LTR   RC,RC                    IS EXIT LIST ZERO               46600021
         BZ    EDI00800                 YES, BRANCH             SA57255 46800021
EDI00400 EQU   *                        TRY TO FIND EXIT LIST ENTRY     47000002
         MODESET KEYADDR=DXUKEY,WORKREG=13 GET INTO USER KEY     Y02082 47050002
         CLC   K0(K1,RC),K0(R7)         DO CODE BYTES MATCH             47200021
         BE    EDI00430                 BRANCH YES             @ZA13566 47400037
         CLC   K0(K1,RC),K1(R7)         DO CODE BYTES MATCH-LST         47500037
*                                       ON EXL                          47600037
         BE    EDI00430                 BRANCH YES             @ZA13566 47700037
         B     EDI00450                 GO CHECK FOR LAST ENTRY@ZA13566 47800037
EDI00430 BR    R1                       GO TO EXIT ADDR        @ZA08315 47900037
EDI00450 TM    0(RC),LASTNTRY           IS THIS LAST ENTRY IN LIST      48600037
         LA    RC,K4(,RC)               POINT TO NEXT ENTRY             48800002
         BZ    EDI00400                 CHECK NEXT ENTRY                49000021
         BR    RF                       EXIT TO CALLER SPECIFIED        49200002
*                                       ADDR                            49400021
*                                                                       49600021
EDI00500 EQU   *                        SEE IF EXIT ADDR SPECIFIED      49800002
         L     RC,K0(,RC)               PICK UP USER'S EXIT ADDR        50000002
         LR    R7,RC                                                    50200021
         LA    R7,K0(,R7)               CLEAR HIGH ORDER BYTE           50400002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGT KEY   Y02082 50450002
         LTR   R7,R7                    IS EXIT ADDRESS ZERO            50600021
         BZ    EDI00800                 YES, BYPASS USER LABEL PROC     50800021
         EJECT                                                          50850002
*                                                                       50900002
*        USER LABELS TO BE PROCESSED - ENSURE DSCB READ                 50950002
*                                                                       51000021
         CLI   DSCFMTID,CHAR1           HAS F1 DSCB BEEN READ   SA57255 51050021
         BE    EDI00550                 YES, DO NOT REREAD      SA57255 51100021
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         Y02132 51150002
         BNO   EDI00525                 BR IF NOT                Y02132 51200002
*        CALL SUBROUTINE TO READ VIO DSCB FROM SWA               Y02132 51250002
         BAL   RD,EDI01250              GO READ VIO DSCB         Y02132 51300002
*                                                                Y02132 51350002
         B     EDI00535                 CONTINUE PROCESSING      Y02132 51400002
EDI00525 EQU   *                        READ READ DSCB           Y02132 51450002
         BAL   RD,EDI02200              BRANCH TO BUILD CHANNEL SA57255 51850021
*                                       PROGRAM TO READ DSCB    SA57255 51900021
         BAL   RD,EDI01200              READ DSCB                       57400021
         BNO   EDI01300                 BR IF I/O ERROR-ABEND 737       57600021
EDI00535 EQU   *                        DSCB IN WORKAREA         Y02132 57615002
         OI    DXATDACC,DXATRDDB        SHOW DSCB READ           Y02144 57650002
*                                                                       57800021
EDI00550 EQU   *                        SET INPUT TO SUL MOD    SA57255 57850002
         MVC   DXRETMOD(K5),LOAD553P    SET RETURN ID                   58000021
         OI    JFCBMASK+K5,K6           SET FLAGS TO INDICATE EOV ENTRY 58200021
         LA    RF,LOAD554L              ID AND TTR                      58400021
         B     EDI02000                 GO TO RESIDENT ROUTINE          58600021
EDI00600 EQU   *                        RETURN FROM USER LABEL MODULE   58800002
         NI    JFCBMASK+K5,K255-K6      TURN OFF EOV-UL ENTRY FLAGS     58850002
         EJECT                                                          58900002
*                                                                       58950002
*        USER LABELS NOT PROCESSED OR RETURED FROM PROCESSING           58960002
*                                                                       58970002
EDI00800 EQU   *                        CONT. IF NO USER LABELS SA57255 59000002
         TM    DCBOFLGS,DCBOCON         CONCAT IN PROCESS       SM5271  59050002
         BO    EDI01400                 YES, PROCESS EOV        SM5271  59100002
*                                                                       59200021
*****    TEST EOV/EOF                                                   59400021
*                                                                       59600021
         MODESET EXTKEY=DATAMGT         DATA MGT KEY FROM NOW ON Y02082 59650002
*                                                                Y02134 60050002
         CLC   JFCBNVOL,DXVOLSEQ+K1     CHECK FOR EOF            Y02134 60200002
         BNH   EDI00900                 GO TO EOF PROCESSING     Y02134 60400002
*                                                                Y02134 60440402
EDI00820 EQU   *                        NOT EOF - TEST DSCB TO VERIFY   60442002
         CLI   DSCFMTID,CHAR1           HAS F1 DSCB BEEN READ   SA57255 60450021
         BE    EDI00850                 YES, DO NOT REREAD      SA57255 60500021
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         Y02132 60510002
         BNO   EDI00835                 BR IF NOT                Y02132 60520002
*        CALL SUBROUTINE TO READ VIO DSCB FROM SWA               Y02132 60530002
         BAL   RD,EDI01250              GO READ VIO DSCB         Y02132 60540002
*                                                                Y02132 60550002
         B     EDI00845                 CONTINUE PROCESSING      Y02132 60560002
EDI00835 EQU   *                        READ READ DSCB           Y02132 60570002
         BAL   RD,EDI02200              BUILD CHANNEL PROGRAM   SA57255 60600021
*                                       TO READ DSCB            SA57255 60650021
         BAL   RD,EDI01200              READ F1 DSCB            SA57255 60700021
         BNO   EDI01300                 BRANCH TO ABEND IF I/O  SA57255 60710021
*                                       ERROR ON READ           SA57255 60720021
EDI00845 EQU   *                        DSCB IN WORKAREA         Y02132 60720602
         OI    DXATDACC,DXATRDDB        SHOW DSCB READ           Y02144 60722002
*                                                                Y02144 60724002
EDI00850 EQU   *                        SEE IF LAST VOLUME      SA57255 60730002
         TM    DSCDSIND,LASTNTRY        TEST LAST VOLUME BIT    SA57255 60750021
*                                       TO DETERMINE EOF OR EOV SA57255 60800021
*                                       IF MORE VOLS SPECIFIED  SA57255 60850021
*                                                               SA57255 60860021
         BNO   EDI01400                 IF BIT IS OFF, BRANCH   SA57255 60900021
*                                       TO INITIATE EOV PROC    SA57255 60950021
*****    END OF FILE PROCESS                                            61200021
*                                                                       61400021
EDI00900 EQU   *                        GO TO END OF FILE MODULE        61600002
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY       @ZA13566 61700037
         LA    RF,LOAD552X              LOAD ADDRESS OF 552X            61800002
         B     EDI02000                 BRANCH TO RES                   62000021
         EJECT                                                          62050002
EDI01000 EQU   *                        RESET REGS IF EXIT NOT FOUND    62200002
*                                                                       62210002
*        IF 03 OR 0C EXIT NOT FOUND, LOOK FOR THE OTHER                 62250002
*                                                                       62300002
         LA    RF,EDI00800              RETURN ADDR IF NOT UL   SA57255 64600021
*                                       DEFER CD                        64800021
         LA    R7,K0(RET,R7)            ADDR OF NEXT UL CODE    SA55619 64850000
         LA    R1,EDI00500              EXIT ADDR IF CODE MATCH SA55619 64900000
         B     EDI00300                 GO CHECK FOR UL EXIT            65400021
         SPACE 2                                                        65450002
*                                                                       65600021
*   THIS SUBROUTINE ISSUES I/O OPERATIONS                               65800021
*                                                                       66000021
EDI01200 EQU   *                        EXCP, RETURN IF NO I/O ERROR    66200002
         EXCP  DXIOB                    EXECUTE CHANNEL PROGRAM         66400021
         BAL   RET,EDI02050             GO SET UP REG RWTG AND RWTGC    66600021
         IECRES WAIT                    SEND TO RES FOR WAIT            66800021
*                                                                       67000021
         TM    DXECB,ALLBITS-DCBMEXCP   WAS THERE AN I/O ERROR          67200021
         BR    RD                       RETURN TO CALLING POINT         67400021
         EJECT                                                          67410002
*                                                                Y02132 67415002
*        SUBROUTINE TO 'READ' VIO FORMAT ONE DSCB                Y02132 67430002
*                                                                Y02132 67445002
EDI01250 EQU   *                        MOVE VDSCB TO WORKAREA   Y02132 67460002
         MVC   DXDSCB(DSCEXT2-DSCFMTID),VDSDSCB-VDSUCB+L'JFCBDSNM(RUCB) 67475002
*                                                                Y02132 67490002
         OC    DXDSCB(DSCEXT2-DSCFMTID),DXDSCB IS DSCB = ZERO?   Y02132 67505002
         BZ    EDI01300                 BR IF YES, I/O ERROR     Y02132 67520002
*                                                                Y02132 67535002
         XC    DSCEXT2(DSCBEND-DSCEXT2),DSCEXT2 ZERO REMAIN CORE Y02132 67550002
*                                                                Y02132 67565002
         BR    RD                       RETURN                   Y02132 67580002
         SPACE 2                                                        67630002
*                                                                       67800021
*                   ABNORMAL END OF TASK                                68000021
*                                                                       68050002
EDI01300 EQU   *                        GO TO PROBLEM DETERMINATION     68400002
         BAL   RET,EDI02050             GO SET UP REG RWTG AND RWTGC    68600021
         DMABCOND ERR175,LOAD0P                                         68800021
         SPACE 2                                                        69000002
*                                                                       69050002
*        COMMENCE EOV PROCESSING                                        69100002
*                                                                       69200021
*        THIS SECTION DETERMINES IF SMF RECORDS REQUIRED              * 69400021
*                                                                       69600021
EDI01400 EQU   *                        RETURN IF SMF NOT REQUIRED      69800002
         TM    DXXPATHS,WTGSMF          IS SMF REQUIRED FOR DATA A38013 70700021
*                                       SET                      A38013 71600021
         BNO   EDI01450                 NO, CONTINUE PROCESSING  A38013 72500021
         LA    RF,LOAD200I                                              73400021
         LA    RET,K4                   SET RETURN INDICATOR            73600021
         MVC   DXRETMOD,LOAD553P        XCTL TO SMF MODULE              73800021
         B     EDI02025                 GO TO SMF LOAD                  74000021
         EJECT                                                          74010002
*********************************************************************** 74100002
*                                                                       74150002
*        DECREMENT DM COUNT - WICLOSE IF VIO AND COUNT GOES ZERO        74160002
*                                                                       74170002
*****************************************************************Y02134 74180002
*                                                                Y02134 74190002
EDI01450 EQU   *                        INCREMENT DXVOLSEQ       YM7099 74192002
         LH    R1,DXVOLSEQ              LOAD VOL SEQ             YM7099 74193002
         LA    R1,K1(R1)                INCREMENT TO NEXT VOL    YM7099 74194002
         STH   R1,DXVOLSEQ              SAVE SEQUENCE NUMBER     YM7099 74195002
*                                                                       74195102
*        GET LOCAL LOCK                                                 74195202
*                                                                       74195302
         L     RF,DXXPREFX              GET PREFIX ADDR          YM7883 74195402
         USING IECPREFX,RF              USING FOR PREFIX         YM7883 74195502
         STM   RB,RET,IECREGSV          SAVE SETLOCK REGS        YM7883 74195602
         MODESET EXTKEY=SUPR            SETLOCK KEY              YM7883 74195702
EDI01455 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  YM7883*74195802
               RELATED=(LOCAL,IFG0553P(EDI01466)) GET LOCAL LOCK YM7883 74195902
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM7883 74196002
         LM    RB,RET,IECREGSV          RESTORE REGS             YM7883 74196102
*                                                                       74196202
         LA    RF,K1                    LOAD DECREMENT VALUE     Y02134 74196302
*                                                                       74196402
*        SHIFT DECREMENT TO USE WITH CS INSTRUCTION              Y02134 74198002
*                                                                       74198102
         SLL   RF,K24-(K8*((UCBDMCT-UCB)-(((UCBDMCT-UCB)/4)*4))) Y02134 74198402
         L     R0,UCB+(((UCBDMCT-UCB)/K4)*K4) ALIGN & LOAD WORD  Y02134 74198802
         EJECT                                                          74199202
EDI01460 EQU   *                        DECREMENT IF NONZERO     Y02134 74199602
         LR    RET,R0                   SAVE CS OPERAND          Y02134 74199802
         SLL   RET,K25                  LEAVE ONLY UCBDMCT COUNT Y02134 74199902
         LTR   RET,RET                  TEST FOR COUNT OF 0      Y02134 74249902
         BZ    EDI01464                 BRANCH IF ALREADY 0      Y02134 74259902
         LR    R1,R0                    LOAD OLD VALUE TO MODIFY Y02134 74279902
         SR    R1,RF                    ADD DECREMENT TO COUNT   Y02134 74289902
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 74293902
*                                                                Y02134 74294302
         CS    R0,R1,UCB+(((UCBDMCT-UCB)/K4)*K4) STORE NEW COUNT Y02134 74295902
*                                                                Y02134 74296302
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 74297902
         BNE   EDI01460                 BRANCH IF NOT THE SAME   Y02134 74298702
         TM    UCBJBNR,UCBVRDEV         IS IT VIO UNIT           YM7883 74299002
         BZ    EDI01464                 BRANCH IF NO             YM7883 74300002
*                                                                       74750002
*        VIO UNIT - WICLOSE IF DATA MANAGEMENT COUNT NOW ZERO    YM7883 74800002
*                                                                       74850002
         SLL   R1,K25                   GET COUNT IN REG         YM7883 74900002
         LTR   R1,R1                    IS COUNT ZERO            YM7883 74950002
         BNZ   EDI01464                 BRANCH IF NOT            YM7883 75000002
         LA    R1,VDSUCB-VDSCB(,RUCB)   GET VDSCB ADDR           YM7883 75050002
         L     RD,DXXPREFX              GET PREFIX ADDR          YM7883 75100002
         LA    RD,IECREGSV-IECPREFX(,RD) GET REG SAVE AREA       YM7883 75150002
         MODESET EXTKEY=SUPR            GET IN KEY ZERO          YM7883 75200002
         WICLOSE VDSCB=(1)              WICLOSE DATA SET         YM7883 75250002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM7883 75300002
         EJECT                                                          75300202
EDI01464 EQU   *                        RELEASE LOCK             YM7883 75350002
         OI    DXATEOV,DXATNVOL         INDIC CURR UNIT INACTIVE YM6520 75350202
         L     RF,DXXPREFX              GET PREFIX ADDR          YM7883 75400002
         STM   RB,RET,IECREGSV          SAVE MODESET REGS        YM7883 75450002
         MODESET EXTKEY=SUPR            GET IN KEY ZERO          YM7883 75500002
EDI01466 SETLOCK RELEASE,TYPE=LOCAL,    RELEASE LOCAL LOCK       YM7883*75550002
               RELATED=(LOCAL,IFG0553P(EDI01455))                YM7883 75600002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM7883 75650002
         LM    RB,RET,IECREGSV          RESTORE MODESET REGS     YM7883 75700002
         DROP  RF                                                YM7883 75750002
         SPACE 2                                                        75750102
*                                                                       75750202
*        DATA MANAGEMENT COUNT DECREMENTATION COMPLETED                 75750402
*                                                                       75750602
         LA    RF,ID3P4A                SET UP FOR MOUNT VERIFY  Y02134 78151502
         MVC   DXRETMOD,ID3P3X          SET UP IFG0553X RETURN   Y02134 78152002
*                                                                Y02134 78152502
EDI02000 EQU   *                        ENTRY CODE 0 FOR NEXT MODULE    89000002
         SR    RET,RET                  SET RETURN CODE TO ZERO         89200021
EDI02025 EQU   *                        GIVE NEXT MODULE CONTROL        89400002
         LA    RWTGC,DXXENTRY           NEXT MODULE ID/TTR              89600021
         LA    RWTG,DXXAREA             CURRENT MODULE IN WORKAREA      89800021
         IECRES LOAD,MODID=(RF),BRCODE=(RET),BRANCH=QUEUED       Y02080*90050002
                                        ENTER RESIDENT ROUTINE   Y02080 90100002
         EJECT                                                          90200002
EDI02050 EQU   *                        SUBROUTINE TO RELOAD REGS 6, 7  90400002
         LA    RWTGC,DXXENTRY           NEXT MODULE ID/TTR              90600021
         LA    RWTG,DXXAREA             CURRENT MODULE IN WORKAREA      90800021
         BR    RET                      RETURN TO CALLER                91000021
         SPACE 2                                                        91010002
*                                                                       91012002
*        READ DSCB FROM VTOC USING BBCCHHR IN DEB                       91014002
*                                                                       91016002
EDI02200 EQU   *                        SUBROUTINE ENTRY POINT  SA57255 91020002
         LA    R1,K15                   DECREMENT FROM DEB      SA57255 91050021
*                                       ADDR TO DSCB BBCCHHR    SA57255 91060002
         SR    RDEB,R1                  ADDR IN PREFIX PORTION  SA57255 91100021
         MVC   DXDAADDR+K1(K7),0(RDEB)  TRK ADDR OF DSCB IN IOB SA57255 91150021
         MVI   DXDAADDR,K0              SET M=0                 SA57255 91160021
*                                                               SA57255 91170021
*   THE FOLLOWING SUBROUTINE SETS UP A CHANNEL PROGRAM TO READ  SA57255 91180021
*   THE DSCB OR VOLUME LABEL INTO THE WORKAREA.                 SA57255 91190021
*   IN THIRD CCW.                                               SA57255 91194021
*                   SEARCH ID EQUAL     IOBDADAD+3   C,SILI   5 SA57255 91196021
*                   TIC                 *-8         -         - SA57255 91198021
*                   READ DATA           WORKAREA    -        96 SA57255 91304702
*                                                               SA57255 91309721
*                                                               SA57255 91314721
*                                                               SA57255 91319721
         XC    DXCCW1(K24),DXCCW1       CLEAR 3 CCW'S           SA57255 91324721
         LA    R0,DXDAADDR+K3           ADDRESS OF IOBDADAD+3   SA57255 91329721
         ST    R0,DXCCW1                SEARCH ADDR IN CCW1     SA57255 91334721
         LA    R0,DXCCW1                ADDR SEARCH CCW         SA57255 91339721
         ST    R0,DXCCW2                PUT IN CCW2             SA57255 91344721
         ST    RCORE,DXCCW3             WORKAREA ADDR IN CCW3   SA57255 91349721
         MVI   DXCCW1,CCWSCHID          SEARCH ID COMMAND CODE  SA57255 91354721
         MVC   DXCCW1+K4(K5),ACCW10I    REST OF CCW1 AND TIC    SA57255 91359721
*                                       COMMAND                 SA57255 91364721
         MVI   DXCCW3,CCWMTRD           READ DATA COMMAND       SA57255 91369721
         MVI   DXCCW3+K7,K96            LENGTH IS 96 BYTES      SA57255 91374702
         L     RDEB,DCBDEBAD            RESTORE USER'S DEB      SA57255 91384721
*                                       ADDRESS                 SA57255 91389721
*                                                               SA57255 91405921
         BR    RD                       RETURN TO CALLER        SA57255 91406921
         EJECT                                                          91456902
*                                                                       91506902
*        CONSTANTS                                                      91556902
*                                                                       91606902
         DS    0F                                                       91800021
ACCW10I  DC    X'6000000508'            SILI,COMMAND CHAIN,5 CHAR,TIC O 92200021
COLCDU0I DC    X'000000007FFF7FFF7FFF'  EXTENT TO COVER ENTIRE DISK     92400002
MASKFL0I DC    F'1'                     MASK TO TEST DCBIOBAD           94000021
ULEXIT   DC    X'03'                    UTL EXIT LIST CODE BYTE         94200021
         DC    X'83'                    UTL EXIT LIST CODE BYTE         94400021
*                                       + LAST                          94600021
SULDFR0I DC    X'0C'                    DEFER UTL PROC CODE BYTE        94800021
         DC    X'8C'                    DEFER UTL PROC CODE BYTE        95000021
*                                       +LAST                           95200021
         EJECT                                                          95250002
         XCTLTABL ID=(LOAD553P,3P,LOAD554L,4L,LOAD0P,0P,         Y02080X95600002
               LOAD552X,2X,ID3P4A,4A,ID3P3X,3X,LOAD200I,3B),     Y02134X95800002
               SVC=055,BRT=YES,LENGTH=                           Y02080 95850002
         IECDSECS TIOT,DCB,DEB,UCB,MAIN,WTG,PREFX,CVT,PSA,       YM7883*96000002
               DSAB,EXPAND=YES                                 @ZA01342 96000237
         IDDVDSCB                                                Y02132 96015002
         IECEQU                                                         96200021
         END                                                            96400021
./  ADD  SSI=81440193,NAME=IFG0553X
         TITLE 'IFG0553X                      EOV DA INPUT - BUILD NEW D00200002
               DEB MODULE'                                       Y02134 00250002
IFG0553X CSECT                                                          00450002
*********************************************************************** 00500002
*                                                                     * 00502002
*                                                                     * 00502102
*        VS2 RELEASE 02 DELETIONS                                     * 00502402
*                                                                     * 00504002
*        VS2 RELEASE 3 DELETIONS                               @ZM30032 00504403
*0000008553,743003,743050-743150,804000                        @Y30LSBS 00504803
*0000                                                          @ZA18313 00505437
*C742938-743820,811200,931200                                  @ZA19720 00505724
*                                                                     * 00506002
*        VS2 RELEASE 037 DELETIONS                                      00508024
*0000                                                          @ZA02204 00510024
*0000                                                          @ZA10274 00512024
*0000                                                          @ZA13569 00514024
*        VS2 RELEASE 037 CHANGES AND ADDITIONS                          00516024
*0000                                                          @ZA15655 00518024
*D74296903-74297400,74299237,74299337                          @ZA16059 00520024
*D742961                                                       @ZA28613 00522024
*AXXXXXX                                                       @ZA28613 00524024
*C743355,743369,743376,743390,743411,743425                    @ZA28613 00526024
*********************************************************************** 00530037
*                                                                     * 00550002
* MODULE NAME = IFG0553X (OS/VS2)                                     * 00600002
*                                                                     * 00650002
* DESCRIPTIVE NAME = EOV DA INPUT - BUILD NEW DEB MODULE              * 00700002
*                                                                     * 00750002
* COPYRIGHT = NONE                                                    * 00760002
*                                                                     * 00770002
* STATUS = RELEASE 2, LEVEL 0                                         * 00780002
*                                                                     * 00790002
* FUNCTION =                                                          * 00792002
*        ENTERED FROM IFG0554C (ALIAS NAME FOR IFG0194C) AFTER        * 00792102
*        MOUNTING NEW DIRECT ACCESS VOLUME AND READING DSCB(S) ON     * 00792202
*        THE NEW VOLUME.                                              * 00792302
*                                                                     * 00792402
*        1) THE DEB IS PAGE FREED IF IT HAD BEEN PAGE FIXED.          * 00792502
*        SAVE OLD DEB IN WORK AREA, AND DELETE IT FROM THE TCB-DEB    * 00792802
*        CHAIN.                                                       * 00792902
*                                                                     * 00793202
*        2A) IF RECORD FORMAT IS NOT VBS AND NOT OPEN FOR UPDATE -    * 00795202
*        VERIFY THAT THE EOV OCCURRED IN THE SAME TASK AS THE OPEN    * 00803202
*        BY CHECKING THAT THE TCB ADDRESS IN THE DEB IS THE SAME AS   * 00803602
*        THE CURRENT TCB ADDRESS, AND IF IT IS,REMOVE THE DEB FROM    * 00803702
*        THE DEBTABLE BY USING THE DEBCHK MACRO. IF RUNNING UNDER     * 00803802
*        ANOTHER TCB, SEARCH THE DEBTABLE FOR THE OLD DEB ADDRESS,    * 00805902
*        (IF IT IS NOT FOUND, CALL PROBLEM DETERMINATION FOR AN       * 00809502
*        437-0C ABEND) AND SAVE THE OFFSET INTO THE DEB TABLE OF THE  * 00811602
*        DEB ADDRESS IN THE DEB TABLE.                                * 00812002
*                                                                     * 00813602
*        2B) IF RECORD FORMAT IS VBS AND OPEN FOR UPDATE THE DEB      * 00815602
*        ADDRESS IS SAVED IN DCBIOBAD, AND THE DEB IS MADE            * 00815702
*        UN-EXCPABLE BY FLIPPING THE LOW ORDER BIT OF THE DEBDCBAD    * 00817702
*        FIELD IN THE DEB AFTER POINTING DEBDCBAD TO THE USER DCB.    * 00819702
         EJECT                                                          00820702
*        3) GET CORE FOR AND BUILD NEW DEB. MERGE IN FIELDS FROM THE  * 00823902
*        DSCB AND THE OLD DEB IN THE WORK AREA. CALCULATE THE BEGINN- * 00825902
*        ING AND ENDING ADDRES AND THE NUMBER OF TRACKS FOR EACH      * 00827902
*        EXTENT AND STORE IN THE NEW DEB.                             * 00829902
*                                                                     * 00830902
*        4) VERIFY THAT THE EOV OCCURRED IN THE SAME TASK AS THE OPEN * 00833902
*        BY CHECKING THAT THE TCB ADDRESS IN THE DEB IS THE SAME AS   * 00835902
*        THE CURRENT TCB ADDRESS.                                     * 00837902
*                                                                     * 00839302
*        4A) IF THE TCB ADDRESSES ARE EQUAL, CHAIN IT TO THE TCB DEB  * 00839702
*        CHAIN OF THE CURRENT TCB. ADD THE DEB TO THE DEBTABLE BY     * 00839902
*        USING THE DEBCHK MACRO.                                      * 00841902
*                                                                     * 00843002
*        4B) IF THE TCB ADDRESSES ARE NOT EQUAL, AND IF THE OLD       * 00845102
*        DEB WAS NOT SAVED (UNDER 2B ABOVE), CHAIN THE DEB TO         * 00845302
*        THE DEB CHAIN OF THE TCB THE DCB WAS OPENED UNDER.           * 00845502
*        MODIFY THE OLD DEB'S DEB TABLE ENTRY TO POINT TO THE NEW     * 00845802
*        DEB.                                                         * 00846202
*                                                                     * 00846602
*        4C) IF THE TCB ADDRESSES ARE NOT EQUAL, AND IF THE OLD DEB   * 00847002
*        WAS SAVED (UNDER 2B ABOVE), CHAIN THE DEB TO THE CURRENT TCB * 00847402
*        DEB CHAIN (NOT THE ONE THE DCB WAS OPENED UNDER), ADD THE    * 00847802
*        DEB TO THE DEB TABLE USING THE DEBCHK-ADD MACRO, UNCHAIN THE * 00847902
*        DEB FROM THE CURRENT TCB'S DEB CHAIN, AND CHAIN THE DEB TO   * 00848002
*        THE TCB DEB CHAIN OF THE TCB THE DCB WAS OPENED UNDER.       * 00848102
*                                                                     * 00848202
*        5) UPDATE DEBVOLSQ AND DEBVOLNM                              * 00848402
*                                                                     * 00848502
*        6) GIVE CONTROL NEXT TO IFG0553Z.                            * 00848602
         EJECT                                                          00849002
* NOTES =                                                             * 00849402
*        1) IF THE DEB IS NOT CHAINED OFF THE CURRENT TCB'S DEB CHAIN,* 00849802
*        THE DEBCHK-DELETE, DEBCHK-ADD LOGIC IS AVOIDED BECAUSE       * 00850302
*        DEBCHK-ADD REQUIRES THE DEB TO BE CHAINED OFF THE CURRENT    * 00850702
*        TCB'S DEB CHAIN.                                             * 00851102
*                                                                     * 00851202
*        2) THE OLD DEB IS SAVED IN DCBIOBAD IF DCBRECFM IS VBS AND   * 00851602
*        THE DCB IS OPENED FOR UPDATE AND A SPANNED RECORD WAS BEING  * 00852002
*        READ WHEN EOV OCCURRED. ONCE EOV IS COMPLETE AND THE         * 00852402
*        COMPLETED RECORD IS PASSED TO THE USER, HE MAY UPDATE AND    * 00852802
*        PUTX IT. THE FIRST SEGMENT OF THE RECORD ON THE PREVIOUS     * 00852902
*        VOLUME MUST BE REWRITTEN. A SPECIAL REPOSITIONING CALL OF    * 00853002
*        FEOV IS INVOKED WHICH REESTABLISHES THE OLD DEB AND FREES    * 00853102
*        THE THEN CURRENT DEB.                                        * 00853202
*                                                                     * 00853502
*        3) A DIRECTED FREEMAIN/GETMAIN IS USED TO FREE THE OLD DEB & * 00853602
*        OBTAIN CORE FOR THE NEW DEB SO THE CORE IS ATTACHED TO THE   * 00853902
*        TCB UNDER WHICH THE DEB WAS OPENED AND WILL BE FREED DURING  * 00854102
*        CLOSE. THIS TCB'S ADDRESS IS IN DEBTCBAD.                    * 00854502
*                                                                     * 00854902
*        4) UPON COMPLETION OF THE DEB, A LOOP THROUGH ITS EX-        * 00855003
*        TENT LIST IS MADE IF IT IS DISCOVERED THAT THE DATA          * 00855103
*        SET RESIDES ON MSS VIRTUAL DASD.  THE DEB EXTENTS ARE        * 00855203
*        USED TO BUILD A PARAMETER LIST THAT WILL BE USED BY          * 00855303
*        THE ICBACREL MACRO TO ACQUIRE DASD SPACE.                    * 00855403
*                                                                     * 00855503
*    DEPENDENCIES =                                                   * 00855603
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 00855702
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 00855902
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 00857902
         EJECT                                                          00859902
*    RESTRICTIONS = NONE                                              * 00861902
*                                                                     * 00863902
*    REGISTER CONVENTIONS =                                           * 00865902
*            R2 POINTS TO DCB                                         * 00867902
*            R4 POINTS TO EOV WORK AREA                               * 00869902
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 00879902
*            R6 POINTS TO THE WTG TABLE                               * 00889902
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 00893902
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 00895902
*            R10 POINTS TO THE UCB                                    * 00897902
*            R11 POINTS TO USER'S DEB                                 * 00898002
*            R14 RETURN ADDRESS OR ENTRY INDICATOR                    * 00898102
*            DCB,DEB,IOB,AND JFCB IN THE EOV WORK AREA                * 00898202
*                                                                     * 00898302
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 00898702
*                  END OF LISTING.                                    * 00899102
*                                                                     * 00899502
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 00899602
*                                                                     * 00899702
*    PROCESSOR = ASSEMBLER XF                                         * 00899802
*                                                                     * 00933202
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 00943202
*                  ORG STATEMENT AT END OF LISTING                    * 00953202
*                                                                     * 00963202
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 00965202
*                  PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY, * 00965602
*                  LINK PACK AREA RESIDENT/PAGEABLE                   * 00966002
*                                                                     * 00966402
* ENTRY POINT = IFG0553X FROM:                                        * 00966502
*               IFG0554C - MOUNT VERIFY                               * 00977502
*                                                                     * 00984302
*    PURPOSE = SEE FUNCTION                                           * 00987602
*                                                                     * 00988002
*    LINKAGE = REGISTERS AS DEFINED IN REGISTER CONVENTIONS AND       * 00988402
*              CONTROL BLOCKS IN WORK AREA.                           * 00988502
*                                                                     * 00990502
* INPUT = REGISTERS AND WORK AREA                                     * 00992502
*         REGISTER 2 POINTS TO COPIED DCB                             * 00992902
*         REGISTER 4 POINTS TO EOV WORKAREA                           * 00993302
*         FORMAT 1 DSCB IN DXDSCB IN EOV WORKAREA                     * 00993702
*         FORMAT 3, IF PRESENT, POINTED TO BY DSCCORE                 * 00994102
*         DEB POINTING TO COPIED DCB                                  * 00994202
*                                                                     * 00994502
* OUTPUT = NEW DEB ON THE TCB-DEB CHAIN AND IN THE DEBTABLE           * 00994902
*          DEB POINTS TO COPIED DCB                                   * 00995002
*          REGISTER 2 POINTING TO COPIED DCB                          * 00995102
*          REGISTER 4 POINTING TO EOV WORKAREA                        * 00995202
         EJECT                                                          00995302
* EXIT-NORMAL = IFG0553Z DA INPUT FINAL EXIT MODULE                   * 00995702
*                                                                     * 00996102
* EXIT-ERROR = IFG0550P PROBLEM DETERMINATION IF THE OLD DEB WAS NOT  * 00996202
*              IN THE DEBTABLE.                                       * 01002002
*              INTERNAL ABEND CODE 199 CAUSING A 437-0C SYSTEM ABEND  * 01004002
*              IS PASSED TO IFG0550P.                                 * 01008002
*                                                                     * 01009602
*              INTERNAL ABEND CODE 111 CAUSES A 737-34 SYSTEM  @Y30LSBS 01011903
*              ABEND WHEN THE ICBACREL MACRO DETECTS AN ERROR. @Y30LSBS 01012303
*                                                                     * 01013803
*              DMABCOND PCK IF PAGE FREE ERROR                   YM5929 01018203
*                                                                     * 01022403
* EXTERNAL REFERENCES = SEE BELOW                                     * 01026603
*                                                                     * 01030803
*    ROUTINES = IFG019RA                                              * 01035003
*                                                                     * 01039203
*               IEAVPSIB VIA CVTVPSIB TO PAGE FREE DEB           YM5929 01043403
*               R0 = 0, NO ECB ADDRESS                           YM5929 01047603
*               R1 = X'20', DEB PREFIX ADDRESS, START OF PGFREE  YM5929 01051803
*               R2 = ADDR OF LAST BYTE OF DEB + 1, END OF FREE   YM5929 01056003
*               R4 = TCB ADDRESS FROM DEBTCBAD                   YM5929 01060203
*                                                                     * 01064403
*    DATA AREAS =                                                     * 01068603
*        EOV WORKAREA                                                 * 01072802
*                                                                     * 01122802
*    CONTROL BLOCK =                                                  * 01172802
*        DEB                                                          * 01182802
*        CURRENT TCB AND/OR TCB UPON WHICH DEB IS CHAINED             * 01192802
*        DCB                                                          * 01202802
*        ACCESS METHOD IOB                                            * 01212802
*        CVT                                                          * 01214802
*        DEB TABLE                                                    * 01216802
*        JSCB                                                         * 01218802
*                                                                     * 01222802
* TABLES = NONE                                                       * 01272802
*                                                                     * 01322802
* MACROS =                                                            * 01372802
*        MODESET                                                      * 01382802
*        SETLOCK                                                      * 01392802
*        DEBCHK                                                       * 01402802
*        DMABCOND                                                     * 01412802
*        FREEMAIN                                                     * 01414802
*        GETMAIN                                                      * 01416802
*        IECRES-GET/FREE                                              * 01417203
*        IECRES-LOAD                                                  * 01418802
*        IECRES-LOCJFCB                                               * 01419802
*        XCTLTABL                                                     * 01420802
*        IECDSECS                                                     * 01421202
*        IECEQU                                                       * 01421602
*        ICBACREL                                                     * 01421703
*                                                                     * 01422802
* CHANGE ACTIVITY =                                                   * 01472802
*        SEE 'CHANGES/DELETIONS' SECTION JUST AFTER CSECT CARD        * 01482802
*                                                                     * 01522802
*********************************************************************** 01572802
         EJECT                                                          01622802
ERR199   EQU   199                      ABEND CODE                      23800002
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        24000021
         USING FORCORE,RCORE                                            24200021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 24250002
         USING TIOENTRY,RTIOT                                           24400021
         USING UCBOB,RUCB                                               24600021
         USING DEBBASIC,RDEB                                     YM1272 24800002
         USING IHADCB,RDCB                                              25000021
         USING CVT,RF                                                   25200021
         USING *,RBASE                                                  25400021
*                                                                       25600021
*                                                                       25800021
         OI    DXATALL,DXATFC           FORCE CLOSE ON ERROR     YM7099 25900002
         L     RDEB,DCBDEBAD            REESTABLISH DEB ADDRESS         26000021
         LA    RDEB,DEBBASIC            CLEAR HIGH BYTE          YM5929 26010002
         MVC   DXCCW10(K8),JFCBELNM     SAVE MEMBER NAME FOR BLDL IF,PO 26200021
         MVC   DXCCW11(K1),DSCFILTY     SAVE DSCB DSORG                 26400021
         MVC   DXCCW11+K1(K1),JFCBIND1  SAVE PDS MEMBER IND IN THE JFCB 26600021
         MVC   DXCCW11+K2(K6),DSCEXTYP  SAVE EXTENT FROM F1 DSCB FOR UL 26800021
*                                       PROCESSING                      27000021
*                                                                       27200021
*        SAVING OLD DEB IN WORK AREA                                    27400021
*                                                                       27600021
         MVC   DXCCW12+K4(K1),JFCBLTYP  SAVE LABL TYPE FOR UL           27800021
         L     RF,DEBAPPAD              AVT ADDRESS              YM5929 27800302
         SH    RDEB,COLC0036            SUBTRACT 36 (PREF + APP)        28000021
         TM    DEBSIOAB-DEBAVT(RF),X10  IS DEB FIXED             YM5929 28010002
         BZ    EDI09440                 BRANCH IF NOT            YM5929 28020002
         XR    RF,RF                    CLEAR FOR IC             YM5929 28030002
         IC    RF,DEBLNGTH-DEBAVT(RDEB) LENGTH OF DEB IN DWORDS  YM5929 28040002
         SLL   RF,K3                    LENGTH OF DEB IN BYTES   YM5929 28050002
         AR    RF,RDEB                  END OF DEB + 1           YM5929 28060002
         LR    R1,RDEB                  START OF DEB             YM5929 28070002
*        PGFREE R,A=(1),EA=(15)         PAGE FREE DEB            YM5929 28070302
         LA    R2,K0(,RF)               END ADDRESS OF PGFREE    YM5929 28070602
         L     RF,DXXPREFX              PREFIX ADDRESS           YM5929 28070902
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM5929 28071202
         MODESET EXTKEY=SUPR            SETLOCK, PGFREE KEY      YM5929 28071502
EDI09430 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  YM5929*28071802
               RELATED=(LOCAL,IFG0553X(EDI09435)) GET LOCAL LOCK YM5929 28072102
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       YM5929 28072702
         EJECT                                                          28073002
         XR    R0,R0                    NO ECB                   YM5929 28073302
         ICM   R1,B'1000',=AL1(X20)     PGFREE BIT               YM5929 28073602
         LR    RDEB,RCORE               SAVE RCORE               YM5929 28073902
         L     RCORE,DEBTCBAD-DEB(,R1)  PGFREE BY TCB            YM5929 28074202
         L     RF,CVTPTR                CVT                      YM5929 28074502
         L     RF,CVTVPSIB-CVT(,RF)     IEAVPSIB ENTRY           YM5929 28074802
         BALR  RET,RF                   REGS 0-14 UNCHANGED      YM5929 28075102
         LTR   RF,RF                    ERROR IN PGFREE          YM5929 28075402
         BNZ   EDI10782                 BRANCH IF YES            YM5929 28075702
         LR    RCORE,RDEB               RESTORE RCORE            YM5929 28076002
         L     RDCB,DXPDCBAD            RESTORE DCB ADDRESS      YM5929 28076302
         L     RDEB,DCBDEBAD            RESTORE DEB ADDRESS      YM5929 28076602
         L     RF,DEBAPPAD              DEB AVT ADDR             YM5929 28076902
         NI    DEBSIOAB-DEBAVT(RF),K255-X10 ZERO DEB FIXED BIT   YM5929 28077202
         LA    RDEB,DEBBASIC            CLEAR HIGH BYTE          YM5929 28077502
         SH    RDEB,COLC0036            SUBTRACT 36 (PREF + APP) YM5929 28077602
         L     RF,DXXPREFX              PREFIX ADDRESS           YM5929 28077802
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM5929 28078102
EDI09435 SETLOCK RELEASE,TYPE=LOCAL,                             YM5929*28078402
               RELATED=(LOCAL,IFG0553X(EDI09430)) RELEASE LOCK   YM5929 28078702
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       YM5929 28079302
         MODESET EXTKEY=DATAMGT         RETURN TO D M KEY        YM5929 28079902
         EJECT                                                          28092002
EDI09440 EQU   *                        SAVE DEB IN WORKAREA     YM5929 28100002
         MVC   JFCBDSNM(K74),DEBBASIC   SAVING PREF,BASIC,EXT    YM1272 28200002
         LA    RDEB,K36(,RDEB)          RESET DEB REGISTER              28400021
         MVC   JFCBDSNM+K68(K6),DXDEBUCB  PICK UP UCBADDR AND BB        28600021
         MVC   JFCBDSNM+K23(K5),DXCCW7  SAVE DSCB COUNT                 28800021
         MVC   JFCBDSNM+K21(K2),ZEROI   INSURE BB OF ZERO               29200021
*                                                                       30400021
*                                       SUBROUTINE IDS IN SAVE AREA     30600002
*                                                                       30800021
         SR    R1,R1                    ZEROS IN RF                     31000021
         IC    R1,DEBNMEXT              PICK UP NUMBER OF EXTENTS       31200021
         SLL   R1,K4                    MULTIPLY BY 16                  31400021
         AR    R1,RDEB                  ADD DEB ADDRESS                 31600021
         LA    R1,K32(,R1)              ADD THIRTY TWO                  31800021
         SR    R7,R7                    ZEROS IN R7                     32000021
         IC    R7,DEBNMSUB              PICK UP NUMBER OF SUBROUTINES   32200021
         SLL   R7,K1                    MULTIPLY BY 2                   32400021
         SR    RF,RF                    CLEAR WORK REGISTER             32600021
         IC    RF,DEBAMLNG              LEN FOR MEMBER NAME,VOL  YM1272 32800002
         AR    R7,RF                    SEQUENCE NUM AND NUM OF VOLUMES 33000021
         EX    R7,EDI10500              SAVING VOLSQ,VOLNM,SUBRTINE     33200021
         L     RD,DEBTCBAD              TCB FROM WHICH TO        Y02082 33210002
*                                       UNCHAIN THE DEB          Y02082 33220002
         BAL   RET,EDI10750             UNCHAIN DEB FROM TCB     Y02082 33230002
         EJECT                                                          35600002
         TM    K12(RDEB),K4             IS THIS UPDATE MODE             35800021
         BZ    EDI09500                 NO,FREE DEB                     36000021
         TM    K12(RDEB),DEBOPOUT-DEBOPUPD  TEST FURTHER FOR UPDATE     36200021
         BNZ   EDI09500                 BRANCH IF NOT UPDATE            36400021
*                                                                       36500021
         TM    DCBMACRF,DCBMEXCP        IS THIS AN EXCP DCB-     A37815 36600021
         BO    EDI09500                 ..BR IF YES- NO IOB ADDR A37815 36700021
*        SPAN RECORD TEST ONLY IF NOT CHAINED SCHEDULING         YM1194 36800002
         TM    DCBCIND2,DCBC2CHN        CHAINED SCHEDULING TEST  YM1194 36850002
         BO    EDI09500                 BRANCH IF YES            YM1194 36860002
         L     R8,DCBIOBA               LOAD ADDR OF IOB PREFIX  S21940 36900021
         MODESET KEYADDR=DXUKEY,WORKREG=1 KEY OF IOB             YM1134 36950002
         L     R8,K0(R8)                LOAD ADDR OF IOB TO BE          37000021
*                                       TESTED                          37200021
         TM    K0(R8),K4                IS THIS A SPAN RECORD           37400021
         BZ    EDI09500                 NO,FREE DEB                     37600021
         EJECT                                                          37601002
         MODESET EXTKEY=DATAMGT         RETURN TO O/C/E KEY      Y02082 37810002
         STCM  RDEB,B'0111',DCBIOBAD+K1 OLD DEB ADDR IN DCBIOBAD YM3909 37812002
*                                                                       37820002
*        SAVE OLD DEB AND INVALIDATE IT TO PREVENT IT'S BEING           37830002
*        USED FOR AN EXCP BY FLIPPING THE LOW ORDER BIT OF DEBDCBAD     37840002
*                                                                       37850002
         XI    DXUDCBAD+K3,K1           FLIP LAST BIT            YM3909 37852002
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXUDCBAD+K1 POINT DEB  Y02082*37860002
                                        TO USER DCB              Y02082 37870002
         XI    DXUDCBAD+K3,K1           FLIP LAST BIT            YM3909 37880002
         L     R1,DXDEBXAD              PT TO DEB EXTENSION      YM1272 37890002
         NI    DEBXFLG1-DEBXTN(R1),ALLBITS-DEBXCDCB DEB PT USER  YM1272 37892002
         MVI   DXCCW6+K4,CHARFF         INDICATE DEBCHK ADD      YM2133 37910000
         OI    DCBIOBAD,DCBIODEB        TURN ON SAVE DEB                38000021
*                                       INDICATOR                       38200021
         L     RF,DXXPREFX              GET PREFIX               Y02080 38201002
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 38202002
         MODESET  EXTKEY=ZERO           SUPERVISOR KEY           Y02080 38203002
EDI09450 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND, GET LOCAL LOCK   Y02080*38204002
               RELATED=(LOCAL,IFG0553X(EDI09650))                Y02080 38205002
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 38206002
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 38207002
         LR    RA,RF                    PUT PREFIX ADDR IN RA    YM3909 38257002
*                                       FOR SUBSEQUENT LM        YM3909 38307002
         LA    R1,K1                    LOAD REGISTER FOR COMPARE       38400021
         CH    R1,DXNOUNIT              IS THERE ONLY ONE DEVICE        38600021
         BNE   EDI09600                 NO,MORE THAN ONE DEVICE         38800021
         OI    DCBIOBAD,DCBIOONE        TURN ON FLAG IN DCBIOBAD        39000021
         B     EDI09600                 BRANCH TO COMPARE LNGTH         39200021
*                                       OF DEB                          39400021
         EJECT                                                          39450002
*                                                                       39600002
*        DELETE DEB FROM DEB TABLE                                      40200002
*                                                                       40400021
EDI09500 EQU   *                        DEBCHK IF DEB ON CURRENT TCB    40450002
*                                                                     * 40452002
         MODESET EXTKEY=DATAMGT         RETURN TO O/C/E KEY      YM1134 40454002
         L     R1,DEBTCBAD              TCB ADDRESS              YM2133 40460000
         CLM   R1,B'0111',DXTCBADR+K1   IS DEB ON CURRENT TCB    YM2133 40470002
         BNE   EDI09550                 NO - BYPASS DEBCHK DLTE  YM2133 40490000
         L     R1,DXPDCBAD              POINT TO COPIED DCB      Y02082 40492002
         DEBCHK (R1),TYPE=DELETE        DELETE OLD DEB           Y01021 40500002
         L     RF,DXXPREFX              GET PREFIX               Y02080 40500402
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 40500802
         MODESET  EXTKEY=ZERO           SUPERVISOR KEY           Y02080 40500902
EDI09525 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND, GET LOCAL LOCK   Y02080*40501202
               RELATED=(LOCAL,IFG0553X(EDI09650))                Y02080 40501602
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 40501702
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 40501802
         B     EDI09580                 BYPASS DEBTABLE SEARCH   YM2133 40502000
         EJECT                                                          40502402
*                                                                YM2133 40504000
*        SEARCH DEBTABLE FOR OLD DEB ADDRESS AND INVALIDATE      YM2133 40506002
*        IT BY FLIPPING LOW ORDER BIT OF DEB ADDRESS IN DEB TABLE       40506402
*                                                                YM2133 40508000
EDI09550 EQU   *                        SAVE DEB TABLE OFFSET    YM2133 40508402
         USING TCB,R1                   R1 CONTAINS DEB TCB ADDR YM2133 40508800
         L     RC,TCBJSCB               ADDR OF JOB STEP JSCB    YM2133 40509200
         DROP  R1                                                YM2133 40509600
         L     R1,DCBDEBAD              GET ADDRESS OF DEB       Y02082 40509702
         LA    R1,0(,R1)                CLEAR HIGH ORDER BYTE    Y02082 40513002
         BCTR  R1,R0                    POINT TO                 YM2133 40516602
         BCTR  R1,R0                    DEBTBLOF FLD IN DEB PFX  YM2133 40519902
         LH    R1,K0(R1)                GET TABLE OFFSET         Y02080 40525202
         SLL   R1,K2                    MPY BY ENTRY LENGTH      YM2133 40533200
         ST    R1,DXCCW6+K4             SAVE DEB TABLE OFFSET    Y02080 40533602
         L     RF,DXXPREFX              GET PREFIX               Y02080 40533802
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 40533902
         MODESET  EXTKEY=ZERO           SUPERVISOR KEY           Y02080 40534002
EDI09555 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02080X40534302
               RELATED=(LOCAL,IFG0553X(EDI09565,EDI09650))       Y02080 40534402
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 40534502
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 40535002
         EJECT                                                          40535102
EDI09560 EQU   *                        DEBTABLE SEARCH          YM2133 40535202
         USING IEZJSCB,RC               ADDRESSABILITY FOR JSCB  YM2133 40535600
         L     R8,JSCBDBTB              DEB TABLE ADDRESS        YM2133 40536000
         LA    RF,K0(R1,R8)             POINT TO ENTRY           YM2133 40536400
         CLM   RDEB,B'0111',K1(RF)      CORRECT ENTRY            Y02082 40536502
         BE    EDI09570                 YES - CONTINUE           YM2133 40536600
         L     RF,DXXPREFX              GET PREFIX                      40536802
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGS             Y02080 40537002
         MODESET  EXTKEY=ZERO           KEY 0                    Y02080 40537602
EDI09565 SETLOCK RELEASE,TYPE=LOCAL,                             Y02080X40546602
               RELATED=(LOCAL,IFG0553X(EDI09555))                Y02080 40556602
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 40556802
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 40559602
*                                                                       40560602
*        REREAD JFCB TO REFRESH WORKAREA OVERLAID BY DEB         YM3116 40561602
*                                                                       40562602
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDR      YM3116 40563602
         LA    RF,TIOEJFCB              GET JFCB ADDRESS ADDRESS YM3116 40564602
         IECRES LOCJFCB,(RF)            LOCATE JFCB ADDRESS      YM3116 40565602
         MVC   DXJBF(JFCBLGTH),INFMJFCB-INFMJFCB(RF) MOVE JFCB   YM3116 40566602
*                                                                       40567602
         LA    RWTGC,DXXENTRY           SET RWTGC FOR RES RTN    YM2133 40571100
         LA    RWTG,DXXAREA             POINT TO EOV WTG         YM2133 40571500
         DMABCOND ERR199,LOAD0P         LOAD ERROR CODE          YM2133 40571902
         EJECT                                                          40572102
EDI09570 EQU   *                        CONTINUE                 YM2133 40572702
         MODESET EXTKEY=ZERO            KEY OF DEB TABLE         Y02082 40574702
         OI    K3(RF),K1                INVALIDATE OLD ENTRY     YM2133 40577200
         MODESET EXTKEY=DATAMGT         RETURN TO O/C/E KEY      Y02082 40577902
EDI09580 EQU   *                        CONT AFTER DEBTABLE SRCH YM2133 40579202
         SR    RF,RF                                             YM0856 40581900
         LR    R1,RDEB                                                  40600021
         SH    R1,COLC0036                                              40800021
         IC    RF,DEB+K32-DEB(,R1)      PUT DEB LENGTH IN DOUBLE WORD   41000021
         SLL   RF,K3                    MULTIPLY BY 8                   41200021
         LR    R0,RF                    GET LENGTH OF DEB        Y02080 41250002
         L     RF,DXXPREFX              PREFIX ADDR              Y02080 41450002
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS            Y02080 41500002
         LR    RA,RF                    SAVE PREFIX ADDR         Y02080 41550002
         MODESET EXTKEY=SUPR            FREEMAIN KEY             Y02080 41600002
         L     R7,DXASCBAD              ASCB ADDR FOR FREEMAIN   Y02080 41630002
         L     RCORE,DEBTCBAD-DEB(R1)   TCB ADDR FOR FREEMAIN    Y02080 41640002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE          Y02080 41642002
         FREEMAIN RU,LV=(0),A=(1),SP=230,KEY=5,BRANCH=YES        Y02080 41644002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02080 41646002
         LM    RBASE,R7,IECREGSV-IECPREFX+RBASE*K4(RA) GET 3,4,7 Y02080 41648002
         OI    DXATEOV,DXATDFRE         SHOW DEB CORE FREED      Y02144 41650002
         EJECT                                                          41660002
*                                                                Y02144 41700002
*        COMPUTING LENGTH OF NEW DEB                                    41800021
*                                                                       42000021
EDI09600 EQU   *                        BUILD NEW DEB                   42200021
         SR    RET,RET                  ZEROS IN RD                     42400021
         IC    RET,DSCNOEXT             PICK UP NUMBER OF EXT IN DSCB   42600021
         LTR   RET,RET                   ANY EXTENTS           @ZA02204 42601037
         BNZ   EDI09625                  YES, BRANCH           @ZA02204 42602037
         LA    RET,K1                    SET NO EXTENTS TO ONE @ZA02204 42603037
         TM    DCBMACRF,DCBMEXCP         EXCP DCB              @ZA02204 42604037
         BO    EDI09625                  YES, BRANCH           @ZA02204 42605037
         OI    DCBCIND1,DCBCNEVB         SET VOL FULL          @ZA02204 42606037
EDI09625 EQU   *                                               @ZA02204 42607037
         STC   RET,JFCBDSNM+K52         SAVING NUMBER OF EXT            42800021
         SLL   RET,K4                   MULTIPLY BY 16                  43000021
         AR    RET,R7                   ADD VOLSEQ,VOLNM,SUBRTINES      43200021
*                                                                       43400021
*        GET CORE FOR NEW DEB                                           43600021
*                                                                       43800021
         LA    R0,K69(K0,RET)           ADD LENGTH OF APPENDAGE  Y02080 44000002
*                                       + BASIC DEB              Y02080 44050002
         ST    R0,IECREGSV-IECPREFX+RET*K4(,RA) SAVE LENGTH OF   YM3909 44100002
*                                       GETMAIN WHERE RET WILL   YM3909 44150002
*                                       BE RESTORED              YM3909 44200002
         L     R7,DXASCBAD              ASCB ADDR FOR GETMAIN    Y02080 44250002
         L     RCORE,JFCBDSNM+(DEBTCBAD-DEB) TCB ADD FOR GETMAIN Y02080 44300002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE          Y02080 44400002
         MODESET EXTKEY=SUPR            GETMAIN KEY              Y02080 44410002
         GETMAIN RU,LV=(0),SP=230,KEY=5,BRANCH=YES GET NEW DEB   Y02080 44420002
         EJECT                                                          44421002
         MODESET EXTKEY=SUPR            SETLOCK KEY              Y02080 44430002
EDI09650 SETLOCK RELEASE,TYPE=LOCAL,    RELEASE LOCAL LOCK       Y02080*44440002
               RELATED=(LOCAL,IFG0553X(EDI09525,EDI09555,EDI09450))     44442002
         LM    R2,RET,IECREGSV-IECPREFX+R2*K4(RA) GET ALL REGS   Y02080 44444002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGT. KEY  Y02080 44446002
         OI    DXATEOV,DXATDNEW         SHOW NEW DEB CORE GOTTEN Y02144 44450002
         EJECT                                                          44460002
*                                                                Y02144 44500002
*        BUILDING NEW DEB                                               44600021
*                                                                       44800021
*        MERGE OLD/NEW DEB AND UPDATING OF BASIC PORTION                45000021
*                                                                       45200021
         LR    RDEB,R1                  UPDATE DEB REGISTER             45400021
         MVC   DEBBASIC(K74),JFCBDSNM   MOVE PREF,BASIC,EXT PART YM1272 45600002
*                                                                       45800021
*        COMPUTING DEB LENGTH IN DOUBLE WORD                            46000021
*                                                                       46200021
         LA    RDEB,K32(K0,RDEB)        ADD 32 IN DEB REGISTER          46400021
         LR    R0,RET                   SAVE NUMBER OF OBTAINED BYTES   46600021
         LA    RET,K7(,RET)             ADD K7                          46800021
         SRL   RET,K3                   DIVIDING BY K8                  47000021
         STC   RET,0(,RDEB)             LENGTH IN DOUBLE WORDS TO DEB   47200021
         LA    RDEB,K4(,RDEB)           RESET DEB REGISTER TO POINT TO  47400021
         ST    R1,DEBAPPAD              ADDRESS OF APP POINTERS TO NEW  47600021
         NI    DEBOFLGS,K255-DEBOFEOF   SET EOF INDICATOR OFF    Y02080 47800002
         TM    DSCDSIND,UCBMOUNT        IS LAST VOLIND ON IN DSCB       48000021
         BZ    EDI09700                 NO BYPASS SET OF EOF IN         48200021
*                                       NEW DEB                         48400021
         OI    DEBOFLGS,DEBOFEOF        SET EOF IN DEBOFLGS             48600021
EDI09700 EQU   *                        CONT UPDATING NEW DEB           48800002
         MVI   DEBEXSCL,DCBOEOF         ESTABLISH LEN OF DEVICE  YM1272 49000002
*                                       DEPENDENT SECTION               49200021
         ST    RDEB,JFCINTVL            STORE NEW DEB ADDRESS           49400021
         SR    R0,R7                                                    49600021
         AR    R1,R0                    ADD NEW DEB ADDRESS             49800021
         BCTR  R1,K0                    ADD 1 TO LENGTH OF SUBROUTINE   50000021
         EX    R7,EDI10600              MOVE VOLSEQ,VOLNUM,IDS          50200002
         EJECT                                                          50250002
*                                                                       50400021
*        MERGE DSCB EXTENTS/NEW DEB                                     50600021
*                                                                       50800021
*        COMPUTING # OF TRACKS                                          51000021
*                                                                       51200021
*        CONVERT ROUTINE MBBCCHHR TO TTR                                51400021
*                                                                       51600021
         LR    R7,RCORE                 SET RG AS CORE REGISTER         51800021
         ST    R7,DXWORK1               SAVE FORMAT 1 POINTER    Y02134 51850002
         LA    R7,K56+K1(,R7)           POINT TO START OF EXTENT ENTRY  52000002
         LA    R8,DEBBASND              PT TO DA SECT            YM1272 52200002
         USING DEBDASD,R8               BASE FOR DA SECTION      YM1272 52250002
         SR    RC,RC                    CLEAR REGISTER                  52400021
         ST    RC,DXCCW5                SET -M- OF SEARCH TO ZERO       52600021
EDI09800 TM    DSCBEXTY-DXDSCB(R7),HEX40 USER LABEL EXTENT       Y02134 52800002
         BO    EDI10400                 IF UL EXTENT,BR TO SET INDIC    53000021
         MVC   DEBDVMOD(K6),JFCBDSNM+K68                         YM1272 53200002
         MVI   DEBDVMOD,X40+X10         INHIBIT WRITE COMMANDS & YM1272 53400002
*                                       PERMIT SEEK HH COMMANDS         53600021
         TM    JFCBDSNM+K48,DEBOPIO     INOUT OR OUTIN                  53800021
         BO    EDI09900                 YES, BRANCH                     54000021
         TM    JFCBDSNM+K48,DEBOPRBK    IS DEBOPATB FLD INPUT OR UPDATE 54200021
         BO    EDI10000                 NO, BRANCH                      54400021
         TM    JFCBDSNM+K48,DEBOPUPD    IS DEBOPATB FIELD = UPDATE      54600021
         BZ    EDI10000                 NO, BRANCH                      54800021
EDI09900 EQU   *                        INOUT OR OUTIN                  55000002
         MVI   DEBDVMOD,DEBOPRRD        PERMIT SEEK HH COMM      YM1272 55200002
EDI10000 CLI   DSCBEXTY-DXDSCB(R7),X'81' IS THIS CYLINDER ALLOC  Y02134 55400002
         BE    EDI10100                 YES,FILE MASK IS ALREADY SET    55800021
         OI    DEBDVMOD,DEBOFDCB        NO,INHIBIT ALL SEEK CMNDSYM1272 56000002
EDI10100 EQU   *                        FILE MASK SETTING NOW COMPLETE  56200021
         MVC   DEBSTRCC(K8),DSCBLLMT-DXDSCB(R7) LOWR+UPPR        YM1272 56400002
         EJECT                                                          56450002
*                                                                       56600021
*        SETTING MBBCCHHR                                               56800021
*                                                                       57000021
*        FOR BEGINNING OF EXTENT                                        57200021
*                                                                       57400021
         ST    RDCB,DXCCW7                                              57600021
         STM   RTIOT,RD,DXCCW7+K4                                       57800021
         L     RF,CVTPTR                ADDR OF COMMU VECTOR TABLE      58000021
         USING CVT,RF                   CVT ADDRESSABILITY       Y02080 58050002
         L     RF,CVTPRLTV              ENTRY POINT OF CONVERT ROUTINE  58200021
         LA    RDCB,DXCCW5              LOAD MBBCCHHR ADDRESS           58400021
         LA    R1,DXDEB                 LOAD DUMMY DEB ADDRESS          58600021
         MVC   DXCCW5+K1(K2),JFCBDSNM+K72  UPDATE BB                    58800021
         MVC   DXCCW5+K3(K4),DSCBLLMT-DXDSCB(R7) LOWR LIMIT CCHH Y02134 59000002
         MVI   DXCCW5+K7,K0             SET R=0                         59200021
         BALR  RET,RF                   MBBCCHHR TO TTR CONVERT ROUTINE 59400021
*                                                                       59600021
*        FOR END OF EXTENT                                              59800021
*                                                                       60000021
         ST    R0,DXCCW4                SAVE BEGINNING OF EXTENT TTR0   60200021
         MVC   DXCCW5+K3(K4),DSCBULMT-DXDSCB(R7) UPPR LIMIT CCHH Y02134 60400002
         L     RF,CVTPTR                ADDR OF COMMU VECTOR TABLE      60600021
         L     RF,CVTPRLTV              LOAD ENTRY POINT OF CONVERT ROU 60800021
         BALR  RET,RF                   MBBCCHHR TO TTR CONVERT ROUTINE 61000021
         L     RDCB,DXCCW7              RESTORE ADDRESS OF USER'S DCB   61200021
         LM    RTIOT,RD,DXCCW7+K4                                       61400021
         LA    RC,K1(,RC)                                               61600021
         EJECT                                                          61650002
*                                                                       61800021
*        COMPUTING # OF TRACKS                                          62000021
*                                                                       62200021
         S     R0,DXCCW4                SUBTRACT BEGINNING TTR0 FROM EN 62400021
         SRL   R0,K16                   RIGHT JUSTIFY TO REMOVE RECORD  62600021
         LR    R1,R0                    PICK UP NUMBER OF TRACKS MINUS  62800021
         LA    R1,K1(,R1)               ADD 1 TO NUMBER OF TRACKS       63000002
         STH   R1,DEBNMTRK              STORE # TRKS IN EXTENT   YM1272 63200002
         NC    DEBSTRCC(K8),DEBSTRCC     ANY EXTENTS           @ZA02204 63201037
         BNZ   EDI10150                  YES, BRANCH           @ZA02204 63202037
         MVC   DEBSTRCC(K4),FOXES        SET INVALID EXTENT    @ZA02204 63203037
EDI10150 EQU   *                                               @ZA02204 63204037
         SR    R1,R1                    ZEROS IN RF                     63400021
         IC    R1,DEBNMEXT              NUMBER EXTNTS IN NEW DEB        63600021
         CR    R1,RC                    IS LAST EXTENT                  63800021
         BE    EDI10700                 YES                             64000021
         LA    R8,K16(,R8)              ADD 16                          64200021
         DROP  R8                                                YM1272 64250002
EDI10200 LA    R7,K10(,R7)              ADD 10                          64400021
         LA    R1,K3                    IF NO UL, 3 EXTENTS IN F1       64600021
         CLI   DXCCW12+K3,CSWUNITX      CK IF WAS UL EXTENT             64800021
         BNE   EDI10300                 NO, BRANCH                      65000021
         BCTR  R1,K0                    UL EXTNT, ONLY 2 EXTNTS IN F1   65200021
EDI10300 EQU   *                        UL17                            65400021
         CR    R1,RC                    CK IF LAST EXTNT FROM F1 IN DEB 65600021
         BNE   EDI09800                 NO, MERGE NEXT EXTENT           65800021
*                                                                Y02134 66010002
         L     R1,DXWORK1               GET PTR TO DSCB          Y02134 66050002
         L     R7,CORECH(,R1)           LOAD POINTER TO F3       Y02134 66100002
         LA    R1,L'JFCBDSNM(,R7)       BUMP PASSED KEY          Y02134 66150002
         ST    R1,DXWORK1               SAVE F3 PTR              Y02134 66160002
*                                       CCHHR OF FORMAT 3 FROM FORMAT1  67000021
         MVC   DSCBFMID+K44-DXDSCB(K91,R7),DSCBFMID+K45-DXDSCB(R7)      69000002
*                                       CONCATENATE THE EXTENTS  Y02134 69002002
         B     EDI09800                 GO TO SET UP ENTENTS IN THE NEW 69600021
*                                                                       69800021
EDI10400 EQU   *                        UL EXTENT                       70000002
         MVI   DXCCW12+K3,CSWUNITX      SET UL EXTENT INDICATOR         70200021
         B     EDI10200                 BR TO GET NEXT EXTENT           70400021
         SPACE 1                                                        70600021
EDI10500 EQU   *                        USED IN EX INSTRUCTION          70800002
         MVC   JFCBDSNM+K74(K0),K0(R1)                                  71000021
EDI10600 EQU   *                        USED IN EX INSTRUCTION          71200002
         MVC   K0(K0,R1),JFCBDSNM+K74                                   71400021
         EJECT                                                          71450002
*                                                                       71600021
*        INCLUDE NEW DEB IN THE CHAINING                                71800021
*                                                                       72000021
EDI10700 L     R1,DEBTCBAD              ADDR OF THE TCB FOR THIS TASK   72200021
         LA    RDEB,K0(,RDEB)           CLEAR HI-ORDER BYTE      Y02082 72250002
         STCM  RDEB,B'0111',DCBDEBAD+K1 PUT DEBAD IN COPY DCB    Y02082 72400002
         L     RET,DXUDCBAD             ADDR USER DCB            Y02082 72420002
         MODESET KEYADDR=DXUKEY,WORKREG=13 KEY USER DCB          YM5305 72420402
         DROP  RDCB                                              Y02082 72422002
         USING IHADCB,RET               USER DCB BASE            Y02082 72424002
         STCM  RDEB,B'0111',DCBDEBAD+K1 PUT DEBAD IN USER DCB    Y02082 72430002
         DROP  RET                                               Y02082 72440002
         USING IHADCB,RDCB              REESTABLISH COPY BASE    Y02082 72440402
         MODESET EXTKEY=DATAMGT         BACK TO EOV KEY          Y02082 72442002
         CLM   R1,B'0111',DXTCBADR      DOES DEB POINT TO        Y02082 72452002
*                                       CURRENT TCB              Y02082 72462002
         BE    EDI10702                 BRANCH IF YES - CHAIN    Y02082 72472002
*                                       DEB TO CURRENT TCB       Y02082 72482002
         CLI   DXCCW6+K4,CHARFF         WAS OLD DEB SAVED        Y02082 72492002
         BNE   EDI10702                 BRANCH IF NO TO CHAIN    Y02082 72502002
*                                       DEB TO DEBTCBAD TCB      Y02082 72522002
         L     R1,DXTCBADR              CHAIN DEB TO CURRENT TCB Y02082 72532002
*                                       SO DEBCHK-ADD WORKS      Y02082 72542002
         EJECT                                                          72543002
EDI10702 EQU   *                        CHAIN DEB TO R1'S TCB    Y02082 72552002
         BAL   RET,EDI10780             GO TO DEB CHAIN SUBRTN.  Y02082 72562002
         L     R1,DEBTCBAD              TCB WHICH DEB SHOULD BE  Y02082 72572002
*                                       CHAINED TO               Y02082 72582002
         L     RET,DXDEBXAD             GET DEB EXTENSION ADDR   Y02134 72952002
         USING DEBXTN,RET                                        Y02134 72954002
         MVC   DEBXDBPR,JFCINTVL        MOVE DEB ADDR TO DEBX    Y02134 72956002
         DROP  RET                                               Y02134 72958002
         LA    RWTGC,DXXENTRY           CURRENT MODULE NAME             72968002
         LA    RWTG,DXXAREA             NEXT MODULE NAME                72978002
         MVC   JFCBLTYP,DXCCW12+K4      RESTORE LABEL TYPE FOR UL       73200021
         MVC   JFCBELNM(K8),DXCCW10     RESTORE MEMBER FOR BLDL         73400021
         MVC   DSCFILTY(K1),DXCCW11     RESTORE DSCB DSORG              73600021
         MVC   JFCBIND1,DXCCW11+K1      RESTORE PDS MEM IND IN THE JFCB 73800021
         MVC   DSCEXTYP(K6),DXCCW11+K2                                  74000002
*        CHECK FOR DEB CHAINED TO CURRENT TCB                    YM2133 74070000
*                                                                YM2133 74080000
         L     RF,CVTADDR               CVT ADDRESS              YM2133 74092000
         L     RF,CVTTCBP-CVT(RF)       ADDR TCB PTRS            Y02080 74092402
         L     RF,K4(RF)                ADDRESS OF CURRENT TCB   YM2133 74094000
         LA    RF,K0(RF)                ZERO HIGH ORDER BYTE     YM2133 74096000
         LA    R1,K0(R1)                ZERO HIGH ORDER BYTE     YM2133 74098000
*                                                                YM2133 74098400
*        THE EOV WAS ISSUED FROM A TASK DIFFERENT THAN THE ONE   YM2133 74098800
*        IN WHICH THE DEB WAS CREATED IF THE TCB ADDRESS IN THE  YM2133 74099200
*        DEB IS NOT THE SAME AS THE CURRENT TCB ADDRESS.         YM2133 74099300
*                                                                YM2133 74099600
         CLR   R1,RF                    IS DEB ON THIS TCB       YM2133 74099700
         BE    EDI10705                 YES - ISSUE DEBCHK       YM2133 74099800
         CLI   DXCCW6+K4,CHARFF         SPAN RCD IN UPDATE MODE  YM2133 74099900
         BNE   EDI10710                 NO - BYPASS DEBCHK ADD   YM2133 74107000
*                                                                YM2133 74114500
*        EOV IN SAME TASK AS OPEN, OR IN DIFFERENT TASK BUT      YM2133 74121602
*        OLD DEB SAVED - ISSUE DEBCHK ADD                        Y02082 74123602
*                                                                YM2133 74128700
         EJECT                                                          74129702
EDI10705 EQU   *                        INITIALIZE DEB PREFIX    YM2133 74130702
         L     RD,DEBTCBAD              GET DEB'S TCB ADDR       Y02082 74131702
         MVC   DEBTCBAD+K1(K3),DXTCBADR+K1 POINT DEB TO CURRENT  Y02082 74132702
*                                       TCB FOR DEBCHK           Y02082 74133702
         LA    RET,K3                   NEGATIVE OFFSET OF       Y01021 74135800
*                                       DEBAMTYP                 Y01021 74142900
         SR    RDEB,RET                 ADDRESS AMTYPE           Y01021 74150000
         IC    RET,K0(R0,RDEB)          GET ACCESS METHOD TYPE   Y01021 74160000
         XC    K0(K3,RDEB),K0(RDEB)     ZERO DEBAMTYP & DEBTBLOF Y01021 74170002
         L     R1,DXPDCBAD              POINT TO PROTECTED DCB   Y02082 74190002
         DEBCHK (R1),TYPE=ADD,AM=((RET))     ADD DEB TO DEBTABLE Y01021 74192002
         LR    RDEB,R1                  RESTORE DEB ADDRESS      Y01021 74194000
         STCM  RD,B'0111',DEBTCBAD+K1   REPLACE DEB'S TCB ADDR   Y02082 74195002
         CLC   DEBTCBAD+K1(K3),DXTCBADR+K1 IS DEB ON CURRENT TCB Y02082 74204002
         BE    EDI10720                 BRANCH IF YES            Y02082 74224002
*                                                                       74234002
*        DEB IS CHAINED ON WRONG TCB BECAUSE OLD DEB WAS SAVED   Y02082 74244002
*        TO SUPPORT VBS UPDATE - DEB NOW IN DEB TABLE SO UNCHAIN Y02082 74254002
*        FROM CURRENT TCB AND CHAIN TO CORRECT (DEBTCBAD) TCB    Y02082 74264002
*                                                                       74266002
         L     RD,DXTCBADR              CURRENT TCB              Y02082 74266402
         BAL   RET,EDI10750             UNCHAIN FROM CURRENT TCB Y02082 74266802
         L     R1,DEBTCBAD              CORRECT TCB              Y02082 74267202
         BAL   RET,EDI10780             CHAIN TO CORRECT TCB     Y02082 74267302
         B     EDI10720                 GO TO NEXT MODULE        YM2133 74267402
         EJECT                                                   YM2133 74269402
*                                                                YM2133 74271402
*        THE FOLLOWING CODE IS EXECUTED IN LIEU OF DEBCHK        YM2133 74273402
*        WHENEVER THE DEB IS CHAINED TO A TCB DIFFERENT THAN     YM2133 74273802
*        THE CURRENT ONE.  THIS IS ACCOMPLISHED BY REPLACING     YM2133 74274202
*        THE EXISTING DEBTABLE ENTRY WITH THE NEW DEB ADDRESS.   YM2133 74274602
*                                                                YM2133 74275400
EDI10710 EQU   *                        OBTAIN LOCK FOR DEBTABLE YM2133 74275802
         L     RF,DXXPREFX              GET PREFIX               Y02080 74276802
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 74277802
         MODESET  EXTKEY=ZERO           KEY 0                    Y02080 74278802
EDI10712 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02080X74286702
               RELATED=(LOCAL,IFG0553X(EDI10714))                Y02080 74286802
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 74286902
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 74287202
         L     RF,DXTCBADR              GET CURRENT TCB ADDR     Y02080 74287902
         USING TCB,RF                   ESTABLISH TCB ADDR       Y02080 74288002
         L     RF,TCBJSCB               GET ADDR OF JSCB         Y02080 74288102
         DROP  RF                                                Y02080 74288202
         USING IEZJSCB,RF               ESTABLISH JSCB ADDR      Y02080 74288302
         L     R1,JSCBDBTB              GET ADDR OF DEB TBL      Y02080 74288402
         DROP  RF                                                Y02080 74288502
         L     RF,DXCCW6+K4             GET SAVED OFFSET         Y02080 74288602
         LA    RDEB,K0(RDEB)            ZERO HIGH ORDER BYTE     YM2133 74288702
         MODESET EXTKEY=ZERO            KEY OF DEB TABLE         Y02082 74289702
         ST    RDEB,K0(RF,R1)           PLACE NEW ADDR IN TABLE  Y02080 74290702
         EJECT                                                          74290802
         L     RF,DXXPREFX              GET PREFIX               Y02080 74290902
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 74291102
EDI10714 SETLOCK RELEASE,TYPE=LOCAL,                             Y02080X74291702
               RELATED=(LOCAL,IFG0553X(EDI10712))                Y02080 74291902
         MODESET EXTKEY=DATAMGT         RET EOV KEY              Y02082 74292002
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 74293202
         EJECT 1                                               @Y30LSBS 74293303
*                                                              @Y30LSBS 74293403
*        CHECK THE UCB FOR AN MSS SUBSYTEM VIRTUAL DASD AND    @Y30LSBS 74293603
*        CREATE A PARAMETER LIST FROM THE DEB EXTENTS TO       @ZA19720 74293824
*        ACQUIRE STAGING SPACE UP TO THE LAST WRITTEN RECORD   @Y30LSBS 74293924
*        ALL SUCH EXTENTS ARE STAGED.                          @ZA19720 74294024
*                                                              @ZA19720 74294124
*        IF THE DATA SET HAS BEEN OPENED WITH THE INOUT OPTION,@ZA19720 74294224
*        IT IS POSSIBLE FOR THE USER TO READ TO EOF,TCLOSE     @ZA19720 74294324
*        AND THEN START WRITING. IF THE USER DOES THIS, WE WILL@ZA19720 74294424
*        CYLINDER FAULT FOR ALL CYLINDERS BEYOND EOF.          @ZA19720 74294524
*                                                              @ZA19720 74294624
EDI10720 EQU   *                        VIRTUAL DASD ROUTINE   @Y30LSBS 74294724
         LA    RC,DEBBASND              EXTENT ADDRESSABILITY  @ZA19720 74294824
         USING DEBDASD,RC                                      @ZA19720 74294924
         L     RUCB,DEBUCBAD            POINTER TO THE UCB     @ZA19720 74295024
         TM    UCBTBYT2,UCBRVDEV        IS IT VIRTUAL          @Y30LSBS 74295124
         BNO   EDI1074D                 NO, CONTINUE MAINLINE  @Y30LSBS 74295224
         CLC   DEBSTRCC,FOXES           YES,VALID EXTENT?      @ZA19720 74295324
         BE    EDI1074D                 NO, CONTINUE MAINLINE  @ZA19720 74295424
         DROP  RTIOT                                           @ZA19720 74295524
         LA    RTIOT,DXJBF              ESTABLISH ACQUIRE LIST @ZA19720 74295624
         USING ACQLST,RTIOT                                    @ZA19720 74295724
         XC    ACQLST(ACQPLN+8),ACQLST  ZERO OUT A WORK AREA   @ZA19720 74295824
*                                       PARM LIST + MBBCC SAVE @ZA19720 74295924
         MVI   ACQLST+3,ACQPLN          MOVE IN LIST LENGTH    @ZA19720 74296024
         MVC   ARVOL,UCBVOLI            MOVE IN THE VOLID      @ZA19720 74296224
         CLC   DSCLSTAR(K5),ZEROI       IS TTRLL = 0           @Y30LSBS 74296324
         MVI   MCCSAVE,X7F              MAKE M = X'7F00'       @ZA19720 74296424
         BE    EDI10730                 BYPASS TTR CNVT        @ZA19720 74296524
         MVI   MCCSAVE,K0               MAKE M = X'00XX'       @ZA28613 74298524
*                                                              @Y30LSBS 74300703
*        DETERMINE WHERE AND IN WHAT EXTENT LAST RECORD WAS    @Y30LSBS 74300803
*        WRITTEN                                               @Y30LSBS 74306903
*                                                              @Y30LSBS 74307603
EDI10727 EQU   *                                               @Y30LSBS 74308303
         L     RF,DXXPREFX              GET PREFIX             @Y30LSBS 74309003
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE ALL REGS       @Y30LSBS 74309703
         SR    R0,R0                    ZERO                   @Y30LSBS 74310403
         ICM   R0,B'1110',DSCLSTAR      GET THE TTR            @ZA19720 74311124
         LA    R1,R0(RB)                POINT TO THE DEB       @Y30LSBS 74311624
         LA    R2,MCCSAVE+1             MBBCCHHR SAVE AREA     @ZA19720 74312124
         L     RF,CVTADDR               POINT TO CVT           @Y30LSBS 74313203
         L     RF,CVTPCNVT-CVT(RF)      POINT TO TTR CNVT RTN  @Y30LSBS 74313903
         BALR  RET,RF                   GO TO CONVERT ROUTINE  @ZM30032 74314603
         L     RF,DXXPREFX              POINT TO PREFIX        @Y30LSBS 74315303
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGS        @Y30LSBS 74316003
*                                                              @Y30LSBS 74317403
*        M = X'7F00' - NOT LAST VOLUME OF DATA SET             @ZA19720 74318124
*                                                              @ZA19720 74318824
*        M = X'00XX' - THE EXTENT WHERE THE LAST RECORD WAS    @Y30LSBS 74319524
*                      WRITTEN FOR A PHYS. SEQ. DATA SET       @ZA19720 74320224
*                      'M' IS FOLLOWED BY THE BBCCHH. R IS NOT @ZA19720 74320924
*                      NEEDED.                                 @ZA19720 74321624
*                                                              @Y30LSBS 74324403
EDI10730 EQU   *                                               @Y30LSBS 74325103
         SR    RF,RF                    ZERO A REG             @Y30LSBS 74325803
         LR    RET,RF                   ZERO ANOTHER           @Y30LSBS 74326503
         IC    RET,DEBNMEXT             GET NUMBER OF EXTENTS  @Y30LSBS 74327203
*                                                              @Y30LSBS 74329303
*        CREATE THE PARAMETER LIST FOR THE ACQUIRE             @Y30LSBS 74330003
*                                                              @Y30LSBS 74330703
EDI10734 EQU   *                                               @ZA19720 74334124
         MVC   AREXT(2),DEBSTRCC        MOVE IN THE LO CC      @ZA19720 74334824
         CH    RF,JFCTRKBL              EXTENT OF LAST PHYS REC@ZA28613 74335524
         BNE   EDI10745                 NO, GET THE HI CC      @ZM30032 74336124
         LH    R1,JFCRECFM              GET THE CC OF LAST REC @ZA28613 74336724
         CLC   JFCBLKSI(2),DEBENDHH     LAST TRACK OF DS ON CYL@ZA28613 74337324
         BL    EDI10736                 NO, JUST GET UP TO CYL @ZM30032 74337924
         CH    R1,DEBENDCC              LAST CYL OF EXTENT     @ZA28613 74338524
         BE    EDI10738                 YES,GO SEE IF ANOTHER  @ZA19720 74339124
*                                       DEB EXTENT             @ZA19720 74339724
         LA    R1,1(,R1)                INSURE EOF MARK GOTTEN @ZA28613 74340324
EDI10736 EQU   *                                               @Y30LSBS 74340924
         STH   R1,AREXT+2               CC IS THE LAST STAGED  @ZA28613 74341524
         LA    RF,K1(RF)                NUMBER OF EXTENTS      @Y30LSBS 74343224
         B     EDI10749                 GO SAVE NUM OF EXTENTS @ZA19720 74343924
EDI10738 EQU   *  EOF MAY NOT BE ON CYL CONTAING LAST REC      @ZA19720 74344624
         STH   R1,AREXT+2               ENDING CYL OF THIS EXT @ZA19720 74345324
         LA    RF,1(RF)                 COUNT THIS EXTENT      @ZA19720 74346024
         BCTR  RET,0                    IS THERE ANOTHER EXTENT@ZA19720 74346724
         BZ    EDI10749                 NO,GO ISSUE ACQUIRE    @ZA19720 74347424
         LA    RTIOT,L'AREXT(RTIOT)     YES,POINT TO NEXT      @ZA19720 74348124
         LA    RC,DEBEXTLN              EXTENT IN DEB AND ACQ  @ZA19720 74348824
         MVC   AREXT(2),DEBSTRCC        EOF MAY BE ON THE FIRST@ZA19720 74349524
         MVC   AREXT+2(2),DEBSTRCC      TRACK OF THIS CYLINDER @ZA19720 74350224
         LA    RF,1(RF)                 ACCOUNT FOR THIS EXTENT@ZA19720 74350924
         B     EDI10749                 GO ISSUE ACQUIRE       @ZA19720 74351624
EDI10745 EQU   *                                               @Y30LSBS 74352324
         MVC   AREXT+2(2),DEBENDCC      GET HI CC              @ZA19720 74353024
EDI10746 EQU   *                                               @Y30LSBS 74353724
         LA    RTIOT,L'AREXT(RTIOT)     POINT TO NEXT LIST ENT @ZA19720 74354424
         LA    RF,K1(RF)                INCREMENT COUNTER      @Y30LSBS 74355124
EDI10747 EQU   *                                               @Y30LSBS 74355824
         LA    RC,DEBEXTLN              POINT TO NEXT DEB EXT  @ZA19720 74356524
         BCT   RET,EDI10734             RETURN FOR MORE EXTENTS@ZA19720 74357224
*                                                              @Y30LSBS 74357924
*        ISSUE ICBACREL                                        @ZA19720 74358624
*                                                              @Y30LSBS 74359324
EDI10749 EQU   *                                               @Y30LSBS 74360024
         LA    RTIOT,DXJBF                                     @ZA19720 74360724
         STC   RF,ARNMEXTS              ST NUMBER OF EXTENTS   @ZA19720 74361424
         LR    R1,RTIOT                                        @ZA19720 74362124
         DROP  RTIOT                                           @ZA19720 74362824
         USING ACQLST,R1                                       @ZA19720 74363524
         MVI   ACQLST+K4,K2                                    @ZA28613 74363824
         ICBACREL TYPE=ACQ,MF=(E,ACQLST) ACQUIRE THE SPACE     @ZM30032 74364224
         DROP  R1                                              @ZA19720 74364924
         LTR   RF,RF                    ANY ERRORS             @Y30LSBS 74365624
         BZ    EDI1074D                 NO                     @ZA19720 74366324
*        ACQUIRE FAILED - ABEND                                @Y30LSFY 74375503
ERR111   EQU   111                      IDMS FAILURE CODE      @Y30LSFY 74376203
         LR    RB,R1                    PASS PARM LIST PTR     @Y30LSFY 74376903
         LA    RWTGC,DXXENTRY           SET RWTGC FOR RES RTN  @Y30LSFY 74377603
         LA    RWTG,DXXAREA             POINT TO EOV WTG       @Y30LSFY 74378303
         DMABCOND ERR111,LOAD0P         XCTL TO PROB DET       @Y30LSFY 74379003
         DROP  RC                                              @ZA19720 74381024
         USING TIOENTRY,RTIOT                                  @ZA19720 74381524
         EJECT 1                                               @Y30LSBS 74383903
*                                                                       74384603
*        REREAD JFCB TO REFRESH WORKAREA OVERLAID BY DEB         YM3116 74385303
*                                                                       74386003
EDI1074D EQU   *                        RETURN TO RES ROUTINE  @Y30LSBS 74386703
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDR      YM3116 74387403
         LA    RET,TIOEJFCB             GET JFCB ADDRESS ADDRESS YM3116 74388103
         IECRES LOCJFCB,(RET)           LOCATE JFCB ADDRESS      YM3116 74388803
         MVC   DXJBF(JFCBLGTH),INFMJFCB-INFMJFCB(RET) MOVE JFCB  YM3116 74389503
*                                                                       74390203
*        SETUP NEW DEBVOLSQ AND DEBVOLNM                         YM5340 74390903
*        DEBVOLNM CHANGES IF CONCATENATION OF LIKE ATTRIBUTES    YM5340 74391603
*                                                                       74392303
         XR    RET,RET                  ZERO FOR IC              YM5340 74393003
         IC    RET,DEBNMEXT             NUMBER OF 16-BYTE EXTNTS YM5340 74393703
         SLL   RET,K4                   LENGTH OF EXTENTS        YM5340 74394403
         LA    RET,DEBBASND-DEBBASIC(RET,RDEB) RET POINTS TO     YM5340 74395103
*                                       ACCESS METHOD SECTION    YM5340 74395803
         USING DEBACSMD,RET                                      YM5340 74396503
         MVC   DEBVOLSQ,DXVOLSEQ        UPDATE DEBVOLSQ          YM5340 74397203
         MVC   DEBVOLNM+K1(K1),JFCBNVOL UPDATE DEBVOLNM          YM5340 74397903
         DROP  RET                                               YM5340 74398603
         LA    RET,K0                   SET RETURN CODE                 74399303
         LA    RF,LOA5553Z                                              74400021
         IECRES LOAD,MODID=(RF),BRCODE=(RET),BRANCH=QUEUED       Y02080 74650002
         EJECT                                                          74800002
*                                                                       74810002
*        SUBROUTINE TO UNCHAIN DEB FROM TCB                      Y02082 74820002
*        ENTERED IN KEY 5 - EXIT IN KEY 5                        Y02082 74830002
*              RDEB POINTS TO DEB                                Y02082 74840002
*              RD POINTS TO TCB                                  Y02082 74850002
*              RET IS RETURN ADDRESS                             Y02082 74860002
*        REGS 0-14 WILL BE SAVED IN THE WORKAREA PREFIX AND      Y02082 74870002
*        WILL BE RETURNED                                        Y02082 74880002
*        RF WILL BE DESTROYED                                    Y02082 74890002
*                                                                       74900002
EDI10750 EQU   *                        UNCHAIN DEB              Y02082 74910002
         L     RF,WTGPREFX              PT TO PREFIX             Y02082 74920002
         USING IECPREFX,RF                                       Y02082 74930002
         STM   R0,RET,IECREGSV          SAVE REGS THRU LOCK      Y02082 74940002
         MODESET EXTKEY=SUPR            SUPERVISOR KEY           Y02082 74950002
*                                       OBTAIN LOCAL LOCK        Y02082 74960002
EDI10755 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*74970002
               RELATED=(LOCAL,IFG0553X(EDI10775))                Y02082 74980002
         LM    R0,RET,IECREGSV          RESTORE REGS             Y02082 74990002
EDI10760 EQU   *                        LOAD REGISTERS           Y02082 75000002
         LR    RC,RDEB                  PRIME WITH DEB ADDR      Y02082 75010002
         LA    R1,K4(,RD)               TCB ADDRESS + 4          Y02082 75020002
EDI10765 EQU   *                        CHECK FOR CORRECT DEB    YM1482 75030002
         CLM   RC,B'0111',DEBDEBAD+K1-DEBBASIC(R1) EQUAL?        YM1482 75040002
         BE    EDI10770                 BRANCH, IF YES                  75050002
         L     R1,DEBDEBAD-DEBBASIC(,R1) GET CORRECT DEB         YM1482 75060002
         B     EDI10765                 BRANCH TO TEST FOR CORRECT DEB  75070002
EDI10770 EQU   *                        CORRECT DEB DELETE IT    Y02082 75080002
         L     R8,DEBDEBAD              PTR TO NEXT DEB          Y02082 75090002
         ICM   R8,B'1000',DEBDEBAD-DEBBASIC(R1) PRIME HI BYTE    YM1482 75100002
         ICM   RC,B'1000',DEBDEBAD-DEBBASIC(R1)                  YM1482 75110002
         CS    RC,R8,DEBDEBAD-DEBBASIC(R1) DECHAIN DEB           YM1482 75120002
         BNZ   EDI10760                 BR IF NOT SUCCESSFUL     Y02082 75130002
         OI    DXATEOV,DXATDCHN         SHOW DEB DECHAINED       Y02144 75140002
         EJECT                                                          75142002
EDI10775 SETLOCK RELEASE,TYPE=LOCAL,                             Y02082*75150002
               RELATED=(LOCAL,IFG0553X(EDI10755))                Y02082 75160002
         LM    R0,RET,IECREGSV          RESTORE REGS             Y02082 75170002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 75180002
         BR    RET                      RETURN TO CALLER         Y02082 75190002
         DROP  RF                                                Y02082 75200002
         SPACE 2                                                        75202002
*                                                                       75204002
*        SUBROUTINE TO CHAIN DEB TO TCB                          Y02082 75206002
*        ENTERED IN KEY 5, EXIT IN KEY 5                         Y02082 75208002
*              RDEB POINTS TO DEB                                Y02082 75208402
*              R1 POINTS TO TCB                                 Y02082  75208802
*              RET POINTS TO RETURN ADDRESS                      Y02082 75209202
*              RD WILL BE DESTROYED IN THIS SUBROUTINE           Y02082 75209602
*                                                                       75209702
EDI10780 EQU   *                        CHAIN DEB TO TCB         Y02082 75210002
         USING TCB,R1                                                   75212002
         LA    RDEB,K0(,RDEB)           CLEAR HIGH BYTE          Y02082 75214002
         L     RD,TCBDEB                PT TO FIRST DEB          Y02080 75220002
         MVC   DEBDEBAD+K1(K3),TCBDEB+K1 DEB POINTER FROM TCB    Y02082 75230002
         MODESET EXTKEY=SUPR            TCB MODIFIED             Y02082 75240002
         CS    RD,RDEB,TCBDEB           CHAIN NEW DEB            Y02082 75250002
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 75260002
         BNZ   EDI10780                 BR IF NOT SUCCESSFUL     Y02082 75270002
         NI    DXATEOV,X'FF'-DXATDCHN   SHOW DEB CHAINED         Y02144 75280002
         BR    RET                      RETURN TO CALLER                75290002
         SPACE 2                                                        75290102
EDI10782 DMABCOND PCK,PGFREE            PGFREE ERROR             YM5929 75290302
         EJECT                                                          75300002
*                                                                       79450002
*                   CONSTANTS                                           79500002
*                                                                       79550002
         SPACE 1                                                        79600002
         DS    0F                                                       79650002
COLC0036 DC    H'36'                    CONSTANT 36                     80200021
FOXES    DC    X'FFFFFFFF'              INVALID EXTENT         @Y30LSBS 80230003
ZEROI    DC    X'0000000000'            ZEROS                  @Y30LSBS 80250003
*                                                              @Y30LSBS 80280003
*        SOME MSS  EQUATES                                     @Y30LSBS 80310003
*                                                              @Y30LSBS 80340003
ACQPLN   EQU   96                       PARM LIST LENGTH       @Y30LSBS 80370003
ACQOP    EQU   X'02'                    ACQUIRE OP CODE        @Y30LSBS 80370103
X7F      EQU   X'7F'                    A VERY HIGH 'M' VALUE  @Y30LSBS 80586003
         EJECT                                                          80600002
         XCTLTABL ID=(LOA5553Z,3Z,LOAD0P,0P),                    Y02134X80800002
               SVC=055,BRT=YES,LENGTH=                           Y02080 80810002
         IECDSECS CVT,TCB,TIOT,DCB,UCB,MAIN,WTG,PREFX,IEZDEB,    YM1272*81000002
               JSCB,PSA,EXPAND=YES                               Y02134 81050002
DEBEXTLN EQU    DEBNMTRK+L'DEBNMTRK                            @ZA19720 81120024
         IECEQU IEZDEB=YES                                       Y02134 81170024
ACQLST   DSECT                                                 @Y30LSFY 81220024
         ICBACREL TYPE=ACQ,MF=L         LIST FORM OF ACQUIRE   @Y30LSBS 81270024
MCCSAVE  DS    CL9                                             @ZA19720 81320024
         END                                                            81370024
./  ADD  SSI=43050672,NAME=IFG0553Z
         TITLE ' EOV INPUT DA FINAL EXIT MODULE -  IFG0553Z '           00300021
*********************************************************************** 00350002
*                                                                     * 00400002
*                                                                     * 00450002
*        VS 2 RELEASE 03 DELETIONS/CHANGES                            * 00460002
*0000671500,672000,684500                                       ZA01290 00470002
*          VS2 RELEASE 02 DELETIONS                                   * 00500002
*                                                                     * 00550002
*                                                                     * 00600002
*********************************************************************** 00650002
*                                                                     * 00700002
* MODULE NAME = IFG0553Z (OS/VS2)                                     * 00750002
*                                                                     * 00800002
* DESCRIPTIVE NAME =                                                  * 00850002
*        EOV INPUT DA FINAL EXIT MODULE                               * 00900002
*                                                                     * 00950002
* COPYRIGHT = NONE                                                    * 01000002
*                                                                     * 01050002
* STATUS = RELEASE 2, LEVEL 0                                         * 01100002
*                                                                     * 01150002
* FUNCTION =                                                          * 01200002
*        THIS MODULE IS GIVEN CONTROL FROM IFG0553X AFTER BUILDING    * 01250002
*        A NEW DEB FOR A NEW VOLUME.                                  * 01300002
*                                                                     * 01350002
*        1) IF USER LABEL PROCESSING IS REQUIRED, MODULE IFG0554L     * 01400002
*        IS GIVEN CONTROL WITH BITS 5 AND 6 OF JFCBMASK+5 SET TO 1    * 01450002
*        AND DXRETMOD SET TO RETURN TO THIS MODULE.                   * 01500002
*                                                                     * 01550002
*        2) UPON RETURN FROM USER LABEL PROCESSING OR IF IT WAS NOT   * 01600002
*        REQUIRED, THE DCBFDAD IS INITIALIZED FROM THE FIRST EXTENT   * 01650002
*        IN THE DEB. IF CONCATENATION TO A MEMBER NAME A BLDL IS      * 01700002
*        PERFORMED TO OBTAIN THE TTR OF THE MEMBER. THIS IS PASSED    * 01750002
*        TO THE TTR-MBBCCHHR RESIDENT CONVERT ROUTINE TO OBTAIN AN    * 01800002
*        MBBCCHHR WHICH IS PLACED IN DCBFDAD.                         * 01850002
*                                                                     * 01900002
*        3) IF AN EXCP DCB, THE USER DCB IS REFRESHED, THE EOV        * 01950002
*        WORKAREA IS FREED AND THE CALLER IS EXITED TO.               * 02000002
*                                                                     * 02050002
*        4) IF NOT EXCP, THE BSAM/QSAM EXECUTOR IS TRANSFERRED        * 02100002
*        CONTROL.                                                     * 02150002
         EJECT                                                          02200002
* NOTES =                                                             * 02250002
*        SEE BELOW.                                                   * 02300002
*                                                                     * 02350002
*    DEPENDENCIES =                                                   * 02400002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 02450002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 02500002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 02550002
*                                                                     * 02600002
*    RESTRICTIONS = NONE                                              * 02650002
*                                                                     * 02700002
*    REGISTER CONVENTIONS =                                           * 02750002
*            R2 POINTS TO DCB                                         * 02800002
*            R4 POINTS TO OPEN WORK AREA                              * 02850002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 02900002
*            R6 POINTS TO THE WTG TABLE                               * 02950002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 03000002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 03050002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 03100002
*            R10 POINTS TO THE UCB                                    * 03150002
*                                                                     * 03200002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 03250002
*                  END OF LISTING.                                    * 03300002
*                                                                     * 03350002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 03400002
*                                                                     * 03450002
*    PROCESSOR = ASSEMBLER XF                                         * 03500002
*                                                                     * 03550002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 03600002
*                  ORG STATEMENT AT END OF LISTING                    * 03650002
*                                                                     * 03700002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 03750002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 03800002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 03850002
*                                                                     * 03900002
* ENTRY POINT =                                                       * 03950002
*        IFG0553Z                                                     * 04000002
*                                                                     * 04050002
*    PURPOSE = SEE FUNCTION                                           * 04100002
*                                                                     * 04150002
*    LINKAGE =                                                        * 04200002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 04250002
*        MACRO INSTRUCTION.                                           * 04300002
         EJECT                                                          04350002
* INPUT =                                                             * 04400002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 04450002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 04500002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 04550002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 04600002
*                                                                     * 04650002
*        FROM IFG0553X - BITS 5&6 IN JFCBMASK+5 SET TO ZERO.          * 04700002
*                                                                     * 04750002
*        FROM IFG0554L - BITS 5&6 IN JFCBMASK+5 SET TO ONE.           * 04800002
*                                                                     * 04850002
* OUTPUT =                                                            * 04900002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 04950002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 05000002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 05050002
*                                                                     * 05100002
*        IFG0554L -                                                   * 05150002
*        DXRETMOD SET TO ID-VCON OF IFG0553Z.                         * 05200002
*        REGISTER 14 SET TO ZERO.                                     * 05250002
*                                                                     * 05300002
*        IFG0551L -                                                   * 05350002
*        DEBDCBAD POINTS TO USER'S DCB.                               * 05400002
*                                                                     * 05410002
*        IFG0550P -                                                   * 05420002
*        INTERNAL ABEND CODE IN REGISTER 0.                           * 05430002
*                                                                     * 05450002
*        EXIT TO CALLER OF EOV -                                      * 05500002
*        REGISTER 15 SET TO ZERO.                                     * 05550002
*        EOV WORKAREA(S) FREED.                                       * 05600002
*        DEB POINTS TO USER'S DCB.                                    * 05650002
*        USER DCB REFRESHED FROM COPIED DCB.                          * 05700002
*                                                                     * 05750002
* EXIT-NORMAL =                                                       * 05800002
*        IFG0554L TO PROCESS USER HEADER LABELS.                      * 05850002
*        IFG0551L TO COMPLETE EOV PROCESSING.                         * 05900002
*                                                                     * 05950002
* EXIT-ERROR =                                                        * 06000002
*        IFG0550P WITH AN INTERNAL ABEND CODE IN REGISTER 0 -         * 06050002
*        218 - CAUSING 737-24 ABEND - MEMBER NAME NOT FOUND.          * 06060002
*        171 - CAUSING 737-0C ABEND - I/O ERROR READING DIRECTORY.    * 06070002
         EJECT                                                          06100002
* EXTERNAL REFERENCES = SEE BELOW                                     * 06150002
*                                                                     * 06200002
*    ROUTINES =                                                       * 06250002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 06300002
*                                                                     * 06350002
*        IECPCNVT - TTR TO MBBCCHHR CONVERT ROUTINE                   * 06400002
*                                                                     * 06450002
*    DATA AREAS =                                                     * 06500002
*        EOV WORKAREA.                                                * 06550002
*                                                                     * 06600002
*    CONTROL BLOCK =                                                  * 06650002
*        DCB                                                          * 06700002
*        TCB                                                          * 06750002
*        CVT                                                          * 06800002
*        DEB                                                          * 06850002
*        DEB EXTENSION                                                * 06900002
*                                                                     * 06950002
* TABLES =                                                            * 07000002
*        NONE.                                                        * 07050002
*                                                                     * 07100002
* MACROS =                                                            * 07150002
*        MODESET                                                      * 07200002
*        BLDL                                                         * 07250002
*        IECRES-LOAD                                                  * 07300002
*        IECRES-INIT                                                  * 07350002
*        IECRES-FREE                                                  * 07400002
*        IECRES-EXIT                                                  * 07450002
*        DMABCOND                                                     * 07500002
*        XCTLTABL                                                     * 07550002
*        IECDSECS                                                     * 07600002
*        IECEQU                                                       * 07650002
*                                                                     * 07700002
* CHANGE ACTIVITY =                                                   * 07750002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 07800002
*                                                                     * 07850002
*********************************************************************** 07900002
         EJECT                                                          07950002
IFG0553Z CSECT                                                          34200021
ERR171   EQU   171                      CODE FOR 737-0C ABEND           34500002
ERR218   EQU   218                      CODE FOR 737-24 ABEND   SA58102 34550002
*                                                                       34800021
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        35100021
         USING FORCORE,RCORE                                            35400021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 35450002
         USING DEBBASIC,RDEB                                     YM1272 35700002
         USING IHADCB,RDCB                                              36000021
         USING CVT,RF                                                   36300021
         USING *,RBASE                                                  36600021
         B     EDI10925(RET)            BR ACCORDING TO RETURN CODE     36900021
EDI10925 EQU   *                        DETERMINE ENTRY CONDITION       37200002
         B     EDI10950                 CONTINUE EOV PROCESSING  YM1193 37500002
         NOP   EDI10925                 NO ENTRY OFFSET 4        YM1193 37550002
*                                                                     * 38400021
***** USER HEADER LABEL PROCESSING SECTION                        ***** 38700021
*                                                                     * 39000021
EDI10950 EQU   *                        TEST IF RETURN FROM SUL  Y02082 39300002
         TM    JFCBMASK+K5,K6                                           39350002
*                                       TEST IF RETURNING FROM UL       39600021
         BO    EDI11300                 PROCESSING, BRANCH              39900021
*        DCBIOBAD CAN BE TESTED ONLY IF NOT EXCP AND NOT CHAINED YM1194 39950002
*        SCHEDULING                                              YM1194 40000002
         TM    DCBMACRF,DCBMEXCP        IS THIS AN EXCP DCB      YM1194 40050002
         BO    EDI10960                 BR IF YES-NO DCBCIND2    YM1194 40100002
         TM    DCBCIND2,DCBC2CHN        IS CHAINED SCHEDULING    YM1194 40150002
         BO    EDI10960                 BR IF YES                YM1194 40160002
         TM    DCBIOBAD,MASKFL9J        HAVE UL BEEN PROCESSED          40200021
         BO    EDI11200                 YES,BRANCH                      40500021
EDI10960 EQU   *                        SEE IF SUL               YM1194 40550002
         TM    JFCBLTYP,JFCSUL          CHECK IF 'SUL' SPECIFIED        40800021
         BNO   EDI11400                 BRANCH IF NOT SUL               41100002
         TM    DCBMACRF,DCBMEXCP        IS THIS AN EXCP DCB      YM1194 41110002
         BNO   EDI10975                 BR IF NO                 YM1194 41120002
         TM    DCBMACRF,DCBMRCI         IS DSORG PRESENT         YM1194 41150002
         BZ    EDI10980                 BRANCH IF NO             YM1194 41200002
EDI10975 EQU   *                        SUL ONLY FOR PS          YM1194 41250002
         TM    DCBDSORG,DCBORGPS        TEST,BRANCH IF DSORG IS NOT     41400021
         BZ    EDI11400                 PHYSICAL SEQUENTIAL             41700021
EDI10980 EQU   *                        EXCP MAY NOT HAVE EXLST  YM1194 41750002
         TM    DCBMACRF,DCBMEXCP        IS THIS AN EXCP DCB      YM1194 41800002
         BNO   EDI10990                 BR IF NO                 YM1194 41850002
         TM    DCBMACRF,DCBMFOUN        IS EXLST PRESENT         YM1194 41900002
         BZ    EDI11400                 BRANCH IF NO             YM1194 41950002
         EJECT                                                          41952002
*                                                                       41954002
*        USER LABEL PROCESSING REQUESTED                                41956002
*                                                                       41958002
EDI10990 EQU   *                        SEARCH EXIT LIST         YM1194 41960002
         L     RC,DCBEXLST              PICK UP EXIT LIST FROM DCB      42000021
         LA    RC,K0(K0,RC)             ZERO HI BYTE OF EXIT LIST       42300021
         LTR   RC,RC                    IS EXIT LIST ADDR ZERO     UL17 42600021
         BZ    EDI11400                 YES, SKIP USER LABELS           42900021
EDI11000 EQU   *                        LOOK FOR EXIT                   43200002
         MODESET KEYADDR=DXUKEY,WORKREG=7 EXIT LIST IN USER      Y02082 43250002
         CLI   K0(RC),CSWUNITX          IS THIS ACTIVE EXIT ONE         43500021
         BE    EDI11100                 GO TO PROCESS USER LABELS       43800021
         CLI   K0(RC),CSWUNITX+LASTNTRY  SEE IF LAST INDICATOR  ON      44100021
         BE    EDI11100                 GO TO PROCESS USER LABELS       44400021
         TM    K0(RC),LASTNTRY          IS THIS LAST ENTRY IN LIST      44700021
         LA    RC,K4(K0,RC)             POINT TO NEXT ENTRY             45000021
         BZ    EDI11000                 NO,BRANCH                       45300021
         MODESET EXTKEY=DATAMGT         RETURN TO O/C/E KEY      Y02082 45350002
         B     EDI11400                 NO EXIT FOR UL                  45600021
EDI11100 EQU   *                        EXIT FOUND - SEE IF ZERO        45900002
         L     RC,K0(K0,RC)             PICK UP USER'S EXIT ADDRESS     46200021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM1291 46250002
         LA    R7,K0(RC)                CLEAR HI ORDER BYTE             46500021
         LTR   R7,R7                    IS EXIT ADDRESS ZERO            46800021
         BZ    EDI11400                 YES, BYPASS UL PROCESSING       47100021
         OI    JFCBMASK+K5,K6           SET EOV BITS TO IFG0554L        47400002
         MVC   DXRETMOD(K5),LOAD3Z      RETURN ID/TTR                   49200021
         LA    RF,LOAD4L                ID/TTR OF UTL ROUTINE           49500021
         SR    RET,RET                  SET RETURN CODE                 49800021
         B     EDI11900                 TO NEXT MODULE VIA RES ROUTINE  50100021
EDI11200 EQU   *                        SET DCBIOBAD TO 1               50400002
         XC    DCBIOBAD,DCBIOBAD                                        50450002
         OI    DCBIOBAD+K3,K1                                           50700021
         B     EDI11400                 BRANCH                          51000021
EDI11300 EQU   *                        RETURN FROM USER LABEL MODULE   51300002
         NI    JFCBMASK+K5,K255-K6      TURN OFF UL ENTRY FLG           51600002
         EJECT                                                          51650002
EDI11400 EQU   *                        NO USER LABEL PROCESSING        52200002
         NI    DCBOFLGS,ALLBITS-DCBOFEOV-DCBOFTM RESET TPMRK AND CONCAT 52500002
*                                       SWITCHES                        52550002
         TM    DCBMACRF,DCBMEXCP        IS THIS AN EXCP DCB             52800021
         BNO   EDI11500                 NO,GO TO SET UP FULL DISK ADDR  53100002
         TM    DCBMACR2,DCBMR5WD+DCBMR4WD DOES DA DEVICE DEPEND EXIST   53400002
         BZ    EDI11600                 NO, GO EXIT              M0064  53600002
*                                                                       53850002
*        SET DCBFDAD TO FIRST EXTENT IN NEW DEB                         53900002
*                                                                       53950002
EDI11500 EQU   *                        SET DCBFDAD FROM DEB            54000002
         MVI   DCBFDAD,K0               SET M TO ZERO IN DCB FULL DISK  54050002
*                                       ADDRESS                         54300021
         LA    R1,DEBBASND              PT TO DA SECT            YM1272 54350002
         USING DEBDASD,R1               BASE TO DA SECTION       YM1272 54400002
         MVC   DCBFDAD+K1(K6),DEBBINUM  SET BBCCHH IN DCB FULL DISK ADR 54600002
         DROP  R1                                                YM1272 54650002
         MVI   DCBFDAD+K7,K0            SET RECORD NUMBER TO ZERO       55200021
*                                                                     * 55500021
****    TEST FOR CONCATENATION OF MEMBERS WITH BSAM                     55800002
*                                                                     * 56100021
         TM    JFCBIND1,JFCBPMEM        YES,JFCB SPECIFY PDS MEMBER     56400021
         BNO   EDI11600                 NO,CONTINUE NORMAL PROCESSING   56700002
         CLI   JFCBELNM,BLANK           WAS THE MEMBER SPECIFIED        57000021
         BC    12,EDI11600              NO,CONTINUE                     57300021
         TM    DSCFILTY,DS1ORGPO        DSCB SPECIFY PO                 57600002
         BC    12,EDI11600              NO,CONTINUE                     57900021
         EJECT                                                          57950002
*                                                                       58000002
*        BPAM MEMBER BEING CONCATENATED TO                              58050002
*              ISSUE BLDL TO LOCATE (OBTAIN TTR) MEMBER                 58100002
*              CONVERT TTR TO MBBCCHHR AND PLACE IN DCBFDAD             58150002
*                                                                       58160002
         XC    DXCCW10(K4),DXCCW10      CLEAR BLDL LIST                 58200002
         MVC   DXCCW10+K4(K8),JFCBELNM  SET MEMBER NAME IN BLDL LIST    58800002
         MVI   DXCCW10+K1,K1            YES,SET BLDL LIST TO INE ENTRY  59400021
         MVI   DXCCW10+K3,K12           INDICATE THAT BLDL LIST 12 BYTE 59700021
         LA    R0,DXCCW10               SET REGISTER 0 TO BLDL LIST LOC 60000021
         SPACE 2                                                        60050002
         BLDL  0(RDCB),(0)              FIND THE TTRN OF THE MEMBER     60300021
         SPACE 2                                                        60350002
         LTR   RF,RF                    DID BLDL DETECT AN ERROR        60600021
         BNE   EDI12000                 YES, ISSUE ABEND                60900021
         L     R0,DXCCW10+K12           GET MEMBER TTR BLDL RETURNED    61200002
         SH    R0,ANUM1                 DECREMENT 1 FROM R              61800021
         LR    R1,RDEB                  DEB ADDRESS TO PARAMETER REG    62100021
         ST    RDCB,DXCCW7              SAVE THE DCB ADDRESS            62400021
         LA    RDCB,DCBFDAD             ADDRESS FOR RESULT OF CONVERT   62700021
         STM   RTIOT,RD,DXCCW8          SAVE REGISTERS                  63000021
         L     RF,CVTPTR                ADDRESS OF CVT                  63300021
         L     RF,CVTPCNVT              TTR TO MBBCCHHR CONVERT ROUTINE 63600021
         BALR  RET,RF                   GO TO THE CONVERT ROUTINE       63900021
         L     RDCB,DXCCW7              RESTORE THE DCB ADDRESS         64200021
         LM    RTIOT,RD,DXCCW8          RESTORE REGISTERS               64500021
         EJECT                                                          64550002
EDI11600 EQU   *                        EXIT                            64800002
*                                                                     * 65220021
*****  DETERMINE IF BSAM/QSAM EXECUTOR REQUIRED                   ***** 65400021
*                                                                     * 65700021
EDI11725 EQU   *                        POINT DEB TO USER DCB    Y02080 65750002
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXUDCBAD+K1 POINT DEB  Y02082*65800002
                                        TO USER DCB              Y02082 65900002
         L     R1,DXDEBXAD              GET PTR TO DEB EXTENSION YM1272 65960002
         NI    DEBXFLG1-DEBXTN(R1),ALLBITS-DEBXCDCB DEB PT USER  YM1272 65970002
         TM    DCBMACRF,DCBMEXCP        IS THIS AN EXCP DCB             66000021
         BC    K12,EDI11800             NO,GO TO ACCESS METHOD EXECUTOR 66300021
*                                                                       66350002
*        EXCP - EXIT TO USER                                            66400002
*                                                                       66450002
         NI    DCBOFLGS,ALLBITS-DCBOBUSY  RESET I/O SUPPORT BIT         68400021
*                                                                Y02082 68410002
*        COPY DCB TO USER'S STORAGE                              Y02082 68420002
*                                                                Y02082 68430002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,DXXPREFX)          Y02082 68440002
*                                                                Y02082 68442002
         IECRES FREE,A=(RCORE),PREFIX=EOV FREE EOV WORK AREA    ZA01290 68450002
         SR    RF,RF                    SET RETURN CODE TO 0     Y02080 68500002
         IECRES EXIT                    RETURN                   Y02080 68700002
         EJECT                                                          68750002
*                                                                       68800002
*        GIVE EOV ACCESS METHOD EXECUTOR CONTROL                        68850002
*                                                                       68900002
EDI11800 EQU   *                        SET UP EOV WTG TABEL            69000002
         MVC   DXXMODID(K2),LOAD1L                               Y02080 69600002
*                                       MOVE ID OF SAM EXEC TO WORKAREA 69900021
         MVC   DXXMODEP+K1(K3),LOAD1L+K2                         Y02080 70200002
*                                       MOVE TTR TO WORKAREA            70500021
         SR    RF,RF                    ZERO WORK REG           YM0992  70600000
         IC    RF,LOAD1L+K5             GET MODULE LENGTH       YM0992  70650000
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT XCTL          Y02080 71150002
         EJECT                                                          71200002
EDI11900 EQU   *                        GO TO USER LABEL MODULE         71400002
         BAL   RD,EDI12300              SET UP REGS RWTG AND RWTGC      71700021
         IECRES LOAD,MODID=(RF),BRCODE=(RET),BRANCH=QUEUED       Y02080 72050002
         SPACE 2                                                        72100002
EDI12000 EQU   *                        ABEND ROUTINE                   72300021
         BAL   RD,EDI12300              SET UP REGS RWTG AND RWTGC      72600021
         LA    RD,K4                    MISSING ENTRY CODE      SA58102 72650002
         CR    RF,RD                    DID BLDL DETECT MISSING SA58102 72700002
*                                       ENTRY                   SA58102 72750002
         BNE   EDI12100                 NO, I/O ERROR           SA58102 72800002
         DMABCOND ERR218,LOAD0P         GO TO PROBLEM DETERM.   SA58102 72850002
EDI12100 EQU   *                        I/O ERROR               SA58102 72860002
         DMABCOND ERR171,LOAD0P         GO TO PROBLEM DETERMINATION     72900021
         SPACE 2                                                        72950002
EDI12300 EQU   *                        REESTABLISH REGISTERS 6, 8      79500002
         LA    RWTGC,DXXENTRY           CURRENT MODULE NAME             79800021
         LA    RWTG,DXXAREA             NEXT MODULE NAME                80100021
         BR    RD                       RETURN TO CALLER                80400021
         EJECT                                                          80700002
*        CONSTANTS                                                      80750002
*                                                                       80800002
ANUM1    DC    X'0100'                  DECREMENTS BLDL'S TTR BY 1      81600021
         SPACE 2                                                        81650002
         XCTLTABL ID=(LOAD0P,0P,LOAD1L,1L,LOAD3Z,3Z,LOAD4L,4L),  YM1193X82250002
               SVC=055,BRT=YES,LENGTH=                           YM1193 82300002
         IECDSECS CVT,TCB,DCB,IEZDEB,MAIN,WTG,PREFX,EXPAND=YES   YM1272 82500002
         IECEQU IEZDEB=YES                                       YM1272 82800002
         END                                                            83100021
./  ADD  SSI=43521195,NAME=IFG0554B
         TITLE 'IFG0554B                      FEOV DIRECT ACCESS VBS UP*00200002
               DATE REPOSITIONING/FREE DEB FUNCTION'             Y02082 00250002
IFG0554B CSECT                                                          00300002
*********************************************************************** 00350002
*                                                                     * 00400002
*                                                                     * 00450002
*          VS2 RELEASE 03 DELETIONS                                   * 00460002
*0000                                                          @ZM33024 00470002
*0000                                                          @ZA02522 00480002
*0000                                                          @ZA02528 00480102
*          VS2 RELEASE 02 DELETIONS                                   * 00500002
*                                                                     * 00550002
*                                                                     * 00600002
*********************************************************************** 00650002
*                                                                     * 00700002
* MODULE NAME = IFG0554B (OS/VS2)                                     * 00750002
*                                                                     * 00800002
* DESCRIPTIVE NAME =                                                  * 00850002
*        FEOV DIRECT ACCESS VBS UPDATE REPOSITIONING/FREE DEB FUNCTION* 00900002
*                                                                     * 00950002
* COPYRIGHT = NONE                                                    * 01000002
*                                                                     * 01050002
* STATUS = RELEASE 2, LEVEL 0                                         * 01100002
*                                                                     * 01150002
* FUNCTION =                                                          * 01200002
*        ENTERED FROM IFG0551H IF BIT 3 IN DCBIOBAD IS SET TO 1       * 01250002
*        AND FEOV WAS ISSUED FOR A DIRECT ACCESS UPDATE DATA SET      * 01300002
*        PROCESSING VARIABLE BLOCKED SPANNED RECORDS.                 * 01350002
*                                                                     * 01400002
*        THIS MODULE HAS TWO FUNCTIONS-                               * 01450002
*                                                                     * 01460002
*        1) (CALLED THE 'FREE OLD DEB' FUNCTION) FREE THE DEB         * 01500002
*        WHOSE ADDRESS HAS BEEN SAVED IN DCBIOBAD.                    * 01550002
*        THIS INVOLVES REMOVING IT FROM THE DEB TABLE AND FREEING THE * 01600002
*        VIRTUAL STORAGE IT OCCUPIES.                                 * 01650002
*                                                                     * 01660002
*        2) (CALLED THE 'REPOSITION' FUNCTION) REESTABLISH THE        * 01700002
*        DEB WHOSE ADDRESS HAS BEEN SAVED IN DCBIOBAD (CHAIN IT TO    * 01750002
*        THE TCB DEB CHAIN AND ENSURE THE VOLUME IT REPRESENTS IS     * 01800002
*        MOUNTED BY GIVING IFG0554A CONTROL) AND FREEING THE CURRENT  * 01850002
*        DEB WHICH DCBDEBAD POINTS TO.                                * 01900002
         EJECT                                                          01950002
*        THE 'REPOSITION' FUNCTION IS IMPLEMENTED AS FOLLOWS-         * 02000002
*                                                                     * 02050002
*        R1) THE CURRENT DEB IS PAGE FREED IF IT HAD BEEN PAGE FIXED. * 02060002
*        THE LOCAL LOCK IS OBTAINED AND THE CURRENT DEB (POINTED      * 02100002
*        TO BY DCBDEBAD) IS DELETED FROM THE TCB DEB CHAIN OF THE TCB * 02150002
*        IN DEBTCBAD.                                                 * 02200002
*                                                                     * 02250002
*        R2) STILL HOLDING THE LOCK, THE BRANCH ENTRY TO THE DEB      * 02300002
*        VALIDITY CHECK ROUTINE IS ENTERED TO VERIFY THAT THE OLD DEB * 02350002
*        POINTED TO BY DCBIOBAD IS IN THE DEB TABLE. IT IS VERIFIED   * 02400002
*        THAT THE DEBDCBAD OF THE OLD DEB POINTS TO THE USER'S DCB    * 02450002
*        WITH ITS LOW ORDER BIT FLIPPED. IF EITHER OF THESE TESTS     * 02500002
*        FAIL, PROBLEM DETERMINATION IS GIVEN CONTROL CAUSING A       * 02550002
*        937-1C ABEND. THE LOCAL LOCK IS RELEASED.                    * 02600002
*                                                                     * 02650002
*        R3) THE OLD DEB IS POINTED TO THE COPIED DCB AND THE         * 02700002
*        COPIED DCB IS POINTED TO THE OLD DEB.                        * 02750002
*                                                                     * 02800002
*        R4) THE OLD DEB IS CHAINED TO THE TCB DEB CHAIN OF THE       * 02850002
*        TCB IN ITS DEBTCBAD.                                         * 02900002
*                                                                     * 02950002
*        R5) THE DEB EXTENSION IS POINTED TO THE OLD DEB.             * 03000002
*                                                                     * 03050002
*        R6) THE CURRENT DEB IS SAVED IN DCBIOBAD. THE CURRENT DEB    * 03100002
*        IS NOW CONSIDERED THE DEB TO BE FREED AND THE 'FREE OLD DEB' * 03150002
*        LOGIC IS ENTERED AS F3) BELOW.                               * 03200002
         EJECT                                                          03250002
*        THE 'FREE OLD DEB' FUNCTION IS IMPLEMENTED AS FOLLOWS-       * 03300002
*                                                                     * 03350002
*        F1) THE LOCAL LOCK IS OBTAINED AND THE BRANCH ENTRY TO THE   * 03400002
*        DEB VALIDITY CHECK ROUTINE IS ENTERED TO VERIFY THAT THE DEB * 03450002
*        TO BE FREED (POINTED TO BY DCBIOBAD) IS IN THE DEB TABLE.    * 03500002
*        IF IT IS NOT CONTROL IS GIVEN TO F4 BELOW, CAUSING A 16E     * 03550002
*        ABEND WHEN AN ATTEMPT IS MADE TO DELETE THE DEB FROM THE DEB * 03600002
*        TABLE USING THE DEBCHK-DELETE MACRO. THE LOCAL LOCK IS       * 03650002
*        RELEASED.                                                    * 03700002
*                                                                     * 03750002
*        F2) IT IS VERIFIED THAT THE DEB TO BE FREED HAS THE ADDRESS  * 03800002
*        OF THE USER'S DCB IN DEBDCBAD WITH THE LOW ORDER BIT         * 03850002
*        FLIPPED. IF NOT CONTROL IS PASSED TO F4 BELOW CAUSING        * 03900002
*        A 16E ABEND.                                                 * 03950002
*                                                                     * 04000002
*        F3) THE DEBDCBAD FIELD OF THE DEB TO BE FREED IS POINTED     * 04050002
*        TO THE COPIED DCB-16 (DCB-(DCBDEBAD-DCBIOBAD)). THIS         * 04100002
*        ADDRESS AT OFFSET DCBDEBAD POINTS TO THE DCBIOBAD WHICH      * 04150002
*        WILL ALLOW DEBCHK-DELETE TO REMOVE THE DEB ADDRESS FROM THE  * 04200002
*        DEB TABLE.                                                   * 04250002
*                                                                     * 04300002
*        F4) DEBCHK-DELETE IS INVOKED PASSING AS A DCB ADDRESS THE    * 04350002
*        ADDRESS OF THE COPIED DCB-16. DEBCHK WILL FIND AT OFFSET     * 04400002
*        DCBDEBAD THE ADDRESS OF THE DEB TO BE FREED, AND THE         * 04450002
*        DEBDCBAD OF THIS DEB POINTS BACK TO THE 'DCB' (DCB-16).      * 04500002
*        THUS, DEBCHK WILL PROCEDE WITH ITS FUNCTION.                 * 04550002
*                                                                     * 04600002
*        F5) THE DEB TO BE FREED IS FREEMAINED USING A DIRECTED       * 04650002
*        BRANCH ENTRY TO FREEMAIN DIRECTED TO THE TCB IN DEBTCBAD.    * 04700002
         EJECT                                                          04750002
*        IF THE 'FREE OLD DEB' FUNCTION WAS INVOKED, BITS 2 AND 3 IN  * 04800002
*        DCBIOBAD ARE SET TO 1 AND MODULE IFG0551L IS GIVEN CONTROL   * 04850002
*        TO COMPLETE EOV PROCESSING.                                  * 04900002
*                                                                     * 04950002
*        IF THE 'REPOSITION' FUNCTION WAS INVOKED, BIT 2 OF DCBIOBAD  * 05000002
*        IS SET TO 1 AND THE FOLLOWING FUNCTION IS PERFORMED-         * 05050002
*                                                                     * 05100002
*        THE DATA MANAGEMENT COUNT OF THE UCB OF THE DEB WHICH WAS    * 05150002
*        FREED IS DECREMENTED. DXVOLSEQ IS DECREMENTED AND MODULE     * 05200002
*        IFG0554A IS GIVEN CONTROL TO MOUNT AND VERIFY THE PREVIOUS   * 05250002
*        VOLUME (THE VOLUME OF THE NOW-CURRENT DEB) AND READ THE      * 05300002
*        DSCB(S).                                                     * 05350002
*                                                                     * 05400002
*        UPON RETURN FROM IFG0554A THE NOW-CURRENT DEB'S EXTENTS ARE  * 05450002
*        VERIFIED TO BE IDENTICAL TO THOSE OF THE DSCB(S) READ. THE   * 05500002
*        UCB ALSO IS VERIFIED TO BE IDENTICAL, AND THE NUMBER OF      * 05550002
*        EXTENTS IN THE DEB AND DSCB MUST BE EQUAL. IF ANY OF THESE   * 05600002
*        CHECKS FAIL, PROBLEM DETERMINATION IS GIVEN CONTROL TO       * 05650002
*        CAUSE A 937-1C ABEND.                                        * 05700002
*                                                                     * 05750002
*        IF THE VERIFICATION IS SUCCESSFUL, MODULE IFG0551L IS GIVEN  * 05800002
*        CONTROL.                                                     * 05850002
*                                                                     * 05900002
* NOTES =                                                             * 05950002
*        THE 'FREE OLD DEB' FUNCTION IS INVOKED BY THE SEQUENTIAL     * 06000002
*        ACCESS METHOD AFTER AN EOV HAS OCCURRED IN THE MIDDLE OF     * 06050002
*        OBTAINING THE SEGMENTS OF A VBS LOGICAL RECORD WHOSE         * 06100002
*        SEGMENTS SPAN TWO VOLUMES WHEN THE PROCESSING IS UPDATE. THE * 06150002
*        OLD DEB ALLOWING ACCESS TO THE FIRST SEGMENT(S) OF THE       * 06200002
*        LOGICAL RECORD HAS NEITHER BEEN FREED NOR DELETED FROM THE   * 06250002
*        DEB TABLE BY EOV, BUT ITS DEBDCBAD HAS HAD ITS LOW ORDER     * 06300002
*        BIT FLIPPED TO PREVENT ITS BEING EXCP-ED. THE DEB'S ADDRESS  * 06350002
*        HAS BEEN SAVED IN DCBIOBAD. IF THE LOGICAL RECORD WHICH      * 06400002
*        SPANS VOLUMES IS NOT UPDATED BY THE USER, A FEOV IS ISSUED   * 06450002
*        CAUSING THIS MODULE TO GAIN CONTROL IN ORDER TO FREE THE     * 06500002
*        OLD DEB AS IT IS NOT NEEDED ANY LONGER. THIS FUNCTION IS     * 06550002
*        INDICATED BY BIT 1 IN DCBIOBAD BEING SET TO 1.               * 06600002
*                                                                     * 06650002
*        THE 'REPOSITION' FUNCTION IN INVOKED UNDER THE SAME          * 06700002
*        CIRCUMSTANCES AS THE 'FREE OLD DEB' FUNCTION EXCEPT THAT THE * 06750002
*        USER HAS REQUESTED THAT THE LOGICAL RECORD WHICH SPANS       * 06800002
*        VOLUMES BE UPDATED. A FEOV CAUSES THIS MODULE TO GAIN        * 06850002
*        CONTROL IN ORDER TO REESTABLISH THE OLD DEB SO THAT THE      * 06900002
*        FIRST SEGMENT(S) OF THE LOGICAL RECORD MAY BE UPDATED.       * 06950002
         EJECT                                                          07000002
*    DEPENDENCIES =                                                   * 07050002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 07100002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 07150002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 07200002
*                                                                     * 07250002
*    RESTRICTIONS = NONE                                              * 07300002
*                                                                     * 07350002
*    REGISTER CONVENTIONS =                                           * 07400002
*            R2 POINTS TO DCB                                         * 07450002
*            R4 POINTS TO OPEN WORK AREA                              * 07500002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 07550002
*            R6 POINTS TO THE WTG TABLE                               * 07600002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 07650002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 07700002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 07750002
*            R10 POINTS TO THE UCB                                    * 07800002
*                                                                     * 07850002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 07900002
*                  END OF LISTING.                                    * 07950002
*                                                                     * 08000002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 08050002
*                                                                     * 08100002
*    PROCESSOR = ASSEMBLER XF                                         * 08150002
*                                                                     * 08200002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 08250002
*                  ORG STATEMENT AT END OF LISTING                    * 08300002
*                                                                     * 08350002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 08400002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 08450002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 08500002
*                                                                     * 08550002
* ENTRY POINT =                                                       * 08600002
*        IFG0554B                                                     * 08650002
*                                                                     * 08700002
*    PURPOSE = SEE FUNCTION                                           * 08750002
*                                                                     * 08800002
*    LINKAGE =                                                        * 08850002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 08900002
*        MACRO INSTRUCTION.                                           * 08950002
         EJECT                                                          09000002
* INPUT =                                                             * 09050002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 09100002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 09150002
*        DEBDCBAD POINTS TO THE COPIED DCB IF 'REPOSITION' FUNCTION.  * 09200002
*        DEBDCBAD POINTS TO USER DCB IF 'FREE OLD DEB' FUNCTION.      * 09210002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 09250002
*                                                                     * 09300002
*        DCBIOBAD POINTS TO A DEB TO BE FREED OR REESTABLISHED.       * 09350002
*        IF BIT 1 IN DCBIOBAD IS SET TO ONE THE DEB POINTED TO BY     * 09400002
*        DCBIOBAD IS FREED. OTHERWISE THE DEB POINTED TO BY DCBIOBAD  * 09450002
*        WILL BE REESTABLISHED.                                       * 09500002
*                                                                     * 09550002
*        REG 14 CONTAINS ENTRY CODE-                                  * 09600002
*        0 - ENTRY FROM IFG0551H.                                     * 09650002
*        4 - RETURN FROM IFG0554A WITH PREVIOUS VOLUME MOUNTED AND    * 09700002
*        DSCB(S) READ.                                                * 09750002
*                                                                     * 09800002
* OUTPUT =                                                            * 09850002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 09900002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 09950002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 10000002
*                                                                     * 10050002
*        IFG0554A -                                                   * 10100002
*        DXRETMOD CONTAINS ID-VCON OF IFG0554B, DXRETCOD = 4.         * 10150002
*        DXVOLSEQ DECREMENTED BY 1 TO VOLUME SEQUENCE OF PREVIOUS     * 10200002
*        VOLUME IN THE JFCB TO BE MOUNTED, AND DSCB(S) TO BE READ.    * 10250002
*                                                                     * 10300002
*        IFG0551L -                                                   * 10350002
*        DCBIOBAD DEB HAS BEEN FREED OR REESTABLISHED.                * 10400002
*        DEBDCBAD POINTS TO USER'S DCB.                               * 10450002
*        BITS 2 & 3 IN DCBIOBAD SET TO 1 IF 'FREE OLD DEB' FUNCTION   * 10500002
*        COMPLETED.                                                   * 10550002
*        BIT 2 IN DCBIOBAD SET TO 1 IF 'REPOSITION' FUNCTION          * 10600002
*        COMPLETED.                                                   * 10650002
*                                                                     * 10700002
*        IFG0550P (PROBLEM DETERMINATION) -                           * 10750002
*        REGISTER 0 CONTAINS 245 CAUSING 937-1C ABEND IF -            * 10800002
*        1) 'REPOSITION' FUNCTION AND DEB POINTED TO BY DCBIOBAD      * 10850002
*        EITHER IS NOT IN THE DEB TABLE OR ITS DEBDCBAD DOES NOT      * 10900002
*        POINT TO THE USER'S DCB WITH ITS LOW ORDER BIT FLIPPED.      * 10950002
*        2) 'REPOSITION' FUNCTION AND OLD DEB EXTENTS DO NOT MATCH    * 11000002
*        THOSE OF THE DSCB(S) READ.                                   * 11050002
         EJECT                                                          11100002
* EXIT-NORMAL =                                                       * 11150002
*        IFG0554A TO MOUNT AND VERIFY DXVOLSEQ VOLUME AND READ        * 11200002
*        DSCB(S).                                                     * 11250002
*        IFG0551L TO COMPLETE EOV PROCESSING.                         * 11300002
*                                                                     * 11350002
* EXIT-ERROR =                                                        * 11400002
*        IFG0550P (PROBLEM DETERMINATION) WITH AN INTERNAL ABEND CODE * 11450002
*        IN REGISTER 0 -                                              * 11500002
*        245 CAUSING 937-1C ABEND.                                    * 11550002
*                                                                     * 11550102
*        DMABCOND PCK IF ERROR FROM PAGE FREE ROUTINE            YM5929 11550502
*                                                                     * 11600002
* EXTERNAL REFERENCES = SEE BELOW                                     * 11650002
*                                                                     * 11700002
*    ROUTINES =                                                       * 11750002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 11800002
*                                                                     * 11850002
*        IEAVPSIB THROUGH CVTVPSIB TO PAGE FREE DEB              YM5929 11850102
*        R0 = 0, NO ECB ADDRESS                                  YM5929 11850202
*        R1 = X'20', ADDRESS OF DEB PREFIX, START OF DEB PGFREE  YM5929 11850302
*        R2 = ADDRESS OF LAST BYTE OF DEB + 1, END OF PGFREE     YM5929 11850402
*        R4 = TCB ADDRESS IN DEBTCBAD                            YM5929 11850902
*                                                                     * 11851402
*        IFGDEBVR POINTED TO BY CVTDEBVR IN VS2 CVT EXTENSION IN      * 11900002
*        ORDER TO VERIFY THAT A DEB ADDRESS IS IN THE DEB TABLE.      * 11950002
*        CALLING SEQUENCE IS AS FOLLOWS -                             * 12000002
*        CALLED IN PROTECT KEY ZERO WITH LOCAL LOCK HELD.             * 12050002
*        REG 1 POINTS TO DEB TO BE VERIFIED.                          * 12100002
*        REG 10 POINTS TO TCB.                                        * 12150002
*        REG 11 WILL BE DESTROYED.                                    * 12200002
*        REG 14 CONTAINS RETURN ADDRESS.                              * 12250002
*        REG 15 CONTAINS ENTRY POINT TO IFGDEBVR.                     * 12300002
*                                                                     * 12350002
*    DATA AREAS =                                                     * 12400002
*        EOV WORKAREA.                                                * 12450002
         EJECT                                                          12500002
*    CONTROL BLOCK =                                                  * 12550002
*        DCB                                                          * 12600002
*        TCB                                                          * 12650002
*        CVT                                                          * 12700002
*        DEB                                                          * 12750002
*        DEB EXTENSION                                                * 12800002
*                                                                     * 12850002
* TABLES =                                                            * 12900002
*        NONE.                                                        * 12950002
*                                                                     * 13000002
* MACROS =                                                            * 13050002
*        MODESET                                                      * 13100002
*        SETLOCK                                                      * 13150002
*        DEBCHK                                                       * 13200002
*        FREEMAIN                                                     * 13250002
*        IECRES-LOAD                                                  * 13300002
*        DMABCOND                                                     * 13350002
*        XCTLTABL                                                     * 13400002
*        IECDSECS                                                     * 13450002
*        IECEQU                                                       * 13500002
*                                                                     * 13550002
* CHANGE ACTIVITY =                                                   * 13600002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 13650002
*                                                                     * 13700002
*********************************************************************** 13750002
         EJECT                                                          13800002
ERR245   EQU   245                      937-1C INTERNAL ABCODE   Y02082 13850002
*                                                                       13900002
***** INITIALIZE EOV REGISTERS                                    ***** 24200021
*                                                                     * 24400021
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        24800021
         USING FORCORE,RCORE                                            25000021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 25050002
         USING TIOENTRY,RTIOT                                           25200021
         USING DEBBASIC,RDEB                                     YM5929 25400002
         USING IHADCB,RDCB                                              25600021
         USING *,RBASE                                                  25800021
         USING UCB,RUCB                                                 26000021
         USING CVT,RF                                                   26200021
*                                                                       26400021
         L     RDEB,DCBDEBAD            ADDRESS OF USER'S DEB           26600021
*                                                                       26800021
         B     EDI12400(RET)            BR, ACCORDING TO RETURN CODE    27000021
EDI12400 EQU   *                        BRANCH TABLE                    27200002
         B     EDI12500                 REGULAR PROCESSING              27400021
         B     EDI14000                 RETURNING FROM MOUNT     Y02082 27600002
*                                                                     * 28000021
*        SEE IF FREE OLD DEB OR REPOSITION FUNCTION                     28200002
*                                                                     * 28400021
EDI12500 EQU   *                        TEST DCBIOCOM                   28600002
         TM    DCBIOBAD,DCBUPDCM        CAN THIS DEB BE FREED    YM5370 28605002
         BO    EDI13000                 BRANCH TO FREE DEB              28800021
         EJECT                                                          28840002
*                                                                       28850002
*        REPOSITION FUNCTION                                            28860002
*                                                                       28860502
*        PAGE FREE DEB IF IT HAD BEEN PAGE FIXED                        28861002
*                                                                       28861502
         L     RF,DEBAPPAD              AVT ADDRESS              YM5929 28862002
         TM    DEBSIOAB-DEBAVT(RF),X10  WAS DEB FIXED            YM5929 28863002
         BZ    EDI12502                 BRANCH IF NOT            YM5929 28863502
         LA    RF,DEBBASIC              START OF DEB             YM5929 28863602
         SH    RF,CONST36               DEB PREFIX               YM5929 28863702
         XR    R1,R1                    CLEAR FOR IC             YM5929 28864002
         IC    R1,DEBLNGTH-DEBAVT(RF)   DEB LENGTH IN DWORDS     YM5929 28864502
         SLL   R1,K3                    DEB LENGTH IN BYTES      YM5929 28865002
         AR    RF,R1                    END OF DEB + 1           YM5929 28865502
         ICM   R1,B'0111',DEBAPPB       START OF DEB             YM5929 28866002
*        PGFREE R,A=(1),EA=(15)         PAGE FREE DEB            YM5929 28866502
         LA    R2,K0(,RF)               END ADDRESS OF PGFREE    YM5929 28867002
         L     RF,DXXPREFX              PREFIX ADDRESS           YM5929 28867502
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM5929 28867602
         MODESET EXTKEY=SUPR            SETLOCK, PGFREE KEY      YM5929 28867702
EDI12501 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  YM5929*28867802
               RELATED=(LOCAL,IFG0554B(EDI12503)) GET LOCAL LOCK YM5929 28868302
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       YM5929 28868402
         EJECT                                                          28868502
         XR    R0,R0                    NO ECB                   YM5929 28868602
         ICM   R1,B'1000',=AL1(X20)     PGFREE BIT               YM5929 28868702
         LR    RDEB,RCORE               SAVE RCORE               YM5929 28868802
         L     RCORE,DEBTCBAD-DEB(,R1)  PGFREE BY TCB            YM5929 28868902
         L     RF,CVTPTR                CVT                      YM5929 28869002
         L     RF,CVTVPSIB-CVT(,RF)     IEAVPSIB ENTRY           YM5929 28869102
         BALR  RET,RF                   REGS 0-14 UNCHANGED      YM5929 28869302
         LTR   RF,RF                    ERROR IN PGFREE          YM5929 28869402
         BNZ   EDI14902                 BRANCH IF YES            YM5929 28869502
         LR    RCORE,RDEB               RESTORE RCORE            YM5929 28869602
         L     RDCB,DXPDCBAD            RESTORE DCB ADDRESS      YM5929 28869702
         L     RDEB,DCBDEBAD            RESTORE DEB ADDRESS      YM5929 28870102
         L     RF,DEBAPPAD              DEB AVT ADDR             YM5929 28870602
         NI    DEBSIOAB-DEBAVT(RF),K255-X10 ZERO DEB FIXED BIT   YM5929 28870702
         L     RF,DXXPREFX              PREFIX ADDRESS           YM5929 28870802
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM5929 28870902
EDI12503 SETLOCK RELEASE,TYPE=LOCAL,                             YM5929*28871002
               RELATED=(LOCAL,IFG0554B(EDI12501)) RELEASE LOCK   YM5929 28871102
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       YM5929 28871302
         MODESET EXTKEY=DATAMGT         RETURN TO D M KEY        YM5929 28871502
         EJECT                                                          28871702
EDI12502 EQU   *                        UNCHAIN DEB              YM5929 28871802
*                                                                       28871902
*              UNCHAIN CURRENT DEB FROM DEBTCBAD'S TCB DEB CHAIN        28872002
*                                                                       28874002
         L     RF,WTGPREFX              PT TO PREFIX             Y02082 28880002
         USING IECPREFX,RF                                       Y02082 28920002
         STM   R0,RET,IECREGSV          SAVE REGS THRU LOCK      Y02082 28960002
         MODESET EXTKEY=SUPR            SETLOCK KEY              Y02082 28970002
*                                                                       28980002
*     OBTAIN LOCAL LOCK TO                                       Y02082 29000002
*              UNCHAIN CURRENT DEB FROM TCB DEB CHAIN                   29002002
*              BRANCH ENTER DEBCHK ROUTINE TO VERIFY OLD DEB            29004002
*                                                                       29010002
EDI12505 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*29040002
               RELATED=(LOCAL,IFG0554B(EDI12600,EDI12903))       Y02082 29080002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       Y02082 29090002
         LM    R0,RET,IECREGSV          RESTORE REGS             Y02082 29120002
         EJECT                                                          29125002
*                                                                       29130002
*        LOCK STILL HELD                                                29135002
*                                                                       29140002
*        UNCHAIN CURRENT DEB FROM TCB                                   29145002
*                                                                       29150002
         LR    R7,RDEB                  SAVE DEBAD FOR CS        Y02082 29170002
EDI12510 EQU   *                        REMOVE DEB               Y02082 29200002
         L     R1,DEBTCBAD              GET PTR TO TCB           Y02082 29240002
         LA    R1,K4(,R1)               ADJUST FOR COMPARE       Y02082 29280002
EDI12520 EQU   *                        PROCESS DEB              Y02082 29320002
         CLC   DCBDEBAD+1(K3),DEBDEBB-DEBBASIC(R1) CORRECT DEB?  YM5929 29360002
         BE    EDI12530                 YES, GO DECHAIN          Y02082 29400002
         L     R1,DEBDEBAD-DEBBASIC(,R1) POINT TO NEXT DEB       YM5929 29440002
         LA    R1,K0(,R1)               CLEAR HI BYTES           Y02082 29480002
         B     EDI12520                 GO CHECK NEXT DEB        Y02082 29600002
*                                                                       29600402
EDI12530 EQU   *                        COMPLETE REMOVAL         Y02082 29640002
         L     R8,DEBDEBAD              PTR TO DEB               Y02082 29680002
         ICM   R8,K8,DEBDEBAD-DEBBASIC(R1) PRIME HI-ORDER BYTE   YM5929 29720002
         ICM   R7,K8,DEBDEBAD-DEBBASIC(R1) PRIME HI-ORDER BYTE   YM5929 29760002
         MODESET EXTKEY=ZERO            KEY ZERO FOR CS          Y02082 29770002
         CS    R7,R8,DEBDEBAD-DEBBASIC(R1) DECHAIN DEB           YM5929 29800002
         MODESET EXTKEY=DATAMGT         RETURN TO KEY 5          Y02082 29810002
         BZ    EDI12535                 BR IF SUCCESSFUL         Y02144 29840002
         LR    R7,RDEB                  RESTORE DEB ADDR         Y02082 29880002
         B     EDI12510                 GO TRY AGAIN             Y02082 29920002
EDI12535 EQU   *                        DEB REMOVED              Y02144 29930002
         OI    DXATEOV,DXATDCHN         SHOW DEB DECHAINED       Y02144 29940002
         EJECT                                                          29960002
*                                                                       29965002
*        LOCK STILL HELD                                                29970002
*                                                                Y02134 34610002
*        VERIFY OLD DEB BY BRANCH ENTERING DEBCHK ROUTINE               34620002
*                                                                Y02134 34658102
         L     R1,DCBIOBAD              R1 = OLD DEB ADDRESS     Y02082 34659202
         LA    R1,K0(R1)                CLEAR HIGH ORDER BYTE  @ZM33024 34661202
         L     RF,CVTPTR                LOAD CVT ADDRESS         Y01021 34661602
         USING CVT,RF                   CVT ADDRESSABILITY       Y02080 34663602
         L     RUCB,CVTTCBP             RUCB = TCB POINTERS      Y01021 34664002
         L     RUCB,K4(R0,RUCB)         RUCB = TCB ADDRESS       Y01021 34666402
         L     RF,CVTEXT2               LOAD CVT EXTENSION ADDR  Y01021 34668802
         USING CVTXTNT2,RF              RF = CVT EXTENSION ADDR  Y01021 34671202
         L     RF,CVTDEBVR              RF = DEBCHK ADDRESS      Y01021 34673602
         MODESET EXTKEY=SUPR            KEY ZERO FOR DEBCHK      Y02082 34675602
         LR    R9,RDEB                  SAVE RDEB ACCROSS DEBCHK Y02082 34675802
         BALR  RET,RF                   BRANCH TO DEBCHK ROUTINE Y01021 34676002
*                                                                Y02134 34676102
*        DEBCHK GOOD RETURN TO NEXT INSTRUCTION                  Y02134 34676402
*                                                                       34676602
         B     EDI12902                 CHECK ADDR OF OLD DCB    Y02082 34676802
*                                                                       34677002
*        DEBCHK BAD RETURN - GO TO PROBLEM DETERMINATION         Y02082 34677202
*                                                                       34678202
EDI12550 EQU   *                        RELEASE LOCK             Y02082 34678802
         LR    RDEB,R9                  RESTORE CURRENT RDEB     Y02082 34679002
         L     RF,DXXPREFX              PREFIX ADDRESS           Y02082 34679202
         STM   RB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS    Y02082 34679602
EDI12600 SETLOCK RELEASE,TYPE=LOCAL,    RELEASE LOCK             Y02082*34680002
               RELATED=(LOCAL,IFG0554B(EDI12505))                Y02082 34680402
         MODESET EXTKEY=DATAMGT         RETURN TO KEY 5          Y02082 34680502
         LM    RB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 34680902
         LA    RWTGC,DXXENTRY           INITIALIZE RWTGC       @ZA02522 34681002
         B     EDI14715                 GO TO PROBLEM DET.       Y02082 34681302
         EJECT                                                          34681402
*                                                                       34681602
*    LOCK STILL HELD                                                    34681702
*                                                                       34682702
*    IF THE DEB CHECK WAS SUCCESSFUL, CHECK THE DCB ADDRESS.     Y02082 34685502
*    FLIP THE LAST BIT IN THE DCB ADDR (DXUDCBAD) AND COMPARE    Y02082 34687502
*    TO THE ALTERED DCB ADDR IN THE OLD DEB                      Y02082 34689502
*                                                                       34689602
EDI12902 EQU   *                        TEST DCB ADDR            Y02082 34689902
         LR    RDEB,R9                  RESTORE CURRENT DEBAD    Y02082 34690102
         L     RF,DXXPREFX              LOAD POINTER TO PREFIX   Y02080 34690602
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS        Y02134 34691102
*                                                                Y02134 34691602
EDI12903 SETLOCK RELEASE,TYPE=LOCAL,                             Y02080*34692102
               RELATED=(LOCAL,IFG0554B(EDI12505)) RELEASE LOCK   Y02080 34692602
         MODESET EXTKEY=DATAMGT         RETURN TO KEY 5          Y02082 34693102
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS     Y02134 34693602
         XI    DXUDCBAD+K3,K1           FLIP LAST BIT            Y02082 34694902
         CLC   DXUDCBAD+K1(K3),DEBDCBB-DEBBASIC(R1)              YM5929 34696902
         BE    EDI12905                 BRANCH IF OK             Y02082 34698902
         XI    DXUDCBAD+K3,K1           RESET LAST BIT           Y02082 34700902
         B     EDI14715                 ABEND                    Y02082 34702902
EDI12905 EQU   *                        RESET BIT & DCBDEBAD     Y02082 34704902
         XI    DXUDCBAD+K3,K1           RESET LAST BIT           Y02082 34706902
         STCM  R1,B'0111',DCBDEBAD+K1   PUT OLD DEB IN DCB COPY  Y02082 34708902
         MVC   DEBDCBB-DEBBASIC(K3,R1),DXPDCBAD+K1 POINT OLD DEB YM5929 34710902
*                                       TO COPIED DCB            Y02082 34712902
         EJECT                                                          34724602
*                                                                       34725002
*     CHAIN OLD DEB BACK AGAIN                                   Y02082 34765302
*                                                                       34765702
         LR    R7,R1                    OLD DEB ADDR             Y02082 34767302
         L     R1,DEBTCBAD-DEBBASIC(,R1) ADDR OF TCB IN OLD DEB  YM5929 34769302
EDI12950 EQU   *                        CHAIN DEB                Y02082 34771302
         L     R8,TCBDEB-TCB(,R1)       PT TO FIRST DEB          Y02080 34771702
         STCM  R8,B'0111',DEBDEBB-DEBBASIC(R7) NEXT DEB ADDR     YM5929 34772102
         ICM   R7,B'1000',TCBDEB-TCB(R1) GET FRONT BYTE          YM5929 34772202
         MODESET EXTKEY=ZERO            KEY ZERO FOR CS          Y02082 34772502
         CS    R8,R7,TCBDEB-TCB(R1)     CHAIN DEB                Y02082 34772602
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       Y02082 34772902
         BNZ   EDI12950                 TRY AGAIN IF NO SUCCESS  Y02082 34773102
         DROP  RF                                                Y02082 34773202
         NI    DXATEOV,X'FF'-DXATDCHN   SHOW DEB CHAINED         Y02144 34778502
         L     R7,DXDEBXAD              GET DEB EXTENSION ADDR   Y02134 34780002
         USING DEBXTN,R7                                         Y02134 34783302
         MVC   DEBXDBPR+K1(K3),DCBDEBAD+K1 PUT OLD DEBAD IN DEBX Y02082 34793302
         DROP  R7                                                Y02134 34795302
         STCM  RDEB,B'0111',DCBIOBAD+K1 SAVE CURRENT DEB AS THE         34800002
*                                       DEB TO BE FREED                 34805002
         L     RDEB,DCBDEBAD            LOAD OLD DEB ADDRESS -   Y02082 34950002
*                                       IT'S NOW THE CURRENT DEB        34955002
         SR    R1,R1                                                    35200021
         IC    R1,DEBNMEXT              GET NO. IF EXTENTS              35400002
         SLL   R1,K4                    MULTIPLY BY 16                  35600021
         LH    R7,DXVOLSEQ              GET CURRENT VOL SEQUENCE Y02134 35800002
         BCTR  R7,K0                    DECREMENT DEB VOL SEQ NO        36000021
         STH   R7,DEBSUCBA+(DEBVOLSQ-DEBACSMD)(R1) UPDATE VOLSEQ YM5929 36200002
         L     R1,DCBIOBAD              GET ADDR OF OLD DEB      Y02082 36250002
         B     EDI13020                 GO TO FREE OLD DEB       Y02082 36300002
         EJECT                                                          36300402
*                                                                       36300802
*        FREE OLD DEB FUNCTION ENTRY                                    36301202
*                                                                Y02082 36350002
EDI13000 EQU   *                        VERIFY AND FREE OLD DEB  Y02082 36450002
         L     R1,DCBIOBAD              GET ADDR OF OLD DEB      Y02082 36500002
         LA    R1,K0(,R1)               CLEAR HIGH BYTE          YM5370 36502002
         LR    R9,RDEB                  SAVE CURRENT DEBAD       Y02082 36505002
*                                       ACCROSS SETLOCK, DEBCHK  Y02082 36510002
         L     RF,CVTPTR                GET CVT ADDRESS          Y02082 36552002
         USING CVT,RF                   ESTABLISH CVT ADDR.      Y02082 36554002
         L     RUCB,CVTTCBP             GET TCB POINTERS         Y02082 36556002
         L     RUCB,K4(,RUCB)           GET ADDR OF TCB          Y02082 36558002
         L     RF,CVTEXT2               GET ADDR OF CVT EXT      Y02082 36558402
         USING CVTXTNT2,RF              ESTABLISH ADDR.          Y02082 36558802
*        GET LOCAL LOCK TO BRANCH ENTER DEBCHK                          36558902
         MODESET EXTKEY=SUPR            SETLOCK,DEBCHK KEY       Y02082 36559002
         L     RF,CVTDEBVR              GET ADDR DEBCHK MACRO    Y02082 36559202
EDI13002 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*36559302
               RELATED=(IFGDEBVR,IFG0554B(EDI13010,EDI13040))    Y02082 36559402
         BALR  RET,RF                   VERIFY OLD DEB           Y02082 36559602
         DROP  RF                                                Y02082 36559702
*                                                                       36563002
*    SUCCESSFUL DEBCHK-RETURN TO NEXT INSTRUCTION                Y02082 36566602
*                                                                       36567602
         B     EDI13010                 GO CHECK ADDR OF OLD DEB Y02082 36569902
*                                                                       36570902
*    ERROR, OLD DEB NOT IN TABLE. RETURN TO NEXT+4               Y02082 36573202
*                                                                       36578202
         B     EDI13040                 ERROR,DON'T CHECK ADDR   Y02082 36583202
*                                                                Y02082 36585202
*                                                                Y02082 36585602
EDI13010 SETLOCK RELEASE,TYPE=LOCAL,                             Y02082*36586002
               RELATED=(IFGDEBVR,IFG0554B(EDI13002))             Y02082 36586102
         LR    RDEB,R9                  RESTORE CURRENT DEBAD    Y02082 36586802
         MODESET EXTKEY=DATAMGT         RETURN TO KEY 5          Y02082 36587502
         EJECT                                                          36588202
         XI    DXUDCBAD+K3,K1           FLIP LAST BIT            Y02082 36588902
*    COMPARE DCB ADDR IN DEB AND IN WORK AREA                    Y02082 36589602
         CLC   DXUDCBAD+K1(K3),DEBDCBB-DEBBASIC(R1)              YM5929 36590302
         BNE   EDI13030                 ERROR,DCB'S UNEQUAL      Y02082 36591002
         XI    DXUDCBAD+K3,K1           RESTORE LAST BIT         Y02082 36593002
EDI13020 EQU   *                        DELETE DEB               Y02082 36595002
*                                                                       36595202
*    SET THE DCB ADDR IN THE DEB (DEBDCBAD) AND RF TO POINT TO   Y02082 36595402
*    THE COPIED DCB-16. THUS,DCBIOBAD (THE POINTER TO THE DEB TO Y02082 36595502
*    BE DELETED) WILL LOOK LIKE DCBDEBAD FOR THE DEBCHK MACRO.   Y02082 36645502
*    NOTE - AT THIS POINT R1 POINTS TO THE DEB TO BE FREED, AND  Y02082 36655502
*    RDEB POINTS TO THE DEB TO BE KEPT.                          Y02082 36665502
*                                                                       36670502
         LR    RF,RDCB                  GET DCB ADDR             Y02082 36675502
         LA    RET,DCBDEBAD-DCBIOBAD    CALC OFFSET-CURRENTLY 16 Y02082 36685502
         SR    RF,RET                   POINT TO DCB-16          Y02082 36687502
         STCM  RF,B'0111',DEBDCBB-DEBBASIC(R1)                   YM5929 36689502
EDI13025 EQU   *                        REMOVE DEB FROM DEBTABLE Y02082 36691502
         DEBCHK (RF),TYPE=DELETE                                 Y02082 36692502
         B     EDI13050                 BRANCH TO FREEMAIN       Y02082 36693502
EDI13030 EQU   *                        FLIP BIT                 Y02082 36693902
         XI    DXUDCBAD+K3,K1           FLIP BIT                 Y02082 36694302
         B     EDI13045                 BRANCH AROUND SETLOCK    Y02082 36694402
EDI13040 SETLOCK RELEASE,TYPE=LOCAL,    DEBCHK ERROR             Y02082*36694502
               RELATED=(IFGDEBVR,IFG0554B(EDI13002))             Y02082 36694602
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       Y02082 36694702
         LR    RDEB,R9                  RESTORE CURRENT DEBAD    Y02082 36694802
EDI13045 EQU   *                        DCB AD FOR DEBCHK DELETE Y02082 36695002
         LR    RF,RDCB                  GET DCB ADDR             Y02082 36695202
         LA    RET,DCBDEBAD-DCBIOBAD    CALC OFFSET-CURRENTLY 16 YM5370 36695302
         SR    RF,RET                   POINT TO DCB-16          Y02082 36695402
         B     EDI13025                 DEBCHK WILL CAUSE ABEND  Y02082 36695502
         EJECT                                                          36695702
EDI13050 EQU   *                        FREE MAIN OF DELETED DEB Y02082 36800402
         SH    R1,CONST36               GET ADDR OF DEB APPENDAGE TABLE 36800802
         SR    R0,R0                    CLEAR REGISTER                  36801202
         IC    R0,DEBLNGTH-DEBAVT(R1)   LENGTH OF DEB IN DBLWD   YM5929 37000002
         SLL   R0,K3                    LENGTH OF DEB IN BYTES          37200002
         L     RA,DXXPREFX              PREFIX ADDRESS           Y02082 37450002
         STM   R0,RF,IECREGSV-IECPREFX(RA) SAVE REGS             Y02082 37450402
         MODESET EXTKEY=SUPR            SETLOCK,FREEMAIN KEY     Y02082 37450802
EDI13060 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*37451202
               RELATED=(FREEMAIN,IFG0554B(EDI13070))             Y02082 37451602
         L     R7,DXASCBAD              ASCB ADDR FOR FREEMAIN   Y02082 37452002
         L     RCORE,K36(,R1)           TCB ADDR FROM DEB        Y02082 37452402
         FREEMAIN RU,A=(1),LV=(0),SP=230,KEY=5,BRANCH=YES        YM5725 37452802
         MODESET EXTKEY=SUPR            SETLOCK KEY              Y02082 37453202
EDI13070 SETLOCK RELEASE,TYPE=LOCAL,                             Y02082*37453602
               RELATED=(FREEMAIN,IFG0554B(EDI13060))             Y02082 37454002
         LM    R0,RF,IECREGSV-IECPREFX(RA) RESTORE REGS          Y02082 37454402
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       Y02082 37454502
         L     RDEB,DCBDEBAD            REESTABLISH DEB ADDRESS  Y02082 37454802
         OI    DXATEOV,DXATDFRE         SHOW DEB FREED           Y02144 37550002
         EJECT                                                          37555002
*                                                                       37560002
*        SET DCBIOBAD BITS AND EXIT IF FREE OLD DEB FUNCTION            37565002
*                                                                       37570002
         TM    DCBIOBAD,DCBUPDCM        IS UPDATE TAKING PLACE   YM5370 37600002
         BZ    EDI13100                 YES, CONTINUE PROCESSING        37800021
         OI    DCBIOBAD,DCBNUPD         CLEAR IOBAD FIELD        YM5370 38000002
         B     EDI14700                 BRANCH                          38200021
EDI13100 EQU   *                        TURN ON BIT                     38400002
         OI    DCBIOBAD,DCBUPDT         CLEAR IOBAD FIELD        YM5370 38405002
         SPACE 2                                                        41250002
*                                                                Y02134 41300002
*****************************************************************Y02134 41350002
*                                                                Y02134 41360002
*        DECREMENT DM COUNT                                      Y02134 41370002
*        WICLOSE NOT NEEDED AS VIO DATA SET CAN'T BE MULTIVOLUME YM5929 41372002
*                                                                Y02134 41380002
*****************************************************************Y02134 41390002
*                                                                Y02134 41392002
EDI13300 EQU   *                        DECREMENT DM COUNT       Y02134 41394002
         L     RUCB,DXUCBADR            LOAD UCB ADDRESS         Y02082 41394402
*                                                                Y02134 41396002
         LA    RF,K1                    LOAD DECREMENT VALUE     Y02134 41398002
*        SHIFT DECREMENT TO USE WITH CS INSTRUCTION              Y02134 41398402
         SLL   RF,K24-(K8*((UCBDMCT-UCB)-(((UCBDMCT-UCB)/4)*4))) Y02134 41398802
         L     R0,UCB+(((UCBDMCT-UCB)/K4)*K4) ALLIGN & LOAD WORD Y02134 41399202
*                                                                Y02134 41399602
EDI13400 EQU   *                        STORE DM COUNT           Y02134 41399702
*                                                                Y02134 41399802
         LR    RET,R0                   SAVE CS OPERAND          Y02134 41399902
         SLL   RET,K25                  LEAVE ONLY UCBDMCT COUNT Y02134 41449902
         LTR   RET,RET                  TEST FOR COUNT OF 0      Y02134 41459902
         BZ    EDI13500                 BRANCH IF ALREADY 0      Y02134 41469902
*                                                                Y02134 41479902
         LR    R1,R0                    LOAD OLD VALUE TO MODIFY Y02134 41489902
         SR    R1,RF                    ADD DECREMENT TO COUNT   Y02134 41491902
*                                                                Y02134 41493902
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 41495902
         CS    R0,R1,UCB+(((UCBDMCT-UCB)/K4)*K4) STORE NEW COUNT Y02134 41497902
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 41498302
*                                                                Y02134 41498702
         BNE   EDI13400                 BRANCH IF NOT THE SAME   Y02134 41499102
         NI    DXATGENS,X'FF'-DXATDMCT  SHOW DM CNT DECREMENTED  Y02144 41499202
         EJECT                                                          41499502
EDI13500 EQU   *                        DECREMENT VOL SEQ AND    Y02134 41499602
*                                       BRANCH QUEUED            Y02134 41499702
         LH    R1,DXVOLSEQ              LOAD VOL SEQ             Y02134 41499802
         BCTR  R1,0                     DECREMENT BY ONE         Y02134 41566502
         STH   R1,DXVOLSEQ              SAVE SEQUENCE NUMBER     Y02134 41588402
*                                                                Y02134 41588802
         MVI   DXRETCOD,K4              SET UP RETURN OFFSET     Y02134 41592502
         MVC   DXRETMOD,ID4B4B          SET UP IFG0554B RETURN   Y02134 41594502
*                                                                Y02134 41594902
         BAL   RET,EDI14900             SET UP REGISTERS         Y02134 41644902
         IECRES LOAD,MODID=ID4B4A,BRCODE=K0,BRANCH=QUEUED        Y02134 41645702
*                                                                Y02134 41695702
         EJECT                                                          41745702
EDI14000 EQU   *                        RETURN FROM MOUNT        Y02082 41795702
         L     RF,DEBAPPAD              GET DEB APPENDAGE ADDR   Y02082 41845702
         MVC   K23(K5,RF),DXCCW7        MOVE CCHHR OF DSCB1      Y02082 41895702
*    VERIFY ALL EXTENTS IN DSCB AND DEB                          Y02082 41945702
         CLC   DEBNMEXT(K1),DSCNOEXT    COMPARE NO. OF EXTENTS   Y02082 41995702
         BNE   EDI14715                 ERROR, ABEND             Y02082 42045702
         LA    R1,K1                    INITIALIZE EXTENT CTR.   Y02082 42095702
         LA    RET,DEBSUCBA             INITILIZE DEB PTR.       YM5929 42145702
*                                       TO FIRST EXTENT          YM5929 42155702
         LA    RF,DSCEXTYP              INITIALIZE DSCB PTR      Y02082 42195702
EDI14710 EQU   *                        COMPARE LOOP FOR EXTENTS Y02082 42245702
*    INSURE CORRECT UCB ADDRESS IN EACH DEB EXTENT SECTION       Y02082 42295702
         MVC   DEBSUCBB-DEBSUCBA(K3,RET),DXUCBADR+K1             YM5929 42345702
*    COMPARE DEB AND DSCB EXTENTS                                Y02082 42395702
         CLC   DEBSTRCC-DEBDASD(K8,RET),DSCLOWLM-DSCEXTYP(RF)    YM5929 42445702
         BE    EDI14720                 CONTINUE COMPARE LOOP    Y02082 42495702
EDI14715 EQU   *                        PROBLEM DETERMINATION    Y02082 42545702
         DMABCOND ERR245,LOAD0P         ABEND                    Y02082 42550702
EDI14720 EQU   *                        TEST FOR ALL EXTENTS     Y02082 42595702
         CLM   R1,B'0001',DSCNOEXT      WAS THIS LAST EXTENT     Y02082 42645702
         BE    EDI14700                 YES, GO CHECK TRACE      Y02082 42695702
         CLM   R1,B'0001',CONST3        WAS THIS EXTENT 3        Y02082 42745702
         BNE   EDI14725                 GO CHECK FOR EXTENT 7    Y02082 42795702
         L     RF,CORECH(,RCORE)        POINT TO DSCB 3          Y02082 42845702
         LA    RF,K4(RF)                SKIP OVER KEY ID         Y02082 42895702
         B     EDI14740                 INCREMENT REGS           Y02082 42900702
EDI14725 EQU   *                        ADJUST DSCB PTR IF EXT 7 Y02082 42945702
         CLM   R1,B'0001',CONST7        WAS THIS EXTENT 7        Y02082 42995702
         BNE   EDI14730                 GO TO BUMP PTRS          Y02082 43045702
         LA    RF,K1(RF)                SKIP OVER DSCB ID BYTE   Y02082 43095702
EDI14730 EQU   *                        BUMP PTR'S               Y02082 43145702
         LA    RF,K10(RF)               BUMP DSCB EXTENT PTR     Y02082 43146102
EDI14740 EQU   *                        BUMP EXTENT CTR, PTR     Y02082 43146502
         LA    R1,K1(R1)                BUMP EXTENT PTR          Y02082 43195702
         LA    RET,K16(RET)             BUMP DEB EXTENT PTR      Y02082 43245702
         B     EDI14710                 RETURN TO COMPARE        Y02082 43345702
         EJECT                                                          43350702
*                                                                       43355702
*        EXIT TO IFG0551L                                               43360702
*                                                                       43365702
EDI14700 EQU   *                        TURN OFF TRACE BIT              69800002
         TM    DXXPATHS+K1,WTGTRACE     IS TRACE ACTIVE                 70000021
         BZ    EDI14750                 NO, BRANCH                      70200021
         NI    DXXPATHS+K1,ALLBITS-WTGTRACE  IND TRACE END              70400021
EDI14750 EQU   *                        SET UP MODULE NAME              70405002
         BAL   RET,EDI14900             SET UP REGISTERS         XM0246 70450002
*                                                                Y02134 71350002
*        DEB ALREADY POINTS TO USER DCB IF FREE-OLD-DEB FUNCTION YM5370 71400002
         MVC   DEBDCBAD+K1(K3),DXUDCBAD+K1 POINT DEB TO USER DCB Y02082 71400402
         MVC   DXXMODID(K2),LOAD1L                               Y02080 73400002
*                                       MOVE ID TO WORKAREA             73600021
         MVC   DXXMODEP+K1(K3),LOAD1L+K2                         Y02080 73800002
*                                       MOVE TTR TO WORKAREA            74000021
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               Y02080 74450002
         SPACE 2                                                        74600002
EDI14900 EQU   *                        SETUP REGISTERS                 74800002
         LA    RWTGC,DXXENTRY           CURRENT MODULE NAME             75000021
         LA    RWTG,DXXAREA             NEXT MODULE NAME                75200021
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDR    @ZA02528 75250002
         BR    RET                      RETURN TO CALLER                75400021
         SPACE 2                                                        75400502
EDI14902 DMABCOND PCK,PGFREE            PAGEFREE ERROR           YM5929 75401002
         EJECT                                                          75405002
*                                                                       75410002
*        CONSTANTS                                                      75415002
*                                                                       75800002
CONST36  DC    H'36'                    CONSTANT 36                     78800021
CONST3   DC    X'03'                    CONSTANT 3               Y02082 78850002
CONST7   DC    X'07'                    CONSTANT 7               Y02082 78900002
         SPACE 2                                                        79000002
         XCTLTABL ID=(LOAD0P,0P,LOAD1L,1L,ID4B4B,4B,ID4B4A,4A),  Y02134X79510002
               SVC=055,BRT=YES,LENGTH=                           Y02080 79520002
*                                                                Y02134 79550002
         IECDSECS CVT,TCB,TIOT,IEZDEB,                           YM5929X79600002
               DCB,UCB,MAIN,                                     YM5929X79800002
               UNITTAB,WTG,PREFX,PSA,EXPAND=YES                  YM5929 80000002
         IECEQU IEZDEB=YES                                       YM5929 80200002
         END                                                            80400021
./  ADD  SSI=62790868,NAME=IFG0554L
         TITLE 'IFG0554L, ALIAS IFG0195F/EOV, OPEN - DA INPUT USER HEADX00100021
               ER/TRAILER LABELS'                                       00200021
         COPY  LCGASMSW                                                 00300000
IFG0554L CSECT                                                          00500021
         ENTRY IFG0195F                                          Y02080 00550002
IFG0195F EQU   IFG0554L                 ALLIAS ENTRY POINT       Y02080 00560002
*********************************************************************** 00610002
*                                                                     * 00660002
*                                                                     * 00710002
*          VS2 RELEASE 037 DELETIONS/CHANGES                          * 00760037
*                                                                     * 00810037
*0000                                                          @ZA13594 00860037
*********************************************************************** 00910002
*                                                                     * 00960002
* MODULE NAME = IFG0554L (OS/VS2)                                     * 01010002
*                                                                     * 01060002
* DESCRIPTIVE NAME = EOV/OPEN DA INPUT USER HEADER LABELS             * 01110002
*                                                                     * 01160002
* COPYRIGHT = NONE                                                    * 01210002
*                                                                     * 01260002
* STATUS = RELEASE 2, LEVEL 0                                         * 01310002
*                                                                     * 01360002
* FUNCTION =                                                          * 01410002
*        THIS MODULE READS USER HEADER/TRAILER LABELS FOR OPEN-       * 01460002
*        EOV UNDER CONTROL OF THE CALLER'S INPUT USER HEADER/TRAILER  * 01510002
*        LABEL ROUTINE.                                               * 01560002
*        1) A 152 BYTE USER LABEL WORK AREA IS OBTAINED FOR EOV FROM  * 01610002
*        FETCH PROTECTED SUBPOOL 229 IN DATA MANAGEMENT KEY, AND      * 01660002
*        A 96 BYTE USER LABEL WORK AREA IS OBTAINED FOR THE CALLER    * 01710002
*        FROM FETCH PROTECTED SUBPOOL 229 IN THE CALLER'S KEY.        * 01760002
*        2) USER LABELS ARE READ AND PRESENTED TO THE CALLER UNTIL    * 01810002
*        AN EOF IS ENCOUNTERED, THE CALLER INDICATES TERMINATION OF   * 01860002
*        PROCESSING VIA A RETURN CODE, OR THE MAXIMUM NUMBER OF 8     * 01910002
*        USER LABELS HAVE BEEN PROCESSED.                             * 01960002
*        3) THE CALLER RETURNS TO THIS MODULE (AFTER PROCESSING EACH  * 02010002
*        USER LABEL) WITH A RETURN CODE IN REGISTER 15:               * 02060002
*        0 - TERMINATE USER LABEL PROCESSING.                         * 02110002
*        4 - CONTINUE USER LABEL PROCESSING                           * 02160002
*        8 - WRITE UPDATED USER LABEL AND TERMINATE                   * 02210002
*            USER LABEL PROCESSING.                                   * 02260002
*        12 - WRITE UPDATED USER LABEL AND CONTINUE                   * 02310002
*             USER LABEL PROCESSING.                                  * 02360002
*        RETURN CODES 8 AND 12 MAY ONLY BE USED IF THE DATA SET IS    * 02410002
*        PHYSICAL SEQUENTIAL AND OPENED FOR UPDATE, OR PHYSICAL       * 02460002
*        SEQUENTIAL OPENED FOR OUTPUT/OUTIN WITH DISP = MOD, OR       * 02510002
*        DSORG = DA OPENED FOR UPDATE OR OUTPUT.                      * 02560002
*        4) IF NO USER LABEL TRACK WAS ALLOCATED, THE CALLER'S EXIT   * 02610002
*        ROUTINE IS ENTERED WITH THE BUFFER POINTER SET TO ZERO. IF   * 02660002
*        NO LABELS CAN BE READ, EXIT TO CALLER'S EXIT ROUTINE         * 02710002
*        WITH THE LABEL BUFFER POINTER = ZERO.                        * 02760002
*        5) IF AN I/O ERROR OCCURS WHEN READING USER LABEL, THE       * 02810002
*        CALLER'S ROUTINE IS ENTERED AGAIN WITH BIT 0 OF THE          * 02860002
*        FLAG BYTE SET TO 1, AND A POINTER TO THE STATUS INFORMATION  * 02910002
*        IN THE WORK AREA IOB. ON RETURN, THE RETURN CODE IS IG-      * 02960002
*        NORED AND NORMAL PROCESSING RESUMES FOR EOV.                 * 03010002
*        8) IF AN I/O ERROR OCCURS WHILE WRITING THE UPDATED USER     * 03060002
*        LABEL, THE CALLER'S EXIT ROUTINE IS ENTERED WITH BITS 0      * 03110002
*        AND 1 OF THE FLAG BYTE IN THE PARAMETER LIST SET TO 1, AND   * 03160002
*        A POINTER TO THE STATUS INFORMATION IN THE WORK AREA IOB.    * 03210002
*                                                                     * 03260002
* NOTES = SEE BELOW                                                   * 03310002
*                                                                     * 03360002
*    DEPENDENCIES =                                                   * 03410002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 03460002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03510002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03560002
*                                                                     * 03610002
*    RESTRICTIONS = NONE                                              * 03660002
*                                                                     * 03710002
*    REGISTER CONVENTIONS =                                           * 03760002
*            R2 POINTS TO DCB                                         * 03810002
*            R4 POINTS TO OPEN WORK AREA                              * 03860002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 03910002
*            R6 POINTS TO THE WTG TABLE                               * 03960002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 04010002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 04060002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 04110002
*            R10 POINTS TO THE UCB                                    * 04160002
*                                                                     * 04210002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 04260002
*                  END OF LISTING.                                    * 04310002
*                                                                     * 04360002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 04410002
*                                                                     * 04460002
*    PROCESSOR = ASSEMBLER XF                                         * 04510002
*                                                                     * 04560002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 04610002
*                  ORG STATEMENT AT END OF LISTING                    * 04660002
*                                                                     * 04710002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 04760002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 04810002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 04860002
*                                                                     * 04910002
* ENTRY POINT =                                                       * 04960002
*        IFG0554L                                                     * 05010002
*        IFG0195F - ALIAS                                             * 05060002
*                                                                     * 05110002
*    PURPOSE = SEE FUNCTION                                           * 05160002
*                                                                     * 05210002
*    LINKAGE =                                                        * 05260002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 05310002
*        MACRO INSTRUCTION.                                           * 05360002
*                                                                     * 05410002
* INPUT =                                                             * 05460002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 05510002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 05560002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 05610002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 05660002
*                                                                     * 05710002
* OUTPUT =                                                            * 05760002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 05810002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 05860002
*        DEBDCBAD POINTING TO THE COPIED DCB,                         * 05910002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 05960002
*                                                                     * 06010002
* EXIT-NORMAL =                                                       * 06060002
*        EXIT TO MODULE WHOSE ID/EPA IS IN DXRETMOD. THIS IS          * 06110002
*        NORMALLY THE CALLER OF THIS MODULE OR THE MODULE THAT THE    * 06160002
*        CALLER OF THIS MODULE WOULD HAVE GONE TO HAD THERE NOT BEEN  * 06210002
*        USER LABEL PROCESSING.                                       * 06260002
*                                                                     * 06310002
* EXIT-ERROR = NONE                                                   * 06360002
*                                                                     * 06410002
* EXTERNAL REFERENCES = SEE BELOW                                     * 06460002
*                                                                     * 06510002
*    ROUTINES =                                                       * 06560002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 06610002
*                                                                     * 06660002
*    DATA AREAS =                                                     * 06710002
*        EOV WORKAREA.                                                * 06760002
*                                                                     * 06810002
*    CONTROL BLOCK =                                                  * 06860002
*        CVT                                                          * 06910002
*        DEB                                                          * 06960002
*        JFCB                                                         * 07010002
*        PSA                                                          * 07060002
*        TCB                                                          * 07110002
*        RB                                                           * 07160002
*                                                                     * 07210002
* TABLES =                                                            * 07260002
*                                                                     * 07310002
* MACROS =                                                            * 07360002
*        MODESET                                                      * 07410002
*        IECRES LOAD                                                  * 07460002
*        IECRES GET                                                   * 07510002
*        IECRES INIT                                                  * 07560002
*        IECRES FREE                                                  * 07610002
*        IECRES UEXIT                                                 * 07660002
*        EXCP                                                         * 07710002
*        WAIT                                                         * 07760002
*        SETLOCK                                                      * 07810002
*        ENQ                                                          * 07860002
*                                                                     * 07910002
* CHANGE ACTIVITY =                                                   * 07960002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 08010002
*                                                                     * 08060002
*********************************************************************** 08110002
         EJECT                                                          08160002
         IECDSECS CVT,TCB,RB,DCB,PSA,   DEFINE DSECTS TO BE      Y02082*23950002
               MAIN,DEB,USERLAB,WTG,    EXPANDED AT THE END      Y02144*24100002
               PREFX,RRPL                                        Y02144 24150002
*                                                                       24200021
         IECEQU ,                       DEFINE EQUATES                  24300021
*                                                                       24400021
         USING IHADCB,RDCB              DEFINE BASE TO DCB              24500021
         USING FORCORE,RCORE            DEFINE BASE TO DCB WORK AREA    24600021
         USING WTG,RWTG                 DEFINE BASE TO XCTL/WTG TABLE   24700021
         USING DEB,RDEB                 DEFINE BASE FOR DEB             24900021
*                                                                       25000021
         BALR  RBASE,0                  ESTABLISH BASE REGISTER         25100021
         USING *,RBASE                  DEFINE BASE REGISTER            25200021
*                                                                       25300021
*********************************************************************** 25400021
*                                                                       25500021
*                                                                Y02082 25550002
*     OBTAIN CORE FOR USER LABEL WORK AREAS                      Y02082 25600002
*                                                                Y02082 25650002
         IECRES GET,LV=USERLDM,PREFIX=YES,SP=K229,               Y02082*25700002
               STM=(2,14,WTGPREFX),ID=ULWA                       Y02144 25750002
         LR    RUCB,R1                  ADDR OF GOTTEN CORE      Y02082 25800002
         USING ULDMWK,RUCB                                       Y02082 25850002
*                                                                Y02082 25900002
         IECRES GET,LV=USERLU,PREFIX=NO,KEY=USER,SP=K229,        Y02082*25950002
               STM=(2,14,WTGPREFX)                               Y02082 26000002
         LR    R9,R1                    ADDR OF GOTTEN CORE      Y02082 26050002
         USING ULUWK,R9                                          Y02082 26100002
         MODESET EXTKEY=DATAMGT         DATA MANGEMENT KEY       Y02082 26150002
         CLI   WTGMODNM+K5,C'9'         IS THIS OPEN (IFG0195F)         26400021
         BNE   ULI01A                   BR IF NO                        26500021
         MVC   DXVOLMT2(K5),DXCCW7      SAVE DSCB CCHHR FOR OPEN        26600021
*                                                                       26700021
ULI01A   EQU   *                        NOT OPEN                        26800002
         CLI   DSCEXTYP,ULEXT           IS FIRST EXTENT FOR USER LABELS 26900021
         BNE   ULT300                   BR IF NO TO INFORM TO USER      27000021
*                                                                       27100021
*********************************************************************** 27200021
*                                                                       27300021
*  SET UP CHANNEL PROGRAM AND WORK AREA TO READ FIRST HEADER / TRAILER  27400021
*  LABEL                                                                27500021
*                                                                       27600021
*        READ COUNT        INTO ULWK8                                   27700021
*        SEARCH KEY EQ     KEY IN ULWK6 = 'UHL1'/'UTL0'                 27800021
*        TIC *-16                                                       27900021
*        READ DATA (LABEL) INTO BUFFER                                  28000021
*                                                                       28100021
         XC    DXCCW1(K32),DXCCW1       CLEAR CCW AREA                  28200021
         LA    R1,ULWK8                 POINT TO AREA INTO WHICH        28300021
         ST    R1,DXCCW1                COUNT IS READ                   28400021
         LA    R1,ULWK6                 POINT TO AREA CONTAINING        28500021
*                                       SEARCH ARGUMENT                 28600021
         ST    R1,DXCCW2                FOR SEARCH KEY EQUAL            28700021
         LA    R1,DXCCW1                POINT TO READ COUNT CCW         28800021
         ST    R1,DXCCW3                IN TIC                          28900021
         LA    R1,ULDMBUFR              POINT TO LABEL BUFFER    Y02082 28950002
         ST    R1,DXCCW4                IN READ DATA                    29100021
         OC    DXCCW1(K32),ULCP1        OR IN CMND, FLAGS, LENGTH       29200021
*                                                                       29300021
*        INITIALIZE IOBDADAD WITH R=0                                   29400021
*                                                                       29500021
*                                       MBB SET BEFORE ENTRY            29600021
         MVC   DXDAADDR+K3(K4),DSCLOWLM  CCHH FROM START OF 1ST EXTENT  29700021
         MVI   DXDAADDR+K7,K0           START SEARCH AT R0              29800021
*                                                                       29900021
         TM    DCBDSORG,DCBORGDA        IS THIS DIRECT ORGANIZATION     30000021
         BZ    ULT040                   BR IF NO                        30100021
*                                                                       30200021
         MVC   DXDEBUCB+1(K3),DXUCBADR+1 GET FIRST UCB ADDRESS @ZA13594 30210037
*                                                              @ZA13594 30220037
         MVC   ULDMBUFR(ULT6000L),ULT6000K MOVE PARM LIST        YM5789 30250002
         STH   RUCB,ULDMBUFR+ULT6000L   MOVE UCBADDR AND CCHH    YM5789 30300002
         MVC   ULDMBUFR+K2+ULT6000L(K6),DXDAADDR+K1 TO MINOR NAM YM5789 30350002
         ENQ   (,ULDMBUFR+ULT6000L),MF=(E,ULDMBUFR) ENQ ON ULTRK YM5789 30400002
         L     RC,DXATCOM3              GET RRPLIST PTR          Y02144 30450002
         USING RRPLIST,RC                                        Y02144 30460002
         OI    RRFLAGS1,RRFENQUL        SHOW ENQ'D ON UL TRACK   Y02144 30470002
*                                                                       30500021
ULT040   EQU   *                        NO ENQ NEEDED                   30600002
         MVC   ULWK6,UHLCONST           SET UP SEARCH ARG = UHL1        30700021
         NI    DXREGC,ALLBITS-LASTNTRY  TURN OFF HIGH ORDER BIT SA55619 30750002
         CLI   DXREGC,XLIUHL            IS THIS INPUT UHL EXIT  SA55619 30760000
         BE    ULT040B                  BR IF YES               SA66619 30770000
         MVC   ULWK6,UTLCONST           SET UP SEARCH ARG = UTL0        31000021
ULT040B  EQU   *                        INPUT UHL EXIT                  31100002
         MVC   ULWK10,ULWK6             NECESSARY SINCE FIRST CHANNEL   31200021
*                                       PROGRAM DOES NOT READ KEY       31300021
         OI    ULWK2,X01                SET FIRST READ SWITCH           31400021
*                                                                       31500021
*        READ FIRST HEADER / TRAILER LABEL                              31600021
*                                                                       31700021
         BAL   RC,ULEXCP                GO READ USER LABEL              31800021
*                                                                       31900021
*********************************************************************** 32000021
*                                                                       32100021
*  ESTABLISH CHANNEL PROGRAM FOR SUBSEQUENT USE, THEN TEST              32200021
*  FOR I/O ERROR.                                                       32300021
*                                                                       32400021
*  SET UP CHANNEL PROGRAM TO WRITE BACK LABEL AND READ NEXT LABEL       32500021
*                                                                       32600021
*        SEARCH KEY EQ       KEY = UHL(N) / UTL(N)                      32700021
*        TIC *-8                                                        32800021
*        WRITE DATA          WRITE UPDATED LABEL                        32900021
*        SEARCH ID EQ        ID OF RECORD PRIOR TO UHL(N)  / UTL(N)     33000021
*        TIC *-8             CHECK                                      33100021
*        RD CKD    (SKIP)    LABEL JUST WRITTEN                         33200021
*        RD CKD              READ NEXT LABEL                            33300021
*                                                                       33400021
*  WHEN ONLY UPDATING IS PERFORMED, CC FLAG IN RD CKD IS TURNED OFF.    33500021
*                                                                       33600021
*  WHEN NO UPDATING IS PERFORMED,CHANNEL PROGRAM TO READ NEXT LABEL IS  33700021
*                                                                       33800021
*        SEARCH KEY EQ       KEY OF PREVIOUS LABEL                      33900021
*        TIC *-8                                                        34000021
*        RD CKD              READ NEXT LABEL                            34100021
*                                                                       34200021
*  PROCEDURE USED BELOW IS TO USE KEY IN ULWK10 (KEY OF LABEL           34300021
*  PROCESSED) AS SEARCH ARGUMENT FOR SUBSEQUENT I/O OPERATIONS.         34400021
*                                                                       34500021
         MVC   DXCCW1(K16),DXCCW2       SEARCH KEY CCW TO DXCCW1        34600021
*                                       AND TIC *-8 TO DXCCW2           34700021
         XC    DXCCW3(K40),DXCCW3       CLEAR REMAINING CCW AREA        34800021
*                                                                       34900021
*  DXCCW3 IS ESTABLISHED AFTER USER RETURNS CODE                        35000021
         LA    R1,DXDAADDR+K3           ADDR OF IOBADDR+3 (CCHHR) FOR   35100021
         ST    R1,DXCCW4                SEARCH ID                       35200021
         LA    R1,DXCCW4                TIC TO                          35300021
         ST    R1,DXCCW5                DXCCW4                          35400021
         LA    R1,ULWK8                 RD CKD INTO                     35500021
         ST    R1,DXCCW7                ULWK8                           35600021
         OC    DXCCW4(K32),ULCP3        OR IN CMND, FLAGS, LENGTH       35700021
*                                                                       35800021
*********************************************************************** 35900021
*                                                                       36000021
ULT050   EQU   *                        TEST FOR I/O ERROR              36100002
         TM    DXECB,ECBCOD7F           TEST IF I/O ERROR               36200021
         BNO   ULT200                   BR IF YES                       36300021
*                                                                       36400021
         NI    ULWK2,X'FF'-X01          SET 1ST-READ-SW OFF IF ON       36500021
         IC    R1,ULWK9                 'R' OF COUNT READ IN            36600021
         BCTR  R1,R0                    DECR BY 1 - USED IN ORIENTATION 36700002
         STC   R1,DXDAADDR+K7           FOR WRITE VERIFICATION          36800021
*                                                                       36900021
         L     RF,WTGPREFX              POINT TO PREFIX          Y02082 36904502
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y02082 36909002
         MODESET EXTKEY=ZERO            SUPERVISOR KEY           Y02082 36913502
*     OBTAIN LOCAL LOCK                                          Y02082 36918002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*36922502
               RELATED=('PREVENT FREE USER CORE-RELEASED BELOW') Y02082 36927002
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 36931502
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 36936002
*     VERIFY USER STILL HOLDS USER LABEL WORK AREA               Y02082 36940502
         OC    ULUWK(USERLU),ULUWK      PGM CHECK IF NOT         Y02082 36945002
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          Y02082 36949502
         MVC   ULBUFR,ULDMBUFR          COPY LABEL TO USER BUFF  Y02082 36954002
*     RELEASE LOCAL LOCK                                         Y02082 36958502
         L     RF,WTGPREFX              POINT TO PREFIX          Y02082 36963002
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y02082 36967502
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=('SEE ABOVE')        Y02082 36972002
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 36976502
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 36981002
         BAL   RD,ULSYNCH               GO TO SYNCH TO USER EXIT RTN    37000021
* RETURN IN DATAMGT KEY                                          Y02082 37100002
         LTR   RF,RF                    DID USER RETURN A CODE = 0      37200021
         BZ    ULT500                   BR IF YES (NO MORE PROCESSING)  37300021
*                                                                       37400021
ULT130   EQU   *                        RETURN CODE NOT ZERO            37500002
*  SOME TYPE OF I/O WILL BE INITIATED.  SEARCH WILL BE BASED UPON KEY   37600021
*  OF LABEL 'JUST PROCESSED'.                                           37700021
         MVC   ULWK6,ULWK10             SET UP SEARCH ARGUMENT          37800021
         XC    DXCCW3,DXCCW3            ENSURE THAT PRVIUS CCW DOES NOT 37900021
*        CONFLICT WITH CHANNEL PROGRAM TO BE COMPLETED BELOW.           38000021
         CLI   ULRETCOD,READNEXT        DIS USER RETURN A CODE = 4      38100021
         BE    ULT150                   BR IF YES TO READ NEXT LABEL    38200021
*                                                                       38300021
*  CHECK IF 8 OR 12 IS A VALID RETURN CODE                              38400021
         L     RDEB,DCBDEBAD            POINTER TO USER'S DEB           38500021
         CLI   WTGMODNM+K5,C'9'         IS THIS OPEN (IFG0195F)         38600021
         BNE   ULT135                   BR IF NO, USER'S DEB EXISTS     38700021
         LA    RDEB,DXDEB               DURING OPEN USE WORK DEB        38800021
ULT135   EQU   *                        NOT OPEN                        38900002
         TM    DEBOPATB,DEBOPOUT-DEBOPUPD  TEST IF OPENED FOR OUTPUT    39000021
         BO    ULT140                   BR IF YES                       39100021
         BM    ULT500                   BR IF NOT UPDAT OR INPUT        39200021
         TM    DEBOPATB,DEBOPUPD        TEST IF OPENED FOR UPDAT        39300021
         BO    ULT145                   BR IF YES                       39400021
         B     ULT500                   BR OPENED FOR INPUT             39500021
*                                                                       39600021
ULT140   EQU   *                        OPENED FOR OUTPUT               39700002
         TM    DCBDSORG,DCBORGDA        IF NOT UPDATE, DIRECT DATA SET  39800021
         BZ    ULT500                   FOR OUTPUT IS ALSO VALID.       39900021
*                                                                       40000021
*  SET UP THIRD CCW TO WRITE UPDATED LABEL                              40100021
*                                                                       40200021
ULT145   EQU   *                        WRITE UPDATED LABEL             40300002
         LA    R1,ULDMBUFR              ESTAB WRITE DATA CCW3 TO Y02082 40304502
         ST    R1,DXCCW3                WRITE FROM LABEL BUFFER         40500021
         OC    DXCCW3,ULCP2             OR IN CMND, FLAGS, LENGTH       40600021
*                                                                Y02082 40604002
*     COPY UPDATED LABEL TO EOV'S BUFFER                         Y02082 40608002
*                                                                Y02082 40612002
         L     RF,WTGPREFX              POINT TO PREFIX          Y02082 40616002
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y02082 40620002
         MODESET EXTKEY=ZERO            SUPERVISOR KEY           Y02082 40624002
*     OBTAIN LOCAL LOCK                                          Y02082 40628002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*40632002
               RELATED=('PREVENT FREE USER CORE-RELEASED BELOW') Y02082 40636002
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 40640002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 40644002
*     VERIFY USER STILL HOLDS USER LABEL WORK AREA               Y02082 40648002
         OC    ULUWK(USERLU),ULUWK      PGM CHECK IF NOT         Y02082 40652002
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          Y02082 40656002
         MVC   ULDMBUFR,ULBUFR          COPY LABEL FROM USER BUFFY02082 40660002
*     RELEASE LOCAL LOCK                                         Y02082 40664002
         L     RF,WTGPREFX              POINT TO PREFIX          Y02082 40668002
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y02082 40672002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=('SEE ABOVE')        Y02082 40676002
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 40680002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 40684002
*                                                                       40700021
         MVC   ULDMBUFR(K4),ULWK10      MOVE UHLX/UTLX TO BUFFER YM1175 40750002
         CLI   ULRETCOD,WRITNEXT        IS LABEL TO BE WRITTEN ONLY     40800021
         BE    ULT170                   BR IF YES                       40900021
         CLI   ULRETCOD,WRITNEXT+READNEXT  IS LABEL TO BE WRITTEN AND   41000021
         BE    ULT160                   NEXT LABEL READ, BR IF YES      41100021
         B     ULT500                   INVALID CODE RETURNED, END      41200021
*                                       PROCESSING IN THIS MODULE       41300021
*                                                                       41400021
*        READ NEXT LABEL                                                41500021
*                                                                       41600021
ULT150   EQU   *                        READ NEXT LABEL                 41700002
         CLI   DXREGC,XLIUHL            IS THIS INPUT UHL EXIT  SA55619 41750000
         BE    ULT151                   BR IF YES               SA55619 41800000
         CLI   ULWK10+K3,C'7'           HAS MAX NO. OF UTL ALREADY      42000021
         BNL   ULT500                   BEEN READ, BR IF YES            42100021
         B     ULT152                   BR NO TO CONTINUE               42200021
ULT151   CLI   ULWK10+K3,C'8'           HAS MAX NO. OF UHL ALREADY      42300021
         BNL   ULT500                   BEEN READ, BR IF YES            42400021
*        ESTABLISH THIRD CCW TO READ NEXT LABEL                         42500021
ULT152   LA    R1,ULWK8                 SET RD CKD CCW TO READ INTO     42600021
         ST    R1,DXCCW3                AREA STARTING AT ULWK8          42700021
         OC    DXCCW3,RDCKD             OR IN CMND, FLAGS, LENGTH       42800021
*                                                                       42900021
ULT155   EQU   *                        GO READ NEXT LABEL (OR WRITE    43000021
         BAL   RC,ULEXCP                UPDATED LABEL AND READ NEXT     43100021
*                                       LABEL)                          43200021
         B     ULT050                   GO CHECK FOR ERROR              43300021
*                                                                       43400021
*        WRITE UPDATED LABEL AND READ NEXT LABEL                        43500021
*                                                                       43600021
ULT160   EQU   *                        WRITE THEN READ LABEL           43700002
         CLI   DXREGC,XLIUHL            IS THIS INPUT UHL EXIT  SA55619 43750000
         BE    ULT161                   BR IF YES               SA55619 43800000
         CLI   ULWK10+K3,C'7'           HAS MAX NO. OF UTL ALREADY      44000021
         BNL   ULT165                   BEEN READ, BR IF YES            44100021
         B     ULT162                   BR NO TO CONTINUE               44200021
ULT161   CLI   ULWK10+K3,C'8'           HAS MAX NO. OF UHL ALREADY      44300021
         BNL   ULT165                   BEEN READ, BR IF YES            44400021
ULT162   OI    DXCCW6+K4,CCWCMDCH       ENSURE COMMAND CHAIN FLAG IN    44500021
*                                       VERIFICATION RD CKD IS ON       44600021
         B     ULT155                   GO PERFORM I/O                  44700021
*                                                                       44800021
*        MAXIMUM NUMBER OF LABELS HAVE ALREADY BEEN READ,               44900021
*        RETURN CODE CHANGED TO WRITE LABEL ONLY.                       45000021
*                                                                       45100021
ULT165   EQU   *                        MAX NO. LABELS READ             45200002
         MVI   ULRETCOD,WRITNEXT        CHANGE RETURN CODE TO UPDATE    45300021
*                                                                       45400021
*        WRITE UPDATED LABEL                                            45500021
ULT170   EQU   *                        WRITE UPDATED LABEL             45600002
         NI    DXCCW6+K4,X'FF'-CCWCMDCH  TURN OFF CMND CHAIN FLAG IN RD 45700021
*                                  CCW THAT PERFORMS WRITE VERIFICATION 45800021
*                                                                       45900021
         BAL   RC,ULEXCP                GO WRITE UPDATED LABEL          46000021
*                                                                       46100021
         TM    DXECB,ECBCOD7F           TEST IF I/O ERROR               46200021
         BO    ULT500                   BR IF NO, NO MORE PROCESSING    46300021
*                                                                       46400021
*********************************************************************** 46500021
*                                                                       46600021
*  I/O ERROR HAS OCCURRED                                               46700021
*                                                                       46800021
ULT200   EQU   *                        I/O ERROR PROCESSING            46900002
         LA    R1,DXIOB                 PUT PTR TO STATUS INFO IN       47000021
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 47004002
         ST    R1,ULERRPTR              PARAMETER LIST                  47100021
         MVI   ULERRPTR,ERROR           FLAG ERROR CONDITION(ALSO RESET 47200021
*                                       OTHER ERROR FLAGS TO ZERO).     47300021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 47304002
*  DETERMINE TYPE OF CHANNEL PROGRAM BEING USED WHEN ERROR OCCURRED.    47400021
*                                                                       47500021
         CLI   ULRETCOD,WRITNEXT        IS ERROR ON READ ONLY           47600021
         BL    ULT210                   BR IF YES                       47700021
*                                       (IF ERROR ON FIRST READ,        47800021
*                                       ULRETCOD=0, BR TAKEN)           47900021
*        EITHER WRITING OR WRITING THEN READING                         48000021
         MVC   ULWK3+K1(K3),IOBCOMAD+K1  OBTAIN CSW POINTER             48100021
         L     R1,ULWK3                 FROM IOB                        48200021
         LA    R0,DXCCW7+K8             POINT 8 BYTES PAST READ CCW,    48300021
         CR    R1,R0                    THEN COMPARE WITH CSW POINTER   48400021
         BNE   ULT230                   BR IF ERROR DURING WRITE        48500021
*                                                                       48600021
*  READ ERROR                                                           48700021
*                                                                       48800021
ULT210   EQU   *                        READ ERROR OCCURRED             48900002
         SR    R1,R1                    CLEAR REG                       49000002
         IC    R1,ULWK6+K3              OBTAIN LAST CHAR OF KEY         49100021
         TM    ULWK2,X01                TEST IF ERROR ON FIRST READ     49200021
         BO    ULT220                   BR IF YES                       49300021
*                                       RECONSTRUCT KEY AREA            49400021
         MVC   ULWK10(K3),UHLCONST      'UHL' TO KEY AREA               49500021
         TM    DXREGC,XLIUTL            IS THIS INPUT UTL EXIT          49600021
         BNO   ULT040C                  BR IF NO                        49700021
         MVC   ULWK10(K3),UTLCONST      'UTL' TO KEY AREA               49800021
ULT040C  EQU   *                        NOT INPUT UTL EXIT              49900002
         LA    R1,K1(R1)                INCREMENT 'N' OF KEY            50000021
         STC   R1,ULWK10+K3             AND PLACE IN KEY AREA           50100021
*        SET UP BUFFER TO TELL USER WHAT LABEL WE WERE UNABLE TO READ   50200021
ULT220   EQU   *                        SET UP BUFFER                   50300002
         NI    ULWK2,X'FF'-X01          SET 1ST READ SW OFF IF ON       50400021
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 50404002
         MVC   ULBUFR(K3),UHLCONST      'UHL' TO BUFFER                 50500021
         CLI   DXREGC,XLIUHL            IS THIS INPUT UHL EXIT  SA55619 50550000
         BE    ULT040D                  BR IF YES               SA55619 50600000
         MVC   ULBUFR(K3),UTLCONST      'UTL' TO BUFFER                 50800021
         LA    R1,K1(R1)                INCR N BY 1 SINCE START AT UTL0 50900021
ULT040D  EQU   *                        INPUT UHL EXIT                  51000002
         STC   R1,ULBUFR+K3             LABEL NUMBER TO BUFFER          51100021
         B     ULT240                   GO TO SYNCH TO USER EXIT RTN    51200021
*                                                                       51300021
*  WRITE ERROR                                                          51400021
*                                                                       51500021
ULT230   EQU   *                        WRITE ERROR                     51600002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 51604002
         OI    ULERRPTR,ERROROUT        FLAG WRITE ERROR CONDITION      51700021
ULT240   EQU   *                        SYNCH TO CALLER                 51800002
         BAL   RD,ULSYNCH1              GO TO SYNCH TO USER             51900021
* RETURN IN DATAMGT KEY                                          Y02082 52000002
         LTR   RF,RF                    DID USER RETURN A CODE = 0      52100021
         BZ    ULT500                   BR IF YES, (NO MORE PROCESSING) 52200021
         ST    RF,ULWK1                 SAVE RETURN CODE                52300021
         CLI   ULRETCOD,READNEXT        DID USER RETURN A CODE = 4      52400021
         BE    ULT130                   BR IF YES, TO READ NEXT LABEL   52500021
         B     ULT500                   BR, INVALID CODE RETURNED       52600021
*                                                                       52700021
*********************************************************************** 52800021
*                                                                       52900021
*  NO USER LABEL TRACK WAS ALLOCATED FOR THIS DATA SET.                 53000021
*                                                                       53100021
ULT300   EQU   *                        NO UL TRACK ALLOCATED           53200002
         SR    R1,R1                    ZERO USER LABEL BUFFER PTR      53300021
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 53304002
         XC    ULERRPTR,ULERRPTR        ZERO ERROR INDICATORS           53400021
         BAL   RD,ULSYNCH2              GO TO SYNCH TO USER EXIT RTN    53500021
* RETURN IN DATAMGT KEY                                          Y02082 53550002
         B     ULT510                   BR TO RETURN TO CALLER          53600021
*                                                                       53700021
*                                                                       55200021
*********************************************************************** 55300021
*                                                                       55400021
*        CLOSED SUBROUTINE TO TAKE USER EXIT                     Y02082 55500002
*        REGISTER CONTENTS AT ENTRY TO EXIT ARE AS FOLLOWS-      Y02082 55900002
*                        R0 - CONTAINS NO MEANINGFUL INFORMATION        56000021
*                        R1 - PTR TO PARAMETER LIST                     56100021
*                    R2-R13 - USER'S CONTENTS BEFORE I/O SUPPORT        56200021
*                       R14 - RETURN ADDRESS (SET BY SYNCH)             56300021
*                       R15 - USER'S EXIT ROUTINE ADDRESS               56400021
*                                                                       56500021
ULSYNCH  EQU   *                        SYNCH ENTRY 1                   56600002
         XC    ULERRPTR,ULERRPTR        ZERO ERROR INDICATOR            56700021
ULSYNCH1 EQU   *                        SYNCH ENTRY 2                   56800002
         LA    R1,ULBUFR                PTR TO LABEL BUFFER             56900021
ULSYNCH2 EQU   *                        SYNCH ENTRY 3                   57000002
         ST    R1,ULPARM                PTR TO LABEL BUFFER      Y02082 57050002
         L     R1,DXUDCBAD              GET USER'S DCB ADDR      Y02082 57100002
         ST    R1,ULPARM+K4             PUT IN PARM LIST         Y02082 57150002
         NI    ULDCBPTR,X'FF'-LASTNTRY  INSURE HI-ORDER BIT OF SECOND   57300021
*                              PARAMETER IS OFF (WOULD BE ON IF FEOV)   57400021
         CLI   DXREGC,XLIUHL            IS THIS INPUT UHL EXIT  SA55619 57450000
         BE    UL450                    BR IF YES               SA55619 57500000
         L     RDEB,DCBDEBAD            USER'S DEB ADDRESS              57700021
         CLI   WTGMODNM+K5,C'9'         IS THIS OPEN (IFG0195F)         57800021
         BE    UL450                    BR IF YES                       57900021
         TM    DCBDSORG,DCBORGDA        IS DSORG DIRECT                 58000021
         BO    UL425                    BR IF YES, INDICATE EOF SA55619 58050000
         CLC   JFCBNVOL,DXVOLSEQ+K1     IS THIS LAST VOLSER      YM5340 58200002
         BE    UL425                    BR IF YES TO SET EOV     YM5340 58250002
         TM    DSCDSIND,LASTNTRY        LAST VOLUME WITH DATA    YM5340 58300002
         BNO   UL450                    BR IF NO                 YM5340 58350002
UL425    EQU   *                                                SA55619 59050000
         OI    ULDCBPTR,EOFFLG          INDICATE EOF            SA55619 59100000
*                                                                       59200021
UL450    EQU   *                        EOV - NOT EOF                   59300002
         MODESET EXTKEY=DATAMGT         DCB COPY KEY             Y02082 59302002
         NI    DCBOFLGS,X'FF'-DCBOLOCK  SET LOCK BIT = 0         Y02082 59310002
*                                                                Y02082 59350002
* COPY THE DCB FROM THE WORK AREA TO USER'S STORAGE              Y02082 59360002
*                                                                Y02082 59370002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,WTGPREFX)          Y02082 59380002
*                                                                Y02082 59390002
         LA    R1,ULPARM                POINT TO PARAMETER LIST         59400021
         IECRES UEXIT,EXITAD=DXREGC,STM=(2,13,WTGPREFX)          Y02082 59500002
         L     RDCB,DXUDCBAD            PT TO CALLER'S DCB       YM3005 59550002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME CALLER'S KEY    YM3005 59600002
         OI    DCBOFLGS,DCBOLOCK        INDICATE RETURN FR USER  Y02082 59650002
         LA    R0,ALLBITS-DCBOBUSY      ISOLATE BUSY BIT MASK    YM3005 59700002
         IC    R1,DCBOFLGS              GET CALLER'S OFLGS       YM3005 59750002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM3005 59800002
         L     RDCB,DXPDCBAD            PT TO COPIED DCB         YM3005 59850002
         OR    R0,R1                    ISOLATE CALLER BUSY BIT  YM3005 59900002
         IC    R1,DCBOFLGS              GET COPIED DCBOFLGS      YM3005 59950002
         NR    R1,R0                    UPDTE BUSY BIT TO CALLER YM3005 60000002
         STC   R1,DCBOFLGS              UPDATE OFLGS FIELD       YM3005 60050002
         OI    DCBOFLGS,DCBOLOCK        SET LOCK BIT = 1                61300021
         ST    RF,ULWK1                 SAVE RETURN CODE                61400021
         BR    RD                       RETURN FROM SYNCH EXIT SUBR     61500021
         EJECT                                                          61600002
*********************************************************************** 61900021
*                                                                       62000021
*                   CLOSED SUBROUTINE TO ISSUE I/O OPERATIONS           62100021
*                                                                       62200021
*        IT IS ASSUMED THAT ALL CONTROL BLOCKS HAVE ALREADY BEEN SET UP 62300021
*                                                                       62400021
ULEXCP   EQU   *                        I/O ROUTINE                     62500002
         EXCP  DXIOB                    UPDATE / READ USER LABEL        62600021
*                                                                       62700021
         WAIT  ECB=DXECB                WAIT FOR I/O TO COMPLETE        62800021
*                                                                       62900021
         TM    IOBSTAT0,CSWUNITX        TEST IF UNIT EXCEPTION (EOF)    63000021
         BCR   14,RC                    BR RETURN IF NO                 63100021
*                                                                       63200021
         CLI   DXREGC,XLIUHL            IS THIS INPUT UHL EXIT  SA55619 63250000
         BE    ULEXC1                   BR IF YES               SA55619 63300000
         CLI   ULWK10+K3,C'0'           HAVE ANY UTL BEEN READ          63500021
         BH    ULT500                   PREVIOUSLY, BR IF YES           63600021
         B     ULEXC2                   BR NO TO CONTINUE               63700021
ULEXC1   CLI   ULWK10+K3,C'1'           HAVE ANY UHL BEEN READ          63800021
         BH    ULT500                   PREVIOUSLY, BR IF YES           63900021
*                                                                       64000021
*        NO HEADERS EXIST ON USER LABEL TRACK.                          64100021
ULEXC2   EQU   *                        NO HEADERS EXIST         Y02082 64150002
         MODESET KEYADDR=DXUKEY,WORKREG=1 USER BUFFER KEY        Y02082 64160002
         SR    R1,R1                    ZERO USER LBL BUFFER PTR Y02082 64200002
         XC    ULERRPTR,ULERRPTR        ZERO ERROR INDICATORS           64300021
         BAL   RD,ULSYNCH2              GO TO SYNCH TO USER EXIT RTN    64400021
* RETURN IN DATAMGT KEY                                          Y02082 64450002
*                                                                       64500021
*********************************************************************** 64600021
*                                                                       64700021
*        NO FURTHER UL PROCESSING IS PERFORMED.  FREE CORE AND RETURN   64800021
*        TO CALLER.                                                     64900021
*                                                                       65000021
ULT500   EQU   *                        ISSUE DEQ, RETURN               65100002
         TM    DCBDSORG,DCBORGDA        IS DS DIRECT ORGANIZATION       65200021
         BZ    ULT510                   BR IF NO                        65300021
         MVC   ULDMBUFR(ULT6000L),ULT6000K MOVE PARM LIST        YM5789 65350002
         STH   RUCB,ULDMBUFR+ULT6000L   MOVE UCBADDR AND CCHH    YM5789 65360002
         MVC   ULDMBUFR+K2+ULT6000L(K6),DXDAADDR+K1 TO MINOR NAM YM5789 65370002
         DEQ   (,ULDMBUFR+ULT6000L),MF=(E,ULDMBUFR) DEQ ULTRK    YM5789 65380002
*                                                                       65600021
ULT510   EQU   *                        FREE UL WORK AREAS              65700002
* FREE UL AREA, LABEL BUFFER AND PARAMETER LIST                  Y02080 65750002
         IECRES FREE,A=(R9),LV=USERLU,SP=229,KEY=USER,PREFIX=NO, Y02082*65800002
               STM=(0,14,WTGPREFX)      FREE USER WORK AREA      Y02082 65850002
         IECRES FREE,A=(RUCB),PREFIX=YES,STM=(0,14,WTGPREFX)     Y02080*65950002
                                        FREE EOV WORK AREA       Y02080 65960002
*                                                                       66000021
*  RETURN TO CALLER                                                     66100021
*                                                                       66200021
         CLI   WTGMODNM+K5,C'9'         IS THIS OPEN (IFG0195F)         66300021
         BNE   ULT530                   BR IF NO                        66400021
         MVC   DXCCW7(K5),DXVOLMT2      RESTORE DSCB CCHHR ADDR         66500021
*                                                                       66600021
ULT530   EQU   *                        RETURN TO DXRETMOD              66700002
         LM    RTIOT,RET,DXREG9         RESTORE REGISTERS 9-14          66800021
         LM    R0,R1,DXREG0             RESTORE REGISTERS 0-1           66900021
*                                                                       67000021
*                                       XCTL TO NEXT MODULE      Y02080 67050102
         IECRES LOAD,MODID=DXRETMOD,BRCODE=(RET),BRANCH=QUEUED   Y02080 67150002
*                                                                       67200021
         DROP  RUCB,RWTG                                                67300021
*                                                                       67400021
*********************************************************************** 67500021
*                                                                       67600021
*        CONSTANTS                                                      67700021
*                                                                       67800021
*  CHANNEL PROGRAM TO READ FIRST HEADER/TRAILER LABEL                   67900021
ULCP1    DC    X'1200000040000008'      READ COUNT                      68000021
         DC    X'2900000040000004'      SEARCH KEY EQ                   68100021
         DC    X'0800000000000000'      TIC *-16                        68200021
         DC    X'0600000000000050'      READ DATA                       68300021
*                                                                       68400021
*  CCW 3 OF CHANNEL PROGRAM TO UPDATE LABEL                             68500021
ULCP2    DC    X'0500000040000050'      WRITE DATA                      68600021
*                                                                       68700021
*  PART OF CHANNEL PROG TO READ NEXT LABEL AFTER UPDATE PREVIOUS LABEL  68800021
ULCP3    DC    X'3100000040000005'      SEARCH ID EQ                    68900021
         DC    X'0800000000000000'      TIC *-8                         69000021
         DC    X'1E0000005000005C'      READ COUNT,KEY,DATA (SKIP)      69100021
RDCKD    DC    X'1E0000000000005C'      READ COUNT,KEY,DATA             69200021
*                                                                       69300021
UHLCONST DC    C'UHL1'                  KEY OF FIRST HEADER LABEL       69400021
UTLCONST DC    C'UTL0'                  KEY OF FIRST TRAILER LABEL      69500021
ULT6000K ENQ   (ULT6001K,,E,8,SYSTEM),MF=L ENQ LIST FORM         YM5789 69550002
ULT6000L EQU   *-ULT6000K               LENGTH OF ENQ/DEQ LIST   YM5789 69600002
ULT6001K DC    CL8'SYSZUSRL'            MAJOR NAME               YM5789 69650002
*                                                                       70000021
         XCTLTABL SVC=055,BRT=YES,LENGTH=                        Y02080 70170002
*                                                                       70200021
         IECDSECS EXPAND=YES            EXPAND DESIRED DSECTS HERE      70300021
*                                                                       70400021
         END                                                            70500021
./  ADD  SSI=40610016,NAME=IFG0554N
         TITLE 'IFG0554N                      EOV DIRECT ACCESS OUTPUT -00200002
               - FEOV PROCESSING'                                Y02134 00250002
IFG0554N CSECT                                                          00450002
*********************************************************************** 00500002
*                                                                     * 00550002
*                                                                     * 00600002
*          VS2 RELEASE 02 DELETIONS                                   * 00650002
*                                                                     * 00700002
*                                                                     * 00750002
*********************************************************************** 00800002
*                                                                     * 00850002
* MODULE NAME = IFG0554N (OS/VS2)                                     * 00900002
*                                                                     * 00950002
* DESCRIPTIVE NAME =                                                  * 01000002
*        EOV DIRECT ACCESS OUTPUT - FEOV PROCESSING                   * 01050002
*                                                                     * 01100002
* COPYRIGHT = NONE                                                    * 01150002
*                                                                     * 01200002
* STATUS = RELEASE 2, LEVEL 0                                         * 01250002
*                                                                     * 01300002
* FUNCTION =                                                          * 01350002
*        THIS MODULE IS ENTERED FROM IFG0551H IF FEOV HAS BEEN        * 01400002
*        ISSUED FOR A DIRECT ACCESS DATA SET FOR WHICH THE LAST       * 01450002
*        OPERATION WAS AN OUTPUT OPERATION (THE TRAILER SWITCH OR     * 01500002
*        'WRITE BIT', BIT ZERO IN DCBOFLGS, WAS SET TO ONE).          * 01550002
*        THIS MODULE WRITES A FILE MARK AFTER THE DATA USING THE      * 01600002
*        DCBFDAD FIELD TO DETERMINE THE LAST DATA RECORD WRITTEN.     * 01650002
*                                                                     * 01700002
*        THE FILE MARK IS WRITTEN ON THE TRACK CONTAINING THE LAST    * 01750002
*        DATA RECORD IF THE RECORD FORMAT IS FIXED STANDARD AND IF    * 01800002
*        A RECORD OF LENGTH DEBBLKSI WILL FIT ON THE TRACK.           * 01850002
*                                                                     * 01900002
*        A FILE MARK IS WRITTEN AS RECORD ONE ON THE NEXT TRACK AFTER * 01950002
*        THE LAST TRACK CONTAINING DATA WHETHER OR NOT THE RECORD     * 02000002
*        FORMAT IS FIXED STANDARD. THIS MAY REQUIRE GOING TO A NEW    * 02050002
*        EXTENT, BUT THE DATA SET WILL NOT BE EXTENDED ON THIS VOLUME * 02100002
*        IN ORDER TO WRITE A FILE MARK. NO FILE MARK WILL BE WRITTEN  * 02150002
*        ON THE NEXT TRACK IF NO SUCH TRACK EXISTS.                   * 02200002
*                                                                     * 02250002
*        THE FORMAT 1 DSCB IS READ, AND THE THE DS1LSTAR AND DS1TRBAL * 02300002
*        FIELDS ARE FILLED IN FROM DCBFDAD AND DCBTRBAL, INDICATING   * 02350002
*        THE LAST DATA RECORD AND THE TRACK BALANCE ON THE LAST TRACK * 02400002
*        OF THIS VOLUME, NOT INCLUDING THE FILE MARK JUST WRITTEN.    * 02450002
*        THE LAST VOLUME BIT (BIT 0 OF DSCDSIND) IS TURNED OFF. THE   * 02500002
*        FORMAT 1 DSCB IS THEN REWRITTEN.                             * 02550002
         EJECT                                                          02600002
*        IF NEITHER USER LABEL PROCESSING NOR SMF PROCESSING IS       * 02650002
*        REQUIRED, MODULE IFG0554P IS GIVEN CONTROL NEXT WITH         * 02700002
*        REGISTER 14 SET TO 4.                                        * 02750002
*                                                                     * 02800002
*        IF USER LABEL PROCESSING IS REQUIRED BUT NOT SMF PROCESSING  * 02850002
*        MODULE IFG0554Z IS NEXT GIVEN CONTROL WITH REGISTER 14 SET   * 02900002
*        TO ZERO.                                                     * 02950002
*                                                                     * 03000002
*        IF SMF PROCESSING AND NOT USER LABEL PROCESSING IS REQUIRED  * 03050002
*        MODULE IFG0553B (ALIAS FOR IFG0202H) IS GIVEN CONTROL WITH   * 03100002
*        DXRETMOD IN THE EOV WORKAREA SET TO THE ID-VCON OF IFG0554P  * 03150002
*        AS THE MODULE NEXT TO BE GIVEN CONTROL WHEN SMF PROCESSING   * 03200002
*        IS COMPLETED, AND REGISTER 14 SET TO 4, WHICH WILL BE        * 03250002
*        PASSED TO IFG0554P WHEN IT IS GIVEN CONTROL.                 * 03300002
*                                                                     * 03350002
*        IF BOTH SMF AND USER LABEL PROCESSING IS REQUIRED, MODULE    * 03400002
*        IFG0553B IS GIVEN CONTROL WITH DXRETMOD SET TO THE ID-VCON   * 03450002
*        OF IFG0554Z WITH REGISTER 14 SET TO ZERO.                    * 03500002
*                                                                     * 03550002
* NOTES =                                                             * 03600002
*        SEE BELOW.                                                   * 03650002
*                                                                     * 03700002
*    DEPENDENCIES =                                                   * 03750002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 03800002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03850002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03900002
*                                                                     * 03950002
*    RESTRICTIONS = NONE                                              * 04000002
*                                                                     * 04050002
*    REGISTER CONVENTIONS =                                           * 04100002
*            R2 POINTS TO DCB                                         * 04150002
*            R4 POINTS TO OPEN WORK AREA                              * 04200002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 04250002
*            R6 POINTS TO THE WTG TABLE                               * 04300002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 04350002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 04400002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 04450002
*            R10 POINTS TO THE UCB                                    * 04500002
*                                                                     * 04550002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 04600002
*                  END OF LISTING.                                    * 04650002
         EJECT                                                          04700002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 04750002
*                                                                     * 04800002
*    PROCESSOR = ASSEMBLER XF                                         * 04850002
*                                                                     * 04900002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 04950002
*                  ORG STATEMENT AT END OF LISTING                    * 05000002
*                                                                     * 05050002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 05100002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 05150002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 05200002
*                                                                     * 05250002
* ENTRY POINT =                                                       * 05300002
*        IFG0554N                                                     * 05350002
*                                                                     * 05400002
*    PURPOSE = SEE FUNCTION                                           * 05450002
*                                                                     * 05500002
*    LINKAGE =                                                        * 05550002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 05600002
*        MACRO INSTRUCTION.                                           * 05650002
*                                                                     * 05700002
* INPUT =                                                             * 05750002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 05800002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 05850002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 05900002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 05950002
*                                                                     * 06000002
* OUTPUT =                                                            * 06050002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 06100002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 06150002
*        THE DEBDCBAD POINTING TO THE COPIED DCB,                     * 06200002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 06250002
*                                                                     * 06300002
*        IFG0553B -                                                   * 06350002
*        DXRETMOD SET TO ID-VCON OF IFG0554Z OR IFG0554P.             * 06400002
*        REGISTER 14 SET TO ZERO (DXRETMOD FOR IFG0554Z),             * 06450002
*        OR TO 4 (DXRETMOD FOR IFG0554P).                             * 06500002
*                                                                     * 06550002
*        IFG0554P -                                                   * 06600002
*        REGISTER 14 SET TO 4.                                        * 06650002
*                                                                     * 06700002
*        IFG0554Z -                                                   * 06750002
*        DXRETMOD SET TO ID-VCON IF IFG0554P.                         * 06800002
*        REGISTER 14 SET TO 0.                                        * 06850002
         EJECT                                                          06900002
* EXIT-NORMAL =                                                       * 06950002
*        IFG0554Z TO PROCESS USER TRAILER LABELS.                     * 07000002
*        IFG0554P TO CONTINUE EOV PROCESSING.                         * 07050002
*        IFG0554B FOR SMF PROCESSING.                                 * 07100002
*                                                                     * 07150002
* EXIT-ERROR =                                                        * 07200002
*        IFG0550P GIVEN CONTROL THROUGH DMABCOND MACRO WITH AN        * 07250002
*        INTERNAL ABEND CODE IN REGISTER 0 -                          * 07300002
*        232 - 737-2C ABEND IF DCBFDAD DOESN'T CORRESPOND TO THE DEB. * 07350002
*        187 - 737-10 - I/O ERROR WRITING FILE MARK.                  * 07400002
*        190 - 737-4 - I/O ERROR READING OR WRITING DSCB.             * 07450002
*                                                                     * 07500002
* EXTERNAL REFERENCES = SEE BELOW                                     * 07550002
*                                                                     * 07600002
*    ROUTINES =                                                       * 07650002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 07700002
*                                                                     * 07750002
*        IECPRLTV - MBBCCHHR TO TTR CONVERT ROUTINE                   * 07800002
*                                                                     * 07850002
*    DATA AREAS =                                                     * 07900002
*        EOV WORKAREA.                                                * 07950002
*                                                                     * 08000002
*    CONTROL BLOCK =                                                  * 08050002
*        DCB                                                          * 08100002
*        TCB                                                          * 08150002
*        CVT                                                          * 08200002
*        UCB                                                          * 08250002
*        VDSCB                                                        * 08300002
*        DEB                                                          * 08350002
*                                                                     * 08400002
* TABLES =                                                            * 08450002
*        DEVICE CHARACTERISTICS TABLE                                 * 08500002
*                                                                     * 08550002
* MACROS =                                                            * 08600002
*        MODESET                                                      * 08650002
*        IECRES-LOAD                                                  * 08700002
*        EXCP                                                         * 08750002
*        WAIT                                                         * 08800002
*        DMABCOND                                                     * 08850002
*        XCTLTABL                                                     * 08900002
*        IECDSECS                                                     * 08950002
*        IECEQU                                                       * 09000002
*                                                                     * 09050002
* CHANGE ACTIVITY =                                                   * 09100002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 09150002
*                                                                     * 09200002
*********************************************************************** 09250002
         EJECT                                                          09300002
*        INTERNAL ABEND CODES                                           09350002
EABD187  EQU   187                      READ DSCB I/O ERROR 737-10      13600002
EABD190  EQU   190                      WRITE DSCB I/O ERROR 737-4      13800002
EABD737  EQU   232                      BAD DCBFDAD INTERNAL     Y02082 13850002
*                                       ABEND CODE 737-2C        Y02082 13900002
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        14000000
         USING FORCORE,RCORE                                            14200000
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 14250002
         USING TIOENTRY,RTIOT                                           14400000
         USING UCB,RUCB                                                 14600000
         USING DEB,RDEB                                                 14800000
         USING DCBRELAD,RDCB                                            15000000
         USING CVT,RF                                                   15200000
         USING EDO00200,RBASE                                           15400000
EDO00200 EQU   *                        ENTRY                           15600002
*                                                                       15800000
*                       WRITE FILE MARK                                 18000000
*                                                                       18200000
         SR    R7,R7                    CLEAR WORK REGISTER             18400000
         IC    R7,DCBFDAD               PICK UP M (CURRENT EXTENT NO.)  18600000
         CLM   R7,B'0001',DEBNMEXT      ARE THERE M EXTENTS      Y02082 18650002
*                                       IN THE DEB               Y02082 18700002
         LA    R0,EABD737               737 INTERNAL ABCODE      Y02082 18750002
         BNL   EDO02450                 BRANCH IF NO-737 ABEND   Y02082 18760002
         SLL   R7,4                     MPY BY 16 TO POINT TO EXTENT    18800000
         AR    RDEB,R7                  POINTING TO PROPER EXTENT (DEB) 19000000
         MVC   DXDEBBIN(K12),DEBBINUM   PLACE USERS EXTENT IN WORK AREA 19200000
         MVC   DXCCW4+K1(K8),DCBFDAD    MOVE MBBCCHHR TO WORK AREA      19400000
         MVI   DXDEBUCB,DCBRECUN        SET MODIFIER BYTE ALLOW WRITES  19600000
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 UCB ADDRESS TO DEB    Y02134 19800002
         L     R1,DCBDVTBL              ADDRESS OF DEVICE TABLE         20200000
         LH    RF,K4(R1)                PICK UP NR OF BYTES PER TRACK   20400000
         CH    RF,DCBTRBAL              IS FULL TRCK AVAILABLE FOR FM   20600000
         BE    EDO01100                 BR IF FULL TRCK AVAILABLE       20800000
         TM    DCBRECFM,DCBRECFX+DCBRECST  IS THE USER WRITING FIXED    21000000
*                                       STANDARD RECORDS                21200000
         BNO   EDO00500                 NO,DO NOT WRITE F.M. ON THIS    21400000
*                                       TRACK                           21600000
         EJECT                                                          21650002
*                                                                       21700002
*        IF FIXED STANDARD, WRITE FILE MARK ON SAME TRACK AS     Y02082 21750002
*        LAST RECORD IF BLOCK WILL FIT THERE                     Y02082 21760002
*                                                                       21770002
         IC    R8,K7(R1)                LAST RECORD ID OVERHEAD SA57120 21800002
         LR    RF,R8                    SAVE VALUE                      22000000
         IC    R8,DCBKEYCN              KEY OVERHEAD                    22200000
         SR    RF,R8                    HIGH ORDER 3 BYTES OF           22400000
*                                       RF ARE ZEROED OUT               22600000
         LR    RD,RDEB                  SAVE DEB REGISTER               22800000
         L     RDEB,DCBDEBAD            PICK UP DEB ADDRESS             23000000
         SR    RC,RC                    CLEAR REGISTER                  23200000
         IC    RC,DEBNMEXT              PICK UP NUMBER OF               23400000
*                                       EXTENTS                         23600000
         SLL   RC,K4                    MULTIPLY BY 16                  23800000
         AR    RC,RDEB                  ADD DEB ADDRESS                 24000000
         TM    DCBMACRF,DCBMEXCP        IS IT EXCP                      24200000
         BNO   EDO00300                 BRANCH IF NO                    24400000
         LA    RF,K8                    GET LENGTH NEEDED FOR FM        24600000
         B     EDO00400                 YES BRANCH                      24800000
EDO00300 EQU   *                        ADD DEBBLKSI VALUE              25000002
         AH    RF,K44(RC)               ADD KEYLENGTH+BLOCKSIZE         25200000
EDO00400 EQU   *                        SEE IF BLOCK FITS               25400002
         CH    RF,DCBTRBAL              WILL RECORD FIT ON THIS         25600000
*                                       TRACK                           25800000
         LR    RDEB,RD                  RESTORE DEB REGISTER            26000000
         BP    EDO00500                 NO,DON'T WRITE THIS TRACK       26200000
         BAL   R8,EDO01300              YES,GO SET UP CHANNEL PROGRAM   26400000
         IC    RF,DXCCW4+K8             ADD 1 TO LAST RECORD NUMBER     26600000
         LA    RF,K1(,RF)               WRITTEN BY THE PROBLEM PROGRAM  26800000
         STC   RF,DXDSCB+K4             STORE UPDATED RECORD NUMBER     27000000
         BAL   R8,EDO01400              GO TO WRITE THE FILE MARK       27200000
         OI    DXATDACC,DXATEOF         EOF MARK WRITTEN         Y02144 27250002
*                                                                       27300002
*        WRITE FILE MARK ON NEXT TRACK                                  27350002
*                                                                       27360002
EDO00500 EQU   *                        CALCULATE NEXT TRACK            27400002
         SR    RF,RF                    CLEAR WORK REGISTER             27600000
         MVI   DXCCW4+K8,K0             SET R=0                         27800000
         IC    RF,DXCCW4+K7             C(RJ)=000H                      28000000
         LA    RF,K1(,RF)               C(RJ)=H+1                       28200000
         STC   RF,DXCCW4+K7             C(CCW4+4)=CCH(H+1)              28400000
         L     R1,DCBDVTBL              ADDRESS OF DEVICE TABLE         28600000
         CLC   DXCCW4+K7(K1),K3(R1)     IS TRACK+1 VALID                28800000
         BNL   EDO00600                 BR IF TRACK NOT VALID           29000000
         L     R1,DCBDEBAD                                              29200000
         TM    K8(R1),DEBOFSPL          CHK FOR SPLIT CYLINDER          29400000
         BNO   EDO01100                 BR IF NO SPLIT CYLINDER         29600000
         EJECT                                                          29650002
*                                                                       29700002
*        SPLIT CYLINDER EXTENT                                          29750002
*                                                                       29760002
         CLC   DXCCW4+K7(K1),DEBENDHH+K1  CHK FOR SPLIT CYL END TRACK   29800000
         BNH   EDO01100                 BR IF NOT END TRACK             30000000
*                                                                       30200000
*   IF TRACK NUMBER IS NOT VALID FOR THE DEVICE OR IS THE LAST OF A     30400000
*   SPLIT CYLINDER, STEP TO THE NEXT CYLINDER.                          30600000
*                                                                       30800000
EDO00600 EQU   *                        CALCULATE NEXT CYLINDER         31000002
         LH    RF,DXCCW4+K4             C(RJ)=00CC                      36200000
         LA    RF,K1(,RF)               C(RJ)=00C(C+1)                  36400000
         SLL   RF,K16                   C(RJ)=C(C+1)00                  36600002
EDO01000 EQU   *                        SET TRACK TO ZERO OR START OF   37200002
*                                       SPLIT CYLINDER.                 37250002
         ST    RF,DXCCW4+K4             C(CCW4+4)=NEXT CYL, TRK ZERO    37400000
         L     RF,DCBDEBAD                                              37600000
         TM    K8(RF),DEBOFSPL          CHK FOR SPLIT CYLINDER          37800000
         BZ    EDO01100                 BR IF NOT SPLIT CYLINDER        38000000
         MVC   DXCCW4+K7(K1),DEBSTRHH+K1  SPLIT CYL, SET TRACK TO START 38200000
*                                                                       38400000
EDO01100 EQU   *                        IS ADDRESS IN EXTENT            38600002
         CLC   DXCCW4+K4(K4),DEBENDCC   IS CCHH IN THIS EXTENT          38800000
         BH    EDO01500                 NO,GO SEE IF ANOTHER EXTENT     39000000
EDO01200 EQU   *                        WRITE FILE MARK                 39200002
         BAL   R8,EDO01300              YES,GO TO SET UP CHANNEL PROG   39400000
         MVI   DXDSCB+K4,K1             SET RCD NO. OF FILE MARK TO 1   39600000
         BAL   R8,EDO01400              GO TO WRITE THE FILE MARK       39800000
         OI    DXATDACC,DXATEOF         EOF MARK WRITTEN         Y02144 39850002
         B     EDO01600                 EXIT, FILE MARK WRITTEN         40000000
         SPACE 2                                                        40200002
EDO01300 EQU   *                        BUILD CHANNEL PROGRAM SUBROUT'N 40400002
         LA    RF,DXCCW4+K4             PLACE ADDRESS OF CCHHR          40600000
         ST    RF,DXCCW1                INTO SEARCH CCW                 40800000
         LA    RF,DXCCW1                ADDRESS OF CCW1                 41000000
         MVI   DXCCW1,CCWSCHID          SET UP SEARCH OPERATION CODE    41200000
         ST    RF,DXCCW2                ADDRESS OF CCW1 INTO TIC CCW    41400000
         MVC   DXCCW1+K4(K5),WFMCCW1    COMMAND CHAIN,5 CHAR,TIC OPER   41600000
         LA    RF,DXDSCB                PLACE ADDRESS OF THE FILE MARK  41800000
         ST    RF,DXCCW3                INTO THE WRITE DATA CCW         42000000
         MVC   DXCCW2+K4(K5),WFMCCW2    COMMAND CHAIN,WR COMMAND OPER   42200000
         MVC   DXCCW3+K4(K4),WFMCCW3    8 CHARACTERS                    42400000
         MVC   DXDSCB(K5),DXCCW4+K4     PLACE CCHHR INTO THE KEY        42600000
         XC    DXDSCB+K5(K3),DXDSCB+K5  ZERO OUT THE DATA PORTION       42800000
         BR    R8                       RETURN TO CALLER                43000000
         EJECT                                                          43200002
EDO01400 EQU   *                        WRITE FILE MARK SUBROUTINE      43400002
         MVC   DXDAADDR,DXCCW4+K1       PLACE FULL DISK ADDRESS IN IOB  43600000
         MVI   DXDAADDR,K0              SET M (EXTENT NUMBER) TO ZERO   43800000
         EXCP  DXIOB                    EXECUTE CHANNEL PROGRAM         44000000
         WAIT  ,ECB=DXECB               WAIT FOR COMPLETION             44200000
         TM    DXECB,ECBCOD7F           TEST COMPLETION CODE            44400000
         BOR   R8                       RETURN TO CALLER                44600002
         LA    R0,EABD187               I/O ERROR WRITE FILE MARK       44800000
         B     EDO02450                 GO ISSUE 737 ABEND              45000000
         SPACE 2                                                        45200002
EDO01500 EQU   *                        GET NEXT EXTENT SUBROUTINE      45400002
         L     RDEB,DCBDEBAD            RESTORE ADDRESS OF USER'S DEB   45600000
         SR    RF,RF                    CLEAR WORK REGISTER             45800000
         SR    R7,R7                    CLEAR WORK REGISTER             46000000
         IC    R7,DCBFDAD               PICK UP M (CURRENT EXTENT NO.)  46200000
         IC    RF,DEBNMEXT              PICK UP NUMBER OF EXTENTS       46400000
         LA    R7,K1(,R7)               UPDATE M BY ONE                 46600000
         CR    R7,RF                    ARE THERE ANY MORE XTNTS        46800000
         BNL   EDO01600                 NO,FILE MARK NOT TO BE WRTN     47000002
         SLL   R7,K4                    MULTIPLY EXTENT NUMBER BY 16    47200002
         AR    RDEB,R7                  POINT TO CORRECT DEB EXTENT     47400000
         MVC   DXDEBBIN(K12),DEBBINUM   PUT BEGINNING CCHH IN WORK DEB  47600000
         MVC   DXCCW4+K2(K6),DXDEBBIN   STARTING BBCCHH TO SEARCH       47800000
         MVI   DXCCW4+K8,K0             SET RECORD NUMBER TO ZERO       48000000
         B     EDO01200                 WRITE FILE MARK IN NEW EXTENT   48200000
         EJECT                                                          48400002
*                                                                       48450002
*        READ FORMAT 1 DSCB                                             48500002
*                                                                       48550002
EDO01600 EQU   *                        SEE IF VIO                      48600002
         L     RDEB,DCBDEBAD            RESTORE ADDRESS OF USER'S DEB   48800000
         L     RUCB,DXUCBADR            PICK UP UCB POINTER      Y02134 49000002
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         Y02132 49012002
         BNO   EDO01700                 BR IF NOT                Y02132 49024002
*                                                                       49034002
*        READ VIO DSCB FROM SWA                                  Y02132 49036002
*                                                                       49046002
         MVC   DXDSCB(DSCEXT2-DSCFMTID),VDSDSCB-VDSUCB+L'JFCBDSNM(RUCB) 49048002
*                                                                Y02132 49060002
         OC    DXDSCB(DSCEXT2-DSCFMTID),DXDSCB IS DSCB = ZERO?   Y02132 49072002
         BZ    EDO02425                 BR IF YES,I/O ERROR      Y02132 49084002
*                                                                Y02132 49096002
         XC    DSCEXT2(DSCBEND-DSCEXT2),DSCEXT2 ZERO REMAIN CORE Y02132 49108002
*                                                                Y02132 49120002
         B     EDO01800                 CONTINUE PROCESSING      Y02132 49132002
EDO01700 EQU   *                        NOT VIO                  Y02132 49144002
*                                                                       49200000
*        READ REAL FORMAT 1 DSCB FROM VTOC                              49250002
*                                                                       49600000
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 UCB ADDRESS TO DEB    Y02134 50000002
         XC    DXDEBSCC(K4),DXDEBSCC    CLEAR START CCHH                50400000
         L     R1,K16                   GET CVT ADDR                    50600000
         L     R1,K64(R1)               GET DEVICE TABLE                50800000
         SR    RF,RF                    CLEAR REG                       51000000
         IC    RF,UCBTBYT4              GET DEVICE TYPE                 51200000
         IC    RF,K0(RF,R1)             GET DEVICE INDEX                51400000
         LA    RF,K0(RF,R1)             GET DEVICE ENTRY                51600000
         MVC   DXDEBECC(K4),K0(RF)      GET MAX EXTENT                  51800000
         MVI   DXDEBNTR,MAXTRK          INDICATE MAX TRACKS             52000000
         LR    R7,RDEB                                                  52200000
         SH    R7,WFM016                POSITION AT (-16)               52400000
         MVC   DXDAADDR+K1(K7),DEB+K1-DEB(R7)  BBCCHHR OF DSCB          52600000
*                                       TO SEEK WRD                     52800000
         MVI   DXDAADDR,K0              SET -M-TO ZERO                  53000000
*                                                                       53200000
*        GENERATE CHANNEL PROGRAM TO READ DSCB FRMT 1                   53400000
*                                                                       53600000
         XC    DXCCW1(K24),DXCCW1       ZERO CCWS 1 THRU 3              53800000
         LA    R1,DXDAADDR+K3           ADDR OF CCHHR                   54000000
         ST    R1,DXCCW1                SRCH I.D.TO CCW 1               54200000
         LA    R1,DXCCW1                ADDR  OF SRCH CMD TO TIC        54400000
         ST    R1,DXCCW2                STORE IT                        54600000
         LA    R1,DXDSCB                READ AREA ADDRESS               54800000
         ST    R1,DXCCW3                TO READ M/T CMD.                55000000
         OC    DXCCW1(K24),WFMCCWS      OR IN SKELETON CCWS-WKAREA.     55200000
         BAL   R7,EDO02400              BRANCH TO I/O ROUTINE           55400000
         EJECT                                                          55450002
*                                                                       57600000
*        UPDATE THE DSCB AND REWRITE IT                                 58000002
*                                                                       58200002
*              MBBCCHHR TO TTR CONVERT ROUTINE (IECPRLTV) WILL BE USED  58400002
*                                                                       58800002
*              THE FOLLOWING IS THE REGISTER USAGE OF THAT ROUTINE      59000002
*                                                                       59200002
*                                  REG 0    RESULTANT TTR0              59600000
*                                  REG 1    DEB ADDRESS                 59800000
*                                  REG 2    ADDR OF MBBCCHHR            60000000
*                                  REG 3-8  NOT USED                    60200000
*                                  REG 9-13 VOLATILE-DESTROYED          60400000
*                                  REG 14   RETURN ADDRESS              60600000
*                                  REG 15   ENTRY POINT-BASE REGISTER   60800000
*                                                                       61000002
EDO01800 EQU   *                        GET TTR FROM DCBFDAD     Y02132 61212002
         L     R8,DXCCW7                SAVE MAIN UCB ADDR              61400000
         STM   RDCB,RD,DXCCW5           SAVE REGS                       61600000
         LR    R1,RDEB                  ADDR OF USER'S DEB TO PARM REG  61800000
         LA    RDCB,DCBFDAD             ADDR OF MBBCCHHR TO PARM REG    62000000
         L     RF,CVTPTR                PICK UP ADDRESS OF CONVERT RTN  62200000
         L     RF,CVTPRLTV              FROM THE CVT                    62400000
         BALR  RET,RF                   CONVERT MBBCCHHR TO TTR0        62600000
         LM    RDCB,RD,DXCCW5           RESTORE REGS                    62800000
         ST    R8,DXCCW7                RESTORE ADDR FOR NEXT LOAD      63000000
         ST    R0,DXCCW5                STORE LAST BLK TTR              63200000
         MVC   DSCLSTAR+K3(K2),DCBTRBAL  NUM OF BYTES ON TRACK REMAININ 63400000
EDO01900 EQU   *                        TRBAL, LAST VOL BIT UPDATED     63600002
         MVC   DSCLSTAR(K3),DXCCW5      MOVE IN LAST BLK PTR            63800000
         NI    DSCDSIND,ALLBITS-LASTNTRY  TURN OFF LAST VOL IND.        64000002
         OI    DXATDACC,DXATTRAK        LAST TRK USED AND TRK    Y02144 64050002
*                                       BALANCE FIELDS UPDATED   Y02144 64100002
         EJECT                                                          64102002
*                                                                       64104002
*        REWRITE DSCB                                                   64104402
*                                                                       64104802
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         Y02132 64105002
         BNO   EDO01950                 BR IF NOT                Y02132 64110002
*                                                                Y02132 64115002
         MODESET EXTKEY=SCHED           ASSUME SCHEDULER KEY     Y02132 64120002
*                                                                Y02132 64125002
*        WRITE VIO FORMAT ONE DSCB TO SWA                        Y02132 64130002
*                                                                Y02132 64135002
         MVC   VDSDSCB-VDSUCB+L'JFCBDSNM(DSCEXT2-DSCFMTID,RUCB),DXDSCB  64140002
*                                                                Y02132 64145002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02132 64150002
*                                                                Y02132 64155002
         B     EDO01975                 CONTINUE PROCESSING      Y02132 64160002
EDO01950 EQU   *                        BUILD CHANNEL PROGRAM           64165002
*                                                                       64200000
*        WRITE FORMAT 1 DSCB ONTO VTOC                                  64400002
*                                                                       64600000
         MVI   DXCCW3,CCWWRTDA          MOVE  WRITE OP CODE TO CCW      64800000
         MVI   DXCCW3+K4,CCWCMDCH       CHAIN COMMAND TO RDBACK CHECK   65000000
         MVC   DXCCW4(K24),DXCCW1       MOVE BASIC CCW'S RDBACK CHECK   65200000
         LA    R1,DXCCW4                                                65400000
         ST    R1,DXCCW5                ADDR FOR TIC                    65600000
         MVI   DXCCW5,CCWTIC                                            65800000
         MVI   DXCCW6,CCWRDDA           READ COMMAND                    66000000
         MVI   DXCCW6+K4,X10            SKIP FLAG ON- NO DATA           66200002
*                                       TRANSFER FOR RDBACK CHECK       66400002
         BAL   R7,EDO02400              BRANCH TO I/O ROUTINE           66600000
EDO01975 EQU   *                        SET AUDIT TRAIL          Y02132 66605002
         OI    DXATDACC,DXATUPDB        UPDATED DSCB WRITTEN     Y02144 66650002
*                                                                       66800000
*        WRITE COMPLETE HERE                                            67000000
*                                                                       67200000
         EJECT                                                          67250002
EDO02000 EQU   *                        DETERMINE EXIT MODULE           67400002
*                                                                Y02134 67450002
         LA    RET,K4                   LOAD BRANCH CODE         Y02134 67450402
         LA    R7,ID4N4P                GET NEW VOLUME           Y02134 67452002
*                                                                Y02134 67454002
         TM    JFCBLTYP,JFCSL+JFCBUL    TEST FOR USER LABELS     Y02134 67460002
         BNO   EDO02100                 BRANCH, BYPASS USER LBLS Y02134 67470002
*                                                                Y02134 67480002
         LA    R7,ID4N4Z                USER LABEL PROCESS       Y02134 67490002
*                                                                Y02134 67492002
EDO02100 EQU   *                        CHECK FOR SMF            Y02134 67494002
*                                                                Y02134 67496002
         TM    DXXPATHS,WTGSMF          IS SMF REQUIRED          Y02134 67500002
         BNO   EDO02200                 BRANCH TO BYPASS SMF     Y02134 67550002
*                                                                Y02134 67600002
         MVC   DXRETMOD,DXXIDTTR-DXXIDTTR(R7) SAVE RETURN LOAD   Y02134 67650002
         LA    R7,ID4N3B                SMF PROCESSING           Y02134 67700002
*                                                                Y02134 67750002
EDO02200 EQU   *                        GIVE NEXT MODULE CONTROL Y02134 67800002
*                                                                Y02134 67850002
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              69400000
         LA    RWTG,DXXAREA             POINT TO EOV WTG                69600000
         IECRES LOAD,MODID=(R7),BRCODE=(RET),BRANCH=QUEUED       Y02134 69850002
         EJECT                                                          69900002
*                                                                       70000000
*        I/O ROUTINE -READS AND WRITES FRMT 1 DSCB                      70200000
*                                                                       70400000
EDO02400 EQU   *                        EXCP, WAIT, TEST FOR I/O ERROR  70600002
         EXCP  DXIOB                    EXECUTE CHANNEL PROGRAM         70800000
         WAIT  ,ECB=DXECB               WAIT FOR COMPLETION             71000000
         TM    DXECB,ECBCOD7F           TEST COMPLETION CODE            71200000
         BOR   R7                       OK,RETURN                       71400002
EDO02425 EQU   *                        GET INTERNAL ABCODE      Y02132 71405002
         LA    R0,EABD190               ABEND 737                       71600000
EDO02450 EQU   *                        GIVE PROBLEM DETERMINATION      71800002
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              72000000
         LA    RWTG,DXXAREA             POINT TO EOV WTG                72200000
         DMABCOND (0),ID4N0P                                     Y02134 72400002
         EJECT                                                          72450002
*                                                                       75600000
*        CONSTANTS                                                      75800000
*                                                                       76000000
WFM016   DC    H'16'                    HALF WORD 16                    76200000
WFMCCWS  DC    X'3100000060000005'      SRCH EQUAL ID                   76400000
         DC    X'0800000000000000'      TIC                             76600000
         DC    X'8600000000000060'      READ DATA M/T                   76800000
WFMCCW1  DC    X'4000000508'            LAST 5 CHAR FOR SRCH ID EQ      77000000
WFMCCW2  DC    X'400000001D'            USED FOR WRITE FILE MARK        77200000
WFMCCW3  DC    X'20000008'              USED FOR WRITE FILE MARK        77400000
         EJECT                                                          77450002
*                                                                       77600000
*        XCTL  TABLE FOR IFG0554N                                       77800000
*                                                                       78000000
         XCTLTABL ID=(ID4N4P,4P,ID4N4Z,4Z,ID4N3B,3B,ID4N0P,0P),  Y02134X78400002
               SVC=055,BRT=YES,LENGTH=                           Y02080 78450002
         IECDSECS CVT,TCB,TIOT,SMF,DCB,DEB,UCB,MAIN,USERLAB,     Y02080X78600002
               WTG,PREFX,EXPAND=YES                              Y02080 78650002
         IECEQU                                                         78652002
         IDDVDSCB                                                Y02132 78655002
         END                                                            79000000
./  ADD  SSI=71330486,NAME=IFG0554P
         TITLE 'IFG0554P                      END OF VOLUME DA OUTPUT ' 00100002
IFG0554P CSECT                                                          00200002
*********************************************************************** 00250002
*                                                                     * 00300002
*          VS2 RELEASE 3.7 DELETIONS/CHANGES                          * 00350037
*0000320740                                                    @ZA16814 00354037
*0000320540                                                    @ZA12175 00358037
*0000043600-043900,320526-320532                               @ZA12174 00362037
*000074000,289968,285969,307908                                @ZA15053 00364037
*C320540,320600,320660,D320550,320620,320640,320680,           @ZA18328 00365008
*D320700-320768,A320570,320630,320690                          @ZA18328 00365508
*                                                                     * 00366037
*          VS2 RELEASE 03 DELETIONS                                   * 00374037
*0000                                                          @ZA02221 00382037
*0000028000,042500,069000,073500,101453,307504,307520          @ZA02218 00390037
*307900,307912,514600                                          @ZA02218 00398037
*          VS2 RELEASE 02 DELETIONS                                   * 00406037
*0000140000                                                    @ZA06676 00414037
*0000108000,160000,285936-285938,285996-288996,353517-353597    ZA01265 00422037
*515000,515500                                                  ZA01265 00430037
*                                                                     * 00438037
*                                                                     * 00450002
*                                                                     * 00500002
*********************************************************************** 00550002
*                                                                     * 00600002
* MODULE NAME = IFG0554P (OS/VS2)                                     * 00650002
*                                                                     * 00700002
* DESCRIPTIVE NAME =                                                  * 00750002
*        EOV DA OUTPUT                                                * 00800002
*                                                                     * 00850002
* COPYRIGHT = NONE                                                    * 00900002
*                                                                     * 00950002
* STATUS = RELEASE 2, LEVEL 0                                         * 01000002
*                                                                     * 01050002
* FUNCTION =                                                          * 01100002
*        THIS IS THE CENTRAL FUNCTION CONTROL MODULE FOR DIRECT       * 01150002
*        ACCESS OUTPUT END OF VOLUME PROCESSING. IT IS ENTERED        * 01200002
*        UNDER THE FOLLOWING CONDITIONS -                             * 01250002
*                                                                     * 01300002
*        1) IF WTGMODNM IN THE EOV WORKAREA DOES NOT INDICATE A       * 01350002
*        RETURN FROM DADSM, REGISTER 14 CONTAINS                      * 01400002
*        A BRANCH TABLE CODE 0, 4, 8, 12, 16 -                        * 01450002
*                                                                     * 01500002
*        - 0 - ENTRY FROM IFG0551H, THE INITIALIZATION FUNCTION FOR   * 01550002
*        EOV. IT IS DETERMINED WHETHER TO OBTAIN ADDITIONAL SPACE ON  * 01600002
*        THE CURRENT VOLUME OR TO OBTAIN A NEW VOLUME.                * 01650002
*                                                                     * 01700002
*        AN ATTEMPT TO ACQUIRE ADDITIONAL SPACE ON THE CURRENT        * 01750002
*        VOLUME WILL BE MADE IF THE DEB DOES NOT ALREADY CONTAIN      * 01800002
*        16 EXTENTS, VIO IS NOT BEING USED, THE SECONDARY SPACE       * 01850002
*        VALUE IN THE JFCB IS NONZERO, AND ONE OF THE FOLLOWING       * 01900002
*        CONDITIONS EXIST -                                           * 01950002
*              1) DISPOSITION IS MOD OR NEW.                          * 02000002
*              2) DISPOSITION IS OLD AND THE LAST VOLUME SUPPLIED     * 02050002
*              IN THE JFCB IS BEING PROCESSED.                        * 02100002
*              3) DISPOSITION IS OLD AND THE LAST VOLUME SUPPLIED     * 02150002
*              IN THE JFCB IS NOT BEING PROCESSED BUT BIT 0 OF        * 02200002
*              DEBVOLSQ (THE 'TREAT AS NEW' BIT) IS SET TO ONE.       * 02250002
*                                                                     * 02300002
*        ADDITIONAL SPACE IS REQUESTED ON THE CURRENT VOLUME BY       * 02350002
*        GIVING CONTROL TO THE DADSM EXTEND ROUTINE'S FIRST MODULE,   * 02400002
*        IGG0553A, WITH REGISTER 13 SET TO 1.                         * 02450002
         EJECT                                                          02500002
*        IF SECONDARY SPACE IS ZERO, IFG0554T IS                      * 02800037
*        GIVEN CONTROL WITH INTERNAL ABEND CODE 186 CAUSING ABEND     * 02850002
*        D37-04.                                                      * 02900002
*                                                                     * 02950002
*        IF 1) THE DEB HAS 16 EXTENTS OR                              * 03000002
*        2) A VIO UNIT IS BEING PROCESSED OR                          * 03000102
*        3) THE DISPOSITION IS OLD AND THE LAST VOLUME SUPPLIED IN    * 03010002
*        THE JFCB IS NOT BEING PROCESSED AND THE 'TREAT AS NEW' BIT   * 03050002
*        (BIT 0 OF DEBVOLSQ) IS NOT SET TO ONE,                       * 03100002
*        MODULE IFG0554Z IS GIVEN CONTROL (IF SMF                     * 03160002
*        PROCESSING IS NOT REQUIRED) IN ORDER TO UPDATE               * 03200002
*        THE DSCB ON THE CURRENT VOLUME AND INTERFACE WITH USER       * 03250002
*        TRAILER LABEL PROCESSING IF REQUIRED.                        * 03300002
*        IF SMF PROCESSING IS REQUIRED UNDER THESE CIRCUMSTANCES,     * 03310002
*        MODULE IFG0553B (ALIAS FOR IFG0202H) IS GIVEN CONTROL WITH   * 03320002
*        DXRETMOD SET IN THE EOV WORKAREA CAUSING MODULE IFG0554Z TO  * 03330002
*        GAIN CONTROL AFTER SMF PROCESSING IS COMPLETED.              * 03340002
*                                                                     * 03350002
*        - 4 - ENTRY FROM IFG0554Z OR IFG0554N AFTER UPDATING THE     * 03400002
*        CURRENT VOLUME'S DSCB AND INTERFACING WITH USER LABEL        * 03450002
*        PROCESSING, THUS COMPLETING PROCESSING ON THE CURRENT        * 03500002
*        VOLUME.                                                      * 03520002
*                                                                     * 03600002
*        IF MORE VOLUMES ARE REQUESTED                                * 03650002
*        (USING THE JFCB VOLUME COUNT OR NUMBER OF                    * 03700002
*        VOLUMES, WHICHEVER IS GREATER), THE DATA MANAGEMENT          * 03750002
*        COUNT ON THE CURRENT VOLUME IS DECREMENTED AND, IF A         * 03752002
*        VIO UNIT, A WICLOSE IS ISSUED IF THE D. M. COUNT DROPS       * 03754002
*        TO ZERO. MODULE IFG0554A (ALIAS                              * 03760002
*        FOR IFG0194A) IS GIVEN CONTROL WITH REGISTER 14 SET TO       * 03800002
*        8 AND THE RETURN MODULE SET TO IFG0555H IN ORDER TO          * 03850002
*        MOUNT AND VERIFY THE NEXT VOLUME. IF THE DSCB IS PRESENT     * 03900002
*        ON THE NEXT VOLUME, IFG0554C (GIVEN CONTROL BY IFG0554A)     * 03950002
*        WILL PASS CONTROL TO IFG0555H TO BUILD A NEW DEB.            * 04000002
*        OTHERWISE A RETURN WILL BE MADE TO THIS MODULE               * 04050002
*        WITH REGISTER 14 SET TO 8.                                   * 04100002
*                                                                     * 04150002
*        IF NO MORE VOLUMES ARE REQUESTED, OR IF THIS IS A PDS,       * 04200002
*        IFG0554T IS GIVEN CONTROL WITH AN INTERNAL ABEND CODE OF     * 04250037
*        184 CAUSING AN E37-4 ABEND.                                  * 04300037
*                                                                     * 04350037
         EJECT                                                          04410002
*        - 8 - RETURN FROM IFG0554C AFTER MOUNTING A NEW VOLUME AND   * 04450002
*        NOT FINDING A DSCB ON THE VOLUME. REGISTER 13 IS SET TO 4    * 04500002
*        AND DADSM EXTEND MODULE IGG0553A IS GIVEN CONTROL TO         * 04550002
*        OBTAIN SECONDARY SPACE ON THE NEW VOLUME.                    * 04600002
*                                                                     * 04650002
*        - 12 - RETURN FROM SMF MODULE IFG0202I WHEN NO MORE VOLUMES  * 04700002
*        ARE AVAILABLE. PROBLEM DETERMINATION IS GIVEN CONTROL WITH   * 04750002
*        INTERNAL ABEND CODE 184 CAUSING AN E37-4 ABEND.              * 04800002
*                                                                     * 04850002
*        - 16 - ENTRY FROM IFG0554T AFTER TAKING THE B37 ABEND EXIT   * 04900002
*        AND RECEIVING A RETURN CODE FROM THE EXIT INDICATING FOR     * 04950002
*        EOV TO TRY ONCE AGAIN TO OBTAIN ADDITIONAL SPACE ON THE      * 05000002
*        CURRENT VOLUME. DADSM EXTEND MODULE IGG0553A IS GIVEN        * 05050002
*        CONTROL WITH REGISTER 13 SET TO 1, THE VALUE PASSED FROM     * 05100002
*        IFG0554T.                                                    * 05150002
*                                                                     * 05200002
*        2) IF WTGMODNM IN THE EOV WORKAREA IS SET TO IGG0553A, THIS  * 05250002
*        INDICATES THAT DADSM IS RETURNING AFTER ATTEMPTING TO        * 05300002
*        ACQUIRE ADDITIONAL SPACE ON THE CURRENT OR A NEW VOLUME.     * 05350002
*        A RETURN CODE IS IN REGISTER 13 -                            * 05400002
*                                                                     * 05450002
*        - 4 - SPACE WAS OBTAINED ON A NEW VOLUME. DEBF1CEV IN        * 05500002
*        DEBFLGS1 IS SET TO 1 (INDICATING THAT EOV HAS EXTENDED),     * 05550002
*        IF DCBC2PUT IS SET TO ONE IN DCBCIND2 (INDICATING            * 05600002
*        CLOSE CALLED EOV).                                           * 05650002
*        IFG0554C IS GIVEN CONTROL USING DXRETMOD AND DXRETCOD        * 05700002
*        (WHICH HAS BEEN SET UP BY IFG0554C BEFORE GIVING THIS        * 05750002
*        MODULE CONTROL WITH REGISTER 14 SET TO 8). THIS WILL         * 05800002
*        RESULT IN THE JFCB BEING UPDATED AND THE DSCB(S) BEING       * 05850002
*        READ AND MODULE IFG0555H BEING GIVEN CONTROL TO BUILD A      * 05900002
*        NEW DEB.                                                     * 05950002
*                                                                     * 06000002
*        - 1 - SPACE HAS BEEN OBTAINED ON THE CURRENT VOLUME.         * 06050002
*        DEBF1CEV IN DEBFLGS1 IS SET TO 1                             * 06100002
*        (INDICATING THAT EOV HAS EXTENDED),                          * 06150002
*        IF DCBC2PUT IS SET TO ONE IN DCBCIND2 (INDICATING            * 06200002
*        CLOSE CALLED EOV).                                           * 06250002
*        THE DSCB IS READ USING THE DEB'S DSCB BBCCHHR, AND CONTROL   * 06300002
*        IS GIVEN TO IFG0555H WITH REGISTER 14 SET TO 8 IN ORDER      * 06350002
*        TO BUILD A NEW DEB.                                          * 06400002
         EJECT                                                          06450002
*        - -1 - NO SPACE AVAILABLE ON THE CURRENT VOLUME. IF MORE     * 06500002
*        VOLUMES ARE SPECIFIED (USING THE VOLUME COUNT OR THE         * 06550002
*        NUMBER OF VOLUMES IN THE JFCB, WHICHEVER IS GREATER),        * 06600002
*        MODULE IFG0554Z IS GIVEN CONTROL (IF                         * 06650002
*        SMF PROCESSING IS NOT REQUIRED) TO UPDATE THE DSCB ON THE    * 06700002
*        CURRENT VOLUME AND PROCESS USER TRAILER LABELS IF NEEDED.    * 06750002
*        IFG0554Z WILL RETURN TO THIS MODULE WITH REGISTER 14 SET     * 06800002
*        TO 4.                                                        * 06850002
*                                                                     * 06860002
*        IF MORE VOLUMES ARE SPECIFIED AND SMF PROCESSING IS          * 06870002
*        REQUIRED, MODULE IFG0553B (ALIAS FOR IFG0202H) IS GIVEN      * 06880002
*        CONTROL WITH DXRETMOD IN THE EOV WORKAREA CAUSING CONTROL    * 06890002
*        NEXT TO BE GIVEN TO IFG0554Z AFTER SMF PROCESSING IS DONE.   * 06892002
*                                                                     * 06894002
*        IF NO MORE VOLUMES ARE SPECIFIED, IFG0554T                   * 06900037
*        IS GIVEN CONTROL WITH INTERNAL ABEND CODE 184 CAUSING        * 06950002
*        AN E37-4 ABEND, IF SMF PROCESSING IS NOT REQUIRED.           * 07000002
*        IF SMF PROCESSING IS REQUIRED UNDER THIS SITUATION,          * 07010002
*        MODULE IFG0553B (ALIAS FOR IFG0202H) IS GIVEN CONTROL WITH   * 07050002
*        DXRETMOD INDICATING THAT CONTROL SHOULD RETURN TO THIS       * 07100002
*        MODULE WITH 12 IN REGISTER 14, WHICH WILL RESULT IN THE      * 07102002
*        E37-4 ABEND.                                                 * 07104002
*                                                                     * 07110002
*        - -4 - NO SPACE COULD BE OBTAINED ON A NEW VOLUME.           * 07150002
*        IF THE NEW VOLUME IS FOR A NON-SPECIFIC REQUEST, MODULE      * 07200002
*        IFG0554A IS GIVEN CONTROL WITH REGISTER 14 SET TO 16         * 07250002
*        TO REJECT THE CURRENT VOLUME AND MOUNT ANOTHER.              * 07300002
*        OTHERWISE, IFG0554T IS GIVEN CONTROL WITH AN                 * 07350037
*        INTERNAL ABEND CODE OF 183 CAUSING AN E37-8 ABEND.   @ZA15053* 07400037
*                                                                     * 07450002
*        - -8 - A VOLUME WAS ENCOUNTERED WHOSE VTOC COULD             * 07500002
*        NOT BE CONVERTED TO STANDARD FORMAT.                         * 07550002
*        IF THE NEW VOLUME IS FOR A NON-SPECIFIC REQUEST, MODULE      * 07600002
*        IFG0554A IS GIVEN CONTROL WITH REGISTER 14 SET TO 16         * 07650002
*        TO REJECT THE CURRENT VOLUME AND MOUNT ANOTHER.              * 07700002
*        OTHERWISE, PROBLEM DETERMINATION IS GIVEN CONTROL WITH       * 07750002
*        AN INTERNAL ABEND CODE OF 177 CAUSING AN B37-8 ABEND.        * 07800002
*                                                              @Z40RSDH 07800208
*        - -12 - RACDEF IN EXTEND FAILED. IF THE DATA SET ON   @Z40RSDH 07800408
*        THE VOLUME PROCESSED AT OPEN IS DEFINED TO RAC A RIDT @Z40RSDH 07800608
*        IS BUILT. EXTEND CHECKS TO SEE IF THE DATA SET ON THE @Z40RSDH 07800808
*        FIRST VOLUME WAS DEFINED TO RAC AND IF IT WAS THEN    @Z40RSDH 07801008
*        A RACDEF TYPE=ADDVOL IS ISSUED TO DEFINE THE NEWLY    @Z40RSDH 07801208
*        CREATED DATA SET/VOLUME TO RAC. THIS WILL FAIL IF     @Z40RSDH 07801408
*        THE DATA SET NAME AT EOV IS NOT THE SAME AS AT OPEN;  @Z40RSDH 07801608
*        HENCE AN INTERVENING OPENJ MUST HAVE ALTERED THE      @Z40RSDH 07801808
*        DATA SET NAME.                                        @Z40RSDH 07802208
*                                                                     * 07850002
*        - -16 - AN I/O ERROR WAS ENCOUNTERED IN PROCESSING THE VTOC. * 07900002
*        IF THE NEW VOLUME IS FOR A NON-SPECIFIC REQUEST, MODULE      * 07950002
*        IFG0554A IS GIVEN CONTROL WITH REGISTER 14 SET TO 16         * 08000002
*        TO REJECT THE CURRENT VOLUME AND MOUNT ANOTHER.              * 08050002
*        OTHERWISE, PROBLEM DETERMINATION IS GIVEN CONTROL WITH       * 08100002
*        AN INTERNAL ABEND CODE OF 190 CAUSING AN 737-4 ABEND.        * 08150002
         EJECT                                                          08200002
* NOTES =                                                             * 08250002
*        THE 'TREAT AS NEW' BIT IS USED AS FOLLOWS.                   * 08300002
*        SECONDARY SPACE WILL NOT BE ACQUIRED ON THE VOLUMES OF       * 08350002
*        OF AN OLD DATA SET UNTIL THE LAST VOLUME OR UNTIL A          * 08400002
*        VOLUME IS ENCOUNTERED UPON WHICH NO DSCB RESIDES. AT         * 08450002
*        THIS POINT THE HIGH ORDER BIT OF DEBVOLSQ IS SET TO ONE      * 08500002
*        TO INFORM THIS MODULE THAT, EVEN THOUGH AN OLD DATA SET      * 08550002
*        IS BEING PROCESSED AND THE LAST VOLUME SPECIFIED IN THE      * 08600002
*        JFCB HAS NOT YET BEEN ENCOUNTERED, SECONDARY SPACE SHOULD    * 08650002
*        ATTEMPT TO BE ACQUIRED.                                      * 08700002
*        IFG0555H TURNS THIS BIT ON.                                  * 08750002
*                                                                     * 08800002
*    DEPENDENCIES =                                                   * 08850002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 08900002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 08950002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 09000002
*                                                                     * 09050002
*    RESTRICTIONS = NONE                                              * 09100002
*                                                                     * 09110002
*    REGISTER CONVENTIONS =                                           * 09200002
*            R2 POINTS TO DCB                                         * 09250002
*            R4 POINTS TO OPEN WORK AREA                              * 09300002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 09350002
*            R6 POINTS TO THE WTG TABLE                               * 09400002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 09450002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 09500002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 09550002
*            R10 POINTS TO THE UCB                                    * 09600002
*                                                                     * 09650002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 09700002
*                  END OF LISTING.                                    * 09750002
*                                                                     * 09800002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 09850002
*                                                                     * 09860002
*    PROCESSOR = ASSEMBLER XF                                         * 09870002
*                                                                     * 09880002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 09890002
*                  ORG STATEMENT AT END OF LISTING                    * 09892002
*                                                                     * 09894002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 09896002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 09898002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 09898402
*                                                                     * 09898802
* ENTRY POINT =                                                       * 09899202
*        IFG0554P                                                     * 09899602
*                                                                     * 09899702
*    PURPOSE = SEE FUNCTION                                           * 09899802
         EJECT                                                          09909802
*    LINKAGE =                                                        * 09933202
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 09943202
*        MACRO INSTRUCTION.                                           * 09953202
*                                                                     * 09955202
* INPUT =                                                             * 09965202
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 09965602
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 09966002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 09966402
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 09966502
*                                                                     * 09966602
*        DADSM RETURN -                                               * 09977702
*        WTGMODNM IN THE EOV WORKAREA SET TO 'IGG0553A'.              * 09987702
*        REGISTER 13 CONTAINS RETURN CODE 4, 1, -1, -4, -8, OR -16.   * 09988102
*                                                                     * 09988602
* OUTPUT =                                                            * 09988702
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 09988802
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 09992502
*        THE DEBDCBAD POINTING TO THE COPIED DCB,                     * 09994502
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 09994902
*                                                                     * 09995302
*        IFG0553B -                                                   * 09995702
*        DXRETMOD SET TO ID-VCON OF IFG0554Z OR IFG0554P.             * 09996102
*        REGISTER 14 SET TO ZERO (DXRETMOD FOR IFG0554Z),             * 09996202
*        OR TO 12 (DXRETMOD FOR IFG0554P).                            * 10022102
*                                                                     * 10032102
*        IFG0554Z -                                                   * 10042102
*        REGISTER 14 SET TO 0.                                        * 10044102
*                                                                     * 10046102
*        IFG0554A -                                                   * 10048102
*        DXRETMOD SET UP -                                            * 10056702
*              IFG0555H TO GET A NEW VOLUME                           * 10058702
*              UNTOUCHED IF REJECTING THE CURRENT NON-SPECIFIC VOL    * 10060702
*        DXRETCOD SET UP -                                            * 10062702
*              8 TO GET A NEW VOLUME                                  * 10064702
*              UNTOUCHED IF REJECTING THE CURRENT NON-SPECIFIC VOL    * 10065102
*        REGISTER 14 CONTAINS AN ENTRY CODE -                         * 10065202
*              0 TO GET A NEW VOLUME                                  * 10065302
*              16 TO REJECTEC THE CURRENT NON-SPECIFIC VOLUME         * 10065402
*                                                                     * 10074002
*        IFG0555H -                                                   * 10076002
*        REGISTER 14 CONTAINS 12                                      * 10078002
*                                                                     * 10080002
*        IFG0550P GIVEN CONTROL THROUGH DMABCOND MACRO -              * 10082002
*        REGISTER 0 CONTAINS INTERNAL ABEND CODE                      * 10082402
*                                                                     * 10082502
*        IGG0553A - DADSM EXTEND -                                    * 10082602
*        REGISTER 13 CONTAINS FUNCTION CODE -                         * 10082702
*              1 - OBTAIN SPACE ON THE CURRENT VOLUME.                * 10106102
*              4 - OBTAIN SPACE ON A NEW VOLUME.                      * 10116102
*                                                                     * 10116537
*        IFG0554T -                                                   * 10118137
*        REGISTER 12 CONTAINS INTERNAL ABEND CODE                     * 10122137
         EJECT                                                          10126102
* EXIT-NORMAL =                                                       * 10128102
*        IFG0554Z TO UPDATE THE CURRENT VOLUME'S DSCB AND             * 10128502
*        PROCESS USER TRAILER LABELS.                                 * 10128902
*        IFG0554A TO REJECT THE CURRENT NON-SPECIFIC REQUEST          * 10129302
*        VOLUME AND/OR MOUNT A NEW VOLUME.                            * 10129702
*        IFG0553B (ALIAS FOR IFG0202H) FOR SMF PROCESSING.            * 10137502
*        IFG0555H TO BUILD A NEW DEB.                                 * 10139502
*        IGG0553A TO OBTAIN ADDITIONAL SPACE (DADSM EXTEND)           * 10141502
*                                                                     * 10143502
* EXIT-ERROR =                                                        * 10143902
*        IFG0550P GIVEN CONTROL THROUGH DMABCOND MACRO WITH AN        * 10144302
*        INTERNAL ABEND CODE IN REGISTER 0 -                          * 10144702
*        190 - 737-4 - I/O ERROR READING DSCB OR I/O ERROR RETURN     * 10145102
*        CODE PASSED BACK FROM DADSM.                                 * 10145202
*        177 - B37-8 - VTOC COUND NOT BE CONVERTED TO                 * 10147437
*        STANDARD FORMAT BY DADSM.                                    * 10149437
*        IFG0554T GIVEN CONTROL WITH AN INTERNAL ABEND CODE IN        * 10149837
*        REGISTER 12 -                                                * 10150237
*        186 - D37-4 - NO SECONDARY SPACE SUPPLIED.                   * 10150837
*        184 - E37-04 - NO MORE VOLUMES SPECIFIED IN JFCB (VOLUME     * 10153102
*        COUNT OR NUMBER OF VOLUMES REACHED).                         * 10155237
*        184 - E37-08 - NO SPACE AVAILABLE ON NEW VOLUME OR   @ZA15053  10157237
*        DUPLICATE NAME FOUND ON NEW VOLUME                   @ZA15053  10159237
*        005 - 937-38 RACDEF FAILED AT EXTEND                  @Z40RSDH 10159308
*                                                                     * 10161837
* EXTERNAL REFERENCES = SEE BELOW                                     * 10164037
*                                                                     * 10166237
*    ROUTINES =                                                       * 10168437
*        IFG019RA THROUGH THE IECRES MACRO.                           * 10170637
*                                                                     * 10172837
*    DATA AREAS =                                                     * 10175037
*        EOV WORKAREA.                                                * 10177237
*                                                                     * 10179437
*    CONTROL BLOCK =                                                  * 10181637
*        DCB                                                          * 10183837
*        TCB                                                          * 10186037
*        CVT                                                          * 10188237
*        UCB                                                          * 10190437
*        VDSCB                                                        * 10192637
*        DEB                                                          * 10194837
*                                                                     * 10197002
* TABLES =                                                            * 10207002
*        NONE.                                                        * 10217002
         EJECT                                                          10217402
* MACROS =                                                            * 10217802
*        MODESET                                                      * 10217902
*        IECRES-LOAD                                                  * 10224702
*        IECRES-GET                                                   * 10226702
*        EXCP                                                         * 10228702
*        WAIT                                                         * 10230702
*        DMABCOND                                                     * 10231102
*        XCTLTABL                                                     * 10231502
*        IECDSECS                                                     * 10231602
*        IECEQU                                                       * 10238402
*                                                                     * 10240402
* CHANGE ACTIVITY =                                                   * 10242402
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 10244402
*                                                                     * 10244802
*********************************************************************** 10245202
         EJECT                                                          10245302
EABD183  EQU   183                      E37-8 ABEND INTERNAL            10247337
*                                       CODE                   @YA15053 10249337
EABD184  EQU   184                      E37-4 ABEND INTERNAL CODE       10252202
EABD177  EQU   177                      B37-8 INTERNAL ABCODE    M0179  10259002
EABD186  EQU   186                      D37-4 ABEND INTERNAL CODE       10279502
EABD190  EQU   190                      737-4 ABEND INTERNAL CODE       10300002
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        10400021
         USING FORCORE,RCORE                                            10500021
         USING WTG,RWTG                 WHERE-TO-GO TABLE        Y02080 10550002
         USING TIOENTRY,RTIOT                                           10600021
         USING UCB,RUCB                                                 10700021
         USING DEBBASIC,RDEB                                            10800002
         USING IHADCB,RDCB              ADDRESSABILITY FOR DCB          10900021
         USING *,RBASE                                                  11000021
*                                                                       11100021
*                                                                       11300021
         CLC   WTGMODNM,IGG0553A        CHECK FOR DADSM ENTRY    Y02134 11400002
         BE    EDO03500                 BRANCH IF EXTEND RETURN  Y02134 11500002
*                                                                       11600021
*      BRANCH TABLE RET IS SET TO THE FOLLOWING VALUES                  11700021
*                RET=0   FROM BASIC STRING IFG0551H                     11800021
*                RET=4   FROM IFG0554Z OR IFG0554N               Y02134 11900002
*                        OR FROM IFG0202I BY WAY OF IFG0554N     Y02134 11910002
*                RET=8   FROM NEW VOLUME MOUNT TO EXTEND         Y02134 11950002
*                RET=12  FROM SMF AFTER EXTEND ERROR             Y02134 12000002
*                RET=16  FROM B37 ABEND EXIT RETURN              Y02082 12050002
*                                                                       12200021
         B     EDO02700(RET)            BRANCH TABLE                    12300021
EDO02700 EQU   *                        BRANCH TABLE                    12400002
         B     EDO02800                 FROM BASIC IFG0551H             12500021
         B     EDO03800                 FROM 554Z OR 554N        Y02134 12600002
         B     EDO02910                 ENTRY FROM IFG0554C      Y02134 12700002
         B     EDO03660                 FROM IFG0553B AFTER ERR  Y02134 12750002
         B     EDO03300                 ENTRY FROM IFG0554T      Y02134 12800002
         EJECT                                                          13000002
EDO02800 EQU   *                        RET=0 FROM IFG0551H             13100002
*                                                                Y02134 13150002
         L     RUCB,DXUCBADR            LOAD UCB ADDRESS         Y02134 13200002
         L     RDEB,DCBDEBAD            LOAD DEB ADDRESS         Y02134 13250002
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 MOVE UCB TO WORK AREA Y02134 13400002
*                                                                       13500021
*        COMPUTE OFFSET FOR DEBVOLSQ REFERENCES                         13600021
*                                                                       13700021
         SR    RC,RC                    ZERO REG.                       13800021
         IC    RC,DEBNMEXT              PICK UP NO.EXTENTS              13900021
         SLL   RC,K4                    MPY BY 16-BYTES PER EXTENT      14100021
         AR    RC,RDEB                  ADD DEB BASE ADDRESS            14200021
*                                                                Y02134 14250002
         LA    RD,K1                    SET REG TO 1             Y02132 14300002
         LNR   RD,RD                    INDIC NO SPACE           Y02132 14350002
         TM    JFCBIND2,JFCMOD          IS IT AN OLD DATA SET           15300002
*                                       HI ORDER BITS OF JFCBIND2       15400002
*                                       01=OLD                          15450002
*                                       11=NEW                          15500002
*                                       10=MOD                          15600002
*                                                                       15700021
         BO    EDO02900                 NO GO GET SPACE ON THIS VOL     15800021
*                                                                       15800102
*        OLD DATA SET                                                   15800202
*                                                                       15800302
         CLC   JFCBNVOL,DXVOLSEQ+K1     CHECK FOR LAST VOL       Y02134 15900002
         BNH   EDO02900                 BRANCH IF LAST VOL       Y02134 16000002
         TM    DEBVOLSQ-DEBACSMD+DEBSUCBA-DEBTCBAD(RC),JFCMOD  @ZA06676 16100037
*                                       TREAT AS NEW ON?       @ZA06676 16150037
         BZ    EDO03515                 NO,DETERMINE DISPO-5F    YM3862 16200002
         EJECT                                                          16300002
EDO02900 EQU   *                        GET SPACE ON THIS VOLUME        16700002
*                                                                Y02134 16750002
*****************************************************************Y02134 16760002
*                                                                Y02134 16770002
*        SET REGISTER RD = 1 - INDICATOR TO GET SPACE            Y02134 16780002
*                              ON SAME VOLUME                    Y02134 16790002
*                                                                Y02134 16792002
*****************************************************************Y02134 16794002
*                                                                Y02134 16796002
         LA    RD,K1                    GET SPACE ON CURRENT VOL Y02134 16798802
         B     EDO02920                 EXTEND ON CURRENT VOL    Y02134 16799202
*                                                                Y02134 16799602
EDO02910 EQU   *                        RET=8 - FROM IFG0554C    Y02134 16799702
*                                                                Y02134 16809502
*****************************************************************Y02134 16813902
*                                                                Y02134 16818302
*        SET REGISTER RD = 4 - INDICATOR TO GET SPACE            Y02134 16822702
*                              ON NEXT (CURRENT NOW) VOLUME      Y02134 16827102
*                                                                Y02134 16831502
*****************************************************************Y02134 16835902
*                                                                Y02134 16840302
         OC    JFCBSQTY(K3),JFCBSQTY    IS SECONDARY QTY SPEC. @ZA12174 16841337
         BZ    EDO03650                 BRANCH IF NO           @ZA12174 16842337
         LA    RD,K4                    GET SPACE ON NEXT VOLUME Y02134 16844702
         B     EDO03300                 BRANCH TO EXTEND         Y02134 16849102
         EJECT                                                          16853502
EDO02920 EQU   *                        SEE IF SPACE CAN BE      Y02134 16857902
*                                       OBTAINED ON THIS VOLUME  Y02134 16862302
         CLI   DEBNMEXT,K16             CHECK FOR 16 EXTENTS            16866702
         BNL   EDO03515                 BRANCH IF 16 OR MORE     Y02134 16900002
*                                                                Y02134 16950002
EDO03000 EQU   *                        CHECK SECONDARY QUANTITY        17000002
*                                                                Y02134 17050002
         OC    JFCBSQTY(K3),JFCBSQTY    IS SECONDARY QTY SPECIFIED      17100021
         BZ    EDO03650                 BRANCH IF NO SPACE SPEC  Y02134 17160002
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         YM7888 17210002
         BO    EDO03515                 BR IF YES                YM7888 17260002
*                                                                Y02134 21650002
EDO03300 EQU   *                        RET=16 - RETURN FROM B37 EXIT   22100002
*                                                                Y02134 22150002
*        EXTEND IGG0553A SAVES REGS 2-12                         Y02134 22200002
*                                                                Y02134 22300002
         ST    RES,DXWORK               SAVE RES POINTER         Y02134 22350002
         MVC   DXWORK1(K8),DXCCW12      SAVE RETURN INFORMATION  Y02134 22400002
         L     R5,DCBDEBAD              LOAD DEB ADDRESS         Y02134 24050002
         L     RA,DXUCBADR              LOAD UCB INTERFACE       Y02134 24060002
         LA    RWTG,DXXAREA             POINT TO WTG TABLE       Y02134 24110002
         MVC   DXXMODNM(K12),IGG0553A   EXTEND ROUTINE           Y02134 24150002
         OI    DXATEOV,DXATDADM         SHOW GOING TO EXTEND     Y02144 24150102
         MVI   DXEXTSW,CHAR00           ZERO EXTEND SWITCH       Y02082 24160102
*                                                                Y02134 24200002
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               Y02080 24450002
         EJECT                                                          24460002
*********************************************************************** 24600021
*                                                                Y02134 24650002
*        RETURN HERE FROM DADSM WITH RESULT INDICATED IN  RD            24700002
*        + INDICATES SPACE OBTAINED,  - INDICATES NO SPACE              24800021
*                                                                       24900021
*****************************************************************Y02134 24950002
*                                                                Y02134 24960002
EDO03500 EQU   *                        DADSM RETURN POINT              25000002
*                                                                Y02134 25050002
         NI    DXATEOV,ALLBITS-DXATDADM SHOW BACK FROM EXTEND    Y02144 25060002
         MVC   WTGMODNM,NAME554P        SET UP WTG NAME          Y02134 25150002
         STM   RTIOT,RC,DXREGSAV        RESTORE REGISTERS               25600021
         MVI   DXRESIND,K0              ZERO RESIDENT RTN SW    SA57998 25602002
         L     RES,DXWORK               RESTORE RES POINTER      Y02134 25610002
         MVC   DXCCW12(K8),DXWORK1      RESTORE RETURN INFO      Y02134 25650002
         SR    R0,R0                    ZERO REGISTER                   25700021
         ST    R0,DXCCW6                ZERO RESIDENT RTN INDICATOR     25800021
*                                                                       26500021
*****************************************************************Y02134 27500002
*                                                                       27700021
*                        CHECK IF SPACE AVAILABLE                       27800021
*                                                                       27900021
*****************************************************************Y02134 27950002
*                                                                Y02134 27960002
EDO03502 EQU   *                        IS RD POSITIVE           Y02132 27960202
         LTR   RD,RD                    SET CONDITION CODE              28000021
*                                                                Y02134 28050002
*****************************************************************Y02134 28060002
*                                                                       28100021
*        ON RETURN FROM EXTEND ROUTINE, RD IS POSITIVE           Y02134 28200002
*        IF SPACE WAS OBTAINED AND NEGATIVE IF NOT.                     28300021
*                                                                       28400021
*****************************************************************Y02134 28450002
*                                                                Y02134 28452002
         BP    EDO03560                 CHECK DADSM RETURN CODE  Y02134 28460002
*                                                                Y02134 28560002
         LPR   RD,RD                    GET POSITIVE VALUE       Y02134 28562002
         BCT   RD,EDO03520              BRANCH, COUNT NOT ONE    Y02134 28564002
         EJECT                                                          28566002
*****************************************************************Y02134 28568002
*                                                                Y02134 28568402
*        UNABLE TO OBTAIN SPACE ON CURRENT VOLUME - RD = -1      Y02134 28568502
*                                                                Y02134 28568802
*****************************************************************Y02134 28569202
*                                                                Y02134 28569602
EDO03515 EQU   *                        MORE VOLUMES AVAILABEL   Y02134 28588802
*                                                                Y02134 28590002
         TM    DXXPATHS,WTGSMF          TEST FOR SMF             Y02134 28590102
         BNO   EDO03516                 GO TO USER LABEL ROUTINE Y02134 28590202
*                                                                Y02134 28590302
         LA    RET,K4                   SET UP ENTRY OFFSET      YM6729 28590602
         MVC   DXRETMOD,ID4P4Z          RETURN FOR USER LBLS     Y02134 28591002
         LA    R7,ID4P3B                SMF ROUTINE              Y02134 28591402
         B     EDO03790                 GO TO SMF ROUTINE        Y02134 28591502
*                                                                Y02134 28591902
EDO03516 EQU   *                        UPDATE CURR VOL'S DSCB,  Y02134 28592002
*                                       CHECK FOR USER LABELS    Y02134 28592102
         LA    RET,K0                   SET UP RETURN OFFSET     Y02134 28592802
         LA    R7,ID4P4Z                USER LABEL PROCESSING    Y02134 28592902
         B     EDO03790                 PROCESS USER LABELS      Y02134 28593002
         EJECT                                                          28593102
EDO03520 EQU   *                        -4,-8,-12,-16 FR DADSM @Z40RSDH 28593208
*                                                                Y02134 28593402
         LA    RD,K1(RD)                INCREMENT FOR BR TABLE   Y02134 28595202
EDO03530 EQU   *                        BRANCH TABLE             Y02134 28596002
         B     EDO03530(RD)             RD WILL NEVER BE ZERO    Y02134 28596402
         B     EDO03655                 RD=4 NO SPACE ON NEW   @ZA15053 28596837
*                                       VOLUME                 @ZA15053 28597437
         B     EDO03670                 RD=8 VTOC NOT CONVERTED  Y02134 28598002
         B     EDO03590                 RD=12 RACDEF ERROR     @Z40RSDH 28598408
         B     EDO03640                 RD=16 EXTEND I/O ERROR   Y02134 28599202
*                                                                Y02134 28901602
*****************************************************************Y02134 28903602
*                                                                Y02134 28905602
*        SPACE HAS BEEN SUCCESSFULLY OBTAINED                    Y02134 28907602
*                                                                Y02134 28908002
*****************************************************************Y02134 28908402
*                                                                Y02134 28909602
EDO03560 EQU   *                        RD = 1, 4 FROM DADSM     Y02134 28919602
*                                                                Y02134 28929602
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP           SA59750 28931602
         BO    EDO03570                 BRANCH IF EXCP          SA59750 28932002
         TM    DCBCIND2,DCBC2PUT        EOV CALLED DURING CLOSE  M0050  28933602
         BNO   EDO03570                 BYPASS CLOSE/EOV BIT     M0050  28937602
*                                                                Y02134 28938002
         OI    DEBFLGS1,DEBF1CEV        INDICATE TO CLOSE THAT   Y02080 28938402
*                                       EOV WAS CALLED BY QSAM   M0050  28938802
*                                       EOB MODULE TO GET SPACE  M0050  28939202
*                                                                Y02134 28939302
EDO03570 EQU   *                        SEE IF 1 OR 4            M0050  28939402
*                                                                Y02134 28939902
         BCT   RD,EDO03580              BRANCH IF NEW VOLUME     Y02134 28940302
*                                                                Y02134 28941102
         B     EDO04000                 READ F1 DSCB FUNCTION    M0050  28958202
*                                                                Y02134 28959802
EDO03580 EQU   *                        RD = 4 - RETURN TO       M0050  28961802
*                                       DXRETMOD (IFG0554C)      Y02134 28963802
         XR    RET,RET                  CLEAR FOR IC INST        Y02134 28965802
         IC    RET,DXRETCOD             LOAD RETURN OFFSET       Y02134 28966202
         LA    R7,DXRETMOD              POINT TO RETURN MODULE   Y02134 28979502
         B     EDO03790                 RETURN                   Y02134 29006902
*                                                              @Z40RSDH 29007108
EDO03590 EQU   *                        RD = 12 RACDEF ERROR   @Z40RSDH 29007308
         LA    R0,EABD005               937-38 TO PROB DET     @Z40RSDH 29007508
         B     EDO03680                 ABEND                  @Z40RSDH 29007708
         EJECT                                                          29020202
*****************************************************************Y02134 29033502
*                                                                Y02134 29046802
*        ERROR EXITS                                             Y02134 29060102
*                                                                Y02134 29073402
*****************************************************************Y02134 29086702
*                                                                Y02134 29100002
EDO03640 EQU   *                        737-4 TO PROB. DET.      Y02134 30604002
         LA    R0,EABD190               I/O ERROR ON R/W DSCB    Y02134 30610002
*                                       IN EXTEND                Y02134 30612002
         B     EDO03680                 ISSUE 737 ABEND          Y02134 30620002
*                                                                Y02134 30650002
EDO03650 EQU   *                        D37-4 TO PROB. DET.             30700002
         LA    RC,EABD186               D37 ABEND              @ZA02218 30750437
*                                       NO SECONDARY SPACE SPEC  Y02134 30750802
         LA    R7,ID4P4T                D37/E37 ABEND ROUTINE  @ZA02218 30751237
         B     EDO03790                 BRANCH TO IFG0554T     @ZA02218 30752037
*                                                                       30760037
EDO03655 EQU   *                        E37-8 TO PROB. DET.    @ZA15053 30760637
         LA    RC,EABD183               SPACE NOT AVAIL. OR    @ZA15053 30761237
*                                       DUP. NAME ON NEW VOL   @ZA15053 30761837
         B     EDO03665                 ISSUE E37-8 ABEND      @ZA15053 30762437
*                                                              @ZA15053 30763037
*                                       R14 = 12                        30764002
*                                       RETURN FROM SMF PROCESSING      30766002
EDO03660 EQU   *                        E37-4 TO PROB DET.       Y02134 30770002
         LA    RC,EABD184               E37 FAIL TO EXTEND     @ZA02218 30790037
*                                       ALL VOL USED             Y02134 30790402
EDO03665 CLC   DXVOLSR2,SCRTCH          NONSPECIFIC REQUEST?   @ZA15053 30790837
         BE    EDO03700                 BR TO GET NEW VOL      @ZA02218 30790937
         LA    R7,ID4P4T                D37/E37 ABEND ROUTINE  @ZA02218 30791037
         B     EDO03790                 BRANCH TO IFG0554T     @ZA02218 30791237
*                                                                Y02134 30793202
EDO03670 EQU   *                        B37-8 TO PROB DET        Y02134 30794002
         LA    R0,EABD177               B37 ABEND                Y02134 30796402
*                                       UNABLE TO MOUNT NEW VOL. Y02134 30796802
         B     EDO03680                 BR TO PROB DET         @ZA02218 30797237
EDO03680 EQU   *                        GO TO PROB DETERMINATION Y02134 30825537
*                                                                Y02134 30839102
         CLC   DXVOLSR2,SCRTCH          NONSPECIFIC REQUEST     ZA01265 30841102
         BE    EDO03700                 BRANCH TO GET NEW VOL   ZA01265 30841602
         NI    DCBOFLGS,ALLBITS-DCBOBUSY  TURN OFF BUSY BIT      Y02134 30859402
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              30879702
         LA    RWTG,DXXAREA             POINT TO EOV WTG                30900021
         DMABCOND (0),ID4P0P            LOAD ERROR CODE          Y02134 31000002
         SPACE 2                                                        31050002
*                                                               ZA01265 31050502
EDO03700 EQU   *                        REJECT CURRENT VOL      ZA01265 31051002
*                                                               ZA01265 31051102
*        IFG0554A SAVED PREV RETMOD/RETCOD IN SAVEMOD/SAVEOFF   ZA01265 31051202
         MVC   DXRETMOD,DXSAVMOD        RESTORE TO PREV RETMOD  ZA01265 31051302
         MVC   DXRETCOD,DXSAVOFF        RESTORE TO PREV RETCOD  ZA01265 31051402
         LA    RET,K16                  LOAD REJECT OFFSET      ZA01265 31051902
         LA    R7,ID4P4A                NEW VOL MOUNT ROUTINE   ZA01265 31052002
*                                                                Y02134 31052402
EDO03790 EQU   *                        EXIT TO NEXT MODULE      Y02134 31450002
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN       Y02134 31460002
         LA    RWTG,DXXAREA             POINT TO EOV WTG         Y02134 31470002
         IECRES LOAD,MODID=(R7),BRCODE=(RET),BRANCH=QUEUED       Y02080 31480002
         EJECT                                                          31492002
*********************************************************************** 31500021
*                                                                       31550002
*        RET = 4 ENTRY POINT                                            31560002
*        RETURN FROM IFG0554N OR IFG0554Z                               31570002
*                                                                Y02134 31600002
*        NEW VOLUME MOUNTING FUNCTION                            Y02134 31650002
*                                                                Y02134 31660002
*        DECREMENT DM COUNT IF MORE VOLUMES ARE SPECIFIED               31900002
*                                                                       32000021
*****************************************************************Y02134 32050002
*                                                                       32050402
EDO03800 EQU   *                        DECREMENT D.M. COUNT     YM6520 32052002
         XR    RET,RET                  CLEAR REG FOR IC INST  @ZA18328 32054008
         IC    RET,JFCBNVOL             GET NUMBER OF VOLUMES  @ZA18328 32057008
         CH    RET,DXVOLSEQ             CHECK FOR MORE VOLUMES @ZA18328 32060008
         BH    EDO03804                 BRANCH IF MORE VOLUMES @ZA18328 32063008
         OC    JFCBSQTY(K3),JFCBSQTY    SECONDARY QTY SPEC?    @ZA18328 32066008
         BZ    EDO03650                 ABEND IF NOT SPECIFIED @ZA18328 32069008
*                                                              @ZA18328 32072008
EDO03804 EQU   *                                               @ZA18328 32075008
*                                                                YM6520 32078002
         TM    DSCFILTY,DCBORGPO        IS THIS A PARTITIONED    YM6520 32080002
*                                       DATA SET                 YM6520 32082002
         BO    EDO03660                 ABEND IF YES, NO SUCH    YM6520 32084002
*                                       THING AS MULTIVOLUME PDS YM6520 32086002
         EJECT                                                          32088002
         L     RF,DXXPREFX              GET PREFIX ADDR          YM3868 32105002
         USING IECPREFX,RF              USING FOR PREFIX         YM3868 32110002
         STM   RB,RET,IECREGSV          SAVE SETLOCK REGS        YM3868 32115002
         MODESET EXTKEY=SUPR            SETLOCK KEY              YM3868 32120002
EDO03805 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  YM3868*32125002
               RELATED=(LOCAL,IFG0554P(EDO03817)) GET LOCAL LOCK YM3868 32130002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM3868 32135002
         LM    RB,RET,IECREGSV          RESTORE REGS             YM3868 32140002
*                                                                Y02134 32150002
         L     RUCB,DXUCBADR            GET UCB ADDR             Y02134 32150402
         LA    RF,K1                    LOAD DECREMENT VALUE     Y02134 32152002
*        SHIFT DECREMENT TO USE WITH CS INSTRUCTION              Y02134 32154002
         SLL   RF,K24-(K8*((UCBDMCT-UCB)-(((UCBDMCT-UCB)/4)*4))) Y02134 32156002
         L     R0,UCB+(((UCBDMCT-UCB)/K4)*K4) ALLIGN & LOAD WORD Y02134 32158002
EDO03810 EQU   *                        SWAP IN UPDATED COUNT    Y02134 32158802
*                                                                Y02134 32159202
         LR    RET,R0                   SAVE CS OPERAND          Y02134 32159602
         SLL   RET,K25                  LEAVE ONLY UCBDMCT COUNT Y02134 32159702
         LTR   RET,RET                  TEST FOR COUNT OF 0      Y02134 32159802
         BZ    EDO03815                 BRANCH IF ALREADY 0      YM3931 32159902
*                                                                Y02134 32163202
         LR    R1,R0                    LOAD OLD VALUE TO MODIFY Y02134 32165202
         SR    R1,RF                    ADD DECREMENT TO COUNT   Y02134 32165602
*                                                                Y02134 32166002
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 32166402
         CS    R0,R1,UCB+(((UCBDMCT-UCB)/K4)*K4) STORE NEW COUNT Y02134 32166502
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 32166602
         BNE   EDO03810                 BRANCH IF NOT THE SAME   Y02134 32166702
         OI    DXATEOV,DXATNVOL         INDIC CURR UNIT INACTIVE YM6520 32168702
         TM    UCBJBNR,UCBVRDEV         IS IT VIO UNIT           YM3868 32170102
         BZ    EDO03815                 BRANCH IF NO             YM3868 32170202
         EJECT                                                          32170902
*                                                                       32172902
*        VIO UNIT - WICLOSE IF DATA MANAGEMENT COUNT NOW ZERO           32173302
*                                                                       32173702
         SLL   R1,K25                   GET COUNT IN REG         YM3868 32173902
         LTR   R1,R1                    IS COUNT ZERO            YM3868 32174602
         BNZ   EDO03815                 BRANCH IF NOT            YM3868 32175302
         LA    R1,VDSUCB-VDSCB(,RUCB)   GET VDSCB ADDR           YM3868 32176002
         L     RD,DXXPREFX              GET PREFIX ADDR          YM3868 32176702
         LA    RD,IECREGSV-IECPREFX(,RD) GET REG SAVE AREA       YM3868 32177402
         MODESET EXTKEY=SUPR            GET IN KEY ZERO          YM3868 32178102
         WICLOSE VDSCB=(1)              WICLOSE DATA SET         YM3868 32178802
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM3868 32179502
EDO03815 EQU   *                        RELEASE LOCK             YM3868 32180202
         L     RF,DXXPREFX              GET PREFIX ADDR          YM3868 32180902
         STM   RB,RET,IECREGSV          SAVE MODESET REGS        YM3868 32181602
         MODESET EXTKEY=SUPR            GET IN KEY ZERO          YM3930 32182002
EDO03817 SETLOCK RELEASE,TYPE=LOCAL,    RELEASE LOCAL LOCK       YM3868*32182302
               RELATED=(LOCAL,IFG0554P(EDO03805))                YM3868 32183002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM3930 32183402
         LM    RB,RET,IECREGSV          RESTORE MODESET REGS     YM3868 32183702
         DROP  RF                                                YM3868 32184402
         EJECT                                                          32185802
EDO03820 EQU   *                        GET MAX(VOLCT, NVOL)     Y02134 32186502
*                                                                Y02134 32187202
         LH    R1,DXVOLSEQ              GET CURRENT SEQUENCE NO. Y02134 32249702
         LA    R1,K1(R1)                INCREMENT TO NEXT VOLUME Y02134 32299702
         STH   R1,DXVOLSEQ              SAVE SEQUENCE NUMBER     Y02134 32349702
*                                                                Y02134 32399702
         MVI   DXRETCOD,K8              SET UP OFFSET FOR 555H   Y02134 32449702
         MVC   DXRETMOD,ID4P5H          SAVE RETURN MODULE NAME  Y02134 32499702
*                                                                Y02134 32549702
         IECRES LOAD,MODID=ID4P4A,BRCODE=K0,BRANCH=QUEUED        Y02134 32599702
         SPACE 2                                                        32609702
*****************************************************************Y02134 32699702
*                                                                Y02134 32749702
*        READ F1 DSCB IF OBTAINED SECONDARY SPACE                YM6520 32799702
*        ON CURRENT VOLUME                                       YM6520 32803702
*                                                                Y02134 32849702
*****************************************************************Y02134 32899702
*                                                                Y02134 32949702
EDO04000 EQU   *                        USE DEB PREFIX BBCCHHR   Y02134 32999702
*                                                                Y02134 33049702
*****************************************************************Y02134 33149702
*                                                                Y02134 33199702
*        SET UP EXTENT TO COVER THE WHOLE DISK.                  Y02134 33249702
*                                                                Y02134 33299702
*****************************************************************Y02134 33349702
*                                                                Y02134 33399702
         XC    DXDEBSCC(K4),DXDEBSCC    EXTENT TO COVER DISK     Y02134 33549702
*                                                                Y02134 33599702
         L     RF,CVTPTR                GET CVT ADDR             Y02134 33649702
         L     RF,CVTZDTAB-CVT(,RF)     I/O DEVICE TABLE ADDRESS Y02134 33699702
*                                                                Y02134 33749702
         XR    R1,R1                    ZERO WORK REGISTER       Y02080 34149702
         IC    R1,UCBTBYT4              GET UCB DEVICE TYPE      Y02134 34199702
         IC    R1,0(R1,RF)              INDEX TO DEVICE OFFSET   Y02134 34249702
         AR    RF,R1                    ADDR OF DEVICE ENTRY     Y02134 34299702
         MVC   DXDEBECC(K4),0(RF)       SET MAX EXTENT FROM TBL  Y02134 34349702
         MVC   DXCCW8(K4),0(RF)         SAVE MAX PACK EXTENTS    Y02082 34399702
*                                                                Y02134 34449702
         MVC   DXDEBNTR,ODA0660K        SET TRACKS TO LARGEST NO Y02134 34499702
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 UCB ADDRESS TO DEB    Y02134 34549702
         XC    DXDEBBIN,DXDEBBIN        ZERO OUT BIN NUMBER      Y02134 34599702
         EJECT                                                          34609702
*****************************************************************Y02134 34649702
*                                                                Y02134 34699702
*        CONSTRUCT CHANNEL PROGRAM TO READ DSCB DIRECTLY         Y02134 34749702
*        SEARCH ID EQ                                            Y02134 34799702
*        TIC *-8                                                 Y02134 34849702
*        SEARCH KEY EQ                                           Y02134 34899702
*        NOP  (NO CHAIN BIT, SLI)                                Y02134 34949702
*        READ DATA (DSCB)                                        Y02134 34999702
*                                                                Y02134 35049702
*        CHANNEL PROGRAM TO READ FORMAT 4 IS CORRECT TO READ     Y02082 35099702
*        FORMAT 1 EXCPT THE SEARCH KEY EQUAL MUST SEARCH ON 44   Y02082 35149702
*        BYTES OF THE JFCB DSNAME AND OMIT THE SLI BIT           Y02082 35199702
*                                                                Y02134 35249702
*****************************************************************Y02134 35299702
*                                                                Y02082 35349702
         LR    R8,RDEB                  GET DEBBASIC            ZA01265 35351702
         LA    RF,DEBBASIC-DEB          GET OFFSET TO PREFIX    ZA01265 35352202
         SR    R8,RF                    GET PTR TO PREFX        ZA01265 35352702
         MVC   DXDAADDR+K1(K7),DEBDSCBA-DEB(R8)  BBCCHHR OF     ZA01265 35359702
*                                              DSCB TO SEE WRD   Y02134 35369702
         MVI   DXDAADDR,K0              SET-M- TO ZERO           Y02134 35379702
         XC    DXCCW1(K40),DXCCW1       CLEAR AREA (5 CCWS)      Y02134 35399702
         LA    RF,DXDAADDR+K3           SEARCH ADDRESS           Y02134 35449702
         ST    RF,DXCCW1                                         Y02134 35499702
         LA    RF,DXCCW1                TIC ADDRESS              Y02134 35549702
         ST    RF,DXCCW2                                         Y02134 35599702
         LA    RF,DXDSCB                LOAD POINTER TO BUFFER   Y02134 35699702
         ST    RF,DXCCW5                                         Y02134 35749702
         MVI   DXCCW3+K7,L'JFCBDSNM     COUNT OF 44              Y02082 35999702
         LA    RF,JFCBDSNM              DATA SET NAME KEY ADDR   Y02082 36099702
         ST    RF,DXCCW3                STORE KEY ADDR IN CCW    Y02134 36149702
         OC    DXCCW1(K40),ODA0640K     CMND CODE, FLAGS, LENGTH Y02134 36159702
*                                                                Y02082 36249702
         EXCP  DXIOB                    READ DSCB VIA EXCP       Y02134 36299702
*                                                                Y02134 36349702
         IECRES WAIT                    WAIT FOR READ TO FINISH  Y02134 36399702
*                                                                Y02134 36449702
         TM    DXECB,ECBNOERR           CHECK FOR IO ERROR       Y02134 36499702
         BZ    EDO03640                 BRANCH IF I/O ERROR      Y02134 36549702
*                                                                Y02134 36599702
         LA    RF,DXCCW6                TEST IF CHANNEL PROGRAM  Y02134 36649702
         L     R1,IOBCOMAD              TERMINATED AFTER READ    Y02134 36699702
         LA    R1,0(R1)                 CCW BY EXAMINING CSW     Y02134 36749702
         CR    R1,RF                    STORED IN IOB            Y02134 36799702
         BNE   EDO03640                 BRANCH IF ERROR          Y02134 36849702
*                                                                Y02134 36899702
         LA    RB,DXDSCB                LOAD POINTER TO DSCB     Y02134 36949702
         EJECT                                                          37099702
*****************************************************************Y02134 37149702
*                                                                Y02134 37199702
*        CHECK FOR MORE DSCB'S.                                  Y02134 37249702
*                                                                Y02134 37299702
*****************************************************************Y02134 37349702
*                                                                Y02134 37359702
EDO04100 EQU   *                        READ FORMAT 3 IF THERE   Y02134 37369702
*                                                                Y02134 37399702
         NC    DSCNEXT-DXDSCB(L'DSCNEXT,RB),DSCNEXT-DXDSCB(RB)   Y02134 37449702
         BZ    EDO04200                 BRANCH IF NO MORE        Y02134 37499702
*                                                                Y02134 37549702
         MVC   DXDAADDR+K3(L'DSCNEXT),DSCNEXT-DXDSCB(RB) CCHHR   Y02134 37599702
*                                                                Y02134 37649702
         LA    R0,DSCBLNG+K4            LENGTH OF DSCB + PTR     Y02134 37699702
         IECRES GET,LV=(0),PREFIX=YES,STM=(2,14,DXXPREFX),       Y02144*37749702
               ID=DJWA                                           Y02144 37759702
*                                                                Y02134 37799702
         LA    R1,DXDSCB-DXDSCB(,R1)    CLEAR HIGH ORDER BYTE    Y02134 37849702
         ST    R1,CORECH(,RB)           CHAIN TO PREVIOUS CORE   Y02134 37899702
         LR    RB,R1                    LOAD DSCB BUFFER ADDR    Y02134 37949702
         EJECT                                                          37999702
*****************************************************************Y02134 38049702
*                                                                Y02134 38099702
*        MODIFY CCW TO READ NEXT FORMAT 2 OR 3 DSCB KEY & DATA   Y02134 38149702
*                                                                Y02134 38199702
*        SEARCH ID EQ                                            Y02134 38249702
*        TIC *-8                                                 Y02134 38299702
*        READ KEY & DATA                                         Y02134 38349702
*                                                                Y02134 38399702
*****************************************************************Y02134 38449702
*                                                                Y02134 38499702
         LA    RC,DSCBLNG               LENGTH OF DSCB KEY+DATA  Y02134 38549702
         STM   RB,RC,DXCCW3             DSCB BUFFER & LENGTH     Y02134 38599702
         MVI   DXCCW3,CCWRDKEY          READ KEY & DATA CMND     Y02134 38649702
         LA    RB,L'JFCBDSNM(,RB)       INCREMENT PASSED KEY     Y02134 38699702
*                                                                Y02134 38749702
         EXCP  DXIOB                    READ FORMAT 2 OR 3 DSCB  Y02134 38799702
*                                                                Y02134 38849702
         IECRES WAIT                    WAIT FOR READ COMPLETE   Y02134 38899702
*                                                                Y02134 38949702
         TM    DXECB,ECBNOERR           CHECK FOR I/O ERROR      Y02134 38999702
         BNO   EDO03640                 BRANCH IF ERROR          Y02134 39049702
         B     EDO04100                 BRANCH IF NO ERROR       Y02134 39099702
*                                                                Y02134 39109702
EDO04200 EQU   *                        BUILD NEW DEB IN 555H    Y02134 39119702
*                                                                Y02134 39129702
         L     RDEB,DCBDEBAD            RESTORE DEB POINTER      Y02134 39179702
         LA    R7,ID4P5H                LOAD IFG0555H ADDRESS    Y02134 41199702
         LA    RET,K12                  IFG0555H ENTRY OFFSET    Y02134 41249702
         B     EDO03790                 BRANCH TO IFG0555H       Y02134 41269702
         EJECT                                                          41299702
*                                                                       41349702
*        CONSTANTS                                                      41399702
*                                                                       41449702
SCRTCH   DC    CL6'SCRTCH'              SCRTCH REQUEST NAME      Y02134 42249702
*                                                                Y02134 42299702
*        CCW'S TO READ FORMAT 1 OR 4 DSCB DIRECTLY.              Y02134 42349702
*                                                                Y02134 42399702
ODA0640K DC    X'3100000040000005'      SEARCH ID EQ             Y02134 42449702
         DC    X'0800000000000000'      TIC *-8                  Y02134 42499702
         DC    X'290000004000002C'      SEARCH KEY EQ            Y02134 42549702
         DC    X'0300000020000001'      NOP  (NO CHAIN, SLI)     Y02134 42599702
         DC    X'0600000000000060'      READ DATA (DSCB)         Y02134 42649702
*                                                                Y02134 42699702
ODA0660K DC    X'7FFF'                  MAX NO. TRACKS IN EXTENT Y02134 42749702
         EJECT                                                          42799702
*                                                                       50900021
*          XCTL TABLE FOR IFG0554P                                      51000021
*                                                                       51100021
         XCTLTABL ID=(ID4P4P,4P,ID4P3B,3B,ID4P4Z,4Z,ID4P4A,4A,   Y02134X51450002
               ID4P5H,5H,ID4P0P,0P,ID4P4T,4T,                  @ZA02218X51460037
               NAME554P,IFG0554P,,IGG0553A),                     Y02134X51470002
               SVC=055,BRT=YES,LENGTH=                           Y02134 51472002
*                                                                Y02134 51480002
         IECDSECS CVT,TIOT,DCB,IEZDEB,UCB,MAIN,WTG,PREFX,PSA,   ZA01265*51500002
               EXPAND=YES                                        YM3868 51500102
         IDDVDSCB                                                YM3868 51500202
         IECEQU IEZDEB=YES                                      ZA01265 51550002
         END                                                            51700021
./  ADD  SSI=80370400,NAME=IFG0554T
         TITLE 'IFG0554T- END OF VOLUME ABEND B37 HANDLING LOAD'        00200021
IFG0554T CSECT                                                          00300002
*********************************************************************** 00350002
*                                                                     * 00400002
*          VS2 RELEASE 037 DELETIONS/CHANGES                          * 00450037
*                                                                     * 00450637
*A606010,606020                                                @ZA18533 00451237
*A603300,C602800,D606000                                       @ZA26360 00451537
*                                                                     * 00451837
*          VS2 RELEASE 030 DELETIONS/CHANGES                          * 00452437
*0000009000,013300,014500,018500,023500,033000,144900          @ZA02218 00453037
*304000-306000                                                 @ZA02218 00454037
*0000                                                          @ZA05438 00455037
*000352500                                                     @ZA08028 00456037
*0000                                                          @ZA12209 00458037
*A000350500,351000,353000                                      @ZA10234 00459037
*          VS2 RELEASE 03 DELETIONS                                   * 00460002
*0000180925,181150,182875,183100                                ZA00019 00470002
*          VS2 RELEASE 02 DELETIONS                                   * 00500002
*                                                                     * 00550002
*                                                                     * 00600002
*********************************************************************** 00650002
*                                                                     * 00700002
* MODULE NAME = IFG0554T (OS/VS2)                                     * 00750002
*                                                                     * 00800002
* DESCRIPTIVE NAME =                                                  * 00850002
*        END OF VOLUME ABEND B37/D37/E37 HANDLING LOAD                * 00900037
*                                                                     * 00950002
* COPYRIGHT = NONE                                                    * 01000002
*                                                                     * 01050002
* STATUS = RELEASE 2, LEVEL 0                                         * 01100002
*                                                                     * 01150002
* FUNCTION =                                                          * 01200002
*        ENTERED FROM IFG0554A WHEN NO VOLUME COULD BE DISMOUNTED     * 01250002
*        TO MOUNT ANOTHER VOLUME.                                     * 01300002
*                                                                     * 01302502
*        THE OLD VOLUME'S UNIT HAS ALREADY HAD ITS DATA               * 01305002
*        MANAGEMENT USE COUNT DECREMENTED, AND THE VOLUME MAY         * 01307502
*        NO LONGER BE MOUNTED.                                        * 01310002
*        DXVOLSEQ IS THE VOLUME SEQUENCE OF THE NEXT VOLUME           * 01312502
*        WHICH COULD NOT BE MOUNTED. THE COUNT WILL BE                * 01315002
*        DECREMENTED BY ONE AND USED TO LOCATE THE PREVIOUS           * 01317502
*        VOLUME'S VOLSERNO.                                           * 01320002
*        IF THIS VOLUME IS STILL MOUNTED ON THE UNIT WHICH THE        * 01322502
*        DEB IS OPEN TO, ITS DATA MANAGEMENT COUNT WILL BE            * 01325002
*        INCREMENTED SO THAT IT MAY BE ACCESSED.                      * 01327502
*        OTHERWISE AN IMMEDIATE B37/D37/E37 ABEND WILL BE ISSUED, AS  * 01330037
*        THE DSCB ON THE OLD VOLUME CAN NOT BE UPDATED.               * 01332502
         EJECT                                                          01350002
*        PROBLEM DETERMINATION IS GIVEN CONTROL WITH INTERNAL ABEND   * 01400002
*        CODE 184 TO ISSUE A E37-4 ABEND, 185 TO ISSUE A B37-4 ABEND  * 01410037
*        OR 186 TO ISSUE A D37-4 ABEND IF ANY OF THE                  * 01450037
*        FOLLOWING CONDITIONS OCCUR -                                 * 01460002
*        1) EXCP DCB.                                                 * 01500002
*        2) DSORG IS NOT PS.                                          * 01550002
*        3) THE WRITE (BSAM) OR PUT (QSAM) BITS ARE NOT ON IN         * 01600002
*        DCBMACRF.                                                    * 01650002
*        4) NO 08 EXIT LIST ADDRESS IS PRESENT IN THE DCB EXIT LIST,  * 01700002
*        OR THERE IS NO EXIT LIST ADDRESS.                            * 01750002
*        5) THE OLD VOLUME IS NO LONGER MOUNTED ON THE DEB'S          * 01752502
*        UNIT, OR ITS DATA MANAGEMENT COUNT COULD NOT BE              * 01755002
*        INCREMENTED.                                                 * 01757502
*                                                                     * 01800002
*        IF NONE OF THE ABOVE CONDITIONS EXIST AND                    * 01810002
*        IF THE DEB HAS LESS THAN 16 EXTENTS THE X37 ABEND EXIT IS    * 01850037
*        TAKEN AND THE VALUE RETURNED IN REGISTER 15 IS USED TO       * 01900002
*        DETERMINE THE ACTION TO BE TAKEN. THE RETURN CODE  AND THE   * 01950002
*        ACTION IS BELOW. IF THE DEB HAS 16 EXTENTS OR VIO IS USED,   * 02000002
*        THE EXIT IS NOT TAKEN BUT ACTION IS TAKEN AS IF IT WERE      * 02050002
*        AND A RETURN CODE OF 1 WERE RETURNED.                        * 02100002
*                                                                     * 02150002
*        0 - MODULE IFG0554P IS GIVEN CONTROL WITH 16 IN REGISTER     * 02200002
*        14 AND 1 IN REGISTER 13. THIS WILL CAUSE IFG0554P TO CALL    * 02250002
*        DADSM EXTEND FOR THE CURRENT VOLUME AND ONCE AGAIN TRY TO    * 02300002
*        OBTAIN SPACE ON THE VOLUME. HOWEVER, IF D37 ABEND PROCESSING * 02350037
*        IS BEING PERFORMED, THE X37 ABEND EXIT WILL BE TAKEN AGAIN.  * 02360037
*        IF A RETURN CODE OF 0 IS AGAIN RETURNED, THIS RETURN CODE    * 02360437
*        WILL BE IGNORED AND A RETURN CODE OF 2 WILL BE ASSUMED.      * 02370037
*                                                                     * 02400002
*        1 - THE FORMAT 1 DSCB FOR THE DATA SET IS READ AND IT IS     * 02450002
*        UPDATED. THE TTR OF THE LAST RECORD ON THE VOLUME IS         * 02500002
*        OBTAINED FROM DCBFDAD, THE TRACK BALANCE IS OBTAINED FROM    * 02550002
*        DCBTRBAL. THESE ARE PLACED IN THE DSCB AND IT IS REWRITTEN.  * 02600002
*        ALL THE BSAM/QSAM IOBS WILL GET THE UNIT EXCEPTION BIT IN    * 02650002
*        THE CSW TURNED OFF. THE FEOV BIT IN THE DCB IS TURNED OFF.   * 02700002
*        IF A SYNAD ADDRESS IS NOT PRESENT OR IF CLOSE CALLED EOV,    * 02750002
*        AN 001 ABEND IS ISSUED. OTHERWISE THE EOV WORKAREAS ARE      * 02800002
*        FREED, THE USER'S DCB IS REFRESHED FROM THE COPY, AND THE    * 02850002
*        ACCESS METHOD CALLER OF EOV IS RETURNED CONTROL TO PASS      * 02900002
*        CONTROL TO THE USER'S SYNAD ROUTINE. REGISTERS 0 AND 1 ARE   * 02950002
*        PASSED TO THE ACCESS METHOD CALLER OF EOV, AND, IN TURN, TO  * 03000002
*        THE SYNAD ROUTINE INDICATING AN OUTPUT ERROR, NO SPACE       * 03050002
*        AVAILABLE.                                                   * 03100002
*                                                                     * 03150002
*        2 -THE DSCB IS UPDATED AS FOR RETURN CODE 1, ABOVE, AND      * 03200002
*        PROBLEM DETERMINATION IS GIVEN CONTROL TO ISSUE A            * 03250002
*        B37-4, D37-4 OR E37-4 ABEND.                                 * 03300037
         EJECT                                                          08300002
* NOTES =                                                             * 08350002
*        WHEN THIS MODULE EXITS TO THE ACCESS METHOD CALLER OF EOV    * 08400002
*        IN ORDER TO PASS CONTROL TO THE USER'S SYNAD ROUTINE, THE    * 08450002
*        REGISTERS WHICH WILL BE PASSED TO THE ACCESS METHOD AND TO   * 08500002
*        THE SYNAD ROUTINE ARE THE USER'S REGISTERS AS A REGISTER     * 08550002
*        SWAP HAS BEEN PERFORMED IN THE FIRST LOAD OF EOV, IGC0005E.  * 08600002
*                                                                     * 08700002
*        THIS MODULE HAS AN ALIAS NAME OF IFG0554T.                   * 08800002
*                                                                     * 08900002
*    DEPENDENCIES =                                                   * 08950002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 09000002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 09050002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 09100002
*                                                                     * 09150002
*    RESTRICTIONS = NONE                                              * 09200002
*                                                                     * 09250002
*    REGISTER CONVENTIONS =                                           * 09300002
*            R2 POINTS TO DCB                                         * 09350002
*            R4 POINTS TO OPEN WORK AREA                              * 09400002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 09450002
*            R6 POINTS TO THE WTG TABLE                               * 09500002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 09550002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 09600002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 09650002
*            R10 POINTS TO THE UCB                                    * 09700002
*                                                                     * 09750002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 09800002
*                  END OF LISTING.                                    * 09850002
*                                                                     * 09900002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 09950002
*                                                                     * 10000002
*    PROCESSOR = ASSEMBLER XF                                         * 10050002
*                                                                     * 10100002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 10150002
*                  ORG STATEMENT AT END OF LISTING                    * 10200002
*                                                                     * 10250002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 10300002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 10350002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 10400002
*                                                                     * 10450002
* ENTRY POINT =                                                       * 10500002
*        IFG0554T                                                     * 10550002
*                                                                     * 10600002
*    PURPOSE = SEE FUNCTION                                           * 10650002
*                                                                     * 10700002
*    LINKAGE =                                                        * 10750002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 10800002
*        MACRO INSTRUCTION.                                           * 10850002
         EJECT                                                          10900002
* INPUT =                                                             * 10950002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 11000002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 11050002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 11100002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 11150002
*        REGISTER 12 CONTAINS THE INTERNAL ABEND CODE                 * 11160037
*        FOR EITHER A B37-4, D37-4 OR E37-4 ABEND.                    * 11170037
*                                                                     * 11200002
* OUTPUT =                                                            * 11500002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 11550002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 11600002
*        THE DEBDCBAD POINTING TO THE COPIED DCB,                     * 11650002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 11700002
*                                                                     * 11750002
*        IFG0554P -                                                   * 11800002
*        REGISTER 14 CONTAINS ENTRY CODE 16                           * 11850002
*        REGISTER 13 CONTAINS DADSM EXTEND INPUT 1.                   * 11900002
*                                                                     * 12850002
*        IFG0550P GIVEN CONTROL THROUGH DMABCOND MACRO -              * 12900002
*        REGISTER 0 CONTAINS INTERNAL ABEND CODE                      * 12950002
*                                                                     * 13000002
*        EXIT TO THE ACCESS METHOD CALLER OF EOV FOR HIM TO PASS      * 13050002
*        CONTROL TO THE USER'S SYNAD ROUTINE -                        * 13100002
*        REGISTER 15 CONTAINS SYNAD ROUTINE ADDRESS.                  * 13150002
*        REGISTER 1 CONTAINS THE DCB ADDRESS WITH SYNAD ERROR         * 13200002
*        INFORMATION (X'42) IN THE HIGH ORDER BYTE.                   * 13210002
*        REGISTER 0 CONTAINS THE DECB ADDRESS FROM THE IOB IN ERROR   * 13220002
*        FOR BSAM AND THE ADDRESS OF THE IOB IN ERROR WITH THE OFFSET * 13230002
*        INTO THAT IOB OF THE WRITE CCW IN THE HIGH ORDER BYTE FOR    * 13240002
*        QSAM.                                                        * 13242002
*                                                                     * 13250002
*        IFG0RR0B IS GIVEN CONTROL TO CONTINUE RECOVERY PROCESSING.   * 13260002
*        REGISTERS OF THE IFG0RR0B SUBROUTINE PASSING CONTROL TO      * 13270002
*        IFG0554T WILL BE RESTORED BEFORE RETURNING TO IFG0RR0B.      * 13280002
*                                                                     * 13290002
* EXIT-NORMAL =                                                       * 13300002
*        IFG0554P TO MAKE STILL ANOTHER ATTEMPT TO GET SPACE ON       * 13350002
*        THE CURRENT VOLUME.                                          * 13400002
*                                                                     * 13500002
*        IFG0RR0B TO CONTINUE RECOVERY PROCESSING.                    * 13600002
*                                                                     * 13700002
* EXIT-ERROR =                                                        * 13750002
*        IFG0550P GIVEN CONTROL THROUGH DMABCOND MACRO WITH AN        * 13800002
*        INTERNAL ABEND CODE IN REGISTER 0 -                          * 13850002
*        190 - 737-4 - I/O ERROR READING OR WRITING DSCB              * 13900002
*        186 - D37-4 - NO SECONDARY SPACE SUPPLIED.                   * 13950037
*        185 - B37-4 - NO VOLUME COULD BE DISMOUNTED ON WHICH TO      * 14000002
*        MOUNT ANOTHER VOLUME TO CONTINUE OUTPUT PROCESSING.          * 14050002
*        184 - E37-4 - NO MORE VOLUMES SPECIFIED IN JFCB (VOLUME      * 14060037
*        COUNT OR NUMBER OF VOLUMES REACHED).                         * 14070037
*                                                                     * 14100002
*        SYSTEM 001 ABEND ISSUED.                                     * 14150002
         EJECT                                                          14250002
* EXTERNAL REFERENCES = SEE BELOW                                     * 14300002
*                                                                     * 14350002
*    ROUTINES =                                                       * 14400002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 14450002
*                                                                     * 14460002
*        IECPRLTV - MBBCCHHR TO TTR CONVERT ROUTINE.                  * 14470002
*                                                                     * 14480002
*        B37/D37/E37 ABEND EXIT.                                      * 14490037
*                                                                     * 14500002
*    DATA AREAS =                                                     * 14550002
*        EOV WORKAREA.                                                * 14600002
*                                                                     * 14650002
*    CONTROL BLOCK =                                                  * 14700002
*        DCB                                                          * 14750002
*        CVT                                                          * 14850002
*        DEB                                                          * 15000002
*                                                                     * 15050002
* TABLES =                                                            * 15100002
*        DCB EXIT LIST.                                               * 15150002
*                                                                     * 15200002
* MACROS =                                                            * 15250002
*        MODESET                                                      * 15300002
*        IECRES-LOAD                                                  * 15350002
*        IECRES-FREE                                                  * 15360002
*        IECRES-EXIT                                                  * 15370002
*        IECRES-INIT                                                  * 15400002
*        IECRES-UEXIT                                                 * 15410002
*        ABEND                                                        * 15420002
*        EXCP                                                         * 15450002
*        WAIT                                                         * 15500002
*        DMABCOND                                                     * 15550002
*        XCTLTABL                                                     * 15600002
*        IECDSECS                                                     * 15650002
*        IECEQU                                                       * 15700002
*                                                                     * 15750002
* CHANGE ACTIVITY =                                                   * 15800002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 15850002
*                                                                     * 15900002
*********************************************************************** 15950002
         EJECT                                                          15960002
EABD185  EQU   185                      B37-4 INTERNAL ABEND CODE       16000002
EABD186  EQU   186                      D37-4 INTERNAL CODE    @ZA02218 16050037
EABD190  EQU   190                      737-4 INTERNAL ABEND CODE       16200002
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        16400021
         USING *,RBASE                                           YM3903 16450002
         USING FORCORE,RCORE                                            16600021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 16650002
         USING TIOENTRY,RTIOT                                           16800021
         USING UCB,RUCB                                                 17000021
         USING DEBBASIC,RDEB                                     YM1272 17200002
         USING DCBRELAD,RDCB                                            17400021
         L     RDEB,DCBDEBAD            GET DEB                  YM6520 17807502
         L     RUCB,DEBSUCBA            GET OLD UNIT             YM6520 17815002
         LA    RUCB,K0(,RUCB)           CLEAR HIGH BYTE          YM6520 17822502
         ST    RUCB,DXUCBADR            PLACE IN WORKAREA        YM6520 17830002
         LA    R1,EABD186               GET D37 ABEND CODE     @ZA02218 17832037
         CR    RC,R1                    D37 ABEND PROCESSING?  @ZA02218 17834037
         BE    EDO08400                 YES, BR TO CHECK FOR   @ZA02218 17836037
*                                       EXIT. BYPASS VOLUME    @ZA02218 17836437
*                                       MOUNT ROUTINE BECAUSE  @ZA02218 17836837
*                                       THE VOLUME IS STILL    @ZA02218 17837237
*                                       MOUNTED.               @ZA02218 17837337
*                                                                       17837502
*        LOCATE PREVIOUS VOLUME'S VOLSERNO USING DXVOLSEQ WHICH  YM6520 17845002
*        HAS BEEN INCREMENTED BY ONE IN ATTEMPTING TO MOUNT THE  YM6520 17852502
*        NEXT VOLUME.                                            YM6520 17860002
*                                                                       17867502
         LH    R1,DXVOLSEQ              NEW SEQUENCE             YM6520 17875002
         BCT   R1,EDO08310              BRANCH IF VOLSEQ NOT ONE YM6520 17882502
         B     EDO08875                 ABEND IF COUNT WAS ONE   YM6520 17890002
EDO08310 EQU   *                        R1 HAS OLD VOLUME SEQ    YM6520 17897502
         CH    R1,HWD5                  IS VOLSER IN JFCB        YM6520 17905002
         LA    RET,JFCBVOLS-K4          INITIALIZE IF IN JFCB    YM6520 17912502
         BNH   EDO08325                 BRANCH IF IN JFCB        YM6520 17920002
         LA    RET,JFCBEXAD             JFCB EXTENTION ADDR      YM6520 17927502
         SH    R1,HWD5                  REDUCE BY 5              YM6520 17935002
EDO08320 EQU   *                        CHECK NEXT EXTENTION     YM6520 17942502
         CLC   ADCON0,K0(RET)           IS THERE AN EXTENTION    YM6520 17944002
         BZ    EDO08875                 ABEND IF NOT             YM6520 17945502
         IECRES LOCJFCB,(RET)           LOCATE JFCB EXTENTION    YM6520 17950002
         CH    R1,HWD15                 IS VOLSER IN THIS EXT.   YM6520 17972502
         BNH   EDO08325                 BRANCH IF YES            YM6520 17980002
         SH    R1,HWD15                 REDUCE BY 15             YM6520 17987502
         B     EDO08320                 TRY NEXT ONE             YM6520 17995002
EDO08325 EQU   *                        GET VOLSER               YM6520 18002502
         BCTR  R1,0                     REDUCE BY 1              YM6520 18010002
         MH    R1,HWD6                  GET OFFSET               YM6520 18017502
         LA    RET,K4(R1,RET)           RET POINTS TO VOLSER     YM6520 18025002
         MVC   DXVOLSR1,K0(RET)         PUT VOLSER IN DXVOLSR1   YM6520 18032502
         EJECT                                                          18034002
*                                                                       18040002
*        ENSURE VOLUME IS STILL MOUNTED                          YM6520 18047502
*                                                                       18055002
         LA    RET,EDO08875             ABEND IF SUBSEQUENT ERR  YM6520 18062502
         L     RF,DXXPREFX              PREFIX ADDR              YM6520 18077502
         USING IECPREFX,RF              PREFIX ADDRESSABILITY    YM6520 18085002
         STM   R0,RET,IECREGSV          SAVE SETLOCK REGS       ZA00019 18092502
         MODESET EXTKEY=SUPR            SETLOCK KEY              YM6520 18094002
EDO08330 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *18100002
               RELATED=(LOCAL,IFG0554T(EDO08345)) GET LOCK       YM6520 18107502
         MODESET EXTKEY=DATAMGT         RETURN TO D. M. KEY      YM6520 18109002
         LM    R0,RET,IECREGSV          RESTORE SETLOCK REGS    ZA00019 18115002
         CLC   UCBVOLI,DXVOLSR1         IS VOLUME MOUNTED STILL  YM6520 18122502
         BNE   EDO08340                 BRANCH IF NO-ABEND       YM6520 18130002
         L     R0,UCB+(((UCBDMCT-UCB)/K4)*K4) ALIGN & LOAD WORD  YM6520 18137502
EDO08335 EQU   *                        INCREMENT D M COUNT      YM6520 18145002
         LR    RF,R0                    SAVE IN RF               YM6520 18152502
         SLL   RF,K25                   COUNT IN HIGH 7 BITS     YM6520 18160002
         SRL   RF,K25                   COUNT IN LOW 7 BITS      YM6520 18167502
         CLM   RF,B'0001',BYTE127       IS THERE 127 USERS       YM6520 18175002
         BNL   EDO08340                 BRANCH IF YES            YM6520 18182502
         LA    R1,K1                    INCREMENT VALUE          YM6520 18190002
         AR    R1,R0                    R1 HAS UPDATED WORD      YM6520 18197502
         EJECT                                                          18199002
         MODESET EXTKEY=SUPR            UCB KEY                  YM6520 18205002
         CS    R0,R1,UCB+(((UCBDMCT-UCB)/K4)*K4) UPDATE COUNT    YM6520 18212502
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         YM6520 18220002
         BNE   EDO08335                 TRY AGAIN-R0 IS RESET    YM6520 18227502
         NI    DXATEOV,X'FF'-DXATNVOL   INDICATE TO RECOVERY OLD YM6520 18242502
*                                       UNIT IS STILL ACTIVE     YM6520 18244002
         LA    RET,EDO08400             NORMAL RETURN            YM6520 18265002
EDO08340 EQU   *                        RLSE LOCK-RETURN ON RET  YM6520 18272502
         L     RF,DXXPREFX              PREFIX ADDRESS           YM6520 18280002
         STM   R0,RET,IECREGSV          SAVE SETLOCK REGS       ZA00019 18287502
         MODESET EXTKEY=SUPR            SETLOCK KEY              YM6520 18289002
EDO08345 SETLOCK RELEASE,TYPE=LOCAL,                                   *18295002
               RELATED=(LOCAL,IFG0554T(EDO08330)) RELEASE LOCK   YM6520 18302502
         MODESET EXTKEY=DATAMGT         RETURN TO D. M. KEY      YM6520 18304002
         LM    R0,RET,IECREGSV          RESTORE REGS            ZA00019 18310002
         BR    RET                      RETURN                   YM6520 18317502
*                                                                YM7099 18318002
*        RETURN TO IFG0RR0B                                      YM7099 18319002
*                                                                YM7099 18320002
EDO08360 EQU   *                                                 YM7099 18321002
         MVC   WTGMODNM,RECMOD          MOVE RECOVERY MOD NAME   YM7099 18322002
         L     RF,DXATCOM3              GET RRPLIST PTR          YM7099 18323002
         USING RRPLIST,RF                                        YM7099 18324002
         L     RF,RRFWORK               RECOVERY SUBRTN SAVEAREA YM7099 18325002
         L     RET,IECREGSV-IECEXTPR+K4*RET(,RF) GET RETURN ADDR YM7099 18327002
         ST    RET,WTGMODEP             SET EPA TO RETURN ADDR   YM7099 18328002
         LM    R0,RD,0(RF)              GET RECOVERY SUBRTN REGS YM7099 18329002
         IECRES LOAD,EXTPR=(RF),BRANCH=DIRECT RETURN TO IFG0RR0B YM7099 18330002
         EJECT                                                          18332502
         DROP  RF                                                YM6520 18340002
*                                                                       18400021
*        CHECK FOR DCB EXIT, IF NONE ISSUE B37 ABEND                    18400502
*                                                                       18402502
EDO08400 EQU   *                        ONLY LOOK IF BSAM/QSAM          18600002
         L     R1,WTGPREFX              GET BASE PREFIX ADDR     YM7099 18650002
         CLC   IECCORID-IECPREFX(K4,R1),RECCORID  RECOVERY ENTRY YM7099 18700002
         BE    EDO08360                 BRANCH IF RECOVERY ENTRY YM7099 18750002
         TM    DCBMACRF,DCBMEXCP        CHECK FOR EXCP                  18800021
         BO    EDO08875                 IF EXCP, IMMEDIATE ABEND YM6520 19000002
         TM    DCBDSORG,DCBORGPS        IS THIS PHYSICAL SEQ.           19200021
         BZ    EDO08875                 NO, IMMEDIATE ABEND      YM6520 19400002
         TM    DCBMACRF+K1,DCBMPUT+DCBMWRIT  QSAM (PUT) OR              19600021
*                                            BSAM (WRITE) DCB           19800021
         BZ    EDO08875                 NO, IMMEDIATE ABEND      YM6520 20000002
*                                                                       20200021
*                        CHECK FOR DCB EXIT                             20400021
*                                                                       20600021
         L     R1,DCBEXLST              EXIT LIST = 0 OR 1              20800021
         LA    R1,K0(,R1)                                               21000021
         LA    R0,K1                                                    21200021
         CR    R1,R0                                                    21400021
         BNH   EDO08875                 NO EXIT LIST SPECIFIED          21600002
         SR    RD,RD                    SET FIRST PASS SW FOR  @ZA02218 21650037
*                                       D37 ABEND PROCESSING   @ZA02218 21700037
EDO08600 EQU   *                        SEE IF 08 EXIT                  21800002
         MODESET KEYADDR=DXUKEY,WORKREG=15 USER EXIT LIST        Y02082 21850002
         CLI   0(R1),X08                CK FOR ACTIVE DCB EXIT          22000002
         BE    EDO08700                 YES SET UP EXIT                 22200021
         CLI   0(R1),X08+X80                                            22400002
         BE    EDO08700                 YES SET UP EXIT                 22600021
         TM    K0(R1),LASTNTRY          IS THIS END OF LIST             22800002
         BO    EDO08875                 YES, IMMEDIATE ABEND     YM6520 23000002
         LA    R1,K4(,R1)               INCREMENT TO NEXT ENTRY  YM1344 23050002
         B     EDO08600                 LOOP TO CHECK NEXT ENTRY YM1344 23400002
         EJECT                                                          23450002
EDO08700 EQU   *                        SEE IF ADDRESS ZERO             23600002
         L     RET,K0(,R1)              GET EXIT ADDRESS         Y02082 23610002
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 23650002
         LA    R1,K0(,RET)              CLEAR HIGH BYTE          Y02082 24050002
         CR    R1,R0                    IS ADDRESS SPECIFIED     Y02082 24100002
         BNH   EDO08875                 BRANCH IF NO             Y02082 24150002
         CLI   DEBNMEXT,K16             CHECK FOR 16 EXTENTS            24160002
         BNL   EDO08900                 BR HI OR EQ TO 16               24170002
         L     RUCB,DXUCBADR            GET UCB ADDRESS          YM5385 24180002
         TM    UCBJBNR,UCBVRDEV         IS IT VIO UNIT           YM5385 24190002
         BO    EDO08900                 BR IF YES-NO RECOVERY,   YM5385 24192002
*                                       LIKE 16 EXTENT DEB       YM5385 24194002
         NI    DCBOFLGS,X'FF'-DCBOLOCK  SET LOCK BIT OFF                24200021
*                                                                Y02082 24250002
* COPY THE DCB FROM THE WORK AREA TO USER'S STORAGE              Y02082 24300002
*                                                                Y02082 24350002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,WTGPREFX) COPY DCB Y02082 24360002
         IECRES UEXIT,EXITAD=(RET),REG1=DXUDCBAD, TAKE EXIT      Y02082*24380002
               STM=(2,13,DXXPREFX)      TAKE EXIT                Y02082 24430002
         LR    RET,RF                   SAVE REGISTER 15         YM0854 28850000
         EJECT                                                          28860002
         L     RDCB,DXUDCBAD            GET PTR TO USER'S DCB    Y02082 28900002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME USER'S KEY      Y02082 28942002
         OI    DCBOFLGS,DCBOLOCK        INDICATE RETURN FR USER  Y02082 28946002
         MODESET EXTKEY=DATAMGT         RESUME DATA MGT KEY      Y02082 28948402
         L     RDCB,DXPDCBAD            POINT TO COPIED DCB      Y02082 28948802
         OI    DCBOFLGS,DCBOLOCK        SET LOCK BIT ON          YM0854 29000000
*                                                                       29020002
*        INSPECT RETURN CODE                                            29030002
*                                                                       29040002
         LA    RET,K0(,RET)             CLEAR HI-ORDER BYTE      Y02082 29050002
         LA    R8,K2                    HIGHEST PERMISSIBLE RET  Y02082 29100002
         CLR   RET,R8                   CHK IF EXCEED MAX        YM1344 29150002
         BNH   EDO08840                 VALID - THEN USE IT      Y02082 29160002
         LA    RET,K2                   IF INVALID DEFLT B37     Y02082 29170002
EDO08840 EQU   *                        GET TO FULLWORDS         Y02082 29180002
         SLL   RET,K2                   RET * 4                  YM0854 29200002
         B     EDO08850(RET)            VECTOR BRANCH            YM0854 29400000
         SPACE 2                                                        29450002
EDO08850 EQU   *                        BRANCH TABLE                    29600002
         B     EDO09400                 RF=0 - TRY TO EXTEND            29610002
         SPACE 2                                                        29650002
         B     EDO08900                 RF=1 - UPDATE DSCB, SYNAD       29800002
         SPACE 2                                                        29850002
EDO08870 EQU   *                                               @ZA02218 29900037
         BAL   R8,EDO09700              RF=2 - UPDATE DSCB, ABEND       30000002
EDO08875 EQU   *                        ABEND                           30200002
         MODESET EXTKEY=DATAMGT         RETURN TO KEY 5          Y02082 30250002
         L     R1,WTGPREFX              GET BASE PREFIX ADDR     YM7099 30300002
         CLC   IECCORID-IECPREFX(K4,R1),RECCORID  RECOVERY ENTRY YM7099 30350002
         BE    EDO08360                 BRANCH IF RECOVERY ENTRY YM7099 30360002
         LR    R0,RC                    LOAD ABEND CODE        @ZA02218 30400037
         B     EDO10050                 BRANCH TO PROB DET     @ZA02218 30600037
         EJECT                                                          30650002
* 1) UPDATE DSCB                                                        30700002
* 2) LINK THROUGH ALL QSAM IOB/ICB(S) TURNING OFF THE UNIT EXCEPTION    30750002
* STATUS INDICATOR IN THE CSW'S.                                        30760002
* 3) EXIT TO SYNAD ROUTINE                                              30770002
EDO08900 EQU   *                        UPDATE DSCB FIRST               30800002
         BAL   R8,EDO09700              GO TO UPDATE LAST TRK IN DSCB   31000021
         L     RF,DCBIOBA               POINTER TO AN IOB IN CHAIN      32800021
         LA    RF,K0(,RF)                                               33000021
         MODESET KEYADDR=DXUKEY,WORKREG=1 IOB KEY                Y02082 33050002
         L     R1,K0(RF)                ADDRESS OF NEXT IOB IN CHAIN    33200021
EDO09000 EQU   *                        TURN OFF UNIT EXCEPTION         33400002
         LA    R1,K0(R1)                CLEAR HIGH ORDER BYTE           33600021
         NI    K20(R1),ALLBITS-CSWUNITX SET OFF UNIT EXCEPTION IN CSW   33800002
         CR    R1,RF                    IS THIS END OF CHAIN            34000021
         L     R1,K0(R1)                GET NEXT IOB IN CHAIN           34200021
         BNE   EDO09000                 NOT END OF CHAIN,CONTINUE LOOP  34400021
         LA    R1,X40+X02               INDICATE PUT ERROR NO SPACE ON  34600002
         SLL   R1,K24                   VOLUME JUSTIFY LEFT  THE CODE   34800021
         ICM   R1,B'0111',DXUDCBAD+K1   PUT USER DCBAD IN R1    YA02662 35000002
         TM    DCBMACRF+K1,DCBMWRIT     IS THIS BSAM           @ZA10234 35050037
         BO    EDO09050                 YES, BYPASS MOVE       @ZA10234 35100037
         MODESET EXTKEY=DATAMGT         DCB COPY KEY             Y02082 35150037
         MVC   DCBRECAD(K4),DCBEOBAD                                    35200037
         MODESET KEYADDR=DXUKEY,WORKREG=8 IOB KEY              @ZA08028 35250037
EDO09050 EQU   *                                               @ZA10234 35300037
         MVI   K4(RF),ECBCOD7F          RESET IOB COMPLETE              35400021
         L     RF,K4(,RF)               ADDRESS OF IOB IN ERROR         35600021
         LA    R0,K8(RF)                INDEX PAST IOB HDR              36000021
         SR    RF,RF                                                    36200021
         IC    RF,DCBOFFSW              INSERT IOB OFFSET               36400021
         SH    RF,CNST8                 ADJUST FOR EIGHT BYTE HDR       36600002
         SLL   RF,K24                   JUSTIFY LEFT THE OFFSET         36800021
         OR    R0,RF                    REG 0 WITH OFFSET & IOB ADDRESS 37000021
         TM    DCBMACRF+K1,DCBMREAD     IS CALLER BSAM                  37200021
         BZ    EDO09200                 NO,QSAM                         37400021
         LR    RF,R0                    MOVE IOB PTR TO ADDRESSABLE REG 37600021
         L     RF,K4(RF)                GET DECB PTR                    37800021
         LA    R0,K0(RF)                CLEAR HI BYTE + SET R0 FOR BSAM 38000021
         EJECT                                                          38050002
EDO09200 EQU   *                        SEE IF SYNAD CAN BE TAKEN       38200002
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 38250002
         NI    DCBCIND2,ALLBITS-DCBC2FEO CLEAR FEOV FLAGS               38400002
         TM    DCBCIND2,DCBC1EOB        IS CLOSE IN CONTROL             38600021
         BO    EDO10100                 YES, ABEND WITHOUT SYNAD        38800002
         TM    DCBSYNAD+K3,X01          TEST FOR SYNAD                  39000002
         BO    EDO10100                 IF NONE, ABEND                  39200002
         OI    DCBCIND2,DCBC2PIO        SET PERM ERR SO SYNAD CAN CLOSE 39400021
         NI    DCBOFLGS,ALLBITS-DCBOBUSY TURN OFF BUSY BIT              39600002
*                                                                Y02080 39650002
* POINT DEB TO USER DCB                                          Y02082 39700002
*                                                                Y02080 39750002
         TM    TIOELINK,TIOTSPOL        TEST FOR SPOOLED         YM1272 39754002
         BM    EDO09250                 BR IF SPOOLED            YM1272 39756002
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXUDCBAD+K1 POINT DEB  YM1272*39758002
                                        TO USER DCB              YM1272 39758402
         L     RF,DXDEBXAD              GET PTR TO DEB EXTENSION YM1272 39758802
         NI    DEBXFLG1-DEBXTN(RF),ALLBITS-DEBXCDCB DEB PT USER  YM1272 39759202
EDO09250 EQU   *                        EXIT TO SYNAD ROUTINE    YM1272 39759602
         NI    DCBCIND1,X'FF'-DCBC1EOB  CLEAR QSAM VOLUME FULL INDICATR 39760002
*                                                                       39760802
*        REFRESH THE USER'S DCB FROM THE COPY                           39761202
*                                                                       39761602
         IECRES INIT,DCBCOPY=FRWKAR,STM=(0,14,DXXPREFX)          Y02082 39762002
         EJECT                                                          39762402
         L     R8,DCBSYNAD              SYNAD ADDRESS FROM DCB   Y02080 39764002
         LR    R9,R0                    SAVE REG 0 IN REG 9    @ZA05438 39764637
         LR    RA,R1                    SAVE REG 1 IN REG A    @ZA05438 39765237
*                                                                       39766002
*        FREE THE EOV WORKAREA(S)                                       39768002
*                                                                       39768402
         IECRES FREE,A=(RCORE),PREFIX=EOV                        Y02080 39770002
*                                                                Y02080 41450002
*        RETURN TO CALLER (QSAM)                                 Y02080 41500002
*                                                                Y02080 41550002
         LR    RF,R8                    SYNAD ADDRESS IN 15      Y02080 41552002
         LR    R0,R9                    RESTORE REG 0          @ZA05438 41554037
         LR    R1,RA                    RESTORE REG 1          @ZA05438 41556037
         IECRES EXIT                    RETURN                   Y02080 41560002
*                                                                       41640002
*        RETURN TO IFG0554P TO EXTEND ON SAME VOLUME                    41690002
*                                                                       41740002
EDO09400 EQU   *                        RETURN CODE 0 FROM EXIT         42200002
         LA    R1,EABD186               GET D37 ABEND CODE     @ZA02218 42250037
         CR    RC,R1                    D37 ABEND PROCESSING?  @ZA02218 42300037
         BNE   EDO09405                 NO, BR                 @ZA02218 42350037
         LTR   RD,RD                    FIRST PASS?            @ZA02218 42360037
         BNZ   EDO08870                 NO, BR TO ASSUME RC=2  @ZA02218 42370037
         LA    RD,4                     SET SECOND PASS SW     @ZA02218 42380037
         L     R1,DCBEXLST              GET EXLST ADDR IN REG 1@ZA02218 42382037
         B     EDO08600                 BR TO TAKE EXIT AGAIN  @ZA02218 42390037
EDO09405 EQU   *                                               @ZA02218 42392037
         LA    RD,K1                    GET SPACE ON SAME VOLUME        42400021
         LA    RWTG,DXXAREA             POINTER TO WTG TABLE     Y02134 42450002
         LA    RWTGC,DXXENTRY           POINTER TO WTG ENTRY     Y02134 42500002
         IECRES LOAD,MODID=ID4T4P,BRCODE=K16,BRANCH=QUEUED       Y02134 44250002
         EJECT                                                          44260002
*                                                                       46400021
*          ENTER VIA BAL RH,UPDATTRK                                    46600021
*          ROUTINE TO UPDATE LAST TRK                                   46800002
*                                                                       46850002
EDO09700 EQU   *                        WRITTEN AND PUT IN DSCB         47000021
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 UCB TO WA DEB         Y02134 47400002
         MVC   DXDEBSCC(K10),UPDDUMXT   MOVE DUMMY EXTENT TO DEB        47600021
         L     RUCB,DXUCBADR            GET UCB ADDRESS          YM5385 47610002
         TM    UCBJBNR,UCBVRDEV         IS IT VIO UNIT           YM5385 47620002
         BZ    EDO09750                 BRANCH IF NO             YM5385 47630002
         DROP  RUCB                                              YM5385 47640002
         USING VDSCB,RUCB                                        YM5385 47650002
*                                       MOVE VDSDSCB TO WORKAREA YM5385 47660002
         MVC   DXDSCB(DSCEXT2-DSCFMTID),VDSDSCB+L'JFCBDSNM       YM5385 47670002
         OC    DXDSCB(DSCEXT2-DSCFMTID),DXDSCB IS DSCB SCRATCHED YM5385 47680002
         BZ    EDO10025                 BRANCH IF YES            YM5385 47690002
         XC    DSCEXT2(DSCBEND-DSCEXT2),DSCEXT2 ZERO 3RD EXTENT  YM5385 47700002
*                                       AND CHAIN POINTER        YM5385 47710002
         B     EDO09800                 UPDATE DSCB              YM5385 47720002
         DROP  RUCB                                              YM5385 47730002
         USING UCB,RUCB                                          YM5385 47740002
EDO09750 EQU   *                        USE REAL I/O             YM5385 47750002
         LR    R7,RDEB                  PICK UP DEB ADDRESS             47800021
         SH    R7,UPD016                POSITION AT (-16)               48000021
         MVC   DXDAADDR+K1(K7),DEB+K1-DEB(R7)  BBCCHHR OF               48200021
*                                                DSCB TO SEEK WRD       48400021
         MVI   DXDAADDR,K0              SET -M- TO ZERO                 48600021
*                                                                       48800021
*        GENERATE CHANNEL PROGRAM TO READ FRMT 1 DSCB                   49000021
*                                                                       49200021
         XC    DXCCW1(K24),DXCCW1       CLEAR CCW'S                     49400021
         LA    R1,DXDAADDR+K3           ADDRESS OF CCHHR                49600021
         ST    R1,DXCCW1                SEARCH ID TO CCW1               49800021
         LA    R1,DXCCW1                ADDR OF SEARCH CMD TO TIC       50000021
         ST    R1,DXCCW2                STORE IN CCW2                   50200021
         LA    R1,DXDSCB                READ INTO AREA ADDRESS          50400021
         ST    R1,DXCCW3                TO READ M/T COMMAND             50600021
         OC    DXCCW1(K24),UPDCCWS      OR IN SKELETON CCW'S            50800021
         BAL   R7,EDO10000              BRANCH TO I/O ROUTINE           51000021
*                                                                       51200021
*        END OF DSCB READ ROUTINE                                       51400021
         EJECT                                                          51600002
EDO09800 EQU   *                        UPDATE DSCB              YM5385 51610002
*              UPDATE LAST TRACK WRITTEN IN DSCB                        51800021
*                       MBBCCHHR TO TTR CONVERT ROUTINE                 52000021
*                       (IECPRLTV) WILL BE USED                         52200021
*                                                                       52400021
         STM   RDCB,RD,DXCCW5           SAVE REGS                       52600021
         LR    R1,RDEB                  ADDR USER'S DEB TO PARM REG     52800021
         LA    RDCB,DCBFDAD             ADDR MBBCCHHR TO PARAM REG      53000021
         L     RF,CVTPTR                ADDRESS OF CONVERT ROUTINE      53200021
         USING CVT,RF                                            YM6520 53207502
         L     RF,CVTPRLTV              FROM COMM VECTOR TABLE          53400021
         BALR  RET,RF                   GO TO CONVERT ROUTINE           53600021
         DROP  RF                                                YM6520 53607502
         LM    RDCB,RD,DXCCW5           RESTORE REGS                    53800021
         ST    R0,DXCCW5                PUT TTR OF LAST TRK USED        54000021
         MVC   DSCLSTAR(K3),DXCCW5      INTO THE DSCB                   54200021
         MVC   DSCLSTAR+K3(K2),DCBTRBAL  NUM OF BYTES LEFT ON TRACK     54400021
         OI    DSCDSIND,LASTNTRY        LAST VOLUME BIT         YA03178 54410002
         OI    DXATDACC,DXATTRAK        LAST TRK USED AND TRK    Y02144 54450002
*                                       BALANCE FIELDS UPDATED   Y02144 54500002
         EJECT                                                          54510002
*                                                                       54600021
*        WRITE FORMAT 1 DSCB BACK                                       54800021
*                                                                       55000021
         TM    UCBJBNR,UCBVRDEV         IS IT VIO UNIT           YM5385 55010002
         BZ    EDO09850                 BRANCH IF NO             YM5385 55020002
         DROP  RUCB                                              YM5385 55030002
         USING VDSCB,RUCB                                        YM5385 55040002
         MODESET EXTKEY=SCHED           VDSCB KEY                YM5385 55050002
*                                       MOVE DSCB TO SWA         YM5385 55060002
         MVC   VDSDSCB+L'JFCBDSNM(DSCEXT2-DSCFMTID),DXDSCB       YM5385 55070002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM5385 55080002
         B     EDO09900                 UPDATE COMPLETE          YM5385 55090002
         DROP  RUCB                                              YM5385 55100002
         USING UCB,RUCB                                          YM5385 55110002
EDO09850 EQU   *                        USE REAL I/O             YM5385 55120002
         XC    DXCCW3(K48),DXCCW3       CLEAR CCWS                      55200021
         LA    R1,DXDAADDR+K3           SEARCH ADDRESS                  55400021
         ST    R1,DXCCW6                                                55600021
         LA    R1,DXCCW1                TIC ADDRESS                     55800021
         ST    R1,DXCCW4                                                56000021
         LA    R1,DXDSCB                BUFFER ADDRESS                  56200021
         ST    R1,DXCCW5                                                56400021
         ST    R1,DXCCW8                                                56600021
         LA    R1,JFCBDSNM              DSNAME FOR SEARCH KEY           56800021
         ST    R1,DXCCW3                                                57000021
         LA    R1,DXCCW6                TIC ADDRESS                     57200021
         ST    R1,DXCCW7                                                57400021
         OC    DXCCW3(K48),WRTCCWS      FINISH CHANNEL PROGRAM          57600021
         BAL   R7,EDO10000              BRANCH TO I/O ROUTINE           57800021
EDO09900 EQU   *                        SET AUDIT TRAIL BIT      YM5385 57810002
         OI    DXATDACC,DXATUPDB        UPDATED DSCB WRITTEN     Y02144 57850002
         BR    R8                       RETURN                          58000021
         EJECT                                                          58050002
*                                                                       58200021
*        I/O ROUTINE- READS/WRITES FORMAT 1 DSCB                        58400021
*                                                                       58600021
EDO10000 EQU   *                        EXCP/WAIT/TEST FOR ERROR        58800002
         EXCP  DXIOB                    EXECUTE CHANNEL PROGRAM         59000021
         WAIT  ,ECB=DXECB               WAIT FOR COMPLETION             59200021
         TM    DXECB,ECBCOD7F           TEST COMPLETION CODE            59400021
         BCR   1,R7                     OK, RETURN                      59600021
EDO10025 EQU   *                        VIO ERROR ENTRY          YM5385 59610002
         LA    R0,EABD190               I/O ERROR WR DSCB 737 ABEND     59800021
EDO10050 EQU   *                        TEST IF CLOSE IN CONTROL        60000002
         TM    DCBMACRF,DCBMEXCP        IS THIS EXCP DCB?      @ZA18533 60200037
         BO    EDO10075                 YES, BRANCH            @ZA26360 60280037
         OI    DCBCIND2,DCBC2PIO        SET PERM ERR IN DCB    @ZA26360 60330037
         TM    DCBCIND2,DCBC2PUT        IS CLOSE IN CONTROL             60380037
         BO    EDO10075                 LEAVE BUSY BIT ON               60430037
         NI    DCBOFLGS,X'FF'-DCBOBUSY  TURN OFF BUSY BIT               60680037
EDO10075 EQU   *                        GO TO PROBLEM DETERMINATION     60800002
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              61000021
         LA    RWTG,DXXAREA             POINT TO EOV WTG                61200021
         DMABCOND (0),MODPD4T           LOAD ABEND ERROR CODE           61400021
         SPACE 2                                                        61450002
EDO10100 EQU   *                        ISSUE 001 ABEND DIRECTLY        61600002
         L     RDCB,DXUDCBAD            GET USER'S DCB ADDRESS   YM5924 61610002
         LA    R1,K1                    001 ABEND                Y02082 61650002
         ABEND (1),DUMP,,SYSTEM         SYSTEM ABEND WITH A DUMP Y02080 61800002
         EJECT                                                          61850002
*                                                                       67200021
*              CONSTANTS                                                67400021
*                                                                       67600021
UPDDUMXT DC    X'00000000FFFFFFFF7FFF'  MAX FOR DISK                    67800021
UPD016   DC    H'16'                    HALF WORD 16                    68000021
CNST8    DC    H'8'                     HALF WORKD 8             Y02082 68050002
HWD5     DC    H'5'                     HALF WORD 5              YM6520 68057502
HWD15    DC    H'15'                    HALF WORD 15             YM6520 68065002
HWD6     DC    H'6'                     HALF WORD 6              YM6520 68072502
         DS    0F                                                       68074002
BYTE127  DC    AL1(127)                 BYTE 127                 YM6520 68080002
ADCON0   DC    AL3(0)                   ADCON OF ZERO            YM6520 68087502
UPDCCWS  DC    X'3100000060000005'      SEARCH EQUAL ID                 68200021
         DC    X'0800000000000000'      TIC                             68400021
         DC    X'8600000000000060'      READ DATA M/T                   68600021
WRTCCWS  DC    X'290000004000002C'      SEARCH KEY (DSNAME)             68800021
         DC    X'0800000040000000'      TIC                             69000021
         DC    X'0500000060000060'      WRITE DSCB                      69200021
         DC    X'3100000060000005'      SEARCH ID                       69400021
         DC    X'0800000040000000'      TIC                             69600021
         DC    X'0600000010000060'      READ,NO DATA TRANSFER           69800021
RECCORID DC    C'RR0A'                  RECOVERY CORE ID         YM7099 70000002
         DS    0F                                                       70200021
MKB370S  DC    X'00000B37'              B37 COMPARE                     70400021
TIOTSPOL EQU   X'06'                    TIOT SPOOLED DS INDIC    YM1272 70450002
         EJECT                                                          70500002
*                                                                       71200021
*          XCTL TABLE FOR IFG0554T                                      71400021
*                                                                       71600021
XCTLTA4T XCTLTABL ID=(MODPD4T,0P,ID4T4P,4P,RECMOD,IFG0RR0B),     YM7099*71800002
               SVC=055,BRT=YES,LENGTH=                           Y02080 71810002
         IECDSECS CVT,TCB,TIOT,DCB,IEZDEB,UCB,MAIN,WTG,RB,PREFX, YM1272X72100002
               RRPL,PSA,EXPAND=YES                               Y02144 72200002
         IDDVDSCB ,                                              YM5385 72210002
         IECEQU IEZDEB=YES                                       YM1272 72250002
         END                                                            72400021
./  ADD  SSI=80390017,NAME=IFG0554Z
         TITLE 'IFG0554Z                      DSCB UPDATE CURRENT VOLUME00300002
               E/USER LABEL DETERMINATION'                       Y02134 00310002
IFG0554Z CSECT                                                          00400002
*********************************************************************** 00450002
*                                                                     * 00500002
*                                                                     * 00550002
*          VS2 RELEASE 02 DELETIONS                                   * 00600002
*                                                                     * 00650002
*                                                                     * 00700002
*********************************************************************** 00750002
*                                                                     * 00800002
* MODULE NAME = IFG0554Z (OS/VS2)                                     * 00850002
*                                                                     * 00900002
* DESCRIPTIVE NAME =                                                  * 00950002
*        UPDATE DSCB CURRENT VOLUME/USER LABEL DETERMINATION          * 01000002
*                                                                     * 01050002
* COPYRIGHT = NONE                                                    * 01100002
*                                                                     * 01150002
* STATUS = RELEASE 2, LEVEL 0                                         * 01200002
*                                                                     * 01250002
* FUNCTION =                                                          * 01300002
*        THIS MODULE IS ENTERED FROM IFG0554N DURING FEOV PROCESSING  * 01350002
*        IF USER LABEL PROCESSING IS REQUIRED. IF SMF PROCESSING HAS  * 01400002
*        BEEN REQUESTED, IFG0554N HAS GIVEN IFG0553B (ALIAS FOR       * 01450002
*        IFG0202H) CONTROL AND IFG0202I GIVES THIS MODULE CONTROL.    * 01500002
*                                                                     * 01550002
*        THIS MODULE IS ALSO ENTERED FROM IFG0554P DURING EOV         * 01600002
*        DA OUTPUT PROCESSING WHEN NO ADDITIONAL SPACE WILL BE        * 01650002
*        ACQUIRED ON THE CURRENT VOLUME AND MORE VOLUMES REMAIN       * 01700002
*        TO BE PROCESSED. IF SMF PROCESSING HAS BEEN REQUESTED,       * 01750002
*        IFG0554P HAS GIVEN IFG0553B (ALIAS FOR                       * 01762002
*        IFG0202H) CONTROL AND IFG0202I GIVES THIS MODULE CONTROL.    * 01770002
*                                                                     * 01780002
*        THE FORMAT 1 DSCB IS READ IF USER LABELS ARE SPECIFIED IN    * 01850002
*        THE JFCB, OR EXCP IS BEING USED, OR IF FEOV IS NOT BEING     * 01900002
*        PROCESSED. IF A VIO DATA SET IS BEING PROCESSED, THE VDSDSCB * 01950002
*        IS MOVED TO THE WORKAREA FROM SWA.                           * 01970002
         EJECT                                                          02000002
*        AFTER THE DSCB IS READ IT IS UPDATED (THE LAST BLOCK TTR     * 02050002
*        AND THE TRACK BALANCE ARE ZEROED, AND THE LAST VOLUME BIT    * 02100002
*        IS TURNED OFF) IF EXCP IS BEING USED OR IF FEOV IS NOT       * 02150002
*        BEING PROCESSED. IF IT IS A PARTITIONED DATA SET, THE LAST   * 02200002
*        BLOCK POINTER AND TRACK BALANCE ARE NOT ZEROED OUT, AS       * 02210002
*        A PDS WILL NOT BE EXTENDED TO A NEW VOLUME. THE              * 02220002
*        DIRECTORY WILL BE OVERWRITTEN AT THE NEXT OPEN FOR           * 02230002
*        OUTPUT IF THE TTRLL IS ZEROED. INSTEAD, THE LL IS            * 02240002
*        ZEROED AND THE TTR IS SET FROM DCBRELAD, THE START OF        * 02242002
*        THE MEMBER CURRENTLY BEING WRITTEN. IF AN EXCP DCB IS        * 02244002
*        PROCESSING THE PDS AND DCBRELAD IS NOT DEFINED (THE DCB      * 02246002
*        DOES NOT HAVE A 5 WORD DEVICE INTERFACE) THE TTRLL IS NOT    * 02248002
*        CHANGED.                                                     * 02248402
*                                                                     * 02250002
*        THE USER TRAILER LABEL MODULE IFG0555B IS GIVEN CONTROL IF   * 02300002
*        USER LABELS ARE SPECIFIED IN THE JFCB AND THE DSORG IS PS    * 02350002
*        AND THERE IS AN 04 EXIT IN THE DCB EXIT LIST. BITS 5 AND 6   * 02400002
*        IN JFCBMASK+5 ARE SET TO ONE TO INDICATE A RETURN FROM       * 02450002
*        IFG0555H.                                                    * 02500002
*                                                                     * 02550002
*        AFTER RETURNING FROM IFG0555H OR IF USER LABEL PROCESSING    * 02600002
*        HAS NOT BEEN REQUIRED, MODULE IFG0554P IS GIVEN CONTROL      * 02650002
*        WITH REGISTER 14 SET TO 4.                                   * 02700002
         EJECT                                                          08400002
* NOTES =                                                             * 08450002
*        NONE.                                                        * 08500002
*                                                                     * 09000002
*    DEPENDENCIES =                                                   * 09050002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 09100002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 09150002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 09200002
*                                                                     * 09250002
*    RESTRICTIONS = NONE                                              * 09300002
*                                                                     * 09350002
*    REGISTER CONVENTIONS =                                           * 09400002
*            R2 POINTS TO DCB                                         * 09450002
*            R4 POINTS TO OPEN WORK AREA                              * 09500002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 09550002
*            R6 POINTS TO THE WTG TABLE                               * 09600002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 09650002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 09700002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 09750002
*            R10 POINTS TO THE UCB                                    * 09800002
*                                                                     * 09850002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 09900002
*                  END OF LISTING.                                    * 09950002
*                                                                     * 10000002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 10050002
*                                                                     * 10100002
*    PROCESSOR = ASSEMBLER XF                                         * 10150002
*                                                                     * 10200002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 10250002
*                  ORG STATEMENT AT END OF LISTING                    * 10300002
*                                                                     * 10350002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 10400002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 10450002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 10500002
*                                                                     * 10550002
* ENTRY POINT =                                                       * 10600002
*        IFG0554Z                                                     * 10650002
*                                                                     * 10700002
*    PURPOSE = SEE FUNCTION                                           * 10750002
*                                                                     * 10800002
*    LINKAGE =                                                        * 10850002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 10900002
*        MACRO INSTRUCTION.                                           * 10950002
         EJECT                                                          11000002
* INPUT =                                                             * 11050002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 11100002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 11150002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 11200002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 11250002
*                                                                     * 11300002
*        IF BITS 5 AND 6 OF JFCBMASK+5 ARE SET TO ONE, A RETURN       * 11350002
*        FROM USER LABEL MODULE IFG0555H IS BEING MADE.               * 11400002
*                                                                     * 11550002
* OUTPUT =                                                            * 11600002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 11650002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 11700002
*        THE DEBDCBAD POINTING TO THE COPIED DCB,                     * 11750002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 11800002
*                                                                     * 11850002
*        IFG0554P -                                                   * 12150002
*        REGISTER 14 SET TO 4.                                        * 12200002
*                                                                     * 12250002
*        IFG0555B -                                                   * 12300002
*        BITS 5 AND 6 OF JFCBMASK+5 SET TO ONE.                       * 12350002
*                                                                     * 12800002
*        IFG0550P GIVEN CONTROL THROUGH DMABCOND MACRO -              * 13000002
*        REGISTER 0 CONTAINS INTERNAL ABEND CODE                      * 13050002
*                                                                     * 13100002
* EXIT-NORMAL =                                                       * 13400002
*        IFG0555B TO PROCESS USER LABELS.                             * 13450002
*        IFG0554P TO OBTAIN A NEW VOLUME.                             * 13500002
*                                                                     * 13800002
* EXIT-ERROR =                                                        * 13850002
*        IFG0550P GIVEN CONTROL THROUGH DMABCOND MACRO WITH AN        * 13900002
*        INTERNAL ABEND CODE IN REGISTER 0 -                          * 13950002
*        190 - 737-4 - I/O ERROR READING OR WRITING DSCB.             * 14000002
*                                                                     * 14350002
* EXTERNAL REFERENCES = SEE BELOW                                     * 14400002
*                                                                     * 14450002
*    ROUTINES =                                                       * 14500002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 14550002
*                                                                     * 14600002
*    DATA AREAS =                                                     * 14650002
*        EOV WORKAREA.                                                * 14700002
         EJECT                                                          14750002
*    CONTROL BLOCK =                                                  * 14800002
*        DCB                                                          * 14850002
*        DEB                                                          * 15100002
*        VDSCB                                                        * 15110002
*                                                                     * 15150002
* TABLES =                                                            * 15200002
*        DCB EXIT LIST.                                               * 15250002
*                                                                     * 15300002
* MACROS =                                                            * 15350002
*        MODESET                                                      * 15400002
*        IECRES-LOAD                                                  * 15450002
*        EXCP                                                         * 15550002
*        WAIT                                                         * 15600002
*        DMABCOND                                                     * 15650002
*        XCTLTABL                                                     * 15700002
*        IECDSECS                                                     * 15750002
*        IECEQU                                                       * 15800002
*                                                                     * 15850002
* CHANGE ACTIVITY =                                                   * 15900002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 15950002
*                                                                     * 16000002
*********************************************************************** 16050002
         EJECT                                                          16100002
EABD190  EQU   190                      737-4 INTERNAL ABEND CODE       18600002
*                                                                     * 18900021
         USING FORCORE,RCORE                                            19200021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 19250002
         USING IHADCB,RDCB                                              19500021
         USING TIOENTRY,RTIOT                                           19800021
         USING UCB,RUCB                                                 20100021
         USING DEB,RDEB                                                 20400021
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        20700021
         USING *,RBASE                                                  21000021
*                                                                       21300021
*                                                                       21600021
         TM    JFCBMASK+K5,K6           IS THIS A RETURN FROM 555B      21900021
         BO    EDO15100                 YES, BRANCH                     22200021
*                                                                Y02134 22500002
EDO14500 EQU   *                        NOT USER LABEL RETURN           22800002
*                                                                Y02134 23100002
         ST    RC,DXCCW5                SAVE FOR 554P            Y02134 23400002
         TM    JFCBLTYP,JFCSL+JFCBUL    TEST IF SUL SPECIFIED           25500021
         BO    EDO14550                 YES, BRANCH              A37870 25600021
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP           SA59750 25650002
         BO    EDO14550                 BRANCH IF EXCP          SA59750 25660002
         TM    DCBCIND2,DCBC2FEO        FEOV                     A37870 25700021
         BO    EDO15300                 YES, BRANCH              A37870 25800021
         EJECT                                                          25850002
EDO14550 EQU   *                        SUL, EXCP, NOT FEOV      A37870 25900002
*                                                                       33300021
*        READ FORMAT 1 DSCB                                             33600021
*                                                                       33900021
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 UCB ADDRESS TO WA DEB Y02134 34200002
         L     RUCB,DXUCBADR            GET UCB ADDRESS          YM3862 34205002
         TM    UCBJBNR,UCBVRDEV         IS IT A VIO UNIT         YM3862 34210002
         BNO   EDO14560                 BRANCH IF NOT VIO        YM3862 34215002
*                                                                       34220202
*        MOVE DSCB FROM SWA TO EOV WORKAREA                      YM3862 34220402
*                                                                       34220602
         SPACE 1                                                        34220802
*                                       MOVE VDSDSCB TO WORKAREA YM5385 34221002
         MVC   DXDSCB(DSCEXT2-DSCFMTID),VDSDSCB-VDSUCB+L'JFCBDSNM(RUCB) 34225002
         OC    DXDSCB(DSCEXT2-DSCFMTID),DXDSCB IS DSCB SCRATCHED YM3862 34230002
         BZ    EDO16310                 BR IF SCRATCHED          YM3862 34240002
         XC    DSCEXT2(DSCBEND-DSCEXT2),DSCEXT2 ZERO 3RD EXT AND YM3862 34245002
*                                       CHAIN POINTER            YM3862 34250002
         B     EDO14570                 BRANCH TO UPDATE DSCB    YM3862 34255002
*                                                                       34260002
*        READ DSCB WITH EXCP                                     YM3862 34265002
*                                                                       34270002
EDO14560 EQU   *                        BUILD CHANNEL PROGRAM    YM3862 34275002
         MVC   DXDEBSCC(K10),WFMDUMXL   MOVE DUMMY EXTENT TO DEB        34800021
         LR    R7,RDEB                  PICK UP DEB ADDRESS             35100021
         SH    R7,WFM0162L              POSITION AT (-16)               35400021
         MVC   DXDAADDR+K1(K7),DEB+K1-DEB(R7)  BBCCHHR OF               35700021
*                                           DSCB TO SEEK WRD            36000021
         MVI   DXDAADDR,K0              SET -M- TO ZERO                 36300021
*                                                                       36600021
*        GENERATE CHANNEL PROGRAM TO READ DSCB                          36900021
*                                                                       37200021
         XC    DXCCW1(K24),DXCCW1       ZERO CCWS 1-3                   37500021
         LA    R1,DXDAADDR+K3           ADDR OF CCHHR                   37800021
         ST    R1,DXCCW1                SEARCH ID TO CCW1               38100021
         LA    R1,DXCCW1                ADDR OF SRCH CMD TO TIC         38400021
         ST    R1,DXCCW2                STORE IT                        38700021
         LA    R1,DXDSCB                READ AREA ADDRESS               39000021
         ST    R1,DXCCW3                TO READ M/T CMD.                39300021
         OC    DXCCW1(K24),WFMCCWSL     OR IN SKELETON CCWS             39600021
         BAL   R7,EDO16300              GO READ DSCB             A37870 39640021
*                                                                Y02134 39650002
EDO14570 EQU   *                        SEE IF DSCB UPDATED      YM3862 39655002
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP           SA59750 39660002
         BO    EDO14575                 BRANCH IF EXCP           YM4634 39670002
         TM    DCBCIND2,DCBC2FEO        FEOV                     A37870 39680021
         BO    EDO14600                 YES, GO PROCESS USER LBL A37870 39720021
         EJECT                                                          39725002
EDO14575 EQU   *                        UPDATE DSCB              YM4634 39730002
*                                                                       39760021
*        UPDATE FORMAT 1 DSCB LAST BLOCK POINTER AND TRACK BALANCE      39800021
*                                                                       39840021
         TM    DSCFILTY,DCBORGPO        IS THIS PDS            @ZA28976 39850000
         BO    EDO14582                 BRANCH YES             @ZA28976 39852000
         TM    DCBMACRF,DCBMRECP        CHECK FOR EXCP         @ZA28976 39854000
         BZ    EDO14580                 BRANCH IF NO           @ZA28976 39856000
         TM    DCBMACF2,DCBMR5WD+DCBMR4WD DCBFDAD EXIST        @ZA28976 39858000
         BZ    EDO14585                 DONT UPDATE IF NO      @ZA28976 39860000
EDO14580 EQU   *                                                        39862000
         MVC   DXDAADDR,DCBFDAD         GET MBBCCHHR           @ZA28976 39864000
         L     RF,WTGPREFX              PTR TO PREFIX          @ZA28976 39866000
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS          @ZA28976 39868000
         LR    R1,RDEB                  PTR TO  DEB            @ZA28976 39870000
         LA    R2,DXDAADDR              PTR TO MBBCCHHR        @ZA28976 39872000
         L     RF,CVTPTR                PTR TO CVT             @ZA28976 39874000
         L     RF,CVTPRLTV-CVT(,RF)     ADDR OF CONVERT RTN    @ZA28976 39876000
         BALR  RET,RF                   CONVERT TO TTR         @ZA28976 39878000
         L     RET,WTGPREFX             POINTER TO PREFIX      @ZA28976 39880000
         LM    R1,RET,IECREGSV-IECPREFX+K4(RET) RESTORE REGS   @ZA28976 39882000
         STCM  R0,RF,DSCLSTAR           SAVE TTR IN F1         @ZA28976 39884000
         LR    R7,RDEB                  GET DEB ADDR           @ZA28976 39886000
         SH    R7,WFM0162L              POSITION AT (-16)      @ZA28976 39888000
         MVC   DXDAADDR+K1(K7),DEB+K1-DEB(R7)  RESTABLISH      @ZA28976 39890000
*                                       BBCCHHRR FOR WRITE     @ZA28976 39892000
         MVI   DXDAADDR,K0              SET -M- TO ZERO        @ZA28976 39894000
         B     EDO14584                                                 39896000
EDO14582 EQU   *                                                        39898000
         TM    DCBMACRF,DCBMRECP        IS PDS PROCESSED         YM4634 39900000
*                                       WITH EXCP                YM4634 39902000
         BZ    EDO14583                 BRANCH IF NO             YM4634 39904000
         TM    DCBMACF2,DCBMR5WD        DOES DCBRELAD EXIST      YM4634 39906000
         BZ    EDO14585                 DON'T UPDATE TTRLL IF NO YM4634 39908000
EDO14583 EQU   *                        UPDATE PDS DSCB          YM4634 39910000
         MVC   DSCLSTAR,DCBRELAD        TTR OF MEM TO F1       @ZA28976 39912000
EDO14584 EQU   *                                               @ZA28976 39914000
         XC    DSCTRBAL,DSCTRBAL        ZERO TRACK BALANCE     @ZA28976 39916000
EDO14585 EQU   *                        REWRITE DSCB             YM4634 39944002
         NI    DSCDSIND,ALLBITS-LASTNTRY RESET LAST VOL IND      A37870 39960002
         OI    DXATDACC,DXATTRAK        LAST TRK USED AND TRK    Y02144 39970002
*                                       BALANCE FIELDS UPDATED   Y02144 39980002
         TM    UCBJBNR,UCBVRDEV         IS IT VIO UNIT           YM3862 39985002
         BNO   EDO14586                 BRANCH IF NOT            YM3862 39990002
*                                                                       39995002
*        MOVE DSCB FROM EOV WORKAREA TO SWA                      YM3862 39996002
*                                                                       39997002
         MODESET EXTKEY=SCHED           GET IN SWA KEY           YM3862 39998002
         MVC   VDSDSCB-VDSCB+L'JFCBDSNM(DSCEXT2-DSCFMTID,RUCB),DXDSCB   39999002
         MODESET EXTKEY=DATAMGT         GET IN KEY 5             YM3862 39999202
         B     EDO14588                 GO TO USER LBL PROCESS   YM3862 39999402
*                                                                       40000021
*        WRITE FORMAT 1 DSCB                                            40040021
*                                                                       40080021
EDO14586 EQU   *                        WRITE DSCB WITH EXCP     YM3862 40085002
         MVC   DXCCW4(K24),DXCCW1       CCW'S FOR RDBACK CHECK   A37870 40120021
         MVI   DXCCW3,CCWWRTDA          WRITE COMMAND TO CCW     A37870 40160021
         MVI   DXCCW3+K4,CCWCMDCH       CHAIN TO RDBACK CHECK    A37870 40200021
         LA    R1,DXCCW4                ADDR OF SEARCH           A37870 40240021
         ST    R1,DXCCW5                PUT IN TIC CCW           A37870 40280021
         MVI   DXCCW5,CCWTIC            RESTORE TIC COMMAND      A37870 40320021
         MVI   DXCCW6+K4,X10            NO DATA XFER FOR RDBACK  A37870 40360021
         BAL   R7,EDO16300              GO WRITE DSCB            A37870 40400021
EDO14588 EQU   *                        SET AUDIT TRAIL          YM3862 40405002
         OI    DXATDACC,DXATUPDB        UPDATED DSCB WRITTEN     Y02144 40410002
         EJECT                                                          40420002
*                                                                       40440021
*        USER TRAILER LABEL PROCESSING                                  40480021
*                                                                       40520021
         ST    RC,DXCCW5                SAVE ADDRESS OF DEB      A37870 40560021
*                                       VOLSEQ REFERENCES NEEDED        40600021
*                                       IN IFG0554P              Y02134 40640002
         TM    DCBMACRF,DCBMEXCP        CHECK DSORG IF NOT EXCP YA02186 40650002
         BZ    EDO14590                 BRANCH IF NOT           YA02186 40660102
         TM    DCBMACR1,DCBMRFE         DOES EXITLIST EXIST      Y02082 40670002
         BZ    EDO15300                 BRANCH IF NO             Y02082 40672002
         TM    DCBMACR1,DCBMRCI         DOES DSORG EXIST         Y02082 40674002
         BZ    EDO14595                 BR IF NO, TREAT AS PS    Y02082 40676002
EDO14590 EQU   *                        IS DSORG PS              Y02082 40678002
         TM    DCBDSORG,DCBORGPS        IS DSORG PS              A37870 40680021
         BZ    EDO15300                 NO,  BRANCH              A37870 40720021
         TM    DCBMACRF,DCBMEXCP        SKIP JFCB TEST IF EXCP  YA02186 40720502
         BO    EDO14595                 BRANCH IF YES           YA02186 40721002
         TM    JFCDSORG,JFCORGDA        BDAM DATA SET           YA02186 40722502
         BO    EDO15300                 BRANCH IF YES-NO EXIT   YA02186 40725002
EDO14595 EQU   *                        IS SUL SPECIFIED        YA02186 40730002
         TM    JFCBLTYP,JFCSL+JFCBUL    USER LABELS SPECIFIED    A37870 40760021
         BNO   EDO15300                 NO, BRANCH               A37870 40800021
EDO14600 EQU   *                        IS EXIT LIST ZERO        A37870 40840002
         L     RC,DCBEXLST              GET EXIT LIST POINTER    A37870 40880021
         LA    RC,K0(,RC)               ZERO HIGH ORDER BYTE     A37870 40920021
         LTR   RC,RC                    IS EXIT LIST ZERO        A37870 40960021
         BZ    EDO15300                 YES, BRANCH              A37870 41000021
EDO14700 EQU   *                        IS THERE AN 04 EXIT      A37870 41040002
         MODESET KEYADDR=DXUKEY,WORKREG=7 USER EXIT LIST KEY     Y02082 41050002
         CLI   K0(RC),XLOUTL            IS THIS ACTIVE EXIT 4    A37870 41080021
         BE    EDO14800                 YES, GO PROCESS USER LBL A37870 41120021
         CLI   K0(RC),XLOUTL+LASTNTRY   IS IT EXIT 4 AND LAST    A37870 41160021
         BE    EDO14800                 YES, GO RPOCESS USER LBL A37870 41200021
         TM    K0(RC),LASTNTRY          IS THIS LAST ENTRY       A37870 41240021
         LA    RC,K4(,RC)               POINT TO NEXT ENTRY      A37870 41280021
         BZ    EDO14700                 BRANCH IF NOT LAST ENTRY A37870 41320021
         B     EDO15300                 BYPASS USER LBL PROCESS  A37870 41360021
         EJECT                                                          41370002
EDO14800 EQU   *                        IS EXIT ADDRESS ZERO     A37870 41400002
         L     RC,K0(,RC)               PICK UP USER EXIT ADDR   A37870 41440021
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 41450002
         LR    R7,RC                    SAVE EXIT ADDRESS        A37870 41480021
         LA    R7,K0(,R7)               ZERO HIGH ORDER BYTE     A37870 41520021
         LTR   R7,R7                    IS EXIT ADDRESS ZERO     A37870 41560021
         BZ    EDO15300                 YES, BRANCH              A37870 41600021
*                                                                Y02134 41750002
         OI    JFCBMASK+K5,K6           SET SW TO IND EOV ENTRY         42000021
*                                                                Y02134 42300002
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              43800021
         LA    RWTG,DXXAREA             POINT TO EOV WTG                44100021
         USING WTG,RWTG                 WHERE-TO-GO TABLE        Y02080 44150002
         IECRES LOAD,MODID=ID4Z5B,BRANCH=QUEUED                  Y02134 44450002
         DROP  RWTG                                              Y02080 44500002
*                                                                       44700021
EDO15100 EQU   *                        ENTRY FROM IFG0555B             45000002
*                                                                Y02134 45050002
*****************************************************************Y02134 45100002
*                                                                Y02134 45150002
*        RETURN HERE FROM USER LABEL ROUTINE                     Y02134 45200002
*                                                                Y02134 45250002
*****************************************************************Y02134 45260002
*                                                                Y02134 45270002
         NI    JFCBMASK+K5,ALLBITS-K6   TURN OFF EOV-UL SWTCH           45300021
         EJECT                                                          45350002
EDO15300 EQU   *                        AFTER BYPASSING USER LABELS     45600002
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 45602002
*                                                                Y02134 45610002
         L     RC,DXCCW5                RESTORE RC FOR 554P      Y02134 45650002
*                                                                Y02134 67550002
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              67600002
         LA    RWTG,DXXAREA             POINT TO EOV WTG                67650002
         USING WTG,RWTG                 WHERE-TO-GO TABLE        Y02080 67700002
         IECRES LOAD,MODID=ID4Z4P,BRCODE=K4,BRANCH=QUEUED        Y02134 67750002
         DROP  RWTG                                              Y02080 67760002
         SPACE 2                                                        68400002
EDO16300 EQU   *                        READ/WRITE DSCB                 68700002
         EXCP  DXIOB                                             A37870 68800021
         WAIT  ,ECB=DXECB                                        A37870 68900021
         TM    DXECB,ECBCOD7F           TEST COMPLETION CODE     A37870 69000021
         BOR   R7                       RETURN NO ERROR          A37870 69100002
*                                                                Y02134 69300002
EDO16310 EQU   *                        VIO 'I/O ERROR'          YM3862 69305002
         NI    DCBOFLGS,X'FF'-DCBOBUSY                                  69600021
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              69900021
         LA    RWTG,DXXAREA             POINT TO EOV WTG                70200021
         DMABCOND EABD190,ID4Z0P                                 Y02134 70500002
         EJECT                                                          70800002
*                                                                       75600021
*        CONSTANTS                                                      75900021
*                                                                       76200021
WFMDUMXL DC    X'000000007FFF7FFF7FFF'  MAX TO COVER ALL DEVICES        79500021
WFM0162L DC    H'16'                    POSITIONING FOR DEB             79800021
WFMCCWSL DC    X'3100000060000005'      SEARCH EQUAL ID                 80100021
         DC    X'0800000000000000'      TIC                             80400021
         DC    X'8600000000000060'      READ DATA M/T                   80700021
         EJECT                                                          80750002
*                                                                       81300021
*        XCTL  TABLE FOR IFG0554Z                                       81600021
*                                                                       81900021
         XCTLTABL ID=(ID4Z4P,4P,ID4Z5B,5B,ID4Z0P,0P),            Y02134X82200002
               SVC=055,BRT=YES,LENGTH=                           Y02134 82500002
         IECDSECS CVT,TCB,TIOT,SMF,DCB,DEB,UCB,MAIN,USERLAB,     A37870X82800021
               WTG,PREFX,EXPAND=YES                              Y02080 83100002
         IDDVDSCB                                                YM3862 83110002
         IECEQU                                                         83150002
         END                                                            83400021
./  ADD  SSI=80160003,NAME=IFG0555B
         TITLE 'IFG0555B / DA OUTPUT USER TRAILER LABEL PROCESSING'     00200021
IFG0555B CSECT                                                          00450002
*********************************************************************** 00500002
*                                                                     * 00550002
*                                                                     * 00600002
*          VS2 ADDITIONS/CHANGES/DELETIONS                            * 00650000
*                                                                     * 00680000
* C49800021                                                  @ZA28829 * 00710000
*********************************************************************** 00800002
*                                                                     * 00850002
* MODULE NAME = IFG0555B (OS/VS2)                                     * 00900002
*                                                                     * 00950002
* DESCRIPTIVE NAME =                                                  * 01000002
*        DA OUTPUT USER TRAILER LABEL PROCESSING                      * 01060002
*                                                                     * 01100002
* COPYRIGHT = NONE                                                    * 01150002
*                                                                     * 01200002
* STATUS = RELEASE 2, LEVEL 0                                         * 01250002
*                                                                     * 01300002
* FUNCTION =                                                          * 01350002
*        THIS MODULE IS ENTERED FROM IFG0554Z (EOV) TO WRITE UP TO    * 01400002
*        EIGHT USER TRAILER LABELS AS REQUIRED FOR DATA SETS ON       * 01450002
*        DIRECT ACCESS DEVICES. IT IS ENTERED ONCE FOR EACH DCB TO BE * 01500002
*        PROCESSED.                                                   * 01550002
*                                                                     * 01600002
*        A 152 BYTE USER LABEL WORK AREA IS OBTAINED FOR EOV FROM     * 01650002
*        FETCH PROTECTED SUBPOOL 229 IN DATA MANAGEMENT KEY. A 96     * 01700002
*        BYTE USER LABEL WORK AREA IS OBTAINED FOR THE USER FROM      * 01750002
*        FETCH PROTECTED SUBPOOL 229 IN THE KEY OF THE CALLER OF EOV. * 01800002
*                                                                     * 01850002
*        IF A TRACK WAS ALLOCATED FOR USER LABELS, CONTROL IS GIVEN   * 01900002
*        TO THE USER'S LABEL CONSTRUCTION ROUTINE WHOSE ADDRESS IS    * 01950002
*        PASSED TO THIS MODULE IN REGISTER 12, VIA THE IECRES-EXIT    * 02000002
*        MACRO WHICH GIVES CONTROL TO IFG0194A WHO TAKES THE EXIT     * 02050002
*        AND RETURNS TO THIS CALLING MODULE.                          * 02060002
*                                                                     * 02100002
*        ON RETURN FROM THE USER'S ROUTINE, IF A LABEL WAS            * 02150002
*        CONSTRUCTED, IT IS WRITTEN FOLLOWED BY ONE FILE MARK FOR     * 02200002
*        UTL(N+1). DEPENDING ON THE RETURN CODE PASSED BY THE USRE'S  * 02250002
*        ROUTINE, ANOTHER LABEL IS PROCESSED OR CONTROL IS GIVEN BACK * 02300002
*        TO IFG0554Z, THE MODULE WHICH CALLED THIS ONE.               * 02350002
         EJECT                                                          08450002
* NOTES =                                                             * 08500002
*        NONE.                                                        * 08550002
*                                                                     * 09050002
*    DEPENDENCIES =                                                   * 09100002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 09150002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 09200002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 09250002
*                                                                     * 09300002
*    RESTRICTIONS = NONE                                              * 09350002
*                                                                     * 09400002
*    REGISTER CONVENTIONS =                                           * 09450002
*            R2 POINTS TO DCB                                         * 09500002
*            R4 POINTS TO OPEN WORK AREA                              * 09550002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 09600002
*            R6 POINTS TO THE WTG TABLE                               * 09650002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 09700002
*            R8 POINTS TO THE DATA MANAGEMENT KEY USER LABEL WORKAREA * 09750002
*            R10 POINTS TO THE USER KEY USER LABEL WORKAREA           * 09850002
*                                                                     * 09900002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 09950002
*                  END OF LISTING.                                    * 10000002
*                                                                     * 10050002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 10100002
*                                                                     * 10150002
*    PROCESSOR = ASSEMBLER XF                                         * 10200002
*                                                                     * 10250002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 10300002
*                  ORG STATEMENT AT END OF LISTING                    * 10350002
*                                                                     * 10400002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 10450002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 10500002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 10550002
*                                                                     * 10600002
* ENTRY POINT =                                                       * 10650002
*        IFG0555B                                                     * 10700002
*                                                                     * 10750002
*    PURPOSE = SEE FUNCTION                                           * 10800002
*                                                                     * 10850002
*    LINKAGE =                                                        * 10900002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 10950002
*        MACRO INSTRUCTION.                                           * 11000002
         EJECT                                                          11050002
* INPUT =                                                             * 11100002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 11150002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 11200002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 11250002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 11300002
*        REGISTER 12 CONTAINS THE ADDRESS OF THE USER LABEL EXIT.     * 11310002
*        BITS 5 AND 6 IN JFCBMASK+5 ARE SET TO ONE.                   * 11320002
*                                                                     * 11350002
* OUTPUT =                                                            * 11650002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 11700002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 11750002
*        THE DEBDCBAD POINTING TO THE COPIED DCB,                     * 11800002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA.                 * 11850002
*        USER LABELS ARE WRITTEN AS REQUESTED.                        * 11860002
*        REGISTERS 2-11 ARE RETURNED AS ON ENTRY.                     * 11870002
*                                                                     * 11900002
* EXIT-NORMAL =                                                       * 13450002
*        IFG0554Z                                                     * 13500002
*                                                                     * 13850002
* EXIT-ERROR =                                                        * 13900002
*        IF NO USER LABEL EXTENT EXISTS, THE USER'S EXIT ROUTINE IS   * 13950002
*        ENTERED WITH THE BUFFER POINTER SET TO ZERO.                 * 14000002
*                                                                     * 14400002
* EXTERNAL REFERENCES = SEE BELOW                                     * 14450002
*                                                                     * 14533302
*    ROUTINES =                                                       * 14550002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 14600002
*                                                                     * 14650002
*        USER'S OUTPUT LABEL EXIT ROUTINE ENTERED BY MEANS OF         * 14660002
*        IECRES-UEXIT MACRO WHICH GIVES CONTROL TO IFG019RA WHICH     * 14670002
*        TAKES THE USER EXIT WITH THE FOLLOWING INPUT -               * 14680002
*              REG 0  CONTAINS NOTHING OF INTEREST.                   * 14690002
*              REG 1  POINTER TO 4 WORD PARAMETER LIST -              * 14692002
*                   OFFSET (HEX)                                      * 14694002
*                   0  POINTER TO LABEL BUFFER                        * 14696002
*                   4  POINTER TO DCB                                 * 14698002
*                   8  FLAG BYTE                                      * 14698402
*                   9  POINTER TO STATUS INFORMATION (IF              * 14698802
*                   PERMANENT I/O ERROR) OR ZERO                      * 14699202
*                   C  POINTER TO IMAGE AREA IF USER TOTALING WAS     * 14699602
*                   REQUESTED OR ZERO.                                * 14699702
*              REG 2-13 CONTENTS OF USER'S REGS BEFORE PUT/CHECK      * 14699802
*              MACRO INSTRUCTION CAUSING EOV WAS ISSUED, OR BEFORE    * 14699902
*              EOV OR FEOV MACRO INSTRUCTION WAS ISSUED.              * 14716602
*              REG 14 RETURN ADDRESS.                                 * 14726602
*              REG 15 USER'S EXIT ADDRESS.                            * 14728602
         EJECT                                                          14730602
*    DATA AREAS =                                                     * 14733302
*        EOV WORKAREA.                                                * 14750002
*        DATA MANAGEMENT KEY USER LABEL WORKAREA                      * 14760002
*        USER KEY USER LABEL WORKAREA                                 * 14770002
*                                                                     * 14800002
*    CONTROL BLOCK =                                                  * 14850002
*        DCB                                                          * 14900002
*        TCB                                                          * 14950002
*        CVT                                                          * 15000002
*        DEB                                                          * 15150002
*                                                                     * 15200002
* TABLES =                                                            * 15250002
*        NONE.                                                        * 15300002
*                                                                     * 15350002
* MACROS =                                                            * 15400002
*        MODESET                                                      * 15450002
*        SETLOCK                                                      * 15460002
*        IECRES-LOAD                                                  * 15500002
*        IECRES-GET                                                   * 15550002
*        IECRES-UEXIT                                                 * 15560002
*        IECRES-FREE                                                  * 15570002
*        EXCP                                                         * 15600002
*        WAIT                                                         * 15650002
*        XCTLTABL                                                     * 15750002
*        IECDSECS                                                     * 15800002
*        IECEQU                                                       * 15850002
*                                                                     * 15900002
* CHANGE ACTIVITY =                                                   * 15950002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 16000002
*                                                                     * 16050002
*********************************************************************** 16100002
         EJECT                                                          16150002
         USING ULDMWK,R8                                         Y02082 25000002
         USING IHADCB,RDCB                                              25200021
         USING FORCORE,RCORE                                            25400021
         USING WTG,RWTG                                          Y02080 25450002
         USING TCB,RET                                                  25800021
         BALR  RBASE,0                  ESTABLISH BASE REGISTER         26000021
         USING *,RBASE                                                  26200021
*                                                                       26400021
*    GET CORE FOR WORK AREA, LABEL BUFFER AND PARAMTER LIST      Y02080 26450002
*                                                                Y02082 26500002
*    OBTAIN CORE FOR DATA MANAGEMENT KEY USER LABEL WORK AREAS   Y02082 26550002
*                                                                Y02082 26600002
         IECRES GET,LV=USERLDM,PREFIX=YES,SP=K229,ID=ULWA,       Y02144*26650002
               STM=(2,14,WTGPREFX)                               Y02082 26700002
*                                                                       26750002
         STM   RPAR,RC,K0(R1)           SAVE REGS 5-12 FOR CALLER       27200021
         LR    R8,R1                    SET BASE FOR ULWK DSECT         27600021
*                                                                Y02082 27610002
*    OBTAIN CORE FOR USER KEY USER LABEL WORK AREAS              Y02082 27620002
*                                                                Y02082 27630002
         IECRES GET,LV=USERLU,PREFIX=NO,SP=K229,KEY=USER,        Y02082*27650002
               STM=(2,14,WTGPREFX)                               Y02082 27700002
         EJECT                                                          27702002
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 27710002
         USING ULUWK,RA                 USER'S WORK AREA         Y02082 27750002
         LR    RA,R1                    ADDR OF GOTTEN CORE      Y02082 27760002
         L     R7,DXCCW5                PICK UP INFO AND SAVE IN DXCCW9 27800021
         NI    K28(R8),X'FF'-LASTNTRY   TURN OFF LAST ENTRY INDIC IF ON 28000021
         XC    DXCCW1(K80),DXCCW1       CLEAR CHAN PROG AREA            28200021
         ST    R7,DXCCW9                SAVE INFO FOR 554Z              28400021
*                                                                       28600021
*        DETERMINE IF A USER LABEL EXTENT HAS BEEN ALLOCATED FOR THIS   28800021
*        DATA SET.                                                      29000021
*                                                                       29200021
         CLI   DSCEXTYP,ULEXTYP         IS 1ST EXTENT FOR USER LABELS   29400021
         BNE   EDO18050                 NO EXTENT, GO TO USER           29600021
*                                                                       29800021
*        EXTENT EXISTS - PROCESS USER LABELS                            30000021
*                                                                       30200021
         XC    DXDAADDR(K8),DXDAADDR    ZERO IOBOADAD IN IOS' IOB       30400021
         MVC   DXDAADDR+K3(K4),DSCLOWLM  CCHH FROM START OF 1ST EXTENT  30600021
*                                                                       32400021
*        PROCESS USER TRAILER LABELS.                                   32600021
*                                                                       32800021
*        SET UP CHANNEL PROGRAM TO FIND UTL0                            33000002
*                                                                       33200021
*        STRUCTURE COUNT AND KEY FIELDS IN WORK AREA.  SET IOBDADAD     33400021
*        IN I/O SUPPORT'S IOB.                                          33600021
*                                                                       33800021
         LA    R1,ULWK8                                                 34000021
         ST    R1,DXCCW1                READ COUNT INTO WK1             34200021
         LA    R1,ULWK10                                                34400021
         ST    R1,DXCCW2                SEARCH ON KEY IN WK3            34600021
         LA    R1,DXCCW1                                                34800021
         ST    R1,DXCCW3                TIC TO CCW1                     35000021
         OC    DXCCW1(K32),ULCP13       OR CP SKELETON OVER ADDRESSES   35200021
         MVC   ULWK10(K4),UTLCONS3      KEY=UTLO FOR SEARCH KEY EQUAL   35400021
*                                                                       35600021
         BAL   RC,EDO18100              EXECUTE CP TO FIND UTL0         35800021
         TM    DXECB,ECBNOERR           CHECK FOR I/O ERROR             36000021
         BZ    EDO17200                 ERROR, BR TO SET UP EXIT TO USR 36200021
         EJECT                                                          36250002
*                                                                       36400021
*                        SET UP  CP TO WRITE USER TRAILE                36600021
*                        AS EACH LABEL (UTLN) IS WRITTEN, A FILE        36800021
*                           MARK (UTL(N+1)) WILL BE WRITTEN FOLLOWING   37000021
*                                                                       37200021
         XC    DXCCW1(K32),DXCCW1       CLEAR CHNL PGM 1 OUT            37400021
         BAL   RPARC,EDO18000           GO SET UP CP                    37600021
         OC    DXCCW1(K32),ULCP23       OR CP SKELETON OVER ADDRESSES   37800021
         MVC   DXCCW5(K24),DXCCW1       APPEND CP FOR WRITE CHECKING    38000021
         LA    R1,DXCCW5                                                38200021
         ST    R1,DXCCW6                TIC BACK TO CCW5                38400021
         MVI   DXCCW6,CCWTIC            RESTORE TIC OP                  38600021
         MVI   DXCCW7,CCWRDCKD          MAKE OP READ                    38800002
         OI    DXCCW7+K4,CCWSKIP        SET SKIP BIT ON                 39000002
         NI    DXCCW7+K4,X'FF'-CCWCMDCH  TURN OFF CC FLAG IN LAST CCW   39200021
         MVC   ULWK5(K12),ULWK8         SET UP COUNT, KEY FOR FILE MARK 39400021
         SR    R1,R1                    CLEAR RF                        39600021
         STC   R1,ULWK6+K3              DATA LENGTH=0 FOR FILE MRK      39800021
*                                       IF DISP=MOD,UTL0 MAY HAVE       40000021
*                                       LENGTH OF 80 BYTES              40200021
*                                                                       40400021
EDO17100 EQU   *                        GET COUNT                       40600002
         IC    R1,ULWK9                 R OF COUNT FOR UTL TO BE WRITTN 40800021
         BCTR  R1,0                     R-1                             41000021
         STC   R1,DXDAADDR+K7           R IN IOBDADAD                   41200021
         LA    R1,K2(,R1)               R-1+2=R+1                       41400021
         STC   R1,ULWK6                 R IN COUNT FIELD OF UTL(N+1)    41600021
*                                                                       41800021
         IC    R1,ULWK10+K3             N FROM LABEL TO BE WRITTEN      42000021
         LA    R1,K1(,R1)               N+1                             42200021
         STC   R1,ULWK7+K3              KEY FOR UTL(N+1)                42400021
*                                                                       42600021
         MVI   ULWK9+K3,K80             DATA LENGTH = 80 FOR UTLN       42800021
*                                                                       43000021
         CLI   ULWK10+K3,X'F8'          CHECK IF 8 TRAILERS WERE WRITTN 43200021
         BNL   EDO17300                 YES, BRANCH TO SET UP RETURN    43400021
*                                                                       43600021
         L     RPARC,ULWK7              GET UTLN                 Y02082 43650002
         MODESET KEYADDR=DXUKEY,WORKREG=1  ASSUME USER KEY       Y02082 43700002
         ST    RPARC,ULBUFR             PRIME BUFFER WITH UTLN   Y02082 43750002
         EJECT                                                          43800002
*                                                                       44000021
*        GO TO USER'S ROUTINE TO CONSTRUCT LABEL.                       44200021
*                                                                       44400021
         BAL   RPARC,EDO18200           GO EXIT TO USER'S ROUTINE       44600021
*        RETURN IN DATAMGT KEY                                   Y02082 44650002
         L     RPARC,ULWK7              UTL NUMBER               YM2891 44700002
         MODESET KEYADDR=DXUKEY,WORKREG=12 USER KEY              YM2891 44750002
         ST    RPARC,ULBUFR             UPDATE USER UTL NUMBER   YM2891 44800002
         MODESET EXTKEY=DATAMGT         RETURN TO DATAMGT KEY    YM2891 44850002
         LTR   RF,RF                    CHECK FOR RETURN CODE=0         45000021
         BZ    EDO17300                 CODE IS ZERO, BRANCH TO RETURN  45200021
         ST    RF,ULWK1                 SAVE RETURN CODE                45400021
*                                                                Y02082 45450002
*    COPY LABEL FROM USER'S USER LABEL WORK AREA                 Y02082 45500002
*                                                                Y02082 45550002
         L     RF,WTGPREFX              POINT TO PREFIX          Y02082 45560002
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y02082 45570002
         MODESET EXTKEY=SUPR            ASSUME KEY ZERO          Y02082 45580002
*    OBTAIN LOCAL LOCK                                           Y02082 45592002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*45594002
               RELATED=('PREVENT FREE USER CORE-RELEASED BELOW') Y02082 45596002
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 45598002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 45598402
*    VERIFY THAT USER STILL HOLDS USER LABEL WORK AREA           Y02082 45598802
         OC    ULUWK(USERLU),ULUWK      PGM CHECK IF NOT         Y02082 45599202
         MODESET EXTKEY=SUPR            ASSUME KEY ZERO          Y02082 45599602
         MVC   ULDMBUFR,ULBUFR          COPY USER LABEL          Y02082 45599702
         L     RF,WTGPREFX              POINT TO PREFIX          Y02082 45599802
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y02082 45599902
*    RELEASE LOCAL LOCK                                          Y02082 45649902
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=('SEE ABOVE')        Y02082 45659902
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 45669902
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 45679902
         EJECT                                                          45689902
         BAL   RC,EDO18100              GO WRITE LABEL                  45699902
*                                                                       45800021
         TM    DXECB,ECBNOERR           CHECK FOR I/O ERROR             46000021
         BZ    EDO17200                 YES, BR TO TAKE SPECIAL EXIT    46200021
         CLI   ULWK1+K3,XLOUTL          CHECK RET CODE FOR MORE LABELS  46400021
         BE    EDO17300                 NO, PREVIOUS LABEL WAS LAST     46600021
         CLI   ULWK1+K3,X08             CHECK,BR IF RETURN CODE         46800002
         BNE   EDO17300                 WAS NOT VALID                   47000021
*                                                                       47200021
         MVC   ULWK8(K12),ULWK5         UTL(N+1) BECOMES C,K OF NXT LBL 47400021
         B     EDO17100                 BR TO PROCESS NEXT LABEL        47600021
         SPACE 2                                                        47650002
EDO17200 EQU   *                        I/O ERROR ROUTINE               47800002
*                                                                       48000021
*        IF AN I/O ERROR OCCURS WRITING USER TRAILER LABELS, A SPECIAL  48200021
*        EXIT IS TAKEN TO THE USER'S ROUTINE.  INPUT TO THE USER'S      48400021
*        ROUTINE IS THE SAME AS FOR OTHER EXITS WITH ONE EXCEPTION-     48600021
*        IN THE THIRD WORD OF THE PARAMETER LIST, BIT 0 IS SET TO ONE   48800021
*        AND THE THREE LOW ORDER BYTES CONTAIN A POINTER TO STATUS      49000021
*        INFO (PTR TO IOB).                                             49200021
*                                                                       49400021
         LA    R1,DXIOB                 INSERT POINTER TO STATUS INFO   49600021
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY   @ZA28829   49800000
         ST    R1,ULPARM+K8             IN PARAMETER LIST               49850000
         OI    ULPARM+K8,ERROR          FLAG ERROR                      49900000
         BAL   RPARC,EDO18300           GO TO SYNCH TO USER             50200021
* RETURN IN DATAMGT KEY                                          Y02082 50250002
         EJECT                                                          50300002
*                                                                       50400021
*        FREE WORKAREAS AND RETURN TO IFG0554Z                          50600002
*                                                                       51000021
EDO17300 EQU   *                        SET RETURN FOR TRLR PROCESSING  51200021
*                                                                       51250002
*        FREEMAIN USER'S USER LABEL WORK AREA                    Y02082 57050002
*                                                                       57060002
         IECRES FREE,A=(RA),PREFIX=NO,LV=USERLU,SP=K229,         Y02082*57100002
               KEY=USER,STM=(2,14,WTGPREFX)                      Y02082 57150002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 57160002
         MVC   DXCCW5(K8),DXCCW9        RESTORE DXCCW5 FOR 554Z         58200021
*                                                                       58400021
         LR    R1,R8                    START OF AREA TO BE FREED       58600021
         LM    RPAR,RDEB,K0(R1)         RESTORE CALLING MODULE'S REGS   58800021
         EJECT                                                          58810002
*                                                                       58850002
*        FREE DATA MANAGEMENT WORKAREA AND LABEL BUFFER AND XCTL        58900002
*                                                                       58950002
         IECRES FREE,A=(R1),PREFIX=YES,STM=(0,14,WTGPREFX)       Y02082 59250002
         LA    RET,K4                                                   59400021
         LA    R7,EOVT                  SET XCTL TO 554Z                59600021
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              59800021
         LA    RWTG,DXXAREA             POINT TO EOV WTG                60000021
         IECRES LOAD,MODID=(R7),BRCODE=(RET),BRANCH=QUEUED       Y02080 60250002
         EJECT                                                          60400002
EDO18000 EQU   *                        BUILD CHANNEL PROGRAM           60600002
         LA    R1,DXDAADDR+K3                                           60800021
         ST    R1,DXCCW1                SEARCH ID FROM IOBDADAD+3       61000021
         LA    R1,DXCCW1                                                61200021
         ST    R1,DXCCW2                TIC TO CCW1                     61400021
         LA    R1,ULWK8                                                 61600021
         ST    R1,DXCCW3                WRITE C,K FROM ULWK1            61800021
         LA    R1,ULWK5                                                 62000021
         ST    R1,DXCCW4                WRITE LABEL FROM BUFFER         62200021
         BR    RPARC                    UNCONDITIONAL BRANCH            62400021
         SPACE 2                                                        62450002
*                                                                       62800021
*        NO USER LABEL TRACK WAS ALLOCATED.  EXIT TO USER'S ROUTINE     63000021
*        WITH POINTER TO LABEL BUFFER ZEROED.                           63200021
*                                                                       63400021
EDO18050 EQU   *                        ZERO BUFFER POINTER             63600002
         MODESET KEYADDR=DXUKEY,WORKREG=1 USER WORK AREA         Y02082 63650002
         XC    ULPARM+K8(K4),ULPARM+K8  CLEAR ANY ERROR INDICTNS        63800021
         SR    R1,R1                    BUFFER POINTER TO ZERO          64000021
         LA    RPARC,EDO17300           POINT TO RETURN AFTER SYNCH     64200021
         B     EDO18400                 GO SYNCH TO USER                64400021
         SPACE 2                                                        64800021
*                                                                       65000021
*        CLOSED SUBROUTINE TO ISSUE I/O OPERATIONS                      65200021
*        IT IS ASSUMED THAT ALL CONTROL BLOCKS HAVE ALREADY BEEN SET UP 65800021
*                                                                       65850002
EDO18100 EQU   *                        EXCP, WAIT, RETURN              66200002
         EXCP  DXIOB                                                    66400021
*                                                                       66600021
         WAIT  ,ECB=DXECB                                               66800021
*                                                                       67000021
         BR    RC                       UNCONDITIONAL BRANCH            67200021
         EJECT                                                          67400002
*                                                                       67450002
*        CLOSED SUBROUTINE TO TAKE USER EXIT. REGISTER           Y02082 67600002
*        CONTENTS UPON ENTRY TO THE USER EXIT ARE AS FOLLOWS     Y02082 67650002
*                        R0 - CONTAINS NO MEANINGFUL INFO               68600021
*                        R1 - PTR TO PARAMETER LIST                     68800021
*                    R2-R13 - USER'S CONTENTS BEFORE I/O SUPPORT        69000021
*                       R14 - RETURN ADDRESS (SET BY SYNCH)             69200021
*                       R15 - EXIT ADDRESS                              69400021
*                                                                       69600021
EDO18200 EQU   *                        ZERO PARMLIST                   69800002
         XC    ULPARM+K8(K4),ULPARM+K8  ZERO ERROR INDICATIONS          70000021
EDO18300 EQU   *                        GET LABEL BUFFER                70200002
         LA    R1,ULBUFR                PTR TO LABEL BUFFER             70400021
EDO18400 EQU   *                        SETUP PARM LIST                 70600002
         ST    R1,ULPARM                PTR TO LABEL BUFFER      Y02082 70650002
         L     R1,DXUDCBAD              GET USER'S DCB ADDR      Y02082 70700002
         ST    R1,ULPARM+K4             PUT IN PARM LIST         Y02082 70750002
         NI    ULDCBPTR,X'FF'-EOFFLG    INSURE EOF FLG IS OFF           71000021
         XC    ULPARM+K12(K4),ULPARM+K12  ZERO TOTALING AREA            71200021
         TM    DCBDSORG,DCBORGDA        CK FOR DIRECT ORGANIZATION      71400021
         BO    EDO18500                 BR IF DIRECT                    71600021
         TM    DCBOFLGS,DCBOPEN         CK IF DCB ALREADY OPEN          71800021
         BZ    EDO18500                 IF YES, CTL FROM OPEN, BYPASS   72000021
*                                       TOTALING                        72200021
         TM    DCBMACRF,DCBMEXCP        CK IF EXCP                      72400021
         BO    EDO18500                 BR IF EXCP,SKIP TOTALING        72600021
         TM    DCBOPTCD,DCBOPTT         TEST,BR IF USER TOTALING        72800021
         BZ    EDO18500                 HAS NOT BEEN REQUESTED          73000021
*                                                                       73200021
         L     RDEB,DCBDEBAD            GET ADDRESS OF USER'S DEB       73400021
         SR    R1,R1                    CLEAR WORK REG                  73600021
         IC    R1,DEBNMEXT-DEB(RDEB)    GET NUMBER OF EXTENTS           73800021
         SLL   R1,K4                    MULTIPLY BY 16                  74000021
         L     RDEB,K36(R1,RDEB)        GET ADDR TOTALING WORKAREA-     74200021
*                                       DEB ADDR+32+4+LENGTH EXTENTS    74400021
         USING TOTSAVWA,RDEB            SET BASE - TOTALING AREA        74600021
         MVC   ULTOTPTR,TOTEOVPT        CURRENT IMAGE AREA ADDR TO      74800021
*                                       USR LBL PARM LIST               75000021
         DROP  RDEB                     DROP TOTALING AREA BASE         75200021
         EJECT                                                          75400002
EDO18500 EQU   *                        UPDATE USER DCB, TAKE EXIT      75600002
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 75650002
         NI    DCBOFLGS,X'FF'-DCBOLOCK  IND USER EXIT TAKEN      Y02082 75700002
*                                                                Y02082 75750002
* COPY THE DCB FROM THE WORK AREA TO USER'S STORAGE              Y02082 75760002
*                                                                Y02082 75770002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,WTGPREFX)          Y02082 75780002
*                                                                Y02082 75790002
         LA    R1,ULPARM                POINT TO PARAMETER LIST         75800021
         IECRES UEXIT,EXITAD=K28(,R8),STM=(2,13,WTGPREFX)        Y02082 76000002
         EJECT                                                          76050002
         L     RDCB,DXUDCBAD            GET PTR TO USER'S DCB    Y02082 79680002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME USER'S KEY      Y02082 79701602
         OI    DCBOFLGS,DCBOLOCK        INDICATE RETURN FR USER  Y02082 79701802
         MODESET EXTKEY=DATAMGT         RESUME DATA MGT KEY      Y02082 79706402
         L     RDCB,DXPDCBAD            POINT TO COPIED DCB      Y02082 79710802
         OI    DCBOFLGS,DCBOLOCK        SET LOCK BIT = 1                80000021
         L     R1,ULWK10                GET UTLN                 Y02082 80200002
         MODESET KEYADDR=DXUKEY,WORKREG=12 ASSUME USER KEY       Y02082 80250002
         ST    R1,ULBUFR                RESET BUFFER WITH UTLN   Y02082 80300002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 80350002
         BR    RPARC                    UNCONDITIONAL BRANCH            80400021
         EJECT                                                          80450002
*                                                                       80600002
*        CONSTANTS                                                      80650002
*                                                                       80700002
         DS    0F                                                       80800021
UTLCONS3 DC    C'UTL0'                  KEY USED IN SEARCH KEY EQ       81000021
ULCP13   CCW   X'12',0,X'40',8          READ COUNT                      81200021
         CCW   X'29',0,X'40',4          SEARCH KEY EQUAL                81400021
         CCW   X'08',0,0,0              TIC                             81600021
         CCW   X'03',0,0,1              NOP                             81800021
*                                                                       82000021
ULCP23   CCW   X'31',0,X'40',5          SEARCH ID EQUAL                 82200021
         CCW   X'08',0,0,0              TIC TO CCW1                     82400021
         CCW   X'1D',0,X'40',92         WRITE CKD    UHLN     LABEL     82600021
         CCW   X'1D',0,X'40',12         WRITE CKD    UHL(N+1) FILE MARK 82800021
         CCW   X'1D',0,X'40',12         WRITE CKD    UTL0     FILE MARK 83000021
CCWSKIP  EQU   X'10'                    SKIP BIT IN CCW          Y02082 83010002
CCWRDCKD EQU   X'1E'                    READ COUNT,KEY,DATA      Y02082 83050002
         EJECT                                                          83100002
*                                                                       83200021
*        XCTL  TABLE FOR IFG0555B                                       83400021
*                                                                       83600021
         XCTLTABL SVC=055,ID=(EOVT,4Z),BRT=YES,LENGTH=           Y02080 83800002
         IECDSECS CVT,TCB,TIOT,SMF,DCB,DEB,UCB,MAIN,UNITTAB,           X84000021
               USERLAB,USERTOT,WTG,PREFX,PSA,RRPL,EXPAND=YES     Y02144 84200002
         IECEQU                                                         84250002
         END                                                            84400021
./  ADD  SSI=81440196,NAME=IFG0555H
         TITLE 'IFG0555H                      END OF VOLUME DA OUTPUT -*00200002
                BUILD DEB FUNCTION'                                     00250002
IFG0555H CSECT                                                          00450002
*********************************************************************** 00460002
*                                                                     * 00470002
*                                                                     * 00480002
*          VS2 RELEASE 02 DELETIONS                                   * 00490002
*                                                                     * 00492002
*          VS2 RELEASE 3 DELETIONS                                    * 00492403
*0000007475,019419,196918-196951,197328                        @Y30LSBS 00492803
*                                                                       00493124
*          VS2 RELEASE SU24                                    @G24LSFS 00493524
*DELETE FIX FOR APAR OZ16031                                   @G24LSFS 00493924
*197148-197188,668054-668159                                   @G24LSFS 00494324
*D388020-456000,463000-467600                                  @G24LSFS 00494724
*                                                              @ZM44640 00495124
*                                                                       00495524
*          VS2 RELEASE 3.7 CHANGES/DELETIONS                          * 00496037
*0000196885,666852-667452,668054                               @ZA13555 00498037
*0000                                                          @ZA16031 00499037
*0000193700,193800,A905980                                     @ZA13538 00499224
*0000                                                          @ZA17972 00499624
*********************************************************************** 00500002
*                                                                     * 00550002
* MODULE NAME = IFG0555H (OS/VS2)                                     * 00600002
*                                                                     * 00650002
* DESCRIPTIVE NAME = END OF VOLUME DA OUTPUT - BUILD DEB FUNCTION     * 00660002
*                                                                     * 00670002
* COPYRIGHT = NONE                                                    * 00680002
*                                                                     * 00690002
* STATUS = RELEASE 2, LEVEL 0                                         * 00692002
*                                                                     * 00694002
* FUNCTION =                                                          * 00696002
*        THIS MODULE IS ENTERED FROM -                                * 00706002
*        IFG0554C (ALIAS FOR IFG0194C) IF A NEW VOLUME WERE MOUNTED   * 00716002
*        IFG0554P AFTER EXTENDING ON THE SAME VOLUME                  * 00718002
*        IFG0555J AFTER RETURNING FROM PROCESSING USER HEADER LABELS  * 00720002
*                                                                     * 00720102
*        1) THE DEB IS PAGE FREED IF IT HAD BEEN PAGE FIXED.          * 00722102
*        THIS MODULE SAVES THE DEB IN THE EOV WORKAREA AND            * 00723402
*        UNCHAINS IT FROM THE TCB IT IS CHAINED TO (NOT NECESSARILY   * 00727902
*        THE CURRENT TCB.                                             * 00729902
*                                                                     * 00730002
*        2) IF THE DEB IS CHAINED TO THE CURRENT TCB, THE DEB IS      * 00730802
*        DELETED FROM THE DEB TABLE WITH THE DEBCHK-DELETE MACRO.     * 00731202
*        OTHERWISE, THE DEB ADDRESS IS LOCATED IN THE DEB TABLE AND   * 00731602
*        INVALIDATED (UNTIL THE NEW DEB IS BUILT) BY FLIPPING THE LOW * 00732002
*        ORDER BIT IN THE DEB ADDRESS.                                * 00732402
*                                                                     * 00732502
*        3) THE DEB IS FREED USING THE BRANCH ENTRY TO FREEMAIN,      * 00733302
*        DIRECTED TO THE TCB THE DEB WAS CHAINED TO.                  * 00733702
*                                                                     * 00734102
*        4) STORAGE FOR A NEW DEB IS OBTAINED USING THE BRANCH ENTRY  * 00734502
*        TO GETMAIN DIRECTED TO THE TCB THE DEB WAS CHAINED TO. THE   * 00734902
*        NEW DEB IS CONSTRUCTED FROM THE CONTENTS OF THE OLD DEB      * 00735002
*        SAVED IN THE EOV WORKAREA AND THE DSCB(S) READ BY THE        * 00735802
*        PREVIOUS MODULES.                                            * 00736202
*                                                                     * 00736602
*        5) THE DEB IS CHAINED TO THE TCB WHICH THE OLD DEB WAS       * 00737002
*        CHAINED TO. IF THAT IS THE CURRENT TCB, THE NEW DEB ADDRESS  * 00737402
*        IS ADDED TO THE DEB TABLE USING THE DEBCHK-ADD MACRO.        * 00737502
*        OTHERWISE THE ENTRY IN THE DEB TABLE POINTING TO THE OLD DEB * 00738302
*        IS  REPLACED WITH THE ADDRESS OF THE NEW DEB.                * 00738702
         EJECT                                                          00739102
*        6) AFTER BUILDING THE DEB, IF A NEW VOLUME IS NOW BEING      * 00739502
*        PROCESSED THE USER HEADER LABEL MODULE, IFG0555J, IS GIVEN   * 00739902
*        CONTROL IF USER LABELS PROCESSING IS REQUIRED.               * 00740002
*                                                                     * 00740802
*        7) UPON RETURN FROM USER LABEL PROCESSING, OR IF IT IS NOT   * 00741202
*        REQUIRED, THE DEBDCBAD IN THE NEW DEB IS POINTED TO THE USER * 00741602
*        DCB, AND THE EOV ACCESS METHOD EXECUTOR, IFG0551L, IS GIVEN  * 00742002
*        CONTROL UNLESS THE DCB IS USING THE EXCP ACCESS METHOD. IN   * 00742402
*        THIS CASE THE USER DCB IS REFRESHED FROM THE COPY DCB, THE   * 00742502
*        EOV WORKAREA IS FREED AND THE CALLER OF EOV IS RETURNED TO.  * 00742702
*                                                                     * 00743302
* NOTES                                                               * 00743402
*        1) IF THE DEB IS NOT CHAINED OFF THE CURRENT TCB'S DEB       * 00743802
*        CHAIN, THE DEBCHK-DELETE, DEBCHK-ADD LOGIC IS AVOIDED        * 00743902
*        BECAUSE DEBCHK-ADD REQUIRES THE DEB TO BE CHAINED OFF THE    * 00744002
*        CURRENT TCB'S DEB CHAIN.                                     * 00744102
*                                                                     * 00744902
*        2) A DIRECTED FREEMAIN/GETMAIN IS USED TO FREE THE OLD DEB   * 00745302
*        AND OBTAIN CORE FOR THE NEW DEB SO THE CORE IS ATTACHED TO   * 00745702
*        THE TCB UNDER WHICH THE DEB WAS OPENED AND WILL BE FREED     * 00746102
*        DURING CLOSE. THIS TCB'S ADDRESS IS IN DEBTCBAD.             * 00746502
*                                                                     * 00746702
*        3) IF THE EXTENT IS ON ONE OF THE  MSS SUBSYSTEM'S           * 00746803
*        VIRTUAL DASD PACKS, AN ICBACREL MACRO (SVC 126) IS           * 00747003
*        ISSUED TO GET STAGING SPACE FOR THE EXTENT.  STAGING         * 00747103
*        WILL BE INHIBITED IF THE EXTENT IS ALLOCATED IN CYL-         * 00747203
*        INDERS.  THE PARAMETER LIST AREA FOR THIS MACRO IS           * 00747303
*        GOTTEN AND FREED VIA THE IECRES MACRO.  DXCCW2+4 WILL        * 00747403
*        SAVE THE POINTER TO THIS LIST.                               * 00747503
*                                                                     * 00747603
*    DEPENDENCIES =                                                   * 00747703
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 00748302
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 00749102
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 00749902
*                                                                     * 00750002
*    RESTRICTIONS = NONE                                              * 00753302
*                                                                     * 00756602
*    REGISTER CONVENTIONS =                                           * 00759902
*            R2 POINTS TO DCB                                         * 00763202
*            R4 POINTS TO OPEN WORK AREA                              * 00765202
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 00765602
*            R6 POINTS TO THE WTG TABLE                               * 00766002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 00766502
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 00766602
*            R10 POINTS TO THE UCB                                    * 00777702
*            R11 POINTS TO THE DEB.                                   * 00779702
*                                                                     * 00787702
*    PATCH LABEL = SEE NEXT TO LAST LABEL BEFORE ORG STATEMENT AT END * 00788102
*                  OF LISTING.                                        * 00788502
         EJECT                                                          00788602
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 00788702
*                                                                     * 00788802
*    PROCESSOR = ASSEMBLER XF                                         * 00792502
*                                                                     * 00794502
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 00794902
*                  ORG STATEMENT AT END OF LISTING                    * 00795302
*                                                                     * 00795702
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 00796102
*                  PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY, * 00796202
*                  LINK PACK AREA RESIDENT/PAGEABLE                   * 00812102
*                                                                     * 00822102
* ENTRY POINT = IFG0555H FROM:                                        * 00824102
*                 IFG0554C MOUNT VERIFY                               * 00824502
*                 IFG0554P DA OUTPUT                                  * 00824902
*                 IFG0555J DA OUTPUT USER HEADER LABELS               * 00825302
*                                                                     * 00826102
*    PURPOSE = SEE FUNCTION                                           * 00828102
*                                                                     * 00833402
*    LINKAGE =                                                        * 00835402
*        THIS MODULE IS GIVEN CONTROL THROUGH THE IECRES-LOAD MACRO   * 00835802
         EJECT                                                          00840602
* INPUT =                                                             * 00841302
*        ENTERED IN PROTECT KEY 5.                                    * 00841402
*        THE DEB'S DEBDCBAD POINTS TO THE COPIED DCB.                 * 00841502
*        REGISTER 2 POINTS TO THE COPIED DCB                          * 00841702
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 00841802
*        REGISTER 10 CONTAINS THE CURRENT UCB ADDRESS                 * 00841902
*        REGISTER 14 CONTAINS A BRANCH TABLE OFFSET -                 * 00891902
*              0 - RETURN FROM USER LABEL MODULE IFG0555J             * 00901902
*              4 - ENTRY FROM IFG0554C AFTER MOUNTING A NEW VOLUME    * 00911902
*              16 - ENTRY FROM IFG0554P AFTER EXTENDING ON THE        * 00921902
*              CURRENT VOLUME.                                        * 00931902
*                                                                     * 00941902
* OUTPUT =                                                            * 00991902
*        A NEW DEB IS BUILT, CHAINED TO THE TCB, AND IN THE DEB TABLE * 01001902
*                                                                     * 01003902
*        IFG0555J                                                     * 01011902
*              CONTROL IS PASSED IN PROTECT KEY 5.                    * 01021902
*              THE DEBDCBAD POINTS TO THE COPIED DCB.                 * 01031902
*              REGISTER 2 POINTS TO THE COPIED DCB.                   * 01033902
*              REGISTER 4 POINTS TO THE EOV WORKAREA                  * 01035902
*              DXRETMOD INDICATES IFG0555H IS TO BE RETURNED CONTROL  * 01037902
*              REGISTER 12 CONTAINS THE USER EXIT ENTRY FROM THE DCB  * 01039902
*              EXIT LIST, OR ZEROS IF USER LABELS ARE NOT SPECIFIED   * 01040302
*              IN THE JFCB BUT A USER LABEL TRACK IS ALLOCATED.       * 01041102
*        IFG0551L                                                     * 01041502
*              CONTROL IS PASSED IN PROTECT KEY 5.                    * 01041602
*              REGISTER 2 POINTS TO THE COPIED DCB.                   * 01041802
*              REGISTER 4 POINTS TO THE EOV WORKAREA                  * 01058502
*        EXIT TO CALLER                                               * 01068502
*              USER DCB REFRESHED FROM COPY                           * 01070502
*              DEB POINTS TO USER DCB                                 * 01072502
*              REGISTER 15 = 0                                        * 01074502
         EJECT                                                          01075202
* EXIT-NORMAL =                                                       * 01091902
*        IFG0555J DA OUTPUT USER HEADER LABELS                        * 01141902
*        IFG0551L BSAM/QSAM END OF VOLUME EXECUTOR                    * 01191902
*        CALLER OF EOV                                                * 01241902
*                                                                     * 01291902
* EXIT-ERROR =                                                        * 01341902
*        IFG0550P PROBLEM DETERMINATION WITH INTERNAL ABEND CODE      * 01351902
*        IN REGISTER 0 -                                              * 01361902
*              199 - CAUSING 437-0C ABEND, DEB NOT IN DEB TABLE       * 01371902
*              111 - CAUSING 737-34 ABEND, ACQUIRE FAILED             * 01376903
*                                                                     * 01381903
*        DMABCOND PCK IF PAGE FREE RETURN CODE                   YM5929 01386903
*                                                                     * 01391902
* EXTERNAL REFERENCES = SEE BELOW                                     * 01441902
*                                                                     * 01491902
*    ROUTINES =                                                       * 01541902
*        IFG019RA TO TRANSFER CONTROL THROUGH IECRES MACRO            * 01551902
*                                                                     * 01552002
*        IEAVPSIB VIA CVTVPSIB TO PAGE FREE DEB                  YM5929 01552102
*        R0 = 0 INDICATING NO ECB                                YM5929 01552302
*        R1 = X'20', ADDR OF DEB PREFIX: START OF PAGE FREE      YM5929 01552502
*        R2 = ADDR OF LAST BYTE OF DEB + 1: END OF PAGE FREE     YM5929 01552702
*        R4 = ADDRESS OF TCB FROM DEBTCBAD                       YM5929 01552902
*                                                                     * 01591902
*    DATA AREAS =                                                     * 01641902
*        NONE                                                         * 01651902
*                                                                     * 01691902
*    CONTROL BLOCK =                                                  * 01741902
*        DEB                                                          * 01751902
*        DCB                                                          * 01761902
*        TCB                                                          * 01771902
*        CVT                                                          * 01781902
*                                                                     * 01791902
* TABLES = EOV WORK AREA                                              * 01841902
*                                                                     * 01891902
* MACROS = DEBCHK, MODESET, SETLOCK, IECRES, IECDSECS, ICBACREL@Y30LSBS 01941903
*                                                                     * 01991902
* CHANGE ACTIVITY =                                                   * 02041902
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD          * 02051902
*                                                                     * 02091902
*********************************************************************** 02141902
         EJECT                                                          02191902
*                                                                     * 15000021
ERR199   EQU   199                      INTERNAL ABEND CODE      Y02082 15420002
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        15600021
         USING FORCORE,RCORE                                            15800021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 15850002
         USING UCB,RUCB                                                 16200021
         USING DEBBASIC,RDEB                                     YM1272 16400002
         USING DCBRELAD,RDCB                                            16600021
         USING TIOENTRY,RTIOT           TIOT ENTRY USING         YM3116 16650002
         USING *,RBASE                                                  16800021
*                                                                       17200021
*        DETERMINE ENTRY CONDITION                                      17400002
*                                                                       18000021
         B     EDO22700(RET)            BRANCH TABLE                    18400021
*                                                                       18600021
EDO22700 EQU   *                        BRANCH TABLE                    18800002
         B     EDO24800                 RETURNING FROM UL PROCESSING    19000002
         NOP   EDO22700                 NO ENTRY OFFSET 4        YM1193 19200002
         B     EDO22710                 ENTRY FROM NEW VOL MNT   Y02134 19250002
         B     EDO22720                 ENTRY FROM IFG0554P      Y02134 19300002
*                                                                Y02134 19350002
EDO22710 EQU   *                        ENTRY FROM NEW VOL MNT   Y02134 19360002
*                                                                Y02134 19370002
         L     RDEB,DCBDEBAD            LOAD DEB ADDRESS         Y02134 19372002
         LA    R8,K0(,RDEB)             DEB ADDRESS TO R8      @ZA13538 19374037
         SH    R8,MLCN10                POINT TO DEB PREFIX    @ZA13538 19382037
         MVC   DEB+K3-DEB(K5,R8),DXCCW7 CCHHR OF DSCB TO DEB   @ZA13538 19390037
         LA    RD,K4                    SET NEW VOL INDICATOR    Y02134 19398402
         B     EDO22730                 BRANCH TO PROCESS        Y02134 19408402
*                                                                Y02134 19442502
EDO22720 EQU   *                        ENTRY FROM IFG0554P      Y02134 19452502
*                                                                Y02134 19462502
         LA    RD,K1                    SET OLD VOL INDICATOR    Y02134 19464502
         EJECT                                                          19468502
EDO22730 EQU   *                        PROCESS DEB              Y02134 19468902
         OI    DXATALL,DXATFC           FORCE CLOSE ON ERROR     YM7099 19469102
*                                                                Y02134 19469302
         MVC   DXCCW6(K1),JFCBLTYP      SAVE LBL TYPE FOR UL     Y02134 19469902
         LA    RDEB,DEBBASIC            CLEAR HIGH BYTE          YM5929 19470002
         L     RF,DEBAPPAD              DEB AVT ADDR             YM5929 19470202
         SH    RDEB,MLCN36              POSITION AT APPENDAGES   Y02134 19479902
         TM    DEBSIOAB-DEBAVT(RF),X10  IS DEB FIXED             YM5929 19480002
         BZ    EDO22735                 BRANCH IF NOT            YM5929 19481002
         XR    RF,RF                    ZERO FOR IC              YM5929 19482002
         IC    RF,DEBLNGTH-DEBAVT(RDEB) LENGTH IN DWORDS OF DEB  YM5929 19483002
         SLL   RF,K3                    LENGTH IN BYTES OF DEB   YM5929 19484002
         AR    RF,RDEB                  END OF DEB + 1           YM5929 19485002
         LR    R1,RDEB                  START OF DEB             YM5929 19486002
*        PGFREE R,A=(1),EA=(15)         PAGE FREE DEB            YM5929 19486202
         LA    R2,K0(,RF)               END ADDRESS OF PGFREE    YM5929 19486402
         L     RF,DXXPREFX              PREFIX ADDRESS           YM5929 19486602
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM5929 19486802
         MODESET EXTKEY=SUPR            SETLOCK, PGFREE KEY      YM5929 19487002
EDO22731 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  YM5929*19487202
               RELATED=(LOCAL,IFG0555H(EDO22732)) GET LOCAL LOCK YM5929 19487402
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       YM5929 19487602
         EJECT                                                          19487802
         XR    R0,R0                    NO ECB                   YM5929 19488002
         ICM   R1,B'1000',=AL1(X20)     PGFREE BIT               YM5929 19488202
         LR    RDEB,RCORE               SAVE RCORE               YM5929 19488402
         L     RCORE,DEBTCBAD-DEB(,R1)  PGFREE BY TCB            YM5929 19488602
         L     RF,CVTPTR                CVT                      YM5929 19488802
         L     RF,CVTVPSIB-CVT(,RF)     IEAVPSIB ENTRY           YM5929 19488902
         BALR  RET,RF                   REGS 0-14 UNCHANGED      YM5929 19489102
         LTR   RF,RF                    ERROR IN PGFREE          YM5929 19489202
         BNZ   EDO25300                 BRANCH IF YES            YM5929 19489402
         LR    RCORE,RDEB               RESTORE RCORE            YM5929 19489502
         L     RDCB,DXPDCBAD            RESTORE DCB ADDRESS      YM5929 19489602
         L     RDEB,DCBDEBAD            RESTORE DEB ADDRESS      YM5929 19489702
         L     RF,DEBAPPAD              DEB AVT ADDR             YM5929 19489902
         NI    DEBSIOAB-DEBAVT(RF),K255-X10 ZERO DEB FIXED BIT   YM5929 19490002
         LA    RDEB,DEBBASIC            CLEAR HIGH BYTE          YM5929 19490102
         SH    RDEB,MLCN36              POSITION AT APPENDAGES   YM5929 19490202
         L     RF,DXXPREFX              PREFIX ADDRESS           YM5929 19490302
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM5929 19490402
EDO22732 SETLOCK RELEASE,TYPE=LOCAL,                             YM5929*19490502
               RELATED=(LOCAL,IFG0555H(EDO22731)) RELEASE LOCK   YM5929 19490602
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       YM5929 19490702
         MODESET EXTKEY=DATAMGT         RETURN TO D M KEY        YM5929 19490802
EDO22735 EQU   *                        MOVE DEB TO WORKAREA     YM5929 19490902
         MVC   JFCBDSNM(K74),DEBBASIC   MOVE DEB-APPENDAGE,OPEN  YM1272 19491102
*                                       PARAM,AND BASIC SECTS TO Y02134 19491902
*                                       WKAREA-ON TOP OF JFCB    Y02134 19493902
         LR    RC,RDEB                  DEB ADDR FOR FREEMAIN    Y02134 19495902
         AH    RDEB,MLCN36              RESET TO BASIC SECT      Y02134 19497902
         SR    R1,R1                    ZERO R1                  Y02134 19498302
         IC    R1,DEBNMEXT              NO. OF EXTENTS IN OLDDEB Y02134 19498702
         SLL   R1,K4                    MPY BY 16                Y02134 19499102
         SH    R1,MLCN6                 SUBTRACT 6 FOR MODIF,UCB Y02134 19499502
*                                           ADDR, AND BB         Y02134 19499602
         AR    R1,RC                    BUMP FWA PTR (APP.ADDR)  Y02134 19499702
         SR    R7,R7                    ZERO R7                  Y02134 19499802
         IC    R7,DEBNMSUB              NUMBER OF SUBROUT.       Y02134 19533202
         SLL   R7,K1                    MPY X 2                  Y02134 19543202
         SR    RF,RF                    CLEAR WORK REGISTER      Y02134 19553202
         IC    RF,DEBAMLNG              LENGTH FOR MEMBER NAME,  Y02134 19563202
         AR    R7,RF                    VOL SEQ AND NUM OF VOLS  Y02134 19565202
         ST    R7,DXCCW3                SAVE FOR LATER           Y02134 19565602
         LTR   R7,R7                    TEST IF NO BYTES TO MOVE A40437 19566002
         BZ    EDO22740                 BRANCH IF NO BYTES       A40437 19566402
         BCTR  R7,0                     SUB ONE FOR EXECUTE      Y02134 19566502
         EX    R7,EDO25650              MOVE SUBRTINES,VOLSQ,NO. Y02134 19577602
*                                           VOLS TO SAVE AREA    Y02134 19587602
         EJECT                                                          19587702
*                                                                       19588002
*        PUT NEW EXTENT NUMBER AT DXCCW7+4 -                     Y02134 19588402
*        ZERO IF EXTENDED ON NEW VOLUME OR                       Y02134 19588802
*              FIRST EXTENT OF DATA SET JUST NOW OBTAINED        Y02134 19589602
*                                                                       19592502
EDO22740 EQU   *                        SET R7 TO SAVE OLD M     A40437 19594502
*                                                                Y02134 19594602
         XR    R7,R7                    CLEAR NO. OF EXTENTS     YM1252 19594902
*                                                                Y02134 19656202
*        UPDATE DEB VOL. SEQUENCE NUMBER                         Y02134 19666202
*                                                                Y02134 19676202
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    YM1184 19678202
         BO    EDO22744                 BRANCH EXCP, ASSUME PS   YM1184 19680202
*                                                                YM1184 19682202
         NC    DCBDSORG,DCBDSORG        CHECK IF DSORG SPECIFIED YM1184 19684202
         BZ    EDO22744                 BRANCH 0, ASSUME PS      YM1184 19684602
*                                                                YM1184 19685002
         TM    DCBDSORG,DCBDSGPS        PHYSICAL SEQUENTIAL DCB  YM1184 19685402
         BNO   EDO22745                 BRANCH IF NOT PS         YM1184 19685902
*                                                                YM1184 19686002
EDO22744 EQU   *                        IF PS, SET VOLSEQ        YM1184 19686102
*                                                                YM1184 19687202
         MVC   JFCBDSNM+K75(1),DXVOLSEQ+1 MOVE IN SEQ NO.      @ZA13555 19688537
*                                                                YM1184 19689602
EDO22745 EQU   *                        CONTINUE                 YM1184 19690702
         CH    RD,MLCN1                 EXTEND ON OLD VOLUME     YM1252 19694003
         BNE   EDO22750                 BRANCH IF NEW VOLUME     Y02134 19694103
         IC    R7,DEBNMEXT              PICK UP NO. DEB EXTENTS  Y02134 19696202
         CLI   DEBNMEXT,K1              ONE EXTENT.Q             A40053 19697302
         BNE   EDO22750                 NO, CONTINUE             A40053 19698402
         LA    R1,DEBBASND              PT TO DA SECTION         YM1272 19699502
         USING DEBDASD,R1               BASE FOR DA SECTION      YM1272 19700602
         CLI   DEBSTRCC,ALLBITS         DUMMY EXTENT.Q           A40053 19701702
         BNE   EDO22750                 NO, CONTINUE             A40053 19702802
         SR    R7,R7                    YES, FIRST EXTENT DUMMY  A40053 19703902
EDO22750 EQU   *                        NEW VOLUME               Y02134 19705002
         DROP  R1                                                YM1272 19706102
         ST    R7,DXCCW7+K4             STORE NEW -M- FOR LATER  Y02134 19712802
         USING DEBDASD-(DEBBASND-DEBBASIC),RDEB                @G24LSFS 19714824
         MVC   OLDSTRCC(1),DEBSTRCC     OLD DEB CYL NUMBER     @G24LSFS 19715324
         DROP  RDEB                                            @G24LSFS 19716124
         USING DEBBASIC,RDEB                                   @G24LSFS 19716924
*                                                              @G24LSFS 19718824
*                                                              @Y30LSBS 19722803
*        ZERO DXCCW2+4 - ASSUME NO VIRTUAL  MSS DASD           @Y30LSBS 19724803
*        IF VIRTUAL DASD, GET 96 BYTES FOR PARAMETER LIST      @Y30LSBS 19726803
*        PARTIALLY FORMAT THE HEADER AND SAVE ADDR IN DXCCW2+4 @Y30LSBS 19728803
*                                                              @Y30LSBS 19730803
         XC    DXCCW2+K4(K4),DXCCW2+K4  ZERO POINTER TO LIST   @Y30LSBS 19731203
         TM    UCBTBYT2,UCBRVDEV        IS OLD VOL VIRT DASD   @Y30LSBS 19731603
         BNO   EDO22753                 NO, NOTHING TO DO THEN @Y30LSBS 19732003
         TM    DCBDSORG,DCBDSGIS        IS IT AN ISAM D.S.     @Y30LSBS 19732403
         BO    EDO22753                 ISAM CYLINDER FAULTS   @Y30LSBS 19732503
         IECRES GET,PREFIX=YES,ID=MSSH,LV=ACQPLN,              @Y30LSBS.19732603
               STM=(2,14,WTGPREFX)                             @Y30LSBS 19732703
         USING ACQLST,R1                ACQUIRE ADDRESSABILITY @Y30LSBS 19734703
         ST    R1,DXCCW2+K4             SAVE POINTER TO CORE   @Y30LSBS 19742703
         LA    RF,AREXT                 POINT TO START OF ENTS @Y30LSBS 19748703
         ST    RF,ARECB                 SAVE IT IN ECB AREA    @Y30LSBS 19750703
         DROP  R1                                              @Y30LSBS 19750803
EDO22753 EQU   *                                               @Y30LSBS 19751103
*                                                              @Y30LSBS 19751503
         EJECT                                                          19752703
*                                                                       19790202
*              DELETE OLD DEB FROM THE DEB TABLE                        19795102
*                                                                       19800021
         L     R1,DEBTCBAD              TCB ADDRESS              YM2133 19860000
         LA    R1,K0(R1)                ZERO HIGH ORDER BYTE     YM2133 19870000
         L     RF,DXTCBADR              CURRENT TCB ADDR         Y02082 19880002
         LA    RF,K0(RF)                ZERO HIGH ORDER BYTE     YM2133 19884000
         CLR   R1,RF                    IS DEB ON CURRENT TCB    YM2133 19886000
         BNE   EDO22755                 NO - BYPASS DEBCHK DLTE  Y02134 19890002
         L     R1,DXPDCBAD              GET PTR TO COPIED DCB    Y02082 19892002
         DEBCHK (1),TYPE=DELETE         DELETE DEB               Y02082 19900002
         B     EDO22780                 BYPASS DEBTABLE SEARCH   YM2133 19910000
         EJECT                                                          19910802
*                                                                YM2133 19912000
*        SEARCH DEBTABLE FOR OLD DEB ADDRESS                     YM2133 19914000
*                                                                YM2133 19916000
EDO22755 EQU   *                        GET TABLE OFFSET         Y02134 19920002
         USING TCB,R1                   R1 CONTAINS TCB ADDR     YM2133 19930000
         L     RC,TCBJSCB               ADDR OF JOB STEP JSCB    YM2133 19940000
         DROP  R1                                                YM2133 19942000
         L     R1,DCBDEBAD              GET ADDRESS OF DEB       Y02082 19943202
         LA    R1,K0(,R1)               CLEAR HIGH ORDER BYTE    Y02082 19943602
         BCTR  R1,R0                    POINT TO                 YM2133 19944400
         BCTR  R1,R0                    DEBTBLOF FLD IN DEB PFX  YM2133 19944800
         LH    R1,K0(R1)                GET DEB TABLE OFFSET     Y02080 19945002
         SLL   R1,K2                    MPY BY ENTRY LENGTH      YM2133 19946000
         ST    R1,DXCCW4+K4             SAVE DEB TABLE OFFSET    YM1387 19946402
         L     RF,DXXPREFX              GET PREFIX               Y02080 19946502
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 19946602
         MODESET  EXTKEY=ZERO           KEY 0                    Y02080 19946702
EDO22758 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02080X19946802
               RELATED=(LOCAL,IFG055H(EDO22765,EDO23000))        Y02080 19947202
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 19947402
         LM    R0,RF,IECREGSV-IECPREFX(RF)   RESTORE REGS        Y02080 19947802
EDO22760 EQU   *                        DEBTABLE CHECK           YM2133 19948002
         USING IEZJSCB,RC               ADDRESSABILITY FOR JSCB  YM2133 19948400
         L     R7,JSCBDBTB              DEB TABLE ADDRESS        YM2133 19948800
         LA    RF,K0(R1,R7)             POINT TO ENTRY           YM2133 19949200
         CLM   RDEB,B'0111',K1(RF)      CORRECT ENTRY            Y02082 19949602
         BE    EDO22770                 YES - CONTINUE           YM2133 19949700
         EJECT                                                          19949902
*        DEB NOT IN DEB TABLE - RELEASE LOCAL LOCK AND                  19950102
*        CALL PROBLEM DETERMINATION                                     19950302
*                                                                       19950502
         L     RF,DXXPREFX              GET PREFIX               Y02080 19950702
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 19951702
         MODESET  EXTKEY=ZERO           KEY 0                    Y02080 19952702
EDO22765 SETLOCK RELEASE,TYPE=LOCAL,                             Y02080X19959702
               RELATED=(LOCAL,IFG0555H(EDO22758))                Y02080 19969702
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 19970702
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         YM3116 19970902
*                                                                       19971702
*        REREAD JFCB TO REFRESH WORKAREA OVERLAID BY DEB         YM3116 19972702
*                                                                       19973702
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDRESS   YM3116 19974702
         LA    RF,TIOEJFCB              GET JFCB ADDRESS ADDRESS YM3116 19975702
         IECRES LOCJFCB,(RF)            LOCATE JFCB              YM3116 19976702
         MVC   DXJBF(JFCBLGTH),INFMJFCB-INFMJFCB(RF) MOVE JFCB   YM3116 19977702
*                                                                       19978702
         LA    RWTGC,DXXENTRY           SET RWTGC FOR RES RTN    YM2133 19983000
         LA    RWTG,DXXAREA             POINT TO EOV WTG         YM2133 19983100
         DMABCOND ERR199,MODPD5H        LOAD ERROR CODE          YM2133 19983202
         EJECT                                                          19983402
*                                                                Y02080 19987602
*        SETUP TO UNCHAIN DEB FROM TCB AND FREE DEB STORAGE             19987802
*                                                                       19988002
EDO22770 EQU   *                        CONTINUE                 YM2133 19988802
         MODESET EXTKEY=ZERO            DEB TABLE                Y02082 19991202
         OI    K3(RF),K1                INVALIDATE OLD ENTRY     YM2133 19992800
         LA    RC,DEBBASIC              DEB ADDRESS              YM1272 20011402
         LA    RET,K36                  DEB PREFIX LENGTH        YM2133 20014902
         SLR   RC,RET                   POINT TO DEB PREFIX      YM2133 20018402
         B     EDO22790                 BRANCH IN KEY 0 TO       Y02082 20020402
*                                       UNCHAIN DEB - LOCK HELD  Y02082 20020802
         SPACE 2                                                        20021602
EDO22780 EQU   *                        GET LOCK TO UNCHAIN DEB  YM2133 20021902
         L     RF,WTGPREFX              PT TO PREFIX             Y02082 20025402
         USING IECPREFX,RF                                       Y02082 20028902
         STM   R0,RET,IECREGSV          SAVE REGS THRU LOCK      Y02082 20032402
*        OBTAIN LOCAL LOCK                                       Y02082 20035902
         MODESET EXTKEY=ZERO            KEY FOR SETLOCK, DEB CHN Y02082 20039402
EDO22785 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*20042902
               RELATED=(LOCAL,IFG0555H(EDO23000))                Y02082 20046402
         LM    R0,RET,IECREGSV          RESTORE REGS             Y02082 20049902
         EJECT                                                          20050902
EDO22790 EQU   *                        REMOVE DEB FROM CHAIN    Y02082 20059902
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 20061902
         LR    R7,RDEB                  PRIME REG 7              Y02082 20069902
         L     R1,DEBTCBAD              PICK UP TCB ADDR.               20099902
         LA    R8,K0(R1)                SAVE TCB ADDR& CLEAR HIBYTE     20200021
         LA    R1,K4(,R1)                                               20400021
EDO22800 EQU   *                        CHECK NEXT DEB                  20600002
         CLC   DCBDEBAD+K1(K3),DEBDEBAD+K1-DEBBASIC(R1) R1=ADDR  YM1482 20800002
*                                       OF PREV DEB/TCB          YM1482 21000002
         BE    EDO22900                 CONTINUE                        21200021
         L     R1,DEBDEBAD-DEBBASIC(,R1) R1=ADDR OF NEXT DEB     YM1482 21400002
         B     EDO22800                 GO CK AGAIN                     21600021
EDO22900 EQU   *                        CONTINUE                        21800002
         L     RET,DEBDEBAD             PT TO NEXT DEB           Y02082 21810002
         ICM   RET,K8,DEBDEBAD-DEBBASIC(R1) PRIME HI BYTE        YM1482 21820002
         ICM   R7,K8,DEBDEBAD-DEBBASIC(R1)                       YM1482 21830002
         MODESET EXTKEY=ZERO            KEY FOR SETLOCK, DEB CHN Y02082 21832002
         CS    R7,RET,DEBDEBAD-DEBBASIC(R1) DECHAIN DEB          YM1482 21840002
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 21842002
         BNZ   EDO22790                 BR IF NOT SUCCESSFUL     Y02082 21850002
         OI    DXATEOV,DXATDCHN         SHOW DEB DECHAINED       Y02144 21852002
         EJECT                                                          21872002
*                                                                       21892002
*        BRANCH ENTER FREEMAIN TO FREE OLD DEB STORAGE                  21912002
*                                                                       21932002
         SR    RET,RET                  CLEAR LENGTH             Y02080 22200002
         IC    RET,DEB+K32-DEB(,RC)     DEB LENGTH IN DUBL WDS.  Y02080 22400002
         SLL   RET,K3                   MPY X 8                  Y02080 22600002
         L     RF,DXXPREFX              EOV WORKAREA PREFIX      Y02082 22604002
         STM   R0,RET,IECREGSV          SAVE REGS FOR FREEMAIN   Y02082 22620002
         LR    RA,RF                    SAVE PREFIX ADDR         Y02082 22640002
         L     R7,DXASCBAD              ASCB ADDR FOR FREEMAIN   Y02082 22660002
         L     RCORE,DEBTCBAD           TCB ADDR FROM DEB        Y02082 22680002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE          Y02082 22700002
         LA    R1,K0(,RC)               CLEAR HIHG BYTE OF DEBAD Y02082 22704002
         MODESET EXTKEY=SUPR            FREEMAIN KEY             Y02082 22720002
         FREEMAIN RU,LV=(RET),A=(1),SP=230,KEY=5,BRANCH=YES      Y02082*22740002
                                        FREE DEB DIRECTED TO TCB Y02082 22760002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       Y02082 22780002
         LM    R0,RET,IECREGSV-IECPREFX(RA) RESTORE REGS         Y02082 22800002
         OI    DXATEOV,DXATDFRE         SHOW DEB FREED           Y02144 22950002
         EJECT                                                          22970002
*                                                                       23000021
*        CALCULATE SIZE OF NEW DEB                                      23200002
*                                                                       23400021
         SR    RET,RET                  ZERO REG.14                     23600021
         IC    RET,DSCNOEXT             NO.EXT IN NEW DSCB              23800021
         STC   RET,JFCBDSNM+K52         SAVE IN DEBNMEXT                24000021
         SLL   RET,K4                   MPY X 16                        24200021
         LR    RC,RET                   SAVE IN RC                      24400021
         L     R7,DXCCW3                PICK UP NO. SUBRT.BYTES         24600021
         AR    RET,R7                   ADD NO.SUBR BYTES(+4)           24800021
         LA    R0,K68(,RET)             ADD 68 FOR BASIC,APP,OPN Y02080 25000002
         ST    R0,DXCCW3+K4                                      Y02080 25200002
*                                                                       25400021
*****    GET CORE FOR NEW DEB  *****        PARAMETERS                  25600021
*                                                                       25800021
         SPACE 1                                                        26600021
         L     RF,DXXPREFX              PREFIX ADDR              Y02082 26604002
         STM   R0,RET,IECREGSV          SAVE REGS FOR GETMAIN,   Y02082 26608002
*                                       AND SETLOCK              Y02082 26612002
         LR    RA,RF                    SAVE PREFIX ADDR IN RA   Y02082 26620002
         DROP  RF                                                Y02082 26624002
         L     R7,DXASCBAD              ASCB ADDR FOR GETMAIN    Y02082 26640002
         L     RCORE,JFCBDSNM+K36+(DEBTCBAD-DEBBASIC) TCB ADDR   YM3873 26660002
*                                       IN OLD DEB SAVED IN W/A  YM3873 26680002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE          Y02082 26700002
         MODESET EXTKEY=SUPR            GETMAIN KEY              Y02082 26720002
         GETMAIN RU,LV=(0),SP=230,KEY=5,BRANCH=YES GETMAIN DEB   Y02082 26740002
         EJECT                                                          26740202
         MODESET EXTKEY=SUPR            SETLOCK KEY              Y02082 26760002
EDO23000 SETLOCK RELEASE,TYPE=LOCAL,    RELEASE LOCAL LOCK       Y02082*26780002
               RELATED=(LOCAL,IFG0555H(EDO22785,EDO22758))       Y02082 26800002
         LM    R2,RET,IECREGSV-IECPREFX+R2*K4(RA) RESTORE REGS   Y02082 26820002
         OI    DXATEOV,DXATDNEW         SHOW NEW DEB CORE GOTTEN Y02144 29450002
         LR    RDEB,R1                  SET UP NEW DEB POINTER          29800021
*                                                                       30000021
*        MOVE DEB DATA FROM WKAREA TO NEW DEB CORE                      30200021
*                                                                       30400021
         MVC   DEBBASIC(K74),JFCBDSNM   MOVE BASIC,APP,OPEN PARM YM1272 30600002
*        DEBMODIF, UCB ADDRESS, DEB EXTENSION PTR, AND BB        Y02134 30800002
         AR    RC,RDEB                  ADD NO. EXTENT BYTES TO DEB     31000021
*                                           APPENDAGE ADDRESS           31200021
         SH    RC,MLCN6                 SUBTRACT 6-MOD.,UCBAD,BB        31400021
*                                           ARE ALREADY MOVED           31600021
         LTR   R7,R7                    TEST IF NO BYTES TO MOVE A40437 31660021
         BZ    EDO23050                 BRANCH IF NO BYTES       A40437 31720021
         BCTR  R7,0                     SUBTRACT ONE FOR EXECUTE        31800021
         EX    R7,EDO25600              R7=NO.SUBR BYTES+4              32000021
*                                                                       32200021
***      MOVE SUBROUTINES TO NEW DEB  ***                               32400021
*                                                                       32600021
EDO23050 EQU   *                        NO BYTES TO MOVE         A40437 32700002
         XC    JFCBDSNM+K72(K2),JFCBDSNM+K72  YES, ZERO BB              33200021
         ST    RUCB,DXCCW10             UCB ADDR TO HOLD                33400021
         MVC   JFCBDSNM+K69(K3),DXCCW10+K1  MOVE TO NEW DEB AREA        33600021
EDO23100 EQU   *                        APPENDAGE                       33800002
         ST    RDEB,DXCCW10+K4          DEB-USE FOR APPENDAGE ADDR      34000021
         MVC   DEBAPPAD+K37(K3),DXCCW10+K5  TO APPENDADR-+36 BECAUSE    34200021
*                                       OF RDEB SETTING                 34400021
*                                                                       34600021
*        COMPUTE DEB LENGTH IN DOUBLE WORDS AND INSERT                  34800021
*        IN DEB LENGTH FIELD                                            35000021
*                                                                       35200021
         L     RF,DXCCW3+K4             NO. OF GOT CORE BYTES           35400021
         LA    RF,K7(,RF)               SET RF =DEB CORE LENGTH+7       35600021
         SRL   RF,K3                    DIVIDE BY EIGHT                 35800021
         STC   RF,DEBBASIC+K32          STORE DEB LTH IN DW      YM1272 36000002
         EJECT                                                          36000202
*                                                                       36200021
*        SET DEB REGISTER TO POINT TO BASIC SECTION OF DEB              36400021
*                                                                       36600021
         LA    RDEB,K36(,RDEB)          ESTABLISH DEB POINTER           36800021
         ST    RDEB,DXCCW11+K4          SAVE DEB ADDRESS                37000021
         L     R7,DXDEBXAD              GET DEB EXTENSION ADDR   Y02134 37010002
         USING DEBXTN,R7                                         Y02134 37020002
         ST    RDEB,DEBXDBPR            PUT DEB ADDR IN DEBX     Y02134 37030002
         DROP  R7                                                Y02134 37040002
         MVC   DCBDEBAD+K1(K3),DXCCW11+K5  STORE IN DCB                 37200021
*                                                                       37400002
******   INSERT DSCB EXTENTS INTO NEW DEB  ******                       37600021
*                                                                       37800021
         LR    R7,RCORE                 R7 SET AS CORE REGISTER         38000021
         ST    R7,DXWORK1               SAVE PTR TO F1           Y02134 38050002
         LA    R7,K50+K7(,R7)           ADD HEX 39 TO POS AT EXTNT      38200002
         LA    R8,DEBBASND              PT TO DA SECTION         YM1272 38400002
         USING DEBDASD,R8               BASE TO DA SECTION       YM1272 38450002
         SR    RWTG,RWTG                                                38600021
         STC   RWTG,DXCCW5              SET-M-TO ZERO                   38800021
*                                                                       38830021
         MVC   DXCCW6+K1(K6),DSCEXTYP   SAVE ANY UL EXTENT INFO  M1784  38860021
         CLI   DSCEXTYP,ULEXTYP         IS FIRST EXTENT A UL EXT M1784  38890021
         BE    EDO23700                 BR IF YES TO SKIP UL EXT M1784  38920021
*                                                                       38950021
EDO23200 EQU   *                        BUILD AN EXTENT                 39000002
         MVC   DEBDVMOD(K6),JFCBDSNM+K68 MOVE IN M,UCBAD AND BB  YM1272 39800002
         MVI   DEBDVMOD,X10             PERMIT SEEK HH COMMANDS  YM1272 40000002
         CLI   DSCBEXTY-DXDSCB(R7),X80+X01 CYLINDER ALLOCATION   Y02134 40200002
         BE    EDO23300                 YES,FILE MASK ALREADY SET UP    40400021
         OI    DEBDVMOD,DEBOFDCB        SET TO INHIBIT ALL       YM1272*40600002
                                        SEEK COMMANDS                   40800002
*                                                                       41200021
*                   FILE MASK SETTING NOW COMPLETE                      41400021
*                                                                       41600021
         EJECT                                                          41620002
EDO23300 EQU   *                        CHECK IF DCBFDAD UPDATE NOW     41800002
         MVC   DEBSTRCC(K8),DSCBLLMT-DXDSCB(R7) LOWER EXT        YM1272 42000002
*                                                                       42200021
*              MOVE -M- AND STARTING BBCCHH TO DEB     ******           42400021
*                                                                       42600021
         L     RC,DXCCW7+K4             PICK UP OLD DEB NOEXT OR 0      42800021
         CR    RC,RWTG                  IS THIS THE CCHH FOR DCB        43600021
         BNE   EDO23600                 NO,TRANSFER                     43800021
         TM    DCBMACRF,DCBMEXCP        YES,CHECK FOR EXCP DCB          44200021
         BZ    EDO23500                 BR IF NO TO FULL DISK ADDR      44400002
         TM    DCBMACRF+K1,DEPEND       DOES DEV.DEP.SECT EXIST         44600021
         BZ    EDO23600                 NO,DONT UPDATE ADDR             44800021
EDO23500 EQU   *                        NO EXCP DCB                     45000002
         STC   RC,DCBFDAD               STORE M- ZERO FOR NEW VOL.      45200021
*                                       NO.OLD DEB EXTNTS FOR SAME      45400002
         MVC   DCBFDAD+K1(K6),DEBBINUM  STARTING BBCCHH TO DCB   YM1272 45600024
         MVI   DCBFDAD+K7,K0            SET R = 0                       45800024
*                                                                       46000024
*        COMPUTE NUMBER OF TRACKS                                       46200021
*                                                                       46250024
EDO23600 EQU   *                        DON'T UPDATE ADDR               46450024
         ST    RDCB,DXCCW7              SAVE DCB PIINTER                46800021
         STM   RTIOT,RD,DXCCW8          SAVE REGS.                      47000021
         L     RF,CVTPTR                ADDR OF COMM VECTOR TABLE       47200021
         L     RF,CVTPRLTV-CVT(,RF)     CONVERT ROUTINE ADDR MBB-TTR    47400021
         LA    R1,DXDEB                 LOAD ADDR. OF DUMMY DEB         47600021
         LA    RDCB,DXCCW5              LOAD ADDR OF MBBCCHHR           47800021
         MVI   DXCCW5,K0                STORE-M- IN DUMMY AREA          48000021
         LA    RWTG,K1(,RWTG)                                           48200021
         MVC   DXCCW5+K1(K2),JFCBDSNM+K72  STORE BB IN INPUT PARAM.     48400021
         MVC   DXCCW5+K3(K4),DSCBLLMT-FORCORE(R7)  MOVE LOWER CCHH      48600021
         MVI   DXCCW5+K7,K0             ZERO R                          48800021
*                                                                       49000021
****     CONVERT LOWER MBBCCHHR TO TTR  ***                             49200021
*                                                                       49400021
         BALR  RET,RF                   GO TO CONVERT RTN               49600021
         ST    R0,DXCCW4                SAVE CONVERSION RESULT(TTR)     49800021
         EJECT                                                          49820002
*                                                                       50000021
****     NOW CONVERT UPPER EXTENT BOUNDARY ***                          50200021
*                                                                       50400021
         L     RF,CVTPTR                ADDR OF COMM VECTOR TABLE       50600021
         MVC   DXCCW5+K3(K4),DSCBULMT-DXDSCB(R7) UPPER EXTENT    Y02134 50800002
         L     RF,CVTPRLTV-CVT(,RF)     CONVERT RTN ADDR  MBB-TTR       51000021
         BALR  RET,RF                   BRANCH TO CONVERSION ROUT.      51200021
         L     RDCB,DXCCW7              RESTORE DCB PTR.                51400021
         LM    RTIOT,RD,DXCCW8                                          51600021
         S     R0,DXCCW4                SUBTRACT LO FROM HI TTR         51800021
         SRL   R0,K16                   RIGHT JUSTIFY                   52000021
         LR    R1,R0                                                    52200021
         LA    R1,K1(,R1)               ADD ONE                         52400021
         STH   R1,DEBNMTRK              NO. TRKS TO DEB EXTENT   YM1272 52600002
         SR    R1,R1                    ZERO RF                         52800021
         IC    R1,DEBNMEXT              NUMBER EXTENTS IN NEW DEB       53000021
         CR    R1,RWTG                  CHECK FOR LAST EXTENT           53200021
         BE    EDO24100                 YES,GO                          53400021
         LA    R8,K16(,R8)              BUMP PTR TO DEB EXTENTS         53600021
         DROP  R8                                                YM1272 53650002
*                                                                       53800021
EDO23700 EQU   *                        SKIP USL EXT                    54000002
         LA    R7,K10(,R7)              ADD 10 TO DSCB EXTNT REG        54200021
         LA    R1,K3                    SET REG =3,NO EXTNTS IN FM1     54400021
         CLI   DXCCW6+K1,ULEXTYP        IS THERE A UL EXTENT IN  M1784  54600021
         BNE   EDO23800                 FMT 1 DSCB, BR IF NO     M1784  54800021
         BCTR  R1,K0                    UL EXTNT, ONLY 2 EXTNTS IN F1   55000021
EDO23800 EQU   *                        NO FMT 1 DSCB                   55200002
         CR    R1,RWTG                  CK IF LAST EXTNT FROM F1 IN DEB 55400021
         BNE   EDO23200                 MERGE NEXT EXTENT               55600021
         L     R1,DXWORK1               LOAD DSCB PTR            Y02134 55650002
         CLI   DSCBNEXT+K4-DXDSCB(R1),K0 CHECK CCHHR OF NXT DSCB Y02134 55800002
         BE    EDO24100                 TRANSFER IF ZEROS--FINSHED      56000021
*                                                                       58400021
         MVC   DXCCW11+K2(K4),DSCLOWLM-DXDSCB(R1) CCHH FOR 555J  Y02134 59600002
*                                                                       59800021
         L     R7,CORECH(,R1)           GET FORMAT 3 PTR         Y02134 59850002
         LA    R1,L'JFCBDSNM(,R7)       BUMP PASSED KEY          Y02134 59900002
         ST    R1,DXWORK1               SAVE PTR FOR NEXT EXTENT Y02134 59950002
*                                                                Y02134 60000002
         MVC   DSCBFMID+K44-DXDSCB(K91,R7),DSCBFMID+K45-DXDSCB(R7)      62200002
*                                           LAY FORMAT ID AND FOLLOW    62400021
*                                           KEY PORTION DIRECTLY        62600021
         B     EDO23200                 GO INSERT FORMAT 3 DSCB INTO    63000021
*                                            NEW DEB                    63200021
         EJECT                                                          63220002
*                                                                       65200021
*              INCLUDE NEW DEB IN THE CHAINING                          65400021
*                                                                       65600021
EDO24100 EQU   *                        USE TCB IN DEB                  65800002
         L     R1,DEBTCBAD              TCB ADDR                        66000021
EDO24105 EQU   *                        CHAIN NEW DEB            Y02082 66010002
         L     R7,TCBDEB-TCB(,R1)       PT TO FIRST DEB          Y02080 66060002
         MVC   DEBDEBAD+K1(K3),K9(R1)   PT TO DEB                       66200002
         LA    RDEB,K0(,RDEB)           CLEAR HI-ORDER BYTE      Y02082 66250002
         MODESET EXTKEY=SUPR            TCB KEY                  Y02082 66454902
         CS    R7,RDEB,K8(R1)           CHAIN NEW DEB            Y02082 66456002
         MODESET EXTKEY=DATAMGT         KEY OF EOV               Y02082 66456402
         BNZ   EDO24105                 BR IF NOT SUCCESS        Y02082 66457502
         NI    DXATEOV,ALLBITS-DXATDCHN SHOW DEB CHAINED         Y02144 66467502
         EJECT                                                          66468302
*                                                                YM2133 66470000
*        CHECK FOR DEB CHAINED TO CURRENT TCB                    YM2133 66480000
*                                                                YM2133 66490000
         L     RF,DXTCBADR              CURRENT TCB ADDR         Y02082 66494002
         LA    RF,K0(RF)                ZERO HIGH ORDER BYTE     YM2133 66504502
         LA    R1,K0(R1)                ZERO HIGH ORDER BYTE     YM2133 66508002
*                                                                YM2133 66511502
*        THE EOV WAS ISSUED FROM A TASK DIFFERENT THAN THE ONE   YM2133 66515002
*        IN WHICH THE DEB WAS CREATED IF THE TCB ADDRESS IN THE  YM2133 66518502
*        DEB IS NOT THE SAME AS THE CURRENT TCB ADDRESS.         YM2133 66522002
*                                                                YM2133 66525502
         CLR   R1,RF                    IS DEB ON THIS TCB       YM2133 66529002
         BNE   EDO24110                 NO - DON'T ISSUE DEBCHK  YM2133 66532502
*                                                                YM2133 66536002
*        EOV IN SAME TASK AS OPEN   -   ISSUE DEBCHK ADD         YM2133 66539502
*                                                                YM2133 66543002
         LA    R7,K3                    DEBAMTYP NEGATIVE OFFSET Y01021 66546502
         SR    RDEB,R7                  ADDRESS DEBAMTYP         Y01021 66550000
         IC    R7,K0(RDEB)              GET ACCESS METHOD TYPE   Y01021 66560000
         XC    K0(K3,RDEB),K0(RDEB)     ZERO DEBAMTYP, DEBTBLOF  Y01021 66570002
         L     R1,DXPDCBAD              DEBCHK PROTECTED DCB     Y02082 66572002
         DEBCHK (R1),TYPE=ADD,AM=((R7)) ADD DEB                  Y02082 66580002
         LR    RDEB,R1                  RELOAD DEB ADDRESS       Y01021 66590000
         B     EDO24120                 GO TO UHL PROCESSING     YM2133 66590400
         EJECT                                                   YM2133 66590800
*                                                                YM2133 66591200
*        THE FOLLOWING CODE IS EXECUTED IN LIEU OF DEBCHK        YM2133 66591600
*        WHENEVER THE DEB IS CHAINED TO A TCB DIFFERENT THAN     YM2133 66591700
*        THE CURRENT ONE.  THIS IS ACCOMPLISHED BY REPLACING     YM2133 66602100
*        THE EXISTING DEBTABLE ENTRY WITH THE NEW DEB ADDRESS.   YM2133 66612700
*                                                                YM2133 66633500
EDO24110 EQU   *                        OBTAIN LOCK FOR DEBTABLE YM2133 66643502
         L     RF,DXXPREFX                                       Y02080 66643702
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 66643902
         MODESET  EXTKEY=ZERO           KEY 0                    Y02080 66644102
EDO24112 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02080X66644502
               RELATED=(LOCAL,IFG0555H(EDO24114))                Y02080 66645502
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 66645602
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 66646102
         L     RF,DXTCBADR              GET CURRENT TCB          Y02080 66646502
         USING TCB,RF                   ESTABLISH TCB ADDR       Y02080 66647502
         L     RF,TCBJSCB               GET ADDR OF JSCB         Y02080 66648502
         DROP  RF                                                Y02080 66649502
         USING IEZJSCB,RF               ESTABLISH JSCB ADDR      Y02080 66650502
         L     R1,JSCBDBTB              GET ADDR OF DEB TABL     Y02080 66651502
         DROP  RF                                                Y02080 66652502
         L     RF,DXCCW4+K4             GET SAVED OFFSET         YM1387 66653502
         LA    RDEB,K0(RDEB)            ZERO HIGH ORDER BYTE     YM2133 66655500
         MODESET EXTKEY=ZERO            DEB TABLE                Y02082 66657502
         ST    RDEB,K0(RF,R1)           PLACE NEW ADDR IN TBL    Y02080 66659502
         EJECT                                                          66660302
         L     RF,DXXPREFX              GET PREFIX               Y02080 66660502
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 66660702
EDO24114 SETLOCK RELEASE,TYPE=LOCAL,                             Y02080X66661502
               RELATED=(LOCAL,IFG0555H(EDO24112))                Y02080 66663502
         MODESET  EXTKEY=DATAMGT        EOV KEY                  Y02082 66664102
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 66665302
EDO24120 EQU   *                        UHL PROCESSING           YM2133 66673502
         STCM  RDEB,B'0111',DCBDEBAD+K1 REFRESH DCBCOPY'S DEBAD  Y02082 66675202
*                                                                       66758400
******** END OF NEW DEB CONSTRUCTION *********                          66800021
*                                                              @Y30LSBS 66801003
*        IF DXCCW2+4 POINTS TO A PARAMETER LIST, THE VOLUME IS @Y30LSBS 66802003
*         MSS VIRTUAL DASD AND STAGING SPACE MUST BE ACQUIRED. @Y30LSBS 66803003
*        THIS LIST SPACE MUST ALSO BE FREED.                   @Y30LSBS 66804003
*                                                              @Y30LSBS 66805003
         USING ACQLST,R8                ACQUIRE ADDRESSABILITY @G24LSFS 66805424
         L     R8,DXCCW2+K4             SEE IF THERE'S A LIST  @G24LSFS 66805724
         LTR   R8,R8                    IF SO,  MSS            @G24LSFS 66806724
         BZ    EDO24140                 IF NOT, NOTHING TO DO  @Y30LSBS 66807724
         LR    RC,RDEB                  RC IS DEB POINTER      @G24LSFS 66809124
         USING DEBDASD-(DEBBASND-DEBBASIC),RC                  @G24LSFS 66809224
         CLI   DEBSTRCC,ALLBITS         IS THIS A DUMMY EXTENT @G24LSFS 66809324
         BE    EDO24130                 YES, NO NEW EXTENTS    @G24LSFS 66809424
         SR    R1,R1                    CLEAR REG              @G24LSFS 66809524
         IC    R1,DEBNMEXT              DEB EXTENT NUMBER      @G24LSFS 66809624
         CH    RD,NEWVOL                ON NEW VOL             @G24LSFS 66809724
         BE    EDO24125                 YES,GET NEW EXTENTS    @G24LSFS 66809824
**                                                             @G24LSFS 66810124
**   IF OLD EXTENT WAS DUMMY,ALL EXTENTS ARE NEW***************@G24LSFS 66810224
**                                                             @G24LSFS 66810424
         CLI   OLDSTRCC,ALLBITS         WAS OLD EXTENT DUMMY   @G24LSFS 66810824
         BE    EDO24125                 YES,ALL EXTENTS NEW    @G24LSFS 66810924
         L     RF,DXCCW7+4              OLD DEB EXTENT NUMBER  @G24LSFS 66811024
         SR    R1,RF                    NUMBER OF NEW EXTENTS  @G24LSFS 66811224
         SR    RC,RC                    CLEAR DEB REG          @G24LSFS 66811324
         IC    RC,DEBEXSCL              EXTENT SCALE           @G24LSFS 66811424
         SLL   RF,0(RC)                 DISPLACEMENT TO EXTS   @G24LSFS 66811524
         LA    RC,0(RF,RDEB)            PTR TO REF NEW EXTS    @G24LSFS 66811724
EDO24125 EQU   *                        CONTINUE               @G24LSFS 66811824
         STC   R1,ARNMEXTS              EXTENT NUMBER TO PARM  @G24LSFS 66811924
         LA    RF,AREXT                 EXTENTS AREA IN PARM   @G24LSFS 66812024
         OI    ARFLAG,INHIBST           SET TO INHIBIT STAGE   @G24LSFS 66812124
EDO24126 EQU  *                         LOOP THROUGH ALL EXTS  @G24LSFS 66812224
         MVC   K0(K2,RF),DEBSTRCC       START AND END CYLINDER-@G24LSFS 66812324
         MVC   K2(K2,RF),DEBENDCC       TO ACQUIRE PARM LIST   @G24LSFS 66812424
**                                                             @G24LSFS 66812524
** IF ANY EXTENT IS NOT ON A CYLINDER BOUNDARY THEN ALL THE    @G24LSFS 66812624
** EXTENTS WILL BE STAGED.                                     @G24LSFS 66812724
**                                                             @G24LSFS 66812824
         TM    DEBDVMOD,X'18'           IS EXT NOT CYL BNDRY.  @G24LSFS 66812924
         BO    EDO24127                 YES,STAGE ALL EXTENTS  @G24LSFS 66813024
         TM    DCBMACF1,DCBMRPT1        IS POINT BEING USED    @G24LSFS 66813124
         BZ    EDO24128                 NO,DON'T STAGE IF CYL  @G24LSFS 66813224
EDO24127 EQU   *                        HERE TO RESET INHIBIT  @G24LSFS 66813324
         NI    ARFLAG,X'FF'-INHIBST     STAGE THESE EXTENTS    @G24LSFS 66813424
EDO24128 EQU   *                        CONTINUE TO INHIBIT    @G24LSFS 66813524
         DROP  RC                                              @G24LSFS 66813624
         LA    RF,K4(RF)                INCR PARM LIST PTR     @G24LSFS 66813724
         LA    RC,K16(RC)               INCR DEB EXT PTR       @G24LSFS 66813824
         BCT   R1,EDO24126              BRANCH IF MORE EXTENTS @G24LSFS 66813924
         OI    ARFLAG,ARSEC             SET SECONDARY EXTEND   @G24LSFS 66815124
         XC    ARECB(K4),ARECB          ZERO ECB ADDRESS       @Y30LSBS 66815324
         MVC   ARVOL,UCBVOLI            MOVE VOLID TO HEADER   @Y30LSBS 66815424
         MVI   ACQLST+K3,ACQPLN         SET LIST LENGTH        @Y30LSFY 66815524
         MVI   AROP,ACQOP               ACQ. OPCODE IN LIST    @Y30LSFY 66815624
         ICBACREL TYPE=ACQ,MF=(E,ACQLST)  GET STAGING SPACE    @Y30LSBS 66815724
         LA    RWTGC,DXXENTRY           SET RWTGC FOR RES RTN  @Y30LSFY 66815824
         LA    RWTG,DXXAREA             POINT TO EOV WTG       @Y30LSFY 66815924
         LTR   RF,RF                    ANY ERRORS             @Y30LSBS 66816024
         BZ    EDO24130                 NO   FREE THE CORE     @Y30LSBS 66816124
*****    ACQUIRE FAILED - ABEND                                @Y30LSFY 66816224
* NOTE: IFG0199B MAY DESTROY THE 2ND WORD OF THE PARM LIST ON ABEND     66816324
*                                                              @Y30LSFY 66816403
ERR111   EQU   111                      IDMS FAILURE CODE      @Y30LSFY 66816603
         LR    RB,R1                    PASS PARM LIST PTR     @Y30LSFY 66816803
         DMABCOND ERR111,MODPD5H        XCTL TO PROB DET       @Y30LSFY 66817203
*                                                              @Y30LSFY 66817403
EDO24130 EQU   *                                               @Y30LSBS 66817503
         DROP  R8                                              @G24LSFS 66817724
         IECRES FREE,A=(1),PREFIX=YES,STM=(R2,RET,WTGPREFX)    @Y30LSBS 66818003
*                                                              @Y30LSBS 66818403
EDO24140 EQU   *                                               @Y30LSBS 66819003
         EJECT                                                          66820002
*                                                                       67000021
***********    USER HEADER LABEL PROCESSING SECTION                     67200021
*                                                                       67400021
*        REREAD JFCB TO REFRESH WORKAREA OVERLAID BY DEB         YM3116 67420002
*                                                                       67430002
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDRESS   YM3116 67440002
         LA    R7,TIOEJFCB              GET JFCB ADDRESS ADDRESS YM3116 67450002
         IECRES LOCJFCB,(R7)            LOCATE JFCB              YM3116 67460002
         MVC   DXJBF(JFCBLGTH),INFMJFCB-INFMJFCB(R7) MOVE JFCB   YM3116 67470002
*                                                                       67480002
         LA    R7,K1                                                    67600021
         CR    RD,R7                    WAS EXTEND ON SAME VOLUME       67800021
         BE    EDO24800                 SKIP USER HEADER LABELS         68000021
         MVC   DSCEXTYP(K6),DXCCW6+K1   RESTORE UL EXTENT INFO   M1784  68100021
         TM    DXCCW6,JFCSL+JFCBUL      TEST IF LABEL TYPE IS SUL       68200021
         BNO   EDO24300                 BRANCH IF NOT SUL               68400021
         TM    DCBMACRF,DCBMEXCP        IS THIS EXCP DCB        YA02186 68420002
         BZ    EDO24150                 BRANCH IF NO            YA02186 68440002
         TM    DCBMACRF,DCBMRFE         IS EXIT LIST PRESENT     Y02082 68460002
         BZ    EDO24300                 BRANCH IF NO             Y02082 68480002
         TM    DCBMACRF,DCBMRCI         IS DSORG PRESENT         Y02082 68500102
         BZ    EDO24160                 BRANCH IF NO-ASSUME PS   Y02082 68520002
EDO24150 EQU   *                        TEST DSORG               Y02082 68540002
         TM    DCBDSORG,DCBORGPS        TEST IF DSORG IS PHYS SEQ       68600021
         BZ    EDO24300                 BRANCH IF NOT PHYS SEQ          68800002
         TM    DCBMACRF,DCBMEXCP        IS THIS EXCP DCB        YA02186 68800202
         BO    EDO24160                 BRANCH IF YES           YA02186 68800402
         TM    JFCDSORG,JFCORGDA        IS DATA SET BDAM        YA02186 68850002
         BO    EDO24300                 BR IF YES-SPECIAL EXIT  YA02186 68900002
EDO24160 EQU   *                        LOOK FOR UHL EXIT       YA02186 68950002
         L     RC,DCBEXLST              PICK UP EXIT LIST FROM DCB      69000021
         LA    RC,K0(,RC)               ZERO HI ORDER BYTE OF EXIT LST  69200021
         LTR   RC,RC                    IS EXIT LIST ZERO               69400021
         BZ    EDO24300                 GO TO CHECK PRE-ALLOC UL TRK    69600021
         MODESET KEYADDR=DXUKEY,WORKREG=7 USER'S EXIT LIST       Y02082 69650002
EDO24200 EQU   *                        PROCESS ENTRY                   69800002
         CLI   K0(RC),K2                IS THIS ACTIVE EXIT 2           70000021
         BE    EDO24400                 GO TO PROCESS USER LABELS       70200021
         CLI   K0(RC),K2+LASTNTRY       SEE IF LAST IND ALSO ON         70400021
         BE    EDO24400                 GO TO PROCESS USER LABELS       70600021
         TM    K0(RC),LASTNTRY          IS THIS LAST ENTRY IN LIST      70800021
         LA    RC,K4(,RC)               POINT TO NEXT ENTRY             71000021
         BZ    EDO24200                 NO, BRANCH                      71200021
         EJECT                                                          71201002
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 71250002
EDO24300 EQU   *                        CHECK PRE-ALLOC UL TRK          71400002
         L     RC,MLZEROS               VALUE FOR IFG0555J       A40053 71500021
         CLI   DSCEXTYP,ULEXTYP         USER LABEL TRACK PRE-ALLOCATED  71600021
         BE    EDO24500                 YES, SPECIAL EXIT        A40053 71800021
         B     EDO24800                 BYPASS                          72000021
*                                                                       72200021
EDO24400 EQU   *                        PROCESS USER LABELS             72400002
         L     RC,K0(,RC)               PICK UP USER'S EXIT ADDRESS     72600021
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 72650002
         LR    R7,RC                                                    72800021
         LA    R7,K0(,R7)               ZERO HI ORDER BYTE              73000021
         LTR   R7,R7                    IS EXIT ADDRESS ZERO            73200021
         BZ    EDO24300                 YES,CK PRE-ALLOC UL TRK         73400021
EDO24500 EQU   *                        SPECIAL EXIT                    73600002
         SR    RET,RET                  SET BRANCH TABLE RET TO  A40053 73900021
*                                       ZERO                     A40053 74000021
         MVC   DXRETMOD,LOAD0H0H        ID OF CURRENT MODULE            74200021
         LA    R7,LOAD2Q                LOAD 555J                       74400021
         LA    RWTGC,DXXENTRY           SET RWTGC FOR RES RTN    M1773  74450021
         LA    RWTG,DXXAREA             POINT TO EOV WTG                74800021
         IECRES LOAD,MODID=(R7),BRCODE=(RET),BRANCH=QUEUED       Y02080 75050002
         EJECT                                                          75200002
*                                                                       76600021
*        EXIT TO EXCP-DCB CALLER OR GO TO IFG0551L                      76620002
*                                                                       77000021
EDO24800 EQU   *                        TURN OFF EOF BIT                77600002
         NI    DCBOFLGS,K255-DCBOEOF    TURN OFF FILE MARK FLAG         77800021
*                        CHECK IF EXCP SPECIFIED                        78000021
EDO24900 EQU   *                        UPDATE DEBDCBAD                 79600002
         L     RDEB,DCBDEBAD            GET ADDR OF DEB          Y02082 81250002
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXUDCBAD+K1 POINT DEB  Y02082*81300002
                                        TO USER DCB              Y02082 81350002
         L     RF,DXDEBXAD              GET PTR TO DEB EXTENSION YM1272 81450002
         NI    DEBXFLG1-DEBXTN(RF),ALLBITS-DEBXCDCB DEB PT USER  YM1272 81500002
         TM    DCBMACRF,DCBMEXCP        EXCP IND IN BIT 0               81600021
         BZ    EDO25100                 NO,BRANCH                       81800002
*                                                                Y02080 82600002
* FREE THE END OF VOLUME WORK AREA                               Y02080 82650002
*                                                                Y02080 82700002
         NI    DCBOFLGS,ALLBITS-DCBOBUSY  RESET I/O SUPPORT BIT  Y02080 83000002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(0,14,DXXPREFX)          Y02082 83002002
         LR    R1,RCORE                                          Y02080 83010002
         IECRES FREE,A=(1),PREFIX=EOV   RELEASE CORE             Y02080 83030002
         EJECT                                                          83031002
*                                                                Y02080 83050002
*        RETURN TO CALLER                                        Y02080 83100002
*                                                                Y02080 83150002
         SR    RF,RF                    ZERO RETURN CODE         Y02082 83170002
         IECRES EXIT                    RETURN                   Y02080 83200002
         SPACE 2                                                        83350002
EDO25100 EQU   *                        NO EXCP                         83800002
         MVC   DXXMODID,VOL1A           ACCESS METHOD EXECUTOR          84000021
         MVC   DXXMODEP+K1(K3),VOL1A+K2 ADDR OF 551L             Y02080 84200002
         SR    RF,RF                    ZERO WORK REG            YM0992 84300000
EDO25200 EQU   *                        BRANCH DIRECT                   84400002
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               Y02080 85050002
         SPACE 2                                                        85050202
EDO25300 DMABCOND PCK,PGFREE            PAGE FREE ERROR          YM5929 85050402
         EJECT                                                          85070002
*                                                                       85200021
*              EXECUTED INSTRUCTIONS                                    85400002
*                                                                       88000021
EDO25600 EQU   *                        USED IN EX INSTRUCTION          88200002
         MVC   DEB+K74-DEB(,RC),JFCBDSNM+K74  RESTORE SUBRTNS    Y02134 88400002
EDO25650 EQU   *                        USED IN EX INSTRUCTION          88420002
         MVC   JFCBDSNM+K74(K0),DEB+K74-DEB(R1)  SAVE SUBRTNS    Y02134 88450002
*                                                                       88600021
*                        CONSTANTS                                      88800021
*                                                                       89000021
         DS    0F                                                       90200021
MLZEROS  DC    X'02000000'              VALUE PASSED TO 555J            90400021
MLCN36   DC    H'36'                    HALF WORD OF 36          Y02134 90594002
MLCN6    DC    H'06'                    HALF WORD OF 6           Y02134 90596002
MLCN1    DC    H'1'                     HALF WORD CONSTANT OF 1  YM1252 90598002
MLCN10   DC    H'16'                    HALF WORD CONST OF 16  @ZA13538 90598124
OLDVOL   EQU   MLCN1                    EXTEND ON CURRENT VOL  @G24LSFS 90598224
NEWVOL   DC    H'4'                     EXTEND ON NEW VOL      @G24LSFS 90598324
*                                                              @Y30LSBS 90598424
*                                                              @Y30LSBS 90598524
*        SOME  MSS EQUATES                                     @Y30LSBS 90598624
*                                                              @Y30LSBS 90598724
*                                                              @Y30LSBS 90599024
ARSEC    EQU   X'10'                    SECONDARY EXTEND       @G24LSFS 90599124
INHIBST  EQU   X'20'                    INHIBIT STAGING        @Y30LSBS 90599224
ACQPLN   EQU   96                       LENGTH OF ICBACREL LIST@Y30LSBS 90599324
ACQOP    EQU   X'02'                    OPCODE FOR ACQUIRE     @ZM44640 90599624
         EJECT                                                          90600002
*                                                                       90800021
*        XCTL  TABLE FOR IFG0555H                                       91000021
*                                                                       91200021
         XCTLTABL SVC=055,ID=(MODPD5H,0P,VOL1A,1L,LOAD0H0H,5H,   YM1193X91500002
               LOAD2Q,5J),BRT=YES,LENGTH=                        YM1193 91800002
         EJECT                                                   YM2133 91810000
         IECEQU IEZDEB=YES                                       YM1272 91830002
         IECDSECS CVT,TCB,DCB,IEZDEB,UCB,MAIN,WTG,PREFX,TIOT,    YM3116*91900002
               JSCB,PSA,EXPAND=YES                               YM1272 91950002
ACQLST   DSECT                                                 @Y30LSFY 91950203
OLDSTRCC EQU   DXCCW+4                  OLD DEB START CYL NO.  @G24LSFS 91950324
         ICBACREL TYPE=ACQ,MF=L         LIST FORM OF ACQUIRE   @Y30LSBS 91950403
         END                                                            92950224
./  ADD  SSI=32770515,NAME=IFG0555J
         TITLE 'IFG0555J, ALIAS IFG0196P/EOV, OPEN - DA OUTPUT USER HEAX00100021
               DER LABELS'                                              00200021
         COPY  LCGASMSW                                                 00300000
IFG0555J CSECT                                                          00500021
         ENTRY IFG0196P                                          Y02080 00550002
IFG0196P EQU   IFG0555J                 ALLIAS ENTRY POINT       Y02080 00560002
*********************************************************************** 00610002
*                                                                     * 00660002
*                                                                     * 00710002
*          VS2 RELEASE 02 DELETIONS                                   * 00760002
*                                                                     * 00810002
*                                                                     * 00860002
*********************************************************************** 00910002
*                                                                     * 00960002
* MODULE NAME = IFG0555J (OS/VS2)                                     * 01010002
*                                                                     * 01060002
* DESCRIPTIVE NAME = EOV/OPEN DA OUTPUT USER HEADER LABELS            * 01110002
*                                                                     * 01160002
* COPYRIGHT = NONE                                                    * 01210002
*                                                                     * 01260002
* STATUS = RELEASE 2, LEVEL 0                                         * 01310002
*                                                                     * 01360002
* FUNCTION =                                                          * 01410002
*        THIS MODULE WRITES USER HEADER/TRAILER LABELS FOR OPEN-      * 01460002
*        EOV UNDER CONTROL OF THE CALLER'S OUTPUT USER HEADER/TRAILER * 01510002
*        LABEL ROUTINE, OR FORMATS THE USER LABEL TRACK IF NO USER    * 01560002
*        LABEL EXIT ROUTINE EXISTS AND THE DATA SET IS BEING PRO-     * 01610002
*        CESSED FOR OUTPUT AND LABEL = SUL.                           * 01660002
*        1) A 152 BYTE USER LABEL WORK AREA IS OBTAINED FOR EOV FROM  * 01710002
*        FETCH PROTECTED SUBPOOL 229 IN DATA MANAGEMENT KEY, AND      * 01760002
*        A 96 BYTE USER LABEL WORK AREA IS OBTAINED FOR THE CALLER    * 01810002
*        FROM FETCH PROTECTED SUBPOOL 229 IN THE CALLER'S KEY.        * 01860002
*        2) USER LABELS ARE PRESENTED TO END OF VOLUME AND WRITTEN    * 01910002
*        UNTIL 8 LABELS ARE WRITTEN OR THE CALLER INDICATES THROUGH   * 01960002
*        A RETURN CODE TO TERMINATE PROCESSING.                       * 02010002
*        3) THE CALLER RETURNS TO THIS MODULE (AFTER PROCESSING EACH  * 02060002
*        USER LABEL) WITH A RETURN CODE IN REGISTER 15:               * 02110002
*        0 - DO NOT WRITE LABEL BUT TERMINATE PROCESSING UL           * 02160002
*        4 - WRITE LABEL AND TERMINATE PROCESSING                     * 02210002
*        8 - WRITE LABEL AND CONTINUE PROCESSING                      * 02260002
*        4) IF NO USER LABEL TRACK WAS ALLOCATED, THE CALLER'S EXIT   * 02310002
*        ROUTINE IS ENTERED WITH THE BUFFER POINTER SET TO ZERO.      * 02360002
*        5) IF AN I/O ERROR OCCURS WHEN WRITING USER LABEL, THE       * 02410002
*        CALLER'S ROUTINE IS ENTERED AGAIN WITH BIT 0 OF THE          * 02460002
*        FLAG BYTE SET TO 1, AND A POINTER TO THE STATUS INFORMATION  * 02510002
*        IN THE WORK AREA IOB. ON RETURN, THE RETURN CODE IS IG-      * 02560002
*        NORED AND NORMAL PROCESSING RESUMES FOR EOV. HOWEVER, FOR    * 02610002
*        OPEN, THE DCBOFLGS BUSY BIT IS TURNED OFF TO TERMINATE       * 02660002
*        THE OPEN OF THE DCB. CONTROL IS PASSED TO THE END OF OPEN    * 02710002
*        TO FREE MAIN WORK AREAS AND TO RETURN TO THE CALLER OF OPEN  * 02760002
*        WITHOUT SETTING THE DCBOFLGS OPEN BIT.                       * 02810002
*                                                                     * 02860002
* NOTES = SEE BELOW                                                   * 02910002
*                                                                     * 02960002
*    DEPENDENCIES =                                                   * 03010002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 03060002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03110002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03160002
*                                                                     * 03210002
*    RESTRICTIONS = NONE                                              * 03260002
*                                                                     * 03310002
*    REGISTER CONVENTIONS =                                           * 03360002
*            R2 POINTS TO DCB                                         * 03410002
*            R4 POINTS TO OPEN WORK AREA                              * 03460002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 03510002
*            R6 POINTS TO THE WTG TABLE                               * 03560002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 03610002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 03660002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 03710002
*            R10 POINTS TO THE UCB                                    * 03760002
*                                                                     * 03810002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 03860002
*                  END OF LISTING.                                    * 03910002
*                                                                     * 03960002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 04010002
*                                                                     * 04060002
*    PROCESSOR = ASSEMBLER XF                                         * 04110002
*                                                                     * 04160002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 04210002
*                  ORG STATEMENT AT END OF LISTING                    * 04260002
*                                                                     * 04310002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 04360002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 04410002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 04460002
*                                                                     * 04510002
* ENTRY POINT =                                                       * 04560002
*        IFG0555J                                                     * 04610002
*        IFG0196P - ALIAS                                             * 04660002
*                                                                     * 04710002
*    PURPOSE = SEE FUNCTION                                           * 04760002
*                                                                     * 04810002
*    LINKAGE =                                                        * 04860002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 04910002
*        MACRO INSTRUCTION.                                           * 04960002
*                                                                     * 05010002
* INPUT =                                                             * 05060002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 05110002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 05160002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 05210002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 05260002
*                                                                     * 05310002
* OUTPUT =                                                            * 05360002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 05410002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 05460002
*        DEBDCBAD POINTING TO THE COPIED DCB,                         * 05510002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 05560002
*                                                                     * 05610002
* EXIT-NORMAL =                                                       * 05660002
*        DXRETMOD - RETURN TO MODULE WHICH CALLED 555J                * 05710002
*                                                                     * 05760002
* EXIT-ERROR =                                                        * 05810002
*        IFG0198N - I/O ERROR PROCESSING USER LABELS                  * 05860002
*                                                                     * 05910002
* EXTERNAL REFERENCES = SEE BELOW                                     * 05960002
*                                                                     * 06010002
*    ROUTINES =                                                       * 06060002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 06110002
*                                                                     * 06160002
*    DATA AREAS =                                                     * 06210002
*        EOV WORKAREA.                                                * 06260002
*                                                                     * 06310002
*    CONTROL BLOCK =                                                  * 06360002
*        CVT                                                          * 06410002
*        DEB                                                          * 06460002
*        PSA                                                          * 06510002
*        TCB                                                          * 06560002
*        RB                                                           * 06610002
*                                                                     * 06660002
* TABLES =                                                            * 06710002
*                                                                     * 06760002
* MACROS =                                                            * 06810002
*        MODESET                                                      * 06860002
*        IECRES LOAD                                                  * 06910002
*        IECRES GET                                                   * 06960002
*        IECRES INIT                                                  * 07010002
*        IECRES FREE                                                  * 07060002
*        IECRES UEXIT                                                 * 07110002
*        EXCP                                                         * 07160002
*        WAIT                                                         * 07210002
*        SETLOCK                                                      * 07260002
*                                                                     * 07310002
* CHANGE ACTIVITY =                                                   * 07360002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 07410002
*                                                                     * 07460002
*********************************************************************** 07510002
         EJECT                                                          07560002
         IECDSECS CVT,TCB,RB,DCB,       DEFINE DESIRED DSCTS TO BE     X21600021
               MAIN,DEB,USERLAB,RRPL,   EXPANDED AT THE END      Y02144X21700002
               USERTOT,WTG,PREFX,PSA                             Y02082 21750002
*                                                                       21900021
         IECEQU ,                       DEFINE EQUATES                  22000021
*                                                                       22100021
         USING IHADCB,RDCB              DEFINE BASE TO USER'S DCB       22200021
         USING FORCORE,RCORE            DEFINE BASE TO MAIN WORK AREA   22300021
         USING WTG,RWTG                 DEFINE BASE TO XCTL/WTG TABLE   22400021
         USING ULDMWK,RUCB              BASE FOR EOV UL W.A.     Y02082 22450002
*                                                                       22600021
         BALR  RBASE,0                  ESTABLISH BASE REGISTER         22700021
         USING *,RBASE                  DEFINE BASE REGISTER            22800021
*                                                                       22900021
*********************************************************************** 23000021
*                                                                       23100021
*    OBTAIN STORAGE FOR EOV'S USER LABEL WORK AREA AND THE       Y02082 23150002
*    USER'S USER LABEL WORK AREA                                 Y02082 23200002
*                                                                Y02082 23250002
         IECRES GET,LV=USERLDM,PREFIX=YES,STM=(2,14,WTGPREFX),   Y02082*23300002
               SP=K229,ID=ULWA                                   Y02144 23350002
*                                                                       23600021
         LR    RUCB,R1                  SET BASE FOR ULWK DSECT         23700021
*                                                                       23900021
         IECRES GET,LV=USERLU,PREFIX=NO,STM=(2,14,WTGPREFX),     Y02082*23950002
               SP=K229,KEY=USER                                  Y02082 23960002
         MODESET EXTKEY=DATAMGT         RESUME O/C/E KEY         Y02082 23962002
         USING ULUWK,R9                 BASE FOR USER'S UL W.A.  Y02082 23970002
         LR    R9,R1                    GOTTEN CORE ADDRESS      Y02082 23980002
         MVC   DXCCW11,DXCCW8           SAVE SAVED REGS 9-10 IN 0-1     24000021
*                                                                       24100021
         CLI   WTGMODNM+K5,C'9'         IS THIS OPEN (IFG0196P)         24200021
         BNE   ULHDR08A                 BR IF NO                        24300021
         MVC   DXVOLMT2(K5),DXCCW7      SAVE DSCB CCHHR ADDR     Y02134 24400002
*                                                                       24500021
ULHDR08A EQU   *                        NOT OPEN                        24600002
*                                                                       24700021
*        DETERMINE IF A USER LABEL EXTENT HAS BEEN ALLOCATED FOR THIS   24800021
*        DATA SET.                                                      24900021
*                                                                       25000021
         CLI   DSCEXTYP,ULEXT           IS 1ST EXTENT FOR USER LABELS   25100021
         BNE   ULNOEXT                  BR IF NO, GO TO USER            25200021
*                                                                       25300021
*********************************************************************** 25400021
*                                                                       25500021
*        EXTENT EXISTS - PROCESS USER LABELS                            25600021
*                                                                       25700021
         MVC   DXDAADDR+K3(K4),DSCLOWLM  CCHH FROM START OF 1ST EXTENT  25800021
         MVI   DXDAADDR+K7,K0           START SEARCH ID AT R0           25900021
*                                                                       26000021
*                                                                       26100021
*  SET UP CHANNEL PROGRAM TO WRITE A HEADER LABEL.                      26200021
*  EACH HEADER LABEL WRITTEN IS FOLLOWED BY TWO FILE MARKS -            26300021
*  UHL(N+1) AND UTL0.                                                   26400021
*                                                                       26500021
*        SEARCH ID EQ                                                   26600021
*        TIC *-8                                                        26700021
*        WRITE COUNT,KEY,DATA           ULWK1, UHLN,     LABEL          26800021
*        WRITE COUNT,KEY,(DATA)         ULWK5, UHL(N+1), FILE MARK      26900021
*        WRITE COUNT,KEY,(DATA)         ULWK2, UTL0,     FILE MARK      27000021
*        SEARCH ID EQ                                                   27100021
*        TIC *-8                                                        27200021
*        READ  COUNT,KEY,DATA           READ BACK UHLN CHECK            27300021
*                                                                       27400021
         XC    DXCCW1(K64),DXCCW1       CLEAR CCW AREA                  27500021
         LA    R1,DXDAADDR+K3                                           27600021
         ST    R1,DXCCW1                SEARCH ID FROM IOBDADAD+3       27700021
         LA    R1,DXCCW1                                                27800021
         ST    R1,DXCCW2                TIC TO CCW1                     27900021
         LA    R1,ULWK8                 WRITE C,K,DATA (UHL1)           28000021
         ST    R1,DXCCW3                FROM ULWK8                      28100021
         LA    R1,ULWK5                 WRITE C,K (UHL2)                28200021
         ST    R1,DXCCW4                FROM ULWK5                      28300021
*                                                                       28400021
         LA    R1,ULWK2                                                 28500021
         ST    R1,DXCCW5                WRITE FILE MARK FROM ULWK2      28600021
         OC    DXCCW1(K40),ULCP26P      OR IN CMND, FLAGS, LENGTH       28700021
*                                                                       28800021
         MVC   DXCCW6(K24),DXCCW1       APPEND WRITE CHECK TO CHNL PGM  28900021
         LA    R1,DXCCW6                                                29000021
         ST    R1,DXCCW7                TIC BACK TO CCW6                29100021
         MVI   DXCCW7,CCWTIC            RESTORE TIC OP                  29200021
         MVI   DXCCW8,ULHRDCKD          MAKE OP READ                    29300002
         MVI   DXCCW8+K4,ULHSKIPB       SET SKIP BIT ON, CHAIN OFF      29400002
*                                                                       29500021
*        STRUCTURE COUNT AND KEY FIELDS IN WORK AREA.                   29600021
*                                                                       29700021
         MVC   ULWK8,DXDAADDR+K3        CCHH TO COUNT FIELD IN WK AREA  29800021
         MVC   ULWK9(K8),UHLCON6P       RKDD, KEY TO WORK AREA FOR UHLN 29900021
*                                                                       30000021
         MVC   ULWK5(K12),ULWK8         CT, KEY FOR UHL(N+1)  FILE MARK 30100021
         MVC   ULWK2(K8),ULWK8          CT FOR UTLO  FILE MARK          30200021
         MVC   ULWK4,UTLCON6P           KEY FOR UTLO                    30300021
*                                                                       30400021
*        DETERMINE IF ACTIVE EXIT LIST ENTRY EXISTS.                    30500021
*                                                                       30600021
         LA    RC,0(RC)                 ZERO HIGH ORDER BYTE            30700021
         LTR   RC,RC                    CHECK FOR ACTIVE EXIT           30800021
         BZ    ULHDR17                  BR IF NO                        30900021
*                                                                       31000021
*********************************************************************** 31100021
*                                                                       31200021
*        COMPLETE STRUCTURING OF WORK AREA FOR WRITING HEADER LABEL     31300021
*                                                                       31400021
ULHDR09  EQU   *                        INITIALIZE WORK AREA            31500002
         MVI   ULWK9+K3,K80             DATA LENGTH=80 FOR LABEL        31600021
         SR    R1,R1                    CLEAR REG.                      31700021
         IC    R1,ULWK9                 PICK UP R FROM CT FIELD OF LBL  31800021
         LA    R1,K1(R1)                INCR R BY 1                     31900021
         STC   R1,ULWK6                 R+1  UHL(N+1)                   32000021
         LA    R1,K1(R1)                INCR R BY 1                     32100021
         STC   R1,ULWK3                 R+2  UTL0                       32200021
         IC    R1,ULWK10+K3             PICK UP N FROM LABEL KEY        32300021
         LA    R1,K1(R1)                INCR N BY 1                     32400021
         STC   R1,ULWK7+K3              N+1                             32500021
         CLI   ULWK10+K3,C'8'           CHECK NO. LABELS GT 8           32600021
         BH    ULHDROUT                 BR IF YES TO SET UP RETURN      32700021
*                                                                       32800021
         L     R1,ULWK10                PLACE UHLN IN REG        Y02082 32850002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 32900002
*                                                                Y02082 32950002
         ST    R1,ULBUFR                PRIME USER BUFFER UHLN   Y02082 32960002
*                                                                       33000021
*        SET UP AND EXECUTE SYNCHRONOUS EXIT TO USER'S ROUTINE FOR      33100021
*        LABEL CONSTRUCTION.                                            33200021
*                                                                       33300021
         BAL   RD,ULSYNC6P              GO EXIT TO USER'S ROUTINE       33400021
* RETURNS IN DATAMGT KEY                                         Y02082 33450002
         L     R1,ULWK10                GET UTLX/UHLX            YM1175 33500002
         MODESET KEYADDR=DXUKEY,WORKREG=12 ASSUME USER KEY       YM1175 33560002
         ST    R1,ULBUFR                PLACE IN USER'S BUFFER   YM1175 33570002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM1175 33580002
         LTR   RF,RF                    CHECK RETURN CODE FOR ZERO      33600021
         BZ    ULHDR13                  CODE=0, NO LABEL CREATED-BRANCH 33700021
         ST    RF,ULWK1                 SAVE RETURN CODE                33800021
         CLI   ULWK1+K3,K4              CHECK FOR RETURN CODE=4         33900021
         BE    ULHDR099                 RETURN CODE IS 4,CONTINUE       34000021
         CLI   ULWK1+K3,K8              CHECK FOR RETURN CODE=8         34100021
         BNE   ULHDR13                  RET CODE NOT 4,8-INVALID        34200021
*                                       RETURNED,NO FURTHER PROCESSING  34300021
ULHDR099 EQU   *                        RETURN CODE = 4                 34400002
         OI    DXCCW2+K4,X01            SET SWITCH INDIC NOT FIRST      34500021
*                                                                Y02082 34550002
*    COPY LABEL FROM USER BUFFER TO EOV BUFFER                   Y02082 34560002
*                                                                Y02082 34570002
         L     RF,WTGPREFX              POINT TO PREFIX          Y02082 34580002
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y20082 34590002
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          Y02082 34592002
*    GET LOCAL LOCK                                              Y02082 34594002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*34596002
               RELATED=('PREVENT FREE USER CORE-RELEASE BELOW')  Y02082 34598002
*                                                                Y02082 34598402
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 34598802
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 34599202
*    VERIFY USER STILL HOLDS USER LABEL WORK AREA CORE           Y02082 34599602
         OC    ULUWK(USERLU),ULUWK      PROGRAM CHECK IF NOT     Y02082 34599702
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          Y02082 34599802
         MVC   ULDMBUFR,ULBUFR          COPY LABEL FROM USER     Y02082 34599902
         L     RF,WTGPREFX              POINT TO PREFIX          Y02082 34633202
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS THRU LOCK  Y02082 34643202
*    RELEASE LOCAL LOCK                                          Y02082 34653202
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=('SEE ABOVE')        Y02082 34663202
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 34665202
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 34665602
         BAL   RC,ULEXCP6P              GO WRITE LABEL                  34666702
*                                                                       34700021
         TM    DXECB,ECBNOERR           CHECK FOR I/O ERROR             34800021
         BZ    ULHDR10                  BR IF YES                       34900021
*                                                                       35000021
         CLI   ULWK1+K3,K4              CHECK RET CODE FOR MORE LABELS  35100021
         BE    ULHDROUT                 NO, PREV LABEL WAS LAST         35200021
*                                                                       35300021
         MVC   DXDAADDR+K7(K1),ULWK9    R OF LABEL JUST WRITTEN TO IOB  35400021
         MVC   ULWK8(K12),ULWK5         CT,KEY OF UHL(N+1) BECOMES CT,  35500021
*                                       KEY OF NEXT USER LABEL          35600021
         B     ULHDR09                  BR TO PROCESS NEXT LABEL        35700021
*                                                                       35800021
*********************************************************************** 35900021
*                                                                       36000021
*  I/O ERROR OCURRED WHILE WRITING USER LABELS.                         36100021
*                                                                       36200021
ULHDR10  EQU   *                        I/O ERROR WRITING LABEL         36300002
         LA    R1,DXIOB                 INSERT POINTER TO STATUS INFO   36400021
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 36450002
         ST    R1,ULERRPTR              IN PARAMETER LIST               36500021
         OI    ULERRPTR,ERROR           FLAG ERROR                      36600021
         BAL   RD,ULSYNC61              GO TO SYNCH TO USER             36700021
* RETURNS IN DATAMGT KEY                                         Y02082 36750002
*                                                                       36800021
ULHDR105 EQU   *                        RETURN FROM SYNCH               36900002
         CLI   WTGMODNM+K5,C'9'         IS THIS OPEN (IFG0196P)         37000021
         BNE   ULHDROUT                 BR IF NO                        37100002
*                                                                       37200021
         NI    DCBOFLGS,X'FF'-DCBOBUSY  TURN OFF DCBOFLGS BUSY BIT TO   37300021
*                                       STOP OPEN                       37400021
         B     ULHDROUT                 BR TO SET UP RETURN             37500021
*                                                                       37600021
*********************************************************************** 37700021
*                                                                       37800021
ULHDR13  EQU   *                        INVALID RETURN CODE             37900002
         TM    DXCCW2+K4,X01            IS IT FIRST TIME                38000021
         BO    ULHDROUT                 BR IF NO                        38100021
*                                                                       38200021
         MVI   ULWK6,K1                 R=1     UHL                     38300021
         MVI   ULWK7+K3,CHAR1           N=1     UHL                     38400002
*                                                                       38500021
*        IF THE USER REQUESTS, VIA THE RETURN CODE, THAT NO USER        38600021
*        HEADER LABELS BE WRITTEN OR                                    38700021
*        IF THE EXIT IS INACTIVE, BUT AN EXTENT HAS BEEN ALLOCATED FOR  38800021
*        USER LABELS, OPEN AND EOV MUST WRITE TWO FILE MARKS (UHL1      38900021
*        AND UTL0).                                                     39000021
*                                                                       39100021
ULHDR17  EQU   *                        WRITE 2 FILE MARKS              39200002
         MVI   ULWK3,K2                 R=2 FOR UTL0                    39300021
         MVC   DXCCW3(K16),DXCCW4       SET CP TO WRITE 2 FILEMARKS     39400021
         NI    DXCCW4+K4,X'FF'-CCWCMDCH  TURN OFF CC FLAG IN LAST CCW   39500021
*                                                                       39600021
         BAL   RC,ULEXCP6P              GO WRITE FILEMARKS              39700021
         TM    DXECB,ECBNOERR           CHECK FOR I/O ERROR             39800021
         BO    ULHDROUT                 BR IF NO ERROR                  39900021
*                                                                       40000021
         L     R1,DXREGC                OBTAIN DCB EXIT LIST ENTRY      40100021
         LA    R1,0(R1)                 ZERO CODE BYTE                  40200021
         LTR   R1,R1                    IS USER EXIT ACTIVE             40300021
         BNZ   ULHDR10                  BR IF YES TO GO TO EXIT RTN     40400021
         B     ULHDR105                 BR TO END LABEL PROCESSING      40500021
*                                                                       40600021
*********************************************************************** 40700021
*                                                                       40800021
*        NO USER LABEL TRACK WAS ALLOCATED.  EXIT TO USER'S ROUTINE     40900021
*        WITH POINTER TO LABEL BUFFER ZEROED.                           41000021
*                                                                       41100021
ULNOEXT  EQU   *                        EXIT TO USER'S ROUTINE          41200002
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 41250002
         XC    ULERRPTR,ULERRPTR        CLEAR ANY ERROR INDICATOR       41300021
         SR    R1,R1                    BUFFER POINTER TO ZERO          41400021
         BAL   RD,ULSYNC62              GO SYNCH TO USER                41500021
* RETURNS IN DATAMGT KEY                                         Y02082 41550002
*                                                                       41600021
*********************************************************************** 41700021
*                                                                       41800021
ULHDROUT EQU   *                        SET RETURN FOR HEADER PROCESSNG 41900021
*                                                                       42100021
*        FREE  WORKAREA AND LABEL BUFFER AND XCTL TO I/O SUPPORT        42200021
*        MODULE WHICH CALLED THIS MODULE.                               42300021
*                                                                       42400021
         IECRES FREE,A=(R9),PREFIX=NO,SP=K229,LV=USERLU,         Y02082*42450002
               KEY=USER,STM=(2,14,WTGPREFX)                      Y02082 42500002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 42550002
         IECRES FREE,A=(RUCB),PREFIX=YES,STM=(2,14,WTGPREFX)     Y02082 42600002
*                                                                       42700021
         LM    RB,RET,DXREGB            RESTORE REGS 11-14              42800021
         LM    RTIOT,RUCB,DXREG0        RESTORE REGS 9-10 FROM 0-1      42900021
*                                                                       43000021
         CLI   WTGMODNM+K5,C'9'         IS THIS OPEN (IFG0196P)         43100021
         BNE   ULHDR08B                 BR IF NO                        43200021
         MVC   DXCCW7(K5),DXVOLMT2      RESTORE DSCB CCHHR       Y02134 43300002
         TM    DCBOFLGS,DCBOBUSY        IS DCB STILL BEING OPENED       43400021
         BO    ULHDR08B                 BR IF YES                       43500021
*                                                                       43600021
         IECRES LOAD,MODNM=LOAD8N6P,BRCODE=4,BRANCH=QUEUED       Y02080 43750002
*                                      XCTL TO OPEN FINAL STRING Y02080 43760002
*                                                                       43800021
ULHDR08B EQU   *                        RETURN TO CALLING MOD           43962002
         IECRES LOAD,MODID=DXRETMOD,BRCODE=(14),BRANCH=QUEUED    Y02134 43994802
*                                                                       44000021
*********************************************************************** 44100021
*                                                                       44200021
*        CLOSED SUBROUTINE TO ISSUE I/O OPERATIONS                      44300021
*                                                                       44400021
ULEXCP6P EQU   *                        I/O ROUTINE                     44500002
         EXCP  DXIOB                    WRITE USER HEADER LABEL         44600021
*                                                                       44700021
         WAIT  ECB=DXECB                WAIT FOR WRITE TO COMPLETE      44800021
*                                                                       44900021
         BR    RC                       RETURN FROM I/O SUBROUTINE      45000021
*                                                                       45100021
*********************************************************************** 45200021
*                                                                       45300021
*        CLOSED SUBROUTINE TO PASS CONTROL TO USER EXIT          Y02082 45400002
*        REGISTER CONTENTS ARE AS FOLLOWS-                       Y02082 45800002
*                        R0 - CONTAINS NO MEANINGFUL INFO               45900021
*                        R1 - PTR TO PARAMETER LIST                     46000021
*                    R2-R13 - USER'S CONTENTS BEFORE I/O SUPPORT        46100021
*                       R14 - RETURN ADDRESS (SET BY SYNCH)             46200021
*                       R15 - USER'S EXIT ROUTINE ADDRESS               46300021
*                                                                       46400021
ULSYNC6P EQU   *                        SYNCH ENTRY 1                   46500002
         XC    ULERRPTR,ULERRPTR        ZERO ERROR INDICATORS           46600021
ULSYNC61 EQU   *                        SYNCH ENTRY 2                   46700002
         LA    R1,ULBUFR                PTR TO LABEL BUFFER             46800021
ULSYNC62 EQU   *                        SYNCH ENTRY 3                   46900002
         ST    R1,ULPARM                PTR TO LABEL BUFFER      Y02082 46950002
         L     R1,DXUDCBAD              GET USER'S DCB ADDR      Y02082 47000002
         ST    R1,ULPARM+K4             PUT IN PARM LIST         Y02082 47050002
         XC    ULTOTPTR,ULTOTPTR        ZERO TOTALING AREA              47100021
         TM    DCBDSORG,DCBORGDA        CK FOR DIRECT ORGANIZATION      47200021
         BO    ULSYNCH3                 BR IF DIRECT                    47300021
         CLI   WTGMODNM+K5,C'9'         IS THIS OPEN (IFG0196P)         47400021
         BE    ULSYNCH3                 BR IF YES, SKIP USER TOTALING   47500021
         TM    DCBMACRF,DCBMEXCP        TEST IF EXCP                    47600021
         BO    ULSYNCH3                 BR IF YES, SKIP USER TOTALING   47700021
         TM    DCBOPTCD,DCBOPTT         TEST IF USER TOTALING           47800021
         BZ    ULSYNCH3                 HAS BEEN REQUESTED, BR IF NO    47900021
*                                                                       48000021
         L     RDEB,DCBDEBAD            GET ADDR OF USER'S DEB   Y01021 48100000
         SR    R1,R1                    CLEAR WORK REG                  48200021
         IC    R1,DEBNMEXT-DEB(,RDEB)   GET NUMBER OF EXTENTS           48300021
         SLL   R1,K4                    MULTIPLY BY 16                  48400021
         L     RDEB,K36(R1,RDEB)        GET ADDR TOTALING WORK AREA     48500021
*                                       DEB ADDR+32+4+LENGTH EXTENTS    48600021
         USING TOTSAVWA,RDEB            SET BASE - TOTALING AREA        48700021
         MVC   ULTOTPTR,TOTEOVPT        CURRENT IMAGE AREA ADDR TO      48800021
*                                       USER LBL PARM LIST              48900021
         DROP  RDEB                     DROP TOTALING AREA BASE         49000021
*                                                                       49100021
ULSYNCH3 EQU   *                        NO USER TOTALING                49200002
         MODESET EXTKEY=DATAMGT                                  Y02082 49202002
         NI    DCBOFLGS,X'FF'-DCBOLOCK  SET LOCK BIT = 0         Y02082 49210002
*                                                                Y02082 49250002
* COPY THE DCB FROM THE WORK AREA TO USER'S STORAGE              Y02082 49260002
*                                                                Y02082 49270002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,WTGPREFX)          Y02082 49280002
*                                                                Y02082 49290002
         MODESET KEYADDR=DXUKEY,WORKREG=1  ASSUME USER'S KEY     Y02082 49292002
         LA    R1,ULPARM                POINT TO PARAMETER LIST         49300021
         MODESET EXTKEY=DATAMGT                                  Y02082 49350002
         IECRES UEXIT,EXITAD=DXREGC,STM=(2,13,WTGPREFX)          Y02082 49400002
         L     RDCB,DXUDCBAD            PT TO CALLER'S DCB       YM3005 49450002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME CALLER'S KEY    YM3005 49500002
         OI    DCBOFLGS,DCBOLOCK        INDICATE RETURN FR USER  Y02082 49550002
         LA    R0,ALLBITS-DCBOBUSY      ISOLATE BUSY BIT MASK    YM3005 49600002
         IC    R1,DCBOFLGS              GET CALLER'S OFLGS       YM3005 49650002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM3005 49700002
         L     RDCB,DXPDCBAD            PT TO COPIED DCB         YM3005 49750002
         OR    R0,R1                    ISOLATE CALLER BUSY BIT  YM3005 49800002
         IC    R1,DCBOFLGS              GET COPIED DCBOFLGS      YM3005 49850002
         NR    R1,R0                    UPDTE BUSY BIT TO CALLER YM3005 49900002
         STC   R1,DCBOFLGS              UPDATE OFLGS FIELD       YM3005 49950002
         L     RDEB,DCBDEBAD            GET ADDR OF USER'S DEB   Y01021 51530002
         OI    DCBOFLGS,DCBOLOCK        SET LOCK BIT = 1                51600021
         L     R0,ULWK10                PLACE UHLN IN REG        Y02082 51650002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME USER KEY        Y02082 51700002
*                                                                Y02082 51750002
         ST    R0,ULBUFR                REPLACE UHLN IN USER BUFFY02082 51760002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 51770002
         BR    RD                       RETURN FROM SYNCH EXIT SUBR     51800021
         EJECT                                                          51900002
*********************************************************************** 52200021
*                                                                       52300021
*        CONSTANTS                                                      52400021
*                                                                       52500021
UHLCON6P DC    0F'0',X'01040000'        RKDD - R0, COUNT, KEY FOR UHL   52600021
         DC    C'UHL1'                  KEY                             52700021
UTLCON6P DC    C'UTL0'                  KEY FOR SEARCH ARGUMENT         52800021
*                                                                       52900021
*  CCW'S TO WRITE USER HEADER LABELS FOLLOWED BY UHL(N+1) UTL0 FILE MKS 53000021
ULCP26P  DC    X'3100000040000005'      SEARCH ID EQ                    53100021
         DC    X'0800000000000000'      TIC *-8                         53200021
         DC    X'1D0000004000005C'      WRITE CKD    UHLN     LABEL     53300021
         DC    X'1D0000004000000C'      WRITE CKD    UHL(N+1) FILE MARK 53400021
         DC    X'1D0000004000000C'      WRITE CKD    UTL0     FILE MARK 53500021
*                                                                       53510002
ULHRDCKD EQU   X'1E'                    READ COUNT, KEY, AND DATA       53550002
ULHSKIPB EQU   X'10'                    SET SKIP BIT ON                 53560002
*                                                                       53600021
         XCTLTABL ID=(LOAD8N6P,IFG0198N),                        Y02080X53700002
               BRT=YES,LENGTH=                                   Y02080 53750002
*                                                                       53800021
         IECDSECS EXPAND=YES            EXPAND DESIRED DSECTS HERE      53900021
*                                                                       54000021
         END                                                            54100021
./  ADD  SSI=42961272,NAME=IFG0558X
         TITLE '      IFG0558X   CHECKPOINT AT EOV ROUTINE '            00500000
IFG0558X CSECT                                                          01000000
*                                                                     * 01500000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 02000000
*                                                                     * 02500000
* MODULE NAME = IFG0558X                                              * 03000000
*                                                                     * 03500000
* DESCRIPTIVE NAME = CHECKPOINT AT EOV ROUTINE                        * 04000000
*                                                                     * 04500000
* COPYRIGHT = NONE                                                    * 05000000
*                                                                     * 05500000
* STATUS = RELEASE 2, LEVEL 0                                         * 06000000
*                                                                     * 06500000
* FUNCTION = THIS ROUTINE IS INVOKED BY EOV FOR BSAM/QSAM DATA SETS   * 07000000
*            AT WHOSE EOV OCCURRANCES A CHECKPOINT IS TO BE TAKEN.    * 07500000
*                                                                     * 08000000
*            THE 'CHKPT' MACRO WILL INVOKE OS/VS CHECKPOINT.          * 08500000
*                                                                     * 09000000
*            A SEQUENTIAL CHECKPOINT DCB WILL DEFINE THE CHECKPOINT   * 09500000
*            DATA SET WITH THE DDNAME OF 'SYSCKEOV'.                  * 10000000
*                                                                     * 10500000
*            SUCCESSFUL COMPLETION OF CHECKPOINT, AS DETERMINED BY    * 11000000
*            RETURN CODES 0 AND 4 FROM 'CHKPT', WILL CAUSE IMMEDIATE  * 11500000
*            EXIT TO IFG0551L.                                        * 12000000
*                                                                     * 12500000
*            UNSUCCESSFUL COMPLETION, AS DETERMINED BY ALL OTHER      * 13000000
*            RETURN CODES, WILL RESULT IN A WARNING MESSAGE BEING     * 13500000
*            GENERATED PRIOR TO EXIT EXCEPT WHEN:                     * 14000000
*                                                                     * 14500000
*                RETURN CODE X'08' FOR DIRECT ACCESS OR X'14' FOR     * 15000000
*                TAPE OCCURS -- THE 'CHKPT' MACRO WILL BE RE-ISSUED   * 15500000
*                ONE TIME TO ATTEMPT TO WRITE GOOD CHECKPOINT RECORDS * 16000000
*                ON THE NEW EXTENT OR VOLUME IF AVAILABLE.            * 16500000
*                                                                     * 17000000
*                SECOND TRY FAILURE WILL RESULT IN THE WARNING        * 17500000
*                MESSAGE AS ABOVE.                                    * 18000000
*                                                                     * 18500000
*            THE FOLLOWING IDENTIFIES THE NEW WARNING MESSAGE:        * 19000000
*                                                                     * 19500000
*                IEC067I  CHKPT=EOV FACILITY EXECUTED UNSUCCESSFULLY  * 20000000
         EJECT                                                          20500000
* NOTES = THIS ROUTINE IS WRITTEN AS A DCB USER EXIT.                 * 21000000
*                                                                     * 21500000
*         IT DOES NOT CONFORM TO REGISTER SAVING AND CHAINING         * 22000000
*         CONVENTIONS.                                                * 22500000
*                                                                     * 23000000
*         REFERENCE OS/VS DATA MANAGEMENT SERVICES SRL FOR MORE       * 23500000
*         DETAIL.                                                     * 24000000
*                                                                     * 24500000
*    DEPENDENCIES = CLASS ONE CHARACTER CODE.  EBCDIC CHARACTER CODE  * 25000000
*                   USED FOR ASSEMBLY.                                * 25500000
*                                                                     * 26000000
*    RESTRICTIONS = NONE                                              * 26500000
*                                                                     * 27000000
*    REGISTER CONVENTIONS = NONE                                      * 27500000
*                                                                     * 28000000
*    PATCH LABEL = CKVPTCH                                            * 28500000
*                                                                     * 29000000
* MODULE TYPE = CONTROL SUBROUTINE (EOV USER EXIT)                    * 29500000
*                                                                     * 30000000
*    PROCESSOR = ASSEMBLER XF                                         * 30500000
*                                                                     * 31000000
*    MODULE SIZE = SEE LOC FIELD ON CKVCEND STATEMENT PRIOR TO DSECT  * 31500000
*                                                                     * 32000000
*    ATTRIBUTES = REUSABLE, USER KEY                                  * 32500000
*                                                                     * 33000000
* ENTRY POINT = IFG0558X                                              * 33500000
*                                                                     * 34000000
*    PURPOSE = SEE FUNCTION                                           * 34500000
*                                                                     * 35000000
*    LINKAGE = ENTERED VIA LOAD/SYNCH FROM MODULE IFG0551L            * 35500000
*                                                                     * 36000000
* INPUT = REGISTER 1 POINTS TO DCB OF DATA SET AT EOV (NOT USED).     * 36500000
*         REGISTER 14 POINTS TO RETURN ADDRESS IN MODULE IFG0551L.    * 37000000
*                                                                     * 37500000
* OUTPUT = CHECKPOINT RECORDS ON EOV CHECKPOINT DATA SET (SYSCKEOV).  * 38000000
*          REGISTER 15 = 0.                                           * 38500000
*                                                                     * 39000000
* EXIT-NORMAL = RETURN TO IFG0551L VIA BRANCH.                        * 39500000
*                                                                     * 40000000
* EXIT-ERROR = NONE                                                   * 40500000
         EJECT                                                          41000000
* EXTERNAL REFERENCES = SEE BELOW                                     * 41500000
*                                                                     * 42000000
*    ROUTINES = SVC 63 VIA CHKPT MACRO                                * 42500000
*                                                                     * 43000000
*    DATA AREAS = WORK SPACE FOR SAVE AREA AND MISCELLANEOUS FIELDS   * 43500000
*                                                                     * 44000000
*    CONTROL BLOCKS = DCB                                             * 44500000
*                                                                     * 45000000
* TABLES = NONE                                                       * 45500000
*                                                                     * 46000000
* MACROS = CHKPT                                                      * 46500000
*          WTO                                                        * 47000000
*                                                                     * 47500000
* CHANGE-ACTIVITY = NONE                                              * 48000000
*                                                                     * 48500000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 49000000
         EJECT                                                          49500000
         IECDSECS DCB,PREFX                                     Z30JSFC 49550003
         IECEQU                                                 Z30JSFC 50000003
         SPACE 1                                                        53500000
MAXCODE  EQU   X'18'                    MAXIMUM CKPT/RST RETCODEZ30JSFC 54050003
         SPACE 3                                                        54500000
*                                                                     * 55000000
* * * *      ESTABLISH ADDRESSABILITY AND FORWARD SAVE AREA     * * * * 55500000
*                                                                     * 56000000
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITYZ30JSFC 56500003
         USING *,RBASE                  ADDRESSABILITY          Z30JSFC 57000003
         USING CKVDSECT,RCORE           IFG0558X WORKAREA       Z30JSFC 57050003
         GETMAIN R,LV=CKVLENTH          GET SUBPOOL 0 CORE      Z30JSFC 57110003
         LR    RCORE,R1                 GET WORKAREA ADDRESS    Z30JSFC 57200003
         XC    CKVDSECT(CKVLENTH),CKVDSECT ZERO WORK AREA       Z30JSFC 57250003
         ST    RET,CKVSVRE              STORE RETURN ADDR.      Z30JSFC 57500003
         LA    RD,CKVSVAR               PROVIDE SAVEAREA FORWARDZ30JSFC 58500003
         SPACE 3                                                        59500000
*                                                                     * 60000000
* * *                ISSUE 'CHKPT' MACRO PROVIDING                * * * 60500000
* * * *             THE DCB TO BE OPENED AND CLOSED             * * * * 61000000
* * *                     BY OS/VS CHECKPOINT                     * * * 61500000
*                                                                     * 62000000
CKVCKPT  EQU *                          ISSUE CHECKPOINT        Z30JSFC 62500003
         MVC   CKVDCBD,CKVDCB           MOVE CHECKPOINT DCB     Z30JSFC 62510003
*                                       TO WORK AREA            Z30JSFC 62520003
         LA    R1,CKVDCBD               GET DCB ADDRESS         Z30JSFC 62550003
         ST    R1,CKVLIST               STORE IN PARM LIST      Z30JSFC 62600003
         OI    CKVLIST,LASTNTRY         SET LAST ENTRY          Z30JSFC 62650003
         LA    R1,CKVLIST               POINT TO PARM LIST      Z30JSFC 62700003
         CHKPT MF=(E,(1))               INVOKE OS/VS CHECKPOINT Z30JSFC 63000003
         LA    R0,MAXCODE               GET MAX EXPECTED CODE   Z30JSFC 63050003
         CR    RF,R0                    CHECK IF > EXPECTED     Z30JSFC 63100003
         BH    CKVEROR                  BRANCH IF UNEXPECTED    Z30JSFC 63150003
         B     CKVBRTB(RF)              BRANCH BASED ON CODE    Z30JSFC 63500003
         EJECT                                                          64000000
*                                                                     * 64500000
* * * *       BRANCH TABLE TO SERVICE RETURN CODE OPTIONS       * * * * 65000000
*                                                                     * 65500000
CKVBRTB  EQU  *                         BRANCH ENTRY            Z30JSFC 66000003
         B     CKVEXIT                  RC=00, EXIT (CHKPT)     Z30JSFC 66500003
         B     CKVEXIT                  RC=04, EXIT (RSTRT)     Z30JSFC 67000003
         B     CKVRTRY                  RC=08, RETRY (D/A)      Z30JSFC 67500003
         B     CKVEROR                  RC=0C, ISSUE MESSAGE    Z30JSFC 68000003
         B     CKVEROR                  RC=10, ISSUE MESSAGE    Z30JSFC 68500003
         B     CKVRTRY                  RC=14, RETRY (TAPE)     Z30JSFC 69000003
         B     CKVEROR                  RC=18, ISSUE MESSAGE    Z30JSFC 69500003
         SPACE 3                                                        70000000
*                                                                     * 70500000
* * *   ISSUE UNSUCCESSFUL CHECKPOINT MESSAGE AND RETURN TO EOV   * * * 71000000
*                                                                     * 71500000
CKVEROR  EQU   *                        ERROR ENTRY             Z30JSFC 72000003
         WTO   'IEC067I  CHKPT=EOV FACILITY EXECUTED UNSUCCESSFULLY',  X72500000
               ROUTCDE=(2,11),          SEND TO OPER/PGMR              X73000003
               DESC=6                   JOB STATUS MSG.         Z30JSFC 73500003
         SPACE 1                                                        74000000
         B     CKVEXIT                  EXIT TO RESUME EOV      Z30JSFC 74500003
         SPACE 3                                                        75000000
*                                                                     * 75500000
* * * *             TEST RETRY SWITCH TO ALLOW ONLY             * * * * 76000000
* * * *              ONE RETRY FOR GOOD CHECKPOINT              * * * * 76500000
*                                                                     * 77000000
CKVRTRY  EQU   *                        RETRY ENTRY             Z30JSFC 77500003
         TM    CKVRTSW,ALLBITS          IS THIS FIRST RETRY?    Z30JSFC 78000003
         BO    CKVEROR                  NO - ISSUE MESSAGE      Z30JSFC 78500003
         OI    CKVRTSW,ALLBITS          YES - SET RETRY SWITCH  Z30JSFC 79000003
         B     CKVCKPT                  GO TO RE-ISSUE CHKPT    Z30JSFC 79500003
         SPACE 3                                                        80000000
*                                                                     * 80500000
* * * *              RETURN TO EOV MODULE IFG0551L              * * * * 81000000
*                                                                     * 81500000
CKVEXIT  EQU   *                        EXIT POINT              Z30JSFC 82000003
         L     RET,CKVSVRE              RESTORE EOV RETURN ADDR Z30JSFC 83000003
         FREEMAIN R,LV=CKVLENTH,A=(RCORE) FREE WORK AREA        Z30JSFC 83050003
         RETURN RC=0                    RETURN                  Z30JSFC 83500003
         EJECT                                                          84000000
*                                                                     * 84500000
* * * *         DCB FOR SEQUENTIAL CHECKPOINT DATA SET          * * * * 85000000
*                                                                     * 85500000
CKVDCB   DCB   DSORG=PS,MACRF=W,RECFM=U,         . SEQUENTIAL          X86000000
               DEVD=DA,OPTCD=W,                  . CHECKPOINT          X86500000
               DDNAME=SYSCKEOV                   . DCB          Z30JSFC 87000003
         EJECT                                                          87500000
         XCTLTABL SVC=055,BRT=YES,LENGTH=                       Z30JSFC 87550003
         IECDSECS EXPAND=YES                                    Z30JSFC 87600003
*                                                                     * 88000000
* * * *                 MISCELLANEOUS WORK AREA                 * * * * 88500000
*                                                                     * 89000000
CKVDSECT DSECT                                                  Z30JSFC 89050003
CKVSVRE  DS    F                        RETURN REG(14) SAVE AREAZ30JSFC 89500003
CKVSVAR  DS    XL72                     SAVE AREA FOR IFG0558X  Z30JSFC 90000003
CKVRTSW  DS    XL1                      RETRY INDICATOR/SWITCH  Z30JSFC 90500003
CKVLIST  DS    A                        CHECKPOINT PARMLIST     Z30JSFC 90510003
         DS    0D                       ALIGN BOUNDRY           Z30JSFC 90550003
CKVDCBD  DS    XL96                     CHECKPOINT/RESTART DCB  Z30JSFC 90560003
CKVEND   DS    0D                       END OF WORKAREA         Z30JSFC 90600003
CKVLENTH EQU   *-CKVDSECT               LENGTH FOR GETMAIN      Z30JSFC 90650003
         END                                                            94000000
./  ADD  SSI=81140188,NAME=IGC0001I
         TITLE 'IGC0001I                      OPEN - SVC 19 INITIAL MODU00200002
               ULE'                                                     00210002
IGC0001I CSECT                                                          00800021
         ENTRY IGC0101I                 ENTRY FROM CLOSE DURING  Y02082 00850002
*                                       UNLIKE CONCAT PROCESSING Y02082 00950002
*********************************************************************** 00960002
*                                                                     * 00970002
*        VS2 RELEASE 03 DELETIONS/CHANGES                               00972002
*0000371488,509556,509576,510280-510420                         ZA00705 00974002
*                                                                       00976002
*               VS2-037 CHANGES/DELETIONS/ADDITIONS                   * 00977037
*A800100-801100,A808100-808200                                 @ZA29752 00978037
*                                                                     * 00979037
* MODULE NAME = IGC0001I (OS/VS2)                                     * 00980002
*                                                                     * 00990002
* DESCRIPTIVE NAME = OPEN INITAL MODULE                               * 00992002
*                                                                     * 00994002
* COPYRIGHT = NONE                                                    * 00996002
*                                                                     * 00998002
* STATUS = RELEASE 2, LEVEL 0                                         * 00998402
*                                                                     * 00998802
* FUNCTION =                                                          * 00999202
*        1. DETERMINE IF THIS REQUEST IS FOR A VSAM RESOURCE   @Y30DSDT 00999337
*        POOL (VRP). IF IT IS, GET A WORK AREA AND BRANCH TO   @Y30DSDT 01001837
*        IFG0192Y. IF THIS IS AN OPEN REQUEST, SAVE REGISTERS  @Y30DSDT 01002237
*        2-12 IN SVRB EXTENDED SAVE AREA AND GET MAIN STORAGE  @Y30DSDT 01003837
*        (VIA RESIDENT ROUTINE) FOR:                           @Y30DSDT 01004937
*           A. WHERE-TO-GO TABLE;                                     * 01007437
*           B. A WORK AREA FOR EACH DCB IN THE PARAMETER LIST. (IF    * 01009937
*           THE DDNAME FOR THE DCB IS NOT IN THE TIOT, THE WORK AREA  * 01012437
*           IS FREED);                                                * 01014937
*           C. A PROTECTED COPY OF THE DCB.                           * 01017437
*                                                                     * 01019937
*        2. INITIALIZE EACH WHERE-TO-GO TABLE ENTRY.                  * 01022437
*                                                                     * 01024937
*        3. CONSTRUCT IN EACH O/C/EOV WORK AREA THE CONTROL BLOCKS    * 01027437
*        NEEDED TO EXCP:                                              * 01029937
*           A. DEB                                                    * 01032437
*           B. ECB                                                    * 01034937
*           C. DCB                                                    * 01037437
*           D. IOB                                                    * 01039937
*           E. CHANNEL PROGRAMS                                       * 01042437
*                                                                     * 01044937
*        4. OBTAIN THE JFCB THROUGH THE TIOT ENTRY FOR EACH DCB.      * 01047437
*        CHECK TO SEE IF THE TRACE ROUTINE HAS BEEN REQUESTED. IF IT  * 01049937
*        HAS, THEN TURN ON THE TRACE ROUTINE INDICATOR AT WTGPATHS+K1.* 01052437
*                                                                     * 01054937
* NOTES = SEE BELOW                                                   * 01057437
*                                                                     * 01059937
*    DEPENDENCIES =                                                   * 01062437
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 01064937
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 01067437
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 01069902
*                                                                     * 01079902
*    RESTRICTIONS = NONE                                              * 01089902
*                                                                     * 01091902
*    REGISTER CONVENTIONS =                                           * 01093902
*            R2 POINTS TO DCB                                         * 01095902
*            R4 POINTS TO OPEN WORK AREA                              * 01097902
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 01098302
*            R6 POINTS TO THE WTG TABLE                               * 01098702
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 01099102
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 01099502
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 01099602
*            R10 POINTS TO THE UCB                                    * 01099702
*                                                                     * 01099802
*    PATCH LABEL = SEE NEXT TO LAST LABEL BEFORE ORG STATEMENT AT END * 01133202
*                  OF LISTING.                                        * 01143202
*                                                                     * 01153202
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 01163202
*                                                                     * 01165202
*    PROCESSOR = ASSEMBLER XF                                         * 01165602
*                                                                     * 01166002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 01166402
*                  ORG STATEMENT AT END OF LISTING                    * 01166502
*                                                                     * 01177602
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 01187602
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 01188002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 01188402
*                                                                     * 01188802
* ENTRY POINT = IGC0001I  FROM OPEN MACRO OR SVC 19 IN KEY ZERO       * 01192502
*               IGC0101I  FROM CLOSE - UNLIKE ATTRIBUTE CONCATENATION * 01192902
*                         AND IN DATA MANAGEMENT KEY                  * 01193702
*                                                                     * 01194502
*    PURPOSE = INITIALIZE WORK AREAS FOR OPEN PROCESSING              * 01194902
*                                                                     * 01195302
*    LINKAGE = STANDARD LINKAGE FOR TYPE 4 SVC                        * 01195702
*                                                                     * 01196102
* INPUT = REGISTER 1 POINTING TO VARIABLE PARAMETER LIST.             * 01196202
*                                                                     * 01216202
* OUTPUT = OPEN WTG TABLE AND WORK AREAS INITIALIZED FOR OPEN         * 01219602
*          PROCESSING.                                                * 01221602
*                                                                     * 01229602
* EXIT-NORMAL =                                                       * 01231602
*          IFG0193A - NORMAL OPEN PROCESSING                          * 01232102
*          IFG0191X - VSAM CATALOG                                    * 01232202
*                                                                     * 01233602
* EXIT-ERROR = CALLER - NO DCB'S TO OPEN                              * 01235602
*                                                                     * 01385602
* EXTERNAL REFERENCES = SEE BELOW                                     * 01435602
*                                                                     * 01485602
*    ROUTINES = IFG0193A,IFG0191X,IFG019RA.                           * 01535602
*                                                                     * 01585602
*    DATA AREAS = SEE PARAMETERS ON IECDSECS MACRO.                   * 01635602
*                                                                     * 01685602
*    CONTROL BLOCK = SEE PARAMETERS ON IECDSECS MACRO.                * 01735602
*                                                                     * 01785602
* TABLES = SEE XCTLTABL MACRO.                                        * 01835602
*                                                                     * 01885602
* MACROS = IECDSECS,IECEQU,IECRES,MODESET,WTO,XCTLTABL.               * 01935602
*                                                                     * 01985602
* CHANGE ACTIVITY = NEW RELEASE (LEVEL 0)                             * 02035602
*                                                                     * 02085602
*********************************************************************** 02135602
         EJECT                                                          26400021
         IECDSECS CVT,TCB,RB,TIOT,UCB,DCB,ACB,MAIN,WTG,PREFX,    Y02080*26600002
               RRPL,IEZDEB                                      YA03003 26650002
*                                                                       27000021
TIOTSPOL EQU   X'06'                    JES SPOOL D.S.  INDICATORS      27290000
ACBMJEP  EQU   X'40'                    ACB JEPS INDICATOR              27300000
VRPREGSV EQU   92                       SAVEAREA SIZE FOR VRP   Z30SSRL 27310037
         IECEQU AOS=YES,IEZDEB=YES                              YA03003 27320002
*                                                                       27400021
         USING IHADCB,RDCB              DEFINE BASE TO USER'S DCB       27600021
         USING FORCORE,RCORE            DEFINE BASE TO MAIN WORK AREA   27800021
         USING TIOENTRY,RTIOT           DEFINE BASE TO TIOT DD ENTRY    28000021
         USING RRPLIST,RC               DEFINE BASE TO RRPLIST   Y02144 28250002
         USING WTG,RWTG                 DEF BASE TO WTG TABLE  @Y30DSDT 28300037
*                                                                       28400021
         BALR  RBASE,R0                 ESTABLISH BASE REGISTER         28600002
         USING *,RBASE                  DEFINE BASE REGISTER            28800021
OIN00000 EQU   *                        TOP OF MODULE            Y02082 28850002
*                                                              @Y30DSDT 31836037
************************************************************** @Y30DSDT 31842037
*                                                              @Y30DSDT 31848037
*  TEST FOR VSAM BLDVRP OR DLVRP REQUEST                       @Y30DSDT 31848437
*                                                              @Y30DSDT 31850037
************************************************************** @Y30DSDT 31852037
*                                                              @Y30DSDT 31852437
         L     RDCB,PLISTDCB(R1)        POINT TO FIRST DCB/ACB @Y30DSDT 31852537
         TM    DCBMACR,DCBMEXCP         EXCP                   @Y30DSDT 31852637
         BO    OIN10000                 BRANCH IF YES          @Y30DSDT 31852737
         TM    DCBDSRG2,ACBDORGA        ACB                    @Y30DSDT 31856337
         BZ    OIN10000                 BRANCH IF NO           @Y30DSDT 31858337
         CLI   ACBSTYP-IFGACB(RDCB),ACBSVRP  VRP REQUEST       @Y30DSDT 31860337
         BNE   OIN10000                 BRANCH IF NO           @Y30DSDT 31864437
         TM    PLISTOPT(R1),X80         CHECK FOR ONE PARM     @Y30DSDT 31864837
         BZ    OIN10000                 BRANCH IF MORE         @Y30DSDT 31864937
         LR    RPARC,R1                 SAVE PT TO PARM LIST   @Y30DSDT 31865137
         SR    R1,R1                    NO PREVIOUS PREFIX     @Y30DSDT 31867637
         USING RBBASIC,R5               RB ADDRESSIBILITY      @Y30DSDT 31868137
         IECRES GET,LV=DXXEND+VRPREGSV,STM=(2,12,RBEXSAVE),    @Y30DSDT*31868337
               PREFIX=YES,A=(1),SP=252,KEY=K0,ID=VRP   VRP WA  @Y30DSDT 31869037
         DROP  R5                       DROP RB ADDRESSING     @Y30DSDT 31869937
         LR    RCORE,R1                 EST WORK AREA BASE     @Y30DSDT 31870637
         LA    R0,IECSTART-IECPREFX     GET LENGTH OF PREFIX   @Y30DSDT 31870937
         SR    R1,R0                    POINT R1 AT PREFIX     @Y30DSDT 31871237
         ST    R1,DXXPREFX              PT TO PREFIX FROM WTG  @Y30DSDT 31871837
         MVI   DXXWTOPR+1,K12           LGTH IN WTG WTO PREFIX @Y30DSDT 31872537
         IECRES LOAD,MODNM=VSAMVRP,PREFIX=DXXPREFX,            @Y30DSDT*31873237
               BRANCH=DIRECT            GO PROCESS VRP REQUEST @Y30DSDT 31873937
OIN10000 EQU   *                        CONTINUE OPEN PROCESS  @Y30DSDT 31874637
*                                                                       31875337
*********************************************************************** 31876037
*                                                                       31876737
*  GETMAIN THE WHERE-TO-GO TABLE                                        31877437
*                                                                       31878137
*                                                                Y02080 31878837
* SAVE REGISTERS 2-12 IN SVRB EXTENDED SAVE AREA                 Y02080 31879237
*                                                                Y02080 31879637
         L     RF,CVTPTR                GET POINTER TO CVT       Y02080 31880537
         L     RF,CVTTCBP-CVT(,RF)      GET TCB WORDS            Y02080 31882002
         L     RF,K4(,RF)               TCB ADDRESS              Y02080 31882402
         L     RF,K0(,RF)               POINTER TO SVRB          Y02080 31883237
         USING RBBASIC,RF               ADDRESS RB               Y02080 31883637
         IECRES GET,PREFIX=WTG,         GETMAIN FOR WTG TABLE    Y02080*31883702
               STM=(2,12,RBEXSAVE),A=(R1)                        Y02080 31883802
*        CONTROL RETURNED IN DATA MANAGEMENT KEY                 Y02082 31885802
*        REGISTER 0 CONTAINS RESULT OF SYSZTIOT ENQ              YM2869 31890002
         DROP  RF                       DROP ADDRESSING TO RB    Y02080 31893802
*                                                                       31896021
         LR    RWTG,R1                  WTG ADDR TO RWTG REG     Y02080 31902002
         IECRES LOAD,MODNM=OPEN,PREFIX=WTGPREFX,BRANCH=NO        Y02080*31908102
                                        GIVE OPT TRACE A SHOT    Y02080 31908302
         L     RPAR,WTGPREFX            GET PTR TO WTG PREFIX    Y02144 31908402
         L     RC,IECRRPRM-IECPREFX(,RPAR) GET RRPLIST ADDRESS   Y02144 31908802
         MVI   RRFUNCTN,RRFOPEN         INDICATE OPEN FUNCTION   Y02144 31909202
*                                                                       31950000
*********************************************************************** 31951200
*                                                                       31957300
*  INITIALIZE EACH WHERE-TO-GO TABLE ENTRY                              31963400
*                                                                       31969500
         SR    RD,RD                    SET GO SWITCH OFF        A39979 31975600
         L     RPAR,IECUPRML-IECPREFX(,RPAR) ADDR OF USER'S PARAM LIST *31979602
                                        IN WTG AREA              Y02134 31981602
         LR    RPARC,RPAR               ADDR FIRST ENT PARM LIST A39979 31981700
         LA    RWTGC,WTGENTRY           ADDR FIRST ENT WTG TABLE A39979 31987800
         USING WTGENTRY,RWTGC           BASE TO CURRENT WTG ENT  A39979 31993900
*                                                                       32000021
*        TEST RESULT OF SYSZTIOT ENQ                             YM2869 32005002
*              REGISTER 0 NONZERO INDICATES CALLER OF OPEN       YM2869 32010002
*              OBTAINED SYSZTIOT RESOURCE EXCLUSIVELY.           YM2869 32015002
*        THIS WILL BE ALLOWED ONLY IF THE CALLER IS IN A SYSTEM  YM2869 32020002
*              PROTECT KEY AND IS OPENING AN ACB TO A VSAM       YM2869 32025002
*              CATALOG INDICATED BY THE ACBCAT BIT BEING SET     YM2869 32030002
*                                                                       32035002
         LTR   R0,R0                    IS RETURN CODE ZERO      YM2869 32040002
         BZ    OIN10200                 BRANCH IF YES            YM2869 32045002
         L     RDCB,PLISTDCB(,RPARC)    GET DCB/ACB              YM2869 32050002
         L     RA,CVTPTR                CVT                      YM2869 32055002
         L     RA,CVTTCBP-CVT(,RA)      TCB WORDS                YM2869 32060002
         L     RA,K4(,RA)               CURRENT TCB              YM2869 32065002
         USING TCB,RA                                            YM2869 32070002
         MODESET EXTKEY=RBT234,WORKREG=1 USER KEY                YM2869 32075002
         TM    DCBMACR,DCBMEXCP         EXCP                     YM2869 32080002
         BO    OIN13250                 BR IF YES                YM2869 32085002
         TM    DCBDSRG2,ACBDORGA        ACB                      YM2869 32090002
         BZ    OIN13250                 BR IF NO                 YM2869 32095002
         TM    ACBINFLG-IFGACB(RDCB),(ACBCAT+ACBSCRA)           Z30SSRL 32100037
*                                       IS IT CATALOG OR SCRA   Z30SSRL 32102037
         BZ    OIN13250                 BR IF NO                 YM2869 32105002
         MODESET EXTKEY=DATAMGT         KEY OF DATA MANAGEMENT   YM2869 32110002
         TESTAUTH KEY=YES               CALLER IN SYSTEM KEY     YM2869 32115002
         LTR   RF,RF                    RETURN CODE              YM2869 32120002
         BNZ   OIN13250                 BR IF NOT IN SYSTEM KEY  YM2869 32125002
         DROP  RA                                                YM2869 32130002
OIN10200 EQU   *                        LOOP FOR EACH DCB               32200002
         XC    WTGENTRY,WTGENTRY        CLEAR WTG TABLE ENTRY    A39979 32300021
         L     RDCB,PLISTDCB(,RPARC)    LOAD CURRENT DCB ADDR           32400021
*                                                                Y02082 32425002
*        MAKE SURE THIS DCB IS NOT PREVIOUSLY DUPLICATED IN THE  Y02082 32450002
*        PARAMETER LIST                                          Y02082 32475002
*                                                                Y02082 32500002
         DROP  RWTGC                    DROP WTGC TEMPORARILY    Y02082 32510002
         LA    R1,WTGENTRY              FIRST DCB'S WTG ENTRY    Y02082 32525002
         USING WTGENTRY,R1              TEMPORARY USING FOR R1   Y02082 32545002
OIN10220 EQU   *                        PROCESS EACH DCB         Y02082 32575002
         CR    R1,RWTGC                 AT CURRENT ENTRY YET     Y02082 32600002
         BE    OIN10225                 BR IF YES-NO DUPLICATE   Y02082 32650002
         L     RCORE,WTGCORE-K1         GET WORKAREA IF PRESENT  Y02082 32700002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE          Y02082 32702002
         LTR   RCORE,RCORE              IS THERE A WORKAREA      Y02082 32710002
         BZ    OIN10222                 BRANCH IF NO             Y02082 32720002
         CLM   RDCB,B'0111',DXUDCBAD+K1 IS CURRENT DCB BEING     Y02082 32730002
*                                       PROCESSED ALREADY        Y02082 32740002
         BE    OIN10400                 BR IF YES-DON'T DO IT    Y02082 32742002
*                                       AGAIN                    Y02082 32744002
OIN10222 EQU   *                        GET NEXT ENTRY           Y02082 32746002
         LA    R1,L'WTGENTRY(,R1)       GO TO NEXT ENTRY         Y02082 32748002
         B     OIN10220                 CHECK NEXT ENTRY         Y02082 32750002
         DROP  R1                       R1 NO LONGER NEEDED      Y02082 32760002
         USING WTGENTRY,RWTGC           REESTABLISH RWTGC USING  Y02082 32770002
OIN10225 EQU   *                        GET WORK AREA            Y02082 32775002
         L     RA,CVTPTR                GET CVT ADDRESS          Y02082 33222002
         L     RA,CVTTCBP-CVT(,RA)      ADDR OF TCB POINTERS     Y02082 33224002
         L     RA,K4(,RA)               GET CURRENT TCB ADDR     Y02082 33224402
         USING TCB,RA                   PROVIDE ADDRESSABILITY   Y02082 33224802
         MODESET EXTKEY=RBT234,WORKREG=15 USER KEY               Y02082 33232602
         DROP  RA                                                Y02082 33234602
         TM    DCBOFLGS,DCBOFOPN+DCBOFIOF OPEN OR BUSY BITS ON?  Y02134 33236302
         BNZ   OIN10400                 BR IF YES-GET NEXT DCB   Y02134 33240002
*        DETERMINE SIZE OF DCB/ACB FOR COPYING IT INTO WORKAREA  Y02134 33250002
         MODESET EXTKEY=DATAMGT         ASSUME KEY 5             Y02082 33261002
         IECRES GET,LV=OPENSIZE,PREFIX=YES,STM=(2,14,WTGPREFX),  Y02134*33262002
               ID=OPWA                                           Y02144 33262402
         LR    RCORE,R1                 ESTABLISH WORKAREA BASE  Y02134 33264002
         ST    RCORE,WTGCORE-K1         SAVE IN WTG TABLE ENTRY  Y02134 33266002
         ST    RC,DXATCOM3              SAVE RRPLIST PTR IN W/A  Y02144 33266402
*        INITIALIZE WORKAREA WITH CONTROL BLOCK POINTERS AND     Y02134 33268002
*        COPY DCB INTO WORKAREA                                  Y02134 33268402
         IECRES INIT,DCBCOPY=TOWKAR,DEB=NO,STM=(3,14,WTGPREFX),  Y02134*33268802
               PREFIX=WTGPREFX                                   Y02082 33273802
         CLI   DXWCOPYE,K0              WAS COPY/INIT OK         Y02082 33278802
         BE    OIN10228                 BRANCH IF YES            Y02082 33283802
         CLI   DXWCOPYE,K2              WAS DDNAME MISSING       Y02082 33288802
         BNE   OIN10350                 BRANCH IF NO-SOME OTHER  Y02082 33293802
*                                       REASON                   Y02082 33298802
*                                                                       33303802
*********************************************************************** 33308802
*                                                                       33313802
*  WRITE  'IEC130I DDNAMEXX DD STATEMENT MISSING'  ERROR MESSAGE        33318802
*                                                                       33319802
*                                                                X02989 33321902
*  SET ERROR FLAG FOR ACB                                        X02989 33322602
*                                                                X02989 33322802
         TM    DCBMACR,DCBMEXCP         IS ACCESS METHOD EXCP    X02989 33323002
         BO    OIN10227                 BRANCH IF YES            X02989 33323202
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB  X02989 33324902
         BNO   OIN10227                 BRANCH IF NO             X02989 33325902
         USING IFGACB,RACB              DEFINE BASE TO ACB       X02989 33326102
         MVI   ACBERFLG,VSONODDN        SET ACB ERROR FLAG       X02989 33326302
*                                       TO DD NAME NOT IN TIOT   X02989 33326502
         USING IHADCB,RDCB              DEFINE BASE TO DCB       X02989 33327102
OIN10227 EQU   *                        ISSUE MESSAGE            X02989 33327302
         LR    R1,RCORE                 MSG ADDR FOR WTO         Y02134 33327602
         MVC   0(OIN1500L,R1),OIN1500K  MOVE MSG TO WORKAREA     Y02134 33328202
         MVC   K12(L'DCBDDNAM,R1),DCBDDNAM MOVE DDNAME TO MSG    Y02134 33328402
*                                                                       33328602
         WTO   MF=(E,(1))               WRITE MESSAGE TO PROGRAMMER     33328702
*                                                                       33330902
         B     OIN10350                 BR TO PROCESS NEXT DCB   Y02134 33331902
         EJECT                                                          33332102
OIN10228 EQU   *                        CONTINUE                 Y02028 33332902
         TM    DCBMACR,DCBMEXCP         IS ACCESS METHOD EXCP    X02989 33333402
         BO    OIN10240                 BR IF YES                X02989 33335602
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB  X02989 33337802
         BNO   OIN10240                 BR IF NO                 X02989 33340002
         USING IFGACB,RDCB              DEFINE BASE TO ACB       X02989 33350002
         TM    ACBOFLGS,ACBOPEN         IS ACB ALREADY OPEN      X02989 33352002
         BNO   OIN10230                 BR IF NO                 X02989 33354002
         MVI   ACBERFLG,VSOACBOP        SET ACB ALREADY OPEN     X02989 33356002
*                                       ERROR FLAG               X02989 33358002
         B     OIN10350                 BR TO PROC NEXT ACB/DCB  Y02134 33358402
OIN10230 EQU   *                        CLEAR ERROR              X02989 33358802
         XC    ACBERFLG,ACBERFLG        ZERO ACB ERROR FLAG      X02989 33359202
         B     OIN10300                 BR TO CONTINUE           X02989 33359602
         USING IHADCB,RDCB              REDEFINE BASE TO DCB     X02989 33359702
OIN10240 EQU   *                        TEST IF ALREADY OPEN     X02989 33359802
         TM    DCBOFLGS,DCBOPEN         IS DCB ALREADY OPEN      X02989 33359902
         BO    OIN10350                 BR IF YES                Y02134 33366602
OIN10300 EQU   *                        ERROR ENCOUNTERED        X02989 33376602
         TM    DCBOFLGS,DCBOCON         CONCATENATION BIT = 1    Y02082 33390002
         BO    OIN10350                 YES, GO FREE WORK AREA   Y02082 33392002
         TM    DCBOFLGS,DCBOLOCK        IS DCB NOT-LOCKED BIT ON        33400021
         BO    OIN10600                 BR IF YES                Y02134 33600002
*                                                                       34200021
OIN10350 EQU   *                         FREE WORKAREA           Y02134 34250002
         NI    DCBOFLGS,X'FF'-DCBOBUSY  RESET BUSY BIT           Y02082 34255002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(2,14,WTGPREFX)          Y02082 34256002
         XC    WTGENTRY,WTGENTRY        NO PROCESSING THIS DCB   Y02134 34260002
OIN10400 EQU   *                        GET NEXT DCB                    34400002
         MODESET EXTKEY=DATAMGT         ASSUME KEY 5             Y02082 34425002
         TM    PLISTOPT(RPARC),LASTNTRY  CHECK FOR LAST ENTRY           34600021
         LA    RPARC,K4(,RPARC)         INCR TO NEXT DCB IN PARM LIST   35000021
         LA    RWTGC,L'WTGENTRY(,RWTGC) ADVANCE WTG ENTRY        A39979 35200021
         BZ    OIN10200                 BR IF NOT LAST ENTRY     A39979 35260021
         B     OIN13000                 BR TO EXIT OR XCTL       A39979 35320021
*                                                                       35400021
*********************************************************************** 35600021
*                                                                       35800021
*  DCB NEEDS TO BE OPENED.                                              36000021
*  SEARCH TIOT FOR MATCHING DDNAME.                                     36200021
*                                                                       36400021
OIN10600 EQU   *                        INITIALIZE FOR NEXT LOAD        36600002
         MVC   WTGIDTTR-WTGENTRY(L'WTGIDTTR,RWTGC),OPENNEXT 3A   Y02080 36650002
         XC    DXREGE,DXREGE            IND INIT ENTRY 193A      Y02080 36660002
         XC    DXREG0,DXREG0            IND NO ERROR             Y02080 36670002
*                                                                X02989 36700002
*  IF OPEN IS FOR VSAM CATALOG, BYPASS TIOT SEARCH               X02989 36750002
*                                                                X02989 36760002
         TM    DCBMACR,DCBMEXCP         IS ACCESS MEHOD EXCP     X02989 36770002
         BO    OIN10650                 BR IF YES, NOT AN ACB    X02989 36780002
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB  X02989 36790002
         BNO   OIN10650                 BR IF NO                 X02989 36792002
*  IS ACB FOR VSAM CATALOG                                     @Y30DSDT 36792437
         TM    ACBINFLG-IFGACB(RDCB),ACBCAT+ACBSCRA CATLG/SCRA  Z30SSRL 36794037
         BZ    OIN10640                 BR IF NO               @Y30DSDT 36798037
OIN10620 EQU   *                        PREPARE TO XCTL         Z30SSRL 36798137
         OI    DCBOFLGS,DCBOBUSY        SET BUSY BIT ON          X02989 36798402
         MVC   WTGIDTTR-WTGENTRY(L'WTGIDTTR,RWTGC),VSAMCATL VSAM Y02080 36798802
         MVC   DXRETMOD,OPENNEXT        SET RETURN TO 193A       Y02080 36898802
         XC    DXRETCOD,DXRETCOD        SET 193A INIT INDR       Y02080 36948802
         B     OIN11500                 BR TO GET WORK AREA      X02989 36998802
OIN10640 EQU   *                        TEST FOR SPECIAL DDNAME         37048802
         CLC   ACBDDNM-IFGACB(L'ACBDDNM,RDCB),=X'FF00000000000000'      37098802
*                                       TEST FOR SPECIAL DDNAME  Y02004 37108802
         BNE   OIN10650                 BRANCH IF NOT VTAM      ZA00705 37148802
         USING IFGACB,RACB              ADDRESS THE ACB         ZA00705 37150802
         MVI   ACBAMETH,ACBVTAM         FLAG VTAM ACCESS METHOD ZA00705 37158802
         USING IHADCB,RDCB              RESTORE DCB ADDRESSING  ZA00705 37160802
         B     OIN11600                 BRANCH TO COPY VTAM ACB ZA00705 37168802
*                                                                       37198802
OIN10650 EQU   *                        CONTINUE                 X02989 37248802
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDR      Y02134 38600002
*                                                                       46212021
OIN11300 EQU   *                        EXCP NOT ALLOWED FOR SUBSYSTEM  46216002
         TM    TIOELINK,TIOTSPOL        IS THIS A SPOOLED DATA SET      46218000
         BNM   OIN11400                 NO, BR TO CONTINUE NORMALLY     46220002
         TM    DCBMACR,DCBMEXCP         IS ACCESS METHOD EXCP           46222000
         BZ    OIN11400                 NO,BR TO CONTINUE               46222402
*                                                                       46222621
*********************************************************************** 46222800
*                                                                       46223200
*   WRITE  'IEC132I DDNAMEXX, MACRF=E WAS SPECIFIED FOR A SYSIN OR      46223600
*   SYSOUT DATA SET' ERROR MESSAGE                                      46223700
*                                                                       46223800
         LR    R1,RCORE                 MSG ADDR FOR WTO         Y02134 46223902
         MVC   0(OIN1500N,R1),OIN1500M  MOVE MSG TO WORKAREA     Y02134 46233902
         MVC   K12(L'DCBDDNAM,R1),DCBDDNAM MOVE DDNAME TO MSG    Y02134 46235902
         WTO   MF=(E,(1))               WRITE MSG TO PROGRAMMER         46239900
         B     OIN10350                 BR TO PROCESS NEXT DCB   Y02134 46267502
*                                                                       46584400
*  THIS DCB IS OPENABLE.                                         Y02134 46600002
*  INITIALIZE CONTROL BLOCKS IN MAIN WORK AREA.                         46800021
*                                                                       47000021
OIN11400 EQU   *                        CALCULATE TIOT OFFSET           47200002
         LR    RF,RTIOT                 CALC TIOT DD ENTRY OFFSET       47400021
         L     RET,DXTCBADR             GET TCB ADDRESS          Y02134 47450002
         L     RET,TCBTIO-TCB(RET)      GET TIOT ADDRESS         Y02134 47500002
         SR    RF,RET                   FROM START OF TIOT              47600021
         STH   RF,DCBTIOT               STORE TIOT OFFSET IN DCB        47800021
         TM    DCBMACR,DCBMEXCP         IS ACCESS MEHOD EXCP    Z30SSRL 47802037
         BO    OIN11500                 BR IF YES, NOT AN ACB   Z30SSRL 47804037
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB Z30SSRL 47806037
         BNO   OIN11500                 BR IF NO                Z30SSRL 47808037
         TM    ACBINFLG-IFGACB(RDCB),ACBUCRA IF IT IS UCRA      Z30SSRL 47810037
         BO    OIN10620                 BRANCH TO XCTL          Z30SSRL 47820037
OIN11500 EQU   *                        MOVE MACRF, TURN ON OPEN GO SW  47850002
         MVC   DCBMACRF,DCBMACR         MOVE MACRF                      48000021
*                                                                       48200021
OIN11600 EQU   *                        INDICATE OPEN IN PROGRESS       48400002
         OI    DCBOFLGS,DCBOBUSY        SET DCB BUSY BIT ON             49000021
         LR    RD,RCORE                 SET OPEN GO SWITCH ON    Y02080 49200002
*                                                                       49400021
OIN11650 EQU   *                        PROCESS                  Y02134 49450002
         ST    RCORE,DCBDEBAD           SAVE CORE ADDR IN DCB DEB SLOT  50200021
         MVC   DCBIFLGS,DCBIFLG         MOVE IN DCB IOS FLAGS           50400021
         IECRES INIT,DCBCOPY=FRWKAR,STM=(0,14,WTGPREFX) UPDATE   YM5702*50450002
                                        THE USER'S DCB           YM5702 50550002
         TM    DCBMACR,DCBMEXCP         IS ACCESS METHOD EXCP    XM1037 50950402
         BO    OIN11670                 BR IF YES, NOT ACB       X02989 50950802
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB  X02989 50951202
         BNO   OIN11670                 BR IF NO                 X02989 50951602
         USING IFGACB,RACB              ADDRESS THE ACB          Y02004 50953602
         CLI   ACBAMETH,ACBVTAM         IS ACB FOR VTAM?        ZA00705 50955602
         BE    OIN10400                 BRANCH IF YES           ZA00705 50957602
         TM    ACBINFLG,(ACBCAT+ACBSCRA+ACBUCRA)                Z30SSRL 50959637
*                                       IF CATALOG/SCRA/UCRA    Z30SSRL 50961637
         BZ    OIN11670                 BR IF NO                Z30SSRL 50969237
         MVC   DXWORK1,ACBINFLG         SET FLAG                Z30SSRL 50973637
         B     OIN10400                 BR TO NEXT DCB/ACB       X02989 50978002
         EJECT                                                          51042402
         USING IHADCB,RDCB              RESTORE DCB ADDRESSING   Y02004 51044002
*                                                                Y02004 51044402
**************************************************************** Y02082 51054402
*                                                                Y02082 51055202
**  1. THE FOLLOWING LABEL (IGC0101I) IS THE ENTRY POINT TO      Y02082 51058002
**     OPEN FROM CLOSE FOR UNLIKE CONCATENATION PROCESSING.      Y02082 51058802
**  2. REGISTER R1 CONTAINS A POINTER TO A SINGLE-MEMBER         Y02082 51059602
**     OPEN PARAMETER LIST.                                      Y02082 51060402
**  3. THE EOV WORK AREA AND WTG TABLE WHICH WERE PASSED TO      Y02082 51061202
**     CLOSE ARE NOW PASSED TO OPEN, WITH REGISTERS RCORE AND    Y02082 51062002
**     RWTG ALREADY INITIALIZED WITH THE WORK AREA ADDRESS AND   Y02082 51062802
**     THE WTG TABLE ADDRESS, RESPECTIVELY.                      Y02082 51063602
*                                                                Y02082 51064402
IGC0101I EQU   *                        SECONDARY ENTRY POINT    Y02082 51065202
         BALR  RBASE,R0                 ESTABLISH BASE AT TOP    Y02082 51066002
OIN11665 EQU   *                        CALCULATE TOP            Y02082 51066402
         LA    RBASE,0(RBASE)           INSURE HI-ORDER BYTE = 0 Y02082 51066802
         LA    RF,OIN11665-OIN00000     SET RF FOR BASE REG CALC Y02082 51068402
         SR    RBASE,RF                 SET RBASE AS BASE REG    Y02082 51069202
*                                                                Y02082 51070002
         LR    RPAR,R1                  LOAD PARM LIST ADDRESS   Y02082 51070802
         LR    RPARC,RPAR               INIT CURR PARM LIST ADDR Y02082 51071602
         L     RDCB,PLISTDCB(,RPARC)    GET DCB ADDRESS          Y02082 51072402
         LA    RWTGC,WTGENTRY-WTG(,RWTG) INIT CURR WTG ADDRESS   Y02082 51073202
         MVC   WTGIDTTR-WTGENTRY(L'WTGIDTTR,RWTGC),OPENNEXT 3A   Y02080 51078202
         L     RC,DXATCOM3              GET RRPLIST PTR          Y02144 51093702
         MVI   RRFUNCTN,RRFOPEN         INDICATE OPEN FUNCTION   Y02144 51098602
         LR    RD,RCORE                 SET GO SWITCH ON         Y02082 51103502
         L     RB,CVTPTR                GET CVT ADDRESS          Y02082 51108402
         L     RTIOT,DXTIOTAD           GET NEXT TIOT ENTRY ADDR Y02082 51113302
*                                       AS SET UP BY IFG0202L    Y02082 51118202
*                                                                       51118402
*        A NEW COPY OF THE DCB MUST BE CREATED - THE DEVICE      YM7983 51118502
*        TYPE AND, HENCE, THE SIZE OF THE DCB MAY HAVE CHANGED   YM7983 51119002
*                                                                       51119502
         L     RB,DXUDCBAD              SAVE USER DCB ADDRESS    YM7983 51120002
         ICM   RB,B'1000',DXUKEY        SAVE USER KEY            YM7983 51120502
         MVC   DXUDCBAD,DXPDCBAD        USER DCB = COPY DCB SO   YM7983 51121002
*                                       INIT BUILDS NEW COPY     YM7983 51121502
         MVI   DXUKEY,K5                SET KEY TO THAT OF COPY  YM7983 51122002
         IECRES INIT,DCBCOPY=TOWKAR,STM=(3,14,WTGPREFX) NEW COPY YM7983 51122502
*        REG 2 RETURNED POINTING TO NEW COPY OF OLD COPY         YM7983 51123002
         STCM  RB,B'0111',DXUDCBAD+K1   REESTABLISH USER DCB ADD YM7983 51123502
         STCM  RB,B'1000',DXUKEY        REESTABLISH USER KEY     YM7983 51124002
*        MERGE REAL USER DCB INTO NEW COPY                       YM7983 51124502
         IECRES INIT,DCBCOPY=TOWKAR,STM=(2,14,WTGPREFX) UPD.COPY YM7983 51125002
*        COPY CREATE CLOBBERS DXREG9-DXREGE, DXREG0-DXREG1       YM8542 51125502
         XC    DXREGE,DXREGE            IND INIT ENTRY 193A      YM8542 51126002
         XC    DXREG0,DXREG0            IND NO ERROR             YM8542 51126502
*                                                                       51127002
OIN11670 EQU   *                        CONTINUE                 X02989 51128002
         ST    RCORE,DCBDEBAD           SAVE CORE ADDR IN DCB    X02989 51132902
*                                                                       51168902
*        CONSTRUCT CONTROL BLOCKS TO READ JFCB                          51200021
*                                                                       51400021
*        DEB, FIRST 36-BYTE                                             51600021
*                                                                       51800021
*              LOAD CVT POINTER TO AVOID DEPENDENCY ON RB STILL  Y02134 51850002
*              CONTAINING IT SINCE LAST TIME IT WAS LOADED       Y02134 51900002
         L     RB,CVTPTR                LOAD CVT ADDRESS         Y02134 51950002
         L     R1,CVTSVDCB-CVT(,RB)     ADDRESS OF SVCLIB DCB    Y02080 52000002
         L     R1,DCBDEBAD-IHADCB(,R1)  ADDR OF TASK SCHEDULER DEB      52200021
         MVC   DXDEB(K48),0(R1)         COPY TASK SCHEDULER DEB         52400021
         MVI   DXDEB+(DEBNMEXT-DEBBASIC),K1 SET NO. EXTS TO 1   YA03003 52410002
         MVC   DXDEBAPP,CVTXAPG-CVT(RB) SET DUMMY APP V T        Y02080 52450002
         MVI   DXDEBMOD,K0              SET FILE MASK TO ZERO    YM6841 52460002
         XC    DXDEBECB+K1(K3),DXDEBECB+K1  ZERO PURGE ECB ADDR  M0032  52500021
         LA    RF,DXDCB                 STORE ADDR OF WORK DCB IN WORK  52600021
         ST    RF,DXDCBAD               DEB FOR EXCP VALIDITY CHECK     52800021
         ST    RF,IOBWGHT               STORE WORK DCB ADDR IN IOB      53000021
         MVI   DXDEBID,DEBIDENT         DEB ID                          53200021
*                                                                       53400021
*        ECB, NEXT 4-BYTE                                               53600021
*                                                                       53800021
*                                                                       54000021
*        DCB, NEXT 8-BYTE                                               54200021
*                                                                       54400021
         LA    RF,DXDEB                 STORE ADDR OF WORK DEB IN WORK  54600021
         ST    RF,DXDCBDEB              DCB FOR EXCP VALIDITY CHECK     54800021
*                                                                       55000021
*        IOB, NEXT 32-BYTE                                              55200021
*                                                                       55400021
         MVI   IOBFLAG1,IOBUNREL        MAKE I/O REQUESTS UNRELATED     55600021
         LA    RF,DXECB                 STORE ADDR OF WORK ECB IN       55800021
         ST    RF,IOBECBPT              WORK IOB                        56000021
         LA    RF,DXCCW1                STORE START CCW ADDR IN         56200021
         ST    RF,IOBSTART-K1           WORK IOB                        56400021
*                                                                       56600021
         LA    RET,TIOEJFCB             JFCB PREFIX POINTER      Y02134 69878002
         IECRES LOCJFCB,(RET)           LOCATE JFCB              Y02134 69928002
*                                                                Y02134 69930002
         MVC   DXJBF,0(RET)             MOVE JFCB TO WORK AREA   Y02134 69932002
*                                                                       69938000
         ST    RTIOT,DXREG9             SAVE RTIOT ACROSS XCTL   A39979 69941021
*                                                                       69944000
         MVI   DXECB,K32                INDICATE SUCCESSFUL READ        69950000
         TM    JFCBMASK+K6,JFCTRACE     IS TRACE ROUTINE DESIRED Y02080 69960002
         BZ    OIN10400                 NO, GO TO NEXT PARM      Y02080 69960402
         OI    WTGPATHS+K1,WTGTRACE     YES, SET TRACE INDR ON   Y02080 69960802
         B     OIN10400                 PROCESS NEXT PARM.              69962000
*                                                                       70000021
*********************************************************************** 70200021
*                                                                       70400021
*  IF NO DCB CAN BE OPENED, FREEMAIN WHERE-TO-GO TABLE                  70450021
*  AND EXIT TO CALLER OF OPEN                                           70500021
*                                                                       70550021
OIN13000 EQU   *                        CHECK FOR ERROR                 70600002
         LTR   RD,RD                    CHECK THE GO SWITCH             70800021
         BNZ   OIN13200                 BR IF ON                        71000021
*                                                                       71320021
         IECRES FREE,PREFIX=WTG,A=(RWTG) FREMAIN WTG TABLE       Y02080 71360002
*                                                                       71380021
         LA    RF,K8                    SET RETURN CODE TO 8     X02989 71530402
*                                                                       71600021
*                                                                Y02080 71650002
*        RETURN TO CALLER                                        Y02080 71700002
*                                                                Y02080 71750002
         IECRES EXIT                    RETURN                   Y02080 71800002
*                                                                Y02080 71950002
*                                                                       72000021
*********************************************************************** 72200021
*                                                                       72400021
*  INITIALIZE WHERE-TO-GO TABLE BASE FOR XCTL                           72600021
*                                                                       73600021
OIN13200 EQU   *                        SET UP FOR NEXT LOAD     A39979 74600002
         MVC   WTGMODNM,OIN1500A        SET LOWEST OPEN NAME     Y02080 77800002
*                                                                       78400021
*  XCTL TO NEXT LOAD OF OPEN                                            78600002
*                                                                       78800021
         OI    RRFLAGS2,RRFFIN1         SET 1ST LOAD COMPLETED   Y02144 79050002
         LR    RCORE,RD                 GET LAST VALID WORK AREA Y02080 79100002
         LM    RTIOT,RET,DXREG9         REST REGS FOR THIS DCB   Y02080 79150002
         LM    R0,R1,DXREG0             FOR BRANCH QUEUED        Y02080 79200002
         L     R5,CVTPTR                PTR CVT                  Y02080 79250002
         L     R5,CVTDMSR-CVT(,R5)      ADDRESS OF RESIDENT RTN  Y02080 79300002
         IECRES XCTL                    BRANCH QUEUED            Y02080 79350002
*                                                                       79600021
         DROP  RWTG                                                     79800021
*                                                                       80000021
OIN13250 EQU   *                        SYSZTIOT ENQ ERROR       YM2869 80005002
*     THE CALLER OF OPEN HOLDS THE TIOT RESOURSE EXCLUSIVELY.  @ZA29752 80010037
*     THIS SHOULD NEVER VALIDLY HAPPEN AND CANNOT BE ALLOWED.  @ZA29752 80020037
         SR    RF,RF                    ZERO REG               @ZA29752 80030037
         SR    RC,RC                    ZERO REG               @ZA29752 80040037
         LA    RF,K0                    RETURN CODE            @ZA29752 80050037
         L     RC,ABND50D               ABEND CODE             @ZA29752 80060037
         ABEND (RC),DUMP                                       @ZA29752 80110037
*********************************************************************** 80200021
*                                                                       80400021
*        CONSTANTS                                                      80600021
*                                                                       80800021
ABND50D  DS    0F                                              @ZA29752 80810037
         DC    XL4'0000050D'                                   @ZA29752 80820037
OIN1500A DC    CL8'IFG0190 '            LOWEST OPEN NAME         Y02080 80850002
OIN1500K WTO   'IEC130I DDNAMEXX DD STATEMENT MISSING',MF=L,           X81000021
               DESC=6,                  JOB STATUS                     X81200021
               ROUTCDE=(11)             PROGRAMMER INFORMATION          81400021
OIN1500L EQU   *-OIN1500K               LENGTH OF ERROR MESSAGE         81600021
         DS    0F                                                       81640000
ONEK     DC    X'00000400'              1024 BYTES FOR LENGTH CALC      81660000
OIN1500M WTO   'IEC132I DDNAMEXX, MACRF=E SPECIFIED FOR A SYSIN OR SYSOX81710000
               UT DATA SET',MF=L,                                      X81712000
               DESC=6,                  JOB STATUS                     X81714000
               ROUTCDE=(11)             PROGRAMMER INFORMATION          81716000
OIN1500N EQU   *-OIN1500M               LENGTH OF MESSAGE               81718000
*                                                                       85200021
         XCTLTABL ID=(OPEN,IGC0001I,OPENNEXT,3A,VSAMCATL,1X,   @Y30DSDT*85330037
               VSAMVRP,IFG0192Y),SVC=019,BRT=YES,LENGTH=       @Y30DSDT 85342037
*                                                                       85400021
         IECDSECS EXPAND=YES            EXPAND DESIRED DSECTS HERE      86000021
*                                                                       86200021
         END                                                            86400021
./  ADD  SSI=72030363,NAME=IGC0002B
         TITLE 'IGC0002B                      OPEN TYPE=J - INITIAL MODU00200002
               ULE, MOVE JFCB'                                          00202002
IGC0002B CSECT                                                          00800021
*********************************************************************** 00900002
*                                                                     * 01000002
*        VS 2 RELEASE 030 DELETIONS/CHANGES                           * 01000137
*0000276070-276140,284600-285000,664548-666018,784300-784600   @ZA00118 01009137
*814500,828001-828002,834800,835300,836000                     @ZA00118 01018137
*0000                                                          @ZA08282 01027137
*0000                                                          @ZA09633 01036137
*0000826350,829365                                             @ZA09969 01037137
*0000664816-664828                                             @ZA10275 01038137
*0000664799,664805,664808                                      @ZA10558 01039137
*0000666454                                                    @ZA15088 01040137
*                                                                     * 01041137
*        VS 2 RELEASE 020 DELETIONS/CHANGES                           * 01046137
*0000333904                                                     ZA01282 01051137
*0000                                                          @ZA08282 01056137
*0000                                                          @ZA09633 01061137
*0000826350,829365                                             @ZA09969 01063137
*0000664816-664828                                             @ZA10275 01065137
*0000664799,664805,664808                                      @ZA10558 01067137
*                                                                     * 01070002
* MODULE NAME = IGC0002B (OS/VS2)                                     * 01100002
*                                                                     * 01200002
* DESCRIPTIVE NAME = OPEN TYPE = J INITIAL MODULE, MOVE JFCB          * 01300002
*                                                                     * 01400002
* COPYRIGHT = NONE                                                    * 01500002
*                                                                     * 01600002
* STATUS = RELEASE 2, LEVEL 0                                         * 01700002
*                                                                     * 01800002
* FUNCTION =                                                          * 01900002
*        1. SAVE REGISTERS 2-12 IN SVRB EXTENDED SAVE AREA, AND GET   * 02000002
*        MAIN STORAGE (VIA RESIDENT ROUTINE) FOR:                     * 02100002
*           A. WHERE-TO-GO TABLE.                                     * 02200002
*                                                                     * 02300002
*        2. OBTAIN COPIED PARAMETER LIST IN DATA MANAGEMENT KEY.      * 02400002
*                                                                     * 02500002
*        3. INITIALIZE EACH WHERE-TO-GO ENTRY EXCEPT FOR VTAM         * 02600002
*        REQUESTS.                                                    * 02700002
*                                                                     * 02800002
*        4. GET WORK AREA FOR A COPY OF EACH DCB/ACB; INITIALIZE IT,  * 02900002
*        AND COPY DCB/ACB.  IF DDNAME IS NOT IN TIOT, FREE WORK AREA  * 03000002
*        AFTER ISSUING THE WTO MESSAGE "IEC130I DDNAMEXX DD STATEMENT * 03100002
*        MISSING".                                                    * 03200002
*                                                                     * 03300002
*        5. MOVE THE JFCB FROM THE SCHEDULER WORK AREA INTO THE OPEN  * 03400002
*        WORK AREA. CHECK TO SEE IF THE TRACE ROUTINE HAS BEEN        * 03500002
*        REQUESTED.  IF IT HAS, THEN TURN ON THE TRACE ROUTINE        * 03600002
*        INDICATOR AT WTGPATHS+K1.                                    * 03700002
*                                                                     * 03800002
*        6. LOCATE X'07' ENTRY IN DCB EXIT LIST AND MOVE THE JFCB     * 03900002
*        INTO THE MAIN DCB WORK AREA.                                 * 04000002
*                                                                     * 04100002
* NOTES = SEE BELOW                                                   * 04200002
*                                                                     * 04300002
*    DEPENDENCIES =                                                   * 04400002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 04500002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 04600002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 04700002
*                                                                     * 04800002
*    RESTRICTIONS = NONE                                              * 04900002
*                                                                     * 05000002
*    REGISTER CONVENTIONS =                                           * 05100002
*            R2 POINTS TO DCB                                         * 05200002
*            R4 POINTS TO OPEN WORK AREA                              * 05300002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 05400002
*            R6 POINTS TO THE WTG TABLE                               * 05500002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 05600002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 05700002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 05800002
*            R10 POINTS TO THE UCB                                    * 05900002
*                                                                     * 06000002
*    PATCH LABEL = SEE THIRD LABEL BEFORE ORG STATEMENT AT END        * 06100002
*                  OF LISTING.                                        * 06200002
*                                                                     * 06300002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 06400002
*                                                                     * 06500002
*    PROCESSOR = ASSEMBLER XF                                         * 06600002
*                                                                     * 06700002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 06800002
*                  ORG STATEMENT AT END OF LISTING                    * 06900002
*                                                                     * 07000002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 07100002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 07200002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 07300002
*                                                                     * 07400002
* ENTRY POINT = OPEN TYPE = J OR SVC 22                               * 07500002
*                                                                     * 07600002
*    PURPOSE = INITIALIZE WORK AREAS FOR OPEN PROCESSING WITH CALLER  * 07700002
*              SUPPLIED JFCB.                                         * 07800002
*                                                                     * 07900002
*    LINKAGE = REGISTER 1 POINTING TO VARIABLE PARAMETER LIST         * 08000002
*                                                                     * 08100002
* INPUT = REGISTER 1 POINTING TO THE PARAMETER LIST                   * 08200002
*                                                                     * 08300002
* OUTPUT = WORK AREAS AND REGISTERS INITIALIZED FOR OPEN PROCESSING   * 08400002
*                                                                     * 08500002
* EXIT-NORMAL = IFG0193A NORMAL OPEN PROCESSING                       * 08600002
*                                                                     * 08700002
* EXIT-ERROR = CALLER IF NO DCB CAN BE OPENED                         * 08800002
*                                                                     * 08900002
* EXTERNAL REFERENCES = SEE BELOW                                     * 09000002
*                                                                     * 09100002
*    ROUTINES = IFG0193A,IFG019RA.                                    * 09200002
*                                                                     * 09300002
*    DATA AREAS = SEE PARAMETERS OF IECDSECS MACRO.                   * 09400002
*                                                                     * 09500002
*    CONTROL BLOCK = SEE PARAMETERS OF IECDSECS MACRO.                * 09600002
*                                                                     * 09700002
* TABLES = SEE XCTLTABL MACRO AT END OF LISTING.                      * 09800002
*                                                                     * 09900002
* MACROS = IECDSECS,IECEQU,IECRES,WTO,ENQ,XCTLTABL.                   * 10000002
*                                                                     * 10100002
* CHANGE ACTIVITY = NEW RELEASE (LEVEL 0)                             * 10200002
*                                                                     * 10300002
*********************************************************************** 10400002
         EJECT                                                          27600021
*                                                                       28600021
         USING IHADCB,RDCB              DEFINE BASE TO USER'S DCB       28800021
         USING FORCORE,RCORE            DEFINE BASE TO MAIN WORK AREA   29000021
         USING TIOENTRY,RTIOT           DEFINE BASE TO TIOT DD ENTRY    29200021
*                                                                       29600021
         BALR  RBASE,R0                 ESTABLISH BASE REGISTER         29800002
         USING *,RBASE                  DEFINE BASE REGISTER            30000021
*                                                                       30200021
         LR    RF,R5                    POINTER TO SVRB          YM1363 30210002
         LR    RPAR,R1                  SAVE DCB PARAM LIST ADDR Y02080 30250002
         USING RBBASIC,RF                                        Y02080 30292002
*                                                                       32236021
*********************************************************************** 32242021
*                                                                       32248021
*  GETMAIN THE WHERE-TO-GO TABLE                                        32254021
*                                                                       32260021
*                                                                Y02080 32294002
* SAVE REGISTERS 2-12 IN SVRB EXTENDED SAVE AREA                 Y02080 32294402
*                                                                Y02080 32294802
*                                                                Y02080 32302002
         IECRES GET,PREFIX=WTG,         GETMAIN FOR WTG TABLE    Y02080*32303902
               STM=(2,12,RBEXSAVE),A=(RPAR)                      Y02080 32305902
*                                                                       32307902
*        REGISTER 0 CONTAINS RETURN CODE FROM SYSZTIOT ENQ       YM2869 32309902
*                                                                       32312002
         DROP  RF                                                Y02080 32316002
         LA    RWTG,DXDCBLST-DXDCBLST(,R1) WTG ADDR TO RWTG REG  A39979 32320002
         USING WTG,RWTG                 DEFINE BASE TO WTG TABLE A39979 32328002
         IECRES LOAD,MODNM=OPENJ,BRANCH=NO,PREFIX=WTGPREFX       Y02080*32338002
                                        GIVE OPT TRACE A SHOT    Y02080 32348002
*                                                                       32360002
*        OBTAIN COPIED PARAMETER LIST IN DATA MANAGEMENT KEY     Y02082 32368002
*                                                                       32376002
         L     RPAR,WTGPREFX            WTG PREFIX ADDRESS       Y02082 32378002
         L     RC,IECRRPRM-IECPREFX(,RPAR) GET RRPLIST ADDRESS   Y02144 32378402
         MVI   RRFUNCTN-RRPLIST(RC),RRFOPENJ IND OPENJ FUNCTION  Y02144 32378802
         L     RPAR,IECUPRML-IECPREFX(,RPAR) COPY PARM LIST ADDR Y02082 32380002
*                                                                       32384002
*  INITIALIZE EACH WHERE-TO-GO TABLE ENTRY                              32544002
*                                                                       32552002
         SR    RD,RD                    SET GO SWITCH OFF        A39979 32560002
         LR    RPARC,RPAR               ADDR FIRST ENT PARM LIST A39979 32568002
         LA    RWTGC,WTGENTRY           ADDR FIRST ENT WTG TABLE A39979 32576002
         USING WTGENTRY,RWTGC           BASE TO CURRENT WTG ENT  A39979 32584002
*                                                                       32584502
*        TEST RESULT OF SYSZTIOT ENQ                             YM2869 32585002
*              REGISTER 0 NONZERO INDICATES CALLER OF OPENJ      YM2869 32585502
*              OBTAINED SYSZTIOT RESOURCE EXCLUSIVELY.           YM2869 32586002
*        THIS SHOULD NEVER OCCUR AND WILL NOT BE TOLERATED.      YM2869 32586502
*                                                                       32587002
         LTR   R0,R0                    IS RETURN CODE 0         YM2869 32587502
         BNZ   OIN23250                 BRANCH IF NOT            YM2869 32588002
*                                                                       32592002
OIN20200 EQU   *                        PROCESS PARM LIST LOOP          32600002
         L     RDCB,PLISTDCB(,RPARC)    LOAD CURRENT DCB ADDR           32800021
*                                                                       32810002
*        MAKE SURE THIS DCB IS NOT PREVIOUSLY DUPLICATED IN      YM2869 32820002
*        THE PARAMETER LIST                                      YM2869 32830002
*                                                                       32840002
         DROP  RWTGC                                             YM2869 32850002
         LA    R1,WTGENTRY              FIRST DCB'S WTG ENTRY    YM2869 32860002
         USING WTGENTRY,R1                                       YM2869 32870002
OIN20220 EQU   *                        PROCESS EACH DCB         YM2869 32880002
         CR    R1,RWTGC                 AT CURRENT ENTRY YET     YM2869 32890002
         BE    OIN20260                 BR IF YES-NO DUPLICATE   YM2869 32900002
         L     RCORE,WTGCORE-K1         GET WORKAREA             YM2869 32910002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE FOR LTR  YM2869 32920002
         LTR   RCORE,RCORE              IS WORKAREA PRESENT      YM2869 32930002
         BZ    OIN20240                 BR IF NO-GET NEXT DCB    YM2869 32940002
         CLM   RDCB,B'0111',DXUDCBAD+K1 IS CURRENT DCB BEING     YM2869 32950002
*                                       PROCESSED ALREADY        YM2869 32960002
         BE    OIN20400                 BR IF YES-DON'T PROCESS  YM2869 32970002
OIN20240 EQU   *                        GET NEXT DCB'S ENTRY     YM2869 32980002
         LA    R1,WTGENTRY+L'WTGENTRY   INCREMENT TO NEXT WTG    YM2869 32990002
         B     OIN20220                 CHECK NEXT ENTRY         YM2869 33000002
         DROP  R1                                                YM2869 33010002
         USING WTGENTRY,RWTGC                                    YM2869 33020002
OIN20260 EQU   *                        ON DUPLICATE             YM2869 33030002
*                                                                       33200021
         L     RA,CVTPTR                GET CVT ADDRESS          Y02082 33200102
         L     RA,CVTTCBP-CVT(,RA)      ADDR OF TCB POINTERS     Y02082 33200202
         L     RA,K4(,RA)               GET CURRENT TCB ADDR     Y02082 33200302
         USING TCB,RA                   PROVIDE ADDRESSABILITY   Y02082 33216802
         MODESET EXTKEY=RBT234,WORKREG=15 ASSUME USER KEY        Y02082 33233502
         TM    DCBOFLGS,DCBOFOPN+DCBOFIOF OPEN OR BUSY BITS ON   YM2869 33250002
         BNZ   OIN20400                 BR IF YES-GET NEXT DCB   Y02134 33300002
*                                                                Y02004 33310002
* DO NOT PROCESS VTAM REQUESTS                                   Y02004 33320002
*                                                                Y02004 33330002
         TM    DCBMACR,DCBMEXCP         TEST FOR EXCP            Y02004 33332002
         BO    OIN20300                 YES, CANNOT BE ACB       Y02004 33334002
         TM    DCBDSRG2,ACBDORGA        IS THIS AN ACB?          Y02004 33340002
         BZ    OIN20300                 BR IF NO                 Y02004 33342002
         USING IFGACB,RACB              ADDRESS ACB              Y02004 33344002
         CLC   ACBDDNM,=X'FF00000000000000' IS THIS A VTAM ACB?  Y02004 33346002
         BNE   OIN20300                 NO, OK TO OPEN           Y02004 33348002
         MVI   ACBERFLG,VSCACBCL        SET ACB ERROR FLAG       Y02004 33348402
         USING IHADCB,RDCB              RESTORE BASE FOR DCB     Y02004 33348802
         B     OIN20400                 GET NEXT DCB/ACB         Y02004 33349202
*        DETERMINE SIZE OF DCB/ACB FOR COPYING IT INTO WORKAREA  Y02134 33350002
OIN20300 EQU   *                        GET OPEN J WORK AREA            33352002
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 33354002
         LA    R0,OPENSIZE              SIZE OF OPEN WORKAREA    Y02134 33360002
         IECRES GET,LV=(0),PREFIX=YES,STM=(2,14,WTGPREFX),       Y02134*33370002
               ID=OJWA                                           Y02144 33372002
         LR    RCORE,R1                 ESTABLISH WORKAREA BASE  Y02134 33380002
         ST    RCORE,WTGCORE-K1         SAVE IN WTG TABLE ENTRY  Y02134 33390002
         L     RF,WTGPREFX              GET PREFIX POINTER      ZA01282 33390202
         MVC   DXATCOM3,IECRRPRM-IECPREFX(RF) SAVE RRPLIST PTR  ZA01282 33390402
*        INITIALIZE WORKAREA WITH CONTROL BLOCK POINTERS AND     Y02134 33392002
*        COPY DCB/ACB INTO WORKAREA                              Y02134 33394002
         IECRES INIT,DCBCOPY=TOWKAR,DEB=NO,STM=(3,14,WTGPREFX),  Y02134*33396002
               PREFIX=WTGPREFX                                   Y02082 33398002
         CLI   DXWCOPYE,K0              WAS COPY/INIT OK         Y02082 33448002
         BE    OIN20325                 BRANCH IF YES            Y02082 33498002
         CLI   DXWCOPYE,K2              WAS DDNAME MISSING       Y02082 33548002
         BNE   OIN20350                 NO-SOME OTHER REASON     Y02082 33598002
*                                                                       33648002
*********************************************************************** 33698002
*                                                                       33748002
*  WRITE  'IEC130I DDNAMEXX DD STATEMENT MISSING'  ERROR MESSAGE        33748402
*                                                                       33748802
OIN20310 EQU   *                        DDNAME MISSING FROM JCL         33749202
         MVC   DXLBL(OIN2500L),OIN2500K MOVE MSG TO WORKAREA     Y02134 33749602
         MVC   K12(L'DCBDDNAM,RCORE),DCBDDNAM MOVE DDNAME TO MSG Y02134 33749702
         LA    R1,DXLBL                 LOAD FOR WTO             Y02134 33749802
         WTO   MF=(E,(1))               WRITE MESSAGE TO PROGRAMMER     33749902
*                                                                       33753202
         B     OIN20350                 BR TO PROCESS NEXT DCB   Y02134 33755202
*                                                                       33755602
*********************************************************************** 33756002
OIN20325 EQU   *                        ASYNCHRONOUS PROCESSING? Y02082 33756402
         TM    DCBOFLGS,DCBOPEN         CHECK FOR OPENED DCB            33756702
         BO    OIN20350                 BR IF YES                Y02082 33760002
         TM    DCBOFLGS,DCBOLOCK        IS DCB NOT-LOCKED BIT ON        33800021
         BZ    OIN20350                 BR IF NO                 Y02134 34000002
         TM    DCBOFLGS,DCBOBUSY        IS DCB BUSY BIT ON              34200021
         BO    OIN20600                 BR IF YES TO OPEN DCB    Y02134 34400002
*                                                                       34600021
OIN20350 EQU   *                        FREE WORKAREA            Y02134 34650002
         NI    DCBOFLGS,X'FF'-DCBOBUSY  TURN OFF BUSY BIT        Y02082 34652002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(2,14,WTGPREFX)          Y02082 34654002
         XC    WTGENTRY,WTGENTRY        INVALIDATE THIS DCB      Y02134 34660002
OIN20400 EQU   *                        GET NEXT DCB IN PARM LIST       34800002
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 34850002
         TM    PLISTOPT(RPARC),LASTNTRY  CHECK FOR LAST ENTRY           35000021
         LA    RPARC,K4(,RPARC)         INCR TO NEXT DCB IN PARM LIST   35400021
         LA    RWTGC,L'WTGENTRY(,RWTGC) ADVANCE WTG ENTRY        A39979 35600021
         BZ    OIN20200                 BR IF NOT LAST ENTRY     A39979 35660021
         B     OIN23000                 BR TO EXIT OR XCTL       A39979 35720021
*                                                                       35800021
*********************************************************************** 36000021
*                                                                       36200021
*  DCB NEEDS TO BE OPENED.                                              36400021
*                                                                       36800021
OIN20600 EQU   *                        DCB PROCESSING LOOP             37000002
         L     R9,DXDSAB                FETCH DSAB ADDRESS       YM6510 37010002
         USING DSAB,R9                  DSAB ADDRESSABILITY      YM6510 37020002
         TM    DSABFLG4,DSABCKDS+DSABCKVL ARE DSAB CHKPT BITS ON YM6510 37020402
         BZ    OIN20700                 IF NOT, SKIP RESET TEST  YM6510 37020802
         TESTAUTH FCTN=1,KEY=YES,STATE=YES TEST CALLER STATE     YM6510 37021202
         LTR   RF,RF                    IS CALLER AUTHORIZED     YM6510 37021602
         BZ    OIN20700                 IF YES, SKIP RESET       YM6510 37021702
         MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 37022002
         NI    DSABFLG4,ALLBITS-DSABCKDS-DSABCKVL RESET CHKPT FLGY02083 37030002
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 37032002
         DROP  R9                                                YM6510 37034002
         USING TIOENTRY,RTIOT           TIOT ADDRESSABILITY      YM6510 37036002
OIN20700 EQU   *                        DCB PROCESSING LOOP CONT YM6510 37042002
         MVC   WTGIDTTR-WTGENTRY(L'WTGIDTTR,RWTGC),OPENNEXT 193A Y02080 37050002
         XC    DXREGE,DXREGE            IND FIRST ENTRY TO 193A  Y02080 37100002
         XC    DXREG0,DXREG0            CLEAR DMABCOND INDR      Y02080 37150002
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDRESS   Y02134 37200002
         L     RET,DXTCBADR             GET TCB ADDRESS          Y02134 37250002
         L     RET,TCBTIO-TCB(RET)      LOAD TIOT ADDRESS        Y02134 37300002
*                                                                       38050000
         TM    DCBOFLGS,DCBOCON         CHECK FOR EOV CONCATENATION     38100000
         BZ    OIN20800                 BR IF NO TO CHK DDNAME   Y02082 38150002
         TM    DCBDSRG2,ACBDORGA        IS CONTROL BLOCK AN ACB  Y02082 38160002
         BZ    OIN20350                 BR NO, EOVC BIT CANNOT=1 Y02082 38170002
         LTR   RTIOT,RTIOT              TIOT ENTRY FOUND         Y02082 38180002
         BZ    OIN20350                 NO, BR TO FREE WORK AREA Y02082 38180102
         TM    TIOELINK,TIOESSDS        TEST IF SPOOLED INPUT    YM5126 38180202
         BZ    OIN20350                 BR NO, EOVC BIT CANNOT=1 Y02082 38180302
         CLI   TIOEDDNM,BLANK           BLANK DDNAME FOR CONCAT  Y02082 38184202
         BNE   OIN20350                 BR NO, ERROR             Y02082 38186202
*                                                                Y02082 38186602
         L     RF,WTGPREFX              GET PREFIX ADDR          Y02082 38187002
         LA    RF,IECREGSV-IECPREFX(RF) GET REG SAVE ADDR        Y02082 38187402
         LR    RC,RF                    SAVE REGSAVE POINTER     Y02082 38187802
         STM   RET,R3,IECREGSV-IECREGSV(RF) SAVE REGS            Y02082 38187902
*                                                                Y02082 38283002
         TESTAUTH STATE=YES,FCTN=1      TEST STATE, APF          Y02082 38330002
*                                                                Y02082 38377002
         LTR   RF,RF                    IS CALLER AUTHORIZED TO  Y02082 38424002
*                                       HAVE EOVC BIT = 1        Y02082 38471002
         LM    RET,R3,IECREGSV-IECREGSV(RC) RESTORE REGS         Y02082 38518002
         BZ    OIN21300                 IF YES, BR TO CONTINUE   Y02082 38565002
         B     OIN20350                 IF NO, GO FREE WORK AREA Y02082 38612002
*                                                                       38659002
OIN20800 EQU *                          CONTINUE                        38706002
*                                                                       38753002
*                                                                       38800021
OIN21300 EQU   *                        CHECK FOR SPOOLED ACB           45216002
*                                                                       45224000
*        TEST FOR A NON-SUBSYSTEM ACB                            YM1363 45232002
*        - IF FOUND THE ACB WILL BE BYPASSED                     YM1363 45234002
*          WORKAREA WILL NOT BE GOTTEN AND                       YM1363 45240002
*          THE BUSY BIT WILL NOT BE TURNED ON                    YM1363 45242002
*                                                                       45248000
         TM    DCBMACR,DCBMEXCP         IS ACCESS METHOD EXCP           45256000
         BO    OIN21350                 YES, CANNOT BE AN ACB    YM3073 45264002
*                                                                       45272000
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB         45280000
         BZ    OIN21400                 NO, TAKE NORMAL DCB PATH        45288000
*                                                                       45296000
         TM    DCBMACR,ACBMJEP          IS THIS A SUBSYSTEM ACB  YM1363 45304002
         BO    OIN21400                 YES, VALID ACB                  45312000
*                                                                       45320000
         TM    TIOELINK,TIOTSPOL        IS THIS A SPOOLED ACB           45328000
         BM    OIN21400                 YES, VALID ACB                  45336000
*                                                                       45344000
         B     OIN20350                 BYPASS INVALID ACB, BUSY Y02134 45352002
*                                       BIT OFF - NO WORK AREA          45360000
*                                                                YM3073 45362002
OIN21350 EQU   *                        TEST FOR EXCP & SPOOL    YM3073 45364002
*                                                                YM3073 45366002
         TM    TIOELINK,TIOTSPOL        IS THIS A SPOOLED DCB    YM3073 45366402
         BNM   OIN21400                 NO, OPENJ EXCP DCB       YM3073 45366802
*                                                                YM3073 45367202
*****************************************************************YM3073 45367402
*                                                                YM3073 45367502
*   WRITE  'IEC132I DDNAMEXX, MACRF=E WAS SPECIFIED FOR          YM3073 45369502
*   A SYSIN OR SYSOUT DATA SET' ERROR MESSAGE                    YM3073 45369902
*                                                                YM3073 45370002
*****************************************************************YM3073 45370102
*                                                                YM3073 45370302
         LR    R1,RCORE                 MSG ADDR FOR WTO         YM3073 45370702
         MVC   0(OIN2500N,R1),OIN2500M  MOVE MSG TO WORKAREA     YM3073 45371102
         MVC   K12(L'DCBDDNAM,R1),DCBDDNAM MOVE DDNAME TO MSG    YM3073 45371202
         WTO   MF=(E,(1))               WRITE MSG TO PROGRAMMER  YM3073 45371302
         B     OIN20350                 BYPASS OPEN              YM3073 45372802
*                                                                       45373502
*                                                                       45400021
*  THIS DCB IS OPENABLE                                          Y02082 45400402
*  INITIALIZE CONTROL BLOCKS IN MAIN WORK AREA.                         45800021
*                                                                       46000021
OIN21400 EQU   *                        INITIALIZE TO PROCESS OPEN      46200002
         LR    RF,RTIOT                 CALC TIOT DD ENTRY OFFSET FROM  46400021
         SR    RF,RET                   START OF TIOT                   46600021
         STH   RF,DCBTIOT               STORE TIOT OFFSET IN DCB        46800021
         MVC   DCBMACRF,DCBMACR         MOVE MACRF                      47000021
         OI    DCBOFLGS,DCBOBUSY        SET DCB BUSY BIT ON             47600021
         LR    RD,RCORE                 SET OPEN GO SWITCH ON    Y02080 47800002
*                                                                       48000021
         ST    RCORE,DCBDEBAD           SAVE CORE ADDR IN DCB DEB SLOT  48800021
         MVC   DCBIFLGS,DCBIFLG         MOVE IN IOS FLAGS               49000021
         IECRES INIT,DCBCOPY=FRWKAR,STM=(0,14,WTGPREFX) UPDATE   YM5702*49050002
                                        THE USER'S DCB           YM5702 49100002
*                                                                       49600021
*        CONSTRUCT CONTROL BLOCKS TO READ JFCB                          49800021
*                                                                       50000021
*        DEB, FIRST 36-BYTE                                             50200021
*                                                                       50400021
         L     RB,CVTPTR                LOAD ADDR OF CVT         Y02134 50450002
         L     R1,CVTSVDCB-CVT(,RB)     ADDRESS OF SVCLIB DCB    Y02080 50600002
         L     R1,DCBDEBAD-IHADCB(,R1)  ADDR OF TASK SCHEDULER DEB      50800021
         MVC   DXDEB(K48),K0(R1)        COPY TASK SCHEDULER DEB         51000002
         MVI   DXDEB+(DEBNMEXT-DEBBASIC),K1 SET NO. EXTENT TO 1 YA03003 51010002
         MVC   DXDEBAPP,CVTXAPG-CVT(RB) SET DUMMY APP VEC TBL    Y02080 51050002
         MVI   DXDEBMOD,K0              SET FILE MASK TO ZERO    YM6841 51060002
         XC    DXDEBECB+K1(K3),DXDEBECB+K1  ZERO PURGE ECB ADDR  M0032  51100021
         LA    RF,DXDCB                 STORE ADDR OF WORK DCB IN WORK  51200021
         ST    RF,DXDCBAD               DEB FOR EXCP VALIDITY CHECK     51400021
         ST    RF,IOBWGHT               STORE WORK DCB ADDR IN IOB      51600021
         MVI   DXDEBID,DEBIDENT         DEB ID                          51800021
*                                                                       52000021
*        ECB, NEXT 4-BYTE                                               52200021
*                                                                       52400021
         MVI   DXECB,K32                POST JFCB MOVE                  52720000
*                                                                       52800021
*        DCB, NEXT 8-BYTE                                               53000021
*                                                                       53200021
         LA    RF,DXDEB                 STORE ADDR OF WORK DEB IN WORK  53400021
         ST    RF,DXDCBDEB              DCB FOR EXCP VALIDITY CHECK     53600021
*                                                                       53800021
*        IOB, NEXT 32-BYTE                                              54000021
*                                                                       54200021
         MVI   IOBFLAG1,IOBUNREL        MAKE I/O REQUESTS UNRELATED     54400021
         LA    RF,DXECB                 STORE ADDR OF WORK ECB IN       54600021
         ST    RF,IOBECBPT              WORK IOB                        54800021
         LA    RF,DXCCW1                STORE START CCW ADDR IN         55000021
         ST    RF,IOBSTART-K1           WORK IOB                        55200021
*                                                                       55400021
         TM    DCBMACR,DCBMEXCP         IS ACCESS METHOD EXCP           60024000
         BO    OIN21450                 YES  NORMAL PROCESSING          60032000
*                                                                       60040000
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB         60048000
         BZ    OIN21450                 NO  NORMAL PROCESSING           60056000
*                                                                       60064000
         TM    TIOELINK,TIOTSPOL        IS THIS A SPOOLED ACB           60072000
         BZ    OIN21450                 NO  NORMAL PROCESSING           60080000
         USING IFGACB,RACB              DEFINE BASE FOR ACB             60088000
*                                                                       60096000
         L     RF,ACBUJFCB              LOAD ADDRESS OF JFCB     X02050 60104000
         LTR   RF,RF                    VALID ADDRESS                   60120000
         BZ    OIN22400                 NO  POST JFCB ERROR             60128000
         LA    RC,OIN21447              BR                       Y02082 60128402
*  OBTAIN LOCAL LOCK TO LOCK OUT GET/FREEMAINS; ENSURE JFCB IS INY02082 60128802
*  USER KEY, AND DO MOVE IN KEY ZERO.                            Y02082 60129202
OIN21435 EQU   *                        COPY JFCB                Y02082 60129602
         LR    RET,RF                   SAVE USER JFCB ADDR      Y02082 60130002
         L     RF,WTGPREFX              GET WTG PREFIX ADDR      Y02082 60130402
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS            Y02082 60130802
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02082 60131202
OIN21440 EQU   *                        SETLOCK                  Y02082 60131602
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND, GET LOCK         Y02082*60132002
               RELATED=(FREEMAIN,IGC0002B(OIN21445))             Y02082 60132402
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 60132802
         MODESET KEYADDR=DXUKEY,WORKREG=11 ASSUME USER KEY       Y02082 60133202
         OC    K0(L'DXJBF,RET),K0(RET)  TOUCH USER'S JFCB        Y02082 60133602
         MODESET EXTKEY=ZERO            ASSUME KEY O             Y02082 60134002
         MVC   DXJBF,K0(RET)            MOVE USER JFCB           Y02082 60134402
OIN21445 EQU   *                        RELEASE SETLOCK          Y02082 60135202
         SETLOCK RELEASE,TYPE=LOCAL,    RELEASE LOCK             Y02082*60135602
               RELATED=(FREEMAIN,IGC0002B(OIN21140))             Y02082 60136002
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 60136402
         MODESET EXTKEY=DATAMGT         RESTORE DM KEY           Y02082 60136802
         TM    JFCBMASK+K6,JFCTRACE     IS TRACE ROUTINE DESIRED?       60136902
         BZR   RC                       NO, RETURN TO COMPLETE PROCESS  60137102
         OI    WTGPATHS+K1,WTGTRACE     YES, SET TRACE INDR ON          60142802
         BR    RC                       RETURN                   Y02082 60144602
OIN21447 EQU   *                        ERROR                    Y02082 60148302
         B     OIN22780                 BYPASS NORMAL PROCESSING        60152002
*                                                                       60160000
         USING IHADCB,RDCB              DEFINE BASE TO USER'S DCB       60168000
OIN21450 EQU   *                        COPY JFCB FROM USER             60176002
*                                                                       60200021
*********************************************************************** 60400021
*                                                                       60600021
*  LOCATE AND MOVE THE JFCB FROM THE AREA POINTED TO BY THE DCB         60800021
*  EXIT LIST X'07' ENTRY TO THE DCB MAIN WORK AREA.                     61000021
*                                                                       61200021
         TM    DCBMACRF,DCBMEXCP        CHECK FOR EXCP                  61400021
         BNO   OIN22000                 BR IF NO                        61600021
         TM    DCBMACRF,DCBMFOUN        CHECK FOR FOUNDATION ENTENSION  61800021
         BNO   OIN22400                 BR IF NO                        62000021
*                                                                       62200021
OIN22000 EQU   *                        VALIDITY CHECK EXIT LIST        62400002
         CLC   DCBEXLST+K1(K3),OIN2570K  IS EXIT LIST ADDR 0 OR 1       62600021
         BNH   OIN22400                 BR IF NO EXIT LIST              62800021
         L     RF,DCBEXLST              PICK UP ADDR OF EXIT LIST       63000021
         MODESET KEYADDR=DXUKEY,WORKREG=1 USER KEY FOR EXITLIST  Y02082 63000402
*                                                                       63200021
OIN22200 EQU   *                        CHECK FOR OPEN J ENTRY          63400002
         CLI   0(RF),XLRDJFCB           CHECK FOR JFCB ADDR ENTRY       63600021
         BE    OIN22600                 BR IF FOUND                     63800021
         CLI   0(RF),XLRDJFCB+LASTNTRY  CHECK FOR JFCB ADDR ENTRY       64000021
         BE    OIN22600                 BR IF FOUND                     64200021
*                                                                       64400021
         TM    K0(RF),LASTNTRY          CHECK FOR LAST ENTRY            64600002
         LA    RF,K4(RF)                ADVANCE TO NEXT ENTRY           64800021
         BNO   OIN22200                 BR IF MORE ENTRIES       Y02080 65000002
*                                                                       65200021
OIN22400 EQU   *                        SET OFF JFCB ERROR              65400002
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 65400402
         MVI   DXECB,ECBCOD7F-ECBNOERR  'POST' ECB WITH 'ERROR' CODE    65600021
         B     OIN22780                 BR TO ABEND IN NEXT MODULE      65800002
*                                                                       66000021
OIN22600 EQU   *                        CONTINUE                        66200002
         L     RF,0(RF)                 GET JFCB ADDR FROM EXIT LIST    66400021
         MODESET EXTKEY=DATAMGT         RET TO OPEN KEY FOR SWAP Y02082 66400102
         BAL   RC,OIN21435              MOVE USER JFCB           Y02082 66400402
         EJECT                                                          66403402
*                                                                       66403837
*********************************************************************** 66403937
*                                                                       66404137
*        IN ORDER TO AVOID ALLOWING THE DATA SET                        66404237
*        TO BE SCRATCHED WHILE IT IS OPEN                               66404337
*        ENQ ON DATA SET NAME BEING OPENED IF 1) - 4) ARE TRUE   YM5388 66404437
*        1) SYSTEM JFCB EXISTS                                   YM5388 66404602
*        2) DATA SET NAME DIFFERENT THAN SYSTEM JFCB'S           YM5388 66405202
*        3) DIRECT ACCESS DEVICE                                 YM5388 66405802
*        4) NOT ACB OPEN                                         YM5388 66406402
*                                                                       66407002
*********************************************************************** 66407437
*                                                                Y02082 66407537
         L     RF,DXUCBADR              GET UCB ADDRESS          Y02082 66418402
         LTR   RF,RF                    IS THERE ONE             Y02082 66421402
         BZ    OIN22700                 BR IF NO                 Y02082 66424402
         TM    UCBTBYT3-UCBOB(RF),UCB3DACC  IS IT DIRECT ACCESS  Y02082 66427402
         BZ    OIN22700                 BR IF NO                 Y02082 66430402
         TM    DCBMACRF,DCBMEXCP        CHECK FOR EXCP           Y02082 66433402
         BO    OIN22605                 BRANCH IF YES            Y02082 66436402
         TM    DCBDSRG2,ACBDORGA        IS IT ACB                Y02082 66439402
         BO    OIN22700                 BRANCH IF YES            Y02082 66442202
OIN22605 EQU   *                        ENQ DSNAME               Y02082 66452602
         XR    RB,RB                    ZERO FOR ICM             YM5388 66455537
         ICM   RB,B'0111',TIOEJFCB      GET SYSTEM JFCB ADDRESS  YM5388 66455637
         BZ    OIN22780                 BRANCH IF ZERO - SKIP    YM5388X66455737
                                        JFCB PROCESSING          YM5388 66455837
         LA    RB,TIOEJFCB              LOAD ADDR OF JFCB ADDR   YM5388 66455937
         IECRES LOCJFCB,(RB)            LOCATE SYSTEM JFCB       YM5388 66456037
         CLC   JFCBDSNM,JFCBDSNM-INFMJFCB(RB) ARE DSNAMES EQUAL  YM5388 66456137
         BE    OIN22700                 SKIP ENQ IF YES          YM5388 66456237
         CLC   JFCBDSNM,VTOCNAME        TEST IF F4 DSCB NAME     YM6549 66456337
         BE    OIN22700                 SKIP ENQ IF YES          YM6549 66456437
         L     RF,WTGPREFX              POINT TO SAVE AREA     @ZA10275 66456537
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS          @ZA10275 66456637
         TESTAUTH FCTN=1,KEY=YES,BRANCH=YES AUTHORIZED CALLER  @ZA10275 66456737
         LTR   RF,RF                    TEST FOR AUTHORZTN     @ZA10275 66456837
         L     RF,WTGPREFX              LOAD SAVE AREA POINTER @ZA10275 66456937
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       @ZA10275 66457037
         BZ    OIN22700                 BYPASS ENQ             @ZA10275 66457137
*                                                                       66457237
*********************************************************************** 66457337
*                                                                       66457437
*        IF UPDATING DSNAME, ISSUE ENQ IF                               66457537
*        1) NEW DATA SET NAME WILL REPLACE OLD DSNAME                   66457637
*        2) OLD DATA SET IS NOT CURRENTLY OPEN                          66457737
*                                                                       66457837
*        IF NOT UPDATING DSNAME DYNAMICALLY                             66457937
*        ALLOCATE THE DATA SET                                          66458037
*                                                                       66458137
*********************************************************************** 66458237
*                                                                       66458337
         TM    JFCBTSDM,JFCNWRIT        INHIBIT JFCB UPDATE    @ZA02193 66458437
         BO    OIN22650                 BRANCH TO ALLOCATE     @ZA02193 66458537
         EJECT                                                          66458637
*                                                                       66458737
*********************************************************************** 66458837
*                                                                Y02082 66458937
*        ENQ SHARED IF DISP=SHR                                  YM5388 66459337
*        ENQ EXCLUSIVE OTHERWISE                                 YM5388 66459737
*                                                                       66459837
*        ENQ IS DONE BY DYNAMIC ALLOCATION                              66459937
*                                                                       66460037
*        MAJOR NAME - SYSDSN                                     YM5388 66460137
*        MINOR NAME - DATASET NAME WITH TRAILING BLANKS STRIPPED YM5388 66460237
*                                                                       66460637
*********************************************************************** 66461337
*                                                                       66461837
*        GET NUMBER OF NON-BLANK CHARACTERS IN DATASET NAME      YM2881 66461937
*                                                                       66462037
         LA    RB,JFCBDSNM+L'JFCBDSNM-K1 LAST BYTE OF DSNAME     YM2881 66462137
OIN22607 EQU   *                        SEARCH FOR NON-BLANK     YM2881 66462237
         CLI   K0(RB),C' '              IS THIS ONE BLANK        YM2881 66462337
         BNE   OIN22608                 BR IF NO TO COMPUTE      YM2881 66462437
*                                       LENGTH OF NAME           YM2881 66462537
         BCT   RB,OIN22607              TRY NEXT BYTE            YM2881 66462637
OIN22608 EQU   *                        CALCULATE LENGTH         YM2881 66462737
         LA    RC,JFCBDSNM-K1           BYTE PRECEDING DSNAME    YM2881 66462837
         SR    RB,RC                    RB HAS LENGTH FOR ENQ    YM2881 66462937
         EJECT                                                          66463037
*                                                                       66463137
*********************************************************************** 66463237
*                                                                       66463337
*        SETUP PARMLIST FOR IEFAB4DC                                    66463437
*                                                                       66463537
*********************************************************************** 66463637
*                                                                       66463737
SCHED    EQU   X'01'                    KEY 1 FOR IEFAB4DC     @ZA00118 66463837
         IECRES GET,LV=QLENGTH,KEY=SCHED, GET IEFAB4DC PRMLST  @OZ00118X66463937
               PREFIX=YES,ID=DSN,                              @OZ00118X66464037
               STM=(R2,RET,WTGPREFX)                           @OZ00118 66464137
         USING QSYSDSN,R1               PARMLIST BASE          @ZA00118 66464237
         LA    RF,JCTPTR                GET JCT POINTER        @ZA08282 66464337
         ST    RF,QMPARMS               SAVE IN PARM LIST      @ZA08282 66464437
         LA    RF,JCTADDR               GET JCT ADDRESS        @ZA08282 66464537
         ST    RF,JCTPTR                SAVE IN JCT POINTER    @ZA08282 66464637
         ST    RF,QJCT                  SAVE IN PARM LIST      @ZA08282 66464737
         LA    RF,RLCONST               GET POINTER TO RL      @ZA08282 66464837
         ST    RF,RLPTR                 SAVE IN RL POINTER     @ZA08282 66464937
         L     RF,DXJSCBAD              LOAD JSCB POINTER      @ZA08282 66465037
         L     R0,JSCBJCT-IEZJSCB(,RF)  POINT TO JCT PTR       @ZA08282 66465137
         SLL   R0,K8(0)                 SHIFT TO HI ORDER BYTE @ZA08282 66465237
         ST    R0,JCTPFIX               SAVE IN PARM LIST      @ZA08282 66465337
         MVC   RLCONST,RL               LOAD RL CONSTANT       @ZA08282 66465437
         MVC   B0CONST,B0               LOAD B0 CONSTANT       @ZA08282 66465537
         LR    R0,R1                    SAVE WORK AREA PTR     @ZA08282 66465637
         ST    RD,SAVEAREA+K4           SAVE SWITCH            @ZA08282 66465737
         LA    RD,SAVEAREA              LOAD SAVE AREA         @ZA08282 66465837
         LA    R1,QMPARMS               LOAD PTR FOR Q MNGR    @ZA08282 66465937
         L     RF,CVTPTR(,0)            GET CVT ADDRESS        @ZA08282 66466037
         L     RF,CVTJESCT-CVT(,RF)     GET JESCT ADDRESS      @ZA08282 66466137
         L     RF,K8(,RF)               GET QMNGIO ADDRESS     @ZA08282 66466237
         MODESET EXTKEY=ZERO            KEY ZERO FOR Q MANAGER @ZA08282 66466337
         BALR  RET,RF                                          @ZA08282 66466437
         LR    R1,R0                    RESTORE REQ 1          @ZA08282 66466537
         STH   RB,DSNLEN                SAVE LENGTH            @ZA00118 66466637
         L     RD,SAVEAREA+K4           RESTORE SAVE AREA PTR  @ZA08282 66466737
         MVC   DSNAME,JFCBDSNM          SET UP DSN FOR ENQ     @ZA00118 66466837
         LA    RF,DSRRFMAP              GET POINTER            @ZA00118 66466937
         ST    RF,QDSRRF                SAVE IN PARM LIST      @ZA00118 66467037
         MVC   DSRRFMAP,DSRRFBIT        INIT DSRRFMAP          @ZA00118 66467137
         L     RF,DXJSCBAD              LOAD JSCB POINTER      @ZA00118 66467237
         LA    R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER  @ZA00118 66467337
         LA    RF,JSCBSTEP-IEZJSCB(,RF) GET STEP POINTER       @ZA08282 66467437
         ST    RF,QSTEPNUM              SAVE IN PARM LIST      @ZA08282 66467537
         LA    RF,DSNLEN                POINT TO DSNAME        @ZA00118 66467637
         ST    RF,QDSNP                 SAVE IN PARMLIST       @ZA00118 66467737
         ST    R0,QTCB                  SAVE IN PARM LIST      @ZA00118 66467837
         LA    RF,ALFNCMAP              POINT AT ALFNCMAP      @ZA00118 66467937
         ST    RF,QALFNC                SAVE IN PARM LIST      @ZA00118 66468037
         MVC   ALFNCMAP,ALFNCBIT        INIT ALFNCMAP          @ZA00118 66468137
         LA    RF,QRETCODE              POINT TO RET CODE      @ZA00118 66468237
         ST    RF,QRET                  SAVE IN PARM LIST      @ZA00118 66468337
         L     RF,DXTCBADR              LOAD TCB ADDRESS       @ZA00118 66468437
         LA    RF,TCBTIO-TCB(,RF)       POINT TO TIOT PTR      @ZA00118 66468537
         ST    RF,QMSGPARM              SAVE IN PARM LIST      @ZA00118 66468637
         EJECT                                                          66468737
*                                                                       66468837
*********************************************************************** 66468937
*                                                                       66469037
*        CHECK FOR SHARE ENQ OR EXCLUSIVE                               66469137
*                                                                       66469237
*********************************************************************** 66469337
*                                                                       66469437
         TM    JFCBIND2,JFCSHARE        IS DISP SHR              YM5388 66469537
         BO    OIN22610                 ENQ SHR IF YES         @ZA00118 66469637
*                                                                       66469737
*********************************************************************** 66469837
*                                                                       66469937
         OI    DSRRFMAP,ENQEXCL         INDICATE EXCLUSIVE ENQ @ZA00118 66470137
         OI    ALFNCMAP+K6,NQEXCLSW     INDICATE EXCLUSIVE ENQ @ZA00118 66470337
         B     OIN22615                 GOTO IEFAB4DC          @ZA00118 66470537
*                                                                       66470937
OIN22610 EQU   *                        SETUP FOR ENQ SHR      @ZA00118 66471137
*                                                                       66471337
         OI    DSRRFMAP,ENQSHR          INDICATE SHARED ENQ    @ZA00118 66471437
*                                                                       66471737
OIN22615 EQU   *                        GOTO IEFAB4DC          @ZA00118 66471937
*                                                                       66472637
         ST    RD,SAVEAREA+K4           SAVE SWITCH            @ZA00118 66473637
         MODESET EXTKEY=ZERO            KEY ZERO FOR IFG019RA  @ZA00118 66474437
         LA    RD,SAVEAREA              LOAD SAVE AREA         @ZA00118 66474537
         IECRES LOAD,MODNM=IEFAB4DC,BRCODE=OIN22620, IEFAB4DC  @ZA00118X66474637
               PREFIX=WTGPREFX,BRANCH=DIRECT                            66474737
         EJECT                                                          66476337
*                                                                       66476537
*********************************************************************** 66476937
*                                                                       66477937
*        RETURN FROM IEFAB4DC                                           66478037
*                                                                       66478137
*********************************************************************** 66478437
*                                                                       66478737
OIN22620 EQU   *                        RETURN FROM IEFAB4DC   @ZA00118 66479037
*                                                                       66479337
         MODESET EXTKEY=DATAMGT         OPEN KEY               @ZA00118 66479637
         IECRES LOAD,MODNM=OPENJ,BRANCH=NO,PREFIX=WTGPREFX     @ZA00118 66479937
         XC    WTGMODEP,WTGMODEP        CLEAR ADDRESS          @ZA00118 66480137
         L     RD,SAVEAREA+K4           RESTORE RD             @ZA00118 66480337
         CLC   QRETCODE,ZEROS           CHECK RETURN CODE      @ZA10558 66480537
         BNE   OIN22630                 BRANCH IF ERROR        @ZA10558 66480737
*                                                                       66481137
         LH    RB,DSNLEN                LOAD DSN LENGTH (ENQ)  @ZA00118 66481237
         LA    RC,JFCBDSNM              RCORE DSN FOR ENQ      @ZA00118 66481337
         DROP  R1                                                       66481437
         IECRES FREE,PREFIX=YES,A=(1),STM=(R0,RET,WTGPREFX)    @ZA00118 66481537
*                                                                       66481637
         EJECT                                                          66483237
*                                                                       66483337
*********************************************************************** 66483437
*                                                                       66483537
*        SYSZOPEN ENQ FOR SCRATCH PROTECTION                            66483737
*                                                                       66483837
*********************************************************************** 66483937
*                                                                       66484237
         LA    RB,TIOEJFCB              LOAD ADDR OF JFCB ADDR @ZA00118 66485337
         IECRES LOCJFCB,(RB)            LOCATE SYSTEM JFCB     @ZA00118 66485437
*                                                                       66485537
*        GET NUMBER OF NON-BLANK CHARACTERS IN DATASET NAME             66485637
*                                                                       66485737
         LA    RC,JFCBDSNM-INFMJFCB(,RB) SAVE DSN POINTER      @ZA00118 66485837
         BCTR  RC,K0                    BYTE PRECEDING DSN     @ZA00118 66485937
         LA    RB,JFCBDSNM-INFMJFCB+L'JFCBDSNM-K1(,RB) END DSN @ZA00118 66486037
*                                                                       66486137
OIN22622 EQU   *                        SEARCH FOR NON-BLANK   @ZA00118 66486237
*                                                                       66486337
         CLI   K0(RB),C' '              IS THIS ONE BLANK      @ZA00118 66486437
         BNE   OIN22623                 BR IF NO TO COMPUTE    @ZA00118 66486537
*                                       LENGTH OF NAME         @ZA00118 66486637
         BCT   RB,OIN22622              TRY NEXT BYTE          @ZA00118 66486737
*                                                                       66486837
OIN22623 EQU   *                        CALCULATE LENGTH       @ZA00118 66486937
*                                                                       66487037
         SR    RB,RC                    RB HAS LENGTH FOR ENQ  @ZA00118 66487137
         LA    RC,JFCBDSNM-INFMJFCB+K1(,RC) DSNAME FOR ENQ     @ZA00118 66487237
*                                                                       66487737
OIN22625 EQU   *                        ENQ ON SYSZOPEN        @ZA00118 66487837
*                                                                       66488037
* SYSZOPEN PREVENTS UNALLOCATION OF OPEN DATA SETS                      66488237
*                                                                       66488337
         MVC   DXWORK(L'ENQLIST),ENQLIST INIT ENQ LIST         @ZA00118 66488437
         L     RF,DXJSCBAD              LOAD JSCB ADDRESS      @ZA00118 66489037
         L     R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER  @ZA00118 66490737
         ENQ   (SYSZOPEN,(RC),,(RB)),   TCB ENQ EXCLUSIVE      @ZA00118X66495737
               TCB=(R0),RET=USE,MF=(E,DXWORK1),                @ZA00118X66496737
               RELATED=(SYSZOPEN,IFG0202K(SYSZOPEN))           @ZA00118 66500737
*                                                                       66505737
         LTR   RF,RF                    DSNAME ALREADY IN USE  @ZA00118 66510737
         BZ    OIN22640                 BRANCH IF NO ERROR     @ZA02193 66515737
*                                                                       66520737
         CLI   K3(RF),K8                TASK ALREADY ENQD      @ZA00118 66525737
         BE    OIN22640                 BRANCH TO CONTINUE     @ZA02193 66530737
*                                                                       66531737
OIN22630 EQU   *                        ISSUE 913 ABEND        @ZA00118 66532737
*                                                                       66533737
OABD140  EQU   140                      PD INTERNAL ABEND CODE @ZA00118 66534737
         LA    R0,OABD140               913 ABEND INDICATOR    @ZA00118 66535737
         ST    R0,DXREG0                SAVE ERROR CODE        @ZA00118 66540737
         B     OIN20400                 BRANCH, PROCESS ERROR  @ZA00118 66545737
         EJECT                                                          66547737
*                                                                       66549737
OIN22640 EQU   *                        UPDATE JFCB WITH DSN   @ZA02193 66551737
*                                                                       66553737
*        SAVE FIRST 100 BYTES PASSED DSNAME                    @ZA02193 66554137
         MVC   FORCORE(INFMJFCB-FORCORE),INFMJFCB+L'JFCBDSNM 1 @ZA02193 66555737
*        SAVE LAST 32 BYTES IN CCWS 1-4                        @ZA02193 66559737
         MVC   DXCCW1(K32),INFMJFCB+L'JFCBDSNM+INFMJFCB-FORCORE         66561737
*                                                                       66563737
*        MOVE SYSTEM JFCB TO WORK AREA                         @ZA02193 66565737
         MVC   INFMJFCB+L'JFCBDSNM(JFCBLGTH-L'JFCBDSNM),L'JFCBDSNM(RC)  66567737
*                                                                       66569737
*        UPDATE SYSTEM JFCB WITH NEW DATA SET NAME             @ZA02193 66571737
         LA    R1,TIOEJFCB              POINT TO SYS JFCB      @ZA02193 66573737
         LA    R0,INFMJFCB              POINT TO NEW JFCB      @ZA02193 66575737
         IECRES WRJFCB,(R1),(R0)        UPDATE DSNAME          @ZA02193 66577737
*                                                                       66579737
*        RESTORE JFCB                                          @ZA02193 66581737
         MVC   INFMJFCB+L'JFCBDSNM(INFMJFCB-FORCORE),FORCORE 1 @ZA02193 66583737
         MVC   INFMJFCB+L'JFCBDSNM+INFMJFCB-FORCORE(K32),DXCCW1 2       66585737
         XC    FORCORE(INFMJFCB-FORCORE),FORCORE CLEAR 1       @ZA02193 66587737
         XC    DXCCW1(K32),DXCCW1       CLEAR 2                @ZA02193 66589737
         B     OIN22700                 CONTINUE OPEN          @ZA02193 66591737
         EJECT                                                          66603802
*                                                                       66605837
OIN22650 EQU   *                        DYNAMIC ALLOCATION     @ZA02193 66607237
*                                                                       66607637
*********************************************************************** 66608037
*                                                                       66608437
*        DYNAMICALLY ALLOCATE                                           66608537
*                                                                       66609037
* //SYSDDN DD DSN=JFCBDSNM,DISP=OLD/SHR,UNIT=UCBNAME,VOL=SER=UCBVOLI    66609437
*                                                                       66609637
*********************************************************************** 66609737
*                                                                       66611737
         L     RF,WTGPREFX              POINT TO SAVE AREA     @ZA02193 66612137
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS          @ZA02193 66612537
         TESTAUTH FCTN=1,KEY=YES,BRANCH=YES AUTHORIZED CALLER  @ZA02193 66612937
         LTR   RF,RF                    TEST FOR AUTHORZTN     @ZA02193 66613337
         L     RF,WTGPREFX              LOAD SAVE AREA POINTER @ZA02193 66613437
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       @ZA02193 66613537
         BZ    OIN22700                 BYPASS ALLOC           @ZA02193 66613637
*                                                                       66614337
*        SET UP PARMLIST FOR SVC 99 DYNAMIC ALLOCATION                  66614737
*                                                                       66614837
         XC    DXXCTL(OPNJDLEN),DXXCTL  CLEAR PARM LIST        @ZA02193 66614937
         XC    FORCORE(JFCBDSNM-FORCORE),FORCORE CLEAR TEXT    @ZA02193 66615037
         LA    R1,DXXCTL                PARM LIST              @ZA02193 66615137
         USING OPNJDYNA,R1              R1 PTR TO PARM WORD    @ZA02193 66615237
         LA    RF,PARMS                 POINT TO PARM LIST     @ZA02193 66615337
         ST    RF,DAPTR                 R1 -> DAPTR -> PARMS   @ZA02193 66615437
         OI    DAPTR,LASTNTRY           SET LAST IN LIST       @ZA02193 66615837
         MVC   PARMS(L'DYNPRM1),DYNPRM1 SET UP LIST            @ZA02193 66617437
         LA    RF,FORCORE               POINT TO TEXT UNITS    @ZA02193 66617837
         ST    RF,TXTPP                 TXTPP -> TEXT UNITS    @ZA02193 66618237
         MVI   FLAGS21,DYNEQU           SET FLAGS              @ZA02193 66618637
*                                                                       66618737
         LA    R1,FORCORE               POINT TO TEXT UNITS    @ZA02193 66619437
         USING TEXTUNIT,R1              TEXT UNIT POINTER      @ZA02193 66619537
         LA    RF,UNIT1                 POINT TO DDNAME UNIT   @ZA02193 66619637
         ST    RF,TEXTU1                UNIT 1 POINTER         @ZA02193 66619737
         LA    RF,UNIT2                 POINT TO FREE=CLOSE    @ZA02193 66619837
         ST    RF,TEXTU2                UNIT 2 POINTER         @ZA02193 66619937
         LA    RF,UNIT3                 POINT TO DISP UNIT     @ZA02193 66620037
         ST    RF,TEXTU3                UNIT 3 POINTER         @ZA02193 66620437
         LA    RF,UNIT4                 POINT TO VOL=SER UNIT  @ZA02193 66620537
         ST    RF,TEXTU4                UNIT 4 POINTER         @ZA02193 66620637
         LA    RF,UNIT5                 POINT TO UNIT= UNIT    @ZA02193 66620837
         ST    RF,TEXTU5                UNIT 5 POINTER         @ZA02193 66620937
         LA    RF,UNIT6                 POINT TO DSNAME UNIT   @ZA02193 66621037
         ST    RF,TEXTU6                UNIT 6 POINTER         @ZA02193 66621137
         OI    TEXTU6,LASTNTRY          IND LAST IN LIST       @ZA02193 66623137
*                                                                       66623537
*        SET UP TEXT UNITS                                              66623937
*                                                                       66624337
         MVC   UNIT1(L'DYNU1),DYNU1     DDNAME RETURN PARMS    @ZA02193 66624737
         MVC   UNIT2(L'DYNU2),DYNU2     FREE=CLOSE PARMS       @ZA02193 66624837
         MVC   UNIT3(L'DYNU3),DYNU3     DISP= PARMS            @ZA02193 66624937
         MVC   UNIT4(L'DYNU4),DYNU4     VOL=SER PARMS          @ZA02193 66625037
         MVC   UNIT5(L'DYNU5),DYNU5     UNIT= PARMS            @ZA02193 66625737
         MVC   UNIT6(L'DYNU6),DYNU6     DSNAME PARMS           @ZA02193 66626137
*                                                                       66626237
         MVI   U3PRM,U3SHR              SET TO DISP=SHR        @ZA02193 66626337
         TM    JFCBIND2,JFCSHARE        TEST FOR DISP=SHR      @ZA02193 66626537
         BO    OIN22665                 BRANCH IF DISP=SHR     @ZA02193 66626637
         MVI   U3PRM,U3OLD              SET TO DISP=OLD        @ZA02193 66626737
*                                                                       66626837
OIN22665 EQU   *                        SET UP VOL=SER         @ZA02193 66628837
*                                                                       66629237
         L     RF,DXUCBADR              LOAD UCB ADDRESS       @ZA02193 66629337
         MVC   U4PRM(L'UCBVOLI),UCBVOLI-UCBOB(RF) VOL=UCBVOLI  @ZA02193 66629637
         MVC   U5PRM(L'UCBNAME),UCBNAME-UCBOB(RF) UNIT=UCBNAME @ZA02193 66630037
*                                                                       66630437
*        GET NUMBER OF NON-BLANK CHARACTERS IN DATASET NAME             66630537
*                                                                       66630637
         LA    RB,JFCBDSNM+L'JFCBDSNM-K1 LAST BYTE OF DSNAME   @ZA02193 66630737
OIN22655 EQU   *                        SEARCH FOR NON-BLANK   @ZA02193 66631437
         CLI   K0(RB),C' '              IS THIS ONE BLANK      @ZA02193 66631837
         BNE   OIN22657                 BR IF NO TO COMPUTE    @ZA02193 66631937
*                                       LENGTH OF NAME         @ZA02193 66632037
         BCT   RB,OIN22655              TRY NEXT BYTE          @ZA02193 66632237
OIN22657 EQU   *                        CALCULATE LENGTH       @ZA02193 66632337
         LA    RC,JFCBDSNM-K1           BYTE PRECEDING DSNAME  @ZA02193 66632437
         SR    RB,RC                    RB HAS LENGTH FOR ENQ  @ZA02193 66632537
         STH   RB,U6LEN                 STORE DSNAME LENGTH    @ZA02193 66634937
*                                                                       66635037
         DROP  R1                                                       66635237
         LA    R1,DXXCTL                DYN ALLOC PRM LIST     @ZA02193 66636837
         DYNALLOC                       CALL DYNAMIC ALLOC     @ZA02193 66637037
         LTR   RF,RF                    TEST IF SUCCESS ALLOC  @ZA02193 66637237
         BNZ   OIN22695                 BRANCH IF NOT          @ZA02193 66637437
*                                                                       66637637
*        FIND ALLOCATED ENTRY                                           66637837
*                                                                       66638037
         LA    R1,FORCORE               POINT TO TEXT UNITS    @ZA02193 66638237
         USING TEXTUNIT,R1              TEXT UNITS             @ZA02193 66638437
         OC    U1PRM(L'TIOEDDNM),BLANKS FOLD ZEROS             @ZA02193 66638637
         L     RF,DXDSABQD              LOAD QDB ADDR          @ZA02193 66638837
         L     RF,QDBFELMP-QDB(,RF)     FIRST DSAB             @ZA02193 66639037
OIN22670 EQU   *                        FIND TIOT ENTRY        @ZA02193 66639237
         LTR   RF,RF                    TEST FOR LAST          @ZA02193 66639437
         BZ    OIN22695                 BRANCH IF NOT FOUND    @ZA02193 66639637
         L     RB,DSABTIOT-DSAB(,RF)    POINT AT TIOENTRY      @ZA02193 66639837
         CLC   TIOEDDNM-TIOENTRY(L'TIOEDDNM,RB),U1PRM DDNAMES  @ZA02193 66640037
         BE    OIN22675                 BRANCH IF FOUND        @ZA02193 66640237
         L     RF,DSABFCHN-DSAB(,RF)    LOAD NEXT DSAB         @ZA02193 66640637
         B     OIN22670                 LOOP TO CHECK NEXT     @ZA02193 66641037
*                                                                       66641437
OIN22675 EQU   *                        FOUND TIOENTRY         @ZA02193 66641837
*                                                                       66641937
         ST    RF,DXDSAB                SAVE DSAB PTR          @ZA02193 66642037
         XC    DXXCTL(OPNJDLEN),DXXCTL  CLEAR PARM LIST        @ZA02193 66642137
         XC    FORCORE(JFCBDSNM-FORCORE),FORCORE CLEAR TEXT    @ZA02193 66642237
         DROP  R1                                                       66642337
         B     OIN22701                 CONTINUE OPEN          @ZA15088 66645437
*                                                                       66645637
OIN22695 EQU   *                        ISSUE 913 ABEND        @ZA02193 66645837
*                                                                       66646037
         LA    R0,OABD140               913 ABEND INDICATOR    @ZA02193 66646237
         ST    R0,DXREG0                SAVE ERROR CODE        @ZA02193 66646437
         B     OIN20400                 BRANCH, PROCESS ERROR  @ZA02193 66646637
         EJECT                                                          66646837
OIN22700 EQU   *                        PASSWORD/DISP=NEW        Y02082 66647037
*****************************************************************Y02082 66648537
*                                                                Y02082 66650002
* THE FOLLOWING CODE TO LABEL ENDPSWD WAS INSERTED               Y02082 66700002
* TO SUPPORT THE OPENJ/PASSWORD BYPASS PROBLEM                   Y02082 66750002
*                                                                Y02082 66760002
*****************************************************************Y02082 66762002
         SR    R5,R5                    ZERO REGISTER            YM5358 66770002
         ICM   R5,B'0111',TIOEJFCB      GET SYSTEM JFCB ADDR     YM5358 66770402
         BZ    OIN22780                 IF ZERO,BYPASS JFCB PROC Y02082 66770502
*        LOCATE ACTUAL SYSTEM JFCB ADDRESS                       Y02082 66770602
         LA    R1,TIOEJFCB              POINT TO JFCB ADDR       Y02082 66770702
         IECRES LOCJFCB,(R1)                                     Y02082 66770802
         LR    R5,R1                    SAVE SYS JFCB ADDR       YM5358 66798002
         MVC   JFCBEXAD(L'JFCBEXAD),JFCBEXAD-DXJBF(R5) ENSURE    YM5358X66798102
                                        SYSTEM JFCB EXT USED     Y02082 66798202
*                                                                Y02134 66798602
*****************************************************************Y02134 66798702
*                                                                Y02134 66798802
*        VERIFY VOLUME SERIAL NUMBERS                            YM1363 66799002
*                                                                Y02134 66799702
*****************************************************************Y02134 66799902
*                                                                Y02134 66800102
OIN22701 EQU   *                                               @ZA15088 66800337
*                                                              @ZA15088 66800437
         L     RUCB,TIOESTTB            GET UCB ADDR           @ZA09633 66800537
         LA    RUCB,K0(,RUCB)           CLEAR HIGH ORDER BYTE  @ZA09633 66800637
         TM    UCBTBYT3-UCBOB(RUCB),UCB3DACC  CHK FOR DA       @ZA09633 66800737
         BO    OIN22710                 BR IF DA               @ZA09633 66800837
         CLC   JFCBVOLS,JFCBVOLS-INFMJFCB(R5) CHK VOLSERS        YM5358 66800937
         BE    OIN22710                 BRANCH IF SAME           Y02134 66801037
*                                                                Y02134 66801137
         MVI   JFCBNVOL,K0              INITIALIZE VOL COUNTER   YM1363 66801237
         LA    RB,JFCBVOLS-INFMJFCB(,R5) LOAD SYSTEM JFCB VOLS   YM5358 66801337
         LA    RC,JFCBVOLS              POINT TO FIRST VOL SER   Y02134 66801437
*                                                                Y02134 66801537
OIN22702 EQU   *                        LOOP FOR MORE VOL SERS   Y02134 66801637
*                                                                Y02134 66801702
         LA    RF,JFCBVOLS+L'UCBVOLI*K5 END OF VOL LIST          YM1363 66801902
         CR    RC,RF                    CHECK FOR END            YM1363 66802102
         BNL   OIN22710                 BRANCH IF MORE VOLS      YM1363 66802202
         CLI   JFCBVOLS-JFCBVOLS(RC),BLANK CHECK FOR NO VOL SER  YM1363 66802302
         BE    OIN22703                 BRANCH OUT IF BLANK      YM1363 66808302
         CLI   JFCBVOLS-JFCBVOLS(RC),CHAR00 CHECK FOR NO VOL SER YM1363 66808702
         BE    OIN22703                 BRANCH OUT IF BLANK      YM1363 66809902
         CLC   JFCBVOLS-JFCBVOLS(L'UCBVOLI,RC),JFCBVOLS-JFCBVOLS(RB)    66810002
         BE    OIN22708                 BRANCH IF OK             YM1363 66810102
         CLI   JFCBVOLS-JFCBVOLS(RC),VIRTUAL VIRTUAL VOLSER      YM1363 66810302
         BNE   OIN22704                 BRANCH IF NOT VIRTUAL    YM1363 66811502
*                                                                Y02134 66815502
OIN22703 EQU   *                        SET VOL SER TO BLANKS    Y02134 66816302
*                                                                Y02134 66817102
         MVC   JFCBVOLS-JFCBVOLS(L'UCBVOLI,RC),BLANKS SCRTCH REQ YM1363 66819502
         LA    R0,L'UCBVOLI(,RC)        POINT TO NEXT            YM1363 66820302
         CR    R0,RF                    CHECK FOR END            YM1363 66821102
         BE    OIN22710                 BRANCH OUT IF AT END     YM1363 66821602
         MVI   L'UCBVOLI(RC),BLANK      SET ALL VOLS TO SCRTCH   YM1363 66821702
         B     OIN22709                 PROCESS FURTHER          YM1373 66821902
*                                                                Y02134 66822702
OIN22704 EQU   *                        ENQ VOL SER              Y02134 66823502
*                                                                Y02134 66824302
         MVC   DXWORK1(K16),ENQLIST     INIT ENQ LIST            Y02134 66825102
         L     RF,DXJSCBAD              LOAD JSCB ADDRESS        Y02134 66825902
         L     R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER    Y02134 66826702
         ENQ   (,(RC)),TCB=(0),RET=USE,MF=(E,DXWORK2),           Y02134X66827502
               RELATED=(SYSZVOLS,IFG0194A(VUS02450))             Y02134 66828302
*                                                                Y02134 66829102
         LTR   RF,RF                    VOLUME ALREADY IN USE    Y02134 66829902
         BZ    OIN22708                 BRANCH IF NO ERROR       Y02134 66830702
*                                                                Y02134 66831502
         CLI   K3(RF),K8                SEE IF TASK HAS RESOURCE Y02134 66832302
         BE    OIN22708                 BRANCH IF ALREADY HELD   Y02134 66833102
         LA    R0,K1                    413-04 ABEND             YM1363 66833902
         ST    R0,DXREG0                SAVE ERROR CODE          Y02134 66834702
         B     OIN22780                 BRANCH TO PROCESS ERROR  Y02134 66835502
*                                                                Y02134 66836302
OIN22708 EQU   *                        INCREMENT VOL COUNT      YM1363 66837102
*                                                                Y02134 66837902
         XR    RF,RF                    CLEAR FOR IC INST        YM1363 66838202
         IC    RF,JFCBNVOL              GET VOL COUNT            YM1363 66838302
         LA    RF,K1(,RF)               INCREMENT COUNT BY 1     YM1363 66838402
         STC   RF,JFCBNVOL              SAVE COUNT               YM1363 66838502
*                                                                YM1363 66838602
OIN22709 EQU   *                        LOOP IF MORE VOLS        YM1363 66838902
*                                                                YM1363 66839002
         LA    RB,L'UCBVOLI(RB)         POINT TO NEXT VOL SER    YM1363 66839202
         LA    RC,L'UCBVOLI(RC)         POINT TO NEXT VOL SER    YM1363 66839302
         B     OIN22702                 LOOP FOR MORE VOLS       YM1363 66839502
         EJECT                                                          66840302
*                                                                Y02134 66841102
OIN22710 EQU   *                        VALIDITY CHECK JFCB      Y02134 66841902
*                                                                Y02134 66842702
         L     RUCB,TIOESTTB            GET UCB ADDR             Y02082 66843502
         LA    RUCB,K0(,RUCB)           CLEAR FOR LTR            Y02082 66844302
         LTR   RUCB,RUCB                IS THERE A UCB           Y02082 66845102
         BZ    OIN22780                 BRANCH IF NO             Y02082 66845902
         TM    UCBTBYT3-UCBOB(RUCB),UCB3DACC  CHK FOR DA         Y02082 66846702
         BNO   OIN22740                 BR IF NOT, CHK FOR TAPE  Y02082 66847502
         TM    JFCBIND2,JFCNEW          CHK USER JFCB FOR NEW    Y02082 66848302
         BNO   OIN22780                 BRANCH IF NO             Y02082 66849102
*        SET JFCBPWBP BIT IF USER MODIFIED DISPOSITION,          Y02082 66849902
*        DSNAME OR VOLSERS IN JFCB                               Y02082 66859902
         TM    JFCBIND2-INFMJFCB(R5),JFCNEW SYS JFCB DISP NEW    YM5358 66869902
         BNO   OIN22720                 NO, SET JFCBPWBP BIT     Y02082 66879902
         CLC   JFCBVOLS,JFCBVOLS-INFMJFCB(R5) CHK VOLSERS        YM5358 66889902
         BNE   OIN22720                 IF NOT SAME GO SET BIT   Y02082 66891902
         CLC   JFCBDSNM,JFCBDSNM-INFMJFCB(R5) CHK DSNAME         YM5358 66893902
         BE    OIN22780                 IF EQUAL, BRANCH OUT     Y02082 66895902
OIN22720 EQU   *                        PASSWORD BYPASS INDICATORY02082 66896002
         OI    JFCBFLG1,JFCBPWBP        INDICATE JFCB MODIFD     Y02082 66898302
         B     OIN22780                 BR TO RESUME PROC        Y02082 66898402
*                                                                Y02082 66898702
*        ROUTINE TO DO BLP CHECKING                              Y02082 66899102
*                                                                Y02082 66899502
OIN22740 EQU   *                        AUTHORIZE USE OF BLP     Y02082 66899602
         TM    UCBTBYT3-UCBOB(RUCB),UCB3TAPE CHK FOR MAG TAPE    Y02082 66908302
         BNO   OIN22780                 BR IF NOT                Y02082 66910302
         TM    JFCBLTYP,JFCBLP          BLP SPEC IN USER JFCB    Y02082 66917102
         BZ    OIN22780                 NO, BYPASS BLP CHECK     Y02082 66925802
OIN22760 EQU   *                        CHECK IF BLP SPECIFIED   Y02082 66934502
         TM    JFCBLTYP-INFMJFCB(R5),JFCBLP BLP SPEC SYS JFCB    YM5358 66943202
         BO    OIN22780                 YES, BYPASS TESTAUTH     Y02082 66943302
         L     RF,WTGPREFX              GET PREFIX ADDR          Y02082 66963202
         LA    RF,IECREGSV-IECPREFX(RF) GET REG SAVE ADDR        Y02082 66965202
         LR    R5,RF                    SAVE REGSAVE PTR         YM5358 66965602
         STM   RET,R3,K0(RF)            SAVE REGS                Y02082 66966002
*                                                                Y02082 66966402
         TESTAUTH FCTN=1,KEY=YES                                 Y02082 66966502
*                                                                Y02082 66977602
         LTR   RF,RF                    AUTHORIZED TASK          Y02082 66987602
         LM    RET,R3,K0(R5)            RESTORE REGISTERS        YM5358 66987702
         BZ    OIN22780                 YES, DO NOT ABEND        Y02082 66988002
OIN7700A EQU   139                      INTERNAL ABEND CODE      Y02082 66988102
         LA    R0,OIN7700A              IND 913 ABEND            Y02082 66988502
         ST    R0,DXREG0                193A WILL DO DMABCOND    Y02082 66988602
*                                                                Y02082 66988802
OIN22780 EQU   *                        CONTINUE PROCESSING             66988902
*                                                                       66996302
         ST    RTIOT,DXREG9             SAVE RTIOT ACROSS XCTL   A39979 67200021
         B     OIN20400                 BR TO PROCESS NEXT DCB          67400021
*                                                                       67600021
*********************************************************************** 67800021
*                                                                       68000021
OIN23000 EQU   *                        EXIT IF ALL DCBS IN ERROR       68200002
*  IF NO DCB CAN BE OPENED, FREEMAIN WHERE-TO-GO TABLE                  68250021
*  AND EXIT TO CALLER OF OPEN                                           68300021
*                                                                       68350021
         LTR   RD,RD                    CHECK THE GO SWITCH             68400021
         BNZ   OIN23200                 BR IF ON                        68600021
*                                                                       68813300
*                                                                       68880021
         IECRES FREE,PREFIX=WTG,A=(RWTG) FREMAIN WTG TABLE       Y02080 68910002
*                                                                       68920021
         LA    RF,K4                    SET OPEN RETURN CODE TO 4       69000021
*                                                                       69200021
*        RETURN TO CALLER                                        Y02080 69300002
*                                                                Y02080 69350002
         IECRES EXIT                    RETURN                   Y02080 69400002
*                                                                Y02080 69550002
*                                                                       69600021
*********************************************************************** 69800021
*                                                                       70000021
*  INITIALIZE WHERE-TO-GO TABLE BASE FOR XCTL                           70200021
*                                                                       71200021
OIN23200 EQU   *                        GO TO SECOND LOAD        A39979 72200002
         MVC   WTGMODNM,OIN2710A        SET MODULE NAME TO 193A  Y02080 75400002
*                                                                       76000021
*  XCTL TO SECOND LOAD OF OPEN                                          76200021
*                                                                       76400021
         L     RC,WTGPREFX              GET PTR TO WTG PREFIX    Y02144 76610002
         L     RC,IECRRPRM-IECPREFX(,RC) GET RRPLIST ADDRESS     Y02144 76620002
         OI    RRFLAGS2-RRPLIST(RC),RRFFIN1 1ST LOAD COMPLETED   Y02144 76650002
         LR    RCORE,RD                 GET LAST VALID WORK AREA Y02134 76750002
         LM    RTIOT,RET,DXREG9         GET REGS THIS DCB        Y02134 76760002
         LM    R0,R1,DXREG0             FOR QUEUED PROCESSING    Y02134 76770002
         L     R5,CVTPTR                PTR CVT                  Y02134 76780002
         L     R5,CVTDMSR-CVT(,R5)      ADDRESS OF RESIDENT RTN  Y02134 76790002
         IECRES XCTL                    BR QUEUED TO NEXT MOD    Y02134 76792002
*                                                                       77200021
         DROP  RWTG                                                     77400021
*                                                                       77600021
OIN23250 EQU   *                        SYSZTIOT ENQ ERROR       YM2869 77600502
         DMABCOND PCK,CALLER-HOLDS-TIOT-RESOURCE-EXCLUSIVELY     YM2869 77601002
         EJECT                                                          77603037
*********************************************************************** 77800021
*                                                                       78000021
*        CONSTANTS                                                      78200021
*                                                                       78400021
OIN2710A DC    CL8'IFG0190 '            LOWEST OPEN NAME         Y02134 78410002
OIN2500K WTO   'IEC130I DDNAMEXX DD STATEMENT MISSING',MF=L,           X78600021
               DESC=6,                  JOB STATUS                     X78800021
               ROUTCDE=(11)             PROGRAMMER INFORMATION          79000021
OIN2500L EQU   *-OIN2500K               LENGTH OF ERROR MESSAGE         79200021
VTOCNAME DC    44X'04'                  FORMAT 4 DSCB KEY        YM6549 79210002
*                                                                       79400021
OIN2500M WTO   'IEC132I DDNAMEXX, MACRF=E SPECIFIED FOR A SYSIN OR SYSOX79402002
               UT DATA SET',MF=L,                                YM3073X79404002
               DESC=6,                  JOB STATUS               YM3073X79406002
               ROUTCDE=(11)             PROGRAMMER INFORMATION   YM3073 79408002
OIN2500N EQU   *-OIN2500M               LENGTH OF MESSAGE        YM3073 79410002
*                                                                       81000021
         DS    0F,XL1                   PAD TO WORD BDY        @ZA00118 81005037
OIN2570K DC    AL3(1)                   ADDR IF NO DCB EXIT LIST        81200021
*                                                                       81400021
         DS    0F                       ALIGN BDY FOR ENQ      @ZA00118 81405037
ENQLIST  DC    0XL16'00',A(0)           ENQ LIST               @ZA00118 81450037
         ENQ   (SYSZVOLS,,E,6,SYSTEM),TCB=,RET=USE,MF=L          Y02134 81500002
SYSZVOLS DC    CL8'SYSZVOLS'            ENQ VOL SER MAJOR NAME   Y02134 81550002
SYSZOPEN DC    CL8'SYSZOPEN'            ENQ DSN MAJOR NAME     @ZA00118 81555037
BLANKS   DC    CL8' '                   BLANKS                 @ZA02193 81650037
ZEROS    DC    XL6'00'                  ZERO VOLUME SERIAL NO.   Y02134 81700002
RL       DC    X'D9D30000'              CONSTANT OF RL         @ZA08282 81700637
B0       DC    X'000000B0'              CONSTANT OF B0         @ZA08282 81701237
         EJECT                                                          81702037
*                                                                       82600021
*********************************************************************** 82602037
*                                                                       82604037
*        IEF4B4DC PARAMETERS                                            82604437
*                                                                       82604837
*********************************************************************** 82604937
*                                                                       82606637
DSRRFBIT DC    0XL2'00'                 DSRRFMAP BITS          @ZA00118 82608337
         DC    AL1(ADCHENQ)             DSRRFMAP BYTE 1        @ZA00118 82610037
         DC    AL1(SRCHDSNM+1)          DSRRFMAP BYTE 2        @ZA00118 82616037
ALFNCBIT DC    0XL8'00'                 ALFNCMAP BITS          @ZA00118 82620037
         DC    AL1(ONCNVTSW+NOCNVTSW+NOMONTSW) ALFNCMAP BYTE 1 @ZA00118 82625037
         DC    AL1(0)                   ALFNCMAP BYTE 2        @ZA00118 82630037
         DC    AL1(TIOTNQSW)            ALFNCMAP BYTE 3        @ZA09969 82635037
         DC    AL1(0)                   ALFNCMAP BYTE 4        @ZA00118 82640037
         DC    AL1(0)                   ALFNCMAP BYTE 5        @ZA00118 82645037
         DC    AL1(0)                   ALFNCMAP BYTE 6        @ZA00118 82650037
         DC    AL1(0)                   ALFNCMAP BYTE 7        @ZA00118 82655037
         DC    AL1(0)                   ALFNCMAP BYTE 8        @ZA00118 82660037
         EJECT                                                          82660137
*                                                                       82660437
*********************************************************************** 82660837
*                                                                       82661237
*        DYNAMIC ALLOCATION PARAMETERS                                  82661637
*                                                                       82661737
*********************************************************************** 82661837
*                                                                       82661937
DYNPRM1  DS    0CL3                     SVC 99 PARMS           @ZA02193 82662037
         DC    AL1(S99RBEND-S99RB)      LENGTH OF PARMS        @ZA02193 82664037
         DC    AL1(S99VRBAL)            ALLOCATE DSNAME        @ZA02193 82666037
         DC    AL1(S99NOCNV+S99NOMNT)   NEW ENTRY NO MOUNT     @ZA02193 82668037
         DS    0F                       ALIGN BOUNDRY          @ZA02193 82684037
DYNU1    DS    0CL6                     RETURN TIOT NAME       @ZA02193 82686037
         DC    AL2(DALRTDDN)            RETURN DDNAME FUNCTION @ZA02193 82688037
         DC    AL2(K1)                  1 PARM                 @ZA02193 82690037
         DC    AL2(L'TIOEDDNM)          LENGTH OF DDNAME       @ZA02193 82692037
DYNU2    DS    0CL2                     FREE=CLOSE             @ZA02193 82694037
         DC    AL2(DALCLOSE)            FREE=CLOSE FUNCTION    @ZA02193 82696037
DYNU3    DS    0CL6                     DISP=                  @ZA02193 82704037
         DC    AL2(DALSTATS)            DISP= FUNCTION         @ZA02193 82706037
         DC    AL2(K1)                  1 PARM                 @ZA02193 82708037
         DC    AL2(K1)                  LENGTH OF DISP         @ZA02193 82710037
DYNU4    DS    0CL6                     VOL=SER=               @ZA02193 82712037
         DC    AL2(DALVLSER)            VOL=SER= FUNCTION      @ZA02193 82714037
         DC    AL2(K1)                  1 PARM                 @ZA02193 82716037
         DC    AL2(L'UCBVOLI)           LENGTH OF VOLSERS      @ZA02193 82718037
DYNU5    DS    0CL6                     UNIT=                  @ZA02193 82720037
         DC    AL2(DALUNIT)             UNIT= FUNCTION         @ZA02193 82722037
         DC    AL2(K1)                  1 PARM                 @ZA02193 82724037
         DC    AL2(L'UCBNAME)           LENGTH OF CUU          @ZA02193 82726037
DYNU6    DS    0CL4                     DSNAME=                @ZA02193 82726437
         DC    AL2(DALDSNAM)            DSNAME= FUNCTION       @ZA02193 82726837
         DC    AL2(K1)                  1 PARM                 @ZA02193 82727237
         EJECT                                                          82728037
*                                                                       82800021
         XCTLTABL ID=(OPENJ,IGC0002B,OPENNEXT,3A,,IEFAB4DC),   @ZA00118X82800137
               SVC=019,BRT=YES,LENGTH=                         @ZA00118 82800237
         EJECT                                                          82805237
*                                                                       82806237
*********************************************************************** 82807237
*                                                                       82808237
*        PARMLIST FOR IEFAB4DC                                          82809237
*                                                                       82809437
*********************************************************************** 82809637
*                                                                       82809837
QSYSDSN  DSECT                          SYSDSN ENQ INTERFACE   @ZA00118 82810237
QDSRRF   DS    A                        POINTER TO DSRRFMAP    @ZA00118 82815237
QJCT     DS    A                        JSCBJCT POINTER        @ZA00118 82825237
QDSNP    DS    A                        POINTER TO DSNAME      @ZA00118 82826237
QEPADDR  DS    A                        EPA ADDRESS            @ZA00118 82830237
QTCB     DS    A                        POINTER TO DXTCBADR    @ZA00118 82835237
QSTEPNUM DS    A                        POINTER TO STEP NUMBER @ZA00118 82840237
QDSENQ   DS    A                        PTR TO DSENQ RECORD    @ZA00118 82845237
QALFNC   DS    A                        POINTER TO ALFNCMAP    @ZA00118 82855237
QRET     DS    A                        POINTER TO RET CODE    @ZA00118 82860237
QRECORD  DS    A                        PTR TO FIRST RECORD    @ZA00118 82865237
QMSGPARM DS    A                        POINTER TO TCBTIOT     @ZA00118 82875237
QENDP    EQU   *                        END OF PARM LIST       @ZA00118 82875437
QRETCODE DS    F                        RETURN CODE            @ZA00118 82876237
*                                                                       82881237
         EJECT                                                          82882237
*********************************************************************** 82886237
*                                                                       82887237
*        ALFNCMAP FROM IEFAB4DC                                         82887437
*                                                                       82887537
*********************************************************************** 82887637
*                                                                       82887737
ALFNCMAP DS    0XL8                     SEE PLS DSECT IEFAB4DC @ZA00118 82887837
INPUTSW  DS    XL6                      INPUT SWITCHES         @ZA00118 82887937
ONCNVTSW EQU   X'80'                    DON'T USE AN EXISTING           82888337
*                                       ALLOCATION THAT DOES            82888537
*                                       NOT HAVE THE CONVERTIBLE        82888937
*                                       ATTRIBUTE TO SATISFY            82889037
*                                       THE REQUEST                     82889237
NOCNVTSW EQU   X'40'                    DON'T USE AN EXISTING           82889537
*                                       ALLOCATION TO SATISFY           82889637
*                                       THE REQUEST                     82889737
NOMONTSW EQU   X'20'                    DON'T MOUNT VOLUMES OR          82889937
*                                       CONSIDER OFFLINE DEVICES        82890137
JOBRLSYS EQU   X'10'                    JOB RELATED SYSOUT              82890337
******** EQU   X'0F'                    RESERVED                        82890737
******** EQU   X'FF'                    RESERVED                        82891737
WTVOLSW  EQU   X'80'                    WAIT FOR VOLUMES                82892737
WTDSNSW  EQU   X'40'                    WAIT FOR DSNAME                 82892937
NORESSW  EQU   X'20'                    DON'T DO DSNAME RESERVATION     82893037
WTUNTSW  EQU   X'10'                    WAIT FOR UNITS                  82893137
OFFLINSW EQU   X'08'                    CONSIDER OFFLINE UNITS          82893237
TIOTNQSW EQU   X'04'                    TIOT ENQ DONE-ONLY USED         82893537
*                                       BY SVC 99 CONTROL               82893737
CATLOGSW EQU   X'02'                    SET SPECIAL CATALOG             82893837
*                                       DATA SET INDICATORS             82894037
MOUNTSW  EQU   X'01'                    ALLOW VOLUME MOUNTING           82894137
UNITDEVT EQU   X'80'                    UNIT NAME IS A DEVICE TYPE      82894437
******** EQU   X'7F'                    RESERVED                        82894637
******** EQU   X'FF'                    RESERVED                        82895137
******** EQU   X'FF'                    RESERVED                        82895637
PROCESSW DS    XL2                      INTERNAL PROCESSING SWITCHES    82895737
******** EQU   X'80'                    RESERVED                        82895937
COPYSW   EQU   X'40'                    COPY MODE DSAB AVAILABLE        82896137
ERRPROSW EQU   X'30'                    SWITCHES TO CONTROL ERROR       82896337
*                                       RECOVERY PROCESSING             82896437
DEQDSNSW EQU   X'20'                    DEQ DSNAME DSNAME ON ERROR      82896637
UNALOCSW EQU   X'10'                    UNALLOCATE ON ERROR             82896737
NQEXCLSW EQU   X'08'                    DO DSNAME ENQ FROM              82896837
*                                       SHR TO EXCLUSIVE                82897037
DCBSPCSW EQU   X'04'                    DCB PARM(S) SPECIFIED           82897137
FRRPERSW EQU   X'02'                    ESTAE PERCOLATED TO BY FRR      82897337
EPAJCTSW EQU   X'01'                    EPA FOR JCT ALREADY ON CHAIN    82897437
EPASCTSW EQU   X'80'                    EPA FOR SCT ALREADY ON CHAIN    82897637
EPALSISW EQU   X'40'                    EPA FOR LAST SIOT ALREADY       82897837
*                                       ON CHAIN                        82898037
USERERSW EQU   X'20'                    EXECUTING CODE WHICH SHOULD     82898137
*                                       ABEND ONLY IF USER ERROR        82898337
DISMSGSW EQU   X'10'                    ISSUE DISP MSGS IF ERROR        82898437
*                                       FORCES UNALLOCATION             82898637
HSKPDQSW EQU   X'08'                    IF ERROR OCCURES, DEQ DSN       82898737
*                                       WHICH WAS ENQ BY HOUSEKPG       82898937
******** EQU   X'07'                    RESERVED                        82903937
         EJECT                                                          82905337
*                                                                       82905437
*********************************************************************** 82905637
*                                                                       82905737
*        DSRRFMAP FROM IEFAB4DC                                         82905837
*                                                                       82906037
*********************************************************************** 82906137
*                                                                       82906237
DSRRFMAP DS    XL2                      SEE PLS DSECT IEFAB4DC @ZA00118 82907437
ADDRPASS EQU   X'80'                    USE PASSED ADDRESS OF ENTRY     82907737
ADCHONLY EQU   X'40'                    ADD/CHANGE ENTRY ONLY           82908237
ADCHENQ  EQU   X'20'                    ADD/CHANGE ENTRY AND ENQ        82908437
DELEONLY EQU   X'10'                    DELETE ENTRY ONLY               82908637
DELEDEQ  EQU   X'08'                    DELETE ENTRY AND DEQ            82908937
NOSHRXCL EQU   X'04'                    DON'T DO SHR TO EXCLUSIVE       82910537
*                                       CHANGE OF ENTRY NOR ENQ         82911537
ENQSHR   EQU   X'02'                    ENQ SHARE                       82911737
ENQEXCL  EQU   X'01'                    ENQ EXCLUSIVE                   82911937
ENQWAIT  EQU   X'80'                    DO UNCONDITIONAL ENQ            82912137
RETADDR  EQU   X'40'                    RETURN ADDRESS OF DSENQ         82912737
*                                       ENTRY AND DSENQ RECORD          82912937
RETINDIC EQU   X'20'                    RETURN INDICATION OF NAME       82913137
*                                       ADDED TO TABLE OR SHR TO        82913237
*                                       EXCLUSIVE CHANGE NECESSARY      82914637
READALL  EQU   X'10'                    READ AND CHAIN ALL DSENQ        82915637
*                                       RECORDS IN CORE AND RETURN      82915837
*                                       THE ADDRESS OF THE 1ST RECORD   82916037
INCORREC EQU   X'08'                    RECORDS ARE IN CORE AND         82916537
*                                       ADDRESS OF THE 1ST IS INPUT     82916737
EPAJCTEX EQU   X'04'                    AN EPA FOR THE JCT IS ALREADY   82916937
*                                       ON THE EPA CHAIN-ON ENTRY, IF   82917437
*                                       THIS BIT IS OFF ON ENTRY AND    82917637
*                                       THE JCT IS UPDATED, THIS BIT    82917837
*                                       IS SET ON ON EXIT.              82919037
SRCHDSNM EQU   X'02'                    SEARCH DSENQ TABLE FOR DSNAME   82920037
******** EQU   X'01'                    DON'T RETURN EPA                82920237
         EJECT                                                          82920537
*                                                                       82920637
*********************************************************************** 82920837
*                                                                       82921037
*        DSNAME PARAMETER FOR IEFAB4DC                                  82921437
*                                                                       82921637
*********************************************************************** 82921837
*                                                                       82922237
DSNLEN   DS    H                        LENGTH OF DSNAME                82922537
DSNAME   DS    CL44                     DATA SET NAME FOR ENQ           82922637
SAVEAREA DS    18F                      IEFAB4DC SAVE AREA     @ZA00118 82923537
*                                                                       82923737
*********************************************************************** 82923837
*                                                                       82923937
*               PARAMETER FOR Q MANAGER TO LOCATE JCT                   82924037
*                                                                       82924137
*********************************************************************** 82924237
*                                                                       82924337
QMPARMS  DS    F                        QMANAGER WORK AREA     @ZA08282 82924437
RLPTR    DS    F                        PTR TO CONSTANT OF RL  @ZA08282 82924537
JCTPTR   DS    F                        PRT TO REAL JCT        @ZA08282 82924637
RLCONST  DS    F                        CONSTANT OF RL         @ZA08282 82924737
JCTADDR  DS    F                        POINTER TO JCT         @ZA08282 82924837
JCTPFIX  DS    F                        POINTER TO JCT PREFIX  @ZA08282 82924937
B0CONST  DS    F                        CONSTANT OF B0         @ZA08282 82925037
         DS    0D                       END OF PARMLIST        @ZA00118 82925337
QLENGTH  EQU   *-QSYSDSN                LENGTH OF LIST         @ZA00118 82925437
         EJECT                                                          82926437
*                                                                       82926837
*********************************************************************** 82927237
*                                                                       82927637
*        DYNAMIC ALLOCATION MACROS AND WORKAREAS               @ZA02193 82927737
*                                                                       82927837
*********************************************************************** 82928237
*                                                                       82928637
         IEFZB4D0                       DYNAMIC ALLOC PARM LIST@ZA02193 82929037
         EJECT                                                          82929437
         IEFZB4D2                       DYNAMIC ALLOC KEYS     @ZA02193 82929837
         EJECT                                                          82930237
*                                                                       82930637
***************************************************************@ZA02193 82931037
*                                                              @ZA02193 82931437
*        DYNAMIC ALLOCATE PARMLIST FOR OPEN TYPE=J             @ZA02193 82931837
*                                                              @ZA02193 82932637
***************************************************************@ZA02193 82933037
*                                                              @ZA02193 82933437
OPNJDYNA DSECT                          ALLOCATION PARMS       @ZA02193 82933837
DAPTR    DS    A                        POINTER TO PARMS       @ZA02193 82933937
PARMS    DS    0A                       PARM LIST              @ZA02193 82934037
LENGTH   DC    AL1(S99RBEND-S99RB)      LENGTH OF LIST         @ZA02193 82934337
VERB     DC    AL1(S99VRBAL)            ALLOCATE DSNAME        @ZA02193 82934437
FLAGS1   DS    0AL2                     FLAG BYTES 1           @ZA02193 82934537
FLAGS11  DC    AL1(S99NOCNV+S99NOMNT)   NEW REQ-NO MOUNT       @ZA02193 82934837
FLAGS12  DC    AL1(0)                   RESERVED               @ZA02193 82934937
ERRCODE  DS    AL2                      ERROR RETURN CODE      @ZA02193 82935037
INFOCODE DS    AL2                      INFORMATION CODE       @ZA02193 82935337
TXTPP    DS    A                        TEXT POINTER           @ZA02193 82935437
         DS    F                        RESERVED FIELD         @ZA02193 82935537
FLAGS2   DS    0A                       FLAG BYTES 2           @ZA02193 82935637
DYNEQU1  EQU   S99WTVOL                 WAIT FOR VOLUMES       @ZA02193 82935837
DYNEQU2  EQU   S99WTDSN                 WAIT FOR DATA SETS     @ZA02193 82935937
DYNEQU3  EQU   S99WTUNT                 WAIT FOR UNITS         @ZA02193 82936037
DYNEQU4  EQU   S99OFFLN                 CONSIDER OFFLINE UNITS @ZA02193 82936137
DYNEQU5  EQU   S99TIONQ                 TIOT ENQD              @ZA02193 82936237
DYNEQU6  EQU   S99MOUNT                 MOUNTING PERMITED      @ZA02193 82936337
DYNEQU   EQU   DYNEQU3+DYNEQU4+DYNEQU5+DYNEQU6                 @ZA09969 82936537
FLAGS21  DC    AL1(DYNEQU)              ALLOCATION REQUEST     @ZA02193 82936637
FLAGS22  DS    AL1                      RESERVED               @ZA02193 82937637
FLAGS23  DS    AL1                      RESERVED               @ZA02193 82938337
FLAGS24  DS    AL1                      RESERVED               @ZA02193 82938737
OPNJDEND DS    0F                       END OF PARM LIST       @ZA02193 82938837
OPNJDLEN EQU   OPNJDEND-OPNJDYNA        LENGTH OF ALLOC PARMS  @ZA02193 82938937
*                                                                       82939037
TEXTUNIT DSECT                          TEXT UNITS             @ZA02193 82939137
TEXTU1   DC    A(UNIT1)                 PTR TEXT UNIT 1        @ZA02193 82939237
TEXTU2   DC    A(UNIT2)                 PTR TEXT UNIT 2        @ZA02193 82939337
TEXTU3   DC    A(UNIT3)                 PTR TEXT UNIT 3        @ZA02193 82939437
TEXTU4   DC    A(UNIT4)                 PTR TEXT UNIT 4        @ZA02193 82939537
TEXTU5   DC    A(UNIT5)                 PTR TEXT UNIT 5        @ZA02193 82939637
TEXTU6   DC    AL1(LASTNTRY),AL3(UNIT6) PTR TEXT UNIT 6        @ZA02193 82939737
UNIT1    DS    0CL14                    DDNAME RETURN UNIT     @ZA02193 82939837
U1KEY    DC    AL2(DALRTDDN)            DDNAME RETURN FUNCTION @ZA02193 82939937
U1NUM    DC    AL2(K1)                  NUMBER OF PARMS        @ZA02193 82940037
U1LEN    DC    AL2(L'TIOEDDNM)          LENGTH OF DDNAME       @ZA02193 82940137
U1PRM    DS    CL8                      PARM                   @ZA02193 82940237
UNIT2    DS    0CL4                     FREE=CLOSE UNIT        @ZA02193 82940337
U2KEY    DC    AL2(DALCLOSE)            FREE=CLOSE FUNCTION    @ZA02193 82940437
U2NUM    DC    AL2(K0)                  NUMBER OF PARMS        @ZA02193 82940537
UNIT3    DS    0CL8                     DISPOSITION UNIT       @ZA02193 82941237
U3KEY    DC    AL2(DALSTATS)            DISP FUNCTION          @ZA02193 82941337
U3NUM    DC    AL2(K1)                  NUMBER OF PARMS        @ZA02193 82941437
U3LEN    DC    AL2(K1)                  LENGTH OF PARM         @ZA02193 82941537
U3PRM    DC    X'00'                    DISP=SHR-08 DISP=OLD-01@ZA02193 82941637
U3SHR    EQU   X'08'                    DISP=SHR FLAG          @ZA02193 82941837
U3OLD    EQU   X'01'                    DISP=OLD FLAG          @ZA02193 82941937
         DS    X                        FILL                   @ZA02193 82942037
UNIT4    DS    0CL12                    VOL SER UNIT           @ZA02193 82942137
U4KEY    DC    AL2(DALVLSER)            VOL=SER FUNCTION       @ZA02193 82942237
U4NUM    DC    AL2(K1)                  1 VOL SER              @ZA02193 82942337
U4LEN    DC    AL2(L'UCBVOLI)           VOL SER LEN            @ZA02193 82942437
U4PRM    DS    CL6                      VOL=SER=PARM           @ZA02193 82942537
UNIT5    DS    0CL10                    UNIT= UNIT             @ZA02193 82942737
U5KEY    DC    AL2(DALUNIT)             UNIT= FUNCTION         @ZA02193 82943137
U5NUM    DC    AL2(K1)                  1 UNIT                 @ZA02193 82943637
U5LEN    DC    AL2(L'UCBNAME)           LENGTH OF UNIT PARM    @ZA02193 82944037
U5PRM    DS    CL3                      PARM                   @ZA02193 82944437
         DS    X                        FILL                   @ZA02193 82944837
         ORG   TEXTUNIT+100-6           ORG IN FRONT OF DSNAME @ZA02193 82945037
UNIT6    DS    0CL50                    DSNAME UNIT            @ZA02193 82945237
U6KEY    DC    AL2(DALDSNAM)            DSNAME FUNCTION        @ZA02193 82945437
U6NUM    DC    AL2(K1)                  NUMBER OF PARMS        @ZA02193 82945537
U6LEN    DC    AL2(L'JFCBDSNM)          LENGTH OF DSNAME       @ZA02193 82945637
U6PRM    DS    CL44                     JFCBDSNM FIELD         @ZA02193 82945737
         EJECT                                                          82946137
         IECDSECS PSA,                                         @ZA00118X82946237
               CVT,                                            @ZA00118X82946337
               TCB,                                            @ZA00118X82946437
               JSCB,                                           @ZA00118X82946937
               RB,                                             @ZA00118X82947437
               QDB,                                            @ZA02193X82947837
               DSAB,                                           @ZA00118X82947937
               TIOT,                                           @ZA00118X82948437
               UCB,                                            @ZA00118X82948937
               IEZDEB,                                         @ZA00118X82953937
               DCB,                                            @ZA00118X82958937
               ACB,                                            @ZA00118X82963937
               WTG,                                            @ZA00118X82968937
               MAIN,                                           @ZA00118X82973937
               PREFX,                                          @ZA00118X82978937
               RRPL,                                           @ZA00118X82983937
               EXPAND=YES               EXPAND DESIRED DSECTS  @ZA00118 82988937
ACBMJEP  EQU  X'40'                     ACB CREATED BY JEPS    @ZA00118 82993937
TIOTSPOL EQU   X'06'                    SPOOL DATA SET INDICTR @ZA00118 82998937
         IECEQU AOS=YES,IEZDEB=YES                             @ZA00118 83003937
         END                                                            83800021
./  ADD  SSI=81150198,NAME=IGC0002C
         TITLE 'IGC0002C - TCLOSE INITIAL FUNCTION'                     00100037
IGC0002C CSECT                                                          00400021
*                                                                       00500021
*********************************************************************** 00600021
*                                                                     * 00700021
*           VS2-037 ADD/DE/CH                                           00750037
*A519020-519041,A549500-550000                                 @ZA29752 00756037
*                                                                     * 00770000
*          VS1 RELEASE 02 DELETIONS                                   * 00772002
*0000199432,530940,530960,530999,531000,531532,531666            XM1037 00772402
*0000199200-199300,563920                                        X02989 00774002
*0000                                                            XM0630 00776002
*          VS2 RELEASE 01 DELETIONS                                   * 00780000
*0000182719                                                      YM0897 00790000
*0000                                                            YM0955 00790100
*0000                                                            YM8269 00790200
*0000                                                            YM0898 00790300
*0000                                                            YM0850 00790400
*0000                                                            YM2069 00790800
*0000                                                            YM0992 00791200
*                                                                     * 00792000
*          VS2 RELEASE 02 DELETIONS/CHANGES                           * 00800002
*0000180000-184500,195429,205000,208000-225000,261667-261700,    YM1272 00801002
*0000338504-338940,517904,526000-540000,553000-555000            YM1272 00802002
*0000426000-450000                                               YM1493 00803002
*0000198850                                                      YM3011 00804002
*0000433500                                                      YM5310 00805002
*0000420500-420900,424500                                       ZA01326 00855002
*          VS2 RELEASE 03 DELETIONS/CHANGES                           * 00905002
*0000435500-436000                                             @ZA02878 00955037
*          VS2 RELEASE 04 DELETIONS/CHANGES                           * 01005037
*0000457000-458000,517500-517920                               @ZA04905 01055037
*          RELEASE 21.7 DELETIONS/CHANGES                             * 01200002
*          RELEASE 21 DELETIONS/CHANGES                               * 01300021
*                                                                S21042 01400021
*                                                                M0039  01450021
*D076000-077000,079000-080000,211000-212000,218000              SA53260 01460021
*0000120000-123000,176000-179000,480000-488000,503000-504000,   SA53293 01470002
*0000514000-517000,563000                                       SA53293 01480002
*0000395000-399000,551000-552000                                 S21940 01490002
*                                                                     * 01500021
* MODULE NAME - IGC0002C                                              * 01510002
*                                                                     * 01520002
* DESCRIPTIVE NAME - TCLOSE INITIAL FUNCTION                          * 01530002
*                                                                     * 01540002
* COPYRIGHT - NONE                                                    * 01550002
*                                                                     * 01560002
* CHANGE ACTIVITY - SEE DELETIONS/CHANGES FOLLOWING THE CSECT CARD    * 01570002
*                                                                     * 01580002
* STATUS CHANGE LEVEL 000                                             * 01600021
*                                                                     * 01700021
* FUNCTION -                                                          * 01800021
*    THIS MODULE CONTAINS THE 'TCLOSE INITIAL FUNCTION'.              * 01900021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG' FOR DETAILS.            * 02000021
*                                                                     * 02100021
* ENTRY POINTS -                                                      * 02200021
*         IGC0002C - ENTERED BY THE SUPERVISOR FROM THE SECOND-LEVEL  * 02300021
*                    INTERRUPT HANDLER (SLIH) WHEN SVC 23 (CLOSE,     * 02400021
*                    TYPE=T) IS ISSUED.                               * 02500021
*                                                                     * 02600021
* INPUT -                                                             * 02700021
*    ENTERED IN SUPERVISOR KEY ZERO                              Y02082 02750002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG'.                        * 02800021
*                                                                     * 02900021
* OUTPUT -                                                            * 03000021
*    EXIT IN DATA MANAGEMENT KEY                                 Y02082 03050002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG'.                        * 03100021
*                                                                     * 03200021
* EXTERNAL REFERENCES -                                               * 03300021
*         IECPCNVT - CONVERTS A RELATIVE TRACK ADDRESS 'TTRN' TO AN   * 03400021
*            ABSOLUTE TRACK ADDRESS 'MBBCCHHR' UTILIZING THE          * 03500021
*            FOLLOWING REGISTER CONVENTUONS -                         * 03600021
*            REG    CONTENTS AT ENTRY      CONTENTS AT EXIT           * 03700021
*             0     TTRN TO BE CONVERTED   DESTROYED                  * 03800021
*             1     DEB ADDRESS            TRANSPARENT                * 03900021
*             2     ADDR OF 8-BYTE AREA    RESULTANT MBBCCHHR         * 04000021
*                   FOR MBBCCHHR                                      * 04100021
*            3-8    IGNORED                TRANSPARENT                * 04200021
*            9-13   IGNORED                DESTROYED                  * 04300021
*             14    RETURN ADDRESS         TRANSPARENT                * 04400021
*             15    ENTRY POINT ADDRESS    ERROR CODE                 * 04500021
*         THE ERROR CODE WILL BE '0' IF THE CONVERSION IS SUCCESSFUL  * 04600021
*         AND '1' IF THE 'TT' EXCEEDS THE TOTAL EXTENTS ASSIGNED.     * 04700021
*                                                                     * 04800021
* EXITS, NORMAL -                                                     * 04900021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG'.                        * 05000021
*                                                                     * 05100021
* EXITS, ERROR -                                                      * 05200021
*         NONE                                                        * 05300002
*                                                                     * 05500021
* TABLES/WORK AREAS -                                                 * 05600021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG'.                        * 05700021
*                                                                     * 05800021
* ATTRIBUTES -                                                        * 05900021
*    REENTRANT, REFRESHABLE, READ-ONLY, ENABLED, PRIVILEGED           * 06000021
*                                                                     * 06100021
* CHARACTER CODE DEPENDENCY -                                         * 06200021
*    CLASS ONE CHARACTER CODE DEPENDENCY - THE EBCDIC CHARACTER CODE  * 06300021
*    WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED IF A      * 06400021
*    DIFFERENT CHARACTER SET IS USED FOR EXECUTION.                   * 06500021
*                                                                     * 06600021
* NOTES -                                                             * 06700021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG'.                        * 06800021
*                                                                     * 06900021
*********************************************************************** 07000021
*                                                                       07100021
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        07200021
         USING *,RBASE                                                  07300021
         USING FORCORE,RCORE                                            07400021
         USING IHADCB,RDCB                                              07500021
         USING WTG,RWTG                                                 07800021
         USING TIOT,RTIOT                                               08100021
         USING UCB,RUCB                 UCB ADDRESSABILITY       YM1272 08120002
         USING CVT,RET                                                  08150000
         USING TCB,RD                                                   08160000
         USING DEBBASIC,RDEB                                     Y02134 08162002
         EJECT                                                          08200021
*********************************************************************** 08300021
*                                                                     * 08400021
*                          FUNCTION PROLOG                            * 08500021
*                                                                     * 08600021
*********************************************************************** 08700021
*                                                                     * 08800021
* FUNCTION NAME -                                                     * 08900021
*    'TCLOSE INITIAL FUNCTION'                                        * 09000021
*                                                                     * 09100021
* (STATUS) -                                                          * 09200021
*    NOT APPLICABLE                                                   * 09300021
*                                                                     * 09400021
* FUNCTION -                                                          * 11550000
*     1) VERIFIES THAT THE DCB(S) IS TO BE PROCESSED;                 * 11560000
*     2) OBTAINS MAIN STORAGE FOR THE 'WHERE-TO-GO' (WTG) TABLE;      * 11570000
*        THE IECRES MACRO IS USED, WHICH ALSO ENQS THE TIOT;     Y02134 11572002
*     3) OBTAINS MAIN STORAGE FOR A WORK AREA FOR EACH DCB TO BE      * 11580000
*        PROCESSED;                                                   * 11590000
*     4) INITIALIZES EACH WORK AREA WITH I/O CONTROL BLOCKS AND       * 11600002
*        CHANNEL PROGRAMS;                                            * 11610002
*     5) VALIDITY CHECKS THE DEB USING THE DEBCHK MACRO AND      Y02082 11620002
*        POINTS THE DEB'S DCB ADDRESS TO THE PROTECTED COPY OF   Y02082 11630002
*        THE DCB EXCEPT FOR VSAM.                                Y02082 11640002
*     6) PURGES (QUIESCES) OUTSTANDING I/O REQUESTS FOR EACH DCB;     * 11650002
*     7) MOVES THE 'JOB FILE CONTROL BLOCK' (JFCB) INTO THE WORK AREA * 11660002
*        FOR EACH DCB;                                                * 11670002
*     8) MOVES THE ID/EPA OF THE NEXT REQUIRED MODULE INTO THE WTG    * 11680002
*        TABLE ENTRY FOR EACH DCB;                                    * 11690002
*     9) BRANCHES TO THE RESIDENT ROUTINE TO CONTINUE TCLOSE          * 11700002
*        PROCESSING, OR                                               * 11710002
*    10) EXITS TO THE SUPERVISOR IF THERE ARE NO VALID DCBS TO        * 11720002
*        PROCESS AFTER FREEING THE WTG TABLE USING               Y02134 11730002
*        THE IECRES MACRO WHICH DEQS THE TIOT.                   Y02134 11740002
*                                                                     * 11750002
* ENTRY POINTS -                                                      * 11760002
*    REFER TO THE PRECEDING MODULE PROLOG.                            * 11770002
*                                                                     * 11800021
* INPUT -                                                             * 11900021
*    REGISTER CONTENTS AT ENTRY ARE AS FOLLOWS-                       * 11950002
*       1 - CONTAINS THE ADDRESS OF THE TCLOSE PARAMETER LIST.        * 11960002
*           EACH ENTRY IS A FULLWORD WHICH CONTAINS THE ADDRESS OF    * 11970002
*           A DCB IN THE 3 LOW ORDER BYTES AND THE TCLOSE POSITIONING * 11980002
*           OPTION IN THE HIGH ORDER BYTE. THE POSITIONING OPTIONS    * 11990002
*           ARE AS FOLLOWS-                                           * 12030002
*              X'00' - LEAVE;                                         * 12070002
*              X'10' - REREAD;                                        * 12110002
*              X'30' - LEAVE;                                         * 12150002
*           THE LAST ENTRY IN THE PARAMETER LIST HAS THE HIGH ORDER   * 12190002
*           BIT OF ITS FIRST BYTE TURNED ON (I.E., X'80').            * 12230002
*       3 - ADDRESS OF THE CVT - INITIALIZED BY THE SLIH.             * 12270002
*       4 - ADDRESS OF THE TCB - INITIALIZED BY THE SLIH.             * 12310002
*       5 - ADDRESS OF THE TCLOSE SVRB - INITIALIZED BY THE SLIH.     * 12350002
*                                                                     * 12400021
* OUTPUT -                                                            * 12500021
*    1) REGISTER CONTENTS FOR A NORMAL EXIT ARE AS FOLLOWS -          * 12600021
*          'RES'   - ADDRESS OF THE RESIDENT ROUTINE;                 * 12700021
*          'RWTG'  - ADDRESS OF THE WTG TABLE;                        * 12800021
*       IF EXIT IS TO MODULE IFG0230P BECAUSE OF AN ERROR READING THE * 12900021
*       JFCB, THE FOLLOWING ADDITIONAL REGISTER CONTENTS APPLY -      * 13000021
*          'R0'    - TCLOSE INTERNAL ERROR CODE 121;                  * 13100021
*          'RDCB'  - ADDRESS OF THE DCB CURRENTLY BEING PROCESSED;    * 13200021
*          'RCORE' - ADDRESS OF THE CURRENT DCB'S WORK AREA;          * 13300021
*          'RWTGC' - ADDRESS OF THE CURRENT DCB'S WTG ENTRY;          * 13400021
*          'RTIOT' - ADDRESS OF THE CURRENT DCB'S CURRENT TIOT ENTRY; * 13500021
*          'RUCB'  - ADDRESS OF THE CURRENT DCB'S CURRENT UCB;        * 13600021
*          'RDEB'  - ADDRESS OF THE CURRENT DCB'S DEB.                * 13700021
*    2) INTERNAL INDICATORS -                                         * 13800021
*          'WTGPATHS' - X'20' - NSL PROCESSING IS REQUIRED;           * 13900021
*                                                                     * 14100021
* EXTERNAL REFERENCES -                                               * 14200021
*         REFER TO THE FOLLOWING 'FUNCTION PROLOG'.                   * 14300021
*                                                                     * 14400021
* EXITS, NORMAL -                                                     * 14500021
*    MODULE IFG0232D WITH 'RET' EQUAL 0 FOR DIRECT ACCESS PROCESSING; * 14600021
*    MODULE IFG0232G WITH 'RET' EQUAL 0 FOR SL TAPE OUTPUT PROCESSING;* 14700021
*    MODULE IFG0232M WITH 'RET' EQUAL 4 FOR SL TAPE INPUT PROCESSING; * 14800021
*    MODULE IFG0232S WITH 'RET' EQUAL 0 FOR NL TAPE POSITIONING;      * 14900021
*    MODULE IFG0232Y WITH 'RET' EQUAL 0 FOR NSL TAPE PROCESSING -     * 15000021
*       THIS MODULE IS AN ALIAS FOR IFG0202B, WHICH INTERFACES WITH   * 15100002
*       MODULES NSLETRLI (DEFERRED NSL PROCESSING) AND NSLCTRLO;      * 15200021
*    MODULE IFG0232Z WITH 'RET' EQUAL 4 FOR UNIT RECORD, GRAPHICS, OR * 15300021
*       COMMUNICATIONS DEVICE TYPES;                                  * 15400021
*                                                                     * 15700021
* EXITS, ERROR -                                                      * 15800021
*    REFER TO THE PRECEDING MODULE PROLOG.                            * 15900002
*                                                                     * 16000021
* TABLES/WORK AREAS -                                                 * 16100021
*    THE TCLOSE WORK AREA AND THE WHERE-TO-GO (WTG) TABLE ARE         * 16200021
*    DESCRIBED BY THE DSECTS AT THE END OF THE LISTING.               * 16300021
*                                                                     * 16400021
* ATTRIBUTES -                                                        * 16500021
*    REFER TO THE PRECEDING MODULE PROLOG.                            * 16600002
*                                                                     * 16700021
* CHARACTER CODE DEPENDENCY -                                         * 16800021
*    REFER TO THE PRECEDING MODULE PROLOG.                            * 16900002
*                                                                     * 17000021
* NOTES -                                                             * 17100021
*                                                                     * 17200021
*********************************************************************** 17300021
*                                                                       17400021
*********************************************************************** 17450002
*                                                                       17500002
*  THIS SECTION OBTAINS CORE FOR THE WHERE-TO-GO TABLE AND SAVES        17550002
*  REGISTERS 2-12 IN THE SVRB EXTENDED SAVE AREA.                       17600002
*                                                                       17650002
         USING RBBASIC,R5                                        YM1272 17700002
         IECRES GET,PREFIX=WTG,         GETMAIN FOR WTG TABLE    Y02080*17750002
               STM=(2,12,RBEXSAVE),A=(R1)                        YM1272 17800002
         DROP  R5                                                YM1272 17850002
*                                                                       17900002
         LTR   R0,R0                    CALLER ENQED EXCLUSIVELY YM3185 17910002
         BNZ   TCM15050                 BRANCH IF YES            YM3185 17930002
         LR    RWTG,R1                  LOAD WTG ADDRESS         YM1272 17950002
         L     RPAR,WTGPREFX            GET EXT PREFX ADDRSBLTY  Y02134 18000002
         L     RC,IECRRPRM-IECPREFX(,RPAR) GET RRPLIST PTR       Y02144 18050002
         MVI   RRFUNCTN-RRPLIST(RC),RRFTCLOS  INDICATE TCLOSE    Y02144 18100002
         IECRES LOAD,BRANCH=NO,MODNM=TCLOSE,PREFIX=WTGPREFX      Y02080X18150002
                                        GIVE OPT TRACE A SHOT    Y02080 18200002
         XC    WTGMODEP,WTGMODEP        CLEAR NEXT MOD ADDR      Y02080 18250002
*                                                                       18300002
         L     RPAR,IECUPRML-IECPREFX(,RPAR) PT PROT PARAM LIST  Y02134 18350002
*                                                                       18600021
*********************************************************************** 18700021
*              DETERMINE IF ENTRY IS TO BE PROCESSED                  * 18800021
*********************************************************************** 18900021
*                                                                       19000021
         LR    RPARC,RPAR               SET UP PARM PTR          YM0898 19220000
         LA    RWTGC,WTGENTRY           INIT CURRENT WTG ENTRY   Y02134 19222002
TCM00500 EQU   *                                                        19400021
         L     RD,CVTPTR                CVT ADDRESS              Y02082 19450002
         L     RD,CVTTCBP-CVT(,RD)      NEXT/CURRENT TCB ADDR    Y02082 19460002
         L     RD,K4(,RD)               CURRENT TCB              Y02082 19470002
         MODESET EXTKEY=RBT234,WORKREG=2 ASSUME USER KEY         Y02082 19480002
         L     RDCB,PLISTDCB(,RPARC)    ESTABLISH ADDRESS OF USER'S DCB 19500021
*                                                                       19500502
*        MAKE SURE THIS DCB IS NOT PREVIOUSLY DUPLICATED IN      YM2869 19501002
*        THE PARAMETER LIST                                      YM2869 19501502
*                                                                       19502002
         LA    RF,WTGENTRY              FIRST DCB'S WTG ENTRY    YM2869 19502502
         USING WTGENTRY,RF                                       YM2869 19503002
TCM00502 EQU   *                        PROCESS EACH DCB         YM2869 19503502
         CR    RF,RWTGC                 AT CURRENT YET           YM2869 19504002
         BE    TCM00506                 BR IF YES-NO DUPLICATES  YM2869 19504502
         L     RCORE,WTGCORE-K1         GET WORKAREA             YM2869 19505002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE FOR LTR  YM2869 19505502
         LTR   RCORE,RCORE              IS THERE A WORKAREA      YM2869 19506002
         BZ    TCM00504                 BR IF NO-TRY NEXT DCB    YM2869 19506502
         CLM   RDCB,B'0111',DXUDCBAD+K1 IS CURRENT DCB BEING     YM2869 19507002
*                                       PROCESSED ALREADY        YM2869 19507502
         BE    TCM03000                 BR IF YES-DON'T PROCESS  YM2869 19508002
TCM00504 EQU   *                        GET NEXT DCB'S WTG ENTRY YM2869 19508502
         LA    RF,WTGENTRY+L'WTGENTRY   INCREMENT TO NEXT WTG    YM2869 19509002
         B     TCM00502                 CHECK NEXT DCB           YM2869 19509502
         DROP  RD                                                YM2869 19510002
         DROP  RF                                                YM2869 19510102
TCM00506 EQU   *                        NO DUPLICATES            YM2869 19510502
         TM    DCBOFLGS,DCBOBUSY        IS BUSY BIT ON?          Y02134 19510902
         BO    TCM03000                 BR IF YES-DON'T PROCESS  Y02134 19511402
         L     RDEB,DCBDEBAD            GET DEB ADDRESS          Y02134 19515002
         TM    DCBOFLGS,DCBOLOCK+DCBOPEN  IS DCB OPEN & UNLOCKED Y02134 19520002
         BNO   TCM03000                 BRANCH IF NO             Y02134 19525002
         TM    DCBMACRF,DCBMEXCP        TEST IF EXCP             YM4688 19526002
         BO    TCM00510                 BRANCH IF EXCP           YM4688 19527002
         TM    DCBDSRG2,DCBACBM         TEST FOR ACB/AMB         YM4688 19528002
         BNO   TCM00510                 BRANCH IF NOT ACB/AMB    YM4688 19529002
         CLI   AMBID-IDAAMB(RDCB),AMBIDENT  TEST FOR AMB         YM4688 19530002
         BE    TCM03000                 BRANCH IF YES - DO NOT   YM4688X19531002
                                        PROCESS AN AMB           YM4688 19532002
TCM00510 EQU   *                        TEST TASK CLOSE BIT      YM2869 19532502
*                                                                       19533002
*        DON'T PROCESS IF DEB HUNG OFF ANOTHER TCB'S DEB CHAIN   YM2869 19533502
*        AND TASK CLOSE IS PROCESSING                            YM2869 19534002
*                                                                       19534502
         CLM   RD,B'0111',DEBTCBAD+K1   IS DEB ON THIS TCB       YM2869 19535002
         BE    TCM00515                 BR IF YES TO CONTINUE    YM2869 19535502
         LA    RF,DEBBASIC              CLEAR HIGH BYTE          YM2869 19536002
         LA    R0,DEBBASIC-DEBXTNP      OFFSET TO DEBX ADDR      YM2869 19536502
         SR    RF,R0                    RF POINTS TO DEBX ADDR   YM2869 19537002
         USING DEBXTNP,RF                                        YM2869 19537502
         L     RF,DEBXTNP               RF POINTS TO DEBX        YM2869 19538002
         USING DEBXTN,RF                                         YM2869 19538502
         TM    DEBXFLG1,DEBXTSK         IS TASK CLOSE PROCESSING YM2869 19539002
         BO    TCM03000                 DON'T PROCESS IF YES     YM2869 19539502
         DROP  RF                                                YM2869 19540002
DEBXTSK  EQU   X'40'                    TASK CLOSE PROCESSING    YM2869 19540502
TCM00515 EQU   *                        GET CORE FOR TCLOSE      YM2869 19541002
*                                                                       19541502
*****          GET MAIN STORAGE FOR WORKAREA FOR THIS DCB        YM2869 19542002
*                                                                       19542502
         LA    R0,CLOSSIZE              LOAD SIZE OF TCLOSE WK   Y02134 19545002
*                                                                Y02134 19550002
         TM    DEBOFLGS,DEBOFEOF+DEBOFNSL  TEST FOR NSL AND EOF  Y02134 19555002
         BNO   TCM00575                 ..BRANCH IF NOT          Y02134 19560002
         TM    DEBOPATB,DEBOPOUT        IS DCB OPENED FOR INPUT  Y02134 19565002
         BNZ   TCM00575                 ..BRANCH IF NOT          Y02134 19570002
         L     RD,DCBEXLST              LD ADDR OF DCB EXIT LIST Y02134 19575002
         LA    RD,K0(,RD)               ..CLEAR HIGH-ORDER BYTE  Y02134 19580002
         LTR   RD,RD                    IS THERE A DCB EXIT LIST Y02134 19585002
         BZ    TCM00575                 ..BR IF NOT TO GET WKA   Y02134 19590002
*                                                                Y02134 19595002
TCM00525 EQU   *                        TEST IF MORE CORE NEEDED Y02134 19600002
         CLI   K0(RD),XLDEFNSL          WAS LABEL PROC DEFERRED  Y02134 19605002
         BE    TCM00550                 ..BRANCH IF YES TO GET   Y02134 19610002
*                                       EXTRA CORE               Y02134 19615002
         CLI   K0(RD),XLDEFNSL+LASTNTRY  IS 'LAST ENTRY' BIT ON  Y02134 19620002
         BE    TCM00550                 ..YES - GET EXTRA CORE   Y02134 19625002
         TM    K0(RD),LASTNTRY          IS THIS THE LAST ENTRY   Y02134 19630002
         LA    RD,K4(,RD)               POINT TO NEXT LIST ENTRY Y02134 19635002
         BNO   TCM00525                 ..BR IF NOT TO CHK NEXT  Y02134 19640002
         B     TCM00575                 ..BR IF YES TO GET WKA   Y02134 19645002
*                                                                Y02134 19650002
TCM00550 EQU   *                        LOAD SIZE OF EOV WKAREA  Y02134 19655002
         LA    R0,EOVSIZE               LOAD SIZE OF WORK AREA   Y02134 19660002
*                                       ..DEFERRED NSL INPUT     Y02134 19665002
*                                       PROCESSING               Y02134 19670002
*                                                                Y02134 19675002
TCM00575 EQU   *                        ISSUE IECRES GET         Y02134 19680002
         MODESET EXTKEY=DATAMGT         ASSUME DM KEY            Y02082 19685002
         IECRES GET,PREFIX=YES,STM=(2,14,WTGPREFX),LV=(0),       Y02134*19690002
               ID=TCWA                  GET CORE FOR TCLOSE WKA  Y02144 19695002
         LR    RCORE,R1                 SAVE ITS ADDRESS IN:     Y02134 19700002
         ST    R1,K4(,RWTGC)            ..WORK AREA BASE REG AND Y02134 19705002
*                                       ..IN CURRENT WTG ENTRY   Y02134 19710002
         ST    RC,DXATCOM3              SAVE RRPLIST PTR IN W/A  Y02144 19715002
*                                                                       19720002
         IECRES INIT,DEB=YES,DCBCOPY=TOWKAR,STM=(3,14,WTGPREFX)  Y02134X19725002
                                        COPY THE DCB AND         Y02134X19730002
                                        INITIALIZE THE WORK AREA Y02134 19735002
         CLI   DXWCOPYE,K0              WAS INIT/COPY PROSPEROUS Y02082 19740002
         BNE   TCM00600                 BRANCH IF NO             Y02082 19745002
*                                                                       19750002
*        IF A CHECKPOINT DATA SET SECURITY INTERFACE EXISTS,     Y02083 19755002
*        FREE THE COPY OF THE USER'S DCB AND COPY THE            Y02083 19760002
*        PROTECTED DCB.                                          Y02083 19765002
*                                                                       19770002
TCB00580 EQU   *                        TEST FOR CHKPT SI        Y02083 19775002
         L     RF,DXDSAB                FETCH DSAB ADDRESS       Y02083 19780002
         USING DSAB,RF                  DSAB ADDRESSABILITY      Y02083 19785002
         TM    DSABFLG4,DSABCKSI        Q - CHKPT SI PRESENT     Y02083 19790002
         BZ    TCM00590                 IF NOT, BRANCH           Y02083 19795002
         DROP  RF                       DSAB ADDRESSABILITY      Y02083 19800002
         L     RDEB,DCBDEBAD            FETCH DEB ADDRESS        Y02083 19805002
         L     RDCB,DEBDCBAD            FETCH PROTECTED DCB ADDR Y02083 19810002
         ST    RDCB,DXUDCBAD            UPDATE WA USER DCB ADDR  Y02083 19815002
         MVI   DXUKEY,K0                SET USER KEY TO ZERO     Y02083 19820002
         L     R1,DXPDCBAD              GET ADDR OF COPIED DCB   Y02083 19825002
*                                       TO BE FREED              Y02083 19830002
         IECRES FREE,A=(R1),PREFIX=YES,STM=(2,14,WTGPREFX)       Y02083 19835002
         MVC   DXPDCBAD,DXUDCBAD        TELL INIT TO COPY        Y02083 19840002
         IECRES INIT,DCBCOPY=TOWKAR,STM=(3,14,WTGPREFX)          Y02083 19845002
         CLI   DXWCOPYE,K0              WAS COPY SUCCESSFUL      Y02083 19850002
         BNE   TCM00600                 IF NOT, BRANCH           Y02083 19855002
         OI    DCBOFLGS,DCBOBUSY        TURN ON BUSY BIT         YM5932 19857002
*                                       IN COPIED DCB            YM5932 19859002
         L     RF,DXUDCBAD              GET PTR TO USER DCB      YM5932 19859402
         MODESET  KEYADDR=DXUKEY,WORKREG=1  GET USER KEY         YM5932 19859802
         OI    DCBOFLGS-IHADCB(RF),DCBOBUSY  TURN ON BUSY BIT    YM5932 19859902
*                                       IN USER DCB              YM5932 19864502
         MODESET  EXTKEY=DATAMGT        RESUME DM KEY            YM5932 19866502
TCM00590 EQU   *                        TEST FOR VSAM ACB        Y02083 19869402
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    Y02134 19874002
         BO    TCM00700                 BR IF YES, NOT ACB       Y02134 19878602
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB  Y02134 19883202
         BNO   TCM00700                 BRANCH IF NO             Y02134 19887802
         CLI   ACBAMETH-IFGACB(RDCB),ACBVTAM  IS ACB FOR VTAM    YM3011 19892402
         BE    TCM00650                 BRANCH IF YES            Y02004 19897002
         CLI   ACBAMETH-IFGACB(RDCB),ACBVSAM  IS ACB FOR VSAM    Y02134 19901602
         BNE   TCM00650                 BRANCH IF NO             Y02134 19906202
         B     TCM03000                 GET NEXT ENTRY           Y02134 19910802
TCM00600 EQU   *                        SET ACB ERROR FLAGS      Y02134 19915402
         TM    DCBMACR,DCBMEXCP         IS ACCESS METHOD EXCP    X02989 19920002
         BO    TCM00650                 BR IF YES                Y02134 19925002
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB  X02989 19930002
         BNO   TCM00650                 BR IF NO                 Y02134 19935002
         MVI   ACBERFLG-IFGACB(RDCB),VSCACBCL  SET ACB ERROR FLG Y02134 19940002
TCM00650 EQU   *                        REFRESH USER'S DCB       Y02134 19945002
         NI    DCBOFLGS,X'FF'-DCBOBUSY  ZERO OUT BUSY BIT        Y02082 19950002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(2,14,WTGPREFX) REFRESH  Y02082*19955002
                                        USER'S DCB               Y02082 19960002
         LR    R1,RCORE                 PREPARE FOR FREEMAIN     Y02134 19965002
         IECRES FREE,A=(R1),PREFIX=YES,STM=(2,14,WTGPREFX)       Y02134 19970002
         XC    K0(K8,RWTGC),K0(RWTGC)   INDICATE NO WORK AREA    Y02004 19975002
         B     TCM03000                 GET NEXT ENTRY           Y02134 19980002
TCM00700 EQU   *                                                 X02989 19985002
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDR      Y02134 19990002
         TM    TIOELINK-TIOENTRY(RTIOT),TIOSPOOL TEST IF SPOOLED Y02134 19995002
         BM    TCM00650                 YES BYPASS THIS PARM     Y02134 19996002
         TM    DCBMACRF,DCBMREAD        IS THIS A BSAM READ DCB-        20000021
         BO    TCM01000                 ..BR IF YES TO PROCESS ENTRY    20100021
         TM    DCBMACRF+K1,DCBMWRIT     IS THIS A BSAM WRITE DCB-       20200021
         BNO   TCM00650                 ..BRANCH IF NOT          Y02134 20300002
*                                                                       20400021
*****    THIS SECTION TESTS FOR A TSO DATA SET.                         20500002
*                                                                       20600021
TCM01000 EQU   *                                                        20700021
         L     RUCB,DXUCBADR            LOAD UCB ADDRESS         YM1272 20800002
         LTR   RUCB,RUCB                TEST FOR DUMMY DATA SET OR TSO- 22600021
         BNZ    TCM03000                BR IF NEITHER            Y02134 23054002
TCM02500 EQU   *                                                        23300021
         CLI   DCBDEVT,DCBDEVTM         IS THIS TSO-                    23400021
         BNE   TCM00650                 ..BRANCH IF NOT          Y02134 23500002
         NI    DCBCIND1,X'FF'-DCBC1EOB  TURN OFF EOF BIT IN DCB ( THIS  23600021
*                                       ..IS THE ONLY TCLOSE            23700021
*                                       ..PROCESSING FOR TSO )          23800021
         B     TCM00650                 GO GET NEXT ENTRY        Y02134 23850002
TCM03000 EQU   *                                                        23900021
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 23950002
         TM    PLISTDCB(RPARC),LASTNTRY IS THIS THE LAST TCLOSE ENTRY-  24000021
         LA    RPARC,K4(,RPARC)         POINT TO THE NEXT TCLOSE ENTRY  24200021
         LA    RWTGC,L'WTGENTRY(,RWTGC) PT TO NEXT WTG ENTRY     Y02134 24250002
         BNO   TCM00500                 ..BR IF NOT TO GET NEXT ENTRY   24300021
         LR    RPARC,RPAR               PT FIRST DCB             Y02082 24400002
         LA    RWTGC,WTGENTRY           PT TO FIRST WTG ENTRY    Y02082 24500002
         USING WTGENTRY,RWTGC           ADDR CURRENT WTG ENTRY   Y02082 24600002
TCM03500 EQU   *                        CHECK FOR VALID ENTRY    Y02082 24700002
         L     RCORE,WTGCORE-K1         GET WORK AREA ADDRESS    Y02082 24800002
         LTR   RCORE,RCORE              CHECK IF TCLOSING        Y02082 24900002
         BNZ   TCM03600                 BRANCH IF VALID TCLOSE   Y02082 25000002
         TM    PLISTDCB(RPARC),LASTNTRY  CHECK IF LAST ENTRY     Y02082 25100002
         LA    RWTGC,WTGEND-WTGENTRY(,RWTGC)  ADDR NEXT ENTRY    Y02082 25200002
         LA    RPARC,K4(,RPARC)         ADDR NEXT PARAM LIST     Y02082 25300002
         BNO   TCM03500                 NO - TRY NEXT            Y02082 25400002
         B     TCM15500                 NO VALID TCLOSE ENTRIES  Y02082 25500002
         EJECT                                                   Y02082 25900002
TCM03600 EQU   *                        PROCESS THE DCB'S        Y02082 26000002
*                                                                       26200021
*********************************************************************** 26300021
*              PREPARE TO PROCESS THE DCBS                            * 26400021
*********************************************************************** 26500021
*                                                                       26600021
TCM04000 EQU   *                                                        27000021
         L     RDCB,PLISTDCB(,RPARC)    POINT TO DCB FOR THIS ENTRY     27100021
         L     RCORE,WTGCORE-K1         LOAD WORKAREA ADDRESS    Y02134 27102002
         LTR   RCORE,RCORE              IS THIS DCB PROCESSABLE  Y02134 27104002
         BZ    TCM13000                 BRANCH IF NO             Y02134 27106002
         L     RDEB,DCBDEBAD            LOAD DEB ADDRESS FROM DCB       27400021
         L     RUCB,DEBSUCBA            LOAD UCB ADDRESS         Y02134 27500002
         L     RTIOT,DXTIOTAD           GET CURRENT TIOT ENTRY   Y02134 27600002
         DROP  RWTGC                                             Y02082 28150002
*                                                                       31400021
*********************************************************************** 31500021
*              INITIALIZE THE 'TCLOSE' WORK AREA                      * 31600021
*********************************************************************** 31700021
*                                                                       31800021
*****          INITIALIZE CONTROL BLOCKS IN WORK AREA                   31900021
*                                                                       32000021
TCM06500 EQU   *                                                        32100021
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    X02989 32360002
         BO    TCM06600                 BR IF YES, NOT ACB       X02989 32370002
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB  X02989 32380002
         BNO   TCM06600                 BR IF NO                 X02989 32390002
         TM    ACBAMETH-IFGACB(RDCB),ACBVSAM  IS ACB FOR VSAM    X02989 32392002
         BO    TCM07600                 BR IF YES, READ JFCB     X02989 32394002
TCM06600 EQU   *                                                 X02989 32396002
         LA    RD,DXDCB                 PLACE ADDRESS OF WORK AREA DCB  32400021
         ST    RD,DXDEBDCB              ..INTO WORK AREA DEB            32500021
         ST    RD,IOBDCBPT-K1           ..AND INTO WORK AREA IOB        32600021
         MVI   DXDEBID,DEBIDENT         MOVE DEB ID INTO WORK AREA DEB  32700021
         MVC   DXDEBUCB,DEBSUCBA        MOVE DEVICE MODIFIER,UCB Y02134 32800002
*                                       ..ADDRESS INTO WORK AREA DEB    32900021
         LA    RD,DXDEB                 PLACE ADDRESS OF WORK AREA DEB  33000021
         ST    RD,DXDCBDEB              ..INTO WORK AREA DCB            33100021
         LA    RD,DXECB                 PLACE ADDRESS OF WORK AREA ECB  33200021
         ST    RD,IOBECBPT              ..INTO WORK AREA IOB            33300021
         LA    RD,DXCCW1                PLACE ADDRESS OF WORK AREA CCW  33400021
         ST    RD,IOBSTART-K1           ..INTO WORK AREA IOB            33500021
         OI    IOBFLAG1,IOBUNREL        SET UNRELATED BIT IN IOB        33600021
         L     RET,CVTPTR               LOAD CVT ADDRESS         Y02134 33650002
         MVC   DXDEBAPP,CVTXAPG         MOVE IOS' APPENDAGE VECTOR TBL  33700021
*                                       ..ADDRESS INTO WORK AREA DEB    33800021
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    Y02082 33805002
         BO    TCM06700                 YES-DO DEBCHK            Y02082 33810002
         TM    DCBDSRG2,ACBDORGA        TEST FOR ACB             Y02082 33815002
         BO    TCM07500                 YES, DO NOT DELETE DEB   Y02082 33820002
*                                                                Y02082 33825002
TCM06700 EQU   *                        CHECK THE DEB            Y02082 33830002
         L     R1,DXUDCBAD              POINT TO USER'S DCB      Y02082 33835002
         DEBCHK (1)                     CHECK DEB                Y02082 33840002
         LR    RDEB,R1                  LOAD VERIFIED DEB ADDR   Y01021 33845002
         STCM  RDEB,B'0111',DCBDEBAD+K1  REFRESH DCBCOPY'S DEBAD Y02082 33850002
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXPDCBAD+K1  POINT DEB Y02082*33855002
                                        TO PROTECTED DCB COPY    Y02082 33860002
         LA    RF,DEBBASIC-DEBXTNP      NEGATIVE OFFSET TO DEB   YM1272 33865002
*                                       EXTENSION ADDRESS        YM1272 33870002
         SR    R1,RF                    POINT R1 TO DEB PREFIX   YM1272 33875002
         L     RF,DEBXTNP-DEBXTNP(,R1)  LOAD DEB EXTENSION ADDR  YM1272 33880002
         OI    DEBXFLG1-DEBXTN(RF),DEBXCDCB  INDICATE DEBDCBAD   YM1272 33885002
*                                       POINTS TO THE COPIED DCB YM1272 33890002
*                                                                       33900021
*****          PURGE I/O TO HALT ANY OUTSTANDING I/O FOR THIS DCB       34000021
*                                                                       34100021
TCM07000 EQU   *                                                        34200021
         ST    RDEB,DXCCW5              INITLZ PURGE PARAMETER LIST     34300021
         MVI   DXCCW5,PURGEFLG          INITLZ FLAGS- DO NOT POST COMP  34400021
         LA    R0,DEBUSRPG              LOAD ADDRESS OF IOB PURGE CHAIN 34500021
         ST    R0,DXCCW6                ..AND STORE IN PARAMETER LIST   34600021
         LA    R1,DXCCW5                POINT TO PURGE PARAMETER LIST   34700021
         PURGE (1)                      SVC PURGE                       34800021
         WAIT  ,ECB=DXCCW5+K4           WAIT FOR PURGE COMPLETION       34900021
         TM    DCBCIND2,DCBC2CHN        IS THIS A CHAINED SCHED DCB-    35000021
         BZ    TCM07500                 ..BRANCH IF NOT                 35100021
         L     R1,DCBIOBAD              LOAD ADDR OF IOB PREFIX         35200021
         MODESET KEYADDR=DXUKEY,WORKREG=15 IOB KEY               Y02082 35250002
         L     R1,IOBECBPT-DXIOB+K16(R1)   GET ECB ADDR                 35300021
         MVI   DXECB-DXECB(R1),ECBCOD7F SET ECB COMPLETE                35400021
         MODESET EXTKEY=DATAMGT         RET TCLOSE KEY           Y02082 35450002
TCM07500 EQU   *                                                        35500021
         LA    RF,MOD232Z               POINT TO ID/TTR OF FINAL MOD    35600021
         LA    RET,K4                   BR TABLE OFFSET FOR THAT MOD    35700021
         TM    UCBTBYT3,UCB3TAPE+UCB3DACC IS THIS A TAPE OR DA DEVICE-  35800021
         BZ    TCM12500                 ..BR IF NOT- PROCESSING DONE    35900021
*                                                                       36000021
*                                                                       36050002
*        LOCATE JFCB AND MOVE INTO WORKAREA                      Y02082 36100002
*                                                                       36150002
TCM07600 EQU   *                        MOVE JFCB INTO WORK AREA X02989 36160002
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDRESS   Y02082 36200002
         LA    RET,TIOEJFCB-TIOENTRY(,RTIOT) GET TIOT ENTRY ADDR Y02082 36250002
         IECRES LOCJFCB,(RET)           LOCATE JFCB              Y02082 36300002
         MVC   DXJBF(JFCBLGTH),INFMJFCB-INFMJFCB(RET) GET JFCB   Y02082 36350002
*                                       INTO WORKAREA            Y02082 36400002
*                                                                       36450002
         TM    JFCBMASK+K6,JFCTRACE     IS THE TRACE FACILITY SPEC'D-   40500021
         BNO   TCM09500                 ..BRANCH IF NOT                 40600021
         OI    WTGPATHS+K1,WTGTRACE     IND THAT TRACE FACILITY REQ'D   40800021
TCM09500 EQU   *                                                        40900021
         LA    RF,MOD231T               PT TO IDTTR OF VSAM MOD  X02989 40952002
         TM    JFCDSRG2,JFCORGAM        IS DATA SET VSAM         X02989 40960002
         BNO   TCM09570                 NO, GO CHK FOR DA DEVICE Y02144 40970002
         OI    DXATGENS,DXATVSMG        VSAM STRING TO GET CNTRL Y02144 40972002
         B     TCM12500                 BR TO PROCESS VSAM       Y02144 40974002
TCM09570 EQU   *                        INIT FOR DA PROCESSING   Y02144 40976002
         LA    RF,MOD232D               PT TO ID/TTR OF DA MODULE       41000021
         SR    RET,RET                  BR TABLE OFFSET FOR THAT MOD    41100021
         MVC   DXDEBUCB,DEBSUCBA        RESTORE USER'S UCB ADDR  Y02134 41200002
         TM    UCBTBYT3,UCB3DACC        IS THIS A DIRECT ACCESS DEVICE  41300021
         BO    TCM12500                 ..BR IF YES TO PROCESS DA       41400021
*                                                                       41500021
*********************************************************************** 41600021
*              TAPE PROCESSING                                        * 41700021
*********************************************************************** 41800021
*                                                                       41900021
TCM10000 EQU   *                                                        42000021
         TM    UCBTBYT2,UCB3TAPE        IS IT 7 TRK TAPE        ZA01326 42050002
         BO    TCM10100                 BRANCH IF YES           ZA01326 42060002
         MVC   DXDEBMOD(K1),DEBSDVM     SET MODE CODE-9 TRK     ZA01326 42070002
         B     TCM10200                 BRANCH TO CONTINUE      ZA01326 42080002
TCM10100 EQU   *                        SET MODE CODE-7 TRK     ZA01326 42090002
         MVI   DXDEBMOD,DCBTRTET        SET MOD TO EVEN PARITY WITH     42100021
*                                       ..TRANSLATION                   42200021
         OC    DXDEBMOD,JFCDEN          SET DENSITY TO TO THAT WHICH    42300021
*                                       ..WAS USED TO CREATE TAPE       42400021
TCM10200 EQU   *                        CONTINUE TAPE PROCESS   ZA01326 42450002
         SR    RET,RET                  BR TABLE OFFSET FOR NSL/SL OUT  42500021
*                                                                YM1493 42550002
*****    NON-STANDARD LABEL (NSL) TAPE EXIT DETERMINATION        YM1493 42600002
*                                                                YM1493 42650002
TCM10500 EQU   *                        TEST FOR NSL TAPE        YM1493 42700002
         TM    DEBOFLGS,DEBOFNSL        TEST FOR NSL TAPE        YM1493 42750002
         BNO   TCM11000                 BRANCH IF NOT NSL        YM1493 42800002
         OI    WTGPATHS,WTGTCLOS        INDICATE THAT TCLOSE     YM1493X42850002
                                        IS PERFORMING NSL        YM1493X42900002
                                        TAPE PROCESSING          YM1493 42950002
         LA    RF,MOD232Y               POINT TO ID/EPA OF THE   YM1493X43000002
                                        CLOSE MODULE WHICH DOES  YM1493X43050002
                                        NSL TAPE PROCESSING      YM1493 43100002
         B     TCM12500                 BR TO FINISH THIS DCB    YM1493 43150002
*                                                                YM1493 43200002
*****    NO-LABEL (NL) TAPE EXIT DETERMINATION                   YM1493 43250002
*                                                                YM1493 43300002
TCM11000 EQU   *                        TEST IF A WRITE OCCURRED YM5310 43350002
         TM    DCBOFLGS,DCBOWRIT        TEST IF A WRITE OCCURRED YM5310 43360002
         BNO   TCM11100                 BRANCH IF NOT            YM5310 43370002
         OI    DEBOFLGS,DEBOFEOF        SET EOF BIT IN DEBOFLGS  YM5310 43380002
TCM11100 EQU   *                        TEST FOR NL TAPE         YM5310 43390002
         LA    RF,MOD232S               POINT TO ID/EPA OF THE   YM1493X43400002
                                        POSITIONING MODULE (FOR  YM1493X43450002
                                        SL/AL INPUT AND ALL NL)  YM1493 43500002
         TM    JFCBLTYP,JFCNL+JFCBLP    TEST FOR NL OR BLP TAPE@ZA02878 43550002
         BM    TCM12500                 BR IF YES TO FINISH DCB@ZA02878 43600002
*                                                                YM1493 43650002
*****    STANDARD LABEL (AL, AUL, SL, OR SUL) OUTPUT TAPE        YM1493 43700002
*        EXIT DETERMINATION                                      YM1493 43750002
*                                                                YM1493 43800002
TCM11500 EQU   *                        TEST FOR OUTPUT          YM1493 43850002
         TM    DCBOFLGS,DCBOWRIT        HAS A WRITE OCCURRED     YM1493 43900002
         BNO   TCM12000                 BRANCH IF NOT            YM1493 43950002
         LA    RF,MOD232G               POINT TO ID/EPA OF THE   YM1493X44000002
                                        AL/AUL/SL/SUL OUTPUT MOD YM1493 44050002
         B     TCM12500                 BR TO FINISH THIS DCB    YM1493 44100002
*                                                                YM1493 44150002
*****    STANDARD LABEL (AL, AUL, SL, OR SUL) INPUT TAPE         YM1493 44200002
*        EXIT DETERMINATION                                      YM1493 44250002
*                                                                YM1493 44300002
TCM12000 EQU   *                        TEST FOR USER LABELS     YM1493 44350002
         TM    JFCBLTYP,JFCBUL          TEST FOR USER LABELS     YM1493 44400002
         BNO   TCM12500                 BRANCH IF NOT TO THE     YM1493X44450002
                                        TAPE POSITIONING MODULE  YM1493X44500002
                                        (FOR AL AND SL INPUT)    YM1493 44550002
         LA    RF,MOD232M               POINT TO ID/EPA OF       YM1493X44600002
                                        THE USER LABEL MODULE    YM1493X44650002
                                        (FOR AUL AND SUL INPUT)  YM1493 44700002
         LA    RET,K4                   BRANCH TABLE OFFSET FOR  YM1493X44750002
                                        AUL AND SUL INPUT -      YM1493X44800002
                                        FALL THRU TO FINISH DCB  YM1493 44850002
*                                                                       45100021
*****    INITIALIZE WORK AREAS FOR RESIDENT ROUTINE                     45200021
*                                                                       45300021
TCM12500 EQU   *                                                        45400021
         MVC   K0(K5,RWTGC),K0(RF)      MOVE ID/TTR OF NEXT MODULE      45500021
*                                       ..INTO WTG TABLE ENTRY          45600021
         STM   RTIOT,RET,DXREG9          STORE REGS 9-14       @ZA04905 45700037
         STM   R0,R1,DXREG0              STORE REGS 0,1        @ZA04905 45750037
TCM13000 EQU   *                                                        45900021
         TM    PLISTDCB(RPARC),LASTNTRY IS THIS THE LAST TCLOSE ENTRY-  46000021
         LA    RPARC,K4(,RPARC)         POINT TO NEXT TCLOSE ENTRY      46100021
         LA    RWTGC,WTGEND-WTGENTRY(,RWTGC) PT TO NEXT WTG TABLE ENTRY 46200021
         BNO   TCM04000                 BR TO GET NEXT ENTRY            46300021
         L     RF,WTGPREFX              GET BASE PREFIX PTR      YM7099 46310002
         L     RPARC,IECUPRML-IECPREFX(,RF) PT FIRST DCB       @ZA04905 46312037
         L     RF,IECRRPRM-IECPREFX(,RF) GET RRPLIST PTR         YM7099 46320002
         OI    RRFLAGS2-RRPLIST(RF),RRFFIN1 INDIC 1ST LOAD DONE  YM7099 46330002
         L     RES,CVTPTR               LOAD ADDRESS OF CVT    @ZA04905 46382037
         L     RES,CVTDMSR-CVT(RES)     LD ADDR OF RESIDENT RTN@ZA04905 46384037
         ST    RES,K4(RWTGC)            SAVE RES RTN ADDRESS IN@ZA04905 46386037
*                                       ..LAST WTG TABLE ENTRY @ZA04905 46388037
         LA    RWTGC,WTGENTRY           PT TO FIRST WTG ENTRY  @ZA04905 46390037
         USING WTGENTRY,RWTGC           ADDR CURRENT WTG ENTRY @ZA04905 46392037
TCM14000 EQU   *                        CHECK FOR VALID ENTRY  @ZA04905 46394037
         L     RCORE,WTGCORE-K1         GET WORK AREA ADDRESS  @ZA04905 46396037
         LTR   RCORE,RCORE              CHECK IF TCLOSING      @ZA04905 46398037
         BNZ   TCM15000                 BRANCH IF VALID TCLOSE @ZA04905 46398437
         TM    PLISTDCB(RPARC),LASTNTRY  CHECK IF LAST ENTRY   @ZA04905 46398837
         LA    RWTGC,WTGEND-WTGENTRY(,RWTGC)  ADDR NEXT ENTRY  @ZA04905 46399237
         LA    RPARC,K4(,RPARC)         ADDR NEXT PARAM LIST   @ZA04905 46399637
         BNO   TCM14000                 NO - TRY NEXT          @ZA04905 46399737
         B     TCM15500                 NO VALID TCLOSE ENTRIES@ZA04905 46399837
*                                                                       46400021
*********************************************************************** 49500021
*              EXITS                                                  * 49600021
*********************************************************************** 49700021
*                                                               SA53293 51350002
*****          OBTAIN THE ADDRESS OF THE OPEN/CLOSE/EOV         SA53293 51400002
*****          RESIDENT ROUTINE                                 SA53293 51450002
*                                                               SA53293 51500002
TCM15000 EQU   *                                                SA53293 51700002
         LM    RTIOT,RET,DXREG9         LOAD REGS 9-14         @ZA04905 51750037
         LM    R0,R1,DXREG0             LOAD REGS 0,1          @ZA04905 51770037
         MVC   WTGMODNM,INITNAME        MOVE BASIC NAME TO WTG   YM1272 51793002
*                                                               SA53293 51794002
*****          EXIT TO RESIDENT ROUTINE TO BEGIN SERIAL PROCESSING      51796002
*                                                               SA53293 51798002
         IECRES XCTL                    BR TO RES RTN TO XCTL    S21940 51800002
         SPACE 2                                                        51900021
*                                                                       51901002
*  THE CALLER OF T-CLOSE HOLDS THE TIOT RESOURSE EXCLUSIVELY.  @ZA29752 51902037
*  THIS SHOULD NEVER VALIDLY HAPPEN AND CANNOT BE ALLOWED.     @ZA29752 51902337
*                                                                       51902637
TCM15050 SR    RF,RF                    ZERO REG               @ZA29752 51902937
         SR    RC,RC                    ZERO REG               @ZA29752 51903237
         LA    RF,K12                   RETURN CODE            @ZA29752 51903537
         L     RC,ABND50D               ABEND CODE             @ZA29752 51903837
         ABEND (RC),DUMP                                       @ZA29752 51904137
         SPACE 2                                                        51905002
*                                                                       52000021
*****          RETURN TO CALLER- THERE ARE NO VALID DCBS TO PROCESS     52100021
*                                                                       52200021
TCM15500 EQU   *                                                        52300021
         IECRES FREE,PREFIX=WTG,A=(RWTG) FREE WTG CORE           Y02080 52400002
         LA    RF,K4                    SET RETURN CODE          X02989 52500002
*                                                                Y02080 52600002
         IECRES EXIT                    RETURN                   Y02080 52700002
         SPACE 2                                                        54500021
*********************************************************************** 54600021
*              CONSTANTS                                              * 54700021
*********************************************************************** 54800021
*                                                                       54900021
ABND50D  DS    0F                                              @ZA29752 54950037
         DC    XL4'0000050D'            ABEND CODE             @ZA29752 55000037
INITNAME DC    CL8'IFG023'              CHARACTERS 'IFG023  '    YM1272 55300002
         EJECT                                                          55600021
*********************************************************************** 55700021
*        TABLE OF MODULE IDS AND ENTRY POINT ADDRESSES                  55800002
*********************************************************************** 55900021
*                                                                       56000021
XCTLTB23 XCTLTABL ID=(MOD232D,2D,MOD232G,2G,MOD232M,2M,          YM1272X56100002
               MOD232S,2S,MOD232Y,2Y,MOD232Z,2Z,MOD231T,1T,      YM1272X56200002
               TCLOSE,IGC0002C),SVC=023,BRT=YES,LENGTH=          YM1272 56300002
         SPACE 2                                                        56400002
         IECDSECS CVT,                                                 C56500002
               RB,                                                     C56550002
               TCB,                                                    C56600002
               TIOT,                                                   C56650002
               DCB,                                                    C56700002
               DSAB,                                             Y02083C56750002
               ACB,                                              Y02080C56800002
               IEZDEB,                                           Y02134C56850002
               UCB,                                                    C56900002
               MAIN,                                                   C56950002
               PREFX,                                            Y02080C57000002
               WTG,                                                    C57050002
               IDAPDPRM,                                               C57100002
               RRPL,                                             Y02144*57150002
               EXPAND=YES                                        XM0630 57200002
         IDAAMB                                                  YM4688 57210002
         EJECT                                                   YM4688 57220002
*                                                                       57250002
TIOSPOOL EQU   X'06'                    TEST FOR SPOOLED         Y02134 57300002
         IECEQU AOS=YES,IEZDEB=YES                               Y02134 57350002
         END                                                            57700021
./  ADD  SSI=81140192,NAME=IGC00020
         TITLE 'IGC00020 - CLOSE INITIAL MODULE'                        00200021
IGC00020 CSECT                                                          00800021
         ENTRY IGC01020                 ENTRY FROM EOV DURING    Y02082 00850002
*                                       UNLIKE CONCAT PROCESSING Y02082 00900002
*********************************************************************** 01000021
*                                                                       01050037
*               VS2-037 CHANGES                                         01100037
*A724800-725600,A761100                                        @ZA29752 01150037
*                                                                     * 01200021
*          VS2 RELEASE 03 DELETIONS                                   * 01210003
*0000343373,546337-546499                                       Y30ASJC 01220003
*0000414776                                                      ZM0798 01230003
*0000                                                           ZM30765 01240003
*          VS1 RELEASE 02 DELETIONS                                   * 01260002
*0000414520                                                      X02989 01270002
*0000                                                            XM0478 01280002
*0000762578                                                      XM1250 01290002
*0000                                                            XM1037 01290102
*          VS2 RELEASE 01 DELETIONS                                   * 01300000
*0000                                                            YM0903 01350000
*0000                                                            YM0850 01352000
*0000                                                            YM0954 01354000
*0000                                                            YM0992 01356000
*0000414280                                                      YM4395 01358000
*0000                                                           YA00180 01358402
*0000                                                           YA00312 01358802
*                                                                     * 01400021
*          RELEASE 21 DELETIONS/CHANGES                               * 02400021
*                                                                S21042 02600021
*                                                                M0001  02800021
*                                                                A37193 03000021
*                                                                M0039  03100021
*1141416000,682000                                               A38013 03150021
*0000442000,532000                                               M0115  03160021
* 528000-530000                                                  M1793  03170021
*0000568000                                                      M2275  03180021
*0000646000                                                      A49961 03190021
*0000478000,482000                                              SA53294 03192000
*                                                                     * 03200021
* MODULE NAME = IGC00020                                              * 03250002
*                                                                     * 03300002
* DESCRIPTIVE NAME = CLOSE INITIAL MODULE                             * 03350002
*                                                                     * 03360002
* COPYRIGHT = NONE                                                    * 03370002
*                                                                     * 03380002
* STATUS CHANGE LEVEL 000                                             * 03400021
*                                                                     * 03600021
* FUNCTION -                                                          * 03800021
*    THIS MODULE CONTAINS THE FUNCTION(S) OR PART(S) OF FUNCTION(S)-- * 04000021
*    CLOSE INITIALIZATION FUNCTION.                                   * 04200021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)' FOR DETAILS.         * 04400021
*                                                                     * 04600021
* ENTRY POINTS -                                                      * 04800021
*         IGC00020 - ENTRY WHEN AN SVC 20 OR A CLOSE MACRO-           * 05000021
*                    INSTRUCTION IS ISSUED.                           * 05200021
*         IGC01020 - ENTRY VIA BRANCH FROM EOV FOR               Y02082 05250002
*                    CONCATENATION WITH UNLIKE ATTRIBUTES.       Y02082 05300002
*                                                                     * 05400021
* INPUT -                                                             * 05600021
*    ENTERED IN SUPERVISOR KEY                                   Y02082 05650002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 05800021
*                                                                     * 06000021
* OUTPUT -                                                            * 06200021
*    EXIT IN DATA MANAGEMENT KEY                                 Y02082 06250002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 06400021
*                                                                     * 06600021
* EXTERNAL REFERENCES -                                               * 06800021
*         IFG019RA - OPEN/CLOSE/EOV RESIDENT ROUTINE FOR XCTL AND     * 07000002
*                    WAIT.                                            * 07200021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 07400021
*                                                                     * 07600021
* EXITS, ERROR-                                                  XM1037 08750002
*    XCTL TO IFG0200V IF CLOSE NOT ENTERED FOR A VSAM CATALOG.   XM1037 08760002
*    XCTL TO IFG0200N IF CLOSE ENTERED FOR A VSAM CATALOG.       XM1037 08770002
*    EXIT VIA AN SVC 3 TO CALLING PROGRAM IN NONE OF THE DCB'S   XM1037 08780002
*      IN THE PARAMETER LIST CAN BE CLOSED.                      XM1037 08790002
*      THE WTG TABLE IS FREED AND THE TIOT IS DEQED USING        Y02134 08840002
*      THE IECRES MACRO                                          Y02134 08890002
*    EXIT IS TO THE PROBLEM DETERMINATION MODULE IFG0200P, IF AN      * 09200021
*    ABEND SITUATION OCCURS IN THIS MODULE.  REFER TO THE FOLLOWING   * 09400021
*    'FUNCTION PROLOG(S)'.                                            * 09600021
*    DMABCOND PCK IF CALLER HOLDS TIOT RESOURCE EXCLUSIVELY      YM7883 09605002
*                                                                     * 09800021
* TABLES/WORK AREAS -                                                 * 10000021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 10200021
*                                                                     * 10400021
* ATTRIBUTES -                                                        * 10600021
*    REENTRANT, REFRESHABLE, READ-ONLY, ENABLED, PRIVILEGED           * 10800021
*                                                                     * 11000021
* CHARACTER CODE DEPENDENCY -                                         * 11200021
*    CLASS ONE CHARACTER CODE DEPENDENCY - THE EBCDIC CHARACTER CODE  * 11400021
*    WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED IF A      * 11600021
*    DIFFERENT CHARACTER SET IS USED FOR EXECUTION.                   * 11800021
*                                                                     * 12000021
* NOTES -                                                             * 12200021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 12400021
*                                                                     * 12600021
*********************************************************************** 12800021
         EJECT                                                          13000021
         USING TIOENTRY,RTIOT                                           13200021
         USING FORCORE,RCORE                                            13400021
         USING TCB,RET                                                  13600021
         USING IHADCB,RDCB                                              13800021
         USING UCBOB,RUCB                                               14000021
         USING DEB,RDEB                                                 14400021
         USING WTG,RWTG                                                 14600021
         USING WTGENTRY,RWTGC                                           14800021
*********************************************************************** 15000021
*                                                                     * 15200021
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        15400021
         USING *,RBASE                                                  15600021
CIN00000 EQU   *                        GET WTG TABLE            Y02082 15650002
*                                                                     * 15800021
*********************************************************************** 16000021
         EJECT                                                          16200021
*                                                                     * 16400021
*                          FUNCTION PROLOG                            * 16600021
*                                                                     * 16800021
*********************************************************************** 17000021
*                                                                     * 17200021
* FUNCTION NAME -                                                     * 17400021
*    CLOSE INITIALIZATION FUNCTION.                                   * 17600021
*                                                                     * 17800021
* (STATUS) -                                                          * 18000021
*    NOT APPLICABLE                                                   * 18200021
*                                                                     * 18400021
* FUNCTION -                                                          * 21250000
*    DETERMINE IF THE DCB IS TO BE CLOSED.                            * 21300000
*    OBTAIN MAIN STORAGE FOR THE WHERE-TO-GO TABLE BY            Y02134 21350002
*     BRANCHING TO THE RESIDENT ROUTINE. THIS WILL ALSO RESULT   Y02134 21352002
*     IN THE TIOT BEING ENQED.                                   Y02134 21354002
*    OBTAIN MAIN STORAGE FOR THE WORKAREA AND CLEAR IT. ONE WORKAREA  * 21360000
*    PER DCB PROCESSED.                                               * 21370000
*    CONSTRUCT CONTROL BLOCKS NEEDED TO PERFORM I/O OPERATION.        * 21380000
*    PURGE QUEUED AND ACTIVE I/O REQUESTS ASSOCIATED WITH DATA SETS   * 21390000
*    THAT ARE BEING ACCESSED ON THE EXCP LEVEL.                       * 21392000
*    DETERMINE WHICH STRING IS TO CONTINUE PROCESSING.                * 21394000
*    READ JFCB INTO THE WORKAREA.                                     * 21396000
*    DETERMINE IF SMF DATA SET INFORMATION IS REQUESTED.              * 21398000
*    OBTAIN MAIN STORAGE FOR THE ECBLIST.                             * 21398400
*    INTERFACE WITH THE TRACE INITIALIZATION FUNCTION IF OPTIONAL     * 21398800
*    TRACE FACILITY IS REQUESTED.                                     * 21399200
*    DEB VALIDITY CHECKING IS ACCOMPLISHED VIA A DEB VALIDITY CHECK   * 21399300
*    ROUTINE WHICH MAINTAINS AND UPDATES A TABLE OF VALID DEB POINTERS* 21399400
*    IN PROTECTED CORE (LSQS).                                        * 21399500
*                                                                     * 21399600
*    IF A DCB IS ENCOUNTERED, THE FIRST FOUR BYTES OF WHOSE      YM6804 21400502
*    DDNAME IS 'IMGL', IT IS ASSUMED THAT THIS IS AN IMAGELIB    YM6804 21401002
*    DCB WHICH WILL BE CLOSED BY ISSUING SVC 105 WITH THE DCB    YM6804 21401502
*    ADDRESS IN REGISTER 1. UPON RETURNING FROM THE SVC 105,     YM6804 21402002
*    THE CALLER OF CLOSE WILL BE RETURNED CONTROL WITH A         YM6804 21402502
*    RETURN CODE OF ZERO IF THE IMAGELIB DCB IS THE ONLY         YM6804 21403002
*    DCB IN THE PARAMETER LIST. IF THERE ARE OTHER DCBS,         YM6804 21403502
*    PROCESSING ON THEM WILL CONTINUE, BUT SINCE NO CLOSE        YM6804 21404002
*    WORKAREA WAS OBTAINED FOR THE IMAGELIB DCB, AN EVENTUAL     YM6804 21404502
*    ERROR RETURN CODE WILL BE RETURNED TO THE CALLER.           YM6804 21405002
*    THIS METHOD OF CLOSING AN IMAGELIB DCB IS NOT INTENDED TO   YM6804 21405502
*    BE USED BY ANY OTHER ROUTINE THAN TASK CLOSE IN THE EVENT   YM6804 21406002
*    THAT IMAGELIB IS NOT CLOSED BEFORE TASK TERMINATION.        YM6804 21406502
*                                                                     * 21406602
* ENTRY POINTS -                                                      * 21407002
*    ENTERED FROM THE FOLLOWING--                                     * 21600021
*    WHEN AN SVC 20 OR A CLOSE MACRO-INSTRUCTION IS ISSUED.           * 21800021
*    WHEN A BRANCH ENTRY IS MADE FROM EOV FOR                    Y02082 21850002
*    CONCATENATION WITH UNLIKE ATTRIBUTES.                       Y02082 21900002
*                                                                     * 22000021
* INPUT -                                                             * 22200021
*    A POINTER IN REGISTER 1 TO THE PARAMETER LIST.                   * 22400021
*    FOR TSO TASKS WITH CONCATENATION OF UNLIKE ATTRIBUTES, REG 5     * 22500000
*    WILL CONTAIN THE VALUE 0 UPON ENTRY TO CLOSE IF EOV DID NOT      * 22550000
*    ISSUE A SUCCESSFUL ENQ ON THE TIOT.  REG 5 WILL CONTAIN THE      * 22560000
*    VALUE 1 IF EOV'S ENQ WAS SUCCESSFUL.                             * 22570000
*                                                                     * 22600021
* OUTPUT -                                                            * 22800021
*    A POINTER TO EACH OF THE FOLLOWING--                             * 23000021
*       CURRENT PARAMETER LIST ENTRY- RPARC                           * 23200021
*       DD ENTRY IN THE TIOT- RTIOT                                   * 23400021
*       WTG TABLE- RWTG                                               * 23600021
*       CURRENT WTG TABLE ENTRY- RWTGC                                * 23800021
*       DCB- RDCB                                                     * 24000021
*       WORK AREA- RCORE                                              * 24200021
*       RESIDENT ROUTINE- RES                                         * 24400021
*       UCB- RUCB                                                     * 24600021
*       DEB- RDEB                                                     * 24800021
*    THE JFCB IS IN THE WORKAREA.                                     * 25000021
*                                                                     * 25200021
* EXTERNAL REFERENCES -                                               * 25400021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 25600021
*    CONVERT ROUTINE TTR TO MBBCCHHR.                                 * 25800021
*                                                                     * 26000021
* EXITS, NORMAL -                                                     * 26200021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 26400021
*    CLOSE TAPE ACCESS METHOD EXECUTOR INTERFACE FUNCTION.            * 26600021
*    CLOSE UNIT RECORD/TELEPROCESSING FUNCTION.                       * 26800021
*    CLOSE DA READ DSCB FUNCTION.                                     * 27000021
*                                                                     * 27200021
* EXITS, ERROR -                                                      * 27400021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 27600021
*    EXIT WITH ONE OF THE FOLLOWING INTERNAL CODES--                  * 27800021
*       111 - 514 ABEND - I/O ERROR READING JFCB.                     * 28000021
*       112 -           - INVALID CONTROL BLOCK(S) FOUND.             * 28200021
*                                                                     * 28400021
* TABLES/WORK AREAS -                                                 * 28600021
*    THE OPEN, CLOSE, OR EOV WORK AREA AND THE WHERE-TO-GO (WTG)      * 28800021
*    TABLE ARE DESCRIBED BY THE DSECTS AT THE END OF THE LISTING.     * 29000021
*                                                                     * 29200021
* ATTRIBUTES -                                                        * 29400021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 29600021
*                                                                     * 29800021
* CHARACTER CODE DEPENDENCY -                                         * 30000021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 30200021
*                                                                     * 30400021
* NOTES -                                                             * 30600021
*    NOT APPLICABLE                                                   * 30800021
*                                                                     * 31000021
*********************************************************************** 31200021
         EJECT                                                          31400021
*                                                                       31600021
*****          INITIALIZATION                                           31800021
*                                                                       32000021
*********************************************************************** 33190000
*                                                                       33192000
*        GETMAIN THE WHERE-TO-GO TABLE                                  33194000
*                                                                       33196000
*                                                                Y02080 33198502
* SAVE REGISTERS 2-12 IN SVRB EXTENDED SAVE AREA                 Y02080 33198602
*                                                                Y02080 33198702
         L     RF,CVTPTR                GET POINTER TO CVT       Y02080 33205102
         L     RF,CVTTCBP-CVT(,RF)      GET TCB WORDS            Y02080 33207102
         L     RF,K4(,RF)               TCB ADDRESS              Y02080 33209102
         L     RF,K0(,RF)               POINTER TO SVRB          Y02080 33211102
         USING RBBASIC,RF                                        Y02080 33213502
*                                                                Y02080 33216302
         IECRES GET,PREFIX=WTG,            GETMAIN FOR WTG TABLE Y02080*33218702
               STM=(2,12,RBEXSAVE),A=(1)                         Y02080 33221102
*                                                                       33221402
* IF REG 0 IS NONZERO, IT IS BECAUSE THE CALLER HAS ENQUEUED     YM7883 33221702
* EXCLUSIVELY ON THE TIOT. THIS CAN NOT BE TOLERATED.            YM7883 33222002
*                                                                       33222302
         LTR   R0,R0                    IS R0 ZERO               YM7883 33222602
         BNZ   CIN01705                 BRANCH IF NOT            YM7883 33222902
*                                                                       33223502
* RETURN FROM GET IN DATAMGT KEY                                 Y02082 33225502
*                                                                       33225602
         DROP  RF                                                Y02080 33225902
         LR    RWTG,R1                  WTG ADDR TO RWTG REG     Y02080 33228302
         IECRES LOAD,PREFIX=WTGPREFX,MODNM=CLOSE,BRANCH=NO       Y02080*33243502
                                        GIVE OPT TRACE A SHOT    Y02080 33293502
         XC    WTGMODEP,WTGMODEP        CLEAR ADDR NEXT MOD      Y02080 33303502
CIN00075 EQU   *                        INITIALIZE POINTERS      Y01018 33353202
         L     RPAR,WTGPREFX            PT TO BASE               Y02134 33363202
         L     RC,IECRRPRM-IECPREFX(,RPAR) GET RRPLIST ADDRESS   Y02144 33364402
         MVI   RRFUNCTN-RRPLIST(RC),RRFCLOS  INDICATE CLOSE      Y02144 33366802
         L     RPAR,IECUPRML-IECPREFX(,RPAR) PT COPY USER PLIST  Y02134 33367002
         LR    RPARC,RPAR               SET CURRENT TO FIRST     Y02134 33368602
         SR    RC,RC                    SET GO SWITCH TO 0       YM0903 33370202
         LA    RWTGC,WTGENTRY-WTG(,RWTG) GET CURRENT WTG ENTRY   Y02134 33371802
CIN00100 EQU   *                                                        33375002
*                                                                Y02134 34010102
* SEMI-FORCED CLOSE ON IMAGELIB                                  Y02134 34010402
*                                                                Y02134 34010802
         L     RDCB,PLISTDCB(,RPARC)    LD ADDR OF ACB/DCB       Y02134 34011202
         L     RET,CVTPTR               GET POINTER TO CVT       Y02080 34012102
         L     RET,CVTTCBP-CVT(,RET)    GET TCB WORDS            Y02080 34012202
         L     RET,K4(,RET)             TCB ADDRESS              Y02080 34012302
         MODESET EXTKEY=RBT234,WORKREG=1 USER'S KEY              Y02134 34012402
         CLC   DCBDDNAM(K4),IMGDDNAM    IS THIS IMGLIB DCB      YA00180 34012802
         BNE   CIN0010A                 NO  BRANCH              YA00180 34013202
         LR    K1,RDCB                  YES  DET DCB ADDRESS    YA00180 34013602
         SVC   105                      ISSUE IMGLIB CLOSE      YA00180 34014002
         TM    PLISTOPT(RPARC),LASTNTRY LAST ENTRY IN THE PLIST  YM6804 34014202
         BNO   CIN01500                 BRANCH IF NOT            YM6804 34014402
         CR    RPAR,RPARC               IS THIS THE ONLY ENTRY   YM6804 34014602
*                                       IN THE PARM LIST         YM6804 34014802
         BNE   CIN01500                 BRANCH IF NO             YM6804 34015002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM6804 34015102
         LA    RTIOT,K0                 ZERO RETURN CODE         YM6804 34015702
         B     CIN01700                 EXIT                     YM6804 34016002
*                                                                Y02134 34016102
CIN0010A EQU   *                        TEST DUPLICATE DCB ADDR  YM2869 34018102
*                                                                       34018202
*        DON'T PROCESS DCB IF IT IS PREVIOUSLY DUPLICATED IN     YM2869 34018302
*        THE PARAMETER LIST                                      YM2869 34018402
*                                                                       34018502
         DROP  RWTGC                                             YM2869 34018602
         LA    R1,WTGENTRY              FIRST DCB'S WTG ENTRY    YM2869 34018702
         USING WTGENTRY,R1                                       YM2869 34018802
CIN0010C EQU   *                        CHECK EACH DCB           YM2869 34018902
         CR    R1,RWTGC                 ARE WE AT CURRENT DCB    YM2869 34019002
         BE    CIN0010G                 BR IF YES-NO DUPLICATES  YM2869 34019102
         L     RCORE,WTGCORE-K1         GET WORKAREA IF ANY      YM2869 34019202
         LA    RCORE,K0(,RCORE)         CLEAR FOR LTR            YM2869 34019302
         LTR   RCORE,RCORE              IS WORKAREA PRESENT      YM2869 34019402
         BZ    CIN0010E                 BR IF NO TO CHECK NEXT   YM2869 34019502
         CLM   RDCB,B'0111',DXUDCBAD+K1 IS CURRENT DCB BEING     YM2869 34019602
*                                       PROCESSED ALREADY        YM2869 34019702
         BE    CIN01500                 BR IF YES TO AVOID IT    YM2869 34019802
CIN0010E EQU   *                        GET NEXT DCB'S WTG ENTRY YM2869 34019902
         LA    R1,WTGENTRY+L'WTGENTRY   INCREMENT WTG ENTRY PTR  YM2869 34020002
         B     CIN0010C                 CHECK NEXT DCB           YM2869 34020102
         DROP  R1                                                YM2869 34020202
         USING WTGENTRY,RWTGC                                    YM2869 34020302
CIN0010G EQU   *                        NO DUPLICATES            YM2869 34020402
         TM    DCBOFLGS,DCBOLOCK        IS LOCK BIT OFF (1)      X02989 34021202
         BNO   CIN01500                 BR IF NO                 Y02134 34024802
         TM    DCBOFLGS,DCBOBUSY        BUSY BIT ALREADY ON?     Y02134 34028402
         BO    CIN01500                 BR IF YES-NO WORKAREA    Y02134 34032002
         TM    DCBOFLGS,DCBOPEN         OPEN BIT ON?             Y02134 34032402
         BNO   CIN01460                 BR IF NO                 Y02134 34032802
         LA    R0,CLOSSIZE              SIZE OF CLOSE WORKAREA   Y02134 34034002
*****                                                                   34036002
*****          TEST FOR DEFERRED TRAILER LABEL PROCESSING ON NSL Y02134 34037302
*****          VOLUME AT EOF TIME                                Y02134 34039302
*****                                                                   34039702
         TM    DCBMACRF,DCBMEXCP        EXCP DCB                 Y02134 34039802
         BO    CIN00101                 BRANCH IF YES            Y02134 34039902
         TM    DCBDSRG2,ACBDORGA        ACB/AMB                  Y02134 34040002
         BNO   CIN00101                 BRANCH IF NO             YM4688 34040602
         CLI   AMBID-IDAAMB(RDCB),AMBIDENT  TEST FOR AMB         YM4688 34040702
         BE    CIN01500                 BRANCH IF AMB            YM4688 34040802
         B     CIN00105                 BRANCH IF ACB            YM4688 34040902
CIN00101 EQU   *                        TEST FOR EOF AND NSL     Y02134 34041002
         L     RDEB,DCBDEBAD            ADDR OF CURRENT DEB      Y02134 34041402
         TM    DEBOFLGS,DEBOFEOF+DEBOFNSL  EOF AND NSL ON THIS   Y02134 34041502
*                                       DCB                      Y02134 34041602
         BNO   CIN00105                 NO,CONTINUE NORMAL CLOSE Y02134 34041702
         L     R1,DCBEXLST              ADDR OF DCB EXIT LIST    Y02134 34041802
         LA    R1,0(,R1)                CLEAR HIGH ORDER BYTE    Y02134 34041902
         LTR   R1,R1                    IS THERE AN ADDR PRESENT Y02134 34042302
         BZ    CIN00105                 NO,CONTINUE NORMAL CLOSE Y02134 34042402
         LA    R0,DXEWAEND-FORCORE      SPECIFY EOV WKAR SIZE    YM3062 34042502
CIN00103 EQU   *                        CHECK EXIT LIST          Y02134 34042702
         CLI   0(R1),XLDEFNSL           EXIT LIST CODE BYTE      Y02134 34043502
*                                       MATCH?                   Y02134 34043602
         BE    CIN00105                 YES,GO GET MORE          Y02134 34043702
*                                       CORE FOR EOV             Y02134 34043802
         CLI   0(R1),XLDEFNSL+LASTNTRY  EXIT LIST LAST CODE BYTE Y02134 34043902
*                                       MATCH?                   Y02134 34044002
         BE    CIN00105                 YES,GO GET MORE          Y02134 34044202
*                                       CORE FOR EOV             Y02134 34044302
         TM    0(R1),LASTNTRY           LAST CODE BYTE IN LIST   Y02134 34044502
         LA    R1,K4(,R1)               INCR CODE BYTE POINTER   Y02134 34044602
         BNO   CIN00103                 NO,GO CHECK NEXT         Y02134 34044702
         LA    R0,CLOSSIZE              SIZE OF WORK AREA RQD    Y02134 34044802
         SPACE 1                                                        34044902
*        GET CORE FOR CONTROL BLOCKS FOR THIS PARTICULAR DCB     Y02134 34045002
CIN00105 EQU   *                        GET DCB WORK AREA        Y02134 34045102
         MODESET EXTKEY=DATAMGT         KEY OF REG SAVE AREA     Y02134 34046002
*                                                                       34048602
         IECRES GET,LV=(0),PREFIX=YES,STM=(2,14,WTGPREFX),       Y02134*34049502
               ID=CLWA                  GETMAIN FOR WORK AREA    Y02144 34050402
*                                                                       34051302
*        STORE THE ADDRESS OF THE GOTTEN CORE IN ITS PROPER      Y02134 34052202
*        PLACE IN THE WTG TABLE                                  Y02134 34053102
*                                                                       34054002
         LR    RCORE,R1                 SET UP BASE WORK AREA    Y02134 34054902
         LR    RC,RCORE                 SET GO SWITCH            Y02080 34055302
*                                                                       34055802
*        PLACE ADDRESS OF CONTROL BLOCK CORE IN WTG TABLE        Y02134 34056702
*        FOR THIS PARTICULAR DCB                                 Y02134 34057602
*                                                                       34058502
         ST    RCORE,WTGCORE-K1         STORE WORK AREA ADDRESS  Y02134 34059402
         MVC   WTGIDTTR,INITMOD         SET DEFAULT NEXT MODULE  Y02080 34060302
         L     RF,WTGPREFX              GET ADDR OF PREFIX       Y02144 34064002
         L     RF,IECRRPRM-IECPREFX(,RF) GET RRPLIST PTR         Y02144 34064902
         ST    RF,DXATCOM3              SAVE RRPLIST PTR IN W/A  Y02144 34065802
         IECRES INIT,DEB=YES,DCBCOPY=TOWKAR,STM=(3,14,WTGPREFX)  Y02134 34066702
         CLI   DXWCOPYE,K0              CHECK IF ERROR           Y02134 34067602
         BNE   CIN00808                 BR IF ERROR IN INIT      Y02134 34068502
*                                                                Y02083 34069002
*        IF A CHECKPOINT DATA SET SECURITY INTERFACE EXISTS;     Y02083 34069102
*        FREE THE COPY OF THE USER'S DCB AND COPY THE            Y02083 34069302
*        PROTECTED DCB.                                          Y02083 34069602
*                                                                Y02083 34069702
         L     RF,DXDSAB                FETCH DSAB ADDRESS       Y02083 34069802
         LTR   RF,RF                    IS THERE A DSAB PTR      YM1342 34069902
         BZ    CIN00102                 BRANCH IF NO             YM1342 34070102
         USING DSAB,RF                  ADDRESS DSAB             Y02083 34070302
         TM    DSABFLG4,DSABCKSI        Q - CHKPT SI PRESENT     Y02083 34070402
         BZ    CIN00102                 IF NOT, BRANCH           Y02083 34070502
         DROP  RF                       DSAB ADDRESSABILITY      Y02083 34070602
         L     RDEB,DCBDEBAD            GET DEB ADDRESS          Y02083 34070702
         L     RDCB,DEBDCBAD            GET PROTECTED DCB ADDRESSY02083 34070802
         ST    RDCB,DXUDCBAD            UPDATE WA USER DCB ADDR  Y02083 34070902
         MVI   DXUKEY,K0                SET USER KEY TO ZERO     Y02083 34071002
         L     R1,DXPDCBAD              GET ADDR OF COPIED DCB   Y02083 34071102
*                                       TO BE FREED              Y02083 34071202
         IECRES FREE,A=(R1),PREFIX=YES,STM=(2,14,WTGPREFX)       Y02083 34071502
         MVC   DXPDCBAD,DXUDCBAD        TELL INIT TO COPY        Y02083 34071602
         IECRES INIT,DCBCOPY=TOWKAR,STM=(3,14,WTGPREFX)          Y02083 34072002
         CLI   DXWCOPYE,K0              CHECK FOR ERROR          Y02083 34072102
         BNE   CIN00808                 BR IF ERROR IN INIT      Y02083 34072202
         OI    DCBOFLGS,DCBOBUSY        TURN ON BUSY BIT         YM5932 34076502
*                                       IN COPIED DCB            YM5932 34078502
         L     RF,DXUDCBAD              GET PTR TO USER DCB      YM5932 34079702
         MODESET  KEYADDR=DXUKEY,WORKREG=1  GET USER KEY         YM5932 34080502
         OI    DCBOFLGS-IHADCB(RF),DCBOBUSY  TURN ON BUSY BIT    YM5932 34080902
*                                       IN USER DCB              YM5932 34081302
         MODESET  EXTKEY=DATAMGT        RESUME DM KEY            YM5932 34081502
CIN00102 EQU   *                        TEST DCBOFLAGS           Y02083 34082102
         TM    DCBOFLGS,DCBOLOCK+DCBOPEN+DCBOBUSY                Y02134 34085702
         BNO   CIN00808                 BR IF NOT ALL ON         Y02134 34090002
CIN00106 EQU   *                        CHECK VSAM CATALOG       X02989 34094302
         L     RTIOT,DXTIOTAD           TIOT ADDRESS             Y02080 34098602
         L     RUCB,DXUCBADR            ESTABLISH UCB ADDR       Y02080 34102902
         L     RDEB,DCBDEBAD            GET DEB ADDR             Y02080 34107202
         NI    DCBOFLGS,X'FF'-DCBOCON   INSURE EOVC BIT = 0      Y02082 34111502
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    Y02080 34115802
         BO    CIN00602                 YES - DO DEB CHK         Y02080 34120102
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB  Y02080 34124402
         BNO   CIN00601                 NO - DO DEBCHK           Y02080 34128702
         USING IFGACB,RDCB              DEFINE BASE TO ACB       Y02080 34133002
         XC    ACBERFLG,ACBERFLG        RESET ACB ERROR FLAGS    Y02080 34137302
         CLI   ACBAMETH,ACBSUBS         SUBSYSTEM ACB?           Y02120 34187302
         BE    CIN00602                 YES - DO DEBCHK          Y02120 34237302
         CLI   ACBAMETH,ACBVTAM         VTAM DCB?                YM3011 34287302
         BE    CIN00200                 YES - DO DEBCHK         Y30ASJC 34337303
         TM    ACBINFL,ACBCAT+ACBSCRA+ACBUCRA  TEST VSAM CATLG @Y30DSDT 34387337
         BZ    CIN00110                 SKIP IF NOT VSAM CATLOG@Y30DSDT 34487337
         XR    RET,RET                  SET RETURN CODE TO 200V  Y02080 34537302
         STC   RET,DXRETCOD             RET CODE FOR INIT ENTRY  Y02080 34587302
         MVC   DXRETMOD,INITMOD         RET FROM CATLG TO 200V   Y02080 34637302
         MVC   WTGIDTTR,VSCATMOD        SET NEXT MOD VSAM CTLG   Y02080 34737302
         B     CIN00650                 CONTIN PROC VSAM CATLG   Y02080 34787302
CIN00110 EQU   *                        CHECK VSAM               Y02080 34837302
         CLI   ACBAMETH,ACBVSAM         VSAM ACB?                Y02134 41460202
         BNE   CIN00808                 BRANCH IF NO             Y02134 41460302
         B     CIN00650                 CONTINUE                 Y02134 41462802
*                                                                       41463203
*********************************************************************** 41463603
*                                                                       41464003
*        LINK TO VTAM ACDEB VALIDITY CHECK ROUTINE                      41464403
*                                                                       41464503
*              EP=ISTOCMDC                                              41464603
*              R0=ACB COPY PTR                                          41464703
*              R1=USER ACB PTR                                          41465503
*              R13=18 FW KEY 5 SAVE AREA                                41465903
*              R14=RETURN ADDRESS                                       41466303
*              R15=EP ADDRESS OF ISTOCMDC                               41467103
*              R2-R12 RESTORED                                          41467503
*                                                                       41467903
*********************************************************************** 41468803
*                                                                       41469203
CIN00200 EQU   *                        LINK TO VTAM ISTOCMDC   Y30ASJC 41469903
*                                                                       41470303
         L     R0,DXPDCBAD              ACB COPY PTR            Y30ASJC 41470403
         L     R1,DXUDCBAD              USER ACB PTR            Y30ASJC 41471103
         L     RD,WTGPREFX              18 FW SAVE AREA         Y30ASJC 41471503
         LA    RD,IECREGSV-IECPREFX(,RD) PTR TO 18 FW SAVE AREA ZM30765 41471603
*                                                                       41471903
         IECRES LOAD,MODNM=ISTOCMDC,BRCODE=CIN00250,            Y30ASJCX41472003
               BRANCH=DIRECT,PREFIX=WTGPREFX                    Y30ASJC 41472103
*                                                                       41472303
CIN00250 EQU   *                        RETURN FROM ISTOCMDC    Y30ASJC 41472703
*                                                                       41473303
         MODESET EXTKEY=DATAMGT         DM KEY                  Y30ASJC 41474203
         LR    RET,RF                   SAVE RETURN CODE         ZM0798 41474303
*                                                                       41474603
         IECRES LOAD,PREFIX=WTGPREFX,MODNM=CLOSE,BRANCH=NO      Y30ASJC*41474903
                                        GIVE OPT TRACE A SHOT   Y30ASJC 41475403
         XC    WTGMODEP,WTGMODEP        CLEAR ADDR NEXT MOD     Y30ASJC 41475803
*                                                                       41477003
         LTR   RET,RET                  INVALID VTAM ACB         ZM0798 41477603
         BZ    CIN01450                 BRANCH IF OK            Y30ASJC 41477803
         MVC   DXRETMOD,PDMOD           INDICATE ERROR          Y30ASJC 41479503
         B     CIN00830                 BRANCH IF NOT ACDEB     Y30ASJC 41482003
*                                                                       41483603
         USING IHADCB,RDCB              REDEFINE BASE TO DCB     Y02080 41485203
*                                                                       41486803
*    BYPASS DEBCHK IF BTAM OR SPOOLED DCB                        Y02120 41488403
*                                                                       41490003
CIN00601 EQU   *                        CHECK BTAM               Y02120 41491603
         TM    DCBDSRG1,DCBDSGCX        BTAM?                    Y02120 41493203
         BO    CIN00650                 BRANCH IF YES            Y02120 41494803
CIN00602 EQU   *                        INITIALIZE DEB REG       Y02120 41496403
         L     RET,DXTCBADR             RELOAD TCB ADDRESS       Y02134 41498002
         LA    RDEB,K4(,RET)            POINT RDEB TO TCBPIE SO  A38013 41500021
*                                       THAT NEXT INST. WILL GET        41600021
*                                       THE DEB ADDR                    41700021
*    CHECK THE DEB CHAIN OFF OF THE TCB FOR VALID DCB'S          YM3017 41750002
*    FOR A SPOOLED DCB THE DEBECBAD POINTS TO THE DCB.           YM3017 41760002
*                                                                YM3017 41770002
CIN00610 EQU   *                                                        41800021
         L     RDEB,DEBDEBAD            GET DEB ADDR                    42000021
         LA    RDEB,0(,RDEB)            CLEAR REG HI-ORDER BYTE         42200021
         LTR   RDEB,RDEB                ANY DEB ADDR                    42400021
         BZ    CIN00808                 NO, BR TO SET ERROR      Y02080 42600002
         TM    DCBDSRG2,DCBACBM         IS IT AN ACB             YM3062 42610002
         BO    CIN00620                 YES, GO CHECK DEBDCBAD   YM3062 42620002
         TM    TIOELINK,TIOTSPOL        IS IT A SPOOLED DCB      YM3017 42650002
         BZ    CIN00620                 NO, CHECK DEBDCBAD       YM3017 42700002
         CLC   DEBECBAD+K1(K3),DXUDCBAD+K1 CHECK DEBECBAD        YM3017 42750002
         B     CIN00630                 BRANCH TO CONTINUE LOOP  YM3017 42760002
CIN00620 EQU   *                        NOT A SPOOLED DCB        YM3017 42770002
         CLC   DEBDCBAD+K1(K3),DXUDCBAD+K1 CHK IF DEB PTS TO DCB Y02134 42800002
CIN00630 EQU   *                        DO DCB POINTERS MATCH    YM3017 42850002
         BNE   CIN00610                 NO, GO CHK NEXT DEB             43000021
         L     R1,DCBDEBAD              GET DEB ADDR FROM DCB           43200021
         LA    R1,0(,R1)                CLEAR HI-ORDER BYTE             43400021
         CR    RDEB,R1                  IS DEB ADDR IN DCB OK           43600021
         BNE   CIN00610                 CONTINUE DEB  SEARCH    SA51581 43800002
CIN00650 EQU   *                                                        44600021
*                                                                       52614002
*        BYPASS DEBCHK FOR VSAM, BTAM.                           Y02120 52616002
*                                                                       52618002
*        FOR A SPOOLED DCB THE DEBDCBAD POINTS TO AN ACB - THE   Y02120 52618402
*        DEBECBAD POINTS TO THE DCB                              Y02120 52618802
*                                                                       52619202
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP           52620000
         BO    CIN00810                 YES-GO CHECK FOR SPOOLED DCB    52630000
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB         52640000
         BNO   CIN00807                 NO-TEST FOR BTAM, SPOOL  Y02120 52650002
         CLI   ACBAMETH-IFGACB(RDCB),ACBVSAM  IS ACB FOR VSAM    X02989 52652002
         BNE   CIN00810                 BR IF NO: DEBCHK         Y02120 52654002
         B     CIN01450                 PROC NEXT ENTRY          Y02080 52658002
CIN00807 EQU   *                        SPOOLED DCB OR BTAM      Y02120 52668002
*                                                                       52718002
*        BYPASS DEBCHK FOR BTAM.                                 Y02120 52728002
*        DO SPECIAL PROCESSING FOR SPOOLED DCB.                  Y02120 52730002
*                                                                       52738002
         TM    DCBDSRG1,DCBDSGCX        BTAM?                    Y02120 52740002
         BO    CIN00830                 BRANCH IF YES            Y02120 52742002
         TM    TIOELINK,TIOTSPOL        SPOOLED DCB?             Y02120 52742402
         BZ    CIN00810                 BRANCH IF NO             Y02120 52742802
         L     RDEB,DCBDEBAD            GET DEB ADDRESS          Y02120 52743202
         LA    RDEB,K0(RDEB)            CLEAR FOR COMPARE        Y02120 52743602
         CLC   DEBECBAD+K1(K3),DXUDCBAD+K1 DEB -> TO OUR DCB?    Y02120 52743702
         BNE   CIN00808                 BRANCH IF NO             Y02120 52743802
         L     R1,DEBDCBAD              ACB ADDRESS              Y02120 52743902
         DEBCHK (R1),AM=SUBSYS          IS DEB VALID?            Y02120 52744002
         CR    RDEB,R1                  IS IT OUR DEB?           Y02120 52793902
         BE    CIN00830                 BRANCH IF YES            Y02120 52803902
CIN00808 EQU   *                        ERROR                    Y02120 52815902
         MVC   DXRETMOD,PDMOD           MOVE IN P.D. MOD ID      Y02120 52817902
* TURN OFF THE BUSY BIT IN BOTH THE USER AND COPIED DCB'S        YM7304 52818302
         NI    DCBOFLGS,ALLBITS-DCBOBUSY                         YM7304 52818702
         L     RF,DXUDCBAD              POINT TO USER'S DCB      YM7304 52819102
         MODESET KEYADDR=DXUKEY,WORKREG=1                        YM7304 52819502
         NI    DCBOFLGS-IHADCB(RF),ALLBITS-DCBOBUSY              YM7304 52819602
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         YM7304 52819702
         B     CIN00830                 GO GET ERROR CODE        Y02120 52819902
CIN00810 EQU   *                        VALIDATE DEB             Y02120 52823902
*        VALIDATE DEB                                            Y02120 52833902
*                                                                       52835902
         L     R1,DXUDCBAD              POINT TO USER'S DCB      Y02082 52839902
         DEBCHK (R1)                    VALIDATE DEB             Y02082 52841902
         LR    RDEB,R1                  LOAD VERIFIED DEB ADDR   Y01021 52843902
         STCM  RDEB,B'0111',DCBDEBAD+K1 REFRESH DCBCOPY'S DEBAD  Y02082 52893902
CIN00830 EQU   *                        TEST FOR ERROR           Y02120 52993902
         CLC   DXRETMOD,PDMOD           ERROR INDICATED          Y02080 53200002
         BNE   CIN00845                 NO,CONSTRUCT CONTROL BLOCKS     53400002
         LA    R0,CABD112               ERR- INVALID CNTRL BLOCK        53600021
*    THE CALLING MOD ID 'DXCALLID' WILL BE SET IN IFG0200V.      YM6507 53650002
         B     CIN01450                 BRANCH TO P. D. RTN             54400002
*                                                                Y02082 54450002
**************************************************************** Y02082 54460002
*                                                                Y02082 54470002
**  1. THE FOLLOWING LABEL (IGC01020) IS THE ENTRY POINT TO      Y02082 54500002
**     CLOSE FROM EOV FOR THE FOLLOWING PURPOSES:                Y02082 54520002
**        (A) UNLIKE CONCATENATION PROCESSING.                   Y02082 54550002
**        (B) CLOSING OF A DCB IF AN EOV ERROR IS TO BE IGNORED. Y02082 54550102
**  2. REGISTER R1 CONTAINS A POINTER TO A SINGLE-MEMBER         Y02082 54550402
**     CLOSE PARAMETER LIST.                                     Y02082 54551202
**  3. THE EOV WORK AREA (WHICH INCLUDES THE WTG TABLE) IS       Y02082 54552002
**     PASSED TO CLOSE, WITH REGISTER RCORE ALREADY              Y02082 54554002
**     INITIALIZED WITH THE WORK AREA ADDRESS. THE EOV WTG       Y02082 54560002
**     TABLE BEGINS AT 'DXXMODNM' IN THE EOV WORK AREA.          Y02082 54562002
*                                                                Y02082 54570002
IGC01020 EQU   *                        EOV ENTRY                Y02082 54580002
         BALR  RBASE,K0                 ESTABLISH ADDR           Y02082 54590002
CIN00840 EQU   *                        RESET BASE               Y02082 54590102
         LA    RBASE,0(RBASE)           INSURE HI-ORDER BYTE = 0 Y02082 54592002
         LA    RF,CIN00840-CIN00000     SET RF FOR BASE REG CALC Y02082 54592802
         SR    RBASE,RF                 SET RBASE AS BASE REG    Y02082 54593202
*                                                                Y02082 54593702
         LR    RPAR,R1                  LOAD PARM LIST ADDRESS   Y02082 54594002
         LA    RWTG,DXXMODNM            SET UP WTG TABLE ADDRESS Y02082 54596002
         LR    RPARC,RPAR               INIT CURR PARM LIST ADDR Y02082 54598002
         L     RDCB,PLISTDCB(,RPARC)    GET DCB ADDRESS          Y02082 54598402
         LA    RWTGC,WTGENTRY-WTG(,RWTG) INIT CURR WTG ADDRESS   Y02082 54598802
         XC    WTGMODEP,WTGMODEP        CLEAR ENTRY POINT        Y02080 54599202
         MVC   WTGIDTTR,INITMOD         SET NEXT MOD             Y02080 54599702
         L     RTIOT,DXTIOTAD           GET TIOT DD ENTRY ADDR   Y02082 54599902
         L     RUCB,DXUCBADR            SET UP UCB ADDRESS       Y02082 54626602
         LR    RC,RCORE                 SET GO SWITCH            Y02080 54628602
         L     RDEB,DCBDEBAD            SET UP DEB ADDRESS       Y02082 54630602
         LA    RDEB,0(RDEB)             CLEAR HI-ORDER BYTE      Y02082 54632602
         L     RF,DXATCOM3              GET ADDR OF RRPLIST      Y02144 54633002
         MVI   RRFUNCTN-RRPLIST(RF),RRFCLOS  SET CLOSE FUNCTION  Y02144 54633402
CIN00845 EQU   *                        CHECK FOR DUMMY         Y30ASJC 54633703
*                                                                       54650021
*        FOR DUMMY DATA SETS, NO JFCB IS READ. THEREFORE,               54700021
*        THERE IS NO NEED TO BUILD THE CONTROL BLOCKS.                  54750021
*                                                                       54760021
         TM    TIOELINK,TIOTSPOL        SPOOLED DATA SET         Y02120 54762002
         BM    CIN00860                 BRANCH IF YES            Y02120 54764002
         LTR   RUCB,RUCB                TEST FOR NULL DATA SET   M1793  54770021
         BZ    CIN01450                 Y - PROC NEXT DCB ENTRY  Y02080 54780002
CIN00860 EQU   *                        RESET TCB PTR            Y02120 54790002
         L     RD,CVTPTR                PT CVT                   Y02080 54792002
         USING CVT,RD                   CVT ADDR                 Y02080 54794002
         L     RET,DXTCBADR             TCB ADDR                 Y02080 54796002
         USING TCB,RET                  TCB ADDR                 Y02080 54798002
*                                                                       54800021
*                                                                       55000021
*        CONSTRUCT CONTROL BLOCKS TO READ JFCB                          55200021
*                                                                       55400021
*                                                                       55600021
*        DEB                                                            55800021
         L     RF,CVTSVDCB              ADDRESS OF SVCLIB DCB    Y02080 56000002
         L     RF,K44(,RF)              ADDRESS OF TASK SCHEDULER DEB   56200021
         MVC   DXDEBDEB(K44),K4(RF)     USE TASK SCHEDULER DEB          56400021
         MVI   DXDEB+(DEBNMEXT-DEB),K1  SET NO. OF EXTENTS TO 1 YA03003 56410002
         MVC   DXDEBAPP,CVTXAPG         SET DUMMY APP VEC TBL    Y02080 56450002
         MVI   DXDEBMOD,K0              SET FILE MASK TO ZERO    YM6841 56500002
         XC    DXDEBECB+1(K3),DXDEBECB+1  ZERO DEBECBAD                 56600021
         MVC   DXDEBSCC(K5),MYZERO      SET EXTENTS FOR DISK     Y02080 57000002
         MVC   DXDEBECC,ANTR            SET UP HIGHEST ENDING CC IN DEB 57200021
         MVC   DXDEBNTR,ANTR            SET UP HIGHEST NUM OF TRACKS    57400021
*                                                                       57600021
*        DCB 8-BYTE                                                     57800021
*                                                                       58000021
         LA    RF,DXDEB                 DEB ADDRESS                     58200021
         ST    RF,DXDCBDEB              STORE DEB ADDRESS IN DCB        58400021
         LA    RF,DXDCB                 DCB ADDRESS                     58600021
         ST    RF,DXDCBAD               STORE DCB ADDRESS IN DEB        58800021
         MVI   DXDEBID,DEBIDENT         MOVE IN ID OF DEB        M2275  58850021
*                                                                       59000021
*        IOB 32-BYTE                                                    59200021
*                                                                       59400021
         ST    RF,IOBWGHT               STORE DCB ADDRESS IN IOB        59600021
         MVI   IOBFLAG1,IOBUNREL        MAKE I/O REQUESTS UNRELATED     59800021
*                                                                       60000021
*        ECB 4-BYTE                                                     60200021
*                                                                       60400021
         LA    RF,DXECB                 ECB ADDRESS                     60600021
         ST    RF,IOBECBPT              STORE ECB ADDRESS IN IOB        60800021
         LA    RF,DXCCW                 START CCW ADDRESS               61000021
         ST    RF,IOBSIOCC              STORE IN IOB                    61200021
*                                                                       61400021
         TM    TIOELINK,TIOTSPOL        SPOOLED DATA SET?        Y02120 61450002
         BM    CIN01450                 BRANCH IF YES            Y02120 61550002
         TM    DCBMACRF,DCBMEXCP        CK FOR EXCP                     61600021
         BO    CIN00900                 BR IF YES TO PURGE I/O          61800021
*                                                                X02989 61900002
* IF VSAM TO ISAM COMPATIBILITY INTERFACE, BYPASS I/O PURGE      X02989 61950002
*                                                                X02989 61970002
         TM    DEBFLGS1,DEBCIFLG        IS CI INDICATED          X02989 61980002
         BO    CIN01450                 PROC NEXT DCB            Y02080 61990002
CIN00875 EQU   *                        TEST FOR DELAYED ABEND   X02989 61998002
         TM    TCBFLG,TCBFA             IS ABEND BIT ON                 62000021
         BZ    CIN01450                 NO - PROC NEXT DCB ENTRY Y02080 62200002
*                                                                       62400021
*****   PURGE I/O TO HALT ANY OUTSTANDING I/O FOR THIS DCB              62600021
*              ***  PURGE WITH HALT I/O  ***                            62800021
*                                                                       63000021
         TM    DCBDSORG,DCBORGIS        CHECK FOR ISAM                  63200021
         BZ    CIN00900                 NO, PURGE THIS DEB       M0001  63400021
         MVC   DXCCW6+K4(K4),DEBUCBAD   SAVE FIRST 4 BYTES OF    A37193 63600002
*                                       ISAM SECTION OF DEB      A37193 63800021
         MVC   DEBUCBAD,K48(RDEB)       SHIFT FIRST UCB ADDRESS         64000021
CIN00900 EQU   *                                                        64200021
         ST    RDEB,DXCCW5              SETTING UP PURGE PARAMETER      64400021
         MVI   DXCCW5,PURGPOST          PURGE PARAMETER          A49961 64600021
         LA    R0,DEBUSRPG              IOB CHAIN FIELD FOR PURGE       64800021
         ST    R0,DXCCW6                SAVE IN CCW                     65000021
         LA    R1,DXCCW5                POINT TO PURGE PARAMETER        65200021
         PURGE (1)                      SVC PURGE                       65400021
         WAIT  ,ECB=DXCCW5+K4           WAIT FOR PURGE COMPLETION       65600021
         TM    DCBMACRF,DCBMEXCP        CK FOR EXCP              A38013 65660021
         BO    CIN01450                 BR IF YES                A38013 65720002
         TM    DCBDSORG,DCBORGIS        CHECK FOR ISAM           A37193 65800021
         BZ    CIN01450                 NO, CONTINUE PROCESSING  A37193 66000002
         MVC   DEBUCBAD,DXCCW6+K4       MOVE IN FIRST 4 BYTES OF A37193 66200002
*                                       ISAM SECTION OF DEB      A37193 66400021
CIN01450 EQU   *                                                        68800021
         XR    RET,RET                  SET INIT ENTRY           Y02080 68850002
         STM   RTIOT,RET,DXREGSAV       SAVE REG 9 THRU 14              69000021
         STM   R0,R1,DXREG0             SAVE REG 0 AND 1                69200021
         B     CIN01500                 PROC NEXT DCB ENTRY      Y02080 69250002
CIN01460 EQU   *                        ERROR DCB NOT OPEN       Y02080 69300002
         TM    DCBMACR,DCBMEXCP         CHK IF EXCP              Y02080 69350002
         BO    CIN01500                 Y - PROC NEXT DCB        Y02080 69360002
         TM    DCBDSORG+K1,ACBDORGA     CHK IF ACB               Y02080 69370002
         BNO   CIN01500                 NO - PROC NEXT DCB ENTRY Y02080 69380002
         MVI   ACBERFLG-IFGACB(RDCB),ACBCALR IND CLOSE ERROR   @ZA02186 69390000
CIN01500 EQU   *                                                        69400021
         MODESET EXTKEY=DATAMGT         RET TO CLOSE KEY         Y02082 69450002
         TM    PLISTOPT(RPARC),LASTNTRY  CK LAST ENTRY ON LIST          69600021
         LA    RWTGC,K8(,RWTGC)         NEXT WTG ENTRY                  69800021
         BO    CIN01600                 BRANCH IF LAST ENTRY            70000021
         LA    RPARC,K4(,RPARC)         NEXT DCB ENTRY                  70200021
         B     CIN00100                 BRANCH TO NEXT ENTRY     Y02080 70400002
CIN01600 EQU   *                                                        70600021
         LTR   RC,RC                    CHK IF ANYTHING TO CLOSE Y02080 70610002
         LA    RTIOT,K4                 ERROR RETURN IF NO       YM6804 70615002
         BZ    CIN01700                 BR - NOTHING TO CLOSE    Y02080 70620002
         L     RD,CVTPTR                GET CVT ADDRESS          Y02080 70650002
         L     RES,CVTDMSR              LOAD ADDR OF RES ROUT    Y02080 70800002
         ST    RES,K4(RWTGC)            SAVE RES RTN ADDR IN WTG Y02080 71000002
         LR    RCORE,RC                 SET LAST GOOD WORK AREA  Y02080 71050002
         L     RF,DXATCOM3              GET ADDR OF RRPLIST      YM7099 71060002
         OI    RRFLAGS2-RRPLIST(RF),RRFFIN1 1ST LOAD COMPLETED   YM7099 71070002
         MVC   WTGMODNM,LOWMOD          SET LOWEST MOD ID        YM7099 71080002
         LM    R0,R1,DXREG0             GET HIS REGS             Y02080 71100002
         LM    RTIOT,RET,DXREGSAV       GET REGS 9-14            Y02080 71150002
         IECRES XCTL                    EXIT NEXT MOD QUEUED     Y02080 71200002
CIN01700 EQU   *                        DCB UNCLOSEABLE                 72200021
*                                                                       72409202
*        FREEMAIN THE WHERE-TO-GO TABLE                                 72419202
*                                                                       72421202
         IECRES FREE,PREFIX=WTG,A=(RWTG) FREEMAIN WTG TABLE CORE Y02080 72429002
         LR    RF,RTIOT                 SET RETURN CODE          YM6804 72431802
*                                                                Y02080 72436402
*        RETURN TO CALLER                                        Y02080 72438402
*                                                                Y02080 72438802
         IECRES EXIT                    RETURN                   Y02080 72439202
*                                                                       72440002
*        THE CALLER OF CLOSE HOLDS THE TIOT RESOURCE EXCLUSIVELY YM7883 72445002
*        THIS SHOULD NEVER VALIDLY HAPPEN AND CAN NOT BE ALLOWED YM7883 72450002
*                                                                       72455002
CIN01705 EQU *                                                          72460037
         SR    RF,RF                   ZERO REG                @ZA29752 72480037
         SR    RC,RC                   ZERO REG                @ZA29752 72500037
         LA    RF,K8                   RETURN CODE             @ZA29752 72520037
         L     RC,ABND50D              ABEND CODE              @ZA29752 72530037
         ABEND (RC),DUMP                                       @ZA29752 72560037
         EJECT                                                          72600021
         SPACE 1                                                        72800021
*********************************************************************** 73000021
*                                                                     * 73200021
*                       CONSTANTS                                     * 73400021
*                                                                     * 73600021
*********************************************************************** 73800021
         SPACE 1                                                        74000021
MYZERO   DC    XL8'00000000'            CONSTANT                 Y02080 74050002
ANTR     DC    X'7FFF'                  DEB END CC AND NUM TRACKS       75600021
LOADID   DC    X'F2C0'                  ID OF FIRST LOAD OF CLOSE       76000021
IMGDDNAM DC    CL8'IMGLIB  '            IMAGELIB DDNAME          XM1250 76010002
LOWMOD   DC    CL8'IFG0200 '            LOWEST CLOSE MOD NAME    Y02080 76060002
ABND50D  DC    XL4'0000050D'            ABEND 50D              @ZA29752 76110037
         XCTLTABL ID=(,ISTOCMDC,INITMOD,0V,PDMOD,0P,            Y30ASJCX76259503
               VSCATMOD,0N,CLOSE,IGC00020),                     Y30ASJCX76259903
               SVC=020,BRT=YES,LENGTH=                           Y02080 76263502
TIOTSPOL EQU   X'06'                    JES SPOOL D.S. INDICATORS     $ 76290000
*                                                                       76310000
         IECDSECS CVT,TCB,TIOT,RB,                               Y02080X76400002
               DSAB,                                             Y02083X76400502
               DCB,ACB,DEB,UCB,MAIN,WTG,PREFX,RRPL,EXPAND=YES    Y02144 76500002
         IDAAMB                                                  YM4688 76550002
         EJECT                                                          76650002
         IECEQU AOS=YES                                                 76720002
         END                                                            76800021
./  ADD  SSI=80760163,NAME=IGC0003A
         TITLE 'IGC0003A - FEOV EXECUTOR (SAM)'                         00200037
IGC0003A CSECT                                                          00800021
*********************************************************************** 01000021
*                                                                     * 01200021
*                                                                     * 01300000
*          VS2 RELEASE 04 CHANGES/DELETIONS                           * 01305037
*0000678000,738000-748000                                      @ZA02215 01306037
*A795540-795680,A795980-795990                                 @ZA29752 01308037
*A674500-675800,714500,72600                                   @ZA30750 01309037
*          VS2 RELEASE 02 DELETIONS                                   * 01310002
*                                                                     * 01320002
*                                                                     * 01330002
*********************************************************************** 01360002
*                                                                     * 01410002
* MODULE NAME = IGC0003A (OS/VS2)                                     * 01460002
*                                                                     * 01510002
* DESCRIPTIVE NAME = FEOV EXECUTOR (SAM) FUNCTION                       01560002
*                                                                     * 01610002
* COPYRIGHT = NONE                                                    * 01660002
*                                                                     * 01710002
* STATUS = RELEASE 4, LEVEL 0                                         * 01760037
*                                                                     * 01810002
* FUNCTION =                                                          * 01860002
*        THIS EXECUTOR WILL BE THE FIRST LOAD OF THE EOV ROUTINES     * 01910002
*        WHEN THE FEOV (SVC 31) MACRO IS ISSUED.                      * 01960002
*        IT WILL CHECK THE VALIDITY OF THE DCB.                       * 02010002
*        FLUSH QSAM OUTPUT BUFFERS AND WAIT FOR QUIESENCE.            * 02060002
*        DEB VALIDITY CHECKING IS ACCOMPLISHED VIA A DEB VALIDITY     * 02110002
*        CHECK ROUTINE WHICH MAINTAINS AND UPDATES A TABLE OF VALID   * 02160002
*        DEB ADDRESSES IN PROTECTED CORE.                             * 02210002
*        THE EOV WORKAREA IS OBTAINED USING THE IECRES MACRO WHICH    * 02260002
*        WILL RESULT IN A SHARED ENQ ON THE TIOT.                     * 02310002
*                                                                     * 02360002
* NOTES = SEE BELOW                                                   * 02410002
*                                                                     * 02460002
*    DEPENDENCIES =                                                   * 02510002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 02560002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 02610002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 02660002
*                                                                     * 02710002
*    RESTRICTIONS = NONE                                              * 02760002
*                                                                     * 02810002
*    REGISTER CONVENTIONS =                                           * 02860002
*            R2 POINTS TO DCB                                         * 02910002
*            R4 POINTS TO EOV WORK AREA                               * 02960002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 03010002
*            R6 POINTS TO THE WTG TABLE                               * 03060002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 03110002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 03160002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 03210002
*            R10 POINTS TO THE UCB                                    * 03260002
*                                                                     * 03310002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 03360002
*                  END OF LISTING.                                    * 03410002
         EJECT                                                          03460002
* MODULE TYPE = CONTROL (EOV DATA MANAGEMENT)                         * 03510002
*                                                                     * 03560002
*    PROCESSOR = ASSEMBLER XF                                         * 03610002
*                                                                     * 03660002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 03710002
*                  ORG STATEMENT AT END OF LISTING                    * 03760002
*                                                                     * 03810002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 03860002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 03910002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 03960002
*                                                                     * 04010002
* ENTRY POINT = IGC0003A                                              * 04060002
*                                                                     * 04110002
*    PURPOSE = SEE FUNCTION                                           * 04160002
*                                                                     * 04210002
*    LINKAGE =                                                        * 04260002
*        FEOV MACRO (SVC 31) WITH DCB ADDRESS IN REGISTER 1           * 04310002
*                                                                     * 04360002
* INPUT =                                                             * 04410002
*        REGISTERS - REGISTER 1 POINTS TO USER'S DCB.                 * 04460002
*        A POINTER IN REGISTER 4 TO THE TCB SET BY THE SVC INTERRUPT  * 04510002
*        HANDLER.                                                     * 04560002
*                                                                     * 04610002
* OUTPUT =                                                            * 04660002
*        CONTROL PASSED IN PROTECT KEY 5.                             * 04670002
*        EOV WORKAREA.                                                * 04710002
*        REGISTERS -                                                  * 04760002
*        R2 POINTS TO DCB COPY                                        * 04810002
*        R4 POINTS TO EOV WORK AREA                                   * 04860002
*        R5 POINTS TO THE RESIDENT ROUTINE                            * 04910002
*        R6 POINTS TO THE WTG TABLE                                   * 04960002
*        R8 POINTS TO THE CURRENT WTG TABLE ENTRY                     * 05010002
*                                                                     * 05060002
* EXIT-NORMAL =                                                       * 05110002
*        IFG0551F VIA IECRES-BRANCH MACRO                             * 05160002
         EJECT                                                          05210002
* EXIT-ERROR =                                                        * 05260002
*        IFG0550P VIA DMABCOND AND IECRES-BRANCH MACRO TO ISSUE       * 05310002
*        1) INTERNAL ABEND CODE 182 CAUSING                           * 05360002
*        437-08 SYSTEM ABEND - INVALID DCB POINTER IN DEB.            * 05410002
*        2) INTERNAL ABEND CODE 242 CAUSING                           * 05460002
*        937-18 ABEND - DSAB INDICATES CHECKPOINT SECURITY            * 05510002
*        INTERFACE ALREADY ESTABLISHED.                               * 05560002
*                                                                     * 05570002
*        EXIT TO CALLER VIA IECRES-EXIT MACRO IF                      * 05610002
*        1) VTAM ACB, IN WHICH CASE THE ACBERFLG IS SET TO 04         * 05660002
*        2) EXCP DCB                                                  * 05710002
*        3) DCB DEVICE TYPE INDICATES TERMINAL DEVICE                 * 05760002
*        4) DUMMY DATA SET (UCB ADDRESS ZERO IN TIOT)                 * 05810002
*        5) ERROR RETURN FROM IECRES-INIT MACRO INDICATING DEB/DEB    * 05860002
*        EXTENSION/DSAB/DCBTIOT OFFSET INVALID                        * 05910002
*        6) OPEN AND LOCK BITS NOT ON IN DCBOFLGS                     * 05960002
*        7) THE DEB ACCESS METHOD TYPE INDICATES A SUBSYSTEM DEB      * 05970002
*        8) AN ACB INSTEAD OF A DCB ADDRESS IS PASSED IN REGISTER 1.  * 05980002
*        9) DEB CHAINED ON ANOTHER TCB AND IT IS BEING CLOSED BY      * 05982002
*        THE TASK CLOSE ROUTINE FOR THAT TCB                          * 05984002
*                                                                     * 05990002
*        DMABCOND PCK ISSUED IF IECRES-GET,PREFIX=EOV RETURNS    YM3185 06000002
*        A NON-ZERO RETURN CODE IN REGISTER 0, INDICATING THAT   YM3185 06002002
*        THE CALLER OF EOV WAS EXCLUSIVELY ENQUEUED ON THE TIOT. YM3185 06004002
*                                                                     * 06010002
* EXTERNAL REFERENCES = SEE BELOW                                     * 06060002
*                                                                     * 06110002
*    ROUTINES =                                                       * 06160002
*        THE FOLLOWING ROUTINES ARE GIVEN CONTROL EITHER VIA THE      * 06210002
*        SYNCH MACRO IF THE CALLER OF THIS SVC ROUTINE, AS INDICATED  * 06260002
*        BY THE RESUME PSW IN THE RB, IS IN A USER                    * 06310002
*        KEY (8-15), OR VIA A BALR IN THE CALLERS KEY IF THE CALLER   * 06360002
*        IS IN A SYSTEM KEY (0-7).                                    * 06410002
*                                                                     * 06420002
*        SEQUENTIAL ACCESS METHOD TRUNC ROUTINE POINTED TO BY         * 06460002
*        DCBPUT WITH BRANCH OFFSET OF 8.                              * 06510002
*                                                                     * 06520002
*        SEQUENTIAL ACCESS METHOD PUT ROUTINE POINTED TO BY DCBPUT.   * 06560002
*                                                                     * 06570002
*        SEQUENTIAL ACCESS METHOD PUT ERROR ROUTINE POINTED TO BY     * 06610002
*        DCBPERR.                                                     * 06660002
*                                                                     * 06670002
*        DATA MANAGEMENT SERVICE ROUTINE, IFG019RA, THROUGH           * 06680002
*        IECRES MACRO INSTRUCTION.                                    * 06690002
*                                                                     * 06710002
*    DATA AREAS =                                                     * 06760002
*        NONE.                                                        * 06770002
         EJECT                                                          06780002
*    CONTROL BLOCK =                                                  * 06860002
*        TCB                                                          * 06910002
*        SVRB                                                         * 06960002
*        DEB                                                          * 07010002
*        TIOT                                                         * 07060002
*        CVT                                                          * 07110002
*        DSAB                                                         * 07160002
*        SEQUENTIAL ACCESS METHOD IOBS                                * 07210002
*        DEB EXTENSION                                                * 07260002
*                                                                     * 07310002
* TABLES =                                                            * 07360002
*        EOV WORKAREA MAPPED BY FORCORE DSECT.                        * 07410002
*                                                                     * 07460002
* MACROS =                                                            * 07510002
*        MODESET                                                      * 07560002
*        DMABCOND                                                     * 07610002
*        IECRES EXIT                                                  * 07660002
*        IECRES GET                                                   * 07710002
*        IECRES LOAD                                                  * 07760002
*        IECRES INIT                                                  * 07810002
*        IECRES FREE                                                  * 07860002
*        DEBCHK                                                       * 07960002
*        SYNCH                                                        * 08010002
*        WAIT                                                         * 08060002
*        PURGE                                                        * 08110002
*        XCTLTABL                                                     * 08160002
*        IECDSECS                                                     * 08210002
*                                                                     * 08260002
* CHANGE ACTIVITY =                                                   * 08310002
*        SEE 'CHANGES/DELETIONS' SECTION JUST AFTER CSECT CARD        * 08360002
*                                                                     * 08410002
*********************************************************************** 08460002
         EJECT                                                          08510002
         BALR  RBASE,0                   ESTABLISH BASE                 21400021
         USING *,RBASE                   DEFINE BASE REGISTER           21600037
*                                                                       21700037
         USING IHADCB,RDCB                                              21800021
         USING SRT,RUCB                                                 22000021
         USING DEBBASIC,RDEB                                     Y02134 22050002
         USING FORCORE,RCORE                                            22200021
         USING WTG,RWTG                 BASE OF WTG TABLE        Y02080 22250002
         USING TIOENTRY,RTIOT           DEFINE BASE TO TIOT DD ENTRY    22300037
*                                                                       22400021
*  INTERNAL CODE FOR ABEND VIA PROBLEM DETERMINATION MODULE             22500021
*                                                                       22600021
EABD182  EQU   182                      CODE FOR ABEND 437-08    A48604 22700002
EABD242  EQU   242                      937-18 INTERNAL CD       Y02083 22750002
*                                                                       22800021
EIN03200 EQU   *                        BASE REGISTER POINTS HERE       23000002
         DROP  RCORE                                             Y02082 23500002
         USING TCB,R4                   SVC GETS R4 AS TCB ADDR  Y02082 23550002
         MODESET EXTKEY=RBT234,WORKREG=2 ASSUME CALLER'S KEY     Y02082 23600002
         DROP  R4                                                Y02082 23650002
         USING FORCORE,RCORE                                     Y02082 23700002
         LR    RDCB,R1                  GET DCB ADDRESS IN PROPER REG   23800021
         LA    R1,0(R1)                 CLEAR HIGH ORDER BYTE    A48604 23850021
         TM    DCBMACRF,DCBMEXCP        DCB USING EXCP MACRO     A48604 23900021
         BO    EIN03300                 YES RETURN TO USER       A48604 23950021
         TM    DCBOFLGS,DCBOPEN+DCBOLOCK IS DCB OPEN + UNLOCKED SA52379 24400002
         BNO   EIN03300                 NO RETURN TO USER       SA52379 24600002
*                                                                Y02004 24650002
* DO NOT PROCESS VTAM REQUESTS                                   Y02004 24700002
*                                                                Y02004 24750002
         TM    DCBDSRG2,ACBDORGA        IS THIS AN ACB?          Y02004 24800002
         BZ    EIN03210                 BR IF NO                 Y02004 24850002
         USING IFGACB,RACB              ADDRESS ACB              Y02004 24900002
         CLI   ACBAMETH,ACBVTAM         IS THIS ACB FOR VTAM?    YM3011 24950002
         BNE   EIN03300                 NO, EXIT                 Y02004 25000002
         MVI   ACBERFLG,VSCACBCL        SET ACB ERROR FLAG       Y02004 25050002
         B     EIN03300                 RETURN TO USER           Y02004 25100002
         USING IHADCB,RDCB              RESTORE BASE FOR DCB     Y02004 25150002
         EJECT                                                          25200002
EIN03210 EQU   *                        GET DEB TO CHECK                25202002
         CLI   DCBDEVT,DCBDEVTM         CHECK FOR TERMINAL       Y02082 25204002
         BE    EIN03300                 IF YES, RETURN TO USER   Y02082 25206002
         L     RDEB,DCBDEBAD            GET DEB FROM DCB         A48604 25211902
         LA    RDEB,0(RDEB)             CLEAR HIGH ORDER BYTE    A48604 25212002
*                                                                       25264021
*  NOW CHECK IF DEB POINTS TO DCB                                       25268002
*                                                                       25276021
EIN03230 EQU   *                        CHECK DEBAMTYP           A48604 25280002
         LR    R8,RDEB                  GET DEB IN R8            YM1196 25280402
         LA    R9,K3                    OFFSET BACK TO ACCESS    Y02120 25282002
*                                       METHOD INDICATOR         Y02120 25282402
         SR    R8,R9                    R8 POINTS TO AM TYPE     Y02120 25282802
         CLC   K0(K1,R8),SUBSYSAM       SUBSYSTEM DEB?           Y02120 25283202
         BE    EIN03300                 EXIT IF YES              Y02120 25283602
         L     R8,DEBDCBAD              GET DEB'S DCB PT         Y02134 25287302
         LA    R8,0(R8)                 CLEAR HIGH ORDER BYTE    A48604 25289902
         CR    R8,R1                    DOES DEB PT TO DCB       A48604 25292502
         BE    EIN03270                 BR YES - VALID DCB       A48604 25296021
         EJECT                                                          25306002
EIN03260 EQU   *                        ABEND ERROR EXIT         A48604 25318502
         BAL   R8,EIN03420              GET CORE FOR EOV RTNS    A48604 25321102
*                                                                       25323702
*              CONTROL RETURNED IN DATA MANAGEMENT KEY           Y02082 25326302
*                                                                       25328902
         NI    DCBOFLGS,K255-DCBOBUSY   CONTINUE WITH ABEND      Y02134 25331502
*              WHETHER OR NOT IECRES INIT WAS SUCCESSFUL         Y02134 25334102
         LA    RWTG,DXXAREA             WTG REG PTS TO DUMMY WTG A48604 25336702
         LA    RWTGC,DXXENTRY           CURRENT PTR POINTS TO    A48604 25339302
*                                       ..DUMMY ENTRY                   25341902
         ST    RCORE,DXXCORE-K1-DXXENTRY(RWTGC)  SAVE WORK AREA  A48604 25344502
*                                       ..POINTER IN WTG ENTRY          25347102
         DMABCOND  EABD182,ABEND2Z,RES=NO,REGSAVE=YES            A48604 25349702
*                                                                       25352302
*  INITIALIZE WHERE-TO-GO TABLE FOR XCTL TO PROBLEM DETERMINATION       25354902
*                                                                       25357502
         MVC   DXXMODID,ABEND2Z         SET MODULE ID TO 0P      A48604 25360102
         MVC   DXXMODEP+K1(K3),ABEND2Z+K2 AND TTR OF IFG0550P    Y02080 25362702
         B     EIN05120                 GO TO XCTL               A48604 25365302
*                                                                       25368202
EIN03270 EQU   *                        CHECK FOR DUMMY          A48604 25371102
         USING DEBBASIC,RDEB                                     Y02134 25384002
*        TCB ADDRESS PASSED TO SVC IN REGISTER 4                 Y02134 25394002
         USING TCB,RCORE                                         Y02134 25396002
         L     RTIOT,TCBTIO             GET TIOT ADDRESS         Y02134 25400002
         USING FORCORE,RCORE                                     Y02134 25450002
         AH    RTIOT,DCBTIOT            GET ADDR TIOT DD ENTRY          25600037
         L     RUCB,TIOEFSRT-K1         GET UCB ADDRESS                 25800037
         LA    RUCB,K0(RUCB)            CLEAR HIGH-ORDER BYTE           26000021
         LTR   RUCB,RUCB                IS THIS A DUMMY DATA SET        26200021
         BZ    EIN03300                 YES RETURN TO USER              26400021
*                                                                       26600021
         L     RDEB,DCBDEBAD            GET DEB ADDRESS                 26800021
         L     RUCB,DEBSUCBA            GET UCB ADDRESS          Y02134 27000002
         B     EIN03400                 BRANCH TO CONTINUE       Y02134 27600002
         EJECT                                                          27800002
EIN03300 EQU   *                        RETURN TO CALLER                28000002
*                                                                       28200021
*        RETURN TO CALLER                                        Y02080 28500002
*                                                                Y02080 28550002
         SR    RF,RF                    CLEAR ERR ROUTINE PTR   SA52379 28552002
         IECRES EXIT                    RETURN                   Y02080 28560002
         EJECT                                                          28750002
EIN03400 EQU   *                        CONTINUE NORMAL FEOV            29000002
*                                                                       29010002
*        DON'T PROCESS DEB CHAINED OFF ANOTHER TCB IF TASK CLOSE YM2869 29020002
*        IS PROCESSING THE DEB                                   YM2869 29030002
*                                                                       29040002
*        RCORE STILL POINTS TO TCB                               YM2869 29042002
*                                                                       29044002
         CLM   RCORE,B'0111',DEBTCBAD+K1 IS DEB ON CURRENT TCB   YM2869 29050002
         BE    EIN03410                 BRANCH IF YES            YM2869 29070002
         LR    R8,RDEB                  DEB ADDRESS              YM2869 29080002
         LA    RF,DEBBASIC-DEBXTNP      OFFSET TO DEBX ADDR      YM2869 29090002
         SR    R8,RF                    R8 POINTS TO DEBX ADDR   YM2869 29100002
         USING DEBXTNP,R8                                        YM2869 29110002
         L     R8,DEBXTNP               R8 POINTS TO DEBX        YM2869 29120002
         USING DEBXTN,R8                                         YM2869 29130002
         TM    DEBXFLG1,DEBXTSK         IS TASK CLOSE PROCESSING YM2869 29140002
*                                       THIS DEB                 YM2869 29150002
         BO    EIN03300                 EXIT IF YES              YM2869 29160002
         DROP  R8                                                YM2869 29170002
DEBXTSK  EQU   X'40'                    TASKCLOSE PROCESSING DEB YM2869 29172002
EIN03410 EQU   *                        CONTINUE NORMAL FEOV     YM2869 29180002
*                                                                       29220021
*  GET SPACE FOR END OF VOLUME ROUTINES                                 29240021
*                                                                       29260021
         LA    R8,EIN03450              LOAD ADDR FOR RETURN     A48604 29280021
*                                       ..FROM                          29300002
         EJECT                                                          29320002
EIN03420 EQU   *                        GET EOV WORKAREA         A48604 29340002
*                                                                Y02080 29390002
* SAVE REGISTERS 2-12 IN SVRB EXTENDED SAVE AREA                 Y02080 29440002
*                                                                Y02080 29442002
         L     RF,CVTPTR                GET POINTER TO CVT       Y02080 29444002
         L     RF,CVTTCBP-CVT(,RF)      GET TCB WORDS            Y02080 29446002
         L     RF,K4(,RF)               TCB ADDRESS              Y02080 29448002
         L     RF,K0(,RF)               POINTER TO SVRB          Y02080 29448402
*                                                                Y02080 29448802
         MODESET EXTKEY=SUPR            SUPR KEY TO STM IN SVRB  Y02082 29449202
         IECRES GET,PREFIX=EOV,LV=EOVSIZE,STM=(2,12,96(15)),     Y02080*29450002
               A=(RDCB)                                                 29500002
*                                                                       29600021
*        IF REG 0 IS NONZERO, IT IS BECAUSE THE CALLER HAS       YM3185 29650002
*        ENQUEUED EXCLUSIVELY ON THE TIOT. THIS MUST NOT BE      YM3185 29652002
*        ALLOWED TO GO UNNOTICED.                                YM3185 29654002
*                                                                       29656002
         LTR   R0,R0                    IS R0 ZERO               YM3185 29658002
         BNZ   EIN05160                 BRANCH IF NO             YM3185 29658402
*                                                                       29658802
         LR    RCORE,R1                                                 29660021
         LA    RWTG,DXXAREA             GET POINTER TO WTG TABLE Y02134 29662002
         L     RF,DXXPREFX              GET PREFIX PTR           Y02144 29662102
         L     RF,IECRRPRM-IECPREFX(,RF) GET RRPLIST PTR         Y02144 29664002
         USING RRPLIST,RF                                        Y02144 29666002
         MVI   RRFUNCTN,RRFFEOV         INDICATE FEOV FUNCTION   Y02144 29668002
         ST    RF,DXATCOM3              SAVE RRPLIST PTR IN W/A  Y02144 29668402
         DROP  RF                                                Y02144 29668802
         EJECT                                                          29668902
         IECRES LOAD,PREFIX=DXXPREFX,MODNM=FEOV,BRANCH=NO        Y02080X29669202
                                        GIVE OPT TRACE A SHOT    Y02080 29669602
         IECRES INIT,DEB=YES,PREFIX=DXXPREFX,STM=(2,12,DXXPREFX) Y02134 29670002
         BR    R8                       RETURN FROM REQUEST FOR  A48604 29704021
*                                       ..EOV WORK AREA                 29708021
*                                                                       29712021
EIN03450 EQU   *                        EXIT IF INIT FAILED      A48604 29716002
         CLI   DXWCOPYE,K0              WAS INIT SUCCESSFUL      Y02082 29716302
         BE    EIN03475                 BRANCH IF YES            Y02082 29716702
EIN03460 EQU   *                        FREE EOV WORKAREA, EXIT  Y02082 29716802
         IECRES FREE,PREFIX=EOV,A=(RCORE)                        Y02134*29720602
                                        R15 STILL IS SAVE AREA   Y02134 29722402
*                                                                Y02080 29726002
*        RETURN TO CALLER                                        Y02080 29727802
*                                                                Y02080 29729602
         IECRES EXIT                    RETURN                   Y02080 29731402
         EJECT                                                          29733202
EIN03475 EQU   *                        CHECK FOR SECURITY INTRF YM1320 29749802
         LA    RWTG,DXXAREA             GET PNTR TO WTG TABLE    YM1418 29749902
         LA    RWTGC,DXXENTRY           GET PNTR TO WTG ENTRY    YM1418 29750202
         L     RF,DXDSAB                GET DSAB ADDRESS         YM1320 29751802
         USING DSAB,RF                  ADDRESS DSAB             YM1320 29753802
         TM    DSABFLG4,DSABCKSI        DS SECURITY INTERFACE ON Y02083 29755802
         BNO   EIN03480                 NO  CONTINUE             YM1320 29757802
         DROP  RF                       DSAB ADDRESSABILITY      YM1320 29758202
*********************************************************************** 29762602
*              ISSUE ABEND 937-18 UNAUTHORIZED USER ATTEMPTING        * 29764602
*              TO FORCE END OF VOLUME ON A CHECKPOINT DATA SET.       * 29765002
*********************************************************************** 29765402
         LA    R0,EABD242               LOAD INTERNAL ABEND CD   Y02083 29765502
         DMABCOND (R0),ABCD0P,RES=NO,REGSAVE=YES SETUP TO ABEND  YM1320 29765602
         B     EIN05120                 GO TO XCTL               YM1320 29765702
         EJECT                                                          29779402
EIN03480 EQU   *                        END CHKPT D/S TEST       YM1320 29794502
         LA    RWTG,DXXAREA             GET PNTR TO WTG TABLE    YM1320 29808202
         LA    RWTGC,DXXENTRY           GET PNTR TO WTG ENTRY    YM1320 29821902
         XR    RD,RD                    CLEAR FOR IC INST        Y02134 29835602
         MODESET KEYADDR=DXUKEY,WORKREG=13 USER KEY              Y02134 29849302
         NI    DCBOFLGS,K255-DCBOBUSY   TURN OFF BUSY BIT        Y02134 29863002
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 29876702
         SRL   RD,K4                    PUT KEY IN LOW 4 BITS    Y02082 29890402
*                                                                       29904102
*        GET CALLER KEY SAVE AREA WITH WHICH TO INTERFACE WITH          29917802
*        THE SEQUENTIAL ACCESS METHOD ROUTINES                          29931502
*                                                                       29945202
         IECRES GET,LV=72,KEY=(RD),PREFIX=NO,STM=(2,14,DXXPREFX) Y02082*29958902
                                        GET USER SAVE AREA       Y02082 29972602
*                                                                       29986302
         LR    RD,R1                    SET UP FOR QSAM SAVE AREA       30000021
         EJECT                                                          30400002
         DEBCHK (RDCB)                  VALIDATE DEB             Y01021 30870002
         LR    RDEB,R1                  LOAD VERIFIED DEB ADDR   Y01021 30900000
*                                                                       30960037
         L     RC,DCBIOBA               GET CURRENT IOB ADDRESS         31000021
         LA    RC,K0(RC)                CLEAR HI BYTE                   31200021
         TM    DEBOPATB,DEBOPUPD        OPEN FOR UPDATE?         Y02134 31400002
         BNO   EIN03500                 IF NOT, BRANCH                  31600021
         TM    DEBOPATB,K15-DEBOPUPD    MAYBE--TEST FURTHUR      Y02134 31800002
         BZ    EIN03700                 YES, BRANCH                     32000021
*                                       NO, CONTINUE                    32200021
EIN03500 EQU   *                        NOT UPDATE-CHECK OUTPUT         32400002
         TM    DEBOPATB,DEBOPOUT        WAS IT USED FOR A WRITE  Y02134 32600002
         BNO   EIN04800                 NO BRANCH                       32800021
*                                                                       33000021
EIN03600 EQU   *                        OUTPUT-CHECK QSAM               33200002
         TM    DCBCIND2,DCBC2QSM        DCB USING QSAM                  33400021
         BNO   EIN04300                 NO, BRANCH.                     33600021
*                                                                       33610002
*        QSAM OUTPUT - SETUP FOR TRUNC ROUTINE                          33650002
*                                                                       33660002
         OI    DCBCIND2,DCBC2FEO        TURN ON FEOV BIT         A35349 33700021
         LR    R1,RDCB                  DCB ADDR. IN PROPER REG.-1      34400021
*                                                                       34600021
         MODESET EXTKEY=DATAMGT         GET IN DM KEY TO STORE   Y02082 34850002
         LA    R0,BRCODE                SAVE ENTRY POINT FOR     M0189  34920002
*                                       SYNCH                    M0189  34930021
         BAL   RET,EIN05150             GET PTR TO FEOV SVRB     M0189  34940021
         USING RBSECT,RF                                         M0189  34950021
         MODESET EXTKEY=SUPR            SVRB KEY                 Y02082 34952002
         STM   R2,RC,RBEXSAVE           SAVE REGS 2-12 IN SVRB   M0189  34960021
*                                       EXTENDED SAVE AREA              34970021
         CLI   DXUKEY,X80               IS CALLER IN SYSTEM KEY  Y02082 34970402
         BNL   EIN03620                 BRANCH IF NO             Y02082 34970802
         EJECT                                                          34970902
         MODESET KEYADDR=DXUKEY,WORKREG=14 ASSUME CALLER'S KEY   Y02082 34971202
         LM    R2,R8,RBGRS2             RESTORE USER REGS 2-8    Y02082 34971602
         LR    RF,R0                    INITIALIZE EXIT ADDRESS  Y02082 34972602
         BALR  RET,RF                   LINK TO TRUNC ROUTINE    Y02082 34973602
         MODESET EXTKEY=DATAMGT         ASSUME DATA MGT KEY      Y02082 34974602
         BALR  RET,0                    ESTABLISH ADDRESSABILITY Y02082 34975602
         USING *,RET                    BASE FOR NEXT BRANCH     Y02080 34976002
         B     EIN03630                 BRANCH TO RESTORE REGS   Y02082 34976602
         DROP  RET                      BASE NOT NEEDED AGAIN    Y02080 34977002
EIN03620 EQU   *                        SETUP SYNCH              Y02082 34977602
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 34982002
         LM    R2,R8,RBGRS2             RESTORE USER REGS 2-8    Y02082 34984002
*                                       THIS IS NECESSARY IN CASE       34990021
*                                       THE ACCESS METHOD ROUTINES      35000021
*                                       ISSUE EOV, SO THAT EOV          35010021
*                                       CAN FIND THE USER REGS          35020021
         DROP  RBASE                                             M0189  35030021
         LR    RF,R0                    INITIALIZE R15 FOR SYNCH M0189  35040021
         DROP  RF                                                M0189  35050021
         SYNCH (15)                     LINK TO TRUNC            M0189  35060021
         EJECT                                                          35060402
EIN03630 EQU   *                        RETURN FROM TRUNC        Y02082 35061002
         BALR  RET,0                    SET UP ADDRESSABILITY           35062000
         USING *,RET                    BASE FOR NEXT BRANCH     Y02080 35062102
         BAL   RET,EIN05150             GET SVRB PTR                    35062402
         DROP  RET                      BASE NOT NEEDED          Y02080 35112402
         USING RBSECT,RF                                         M0189  35130021
         LM    R2,RC,RBEXSAVE           RESTORE REGS 2-12        M0189  35140021
         DROP  RF                                                M0189  35150000
         DEBCHK (RDCB)                  VALIDATE DEB             Y01021 35170002
         LR    RDEB,R1                  RESTORE VALID DEB ADDR   Y01021 35192000
         LA    R1,DEBBASIC-DEBXTNP      OFFSET TO EXTENSION      Y02134 35196302
         SR    RDEB,R1                  RDEB POINTS TO EXT. ADDR Y02134 35196602
         USING DEBXTNP,RDEB                                      Y02134 35196902
         MVC   DXDEBXAD,DEBXTNP         UPDATE DEB EXT ADDR      Y02134 35197202
         LA    RDEB,DEBBASIC            RELOAD RDEB TO DEB START Y02134 35197502
         USING DEBBASIC,RDEB                                     Y02134 35197802
         MVC   DXUCBADR+K1(L'DXUCBADR-K1),DEBSUCBA+K1 UPDATE UCB        35198202
         USING EIN03200,RBASE                                    M0189  35198800
*                                                                       35200021
*  ISSUE EXTRA PUT TO WRITE LAST RECORD IF PUT LOCATE                   35210037
*                                                                       35220037
         MODESET KEYADDR=DXUKEY,WORKREG=1 CALLER'S KEY           Y02082 35250002
*                                                                       35400021
         OI    DCBCIND2,DCBC2FEO        TURN ON FEOV BIT        SA52460 35450021
         TM    DCBMACRF+K1,K20          DCB USING LOCATE MODE           35600021
         BZ    EIN03650                 YES BRANCH                      35800021
         TM    DEBOPATB,DEBOPUPD        OPEN FOR UPDATE?         Y02134 36000302
         BNO   EIN03900                 IF NOT, BRANCH                  36200021
         TM    DEBOPATB,K15-DEBOPUPD    MAYBE--TEST FURTHUR      Y02134 36200302
         BNZ   EIN03900                 NOT, BRANCH                     36600021
         EJECT                                                          36800002
EIN03650 EQU   *                        LOCATE MODE/UPDATE       M0189  37000002
         LR    R1,RDCB                  GET DCB ADDESS IN PROPER REG    37200021
*                                                                       37400021
         BAL   RET,EIN05150             GET PTR TO FEOV SVRB     M0189  37500021
         USING RBSECT,RF                                         M0189  37508021
         MODESET EXTKEY=SUPR            SVRB KEY                 Y02082 37510002
         STM   R2,RC,RBEXSAVE           SAVE REGS 2-12 IN SVRB   M0189  37516021
*                                       EXTENDED SAVE AREA              37524021
         MODESET KEYADDR=DXUKEY,WORKREG=2  ASSUME CALLERS KEY    Y02082 37524202
         CLI   DXUKEY,X80               IS CALLER IN SYSTEM KEY  Y02082 37525002
         BNL   EIN03670                 BRANCH IF NO             Y02082 37526002
         LM    R2,R8,RBGRS2             RESTORE USER REGS 2-8    Y02082 37528002
         L     RF,DCBPUT-IHADCB(,R1)    GET ADDR OF PUT ROUTINE  Y02082 37529002
         BALR  RET,RF                   LINK TO PUT ROUTINE      Y02082 37530002
         BALR  RET,0                    ESTABLISH ADDRESSABILITY Y02082 37531002
         USING *,RET                    BASE FOR NEXT BRANCH     Y02080 37531402
         B     EIN03680                 BRANCH TO RESTORE REGS   Y02082 37532002
         DROP  RET                      BASE NOT NEEDED          Y02080 37532102
EIN03670 EQU   *                        SETUP FOR SYNCH          Y02082 37532202
         LM    R2,R8,RBGRS2             RESTORE USER REGS 2-8    M0189  37534002
         DROP  RBASE                                             M0189  37540021
*                                       THIS IS NECESSARY IN CASE       37548021
*                                       THE ACCESS METHOD ROUTINES      37556021
*                                       ISSUE EOV, SO THAT EOV          37564021
*                                       CAN FIND THE USER REGS          37572021
         DROP  RF                                                M0189  37588021
         L     RF,DCBPUT-IHADCB(,R1)    GET ADDR OF PUT ROUTINE  Y02082 37589002
         SYNCH (15)                     LINK TO PUT IN PP STATE  M0189  37600021
         EJECT                                                          37600402
EIN03680 EQU   *                        RETURN FROM PUT ROUTINE  Y02082 37601002
         BALR  RET,0                    ESTABLISH ADDRESSABILITY        37660000
         USING *,RET                    BASE FOR NEXT BRANCH     Y02080 37670002
         BAL   RET,EIN05150             GET SVRB PTR             M0189  37700002
         DROP  RET                      BASE NOT NEEDED          Y02080 37702002
*                                       RET IS USED AS BASE REG         37709021
*                                       FOR THIS INSTRUCTION BECAUSE    37718021
*                                       UPON RETURN FROM SYNCH,         37727021
*                                       IT IS POINTING HERE AND RBASE   37736021
*                                       HAS NOT BEEN REINITIALIZED      37745021
         USING RBSECT,RF                                         M0189  37754021
         LM    R2,RC,RBEXSAVE           RESTORE REGS 2-12        M0189  37758000
         DROP  RF                                                M0189  37760000
         LR    RET,R1                   SAVE RECORD ADDR         Y01021 37764000
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 37774002
         DEBCHK (RDCB)                  VALIDATE DEB             Y01021 37784002
         LR    RDEB,R1                  LOAD VALID DEB ADDRESS   Y01021 37790000
         LA    R1,DEBBASIC-DEBXTNP      OFFSET TO EXTENSION      Y02134 37794702
         SR    RDEB,R1                  RDEB POINTS TO EXT. ADDR Y02134 37795002
         USING DEBXTNP,RDEB                                      Y02134 37795302
         MVC   DXDEBXAD,DEBXTNP         UPDATE DEB EXT ADDR      Y02134 37795602
         LA    RDEB,DEBBASIC            RELOAD RDEB TO DEB START Y02134 37795902
         USING DEBBASIC,RDEB                                     Y02134 37796202
         MVC   DXUCBADR+K1(L'DXUCBADR-K1),DEBSUCBA+K1 UPDATE UCB        37796602
         USING EIN03200,RBASE                                    M0189  37798000
         LR    R1,RET                   RESTORE RECORD ADDR      Y01021 37802002
         MODESET KEYADDR=DXUKEY,WORKREG=15 CALLER'S KEY          Y02082 37810002
         OI    DCBCIND2,DCBC2FEO        TURN ON FEOV BIT        SA52460 37850021
         TM    DCBRECFM,DCBRECUN        U RECORDS USED                  38000021
         BC    9,EIN03800               YES BRANCH                      38200021
         TM    DCBRECFM,DCBRECF         U OR F RECORDS USED      YM5563 38400037
         BO    EIN03800                 YES BRANCH                      38600021
         LA    R0,K4                    GET CONSTANT OF FOUR            39000021
         SR    R1,R0                    REDUCE RECORD ADDRESS BY FOUR   39200021
         XC    K0(K6,R1),K0(R1)         ZERO LARGE AND SMALL LL FIELDS  39600021
         MVI   K1(R1),K4                STORE LL OF 4 IN BUFFER         39800021
         B     EIN03900                 BR TO BACK UP IOB PTR           40000021
         EJECT                                                          40200002
EIN03700 EQU   *                        TEST FOR FEOV REPOSITIONING     40400002
*        PCI AND FEOV REPOSITIONING ARE MUTUALLY EXCLUSIVE       YM1194 40450002
         TM    DCBCIND2,DCBC2CHN        IS PCI BEING USED        YM1194 40500002
         BO    EIN03750                 BRANCH IF YES-DCBIOBAD   YM1194 40550002
*                                       TEST IS INVALID          YM1194 40560002
         CLC   DCBIOBAD,MASKFLAG        IS THIS REPOSITIONING           40600021
*                                       FEOV                            40800021
         BNE   EIN05100                 YES,REPOSITIONING MODULE        41000021
EIN03750 EQU   *                        NOT FEOV REPOSITIONING   YMRELE 41050002
         OI    DCBCIND2,DCBC2FEO        SET FEOV MODE ON                41200021
         B     EIN03600                 BR TO QSAM CHECK                41400021
*                                                                       41600021
EIN03800 EQU   *                        UPDATE RECAD                    41800002
         ST    R1,DCBRECAD              STORE IN DCB                    42000021
*                                                                       42200021
* MUST BACK UP IOB AS PUT LOCATE WILL ADVANCE IOB TO NEXT. IN THE       42400021
* CASE OF COBOL THEY ARE AHEAD OF THEMSELVES BY ONE PUT LOCATE          42600021
* AND DO NOT WISH TO OUTPUT. THEY STOP PUT LOCATE BY SETTING            42800021
* RECAD TO START OF BUFFER WHICH CAUSES PUT TO FIND A RECORD            43000021
* LENGTH OF ZERO AND RETURN WITHOUT ADVANCING THE IOB ADDRESS.          43200021
*                                                                       43400021
EIN03900 EQU   *                        GET IOBS                        43600002
         L     RC,DCBIOBA               GET ADDR OF IOB PAST THE        44000021
*                                       LAST ONE SCHEDULED FOR          44200021
*                                        SIMPLE-PUT-MOVE-VARIABLE       44400021
         LA    RC,K0(RC)                                                44600021
         LR    R7,RC                    SAVE IOBA                       44800021
         LR    RET,RC                   SAVE IOBA                       45000021
*                                                                       45200021
EIN04000 EQU   *                        TEST FOR COMPLETE               45400002
         L     R7,K0(R7)                GET NEXT IOB                    45800021
         LA    R7,K0(R7)                GET ADDR                        46000021
         TM    K4(R7),ECBCOMPL          IS IOB COMPLETED                46200021
         BO    EIN04100                 YES CHECK IF IN ERROR           46400021
         L     R1,K12(R7)               NO GET ECB ADDRESS              46600021
         WAIT  ECB=(1)                  WAIT ON IOB                     46800021
         EJECT                                                          47000002
EIN04100 EQU   *                        TEST FOR UPDATE                 47200002
         TM    DEBOPATB,DEBOPUPD        OPEN FOR UPDATE?         Y02134 47400302
         BNO   EIN04150                 BR IF NOT               SA53132 47500021
         TM    DEBOPATB,K15-DEBOPUPD    MAYBE--TEST FURTHUR      Y02134 47500302
         BNZ   EIN04150                 BR IF NOT               SA53132 47560021
         SR    R5,R5                    CLEAR REG               SA53132 47570021
         IC    R5,DCBOFFSR              OFFS TO READ CCW        SA53132 47580021
         AR    R5,R7                    ADDR OF READ CCW        SA53132 47590021
         SH    R5,CONST56               END OF WRITE CHAN PGM   SA53132 47592021
         CLI   K16(R5),CCWSTSEC         RPS CHAN PGM?           SA53132 47594037
         BE    EIN04120                 BR IF YES               SA53132 47596021
         AH    R5,CONST8                ADJUST FOR NON-RPS PGM  SA53132 47598021
* THE PUT MODULE IGG019AE TURNED OFF THE COMMAND CHAIN BIT TO   SA53132 47598421
* PREVENT READING AFTER FEOV WAS ISSUED.IT MUST BE RESTORED NOW.SA53132 47598821
EIN04120 OI    K4(R5),CCWCMDCH          TURN ON COMM CHAIN BIT  SA53132 47599237
EIN04150 EQU   *                        NOT UPDATE              SA53132 47599602
         CR    R7,RC                    IS THE NEXT IOB = IOBA          48000021
         BE    EIN04154                 YES,TEST COMPLETION      YM5563 48200002
         LR    RET,R7                   SAVE THIS IOB BEFORE NEXT       48400021
*                                        IS OBTAINED                    48600021
         B     EIN04000                 GO TRY AGAIN                    48800021
*                                                                       49000021
EIN04154 EQU   *                        TEST FOR COMPLETION     YM5563  49050002
         CLI   K4(RC),ECBCOD7F          IOBA IN ERROR?          YM5563  49100002
         BE    EIN04155                 NO, TEST PREVIOUS IOB   YM5563  49150002
         LR    RET,RC                   SET IOB TO PREVIOUS     YM5563  49160002
EIN04155 EQU   *                        TEST PREVIOUS IOB       YM5563  49170002
         CLI   K4(RET),ECBCOD7F         PREVIOUS IOB IN ERROR?  YM5563  49180002
         BE    EIN04200                 NO, ALL DONE            YM5563  49190002
         CR    RET,RC                   TEST IF IOB HAS BEEN    YM5563 C49192002
                                        BACKED UP               YM5563  49196002
         BE    EIN04156                 BRANCH IF NO            YM5563  49198002
         MODESET EXTKEY=DATAMGT         GET IN D.M. KEY         YM3150  49198102
         MVI   DXCCW1,ECBCOD7F          SET INDICATOR           YM5563  49198402
         MODESET KEYADDR=DXUKEY,WORKREG=7 RETURN TO CALLER KEY  YM3150  49198502
EIN04156 EQU   *                        IOB NOT BACKED UP       YM5563  49198802
         IC    R7,DCBIOBA               GET HIGH ORDER BYTE     YM5563  49199202
         SLL   R7,K24                   SHIFT TO HIGH BYTE      YM5563  49199602
         OR    RET,R7                   PUT INTO REG 14         YM5563  49199702
         ST    RET,DCBIOBA              SET DCBIOBA TO THE      YM5563 C49199802
                                        CORRECT IOB             YM5563  49249802
         LA    RET,K0(RET)              CLEAR  HIGH ORDER BYTE  YM5563  49299802
         LR    RC,RET                   INITIALIZE REGISTER     YM5563  49309802
         LR    R7,RC                    SAVE IOB                YM5563  49319802
EIN04157 EQU   *                        SEARCH IOB'S            YM5563  49329802
         L     R7,K0(R7)                GET NEXT IOB            YM5563  49339802
         LA    R7,K0(R7)                GET ADDRESS             YM5563  49341802
         CLI   K4(R7),ECBCOD7F          IS IOB IN ERROR         YM5563  49343802
         BNE   EIN04400                 YES GO TO ERROR ROUTINE YM5563  49345802
         LR    RET,R7                   SAVE PREVIOUS IOB       YM5563  49347802
         B     EIN04157                 LOOP TO FIND ERROR      YM5563  49348202
         EJECT                                                          49348602
EIN04200 EQU   *                        TEST FOR UPDATE                 49349802
         L     RC,DCBIOBA               BE SURE RB HAS CURRENT IOB ADDR 49400021
         L     RDEB,DCBDEBAD            LOAD DEB ADDR            Y02082 49750002
*                                                                       49800021
         TM    DEBOPATB,DEBOPUPD        OPEN FOR UPDATE?         Y02134 49800302
         BNO   EIN04300                 IF NOT, BRANCH.                 50200021
         TM    DEBOPATB,K15-DEBOPUPD    MAYBE--TEST FURTHUR      Y02134 50200302
         BZ    EIN04600                 YES, BRANCH                     50600021
*                                                                       50800021
EIN04300 EQU   *                        DSAB OUTPUT ENTERS HERE         51000002
         ST    RC,K4(K0,RC)             SET ADDRESS OF THIS IOB FOR EOV 51400021
*                                       IT WILL NOT RESCHEDULE ANY FOR  51600021
*                                       OUTPUT DATA SET AFTER FEOV.     51800021
         MVI   K4(RC),ECBCOD7F          SET THIS IOB COMPLETE, NO ERROR 52000021
         B     EIN05100                 GO LINK TO EOV.                 52400021
         EJECT                                                          52450002
EIN04400 EQU   *                        ENTER ERROR CHECKING ROUTINE    52600002
*                                                                       52800021
*              FIND THE ERROR IOB AND GO TO THE ERROR ROUTINE WITH THE  53000021
*              ADDRESS OF THE IOB PREVIOUS TO IT                        53200021
*                                                                       53400021
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 53450002
         STM   R0,RF,K8(RCORE)          SAVE ALL REGS                   53700021
         MODESET EXTKEY=SUPR            SVRB KEY                 Y02082 53750002
*                                                                       54000021
         LR    R1,RDCB                  STORE DCB IN PROPER REG 1       54600021
         LR    R0,RET                   SAVE IOB ADDR            M0189  54800021
         BAL   RET,EIN05150             GET PTR TO FEOV SVRB     M0189  54820021
         USING RBSECT,RF                                         M0189  54840021
*                                       REGS 2-8 BEFORE SYNCHING        54860021
         STM   R2,RC,RBEXSAVE           SAVE REGS 2-12 IN SVRB   M0189  54880021
*                                       EXTENDED SAVE AREA              54900021
         MODESET KEYADDR=DXUKEY,WORKREG=9 CALLER'S KEY           Y02082 54970002
         MVC   K28(K44,RD),RBGRSAVE     MOVE USER REGS 0-8 TO    M0189  54980021
*                                       SAVE AREA PASSED TO SAM         55000021
*                                       SO THAT IF SAM ISSUES           55020021
*                                       EOV, THE RIGHT REGS WILL        55040021
*                                       BE SWAPPED                      55060021
         LM    R9,RD,RBGRS9             RESTORE USERS REGS 9-13 SA57952 55070000
*                                       SO THAT IF SAM ISSUES EOV       55072000
*                                       AND A SYNAD EXIT IS TAKEN       55074000
*                                       THE USER WILL RECEIVE HIS       55076000
*                                       REGS                            55078000
         DROP  RF                                                M0189  55080021
         L     RF,DCBPERR-IHADCB(,R1)   GET PUT ERR RTN ADDR     M0189  55100021
         EJECT                                                          55102002
         CLI   DXUKEY,X80               IS CALLER IN USER KEY    Y02082 55110002
         BNL   EIN04540                 BRANCH IF YES            Y02082 55120002
         LR    RBASE,R0                 PUT IOB ADDR IN PROPER   Y02082 55130002
*                                       REGISTER                 Y02082 55140002
         DROP  RBASE                                             Y02082 55142002
         BALR  RET,RF                   BRANCH TO PUT ERROR RTN  Y02082 55150002
         BALR  RET,0                    ESTABLISH ADDRESSABILITY Y02082 55160002
         USING *,RET                    BASE FOR NEXT BAL        Y02080 55162002
         B     EIN04560                 BRANCH TO RESTORE REGS   Y02082 55170002
         DROP  RET                      BASE NOT NEEDED          Y02080 55170402
EIN04540 EQU   *                        SYNCH                    Y02082 55180002
         USING EIN03200,RBASE                                    Y02082 55190002
         MODESET EXTKEY=SUPR            SYSTEM KEY FOR SYNCH     Y02082 55310002
         LR    RBASE,R0                 PUT IOB ADDR IN PROPER   Y02082 55320002
*                                       REGISTER                 Y02082 55330002
         DROP  RBASE                                             Y02082 55340002
         SYNCH (15)                     LINK TO PERR IN PP STATE        55350000
*                                                                       55400021
*          AT THIS POINT CONTROL GOES TO THE PUT ERROR ROUTINE          55600021
*        TO DETERMINE THE CAUSE OF THE EXCEPTIONAL CONDITION.  IF MORE  55800021
*        SPACE IS REQUIRED, THE VOLUME SWITCHING ROUTINES GET CONTROL.  56000021
*        CONTROL WILL RETURN FROM THE PUT ERROR ROUTINE WHEN ALL        56200021
*        OUTSTANDING REQUESTS HAVE BEEN RESCHEDULED.  IF THE            56400021
*        USER GETS A SYNAD ENTRY, THIS ROUTINE MAY NOT                  56600021
*        REGAIN CONTROL.                                                56800021
         EJECT                                                          57000002
EIN04560 EQU   *                        RETURN FROM PERR         Y02082 57200002
         BALR  RET,0                    ESTABLISH ADDRESSABILITY        57300000
         USING *,RET                    BASE FOR NEXT BAL        Y02080 57350002
         BAL   RET,EIN05150             GET SVRB PTR             M0189  57400002
*                                       RET IS USED AS BASE REG         57420021
*                                       FOR THIS INSTRUCTION BECAUSE    57440021
*                                       UPON RETURN FROM SYNCH,         57460021
*                                       IT IS POINTING HERE AND RBASE   57480021
*                                       HAS NOT BEEN REINITIALIZED      57500021
         DROP  RET                      BASE NOT NEEDED          Y02080 57502002
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 57510002
         USING RBSECT,RF                                         M0189  57520021
         L     RCORE,RBEXSAVE+K4*(R4-R2) RESTORE REG 4          SA54463 57530002
         LM    R0,RF,K8(RCORE)          RESTORE ALL REGS        SA54463 57540000
         DROP  RF                                                M0189  57550000
         DEBCHK (RDCB)                  VERIFY DEB               Y01021 57560100
         LR    RDEB,R1                  LOAD VERIFIED DEB        Y01021 57580100
         LA    R1,DEBBASIC-DEBXTNP      OFFSET TO EXTENSION      Y02134 57592302
         SR    RDEB,R1                  RDEB POINTS TO EXT. ADDR Y02134 57592602
         USING DEBXTNP,RDEB                                      Y02134 57592902
         MVC   DXDEBXAD,DEBXTNP         UPDATE DEB EXT ADDR      Y02134 57593202
         LA    RDEB,DEBBASIC            RELOAD RDEB TO DEB START Y02134 57593502
         USING DEBBASIC,RDEB                                     Y02134 57593802
         MVC   DXUCBADR+K1(L'DXUCBADR-K1),DEBSUCBA+K1 UPDATE UCB        57595802
         USING EIN03200,RBASE                                    M0189  57596000
         LR    R7,RET                   LOAD PREVIOUS IOB       SA54463 57600000
         MODESET KEYADDR=DXUKEY,WORKREG=1 CALLER'S KEY           Y02082 57650002
         MVC   DCBIOBA+K1(K3),K50+K7(RCORE) MOVE IOB ADDR FROM  SA54463 57800002
*                                       SAVE AREA TO DCB        SA54463 57900000
         CLI   DXCCW1,ECBCOD7F          TEST IF BACK UP SW SET  YM5563  57950002
         BNE   EIN04000                 BRANCH IF NOT SET       YM5563  58000002
         L     R1,DCBIOBA               GET IOBA ADDRESS        YM5563  58100002
         MVC   DCBIOBA+K1(K3),K1(R1)    SET IOBA TO NEXT        YM5563  58150002
         MODESET EXTKEY=DATAMGT         SWITCH TO DATAMGT KEY    YM3874 58155002
         MVI   DXCCW1,K0                CLEAR INDICATOR         YM5563  58160002
         MODESET KEYADDR=DXUKEY,WORKREG=1  RTN TO CALLER'S KEY   YM3874 58165002
         B     EIN03900                 CHECK IOB'S ON QUEUE    YM5563  58170002
         EJECT                                                          58200002
EIN04600 EQU   *                        SIMULATE END OF BUFFER          58600002
         MVC   DCBRECAD+K1(K3),DCBEOBAD+K1  SIMULATE EOB CONDITION      58800021
*                                                                       59000021
*  THIS WILL CAUSE THE UPDATE GET ROUTINE TO SCHEDULE THE LAST          59200021
*    REMAINING IOB BEFORE GIVING THE USER THE FIRST RECORD ON THE NEW   59400021
*     VOLUME                                                            59600021
*                                                                       59800021
         SR    RPAR,RPAR                CLEAR REG                       60000021
         SR    RET,RET                  CLEAR REG                       60200021
         IC    RPAR,DCBWCPO             GET WRITE CHANNEL PROG. OFFSET  60400021
         IC    RET,DCBWCPL              GET WRITE CHANNEL PROG. LENGTH  60600021
         SLL   RET,K3                   CHANGE DB WDS TO BYTES          60800021
         LA    RPAR,K8(RPAR,RET)        COMBINE AND ADD 8 TO POINT      61000021
*                                         TO THE CP READ SEQUENCE       61200021
*                                                                       61400021
* RC HAS ADDRESS OF CURRENT IOB                                         61600021
*                                                                       61800021
         LA    RC,K0(RC)                CLEAR HI BYTE FOR COMPARISON.   62000021
         LR    R8,RC                    COPY ADDR FOR IOB MOD LOOP      62200021
*                                                                       62400021
EIN04700 EQU   *                        UPDATE IOB                      62600002
         AR    RPAR,R8                  ADD IOB ADDR TO RD CP OFFSET    62800021
         ST    RPAR,K24(R8)             PLACE IN CHANNEL POINTER        63000021
         OI    K0(R8),IOBREAD           TURN ON ONLY READ FLAG          63200021
*                                                                       63400021
         SR    RPAR,R8                  RETURN R5 TO RD CP OFFSET       63600021
*                                                                       63800021
         L     R8,K0(R8)                LINK TO NEXT IOB                64000021
         LA    R8,K0(R8)                CLEAR HI BYTE FOR COMPARISON.   64200021
         CR    R8,RC                    WAS THIS IOB SET TO READ        64400021
         BE    EIN04300                 YES, BRANCH.                    64600021
         B     EIN04700                 NO                              64800021
         EJECT                                                          65000002
*  PURGE ALL INPUT I/O.  (IF BASM, ALL READS AND WRITES ARE SUPPOSED    65050037
*  TO HAVE ALREADY BEEN CHECKED.)                                       65100037
*                                                                       65200037
EIN04800 EQU   *                        INPUT ENTERS HERE               65400002
*        PURGE OPTIONS ARE -                                            65600037
*          1 = PURGE REQUESTS ASSOCIATED WITH THIS DEB ONLY,            65800037
*          1 = POST THE PURGED IOB'S,                          @ZA02215 66000037
*          0 = ALLOW ACTIVE I/O TO QUIESCE,                    @ZA02215 66200037
*          0 = PURGE ALL REQUESTS,                             @ZA02215 66400037
*          0 = NORMAL PURGE (NOT TCB LIST),                             66600037
*          0 = PURGE ALL QUEUES,                                        66800037
*          0 = PURGE BY DEB.                                            67000037
*                                                                       67400021
* SINCE A RESTORE IS NEVER DONE FOR TAPE DEVICES, WE WILL               67450037
* WAIT ON THE USERS IOB INSTEAD OF DOING A PURGE QUIESCE.               67455037
* WE ENTER HERE IN USERS KEY.                                           67460037
         TM    DCBDEVT,DCBDEVTP         IS IT TAPE             @ZA30750 67465037
         BZ    EIN04808                 BRANCH NO              @ZA30750 67470037
         TM    DCBCIND2,DCBC2CHN        CHAINED SCHEDULING     @ZA30750 67475037
         BNO   EIN04801                 BRANCH NO              @ZA30750 67480037
         L     RC,DCBIOBAD              GET CH SCHED IOB       @ZA30750 67485037
         LA    RC,0(RC)                 CLEAR HI BYTE          @ZA30750 67490037
         L     R1,K20(RC)               GET CH SCHED ECB       @ZA30750 67495037
         TM    0(R1),ECBPOST            IOB POSTED             @ZA30750 67500037
         BO    EIN04807                 YES CONTINUE           @ZA30750 67505037
         WAIT  ECB=(1)                  WAIT ON LIST           @ZA30750 67510037
         B     EIN04809                 CONTINUE               @ZA30750 67515037
EIN04801 L     RC,DCBIOBA               GET NORMAL IOB         @ZA30750 67520037
         LA    RC,0(RC)                 CLEAR HI BYTE          @ZA30750 67525037
         LR    RF,RC                    SAVE FOR COMPARE       @ZA30750 67530037
EIN04802 L     R1,K12(RC)               GET NORMAL ECB         @ZA30750 67535037
         TM    0(R1),ECBPOST            ECB POSED              @ZA30750 67540037
         BO    EIN04803                 YES CONTINUE           @ZA30750 67545037
         WAIT  ECB=(1)                  WAIT                   @ZA30750 67550037
EIN04803 L     RC,0(RC)                 GET NEXT IOB ADDR      @ZA30750 67555037
         LA    RC,0(RC)                 CLEAR HI BYTE          @ZA30750 67560037
         CR    RC,RF                    LAST IOB               @ZA30750 67565037
         BE    EIN04809                 YES CONTINUE           @ZA30750 67570037
         B     EIN04802                 TEST FOR COMPLETION    @ZA30750 67575037
EIN04808 MODESET EXTKEY=DATAMGT         DM KEY                 @ZA30750 67580037
         ST    RDEB,0(RCORE)            STORE DEB ADDRESS               67600021
         MVI   0(RCORE),X'C0'           OPTIONS TO PURGE WITH  @ZA02215 67800037
         XC    K4(K4,RCORE),K4(RCORE)   ZERO TCB ADDR / ECB FIELD       68000037
         LA    R0,DEBUSRPG              GET CHAINING ADDRESS     Y02134 68200002
         ST    R0,K8(RCORE)             STORE FOR PURGE                 68400021
*                                                                       69000021
         PURGE (RCORE)                  ISSUE PURGE SVC                 69400037
*                                                                       70200021
         WAIT  ECB=K4(RCORE)            WAIT FOR PURGE POST COMPLETE    70400037
*                                                                       71400021
EIN04807 MODESET KEYADDR=DXUKEY,WORKREG=1 CALLER'S KEY           Y02082 71450037
         ST    RC,K4(,RC)               PUT ADDR OF FIRST IOB TO BE     71600037
*                                       RESCHEDULED INTO ECB OF CURRENT 71800021
*                                       IOB, WHICH WILL BE THE LAST IOB 72000021
*                                       RESCHEDULED.                    72200021
*                                                                       72220037
*  TEST IF A TAPE MARK WAS ENCOUNTERED BY AN UNCHECKED QSAM GET,        72240037
*  BECAUSE THIS AFFECTS THE DISPOSITION POSITIONING OF THE TAPE.        72260037
*  THE PRIOR PURGE MUST BE QUIESCE AND POST SO THAT THIS TEST CAN       72280037
*  BE MADE.                                                    @ZA02215 72300037
*                                                                       72400021
EIN04809 TM    DCBIFLGS,DCBIFPIO        ERRORS ASSC WITH INPUT          72600037
         BNO   EIN05100                 NO BRANCH                       72800021
         TM    DCBCIND2,DCBC2QSM        IS DCB QSAM            @ZA02215 72810037
         BZ    EIN05100                 BR IF NO               @ZA02215 72820037
         TM    DEBOPATB,DEBOPOUT        WAS OPEN FOR INPUT     @ZA02215 72830037
         BNZ   EIN05100                 BR IF NO               @ZA02215 72840037
         L     RUCB,DEBSUCBA            GET UCB ADDRESS        @ZA02215 72850037
         CLI   UCBTBYT3,UCB3TAPE        IS THIS MAGNETIC TAPE  @ZA02215 72860037
         BNE   EIN05100                 BR IF NO               @ZA02215 72870037
*                                                                       73000037
         LR    RF,RC                    SAVE IOB ADDRESS       @ZA02215 73050037
*                                                                       73100037
EIN04900 EQU   *                        SKIP THROUGH IOBS        Y02082 73200002
         TM    K20(RC),CSWUNITX         TAPE MARK INDICATION     Y02082 73250002
         BO    EIN05000                 YES BRANCH                      73400021
*                                                                       73600021
         L     RC,0(,RC)                GET NEXT IOB           @ZA02215 73650037
         LA    RC,0(,RC)                CLEAR HI BYTE          @ZA02215 73700037
*                                                                       73750037
         CR    RF,RC                    ARE IOB ADDRS THE SAME @ZA02215 73800037
         BNE   EIN04900                 BR NO TO TEST NEXT IOB @ZA02215 74000037
         B     EIN05100                 BR TO NEXT FUNCTION    @ZA02215 74200037
*                                                                       75000037
EIN05000 EQU   *                        SET TAPE MARK READ BIT          75400002
         OI    DCBOFLGS,DCBOEOF         SET CONDITION FOR END OF VOLUME 76000037
         EJECT                                                          76100037
*                                                                       76200021
*  FREEMAIN 72 BYTE USER SAVE AREA USED FOR SAM PUT ROUTINES            76250037
*                                                                       76300037
EIN05100 EQU   *                        FREE SAVE AREA                  76400002
         LR    R1,RD                                                    76660021
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 76710002
         SR    RD,RD                    SR FOR IC                Y02082 76780002
         IC    RD,DXUKEY                KEY OF CORE TO FREE      Y02082 76790002
         SRL   RD,K4                    PUT KEY IN LOW 4 BITS    Y02082 76792002
         IECRES FREE,A=(1),LV=72,KEY=(RD),PREFIX=NO,             Y02082*76794002
               STM=(0,14,DXXPREFX)      FREE USER SAVE AREA      Y02082 76796002
         EJECT                                                          76798002
*                                                                       76798402
*        SET UP COMMUNICATION BIT FOR THE END OF VOLUME ROUTINES        76800021
*                                                                       77000021
         MODESET KEYADDR=DXUKEY,WORKREG=15 USER KEY              YM1303 77050002
         OI    DCBCIND2,DCBC2FEO        SET INDIC FOR NEXT EXEC EOV     77600021
         L     RDEB,DCBDEBAD            LOAD DEB ADDR            YM1303 77610002
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 77650002
*                                                                       77800021
         L     RUCB,DEBSUCBA            GET UCB ADDRESS          YM1303 77810002
         MVC   DXXMODID,MOD0Z3A         MOVE IN NAME             A48604 77840021
         MVC   DXXMODEP+K1(K3),MOD0Z3A+K2 AND TTR TO XCTL AREA   Y02080 77880002
*                                                                       77920021
EIN05120 EQU   *                        GET READY TO XCTL        A48604 77960002
         ST    R0,DXWORK1               SAVE R0 FROM IECRES CALL YM1320 77962002
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY IF NEED Y02082 77970002
         IECRES INIT,DCBCOPY=TOWKAR,PREFIX=DXXPREFX,             Y02082*77980002
               STM=(3,14,DXXPREFX)      PASS NEXT MOD COPIED DCB Y02082 77990002
         EJECT                                                          77990102
         L     R0,DXWORK1               REFRESH R0               YM1320 77990402
         CLI   DXWCOPYE,K0              WAS COPY OK              Y02082 77992002
         BE    EIN05130                 BRANCH IF YES            Y02082 77994002
         CLC   DXXMODID,ABEND2Z         GOING TO PROBLEM DET     Y02082 77996002
         BNE   EIN03460                 EXIT IF NO               Y02082 77998002
EIN05130 EQU   *                        SET FIRST LOAD BIT       Y02082 77998402
         CLC   DXXMODID,MOD0Z3A         GOING TO IFG0551F        Y02144 77999402
         BNE   EIN05140                 BR IF NO                 Y02144 77999602
         L     RF,DXATCOM3              GET RRPLIST PTR          Y02144 77999802
         USING RRPLIST,RF                                        Y02144 77999902
         OI    RRFLAGS2,RRFFIN1         SET 1ST LOAD COMPLETED   Y02144 78000002
         DROP  RF                                                Y02144 78000202
EIN05140 EQU   *                        TRANSFER CONTROL         Y02144 78000902
         MVC   DXXATTRB(K7),XCTLCN3A    SET UP FOR XCTL                 78001902
         MVC   DXXMODNM(K6),IGG3A       BASIC EOV MODULE NAME           78200002
         XR    RET,RET                  ZERO BRANCH REG          X02989 78362002
         LA    RWTG,DXXMODNM            GET ADDR OF MOD NAME     A48604 78400021
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               Y02134 79050002
         EJECT                                                          79100002
EIN05150 EQU   *                        GET SVRB ADDRESS         M0189  79220002
*                                                                       79230002
*        SUBROUTINE TO LOAD CURRENT SVRB ADDRESS INTO RF.               79232002
*        RETURN IS ON RET.                                              79234002
*                                                                       79236002
         L     RF,CVTPTR                ADDRESS OF CVT           Y02134 79240002
         L     RF,CVTTCBP-CVT(,RF)      TCB VECTORS              Y02134 79290002
         L     RF,K4(,RF)               CURRENT TCB ADDRESS      Y02134 79292002
         L     RF,TCBRBP-TCB(,RF)       PTR TO FEOV RB           M0189  79300021
         BR    RET                      RETURN TO CALLER         M0189  79320021
*                                                                       79350037
BRCODE   DS    0H                       TRUNC CALL               M0189  79370002
*                                                                       79400021
*        CALLING SEQUENCE TO ENTER TRUNC ROUTINE                        79450002
*                                                                       79452002
         L     RF,DCBPUT-IHADCB(,R1)    PUT ADDR FROM DCB        M0189  79460002
         USING PUTDSECT,RF              USING TO ENTER TRUNC     Y02080 79510002
         B     TRUNCRTN                 BRANCH TO TRUNC          M0189  79530002
         DROP  RF                       RF NOT NEEDED            Y02080 79540002
         SPACE 2                                                        79542002
EIN05160 EQU   *                        CALLER ENQED ON TIOT EXC YM3185 79550002
*                                                                       79552002
*   THE CALLER OF FEOV HOLDS THE TIOT RESOURSE EXCLUSIVELY.    @ZA29752 79554037
*   THIS SHOULD NEVER VALIDLY HAPPEN AND CANNOT BE ALLOWED.    @ZA29752 79556037
*                                                                       79558037
         SR    RF,RF                    ZERO REG               @ZA29752 79560037
         SR    RC,RC                    ZERO REG               @ZA29752 79562037
         LA    RF,K20                   RETURN CODE            @ZA29752 79564037
         L     RC,ABND50D               ABEND CODE             @ZA29752 79566037
         ABEND (RC),DUMP                                       @ZA29752 79568037
         EJECT                                                          79580002
*                                                                       79585037
*********************************************************************** 79590037
*                                                                       79595037
*        CONSTANTS                                                      79596037
*                                                                       79597037
ABND50D  DS    0F                                              @ZA29752 79598037
         DC    XL4'0000050D'                                   @ZA29752 79599037
IGG3A    DC    C'IFG055'                1ST 6 CHAR OF MOD NAME          79600021
MASKFLAG DC    F'1'                     MASK FOR IOBAD                  79800021
CONST8   DC    H'8'                     CONSTANT 8              SA53132 79850021
CONST56  DC    H'56'                    CONSTANT 56             SA53132 79900021
XCTLCN3A DC    X'C378'                  XCTL ATTR.-REENT.,REUSEABLE     80400021
*                                         NOT IN OV'LAY,NOT TEST,NOT    80600021
*                                         ONLY LOADABLE,BLOCK FORMAT,   80800021
*                                         EXECUTABLE,1 TEXT,COMPAT.,    81000021
*                                         ORIGIN AT 0,ENTRY PT.0,NO RLD 81200021
*                                         NO ESD,NO SYMBOL CARDS        81400021
         DC    X'0004000400'            TOTAL LENGTH  TEXT LENGTH       81600021
         DC    X'000000'                LENGTH OF WTG TABLE             81800021
SUBSYSAM DEBCHK AM=SUBSYS,MF=L          SUBSYSTEM ACCESS METHOD  Y02120*81810002
                                        TYPE IN DEBAMTYP         Y02120 81820002
         EJECT                                                          81870002
XCTLTA3A XCTLTABL  ID=(ABEND2Z,0P,MOD0Z3A,1F,FEOV,IGC0003A,      Y02080X82050002
               ABCD0P,0P),                                       Y02083X82052002
               SVC=055,BRT=YES,LENGTH=                           Y02080 82060002
         EJECT                                                          82110002
         IECDSECS DCB,ACB,UCB,IEZDEB,MAIN,CVT,TCB,WTG,PREFX,     Y02134*82200002
               TIOT,DSAB,                                        Y02083X82210037
               RB,RRPL,EXPAND=YES                                Y02144 82250002
PUTDSECT DSECT ,                        DSECT FOR TRUNC RTN      Y02080 82260002
         DS    F                        PUT ROUTINE              Y02080 82270002
         DS    F                        PUTX ROUTINE             Y02080 82280002
TRUNCRTN DS    F                        TRUNC ROUTINE            Y02080 82290002
         EJECT                                                          82300002
         IECEQU AOS=YES,IEZDEB=YES                               Y02134 82400002
         END                                                            82600021
./  ADD  SSI=81140196,NAME=IGC0005E
         TITLE 'IGC0005E BASIC EOV RTN'                          S21940 00100002
IGC0005E CSECT                                                          00400002
*********************************************************************** 00450002
*                                                                     * 00500002
*                  VS2-037 ADD/DEL/CH                                 * 00503037
*A486050-486750,A487930-487960                                 @ZA29752 00506037
*                                                                     * 00510002
*        VS2 RELEASE 02 DELETIONS                                     * 00520002
*        VS2 RELEASE 03 DELETIONS                                     * 00522102
*0000                                                           ZA00004 00524002
*0000359135,359583                                              ZA00113 00524102
*0000213920-213940                                              ZA00621 00526102
*0000211500,398020-399420                                       ZA02545 00526902
*0000393600                                                    @ZM33366 00528903
*        VS2 RELEASE 04 DELETIONS                                     * 00529337
*0000502000                                                    @ZA02977 00529737
*0000265000-267000                                             @ZA03655 00529837
*                                                                     * 00530002
*                                                                     * 00540002
*********************************************************************** 00542002
*                                                                     * 00544002
* MODULE NAME = IGC0005E (OS/VS2)                                     * 00550002
*                                                                     * 00600002
* DESCRIPTIVE NAME = BASIC EOV ROUTINE                                * 00650002
*                                                                     * 00700002
* COPYRIGHT = NONE                                                    * 00750002
*                                                                     * 00800002
* STATUS = RELEASE 2, LEVEL 0                                         * 00850002
*                                                                     * 00860002
* FUNCTION =                                                          * 00860402
*        THIS MODULE WILL BE THE FIRST LOAD OF THE EOV ROUTINES       * 00860502
*        WHEN THE EOV (SVC 55) MACRO IS ISSUED.                       * 00877202
*                                                                     * 00887202
*        1) IF REGISTER 0 CONTAINS X'1000' IN ITS LOW ORDER TWO BYTES * 00889202
*        A DCB ADDRESS IS PASSED IN REGISTER 1. AN EOV WORKAREA IS    * 00891202
*        OBTAINED AND INITIALIZED, AND 1A OR 1B BELOW IS PERFORMED.   * 00893202
*        1A) IF THE DSORG IS ISAM OR BDAM, MESSAGE 'IEC020I NO ERROR  * 00893602
*        HANDLING, (SYNAD), EXIT SPECIFIED' IS MOVED TO THE WORKAREA  * 00893702
*        AND MODULE IFG0551D IS GIVEN CONTROL TO WRITE THE MESSAGE    * 00893802
*        AND ISSUE A SYSTEM 001 ABEND.                                * 00899402
*        1B) IF DSORG IS NOT ISAM OR BDAM, MODULE IFG0551B IS GIVEN   * 00901402
*        CONTROL WITH REGISTER 7 SET TO AN ENTRY CODE OF 20. IT WILL  * 00903402
*        MOVE MESSAGE 'IEC020I DCB EROPT=ABE OR AN INVALID CODE       * 00903802
*        AND/OR NO SYNAD EXIT SPECIFIED' IN THE EOV WORKAREA AND      * 00904202
*        GIVE CONTROL TO IFG0551D WHICH WILL WRITE THE MESSAGE        * 00904602
*        AND ISSUE A SYSTEM 001 ABEND.                                * 00904702
*                                                                     * 00904802
*        2) IF REGISTER 1 IS NEGATIVE, IT WILL CONTAIN A NEGATED DCB  * 00904902
*        ADDRESS AND AN INTERNAL ABEND CODE WILL BE IN REGISTER 0.    * 00918802
*        AN EOV WORKAREA WILL BE OBTAINED AND INITIALIZED, A DCB      * 00928802
*        COPY WILL BE OBTAINED, AND PROBLEM DETERMINATION MODULE      * 00930802
*        IFG0550P WILL BE GIVEN CONTROL PASSING IT THE INTERNAL       * 00931202
*        ABEND CODE FROM REGISTER 0.                                  * 00931602
         EJECT                                                          00932002
*        3) IF NEITHER CONDITION 1 NOR 2 IS TRUE AND REGISTER 1       * 00932402
*        POINTS TO AN AMB, THEN VSAM EOV PROCESSING IS INDICATED. THE * 00932502
*        AMB IS IN PROTECT KEY ZERO CORE AND FETCH PROTECTED, EVEN    * 00932602
*        THOUGH THE PROTECT KEY OF THE CALLER OF SVC 55 IS NOT IN KEY * 00932702
*        ZERO. AN EOV WORKAREA IS OBTAINED AND INITIALIZED, AND MODULE* 00937302
*        IFG0551F IS GIVEN CONTROL WITH REGISTER 14 CONTAINING AN     * 00939302
*        ENTRY CODE OF 12. ACBS ARE NOT PROCESSED BY EOV.             * 00941302
*                                                                     * 00941702
*        IF CONDITIONS 1, 2, OR 3, ARE NOT THE CASE, THEN REGISTER 1  * 00941802
*        CONTAINS A DCB ADDRESS. THE DCB IS CHECKED TO ENSURE IT IS   * 00941902
*        OPEN AND THE DEB IS VERIFIED TO POINT BACK TO THE DCB.       * 00942002
*                                                                     * 00946602
*        4) IF REGISTER ONE POINTS TO A DCB FOR A SUBSYSTEM DATA SET  * 00948602
*        AS INDICATED BY THE ACCESS METHOD TYPE IN THE DEB, AN EOV    * 00950602
*        WORKAREA IS OBTAINED AND INITIALIZED, A DCB COPY IS          * 00951002
*        OBTAINED, THE DEB IS DEB VALIDITY CHECKED USING THE DEBCHK   * 00951102
*        MACRO, AND MODULE IFG0551F IS GIVEN CONTROL TO PROCESS END   * 00951202
*        OF DATA OR CONCATENATION FOR THE SEQUENTIAL ACCESS METHOD-   * 00951302
*        SUBSYSTEM INTERFACE.                                         * 00963102
         EJECT                                                          00973102
*        5) IF 1-4 ABOVE IS NOT TRUE, REGISTER 1 POINTS TO AN EXCP,   * 00975102
*        BSAM, QSAM, OR BPAM DCB, AND REGISTER 0 CONTAINS AN          * 00979002
*        IOB ADDRESS IF NOT EXCP. ONE OF THREE CONDITIONS WILL BE     * 00981002
*        DETERMINED BY THIS MODULE.                                   * 00983002
*                                                                     * 00986902
*        5A) AN END OF VOLUME CONDITION IS INDICATED IN THE IOB       * 00988902
*        PASSED IN REGISTER 0 OR ASSUMED IF AN EXCP DCB. THIS WILL    * 00990902
*        RESULT IN TAKING THE END OF DATA EXIT (EITHER IN THIS MODULE * 00994802
*        FOR BPAM OR IN A SUBSEQUENT EOV MODULE), SWITCHING TAPE OR   * 00996802
*        DIRECT ACCESS VOLUMES, OBTAINING MORE DIRECT ACCESS SPACE ON * 00998802
*        THE CURRENT OR NEXT VOLUME, OR PROCESSING                    * 01009102
*        CONCATENATION OF TWO DATA SETS. AN EOV                       * 01019102
*        WORKAREA IS OBTAINED AND INITIALIZED, A DCB COPY             * 01019202
*        IS OBTAINED, THE DEB IS DEB VALIDITY CHECKED USING THE DEBCHK* 01019302
*        MACRO, AND MODULE IFG0551F IS GIVEN CONTROL.                 * 01022702
*                                                                     * 01024702
*        5B) A PERMANENT I/O ERROR IS INDICATED IN THE IOB PASSED IN  * 01025102
*        REGISTER 0. THIS WILL RESULT IN EXITING TO THE SYNAD ERROR   * 01025502
*        ANALYSIS ROUTINE POINTED TO BY DCBSYNAD (BY WAY OF THE       * 01025902
*        ACCESS METHOD, THE CALLER OF SVC 55) EITHER FROM THIS MODULE * 01026002
*        (FOR BSAM AND BPAM) OR IN IFG0551B (FOR QSAM). IF NO SYNAD   * 01026102
*        ROUTINE IS DEFINED FOR BSAM A SYSTEM 001 ABEND WILL BE       * 01026202
*        ISSUED BY GIVING IFG0551D CONTROL. IF NO SYNAD ROUTINE IS    * 01029602
*        PRESENT FOR QSAM, MODULE IFG0551B IS GIVEN CONTROL TO        * 01031602
*        IMPLEMENT THE ERROR OPTIONS.                                 * 01032002
*        IF A SYNAD ROUTINE IS PRESENT, THE PERMANENT I/O ERROR BIT   * 01032402
*        (DCBC2PIO, BIT 3, IN DCBCIND2) IS SET TO 1 TO SERVE AS A     * 01032802
*        SECOND ENTRY SWITCH IF THE USER RETURNS FROM HIS SYNAD       * 01032902
*        ROUTINE, IN WHICH CASE THE ACCESS METHOD WILL RE-ISSUE SVC 55* 01033002
*        TO ATTEMPT TO BYPASS THE I/O ERROR AS THE USER INDICATED.    * 01033102
         EJECT                                                          01036502
*        5C) A RETURN FROM THE SYNAD ROUTINE IS INDICATED BY BIT 3,   * 01038502
*        DCBC2PIO, IN DCBCIND2 BEING SET TO ONE. MODULE IFG0551B WILL * 01038902
*        BE GIVEN CONTROL -                                           * 01039302
*        1) IF QSAM TO IMPLEMENT THE ERROR OPTION                     * 01039702
*        INDICATED IN DCBEROPT. THIS MAY RESULT IN THE I/O ERROR      * 01039802
*        BEING ACCEPTED OR SKIPPED AND THE QSAM CHANNEL PROGRAMS      * 01039902
*        BEING RESTARTED.                                             * 01040002
*        2) IF BSAM AND A CHANNEL PROGRAM NEEDS TO BE RESTARTED.      * 01043402
*        IF BSAM AND THE IOB IN ERROR (PASSED IN REGISTER 0) IS THE   * 01045402
*        CURRENT IOB (POINTED TO BY DCBIOBA), THE ACCESS METHOD       * 01045802
*        IS RETURNED CONTROL FROM THIS MODULE.                        * 01046202
*                                                                     * 01048202
*        THE EOV WORKAREA IS OBTAINED THROUGH THE IECRES-GET MACRO    * 01052502
*        WHICH CAUSES A SHARED ENQ ON THE TIOT. IF THE CALLER OF EOV  * 01054502
*        IS ENQUEUED ON THE TIOT EXCLUSIVELY, EOV PROCESSING WILL     * 01054702
*        NOT PROCEED, BUT THE RECOVERY ROUTINES WILL BE GIVEN CONTROL.* 01054902
*        THE EOV WORKAREA IS INITITIALIZED THROUGH THE IECRES-INIT    * 01055502
*        MACRO WHICH FILLS IN CONTROL BLOCK POINTERS IN THE WORKAREA. * 01056502
*                                                                     * 01058502
         EJECT                                                          01060902
* NOTES =                                                             * 01072602
*        WHEN THE BSAM/QSAM ACCESS METHOD ISSUES EOV, IT HAS SAVED    * 01077302
*        REGISTERS 14-8 IN THE SAVE AREA OF THE CALLER OF THE GET/PUT/* 01082002
*        CHECK MACRO INSTRUCTION POINTED TO BY REGISTER 13. THESE     * 01086702
*        REGISTERS ARE NOT SAVED ACCORDING TO STANDARD LINKAGE        * 01091402
*        CONVENTIONS, BUT ARE SAVED AT OFFSET 20 DECIMAL INTO THE     * 01096102
*        SAVE AREA. THE ACCESS METHOD CALLER OF EOV HAS PRESERVED     * 01100802
*        REGISTER 13. CONSEQUENTLY, THE REGISTERS SAVED IN THE SVRB   * 01105502
*        ARE THOSE OF THE ACCESS METHOD (14-8) AND OF THE CALLER OF   * 01110202
*        THE ACCESS METHOD (9-13).                                    * 01120202
*                                                                     * 01130202
*        ANTICIPATING TAKING THE EODAD OR SYNAD EXIT, EOV SWAPS       * 01140202
*        THE REGISTERS 0-8 BETWEEN THE USER SAVE AREA (POINTED TO BY  * 01142202
*        REGISTER 13 IN THE SVRB SAVE AREA) AND THE SVRB SAVE AREA.   * 01144202
*        THIS IS DONE BECAUSE OF THE METHOD OF TAKING THE SYNAD       * 01146202
*        OR EODAD EXIT.                                               * 01148202
*                                                                     * 01148602
*        THE SYNAD EXIT IS TAKEN BY EXITING FROM EOV WITH             * 01149002
*        REGISTER 15 CONTAINING THE SYNAD ADDRESS. THE ACCESS         * 01149402
*        METHOD GAINS CONTROL AT THE NSI AFTER THE SVC 55, TESTS      * 01149802
*        REGISTER 15, AND, IF NONZERO, ASSUMES REGISTER 15 POINTS TO  * 01149902
*        THE SYNAD ADDRESS AND ISSUES A BALR 14,15 INSTRUCTION. SINCE * 01150002
*        THE SVRB FOR EOV HAD BEEN MADE TO CONTAIN THE REGISTERS OF   * 01150102
*        THE CALLER OF THE ACCESS METHOD, THOSE REGISTERS ARE         * 01166802
*        RETURNED TO THE ACCESS METHOD AND WILL BE PRESENTED TO THE   * 01176802
*        SYNAD ROUTINE. FOR THIS REASON THE SYNAD ROUTINE MUST NOT    * 01178802
*        SAVE REGISTERS IN ITS SAVE AREA AS IT THEN CONTAINS THE      * 01180802
*        ACCESS METHOD REGISTERS WHICH WILL BE NEEDED IF A RETURN IS  * 01182802
*        MADE FROM THE SYNAD ROUTINE TO IGNORE THE I/O ERROR OR       * 01183202
*        IMPLEMENT THE DCB ERROR OPTIONS.                             * 01183302
*                                                                     * 01183402
*        SIMILARLY, THE EODAD EXIT IS TAKEN BY ALTERING THE RESUME    * 01189002
*        PSW IN THE EOV SVRB TO NOT CONTAIN THE ADDRESS OF THE NSI    * 01191002
*        AFTER THE SVC 55 IN THE ACCESS METHOD ROUTINE, BUT THE       * 01193002
*        ADDRESS OF THE EODAD EXIT. WHEN EOV EXITS, THE EODAD EXIT    * 01193402
*        WILL BE GIVEN CONTROL DIRECTLY AND THE REGISTERS WILL BE     * 01193802
*        LOADED FROM THE SVRB AND WILL BE THOSE OF THE CALLER OF THE  * 01194202
*        ACCESS METHOD.                                               * 01194302
*                                                                     * 01194402
*        WHEN EOV SUCCESSFULLY SWITCHES VOLUMES OR OBTAINS ADDITIONAL * 01194502
*        DIRECT ACCESS SPACE ON THE CURRENT OR A NEW VOLUME OR AFFECTS* 01208402
*        A CONCATENATION, EOV EXITS TO THE ACCESS METHOD WITH         * 01218402
*        15 SET TO ZERO INDICATING THAT ACCESS METHOD PROCESSING MAY  * 01220402
*        CONTINUE. IN THIS CASE THE REGISTERS THAT HAD BEEN SWAPPED   * 01220802
*        ANTICIPATING AN EODAD OR SYNAD EXIT MUST BE UN-SWAPPED SO    * 01221202
*        THE ACCESS METHOD WILL BE RETURNED ITS OWN REGISTERS.        * 01221602
         EJECT                                                          01222002
*    DEPENDENCIES =                                                   * 01222102
*        THE ACCESS METHOD REGISTER SAVING CONVENTIONS STATED ABOVE   * 01222202
*        UNDER NOTES.                                                 * 01222302
*        CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE         * 01226902
*        WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED       * 01228902
*        IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.          * 01230902
*                                                                     * 01231302
*    RESTRICTIONS = NONE                                              * 01231402
*                                                                     * 01231502
*    REGISTER CONVENTIONS =                                           * 01231602
*            R2 POINTS TO DCB                                         * 01236202
*            R4 POINTS TO OPEN WORK AREA                              * 01238202
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 01240202
*            R6 POINTS TO THE WTG TABLE                               * 01240602
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 01240702
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 01240802
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 01240902
*            R10 POINTS TO THE UCB                                    * 01252702
*                                                                     * 01262702
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 01264702
*                  END OF LISTING.                                    * 01268602
*                                                                     * 01270602
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 01272602
*                                                                     * 01276502
*    PROCESSOR = ASSEMBLER XF                                         * 01278502
*                                                                     * 01280502
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 01284402
*                  ORG STATEMENT AT END OF LISTING                    * 01286402
*                                                                     * 01288402
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 01298702
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 01308702
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 01308802
*                                                                     * 01308902
* ENTRY POINT = IGC0005E                                              * 01312302
*                                                                     * 01314302
*    PURPOSE = SEE FUNCTION                                           * 01314702
*                                                                     * 01315102
*    LINKAGE = EOV MACRO (SVC 55)                                     * 01315502
         EJECT                                                          01315602
* INPUT =                                                             * 01320802
*        THERE ARE FOUR DIFFERENT INPUT CONDITIONS -                  * 01323102
*                                                                     * 01325402
*        1) REGISTER 0 CONTAINS AN IOB ADDRESS.                       * 01327702
*        REGISTER 1 CONTAINS A DCB ADDRESS.                           * 01330002
*        IN THIS CASE IF THE DCBC2PIO BIT (BIT 3) IN DCBCIND2 IS SET, * 01332302
*        IT INDICATES A SECOND ENTRY INTO EOV UPON RETURN FROM THE    * 01334602
*        SYNAD ROUTINE.                                               * 01336902
*                                                                     * 01339202
*        2) REGISTER 1 CONTAINS A DCB/AMB ADDRESS.                    * 01341502
*                                                                     * 01343802
*        3) REGISTER 0 CONTAINS X'1000' IN THE LOW ORDER TWO BYTES.   * 01346102
*        REGISTER 1 CONTAINS A DCB ADDRESS.                           * 01348402
*                                                                     * 01350702
*        4) REGISTER 0 CONTAINS AN INTERNAL ABEND CODE TO BE PASSED   * 01353002
*        TO EOV PROBLEM DETERMINATION.                                * 01355302
*        REGISTER 1 CONTAINS A NEGATED DCB ADDRESS.                   * 01357602
*                                                                     * 01359902
* OUTPUT =                                                            * 01362202
*        1) EOV WORKAREA OBTAINED AND INITIALIZED AND TIOT ENQED UPON * 01364202
*        VIA THE IECRES MACRO (EXIT TO IFG0550P, IFG0551D, IFG0551F). * 01364402
*                                                                     * 01369102
*        2) DCB COPY (IFG0550P, AND IFG0551F IF NOT AMB).             * 01371402
*                                                                     * 01373702
*        3) DCBC2PIO BIT IN DCBCIND2 SET TO 1 (PERMANENT I/O ERROR).  * 01376002
*                                                                     * 01378302
*        4) ERROR MESSAGE PLACED AT OFFSET 8 IN EOV WORKAREA (EXIT TO * 01380602
*        IFG0551D).                                                   * 01382902
*                                                                     * 01385202
*        5) REGISTER 7 CONTAINING ENTRY CODE TO IFG0551B -            * 01387502
*        0 - QSAM I/O ERROR, SYNAD ADDRESS PRESENT.                   * 01389802
*        4 - QSAM I/O ERROR AND SYNAD ADDRESS ABSENT, OR SECOND       * 01399802
*        ENTRY FOR QSAM.                                              * 01409802
*        8 - BSAM SECOND ENTRY WITH CHANNEL PROGRAMS TO RESCHEDULE.   * 01419802
*        12 - BSAM SECOND ENTRY AND CHAINED SCHEDULING.               * 01429802
*        16 - BSAM SECOND ENTRY, PRINTER DEVICE AND IOBS PURGED.      * 01431802
*        20 - REGISTER 0 = X'1000' IN LOW ORDER 2 BYTES ON ENTRY TO   * 01433802
*        EOV AND NOT ISAM/BDAM.                                       * 01435802
*                                                                     * 01437802
*        6) REGISTER 0 CONTAINING INTERNAL ABEND CODE (IFG0550P).     * 01438202
*                                                                     * 01438602
*        7) REGISTER 14 CONTAINING ENTRY CODE TO IFG0551F -           * 01439002
*        0 - NOT AMB.                                                 * 01439402
*        12 - (VSAM) AMB.                                             * 01439502
*                                                                     * 01439602
*        8) RESUME PSW SET TO POINT TO EODAD EXIT (BPAM END OF DATA). * 01439702
*                                                                     * 01456402
*        9) REGISTER 15 CONTAINING SYNAD ADDRESS OR ZERO (EXIT        * 01466402
*        TO BSAM ACCESS METHOD CALLER FROM FIRST OR SECOND ENTRY      * 01468402
*        WHEN PROCESSING A PERMANENT I/O ERROR).                      * 01470402
*                                                                     * 01472402
*        10) REGISTERS 0-8 AT OFFSET 28 IN USER SAVE AREA, OFF        * 01472802
*        REGISTER 13 IN SVRB, SWAPPED WITH REGISTERS 0-8 IN SVRB      * 01472902
*        SAVE AREA (IF EXITING TO BSAM ACCESS METHOD CALLER WITH      * 01473002
*        SYNAD ADDRESS OR ZERO IN REGISTER 15, OR WHEN TAKING EODAD   * 01478602
*        EXIT FOR BPAM MEMBER, OR GIVING CONTROL TO IFG0551F EXCEPT   * 01480602
*        FOR VSAM AMB).                                               * 01482602
*                                                                     * 01482702
*        11) WHEN GOING TO IFG0551B WITH REGISTER 7 CONTAINING   YM4610 01482802
*        4 OR 12 - REGISTER 12 CONTAINS THE ADDRESS OF THE IOB   YM4610 01484302
*        IN ERROR.                                               YM4610 01484702
*                                                                       01485102
*        12) WHEN GOING TO IFG0551B WITH REGISTER 7 CONTAINING   YM4610 01485502
*        8 OR 16 - REGISTER 6 CONTAINS THE ADDRESS OF THE IOB    YM4610 01485602
*        IN ERROR AND REGISTER 12 CONTAINS THE ADDRESS OF THE    YM4610 01487602
*        LAST SCHEDULED IOB                                      YM4610 01489602
*                                                                     * 01490002
*        REGISTERS IF TRANSFERRING TO ANOTHER MODULE                  * 01492002
*        R2 POINTS TO USER'S DCB EXCEPT UNDER 2) ABOVE                * 01494002
*        R4 POINTS TO EOV WORKAREA                                    * 01496002
*        R6 POINTS TO THE WTG TABLE IN THE EOV WORKAREA EXCEPT   YM4610 01498002
*              FOR 11) AND 12) ABOVE                             YM4610 01498402
*        R8 POINTS TO THE CURRENT (AND ONLY) WTG TABLE ENTRY          * 01500002
*                                                                     * 01502002
*        CONTROL PASSED TO NEXT MODULE IN PROTECT KEY 5               * 01504002
         EJECT                                                          01506002
* EXIT-NORMAL =                                                       * 01508002
*        IFG0551F                                                     * 01510002
*        IFG0550P                                                     * 01510402
*        IFG0551B                                                     * 01510802
*        IFG0551D                                                     * 01511202
*        EXIT TO ACCESS METHOD CALLER VIA IECRES-EXIT MACRO           * 01511602
*        EXIT TO EODAD ROUTINE (ADDRESS PLACED IN RESUME PSW) VIA     * 01511702
*        IECRES-EXIT MACRO.                                           * 01511802
*                                                                     * 01511902
* EXIT-ERROR =                                                        * 01516502
*        IFG0550P VIA DMABCOND AND IECRES-BRANCH MACRO WITH INTERNAL  * 01518502
*        ABEND CODE IN REGISTER 0 -                                   * 01520502
*        1) INTERNAL ABEND CODE 219 CAUSING                           * 01520902
*        A37-08 SYSTEM ABEND - DEB DOES NOT POINT TO DCB,             * 01521002
*        BAD CONTROL BLOCK STRUCTURE (ERROR FROM IECRES INIT).   YM7883 01521202
*        2) INTERNAL ABEND CODE 174 CAUSING                           * 01521402
*        337-04 SYSTEM ABEND - NO EODAD ADDRESS AT END OF DATA.       * 01521602
*        3) INTERNAL ABEND CODE 198 CAUSING                           * 01525802
*        A37-04 SYSTEM ABEND - DCB NOT OPEN.                          * 01527802
*                                                                     * 01528802
*        DMABCOND PCK IF RETURN CODE FROM IECRES-GET,PREFIX=EOV       * 01529002
*        INDICATES THAT THE CALLER OF EOV ENQUEUED ON THE TIOT        * 01529202
*        RESOURCE EXCLUSIVELY. THIS WILL NOT BE TOLERATED,            * 01529402
*        UNLESS FOR AN AMB CATALOG REQUEST, AND THE CALLER IS IN YM7883 01529602
*        A SYSTEM KEY.                                           YM7883 01529702
*                                                                     * 01529802
*        EXIT TO CALLER VIA IECRES-EXIT MACRO IF                      * 01530202
*        1) VTAM ACB - ACBERFLG SET TO 4.                             * 01530302
*        2) ACB ADDRESS PASSED IN REGISTER 1.                         * 01530402
*        3) LOCK BIT NOT ON IN DCB.                                   * 01530502
*        4) DEB CHAINED ON ANOTHER TCB AND IT IS BEING CLOSED BY      * 01552802
*        THE TASK CLOSE ROUTINE FOR THAT TCB.                         * 01553302
*        5) IECRES INIT ERROR FOR AMB CONTROL BLOCK              YM7883 01553502
*                                                                     * 01554302
*        IFG0551D WITH MESSAGE 'IEC020I ERROR OCCURRED WHILE CLOSING  * 01558202
*        DATA SET' AT LOCATION 8 IN THE EOV WORKAREA IF A PERMANENT   * 01560202
*        I/O ERROR OCCURRED AND THE DCB INDICATED THAT CLOSE'S        * 01562202
*        FLUSHING OF BURRERS DETECTED THE I/O ERROR AND CALLED EOV.   * 01566102
*                                                                     * 01568102
*        IFG0551D WITH MESSAGE 'IEC020I NO ERROR HANDLING, (SYNAD),   * 01570102
*        EXIT SPECIFIED' AT LOCATION 8 IN THE EOV WORKAREA IF         * 01574002
*        PERMANENT I/O ERROR ON BSAM/BPAM DCB AND NO SYNAD ADDRESS    * 01576002
*        WAS PRESENT IN THE DCB.                                      * 01578002
*                                                                     * 01588302
*        IFG0551D WITH MESSAGE 'IEC020I GET OR READ ISSUED AFTER END  * 01598302
*        OF FILE' AT OFFSET 8 IN EOV WORKAREA IF SECOND ENTRY AND     * 01598402
*        DEBF1EOF (BIT 1) IN DEBFLGS1 SET TO 1 INDICATING GET/READ    * 01598502
*        ISSUED FROM EODAD ROUTINE.                                   * 01601902
         EJECT                                                          01603902
* EXTERNAL REFERENCES = SEE BELOW                                     * 01604302
*                                                                     * 01604702
*    ROUTINES =                                                       * 01605102
*                                                                     * 01605202
*    DATA AREAS =                                                     * 01605302
*                                                                     * 01605402
*    CONTROL BLOCK =                                                  * 01608802
*        TCB                                                          * 01610802
*        SVRB                                                         * 01611202
*        DEB                                                          * 01611602
*        CVT                                                          * 01612002
*        SEQUENTIAL ACCESS METHOD IOBS                                * 01612102
*                                                                     * 01612202
* TABLES =                                                            * 01612302
*        EOV WORKAREA MAPPED BY FORCORE DSECT.                        * 01615702
*                                                                     * 01617702
* MACROS =                                                            * 01618102
*        MODESET                                                      * 01618502
*        DMABCOND                                                     * 01618902
*        ICREST INIT                                                  * 01619002
*        IECRES EXIT                                                  * 01619102
*        IECRES GET                                                   * 01619202
*        IECRES LOAD                                                  * 01622602
*        IECRES FREE                                                  * 01624602
*        DEBCHK MF=L                                                  * 01625002
*        XCTLTABL                                                     * 01625402
*        IDAAMB                                                       * 01625802
*        IECEQU                                                       * 01625902
*        IECDSECS                                                     * 01626002
*                                                                     * 01626102
* CHANGE ACTIVITY =                                                   * 01627202
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD          * 01627602
*                                                                     * 01629202
*********************************************************************** 01629302
         EJECT                                                          01629502
EABD174  EQU   174                      CODE FOR ABEND 337              01633002
EABD198  EQU   198                      CODE FOR ABEND A37      SA52379 01636402
EABD219  EQU   219                      CODE FOR ABEND A37      SA59307 01639802
         BALR  RBASE,0                  ESTABLISH BASE                  16666702
         USING EIN00200,RBASE           BASE REGISTER USING             16700002
         USING IHADCB,RDCB              DCB ADDRESS USING               16800002
         USING SAVEAREA,RD              USER'S SAVE AREA DSECT   Y02082 16850002
*                                                                       16900021
EIN00200 EQU   *                        BASE UNTIL FOLLOWING BAL        17000002
*                                                                       17100021
         BAL   RBASE,EIN00500           BRANCH AROUND ABEND CODE        17200021
         USING EIN00300,RBASE           ESTABLISH NEW ADDRESABILITY     17300021
*        RBASE IS USED FOR BASE REGISTER AND ABEND ENTRY POINT          17400021
EIN00300 EQU   *                        PROBLEM DETERMINATION FUNCTION  17500002
*                                                                       17510002
*        REGISTER 7 POINTS TO ERROR MESSAGE OR CONTAINS A NEGATED       17550002
*        INTERNAL ABEND CODE TO BE PASSED TO PROBLEM DETERMINATION      17560002
*                                                                       17560202
         USING FORCORE,RCORE            EOV WORKAREA USING              17600002
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 17650002
*                                                                       17650202
         BAL   R8,EIN01800              GET CORE FOR EOV RTNS    A44814 17700021
*                                                                       17700202
         LTR   R7,R7                    001 ABEND OR OTHER              17800021
         BM    EIN00450                 OTHER, CALL PROB DET.           17900021
         LA    R1,DXCCW11+K4            MESSAGE AREA                    18000002
         XC    K0(K12,R1),K0(R1)        ZERO AREA TO HOLD MESSAGE       18100002
         MVI   K1(R1),K16               ABEND CODE                      18200021
         LH    RF,K0(R7)                MESSAGE LENGTH                  18300002
         BCTR  RF,K0                    DECREMENT BY ONE                18400021
         EX    RF,EIN00400              MOVE MSG TO WKAREA              18500021
         LA    R7,K4                    INDICATE MESSAGE IS IN  SA53086 18550002
*                                       THE WORKAREA            SA53086 18600002
         MVC   DXXMODID,MOD2E5E         PUT ID IN NAME                  19000021
         MVC   DXXMODEP+K1(K3),MOD2E5E+K2 MOVE IN EP ADDRESS     Y02080 19100002
         B     EIN02100                 BR TO SETUP FOR XCTL            19200021
EIN00400 MVC   MSGLSTSZ(K0),K0(R7)      GET LENGTH OF MSG               19300021
         EJECT                                                          19300202
EIN00450 EQU   *                        NOT AN 001 ABEND                19400002
         MODESET EXTKEY=DATAMGT         GET IN D. M. KEY         YM7883 19400202
         LA    RWTG,DXXAREA             WTG REG POINTS TO DUMMY WTG TBL 19600021
         LA    RWTGC,DXXENTRY           CURRENT PTR POINTS TO DUMMY     19700021
*                                       ENTRY                           19800021
         DMABCOND (0),RES=NO,REGSAVE=YES SETUP FOR 550P          M0067  20720002
         MVC   DXXMODNM+K6(K2),MODPD5E  MOVE ID OF IFG0550P, TO  M0067  20740002
*                                       NAME FIELD OF WTG TABLE  M0067  20800021
         MVC   DXXMODEP+K1(K3),MODPD5E+K2 IFG0550P EP            Y02080 20820002
         IECRES INIT,DCBCOPY=TOWKAR,PREFIX=DXXPREFX, COPY DCB TO Y02082*20830002
               STM=(3,14,DXXPREFX)      PROTECTED CORE           Y02082 20840002
         LPR   R0,R7                    PUT POS INTERNAL CODE IN REG 0  20850002
         B     EIN02100                 GO XCTL                  M0067  20860021
         EJECT                                                          20870002
EIN00500 EQU   *                        CHECK FOR ABEND/PROBELM DET     20900002
*                                                                       20902002
*        DETERMINE FUNCTION REQUESTED BY SVC 55 CALL                    20904002
*                                                                       20906002
         DROP  RCORE                    DROP EOV WORKAREA USING  Y02082 20906802
         USING TCB,R4                   TCB PASSED IN R4 TO SVC  Y02082 20907602
         USING RBBASIC,R5               RB PASSED IN R5        @ZA02545 20908402
         LA    RDCB,K0(R1)              GET DCB ADDRESS                 20910002
         CH    R0,ABCOD                 ABEND REQUESTED                 20950002
         BE    EIN00550                 YES, 001 IS COMP CODE           21000002
         LTR   R1,R1                    ABEND OTHER THAN 001            21050002
         BNM   EIN00600                 NO, ABEND NOT REQUESTED         21100002
         TM    RBGRS1,ALLBITS           VALIDITY CHECK ABEND   @ZA02545 21150002
         BNO   EIN00600                 BRANCH IF NOT ABEND      Y02134 21160002
         LPR   RDCB,R1                  LOAD DCB ADDR INTO RDCB  Y02082 21350002
         LNR   R7,R0                    PUT NEGATIVE INTERNAL CODE      21360002
*                                       IN REG 7                        21370002
         BAL   R8,EIN03010              LINK TO SWAP REGS      @ZA02545 21374002
         BR    RBASE                    ISSUE MESSAGE & ABEND           21380002
         SPACE 2                                                        21382002
EIN00550 EQU   *                        001 ABEND REQUEST               21390002
         LA    R7,K20                   BRANCH OFFSET INTO       YM1197 21390402
*                                       IFG0551B IF NOT IS/DA    YM1197 21390802
         TM    DCBDSORG-IHADCB(RDCB),DCBORGPS PS PROCESSING     ZA00621 21392002
         BZ    EIN00575                 NO - GO TO IFG0551D     ZA00621 21394002
         TM    DCBCIND2,DCBC2QSM        QSAM PROCESSING         ZA00621 21394402
         BO    EIN02000                 YES - GO TO IFG0551B    ZA00621 21394802
EIN00575 EQU   *                                                ZA00621 21395202
         LA    R7,MSG1                  GET ADDR MSG NO SYNAD SPECIFIED 21396002
         BR    RBASE                    ISSUE MESSAGE & ABEND           21398002
         EJECT                                                          21399802
EIN00600 EQU   *                        NOT SPECIAL PROBLEM             21400402
*                                       DETERMINATION USE OF SVC55      21402402
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          YM1391 21460002
         LA    R7,K20                   PUT ENTRY CODE IN REG           21500021
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    X02989 21560002
         BO    EIN00700                 BR IF YES, NOT ACB/AMB   XM1037 21570002
         TM    DCBDSORG+K1,ACBDORGA     IS CNTRL BLK AN ACB/AMB  X02989 21580002
         BNO   EIN00700                 BR IF NO                 X02989 21590002
         USING IDAAMB,RDCB                                       YM3843 21590102
         TM    AMBID,AMBIDENT           IS CNTRL BLK AN AMB      YM3843 21590202
         LA    R8,EIN02150              SKIP DCB COPY IF YES     YM3843 21590302
         BO    EIN01800                 BR IF YES - VSAM AMB     YM3843 21590402
         SPACE 2                                                        21590502
*                                                                Y02004 21590602
*        ACB PASSED TO EOV IN REGISTER 1                                21590702
*        DO NOT PROCESS VTAM ACB REQUESTS                        Y02004 21590802
*                                                                Y02004 21591202
         USING IFGACB,RACB              ADDRESS ACB              Y02004 21591802
         MODESET EXTKEY=RBT234,WORKREG=7 ASSUME CALLER'S KEY     YM3843 21592802
         CLI   ACBAMETH,ACBVTAM         IS THIS ACB FOR VTAM?    YM3011 21593802
         BNE   EIN01100                 NO, EXIT                 YM3843 21607302
         MVI   ACBERFLG,VSCACBCL        SET ACB ERROR FLAG       Y02004 21617302
         B     EIN01100                 RETURN TO USER           Y02004 21619302
*                                                                       21620302
         USING IHADCB,RDCB              RESTORE BASE FOR DCB     Y02004 21663802
         EJECT                                                          21664202
EIN00700 EQU   *                        DCB PASSED IN REGISTER 1 X02989 21665802
         MODESET EXTKEY=RBT234,WORKREG=7 ASSUME CALLER'S KEY     YM1391 21715802
*                                                                       23500021
         LR    RET,RPAR                 GET SVRB PASSED BY MONITOR      23600021
         USING RBBASIC,RET              USING ON SVRB            Y02082 23650002
         DROP  R4                                                YM1391 23660002
         DROP  R5                                              @ZA02545 23664002
         USING FORCORE,RCORE                                     YM1391 23670002
*                                                                       23700021
*                                                                       23800021
         TM    DCBOFLGS,DCBOPEN+DCBOLOCK IS DCB OPEN + UNLOCKED SA52379 23900002
         BNO   EIN01150                 NO, STOP PROCESSING     SA52379 24000002
         USING DEBBASIC,RDEB            ADDRESSABILITY           YM2869 24050002
         L     RDEB,DCBDEBAD            GET DEB ADDRESS         SA59307 24060002
         L     RC,DEBDCBAD              GET DCB FROM DEB        SA59307 24070002
         LA    R7,K3                    NEG OFFSET TO AMTYP      YM1310 24070402
         SR    RDEB,R7                  PT TO DEBAMTYP           YM1310 24070802
         CLC   K0(K1,RDEB),DEBCKSS      TEST FOR SUBSYS DEB      YM1310 24072002
         L     RDEB,DCBDEBAD            RESTORE DEB ADDRESS      YM1310 24072402
         BNE   EIN00730                 BR IF NOT                YM1310 24074002
         L     RC,DEBECBAD              DCB ADDR FOR SUBSYS DEB  YM1310 24076002
EIN00730 EQU   *                        SEE IF DEB POINTS TO DCB YM1310 24078002
         LA    RC,0(RC)                 CLEAR HIGH ORDER BYTE   SA59307 24080002
         CR    RC,RDCB                  IS THIS A VALID DCB     SA59307 24090002
         BE    EIN00750                 YES                     SA59307 24092002
         LA    R7,EABD219               NO, BAD DCB PTR         SA59307 24094002
         LNR   R7,R7                    NOT 001 ABEND           SA59307 24096002
         BAL   R8,EIN03015              LINK TO SWAP REGS      @ZA02545 24097602
         BR    RBASE                    BRANCH TO ABEND         SA59307 24098002
         EJECT                                                          24098102
EIN00750 EQU   *                        VALID DEB, CONTINUE     SA59307 24098402
         TM    DCBMACRF,DCBMEXCP        DCB USING EXCP MACRO            24100021
         BO    EIN01750                 YES XCTL TO EOV ROUTINE  YM2869 24200002
         NI    DCBCIND2,ALLBITS-DCBC2FEO    TURN OFF FEOV BIT   SA58624 24250002
         LA    RC,K3                    GET OFFSET TO DEBAMTYP   Y02120 24276002
         SR    RDEB,RC                  RDEB POINTS TO DEBAMTYP  Y02120 24278002
         CLC   DEBCKSS,K0(RDEB)         DEBAMTYP FOR SUBSYSTEM   Y02120 24278402
         LA    RDEB,K3(,RDEB)           RESTORE DEB ADDRESS      YM1119 24278502
         BE    EIN01700                 BRANCH IF SUBSYSTEM      YM2869 24278802
*                                                                       24300021
*        NOT SUBSYSTEM DCB, MUST BE NORMAL BSAM/QSAM                    24350002
*                                                                       24360002
         LR    RC,R0                    GET IOB ADDRESS                 24400021
         TM    DCBCIND2,DCBC2QSM        QSAM BEING USED                 24500021
         BO    EIN00800                 YES BRANCH                      24600021
         CLI   DCBDEVT,K80              PAPER TAPE BEING USED           24700021
         BE    EIN01750                 YES BRANCH               YM2869 24800002
         B     EIN00900                 NO, BRANCH              SA59307 24850002
EIN00800 EQU   *                        TEST FOR QSAM GET FROM EODAD    25000002
*                                                                       25100021
         LA    R7,MSG3                  GET ADDR MSG ISSUED BY EODAD    25200021
         TM    DEBFLGS1,DEBF1EOF        WAS EOD TAKEN           SA50649 25300002
         BCR   1,RBASE                  ISSUE MESSAGE AND ABEND SA50649 25400002
EIN00900 EQU   *                        BSAM/QSAM EOV                   25500002
         L     RPAR,K12(RC)             GET ECB ADDR                    25600021
         TM    DCBCIND2,DCBC2PIO        SECOND ENTRY INTO ROUTINE       25700021
         BZ    EIN01200                 NO CONTINUE                     25800021
         EJECT                                                          25850002
*                                                                       25900021
*        SECOND ENTRY INTO EOV - RETURN FROM SYNAD ROUTINE              25950002
*                                                                       25960002
         NI    DCBCIND2,ALLBITS-X10     TURN OFF PERM ERROR FLAGS       26000021
         TM    DCBCIND2,DCBC2QSM        QSAM BEING USED                 26100021
         LA    R7,K4                    PUT 551B ENTRY CODE IN REG      26200002
         BO    EIN02000                 YES BRANCH TO QSAM ERROR        26300002
*                                       OPTIONS TEST                    26400002
*                                                                       26410002
*        BSAM SECOND ENTRY TO EOV                                       26420002
*                                                                       26430002
         NI    DCBIFLGS,X'FF'-DCBIFPIO  TURN OFF ERROR FLAGS     A49379 26450021
*                                                                       26710037
         TM    DCBCIND2,DCBC2CHN        TEST FOR CHAINED SCHED @ZA03655 26720037
         BNO   EIN00950                 BRANCH NOT PCI         @ZA03655 26730037
*                                                                       26740037
         LA    R7,K12                   551B ENTRY CODE        @ZA03655 26742037
         L     RWTG,DCBIOBA             LOAD CURRENT ICB       @ZA03655 26750037
         LA    RWTG,K0(,RWTG)           CLEAR FOR COMPARE      @ZA03655 26760037
         CR    RC,RWTG                  ERROR ICB = CURRENT    @ZA03655 26770037
         BNE   EIN02000                 BRANCH TO RESCHED I/O  @ZA03655 26780037
         TM    K0(RC),X08               OUTPUT WITH READ       @ZA03655 26782037
         BNO   EIN02000                 BRANCH INVALID REQUEST @ZA03655 26784037
         B     EIN01050                 RETURN TO CALLER       @ZA03655 26786037
*                                                                       26790037
EIN00950 EQU   *                        NORMAL SCREDULING      @ZA03655 26792037
*                                                                       26800021
         LR    RWTG,RC                  GET CURRENT IOB                 26900021
         L     RC,DCBIOBA               GET LAST IOB USED               27000021
         LA    RC,K0(RC)                CLEAR                           27100021
         TM    DCBDEVT,DCBDVPR1         TEST IF DCB USING PRINTER       27300002
         BNO   EIN01000                 NO BRANCH                       27400021
         TM    K12(RWTG),DEPEND         IOB INTERCEPTED OR PURGED       27500021
         LA    R7,K16                   PUT 551B ENTRY CODE IN REG      27600002
         BM    EIN02000                 YES, BRANCH                     27700021
EIN01000 EQU   *                        WERE IOBS PURGED                27900002
         CR    RC,RWTG                  IS ERROR IOB CURRENT IOB        28000002
         LA    R7,K8                    PUT 551B ENTRY CODE IN REG      28300002
         BNE   EIN02000                 YES, BRANCH                     28400021
         EJECT                                                          28450002
*                                                                       28460002
*        BSAM - NO IOBS TO BE RESTARTED - RETURN TO CALLER              28470002
*                                                                       28480002
EIN01050 EQU   *                        TEST FOR PRESENCE OF SYNAD      28490002
         TM    DCBSYNAD+K3,K1           IS SYNAD PRESENT                28600021
         BO    EIN01100                 NO, BRANCH - NO REG UNSWAP      28700002
         LM    R0,R8,SAVREG0            GET ERR REGS 0-8         Y02082 28800002
*                                       PRE-SAVED IN SAVE AREA   Y02082 28900002
         MVC   SAVREG2(SAVREG9-SAVREG2),RBGRS2 MOVE REGS 2-8 IN  Y02082 29000002
*                                       SVRB TO SAVE AREA        Y02082 29010002
         MODESET EXTKEY=SUPR            SVRB KEY                 Y02082 29050002
         STM   R0,R8,RBGRS0             USER REGS TO SVRB        Y02082 29100002
EIN01100 EQU   *                        RETURN TO GERR/PERR             29200002
*                                                                Y02080 29250002
*        RETURN TO CALLER                                        Y02080 29300002
*                                                                Y02080 29350002
         SR    RF,RF                    ZERO RETURN CODE         YM7883 29350202
*                                                                       29350402
         IECRES EXIT                    RETURN                   Y02080 29352002
         SPACE 2                                                        29362002
*                                                                Y02080 29390002
*        OPEN AND LOCK BIT NOT BOTH ON                                  29390402
*                                                                       29390802
EIN01150 EQU   *                        ABEND OR RETURN TO USER SA52379 29392002
         TM    DCBOFLGS,DCBOPEN         IS THE OPEN BIT ON      SA52379 29394002
         BO    EIN01100                 BR IF YES-EXIT           YM7883 29396002
         LA    R7,EABD198               GET CODE FOR A37 ABEND  SA52379 29399202
         LNR   R7,R7                    INDICATE NON 001 ABEND  SA52379 29399602
         BAL   R8,EIN03010              LINK TO SWAP REGS      @ZA02545 29423602
         BR    RBASE                    GO TO ABEND CODE        SA52379 29439602
         EJECT                                                          29459602
EIN01200 EQU   *                        TEST FOR I/O ERROR              29500002
*                                                                       29600021
*        FIRST ENTRY TO EOV                                             29650002
*                                                                       29660002
         TM    K20(RC),CSWUNITX         UNIT EXCEPTION ON IN CSW        29700021
         BZ    EIN01500                 NO BRANCH                       29800021
*                                                                       29900021
         TM    K0(RC),IOBWRITE          WAS IOB USED FOR OUTPUT         30000021
         BO    EIN01300                 YES BRANCH                      30100021
*                                                                       30200021
         TM    DCBDSORG,DCBORGPO        PAM DCB FOR INPUT               30300021
         BO    EIN02200                 YES BRANCH                      30400021
*                                                                       30500021
EIN01300 EQU   *                        UNIT EXCEPTION - NOT PAM INPUT  30600002
*                                                                       30700021
         TM    DCBDEVT,DCBDEVDA         DA USED                         30800021
         BO    EIN01400                 YES, BRANCH                     30900021
         TM    K20(RC),K2               UNIT CHECK ON IN CSW            31000021
         BO    EIN02500                 YES,BRANCH                      31100021
EIN01400 EQU   *                        END OF FILE INDICATION          31150002
         OI    DCBOFLGS,DCBOEOF         SET FILE IND-I/O SUPPORT        31200002
         B     EIN01600                 BR TO GET IOB                   31300021
EIN01500 EQU   *                        NOT UNIT EXCEPTION              31350002
*                                                                       31400021
*        I/O ERROR UNLESS READ BACKWARDS INTO LOAD POINT                31450002
*                                                                       31500021
         TM    DCBDEVT,DCBDEVTP         DCB USING TAPE FOR INPUT        31800021
         BZ    EIN02500                 NO BRANCH - UNIT CHECK          31900021
*                                                                       32000021
         TM    K11(RC),UCBLDPT          READ LOAD POINT ON TAPE         32100021
         BZ    EIN02500                 NO BRANCH - UNIT CHECK          32200021
*                                                                       32300021
         TM    DCBOFLGS,DCBORDBK        IS IT READ BACK AT THE   M0180  32320021
*                                       LOAD POINT                      32340021
         BZ    EIN02500                 NO, BRANCH - UNIT CHECK  M0180  32360021
*                                                                       32400021
EIN01600 EQU   *                        NOT I/O ERROR                   32500002
*                                                                       32600021
         L     RPAR,K12(RC)             GET ECB ADDRESS                 32700021
         MVI   K0(RPAR),ECBCOD7F        POST COMPLETE NO ERROR          32800021
         L     RWTG,DCBIOBA             GET CURR IOB FROM DCB           32900021
         STCM  RC,B'0111',K5(RWTG)      STORE ERROR IOB IN IT    Y02082 32950002
         NI    DCBCIND1,ALLBITS-K48     TURN OFF VOLUME FULL BITS       33100021
         EJECT                                                          33200002
EIN01700 EQU   *                        NORMAL END OF VOLUME     YM2869 33350002
*                                                                Y02082 33400002
*        SWAP REGS 0-8 - THOSE IN THE SVRB AND THOSE IN THE      Y02082 33450002
*        CALLER'S SAVE AREA                                      Y02082 33500002
*                                                                       33550002
         LM    RCORE,RC,SAVREG0         LOAD REGS 0-8 IN SAVAREA Y02082 33600002
         MVC   SAVREG0(SAVREG9-SAVREG0),RBGRS0  MOVE REGS 0-8 IN Y02082 33650002
*                                       SVRB INTO THE SAVE AREA  Y02082 33700002
         MODESET EXTKEY=SUPR            SVRB KEY                 Y02082 33750002
         STM   RCORE,RC,RBGRS0          STORE REGS 0-8 FROM SAVE Y02082 33800002
*                                       AREA INTO SVRB           Y02082 33850002
*                                                                       34200021
EIN01750 EQU   *                        TEST TASK CLOSE BIT      YM2869 34300002
*                                                                       35880000
*        DON'T CONTINUE WITH EOV IF DEB IS CHAINED ON ANOTHER    YM2869 35880502
*        TCB'S DEB CHAIN AND IS BEING PROCESSED BY TASK CLOSE    YM2869 35881002
*                                                                       35881502
         L     R8,CVTPTR                CVT                      YM2869 35882102
         L     R8,CVTTCBP-CVT(,R8)      TCB POINTERS             YM2869 35882202
         L     R8,K4(,R8)               CURRENT TCB ADDR         YM2869 35882502
         USING TCB,R8                                            YM2869 35882802
         MODESET EXTKEY=RBT234,WORKREG=15 USER KEY               YM2869 35883102
         L     RDEB,DCBDEBAD            DEB ADDRESS              YM2869 35883402
         CLM   R8,B'0111',DEBTCBAD+K1   DEB ON CURRENT TCB       YM2869 35883702
         BE    EIN01760                 BRANCH IF YES            YM2869 35884002
         DROP  R8                                                YM2869 35884302
         LA    RF,DEBBASIC-DEBXTNP      OFFSET TO DEBX           YM2869 35884502
         LA    R8,DEBBASIC              CLEAR HIGH BYTE FOR LTR  YM2869 35885002
         SR    R8,RF                    R8 POINTS TO DEBX ADDR   YM2869 35885502
         USING DEBXTNP,R8                                        YM2869 35886002
         L     R8,DEBXTNP               R8 POINTS TO DEBX        YM2869 35886502
         USING DEBXTN,R8                                         YM2869 35887002
         TM    DEBXFLG1,DEBXTSK         IS TASK CLOSE ON DEB     YM2869 35887502
         BO    EIN01100                 BRANCH IF YES            YM2869 35888002
         DROP  R8                                                YM2869 35888502
DEBXTSK  EQU   X'40'                    TASK CLOSE PROCESSING    YM2869 35889002
         EJECT                                                          35889102
EIN01760 EQU   *                        GET CORE FOR EOV         YM2869 35889502
         LA    R8,EIN01900              LOAD ADDR FOR RETURN     A44814 35894000
*                                       FROM GETMAIN             A44814 35896000
EIN01800 EQU   *                        GET EOV WORKAREA                35898002
*                                                                Y02080 35898402
* SAVE REGISTERS 2-12 IN SVRB EXTENDED SAVE AREA                 Y02080 35898502
*                                                                Y02080 35898602
         L     RF,CVTPTR                GET POINTER TO CVT       Y02080 35898702
         L     RF,CVTTCBP-CVT(,RF)      GET TCB WORDS            Y02080 35903002
         L     RF,K4(,RF)               TCB ADDRESS              Y02080 35905002
         L     RF,K0(,RF)               POINTER TO SVRB          Y02080 35907002
*                                                                Y02080 35907102
         MODESET EXTKEY=SUPR            SVRB KEY TO STM          Y02082 35909102
         IECRES GET,PREFIX=EOV,LV=EOVSIZE,STM=(2,13,96(15)),A=(RDCB)    35909302
*                                                                       35910302
         LR    RCORE,R1                 SET UP ADDRESS FOR EV RTS.      35910402
         STCM  RCORE,B'0111',DXXCORE    PUT WORKAREA ADDR IN     YM3843 35910502
*                                       EOV'S WTG TABLE ENTRY    YM3843 35910602
         LTR   R0,R0                    IS R0 ZERO               YM3185 35910702
         BZ    EIN01850                 BRANCH IF OK             YM7883 35910802
         EJECT                                                          35910902
*        IF REG 0 IS NONZERO, IT IS BECAUSE THE CALLER HAS       YM3185 35911302
*        ENQUEUED EXCLUSIVELY ON THE TIOT. THIS MUST NOT BE      YM3185 35911402
*        ALLOWED TO GO UNNOTICED UNLESS FOR A CATALOG AMB.       YM7883 35911502
*                                                                       35912702
         MODESET EXTKEY=ZERO            AMB IN KEY 0             YM7883 35913202
         TM    DCBMACRF,DCBMEXCP        EXCP DCB                 YM7883 35913302
         BO    EIN03005                 BRANCH IF YES            YM7883 35913402
         TM    DCBDSRG2,ACBDORGA        ACB/AMB                 ZA00113 35913502
         BZ    EIN03005                 BRANCH IF NO             YM7883 35913702
         USING IDAAMB,RDCB              AMB USING                YM7883 35913802
         TM    AMBID,AMBIDENT           TEST FOR AMB             YM7883 35914002
         BZ    EIN03005                 BRANCH IF NOT            YM7883 35914202
         TM    AMBINFL,AMBCAT+AMBSCRA   CATALOG AMB?            Z30SSRL 35914337
         BZ    EIN03005                 BRANCH IF NOT            YM7883 35914402
         USING IHADCB,RDCB              RESUME DCB USING         YM7883 35914502
         TESTAUTH KEY=YES               IS CALLER IN SYSTEM KEY  YM7883 35914602
         LTR   RF,RF                    CALLER IN SYSTEM KEY     YM7883 35914702
         BNZ   EIN03005                 BRANCH IF NOT SYSTEM KEY YM7883 35914802
         EJECT                                                          35915002
EIN01850 EQU   *                        PROCEED                  YM7883 35915102
         L     RF,DXXPREFX              GET PREFIX PTR           Y02144 35915502
         L     RF,IECRRPRM-IECPREFX(,RF) GET RRPLIST PTR         Y02144 35915602
         USING RRPLIST,RF                                        Y02144 35915702
         MVI   RRFUNCTN,RRFEOV          INDICATE EOV FUNCTION    Y02144 35915802
         ST    RF,DXATCOM3              SAVE RRPLIST PTR IN W/A  Y02144 35916002
         DROP  RF                                                Y02144 35916202
         IECRES LOAD,PREFIX=DXXPREFX,MODNM=EOV,BRANCH=NO         Y02080X35916402
                                        GIVE OPT TRACE A SHOT    Y02080 35924602
*                                                                       35924802
         IECRES INIT,DEB=YES,STM=(2,14,DXXPREFX),PREFIX=DXXPREFX Y02082 35934202
*                                                                       35934402
         LR    R1,RDCB                  SET DCB ADDRESS IN REG 1        35953200
         CLI   DXWCOPYE,K0              WAS INIT SUCCESSFUL      YM4610 35955202
         BER   R8                       RETURN TO CALLER         A44814 35955402
*                                       OF SUBROUTINE                   35955602
         LA    R7,EABD219               INTERNAL ABEND CODE      YM7883 35957202
         LNR   R7,R7                    NEGATE CODE              YM7883 35957602
         MODESET EXTKEY=ZERO            AMB IN KEY 0             YM7883 35957702
         TM    DCBMACRF,DCBMEXCP        EXCP DCB                 YM7883 35957902
         BO    EIN00450                 BRANCH IF YES            YM7883 35958002
         TM    DCBDSRG2,ACBDORGA        ACB/AMB                 ZA00113 35958202
         BZ    EIN00450                 BRANCH IF NO             YM7883 35958302
*        MUST BE AMB CONTROL BLOCK - ACB ALREADY SCREENED OUT    YM7883 35958502
         B     EIN01100                 EXIT                     YM7883 35959002
         EJECT                                                          35965602
EIN01900 EQU   *                        COPY DCB                        35966702
*                                                                       36000002
*        DCB COPY LEAVES BUSY BIT ALONE WHEN DEB= NOT CODED      YM7883 36000202
*                                                                       36008002
         IECRES INIT,DCBCOPY=TOWKAR,PREFIX=DXXPREFX, COPY DCB    Y02082*36010002
               STM=(3,14,DXXPREFX)      BUT NOT AMB              Y02082 36020002
         EJECT                                                          36020202
EIN01950 EQU   *                        DCB COPY SUCCESSFUL      Y02134 36190002
         SR    RET,RET                  ZERO BRANCH REG          YM1391 36192402
EIN01960 EQU   *                        GO TO IFG0551F           Y02082 36194002
         MVC   DXXMODID,MOD0Z5E         MOVE ID TO NAME                 36200021
         MVC   DXXMODEP+K1(K3),MOD0Z5E+K2 MODULE EP ADDRESS      Y02080 36300002
         B     EIN02100                 BR TO XCTL                      36400021
         SPACE 2                                                        36400202
EIN02000 EQU   *                        GO TO IFG0551B                  36500002
         BAL   R8,EIN01800              GETMAIN FOR EOV ROUTINES A44814 36600021
         MVC   DXXMODID,MOD2F5E         MOVE ID TO NAME                 36700021
         MVC   DXXMODEP+K1(K3),MOD2F5E+K2 MODULE EP ADDRESS      Y02080 36800002
         SR    RET,RET                  ZERO BRANCH REG          YM1391 36850002
EIN02100 EQU   *                        SET AUDIT TRAIL          Y02080 36900002
         CLC   DXXMODID,MOD0Z5E         GOING TO IFG0551F        Y02144 36950002
         BNE   EIN02110                 BR IF NO                 Y02144 36960002
         L     RF,DXATCOM3              GET RRPLIST PTR          Y02144 36962002
         USING RRPLIST,RF                                        Y02144 36964002
         OI    RRFLAGS2,RRFFIN1         SET 1ST LOAD COMPLETED   Y02144 36966002
         DROP  RF                                                Y02144 36968002
EIN02110 EQU   *                        GO TO NEXT MODULE        Y02080 36970002
         MVC   DXXMODNM(K6),IGG5E       MOVE IN NAME                    37000021
         CLC   DXXMODID,MOD2F5E         GOING TO IFG0551B        YM4610 37050002
         BE    EIN02120                 BRANCH IF YES, R6 HAS    YM4610 37060002
*                                       IOB ADDRESS              YM4610 37080002
         LA    R6,DXXMODNM              POINT TO NAME            Y02080 37100002
EIN02120 EQU   *                        GO TO NEXT MOD           YM4610 37150002
         IECRES LOAD,PREFIX=DXXPREFX,MODNM=DXXMODNM,             YM4610*37350002
               BRANCH=DIRECT            USE IFG019RA TO XCTL     YM4610 37352002
EIN02150 EQU   *                        VSAM                     YM1391 37360002
         LA    RET,K12                  BRANCH CODE FOR 551F     YM1391 37370002
         B     EIN01960                 GO TO IFG0551F           YM1391 37380002
         EJECT                                                          37390002
EIN02200 EQU   *                        BPAM EODAD                      38000002
*                                                                       38050002
*        END OF DATA READING A BPAM MEMBER                              38060002
*                                                                       38100021
         LA    R7,EABD174               ABEND 337 FOR PROB       M0067  38200021
*                                       DETER.                   M0067  38300021
         LNR   R7,R7                    INDICATE ABEND OTHER     M0067  38400021
*                                       THAN 001                 M0067  38500021
         BAL   R8,EIN03015              LINK TO SWAP REGS      @ZA02545 38540002
         TM    DCBEODAD+K3,K1           EODAD PRESENT            M0067  38600021
         BCR   1,RBASE                  YES - BRANCH TO ABEND    M0067  38700021
         NI    DCBIFLGS,X'FF'-DCBIFPIO  OFF WITH ERR FLAGS              39200002
         NI    DCBCIND1,ALLBITS-K48     TURN OFF VOLUME FULL BITS       39300021
         TM    DCBCIND2,DCBC2CHN       CHAINED SCHEDULING      @ZA02545 39320002
         BZ    EIN02300                NO                      @ZA02545 39340002
         L     RA,DCBIOBAD             YES - MUST TURN ON      @ZM33366 39360003
*                                      EXCP NEEDED FLAG        @ZA02545 39380002
         OI    K12(RA),K80             TURN ON FLAG            @ZA02545 39400002
EIN02300 EQU   *                       NO CHAINNED SCHEDULING  @ZA02545 39420002
*                                                                       39550002
         L     R9,SAVREG14              USERS REG 14           @ZA02545 39570002
         MODESET EXTKEY=SUPR            SVRB KEY               @ZA02545 39590002
*                                       INTO THE SVRB          @ZA02545 39610002
         ST    R9,RBGRS14               STORE USERS RET ADDR   @ZA02545 39630002
         L     RA,DCBEODAD              USER'S EODAD ADDRESS     Y02082 39800402
         L     RET,RBLINK               ADDR OF USERS RB         Y02082 39992002
         STCM  RA,B'0111',RBOPSW+K5     SET EODAD ADDR IN THE    Y02082 39994002
*                                       RESUME PSW               Y02082 39996002
*                                                                Y02080 40050002
*        RETURN TO CALLER                                        Y02080 40100002
*                                                                Y02080 40150002
         IECRES EXIT                    RETURN                   Y02080 40160002
         EJECT                                                          40170002
EIN02500 EQU   *                        BSAM/QSAM ERROR ANALYSIS        40600002
*                                                                       40650002
*        PERMANENT I/O ERROR DETECTED                                   40660002
*                                                                       40700021
         OI    DCBCIND2,DCBC2PIO        SET PERMANENT ERROR INDICATOR   40800021
         TM    DCBCIND2,DCBC2QSM        DCB USING QSAM                  40900021
         BO    EIN03000                 YES BRANCH                      41000021
*                                                                       41100021
*        BSAM ONLY PROCESSING                                           41110002
*                                                                       41150002
         TM    DCBSYNAD+K3,K1           SYNAD PRESENT                   41200021
         LA    R7,MSG1                  GET ADDR OF MSG -NO SYNAD EXIT- 41300021
         BCR   1,RBASE                  NO - BRANCH TO ABEND            41400021
         CLI   K4(RC),ALLBITS           ECB FLAGGED IN ERROR            41500021
         BNE   EIN02600                 NO BRANCH                       41600021
         OI    K0(RC),BIT2+BIT4         TURN ON N/P ILLOGICAL REQUEST   41700002
         NI    K4(RC),K0                TURN OFF ECB ERROR INDICATOR    41800021
*                                                                       41900021
EIN02600 EQU   *                        COLLECT SYNAD INFORMATION       42000002
*                                       FOR BOTH BSAM AND QSAM          42100002
*                                                                       42150002
         TM    K0(RC),IOBWRITE          LAST USED FOR WRITING           42200021
         BO    EIN02900                 YES, BRANCH                     42300021
         NI    K0(RC),ALLBITS-DCBMREAD  TURN OFF OLD READ BIT           42500021
         OI    K0(RC),UCBMOUNT          TURN ON NEW READ INDICATOR      42600021
         SR    RWTG,RWTG                CLEAR REG                       42700021
         IC    RWTG,DCBOFFSR            GET READ CCW OFFSET             42800021
         LA    RWTG,K8(RWTG,RC)         GET READ CCW OFFSET PLUS A48213 43000021
*                                       EIGHT IN IOB             A48213 43050021
         TM    DCBCIND1,K1              QSAM EXCHANGE                   43700021
         BZ    EIN02800                 NO, BRANCH                      43800021
         LH    R0,DCBEROPT+K4           GET BLOCK FACTOR                43900021
         BCTR  R0,K0                    REDUCE COUNT BY ONE             44000021
         SLL   R0,K3                    MULTIPLY BY EIGHT               44100021
         AR    RWTG,R0                  DETERMINE OFFSET                44200021
EIN02800 EQU   *                        SEE IF BLOCK IS IN CORE         44300002
*                                                                       44400021
         L     R7,K16(RC)               GET ADDR OF CSW                 44500021
         LA    R7,K0(R7)                CLEAR HIGH ORDER BIT            44600021
         CR    RWTG,R7                  COMPARE COMPUTED ADDR TO CSW    44700021
         BH    EIN02900                 BRANCH IF THE COMPUTED   A48213 44800021
*                                       ADDRESS IS HIGHER THAN   A48213 44850021
*                                       THAT IN THE CSW          A48213 44860021
         BL    EIN02850                 BR IF AHEAD OF THE      ZA00004 44870002
*                                       READ CSW                ZA00004 44880002
         LA    R1,K8                    GET BACKUP VALUE        ZA00004 44890002
         SR    R7,R1                    DECREMENT R7 BY 8       ZA00004 44892002
         CLC   K22(K2,RC),K6(R7)        COMPARE THE CCW COUNT   ZA00004 44894002
*                                       FIELD WITH THE CSW      ZA00004 44896002
*                                       COUNT FIELD AND BR IF   ZA00004 44898002
*                                       EQUAL - HAVE NOT READ   ZA00004 44898402
*                                       ANY DATA INTO CORE      ZA00004 44898802
         BE    EIN02900                 BR IF EQUAL -NO READ    ZA00004 44899202
*                                       DATA IN CORE - DO NOT   ZA00004 44899602
*                                       SET THE BLOCK IN CORE   ZA00004 44899702
*                                       INDICATOR               ZA00004 44899802
EIN02850 EQU   *                                                ZA00004 44899902
*                                                                       44900021
         OI    K0(RC),K16               SET BLOCK IN CORE INDICATOR     45000021
         EJECT                                                          45100002
EIN02900 EQU   *                        PLACE SYNAD INFO IN R1/R2       45200002
*                                       TAKE SYNAD EXIT IF BSAM         45300002
*                                                                       45350002
         IC    R1,K0(RC)                GET ERROR INDICATORS            45400021
         SLL   R1,K24                   SHIFT TO HIGH BYTE              45500021
         OR    R1,RDCB                  PUT DCBAD IN SAME REG           45600021
         LR    RDCB,R1                  SAVE DCB AND RETURN CODE        45700021
         L     RF,DCBSYNAD              GET SYNAD ADDRESS               45800021
         XR    R7,R7                    PUT ENTRY CODE INTO REG  A44814 45850021
         TM    DCBCIND2,DCBC2QSM        DCB USING QSAM                  45900021
         BO    EIN02000                 YES, BRANCH                     46100021
         LR    R0,RPAR                  GET DECB ADDRESS FOR USER       46200021
*                                                                Y02082 46300002
*        MOVE REGS 0-6 IN SVRB INTO CALLER'S SAVE AREA           Y02082 46350002
*        MOVE REGS 2-8 IN CALLER'S SAVE AREA INTO SVRB           Y02082 46400002
*                                                                       46450002
*        CONTROL SHOULD NOW BE IN THE CALLER'S PROTECT KEY       Y02082 46500002
         LM    RDCB,R8,SAVREG2          GET SAVE AREA REGS 2-8   Y02082 46550002
         MVC   SAVREG0(SAVREG7-SAVREG0),RBGRS0    MOVE SVRB      Y02082 46600002
*                                       REGS 0-6 INTO SAVE AREA  Y02082 46650002
         MODESET EXTKEY=SUPR            SVRB KEY                 Y02082 46700002
         STM   RDCB,R8,RBGRS2           PUT SAVE AREA REGS 2-8   Y02082 46750002
*                                       INTO SVRB                Y02082 46760002
*                                                                       46800021
*               RETURN TO CHECK                                         46900002
*                                                                Y02080 46950002
*        RETURN TO CALLER                                        Y02080 46960002
*                                                                Y02080 46970002
         IECRES EXIT                    RETURN                   Y02080 46980002
         EJECT                                                          46990002
EIN03000 EQU   *                        QSAM I/O ERROR ANALYSIS         47300002
*                                                                       47500021
         TM    DCBSYNAD+K3,K1           SYNAD PRESENT IN DCB            47600021
         LA    R7,K4                    PUT ENTRY CODE IN REG           47700021
         BO    EIN02000                 NO, BRANCH                      47800021
*                                                                       47900021
         TM    DCBCIND2,DCBC2PUT        DID THE ERROR OCCUR WHILE       48000021
*                                       WE WERE CLOSING THE DATA SET    48100021
         LA    R7,MSG2                  GET ADDR OF MSG -ERR CLOSE DS-  48200021
         BCR   1,RBASE                  YES - BRANCH CANNOT GO TO       48300021
*                                         SYNAD FROM CLOSE NOW          48400021
*                                                                       48500021
         B     EIN02600                 BR TO CHK IF READ OR WRITE      48600021
         SPACE 2                                                        48601002
EIN03005 EQU   *                        CALLER HOLDS TIOT EXC    YM3185 48602002
*                                                                       48604002
*   THE CALLER OF EOV HOLDS THE TIOT RESOURSE EXCLUSIVELY.     @ZA29752 48605037
*   THIS SHOULD NEVER VALIDLY HAPPEN AND CANNOT BE ALLOWED.    @ZA29752 48615037
*                                                                       48625037
         SR    RF,RF                    ZERO REG               @ZA29752 48635037
         SR    RC,RC                    ZERO REG               @ZA29752 48645037
         LA    RF,K16                   RETURN CODE            @ZA29752 48655037
         L     RC,ABND50D               ABEND CODE             @ZA29752 48665037
         ABEND (RC),DUMP                                       @ZA29752 48675037
         EJECT                                                          48700002
*                                                                       48700802
EIN03010 EQU   *                        SWAP REGS              @ZA02545 48704002
*                                                                       48704802
*********************************************************************** 48705602
*                                                                       48706402
*        PREPARE TO SWAP SVRB REGS WITH USER REGS IN SAVE AREA          48708002
*        R13 = USER SAVE AREA                                           48712002
*        R5 = SVRB WITH CALLERS REGS                                    48716002
*        IT IS NECESSARY TO SWAP REGS IF CALLER                         48716802
*        IS AN ACCESS METHOD ROUTINE BECAUSE ACCESS                     48717602
*        METHODS CALL EOV WITH ITS REGS INSTEAD OF                      48718402
*        PROBLEM PROGRAM REGS WHICH HAVE BEEN SAVED                     48719202
*        IN THE PROBLEM PROGRAM SAVE AREA:                              48719302
*        USER SAVE AREA WORD 8 - WORD 16 = USER REGS 0 - 8              48719402
*        SVRB REG0 - 8 = ACCESS METHOD REG 0 - 8                        48719502
*        NOTE1- THE SWAP IS NECESSARY FOR TAKING USER EXITS.            48719602
*        NOTE2- THE REGS ARE SWAPPED BACK BEFORE EOV EXIT.              48719702
*        NOTE3- UNLESS DCBMACRF = EXCP THE CALLER IS ASSUMED            48719802
*               TO BE AN ACCESS METHOD.                                 48719902
*                                                                       48724002
*********************************************************************** 48728002
*                                                                       48732002
         L     RF,CVTPTR                LOAD CVT PTR           @ZA02545 48732802
         L     RF,CVTTCBP-CVT(,RF)      LOAD TCB PTRS          @ZA02545 48733602
         L     RF,K4(,RF)               LOAD CURRENT TCB       @ZA02545 48734402
         USING TCB,RF                   TCB ADDRESSABILITY     @ZA02545 48735202
         MODESET EXTKEY=RBT234,WORKREG=15 CALLER KEY           @ZA02545 48736002
         TM    DCBMACRF,DCBMEXCP        IF EXCP - NOSWAP       @ZA02545 48743902
         BO    EIN03020                 RETURN IF EXCP         @ZA02545 48747902
*                                                                       48748702
EIN03015 EQU   *                        SWAP REGS              @ZA02545 48751902
*                                                                       48755902
         L     RF,CVTPTR                LOAD CVT PTR           @ZA02545 48756102
         L     RF,CVTTCBP-CVT(,RF)      LOAD TCB PTRS          @ZA02545 48756202
         L     RF,K4(,RF)               LOAD CURRENT TCB       @ZA02545 48756302
         L     RET,TCBRBP               LOAD RB POINTER        @ZA02545 48756402
         USING RBBASIC,RET              RB ADDRESSABILITY      @ZA02545 48756502
         MODESET EXTKEY=ZERO            RB KEY                 @ZA02545 48756602
         STM   R0,R8,RBEXSAVE           SAVE REGS 0-8          @ZA02545 48756902
         MODESET EXTKEY=RBT234,WORKREG=15 CALLER KEY           @ZA02545 48757502
         LM    R0,R8,SAVREG0            LOAD USERS 0-8         @ZA02545 48758302
         MVC   SAVREG0(K9*K4),RBGRS0    SAVE CALLER REGS       @ZA02545 48759102
         MODESET EXTKEY=ZERO            RB KEY                 @ZA02545 48759202
         STM   R0,R8,RBGRS0             SAVE USERS REGS        @ZA02545 48759302
         LM    R0,R8,RBEXSAVE           LOAD EOV REGS          @ZA02545 48759402
         XC    RBEXSAVE(K9*K4),RBEXSAVE CLEAR SAVE AREA        @ZA02545 48759502
*                                                                       48759602
EIN03020 EQU   *                        SWAP REGS              @ZA02545 48759702
*                                                                       48759802
         L     RF,CVTPTR                LOAD CVT PTR           @ZA02545 48763902
         L     RF,CVTTCBP-CVT(,RF)      LOAD TCB PTRS          @ZA02545 48767902
         L     RF,K4(,RF)               LOAD CURRENT TCB       @ZA02545 48768702
         MODESET EXTKEY=RBT234,WORKREG=15 CALLER KEY           @ZA02545 48769702
         BR    R8                       RETURN                 @ZA02545 48780002
         DROP  RET                                             @ZA02545 48784002
         DROP  RF                                              @ZA02545 48788002
         EJECT                                                          48790002
         DS    0F                                              @ZA29752 48793037
ABND50D  DC    XL4'0000050D'            ABEND 50D CODE         @ZA29752 48796037
         DS    0H                                                       48800021
ABCOD    DC    X'1000'                  HWD OF 1000 FOR ABEND REQUEST   48900021
MSG1     DC    AL2(ENDMSG1-*)           MSG LINE FOR NO SYNAD EXIT      49000021
         DC    AL2(1)                   MSG                             49100021
         DC    C'IEC020I NO ERROR HANDLING, ' MSG TEXT PART 1    A39511 49160002
         DC    C'(SYNAD), EXIT SPECIFIED' MSG TEXT PART 2        A39511 49220002
ENDMSG1  EQU   *                        END OF MSG1                     49300002
         SPACE 2                                                        49350002
         DS    0H                                                       49400021
MSG2     DC    AL2(ENDMSG2-*)           MSG FOR ERROR CLOSING DATA SET  49500021
         DC    AL2(2)                   MSG                             49600021
         DC    C'IEC020I ERROR OCCURRED ' MSG TEXT PART 1               49700002
         DC    C'WHILE CLOSING DATA SET' MSG TEXT PART 2                49750002
ENDMSG2  EQU   *                        END OF MSG 2                    49800002
         SPACE 2                                                        49850002
         DS    0H                                                       49900021
MSG3     DC    AL2(ENDMSG3-*)           MSG TO GET ISSUED FROM EODAD    50000021
         DC    AL2(5)                   RETURN CODE              A39511 50100002
         DC    C'IEC020I GET '          MSG TEXT PART 1        @ZA02977 50200037
         DC    C'ISSUED AFTER END-OF-FILE' MSG TEXT PART 2       A39511 50250002
ENDMSG3  EQU   *                        END OF MSG3                     50300002
         SPACE 2                                                        50350002
IGG5E    DC    C'IFG055'                IST 6 CHARA OF EOV MOD NAME     50500021
DEBCKSS  DEBCHK AM=SUBSYS,MF=L          DEBAMTYP FOR SUBSYSTEM   Y02120 50550002
         EJECT                                                          50600002
XCTLTA5E XCTLTABL ID=(MOD0Z5E,1F,MOD2E5E,1D,MOD2F5E,1B,          X02989X51852002
               EOV,IGC0005E,                                     Y02080X51852402
               MODPD5E,0P),SVC=055,BRT=YES,LENGTH=               Y02080 51854002
         EJECT                                                          51858002
         IECEQU AOS=YES,IEZDEB=YES                               YM2869 51870002
         IECDSECS DCB,ACB,UCB,MAIN,CVT,TCB,WTG,TIOT,PREFX,       YM2869*51910002
               RB,RRPL,IEZDEB,EXPAND=YES                         YM2869 51920002
         IDAAMB                                                  X02989 51940002
         EJECT                                                          51960002
SAVEAREA DSECT                                                   Y02082 51970002
*        THIS DSECT MAPS THE SAVE AREA OF THE CALLER OF THE      Y02082 51972002
*        ACCESS METHOD (BSAM/QSAM).                              Y02082 51974002
*        THE ACCESS METHOD  SAVES REGISTERS 14-8 IN              Y02082 51980002
*        THE CALLER'S SAVE AREA STARTING WITH THE SIXTH WORD     Y02082 51990002
*        OF THE SAVE AREA - OFFSET 20 (X'14').                   Y02082 51992002
*        THE ACCESS METHOD DOES NOT ALTER REGS 9-13. HENCE,      Y02082 52042002
*        THESE REGISTERS ARE IN THE CURRENT SVRB.                Y02082 52092002
         DS    F                                                 Y02082 52150002
         DS    F                                                 Y02082 52200002
SAVREG11 DS    F                                                 Y02082 52250002
SAVREG12 DS    F                                                 Y02082 52300002
SAVREG13 DS    F                                                 Y02082 52350002
SAVREG14 DS    F                                                 Y02082 52400002
SAVREG15 DS    F                                                 Y02082 52450002
SAVREG0  DS    F                                                 Y02082 52500002
SAVREG1  DS    F                                                 Y02082 52550002
SAVREG2  DS    F                                                 Y02082 52600002
SAVREG3  DS    F                                                 Y02082 52650002
SAVREG4  DS    F                                                 Y02082 52700002
SAVREG5  DS    F                                                 Y02082 52750002
SAVREG6  DS    F                                                 Y02082 52800002
SAVREG7  DS    F                                                 Y02082 52850002
SAVREG8  DS    F                                                 Y02082 52900002
SAVREG9  DS    F                                                 Y02082 52950002
SAVREG10 DS    F                                                 Y02082 53000002
         END   ,                                                 Y02082 53100002
./  ADD  SSI=70030068,NAME=IGC0006D
         TITLE 'IGC0006D/READ JFCB'                                     00100002
IGC0006D CSECT                                                          00200002
*                                                                       00300002
*          VS2 RELEASE 02 DELETIONS/CHANGES                             00400002
*0000313400,314100                                               YM3142 00402002
*0000                                                            YM3085 00410002
*0000                                                            YM1496 00420002
*0000                                                            YM1345 00440002
*0000                                                            YM4406 00450002
*0000379000                                                      YM5960 00490002
*          VS2 RELEASE 03 DELETIONS/CHANGES                             00500002
*0000                                                          @ZA02219 00600037
*35530000                                                      @ZA16013 00650037
*********************************************************************** 00700002
*                                                                     * 00800002
* MODULE NAME = IGC0006D (OS/VS2)                                     * 00900002
*                                                                     * 01000002
* DESCRIPTIVE NAME = READ JFCB                                        * 01100002
*                                                                     * 01200002
* COPYRIGHT = NONE                                                    * 01300002
*                                                                     * 01400002
* STATUS = RELEASE 2, LEVEL 0                                         * 01500002
*                                                                     * 01600002
* FUNCTION = THIS MODULE FIRST OBTAINS CORE FOR THE WTG TABLE AND     * 01700002
*            FOR THE RDJFCB WORK AREA.  IT THEN ASSUMES THE USER KEY. * 01800002
*            IF THE DCB IS NOT OPEN, IT SEARCHES THE DSAB CHAIN FOR   * 01900002
*            A TIOT ENTRY CONTAINING THE DCB DDNAME.  FOR AN OPEN     * 02000002
*            DCB, IT USES THE TIOT OFFSET IN THE DCB TO CALCULATE     * 02100002
*            THE TIOT ADDRESS.                                        * 02200002
*            AFTER VALIDITY CHECKING THE JFCB AREA ADDRESS (IF        * 02300002
*            RDJFCB WAS NOT CALLED BY A SYSTEM FUNCTION), IT          * 02400002
*            MOVES THE JFCB TO THE PROBLEM PROGRAM JFCB AREA.         * 02500002
*            IT THEN FREES THE WORK AREAS AND RETURNS.                * 02600002
*                                                                     * 02700002
* NOTES = SEE BELOW                                                   * 02800002
*                                                                     * 02900002
*    DEPENDENCIES =                                                   * 03000002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 03100002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03200002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03300002
*                                                                     * 03400002
*    RESTRICTIONS = NONE                                              * 03500002
*                                                                     * 03600002
*    REGISTER CONVENTIONS =                                           * 03700002
*            R2 POINTS TO THE DCB.                                    * 03800002
*            R3 IS THE BASE REGISTER.                                 * 03900002
*            R4 POINTS TO THE RDJFCB WORK AREA.                       * 04000002
*            R5 POINTS TO THE RESIDENT ROUTINE.                       * 04100002
*            R6 POINTS TO THE WTG TABLE.                              * 04200002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY.           * 04300002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT.                   * 04500002
*                                                                     * 04600002
*    PATCH LABEL = IHB0023D (THIRD LABEL BEFORE ORG STATEMENT AT END  * 04700002
*                  OF LISTING).                                       * 04800002
*                                                                     * 04900002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 05000002
*                                                                     * 05100002
*    PROCESSOR = ASSEMBLER XF                                         * 05200002
*                                                                     * 05300002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 05400002
*                  ORG STATEMENT AT END OF LISTING                    * 05500002
*                                                                     * 05600002
*    ATTRIBUTES = REENTRANT, REFRESHABLE ,READ-ONLY, ENABLED,         * 05700002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT AND   * 05800002
*                 USER KEY, LINK PACK AREA RESIDENT/PAGEABLE.         * 05900002
*                                                                     * 06000002
* ENTRY POINT = IGC0006D FROM A RDJFCB MACRO OR AN SVC 64.            * 06100002
*                                                                     * 06200002
*    PURPOSE = SEE FUNCTION                                           * 06300002
*                                                                     * 06400002
*    LINKAGE = THIS MODULE IS ENTERED VIA AN SVC 64.                  * 06500002
*                                                                     * 06600002
* INPUT = REGISTER 1 POINTS TO THE PARAMETER LIST.                    * 06700002
*                                                                     * 06800002
* OUTPUT = THE JFCB IS MOVED TO THE PROBLEM PROGRAM AREA.             * 06900002
*                                                                     * 07000002
* EXIT-NORMAL = RETURN TO THE CALLER.                                 * 07100002
*                                                                     * 07200002
* EXIT-ERROR = ABEND WITH A 140 OR 240 CODE.                          * 07300002
*              POSSIBLE INTERNAL CODES ARE:                           * 07400002
*              CODE    MEANING                                        * 07500002
*               79     NO FOUNDATION EXTENSION PRESENT IN AN EXCP DCB * 07600002
*               80     NO EXIT LIST                                   * 07700002
*               81     NO EXIT LIST ENTRY                             * 07800002
*               82     INVALID JFCB AREA ADDRESS                      * 07900002
*                                                                     * 08000002
* EXTERNAL REFERENCES = SEE BELOW                                     * 08100002
*                                                                     * 08200002
*    ROUTINES = SETLOCK                                               * 08300002
*               WTO                                                   * 08400002
*               IECRES                                                * 08500002
*                                                                     * 08600002
*    DATA AREAS = PROBLEM PROGRAM JFCB AREA                           * 08700002
*                                                                     * 08800002
*    CONTROL BLOCKS = CVT                                             * 08900002
*                     DCB                                             * 09000002
*                     DSAB                                            * 09100002
*                     JSCB                                            * 09200002
*                     QDB                                             * 09300002
*                     PSA                                             * 09400002
*                     RB                                              * 09500002
*                     TCB                                             * 09600002
*                     TIOT                                            * 09700002
*                                                                     * 09800002
* TABLES = WTG TABLE, RDJFCB WORK AREA                                * 09900002
*                                                                     * 10000002
* MACROS = DMABCOND                                                   * 10100002
*          IECDSECS                                                   * 10200002
*          IECRES                                                     * 10300002
*          MODESET                                                    * 10400002
*          XCTLTABL                                                   * 10500002
*                                                                     * 10600002
* CHANGE ACTIVITY = SEE CHANGES/DELETIONS AFTER CSECT STATEMENT       * 10700002
*                                                                     * 10800002
*********************************************************************** 10900002
         EJECT                                                          11000002
*                                                                       11100002
         IECEQU AOS=YES                                          Y02080 11200002
OABD079  EQU   79                                                       11300002
OABD080  EQU   80                                                       11400002
OABD081  EQU   81                                                       11500002
OABD082  EQU   82                                                       11600002
MCSFLAG  EQU   X'80'                    WTP FLAGS FOR MSG        Y02080 11700002
         EJECT                                                   Y02080 11800002
         USING TIOENTRY,RTIOT                                           11900002
         USING IHADCB,RDCB                                              12000002
         BALR  RBASE,0                                                  12100002
         USING *,RBASE                                                  12200002
*                                                                Y02080 12300002
*   GETMAIN THE WHERE-TO-GO TABLE                                Y02080 12400002
*                                                                Y02080 12500002
         USING RBBASIC,RA               RB ADDRESSABILITY        YM1496 12600002
         LR    RA,R5                    GET SVRB ADDRESS         YM1496X12700002
                                        (INITIALIZED BY SLIH)    YM1496 12800002
         IECRES GET,PREFIX=WTG,A=(R1),  GETMAIN FOR WTG TABLE    Y02080*12900002
               STM=(2,12,RBEXSAVE)                               Y02080 13000002
*                                                                Y02080 13100002
*  ON RETURN FROM GET, THE PARAMETER LIST HAD BEEN MOVED INTO    Y02080 13200002
*  THE WORK AREA. HENCE PROTECTED ADDRESS MUST BE GOTTEN.        Y02080 13300002
*                                                                Y02080 13400002
*  FURTHERMORE, THE ENQ ON THE TIOT HAS BEEN DONE IN THE GET     Y02080 13500002
*  ROUTINE FOR WTG.                                              Y02080 13600002
*                                                                Y02080 13700002
         LR    RWTG,R1                  ADDR WTG TABLE FROM GET  Y02080 13800002
         USING WTG,RWTG                 WTG TABLE ADDRESSABILITY Y02080 13900002
         L     R8,WTGPREFX              ADDR BASE PREFIX         Y02080 14000002
         USING IECPREFX,R8              BASE PREFIX ADDR         Y02080 14100002
         L     RB,IECRRPRM              GET RRPLIST ADDRESS      Y02144 14200002
         MVI   RRFUNCTN-RRPLIST(RB),RRFRJFCB  INDICATE RDJFCB    Y02144X14300002
                                        FUNCTION FOR RECOVERY    Y02144 14400002
*                                                                       14450002
         IECRES LOAD,BRANCH=NO,MODNM=RDJFCB,PREFIX=WTGPREFX      YM5960X14460002
                                        LET OPTIONAL TRACE PRINT YM5960X14470002
                                        THIS MODULE'S NAME       YM5960 14480002
*                                                                       14490002
         L     RPAR,IECUPRML            ADDR PROT PARAM LIST     Y02080 14500002
         LR    RPARC,RPAR               GET ADDR. OF PARAM ENTRY Y02080 14600002
         SR    RC,RC                    USE REG 12 TO COUNT NUM  Y02080 14700002
*                                       DCBS IN PARALIST                14800002
         SR    RD,RD                    ZERO RETURN CODE REG     Y02080 14900002
         IECRES GET,PREFIX=YES,LV=OPENSIZE,STM=(2,14,WTGPREFX),  Y02080*15000002
               ID=RJWA                  WORK AREA FOR MSG/KEY/.. Y02080 15100002
         LR    RCORE,R1                 SET ADDR WORK AREA       Y02080 15200002
         USING FORCORE,RCORE            WORK AREA ADDRESSABILITY Y02080 15300002
         ST    RCORE,WTGENTRY+K4        SAVE WORK AREA ADDRESS   Y02080 15400002
         ST    RB,DXATCOM3              SAVE RRPLIST PTR IN W/A  Y02144 15500002
         L     RA,RBLINK                GET CALLER'S RB          Y02080 15600002
         MVC   DXUKEY,RBOPSW+K1         MOVE KEY,AMWP TO WORKAR  Y02080 15700002
         NI    DXUKEY,KEYMASK           ZERO AMWP FIELD          YM1496 15800002
         DROP  RA                                                Y02080 15900002
         MODESET KEYADDR=DXUKEY,WORKREG=2  ASSUME USER KEY       Y02080 16000002
*                                                                Y02080 16100002
*  THIS SECTION PROCESSES EACH DCB IN THE PARAMETER LIST.        YM1496 16200002
*                                                                Y02080 16300002
OP1010   EQU   *                                               @ZA16096 16400037
         LA    RC,K1(RC)                BUMP DCB COUNT           Y02080 16500002
         L     RDCB,PLISTDCB(,RPARC)    DCB ADDR.                Y02080 16600002
         TM    DCBOFLGS,DCBOLOCK        CHECK LOCK BIT           YM1496 16700002
         BO    OP1040                   BRANCH IF ON             Y02080 16800002
         LA    RD,K4                    SET RETURN CODE OF 4   @ZA02219 16850037
OP1020   EQU   *                        GET DCB                         16900002
         TM    PLISTOPT(RPARC),LASTNTRY  CHECK FOR LAST ENTRY    Y02080 17000002
         BO    OP1110                   BRANCH IF YES            Y02080 17100002
         LA    RPARC,K4(,RPARC)         ADDR NEXT DCB ADDR       Y02080 17200002
         B     OP1010                   PROCESS NEXT DCB         Y02080 17300002
*                                                                       17400002
* THIS SECTION CALCULATES THE TIOT ADDRESS FOR AN OPENED DCB.           17500002
*                                                                       17600002
OP1040   EQU   *                        LOCK BIT ON                     17700002
         L     RET,CVTADDR              GET POINTER TO CVT       Y02080 17800002
         L     RET,CVTTCBP-CVT(RET)     GET TCB WORDS            Y02080 17900002
         L     RET,K4(RET)              ADDR OF ACTIVE TCB       Y02080 18000002
         L     RTIOT,TCBTIO-TCB(,RET)   GET TIOT ADDRESS         Y02080 18100002
*                                                                       18200002
         TM    DCBOFLGS,DCBOPEN         CHECK FOR OPENED DCB     YM1496 18300002
         BNO   OP1045                   BRANCH IF NO             Y02080 18400002
         AH    RTIOT,DCBTIOT            PTR TO TIOT ENTRY               18500002
         B     OP1060                   CONTINUE                 Y02080 18600002
*                                                                       18700002
* IF THE DCB IS NOT OPEN, THIS SECTION SEARCHES FOR A TIOT ENTRY        18800002
* CONTAINING THE DCB DDNAME.                                            18900002
*                                                                       19000002
OP1045   EQU   *                        DCB NOT OPEN                    19100002
         CLI   DCBDDNAM,BLANK           CHECK FOR BLANK DDNAME FIELD    19200002
         BE    OPJWTP                   IF IT IS, ISSUE WTP             19300002
         L     RF,TCBJSCB-TCB(,RET)     TCB'S JSCB               Y02134 19400002
         USING IEZJSCB,RF                                        Y02134 19500002
         L     RF,JSCBACT               ACTIVE JSCB FOR TASK     Y02134 19600002
         L     RF,JSCDSABQ              DSAB QDB                 Y02134 19700002
         USING QDB,RF                                            Y02134 19800002
         L     RF,QDBFELMP              FIRST DSAB               Y02134 19900002
OP1050   EQU   *                        DSAB PROCESSING                 20000002
         LTR   RF,RF                    IS THERE A DSAB          Y02134 20100002
         BZ    OP1055                   BRANCH IF NOT - NO       Y02134X20200002
                                        DD STATEMENT FOR DCB     Y02134 20300002
         USING DSAB,RF                                           Y02134 20400002
         L     RTIOT,DSABTIOT           GET TIOT ENTRY           Y02134 20500002
         CLC   DCBDDNAM,TIOEDDNM        LOOK FOR NAME IN TIOT    YM1496 20600002
         BE    OP1060                   BRANCH IF FOUND          Y02134 20700002
         L     RF,DSABFCHN              GET NEXT DSAB            Y02134 20800002
         B     OP1050                   TEST NEXT DSAB           Y02134 20900002
*                                                                       21000002
OP1055   EQU   *                        NO DSAB                         21100002
         LA    RD,K4                    SET RETURN CODE OF 4     Y02080 21200002
         B     OP1020                   GET NEXT DCB                    21300002
*                                                                       21400002
* THIS SECTION TEST THAT AN EXIT LIST ENTRY EXISTS.                     21500002
*                                                                       21600002
OP1060   EQU   *                        NAME IN TIOT                    21700002
         TM    DCBOFLGS,DCBOPEN         CHECK FOR OPENED DCB     YM1496 21800002
         BNO   OPJ99                    BRANCH IF NO             Y02080 21900002
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP            YM1345 22000002
         BNO   OPJ100                   BRANCH IF NO             Y02080 22100002
         LA    R0,OABD079               LOAD INTERNAL CODE 79    Y02080 22200002
         TM    DCBMACRF,DCBMFOUN        TEST FOR FOUNDATION EXT  YM1345 22300002
         BNO   OPJERR                   BRANCH IF NO             Y02080 22400002
         B     OPJ100                   CONTINUE                        22500002
OPJ99    EQU   *                        DCB NOT OPENED                  22600002
         TM    DCBMACR,DCBMEXCP         IS IT EXCP METHOD        YM1496 22700002
         BNO   OPJ100                   BRANCH IF NO             Y02080 22800002
         LA    R0,OABD079               LOAD INTERNAL CODE 79    Y02080 22900002
         TM    DCBMACR,DCBMFOUN         TEST FOR FOUNDATION EXT  YM1496 23000002
         BNO   OPJERR                   BRANCH IF NO             Y02080 23100002
OPJ100   EQU   *                        CONTINUE PROCESSING             23200002
         LA    R0,OABD080               LOAD INTERNAL CODE 80    Y02080 23300002
         NC    DCBEXLSA,DCBEXLSA        CHECK IF EXLST PROVIDED  YM1496 23400002
         BZ    OPJERR                   NO, CALL PD                     23500002
         TM    DCBEXLST+K3,X02+X01      CHECK FULLWORD BOUNDARY  Y02080 23600002
         BC    5,OPJERR                 BR IF INVALID ADDRESS    YM1496 23700002
         L     RF,DCBEXLST              ADDR OF EXIT LIST        Y02080 23800002
OPJ110   EQU   *                        EXIT LIST PROCESSING            23900002
         CLI   0(RF),XLRDJFCB           IS EXIT 7 ACTIVE         YM1496 24000002
         BE    OPJFOUND                 BRANCH IF YES            Y02080 24100002
         CLI   0(RF),LASTNTRY+XLRDJFCB  IS EXIT 7 ACTIVE         YM1496 24200002
         BE    OPJFOUND                 BRANCH IF YES            Y02080 24300002
         LA    R0,OABD081               LOAD INTERNAL CODE 81    Y02080 24400002
         TM    0(RF),LASTNTRY           LAST ENTRY IN LIST       YM1496 24500002
         BO    OPJERR                   ERROR NO EXIT LIST ENTRY Y02080 24600002
         LA    RF,K4(RF)                ADDR OF NEXT ENTRY       Y02080 24700002
         B     OPJ110                   GO TO EXIT PROCESS              24800002
*                                                                       24900002
         EJECT                                                   Y02080 25000002
OPJFOUND EQU   *                        EXIT 7 ACTIVE                   25100002
         L     RA,K0(,RF)               ADDR USER JFCB AREA      Y02080 25200002
         LA    RA,0(,RA)                CLEAR HIGH ORDER BYTE    Y02080 25300002
         LA    RB,TIOEJFCB              JFCB PREFIX POINTER      Y02134 25400002
         IECRES LOCJFCB,(RB)            LOCATE JFCB              Y02134 25500002
         TM    JFCBMASK+K6-INFMJFCB(RB),JFCTRACE  TEST IF TRACE  Y02080C25600002
                                        ROUTINE IS DESIRED       YM1496 25700002
         BZ    OPJFOUN1                 NO, CONTINUE             Y02080 25800002
         MODESET EXTKEY=DATAMGT         SWITCH TO DATAMGT KEY    YM4406 25850002
         OI    WTGPATHS+K1,WTGTRACE     YES, TURN ON TRACE INDR  Y02080 25900002
         MODESET KEYADDR=DXUKEY,WORKREG=15  RETURN TO USER KEY   YM4406 25950002
OPJFOUN1 EQU   *                        CONTINUE JFCB PROCESS    Y02080 26000002
         CLI   DXUKEY,X'80'             USER KEY 0 - 7           Y02080 26100002
         BL    OPJ220                   BRANCH IF SYSTEM KEY     Y02080 26200002
*                                                                Y02080 26300002
*  PERFORM VALIDITY CHECK IF NOT SYSTEM CALLER                   Y02080 26400002
*                                                                Y02080 26500002
         MODESET EXTKEY=ZERO            KEY FOR SETLOCK,VAL CHK  Y02080 26600002
         STM   R1,RF,IECREGSV           SAVE REGISTERS           Y02080 26700002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02080*26800002
               RELATED=(LOCAL,IGC0006D(OPJ180,OPJERR0))          Y02080 26900002
         LM    R1,RF,IECREGSV           RESTORE REGISTERS        Y02080 27000002
         LR    R1,RA                    START USER JFCB AREA     Y02080 27100002
         LA    R2,L'DXJBF-K1(,RA)       END USER JFCB AREA       Y02080 27200002
         XR    R4,R4                    INDIC USE CURRENT TCB    Y02080 27300002
         L     RF,CVTADDR               LOAD CVT ADDRESS         Y02080 27400002
         L     RF,CVT0VL00-CVT(,RF)     ADDR VAL CHK ROUTINE     Y02080 27500002
         BALR  RET,RF                   VALIDITY CHK USER JFCB   Y02080 27600002
         LM    R1,RF,IECREGSV           RESTORE REGISTERS        Y02080 27700002
         LA    R0,OABD082               INVALID ADDR ABEND CODE  Y02080 27800002
         BNZ   OPJERR0                  BRANCH IF NOT VALID      Y02080 27900002
*                                                                Y02080 28000002
         MVC   K0(L'DXJBF,RA),K0(RB)    MOVE IN SYSTEM JFCB      Y02080 28100002
         SETLOCK RELEASE,TYPE=LOCAL,                             Y02080*28200002
               RELATED=(LOCAL,IGC0006D(OPJ150))                  Y02080 28300002
         LM    R1,RF,IECREGSV           RESTORE REGISTERS        Y02080 28400002
         MODESET KEYADDR=DXUKEY,WORKREG=15  RETURN TO USER KEY   Y02080 28500002
         B     OP1020                   PROCESS NEXT DCB         Y02080 28600002
*                                                                Y02080 28700002
*  FOR SYSTEM KEY CALLERS, PERFORM JFCB MOVE IN THEIR KEY.       Y02080 28800002
*  IF THE ADDRESS IS NOT VALID, AN ADDRESSING/PROTECTION/PAGING  Y02080 28900002
*  EXCEPTION WILL OCCUR.                                         Y02080 29000002
*                                                                Y02080 29100002
OPJ220   EQU   *                        SYSTEM KEY               Y02080 29200002
         MVC   K0(L'DXJBF,RA),K0(RB)    MOVE JFCB TO USER AREA   Y02080 29300002
         B     OP1020                   PROCESS NEXT DCB         Y02080 29400002
*                                                                Y02080 29500002
*  ALL DCBS HAVE BEEN PROCESSED.  FREE THE WORK AREAS AND        Y02080 29600002
*  EXIT TO THE USER.                                             Y02080 29700002
*                                                                Y02080 29800002
OP1110   EQU   *                        LAST ENTRY                      29900002
         LR    RF,RD                    SAVE RETURN CODE         Y02080 30000002
         MODESET EXTKEY=DATAMGT         KEY OF WORK AREAS        Y02080 30100002
         IECRES FREE,PREFIX=WTG,A=(RWTG)  FREE ALL WORK AREAS    Y02080*30200002
                                        AND DEQ THE TIOT         Y02080 30300002
         IECRES EXIT                    RETURN                   Y02080 30400002
         EJECT                                                   Y02080 30500002
*                                                                Y02080 30600002
*  ERROR HANDLING                                                Y02080 30700002
*                                                                Y02080 30800002
OPJERR0  EQU   *                        INVALID ADDRESS          YM3861 30900002
         SETLOCK RELEASE,TYPE=LOCAL,                             Y02080*31000002
               RELATED=(LOCAL,IGC0006D(OPJ150))                  Y02080 31100002
         LM    R1,RF,IECREGSV           RESTORE REGISTERS        Y02080 31200002
OPJERR   EQU   *                        GO TO PROBLEM DETERMINATION     31300002
         TM    DCBOFLGS,DCBOPEN         CHECK FOR AN OPENED DCB  YM3085 31310002
         BNO   OPJERR10                 BRANCH IF NOT            YM3085 31320002
         MODESET EXTKEY=DATAMGT         O/C/E KEY FOR P.D.       Y02080 31330002
         IECRES INIT,DEB=YES,DCBCOPY=TOWKAR,STM=(3,0,WTGPREFX)   YM3142X31340002
                                        COPY AN OPENED DCB FOR   YM3085X31350002
                                        PROBLEM DETERMINATION    YM3085 31360002
         B     OPJERR20                 GO BRANCH TO P.D.        YM3085 31370002
*                                                                YM3085 31380002
OPJERR10 EQU   *                        COPY AN UNOPENED DCB     YM3085 31390002
         MODESET EXTKEY=DATAMGT         SWITCH TO O/C/E KEY      YM3085 31400002
         IECRES INIT,DEB=NO,DCBCOPY=TOWKAR,STM=(3,0,WTGPREFX)    YM3142X31410002
                                        COPY AN UNOPENED DCB FOR YM3085X31420002
                                        PROBLEM DETERMINATION    YM3085 31430002
*                                                                YM3085 31440002
OPJERR20 EQU   *                        GO TO PROB DETERMINATION YM3085 31450002
         LA    RWTGC,WTGENTRY           INIT CURRENT ENTRY PTR   Y02080 31500002
         MVC   WTGMODNM(K6),PDLOAD      MOVE IN PROB DET NAME    YM1345 31600002
         L     R5,CVTADDR               CVT ADDRESS              Y02080 31700002
         L     R5,CVTDMSR-CVT(,R5)      ADDR RESIDENT ROUTINE    Y02080 31800002
         DMABCOND (0),PDLOAD+K6         ABEND 140 OR 240         Y02080 31900002
*                                                                Y02080 32000002
*  MESSAGE TO PROGRAMMER FOR BLANK DDNAME IN THE DCB             Y02080 32100002
*                                                                Y02080 32200002
OPJWTP   EQU   *                        BUILD WTP MESSAGE        YM1496 32300002
         USING TIOT,RTIOT               START OF TIOT            Y02080 32400002
         MODESET EXTKEY=DATAMGT         RDJFCB WORK AREA KEY     Y02080 32500002
         LR    RET,RCORE                ADDR MSG AREA            Y02080 32600002
         XC    K0(K76,RET),K0(RET)      CLEAR MSG AREA           Y02080 32700002
         LA    RET,K4(RET)              BUMP PTR TO ACCOUNT FOR  Y02080 32800002
*                                       LENGTH AND MCS FLAGS            32900002
         MVC   K0(L'MSGID,RET),MSGID    MOVE ID OF MSG TO BUFFER        33000002
         LA    RET,L'MSGID(RET)         BUMP PTR TO BUFFER              33100002
         STC   RC,K8(RET)               STORE DCB COUNT IN BUFFER       33200002
         MVO   K6(K2,RET),K8(K1,RET)    SHIFT IN ORDER TO UNPACK        33300002
*                                       AND CONVERT TO EBCDIC           33400002
         UNPK  K0(K2,RET),K6(K2,RET)    UNPACK DCB COUNT                33500002
         OI    K1(RET),CHAR0            CONVERT SIGN                    33600002
         TR    K0(K2,RET),EBCTBL        TRANSLATE TO EBCDIC             33700002
         MVI   K2(RET),COMMA            MOVE COMMA TO MSG               33800002
         LA    RET,K3(RET)              BUMP BUFFER PTR                 33900002
         MVC   K0(K8,RET),TIOCNJOB      MOVE JOBNAME TO BUFFER   Y02080 34000002
         LA    RET,K7(RET)              BUMP PTR                        34100002
         BAL   RA,OPJCLR                CLEAR TRAILING BLANKS           34200002
         MVC   K0(K8,RET),TIOCSTEP      MOVE STEPNAME TO BUFFER  Y02080 34300002
         LA    RET,K7(RET)              BUMP PTR                        34400002
         BAL   RA,OPJCLR                CLEAR TRAILING BLANKS           34500002
         MVC   K0(L'BLANKDDN+K4,RET),BLANKDDN                           34600002
*                                       MOVE MSG TO BUFFER              34700002
         LA    RET,L'BLANKDDN(RET)      POINT TO END OF MSG             34800002
         SR    RET,RCORE                CALCULATE MSG LENGTH     Y02080 34900002
         STH   RET,K0(RCORE)            STORE IN MSG             Y02080 35000002
         OI    K2(RCORE),MCSFLAG        SET MCS FLAGS            Y02080 35100002
         LR    RET,RCORE                SAVE BUFFER PTR          Y02080 35200002
         LR    R1,RCORE                 SET ADDR WTO             Y02080 35300002
         WTO   MF=(E,(1))               ISSUE WRITE-TO-PROG             35400002
         LA    RD,K4                    SET RETURN CODE                 35500002
         MODESET KEYADDR=DXUKEY,WORKREG=2  ASSUME USER KEY     @ZA16096 35550037
         B     OP1020                   GET NEXT ENTRY IN PARAMLIST     35600002
*                                       THIS ROUTINE WILL MOVE          35700002
*                                       TRAILING BLANKS FROM VARIABLE   35800002
*                                       LENGTH FIELDS IN THE MESSAGE    35900002
*                                       SUCH AS JOBNAME AND STEPNAME    36000002
OPJCLR   EQU   *                        CLEAR TRAILING BLANKS    YM1496 36100002
         CLI   K0(RET),BLANK            BLANK CHARACTER                 36200002
         BNE   OPJCLR2                  NO, MOVE COMMA AND RETURN       36300002
         BCT   RET,OPJCLR               POINT TO PRECEDING CHARACTER    36400002
*                                       AND CHECK IT                    36500002
OPJCLR2  EQU   *                        MOVE COMMA                      36600002
         MVI   K1(RET),COMMA            MOVE COMMA TO BUFFER            36700002
         LA    RET,K2(RET)              UPDATE BUFFER PTR               36800002
         BR    RA                       RETURN                          36900002
*                                                                       37000002
EBCTBL   EQU   *-240                    START OF CONVERT TABLE          37100002
         DC    C'0123456789ABCDEF'      TABLE TO CONVERT UNPACKED DATA  37200002
*                                       TO EBCDIC                       37300002
MSGID    DC    C'IEC131I '              ID OF WTP MSG                   37400002
BLANKDDN DC    C'RDJFCB ISSUED FOR DCB WITH A BLANK DDNAME'             37500002
*                                       WRITE-TO-PROG MSG               37600002
         DC    X'04000020'              MCSFLAGS                        37700002
*                                                                       37800002
         XCTLTABL ID=(RDJFCB,IGC0006D,PDLOAD,IGG0196M),          YM5960X37850002
               SVC=064,BRT=YES,LENGTH=                           YM5960 37900002
         IECDSECS MAIN,DCB,CVT,TCB,TIOT,WTG,RB,PREFX,PSA,        Y02134*38000002
               JSCB,QDB,DSAB,RRPL,EXPAND=YES                     Y02144 38100002
         END                                                            38200002
./  ADD  SSI=73010456,NAME=IGC0010C
   TITLE 'IGC0010C - SVC 103 - EBCDIC/ASCII TRANSLATE SVC ROUTINE'      00400020
IGC0010C CSECT                                                          00800002
*                                                                       00900002
*        VS2 RELEASE 03 DELETIONS/CHANGES                               00950000
*0000796000                                                     ZA00005 00960000
*        VS2 RELEASE 02 DELETIONS/CHANGES                               01000002
*0000220000,292500,552000-560000                                 YM1440 01001002
*                                                                       01100002
*                                                                       01200002
*                                                                       01300002
*                                                                       01400002
*********************************************************************** 01500002
*                                                                     * 01600002
* MODULE NAME = IGC0010C (OS/VS2)                                     * 01700002
*                                                                     * 01800002
* DESCRIPTIVE NAME = SVC 103 - EBCDIC/ASCII TRANSLATE SVC ROUTINE     * 01900002
*                                                                     * 02000002
* COPYRIGHT = NONE                                                    * 02100002
*                                                                     * 02200002
* STATUS = RELEASE 2, LEVEL 0                                         * 02300002
*                                                                     * 02400002
* FUNCTION =                                                          * 02500002
*        1. TRANSLATE FROM ASCII CODE TO EBCDIC CODE OR FROM          * 02600002
*        EBCDIC TO ASCII CODE DEPENDING UPON BIT 0 OF REGISTER 1:     * 02700002
*           BIT 0 = 0 ASCII TO EBCDIC,                                * 02800002
*           BIT 0 = 1 EBCDIC TO ASCII.                                * 02900002
*                                                                     * 03000002
*        2. REGISTER 1 ALSO CONTAINS THE ADDRESS OF THE CODE TO BE    * 03100002
*        TRANSLATED, AND REGISTER 0 CONTAINS THE NUMBER OF BYTES TO   * 03200002
*        BE TRANSLATED.                                               * 03300002
*                                                                     * 03400002
*        3. TRANSLATION IS BY TABLE LOOKUP WITH THE BYTE BEING        * 03500002
*        TRANSLATED USED AS AN INDEX VALUE TO OBTAIN THE              * 03600002
*        APPROPRIATE TRANSLATED CODE. THE TRANSLATED CODE             * 03700002
*        REPLACES THE ORIGINAL CODE IN CORE. SUBSTITUTION CODE        * 03800002
*        IS SUPPLIED FOR ALL BYTES THAT HAVE NO STANDARD TRANSLATION. * 03900002
*                                                                     * 04000002
* NOTES = SEE BELOW                                                   * 04100002
*                                                                     * 04200002
*    DEPENDENCIES =                                                   * 04300002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 04400002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 04500002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 04600002
*                                                                     * 04700002
*    RESTRICTIONS = NONE                                              * 04800002
*                                                                     * 04900002
*    REGISTER CONVENTIONS =                                           * 05000002
*            REGISTER 0 CONTAINS THE NUMBER OF BYTES REMAINING        * 05100002
*            TO BE TRANSLATED.                                        * 05200002
*            REGISTER 1 POINTS TO THE DATA TO BE TRANSLATED.          * 05300002
*            REGISTER 3 POINTS TO THE CVT.                            * 05400002
*            REGISTER 4 POINTS TO THE TCB.                            * 05500002
*            REGISTER 6 IS THE BASE REGISTER.                         * 05600002
*                                                                     * 05700002
*    PATCH LABEL = IHB0008D (THIRD LABEL BEFORE ORG STATEMENT AT END  * 05800002
*                  OF LISTING).                                       * 05900002
*                                                                     * 06000002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 06100002
*                                                                     * 06200002
*    PROCESSOR = ASSEMBLER XF                                         * 06300002
*                                                                     * 06400002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 06500002
*                  ORG STATEMENT AT END OF LISTING                    * 06600002
*                                                                     * 06700002
*    ATTRIBUTES = REENTRANT, REFRESHABLE, READ-ONLY, ENABLED,         * 06800002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 06900002
*                 LINK PACK AREA RESIDENT/PAGEABLE.                   * 07000002
*                                                                     * 07100002
* ENTRY POINT = IGC0010C FROM SVC 103 (XLATE MACRO)                   * 07200002
*                                                                     * 07300002
*    PURPOSE = SEE FUNCTION                                           * 07400002
*                                                                     * 07500002
*    LINKAGE = THIS MODULE IS ENTERED VIA AN SVC 103.                 * 07600002
*                                                                     * 07700002
* INPUT = REGISTER 0 CONTAINS THE NUMBER OF BYTES TO BE TRANSLATED.   * 07800002
*         REGISTER 1 INDICATES THE DIRECTION OF TRANSLATION AND       * 07900002
*         CONTAINS THE ADDRESS OF THE DATA.                           * 08000002
*         REGISTER 3 POINTS TO THE CVT (INITIALIZED BY THE SLIH).     * 08100002
*         REGISTER 4 POINTS TO THE TCB (INITIALIZED BY THE SLIH).     * 08200002
*                                                                     * 08300002
* OUTPUT = THE TRANSLATED DATA REPLACES THE ORIGINAL DATA.            * 08400002
*          REGISTER 15 CONTAINS A RETURN CODE.                        * 08500002
*                                                                     * 08600002
* EXIT-NORMAL = RETURN TO CALLER WITH A RETURN CODE OF 0 IN REG 15.   * 08700002
*                                                                     * 08800002
* EXIT-ERROR = RETURN TO CALLER WITH AN ERROR CODE IN REGISTER 15:    * 08900002
*              4 = ZERO OR NEGATIVE NUMBER OF BYTES TO TRANSLATE      * 09000002
*              8 = INVALID DATA ADDRESS.                              * 09100002
*                                                                     * 09200002
* EXTERNAL REFERENCES = SEE BELOW                                     * 09300002
*                                                                     * 09400002
*    ROUTINES = SETLOCK                                               * 09500002
*               TESTAUTH                                              * 09600002
*                                                                     * 09700002
*    DATA AREAS = DATA AREA POINTED TO BY REGISTER 1 AT ENTRY.        * 09800002
*                                                                     * 09900002
*    CONTROL BLOCKS = CVT                                             * 10000002
*                     PSA                                             * 10100002
*                     RB                                              * 10200002
*                     TCB                                             * 10300002
*                                                                     * 10400002
* TABLES = TWO 256 BYTE TABLES CONTAIN THE TRANSLATION CODES USED     * 10500002
*          BY THIS MODULE.                                            * 10600002
*                                                                     * 10700002
* MACROS = IECDSECS                                                   * 10800002
*          IECRES                                                     * 10900002
*          MODESET                                                    * 11000002
*          XCTLTABL                                                   * 11100002
*                                                                     * 11200002
* CHANGE ACTIVITY = SEE CHANGES/DELETIONS AFTER CSECT STATEMENT.      * 11300002
*                                                                     * 11400002
*********************************************************************** 11500002
         EJECT                                                          11600002
*                                                                       18400020
*                        REGISTERS                                      18800020
*                                                                       19200020
R0       EQU   0                                                        19600020
R1       EQU   1                                                        20000020
R2       EQU   2                                                        20400020
R3       EQU   3                                                        20800020
R4       EQU   4                                                        21200020
R5       EQU   5                                                        21600020
BASE     EQU   6                        BASE REGISTER            YM1440 22000002
R7       EQU   7                                                        22400020
R8       EQU   8                                                        22800020
R9       EQU   9                                                        23200020
R10      EQU   10                                                       23600020
R11      EQU   11                                                       24000020
R12      EQU   12                                                       24400020
R13      EQU   13                                                       24800020
R14      EQU   14                                                       25200020
R15      EQU   15                                                       25600020
*                                                                       26000020
*                   SYMBOLIC REGISTER USAGE                             26400020
*                                                                       26800020
BYTES    EQU   0                        NUMBER OF BYTES TO TRANSLATE    27200020
DATAD    EQU   1                        DIRECTION BIT--ADDR OF DATA     27600020
TRANSTAB EQU   2                        ADDRESS OF TRANSLATION TABLE    28000020
CVTAD    EQU   3                        CVT ADDRESS                     28400020
TCBAD    EQU   4                        TCB ADDRESS                     28800020
RETURN2  EQU   R7                       RETURN REGISTER          Y02082 29300002
RETURN   EQU   14                       RETURN REGISTER                 29600020
VCBASE   EQU   R15                      VALIDITY CHECK RTN BASE  Y02082 29650002
RTNCODE  EQU   R15                      RETURN CODE REGISTER     Y02082 29700002
*                                                                     * 30400020
*********************************************************************   30800020
*                             MASKS AND EQUATES                         31200020
*********************************************************************   31600020
*                                                                     * 32000020
P0       EQU   0                        CONSTANT OF ZERO                32400020
P256     EQU   256                      CONSTANT OF 256                 34000020
CODE4    EQU   4                        CONDITION CODE OF 4             34400020
CODE8    EQU   8                        CONDITION CODE OF 8             34800020
*                                                                     * 36000020
*********************************************************************   36400020
*********************************************************************   36800020
         BALR  BASE,P0                  ESTABLISH ADDRESSABILITY        37200020
         USING *,BASE                                                   37600020
         USING CVT,CVTAD                USING ON CVT             Y02082 37650002
         USING TCB,TCBAD                USING ON TCB             Y02082 37700002
*                                                                       38000020
* CHECK FOR POSITIVE NUMBER OF BYTES TO TRANSLATE                       38400020
*                                                                       38800020
         LTR   BYTES,BYTES              TEST BYTE COUNT NOT ZERO OR NEG 39200020
         BP    VALIDCHK                 BRANCH IF POSITIVE              39600020
         LA    RTNCODE,CODE4            SET CONDITION CODE TO 4  Y02082 39650002
EXIT     IECRES EXIT                    RETURN                   Y02082 39700002
*                                                                       40800020
*        THE RESIDENT VALIDITY CHECK ROUTINE IS USED TO VERIFY   Y02082 40850002
*        THAT THE CALLERS AREA IS IN THE TCB KEY.                Y02082 40900002
*              REGISTER 1 - FIRST ADDRESS TO BE CHECKED          Y02082 40950002
*              REGISTER 2 - LAST ADDRESS TO BE CHECKED           Y02082 41000002
*              REGISTER 4 - CURRENT TCB                          Y02082 41050002
*              REGISTER 14 - RETURN ADDRESS                      Y02082 41100002
*              REGISTER 15 - ENTRY POINT OF ROUTINE              Y02082 41150002
*              THE LOCAL LOCK MUST BE HELD                       Y02082 41160002
*                                                                Y02082 41170002
VALIDCHK LA    R2,P0(DATAD)             LOAD ADDRESS OF DATA    SA51421 41200000
         AR    R2,BYTES                 ADD DATA LENGTH         SA51421 41300021
         BCTR  R2,P0                    R2 POINTS TO LAST BYTE   Y02082 41400002
*                                       TO BE TRANSLATED         Y02082 41500002
         LR    RETURN2,DATAD            SAVE DATAD               Y02082 41600002
         LR    R8,BYTES                 SAVE BYTES               Y02082 41700002
         TESTAUTH KEY=YES               IS CALLER IN SYSTEM KEY  Y02082 41800002
*                                                                Y02082 41900002
         LR    BYTES,R8                 RESTORE BYTES            Y02082 42000002
         LR    DATAD,RETURN2            RESTORE DATAD            Y02082 42100002
         LTR   RTNCODE,RTNCODE          TEST CODE                Y02082 42200002
         BZ    TSTDIREC                 BRANCH IF CALLER IN      Y02082 42300002
*                                       SYSTEM KEY               Y02082 42400002
         L     VCBASE,CVT0VL00          ENTRY POINT ADDRESS      Y02082 42500002
SETLOCK  EQU   *                        OBTAIN LOCAL LOCK        Y02082 42600002
         SETLOCK OBTAIN,MODE=UNCOND,TYPE=LOCAL,                  Y02082*42700002
               RELATED=(RESVALCK,IGC0010C(FREELOCK))             Y02082 42800002
         BALR  RETURN,VCBASE            GO TO VALIDITY CHK RTN   Y02082 42900002
         BZ    ADDROK                   BRANCH-ADDRESS OK        Y02082 43000002
*                                                                Y02082 43100002
VCERR    EQU   *                        VALIDITY CHECK ERROR     Y02082 43200002
         LA    RETURN2,EXIT             RETURN FROM FREELOCK     Y02082 43300002
         LA    RTNCODE,CODE8            SET CONDITION CODE TO 8  Y02082 43400002
FREELOCK EQU   *                        RELEASE LOCAL LOCK       Y02082 43500002
         SETLOCK RELEASE,TYPE=LOCAL,                             Y02082*43600002
               RELATED=(RESVALCK,IGC0010C(GETLOCK))              Y02082 43700002
         BR    RETURN2                  RETURN                   Y02082 43800002
*                                                                       46400020
* DETERMINE THE DIRECTION OF TRANSLATION                                46800020
*                                                                       47200020
ADDROK   EQU   *                        ADDRESS IS OK            Y02082 47250002
         BAL   RETURN2,FREELOCK         RELEASE LOCAL LOCK       Y02082 47300002
         MODESET EXTKEY=RBT234,WORKREG=14 ASSUME CALLER'S KEY    Y02082 47350002
TSTDIREC EQU   *                        DETERMINE DIRECTION      Y02082 47400002
         LTR   DATAD,DATAD              TEST DIRECTION OF XLATE  Y02082 47450002
         BM    TOASC                    BRANCH IF NEGATIVE--TO USASCII  48000020
         LA    TRANSTAB,TABE            LOAD ADDRESS OF EBCDIC TABLE    48400020
         B     TRANS                    BRANCH TO TRANSLATE  LOOP       48800020
TOASC    LA    TRANSTAB,TABA            LOAD ADDRESS OF USASCII TABLE   49200020
*                                                                       49600020
*  TRANSLATE 256 BYTES AT A TIME                                        50000020
*                                                                       50400020
TRANS    S     BYTES,K256               DECREMENT BYTES COUNT           50800020
         BM    REST                     BRANCH TO TRANSLATE <256 BYTES  51200020
         TR    P0(P256,DATAD),P0(TRANSTAB) TRANSLATE 256 BYTES          51600020
         LA    DATAD,P256(DATAD)        INCREMENT DATA POINTER BY 256   52000020
         B     TRANS                    GO TRANSLATE DATA               52400020
*                                                                       52800020
* TRANSLATE LESS THEN 256 BYTES                                         53200020
*                                                                       53600020
REST     EQU   *                        TRANSLATE REMAINDER      Y02082 53650002
         SR    RTNCODE,RTNCODE          ZERO CONDITION CODE      Y02082 53700002
         A     BYTES,K256               RESTORE REMAINING COUNT  Y02082 53750002
         BZ    EXIT                     RETURN TO CALLER         Y02082 53800002
         BCTR  BYTES,P0                 DECREMENT BYTE COUNT            54800020
         LR    R8,BYTES                 LOAD REG FOR TRANSLATE   YM1440 55200002
         EX    R8,TRANS1                TRANSLATE LAST BYTES     YM1440 55600002
         B     EXIT                     RETURN TO CALLER         Y02082 56050002
*********************************************************************   56800020
*                                                                       57200020
* CONSTANTS                                                             57600020
*                                                                       58000020
K256     DC    F'256'                   DECREMENT VALUE FOR LENGTH      58800020
TRANS1   TR    P0(P0,DATAD),P0(TRANSTAB) TRANSLATE LAST BYTES           59200020
*                                                                       60000020
*        TABLE FOR TRANSLATING FROM EBCDIC TO ASCII                     60400020
*                                                                       60800020
TABA     DC    X'000102031A091A7F'      ASCII TABLE                     61200020
ENT080FA DC    X'1A1A1A0B0C0D0E0F'        *                             61600020
ENT1017A DC    X'101112131A1A081A'        *                             62000020
ENT181FA DC    X'18191A1A1C1D1E1F'        *                             62400020
ENT2027A DC    X'1A1A1A1A1A0A171B'        *                             62800020
ENT282FA DC    X'1A1A1A1A1A050607'        *                             63200020
ENT3037A DC    X'1A1A161A1A1A1A04'        *                             63600020
ENT383FA DC    X'1A1A1A1A14151A1A'        *                             64000020
ENT4047A DC    X'201A1A1A1A1A1A1A'        *                             64400020
ENT484FA DC    X'1A1A5B2E3C282B21'        *                             64800020
ENT5057A DC    X'261A1A1A1A1A1A1A'        *                             65200020
ENT585FA DC    X'1A1A5D242A293B5E'        *                             65600020
ENT6067A DC    X'2D2F1A1A1A1A1A1A'        *                             66000020
ENT686FA DC    X'1A1A7C2C255F3E3F'        *                             66400020
ENT7077A DC    X'1A1A1A1A1A1A1A1A'        *                             66800020
ENT787FA DC    X'1A603A2340273D22'        *                             67200020
ENT8087A DC    X'1A61626364656667'        *                             67600020
ENT888FA DC    X'68691A1A1A1A1A1A'        *                             68000020
ENT9097A DC    X'1A6A6B6C6D6E6F70'        *                             68400020
ENT989FA DC    X'71721A1A1A1A1A1A'        *                             68800020
ENTA0A7A DC    X'1A7E737475767778'        *                             69200020
ENTA8AFA DC    X'797A1A1A1A1A1A1A'        *                             69600020
ENTB0B7A DC    X'1A1A1A1A1A1A1A1A'        *                             70000020
ENTB8BFA DC    X'1A1A1A1A1A1A1A1A'        *                             70400020
ENTC0C7A DC    X'7B41424344454647'        *                             70800020
ENTC8CFA DC    X'48491A1A1A1A1A1A'        *                             71200020
ENTD0D7A DC    X'7D4A4B4C4D4E4F50'        *                             71600020
ENTD8DFA DC    X'51521A1A1A1A1A1A'        *                             72000020
ENTE0E7A DC    X'5C1A535455565758'        *                             72400020
ENTE8EFA DC    X'595A1A1A1A1A1A1A'        *                             72800020
ENTF0F7A DC    X'3031323334353637'        *                             73200020
ENTF8FFA DC    X'38391A1A1A1A1A1A'        *                             73600020
*                                                                       74000020
*        TABLE FOR TRANSLATING FROM ASCII TO EBCDIC                     74400020
*                                                                       74800020
TABE     DC    X'00010203372D2E2F'      EBCDIC TABLE                    75200020
ENT080FE DC    X'1605250B0C0D0E0F'        *                             75600020
ENT1017E DC    X'101112133C3D3226'        *                             76000020
ENT181FE DC    X'18193F271C1D1E1F'        *                             76400020
ENT2027E DC    X'404F7F7B5B6C507D'        *                             76800020
ENT282FE DC    X'4D5D5C4E6B604B61'        *                             77200020
ENT3037E DC    X'F0F1F2F3F4F5F6F7'        *                             77600020
ENT383FE DC    X'F8F97A5E4C7E6E6F'        *                             78000020
ENT4047E DC    X'7CC1C2C3C4C5C6C7'        *                             78400020
ENT484FE DC    X'C8C9D1D2D3D4D5D6'        *                             78800020
ENT5057E DC    X'D7D8D9E2E3E4E5E6'        *                             79200020
ENT585FE DC    X'E7E8E9ADE0BD5F6D'        *                     ZA00005 79600000
ENT6067E DC    X'7981828384858687'        *                             80000020
ENT686FE DC    X'8889919293949596'        *                             80400020
ENT7077E DC    X'979899A2A3A4A5A6'        *                             80800020
ENT787FE DC    X'A7A8A9C06AD0A107'        *                             81200020
ENT8087E DC    X'3F3F3F3F3F3F3F3F'        *                             81600020
ENT888FE DC    X'3F3F3F3F3F3F3F3F'        *                             82000020
ENT9097E DC    X'3F3F3F3F3F3F3F3F'        *                             82400020
ENT989FE DC    X'3F3F3F3F3F3F3F3F'        *                             82800020
ENTA0A7E DC    X'3F3F3F3F3F3F3F3F'        *                             83200020
ENTA8AFE DC    X'3F3F3F3F3F3F3F3F'        *                             83600020
ENTB0B7E DC    X'3F3F3F3F3F3F3F3F'        *                             84000020
ENTB8BFE DC    X'3F3F3F3F3F3F3F3F'        *                             84400020
ENTC0C7E DC    X'3F3F3F3F3F3F3F3F'        *                             84800020
ENTC8CFE DC    X'3F3F3F3F3F3F3F3F'        *                             85200020
ENTD0D7E DC    X'3F3F3F3F3F3F3F3F'        *                             85600020
ENTD8DFE DC    X'3F3F3F3F3F3F3F3F'        *                             86000020
ENTE0E7E DC    X'3F3F3F3F3F3F3F3F'        *                             86400020
ENTE8EFE DC    X'3F3F3F3F3F3F3F3F'        *                             86800020
ENTF0F7E DC    X'3F3F3F3F3F3F3F3F'        *                             87200020
ENTF8FFE DC    X'3F3F3F3F3F3F3F3F'        *                             87600020
*********************************************************************   88000020
*                                                                       88100002
         XCTLTABL SVC=103,BRT=YES,LENGTH=                        Y02080 88200002
         IECDSECS CVT,PSA,RB,TCB,EXPAND=YES                      Y02082 88300002
         END                                                            88400020
./  ADD  SSI=50250603,NAME=IGG0193K
         TITLE 'IGG0193K -- SUBSYSTEM EXECUTOR                         *00001000
                        '                                               00002000
IGG0193K CSECT ,                                                   0001 00003000
@PROLOG  BALR  @03,0                                               0001 00004000
@PSTART  DS    0H                                                  0001 00005000
         USING @PSTART,@03                                         0001 00006000
         EJECT                                                          00007000
*BEGIN:                                 /* INITALIZE POINTERS        */ 00008000
*        ACBPTR = ACBPTRP ;             /* INIT POINTER TO ACB       */ 00009000
BEGIN    L     ACBPTR,ACBPTRP-1(,PARCPTR)                          0108 00010000
         LA    ACBPTR,0(,ACBPTR)                                   0108 00011000
*        RCORE = WTGCORE ;              /* INIT WORK AREA PT   Y02134*/ 00012000
         L     RCORE,WTGCORE-1(,RWTGC)                             0109 00013000
         LA    RCORE,0(,RCORE)                                     0109 00014000
*/********************************************************************/ 00015000
*/*                                                                  */ 00016000
*/*                  BUILD DEB                                       */ 00017000
*/* GET STORAGE FOR THE DEB, SSIB, SSOB.  SET UP POINTER IN          */ 00018000
*/* THE ACB TO POINT TO THE DEB.  CHAIN THE DEB ON THE TCB           */ 00019000
*/* DEB CHAIN INITIALIZE THE DEB, SSIB, SSOB.                  Y02120*/ 00020000
*/*                                                                  */ 00021000
*/********************************************************************/ 00022000
*/*                                                                  */ 00023000
*        RFY (R0,REG15) RSTD;           /*                     Y02082*/ 00024000
*BUILDDEB:                              /* BUILD DEB                 */ 00025000
*        REG15 = ADDR(IECREGSV);        /*GET SAVE AREA ADDRESSY02080*/ 00026000
BUILDDEB L     REG15,WTGPREFX(,RWTG)                               0111 00027000
         LA    REG15,IECREGSV(,REG15)                              0111 00028000
*        RFY (R11) RSTD;                /* DETERMINE LENGTH    Y02082*/ 00029000
*/*                                                                  */ 00030000
*/********************************************************************/ 00031000
*/*      ESTABLISH LENGTH OF DEB GETMAIN                      Y02082 */ 00032000
*/********************************************************************/ 00033000
*/*                                                                  */ 00034000
*        R11 = ((8 +                    /* DEB PREFIX LENGTH   Y02082*/ 00035000
*              LENGTH(DEBBASIC) +       /* BASIC DEB LENGTH    Y02082*/ 00036000
*              LENGTH(DEBSUCBA) +       /* JESUNITS UCB FIELD  Y02082*/ 00037000
*              LENGTH(SSIB) +           /* SSIB LENGTH         Y02082*/ 00038000
*              LENGTH(SSOB) +           /* SSOB LENGTH         Y02082*/ 00039000
*              LENGTH(SSDASSCB) +       /* SSDASSCB NOT YET    Y02082*/ 00040000
*                                       /* IN SSOB DSECT       Y02082*/ 00041000
*              LENGTH(SSDA) +           /* SSDA LENGTH         Y02082*/ 00042000
*              7)/8)*8;                 /* ROUND UP DOUBLEWORD Y02082*/ 00043000
         LA    R11,128                                             0113 00044000
*        RFY (R1) RSTD;                 /*                     Y02082*/ 00045000
*/*                                                                  */ 00046000
*        GEN REFS(IECREGSV,R11);        /*                     Y02082*/ 00047000
*        GET CORE AND CLEAR TO ZERO FOR DEB, SSIB, SSOB.         Y02120 00048000
         IECRES GET,LV=(R11),PREFIX=NO,STM=(2,14,0(15))          Y02082 00049000
         B     BUILD                    GO TO START OF INIT      Y02082 00050000
CLRCORE  XC    0(0,R1),0(R1)            CLEAR GETMAIN CORE       Y02082 00051000
*/*                                                                  */ 00052000
*BUILD:  R11 = R11 - 1;                 /* REDUCE FOR EX       Y02082*/ 00053000
BUILD    BCTR  R11,0                                               0116 00054000
*        GEN (EX R11,CLRCORE);          /* CLEAR GETMAIN CORE  Y02082*/ 00055000
         EX R11,CLRCORE                                                 00056000
*        R11 = R11 + 1;                 /* RESTORE LENGTH      Y02082*/ 00057000
         AL    R11,@CF00064                                        0118 00058000
*        ACBDEB   =   MACROREG + 8 ;    /* PUT POINTER TO DEB IN ACB */ 00059000
         LA    @14,8                                               0119 00060000
         ALR   @14,MACROREG                                        0119 00061000
         STCM  @14,7,ACBDEB(ACBPTR)                                0119 00062000
*        DEBAPPAD = MACROREG - 28 ;     /* POINTER TO AVT            */ 00063000
         LR    @12,MACROREG                                        0120 00064000
         SL    @12,@CF02541                                        0120 00065000
         ST    @12,DEBAPPAD(,@14)                                  0120 00066000
*        RFY (R0,R1,REG15) UNRSTD;      /*                     Y02082*/ 00067000
*        DEBLNGTH = R11/8;              /*LENGTH OF DEB IN DWS Y02082*/ 00068000
         LR    @10,R11                                             0122 00069000
         SRL   @10,3                                               0122 00070000
         STC   @10,DEBLNGTH(,@12)                                  0122 00071000
*        DEBAMLNG = R11 - 8 -           /*LENGTH OF SSIB,      Y02082*/ 00072000
*                   LENGTH(DEBBASIC);   /*SSOB, SSDA, AND UCB  Y02082*/ 00073000
         LR    @12,R11                                             0123 00074000
         SL    @12,@CF02564                                        0123 00075000
         STC   @12,DEBAMLNG(,@14)                                  0123 00076000
*        RFY (R11) UNRSTD;              /*                     Y02082*/ 00077000
*        DEBOFLGS = JFCBIND2 & 'C0'X;   /* STATUS FLAGS FOR DATA SET    00078000
*                                       LINE ITEM              Y02120*/ 00079000
         MVC   DEBOFLGS(1,@14),JFCBIND2+100(RCORE)                 0125 00080000
         NI    DEBOFLGS(@14),X'C0'                                 0125 00081000
*        DEBNMEXT = 0;                  /* INITIALIZED TO ZERO Y02120*/ 00082000
         MVI   DEBNMEXT(@14),X'00'                                 0126 00083000
*        DEBOPATB = ACBOPATB & '3F'X;   /* PUT OPEN OPTNS IN DEB   0127 00084000
*                                       LINE ITEM              Y02120*/ 00085000
         MVC   DEBOPATB(1,@14),ACBOPATB(PARCPTR)                   0127 00086000
         NI    DEBOPATB(@14),X'3F'                                 0127 00087000
*        DEBDCBAD = ACBPTR;             /* DEB POINTS TO USER ACB  0128 00088000
*                                       LINE ITEM              Y02082*/ 00089000
         ST    ACBPTR,DEBDCBAD(,@14)                               0128 00090000
*        DEBPROTG = DXUKEY;             /* USER KEY IN DEB     Y02082*/ 00091000
         MVC   DEBPROTG(1,@14),DXUKEY(RCORE)                       0129 00092000
*        DEBDEBID = DEBDEBID | '0F'X;   /* SET DEB ID          Y02082*/ 00093000
         OI    DEBDEBID(@14),X'0F'                                 0130 00094000
*        DEBEXSCL = 0;                  /* INITIALIZE TO ZERO  Y02120*/ 00095000
         MVI   DEBEXSCL(@14),X'00'                                 0131 00096000
*        DEBUCBAD = JESUNITS;           /* POINTER TO UCB      Y02120*/ 00097000
         L     @12,CVTPTR                                          0132 00098000
         L     @12,CVTJESCT(,@12)                                  0132 00099000
         L     @12,JESUNITS(,@12)                                  0132 00100000
         ST    @12,DEBUCBAD+32(,@14)                               0132 00101000
*/*                                                                  */ 00102000
*/********************************************************************/ 00103000
*/*                                                                  */ 00104000
*/*  BUILD SSIB AND SSOB                                       Y02120*/ 00105000
*/*                                                                  */ 00106000
*/********************************************************************/ 00107000
*        SSIBID = 'SSIB';               /* ID OF SSIB          Y02120*/ 00108000
         LA    @12,36                                              0133 00109000
         LR    @15,@14                                             0133 00110000
         ALR   @15,@12                                             0133 00111000
         MVC   SSIBID(4,@15),@CC02545                              0133 00112000
*        SSIBLEN = LENGTH(SSIB);        /* LENGTH OF SSIB      Y02120*/ 00113000
         STH   @12,SSIBLEN(,@15)                                   0134 00114000
*        SSIBSSNM = DSABSSNM;           /* SUBSYSTEM NAME      Y02134*/ 00115000
         L     @12,DXDSABAD(,RCORE)                                0135 00116000
         MVC   SSIBSSNM(4,@15),DSABSSNM(@12)                       0135 00117000
*/*                                                                  */ 00118000
*        SSOBID = 'SSOB';               /* ID OF SSOB          Y02120*/ 00119000
         LA    @11,4                                               0136 00120000
         LA    @10,SSIBSUSE(,@15)                                  0136 00121000
         ALR   @10,@11                                             0136 00122000
         MVC   SSOBID(4,@10),@CC02546                              0136 00123000
*        SSOBLEN = LENGTH(SSOB);        /* LENGTH OF SSOB HEADER   0137 00124000
*                                       LINE ITEM              Y02120*/ 00125000
         MVC   SSOBLEN(2,@10),@CH00102                             0137 00126000
*        SSOBFUNC =SSOBOPEN;            /* FUNCTION ID: OPEN = 16  0138 00127000
*                                       CLOSE = 17             Y02120*/ 00128000
         MVC   SSOBFUNC(2,@10),@CH00054                            0138 00129000
*        SSOBSSIB = ADDR(SSIB);         /* SSIB ADDRESS        Y02134*/ 00130000
         ST    @15,SSOBSSIB(,@10)                                  0139 00131000
*        SSOBINDV = ADDR(SSDALEN);      /* FUNCTION DEPENDENT PORTION   00132000
*                                       LENGTH ADDRESS         Y02120*/ 00133000
         LA    @15,SSOBINDV(,@10)                                  0140 00134000
         ALR   @15,@11                                             0140 00135000
         ST    @15,SSOBINDV(,@10)                                  0140 00136000
*        SSDALEN = LENGTH(SSDA) +       /* LENGTH OF FUNCTION DEPEN- */ 00137000
*                  LENGTH(SSDASSCB);    /* DENT PORTION OF SSOBY02120*/ 00138000
         LA    @15,SSOBINDV(,@10)                                  0141 00139000
         ALR   @15,@11                                             0141 00140000
         MVC   SSDALEN(2,@15),@CH00034                             0141 00141000
*        SSDAJFCB = ADDR(DXJBF);        /* ADDR JFCB IN WORK AREA  0142 00142000
*                                       LINE ITEM              Y02120*/ 00143000
         LA    @01,DXJBF(,RCORE)                                   0142 00144000
         ST    @01,SSDAJFCB(,@15)                                  0142 00145000
*        SSDADEBP = ACBDEB;             /* ADDRESS OF DEB      Y02120*/ 00146000
         ST    @14,SSDADEBP(,@15)                                  0143 00147000
*        SSDASSCB = DSABSSCM;           /* MOVE SUBSYSTEM COMM       */ 00148000
         LA    @15,SSDADEBP(,@15)                                  0144 00149000
         ALR   @15,@11                                             0144 00150000
         MVC   SSDASSCB(4,@15),DSABSSCM(@12)                       0144 00151000
*                                       /* AREA TO SSOB        Y02120*/ 00152000
*/*                                                                  */ 00153000
*/********************************************************************/ 00154000
*/*                                                                  */ 00155000
*/*  PREPARE TO AND ISSUE IEFSSREQ MACRO.                      Y02120*/ 00156000
*/*                                                                  */ 00157000
*/********************************************************************/ 00158000
*        DXCCW1A = ADDR(SSOB) | '80000000'X; /*                Y02120*/ 00159000
         O     @10,@CF02547                                        0145 00160000
         ST    @10,DXCCW1A(,RCORE)                                 0145 00161000
*        RFY (R0,R1,SAVEPTR,RET,REG15) RSTD; /*                Y02082*/ 00162000
*        R1 = ADDR(DXCCW1A);            /* REG 1 POINTS TO PARAMETER    00163000
*                                       LINE ITEM              Y02120*/ 00164000
         LA    R1,DXCCW1A(,RCORE)                                  0147 00165000
*        SAVEPTR = ADDR(DXLBL);         /* REG 13 POINTS TO SAVE AREA   00166000
*                                       LINE ITEM              Y02120*/ 00167000
         LR    SAVEPTR,RCORE                                       0148 00168000
*        GEN (IEFSSREQ);                /*                     Y02120*/ 00169000
         IEFSSREQ                                                       00170000
*        RFY (R0,R1,SAVEPTR,RET) UNRSTD; /*                    Y02082*/ 00171000
*/*                                                                  */ 00172000
*/********************************************************************/ 00173000
*/*                                                                  */ 00174000
*/*  ERROR RETURN LOGIC                                        Y02120*/ 00175000
*/*                                                                  */ 00176000
*/********************************************************************/ 00177000
*        IF REG15 = 0 & SSOBRETN = 0    /* CHECK FOR ERROR     Y02120*/ 00178000
*          THEN                         /* NON-ERROR LOGIC     Y02120*/ 00179000
         SLR   @14,@14                                             0151 00180000
         CR    REG15,@14                                           0151 00181000
         BNE   @RF00151                                            0151 00182000
         L     @12,ACBDEB-1(,ACBPTR)                               0151 00183000
         LA    @12,0(,@12)                                         0151 00184000
         LA    @11,SSIBSUSE+36(,@12)                               0151 00185000
         C     @14,SSOBRETN+4(,@11)                                0151 00186000
         BNE   @RF00151                                            0151 00187000
*            DO;                        /* NON-ERROR LOGIC     Y02120*/ 00188000
*              RFY (REG15) UNRSTD;      /*                     Y02082*/ 00189000
*/********************************************************************/ 00190000
*/*                                                                  */ 00191000
*/*  CHAIN DEB                                                       */ 00192000
*/*                                                                  */ 00193000
*/********************************************************************/ 00194000
*              DXEXHASP = ON;           /*HASP RETURNED      @ZA02504*/ 00195000
         OI    DXEXHASP(RCORE),B'10000000'                         0154 00196000
*              DEBTCBAD = TCBPTR;       /* PT TO TCB INTO DEB  Y02120*/ 00197000
         L     @15,TCBPTR(,RCORE)                                  0155 00198000
         ST    @15,DEBTCBAD(,@12)                                  0155 00199000
*              DEBDEBAD = TCBDEB;       /* TCB DEB PT INTO DEB Y02120*/ 00200000
         L     @15,TCBDEB(,@15)                                    0156 00201000
         ST    @15,DEBDEBAD(,@12)                                  0156 00202000
*              GEN(MODESET EXTKEY=SUPR); /* TCB/MODESET KEY    Y02082*/ 00203000
         MODESET EXTKEY=SUPR                                            00204000
*CHAINDEB:     DXCCW1A = DEBDEBAD;      /* SAVE TO VERIFY CS   Y02082*/ 00205000
CHAINDEB L     @12,ACBDEB-1(,ACBPTR)                               0158 00206000
         LA    @12,0(,@12)                                         0158 00207000
         L     @15,DEBDEBAD(,@12)                                  0158 00208000
         ST    @15,DXCCW1A(,RCORE)                                 0158 00209000
*              CS (DEBDEBAD,SSDADEBP,TCBDEB); /* ENQUEUE DEB   Y02082*/ 00210000
         L     @14,DEBDEBAD(,@12)                                  0159 00211000
         LA    @11,4                                               0159 00212000
         LA    @10,SSIBSUSE+36(,@12)                               0159 00213000
         ALR   @10,@11                                             0159 00214000
         LA    @10,SSOBINDV(,@10)                                  0159 00215000
         ALR   @10,@11                                             0159 00216000
         L     @11,SSDADEBP(,@10)                                  0159 00217000
         L     @10,TCBPTR(,RCORE)                                  0159 00218000
         CS    @14,@11,TCBDEB(@10)                                 0159 00219000
         BZ    @BC00159                                            0159 00220000
         ST    @14,DEBDEBAD(,@12)                                  0159 00221000
@BC00159 DS    0H                                                  0160 00222000
*              IF DEBDEBAD = DXCCW1A   /* STILL THE FIRST DEB?Y02082*/ 00223000
*                THEN                   /* NO, TRY CS UNTIL FIRST    */ 00224000
         C     @15,DEBDEBAD(,@12)                                  0160 00225000
         BNE   @RT00160                                            0160 00226000
*                GOTO CHAINDEB;         /* BRANCH TO THE CS INSTR    */ 00227000
*              GEN (MODESET EXTKEY=DATAMGT); /* DM KEY         Y02082*/ 00228000
         MODESET EXTKEY=DATAMGT                                         00229000
*/********************************************************************/ 00230000
*/*                                                                  */ 00231000
*/*   ADD DEB TO DEB TABLE, DEB POINTS TO COPIED ACB           Y02082*/ 00232000
*/*                                                                  */ 00233000
*/********************************************************************/ 00234000
*              RFY (R0,R1,REG15) RSTD;  /*                     Y02082*/ 00235000
*              GEN(DEBCHK (ACBPTR),TYPE=ADD,AM=SUBSYS); /*     Y02082*/ 00236000
         DEBCHK (ACBPTR),TYPE=ADD,AM=SUBSYS                             00237000
*              RFY (R0,R1,REG15) UNRSTD; /*                    Y02082*/ 00238000
*              DEBDCBA = DXUDCBA;       /* DEB POINTS TO USER      0166 00239000
*                                       DCB                    YM1247*/ 00240000
         L     @12,ACBDEB-1(,ACBPTR)                               0166 00241000
         LA    @12,0(,@12)                                         0166 00242000
         MVC   DEBDCBA(3,@12),DXUDCBA(RCORE)                       0166 00243000
*            END;                       /*                     Y02120*/ 00244000
*        ELSE                           /* ERROR CONDITION     Y02120*/ 00245000
*          DO;                          /* ERROR CONDITION     Y02120*/ 00246000
         B     @RC00151                                            0168 00247000
@RF00151 DS    0H                                                  0169 00248000
*/********************************************************************/ 00249000
*/*                                                                  */ 00250000
*/*   FREE MAIN                                                Y02120*/ 00251000
*/*                                                                  */ 00252000
*/********************************************************************/ 00253000
*            RFY (R0,R1,R9,REG15) RSTD; /*                     YM1195*/ 00254000
*            R9 = REG15;                /* SAVE RETURN CODE    YM1195*/ 00255000
         LR    R9,REG15                                            0170 00256000
*            MACROREG = ACBDEB - 8;     /* PREPARE FOR FREE    Y02082*/ 00257000
         L     MACROREG,ACBDEB-1(,ACBPTR)                          0171 00258000
         LA    MACROREG,0(,MACROREG)                               0171 00259000
         SL    MACROREG,@CF00053                                   0171 00260000
*            REG15 = ADDR(IECREGSV);    /* REG SAVE AREA       Y02082*/ 00261000
         L     REG15,WTGPREFX(,RWTG)                               0172 00262000
         LA    REG15,IECREGSV(,REG15)                              0172 00263000
*            /*      ESTABLISH LENGTH OF DEB GETMAIN           Y02082*/ 00264000
*            R0 = ((8 +                 /*LENGTH OF DEB PREFIX Y02082*/ 00265000
*                 LENGTH(DEBBASIC) +    /*BODY OF DEB          Y02082*/ 00266000
*                 LENGTH(DEBSUCBA) +    /*JESUNITS UCB FIELD   Y02082*/ 00267000
*                 LENGTH(SSIB) +        /*SSIB                 Y02082*/ 00268000
*                 LENGTH(SSOB) +        /*SSOB                 Y02082*/ 00269000
*                 LENGTH(SSDASSCB) +    /*UNTIL ITS IN SSDA    Y02082*/ 00270000
*                 LENGTH(SSDA) +        /*SSDA                 Y02082*/ 00271000
*                 7)/8)*8;              /*ROUND UP TO DW BDY   Y02082*/ 00272000
         LA    R0,128                                              0173 00273000
*/*                                                                  */ 00274000
*            GEN;                                                  0174 00275000
*        FREE CORE FOR DEB, SSIB, SSOB.                          Y02120 00276000
         IECRES FREE,LV=(0),A=(1),PREFIX=NO,STM=(0,14,0(15))     Y02134*00277000
                                        FREE DEB SSOB SSIB       Y02080 00278000
*/*                                                                  */ 00279000
*            IF R9 = 0                 /* IS THERE AN ERROR   YM6527*/ 00280000
*                                       /* IN IEFSSREQ         YM1195*/ 00281000
*              THEN                     /* ERR CODE, ISSUE MSG YM1195*/ 00282000
         LTR   R9,R9                                               0175 00283000
         BZ    @RF00175                                            0175 00284000
*                DO;                    /*                     YM1195*/ 00285000
*                  GEN REFS(DXCALLID,DXREG9); /*               YM1195*/ 00286000
*        DMABCOND IC252,ID3K6M,RES=NO   ISSUE ERROR MSG          YM1195 00287000
         LA    0,IC252                  INTERNAL CODE            YM1195 00288000
         MVC   DXCALLID(2,4),6(RWTG)    MOD ID                   YM1195 00289000
         MVC   0(5,RWTGC),ID3K6M        ID AND ENTRY POINT       YM1195 00290000
         STM   9,14,DXREG9(4)           SAVE REGS                YM3885 00291000
         B     ABCONENT                 BRANCH DIRECT CODE       YM1195 00292000
IC252    EQU   252                      INTERN CODE 013-C8 ABEND YM1195 00293000
*                END;                   /*                     YM1195*/ 00294000
*            RFY (R0,R1,R9,RES) UNRSTD; /*                     YM1195*/ 00295000
@RF00175 DS    0H                                                  0180 00296000
*/********************************************************************/ 00297000
*/*  TURN OFF BUSY BIT IN ACB                                        */ 00298000
*/********************************************************************/ 00299000
*            ACBIOSFG = '0'B;           /* SET BUSY INDICATOR TO ZERO*/ 00300000
         NI    ACBIOSFG(ACBPTR),B'11111110'                        0180 00301000
*          END;                                                    0181 00302000
*/********************************************************************/ 00303000
*/*  MOVE COPIED ACB                                                 */ 00304000
*/********************************************************************/ 00305000
*        REG15 = ADDR(IECREGSV);        /*                     Y02082*/ 00306000
@RC00151 L     REG15,WTGPREFX(,RWTG)                               0182 00307000
         LA    REG15,IECREGSV(,REG15)                              0182 00308000
*/*                                                                  */ 00309000
*        GEN;                           /*                     Y02082*/ 00310000
         IECRES INIT,DCBCOPY=FRWKAR,STM=(2,14,0(15)),            Y02082*00311000
               PREFIX=WTGPREFX                                   Y02082 00312000
*/*                                                                  */ 00313000
*        RFY REG15 UNRSTD;              /*                     Y02082*/ 00314000
*/*                                                                  */ 00315000
*/********************************************************************/ 00316000
*/*                                                                  */ 00317000
*/* PROCESSING OF ACB IS COMPLETE. DETERMINE IF THIS EXECUTOR        */ 00318000
*/* IS REQUIRED FOR ANOTHER ACB IN THE PARAMETER LIST AND            */ 00319000
*/* REPEAT.  IF NOT NEEDED XCTL TO THE FIRST NONZERO ENTRY IN        */ 00320000
*/* THE WHERE TO GO TABLE.                                           */ 00321000
*/*                                                                  */ 00322000
*/********************************************************************/ 00323000
*        WTGIDTTR = WTGIDTTR && WTGIDTTR; /* ZERO OUT ID       Y02120*/ 00324000
         XC    WTGIDTTR(5,RWTGC),WTGIDTTR(RWTGC)                   0185 00325000
*NEXTACB:                               /* CHECK FOR LAST ENTRY      */ 00326000
*        IF    ENDPARM = '1'B           /* IF IT IS THE LAST ENTRY   */ 00327000
*          THEN                         /* SEARCH FOR FIRST NON-ZERO */ 00328000
NEXTACB  TM    ENDPARM(PARCPTR),B'10000000'                        0186 00329000
         BO    @RT00186                                            0186 00330000
*          GOTO SERCHWTG ;              /* WTG ENTRY                 */ 00331000
*        ELSE;                          /* PROCESS NEXT ACB          */ 00332000
*        PARCPTR =PARCPTR + LENGTH(PARMLIST);/*INCREMENT TO NEXT   0189 00333000
*                                            ENTRY IN PARAMETER LIST */ 00334000
         AL    PARCPTR,@CF00070                                    0189 00335000
*        RWTGC = RWTGC + LENGTH(WTGENTRY);/*INCREMENT TO NEXT ENTRY     00336000
*                                         IN WHERE-TO-GO-TABLE       */ 00337000
         AL    RWTGC,@CF00053                                      0190 00338000
*        IF  WTGEID = '3K'              /* EXECUTOR REQUIRED AGAIN   */ 00339000
*          THEN                         /* YES GO TO START           */ 00340000
         CLC   WTGEID(2,RWTGC),@CC02555                            0191 00341000
         BE    @RT00191                                            0191 00342000
*          GOTO BEGIN;                  /* YES REPEAT MODULE FOR NEW    00343000
*                                       ACB                          */ 00344000
*        ELSE                           /* NO PROCESS NEXT ACB       */ 00345000
*          GOTO NEXTACB ;               /* PROCESS NEXT ACB          */ 00346000
         B     NEXTACB                                             0193 00347000
*/********************************************************************/ 00348000
*/* 3K NOT NEEDED AGAIN - SEARCH WTG TABLE FOR FIRST NONZERO         */ 00349000
*/* ENTRY                                                            */ 00350000
*/********************************************************************/ 00351000
*SERCHWTG:                                                         0194 00352000
*        PARCPTR  = PARMPTR  ;          /* POINT TO START OF THE   0194 00353000
*                                       PARAMETER LIST               */ 00354000
SERCHWTG LR    PARCPTR,PARMPTR                                     0194 00355000
*        RWTGC = RWTG + LENGTH(WTG);    /* POINT TO START OF THE WHERE  00356000
*                                       TO GO TABLE            Y02134*/ 00357000
         LA    RWTGC,32                                            0195 00358000
         ALR   RWTGC,RWTG                                          0195 00359000
*NEXTWTGE:                              /* TEST FOR NEXT ACTIVE ENTRY*/ 00360000
*        IF    WTGEID(1) = '00'X       /* TEST FOR NEXT ACTIVE ENTRY*/ 00361000
*          THEN                         /* SET UP AND XCTL IF FOUND  */ 00362000
NEXTWTGE CLI   WTGEID(RWTGC),X'00'                                 0196 00363000
         BE    @RF00196                                            0196 00364000
*            DO;                                                   0197 00365000
*              RFY REG15 RSTD;          /*                     Y02082*/ 00366000
*ABCONENT:                              /* ENTRY BRANCH DIRECT YM1195*/ 00367000
*              REG15 = ADDR(WTGPREFX);  /*  ADDR OF WTG PREFIX Y02080*/ 00368000
ABCONENT LA    REG15,WTGPREFX(,RWTG)                               0199 00369000
*              GEN REFS(WTGMODEP);                                 0200 00370000
*        IECRES LOAD,PREFIX=0(15),BRANCH=DIRECT,MODID=(RWTGC)    Y02134 00371000
         L     15,0(,15)                                         Y02080 00372000
         STM   0,14,IECREGSV-IECPREFX(15)                        Y02080 00373000
         MVC   WTGMODNM+6(2,6),0(RWTGC)                          Y02134 00374000
         MVC   WTGMODEP+1(3,6),2(RWTGC)                          Y02134 00375000
         LA    6,WTGMODNM(,6)                                    Y02080 00376000
         L     5,CVTPTR(0,0)                                     Y02080 00377000
         L     5,CVTDMSR-CVT(,5)                                 Y02080 00378000
         B     20(,5)                                            Y02080 00379000
*              RFY REG15 UNRSTD;        /*                     Y02082*/ 00380000
*            END;                                                  0202 00381000
*        ELSE                                                      0203 00382000
*          DO;                                                     0203 00383000
         B     @RC00196                                            0203 00384000
@RF00196 DS    0H                                                  0204 00385000
*            PARCPTR = PARCPTR + LENGTH(PARMLIST) ; /* INCR NEXT ENT */ 00386000
         AL    PARCPTR,@CF00070                                    0204 00387000
*            RWTGC = RWTGC + LENGTH(WTGENTRY); /* INCR ENTRY  Y02134 */ 00388000
         AL    RWTGC,@CF00053                                      0205 00389000
*            GOTO NEXTWTGE ;            /* BRANCH BACK TO CHECK NEXT    00390000
*                                       ENTRY                        */ 00391000
         B     NEXTWTGE                                            0206 00392000
*          END;                                                    0207 00393000
*FINISH: RETURN;                        /*                    Y02080 */ 00394000
@EL00001 DS    0H                                                  0208 00395000
@EF00001 DS    0H                                                  0208 00396000
@ER00001 BR    @14                                                 0208 00397000
*        GEN DATA;                                                 0209 00398000
*        END IGG0193K                                              0210 00399000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00400000
*/*%INCLUDE SYSLIB  (IECDSECT)                                        * 00401000
*/*%INCLUDE SYSLIB  (IECDSECS)                                        * 00402000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        * 00403000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 00404000
*/*%INCLUDE SYSLIB  (IFGACB  )                                        * 00405000
*/*%INCLUDE SYSLIB  (IEFJESCT)                                        * 00406000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                        * 00407000
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                        * 00408000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                        * 00409000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        * 00410000
*/*%INCLUDE SYSLIB  (IEFJSSIB)                                        * 00411000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                        * 00412000
*/*%INCLUDE SYSLIB  (IHADSAB )                                        * 00413000
*;                                                                 0210 00414000
         B     @EL00001                                            0210 00415000
@DATA    DS    0H                                                       00416000
@CH00054 DC    H'16'                                                    00417000
@CH00102 DC    H'20'                                                    00418000
@CH00034 DC    H'24'                                                    00419000
@DATD    DSECT                                                          00420000
         DS    0F                                                       00421000
IGG0193K CSECT                                                          00422000
         DS    0F                                                       00423000
@CF00064 DC    F'1'                                                     00424000
@CF00070 DC    F'4'                                                     00425000
@CF00053 DC    F'8'                                                     00426000
@CF02541 DC    F'28'                                                    00427000
@CF02564 DC    F'40'                                                    00428000
@CF02547 DC    XL4'80000000'                                            00429000
@DATD    DSECT                                                          00430000
         DS    0D                                                       00431000
IGG0193K CSECT                                                          00432000
         DS    0F                                                       00433000
@SIZDATD DC    AL1(0)                                                   00434000
         DC    AL3(@ENDDATD-@DATD)                                      00435000
         DS    0D                                                       00436000
@CC02545 DC    C'SSIB'                                                  00437000
@CC02546 DC    C'SSOB'                                                  00438000
@CC02555 DC    C'3K'                                                    00439000
@DATD    DSECT                                                          00440000
IGG0193K CSECT                                                   Y02080 00441000
XCTLTABL XCTLTABL ID=(ID3K6M,6M),BRT=YES,LENGTH=                 Y02080 00442000
CVT      EQU   0                        DEFINE CVT DSECT NAME    Y02080 00443000
DEBLTH   EQU    128                     LENGTH OF DEB,SSIB,SSOB         00444000
*                                       IN BYTES                 Y02120 00445000
DM       EQU   254                      SUBPOOL FOR GET MAIN     Y02120 00446000
K0       EQU   0                        CONSTANT OF ZERO         Y02120 00447000
LNSAV    EQU   72                       SAVE AREA LENGTH  BYTES  Y02120 00448000
K250     EQU   250                      SUBPOOL FOR GET MAIN     Y02120 00449000
RF       EQU   15                       DEFINE REGISTER 15       Y02080 00450000
@DATD    DSECT                                                          00451000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00452000
@ENDDATD EQU   *                                                        00453000
IGG0193K CSECT                                                          00454000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00455000
@01      EQU   01                                                       00456000
@02      EQU   02                                                       00457000
@03      EQU   03                                                       00458000
@04      EQU   04                                                       00459000
@05      EQU   05                                                       00460000
@06      EQU   06                                                       00461000
@07      EQU   07                                                       00462000
@08      EQU   08                                                       00463000
@09      EQU   09                                                       00464000
@10      EQU   10                                                       00465000
@11      EQU   11                                                       00466000
@12      EQU   12                                                       00467000
@13      EQU   13                                                       00468000
@14      EQU   14                                                       00469000
@15      EQU   15                                                       00470000
R0       EQU   @00                                                      00471000
MACROREG EQU   @01                                                      00472000
R1       EQU   @01                                                      00473000
ACBPTR   EQU   @02                                                      00474000
RCORE    EQU   @04                                                      00475000
PARMPTR  EQU   @05                                                      00476000
RES      EQU   @05                                                      00477000
RWTG     EQU   @06                                                      00478000
PARCPTR  EQU   @07                                                      00479000
RWTGC    EQU   @08                                                      00480000
R9       EQU   @09                                                      00481000
R11      EQU   @11                                                      00482000
SAVEPTR  EQU   @13                                                      00483000
RET      EQU   @14                                                      00484000
REG15    EQU   @15                                                      00485000
MACRORE0 EQU   @00                                                      00486000
CVTPTR   EQU   16                                                       00487000
PSA      EQU   0                                                        00488000
FLCRNPSW EQU   PSA                                                      00489000
FLCROPSW EQU   PSA+8                                                    00490000
FLCICCW2 EQU   PSA+16                                                   00491000
PSAEEPSW EQU   PSA+132                                                  00492000
PSAESPSW EQU   PSA+136                                                  00493000
FLCSVILC EQU   PSAESPSW+1                                               00494000
PSAEPPSW EQU   PSA+140                                                  00495000
FLCPIILC EQU   PSAEPPSW+1                                               00496000
FLCPICOD EQU   PSAEPPSW+2                                               00497000
PSAPICOD EQU   FLCPICOD+1                                               00498000
FLCTEA   EQU   PSAEPPSW+4                                               00499000
FLCPER   EQU   PSA+152                                                  00500000
FLCMCLA  EQU   PSA+168                                                  00501000
FLCIOEL  EQU   FLCMCLA+4                                                00502000
FLCIOA   EQU   FLCMCLA+16                                               00503000
FLCFSA   EQU   FLCMCLA+80                                               00504000
PSASUPER EQU   PSA+552                                                  00505000
PSASUP1  EQU   PSASUPER                                                 00506000
PSASUP2  EQU   PSASUPER+1                                               00507000
PSASUP3  EQU   PSASUPER+2                                               00508000
PSASUP4  EQU   PSASUPER+3                                               00509000
PSACLHT  EQU   PSA+640                                                  00510000
PSALKSA  EQU   PSA+696                                                  00511000
PSAHLHI  EQU   PSA+760                                                  00512000
PSADSSFL EQU   PSA+836                                                  00513000
PSADSSF1 EQU   PSADSSFL                                                 00514000
PSADSSF3 EQU   PSADSSFL+2                                               00515000
PSADSSF4 EQU   PSADSSFL+3                                               00516000
PSARSVT  EQU   PSA+896                                                  00517000
DEBEXPTR EQU   0                                                        00518000
DEBSBPTR EQU   0                                                        00519000
PARMLIST EQU   0                                                        00520000
ACBOPATB EQU   PARMLIST                                                 00521000
ENDPARM  EQU   ACBOPATB                                                 00522000
ACBPTRP  EQU   PARMLIST+1                                               00523000
TCBPTRS  EQU   0                                                        00524000
SSDASSCB EQU   0                                                        00525000
FORCORE  EQU   0                                                        00526000
DXDSCB   EQU   FORCORE                                                  00527000
DXLBL    EQU   DXDSCB                                                   00528000
DXJBF    EQU   FORCORE+100                                              00529000
DXDAADDR EQU   FORCORE+312                                              00530000
DXDCB    EQU   FORCORE+320                                              00531000
DXCCW    EQU   FORCORE+368                                              00532000
DXCCW1   EQU   DXCCW                                                    00533000
DXCCW5   EQU   DXCCW+32                                                 00534000
DXCCW8   EQU   DXCCW+56                                                 00535000
DXCCW12  EQU   DXCCW+88                                                 00536000
DXXCTL   EQU   FORCORE+472                                              00537000
DXVOLSR  EQU   FORCORE+500                                              00538000
DXVOLSR1 EQU   DXVOLSR                                                  00539000
DXVOLSR2 EQU   DXVOLSR+6                                                00540000
DXVOLSR3 EQU   DXVOLSR+12                                               00541000
DXRESSW  EQU   FORCORE+524                                              00542000
DXUKEY   EQU   FORCORE+526                                              00543000
DXTCBADR EQU   FORCORE+532                                              00544000
DXDSABAD EQU   FORCORE+544                                              00545000
DXUCBSAV EQU   FORCORE+564                                              00546000
DXUDCBAD EQU   FORCORE+568                                              00547000
DXPDCBAD EQU   FORCORE+572                                              00548000
DXATCOM1 EQU   FORCORE+588                                              00549000
DXATGENS EQU   DXATCOM1                                                 00550000
DXATVGIV EQU   DXATGENS                                                 00551000
DXATOUTA EQU   DXATCOM1+2                                               00552000
DXATDACC EQU   DXATCOM1+3                                               00553000
DXATCOM2 EQU   FORCORE+592                                              00554000
DXATEOV  EQU   DXATCOM2                                                 00555000
DXATOPEN EQU   DXATCOM2+1                                               00556000
DXATALL  EQU   DXATCOM2+2                                               00557000
DXATEXC1 EQU   FORCORE+604                                              00558000
DXATEXB1 EQU   DXATEXC1                                                 00559000
DXEXHASP EQU   DXATEXB1                                                 00560000
DXATEXC2 EQU   FORCORE+608                                              00561000
DSECTSIZ EQU   FORCORE+612                                              00562000
IECPREFX EQU   0                                                        00563000
IECEXTPR EQU   IECPREFX+32                                              00564000
IECREGSV EQU   IECEXTPR                                                 00565000
IECUPRML EQU   IECEXTPR+80                                              00566000
IECRESWA EQU   IECEXTPR+84                                              00567000
RWARESWA EQU   0                                                        00568000
RWAPREFX EQU   RWARESWA                                                 00569000
USERPRML EQU   0                                                        00570000
IECRRPL  EQU   0                                                        00571000
RRPLIST  EQU   IECRRPL                                                  00572000
RRFUNCTN EQU   RRPLIST                                                  00573000
RRFLAGS1 EQU   RRPLIST+1                                                00574000
RRFLAGS2 EQU   RRPLIST+2                                                00575000
RRFLAGS3 EQU   RRPLIST+3                                                00576000
RRXRETRY EQU   RRPLIST+12                                               00577000
DSMADTRL EQU   0                                                        00578000
DSMADTW1 EQU   DSMADTRL                                                 00579000
DSMADTB1 EQU   DSMADTW1                                                 00580000
DSMADTB2 EQU   DSMADTW1+1                                               00581000
WTGTABLE EQU   0                                                        00582000
WTGWTOPR EQU   WTGTABLE                                                 00583000
WTG      EQU   0                                                        00584000
WTGAREA  EQU   WTG                                                      00585000
WTGMODNM EQU   WTGAREA                                                  00586000
WTGMODEP EQU   WTGAREA+8                                                00587000
WTGPREFX EQU   WTGAREA+16                                               00588000
WTGPATHS EQU   WTG+30                                                   00589000
WTGENTRY EQU   0                                                        00590000
WTGIDTTR EQU   WTGENTRY                                                 00591000
WTGEID   EQU   WTGIDTTR                                                 00592000
WTGCORE  EQU   WTGENTRY+5                                               00593000
APPNMTBL EQU   0                                                        00594000
APPENTRY EQU   APPNMTBL+4                                               00595000
CVTMAP   EQU   0                                                        00596000
CVTTCBP  EQU   CVTMAP                                                   00597000
CVTDAR   EQU   CVTMAP+72                                                00598000
CVTFLGS1 EQU   CVTDAR                                                   00599000
CVTDCB   EQU   CVTMAP+116                                               00600000
CVTIERLC EQU   CVTMAP+144                                               00601000
CVTOPTA  EQU   CVTMAP+182                                               00602000
CVTOPTB  EQU   CVTMAP+183                                               00603000
CVTGTF   EQU   CVTMAP+236                                               00604000
CVTGTFST EQU   CVTGTF                                                   00605000
CVTGTFS  EQU   CVTGTFST                                                 00606000
CVTSTATE EQU   CVTGTFST                                                 00607000
CVTTMODE EQU   CVTGTFST                                                 00608000
CVTFORM  EQU   CVTGTFST                                                 00609000
CVTUSR   EQU   CVTGTFST                                                 00610000
CVTAQAVT EQU   CVTMAP+240                                               00611000
CVTTCMFG EQU   CVTAQAVT                                                 00612000
CVTVOLM2 EQU   CVTMAP+244                                               00613000
CVTTATA  EQU   CVTVOLM2                                                 00614000
CVTTSKS  EQU   CVTTATA                                                  00615000
CVTVOLF2 EQU   CVTTSKS                                                  00616000
CVTTAT   EQU   CVTTATA+1                                                00617000
CVTATER  EQU   CVTMAP+248                                               00618000
CVTEXT1  EQU   CVTMAP+252                                               00619000
CVTPURG  EQU   CVTMAP+260                                               00620000
CVTQMSG  EQU   CVTMAP+268                                               00621000
CVTDMSR  EQU   CVTMAP+272                                               00622000
CVTJESCT EQU   CVTMAP+296                                               00623000
CVTERPV  EQU   CVTMAP+316                                               00624000
CVTINTLA EQU   CVTMAP+320                                               00625000
CVTAPF   EQU   CVTMAP+324                                               00626000
CVTEXT2  EQU   CVTMAP+328                                               00627000
CVTHJES  EQU   CVTMAP+332                                               00628000
CVTPGSIA EQU   CVTMAP+348                                               00629000
CVTA1F1  EQU   CVTMAP+356                                               00630000
CVTSYSK  EQU   CVTMAP+357                                               00631000
CVTVOLM1 EQU   CVTMAP+380                                               00632000
CVTVOLF1 EQU   CVTVOLM1                                                 00633000
CVTATMCT EQU   CVTMAP+388                                               00634000
CVTXTNT1 EQU   0                                                        00635000
CVTXTNT2 EQU   0                                                        00636000
CVTDSSV  EQU   CVTXTNT2                                                 00637000
CVTRSV90 EQU   CVTXTNT2+5                                               00638000
CVTQID   EQU   CVTXTNT2+24                                              00639000
CVTRV400 EQU   CVTXTNT2+52                                              00640000
CVTRV409 EQU   CVTXTNT2+53                                              00641000
CVTATCVT EQU   CVTXTNT2+64                                              00642000
CVTRV429 EQU   CVTXTNT2+84                                              00643000
CVTRV438 EQU   CVTXTNT2+85                                              00644000
CVTRV457 EQU   CVTXTNT2+112                                             00645000
CVTRV466 EQU   CVTXTNT2+113                                             00646000
CVTFIX   EQU   0                                                        00647000
CVTRELNO EQU   CVTFIX+252                                               00648000
IFGACB   EQU   0                                                        00649000
ACBCOMN  EQU   IFGACB                                                   00650000
ACBLENG  EQU   ACBCOMN+2                                                00651000
ACBLENG2 EQU   ACBLENG                                                  00652000
ACBAMBL  EQU   ACBCOMN+4                                                00653000
ACBIXLST EQU   ACBAMBL                                                  00654000
ACBJWA   EQU   ACBIXLST                                                 00655000
ACBMACRF EQU   ACBCOMN+12                                               00656000
ACBMACR1 EQU   ACBMACRF                                                 00657000
ACBADR   EQU   ACBMACR1                                                 00658000
ACBCNV   EQU   ACBMACR1                                                 00659000
ACBMACR2 EQU   ACBMACRF+1                                               00660000
ACBLFB   EQU   ACBCOMN+20                                               00661000
ACBBUFPL EQU   ACBLFB                                                   00662000
ACBRECFM EQU   ACBCOMN+24                                               00663000
ACBCCTYP EQU   ACBCOMN+25                                               00664000
ACBOPT   EQU   ACBCOMN+26                                               00665000
ACBDSORG EQU   ACBOPT                                                   00666000
ACBCROPS EQU   ACBDSORG                                                 00667000
ACBEXLST EQU   ACBCOMN+36                                               00668000
ACBDDNM  EQU   ACBCOMN+40                                               00669000
ACBAMETH EQU   ACBDDNM+3                                                00670000
ACBDEB   EQU   ACBDDNM+5                                                00671000
ACBOFLGS EQU   ACBCOMN+48                                               00672000
ACBEXFG  EQU   ACBOFLGS                                                 00673000
ACBIOSFG EQU   ACBOFLGS                                                 00674000
ACBINFLG EQU   ACBCOMN+50                                               00675000
ACBUJFCB EQU   ACBCOMN+52                                               00676000
ACBWAPTR EQU   ACBUJFCB                                                 00677000
JESCT    EQU   0                                                        00678000
JESUNITS EQU   JESCT+4                                                  00679000
JESWAA   EQU   JESCT+8                                                  00680000
JESSSREQ EQU   JESCT+20                                                 00681000
TCBFIX   EQU   0                                                        00682000
TCBFRS   EQU   TCBFIX                                                   00683000
TCB      EQU   0                                                        00684000
TCBPIE   EQU   TCB+4                                                    00685000
TCBPMASK EQU   TCBPIE                                                   00686000
TCBDEB   EQU   TCB+8                                                    00687000
TCBTIO   EQU   TCB+12                                                   00688000
TCBCMP   EQU   TCB+16                                                   00689000
TCBCMPF  EQU   TCBCMP                                                   00690000
TCBCPP   EQU   TCBCMPF                                                  00691000
TCBSTCC  EQU   TCBCMPF                                                  00692000
TCBCDBL  EQU   TCBCMPF                                                  00693000
TCBCWTO  EQU   TCBCMPF                                                  00694000
TCBCIND  EQU   TCBCMPF                                                  00695000
TCBCMSG  EQU   TCBCMPF                                                  00696000
TCBTRN   EQU   TCB+20                                                   00697000
TCBABF   EQU   TCBTRN                                                   00698000
TCBMSS   EQU   TCB+24                                                   00699000
TCBPKF   EQU   TCB+28                                                   00700000
TCBFLGS  EQU   TCB+29                                                   00701000
TCBFLGS1 EQU   TCBFLGS                                                  00702000
TCBFLGS2 EQU   TCBFLGS+1                                                00703000
TCBFLGS3 EQU   TCBFLGS+2                                                00704000
TCBFLGS4 EQU   TCBFLGS+3                                                00705000
TCBFLGS5 EQU   TCBFLGS+4                                                00706000
TCBABWF  EQU   TCBFLGS5                                                 00707000
TCBJPQ   EQU   TCB+44                                                   00708000
TCBPURGE EQU   TCBJPQ                                                   00709000
TCBGRS   EQU   TCB+48                                                   00710000
TCBFSA   EQU   TCB+112                                                  00711000
TCBTME   EQU   TCB+120                                                  00712000
TCBJSTCB EQU   TCB+124                                                  00713000
TCBTSFLG EQU   TCB+148                                                  00714000
TCBTSTSK EQU   TCBTSFLG                                                 00715000
TCBSTAB  EQU   TCB+160                                                  00716000
TCBNSTAE EQU   TCBSTAB                                                  00717000
TCBTCT   EQU   TCB+164                                                  00718000
TCBTCTGF EQU   TCBTCT                                                   00719000
TCBSCNDY EQU   TCB+172                                                  00720000
TCBNDSP  EQU   TCBSCNDY                                                 00721000
TCBNDSP1 EQU   TCBNDSP+1                                                00722000
TCBNDSP2 EQU   TCBNDSP+2                                                00723000
TCBNDSP3 EQU   TCBNDSP+3                                                00724000
TCBJSCB  EQU   TCB+180                                                  00725000
TCBRECDE EQU   TCBJSCB                                                  00726000
TCBEXT1  EQU   TCB+196                                                  00727000
TCBBITS  EQU   TCB+200                                                  00728000
TCBNDSP4 EQU   TCBBITS                                                  00729000
TCBNDSP5 EQU   TCBBITS+1                                                00730000
TCBFLGS6 EQU   TCBBITS+2                                                00731000
TCBFLGS7 EQU   TCBBITS+3                                                00732000
TCBDAR   EQU   TCB+204                                                  00733000
TCBDARC  EQU   TCBDAR                                                   00734000
TCBEXT2  EQU   TCB+208                                                  00735000
TCBFOE   EQU   TCB+244                                                  00736000
TCBESTAE EQU   TCB+264                                                  00737000
TCBESTRM EQU   TCBESTAE+1                                               00738000
TCBFBYT1 EQU   TCB+276                                                  00739000
TCBFBYT2 EQU   TCB+277                                                  00740000
TCBRV124 EQU   TCB+278                                                  00741000
TCBRV133 EQU   TCB+279                                                  00742000
TCBXTNT2 EQU   0                                                        00743000
TCBGTF   EQU   TCBXTNT2                                                 00744000
TCBTFLG  EQU   TCBGTF                                                   00745000
TCBRV146 EQU   TCBXTNT2+28                                              00746000
TCBRV155 EQU   TCBXTNT2+29                                              00747000
TCBRV164 EQU   TCBXTNT2+30                                              00748000
TCBRV173 EQU   TCBXTNT2+31                                              00749000
TIOT1    EQU   0                                                        00750000
DEBBASIC EQU   0                                                        00751000
DEBTCBAD EQU   DEBBASIC                                                 00752000
DEBDEBAD EQU   DEBBASIC+4                                               00753000
DEBAMLNG EQU   DEBDEBAD                                                 00754000
DEBIRBAD EQU   DEBBASIC+8                                               00755000
DEBOFLGS EQU   DEBIRBAD                                                 00756000
DEBOPATB EQU   DEBBASIC+12                                              00757000
DEBFLGS1 EQU   DEBBASIC+14                                              00758000
DEBUSRPG EQU   DEBBASIC+16                                              00759000
DEBNMEXT EQU   DEBUSRPG                                                 00760000
DEBRRQ   EQU   DEBBASIC+20                                              00761000
DEBECBAD EQU   DEBRRQ                                                   00762000
DEBDCBAD EQU   DEBBASIC+24                                              00763000
DEBPROTG EQU   DEBDCBAD                                                 00764000
DEBDEBID EQU   DEBPROTG                                                 00765000
DEBAPPAD EQU   DEBBASIC+28                                              00766000
DEBEXSCL EQU   DEBAPPAD                                                 00767000
DEBBASND EQU   DEBBASIC+32                                              00768000
DEBDASD  EQU   0                                                        00769000
DEBUCBAD EQU   DEBDASD                                                  00770000
DEBBINUM EQU   DEBDASD+4                                                00771000
DEBACSMD EQU   0                                                        00772000
DEBVOLSQ EQU   DEBACSMD                                                 00773000
DEBVOLBT EQU   DEBVOLSQ                                                 00774000
DEBDSNM  EQU   DEBACSMD+4                                               00775000
DEBUTSAA EQU   DEBDSNM                                                  00776000
DEBACS01 EQU   0                                                        00777000
DEBDSNAM EQU   DEBACS01                                                 00778000
DEBACS02 EQU   0                                                        00779000
DEBDBLK  EQU   DEBACS02                                                 00780000
DEBACS03 EQU   0                                                        00781000
DEBACS04 EQU   0                                                        00782000
DEBTBFRA EQU   DEBACS04                                                 00783000
DEBTCCWA EQU   DEBACS04+4                                               00784000
DEBACS05 EQU   0                                                        00785000
DEBFUCBA EQU   DEBACS05                                                 00786000
DEBLUCBA EQU   DEBACS05+4                                               00787000
DEBACS06 EQU   0                                                        00788000
DEBACS07 EQU   0                                                        00789000
DEBACS08 EQU   0                                                        00790000
DEBSUBNM EQU   0                                                        00791000
DEB      EQU   0                                                        00792000
DEBAVT   EQU   DEB                                                      00793000
DEBEOEA  EQU   DEBAVT                                                   00794000
DEBEOEAB EQU   DEBEOEA                                                  00795000
DEBSIOA  EQU   DEBAVT+4                                                 00796000
DEBSIOAB EQU   DEBSIOA                                                  00797000
DEBPCIA  EQU   DEBAVT+8                                                 00798000
DEBPCIAB EQU   DEBPCIA                                                  00799000
DEBCEA   EQU   DEBAVT+12                                                00800000
DEBCEAB  EQU   DEBCEA                                                   00801000
DEBXCEA  EQU   DEBAVT+16                                                00802000
DEBXCEAB EQU   DEBXCEA                                                  00803000
DEBPREFX EQU   DEB+20                                                   00804000
DEBXTNP  EQU   DEBPREFX+8                                               00805000
DEBLNGTH EQU   DEBPREFX+12                                              00806000
DEBXTN   EQU   0                                                        00807000
DEBXFLG1 EQU   DEBXTN+2                                                 00808000
INFMJFCB EQU   0                                                        00809000
JFCBDSNM EQU   INFMJFCB                                                 00810000
JFCBELNM EQU   INFMJFCB+44                                              00811000
JFCBTSDM EQU   INFMJFCB+52                                              00812000
JFCFCBID EQU   INFMJFCB+56                                              00813000
JFCBFRID EQU   JFCFCBID                                                 00814000
JFCBLTYP EQU   INFMJFCB+66                                              00815000
JFCBOTTR EQU   INFMJFCB+67                                              00816000
JFCBUFOF EQU   JFCBOTTR                                                 00817000
JFCBFLSQ EQU   JFCBOTTR+1                                               00818000
JFCFUNC  EQU   JFCBFLSQ                                                 00819000
JFCBMASK EQU   INFMJFCB+72                                              00820000
JFCBFLG1 EQU   JFCBMASK+5                                               00821000
JFCOPEN  EQU   JFCBFLG1                                                 00822000
JFCBFLG2 EQU   JFCBMASK+6                                               00823000
JFCDEFER EQU   JFCBFLG2                                                 00824000
JFCBIND1 EQU   INFMJFCB+86                                              00825000
JFCBIND2 EQU   INFMJFCB+87                                              00826000
JFCAMPTR EQU   INFMJFCB+88                                              00827000
JFCBUFRQ EQU   JFCAMPTR                                                 00828000
JFCBUFNO EQU   JFCBUFRQ                                                 00829000
JFCBGNCP EQU   JFCAMPTR+1                                               00830000
JFCBHIAR EQU   JFCBGNCP                                                 00831000
JFCBFALN EQU   JFCBHIAR                                                 00832000
JFCBFTEK EQU   JFCBFALN                                                 00833000
JFCBBFTA EQU   JFCBFTEK                                                 00834000
JFCEROPT EQU   INFMJFCB+92                                              00835000
JFCTRTCH EQU   INFMJFCB+93                                              00836000
SSIB     EQU   0                                                        00837000
SSIBID   EQU   SSIB                                                     00838000
SSIBLEN  EQU   SSIB+4                                                   00839000
SSIBFLG1 EQU   SSIB+6                                                   00840000
SSIBSSNM EQU   SSIB+8                                                   00841000
SSIBSUSE EQU   SSIB+32                                                  00842000
SSOB     EQU   0                                                        00843000
SSOBID   EQU   SSOB                                                     00844000
SSOBLEN  EQU   SSOB+4                                                   00845000
SSOBFUNC EQU   SSOB+6                                                   00846000
SSOBSSIB EQU   SSOB+8                                                   00847000
SSOBRETN EQU   SSOB+12                                                  00848000
SSOBINDV EQU   SSOB+16                                                  00849000
SSDA     EQU   0                                                        00850000
SSDALEN  EQU   SSDA                                                     00851000
SSDARESF EQU   SSDA+3                                                   00852000
SSDAJFCB EQU   SSDA+8                                                   00853000
SSDADEBP EQU   SSDA+12                                                  00854000
DSAB     EQU   0                                                        00855000
DSABGIDP EQU   DSAB+24                                                  00856000
DSABANMP EQU   DSAB+28                                                  00857000
DSABORG  EQU   DSAB+32                                                  00858000
DSABORG1 EQU   DSABORG                                                  00859000
DSABORG2 EQU   DSABORG+1                                                00860000
DSABFLG1 EQU   DSAB+34                                                  00861000
DSABFLG2 EQU   DSAB+35                                                  00862000
DSABFLG3 EQU   DSAB+36                                                  00863000
DSABFLG4 EQU   DSAB+37                                                  00864000
DSABSSNM EQU   DSAB+48                                                  00865000
DSABSSCM EQU   DSAB+52                                                  00866000
DSABANMI EQU   0                                                        00867000
DSABGIDL EQU   0                                                        00868000
SSREQ    EQU   0                                                        00869000
SWAMGR   EQU   0                                                        00870000
DEBDCBA  EQU   DEBDCBAD+1                                               00871000
DXUDCBA  EQU   DXUDCBAD+1                                               00872000
TCBPTR   EQU   DXTCBADR                                                 00873000
DXCCW1A  EQU   DXCCW1                                                   00874000
DXXWTG   EQU   DSECTSIZ                                                 00875000
DXXAREA  EQU   DSECTSIZ+4                                               00876000
DXXMODNM EQU   DXXAREA                                                  00877000
DXXLNG   EQU   DXXAREA+29                                               00878000
DXXENTRY EQU   DXXAREA+32                                               00879000
DXXIDTTR EQU   DXXENTRY                                                 00880000
DXREGSAV EQU   DXCCW8                                                   00881000
DXREG9   EQU   DXREGSAV                                                 00882000
DXREG1   EQU   DXREGSAV+28                                              00883000
DXIDENT  EQU   DXCCW12                                                  00884000
DXCALLID EQU   DXIDENT                                                  00885000
DXRETMOD EQU   DXIDENT+2                                                00886000
@NM00031 EQU   DXXCTL                                                   00887000
DXSAVMOD EQU   @NM00031+2                                               00888000
@NM00032 EQU   DXRESSW                                                  00889000
PSARSVTE EQU   PSARSVT                                                  00890000
CVTS01   EQU   CVTPGSIA                                                 00891000
CVTLPDIA EQU   CVTS01+12                                                00892000
CVTDIRST EQU   CVTLPDIA                                                 00893000
CVTSLIDA EQU   CVTS01+24                                                00894000
CVTCTLFG EQU   CVTS01+50                                                00895000
CVTRV210 EQU   CVTS01+424                                               00896000
CVTRV219 EQU   CVTS01+425                                               00897000
CVTRV228 EQU   CVTS01+426                                               00898000
CVTRV237 EQU   CVTS01+427                                               00899000
CVTMFRTR EQU   CVTS01+452                                               00900000
CVTRV262 EQU   CVTS01+468                                               00901000
CVTRV271 EQU   CVTS01+469                                               00902000
CVTRV280 EQU   CVTS01+470                                               00903000
CVTRV289 EQU   CVTS01+471                                               00904000
CVTGSDA  EQU   CVTS01+600                                               00905000
TIOENTRY EQU   TIOT1+24                                                 00906000
TIOESTTA EQU   TIOENTRY+1                                               00907000
TIOERLOC EQU   TIOENTRY+2                                               00908000
TIOELINK EQU   TIOERLOC+1                                               00909000
TIOESYOT EQU   TIOELINK                                                 00910000
TIOESTTC EQU   TIOENTRY+15                                              00911000
TIOESTTB EQU   TIOENTRY+16                                              00912000
POOLSTAR EQU   TIOENTRY+20                                              00913000
TIOEDEVE EQU   TIOESTTB                                                 00914000
TIOSTTB  EQU   TIOEDEVE                                                 00915000
DEBBAS02 EQU   DEBBASND                                                 00916000
DEBDDS1  EQU   DEBBAS02                                                 00917000
DEBSUCBA EQU   DEBDDS1                                                  00918000
DEBRDCB  EQU   DEBDDS1+4                                                00919000
DEBPDCB  EQU   DEBDDS1+8                                                00920000
DEBWDCB  EQU   DEBDDS1+12                                               00921000
DEBBAS01 EQU   DEBBASND                                                 00922000
DEBISAM  EQU   DEBBAS01                                                 00923000
DEBFIEAD EQU   DEBISAM                                                  00924000
DEBFPEAD EQU   DEBISAM+4                                                00925000
DEBFOEAD EQU   DEBISAM+8                                                00926000
DEBEXPT  EQU   DEBISAM+12                                               00927000
DEBRPSID EQU   DEBEXPT                                                  00928000
JFCKEYLE EQU   JFCTRTCH                                                 00929000
JFCCODE  EQU   JFCKEYLE                                                 00930000
JFCSTACK EQU   JFCTRTCH                                                 00931000
JFCMODE  EQU   JFCSTACK                                                 00932000
JFCSPPRT EQU   JFCTRTCH                                                 00933000
JFCBABFS EQU   JFCSPPRT+2                                               00934000
JFCLIMCT EQU   JFCBABFS                                                 00935000
JFCDSORG EQU   JFCSPPRT+5                                               00936000
JFCDSRG1 EQU   JFCDSORG                                                 00937000
JFCDSRG2 EQU   JFCDSORG+1                                               00938000
JFCRECFM EQU   JFCSPPRT+7                                               00939000
JFCRCFM  EQU   JFCRECFM                                                 00940000
JFCOPTCD EQU   JFCSPPRT+8                                               00941000
JFCWVCSP EQU   JFCOPTCD                                                 00942000
JFCWVCIS EQU   JFCWVCSP                                                 00943000
JFCWVCBD EQU   JFCWVCIS                                                 00944000
JFCALLOW EQU   JFCOPTCD                                                 00945000
JFCRSV17 EQU   JFCALLOW                                                 00946000
JFCOVER  EQU   JFCRSV17                                                 00947000
JFCPCIBT EQU   JFCOPTCD                                                 00948000
JFCMAST  EQU   JFCPCIBT                                                 00949000
JFCEXT   EQU   JFCMAST                                                  00950000
JFCBCKPT EQU   JFCOPTCD                                                 00951000
JFCIND   EQU   JFCBCKPT                                                 00952000
JFCRSV18 EQU   JFCOPTCD                                                 00953000
JFCCYL   EQU   JFCRSV18                                                 00954000
JFCACT   EQU   JFCCYL                                                   00955000
JFCREDUC EQU   JFCOPTCD                                                 00956000
JFCRSV19 EQU   JFCREDUC                                                 00957000
JFCRSV20 EQU   JFCRSV19                                                 00958000
JFCRSV21 EQU   JFCOPTCD                                                 00959000
JFCDEL   EQU   JFCRSV21                                                 00960000
JFCRSV23 EQU   JFCOPTCD                                                 00961000
JFCREORG EQU   JFCRSV23                                                 00962000
JFCBLKSI EQU   JFCSPPRT+9                                               00963000
JFCBUFSI EQU   JFCBLKSI                                                 00964000
JFCAMSYN EQU   JFCSPPRT+11                                              00965000
JFCNCP   EQU   JFCAMSYN+2                                               00966000
JFCNTM   EQU   JFCAMSYN+3                                               00967000
JFCBFSEQ EQU   JFCNTM                                                   00968000
JFCPCI   EQU   JFCBFSEQ                                                 00969000
JFCRESRV EQU   JFCAMSYN+4                                               00970000
JFCUCSEG EQU   JFCRESRV                                                 00971000
JFCUCSOP EQU   JFCUCSEG+4                                               00972000
JFCOUTLI EQU   JFCUCSEG+5                                               00973000
JFCTHRSH EQU   JFCOUTLI                                                 00974000
JFCCPRI  EQU   JFCTHRSH                                                 00975000
JFCBVOLS EQU   JFCUCSEG+10                                              00976000
JFCBPQTY EQU   JFCUCSEG+44                                              00977000
JFCBCTRI EQU   JFCUCSEG+47                                              00978000
JFCBSQTY EQU   JFCUCSEG+48                                              00979000
JFCBIND3 EQU   JFCBSQTY+2                                               00980000
JFCFLGS1 EQU   JFCUCSEG+51                                              00981000
DXBTAMX  EQU   DXREG1                                                   00982000
DXDSNAME EQU   DXCCW5                                                   00983000
FLC      EQU   PSA                                                      00984000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00985000
JFCBEND  EQU   JFCUCSEG+68                                              00986000
JFCBSPTN EQU   JFCUCSEG+67                                              00987000
JFCBVLCT EQU   JFCUCSEG+66                                              00988000
JFCBDRLH EQU   JFCUCSEG+63                                              00989000
JFCBSBNM EQU   JFCUCSEG+60                                              00990000
JFCBABST EQU   JFCUCSEG+58                                              00991000
JFCBSPNM EQU   JFCUCSEG+55                                              00992000
JFCBDQTY EQU   JFCUCSEG+52                                              00993000
JFCBUAFF EQU   JFCFLGS1                                                 00994000
JFCRSV45 EQU   JFCFLGS1                                                 00995000
JFCVRDS  EQU   JFCFLGS1                                                 00996000
JFCRSV43 EQU   JFCFLGS1                                                 00997000
JFCRSV42 EQU   JFCFLGS1                                                 00998000
JFCRSV41 EQU   JFCFLGS1                                                 00999000
JFCTOPEN EQU   JFCFLGS1                                                 01000000
JFCRSV39 EQU   JFCFLGS1                                                 01001000
JFCRSV52 EQU   JFCBIND3                                                 01002000
JFCRSV51 EQU   JFCBIND3                                                 01003000
JFCRSV50 EQU   JFCBIND3                                                 01004000
JFCRSV49 EQU   JFCBIND3                                                 01005000
JFCRSV48 EQU   JFCBIND3                                                 01006000
JFCRSV47 EQU   JFCBIND3                                                 01007000
JFCRSV46 EQU   JFCBIND3                                                 01008000
JFCBDLET EQU   JFCBIND3                                                 01009000
JFCRQID  EQU   JFCBSQTY                                                 01010000
JFCROUND EQU   JFCBCTRI                                                 01011000
JFCALX   EQU   JFCBCTRI                                                 01012000
JFCMIXG  EQU   JFCBCTRI                                                 01013000
JFCONTIG EQU   JFCBCTRI                                                 01014000
JFCRSV29 EQU   JFCBCTRI                                                 01015000
JFCRSV28 EQU   JFCBCTRI                                                 01016000
JFCBSPAC EQU   JFCBCTRI                                                 01017000
JFCRUNIT EQU   JFCBPQTY                                                 01018000
JFCBEXAD EQU   JFCUCSEG+41                                              01019000
JFCBEXTL EQU   JFCUCSEG+40                                              01020000
JFCAVOLS EQU   JFCBVOLS                                                 01021000
JFCBNVOL EQU   JFCUCSEG+9                                               01022000
JFCBNTCS EQU   JFCUCSEG+8                                               01023000
JFCSOWA  EQU   JFCOUTLI+1                                               01024000
JFCSEND  EQU   JFCCPRI                                                  01025000
JFCEQUAL EQU   JFCCPRI                                                  01026000
JFCRECV  EQU   JFCCPRI                                                  01027000
JFCRSV34 EQU   JFCCPRI                                                  01028000
JFCRSV33 EQU   JFCCPRI                                                  01029000
JFCRSV55 EQU   JFCCPRI                                                  01030000
JFCRSV54 EQU   JFCCPRI                                                  01031000
JFCRSV53 EQU   JFCCPRI                                                  01032000
JFCRSV27 EQU   JFCUCSOP                                                 01033000
JFCRSV26 EQU   JFCUCSOP                                                 01034000
JFCFCBVR EQU   JFCUCSOP                                                 01035000
JFCFCBAL EQU   JFCUCSOP                                                 01036000
JFCVER   EQU   JFCUCSOP                                                 01037000
JFCRSV25 EQU   JFCUCSOP                                                 01038000
JFCFOLD  EQU   JFCUCSOP                                                 01039000
JFCRSV24 EQU   JFCUCSOP                                                 01040000
JFCUCSID EQU   JFCUCSEG                                                 01041000
JFCINTVL EQU   JFCSPPRT+19                                              01042000
JFCDBUFN EQU   JFCRESRV+3                                               01043000
JFCCYLOF EQU   JFCRESRV+2                                               01044000
JFCRKP   EQU   JFCRESRV                                                 01045000
JFCPCIR2 EQU   JFCPCI                                                   01046000
JFCPCIR1 EQU   JFCPCI                                                   01047000
JFCPCIN2 EQU   JFCPCI                                                   01048000
JFCPCIN1 EQU   JFCPCI                                                   01049000
JFCPCIA2 EQU   JFCPCI                                                   01050000
JFCPCIA1 EQU   JFCPCI                                                   01051000
JFCPCIX2 EQU   JFCPCI                                                   01052000
JFCPCIX1 EQU   JFCPCI                                                   01053000
JFCBUFMX EQU   JFCNCP                                                   01054000
JFCLRECL EQU   JFCAMSYN                                                 01055000
JFCBAXBF EQU   JFCBUFSI                                                 01056000
JFCREL   EQU   JFCREORG                                                 01057000
JFCRSV22 EQU   JFCDEL                                                   01058000
JFCSRCHD EQU   JFCRSV20                                                 01059000
JFCOPTQ  EQU   JFCACT                                                   01060000
JFCFEED  EQU   JFCIND                                                   01061000
JFCCBWU  EQU   JFCEXT                                                   01062000
JFCWUMSG EQU   JFCOVER                                                  01063000
JFCSDNAM EQU   JFCWVCBD                                                 01064000
@NM00082 EQU   JFCRECFM                                                 01065000
JFCCHAR  EQU   JFCRECFM                                                 01066000
JFCRFS   EQU   JFCRECFM                                                 01067000
JFCRFB   EQU   JFCRECFM                                                 01068000
JFCRFO   EQU   JFCRCFM                                                  01069000
JFCFMREC EQU   JFCRCFM                                                  01070000
JFCRSV16 EQU   JFCDSRG2                                                 01071000
JFCRSV15 EQU   JFCDSRG2                                                 01072000
JFCORGTR EQU   JFCDSRG2                                                 01073000
JFCORGAM EQU   JFCDSRG2                                                 01074000
JFCRSV13 EQU   JFCDSRG2                                                 01075000
JFCORGTQ EQU   JFCDSRG2                                                 01076000
JFCORGTX EQU   JFCDSRG2                                                 01077000
JFCORGGS EQU   JFCDSRG2                                                 01078000
JFCORGU  EQU   JFCDSRG1                                                 01079000
JFCORGPO EQU   JFCDSRG1                                                 01080000
JFCORGMQ EQU   JFCDSRG1                                                 01081000
JFCORGCQ EQU   JFCDSRG1                                                 01082000
JFCORGCX EQU   JFCDSRG1                                                 01083000
JFCORGDA EQU   JFCDSRG1                                                 01084000
JFCORGPS EQU   JFCDSRG1                                                 01085000
JFCORGIS EQU   JFCDSRG1                                                 01086000
JFCTRKBL EQU   JFCLIMCT+1                                               01087000
@NM00081 EQU   JFCLIMCT                                                 01088000
JFCDEN   EQU   JFCSPPRT+1                                               01089000
JFCPRTSP EQU   JFCSPPRT                                                 01090000
JFCONE   EQU   JFCMODE                                                  01091000
JFCTWO   EQU   JFCMODE                                                  01092000
JFCRSV07 EQU   JFCMODE                                                  01093000
JFCRSV06 EQU   JFCMODE                                                  01094000
JFCMODER EQU   JFCMODE                                                  01095000
JFCMODEO EQU   JFCMODE                                                  01096000
JFCEBCD  EQU   JFCMODE                                                  01097000
JFCBIN   EQU   JFCMODE                                                  01098000
JFCRSV32 EQU   JFCCODE                                                  01099000
JFCTTY   EQU   JFCCODE                                                  01100000
JFCASCII EQU   JFCCODE                                                  01101000
JFCNCR   EQU   JFCCODE                                                  01102000
JFCBUR   EQU   JFCCODE                                                  01103000
JFCFRI   EQU   JFCCODE                                                  01104000
JFCBCD   EQU   JFCCODE                                                  01105000
JFCNOCON EQU   JFCCODE                                                  01106000
DEBEXPTA EQU   DEBEXPT+1                                                01107000
DEBRSV12 EQU   DEBRPSID                                                 01108000
DEBRSV11 EQU   DEBRPSID                                                 01109000
DEBRSV10 EQU   DEBRPSID                                                 01110000
DEBRSV09 EQU   DEBRPSID                                                 01111000
DEBRPSAP EQU   DEBRPSID                                                 01112000
DEBRPSO  EQU   DEBRPSID                                                 01113000
DEBRPSI  EQU   DEBRPSID                                                 01114000
DEBRPSP  EQU   DEBRPSID                                                 01115000
DEBFOEB  EQU   DEBFOEAD+1                                               01116000
DEBNOEE  EQU   DEBFOEAD                                                 01117000
DEBFPEB  EQU   DEBFPEAD+1                                               01118000
DEBNPEE  EQU   DEBFPEAD                                                 01119000
DEBFIEB  EQU   DEBFIEAD+1                                               01120000
DEBNIEE  EQU   DEBFIEAD                                                 01121000
DEBWDCBA EQU   DEBWDCB+1                                                01122000
DEBRSV08 EQU   DEBWDCB                                                  01123000
DEBPDCBA EQU   DEBPDCB+1                                                01124000
DEBRSV07 EQU   DEBPDCB                                                  01125000
DEBRDCBA EQU   DEBRDCB+1                                                01126000
DEBRSV06 EQU   DEBRDCB                                                  01127000
DEBSUCBB EQU   DEBSUCBA+1                                               01128000
DEBSDVM  EQU   DEBSUCBA                                                 01129000
TIOUCBP  EQU   TIOEDEVE+1                                               01130000
TIOVERF  EQU   TIOSTTB                                                  01131000
TIOUNLD  EQU   TIOSTTB                                                  01132000
TIOMNTD  EQU   TIOSTTB                                                  01133000
TIOSETU  EQU   TIOSTTB                                                  01134000
TIOVLSR  EQU   TIOSTTB                                                  01135000
TIOPVIO  EQU   TIOSTTB                                                  01136000
TIOREQD  EQU   TIOSTTB                                                  01137000
TIOUSED  EQU   TIOSTTB                                                  01138000
TIOTFEND EQU   POOLSTAR+16                                              01139000
TIOPSLOT EQU   POOLSTAR+13                                              01140000
TIOPSTTB EQU   POOLSTAR+12                                              01141000
TIOPPOOL EQU   POOLSTAR+4                                               01142000
TIOPNSRT EQU   POOLSTAR+3                                               01143000
@NM00075 EQU   POOLSTAR+2                                               01144000
TIOPNSLT EQU   POOLSTAR+1                                               01145000
@NM00074 EQU   POOLSTAR                                                 01146000
TIOEFSRT EQU   TIOENTRY+17                                              01147000
TIOSVERF EQU   TIOESTTB                                                 01148000
TIOSUNLD EQU   TIOESTTB                                                 01149000
TIOSMNTD EQU   TIOESTTB                                                 01150000
TIOSSETU EQU   TIOESTTB                                                 01151000
TIOSVLSR EQU   TIOESTTB                                                 01152000
TIOSPVIO EQU   TIOESTTB                                                 01153000
TIOSREQD EQU   TIOESTTB                                                 01154000
TIOSUSED EQU   TIOESTTB                                                 01155000
TIOSBALS EQU   TIOESTTC                                                 01156000
TIOSBALP EQU   TIOESTTC                                                 01157000
TIOSVOLS EQU   TIOESTTC                                                 01158000
TIOSVOLP EQU   TIOESTTC                                                 01159000
TIOSAFFS EQU   TIOESTTC                                                 01160000
TIOSAFFP EQU   TIOESTTC                                                 01161000
TIOSDEFR EQU   TIOESTTC                                                 01162000
TIOSDKCR EQU   TIOESTTC                                                 01163000
TIOEJFCB EQU   TIOENTRY+12                                              01164000
TIOEDDNM EQU   TIOENTRY+4                                               01165000
TIOTREM  EQU   TIOELINK                                                 01166000
TIOESSDS EQU   TIOESYOT                                                 01167000
TIOESYIN EQU   TIOELINK                                                 01168000
TIOEQNAM EQU   TIOELINK                                                 01169000
TIOEDYNM EQU   TIOELINK                                                 01170000
TIOTTERM EQU   TIOELINK                                                 01171000
TIOTRV01 EQU   TIOELINK                                                 01172000
TIOSYOUT EQU   TIOELINK                                                 01173000
TIOEWTCT EQU   TIOERLOC                                                 01174000
TIOSDSP2 EQU   TIOESTTA                                                 01175000
TIOSDSP1 EQU   TIOESTTA                                                 01176000
TIOSLABL EQU   TIOESTTA                                                 01177000
TIOSDADS EQU   TIOESTTA                                                 01178000
TIOSJBLB EQU   TIOESTTA                                                 01179000
TIOSPLTS EQU   TIOESTTA                                                 01180000
TIOSPLTP EQU   TIOESTTA                                                 01181000
TIOSLTYP EQU   TIOESTTA                                                 01182000
TIOELNGH EQU   TIOENTRY                                                 01183000
CVTTPIO  EQU   CVTS01+608                                               01184000
CVTADV   EQU   CVTS01+604                                               01185000
CVTGSDAB EQU   CVTGSDA                                                  01186000
CVTQV3   EQU   CVTS01+596                                               01187000
CVTQV2   EQU   CVTS01+592                                               01188000
CVTQV1   EQU   CVTS01+588                                               01189000
CVTRPT   EQU   CVTS01+584                                               01190000
CVTSSRB  EQU   CVTS01+580                                               01191000
CVTCSDRL EQU   CVTS01+576                                               01192000
CVTEXP1  EQU   CVTS01+572                                               01193000
CVTRMPMT EQU   CVTS01+568                                               01194000
CVTRMPTT EQU   CVTS01+564                                               01195000
CVTVPSA  EQU   CVTS01+560                                               01196000
CVTVSTOP EQU   CVTS01+556                                               01197000
CVTGTFR8 EQU   CVTS01+552                                               01198000
CVTQUIT  EQU   CVTS01+548                                               01199000
CVTVACR  EQU   CVTS01+544                                               01200000
CVTWTCB  EQU   CVTS01+540                                               01201000
CVTSTPRS EQU   CVTS01+536                                               01202000
CVT0PT02 EQU   CVTS01+532                                               01203000
CVTDARCM EQU   CVTS01+528                                               01204000
CVTIRECM EQU   CVTS01+524                                               01205000
CVTJRECM EQU   CVTS01+520                                               01206000
CVTVEMS0 EQU   CVTS01+516                                               01207000
CVTSPFRR EQU   CVTS01+512                                               01208000
CVTRLSTG EQU   CVTS01+508                                               01209000
CVT0TC0A EQU   CVTS01+504                                               01210000
CVTGMBR  EQU   CVTS01+500                                               01211000
CVTLFRM  EQU   CVTS01+496                                               01212000
CVTRMBR  EQU   CVTS01+492                                               01213000
CVTVIOP  EQU   CVTS01+488                                               01214000
CVTRV307 EQU   CVTS01+486                                               01215000
CVTRV306 EQU   CVTS01+484                                               01216000
CVTRV305 EQU   CVTS01+482                                               01217000
CVTRV304 EQU   CVTS01+480                                               01218000
CVTRV303 EQU   CVTS01+478                                               01219000
CVTRV302 EQU   CVTS01+476                                               01220000
CVTRV301 EQU   CVTS01+475                                               01221000
CVTRV300 EQU   CVTS01+474                                               01222000
CVTRV299 EQU   CVTS01+473                                               01223000
CVTRV298 EQU   CVTS01+472                                               01224000
CVTRV297 EQU   CVTRV289                                                 01225000
CVTRV296 EQU   CVTRV289                                                 01226000
CVTRV295 EQU   CVTRV289                                                 01227000
CVTRV294 EQU   CVTRV289                                                 01228000
CVTRV293 EQU   CVTRV289                                                 01229000
CVTRV292 EQU   CVTRV289                                                 01230000
CVTRV291 EQU   CVTRV289                                                 01231000
CVTRV290 EQU   CVTRV289                                                 01232000
CVTRV288 EQU   CVTRV280                                                 01233000
CVTRV287 EQU   CVTRV280                                                 01234000
CVTRV286 EQU   CVTRV280                                                 01235000
CVTRV285 EQU   CVTRV280                                                 01236000
CVTRV284 EQU   CVTRV280                                                 01237000
CVTRV283 EQU   CVTRV280                                                 01238000
CVTRV282 EQU   CVTRV280                                                 01239000
CVTRV281 EQU   CVTRV280                                                 01240000
CVTRV279 EQU   CVTRV271                                                 01241000
CVTRV278 EQU   CVTRV271                                                 01242000
CVTRV277 EQU   CVTRV271                                                 01243000
CVTRV276 EQU   CVTRV271                                                 01244000
CVTRV275 EQU   CVTRV271                                                 01245000
CVTRV274 EQU   CVTRV271                                                 01246000
CVTRV273 EQU   CVTRV271                                                 01247000
CVTRV272 EQU   CVTRV271                                                 01248000
CVTRV270 EQU   CVTRV262                                                 01249000
CVTRV269 EQU   CVTRV262                                                 01250000
CVTRV268 EQU   CVTRV262                                                 01251000
CVTRV267 EQU   CVTRV262                                                 01252000
CVTRV266 EQU   CVTRV262                                                 01253000
CVTRV265 EQU   CVTRV262                                                 01254000
CVTRV264 EQU   CVTRV262                                                 01255000
CVTRV263 EQU   CVTRV262                                                 01256000
CVTVFP   EQU   CVTS01+464                                               01257000
CVTVSI   EQU   CVTS01+460                                               01258000
CVTVPSIB EQU   CVTS01+456                                               01259000
CVTMFACT EQU   CVTMFRTR                                                 01260000
CVTMFCTL EQU   CVTS01+448                                               01261000
CVTPVBP  EQU   CVTS01+444                                               01262000
CVTPWI   EQU   CVTS01+440                                               01263000
CVTRV254 EQU   CVTS01+438                                               01264000
CVTRV253 EQU   CVTS01+436                                               01265000
CVTRV252 EQU   CVTS01+434                                               01266000
CVTRV251 EQU   CVTS01+433                                               01267000
CVTRV250 EQU   CVTS01+432                                               01268000
CVTRV249 EQU   CVTS01+431                                               01269000
CVTRV248 EQU   CVTS01+430                                               01270000
CVTRV247 EQU   CVTS01+429                                               01271000
CVTRV246 EQU   CVTS01+428                                               01272000
CVTRV245 EQU   CVTRV237                                                 01273000
CVTRV244 EQU   CVTRV237                                                 01274000
CVTRV243 EQU   CVTRV237                                                 01275000
CVTRV242 EQU   CVTRV237                                                 01276000
CVTRV241 EQU   CVTRV237                                                 01277000
CVTRV240 EQU   CVTRV237                                                 01278000
CVTRV239 EQU   CVTRV237                                                 01279000
CVTRV238 EQU   CVTRV237                                                 01280000
CVTRV236 EQU   CVTRV228                                                 01281000
CVTRV235 EQU   CVTRV228                                                 01282000
CVTRV234 EQU   CVTRV228                                                 01283000
CVTRV233 EQU   CVTRV228                                                 01284000
CVTRV232 EQU   CVTRV228                                                 01285000
CVTRV231 EQU   CVTRV228                                                 01286000
CVTRV230 EQU   CVTRV228                                                 01287000
CVTRV229 EQU   CVTRV228                                                 01288000
CVTRV227 EQU   CVTRV219                                                 01289000
CVTRV226 EQU   CVTRV219                                                 01290000
CVTRV225 EQU   CVTRV219                                                 01291000
CVTRV224 EQU   CVTRV219                                                 01292000
CVTRV223 EQU   CVTRV219                                                 01293000
CVTRV222 EQU   CVTRV219                                                 01294000
CVTRV221 EQU   CVTRV219                                                 01295000
CVTRV220 EQU   CVTRV219                                                 01296000
CVTRV218 EQU   CVTRV210                                                 01297000
CVTRV217 EQU   CVTRV210                                                 01298000
CVTRV216 EQU   CVTRV210                                                 01299000
CVTRV215 EQU   CVTRV210                                                 01300000
CVTRV214 EQU   CVTRV210                                                 01301000
CVTRV213 EQU   CVTRV210                                                 01302000
CVTRV212 EQU   CVTRV210                                                 01303000
CVTRV211 EQU   CVTRV210                                                 01304000
CVTLCCAT EQU   CVTS01+420                                               01305000
CVTPCCAT EQU   CVTS01+416                                               01306000
CVTIPCRP EQU   CVTS01+412                                               01307000
CVTIPCRI EQU   CVTS01+408                                               01308000
CVTIPCDS EQU   CVTS01+404                                               01309000
CVTAIDVT EQU   CVTS01+400                                               01310000
CVTSSAP  EQU   CVTS01+396                                               01311000
CVTEHCIR EQU   CVTS01+392                                               01312000
CVTEHDEF EQU   CVTS01+388                                               01313000
CVTDAIR  EQU   CVTS01+384                                               01314000
CVTPERFM EQU   CVTS01+380                                               01315000
CVT044R2 EQU   CVTS01+376                                               01316000
CVTFETCH EQU   CVTS01+372                                               01317000
CVTRSTWD EQU   CVTS01+368                                               01318000
CVTSPOST EQU   CVTS01+364                                               01319000
CVTIOBP  EQU   CVTS01+360                                               01320000
CVTASMVT EQU   CVTS01+356                                               01321000
CVTRECRQ EQU   CVTS01+352                                               01322000
CVTWSAC  EQU   CVTS01+348                                               01323000
CVTRV149 EQU   CVTS01+344                                               01324000
CVTWSAL  EQU   CVTS01+340                                               01325000
CVTSPSA  EQU   CVTS01+336                                               01326000
CVTGLMN  EQU   CVTS01+332                                               01327000
CVTVEAC0 EQU   CVTS01+328                                               01328000
CVT062R1 EQU   CVTS01+324                                               01329000
CVTRPOST EQU   CVTS01+320                                               01330000
CVTDQIQE EQU   CVTS01+316                                               01331000
CVTCSD   EQU   CVTS01+312                                               01332000
CVTLKRMA EQU   CVTS01+308                                               01333000
CVTRSPIE EQU   CVTS01+304                                               01334000
CVTRENQ  EQU   CVTS01+300                                               01335000
CVTLQCB  EQU   CVTS01+296                                               01336000
CVTFQCB  EQU   CVTS01+292                                               01337000
CVTQCS01 EQU   CVTS01+288                                               01338000
CVTAPFT  EQU   CVTS01+284                                               01339000
CVTPARRL EQU   CVTS01+280                                               01340000
CVTVWAIT EQU   CVTS01+276                                               01341000
CVTGSPL  EQU   CVTS01+272                                               01342000
CVTLSMQ  EQU   CVTS01+268                                               01343000
CVTGSMQ  EQU   CVTS01+264                                               01344000
CVTEXPRO EQU   CVTS01+260                                               01345000
CVTOPCTP EQU   CVTS01+256                                               01346000
CVTSIC   EQU   CVTS01+252                                               01347000
CVTTPIOS EQU   CVTS01+248                                               01348000
CVTRTMS  EQU   CVTS01+244                                               01349000
CVTSDBF  EQU   CVTS01+240                                               01350000
CVTSCBP  EQU   CVTS01+236                                               01351000
CVTSDMP  EQU   CVTS01+232                                               01352000
CVTSV60  EQU   CVTS01+228                                               01353000
CVTRTMCT EQU   CVTS01+224                                               01354000
CVTASCBL EQU   CVTS01+220                                               01355000
CVTASCBH EQU   CVTS01+216                                               01356000
CVTGDA   EQU   CVTS01+212                                               01357000
CVTASVT  EQU   CVTS01+208                                               01358000
CVTVVMDI EQU   CVTS01+204                                               01359000
CVTAQTOP EQU   CVTS01+200                                               01360000
CVTIOSCS EQU   CVTS01+196                                               01361000
CVTSDRM  EQU   CVTS01+192                                               01362000
CVTOPTE  EQU   CVTS01+188                                               01363000
CVTSTXU  EQU   CVTS01+184                                               01364000
CVTQUIS  EQU   CVTS01+180                                               01365000
CVTPARS  EQU   CVTS01+176                                               01366000
CVTS1EE  EQU   CVTS01+172                                               01367000
CVTFRAS  EQU   CVTS01+168                                               01368000
CVTQSAS  EQU   CVTS01+164                                               01369000
CVTCRAS  EQU   CVTS01+160                                               01370000
CVTCRMN  EQU   CVTS01+156                                               01371000
CVTDELCP EQU   CVTS01+152                                               01372000
CVTFRECL EQU   CVTS01+148                                               01373000
CVTGETCL EQU   CVTS01+144                                               01374000
CVTBLDCP EQU   CVTS01+140                                               01375000
CVTAUTHL EQU   CVTS01+136                                               01376000
CVTSCAN  EQU   CVTS01+132                                               01377000
CVTRV144 EQU   CVTS01+130                                               01378000
CVTMAXMP EQU   CVTS01+128                                               01379000
CVTSTCK  EQU   CVTS01+124                                               01380000
CVTRV139 EQU   CVTS01+123                                               01381000
CVTDSSAC EQU   CVTS01+122                                               01382000
CVTRV513 EQU   CVTS01+121                                               01383000
CVTIOSPL EQU   CVTS01+120                                               01384000
CVTPTGT  EQU   CVTS01+116                                               01385000
CVTCSPIE EQU   CVTS01+112                                               01386000
CVTSMFEX EQU   CVTS01+108                                               01387000
CVTOLT0A EQU   CVTS01+104                                               01388000
CVTSRBRT EQU   CVTS01+100                                               01389000
CVTPUTL  EQU   CVTS01+96                                                01390000
CVTRV519 EQU   CVTS01+92                                                01391000
CVTRV327 EQU   CVTS01+88                                                01392000
CVTRV326 EQU   CVTS01+84                                                01393000
CVTRV325 EQU   CVTS01+80                                                01394000
CVTRV324 EQU   CVTS01+76                                                01395000
CVT0VL01 EQU   CVTS01+72                                                01396000
CVTSHRVM EQU   CVTS01+68                                                01397000
CVTRV332 EQU   CVTS01+64                                                01398000
CVTTAS   EQU   CVTS01+60                                                01399000
CVTRSCN  EQU   CVTS01+56                                                01400000
CVTTRAC2 EQU   CVTS01+54                                                01401000
CVTTRACE EQU   CVTS01+52                                                01402000
CVTAPG   EQU   CVTS01+51                                                01403000
CVTSDTRC EQU   CVTCTLFG                                                 01404000
CVTGTRCE EQU   CVTCTLFG                                                 01405000
CVTNOMP  EQU   CVTCTLFG                                                 01406000
CVTRSV79 EQU   CVTCTLFG                                                 01407000
CVTDSTAT EQU   CVTCTLFG                                                 01408000
CVTRSV78 EQU   CVTCTLFG                                                 01409000
CVTRV333 EQU   CVTCTLFG                                                 01410000
CVTRV323 EQU   CVTCTLFG                                                 01411000
CVTSPVLK EQU   CVTS01+49                                                01412000
CVTRSV77 EQU   CVTS01+48                                                01413000
CVTRV331 EQU   CVTS01+44                                                01414000
CVTRV330 EQU   CVTS01+40                                                01415000
CVTRV329 EQU   CVTS01+36                                                01416000
CVTRV328 EQU   CVTS01+32                                                01417000
CVTRV322 EQU   CVTS01+28                                                01418000
CVTSLID  EQU   CVTSLIDA+1                                               01419000
CVTSYLK  EQU   CVTSLIDA                                                 01420000
CVTRV321 EQU   CVTS01+20                                                01421000
CVTRV320 EQU   CVTS01+16                                                01422000
CVTLPDIR EQU   CVTLPDIA+1                                               01423000
CVTRSV69 EQU   CVTDIRST                                                 01424000
CVTRSV68 EQU   CVTDIRST                                                 01425000
CVTRSV67 EQU   CVTDIRST                                                 01426000
CVTRSV66 EQU   CVTDIRST                                                 01427000
CVTRSV65 EQU   CVTDIRST                                                 01428000
CVTRSV64 EQU   CVTDIRST                                                 01429000
CVTRSV63 EQU   CVTDIRST                                                 01430000
CVTDICOM EQU   CVTDIRST                                                 01431000
CVTPVTP  EQU   CVTS01+8                                                 01432000
CVTLPDSR EQU   CVTS01+4                                                 01433000
CVTGETL  EQU   CVTS01                                                   01434000
PSARSAV  EQU   PSARSVTE+60                                              01435000
PSARSTK  EQU   PSARSVTE+56                                              01436000
PSAESAV3 EQU   PSARSVTE+52                                              01437000
PSAESTK3 EQU   PSARSVTE+48                                              01438000
PSAESAV2 EQU   PSARSVTE+44                                              01439000
PSAESTK2 EQU   PSARSVTE+40                                              01440000
PSAESAV1 EQU   PSARSVTE+36                                              01441000
PSAESTK1 EQU   PSARSVTE+32                                              01442000
PSAPSAV  EQU   PSARSVTE+28                                              01443000
PSAPSTK  EQU   PSARSVTE+24                                              01444000
PSAMSAV  EQU   PSARSVTE+20                                              01445000
PSAMSTK  EQU   PSARSVTE+16                                              01446000
PSASSAV  EQU   PSARSVTE+12                                              01447000
PSASSTK  EQU   PSARSVTE+8                                               01448000
PSANSTK  EQU   PSARSVTE+4                                               01449000
PSACSTK  EQU   PSARSVTE                                                 01450000
DXRESIND EQU   @NM00032                                                 01451000
DXSAVOFF EQU   @NM00031+7                                               01452000
DXSAVADR EQU   DXSAVMOD+2                                               01453000
DXSAVID  EQU   DXSAVMOD                                                 01454000
DXABCODE EQU   @NM00031                                                 01455000
DXRETCOD EQU   DXIDENT+7                                                01456000
DXRETTTR EQU   DXRETMOD+2                                               01457000
DXRETID  EQU   DXRETMOD                                                 01458000
DXREG0   EQU   DXREGSAV+24                                              01459000
DXREGE   EQU   DXREGSAV+20                                              01460000
DXREGD   EQU   DXREGSAV+16                                              01461000
DXREGC   EQU   DXREGSAV+12                                              01462000
DXREGB   EQU   DXREGSAV+8                                               01463000
DXREGA   EQU   DXREGSAV+4                                               01464000
DXXEND   EQU   DXXAREA+48                                               01465000
DXXLAST  EQU   DXXAREA+40                                               01466000
DXXCORE  EQU   DXXENTRY+5                                               01467000
DXETTR   EQU   DXXIDTTR+2                                               01468000
DXEID    EQU   DXXIDTTR                                                 01469000
DXXPATHS EQU   DXXAREA+30                                               01470000
DXOPCLSW EQU   DXXLNG                                                   01471000
DXXTXTLN EQU   DXXAREA+27                                               01472000
DXXMODSZ EQU   DXXAREA+24                                               01473000
DXXATTRB EQU   DXXAREA+22                                               01474000
@NM00016 EQU   DXXAREA+20                                               01475000
DXXPREFX EQU   DXXAREA+16                                               01476000
@NM00015 EQU   DXXAREA+12                                               01477000
DXXMODEP EQU   DXXAREA+8                                                01478000
DXXMODID EQU   DXXMODNM+6                                               01479000
@NM00014 EQU   DXXMODNM                                                 01480000
DXXWTOPR EQU   DXXWTG                                                   01481000
DSABGRID EQU   DSABGIDL+4                                               01482000
DSABLLEN EQU   DSABGIDL                                                 01483000
DSABANAM EQU   DSABANMI+1                                               01484000
DSABANML EQU   DSABANMI                                                 01485000
DSABRS04 EQU   DSAB+68                                                  01486000
DSABSIOT EQU   DSAB+64                                                  01487000
DSABRS03 EQU   DSAB+62                                                  01488000
DSABDCBM EQU   DSAB+56                                                  01489000
DSABPTTR EQU   DSAB+44                                                  01490000
DSABTCBP EQU   DSAB+40                                                  01491000
DSABRS02 EQU   DSAB+38                                                  01492000
@NM00089 EQU   DSABFLG4                                                 01493000
DSABCKSI EQU   DSABFLG4                                                 01494000
DSABCKVL EQU   DSABFLG4                                                 01495000
DSABCKDS EQU   DSABFLG4                                                 01496000
@NM00088 EQU   DSABFLG3                                                 01497000
DSABJSCT EQU   DSABFLG3                                                 01498000
DSABCATL EQU   DSABFLG3                                                 01499000
DSABVMSC EQU   DSABFLG3                                                 01500000
DSABVAM  EQU   DSABFLG3                                                 01501000
DSABPASS EQU   DSABFLG3                                                 01502000
DSABDEFR EQU   DSABFLG3                                                 01503000
@NM00087 EQU   DSABFLG2                                                 01504000
DSABUNAL EQU   DSABFLG2                                                 01505000
DSABIRM  EQU   DSABFLG2                                                 01506000
DSABOPEN EQU   DSABFLG2                                                 01507000
DSABNUSE EQU   DSABFLG1                                                 01508000
DSABCATM EQU   DSABFLG1                                                 01509000
DSABPCAT EQU   DSABFLG1                                                 01510000
DSABDCAT EQU   DSABFLG1                                                 01511000
DSABCONV EQU   DSABFLG1                                                 01512000
DSABDCNV EQU   DSABFLG1                                                 01513000
DSABPALC EQU   DSABFLG1                                                 01514000
DSABDALC EQU   DSABFLG1                                                 01515000
@NM00086 EQU   DSABORG2                                                 01516000
DSABTR   EQU   DSABORG2                                                 01517000
DSABAM   EQU   DSABORG2                                                 01518000
@NM00085 EQU   DSABORG2                                                 01519000
DSABTQ   EQU   DSABORG2                                                 01520000
DSABTX   EQU   DSABORG2                                                 01521000
DSABGS   EQU   DSABORG2                                                 01522000
DSABU    EQU   DSABORG1                                                 01523000
DSABPO   EQU   DSABORG1                                                 01524000
DSABMQ   EQU   DSABORG1                                                 01525000
DSABCQ   EQU   DSABORG1                                                 01526000
DSABCX   EQU   DSABORG1                                                 01527000
DSABDA   EQU   DSABORG1                                                 01528000
DSABPS   EQU   DSABORG1                                                 01529000
DSABIS   EQU   DSABORG1                                                 01530000
DSABSSVA EQU   DSAB+21                                                  01531000
DSABRS01 EQU   DSAB+20                                                  01532000
DSABTIOT EQU   DSAB+16                                                  01533000
DSABOPCT EQU   DSAB+14                                                  01534000
DSABLNTH EQU   DSAB+12                                                  01535000
DSABBCHN EQU   DSAB+8                                                   01536000
DSABFCHN EQU   DSAB+4                                                   01537000
DSABID   EQU   DSAB                                                     01538000
SSDASSCM EQU   SSDA+16                                                  01539000
SSDABUFR EQU   SSDA+4                                                   01540000
@NM00084 EQU   SSDARESF                                                 01541000
SSDADEFR EQU   SSDARESF                                                 01542000
SSDAAUTO EQU   SSDARESF                                                 01543000
SSDARESV EQU   SSDA+2                                                   01544000
SSIBRSV1 EQU   SSIB+28                                                  01545000
SSIBDEST EQU   SSIB+20                                                  01546000
SSIBJBID EQU   SSIB+12                                                  01547000
SSIBRESV EQU   SSIB+7                                                   01548000
@NM00083 EQU   SSIBFLG1                                                 01549000
SSIBPJES EQU   SSIBFLG1                                                 01550000
JFCRSV05 EQU   JFCEROPT                                                 01551000
JFCRSV04 EQU   JFCEROPT                                                 01552000
JFCRSV03 EQU   JFCEROPT                                                 01553000
JFCRSV02 EQU   JFCEROPT                                                 01554000
JFCTOPT  EQU   JFCEROPT                                                 01555000
JFCABN   EQU   JFCEROPT                                                 01556000
JFCSKP   EQU   JFCEROPT                                                 01557000
JFCACC   EQU   JFCEROPT                                                 01558000
JFCBUFL  EQU   JFCAMPTR+2                                               01559000
JFCFWORD EQU   JFCBFTEK                                                 01560000
JFCDWORD EQU   JFCBFTEK                                                 01561000
JFCHIER1 EQU   JFCBFTEK                                                 01562000
JFCDYN   EQU   JFCBFTEK                                                 01563000
JFCEXC   EQU   JFCBFTEK                                                 01564000
JFCBBFTR EQU   JFCBBFTA                                                 01565000
JFCSIM   EQU   JFCBBFTA                                                 01566000
JFCHIER  EQU   JFCBFTEK                                                 01567000
JFCBFOUT EQU   JFCBUFNO                                                 01568000
JFCBUFIN EQU   JFCBUFNO                                                 01569000
JFCTEMP  EQU   JFCBIND2                                                 01570000
JFCREQ   EQU   JFCBIND2                                                 01571000
JFCENT   EQU   JFCBIND2                                                 01572000
JFCSHARE EQU   JFCBIND2                                                 01573000
JFCSECUR EQU   JFCBIND2                                                 01574000
JFCDISP  EQU   JFCBIND2                                                 01575000
JFCPDS   EQU   JFCBIND1                                                 01576000
JFCGDG   EQU   JFCBIND1                                                 01577000
JFCADDED EQU   JFCBIND1                                                 01578000
JFCLOC   EQU   JFCBIND1                                                 01579000
JFCRLSE  EQU   JFCBIND1                                                 01580000
JFCBXPDT EQU   INFMJFCB+83                                              01581000
JFCBCRDT EQU   INFMJFCB+80                                              01582000
JFCBOPS2 EQU   JFCBMASK+7                                               01583000
JFCRCTLG EQU   JFCBFLG2                                                 01584000
JFCBBUFF EQU   JFCBFLG2                                                 01585000
JFCTRACE EQU   JFCBFLG2                                                 01586000
JFCSDRPS EQU   JFCBFLG2                                                 01587000
JFCMODNW EQU   JFCBFLG2                                                 01588000
JFCNRPS  EQU   JFCDEFER                                                 01589000
JFCOUTOP EQU   JFCBFLG2                                                 01590000
JFCINOP  EQU   JFCBFLG2                                                 01591000
JFCBPWBP EQU   JFCOPEN                                                  01592000
@NM00080 EQU   JFCOPEN                                                  01593000
JFCDUAL  EQU   JFCBFLG1                                                 01594000
JFCSLDES EQU   JFCBFLG1                                                 01595000
JFCSLCRE EQU   JFCBFLG1                                                 01596000
JFCSTAND EQU   JFCBFLG1                                                 01597000
JFCBOPS1 EQU   JFCBMASK                                                 01598000
JFCBVLSQ EQU   INFMJFCB+70                                              01599000
JFCRSV31 EQU   JFCFUNC                                                  01600000
JFCFNCBT EQU   JFCFUNC                                                  01601000
JFCFNCBX EQU   JFCFUNC                                                  01602000
JFCFNCBD EQU   JFCFUNC                                                  01603000
JFCFNCBW EQU   JFCFUNC                                                  01604000
JFCFNCBP EQU   JFCFUNC                                                  01605000
JFCFNCBR EQU   JFCFUNC                                                  01606000
JFCFNCBI EQU   JFCFUNC                                                  01607000
JFCBFOFL EQU   JFCBUFOF                                                 01608000
JFCNL    EQU   JFCBLTYP                                                 01609000
JFCSL    EQU   JFCBLTYP                                                 01610000
JFCNSL   EQU   JFCBLTYP                                                 01611000
JFCSUL   EQU   JFCBLTYP                                                 01612000
JFCBLP   EQU   JFCBLTYP                                                 01613000
JFCBLTM  EQU   JFCBLTYP                                                 01614000
JFCBAL   EQU   JFCBLTYP                                                 01615000
JFCRSV38 EQU   JFCBLTYP                                                 01616000
JFCRSV01 EQU   INFMJFCB+64                                              01617000
JFCNLREC EQU   INFMJFCB+62                                              01618000
JFCBADBF EQU   INFMJFCB+60                                              01619000
JFCAMSTR EQU   JFCBFRID+2                                               01620000
JFCAMCRO EQU   JFCBFRID                                                 01621000
JFCBDSCB EQU   INFMJFCB+53                                              01622000
JFCPAT   EQU   JFCBTSDM                                                 01623000
JFCNDCB  EQU   JFCBTSDM                                                 01624000
JFCNDSCB EQU   JFCBTSDM                                                 01625000
JFCNWRIT EQU   JFCBTSDM                                                 01626000
JFCTTR   EQU   JFCBTSDM                                                 01627000
JFCSDS   EQU   JFCBTSDM                                                 01628000
JFCVSL   EQU   JFCBTSDM                                                 01629000
JFCCAT   EQU   JFCBTSDM                                                 01630000
JFCIPLTX EQU   JFCBELNM                                                 01631000
JFCBQNAM EQU   JFCBDSNM                                                 01632000
DEBXRV40 EQU   DEBXTN+28                                                01633000
DEBXRV39 EQU   DEBXTN+24                                                01634000
DEBXXARG EQU   DEBXTN+20                                                01635000
DEBXMCF2 EQU   DEBXTN+19                                                01636000
DEBXMCF1 EQU   DEBXTN+18                                                01637000
DEBXDSO2 EQU   DEBXTN+17                                                01638000
DEBXDSO1 EQU   DEBXTN+16                                                01639000
DEBXDBPR EQU   DEBXTN+12                                                01640000
DEBXDCBM EQU   DEBXTN+8                                                 01641000
DEBXDSAB EQU   DEBXTN+4                                                 01642000
DEBXRV48 EQU   DEBXTN+3                                                 01643000
DEBXRV47 EQU   DEBXFLG1                                                 01644000
DEBXRV46 EQU   DEBXFLG1                                                 01645000
DEBXRV45 EQU   DEBXFLG1                                                 01646000
DEBXRV44 EQU   DEBXFLG1                                                 01647000
DEBXRV43 EQU   DEBXFLG1                                                 01648000
DEBXRV42 EQU   DEBXFLG1                                                 01649000
DEBXTSKC EQU   DEBXFLG1                                                 01650000
DEBXCDCB EQU   DEBXFLG1                                                 01651000
DEBXLNGH EQU   DEBXTN                                                   01652000
DEBTBLOF EQU   DEBPREFX+14                                              01653000
DEBAMTYP EQU   DEBPREFX+13                                              01654000
DEBDCBMK EQU   DEBXTNP                                                  01655000
DEBDSCBA EQU   DEBPREFX+1                                               01656000
DEBWKARA EQU   DEBPREFX                                                 01657000
DEBXCEAD EQU   DEBXCEA+1                                                01658000
DEBXCENP EQU   DEBXCEAB                                                 01659000
DEBRSV35 EQU   DEBXCEAB                                                 01660000
DEBRSV34 EQU   DEBXCEAB                                                 01661000
DEBRSV33 EQU   DEBXCEAB                                                 01662000
DEBRSV32 EQU   DEBXCEAB                                                 01663000
DEBCEAD  EQU   DEBCEA+1                                                 01664000
DEBCENP  EQU   DEBCEAB                                                  01665000
DEBRSV31 EQU   DEBCEAB                                                  01666000
DEBRSV30 EQU   DEBCEAB                                                  01667000
DEBRSV29 EQU   DEBCEAB                                                  01668000
DEBRSV28 EQU   DEBCEAB                                                  01669000
DEBPCIAD EQU   DEBPCIA+1                                                01670000
DEBPCINP EQU   DEBPCIAB                                                 01671000
DEBRSV27 EQU   DEBPCIAB                                                 01672000
DEBRSV26 EQU   DEBPCIAB                                                 01673000
DEBRSV25 EQU   DEBPCIAB                                                 01674000
DEBRSV24 EQU   DEBPCIAB                                                 01675000
DEBSIOAD EQU   DEBSIOA+1                                                01676000
DEBSIONP EQU   DEBSIOAB                                                 01677000
DEBFIX   EQU   DEBSIOAB                                                 01678000
DEBIOVR  EQU   DEBSIOAB                                                 01679000
DEBSIOX  EQU   DEBSIOAB                                                 01680000
DEBPGFX  EQU   DEBSIOAB                                                 01681000
DEBEOEAD EQU   DEBEOEA+1                                                01682000
DEBEOENP EQU   DEBEOEAB                                                 01683000
DEBRSV22 EQU   DEBEOEAB                                                 01684000
DEBRSV21 EQU   DEBEOEAB                                                 01685000
DEBRSV20 EQU   DEBEOEAB                                                 01686000
DEBRSV19 EQU   DEBEOEAB                                                 01687000
DEBSUBID EQU   DEBSUBNM                                                 01688000
DEBSIOA2 EQU   DEBACS08+24                                              01689000
DEBRPSIO EQU   DEBACS08+20                                              01690000
DEBFREED EQU   DEBACS08+16                                              01691000
@NM00079 EQU   DEBACS08+12                                              01692000
@NM00078 EQU   DEBACS08+8                                               01693000
DEBDISAD EQU   DEBACS08+4                                               01694000
@NM00077 EQU   DEBACS08                                                 01695000
DEBRPSST EQU   DEBACS07+64                                              01696000
DEBARECK EQU   DEBACS07+60                                              01697000
DEBAREWT EQU   DEBACS07+56                                              01698000
DEBACHK  EQU   DEBACS07+52                                              01699000
DEBAWRIT EQU   DEBACS07+48                                              01700000
DEBASETL EQU   DEBACS07+44                                              01701000
DEBAREAD EQU   DEBACS07+40                                              01702000
DEBCRECK EQU   DEBACS07+36                                              01703000
DEBCREWT EQU   DEBACS07+32                                              01704000
DEBCCHK  EQU   DEBACS07+28                                              01705000
DEBCWRIT EQU   DEBACS07+24                                              01706000
DEBCSETL EQU   DEBACS07+20                                              01707000
DEBCREAD EQU   DEBACS07+16                                              01708000
DEBWKPT5 EQU   DEBACS07+12                                              01709000
DEBWKPT4 EQU   DEBACS07+8                                               01710000
DEBGET   EQU   DEBACS07+4                                               01711000
@NM00076 EQU   DEBACS07                                                 01712000
DEBPUT   EQU   DEBACS06+4                                               01713000
DEBDCBFA EQU   DEBACS06                                                 01714000
DEBLUCBB EQU   DEBLUCBA+1                                               01715000
DEBRSV18 EQU   DEBLUCBA                                                 01716000
DEBFUCBB EQU   DEBFUCBA+1                                               01717000
DEBRSV17 EQU   DEBFUCBA                                                 01718000
DEBTCCWB EQU   DEBTCCWA+1                                               01719000
DEBRSV16 EQU   DEBTCCWA                                                 01720000
DEBTBFRB EQU   DEBTBFRA+1                                               01721000
DEBRSV15 EQU   DEBTBFRA                                                 01722000
DEBDBPEF EQU   DEBACS03+8                                               01723000
DEBDBPP  EQU   DEBACS03+4                                               01724000
DEBDTPP  EQU   DEBACS03                                                 01725000
DEBDBPE  EQU   DEBDBLK+1                                                01726000
DEBDBPT  EQU   DEBDBLK                                                  01727000
DEBEXTNM EQU   DEBDSNAM                                                 01728000
DEBRSV14 EQU   DEBDSNM+4                                                01729000
DEBUTSAB EQU   DEBUTSAA+1                                               01730000
DEBRSV13 EQU   DEBUTSAA                                                 01731000
DEBVOLNM EQU   DEBACSMD+2                                               01732000
DEBVLSEQ EQU   DEBVOLSQ+1                                               01733000
DEBRSV42 EQU   DEBVOLBT                                                 01734000
DEBRSV41 EQU   DEBVOLBT                                                 01735000
DEBRSV40 EQU   DEBVOLBT                                                 01736000
DEBRSV39 EQU   DEBVOLBT                                                 01737000
DEBRSV38 EQU   DEBVOLBT                                                 01738000
DEBRSV37 EQU   DEBVOLBT                                                 01739000
DEBRSV36 EQU   DEBVOLBT                                                 01740000
DEBEXFUL EQU   DEBVOLBT                                                 01741000
DEBNMTRK EQU   DEBDASD+14                                               01742000
DEBENDHH EQU   DEBDASD+12                                               01743000
DEBENDCC EQU   DEBDASD+10                                               01744000
DEBSTRHH EQU   DEBDASD+8                                                01745000
DEBSTRCC EQU   DEBDASD+6                                                01746000
DEBUCBA  EQU   DEBUCBAD+1                                               01747000
DEBDVMOD EQU   DEBUCBAD                                                 01748000
DEBAPPB  EQU   DEBAPPAD+1                                               01749000
DEBDCBB  EQU   DEBDCBAD+1                                               01750000
DEBECBB  EQU   DEBECBAD+1                                               01751000
DEBPRIOR EQU   DEBECBAD                                                 01752000
DEBUSRPB EQU   DEBUSRPG+1                                               01753000
DEBRSV05 EQU   DEBBASIC+15                                              01754000
DEBXTNIN EQU   DEBFLGS1                                                 01755000
DEBAPFIN EQU   DEBFLGS1                                                 01756000
DEBF1CEV EQU   DEBFLGS1                                                 01757000
DEBCINDI EQU   DEBFLGS1                                                 01758000
DEBRSV02 EQU   DEBFLGS1                                                 01759000
DEBRSV01 EQU   DEBFLGS1                                                 01760000
DEBEOFDF EQU   DEBFLGS1                                                 01761000
DEBPWCKD EQU   DEBFLGS1                                                 01762000
DEBQSCNT EQU   DEBBASIC+13                                              01763000
DEBACCS  EQU   DEBOPATB                                                 01764000
DEBPOSIT EQU   DEBOPATB                                                 01765000
DEBZERO  EQU   DEBOPATB                                                 01766000
DEBABEND EQU   DEBOPATB                                                 01767000
DEBIRBB  EQU   DEBIRBAD+1                                               01768000
DEBRERR  EQU   DEBOFLGS                                                 01769000
DEBLABEL EQU   DEBOFLGS                                                 01770000
DEBSPLIT EQU   DEBOFLGS                                                 01771000
DEBDCB   EQU   DEBOFLGS                                                 01772000
DEBRLSE  EQU   DEBOFLGS                                                 01773000
DEBEOF   EQU   DEBOFLGS                                                 01774000
DEBDISP  EQU   DEBOFLGS                                                 01775000
DEBDEBB  EQU   DEBDEBAD+1                                               01776000
DEBTCBB  EQU   DEBTCBAD+1                                               01777000
DEBNMSUB EQU   DEBTCBAD                                                 01778000
TIOCSTEP EQU   TIOT1+8                                                  01779000
TIOCNJOB EQU   TIOT1                                                    01780000
@NM00073 EQU   TCBXTNT2+32                                              01781000
TCBRV181 EQU   TCBRV173                                                 01782000
TCBRV180 EQU   TCBRV173                                                 01783000
TCBRV179 EQU   TCBRV173                                                 01784000
TCBRV178 EQU   TCBRV173                                                 01785000
TCBRV177 EQU   TCBRV173                                                 01786000
TCBRV176 EQU   TCBRV173                                                 01787000
TCBRV175 EQU   TCBRV173                                                 01788000
TCBRV174 EQU   TCBRV173                                                 01789000
TCBRV172 EQU   TCBRV164                                                 01790000
TCBRV171 EQU   TCBRV164                                                 01791000
TCBRV170 EQU   TCBRV164                                                 01792000
TCBRV169 EQU   TCBRV164                                                 01793000
TCBRV168 EQU   TCBRV164                                                 01794000
TCBRV167 EQU   TCBRV164                                                 01795000
TCBRV166 EQU   TCBRV164                                                 01796000
TCBRV165 EQU   TCBRV164                                                 01797000
TCBRV163 EQU   TCBRV155                                                 01798000
TCBRV162 EQU   TCBRV155                                                 01799000
TCBRV161 EQU   TCBRV155                                                 01800000
TCBRV160 EQU   TCBRV155                                                 01801000
TCBRV159 EQU   TCBRV155                                                 01802000
TCBRV158 EQU   TCBRV155                                                 01803000
TCBRV157 EQU   TCBRV155                                                 01804000
TCBRV156 EQU   TCBRV155                                                 01805000
TCBRV154 EQU   TCBRV146                                                 01806000
TCBRV153 EQU   TCBRV146                                                 01807000
TCBRV152 EQU   TCBRV146                                                 01808000
TCBRV151 EQU   TCBRV146                                                 01809000
TCBRV150 EQU   TCBRV146                                                 01810000
TCBRV149 EQU   TCBRV146                                                 01811000
TCBRV148 EQU   TCBRV146                                                 01812000
TCBRV147 EQU   TCBRV146                                                 01813000
TCBRV145 EQU   TCBXTNT2+26                                              01814000
TCBRV144 EQU   TCBXTNT2+24                                              01815000
TCBRV143 EQU   TCBXTNT2+20                                              01816000
TCBRV142 EQU   TCBXTNT2+16                                              01817000
TCBRSV49 EQU   TCBXTNT2+12                                              01818000
TCBRSV48 EQU   TCBXTNT2+8                                               01819000
TCBRCMP  EQU   TCBXTNT2+5                                               01820000
TCBRSVAB EQU   TCBXTNT2+4                                               01821000
TCBGTFA  EQU   TCBGTF+1                                                 01822000
TCBRSV47 EQU   TCBTFLG                                                  01823000
TCBRSV46 EQU   TCBTFLG                                                  01824000
TCBRSV45 EQU   TCBTFLG                                                  01825000
TCBRSV44 EQU   TCBTFLG                                                  01826000
TCBRSV43 EQU   TCBTFLG                                                  01827000
TCBDSPIT EQU   TCBTFLG                                                  01828000
TCBERRTN EQU   TCBTFLG                                                  01829000
TCBASYNC EQU   TCBTFLG                                                  01830000
@NM00072 EQU   TCB+296                                                  01831000
TCBSCBQ  EQU   TCB+292                                                  01832000
TCBSWASA EQU   TCB+288                                                  01833000
TCBDBTB  EQU   TCB+284                                                  01834000
TCBRPT   EQU   TCB+280                                                  01835000
TCBRV141 EQU   TCBRV133                                                 01836000
TCBRV140 EQU   TCBRV133                                                 01837000
TCBRV139 EQU   TCBRV133                                                 01838000
TCBRV138 EQU   TCBRV133                                                 01839000
TCBRV137 EQU   TCBRV133                                                 01840000
TCBRV136 EQU   TCBRV133                                                 01841000
TCBRV135 EQU   TCBRV133                                                 01842000
TCBRV134 EQU   TCBRV133                                                 01843000
TCBRV132 EQU   TCBRV124                                                 01844000
TCBRV131 EQU   TCBRV124                                                 01845000
TCBRV130 EQU   TCBRV124                                                 01846000
TCBRV129 EQU   TCBRV124                                                 01847000
TCBRV128 EQU   TCBRV124                                                 01848000
TCBRV127 EQU   TCBRV124                                                 01849000
TCBRV126 EQU   TCBRV124                                                 01850000
TCBRV125 EQU   TCBRV124                                                 01851000
TCBRV123 EQU   TCBFBYT2                                                 01852000
TCBRV122 EQU   TCBFBYT2                                                 01853000
TCBECBNV EQU   TCBFBYT2                                                 01854000
TCBSSSYN EQU   TCBFBYT2                                                 01855000
TCBFPRAP EQU   TCBFBYT2                                                 01856000
TCBFDW   EQU   TCBFBYT2                                                 01857000
TCBFMW   EQU   TCBFBYT2                                                 01858000
TCBCNCB  EQU   TCBFBYT2                                                 01859000
TCBLLH   EQU   TCBFBYT1                                                 01860000
TCBRV113 EQU   TCBFBYT1                                                 01861000
TCBEOT   EQU   TCBFBYT1                                                 01862000
TCBRTM2  EQU   TCBFBYT1                                                 01863000
TCBPGNLY EQU   TCBFBYT1                                                 01864000
TCBNDIOS EQU   TCBFBYT1                                                 01865000
TCBACTIV EQU   TCBFBYT1                                                 01866000
TCBEOTFM EQU   TCBFBYT1                                                 01867000
TCBAFFN  EQU   TCB+274                                                  01868000
TCBCCPVI EQU   TCB+272                                                  01869000
TCBUKYSP EQU   TCB+268                                                  01870000
TCBMODE  EQU   TCBESTAE+3                                               01871000
TCBERTYP EQU   TCBESTAE+2                                               01872000
TCBRV314 EQU   TCBESTRM                                                 01873000
TCBRV313 EQU   TCBESTRM                                                 01874000
TCBRV312 EQU   TCBESTRM                                                 01875000
TCBRV311 EQU   TCBESTRM                                                 01876000
TCBRV310 EQU   TCBESTRM                                                 01877000
TCBRV309 EQU   TCBESTRM                                                 01878000
TCBRV308 EQU   TCBESTRM                                                 01879000
TCBETERM EQU   TCBESTRM                                                 01880000
TCBSCBKY EQU   TCBESTAE                                                 01881000
TCBRTM12 EQU   TCB+260                                                  01882000
TCBTCBID EQU   TCB+256                                                  01883000
TCBRSV96 EQU   TCB+252                                                  01884000
TCBSWA   EQU   TCB+248                                                  01885000
TCBFOEA  EQU   TCBFOE+1                                                 01886000
TCBRSV42 EQU   TCBFOE                                                   01887000
TCBRV306 EQU   TCB+240                                                  01888000
TCBRSV41 EQU   TCB+239                                                  01889000
TCBTID   EQU   TCB+238                                                  01890000
TCBRSVAA EQU   TCB+237                                                  01891000
TCBABCUR EQU   TCB+236                                                  01892000
TCBTMSAV EQU   TCB+232                                                  01893000
TCBIOTIM EQU   TCB+228                                                  01894000
TCBRTWA  EQU   TCB+224                                                  01895000
TCBBACK  EQU   TCB+220                                                  01896000
TCBTIRB  EQU   TCB+216                                                  01897000
TCBAECB  EQU   TCB+212                                                  01898000
TCBEXT2A EQU   TCBEXT2+1                                                01899000
TCBRSV39 EQU   TCBEXT2                                                  01900000
TCBSTMCT EQU   TCB+207                                                  01901000
TCBSYSCT EQU   TCB+206                                                  01902000
TCBRSV37 EQU   TCB+205                                                  01903000
TCBEXSVC EQU   TCBDAR                                                   01904000
TCBRSV36 EQU   TCBDAR                                                   01905000
TCBDARWT EQU   TCBDAR                                                   01906000
TCBDARO  EQU   TCBDAR                                                   01907000
TCBDARMC EQU   TCBDARC                                                  01908000
TCBDARD  EQU   TCBDAR                                                   01909000
TCBDARS  EQU   TCBDAR                                                   01910000
TCBDARP  EQU   TCBDAR                                                   01911000
TCBGTOFM EQU   TCBFLGS7                                                 01912000
TCBADMP  EQU   TCBFLGS7                                                 01913000
TCBRSTSK EQU   TCBFLGS7                                                 01914000
TCBRSV35 EQU   TCBFLGS7                                                 01915000
TCBSTACK EQU   TCBFLGS7                                                 01916000
TCBRSV34 EQU   TCBFLGS7                                                 01917000
TCBRSV33 EQU   TCBFLGS7                                                 01918000
TCBGPECB EQU   TCBFLGS7                                                 01919000
TCBNTJS  EQU   TCBFLGS6                                                 01920000
TCBAPG   EQU   TCBFLGS6                                                 01921000
TCBMIGR  EQU   TCBFLGS6                                                 01922000
TCBRV303 EQU   TCBFLGS6                                                 01923000
TCBSPVLK EQU   TCBFLGS6                                                 01924000
TCBCPU   EQU   TCBFLGS6                                                 01925000
TCBPIE17 EQU   TCBFLGS6                                                 01926000
TCBRV    EQU   TCBFLGS6                                                 01927000
TCBRSV79 EQU   TCBNDSP5                                                 01928000
TCBRSV78 EQU   TCBNDSP5                                                 01929000
TCBRSV77 EQU   TCBNDSP5                                                 01930000
TCBRSV76 EQU   TCBNDSP5                                                 01931000
TCBRSV75 EQU   TCBNDSP5                                                 01932000
TCBRSV74 EQU   TCBNDSP5                                                 01933000
TCBRSV95 EQU   TCBNDSP5                                                 01934000
TCBRSV94 EQU   TCBNDSP5                                                 01935000
TCBRSV93 EQU   TCBNDSP4                                                 01936000
TCBRSV92 EQU   TCBNDSP4                                                 01937000
TCBRSV91 EQU   TCBNDSP4                                                 01938000
TCBRSV90 EQU   TCBNDSP4                                                 01939000
TCBRSV89 EQU   TCBNDSP4                                                 01940000
TCBRSV88 EQU   TCBNDSP4                                                 01941000
TCBRSV87 EQU   TCBNDSP4                                                 01942000
TCBRSV86 EQU   TCBNDSP4                                                 01943000
TCBEXT1A EQU   TCBEXT1+1                                                01944000
TCBRSV32 EQU   TCBEXT1                                                  01945000
TCBEXCPD EQU   TCB+192                                                  01946000
TCBIOBRC EQU   TCB+188                                                  01947000
TCBDDWTC EQU   TCB+186                                                  01948000
TCBDDEXC EQU   TCB+184                                                  01949000
TCBJSCBB EQU   TCBJSCB+1                                                01950000
@NM00071 EQU   TCBRECDE                                                 01951000
TCBREC   EQU   TCBRECDE                                                 01952000
TCBMDIDS EQU   TCB+176                                                  01953000
TCBNDINT EQU   TCBNDSP3                                                 01954000
TCBRSV27 EQU   TCBNDSP3                                                 01955000
TCBRSV26 EQU   TCBNDSP3                                                 01956000
TCBRSV25 EQU   TCBNDSP3                                                 01957000
TCBRSV24 EQU   TCBNDSP3                                                 01958000
TCBSRBND EQU   TCBNDSP3                                                 01959000
TCBRV302 EQU   TCBNDSP3                                                 01960000
TCBLJSND EQU   TCBNDSP3                                                 01961000
TCBABE   EQU   TCBNDSP2                                                 01962000
TCBDSS   EQU   TCBNDSP2                                                 01963000
TCBOWAIT EQU   TCBNDSP2                                                 01964000
TCBIWAIT EQU   TCBNDSP2                                                 01965000
TCBNDTS  EQU   TCBNDSP2                                                 01966000
TCBNDSVC EQU   TCBNDSP2                                                 01967000
TCBSTPP  EQU   TCBNDSP2                                                 01968000
TCBABD   EQU   TCBNDSP2                                                 01969000
TCBRSV22 EQU   TCBNDSP1                                                 01970000
TCBPIEND EQU   TCBNDSP1                                                 01971000
TCBTPSP  EQU   TCBNDSP1                                                 01972000
TCBDDRND EQU   TCBNDSP1                                                 01973000
TCBRSPND EQU   TCBNDSP1                                                 01974000
TCBRSTND EQU   TCBNDSP1                                                 01975000
TCBDARPN EQU   TCBNDSP1                                                 01976000
TCBDARTN EQU   TCBNDSP1                                                 01977000
TCBNDSP0 EQU   TCBNDSP                                                  01978000
TCBUSER  EQU   TCB+168                                                  01979000
TCBTCTB  EQU   TCBTCT+1                                                 01980000
TCBRSV9C EQU   TCBTCTGF                                                 01981000
TCBRSV9B EQU   TCBTCTGF                                                 01982000
TCBRSV9A EQU   TCBTCTGF                                                 01983000
TCBRSV99 EQU   TCBTCTGF                                                 01984000
TCBRSV98 EQU   TCBTCTGF                                                 01985000
TCBRSV97 EQU   TCBTCTGF                                                 01986000
TCBRSV20 EQU   TCBTCTGF                                                 01987000
TCBSMFGF EQU   TCBTCTGF                                                 01988000
TCBSTABB EQU   TCBSTAB+1                                                01989000
TCBSTCUR EQU   TCBNSTAE                                                 01990000
TCBRV301 EQU   TCBNSTAE                                                 01991000
TCBSYNCH EQU   TCBNSTAE                                                 01992000
TCBHALT  EQU   TCBNSTAE                                                 01993000
TCBPPSUP EQU   TCBNSTAE                                                 01994000
TCB33E   EQU   TCBNSTAE                                                 01995000
TCBQUIES EQU   TCBNSTAE                                                 01996000
TCBSTABE EQU   TCBNSTAE                                                 01997000
TCBAQE   EQU   TCB+156                                                  01998000
TCBPQE   EQU   TCB+152                                                  01999000
TCBTSDP  EQU   TCB+151                                                  02000000
TCBTSLP  EQU   TCB+150                                                  02001000
TCBSTPCT EQU   TCB+149                                                  02002000
TCBCPUBN EQU   TCBTSFLG                                                 02003000
TCBDYDSP EQU   TCBTSFLG                                                 02004000
TCBRSV18 EQU   TCBTSFLG                                                 02005000
TCBRSV17 EQU   TCBTSFLG                                                 02006000
TCBTIOTG EQU   TCBTSFLG                                                 02007000
TCBATT   EQU   TCBTSFLG                                                 02008000
TCBSTPPR EQU   TCBTSFLG                                                 02009000
TCBRV300 EQU   TCBTSTSK                                                 02010000
TCBECB   EQU   TCB+144                                                  02011000
TCBIQE   EQU   TCB+140                                                  02012000
TCBLTC   EQU   TCB+136                                                  02013000
TCBOTC   EQU   TCB+132                                                  02014000
TCBNTC   EQU   TCB+128                                                  02015000
TCBJSTCA EQU   TCBJSTCB+1                                               02016000
TCBRSV16 EQU   TCBJSTCB                                                 02017000
TCBTQET  EQU   TCBTME                                                   02018000
TCBTCB   EQU   TCB+116                                                  02019000
TCBFSAB  EQU   TCBFSA+1                                                 02020000
TCBQEL   EQU   TCBFSA                                                   02021000
TCBGRS15 EQU   TCBGRS+60                                                02022000
TCBGRS14 EQU   TCBGRS+56                                                02023000
TCBGRS13 EQU   TCBGRS+52                                                02024000
TCBGRS12 EQU   TCBGRS+48                                                02025000
TCBGRS11 EQU   TCBGRS+44                                                02026000
TCBGRS10 EQU   TCBGRS+40                                                02027000
TCBGRS9  EQU   TCBGRS+36                                                02028000
TCBGRS8  EQU   TCBGRS+32                                                02029000
TCBGRS7  EQU   TCBGRS+28                                                02030000
TCBGRS6  EQU   TCBGRS+24                                                02031000
TCBGRS5  EQU   TCBGRS+20                                                02032000
TCBGRS4  EQU   TCBGRS+16                                                02033000
TCBGRS3  EQU   TCBGRS+12                                                02034000
TCBGRS2  EQU   TCBGRS+8                                                 02035000
TCBGRS1  EQU   TCBGRS+4                                                 02036000
TCBGRS0  EQU   TCBGRS                                                   02037000
TCBJPQB  EQU   TCBJPQ+1                                                 02038000
TCBRSV15 EQU   TCBPURGE                                                 02039000
TCBRSV14 EQU   TCBPURGE                                                 02040000
TCBRSV13 EQU   TCBPURGE                                                 02041000
TCBRSV12 EQU   TCBPURGE                                                 02042000
TCBRSV11 EQU   TCBPURGE                                                 02043000
TCBRSV10 EQU   TCBPURGE                                                 02044000
TCBRSV09 EQU   TCBPURGE                                                 02045000
TCBJPQF  EQU   TCBPURGE                                                 02046000
TCBJLB   EQU   TCB+40                                                   02047000
TCBLLS   EQU   TCB+36                                                   02048000
TCBDSP   EQU   TCB+35                                                   02049000
TCBLMP   EQU   TCB+34                                                   02050000
TCBPNDSP EQU   TCBFLGS5                                                 02051000
TCBFCD1  EQU   TCBFLGS5                                                 02052000
TCBSTP   EQU   TCBFLGS5                                                 02053000
TCBSYS   EQU   TCBFLGS5                                                 02054000
TCBANDSP EQU   TCBFLGS5                                                 02055000
TCBPAGE  EQU   TCBFLGS5                                                 02056000
TCBUXNDF EQU   TCBABWF                                                  02057000
TCBFC    EQU   TCBFLGS5                                                 02058000
TCBONDSP EQU   TCBFLGS4                                                 02059000
TCBMPCND EQU   TCBFLGS4                                                 02060000
TCBMPCVQ EQU   TCBFLGS4                                                 02061000
TCBUXNDV EQU   TCBFLGS4                                                 02062000
TCBHNDSP EQU   TCBFLGS4                                                 02063000
TCBRQENA EQU   TCBFLGS4                                                 02064000
TCBSER   EQU   TCBFLGS4                                                 02065000
TCBNDUMP EQU   TCBFLGS4                                                 02066000
TCBDWSTA EQU   TCBFLGS3                                                 02067000
TCBRSV08 EQU   TCBFLGS3                                                 02068000
TCBRSV07 EQU   TCBFLGS3                                                 02069000
TCBRSV06 EQU   TCBFLGS3                                                 02070000
TCBABGM  EQU   TCBFLGS3                                                 02071000
TCBABTRM EQU   TCBFLGS3                                                 02072000
TCBADINP EQU   TCBFLGS3                                                 02073000
TCBFSM   EQU   TCBFLGS3                                                 02074000
TCBFTS   EQU   TCBFLGS2                                                 02075000
TCBFETXR EQU   TCBFLGS2                                                 02076000
TCBFDSOP EQU   TCBFLGS2                                                 02077000
TCBFJMC  EQU   TCBFLGS2                                                 02078000
TCBFSMC  EQU   TCBFLGS2                                                 02079000
TCBFABOP EQU   TCBFLGS2                                                 02080000
TCBFSTI  EQU   TCBFLGS2                                                 02081000
TCBFOINP EQU   TCBFLGS2                                                 02082000
TCBFX    EQU   TCBFLGS1                                                 02083000
TCBFS    EQU   TCBFLGS1                                                 02084000
TCBFT    EQU   TCBFLGS1                                                 02085000
TCBPDUMP EQU   TCBFLGS1                                                 02086000
TCBRSV04 EQU   TCBFLGS1                                                 02087000
TCBFERA  EQU   TCBFLGS1                                                 02088000
TCBFE    EQU   TCBFLGS1                                                 02089000
TCBFA    EQU   TCBFLGS1                                                 02090000
TCBZERO  EQU   TCBPKF                                                   02091000
TCBFLAG  EQU   TCBPKF                                                   02092000
TCBMSSB  EQU   TCBMSS+1                                                 02093000
TCBRSV03 EQU   TCBMSS                                                   02094000
TCBTRNB  EQU   TCBTRN+1                                                 02095000
TCBRSV02 EQU   TCBABF                                                   02096000
TCBOLTEP EQU   TCBABF                                                   02097000
TCBTCP   EQU   TCBABF                                                   02098000
TCBTCPP  EQU   TCBABF                                                   02099000
TCBRSV01 EQU   TCBABF                                                   02100000
TCBGRPH  EQU   TCBABF                                                   02101000
TCBNOCHK EQU   TCBABF                                                   02102000
TCBMOD91 EQU   TCBABF                                                   02103000
TCBCMPC  EQU   TCBCMP+1                                                 02104000
TCBRV318 EQU   TCBCMSG                                                  02105000
TCBRV317 EQU   TCBCIND                                                  02106000
TCBRV316 EQU   TCBCWTO                                                  02107000
TCBCASID EQU   TCBCDBL                                                  02108000
TCBNOCC  EQU   TCBSTCC                                                  02109000
TCBDMPO  EQU   TCBCPP                                                   02110000
TCBCSTEP EQU   TCBCMPF                                                  02111000
TCBCREQ  EQU   TCBCMPF                                                  02112000
TCBPIEA  EQU   TCBPIE+1                                                 02113000
TCBPM    EQU   TCBPMASK                                                 02114000
@NM00070 EQU   TCBPMASK                                                 02115000
TCBRBP   EQU   TCB                                                      02116000
TCBFRS6  EQU   TCBFRS+24                                                02117000
TCBFRS4  EQU   TCBFRS+16                                                02118000
TCBFRS2  EQU   TCBFRS+8                                                 02119000
TCBFRS0  EQU   TCBFRS                                                   02120000
JESPJESN EQU   JESCT+28                                                 02121000
JESSSCT  EQU   JESCT+24                                                 02122000
JESRESQM EQU   JESCT+16                                                 02123000
JESQMGR  EQU   JESCT+12                                                 02124000
@NM00069 EQU   JESCT                                                    02125000
ACBAPID  EQU   ACBCOMN+72                                               02126000
ACBCBMWA EQU   ACBCOMN+68                                               02127000
ACBUAPTR EQU   ACBCOMN+64                                               02128000
ACBLRECL EQU   ACBCOMN+62                                               02129000
ACBBLKSZ EQU   ACBCOMN+60                                               02130000
ACBBUFSP EQU   ACBCOMN+56                                               02131000
@NM00068 EQU   ACBWAPTR+1                                               02132000
ACBOPTN  EQU   ACBWAPTR                                                 02133000
ACBCAT   EQU   ACBINFLG                                                 02134000
ACBIJRQE EQU   ACBINFLG                                                 02135000
ACBJEPS  EQU   ACBINFLG                                                 02136000
@NM00067 EQU   ACBINFLG                                                 02137000
ACBERFLG EQU   ACBCOMN+49                                               02138000
ACBBUSY  EQU   ACBIOSFG                                                 02139000
ACBLOCK  EQU   ACBEXFG                                                  02140000
@NM00066 EQU   ACBOFLGS                                                 02141000
ACBDSERR EQU   ACBOFLGS                                                 02142000
ACBOPEN  EQU   ACBOFLGS                                                 02143000
ACBEOV   EQU   ACBOFLGS                                                 02144000
@NM00065 EQU   ACBOFLGS                                                 02145000
ACBERFL  EQU   ACBDDNM+4                                                02146000
ACBAM    EQU   ACBAMETH                                                 02147000
ACBINFL  EQU   ACBDDNM+2                                                02148000
ACBTIOT  EQU   ACBDDNM                                                  02149000
ACBUEL   EQU   ACBEXLST                                                 02150000
ACBPASSW EQU   ACBCOMN+32                                               02151000
@NM00064 EQU   ACBCOMN+28                                               02152000
@NM00063 EQU   ACBDSORG+1                                               02153000
ACBDORGA EQU   ACBDSORG+1                                               02154000
@NM00062 EQU   ACBDSORG                                                 02155000
ACBCRNRE EQU   ACBCROPS                                                 02156000
ACBCRNCK EQU   ACBCROPS                                                 02157000
ACBASA   EQU   ACBCCTYP                                                 02158000
@NM00061 EQU   ACBCCTYP                                                 02159000
ACBRECAF EQU   ACBRECFM                                                 02160000
ACBJBUF  EQU   ACBBUFPL+2                                               02161000
@NM00060 EQU   ACBBUFPL                                                 02162000
ACBBUFNI EQU   ACBCOMN+18                                               02163000
ACBBUFND EQU   ACBCOMN+16                                               02164000
ACBSTRNO EQU   ACBCOMN+14                                               02165000
@NM00059 EQU   ACBMACR2                                                 02166000
ACBLOGON EQU   ACBMACR2                                                 02167000
ACBSKP   EQU   ACBMACR2                                                 02168000
ACBCHN   EQU   ACBMACR2                                                 02169000
ACBCBRD  EQU   ACBMACR2                                                 02170000
ACBCBOPN EQU   ACBMACR2                                                 02171000
ACBUBF   EQU   ACBMACR1                                                 02172000
ACBOUT   EQU   ACBMACR1                                                 02173000
ACBIN    EQU   ACBMACR1                                                 02174000
ACBDIR   EQU   ACBMACR1                                                 02175000
ACBSEQ   EQU   ACBMACR1                                                 02176000
ACBBLK   EQU   ACBCNV                                                   02177000
ACBADD   EQU   ACBADR                                                   02178000
ACBKEY   EQU   ACBMACR1                                                 02179000
ACBINRTN EQU   ACBCOMN+8                                                02180000
ACBIBCT  EQU   ACBJWA                                                   02181000
ACBLEN2  EQU   ACBLENG2                                                 02182000
ACBSTYP  EQU   ACBCOMN+1                                                02183000
ACBID    EQU   ACBCOMN                                                  02184000
CVTLEVL  EQU   CVTRELNO+2                                               02185000
CVTNUMB  EQU   CVTRELNO                                                 02186000
CVTMDL   EQU   CVTFIX+250                                               02187000
@NM00058 EQU   CVTFIX+248                                               02188000
@NM00057 EQU   CVTFIX                                                   02189000
CVTRV482 EQU   CVTXTNT2+128                                             02190000
CVTRV481 EQU   CVTXTNT2+124                                             02191000
CVTRV480 EQU   CVTXTNT2+120                                             02192000
CVTRV479 EQU   CVTXTNT2+118                                             02193000
CVTRV478 EQU   CVTXTNT2+117                                             02194000
CVTRV477 EQU   CVTXTNT2+116                                             02195000
CVTRV476 EQU   CVTXTNT2+115                                             02196000
CVTRV475 EQU   CVTXTNT2+114                                             02197000
CVTRV474 EQU   CVTRV466                                                 02198000
CVTRV473 EQU   CVTRV466                                                 02199000
CVTRV472 EQU   CVTRV466                                                 02200000
CVTRV471 EQU   CVTRV466                                                 02201000
CVTRV470 EQU   CVTRV466                                                 02202000
CVTRV469 EQU   CVTRV466                                                 02203000
CVTRV468 EQU   CVTRV466                                                 02204000
CVTRV467 EQU   CVTRV466                                                 02205000
CVTRV465 EQU   CVTRV457                                                 02206000
CVTRV464 EQU   CVTRV457                                                 02207000
CVTRV463 EQU   CVTRV457                                                 02208000
CVTRV462 EQU   CVTRV457                                                 02209000
CVTRV461 EQU   CVTRV457                                                 02210000
CVTRV460 EQU   CVTRV457                                                 02211000
CVTRV459 EQU   CVTRV457                                                 02212000
CVTRV458 EQU   CVTRV457                                                 02213000
CVTRV456 EQU   CVTXTNT2+108                                             02214000
CVTRV455 EQU   CVTXTNT2+104                                             02215000
CVTRV454 EQU   CVTXTNT2+100                                             02216000
CVTRV453 EQU   CVTXTNT2+96                                              02217000
CVTRV452 EQU   CVTXTNT2+94                                              02218000
CVTRV451 EQU   CVTXTNT2+92                                              02219000
CVTRV450 EQU   CVTXTNT2+90                                              02220000
CVTRV449 EQU   CVTXTNT2+88                                              02221000
CVTRV448 EQU   CVTXTNT2+87                                              02222000
CVTRV447 EQU   CVTXTNT2+86                                              02223000
CVTRV446 EQU   CVTRV438                                                 02224000
CVTRV445 EQU   CVTRV438                                                 02225000
CVTRV444 EQU   CVTRV438                                                 02226000
CVTRV443 EQU   CVTRV438                                                 02227000
CVTRV442 EQU   CVTRV438                                                 02228000
CVTRV441 EQU   CVTRV438                                                 02229000
CVTRV440 EQU   CVTRV438                                                 02230000
CVTRV439 EQU   CVTRV438                                                 02231000
CVTRV437 EQU   CVTRV429                                                 02232000
CVTRV436 EQU   CVTRV429                                                 02233000
CVTRV435 EQU   CVTRV429                                                 02234000
CVTRV434 EQU   CVTRV429                                                 02235000
CVTRV433 EQU   CVTRV429                                                 02236000
CVTRV432 EQU   CVTRV429                                                 02237000
CVTRV431 EQU   CVTRV429                                                 02238000
CVTRV430 EQU   CVTRV429                                                 02239000
CVTRV428 EQU   CVTXTNT2+80                                              02240000
CVTRV427 EQU   CVTXTNT2+76                                              02241000
CVTRV426 EQU   CVTXTNT2+72                                              02242000
CVTRV425 EQU   CVTXTNT2+68                                              02243000
CVTATACT EQU   CVTATCVT                                                 02244000
CVTRV423 EQU   CVTXTNT2+62                                              02245000
CVTRV422 EQU   CVTXTNT2+60                                              02246000
CVTRV421 EQU   CVTXTNT2+58                                              02247000
CVTRV420 EQU   CVTXTNT2+56                                              02248000
CVTRV419 EQU   CVTXTNT2+55                                              02249000
CVTRV418 EQU   CVTXTNT2+54                                              02250000
CVTRV417 EQU   CVTRV409                                                 02251000
CVTRV416 EQU   CVTRV409                                                 02252000
CVTRV415 EQU   CVTRV409                                                 02253000
CVTRV414 EQU   CVTRV409                                                 02254000
CVTRV413 EQU   CVTRV409                                                 02255000
CVTRV412 EQU   CVTRV409                                                 02256000
CVTRV411 EQU   CVTRV409                                                 02257000
CVTRV410 EQU   CVTRV409                                                 02258000
CVTRV408 EQU   CVTRV400                                                 02259000
CVTRV407 EQU   CVTRV400                                                 02260000
CVTRV406 EQU   CVTRV400                                                 02261000
CVTRV405 EQU   CVTRV400                                                 02262000
CVTRV404 EQU   CVTRV400                                                 02263000
CVTRV403 EQU   CVTRV400                                                 02264000
CVTRV402 EQU   CVTRV400                                                 02265000
CVTRV401 EQU   CVTRV400                                                 02266000
CVTRSVA1 EQU   CVTXTNT2+48                                              02267000
CVTRSVA0 EQU   CVTXTNT2+44                                              02268000
CVTRSV99 EQU   CVTXTNT2+40                                              02269000
CVTRSV98 EQU   CVTXTNT2+36                                              02270000
CVTRSV97 EQU   CVTXTNT2+34                                              02271000
CVTRSV96 EQU   CVTXTNT2+32                                              02272000
CVTOLTEP EQU   CVTXTNT2+28                                              02273000
CVTQIDA  EQU   CVTQID+1                                                 02274000
CVTRSV95 EQU   CVTQID                                                   02275000
CVTRSV94 EQU   CVTXTNT2+20                                              02276000
CVTRSV93 EQU   CVTXTNT2+16                                              02277000
CVTRSV92 EQU   CVTXTNT2+12                                              02278000
CVTDEBVR EQU   CVTXTNT2+8                                               02279000
CVTRSV91 EQU   CVTXTNT2+6                                               02280000
CVTRSV9H EQU   CVTRSV90                                                 02281000
CVTRSV9G EQU   CVTRSV90                                                 02282000
CVTRSV9F EQU   CVTRSV90                                                 02283000
CVTRSV9E EQU   CVTRSV90                                                 02284000
CVTRSV9D EQU   CVTRSV90                                                 02285000
CVTRSV9C EQU   CVTRSV90                                                 02286000
CVTRSV9B EQU   CVTRSV90                                                 02287000
CVTRSV9A EQU   CVTRSV90                                                 02288000
CVTNUCLS EQU   CVTXTNT2+4                                               02289000
CVTDSSVA EQU   CVTDSSV+1                                                02290000
CVTRSV89 EQU   CVTDSSV                                                  02291000
CVTRSV88 EQU   CVTXTNT1+8                                               02292000
CVTRSV87 EQU   CVTXTNT1+4                                               02293000
CVTFACHN EQU   CVTXTNT1                                                 02294000
CVTRV488 EQU   CVTMAP+412                                               02295000
CVTRV487 EQU   CVTMAP+408                                               02296000
CVTRV486 EQU   CVTMAP+404                                               02297000
CVTRV485 EQU   CVTMAP+400                                               02298000
CVTRV484 EQU   CVTMAP+396                                               02299000
CVTAUTH  EQU   CVTMAP+392                                               02300000
CVTATMCA EQU   CVTATMCT+1                                               02301000
CVTATMST EQU   CVTATMCT                                                 02302000
CVTRSV61 EQU   CVTMAP+384                                               02303000
CVTVOLT1 EQU   CVTVOLM1+1                                               02304000
CVTVOLI1 EQU   CVTVOLF1                                                 02305000
CVTSTOA  EQU   CVTMAP+376                                               02306000
CVTRSV58 EQU   CVTMAP+374                                               02307000
CVTRSV57 EQU   CVTMAP+372                                               02308000
CVTDDCE  EQU   CVTMAP+368                                               02309000
CVTPNWFR EQU   CVTMAP+364                                               02310000
CVTSMF   EQU   CVTMAP+360                                               02311000
CVTSULK  EQU   CVTMAP+358                                               02312000
CVTSLKO  EQU   CVTSYSK                                                  02313000
CVTSLKP  EQU   CVTSYSK                                                  02314000
CVTSLKQ  EQU   CVTSYSK                                                  02315000
CVTSLKR  EQU   CVTSYSK                                                  02316000
CVTRSV56 EQU   CVTSYSK                                                  02317000
CVTRSV55 EQU   CVTSYSK                                                  02318000
CVTRSV54 EQU   CVTSYSK                                                  02319000
CVTRSV53 EQU   CVTSYSK                                                  02320000
CVTRSV52 EQU   CVTA1F1                                                  02321000
CVTRSV51 EQU   CVTA1F1                                                  02322000
CVTRSV50 EQU   CVTA1F1                                                  02323000
CVTRSV49 EQU   CVTA1F1                                                  02324000
CVTRSV48 EQU   CVTA1F1                                                  02325000
CVTRSV47 EQU   CVTA1F1                                                  02326000
CVTSRSW  EQU   CVTA1F1                                                  02327000
CVTPFSW  EQU   CVTA1F1                                                  02328000
CVTPCVT  EQU   CVTMAP+352                                               02329000
CVTRSV46 EQU   CVTMAP+344                                               02330000
CVTRSV45 EQU   CVTMAP+340                                               02331000
CVTRSV44 EQU   CVTMAP+338                                               02332000
CVTRSV43 EQU   CVTMAP+336                                               02333000
CVTHJESA EQU   CVTHJES+1                                                02334000
CVTRSV42 EQU   CVTHJES                                                  02335000
CVTEXT2A EQU   CVTEXT2+1                                                02336000
CVTRSV41 EQU   CVTEXT2                                                  02337000
CVTAPFA  EQU   CVTAPF+1                                                 02338000
CVTRSV40 EQU   CVTAPF                                                   02339000
CVTRV518 EQU   CVTINTLA                                                 02340000
CVTRV517 EQU   CVTERPV                                                  02341000
CVTEORM  EQU   CVTMAP+312                                               02342000
CVTMCHPR EQU   CVTMAP+308                                               02343000
CVTTZ    EQU   CVTMAP+304                                               02344000
CVTJEPS  EQU   CVTMAP+300                                               02345000
CVTMODE  EQU   CVTMAP+292                                               02346000
CVTPTRV  EQU   CVTMAP+288                                               02347000
CVTREAL  EQU   CVTMAP+284                                               02348000
CVTRSV39 EQU   CVTMAP+280                                               02349000
CVTRSV38 EQU   CVTMAP+276                                               02350000
CVTDMSRA EQU   CVTDMSR+1                                                02351000
CVTRSV37 EQU   CVTDMSR                                                  02352000
CVTQMSGA EQU   CVTQMSG+1                                                02353000
CVTRSV36 EQU   CVTQMSG                                                  02354000
CVTAMFF  EQU   CVTMAP+264                                               02355000
CVTPURGA EQU   CVTPURG+1                                                02356000
CVTRSV35 EQU   CVTPURG                                                  02357000
CVTCBSP  EQU   CVTMAP+256                                               02358000
CVTATERA EQU   CVTATER+1                                                02359000
CVTSYST  EQU   CVTATER                                                  02360000
CVTVOLT2 EQU   CVTTAT                                                   02361000
CVTVOLI2 EQU   CVTVOLF2                                                 02362000
CVTAQAVB EQU   CVTAQAVT+1                                               02363000
CVTRSV34 EQU   CVTTCMFG                                                 02364000
CVTRSV33 EQU   CVTTCMFG                                                 02365000
CVTRSV32 EQU   CVTTCMFG                                                 02366000
CVTRSV31 EQU   CVTTCMFG                                                 02367000
CVTRSV30 EQU   CVTTCMFG                                                 02368000
CVTRSV29 EQU   CVTTCMFG                                                 02369000
CVTRSV28 EQU   CVTTCMFG                                                 02370000
CVTTCRDY EQU   CVTTCMFG                                                 02371000
CVTGTFA  EQU   CVTGTF+1                                                 02372000
CVTRSV27 EQU   CVTGTFST                                                 02373000
CVTRNIO  EQU   CVTGTFST                                                 02374000
CVTRV319 EQU   CVTUSR                                                   02375000
CVTRV318 EQU   CVTFORM                                                  02376000
CVTRV317 EQU   CVTTMODE                                                 02377000
CVTRV316 EQU   CVTSTATE                                                 02378000
CVTRV315 EQU   CVTGTFS                                                  02379000
CVTGTFAV EQU   CVTGTFS                                                  02380000
CVT0SCR1 EQU   CVTMAP+232                                               02381000
CVTRV515 EQU   CVTMAP+228                                               02382000
CVTRMS   EQU   CVTMAP+224                                               02383000
CVTPATCH EQU   CVTMAP+220                                               02384000
CVTTSCE  EQU   CVTMAP+216                                               02385000
CVTLNKSC EQU   CVTMAP+214                                               02386000
CVTQABST EQU   CVTMAP+212                                               02387000
CVTMDLDS EQU   CVTMAP+208                                               02388000
CVTUSER  EQU   CVTMAP+204                                               02389000
CVTABEND EQU   CVTMAP+200                                               02390000
CVTSMCA  EQU   CVTMAP+196                                               02391000
CVTRSV18 EQU   CVTMAP+192                                               02392000
CVTQLPAQ EQU   CVTMAP+188                                               02393000
CVTQCDSR EQU   CVTMAP+184                                               02394000
CVTRSV17 EQU   CVTOPTB                                                  02395000
CVTRSV16 EQU   CVTOPTB                                                  02396000
CVTFP    EQU   CVTOPTB                                                  02397000
CVTAPTHR EQU   CVTOPTB                                                  02398000
CVTNLOG  EQU   CVTOPTB                                                  02399000
CVTTOD   EQU   CVTOPTB                                                  02400000
CVTCTIMS EQU   CVTOPTB                                                  02401000
CVTPROT  EQU   CVTOPTB                                                  02402000
CVTXPFP  EQU   CVTOPTA                                                  02403000
CVTASCII EQU   CVTOPTA                                                  02404000
CVTRSV13 EQU   CVTOPTA                                                  02405000
CVTRSV12 EQU   CVTOPTA                                                  02406000
CVTNIP   EQU   CVTOPTA                                                  02407000
CVTDDR   EQU   CVTOPTA                                                  02408000
CVTAPR   EQU   CVTOPTA                                                  02409000
CVTCCH   EQU   CVTOPTA                                                  02410000
CVTSNCTR EQU   CVTMAP+180                                               02411000
CVTQMWR  EQU   CVTMAP+176                                               02412000
CVTQOCR  EQU   CVTMAP+172                                               02413000
CVT1EF00 EQU   CVTMAP+168                                               02414000
CVTMZ00  EQU   CVTMAP+164                                               02415000
CVTHEAD  EQU   CVTMAP+160                                               02416000
CVTRSV11 EQU   CVTMAP+156                                               02417000
CVT0PT01 EQU   CVTMAP+152                                               02418000
CVTMSER  EQU   CVTMAP+148                                               02419000
CVTRV516 EQU   CVTIERLC                                                 02420000
CVTILCH  EQU   CVTMAP+140                                               02421000
CVT0DS   EQU   CVTMAP+136                                               02422000
CVTFBOSV EQU   CVTMAP+132                                               02423000
CVTNUCB  EQU   CVTMAP+128                                               02424000
CVTIXAVL EQU   CVTMAP+124                                               02425000
CVTIOQET EQU   CVTMAP+120                                               02426000
CVTDCBA  EQU   CVTMAP+117                                               02427000
CVTMVS2  EQU   CVTDCB                                                   02428000
CVT6DAT  EQU   CVTDCB                                                   02429000
CVT4MPS  EQU   CVTDCB                                                   02430000
CVTRSV09 EQU   CVTDCB                                                   02431000
CVT4MS1  EQU   CVTDCB                                                   02432000
CVT2SPS  EQU   CVTDCB                                                   02433000
CVT1SSS  EQU   CVTDCB                                                   02434000
CVTRSV08 EQU   CVTDCB                                                   02435000
CVTSTB   EQU   CVTMAP+112                                               02436000
CVTQTD00 EQU   CVTMAP+108                                               02437000
CVTQTE00 EQU   CVTMAP+104                                               02438000
CVTCUCB  EQU   CVTMAP+100                                               02439000
CVTSJQ   EQU   CVTMAP+96                                                02440000
CVTPBLDL EQU   CVTMAP+92                                                02441000
CVTTPC   EQU   CVTMAP+88                                                02442000
CVTSVDCB EQU   CVTMAP+84                                                02443000
CVTBRET  EQU   CVTMAP+82                                                02444000
CVTEXIT  EQU   CVTMAP+80                                                02445000
CVT0FN00 EQU   CVTMAP+76                                                02446000
CVTDARA  EQU   CVTDAR+1                                                 02447000
CVTRSV07 EQU   CVTFLGS1                                                 02448000
CVTRSV06 EQU   CVTFLGS1                                                 02449000
CVTRSV05 EQU   CVTFLGS1                                                 02450000
CVTRSV04 EQU   CVTFLGS1                                                 02451000
CVTRSV03 EQU   CVTFLGS1                                                 02452000
CVTRSV02 EQU   CVTFLGS1                                                 02453000
CVTRSV01 EQU   CVTFLGS1                                                 02454000
CVTDMPLK EQU   CVTFLGS1                                                 02455000
CVTXITP  EQU   CVTMAP+68                                                02456000
CVTZDTAB EQU   CVTMAP+64                                                02457000
CVTMSLT  EQU   CVTMAP+60                                                02458000
CVTDATE  EQU   CVTMAP+56                                                02459000
CVTBTERM EQU   CVTMAP+52                                                02460000
CVTSYSAD EQU   CVTMAP+48                                                02461000
CVTXTLER EQU   CVTMAP+44                                                02462000
CVTILK2  EQU   CVTMAP+40                                                02463000
CVTILK1  EQU   CVTMAP+36                                                02464000
CVTPRLTV EQU   CVTMAP+32                                                02465000
CVTPCNVT EQU   CVTMAP+28                                                02466000
CVT0VL00 EQU   CVTMAP+24                                                02467000
CVTXAPG  EQU   CVTMAP+20                                                02468000
CVTBUF   EQU   CVTMAP+16                                                02469000
CVTJOB   EQU   CVTMAP+12                                                02470000
CVTLINK  EQU   CVTMAP+8                                                 02471000
CVT0EF00 EQU   CVTMAP+4                                                 02472000
CVT      EQU   CVTMAP                                                   02473000
APPNAMID EQU   APPNMTBL+24                                              02474000
APPOFFST EQU   APPENTRY+2                                               02475000
APPCOUNT EQU   APPENTRY                                                 02476000
APPSIZE  EQU   APPNMTBL+2                                               02477000
APPBAL   EQU   APPNMTBL                                                 02478000
WTGETTR  EQU   WTGIDTTR+2                                               02479000
WTGOPD   EQU   WTGPATHS+1                                               02480000
WTGRECHK EQU   WTGPATHS+1                                               02481000
WTGTSENQ EQU   WTGPATHS+1                                               02482000
@NM00030 EQU   WTGPATHS+1                                               02483000
WTGTRACE EQU   WTGPATHS+1                                               02484000
@NM00029 EQU   WTGPATHS                                                 02485000
WTGJFCBW EQU   WTGPATHS                                                 02486000
WTGSMF   EQU   WTGPATHS                                                 02487000
WTGTCOS  EQU   WTGPATHS                                                 02488000
WTGNSL   EQU   WTGPATHS                                                 02489000
WTGPRLSE EQU   WTGPATHS                                                 02490000
WTGLNG   EQU   WTG+29                                                   02491000
WTGTXTLN EQU   WTGAREA+27                                               02492000
WTGMODSZ EQU   WTGAREA+24                                               02493000
WTGATTRB EQU   WTGAREA+22                                               02494000
@NM00028 EQU   WTGAREA+20                                               02495000
@NM00027 EQU   WTGAREA+12                                               02496000
WTGMODID EQU   WTGMODNM+6                                               02497000
@NM00026 EQU   WTGMODNM                                                 02498000
DSMADTW6 EQU   DSMADTRL+20                                              02499000
DSMADTW5 EQU   DSMADTRL+16                                              02500000
DSMADTW4 EQU   DSMADTRL+12                                              02501000
DSMADTW3 EQU   DSMADTRL+8                                               02502000
DSMADTW2 EQU   DSMADTRL+4                                               02503000
DSMADTB4 EQU   DSMADTW1+3                                               02504000
DSMADTB3 EQU   DSMADTW1+2                                               02505000
@NM00025 EQU   DSMADTB2                                                 02506000
DSMDSNE  EQU   DSMADTB2                                                 02507000
DSMTIOTE EQU   DSMADTB2                                                 02508000
DSMSMCE  EQU   DSMADTB2                                                 02509000
DSMVTOCR EQU   DSMADTB2                                                 02510000
DSMASWAP EQU   DSMADTB1                                                 02511000
DSMUCBAL EQU   DSMADTB1                                                 02512000
DSMRPSAP EQU   DSMADTB1                                                 02513000
DSMLOCK  EQU   DSMADTB1                                                 02514000
@NM00024 EQU   DSMADTB1                                                 02515000
DSMVIO   EQU   DSMADTB1                                                 02516000
DSMISAM  EQU   DSMADTB1                                                 02517000
RRFWORK  EQU   RRPLIST+20                                               02518000
RRMLRTRY EQU   RRPLIST+16                                               02519000
RRUCBPTR EQU   RRXRETRY                                                 02520000
RR1RETRY EQU   RRPLIST+8                                                02521000
RR1WRKAR EQU   RRPLIST+4                                                02522000
@NM00023 EQU   RRFLAGS3                                                 02523000
RRFTERM  EQU   RRFLAGS3                                                 02524000
RRFFCEXC EQU   RRFLAGS3                                                 02525000
RRFFINFC EQU   RRFLAGS3                                                 02526000
RRFNRTCA EQU   RRFLAGS3                                                 02527000
@NM00022 EQU   RRFLAGS3                                                 02528000
RRFENQUL EQU   RRFLAGS2                                                 02529000
RRFPRDET EQU   RRFLAGS2                                                 02530000
@NM00021 EQU   RRFLAGS2                                                 02531000
RRFQMNGR EQU   RRFLAGS2                                                 02532000
RRFENQPW EQU   RRFLAGS2                                                 02533000
@NM00020 EQU   RRFLAGS2                                                 02534000
RRFFIN1  EQU   RRFLAGS2                                                 02535000
RRFTRACE EQU   RRFLAGS1                                                 02536000
RRFSMF   EQU   RRFLAGS1                                                 02537000
RRFNSL   EQU   RRFLAGS1                                                 02538000
RRFAMSTR EQU   RRFLAGS1                                                 02539000
RRFAMEXR EQU   RRFLAGS1                                                 02540000
RRFAMEXG EQU   RRFLAGS1                                                 02541000
RRFUSREX EQU   RRFLAGS1                                                 02542000
@NM00019 EQU   RRFLAGS1                                                 02543000
RRFRJFCB EQU   RRFUNCTN                                                 02544000
RRFDADSM EQU   RRFUNCTN                                                 02545000
DXDCBLST EQU   USERPRML                                                 02546000
RWALIST  EQU   RWARESWA+12                                              02547000
RWAPARM  EQU   RWAPREFX+8                                               02548000
RWATRBUF EQU   RWAPREFX+4                                               02549000
RWATRACE EQU   RWAPREFX                                                 02550000
IECQMNGR EQU   IECEXTPR+92                                              02551000
IECMSGQA EQU   IECEXTPR+88                                              02552000
IECDCBNO EQU   IECUPRML                                                 02553000
IECRRPRM EQU   IECEXTPR+76                                              02554000
IECWTGTB EQU   IECEXTPR+72                                              02555000
IECCORP2 EQU   IECPREFX+28                                              02556000
IECCORP1 EQU   IECPREFX+24                                              02557000
IECCORPS EQU   IECPREFX+20                                              02558000
IECCORSP EQU   IECPREFX+19                                              02559000
@NM00018 EQU   IECPREFX+17                                              02560000
IECCORKY EQU   IECPREFX+16                                              02561000
IECCORAD EQU   IECPREFX+12                                              02562000
IECCORLN EQU   IECPREFX+8                                               02563000
@NM00017 EQU   IECPREFX+4                                               02564000
IECCORID EQU   IECPREFX                                                 02565000
DXATEXB2 EQU   DXATEXC2                                                 02566000
DXATCOM4 EQU   FORCORE+600                                              02567000
DXATCOM3 EQU   FORCORE+596                                              02568000
@NM00013 EQU   DXATCOM2+3                                               02569000
@NM00012 EQU   DXATALL                                                  02570000
DXATSWAP EQU   DXATALL                                                  02571000
DXATFC   EQU   DXATALL                                                  02572000
@NM00011 EQU   DXATOPEN                                                 02573000
DXATDFIN EQU   DXATOPEN                                                 02574000
DXATDSIN EQU   DXATOPEN                                                 02575000
DXATMODM EQU   DXATOPEN                                                 02576000
DXATMODE EQU   DXATOPEN                                                 02577000
DXATMODS EQU   DXATOPEN                                                 02578000
DXATIGN  EQU   DXATOPEN                                                 02579000
DXATVCAT EQU   DXATEOV                                                  02580000
DXATDADM EQU   DXATEOV                                                  02581000
DXATREMT EQU   DXATEOV                                                  02582000
DXATDNEW EQU   DXATEOV                                                  02583000
DXATDFRE EQU   DXATEOV                                                  02584000
DXATDCHN EQU   DXATEOV                                                  02585000
DXATNVOL EQU   DXATEOV                                                  02586000
DXATCCAT EQU   DXATEOV                                                  02587000
DXATRDDB EQU   DXATDACC                                                 02588000
DXATEOF  EQU   DXATDACC                                                 02589000
@NM00010 EQU   DXATDACC                                                 02590000
DXATSMF  EQU   DXATDACC                                                 02591000
DXATUPDB EQU   DXATDACC                                                 02592000
DXATDRCT EQU   DXATDACC                                                 02593000
DXATTRAK EQU   DXATDACC                                                 02594000
DXATF1CE EQU   DXATDACC                                                 02595000
DXATNSL  EQU   DXATOUTA                                                 02596000
DXATTTM2 EQU   DXATOUTA                                                 02597000
DXATTTM1 EQU   DXATOUTA                                                 02598000
DXATTRL2 EQU   DXATOUTA                                                 02599000
DXATTRL1 EQU   DXATOUTA                                                 02600000
DXATDATM EQU   DXATOUTA                                                 02601000
DXATHDTM EQU   DXATOUTA                                                 02602000
DXATVLHD EQU   DXATOUTA                                                 02603000
DXATCLOS EQU   DXATCOM1+1                                               02604000
DXATSRET EQU   DXATGENS                                                 02605000
DXATVCIG EQU   DXATVGIV                                                 02606000
DXATVTMG EQU   DXATVGIV                                                 02607000
DXATVSMG EQU   DXATVGIV                                                 02608000
DXATJFCB EQU   DXATGENS                                                 02609000
DXATDISP EQU   DXATGENS                                                 02610000
DXATREFR EQU   DXATGENS                                                 02611000
DXATDMCT EQU   DXATGENS                                                 02612000
DXMSGADR EQU   FORCORE+584                                              02613000
DXPRPARC EQU   FORCORE+580                                              02614000
DXUDCBML EQU   FORCORE+578                                              02615000
DXUDCBPL EQU   FORCORE+576                                              02616000
DXPACBAD EQU   DXPDCBAD+1                                               02617000
@NM00009 EQU   DXPDCBAD                                                 02618000
DXUACBAD EQU   DXUDCBAD+1                                               02619000
@NM00008 EQU   DXUDCBAD                                                 02620000
DXUCBSVV EQU   DXUCBSAV+1                                               02621000
@NM00007 EQU   DXUCBSAV                                                 02622000
DXUCBADR EQU   FORCORE+560                                              02623000
DXTIOTAD EQU   FORCORE+556                                              02624000
DXDEBXAD EQU   FORCORE+552                                              02625000
DXDSAB   EQU   FORCORE+548                                              02626000
DXDSABQD EQU   FORCORE+540                                              02627000
DXJSCBAD EQU   FORCORE+536                                              02628000
DXASCBAD EQU   FORCORE+528                                              02629000
DXEXTSW  EQU   FORCORE+527                                              02630000
DXWKEYSV EQU   FORCORE+525                                              02631000
DXUNITOF EQU   FORCORE+522                                              02632000
DXNOUNIT EQU   FORCORE+520                                              02633000
DXVOLSEQ EQU   FORCORE+518                                              02634000
DXVOLMT3 EQU   DXVOLSR3                                                 02635000
DXVOLMT2 EQU   DXVOLSR2                                                 02636000
DXVOLMT1 EQU   DXVOLSR1                                                 02637000
DXWORK4  EQU   FORCORE+496                                              02638000
DXWORK3  EQU   FORCORE+492                                              02639000
DXWORK2  EQU   FORCORE+488                                              02640000
DXWORK1  EQU   FORCORE+484                                              02641000
DXWORK   EQU   FORCORE+480                                              02642000
@NM00006 EQU   FORCORE+464                                              02643000
DXCCW11  EQU   DXCCW+80                                                 02644000
DXCCW10  EQU   DXCCW+72                                                 02645000
DXCCW9   EQU   DXCCW+64                                                 02646000
DXCCW7   EQU   DXCCW+48                                                 02647000
DXCCW6   EQU   DXCCW+40                                                 02648000
DXCCW4   EQU   DXCCW+24                                                 02649000
DXCCW3   EQU   DXCCW+16                                                 02650000
DXCCW2   EQU   DXCCW+8                                                  02651000
DXDCBDEB EQU   DXDCB+44                                                 02652000
@NM00005 EQU   DXDCB+24                                                 02653000
DXDEBDCB EQU   DXDCB+20                                                 02654000
@NM00004 EQU   DXDCB                                                    02655000
DXDEB    EQU   DXDAADDR+4                                               02656000
@NM00003 EQU   DXDAADDR                                                 02657000
DXIOB    EQU   FORCORE+280                                              02658000
DXECB    EQU   FORCORE+276                                              02659000
DSCCORE  EQU   FORCORE+96                                               02660000
CURRTCB  EQU   TCBPTRS+5                                                02661000
@NM00002 EQU   TCBPTRS+4                                                02662000
NEXTTCB  EQU   TCBPTRS+1                                                02663000
@NM00001 EQU   TCBPTRS                                                  02664000
PARMIN   EQU   ACBOPATB                                                 02665000
FILPAD   EQU   ACBOPATB                                                 02666000
@NM00056 EQU   PSA+3412                                                 02667000
PSASTAK  EQU   PSA+3072                                                 02668000
@NM00055 EQU   PSA+1032                                                 02669000
PSAUSEND EQU   PSA+1032                                                 02670000
PSAPCPSW EQU   PSA+1024                                                 02671000
PSARV060 EQU   PSA+1020                                                 02672000
PSARV059 EQU   PSA+1018                                                 02673000
PSASVC13 EQU   PSA+1016                                                 02674000
PSALSFCC EQU   PSA+1012                                                 02675000
PSASFACC EQU   PSA+1008                                                 02676000
PSASTOP  EQU   PSA+992                                                  02677000
PSASTART EQU   PSA+976                                                  02678000
PSARSPSW EQU   PSA+968                                                  02679000
PSASRPSW EQU   PSA+960                                                  02680000
PSARV045 EQU   PSA+892                                                  02681000
PSARV044 EQU   PSA+888                                                  02682000
PSARV043 EQU   PSA+884                                                  02683000
PSARV042 EQU   PSA+880                                                  02684000
PSARV041 EQU   PSA+876                                                  02685000
PSARV040 EQU   PSA+872                                                  02686000
PSARV025 EQU   PSA+868                                                  02687000
PSADSSED EQU   PSA+868                                                  02688000
PSADSSPR EQU   PSA+864                                                  02689000
PSADSSFW EQU   PSA+860                                                  02690000
PSADSS14 EQU   PSA+856                                                  02691000
PSADSSPP EQU   PSA+848                                                  02692000
PSADSSRP EQU   PSA+840                                                  02693000
PSADSS05 EQU   PSADSSF4                                                 02694000
PSADSS10 EQU   PSADSSF4                                                 02695000
PSADSSVE EQU   PSADSSF4                                                 02696000
PSADSSDE EQU   PSADSSF4                                                 02697000
PSADSSC0 EQU   PSADSSF4                                                 02698000
PSADSSIE EQU   PSADSSF4                                                 02699000
PSADSS12 EQU   PSADSSF4                                                 02700000
PSADSSRC EQU   PSADSSF4                                                 02701000
PSARV057 EQU   PSADSSF3                                                 02702000
PSARV056 EQU   PSADSSF3                                                 02703000
PSARV055 EQU   PSADSSF3                                                 02704000
PSADSSMC EQU   PSADSSF3                                                 02705000
PSADSSRW EQU   PSADSSF3                                                 02706000
PSADSSNM EQU   PSADSSF3                                                 02707000
PSADSSES EQU   PSADSSF3                                                 02708000
PSADSSGP EQU   PSADSSF3                                                 02709000
PSADSSF2 EQU   PSADSSFL+1                                               02710000
PSADSSPI EQU   PSADSSF1                                                 02711000
PSADSSOI EQU   PSADSSF1                                                 02712000
PSADSSSP EQU   PSADSSF1                                                 02713000
PSADSSTP EQU   PSADSSF1                                                 02714000
PSADSSDW EQU   PSADSSF1                                                 02715000
PSADSSDD EQU   PSADSSF1                                                 02716000
PSADSSDM EQU   PSADSSF1                                                 02717000
PSADSSMV EQU   PSADSSF1                                                 02718000
PSADSSTS EQU   PSA+816                                                  02719000
PSADSSWK EQU   PSA+812                                                  02720000
PSADSSR3 EQU   PSA+808                                                  02721000
PSADSSR2 EQU   PSA+804                                                  02722000
PSADSSRS EQU   PSA+800                                                  02723000
PSASTOR  EQU   PSA+796                                                  02724000
PSACPUSA EQU   PSA+794                                                  02725000
PSAVSTAP EQU   PSA+792                                                  02726000
PSAWKVAP EQU   PSA+788                                                  02727000
PSAWKRAP EQU   PSA+784                                                  02728000
PSAMCHIC EQU   PSA+783                                                  02729000
PSARV061 EQU   PSA+782                                                  02730000
PSASYMSK EQU   PSA+781                                                  02731000
PSAMCHFL EQU   PSA+780                                                  02732000
PSACR0   EQU   PSA+776                                                  02733000
PSAPSWSV EQU   PSA+768                                                  02734000
PSALITA  EQU   PSA+764                                                  02735000
PSACLHS  EQU   PSAHLHI                                                  02736000
PSALKR15 EQU   PSALKSA+60                                               02737000
PSALKR14 EQU   PSALKSA+56                                               02738000
PSALKR13 EQU   PSALKSA+52                                               02739000
PSALKR12 EQU   PSALKSA+48                                               02740000
PSALKR11 EQU   PSALKSA+44                                               02741000
PSALKR10 EQU   PSALKSA+40                                               02742000
PSALKR9  EQU   PSALKSA+36                                               02743000
PSALKR8  EQU   PSALKSA+32                                               02744000
PSALKR7  EQU   PSALKSA+28                                               02745000
PSALKR6  EQU   PSALKSA+24                                               02746000
PSALKR5  EQU   PSALKSA+20                                               02747000
PSALKR4  EQU   PSALKSA+16                                               02748000
PSALKR3  EQU   PSALKSA+12                                               02749000
PSALKR2  EQU   PSALKSA+8                                                02750000
PSALKR1  EQU   PSALKSA+4                                                02751000
PSALKR0  EQU   PSALKSA                                                  02752000
PSARV023 EQU   PSACLHT+52                                               02753000
PSALOCAL EQU   PSACLHT+48                                               02754000
PSACMSL  EQU   PSACLHT+44                                               02755000
PSAOPTL  EQU   PSACLHT+40                                               02756000
PSATPACL EQU   PSACLHT+36                                               02757000
PSATPDNL EQU   PSACLHT+32                                               02758000
PSATPNCL EQU   PSACLHT+28                                               02759000
PSAIOSLL EQU   PSACLHT+24                                               02760000
PSAIOSUL EQU   PSACLHT+20                                               02761000
PSAIOSCL EQU   PSACLHT+16                                               02762000
PSAIOSSL EQU   PSACLHT+12                                               02763000
PSASALCL EQU   PSACLHT+8                                                02764000
PSAASML  EQU   PSACLHT+4                                                02765000
PSADISPL EQU   PSACLHT                                                  02766000
PSASRSA  EQU   PSA+636                                                  02767000
PSARV050 EQU   PSA+634                                                  02768000
PSADSSGO EQU   PSA+633                                                  02769000
PSARECUR EQU   PSA+632                                                  02770000
PSAHLHIS EQU   PSA+628                                                  02771000
PSAIPCSA EQU   PSA+624                                                  02772000
@NM00054 EQU   PSA+621                                                  02773000
PSAIPCDM EQU   PSA+620                                                  02774000
PSAIPCD  EQU   PSA+616                                                  02775000
@NM00053 EQU   PSA+613                                                  02776000
PSAIPCRM EQU   PSA+612                                                  02777000
PSAIPCR  EQU   PSA+608                                                  02778000
PSAMCHEX EQU   PSA+600                                                  02779000
PSAMPSW  EQU   PSA+592                                                  02780000
PSAEXPS2 EQU   PSA+584                                                  02781000
PSAEXPS1 EQU   PSA+576                                                  02782000
PSAPIREG EQU   PSA+572                                                  02783000
PSARSREG EQU   PSA+568                                                  02784000
PSAGPREG EQU   PSA+556                                                  02785000
PSARV022 EQU   PSASUP4                                                  02786000
PSARV021 EQU   PSASUP4                                                  02787000
PSARV020 EQU   PSASUP4                                                  02788000
PSARV019 EQU   PSASUP4                                                  02789000
PSARV018 EQU   PSASUP4                                                  02790000
PSARV017 EQU   PSASUP4                                                  02791000
PSARV016 EQU   PSASUP4                                                  02792000
PSARV015 EQU   PSASUP4                                                  02793000
PSARV014 EQU   PSASUP3                                                  02794000
PSARV013 EQU   PSASUP3                                                  02795000
PSARV012 EQU   PSASUP3                                                  02796000
PSARV011 EQU   PSASUP3                                                  02797000
PSARV010 EQU   PSASUP3                                                  02798000
PSARV009 EQU   PSASUP3                                                  02799000
PSARV008 EQU   PSASUP3                                                  02800000
PSAIOSUP EQU   PSASUP3                                                  02801000
PSALCR   EQU   PSASUP2                                                  02802000
PSARTM   EQU   PSASUP2                                                  02803000
PSAACR   EQU   PSASUP2                                                  02804000
PSAIPCE2 EQU   PSASUP2                                                  02805000
PSAIPCES EQU   PSASUP2                                                  02806000
PSAIPCEC EQU   PSASUP2                                                  02807000
PSAGTF   EQU   PSASUP2                                                  02808000
PSAIPCRI EQU   PSASUP2                                                  02809000
PSAIPCRP EQU   PSASUP1                                                  02810000
PSAIPCDR EQU   PSASUP1                                                  02811000
PSADISP  EQU   PSASUP1                                                  02812000
PSALOCK  EQU   PSASUP1                                                  02813000
PSAPI    EQU   PSASUP1                                                  02814000
PSAEXT   EQU   PSASUP1                                                  02815000
PSASVC   EQU   PSASUP1                                                  02816000
PSAIO    EQU   PSASUP1                                                  02817000
PSAAOLD  EQU   PSA+548                                                  02818000
PSAANEW  EQU   PSA+544                                                  02819000
PSATOLD  EQU   PSA+540                                                  02820000
PSATNEW  EQU   PSA+536                                                  02821000
PSALCCAR EQU   PSA+532                                                  02822000
PSALCCAV EQU   PSA+528                                                  02823000
PSAPCCAR EQU   PSA+524                                                  02824000
PSAPCCAV EQU   PSA+520                                                  02825000
PSACPULA EQU   PSA+518                                                  02826000
PSACPUPA EQU   PSA+516                                                  02827000
PSAPSA   EQU   PSA+512                                                  02828000
FLCHDEND EQU   PSA+512                                                  02829000
FLCCRSAV EQU   FLCMCLA+280                                              02830000
FLCGRSAV EQU   FLCMCLA+216                                              02831000
FLCFPSAV EQU   FLCMCLA+184                                              02832000
FLCFLA   EQU   FLCMCLA+88                                               02833000
FLCRGNCD EQU   FLCMCLA+84                                               02834000
FLCFSAA  EQU   FLCFSA+1                                                 02835000
@NM00052 EQU   FLCFSA                                                   02836000
@NM00051 EQU   FLCMCLA+72                                               02837000
FLCMCIC  EQU   FLCMCLA+64                                               02838000
@NM00050 EQU   FLCMCLA+20                                               02839000
FLCIOAA  EQU   FLCIOA+1                                                 02840000
@NM00049 EQU   FLCIOA                                                   02841000
@NM00048 EQU   FLCMCLA+15                                               02842000
@NM00047 EQU   FLCMCLA+14                                               02843000
@NM00046 EQU   FLCMCLA+12                                               02844000
FLCLCL   EQU   FLCMCLA+8                                                02845000
FLCIOELA EQU   FLCIOEL+1                                                02846000
@NM00045 EQU   FLCIOEL                                                  02847000
FLCCHNID EQU   FLCMCLA                                                  02848000
@NM00044 EQU   PSA+160                                                  02849000
FLCMTRCD EQU   PSA+157                                                  02850000
@NM00043 EQU   PSA+156                                                  02851000
FLCPERA  EQU   FLCPER+1                                                 02852000
@NM00042 EQU   FLCPER                                                   02853000
@NM00041 EQU   PSA+151                                                  02854000
FLCPERCD EQU   PSA+150                                                  02855000
FLCMCNUM EQU   PSA+149                                                  02856000
@NM00040 EQU   PSA+148                                                  02857000
FLCTEAA  EQU   FLCTEA+1                                                 02858000
@NM00039 EQU   FLCTEA                                                   02859000
PSAPIPC  EQU   PSAPICOD                                                 02860000
PSAPIMC  EQU   PSAPICOD                                                 02861000
PSAPIPER EQU   PSAPICOD                                                 02862000
PSARV049 EQU   FLCPICOD                                                 02863000
FLCPILCB EQU   FLCPIILC                                                 02864000
@NM00038 EQU   FLCPIILC                                                 02865000
@NM00037 EQU   PSAEPPSW                                                 02866000
FLCSVCN  EQU   PSAESPSW+2                                               02867000
FLCSILCB EQU   FLCSVILC                                                 02868000
@NM00036 EQU   FLCSVILC                                                 02869000
@NM00035 EQU   PSAESPSW                                                 02870000
FLCEICOD EQU   PSAEEPSW+2                                               02871000
PSASPAD  EQU   PSAEEPSW                                                 02872000
@NM00034 EQU   PSA+128                                                  02873000
FLCINPSW EQU   PSA+120                                                  02874000
FLCMNPSW EQU   PSA+112                                                  02875000
FLCPNPSW EQU   PSA+104                                                  02876000
FLCSNPSW EQU   PSA+96                                                   02877000
FLCENPSW EQU   PSA+88                                                   02878000
FLCTRACE EQU   PSA+84                                                   02879000
FLCTIMER EQU   PSA+80                                                   02880000
FLCCVT2  EQU   PSA+76                                                   02881000
FLCCAW   EQU   PSA+72                                                   02882000
FLCCSW   EQU   PSA+64                                                   02883000
FLCIOPSW EQU   PSA+56                                                   02884000
FLCMOPSW EQU   PSA+48                                                   02885000
FLCPOPSW EQU   PSA+40                                                   02886000
FLCSOPSW EQU   PSA+32                                                   02887000
FLCEOPSW EQU   PSA+24                                                   02888000
@NM00033 EQU   FLCICCW2+4                                               02889000
FLCCVT   EQU   FLCICCW2                                                 02890000
FLCICCW1 EQU   FLCROPSW                                                 02891000
FLCIPPSW EQU   FLCRNPSW                                                 02892000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02893000
@RT00160 EQU   CHAINDEB                                                 02894000
@RT00186 EQU   SERCHWTG                                                 02895000
@RT00191 EQU   BEGIN                                                    02896000
@RF00191 EQU   NEXTACB                                                  02897000
@RC00196 EQU   @EL00001                                                 02898000
FINISH   EQU   @EL00001                                                 02899000
@ENDDATA EQU   *                                                        02900000
         END   IGG0193K,(C'PLS0006',0602,75026)                         02901000
./  ADD  SSI=71600268,NAME=IGG0196M
         IECPDINI OPENEX                                                30000021
         END   IGG0196M                                                 60000021
./  ADD  SSI=50250604,NAME=IGG0203K
         TITLE 'IGG0203K -- SUBSYSTEM CLOSE EXECUTOR                   *00001000
                        '                                               00002000
IGG0203K CSECT ,                                                   0001 00003000
@PROLOG  BALR  @03,0                                               0001 00004000
@PSTART  DS    0H                                                  0001 00005000
         USING @PSTART,@03                                         0001 00006000
         EJECT                                                          00007000
*                                       /* EQUATES GEN CODE   Y02120 */ 00008000
K0       EQU   0                        CONSTANT OF ZERO      Y02120    00009000
LNSAV    EQU   72                       SAVE AREA IN BYTES    Y02120    00010000
K254     EQU   254                      CONSTANT OF 250 FOR SP   Y02120 00011000
         EJECT                                                          00012000
         EJECT                                                          00013000
         EJECT                                                          00014000
*                                                                  0095 00015000
*/* SETUP POINTERS TO WORK AREA, JFCB, ACB, TIOT, AND DEB            */ 00016000
*/* FOR THIS ENTRY IN THE WTG TABLE.                                 */ 00017000
*                                                                  0095 00018000
*START:                                                            0095 00019000
*   ;                                                              0095 00020000
START    DS    0H                                                  0096 00021000
*   RCORE=WTGCORE;                  /* LOAD OCE WORK AREA POINTER    */ 00022000
         SLR   RCORE,RCORE                                         0096 00023000
         ICM   RCORE,7,WTGCORE(RWTGC)                              0096 00024000
*   RACB=PARM;                      /* LOAD ACB POINTER              */ 00025000
         L     RACB,PARM(,RPARC)                                   0097 00026000
*   RDEB=ACBDEB;                    /* LOAD DEB POINTER              */ 00027000
         SLR   RDEB,RDEB                                           0098 00028000
         ICM   RDEB,7,ACBDEB(RACB)                                 0098 00029000
*/* BUILD LINKAGE AND GO TO THE SUBSYSTEM BY ISSUING THE     Y02120  */ 00030000
*/* IEFSSREQ MACRO.                                          Y02120  */ 00031000
*                                                                  0099 00032000
*   SSOBFUNC=17;                    /* FUNCTION ID Y02120            */ 00033000
         LA    @12,4                                               0099 00034000
         LA    @10,SSIBSUSE+36(,RDEB)                              0099 00035000
         ALR   @10,@12                                             0099 00036000
         MVC   SSOBFUNC(2,@10),@CH01090                            0099 00037000
*   SSDAJFCB=ADDR(DXJBF);           /* JFCB ADDRESS Y02120           */ 00038000
         LA    @09,SSOBINDV(,@10)                                  0100 00039000
         ALR   @09,@12                                             0100 00040000
         LA    @12,DXJBF(,RCORE)                                   0100 00041000
         ST    @12,SSDAJFCB(,@09)                                  0100 00042000
*   DXCCW1A=ADDR(SSOB)|'80000000'X; /* PARM LIST END Y02120          */ 00043000
         O     @10,@CF01890                                        0101 00044000
         ST    @10,DXCCW1A(,RCORE)                                 0101 00045000
*   R1=ADDR(DXCCW1A);               /* POINTS TO LIST Y02120         */ 00046000
         LA    R1,DXCCW1A(,RCORE)                                  0102 00047000
*   RFY                                                            0103 00048000
*    (SAVEPTR,                                                     0103 00049000
*     REG15) RSTD;                  /* RESTRICT FOR Y02134 IEFSSREQ     00050000
*                                      Y02134                        */ 00051000
*   SAVEPTR=ADDR(DXLBL);            /* POINTS TO SAVE AREA Y02120    */ 00052000
         LR    SAVEPTR,RCORE                                       0104 00053000
*   DXEXHASP=ON;                    /* HASP GIVEN CONTROL    @ZA02504*/ 00054000
         OI    DXEXHASP(RCORE),B'10000000'                         0105 00055000
*   GEN(IEFSSREQ);                  /* ISSUE MACRO CALL Y02120       */ 00056000
         IEFSSREQ                                                       00057000
*   RFY                                                            0107 00058000
*     SAVEPTR UNRSTD;               /* Y02120                        */ 00059000
*/*   ERROR RETURN LOGIC                                      Y02120 */ 00060000
*/*                                                           Y02120 */ 00061000
*                                                                  0108 00062000
*   IF REG15=0&SSOBRETN=0 THEN      /* CHECK ERROR Y02120            */ 00063000
         SLR   @14,@14                                             0108 00064000
         CR    REG15,@14                                           0108 00065000
         BNE   @RF00108                                            0108 00066000
         LA    @12,SSIBSUSE+36(,RDEB)                              0108 00067000
         C     @14,SSOBRETN+4(,@12)                                0108 00068000
         BE    @RT00108                                            0108 00069000
*     GO TO RELOOP;                 /* NO ERROR Y02120               */ 00070000
*/*   TURN OFF BUSY BIT IN ACB                                Y02120 */ 00071000
*                                                                  0110 00072000
*   ACBIOSFG='0'B;                  /* TURN OFF BUSY BIT Y02120      */ 00073000
@RF00108 NI    ACBIOSFG(RACB),B'11111110'                          0110 00074000
*   IF REG15=0 THEN                 /* TEST FOR ERROR YM1195         */ 00075000
         LTR   REG15,REG15                                         0111 00076000
         BZ    @RT00111                                            0111 00077000
*     GO TO RELOOP;                 /* NO IEFSSREQ ERROR YM1195      */ 00078000
*   ELSE                            /* YM1195                        */ 00079000
*     DO;                           /* YM1195                        */ 00080000
*       GEN REFS(DXCALLID,DXREG9);                                 0114 00081000
*                                                           /*YM1195 */ 00082000
*        DMABCOND CABD254,IGG0206M,RES=NO      GENERATE ABEND    YM1195 00083000
         LA    0,CABD254                                         YM1195 00084000
         MVC   DXCALLID(2,4),6(RWTG)                             YM1195 00085000
         MVC   0(5,RWTGC),IGG0206M                               YM1195 00086000
         STM   9,14,DXREG9(4)              SAVE REGS             YM3885 00087000
         B     BRANCH                   GO TO PROB DETERMINATION YM1195 00088000
CABD254  EQU   254                      ERROR CODE               YM1195 00089000
*     END;                          /* YM1195                        */ 00090000
*   RFY                                                            0116 00091000
*     REG15 UNRSTD;                 /* YM1195                        */ 00092000
*                                                                  0117 00093000
*/* DETERMINE IF THIS MODULE IS NEEDED BY ANOTHER ENTRY IN THE       */ 00094000
*/* WTG TABLE. IF YES, GO BACK TO THE START OF THIS MODULE.          */ 00095000
*                                                                  0117 00096000
*RELOOP:                                                           0117 00097000
*   WTGEID='0000'X;                 /* INDICATE THIS ENTRY Y02134  0117 00098000
*                                      FINISHED Y02134               */ 00099000
RELOOP   MVC   WTGEID(2,RWTGC),@CB01893                            0117 00100000
*LOOP1:                                                            0118 00101000
*   ;                                                              0118 00102000
LOOP1    DS    0H                                                  0119 00103000
*   RWTGC=RWTGC+LENGTH(WTGENTRY);   /* POINT TO NEXT WTG ENTRY       */ 00104000
         AH    RWTGC,@CH00061                                      0119 00105000
*   RPARC=RPARC+LENGTH(PARC);       /* POINT TO NEXT PARM ENTRY      */ 00106000
         AH    RPARC,@CH00059                                      0120 00107000
*   IF WTGEID='3K' THEN                                            0121 00108000
         CLC   WTGEID(2,RWTGC),@CC01897                            0121 00109000
         BE    @RT00121                                            0121 00110000
*     GO TO START;                  /* Y02134                        */ 00111000
*   IF WTGEID<'0B'|WTGEID>'0G'      /* Y02134                        */ 00112000
*     THEN                                                         0123 00113000
         CLC   WTGEID(2,RWTGC),@CC01898                            0123 00114000
         BL    @RT00123                                            0123 00115000
         CLC   WTGEID(2,RWTGC),@CC01899                            0123 00116000
         BH    @RT00123                                            0123 00117000
*     GO TO LOOP1;                  /* Y02134                        */ 00118000
*/* THIS MODULE IS NOT REQUIRED FOR FURTHER PROCESSING. NOW FIND     */ 00119000
*/* THE FIRST NON-ZERO ENTRY IN THE WTG TABLE.                       */ 00120000
*                                                                  0125 00121000
*   RPARC=RPAR;                     /* POINT TO START OF PARM LIST   */ 00122000
         LR    RPARC,RPAR                                          0125 00123000
*   RWTGC=RWTG+LENGTH(WTG);         /* POINT TO FIRST ENTRY Y02134   */ 00124000
         LA    RWTGC,32                                            0126 00125000
         ALR   RWTGC,RWTG                                          0126 00126000
*LOOP2:                                                            0127 00127000
*   ;                                                              0127 00128000
LOOP2    DS    0H                                                  0128 00129000
*   IF WTGEID='0000'X THEN                                         0128 00130000
         CLC   WTGEID(2,RWTGC),@CB01893                            0128 00131000
         BNE   @RF00128                                            0128 00132000
*     DO;                           /* IS THIS ENTRY THROUGH Y02134  */ 00133000
*       RWTGC=RWTGC+LENGTH(WTGENTRY);/* YES INCR WTG ENT             */ 00134000
         AH    RWTGC,@CH00061                                      0130 00135000
*       RPARC=RPARC+LENGTH(PARC);   /* INCR PARM POINTER             */ 00136000
         AH    RPARC,@CH00059                                      0131 00137000
*       GO TO LOOP2;                /* GO CHECK NEXT ENTRY           */ 00138000
         B     LOOP2                                               0132 00139000
*     END;                                                         0133 00140000
*                                                                  0133 00141000
*/* GO FREE THIS MODULES DATA AREA.                                  */ 00142000
*                                                                  0134 00143000
*   GEN(BAL  RET,FINISH);           /* GO FREE DATA AREA             */ 00144000
@RF00128 DS    0H                                                  0134 00145000
         BAL  RET,FINISH                                                00146000
*/* TRANSFER CONTROL TO NEXT MODULE.                                 */ 00147000
*                                                                  0135 00148000
*   RFY                                                            0135 00149000
*    (REG15) RSTD;                  /* Y02134                        */ 00150000
*BRANCH:                                                           0136 00151000
*   ;                               /* YM1195                        */ 00152000
BRANCH   DS    0H                                                  0137 00153000
*   REG15=ADDR(WTGPREFX);           /* Y02080                        */ 00154000
         LA    REG15,WTGPREFX(,RWTG)                               0137 00155000
*   GEN REFS(WTGMODEP,WTGMODNM,IECREGSV);                          0138 00156000
*                                                          /* Y02134 */ 00157000
*        IECRES LOAD,MODID=(RWTGC),PREFIX=0(15),BRANCH=DIRECT    Y02080 00158000
         L     15,0(,15)                                         Y02080 00159000
         STM   0,14,IECREGSV-IECPREFX(15)                        Y02080 00160000
         MVC   WTGMODNM+6(2,6),0(RWTGC)                          Y02080 00161000
         MVC   WTGMODEP+1(3,6),2(RWTGC)                          Y02080 00162000
         LA    6,WTGMODNM(,6)                                    Y02080 00163000
         L     5,CVTPTR(0,0)                                     Y02080 00164000
         L     5,CVTDMSR-CVT(,5)                                 Y02080 00165000
         B     20(,5)                                            Y02080 00166000
*   RFY                                                            0139 00167000
*    (REG15) UNRSTD;                /* Y02134                        */ 00168000
*FINISH:                                                           0140 00169000
*   RETURN;                         /* Y02080                        */ 00170000
@EL00001 DS    0H                                                  0140 00171000
@EF00001 DS    0H                                                  0140 00172000
@ER00001 BR    @14                                                 0140 00173000
*   GEN DATA;                                                      0141 00174000
*   END IGG0203K                                                   0142 00175000
*                                                                  0142 00176000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00177000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 00178000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 00179000
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */ 00180000
*/*%INCLUDE SYSLIB  (IECDSECT)                                       */ 00181000
*/*%INCLUDE SYSLIB  (IECDSECS)                                       */ 00182000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 00183000
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                       */ 00184000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */ 00185000
*/*%INCLUDE SYSLIB  (IEFJSSIB)                                       */ 00186000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */ 00187000
*                                                                  0142 00188000
*       ;                                                          0142 00189000
         B     @EL00001                                            0142 00190000
@DATA    DS    0H                                                       00191000
@CH00059 DC    H'4'                                                     00192000
@CH00061 DC    H'8'                                                     00193000
@CH01090 DC    H'17'                                                    00194000
@DATD    DSECT                                                          00195000
         DS    0F                                                       00196000
IGG0203K CSECT                                                          00197000
         DS    0F                                                       00198000
@CF01890 DC    XL4'80000000'                                            00199000
@DATD    DSECT                                                          00200000
         DS    0D                                                       00201000
IGG0203K CSECT                                                          00202000
         DS    0F                                                       00203000
@SIZDATD DC    AL1(0)                                                   00204000
         DC    AL3(@ENDDATD-@DATD)                                      00205000
         DS    0D                                                       00206000
@CC01897 DC    C'3K'                                                    00207000
@CC01898 DC    C'0B'                                                    00208000
@CC01899 DC    C'0G'                                                    00209000
@CB01893 DC    X'0000'                                                  00210000
JECSINT  DC    CL8'IFGAAABA'                                            00211000
@DATD    DSECT                                                          00212000
IGG0203K CSECT                                                   Y02080 00213000
XCTLTABL XCTLTABL ID=(IGG0206M,6M),SVC=020,BRT=YES,LENGTH=       YM1195 00214000
CVT      EQU   0                        DEFINE CVT DSECT NAME    Y02080 00215000
@DATD    DSECT                                                          00216000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00217000
@ENDDATD EQU   *                                                        00218000
IGG0203K CSECT                                                          00219000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00220000
@01      EQU   01                                                       00221000
@02      EQU   02                                                       00222000
@03      EQU   03                                                       00223000
@04      EQU   04                                                       00224000
@05      EQU   05                                                       00225000
@06      EQU   06                                                       00226000
@07      EQU   07                                                       00227000
@08      EQU   08                                                       00228000
@09      EQU   09                                                       00229000
@10      EQU   10                                                       00230000
@11      EQU   11                                                       00231000
@12      EQU   12                                                       00232000
@13      EQU   13                                                       00233000
@14      EQU   14                                                       00234000
@15      EQU   15                                                       00235000
R1       EQU   @01                                                      00236000
RACB     EQU   @02                                                      00237000
RCORE    EQU   @04                                                      00238000
RPAR     EQU   @05                                                      00239000
RWTG     EQU   @06                                                      00240000
RPARC    EQU   @07                                                      00241000
RWTGC    EQU   @08                                                      00242000
RDEB     EQU   @11                                                      00243000
SAVEPTR  EQU   @13                                                      00244000
REG15    EQU   @15                                                      00245000
RET      EQU   @14                                                      00246000
RF       EQU   @15                                                      00247000
R0       EQU   @00                                                      00248000
CVTPTR   EQU   16                                                       00249000
DEBSBPTR EQU   0                                                        00250000
DEBEXPTR EQU   0                                                        00251000
PARC     EQU   0                                                        00252000
PARM     EQU   PARC                                                     00253000
CVTMAP   EQU   0                                                        00254000
CVTDAR   EQU   CVTMAP+72                                                00255000
CVTFLGS1 EQU   CVTDAR                                                   00256000
CVTDCB   EQU   CVTMAP+116                                               00257000
CVTIERLC EQU   CVTMAP+144                                               00258000
CVTOPTA  EQU   CVTMAP+182                                               00259000
CVTOPTB  EQU   CVTMAP+183                                               00260000
CVTGTF   EQU   CVTMAP+236                                               00261000
CVTGTFST EQU   CVTGTF                                                   00262000
CVTGTFS  EQU   CVTGTFST                                                 00263000
CVTSTATE EQU   CVTGTFST                                                 00264000
CVTTMODE EQU   CVTGTFST                                                 00265000
CVTFORM  EQU   CVTGTFST                                                 00266000
CVTUSR   EQU   CVTGTFST                                                 00267000
CVTAQAVT EQU   CVTMAP+240                                               00268000
CVTTCMFG EQU   CVTAQAVT                                                 00269000
CVTVOLM2 EQU   CVTMAP+244                                               00270000
CVTTATA  EQU   CVTVOLM2                                                 00271000
CVTTSKS  EQU   CVTTATA                                                  00272000
CVTVOLF2 EQU   CVTTSKS                                                  00273000
CVTTAT   EQU   CVTTATA+1                                                00274000
CVTATER  EQU   CVTMAP+248                                               00275000
CVTEXT1  EQU   CVTMAP+252                                               00276000
CVTPURG  EQU   CVTMAP+260                                               00277000
CVTQMSG  EQU   CVTMAP+268                                               00278000
CVTDMSR  EQU   CVTMAP+272                                               00279000
CVTJESCT EQU   CVTMAP+296                                               00280000
CVTERPV  EQU   CVTMAP+316                                               00281000
CVTINTLA EQU   CVTMAP+320                                               00282000
CVTAPF   EQU   CVTMAP+324                                               00283000
CVTEXT2  EQU   CVTMAP+328                                               00284000
CVTHJES  EQU   CVTMAP+332                                               00285000
CVTPGSIA EQU   CVTMAP+348                                               00286000
CVTA1F1  EQU   CVTMAP+356                                               00287000
CVTSYSK  EQU   CVTMAP+357                                               00288000
CVTVOLM1 EQU   CVTMAP+380                                               00289000
CVTVOLF1 EQU   CVTVOLM1                                                 00290000
CVTATMCT EQU   CVTMAP+388                                               00291000
CVTXTNT1 EQU   0                                                        00292000
CVTXTNT2 EQU   0                                                        00293000
CVTDSSV  EQU   CVTXTNT2                                                 00294000
CVTRSV90 EQU   CVTXTNT2+5                                               00295000
CVTQID   EQU   CVTXTNT2+24                                              00296000
CVTRV400 EQU   CVTXTNT2+52                                              00297000
CVTRV409 EQU   CVTXTNT2+53                                              00298000
CVTATCVT EQU   CVTXTNT2+64                                              00299000
CVTRV429 EQU   CVTXTNT2+84                                              00300000
CVTRV438 EQU   CVTXTNT2+85                                              00301000
CVTRV457 EQU   CVTXTNT2+112                                             00302000
CVTRV466 EQU   CVTXTNT2+113                                             00303000
CVTFIX   EQU   0                                                        00304000
CVTRELNO EQU   CVTFIX+252                                               00305000
IFGACB   EQU   0                                                        00306000
ACBCOMN  EQU   IFGACB                                                   00307000
ACBLENG  EQU   ACBCOMN+2                                                00308000
ACBLENG2 EQU   ACBLENG                                                  00309000
ACBAMBL  EQU   ACBCOMN+4                                                00310000
ACBIXLST EQU   ACBAMBL                                                  00311000
ACBJWA   EQU   ACBIXLST                                                 00312000
ACBMACRF EQU   ACBCOMN+12                                               00313000
ACBMACR1 EQU   ACBMACRF                                                 00314000
ACBADR   EQU   ACBMACR1                                                 00315000
ACBCNV   EQU   ACBMACR1                                                 00316000
ACBMACR2 EQU   ACBMACRF+1                                               00317000
ACBLFB   EQU   ACBCOMN+20                                               00318000
ACBBUFPL EQU   ACBLFB                                                   00319000
ACBRECFM EQU   ACBCOMN+24                                               00320000
ACBCCTYP EQU   ACBCOMN+25                                               00321000
ACBOPT   EQU   ACBCOMN+26                                               00322000
ACBDSORG EQU   ACBOPT                                                   00323000
ACBCROPS EQU   ACBDSORG                                                 00324000
ACBEXLST EQU   ACBCOMN+36                                               00325000
ACBDDNM  EQU   ACBCOMN+40                                               00326000
ACBAMETH EQU   ACBDDNM+3                                                00327000
ACBDEB   EQU   ACBDDNM+5                                                00328000
ACBOFLGS EQU   ACBCOMN+48                                               00329000
ACBEXFG  EQU   ACBOFLGS                                                 00330000
ACBIOSFG EQU   ACBOFLGS                                                 00331000
ACBINFLG EQU   ACBCOMN+50                                               00332000
ACBUJFCB EQU   ACBCOMN+52                                               00333000
ACBWAPTR EQU   ACBUJFCB                                                 00334000
JESCT    EQU   0                                                        00335000
JESWAA   EQU   JESCT+8                                                  00336000
JESSSREQ EQU   JESCT+20                                                 00337000
FORCORE  EQU   0                                                        00338000
DXDSCB   EQU   FORCORE                                                  00339000
DXLBL    EQU   DXDSCB                                                   00340000
DXJBF    EQU   FORCORE+100                                              00341000
DXDAADDR EQU   FORCORE+312                                              00342000
DXDCB    EQU   FORCORE+320                                              00343000
DXCCW    EQU   FORCORE+368                                              00344000
DXCCW1   EQU   DXCCW                                                    00345000
DXCCW5   EQU   DXCCW+32                                                 00346000
DXCCW8   EQU   DXCCW+56                                                 00347000
DXCCW12  EQU   DXCCW+88                                                 00348000
DXXCTL   EQU   FORCORE+472                                              00349000
DXVOLSR  EQU   FORCORE+500                                              00350000
DXVOLSR1 EQU   DXVOLSR                                                  00351000
DXVOLSR2 EQU   DXVOLSR+6                                                00352000
DXVOLSR3 EQU   DXVOLSR+12                                               00353000
DXRESSW  EQU   FORCORE+524                                              00354000
DXTCBADR EQU   FORCORE+532                                              00355000
DXDEBXAD EQU   FORCORE+552                                              00356000
DXUCBSAV EQU   FORCORE+564                                              00357000
DXUDCBAD EQU   FORCORE+568                                              00358000
DXPDCBAD EQU   FORCORE+572                                              00359000
DXATCOM1 EQU   FORCORE+588                                              00360000
DXATGENS EQU   DXATCOM1                                                 00361000
DXATVGIV EQU   DXATGENS                                                 00362000
DXATOUTA EQU   DXATCOM1+2                                               00363000
DXATDACC EQU   DXATCOM1+3                                               00364000
DXATCOM2 EQU   FORCORE+592                                              00365000
DXATEOV  EQU   DXATCOM2                                                 00366000
DXATOPEN EQU   DXATCOM2+1                                               00367000
DXATALL  EQU   DXATCOM2+2                                               00368000
DXATEXC1 EQU   FORCORE+604                                              00369000
DXATEXB1 EQU   DXATEXC1                                                 00370000
DXEXHASP EQU   DXATEXB1                                                 00371000
DXATEXC2 EQU   FORCORE+608                                              00372000
DSECTSIZ EQU   FORCORE+612                                              00373000
IECPREFX EQU   0                                                        00374000
IECEXTPR EQU   IECPREFX+32                                              00375000
IECREGSV EQU   IECEXTPR                                                 00376000
IECUPRML EQU   IECEXTPR+80                                              00377000
IECRESWA EQU   IECEXTPR+84                                              00378000
RWARESWA EQU   0                                                        00379000
RWAPREFX EQU   RWARESWA                                                 00380000
USERPRML EQU   0                                                        00381000
IECRRPL  EQU   0                                                        00382000
RRPLIST  EQU   IECRRPL                                                  00383000
RRFUNCTN EQU   RRPLIST                                                  00384000
RRFLAGS1 EQU   RRPLIST+1                                                00385000
RRFLAGS2 EQU   RRPLIST+2                                                00386000
RRFLAGS3 EQU   RRPLIST+3                                                00387000
RRXRETRY EQU   RRPLIST+12                                               00388000
DSMADTRL EQU   0                                                        00389000
DSMADTW1 EQU   DSMADTRL                                                 00390000
DSMADTB1 EQU   DSMADTW1                                                 00391000
DSMADTB2 EQU   DSMADTW1+1                                               00392000
WTGTABLE EQU   0                                                        00393000
WTGWTOPR EQU   WTGTABLE                                                 00394000
WTG      EQU   0                                                        00395000
WTGAREA  EQU   WTG                                                      00396000
WTGMODNM EQU   WTGAREA                                                  00397000
WTGMODEP EQU   WTGAREA+8                                                00398000
WTGPREFX EQU   WTGAREA+16                                               00399000
WTGPATHS EQU   WTG+30                                                   00400000
WTGENTRY EQU   0                                                        00401000
WTGIDTTR EQU   WTGENTRY                                                 00402000
WTGEID   EQU   WTGIDTTR                                                 00403000
WTGCORE  EQU   WTGENTRY+5                                               00404000
APPNMTBL EQU   0                                                        00405000
APPENTRY EQU   APPNMTBL+4                                               00406000
TCBFIX   EQU   0                                                        00407000
TCBFRS   EQU   TCBFIX                                                   00408000
TCB      EQU   0                                                        00409000
TCBPIE   EQU   TCB+4                                                    00410000
TCBPMASK EQU   TCBPIE                                                   00411000
TCBTIO   EQU   TCB+12                                                   00412000
TCBCMP   EQU   TCB+16                                                   00413000
TCBCMPF  EQU   TCBCMP                                                   00414000
TCBCPP   EQU   TCBCMPF                                                  00415000
TCBSTCC  EQU   TCBCMPF                                                  00416000
TCBCDBL  EQU   TCBCMPF                                                  00417000
TCBCWTO  EQU   TCBCMPF                                                  00418000
TCBCIND  EQU   TCBCMPF                                                  00419000
TCBCMSG  EQU   TCBCMPF                                                  00420000
TCBTRN   EQU   TCB+20                                                   00421000
TCBABF   EQU   TCBTRN                                                   00422000
TCBMSS   EQU   TCB+24                                                   00423000
TCBPKF   EQU   TCB+28                                                   00424000
TCBFLGS  EQU   TCB+29                                                   00425000
TCBFLGS1 EQU   TCBFLGS                                                  00426000
TCBFLGS2 EQU   TCBFLGS+1                                                00427000
TCBFLGS3 EQU   TCBFLGS+2                                                00428000
TCBFLGS4 EQU   TCBFLGS+3                                                00429000
TCBFLGS5 EQU   TCBFLGS+4                                                00430000
TCBABWF  EQU   TCBFLGS5                                                 00431000
TCBJPQ   EQU   TCB+44                                                   00432000
TCBPURGE EQU   TCBJPQ                                                   00433000
TCBGRS   EQU   TCB+48                                                   00434000
TCBFSA   EQU   TCB+112                                                  00435000
TCBTME   EQU   TCB+120                                                  00436000
TCBJSTCB EQU   TCB+124                                                  00437000
TCBTSFLG EQU   TCB+148                                                  00438000
TCBTSTSK EQU   TCBTSFLG                                                 00439000
TCBSTAB  EQU   TCB+160                                                  00440000
TCBNSTAE EQU   TCBSTAB                                                  00441000
TCBTCT   EQU   TCB+164                                                  00442000
TCBTCTGF EQU   TCBTCT                                                   00443000
TCBSCNDY EQU   TCB+172                                                  00444000
TCBNDSP  EQU   TCBSCNDY                                                 00445000
TCBNDSP1 EQU   TCBNDSP+1                                                00446000
TCBNDSP2 EQU   TCBNDSP+2                                                00447000
TCBNDSP3 EQU   TCBNDSP+3                                                00448000
TCBJSCB  EQU   TCB+180                                                  00449000
TCBRECDE EQU   TCBJSCB                                                  00450000
TCBEXT1  EQU   TCB+196                                                  00451000
TCBBITS  EQU   TCB+200                                                  00452000
TCBNDSP4 EQU   TCBBITS                                                  00453000
TCBNDSP5 EQU   TCBBITS+1                                                00454000
TCBFLGS6 EQU   TCBBITS+2                                                00455000
TCBFLGS7 EQU   TCBBITS+3                                                00456000
TCBDAR   EQU   TCB+204                                                  00457000
TCBDARC  EQU   TCBDAR                                                   00458000
TCBEXT2  EQU   TCB+208                                                  00459000
TCBFOE   EQU   TCB+244                                                  00460000
TCBESTAE EQU   TCB+264                                                  00461000
TCBESTRM EQU   TCBESTAE+1                                               00462000
TCBFBYT1 EQU   TCB+276                                                  00463000
TCBFBYT2 EQU   TCB+277                                                  00464000
TCBRV124 EQU   TCB+278                                                  00465000
TCBRV133 EQU   TCB+279                                                  00466000
TCBXTNT2 EQU   0                                                        00467000
TCBGTF   EQU   TCBXTNT2                                                 00468000
TCBTFLG  EQU   TCBGTF                                                   00469000
TCBRV146 EQU   TCBXTNT2+28                                              00470000
TCBRV155 EQU   TCBXTNT2+29                                              00471000
TCBRV164 EQU   TCBXTNT2+30                                              00472000
TCBRV173 EQU   TCBXTNT2+31                                              00473000
TIOT1    EQU   0                                                        00474000
DEBBASIC EQU   0                                                        00475000
DEBTCBAD EQU   DEBBASIC                                                 00476000
DEBDEBAD EQU   DEBBASIC+4                                               00477000
DEBIRBAD EQU   DEBBASIC+8                                               00478000
DEBOFLGS EQU   DEBIRBAD                                                 00479000
DEBOPATB EQU   DEBBASIC+12                                              00480000
DEBFLGS1 EQU   DEBBASIC+14                                              00481000
DEBUSRPG EQU   DEBBASIC+16                                              00482000
DEBRRQ   EQU   DEBBASIC+20                                              00483000
DEBECBAD EQU   DEBRRQ                                                   00484000
DEBDCBAD EQU   DEBBASIC+24                                              00485000
DEBPROTG EQU   DEBDCBAD                                                 00486000
DEBAPPAD EQU   DEBBASIC+28                                              00487000
DEBBASND EQU   DEBBASIC+32                                              00488000
DEBDASD  EQU   0                                                        00489000
DEBUCBAD EQU   DEBDASD                                                  00490000
DEBBINUM EQU   DEBDASD+4                                                00491000
DEBACSMD EQU   0                                                        00492000
DEBVOLSQ EQU   DEBACSMD                                                 00493000
DEBVOLBT EQU   DEBVOLSQ                                                 00494000
DEBDSNM  EQU   DEBACSMD+4                                               00495000
DEBUTSAA EQU   DEBDSNM                                                  00496000
DEBACS01 EQU   0                                                        00497000
DEBDSNAM EQU   DEBACS01                                                 00498000
DEBACS02 EQU   0                                                        00499000
DEBDBLK  EQU   DEBACS02                                                 00500000
DEBACS03 EQU   0                                                        00501000
DEBACS04 EQU   0                                                        00502000
DEBTBFRA EQU   DEBACS04                                                 00503000
DEBTCCWA EQU   DEBACS04+4                                               00504000
DEBACS05 EQU   0                                                        00505000
DEBFUCBA EQU   DEBACS05                                                 00506000
DEBLUCBA EQU   DEBACS05+4                                               00507000
DEBACS06 EQU   0                                                        00508000
DEBACS07 EQU   0                                                        00509000
DEBACS08 EQU   0                                                        00510000
DEBSUBNM EQU   0                                                        00511000
DEB      EQU   0                                                        00512000
DEBAVT   EQU   DEB                                                      00513000
DEBEOEA  EQU   DEBAVT                                                   00514000
DEBEOEAB EQU   DEBEOEA                                                  00515000
DEBSIOA  EQU   DEBAVT+4                                                 00516000
DEBSIOAB EQU   DEBSIOA                                                  00517000
DEBPCIA  EQU   DEBAVT+8                                                 00518000
DEBPCIAB EQU   DEBPCIA                                                  00519000
DEBCEA   EQU   DEBAVT+12                                                00520000
DEBCEAB  EQU   DEBCEA                                                   00521000
DEBXCEA  EQU   DEBAVT+16                                                00522000
DEBXCEAB EQU   DEBXCEA                                                  00523000
DEBPREFX EQU   DEB+20                                                   00524000
DEBXTNP  EQU   DEBPREFX+8                                               00525000
DEBXTN   EQU   0                                                        00526000
DEBXFLG1 EQU   DEBXTN+2                                                 00527000
SSIB     EQU   0                                                        00528000
SSIBFLG1 EQU   SSIB+6                                                   00529000
SSIBSUSE EQU   SSIB+32                                                  00530000
SSOB     EQU   0                                                        00531000
SSOBFUNC EQU   SSOB+6                                                   00532000
SSOBRETN EQU   SSOB+12                                                  00533000
SSOBINDV EQU   SSOB+16                                                  00534000
SSDA     EQU   0                                                        00535000
SSDARESF EQU   SSDA+3                                                   00536000
SSDAJFCB EQU   SSDA+8                                                   00537000
SSREQ    EQU   0                                                        00538000
SWAMGR   EQU   0                                                        00539000
DXCCW1A  EQU   DXCCW1                                                   00540000
CVTS01   EQU   CVTPGSIA                                                 00541000
CVTLPDIA EQU   CVTS01+12                                                00542000
CVTDIRST EQU   CVTLPDIA                                                 00543000
CVTSLIDA EQU   CVTS01+24                                                00544000
CVTCTLFG EQU   CVTS01+50                                                00545000
CVTRV210 EQU   CVTS01+424                                               00546000
CVTRV219 EQU   CVTS01+425                                               00547000
CVTRV228 EQU   CVTS01+426                                               00548000
CVTRV237 EQU   CVTS01+427                                               00549000
CVTMFRTR EQU   CVTS01+452                                               00550000
CVTRV262 EQU   CVTS01+468                                               00551000
CVTRV271 EQU   CVTS01+469                                               00552000
CVTRV280 EQU   CVTS01+470                                               00553000
CVTRV289 EQU   CVTS01+471                                               00554000
CVTGSDA  EQU   CVTS01+600                                               00555000
DXXWTG   EQU   DSECTSIZ                                                 00556000
DXXAREA  EQU   DSECTSIZ+4                                               00557000
DXXMODNM EQU   DXXAREA                                                  00558000
DXXLNG   EQU   DXXAREA+29                                               00559000
DXXENTRY EQU   DXXAREA+32                                               00560000
DXXIDTTR EQU   DXXENTRY                                                 00561000
DXREGSAV EQU   DXCCW8                                                   00562000
DXREG9   EQU   DXREGSAV                                                 00563000
DXREG1   EQU   DXREGSAV+28                                              00564000
DXIDENT  EQU   DXCCW12                                                  00565000
DXCALLID EQU   DXIDENT                                                  00566000
DXRETMOD EQU   DXIDENT+2                                                00567000
@NM00042 EQU   DXXCTL                                                   00568000
DXSAVMOD EQU   @NM00042+2                                               00569000
@NM00043 EQU   DXRESSW                                                  00570000
TIOENTRY EQU   TIOT1+24                                                 00571000
TIOESTTA EQU   TIOENTRY+1                                               00572000
TIOERLOC EQU   TIOENTRY+2                                               00573000
TIOELINK EQU   TIOERLOC+1                                               00574000
TIOESYOT EQU   TIOELINK                                                 00575000
TIOESTTC EQU   TIOENTRY+15                                              00576000
TIOESTTB EQU   TIOENTRY+16                                              00577000
POOLSTAR EQU   TIOENTRY+20                                              00578000
TIOEDEVE EQU   TIOESTTB                                                 00579000
TIOSTTB  EQU   TIOEDEVE                                                 00580000
DEBBAS02 EQU   DEBBASND                                                 00581000
DEBDDS1  EQU   DEBBAS02                                                 00582000
DEBSUCBA EQU   DEBDDS1                                                  00583000
DEBRDCB  EQU   DEBDDS1+4                                                00584000
DEBPDCB  EQU   DEBDDS1+8                                                00585000
DEBWDCB  EQU   DEBDDS1+12                                               00586000
DEBBAS01 EQU   DEBBASND                                                 00587000
DEBISAM  EQU   DEBBAS01                                                 00588000
DEBFIEAD EQU   DEBISAM                                                  00589000
DEBFPEAD EQU   DEBISAM+4                                                00590000
DEBFOEAD EQU   DEBISAM+8                                                00591000
DEBEXPT  EQU   DEBISAM+12                                               00592000
DEBRPSID EQU   DEBEXPT                                                  00593000
DXBTAMX  EQU   DXREG1                                                   00594000
DXDSNAME EQU   DXCCW5                                                   00595000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00596000
DEBEXPTA EQU   DEBEXPT+1                                                00597000
DEBRSV12 EQU   DEBRPSID                                                 00598000
DEBRSV11 EQU   DEBRPSID                                                 00599000
DEBRSV10 EQU   DEBRPSID                                                 00600000
DEBRSV09 EQU   DEBRPSID                                                 00601000
DEBRPSAP EQU   DEBRPSID                                                 00602000
DEBRPSO  EQU   DEBRPSID                                                 00603000
DEBRPSI  EQU   DEBRPSID                                                 00604000
DEBRPSP  EQU   DEBRPSID                                                 00605000
DEBFOEB  EQU   DEBFOEAD+1                                               00606000
DEBNOEE  EQU   DEBFOEAD                                                 00607000
DEBFPEB  EQU   DEBFPEAD+1                                               00608000
DEBNPEE  EQU   DEBFPEAD                                                 00609000
DEBFIEB  EQU   DEBFIEAD+1                                               00610000
DEBNIEE  EQU   DEBFIEAD                                                 00611000
DEBWDCBA EQU   DEBWDCB+1                                                00612000
DEBRSV08 EQU   DEBWDCB                                                  00613000
DEBPDCBA EQU   DEBPDCB+1                                                00614000
DEBRSV07 EQU   DEBPDCB                                                  00615000
DEBRDCBA EQU   DEBRDCB+1                                                00616000
DEBRSV06 EQU   DEBRDCB                                                  00617000
DEBSUCBB EQU   DEBSUCBA+1                                               00618000
DEBSDVM  EQU   DEBSUCBA                                                 00619000
TIOUCBP  EQU   TIOEDEVE+1                                               00620000
TIOVERF  EQU   TIOSTTB                                                  00621000
TIOUNLD  EQU   TIOSTTB                                                  00622000
TIOMNTD  EQU   TIOSTTB                                                  00623000
TIOSETU  EQU   TIOSTTB                                                  00624000
TIOVLSR  EQU   TIOSTTB                                                  00625000
TIOPVIO  EQU   TIOSTTB                                                  00626000
TIOREQD  EQU   TIOSTTB                                                  00627000
TIOUSED  EQU   TIOSTTB                                                  00628000
TIOTFEND EQU   POOLSTAR+16                                              00629000
TIOPSLOT EQU   POOLSTAR+13                                              00630000
TIOPSTTB EQU   POOLSTAR+12                                              00631000
TIOPPOOL EQU   POOLSTAR+4                                               00632000
TIOPNSRT EQU   POOLSTAR+3                                               00633000
@NM00049 EQU   POOLSTAR+2                                               00634000
TIOPNSLT EQU   POOLSTAR+1                                               00635000
@NM00048 EQU   POOLSTAR                                                 00636000
TIOEFSRT EQU   TIOENTRY+17                                              00637000
TIOSVERF EQU   TIOESTTB                                                 00638000
TIOSUNLD EQU   TIOESTTB                                                 00639000
TIOSMNTD EQU   TIOESTTB                                                 00640000
TIOSSETU EQU   TIOESTTB                                                 00641000
TIOSVLSR EQU   TIOESTTB                                                 00642000
TIOSPVIO EQU   TIOESTTB                                                 00643000
TIOSREQD EQU   TIOESTTB                                                 00644000
TIOSUSED EQU   TIOESTTB                                                 00645000
TIOSBALS EQU   TIOESTTC                                                 00646000
TIOSBALP EQU   TIOESTTC                                                 00647000
TIOSVOLS EQU   TIOESTTC                                                 00648000
TIOSVOLP EQU   TIOESTTC                                                 00649000
TIOSAFFS EQU   TIOESTTC                                                 00650000
TIOSAFFP EQU   TIOESTTC                                                 00651000
TIOSDEFR EQU   TIOESTTC                                                 00652000
TIOSDKCR EQU   TIOESTTC                                                 00653000
TIOEJFCB EQU   TIOENTRY+12                                              00654000
TIOEDDNM EQU   TIOENTRY+4                                               00655000
TIOTREM  EQU   TIOELINK                                                 00656000
TIOESSDS EQU   TIOESYOT                                                 00657000
TIOESYIN EQU   TIOELINK                                                 00658000
TIOEQNAM EQU   TIOELINK                                                 00659000
TIOEDYNM EQU   TIOELINK                                                 00660000
TIOTTERM EQU   TIOELINK                                                 00661000
TIOTRV01 EQU   TIOELINK                                                 00662000
TIOSYOUT EQU   TIOELINK                                                 00663000
TIOEWTCT EQU   TIOERLOC                                                 00664000
TIOSDSP2 EQU   TIOESTTA                                                 00665000
TIOSDSP1 EQU   TIOESTTA                                                 00666000
TIOSLABL EQU   TIOESTTA                                                 00667000
TIOSDADS EQU   TIOESTTA                                                 00668000
TIOSJBLB EQU   TIOESTTA                                                 00669000
TIOSPLTS EQU   TIOESTTA                                                 00670000
TIOSPLTP EQU   TIOESTTA                                                 00671000
TIOSLTYP EQU   TIOESTTA                                                 00672000
TIOELNGH EQU   TIOENTRY                                                 00673000
DXRESIND EQU   @NM00043                                                 00674000
DXSAVOFF EQU   @NM00042+7                                               00675000
DXSAVADR EQU   DXSAVMOD+2                                               00676000
DXSAVID  EQU   DXSAVMOD                                                 00677000
DXABCODE EQU   @NM00042                                                 00678000
DXRETCOD EQU   DXIDENT+7                                                00679000
DXRETTTR EQU   DXRETMOD+2                                               00680000
DXRETID  EQU   DXRETMOD                                                 00681000
DXREG0   EQU   DXREGSAV+24                                              00682000
DXREGE   EQU   DXREGSAV+20                                              00683000
DXREGD   EQU   DXREGSAV+16                                              00684000
DXREGC   EQU   DXREGSAV+12                                              00685000
DXREGB   EQU   DXREGSAV+8                                               00686000
DXREGA   EQU   DXREGSAV+4                                               00687000
DXXEND   EQU   DXXAREA+48                                               00688000
DXXLAST  EQU   DXXAREA+40                                               00689000
DXXCORE  EQU   DXXENTRY+5                                               00690000
DXETTR   EQU   DXXIDTTR+2                                               00691000
DXEID    EQU   DXXIDTTR                                                 00692000
DXXPATHS EQU   DXXAREA+30                                               00693000
DXOPCLSW EQU   DXXLNG                                                   00694000
DXXTXTLN EQU   DXXAREA+27                                               00695000
DXXMODSZ EQU   DXXAREA+24                                               00696000
DXXATTRB EQU   DXXAREA+22                                               00697000
@NM00027 EQU   DXXAREA+20                                               00698000
DXXPREFX EQU   DXXAREA+16                                               00699000
@NM00026 EQU   DXXAREA+12                                               00700000
DXXMODEP EQU   DXXAREA+8                                                00701000
DXXMODID EQU   DXXMODNM+6                                               00702000
@NM00025 EQU   DXXMODNM                                                 00703000
DXXWTOPR EQU   DXXWTG                                                   00704000
CVTTPIO  EQU   CVTS01+608                                               00705000
CVTADV   EQU   CVTS01+604                                               00706000
CVTGSDAB EQU   CVTGSDA                                                  00707000
CVTQV3   EQU   CVTS01+596                                               00708000
CVTQV2   EQU   CVTS01+592                                               00709000
CVTQV1   EQU   CVTS01+588                                               00710000
CVTRPT   EQU   CVTS01+584                                               00711000
CVTSSRB  EQU   CVTS01+580                                               00712000
CVTCSDRL EQU   CVTS01+576                                               00713000
CVTEXP1  EQU   CVTS01+572                                               00714000
CVTRMPMT EQU   CVTS01+568                                               00715000
CVTRMPTT EQU   CVTS01+564                                               00716000
CVTVPSA  EQU   CVTS01+560                                               00717000
CVTVSTOP EQU   CVTS01+556                                               00718000
CVTGTFR8 EQU   CVTS01+552                                               00719000
CVTQUIT  EQU   CVTS01+548                                               00720000
CVTVACR  EQU   CVTS01+544                                               00721000
CVTWTCB  EQU   CVTS01+540                                               00722000
CVTSTPRS EQU   CVTS01+536                                               00723000
CVT0PT02 EQU   CVTS01+532                                               00724000
CVTDARCM EQU   CVTS01+528                                               00725000
CVTIRECM EQU   CVTS01+524                                               00726000
CVTJRECM EQU   CVTS01+520                                               00727000
CVTVEMS0 EQU   CVTS01+516                                               00728000
CVTSPFRR EQU   CVTS01+512                                               00729000
CVTRLSTG EQU   CVTS01+508                                               00730000
CVT0TC0A EQU   CVTS01+504                                               00731000
CVTGMBR  EQU   CVTS01+500                                               00732000
CVTLFRM  EQU   CVTS01+496                                               00733000
CVTRMBR  EQU   CVTS01+492                                               00734000
CVTVIOP  EQU   CVTS01+488                                               00735000
CVTRV307 EQU   CVTS01+486                                               00736000
CVTRV306 EQU   CVTS01+484                                               00737000
CVTRV305 EQU   CVTS01+482                                               00738000
CVTRV304 EQU   CVTS01+480                                               00739000
CVTRV303 EQU   CVTS01+478                                               00740000
CVTRV302 EQU   CVTS01+476                                               00741000
CVTRV301 EQU   CVTS01+475                                               00742000
CVTRV300 EQU   CVTS01+474                                               00743000
CVTRV299 EQU   CVTS01+473                                               00744000
CVTRV298 EQU   CVTS01+472                                               00745000
CVTRV297 EQU   CVTRV289                                                 00746000
CVTRV296 EQU   CVTRV289                                                 00747000
CVTRV295 EQU   CVTRV289                                                 00748000
CVTRV294 EQU   CVTRV289                                                 00749000
CVTRV293 EQU   CVTRV289                                                 00750000
CVTRV292 EQU   CVTRV289                                                 00751000
CVTRV291 EQU   CVTRV289                                                 00752000
CVTRV290 EQU   CVTRV289                                                 00753000
CVTRV288 EQU   CVTRV280                                                 00754000
CVTRV287 EQU   CVTRV280                                                 00755000
CVTRV286 EQU   CVTRV280                                                 00756000
CVTRV285 EQU   CVTRV280                                                 00757000
CVTRV284 EQU   CVTRV280                                                 00758000
CVTRV283 EQU   CVTRV280                                                 00759000
CVTRV282 EQU   CVTRV280                                                 00760000
CVTRV281 EQU   CVTRV280                                                 00761000
CVTRV279 EQU   CVTRV271                                                 00762000
CVTRV278 EQU   CVTRV271                                                 00763000
CVTRV277 EQU   CVTRV271                                                 00764000
CVTRV276 EQU   CVTRV271                                                 00765000
CVTRV275 EQU   CVTRV271                                                 00766000
CVTRV274 EQU   CVTRV271                                                 00767000
CVTRV273 EQU   CVTRV271                                                 00768000
CVTRV272 EQU   CVTRV271                                                 00769000
CVTRV270 EQU   CVTRV262                                                 00770000
CVTRV269 EQU   CVTRV262                                                 00771000
CVTRV268 EQU   CVTRV262                                                 00772000
CVTRV267 EQU   CVTRV262                                                 00773000
CVTRV266 EQU   CVTRV262                                                 00774000
CVTRV265 EQU   CVTRV262                                                 00775000
CVTRV264 EQU   CVTRV262                                                 00776000
CVTRV263 EQU   CVTRV262                                                 00777000
CVTVFP   EQU   CVTS01+464                                               00778000
CVTVSI   EQU   CVTS01+460                                               00779000
CVTVPSIB EQU   CVTS01+456                                               00780000
CVTMFACT EQU   CVTMFRTR                                                 00781000
CVTMFCTL EQU   CVTS01+448                                               00782000
CVTPVBP  EQU   CVTS01+444                                               00783000
CVTPWI   EQU   CVTS01+440                                               00784000
CVTRV254 EQU   CVTS01+438                                               00785000
CVTRV253 EQU   CVTS01+436                                               00786000
CVTRV252 EQU   CVTS01+434                                               00787000
CVTRV251 EQU   CVTS01+433                                               00788000
CVTRV250 EQU   CVTS01+432                                               00789000
CVTRV249 EQU   CVTS01+431                                               00790000
CVTRV248 EQU   CVTS01+430                                               00791000
CVTRV247 EQU   CVTS01+429                                               00792000
CVTRV246 EQU   CVTS01+428                                               00793000
CVTRV245 EQU   CVTRV237                                                 00794000
CVTRV244 EQU   CVTRV237                                                 00795000
CVTRV243 EQU   CVTRV237                                                 00796000
CVTRV242 EQU   CVTRV237                                                 00797000
CVTRV241 EQU   CVTRV237                                                 00798000
CVTRV240 EQU   CVTRV237                                                 00799000
CVTRV239 EQU   CVTRV237                                                 00800000
CVTRV238 EQU   CVTRV237                                                 00801000
CVTRV236 EQU   CVTRV228                                                 00802000
CVTRV235 EQU   CVTRV228                                                 00803000
CVTRV234 EQU   CVTRV228                                                 00804000
CVTRV233 EQU   CVTRV228                                                 00805000
CVTRV232 EQU   CVTRV228                                                 00806000
CVTRV231 EQU   CVTRV228                                                 00807000
CVTRV230 EQU   CVTRV228                                                 00808000
CVTRV229 EQU   CVTRV228                                                 00809000
CVTRV227 EQU   CVTRV219                                                 00810000
CVTRV226 EQU   CVTRV219                                                 00811000
CVTRV225 EQU   CVTRV219                                                 00812000
CVTRV224 EQU   CVTRV219                                                 00813000
CVTRV223 EQU   CVTRV219                                                 00814000
CVTRV222 EQU   CVTRV219                                                 00815000
CVTRV221 EQU   CVTRV219                                                 00816000
CVTRV220 EQU   CVTRV219                                                 00817000
CVTRV218 EQU   CVTRV210                                                 00818000
CVTRV217 EQU   CVTRV210                                                 00819000
CVTRV216 EQU   CVTRV210                                                 00820000
CVTRV215 EQU   CVTRV210                                                 00821000
CVTRV214 EQU   CVTRV210                                                 00822000
CVTRV213 EQU   CVTRV210                                                 00823000
CVTRV212 EQU   CVTRV210                                                 00824000
CVTRV211 EQU   CVTRV210                                                 00825000
CVTLCCAT EQU   CVTS01+420                                               00826000
CVTPCCAT EQU   CVTS01+416                                               00827000
CVTIPCRP EQU   CVTS01+412                                               00828000
CVTIPCRI EQU   CVTS01+408                                               00829000
CVTIPCDS EQU   CVTS01+404                                               00830000
CVTAIDVT EQU   CVTS01+400                                               00831000
CVTSSAP  EQU   CVTS01+396                                               00832000
CVTEHCIR EQU   CVTS01+392                                               00833000
CVTEHDEF EQU   CVTS01+388                                               00834000
CVTDAIR  EQU   CVTS01+384                                               00835000
CVTPERFM EQU   CVTS01+380                                               00836000
CVT044R2 EQU   CVTS01+376                                               00837000
CVTFETCH EQU   CVTS01+372                                               00838000
CVTRSTWD EQU   CVTS01+368                                               00839000
CVTSPOST EQU   CVTS01+364                                               00840000
CVTIOBP  EQU   CVTS01+360                                               00841000
CVTASMVT EQU   CVTS01+356                                               00842000
CVTRECRQ EQU   CVTS01+352                                               00843000
CVTWSAC  EQU   CVTS01+348                                               00844000
CVTRV149 EQU   CVTS01+344                                               00845000
CVTWSAL  EQU   CVTS01+340                                               00846000
CVTSPSA  EQU   CVTS01+336                                               00847000
CVTGLMN  EQU   CVTS01+332                                               00848000
CVTVEAC0 EQU   CVTS01+328                                               00849000
CVT062R1 EQU   CVTS01+324                                               00850000
CVTRPOST EQU   CVTS01+320                                               00851000
CVTDQIQE EQU   CVTS01+316                                               00852000
CVTCSD   EQU   CVTS01+312                                               00853000
CVTLKRMA EQU   CVTS01+308                                               00854000
CVTRSPIE EQU   CVTS01+304                                               00855000
CVTRENQ  EQU   CVTS01+300                                               00856000
CVTLQCB  EQU   CVTS01+296                                               00857000
CVTFQCB  EQU   CVTS01+292                                               00858000
CVTQCS01 EQU   CVTS01+288                                               00859000
CVTAPFT  EQU   CVTS01+284                                               00860000
CVTPARRL EQU   CVTS01+280                                               00861000
CVTVWAIT EQU   CVTS01+276                                               00862000
CVTGSPL  EQU   CVTS01+272                                               00863000
CVTLSMQ  EQU   CVTS01+268                                               00864000
CVTGSMQ  EQU   CVTS01+264                                               00865000
CVTEXPRO EQU   CVTS01+260                                               00866000
CVTOPCTP EQU   CVTS01+256                                               00867000
CVTSIC   EQU   CVTS01+252                                               00868000
CVTTPIOS EQU   CVTS01+248                                               00869000
CVTRTMS  EQU   CVTS01+244                                               00870000
CVTSDBF  EQU   CVTS01+240                                               00871000
CVTSCBP  EQU   CVTS01+236                                               00872000
CVTSDMP  EQU   CVTS01+232                                               00873000
CVTSV60  EQU   CVTS01+228                                               00874000
CVTRTMCT EQU   CVTS01+224                                               00875000
CVTASCBL EQU   CVTS01+220                                               00876000
CVTASCBH EQU   CVTS01+216                                               00877000
CVTGDA   EQU   CVTS01+212                                               00878000
CVTASVT  EQU   CVTS01+208                                               00879000
CVTVVMDI EQU   CVTS01+204                                               00880000
CVTAQTOP EQU   CVTS01+200                                               00881000
CVTIOSCS EQU   CVTS01+196                                               00882000
CVTSDRM  EQU   CVTS01+192                                               00883000
CVTOPTE  EQU   CVTS01+188                                               00884000
CVTSTXU  EQU   CVTS01+184                                               00885000
CVTQUIS  EQU   CVTS01+180                                               00886000
CVTPARS  EQU   CVTS01+176                                               00887000
CVTS1EE  EQU   CVTS01+172                                               00888000
CVTFRAS  EQU   CVTS01+168                                               00889000
CVTQSAS  EQU   CVTS01+164                                               00890000
CVTCRAS  EQU   CVTS01+160                                               00891000
CVTCRMN  EQU   CVTS01+156                                               00892000
CVTDELCP EQU   CVTS01+152                                               00893000
CVTFRECL EQU   CVTS01+148                                               00894000
CVTGETCL EQU   CVTS01+144                                               00895000
CVTBLDCP EQU   CVTS01+140                                               00896000
CVTAUTHL EQU   CVTS01+136                                               00897000
CVTSCAN  EQU   CVTS01+132                                               00898000
CVTRV144 EQU   CVTS01+130                                               00899000
CVTMAXMP EQU   CVTS01+128                                               00900000
CVTSTCK  EQU   CVTS01+124                                               00901000
CVTRV139 EQU   CVTS01+123                                               00902000
CVTDSSAC EQU   CVTS01+122                                               00903000
CVTRV513 EQU   CVTS01+121                                               00904000
CVTIOSPL EQU   CVTS01+120                                               00905000
CVTPTGT  EQU   CVTS01+116                                               00906000
CVTCSPIE EQU   CVTS01+112                                               00907000
CVTSMFEX EQU   CVTS01+108                                               00908000
CVTOLT0A EQU   CVTS01+104                                               00909000
CVTSRBRT EQU   CVTS01+100                                               00910000
CVTPUTL  EQU   CVTS01+96                                                00911000
CVTRV519 EQU   CVTS01+92                                                00912000
CVTRV327 EQU   CVTS01+88                                                00913000
CVTRV326 EQU   CVTS01+84                                                00914000
CVTRV325 EQU   CVTS01+80                                                00915000
CVTRV324 EQU   CVTS01+76                                                00916000
CVT0VL01 EQU   CVTS01+72                                                00917000
CVTSHRVM EQU   CVTS01+68                                                00918000
CVTRV332 EQU   CVTS01+64                                                00919000
CVTTAS   EQU   CVTS01+60                                                00920000
CVTRSCN  EQU   CVTS01+56                                                00921000
CVTTRAC2 EQU   CVTS01+54                                                00922000
CVTTRACE EQU   CVTS01+52                                                00923000
CVTAPG   EQU   CVTS01+51                                                00924000
CVTSDTRC EQU   CVTCTLFG                                                 00925000
CVTGTRCE EQU   CVTCTLFG                                                 00926000
CVTNOMP  EQU   CVTCTLFG                                                 00927000
CVTRSV79 EQU   CVTCTLFG                                                 00928000
CVTDSTAT EQU   CVTCTLFG                                                 00929000
CVTRSV78 EQU   CVTCTLFG                                                 00930000
CVTRV333 EQU   CVTCTLFG                                                 00931000
CVTRV323 EQU   CVTCTLFG                                                 00932000
CVTSPVLK EQU   CVTS01+49                                                00933000
CVTRSV77 EQU   CVTS01+48                                                00934000
CVTRV331 EQU   CVTS01+44                                                00935000
CVTRV330 EQU   CVTS01+40                                                00936000
CVTRV329 EQU   CVTS01+36                                                00937000
CVTRV328 EQU   CVTS01+32                                                00938000
CVTRV322 EQU   CVTS01+28                                                00939000
CVTSLID  EQU   CVTSLIDA+1                                               00940000
CVTSYLK  EQU   CVTSLIDA                                                 00941000
CVTRV321 EQU   CVTS01+20                                                00942000
CVTRV320 EQU   CVTS01+16                                                00943000
CVTLPDIR EQU   CVTLPDIA+1                                               00944000
CVTRSV69 EQU   CVTDIRST                                                 00945000
CVTRSV68 EQU   CVTDIRST                                                 00946000
CVTRSV67 EQU   CVTDIRST                                                 00947000
CVTRSV66 EQU   CVTDIRST                                                 00948000
CVTRSV65 EQU   CVTDIRST                                                 00949000
CVTRSV64 EQU   CVTDIRST                                                 00950000
CVTRSV63 EQU   CVTDIRST                                                 00951000
CVTDICOM EQU   CVTDIRST                                                 00952000
CVTPVTP  EQU   CVTS01+8                                                 00953000
CVTLPDSR EQU   CVTS01+4                                                 00954000
CVTGETL  EQU   CVTS01                                                   00955000
SSDASSCM EQU   SSDA+16                                                  00956000
SSDADEBP EQU   SSDA+12                                                  00957000
SSDABUFR EQU   SSDA+4                                                   00958000
@NM00055 EQU   SSDARESF                                                 00959000
SSDADEFR EQU   SSDARESF                                                 00960000
SSDAAUTO EQU   SSDARESF                                                 00961000
SSDARESV EQU   SSDA+2                                                   00962000
SSDALEN  EQU   SSDA                                                     00963000
SSOBSSIB EQU   SSOB+8                                                   00964000
SSOBLEN  EQU   SSOB+4                                                   00965000
SSOBID   EQU   SSOB                                                     00966000
SSIBRSV1 EQU   SSIB+28                                                  00967000
SSIBDEST EQU   SSIB+20                                                  00968000
SSIBJBID EQU   SSIB+12                                                  00969000
SSIBSSNM EQU   SSIB+8                                                   00970000
SSIBRESV EQU   SSIB+7                                                   00971000
@NM00054 EQU   SSIBFLG1                                                 00972000
SSIBPJES EQU   SSIBFLG1                                                 00973000
SSIBLEN  EQU   SSIB+4                                                   00974000
SSIBID   EQU   SSIB                                                     00975000
DEBXRV40 EQU   DEBXTN+28                                                00976000
DEBXRV39 EQU   DEBXTN+24                                                00977000
DEBXXARG EQU   DEBXTN+20                                                00978000
DEBXMCF2 EQU   DEBXTN+19                                                00979000
DEBXMCF1 EQU   DEBXTN+18                                                00980000
DEBXDSO2 EQU   DEBXTN+17                                                00981000
DEBXDSO1 EQU   DEBXTN+16                                                00982000
DEBXDBPR EQU   DEBXTN+12                                                00983000
DEBXDCBM EQU   DEBXTN+8                                                 00984000
DEBXDSAB EQU   DEBXTN+4                                                 00985000
DEBXRV48 EQU   DEBXTN+3                                                 00986000
DEBXRV47 EQU   DEBXFLG1                                                 00987000
DEBXRV46 EQU   DEBXFLG1                                                 00988000
DEBXRV45 EQU   DEBXFLG1                                                 00989000
DEBXRV44 EQU   DEBXFLG1                                                 00990000
DEBXRV43 EQU   DEBXFLG1                                                 00991000
DEBXRV42 EQU   DEBXFLG1                                                 00992000
DEBXTSKC EQU   DEBXFLG1                                                 00993000
DEBXCDCB EQU   DEBXFLG1                                                 00994000
DEBXLNGH EQU   DEBXTN                                                   00995000
DEBTBLOF EQU   DEBPREFX+14                                              00996000
DEBAMTYP EQU   DEBPREFX+13                                              00997000
DEBLNGTH EQU   DEBPREFX+12                                              00998000
DEBDCBMK EQU   DEBXTNP                                                  00999000
DEBDSCBA EQU   DEBPREFX+1                                               01000000
DEBWKARA EQU   DEBPREFX                                                 01001000
DEBXCEAD EQU   DEBXCEA+1                                                01002000
DEBXCENP EQU   DEBXCEAB                                                 01003000
DEBRSV35 EQU   DEBXCEAB                                                 01004000
DEBRSV34 EQU   DEBXCEAB                                                 01005000
DEBRSV33 EQU   DEBXCEAB                                                 01006000
DEBRSV32 EQU   DEBXCEAB                                                 01007000
DEBCEAD  EQU   DEBCEA+1                                                 01008000
DEBCENP  EQU   DEBCEAB                                                  01009000
DEBRSV31 EQU   DEBCEAB                                                  01010000
DEBRSV30 EQU   DEBCEAB                                                  01011000
DEBRSV29 EQU   DEBCEAB                                                  01012000
DEBRSV28 EQU   DEBCEAB                                                  01013000
DEBPCIAD EQU   DEBPCIA+1                                                01014000
DEBPCINP EQU   DEBPCIAB                                                 01015000
DEBRSV27 EQU   DEBPCIAB                                                 01016000
DEBRSV26 EQU   DEBPCIAB                                                 01017000
DEBRSV25 EQU   DEBPCIAB                                                 01018000
DEBRSV24 EQU   DEBPCIAB                                                 01019000
DEBSIOAD EQU   DEBSIOA+1                                                01020000
DEBSIONP EQU   DEBSIOAB                                                 01021000
DEBFIX   EQU   DEBSIOAB                                                 01022000
DEBIOVR  EQU   DEBSIOAB                                                 01023000
DEBSIOX  EQU   DEBSIOAB                                                 01024000
DEBPGFX  EQU   DEBSIOAB                                                 01025000
DEBEOEAD EQU   DEBEOEA+1                                                01026000
DEBEOENP EQU   DEBEOEAB                                                 01027000
DEBRSV22 EQU   DEBEOEAB                                                 01028000
DEBRSV21 EQU   DEBEOEAB                                                 01029000
DEBRSV20 EQU   DEBEOEAB                                                 01030000
DEBRSV19 EQU   DEBEOEAB                                                 01031000
DEBSUBID EQU   DEBSUBNM                                                 01032000
DEBSIOA2 EQU   DEBACS08+24                                              01033000
DEBRPSIO EQU   DEBACS08+20                                              01034000
DEBFREED EQU   DEBACS08+16                                              01035000
@NM00053 EQU   DEBACS08+12                                              01036000
@NM00052 EQU   DEBACS08+8                                               01037000
DEBDISAD EQU   DEBACS08+4                                               01038000
@NM00051 EQU   DEBACS08                                                 01039000
DEBRPSST EQU   DEBACS07+64                                              01040000
DEBARECK EQU   DEBACS07+60                                              01041000
DEBAREWT EQU   DEBACS07+56                                              01042000
DEBACHK  EQU   DEBACS07+52                                              01043000
DEBAWRIT EQU   DEBACS07+48                                              01044000
DEBASETL EQU   DEBACS07+44                                              01045000
DEBAREAD EQU   DEBACS07+40                                              01046000
DEBCRECK EQU   DEBACS07+36                                              01047000
DEBCREWT EQU   DEBACS07+32                                              01048000
DEBCCHK  EQU   DEBACS07+28                                              01049000
DEBCWRIT EQU   DEBACS07+24                                              01050000
DEBCSETL EQU   DEBACS07+20                                              01051000
DEBCREAD EQU   DEBACS07+16                                              01052000
DEBWKPT5 EQU   DEBACS07+12                                              01053000
DEBWKPT4 EQU   DEBACS07+8                                               01054000
DEBGET   EQU   DEBACS07+4                                               01055000
@NM00050 EQU   DEBACS07                                                 01056000
DEBPUT   EQU   DEBACS06+4                                               01057000
DEBDCBFA EQU   DEBACS06                                                 01058000
DEBLUCBB EQU   DEBLUCBA+1                                               01059000
DEBRSV18 EQU   DEBLUCBA                                                 01060000
DEBFUCBB EQU   DEBFUCBA+1                                               01061000
DEBRSV17 EQU   DEBFUCBA                                                 01062000
DEBTCCWB EQU   DEBTCCWA+1                                               01063000
DEBRSV16 EQU   DEBTCCWA                                                 01064000
DEBTBFRB EQU   DEBTBFRA+1                                               01065000
DEBRSV15 EQU   DEBTBFRA                                                 01066000
DEBDBPEF EQU   DEBACS03+8                                               01067000
DEBDBPP  EQU   DEBACS03+4                                               01068000
DEBDTPP  EQU   DEBACS03                                                 01069000
DEBDBPE  EQU   DEBDBLK+1                                                01070000
DEBDBPT  EQU   DEBDBLK                                                  01071000
DEBEXTNM EQU   DEBDSNAM                                                 01072000
DEBRSV14 EQU   DEBDSNM+4                                                01073000
DEBUTSAB EQU   DEBUTSAA+1                                               01074000
DEBRSV13 EQU   DEBUTSAA                                                 01075000
DEBVOLNM EQU   DEBACSMD+2                                               01076000
DEBVLSEQ EQU   DEBVOLSQ+1                                               01077000
DEBRSV42 EQU   DEBVOLBT                                                 01078000
DEBRSV41 EQU   DEBVOLBT                                                 01079000
DEBRSV40 EQU   DEBVOLBT                                                 01080000
DEBRSV39 EQU   DEBVOLBT                                                 01081000
DEBRSV38 EQU   DEBVOLBT                                                 01082000
DEBRSV37 EQU   DEBVOLBT                                                 01083000
DEBRSV36 EQU   DEBVOLBT                                                 01084000
DEBEXFUL EQU   DEBVOLBT                                                 01085000
DEBNMTRK EQU   DEBDASD+14                                               01086000
DEBENDHH EQU   DEBDASD+12                                               01087000
DEBENDCC EQU   DEBDASD+10                                               01088000
DEBSTRHH EQU   DEBDASD+8                                                01089000
DEBSTRCC EQU   DEBDASD+6                                                01090000
DEBUCBA  EQU   DEBUCBAD+1                                               01091000
DEBDVMOD EQU   DEBUCBAD                                                 01092000
DEBAPPB  EQU   DEBAPPAD+1                                               01093000
DEBEXSCL EQU   DEBAPPAD                                                 01094000
DEBDCBB  EQU   DEBDCBAD+1                                               01095000
DEBDEBID EQU   DEBPROTG                                                 01096000
DEBECBB  EQU   DEBECBAD+1                                               01097000
DEBPRIOR EQU   DEBECBAD                                                 01098000
DEBUSRPB EQU   DEBUSRPG+1                                               01099000
DEBNMEXT EQU   DEBUSRPG                                                 01100000
DEBRSV05 EQU   DEBBASIC+15                                              01101000
DEBXTNIN EQU   DEBFLGS1                                                 01102000
DEBAPFIN EQU   DEBFLGS1                                                 01103000
DEBF1CEV EQU   DEBFLGS1                                                 01104000
DEBCINDI EQU   DEBFLGS1                                                 01105000
DEBRSV02 EQU   DEBFLGS1                                                 01106000
DEBRSV01 EQU   DEBFLGS1                                                 01107000
DEBEOFDF EQU   DEBFLGS1                                                 01108000
DEBPWCKD EQU   DEBFLGS1                                                 01109000
DEBQSCNT EQU   DEBBASIC+13                                              01110000
DEBACCS  EQU   DEBOPATB                                                 01111000
DEBPOSIT EQU   DEBOPATB                                                 01112000
DEBZERO  EQU   DEBOPATB                                                 01113000
DEBABEND EQU   DEBOPATB                                                 01114000
DEBIRBB  EQU   DEBIRBAD+1                                               01115000
DEBRERR  EQU   DEBOFLGS                                                 01116000
DEBLABEL EQU   DEBOFLGS                                                 01117000
DEBSPLIT EQU   DEBOFLGS                                                 01118000
DEBDCB   EQU   DEBOFLGS                                                 01119000
DEBRLSE  EQU   DEBOFLGS                                                 01120000
DEBEOF   EQU   DEBOFLGS                                                 01121000
DEBDISP  EQU   DEBOFLGS                                                 01122000
DEBDEBB  EQU   DEBDEBAD+1                                               01123000
DEBAMLNG EQU   DEBDEBAD                                                 01124000
DEBTCBB  EQU   DEBTCBAD+1                                               01125000
DEBNMSUB EQU   DEBTCBAD                                                 01126000
TIOCSTEP EQU   TIOT1+8                                                  01127000
TIOCNJOB EQU   TIOT1                                                    01128000
@NM00047 EQU   TCBXTNT2+32                                              01129000
TCBRV181 EQU   TCBRV173                                                 01130000
TCBRV180 EQU   TCBRV173                                                 01131000
TCBRV179 EQU   TCBRV173                                                 01132000
TCBRV178 EQU   TCBRV173                                                 01133000
TCBRV177 EQU   TCBRV173                                                 01134000
TCBRV176 EQU   TCBRV173                                                 01135000
TCBRV175 EQU   TCBRV173                                                 01136000
TCBRV174 EQU   TCBRV173                                                 01137000
TCBRV172 EQU   TCBRV164                                                 01138000
TCBRV171 EQU   TCBRV164                                                 01139000
TCBRV170 EQU   TCBRV164                                                 01140000
TCBRV169 EQU   TCBRV164                                                 01141000
TCBRV168 EQU   TCBRV164                                                 01142000
TCBRV167 EQU   TCBRV164                                                 01143000
TCBRV166 EQU   TCBRV164                                                 01144000
TCBRV165 EQU   TCBRV164                                                 01145000
TCBRV163 EQU   TCBRV155                                                 01146000
TCBRV162 EQU   TCBRV155                                                 01147000
TCBRV161 EQU   TCBRV155                                                 01148000
TCBRV160 EQU   TCBRV155                                                 01149000
TCBRV159 EQU   TCBRV155                                                 01150000
TCBRV158 EQU   TCBRV155                                                 01151000
TCBRV157 EQU   TCBRV155                                                 01152000
TCBRV156 EQU   TCBRV155                                                 01153000
TCBRV154 EQU   TCBRV146                                                 01154000
TCBRV153 EQU   TCBRV146                                                 01155000
TCBRV152 EQU   TCBRV146                                                 01156000
TCBRV151 EQU   TCBRV146                                                 01157000
TCBRV150 EQU   TCBRV146                                                 01158000
TCBRV149 EQU   TCBRV146                                                 01159000
TCBRV148 EQU   TCBRV146                                                 01160000
TCBRV147 EQU   TCBRV146                                                 01161000
TCBRV145 EQU   TCBXTNT2+26                                              01162000
TCBRV144 EQU   TCBXTNT2+24                                              01163000
TCBRV143 EQU   TCBXTNT2+20                                              01164000
TCBRV142 EQU   TCBXTNT2+16                                              01165000
TCBRSV49 EQU   TCBXTNT2+12                                              01166000
TCBRSV48 EQU   TCBXTNT2+8                                               01167000
TCBRCMP  EQU   TCBXTNT2+5                                               01168000
TCBRSVAB EQU   TCBXTNT2+4                                               01169000
TCBGTFA  EQU   TCBGTF+1                                                 01170000
TCBRSV47 EQU   TCBTFLG                                                  01171000
TCBRSV46 EQU   TCBTFLG                                                  01172000
TCBRSV45 EQU   TCBTFLG                                                  01173000
TCBRSV44 EQU   TCBTFLG                                                  01174000
TCBRSV43 EQU   TCBTFLG                                                  01175000
TCBDSPIT EQU   TCBTFLG                                                  01176000
TCBERRTN EQU   TCBTFLG                                                  01177000
TCBASYNC EQU   TCBTFLG                                                  01178000
@NM00046 EQU   TCB+296                                                  01179000
TCBSCBQ  EQU   TCB+292                                                  01180000
TCBSWASA EQU   TCB+288                                                  01181000
TCBDBTB  EQU   TCB+284                                                  01182000
TCBRPT   EQU   TCB+280                                                  01183000
TCBRV141 EQU   TCBRV133                                                 01184000
TCBRV140 EQU   TCBRV133                                                 01185000
TCBRV139 EQU   TCBRV133                                                 01186000
TCBRV138 EQU   TCBRV133                                                 01187000
TCBRV137 EQU   TCBRV133                                                 01188000
TCBRV136 EQU   TCBRV133                                                 01189000
TCBRV135 EQU   TCBRV133                                                 01190000
TCBRV134 EQU   TCBRV133                                                 01191000
TCBRV132 EQU   TCBRV124                                                 01192000
TCBRV131 EQU   TCBRV124                                                 01193000
TCBRV130 EQU   TCBRV124                                                 01194000
TCBRV129 EQU   TCBRV124                                                 01195000
TCBRV128 EQU   TCBRV124                                                 01196000
TCBRV127 EQU   TCBRV124                                                 01197000
TCBRV126 EQU   TCBRV124                                                 01198000
TCBRV125 EQU   TCBRV124                                                 01199000
TCBRV123 EQU   TCBFBYT2                                                 01200000
TCBRV122 EQU   TCBFBYT2                                                 01201000
TCBECBNV EQU   TCBFBYT2                                                 01202000
TCBSSSYN EQU   TCBFBYT2                                                 01203000
TCBFPRAP EQU   TCBFBYT2                                                 01204000
TCBFDW   EQU   TCBFBYT2                                                 01205000
TCBFMW   EQU   TCBFBYT2                                                 01206000
TCBCNCB  EQU   TCBFBYT2                                                 01207000
TCBLLH   EQU   TCBFBYT1                                                 01208000
TCBRV113 EQU   TCBFBYT1                                                 01209000
TCBEOT   EQU   TCBFBYT1                                                 01210000
TCBRTM2  EQU   TCBFBYT1                                                 01211000
TCBPGNLY EQU   TCBFBYT1                                                 01212000
TCBNDIOS EQU   TCBFBYT1                                                 01213000
TCBACTIV EQU   TCBFBYT1                                                 01214000
TCBEOTFM EQU   TCBFBYT1                                                 01215000
TCBAFFN  EQU   TCB+274                                                  01216000
TCBCCPVI EQU   TCB+272                                                  01217000
TCBUKYSP EQU   TCB+268                                                  01218000
TCBMODE  EQU   TCBESTAE+3                                               01219000
TCBERTYP EQU   TCBESTAE+2                                               01220000
TCBRV314 EQU   TCBESTRM                                                 01221000
TCBRV313 EQU   TCBESTRM                                                 01222000
TCBRV312 EQU   TCBESTRM                                                 01223000
TCBRV311 EQU   TCBESTRM                                                 01224000
TCBRV310 EQU   TCBESTRM                                                 01225000
TCBRV309 EQU   TCBESTRM                                                 01226000
TCBRV308 EQU   TCBESTRM                                                 01227000
TCBETERM EQU   TCBESTRM                                                 01228000
TCBSCBKY EQU   TCBESTAE                                                 01229000
TCBRTM12 EQU   TCB+260                                                  01230000
TCBTCBID EQU   TCB+256                                                  01231000
TCBRSV96 EQU   TCB+252                                                  01232000
TCBSWA   EQU   TCB+248                                                  01233000
TCBFOEA  EQU   TCBFOE+1                                                 01234000
TCBRSV42 EQU   TCBFOE                                                   01235000
TCBRV306 EQU   TCB+240                                                  01236000
TCBRSV41 EQU   TCB+239                                                  01237000
TCBTID   EQU   TCB+238                                                  01238000
TCBRSVAA EQU   TCB+237                                                  01239000
TCBABCUR EQU   TCB+236                                                  01240000
TCBTMSAV EQU   TCB+232                                                  01241000
TCBIOTIM EQU   TCB+228                                                  01242000
TCBRTWA  EQU   TCB+224                                                  01243000
TCBBACK  EQU   TCB+220                                                  01244000
TCBTIRB  EQU   TCB+216                                                  01245000
TCBAECB  EQU   TCB+212                                                  01246000
TCBEXT2A EQU   TCBEXT2+1                                                01247000
TCBRSV39 EQU   TCBEXT2                                                  01248000
TCBSTMCT EQU   TCB+207                                                  01249000
TCBSYSCT EQU   TCB+206                                                  01250000
TCBRSV37 EQU   TCB+205                                                  01251000
TCBEXSVC EQU   TCBDAR                                                   01252000
TCBRSV36 EQU   TCBDAR                                                   01253000
TCBDARWT EQU   TCBDAR                                                   01254000
TCBDARO  EQU   TCBDAR                                                   01255000
TCBDARMC EQU   TCBDARC                                                  01256000
TCBDARD  EQU   TCBDAR                                                   01257000
TCBDARS  EQU   TCBDAR                                                   01258000
TCBDARP  EQU   TCBDAR                                                   01259000
TCBGTOFM EQU   TCBFLGS7                                                 01260000
TCBADMP  EQU   TCBFLGS7                                                 01261000
TCBRSTSK EQU   TCBFLGS7                                                 01262000
TCBRSV35 EQU   TCBFLGS7                                                 01263000
TCBSTACK EQU   TCBFLGS7                                                 01264000
TCBRSV34 EQU   TCBFLGS7                                                 01265000
TCBRSV33 EQU   TCBFLGS7                                                 01266000
TCBGPECB EQU   TCBFLGS7                                                 01267000
TCBNTJS  EQU   TCBFLGS6                                                 01268000
TCBAPG   EQU   TCBFLGS6                                                 01269000
TCBMIGR  EQU   TCBFLGS6                                                 01270000
TCBRV303 EQU   TCBFLGS6                                                 01271000
TCBSPVLK EQU   TCBFLGS6                                                 01272000
TCBCPU   EQU   TCBFLGS6                                                 01273000
TCBPIE17 EQU   TCBFLGS6                                                 01274000
TCBRV    EQU   TCBFLGS6                                                 01275000
TCBRSV79 EQU   TCBNDSP5                                                 01276000
TCBRSV78 EQU   TCBNDSP5                                                 01277000
TCBRSV77 EQU   TCBNDSP5                                                 01278000
TCBRSV76 EQU   TCBNDSP5                                                 01279000
TCBRSV75 EQU   TCBNDSP5                                                 01280000
TCBRSV74 EQU   TCBNDSP5                                                 01281000
TCBRSV95 EQU   TCBNDSP5                                                 01282000
TCBRSV94 EQU   TCBNDSP5                                                 01283000
TCBRSV93 EQU   TCBNDSP4                                                 01284000
TCBRSV92 EQU   TCBNDSP4                                                 01285000
TCBRSV91 EQU   TCBNDSP4                                                 01286000
TCBRSV90 EQU   TCBNDSP4                                                 01287000
TCBRSV89 EQU   TCBNDSP4                                                 01288000
TCBRSV88 EQU   TCBNDSP4                                                 01289000
TCBRSV87 EQU   TCBNDSP4                                                 01290000
TCBRSV86 EQU   TCBNDSP4                                                 01291000
TCBEXT1A EQU   TCBEXT1+1                                                01292000
TCBRSV32 EQU   TCBEXT1                                                  01293000
TCBEXCPD EQU   TCB+192                                                  01294000
TCBIOBRC EQU   TCB+188                                                  01295000
TCBDDWTC EQU   TCB+186                                                  01296000
TCBDDEXC EQU   TCB+184                                                  01297000
TCBJSCBB EQU   TCBJSCB+1                                                01298000
@NM00045 EQU   TCBRECDE                                                 01299000
TCBREC   EQU   TCBRECDE                                                 01300000
TCBMDIDS EQU   TCB+176                                                  01301000
TCBNDINT EQU   TCBNDSP3                                                 01302000
TCBRSV27 EQU   TCBNDSP3                                                 01303000
TCBRSV26 EQU   TCBNDSP3                                                 01304000
TCBRSV25 EQU   TCBNDSP3                                                 01305000
TCBRSV24 EQU   TCBNDSP3                                                 01306000
TCBSRBND EQU   TCBNDSP3                                                 01307000
TCBRV302 EQU   TCBNDSP3                                                 01308000
TCBLJSND EQU   TCBNDSP3                                                 01309000
TCBABE   EQU   TCBNDSP2                                                 01310000
TCBDSS   EQU   TCBNDSP2                                                 01311000
TCBOWAIT EQU   TCBNDSP2                                                 01312000
TCBIWAIT EQU   TCBNDSP2                                                 01313000
TCBNDTS  EQU   TCBNDSP2                                                 01314000
TCBNDSVC EQU   TCBNDSP2                                                 01315000
TCBSTPP  EQU   TCBNDSP2                                                 01316000
TCBABD   EQU   TCBNDSP2                                                 01317000
TCBRSV22 EQU   TCBNDSP1                                                 01318000
TCBPIEND EQU   TCBNDSP1                                                 01319000
TCBTPSP  EQU   TCBNDSP1                                                 01320000
TCBDDRND EQU   TCBNDSP1                                                 01321000
TCBRSPND EQU   TCBNDSP1                                                 01322000
TCBRSTND EQU   TCBNDSP1                                                 01323000
TCBDARPN EQU   TCBNDSP1                                                 01324000
TCBDARTN EQU   TCBNDSP1                                                 01325000
TCBNDSP0 EQU   TCBNDSP                                                  01326000
TCBUSER  EQU   TCB+168                                                  01327000
TCBTCTB  EQU   TCBTCT+1                                                 01328000
TCBRSV9C EQU   TCBTCTGF                                                 01329000
TCBRSV9B EQU   TCBTCTGF                                                 01330000
TCBRSV9A EQU   TCBTCTGF                                                 01331000
TCBRSV99 EQU   TCBTCTGF                                                 01332000
TCBRSV98 EQU   TCBTCTGF                                                 01333000
TCBRSV97 EQU   TCBTCTGF                                                 01334000
TCBRSV20 EQU   TCBTCTGF                                                 01335000
TCBSMFGF EQU   TCBTCTGF                                                 01336000
TCBSTABB EQU   TCBSTAB+1                                                01337000
TCBSTCUR EQU   TCBNSTAE                                                 01338000
TCBRV301 EQU   TCBNSTAE                                                 01339000
TCBSYNCH EQU   TCBNSTAE                                                 01340000
TCBHALT  EQU   TCBNSTAE                                                 01341000
TCBPPSUP EQU   TCBNSTAE                                                 01342000
TCB33E   EQU   TCBNSTAE                                                 01343000
TCBQUIES EQU   TCBNSTAE                                                 01344000
TCBSTABE EQU   TCBNSTAE                                                 01345000
TCBAQE   EQU   TCB+156                                                  01346000
TCBPQE   EQU   TCB+152                                                  01347000
TCBTSDP  EQU   TCB+151                                                  01348000
TCBTSLP  EQU   TCB+150                                                  01349000
TCBSTPCT EQU   TCB+149                                                  01350000
TCBCPUBN EQU   TCBTSFLG                                                 01351000
TCBDYDSP EQU   TCBTSFLG                                                 01352000
TCBRSV18 EQU   TCBTSFLG                                                 01353000
TCBRSV17 EQU   TCBTSFLG                                                 01354000
TCBTIOTG EQU   TCBTSFLG                                                 01355000
TCBATT   EQU   TCBTSFLG                                                 01356000
TCBSTPPR EQU   TCBTSFLG                                                 01357000
TCBRV300 EQU   TCBTSTSK                                                 01358000
TCBECB   EQU   TCB+144                                                  01359000
TCBIQE   EQU   TCB+140                                                  01360000
TCBLTC   EQU   TCB+136                                                  01361000
TCBOTC   EQU   TCB+132                                                  01362000
TCBNTC   EQU   TCB+128                                                  01363000
TCBJSTCA EQU   TCBJSTCB+1                                               01364000
TCBRSV16 EQU   TCBJSTCB                                                 01365000
TCBTQET  EQU   TCBTME                                                   01366000
TCBTCB   EQU   TCB+116                                                  01367000
TCBFSAB  EQU   TCBFSA+1                                                 01368000
TCBQEL   EQU   TCBFSA                                                   01369000
TCBGRS15 EQU   TCBGRS+60                                                01370000
TCBGRS14 EQU   TCBGRS+56                                                01371000
TCBGRS13 EQU   TCBGRS+52                                                01372000
TCBGRS12 EQU   TCBGRS+48                                                01373000
TCBGRS11 EQU   TCBGRS+44                                                01374000
TCBGRS10 EQU   TCBGRS+40                                                01375000
TCBGRS9  EQU   TCBGRS+36                                                01376000
TCBGRS8  EQU   TCBGRS+32                                                01377000
TCBGRS7  EQU   TCBGRS+28                                                01378000
TCBGRS6  EQU   TCBGRS+24                                                01379000
TCBGRS5  EQU   TCBGRS+20                                                01380000
TCBGRS4  EQU   TCBGRS+16                                                01381000
TCBGRS3  EQU   TCBGRS+12                                                01382000
TCBGRS2  EQU   TCBGRS+8                                                 01383000
TCBGRS1  EQU   TCBGRS+4                                                 01384000
TCBGRS0  EQU   TCBGRS                                                   01385000
TCBJPQB  EQU   TCBJPQ+1                                                 01386000
TCBRSV15 EQU   TCBPURGE                                                 01387000
TCBRSV14 EQU   TCBPURGE                                                 01388000
TCBRSV13 EQU   TCBPURGE                                                 01389000
TCBRSV12 EQU   TCBPURGE                                                 01390000
TCBRSV11 EQU   TCBPURGE                                                 01391000
TCBRSV10 EQU   TCBPURGE                                                 01392000
TCBRSV09 EQU   TCBPURGE                                                 01393000
TCBJPQF  EQU   TCBPURGE                                                 01394000
TCBJLB   EQU   TCB+40                                                   01395000
TCBLLS   EQU   TCB+36                                                   01396000
TCBDSP   EQU   TCB+35                                                   01397000
TCBLMP   EQU   TCB+34                                                   01398000
TCBPNDSP EQU   TCBFLGS5                                                 01399000
TCBFCD1  EQU   TCBFLGS5                                                 01400000
TCBSTP   EQU   TCBFLGS5                                                 01401000
TCBSYS   EQU   TCBFLGS5                                                 01402000
TCBANDSP EQU   TCBFLGS5                                                 01403000
TCBPAGE  EQU   TCBFLGS5                                                 01404000
TCBUXNDF EQU   TCBABWF                                                  01405000
TCBFC    EQU   TCBFLGS5                                                 01406000
TCBONDSP EQU   TCBFLGS4                                                 01407000
TCBMPCND EQU   TCBFLGS4                                                 01408000
TCBMPCVQ EQU   TCBFLGS4                                                 01409000
TCBUXNDV EQU   TCBFLGS4                                                 01410000
TCBHNDSP EQU   TCBFLGS4                                                 01411000
TCBRQENA EQU   TCBFLGS4                                                 01412000
TCBSER   EQU   TCBFLGS4                                                 01413000
TCBNDUMP EQU   TCBFLGS4                                                 01414000
TCBDWSTA EQU   TCBFLGS3                                                 01415000
TCBRSV08 EQU   TCBFLGS3                                                 01416000
TCBRSV07 EQU   TCBFLGS3                                                 01417000
TCBRSV06 EQU   TCBFLGS3                                                 01418000
TCBABGM  EQU   TCBFLGS3                                                 01419000
TCBABTRM EQU   TCBFLGS3                                                 01420000
TCBADINP EQU   TCBFLGS3                                                 01421000
TCBFSM   EQU   TCBFLGS3                                                 01422000
TCBFTS   EQU   TCBFLGS2                                                 01423000
TCBFETXR EQU   TCBFLGS2                                                 01424000
TCBFDSOP EQU   TCBFLGS2                                                 01425000
TCBFJMC  EQU   TCBFLGS2                                                 01426000
TCBFSMC  EQU   TCBFLGS2                                                 01427000
TCBFABOP EQU   TCBFLGS2                                                 01428000
TCBFSTI  EQU   TCBFLGS2                                                 01429000
TCBFOINP EQU   TCBFLGS2                                                 01430000
TCBFX    EQU   TCBFLGS1                                                 01431000
TCBFS    EQU   TCBFLGS1                                                 01432000
TCBFT    EQU   TCBFLGS1                                                 01433000
TCBPDUMP EQU   TCBFLGS1                                                 01434000
TCBRSV04 EQU   TCBFLGS1                                                 01435000
TCBFERA  EQU   TCBFLGS1                                                 01436000
TCBFE    EQU   TCBFLGS1                                                 01437000
TCBFA    EQU   TCBFLGS1                                                 01438000
TCBZERO  EQU   TCBPKF                                                   01439000
TCBFLAG  EQU   TCBPKF                                                   01440000
TCBMSSB  EQU   TCBMSS+1                                                 01441000
TCBRSV03 EQU   TCBMSS                                                   01442000
TCBTRNB  EQU   TCBTRN+1                                                 01443000
TCBRSV02 EQU   TCBABF                                                   01444000
TCBOLTEP EQU   TCBABF                                                   01445000
TCBTCP   EQU   TCBABF                                                   01446000
TCBTCPP  EQU   TCBABF                                                   01447000
TCBRSV01 EQU   TCBABF                                                   01448000
TCBGRPH  EQU   TCBABF                                                   01449000
TCBNOCHK EQU   TCBABF                                                   01450000
TCBMOD91 EQU   TCBABF                                                   01451000
TCBCMPC  EQU   TCBCMP+1                                                 01452000
TCBRV318 EQU   TCBCMSG                                                  01453000
TCBRV317 EQU   TCBCIND                                                  01454000
TCBRV316 EQU   TCBCWTO                                                  01455000
TCBCASID EQU   TCBCDBL                                                  01456000
TCBNOCC  EQU   TCBSTCC                                                  01457000
TCBDMPO  EQU   TCBCPP                                                   01458000
TCBCSTEP EQU   TCBCMPF                                                  01459000
TCBCREQ  EQU   TCBCMPF                                                  01460000
TCBDEB   EQU   TCB+8                                                    01461000
TCBPIEA  EQU   TCBPIE+1                                                 01462000
TCBPM    EQU   TCBPMASK                                                 01463000
@NM00044 EQU   TCBPMASK                                                 01464000
TCBRBP   EQU   TCB                                                      01465000
TCBFRS6  EQU   TCBFRS+24                                                01466000
TCBFRS4  EQU   TCBFRS+16                                                01467000
TCBFRS2  EQU   TCBFRS+8                                                 01468000
TCBFRS0  EQU   TCBFRS                                                   01469000
APPNAMID EQU   APPNMTBL+24                                              01470000
APPOFFST EQU   APPENTRY+2                                               01471000
APPCOUNT EQU   APPENTRY                                                 01472000
APPSIZE  EQU   APPNMTBL+2                                               01473000
APPBAL   EQU   APPNMTBL                                                 01474000
WTGETTR  EQU   WTGIDTTR+2                                               01475000
WTGOPD   EQU   WTGPATHS+1                                               01476000
WTGRECHK EQU   WTGPATHS+1                                               01477000
WTGTSENQ EQU   WTGPATHS+1                                               01478000
@NM00041 EQU   WTGPATHS+1                                               01479000
WTGTRACE EQU   WTGPATHS+1                                               01480000
@NM00040 EQU   WTGPATHS                                                 01481000
WTGJFCBW EQU   WTGPATHS                                                 01482000
WTGSMF   EQU   WTGPATHS                                                 01483000
WTGTCOS  EQU   WTGPATHS                                                 01484000
WTGNSL   EQU   WTGPATHS                                                 01485000
WTGPRLSE EQU   WTGPATHS                                                 01486000
WTGLNG   EQU   WTG+29                                                   01487000
WTGTXTLN EQU   WTGAREA+27                                               01488000
WTGMODSZ EQU   WTGAREA+24                                               01489000
WTGATTRB EQU   WTGAREA+22                                               01490000
@NM00039 EQU   WTGAREA+20                                               01491000
@NM00038 EQU   WTGAREA+12                                               01492000
WTGMODID EQU   WTGMODNM+6                                               01493000
@NM00037 EQU   WTGMODNM                                                 01494000
DSMADTW6 EQU   DSMADTRL+20                                              01495000
DSMADTW5 EQU   DSMADTRL+16                                              01496000
DSMADTW4 EQU   DSMADTRL+12                                              01497000
DSMADTW3 EQU   DSMADTRL+8                                               01498000
DSMADTW2 EQU   DSMADTRL+4                                               01499000
DSMADTB4 EQU   DSMADTW1+3                                               01500000
DSMADTB3 EQU   DSMADTW1+2                                               01501000
@NM00036 EQU   DSMADTB2                                                 01502000
DSMDSNE  EQU   DSMADTB2                                                 01503000
DSMTIOTE EQU   DSMADTB2                                                 01504000
DSMSMCE  EQU   DSMADTB2                                                 01505000
DSMVTOCR EQU   DSMADTB2                                                 01506000
DSMASWAP EQU   DSMADTB1                                                 01507000
DSMUCBAL EQU   DSMADTB1                                                 01508000
DSMRPSAP EQU   DSMADTB1                                                 01509000
DSMLOCK  EQU   DSMADTB1                                                 01510000
@NM00035 EQU   DSMADTB1                                                 01511000
DSMVIO   EQU   DSMADTB1                                                 01512000
DSMISAM  EQU   DSMADTB1                                                 01513000
RRFWORK  EQU   RRPLIST+20                                               01514000
RRMLRTRY EQU   RRPLIST+16                                               01515000
RRUCBPTR EQU   RRXRETRY                                                 01516000
RR1RETRY EQU   RRPLIST+8                                                01517000
RR1WRKAR EQU   RRPLIST+4                                                01518000
@NM00034 EQU   RRFLAGS3                                                 01519000
RRFTERM  EQU   RRFLAGS3                                                 01520000
RRFFCEXC EQU   RRFLAGS3                                                 01521000
RRFFINFC EQU   RRFLAGS3                                                 01522000
RRFNRTCA EQU   RRFLAGS3                                                 01523000
@NM00033 EQU   RRFLAGS3                                                 01524000
RRFENQUL EQU   RRFLAGS2                                                 01525000
RRFPRDET EQU   RRFLAGS2                                                 01526000
@NM00032 EQU   RRFLAGS2                                                 01527000
RRFQMNGR EQU   RRFLAGS2                                                 01528000
RRFENQPW EQU   RRFLAGS2                                                 01529000
@NM00031 EQU   RRFLAGS2                                                 01530000
RRFFIN1  EQU   RRFLAGS2                                                 01531000
RRFTRACE EQU   RRFLAGS1                                                 01532000
RRFSMF   EQU   RRFLAGS1                                                 01533000
RRFNSL   EQU   RRFLAGS1                                                 01534000
RRFAMSTR EQU   RRFLAGS1                                                 01535000
RRFAMEXR EQU   RRFLAGS1                                                 01536000
RRFAMEXG EQU   RRFLAGS1                                                 01537000
RRFUSREX EQU   RRFLAGS1                                                 01538000
@NM00030 EQU   RRFLAGS1                                                 01539000
RRFRJFCB EQU   RRFUNCTN                                                 01540000
RRFDADSM EQU   RRFUNCTN                                                 01541000
DXDCBLST EQU   USERPRML                                                 01542000
RWALIST  EQU   RWARESWA+12                                              01543000
RWAPARM  EQU   RWAPREFX+8                                               01544000
RWATRBUF EQU   RWAPREFX+4                                               01545000
RWATRACE EQU   RWAPREFX                                                 01546000
IECQMNGR EQU   IECEXTPR+92                                              01547000
IECMSGQA EQU   IECEXTPR+88                                              01548000
IECDCBNO EQU   IECUPRML                                                 01549000
IECRRPRM EQU   IECEXTPR+76                                              01550000
IECWTGTB EQU   IECEXTPR+72                                              01551000
IECCORP2 EQU   IECPREFX+28                                              01552000
IECCORP1 EQU   IECPREFX+24                                              01553000
IECCORPS EQU   IECPREFX+20                                              01554000
IECCORSP EQU   IECPREFX+19                                              01555000
@NM00029 EQU   IECPREFX+17                                              01556000
IECCORKY EQU   IECPREFX+16                                              01557000
IECCORAD EQU   IECPREFX+12                                              01558000
IECCORLN EQU   IECPREFX+8                                               01559000
@NM00028 EQU   IECPREFX+4                                               01560000
IECCORID EQU   IECPREFX                                                 01561000
DXATEXB2 EQU   DXATEXC2                                                 01562000
DXATCOM4 EQU   FORCORE+600                                              01563000
DXATCOM3 EQU   FORCORE+596                                              01564000
@NM00024 EQU   DXATCOM2+3                                               01565000
@NM00023 EQU   DXATALL                                                  01566000
DXATSWAP EQU   DXATALL                                                  01567000
DXATFC   EQU   DXATALL                                                  01568000
@NM00022 EQU   DXATOPEN                                                 01569000
DXATDFIN EQU   DXATOPEN                                                 01570000
DXATDSIN EQU   DXATOPEN                                                 01571000
DXATMODM EQU   DXATOPEN                                                 01572000
DXATMODE EQU   DXATOPEN                                                 01573000
DXATMODS EQU   DXATOPEN                                                 01574000
DXATIGN  EQU   DXATOPEN                                                 01575000
DXATVCAT EQU   DXATEOV                                                  01576000
DXATDADM EQU   DXATEOV                                                  01577000
DXATREMT EQU   DXATEOV                                                  01578000
DXATDNEW EQU   DXATEOV                                                  01579000
DXATDFRE EQU   DXATEOV                                                  01580000
DXATDCHN EQU   DXATEOV                                                  01581000
DXATNVOL EQU   DXATEOV                                                  01582000
DXATCCAT EQU   DXATEOV                                                  01583000
DXATRDDB EQU   DXATDACC                                                 01584000
DXATEOF  EQU   DXATDACC                                                 01585000
@NM00021 EQU   DXATDACC                                                 01586000
DXATSMF  EQU   DXATDACC                                                 01587000
DXATUPDB EQU   DXATDACC                                                 01588000
DXATDRCT EQU   DXATDACC                                                 01589000
DXATTRAK EQU   DXATDACC                                                 01590000
DXATF1CE EQU   DXATDACC                                                 01591000
DXATNSL  EQU   DXATOUTA                                                 01592000
DXATTTM2 EQU   DXATOUTA                                                 01593000
DXATTTM1 EQU   DXATOUTA                                                 01594000
DXATTRL2 EQU   DXATOUTA                                                 01595000
DXATTRL1 EQU   DXATOUTA                                                 01596000
DXATDATM EQU   DXATOUTA                                                 01597000
DXATHDTM EQU   DXATOUTA                                                 01598000
DXATVLHD EQU   DXATOUTA                                                 01599000
DXATCLOS EQU   DXATCOM1+1                                               01600000
DXATSRET EQU   DXATGENS                                                 01601000
DXATVCIG EQU   DXATVGIV                                                 01602000
DXATVTMG EQU   DXATVGIV                                                 01603000
DXATVSMG EQU   DXATVGIV                                                 01604000
DXATJFCB EQU   DXATGENS                                                 01605000
DXATDISP EQU   DXATGENS                                                 01606000
DXATREFR EQU   DXATGENS                                                 01607000
DXATDMCT EQU   DXATGENS                                                 01608000
DXMSGADR EQU   FORCORE+584                                              01609000
DXPRPARC EQU   FORCORE+580                                              01610000
DXUDCBML EQU   FORCORE+578                                              01611000
DXUDCBPL EQU   FORCORE+576                                              01612000
DXPACBAD EQU   DXPDCBAD+1                                               01613000
@NM00020 EQU   DXPDCBAD                                                 01614000
DXUACBAD EQU   DXUDCBAD+1                                               01615000
@NM00019 EQU   DXUDCBAD                                                 01616000
DXUCBSVV EQU   DXUCBSAV+1                                               01617000
@NM00018 EQU   DXUCBSAV                                                 01618000
DXUCBADR EQU   FORCORE+560                                              01619000
DXTIOTAD EQU   FORCORE+556                                              01620000
DXDSAB   EQU   FORCORE+548                                              01621000
DXDSABAD EQU   FORCORE+544                                              01622000
DXDSABQD EQU   FORCORE+540                                              01623000
DXJSCBAD EQU   FORCORE+536                                              01624000
DXASCBAD EQU   FORCORE+528                                              01625000
DXEXTSW  EQU   FORCORE+527                                              01626000
DXUKEY   EQU   FORCORE+526                                              01627000
DXWKEYSV EQU   FORCORE+525                                              01628000
DXUNITOF EQU   FORCORE+522                                              01629000
DXNOUNIT EQU   FORCORE+520                                              01630000
DXVOLSEQ EQU   FORCORE+518                                              01631000
DXVOLMT3 EQU   DXVOLSR3                                                 01632000
DXVOLMT2 EQU   DXVOLSR2                                                 01633000
DXVOLMT1 EQU   DXVOLSR1                                                 01634000
DXWORK4  EQU   FORCORE+496                                              01635000
DXWORK3  EQU   FORCORE+492                                              01636000
DXWORK2  EQU   FORCORE+488                                              01637000
DXWORK1  EQU   FORCORE+484                                              01638000
DXWORK   EQU   FORCORE+480                                              01639000
@NM00017 EQU   FORCORE+464                                              01640000
DXCCW11  EQU   DXCCW+80                                                 01641000
DXCCW10  EQU   DXCCW+72                                                 01642000
DXCCW9   EQU   DXCCW+64                                                 01643000
DXCCW7   EQU   DXCCW+48                                                 01644000
DXCCW6   EQU   DXCCW+40                                                 01645000
DXCCW4   EQU   DXCCW+24                                                 01646000
DXCCW3   EQU   DXCCW+16                                                 01647000
DXCCW2   EQU   DXCCW+8                                                  01648000
DXDCBDEB EQU   DXDCB+44                                                 01649000
@NM00016 EQU   DXDCB+24                                                 01650000
DXDEBDCB EQU   DXDCB+20                                                 01651000
@NM00015 EQU   DXDCB                                                    01652000
DXDEB    EQU   DXDAADDR+4                                               01653000
@NM00014 EQU   DXDAADDR                                                 01654000
DXIOB    EQU   FORCORE+280                                              01655000
DXECB    EQU   FORCORE+276                                              01656000
DSCCORE  EQU   FORCORE+96                                               01657000
JESPJESN EQU   JESCT+28                                                 01658000
JESSSCT  EQU   JESCT+24                                                 01659000
JESRESQM EQU   JESCT+16                                                 01660000
JESQMGR  EQU   JESCT+12                                                 01661000
JESUNITS EQU   JESCT+4                                                  01662000
@NM00013 EQU   JESCT                                                    01663000
ACBAPID  EQU   ACBCOMN+72                                               01664000
ACBCBMWA EQU   ACBCOMN+68                                               01665000
ACBUAPTR EQU   ACBCOMN+64                                               01666000
ACBLRECL EQU   ACBCOMN+62                                               01667000
ACBBLKSZ EQU   ACBCOMN+60                                               01668000
ACBBUFSP EQU   ACBCOMN+56                                               01669000
@NM00012 EQU   ACBWAPTR+1                                               01670000
ACBOPTN  EQU   ACBWAPTR                                                 01671000
ACBCAT   EQU   ACBINFLG                                                 01672000
ACBIJRQE EQU   ACBINFLG                                                 01673000
ACBJEPS  EQU   ACBINFLG                                                 01674000
@NM00011 EQU   ACBINFLG                                                 01675000
ACBERFLG EQU   ACBCOMN+49                                               01676000
ACBBUSY  EQU   ACBIOSFG                                                 01677000
ACBLOCK  EQU   ACBEXFG                                                  01678000
@NM00010 EQU   ACBOFLGS                                                 01679000
ACBDSERR EQU   ACBOFLGS                                                 01680000
ACBOPEN  EQU   ACBOFLGS                                                 01681000
ACBEOV   EQU   ACBOFLGS                                                 01682000
@NM00009 EQU   ACBOFLGS                                                 01683000
ACBERFL  EQU   ACBDDNM+4                                                01684000
ACBAM    EQU   ACBAMETH                                                 01685000
ACBINFL  EQU   ACBDDNM+2                                                01686000
ACBTIOT  EQU   ACBDDNM                                                  01687000
ACBUEL   EQU   ACBEXLST                                                 01688000
ACBPASSW EQU   ACBCOMN+32                                               01689000
@NM00008 EQU   ACBCOMN+28                                               01690000
@NM00007 EQU   ACBDSORG+1                                               01691000
ACBDORGA EQU   ACBDSORG+1                                               01692000
@NM00006 EQU   ACBDSORG                                                 01693000
ACBCRNRE EQU   ACBCROPS                                                 01694000
ACBCRNCK EQU   ACBCROPS                                                 01695000
ACBASA   EQU   ACBCCTYP                                                 01696000
@NM00005 EQU   ACBCCTYP                                                 01697000
ACBRECAF EQU   ACBRECFM                                                 01698000
ACBJBUF  EQU   ACBBUFPL+2                                               01699000
@NM00004 EQU   ACBBUFPL                                                 01700000
ACBBUFNI EQU   ACBCOMN+18                                               01701000
ACBBUFND EQU   ACBCOMN+16                                               01702000
ACBSTRNO EQU   ACBCOMN+14                                               01703000
@NM00003 EQU   ACBMACR2                                                 01704000
ACBLOGON EQU   ACBMACR2                                                 01705000
ACBSKP   EQU   ACBMACR2                                                 01706000
ACBCHN   EQU   ACBMACR2                                                 01707000
ACBCBRD  EQU   ACBMACR2                                                 01708000
ACBCBOPN EQU   ACBMACR2                                                 01709000
ACBUBF   EQU   ACBMACR1                                                 01710000
ACBOUT   EQU   ACBMACR1                                                 01711000
ACBIN    EQU   ACBMACR1                                                 01712000
ACBDIR   EQU   ACBMACR1                                                 01713000
ACBSEQ   EQU   ACBMACR1                                                 01714000
ACBBLK   EQU   ACBCNV                                                   01715000
ACBADD   EQU   ACBADR                                                   01716000
ACBKEY   EQU   ACBMACR1                                                 01717000
ACBINRTN EQU   ACBCOMN+8                                                01718000
ACBIBCT  EQU   ACBJWA                                                   01719000
ACBLEN2  EQU   ACBLENG2                                                 01720000
ACBSTYP  EQU   ACBCOMN+1                                                01721000
ACBID    EQU   ACBCOMN                                                  01722000
CVTLEVL  EQU   CVTRELNO+2                                               01723000
CVTNUMB  EQU   CVTRELNO                                                 01724000
CVTMDL   EQU   CVTFIX+250                                               01725000
@NM00002 EQU   CVTFIX+248                                               01726000
@NM00001 EQU   CVTFIX                                                   01727000
CVTRV482 EQU   CVTXTNT2+128                                             01728000
CVTRV481 EQU   CVTXTNT2+124                                             01729000
CVTRV480 EQU   CVTXTNT2+120                                             01730000
CVTRV479 EQU   CVTXTNT2+118                                             01731000
CVTRV478 EQU   CVTXTNT2+117                                             01732000
CVTRV477 EQU   CVTXTNT2+116                                             01733000
CVTRV476 EQU   CVTXTNT2+115                                             01734000
CVTRV475 EQU   CVTXTNT2+114                                             01735000
CVTRV474 EQU   CVTRV466                                                 01736000
CVTRV473 EQU   CVTRV466                                                 01737000
CVTRV472 EQU   CVTRV466                                                 01738000
CVTRV471 EQU   CVTRV466                                                 01739000
CVTRV470 EQU   CVTRV466                                                 01740000
CVTRV469 EQU   CVTRV466                                                 01741000
CVTRV468 EQU   CVTRV466                                                 01742000
CVTRV467 EQU   CVTRV466                                                 01743000
CVTRV465 EQU   CVTRV457                                                 01744000
CVTRV464 EQU   CVTRV457                                                 01745000
CVTRV463 EQU   CVTRV457                                                 01746000
CVTRV462 EQU   CVTRV457                                                 01747000
CVTRV461 EQU   CVTRV457                                                 01748000
CVTRV460 EQU   CVTRV457                                                 01749000
CVTRV459 EQU   CVTRV457                                                 01750000
CVTRV458 EQU   CVTRV457                                                 01751000
CVTRV456 EQU   CVTXTNT2+108                                             01752000
CVTRV455 EQU   CVTXTNT2+104                                             01753000
CVTRV454 EQU   CVTXTNT2+100                                             01754000
CVTRV453 EQU   CVTXTNT2+96                                              01755000
CVTRV452 EQU   CVTXTNT2+94                                              01756000
CVTRV451 EQU   CVTXTNT2+92                                              01757000
CVTRV450 EQU   CVTXTNT2+90                                              01758000
CVTRV449 EQU   CVTXTNT2+88                                              01759000
CVTRV448 EQU   CVTXTNT2+87                                              01760000
CVTRV447 EQU   CVTXTNT2+86                                              01761000
CVTRV446 EQU   CVTRV438                                                 01762000
CVTRV445 EQU   CVTRV438                                                 01763000
CVTRV444 EQU   CVTRV438                                                 01764000
CVTRV443 EQU   CVTRV438                                                 01765000
CVTRV442 EQU   CVTRV438                                                 01766000
CVTRV441 EQU   CVTRV438                                                 01767000
CVTRV440 EQU   CVTRV438                                                 01768000
CVTRV439 EQU   CVTRV438                                                 01769000
CVTRV437 EQU   CVTRV429                                                 01770000
CVTRV436 EQU   CVTRV429                                                 01771000
CVTRV435 EQU   CVTRV429                                                 01772000
CVTRV434 EQU   CVTRV429                                                 01773000
CVTRV433 EQU   CVTRV429                                                 01774000
CVTRV432 EQU   CVTRV429                                                 01775000
CVTRV431 EQU   CVTRV429                                                 01776000
CVTRV430 EQU   CVTRV429                                                 01777000
CVTRV428 EQU   CVTXTNT2+80                                              01778000
CVTRV427 EQU   CVTXTNT2+76                                              01779000
CVTRV426 EQU   CVTXTNT2+72                                              01780000
CVTRV425 EQU   CVTXTNT2+68                                              01781000
CVTATACT EQU   CVTATCVT                                                 01782000
CVTRV423 EQU   CVTXTNT2+62                                              01783000
CVTRV422 EQU   CVTXTNT2+60                                              01784000
CVTRV421 EQU   CVTXTNT2+58                                              01785000
CVTRV420 EQU   CVTXTNT2+56                                              01786000
CVTRV419 EQU   CVTXTNT2+55                                              01787000
CVTRV418 EQU   CVTXTNT2+54                                              01788000
CVTRV417 EQU   CVTRV409                                                 01789000
CVTRV416 EQU   CVTRV409                                                 01790000
CVTRV415 EQU   CVTRV409                                                 01791000
CVTRV414 EQU   CVTRV409                                                 01792000
CVTRV413 EQU   CVTRV409                                                 01793000
CVTRV412 EQU   CVTRV409                                                 01794000
CVTRV411 EQU   CVTRV409                                                 01795000
CVTRV410 EQU   CVTRV409                                                 01796000
CVTRV408 EQU   CVTRV400                                                 01797000
CVTRV407 EQU   CVTRV400                                                 01798000
CVTRV406 EQU   CVTRV400                                                 01799000
CVTRV405 EQU   CVTRV400                                                 01800000
CVTRV404 EQU   CVTRV400                                                 01801000
CVTRV403 EQU   CVTRV400                                                 01802000
CVTRV402 EQU   CVTRV400                                                 01803000
CVTRV401 EQU   CVTRV400                                                 01804000
CVTRSVA1 EQU   CVTXTNT2+48                                              01805000
CVTRSVA0 EQU   CVTXTNT2+44                                              01806000
CVTRSV99 EQU   CVTXTNT2+40                                              01807000
CVTRSV98 EQU   CVTXTNT2+36                                              01808000
CVTRSV97 EQU   CVTXTNT2+34                                              01809000
CVTRSV96 EQU   CVTXTNT2+32                                              01810000
CVTOLTEP EQU   CVTXTNT2+28                                              01811000
CVTQIDA  EQU   CVTQID+1                                                 01812000
CVTRSV95 EQU   CVTQID                                                   01813000
CVTRSV94 EQU   CVTXTNT2+20                                              01814000
CVTRSV93 EQU   CVTXTNT2+16                                              01815000
CVTRSV92 EQU   CVTXTNT2+12                                              01816000
CVTDEBVR EQU   CVTXTNT2+8                                               01817000
CVTRSV91 EQU   CVTXTNT2+6                                               01818000
CVTRSV9H EQU   CVTRSV90                                                 01819000
CVTRSV9G EQU   CVTRSV90                                                 01820000
CVTRSV9F EQU   CVTRSV90                                                 01821000
CVTRSV9E EQU   CVTRSV90                                                 01822000
CVTRSV9D EQU   CVTRSV90                                                 01823000
CVTRSV9C EQU   CVTRSV90                                                 01824000
CVTRSV9B EQU   CVTRSV90                                                 01825000
CVTRSV9A EQU   CVTRSV90                                                 01826000
CVTNUCLS EQU   CVTXTNT2+4                                               01827000
CVTDSSVA EQU   CVTDSSV+1                                                01828000
CVTRSV89 EQU   CVTDSSV                                                  01829000
CVTRSV88 EQU   CVTXTNT1+8                                               01830000
CVTRSV87 EQU   CVTXTNT1+4                                               01831000
CVTFACHN EQU   CVTXTNT1                                                 01832000
CVTRV488 EQU   CVTMAP+412                                               01833000
CVTRV487 EQU   CVTMAP+408                                               01834000
CVTRV486 EQU   CVTMAP+404                                               01835000
CVTRV485 EQU   CVTMAP+400                                               01836000
CVTRV484 EQU   CVTMAP+396                                               01837000
CVTAUTH  EQU   CVTMAP+392                                               01838000
CVTATMCA EQU   CVTATMCT+1                                               01839000
CVTATMST EQU   CVTATMCT                                                 01840000
CVTRSV61 EQU   CVTMAP+384                                               01841000
CVTVOLT1 EQU   CVTVOLM1+1                                               01842000
CVTVOLI1 EQU   CVTVOLF1                                                 01843000
CVTSTOA  EQU   CVTMAP+376                                               01844000
CVTRSV58 EQU   CVTMAP+374                                               01845000
CVTRSV57 EQU   CVTMAP+372                                               01846000
CVTDDCE  EQU   CVTMAP+368                                               01847000
CVTPNWFR EQU   CVTMAP+364                                               01848000
CVTSMF   EQU   CVTMAP+360                                               01849000
CVTSULK  EQU   CVTMAP+358                                               01850000
CVTSLKO  EQU   CVTSYSK                                                  01851000
CVTSLKP  EQU   CVTSYSK                                                  01852000
CVTSLKQ  EQU   CVTSYSK                                                  01853000
CVTSLKR  EQU   CVTSYSK                                                  01854000
CVTRSV56 EQU   CVTSYSK                                                  01855000
CVTRSV55 EQU   CVTSYSK                                                  01856000
CVTRSV54 EQU   CVTSYSK                                                  01857000
CVTRSV53 EQU   CVTSYSK                                                  01858000
CVTRSV52 EQU   CVTA1F1                                                  01859000
CVTRSV51 EQU   CVTA1F1                                                  01860000
CVTRSV50 EQU   CVTA1F1                                                  01861000
CVTRSV49 EQU   CVTA1F1                                                  01862000
CVTRSV48 EQU   CVTA1F1                                                  01863000
CVTRSV47 EQU   CVTA1F1                                                  01864000
CVTSRSW  EQU   CVTA1F1                                                  01865000
CVTPFSW  EQU   CVTA1F1                                                  01866000
CVTPCVT  EQU   CVTMAP+352                                               01867000
CVTRSV46 EQU   CVTMAP+344                                               01868000
CVTRSV45 EQU   CVTMAP+340                                               01869000
CVTRSV44 EQU   CVTMAP+338                                               01870000
CVTRSV43 EQU   CVTMAP+336                                               01871000
CVTHJESA EQU   CVTHJES+1                                                01872000
CVTRSV42 EQU   CVTHJES                                                  01873000
CVTEXT2A EQU   CVTEXT2+1                                                01874000
CVTRSV41 EQU   CVTEXT2                                                  01875000
CVTAPFA  EQU   CVTAPF+1                                                 01876000
CVTRSV40 EQU   CVTAPF                                                   01877000
CVTRV518 EQU   CVTINTLA                                                 01878000
CVTRV517 EQU   CVTERPV                                                  01879000
CVTEORM  EQU   CVTMAP+312                                               01880000
CVTMCHPR EQU   CVTMAP+308                                               01881000
CVTTZ    EQU   CVTMAP+304                                               01882000
CVTJEPS  EQU   CVTMAP+300                                               01883000
CVTMODE  EQU   CVTMAP+292                                               01884000
CVTPTRV  EQU   CVTMAP+288                                               01885000
CVTREAL  EQU   CVTMAP+284                                               01886000
CVTRSV39 EQU   CVTMAP+280                                               01887000
CVTRSV38 EQU   CVTMAP+276                                               01888000
CVTDMSRA EQU   CVTDMSR+1                                                01889000
CVTRSV37 EQU   CVTDMSR                                                  01890000
CVTQMSGA EQU   CVTQMSG+1                                                01891000
CVTRSV36 EQU   CVTQMSG                                                  01892000
CVTAMFF  EQU   CVTMAP+264                                               01893000
CVTPURGA EQU   CVTPURG+1                                                01894000
CVTRSV35 EQU   CVTPURG                                                  01895000
CVTCBSP  EQU   CVTMAP+256                                               01896000
CVTATERA EQU   CVTATER+1                                                01897000
CVTSYST  EQU   CVTATER                                                  01898000
CVTVOLT2 EQU   CVTTAT                                                   01899000
CVTVOLI2 EQU   CVTVOLF2                                                 01900000
CVTAQAVB EQU   CVTAQAVT+1                                               01901000
CVTRSV34 EQU   CVTTCMFG                                                 01902000
CVTRSV33 EQU   CVTTCMFG                                                 01903000
CVTRSV32 EQU   CVTTCMFG                                                 01904000
CVTRSV31 EQU   CVTTCMFG                                                 01905000
CVTRSV30 EQU   CVTTCMFG                                                 01906000
CVTRSV29 EQU   CVTTCMFG                                                 01907000
CVTRSV28 EQU   CVTTCMFG                                                 01908000
CVTTCRDY EQU   CVTTCMFG                                                 01909000
CVTGTFA  EQU   CVTGTF+1                                                 01910000
CVTRSV27 EQU   CVTGTFST                                                 01911000
CVTRNIO  EQU   CVTGTFST                                                 01912000
CVTRV319 EQU   CVTUSR                                                   01913000
CVTRV318 EQU   CVTFORM                                                  01914000
CVTRV317 EQU   CVTTMODE                                                 01915000
CVTRV316 EQU   CVTSTATE                                                 01916000
CVTRV315 EQU   CVTGTFS                                                  01917000
CVTGTFAV EQU   CVTGTFS                                                  01918000
CVT0SCR1 EQU   CVTMAP+232                                               01919000
CVTRV515 EQU   CVTMAP+228                                               01920000
CVTRMS   EQU   CVTMAP+224                                               01921000
CVTPATCH EQU   CVTMAP+220                                               01922000
CVTTSCE  EQU   CVTMAP+216                                               01923000
CVTLNKSC EQU   CVTMAP+214                                               01924000
CVTQABST EQU   CVTMAP+212                                               01925000
CVTMDLDS EQU   CVTMAP+208                                               01926000
CVTUSER  EQU   CVTMAP+204                                               01927000
CVTABEND EQU   CVTMAP+200                                               01928000
CVTSMCA  EQU   CVTMAP+196                                               01929000
CVTRSV18 EQU   CVTMAP+192                                               01930000
CVTQLPAQ EQU   CVTMAP+188                                               01931000
CVTQCDSR EQU   CVTMAP+184                                               01932000
CVTRSV17 EQU   CVTOPTB                                                  01933000
CVTRSV16 EQU   CVTOPTB                                                  01934000
CVTFP    EQU   CVTOPTB                                                  01935000
CVTAPTHR EQU   CVTOPTB                                                  01936000
CVTNLOG  EQU   CVTOPTB                                                  01937000
CVTTOD   EQU   CVTOPTB                                                  01938000
CVTCTIMS EQU   CVTOPTB                                                  01939000
CVTPROT  EQU   CVTOPTB                                                  01940000
CVTXPFP  EQU   CVTOPTA                                                  01941000
CVTASCII EQU   CVTOPTA                                                  01942000
CVTRSV13 EQU   CVTOPTA                                                  01943000
CVTRSV12 EQU   CVTOPTA                                                  01944000
CVTNIP   EQU   CVTOPTA                                                  01945000
CVTDDR   EQU   CVTOPTA                                                  01946000
CVTAPR   EQU   CVTOPTA                                                  01947000
CVTCCH   EQU   CVTOPTA                                                  01948000
CVTSNCTR EQU   CVTMAP+180                                               01949000
CVTQMWR  EQU   CVTMAP+176                                               01950000
CVTQOCR  EQU   CVTMAP+172                                               01951000
CVT1EF00 EQU   CVTMAP+168                                               01952000
CVTMZ00  EQU   CVTMAP+164                                               01953000
CVTHEAD  EQU   CVTMAP+160                                               01954000
CVTRSV11 EQU   CVTMAP+156                                               01955000
CVT0PT01 EQU   CVTMAP+152                                               01956000
CVTMSER  EQU   CVTMAP+148                                               01957000
CVTRV516 EQU   CVTIERLC                                                 01958000
CVTILCH  EQU   CVTMAP+140                                               01959000
CVT0DS   EQU   CVTMAP+136                                               01960000
CVTFBOSV EQU   CVTMAP+132                                               01961000
CVTNUCB  EQU   CVTMAP+128                                               01962000
CVTIXAVL EQU   CVTMAP+124                                               01963000
CVTIOQET EQU   CVTMAP+120                                               01964000
CVTDCBA  EQU   CVTMAP+117                                               01965000
CVTMVS2  EQU   CVTDCB                                                   01966000
CVT6DAT  EQU   CVTDCB                                                   01967000
CVT4MPS  EQU   CVTDCB                                                   01968000
CVTRSV09 EQU   CVTDCB                                                   01969000
CVT4MS1  EQU   CVTDCB                                                   01970000
CVT2SPS  EQU   CVTDCB                                                   01971000
CVT1SSS  EQU   CVTDCB                                                   01972000
CVTRSV08 EQU   CVTDCB                                                   01973000
CVTSTB   EQU   CVTMAP+112                                               01974000
CVTQTD00 EQU   CVTMAP+108                                               01975000
CVTQTE00 EQU   CVTMAP+104                                               01976000
CVTCUCB  EQU   CVTMAP+100                                               01977000
CVTSJQ   EQU   CVTMAP+96                                                01978000
CVTPBLDL EQU   CVTMAP+92                                                01979000
CVTTPC   EQU   CVTMAP+88                                                01980000
CVTSVDCB EQU   CVTMAP+84                                                01981000
CVTBRET  EQU   CVTMAP+82                                                01982000
CVTEXIT  EQU   CVTMAP+80                                                01983000
CVT0FN00 EQU   CVTMAP+76                                                01984000
CVTDARA  EQU   CVTDAR+1                                                 01985000
CVTRSV07 EQU   CVTFLGS1                                                 01986000
CVTRSV06 EQU   CVTFLGS1                                                 01987000
CVTRSV05 EQU   CVTFLGS1                                                 01988000
CVTRSV04 EQU   CVTFLGS1                                                 01989000
CVTRSV03 EQU   CVTFLGS1                                                 01990000
CVTRSV02 EQU   CVTFLGS1                                                 01991000
CVTRSV01 EQU   CVTFLGS1                                                 01992000
CVTDMPLK EQU   CVTFLGS1                                                 01993000
CVTXITP  EQU   CVTMAP+68                                                01994000
CVTZDTAB EQU   CVTMAP+64                                                01995000
CVTMSLT  EQU   CVTMAP+60                                                01996000
CVTDATE  EQU   CVTMAP+56                                                01997000
CVTBTERM EQU   CVTMAP+52                                                01998000
CVTSYSAD EQU   CVTMAP+48                                                01999000
CVTXTLER EQU   CVTMAP+44                                                02000000
CVTILK2  EQU   CVTMAP+40                                                02001000
CVTILK1  EQU   CVTMAP+36                                                02002000
CVTPRLTV EQU   CVTMAP+32                                                02003000
CVTPCNVT EQU   CVTMAP+28                                                02004000
CVT0VL00 EQU   CVTMAP+24                                                02005000
CVTXAPG  EQU   CVTMAP+20                                                02006000
CVTBUF   EQU   CVTMAP+16                                                02007000
CVTJOB   EQU   CVTMAP+12                                                02008000
CVTLINK  EQU   CVTMAP+8                                                 02009000
CVT0EF00 EQU   CVTMAP+4                                                 02010000
CVTTCBP  EQU   CVTMAP                                                   02011000
CVT      EQU   CVTMAP                                                   02012000
ACBADDR  EQU   PARM+1                                                   02013000
OPENATTB EQU   PARM                                                     02014000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02015000
@RT00108 EQU   RELOOP                                                   02016000
@RT00111 EQU   RELOOP                                                   02017000
@RT00121 EQU   START                                                    02018000
@RT00123 EQU   LOOP1                                                    02019000
FINISH   EQU   @EL00001                                                 02020000
@ENDDATA EQU   *                                                        02021000
         END   IGG0203K,(C'PLS0040',0602,75026)                         02022000
./  ADD  SSI=50050114,NAME=IMDUSRFF
         TITLE 'IMDUSRFF - OPEN/CLOSE/EOV GTF UTILITY FORMAT APPENDAGE *00001000
                        '                                               00002000
IMDUSRFF CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IMDUSRFF  75.005'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @09,4095(,@11)                                      0001 00012000
         LA    @08,4095(,@09)                                      0001 00013000
         USING @PSTART,@11                                         0001 00014000
         USING @PSTART+4095,@09                                    0001 00015000
         USING @PSTART+8190,@08                                    0001 00016000
         EJECT                                                          00017000
*   WTABPTR=R1->GCORPTR;            /* INITIALIZE PTR TO WORK TABLE     00018000
*                                      GOTTEN CORE AREA              */ 00019000
         L     WTABPTR,GCORPTR(,R1)                                0065 00020000
*   SACALLER=RD;                    /* SAVE CALLER'S SAVE AREA PTR   */ 00021000
         ST    RD,SACALLER(,WTABPTR)                               0066 00022000
*   RD->SACALLED=ADDR(SAVAREA);     /* SAVE CALLED SAVE AREA PTR     */ 00023000
         ST    WTABPTR,SACALLED(,RD)                               0067 00024000
*   RD=ADDR(SAVAREA);               /* PT TO CALLED SAVE AREA        */ 00025000
         LR    RD,WTABPTR                                          0068 00026000
*   OBUFRPTR=R1->OUTPTR;            /* INITIALIZE OUTPUT BFR PTR     */ 00027000
         L     @10,OUTPTR(,R1)                                     0069 00028000
         ST    @10,OBUFRPTR(,WTABPTR)                              0069 00029000
*   GPARMPTR=R1;                    /* INITIALIZE PTR TO INPUT     0070 00030000
*                                      PARAMETER LIST                */ 00031000
         ST    R1,GPARMPTR(,WTABPTR)                               0070 00032000
*   RFY                                                            0071 00033000
*     R1 UNRSTD;                                                   0071 00034000
*   OUTBUFFR='';                    /* CLEAR OUTPUT BFR TO BLANKS    */ 00035000
*                                                                  0072 00036000
         MVI   OUTBUFFR(@10),C' '                                  0072 00037000
         MVC   OUTBUFFR+1(109,@10),OUTBUFFR(@10)                   0072 00038000
*   /*****************************************************************/ 00039000
*   /*                                                               */ 00040000
*   /* DETERMINE WHETHER THIS IS FIRST ENTRY FROM GTF                */ 00041000
*   /*                                                               */ 00042000
*   /*****************************************************************/ 00043000
*                                                                  0073 00044000
*   IF FLAGS(1)='1'B THEN           /* NOT FIRST ENTRY FROM GTF,   0073 00045000
*                                      INITIALIZATION HAS BEEN DONE  */ 00046000
         TM    FLAGS(WTABPTR),B'10000000'                          0073 00047000
         BO    @RT00073                                            0073 00048000
*     GOTO CALCBMN;                 /* GO GET PTR TO CONTROL BLOCK 0074 00049000
*                                      MONITOR AND BRANCH TO IT      */ 00050000
*   ELSE                                                           0075 00051000
*     ;                             /* THIS IS FIRST ENTRY FROM GTF,    00052000
*                                      INITIALIZATION IS NECESSARY   */ 00053000
*   SCANPTR=ADDR(SCANTBLE);         /* INITIALIZE PTR TO SCANTBLE  0076 00054000
*                                      TABLE TO SCAN FOR TRACE CODE. */ 00055000
         LA    @10,SCANTBLE                                        0076 00056000
         ST    @10,SCANPTR(,WTABPTR)                               0076 00057000
*   BUFRPTR=INPTR;                  /* INITIALIZE PTR TO INPUT RECORD   00058000
*                                      ADDRESS                       */ 00059000
         L     @10,GPARMPTR(,WTABPTR)                              0077 00060000
         L     @10,INPTR(,@10)                                     0077 00061000
         ST    @10,BUFRPTR(,WTABPTR)                               0077 00062000
*   LNGTH=INBUFFER(1:2);            /* LENGTH OF INPUT BUFFER IS   0078 00063000
*                                      TAKEN FROM 1ST TWO BYTES      */ 00064000
         MVC   LNGTH(2,WTABPTR),INBUFFER(@10)                      0078 00065000
*SCAN:                                                             0079 00066000
*                                                                  0079 00067000
*   /*****************************************************************/ 00068000
*   /*                                                               */ 00069000
*   /* HAS END OF SCANTBLE BEEN REACHED                              */ 00070000
*   /*                                                               */ 00071000
*   /*****************************************************************/ 00072000
*                                                                  0079 00073000
*   IF TRCCODE=ZERO                 /* ZERO IS TABLE END       YM8285*/ 00074000
*     THEN                          /* END OF SCANTBLE REACHED, DATA    00075000
*                                      WILL NOT BE PRINTED           */ 00076000
SCAN     L     @10,SCANPTR(,WTABPTR)                               0079 00077000
         CLI   TRCCODE(@10),0                                      0079 00078000
         BE    @RT00079                                            0079 00079000
*     GOTO RETURN8;                 /* GO MAKE FINAL EXIT TO GTF, DO    00080000
*                                      NOT PRINT DATA                */ 00081000
*   ELSE                            /* TRACE CODES ARE NOT EQUAL     */ 00082000
*                                                                  0081 00083000
*     /***************************************************************/ 00084000
*     /*                                                             */ 00085000
*     /* FIND A MATCH BETWEEN THE TRACE CODE KEY IN THE SCANTBLE &   */ 00086000
*     /* THE TRACE CODE IN THE FIRST BYTE OF THE INPUT TRACE DATA    */ 00087000
*     /*                                                             */ 00088000
*     /***************************************************************/ 00089000
*                                                                  0081 00090000
*     IF DATA(1)=TRCCODE            /* TEST TRACE CODE         YM8285*/ 00091000
*       THEN                        /* THE TRACE CODES IN SCANTBLE 0081 00092000
*                                      KEY AND THE INPUT TRACE DATA     00093000
*                                      MATCH. THIS IS THE PROPER   0081 00094000
*                                      SCANTBLE ENTRY                */ 00095000
         L     @03,GPARMPTR(,WTABPTR)                              0081 00096000
         L     @03,DATAPTR(,@03)                                   0081 00097000
         CLC   DATA(1,@03),TRCCODE(@10)                            0081 00098000
         BE    @RT00081                                            0081 00099000
*       GOTO BLDTBL;                /* GO BUILD THE WORK TABLE USING    00100000
*                                      THIS SCANTBLE ENTRY           */ 00101000
*     ELSE                          /* MORE ENTRIES IN SCANTBLE      */ 00102000
*       SCANPTR=SCANPTR+LENGTH(BASDSCAN);/* INCREMENT SCANTBLE ENTRY    00103000
*                                      PTR TO NEXT ENTRY             */ 00104000
         AL    @10,@CF00089                                        0083 00105000
         ST    @10,SCANPTR(,WTABPTR)                               0083 00106000
*   GOTO SCAN;                      /* GO LOOP TO CHECK NEXT ENTRY   */ 00107000
*                                                                  0084 00108000
         B     SCAN                                                0084 00109000
*   /*****************************************************************/ 00110000
*   /*                                                               */ 00111000
*   /* BUILD THE WORK TABLE (WORKTABL) FOR USE BY THE CONTROL BLOCK  */ 00112000
*   /* MONITORS, TRANSLATE ROUTINE, ETC. UPON FINDING THE CORRECT    */ 00113000
*   /* SCANTBLE ENTRY                                                */ 00114000
*   /*                                                               */ 00115000
*   /*****************************************************************/ 00116000
*                                                                  0085 00117000
*BLDTBL:                                                           0085 00118000
*   BUFRPTR=DATAPTR+LENGTH(TRCCODE);/* POINT TO DATA IN BUFFER BEYOND   00119000
*                                      TRACE CODE                    */ 00120000
BLDTBL   L     @10,GPARMPTR(,WTABPTR)                              0085 00121000
         LA    @03,1                                               0085 00122000
         AL    @03,DATAPTR(,@10)                                   0085 00123000
         ST    @03,BUFRPTR(,WTABPTR)                               0085 00124000
*   LNGTH=LNGTH-(BUFRPTR-INPTR);    /* SET LENGTH TO LENGTH OF DATA     00125000
*                                      TO BE FORMATTED               */ 00126000
         SL    @03,INPTR(,@10)                                     0086 00127000
         LCR   @03,@03                                             0086 00128000
         AH    @03,LNGTH(,WTABPTR)                                 0086 00129000
         STH   @03,LNGTH(,WTABPTR)                                 0086 00130000
*   DTBLPTR=DPNTR;                  /* PTR TO DATA TABLE             */ 00131000
         L     @10,SCANPTR(,WTABPTR)                               0087 00132000
         L     @03,DPNTR(,@10)                                     0087 00133000
         ST    @03,DTBLPTR(,WTABPTR)                               0087 00134000
*   TTBLPTR=TITLPTR;                /* PTR TO TITLE TABLE            */ 00135000
         L     @03,TITLPTR(,@10)                                   0088 00136000
         ST    @03,TTBLPTR(,WTABPTR)                               0088 00137000
*   CBMONPTR=CBPTR;                 /* PTR TO CONTROL BLOCK MON      */ 00138000
         L     @10,CBPTR-1(,@10)                                   0089 00139000
         LA    @10,0(,@10)                                         0089 00140000
         ST    @10,CBMONPTR(,WTABPTR)                              0089 00141000
*   FLAGS(1)='1'B;                  /* SET SECOND ENTRY SWITCH       */ 00142000
*                                                                  0090 00143000
         OI    FLAGS(WTABPTR),B'10000000'                          0090 00144000
*   /*****************************************************************/ 00145000
*   /*                                                               */ 00146000
*   /* LOAD THE ADDRESS OF THE APPROPRIATE CONTROL BLOCK MONITOR INTO*/ 00147000
*   /* A REGISTER AND BRANCH TO THE CONTROL BLOCK REGISTER           */ 00148000
*   /*                                                               */ 00149000
*   /*****************************************************************/ 00150000
*                                                                  0091 00151000
*CALCBMN:                                                          0091 00152000
*   CBMONREG=CBMONPTR;              /* LOAD ADDRESS OF CONTROL BLOCK    00153000
*                                      MONITOR IN REG.               */ 00154000
CALCBMN  L     CBMONREG,CBMONPTR(,WTABPTR)                         0091 00155000
*   GEN;                                                           0092 00156000
         BR    CBMONREG                 GO TO CONTROL BLOCK MONITOR     00157000
*RETURN8:                           /* RETURN TO EDIT AND TELL IT NOT   00158000
*                                      TO PRINT THE OUTPUT BUFFER BUT   00159000
*                                      TO GET THE NEXT LOGICAL RECORD*/ 00160000
*   FLAGS(1)='0'B;                  /* TURN OFF SECOND TIME SW       */ 00161000
RETURN8  NI    FLAGS(WTABPTR),B'01111111'                          0093 00162000
*   RD=SACALLER;                    /* PT TO SAVE AREA OF CALLER     */ 00163000
         L     RD,SACALLER(,WTABPTR)                               0094 00164000
*   RETURN CODE(8);                                                0095 00165000
         LA    @15,8                                               0095 00166000
         L     @14,12(,@13)                                        0095 00167000
         LM    @00,@12,20(@13)                                     0095 00168000
         BR    @14                                                 0095 00169000
*   GEN(EJECT);                                                    0096 00170000
         EJECT                                                          00171000
*                                                                  0097 00172000
*   /*****************************************************************/ 00173000
*   /*                                                               */ 00174000
*   /* FORMAT MONITOR (FORMON) THIS ROUTINE WILL DETERMINE WHETHER A */ 00175000
*   /* TITLE OR DATA LINE IS TO BE PRINTED. IF A TITLE IS TO BE      */ 00176000
*   /* PRINTED, THEN THE TITLE IS TAKEN FROM THE TABLE AND MOVED TO  */ 00177000
*   /* THE OUTPUT BUFFER, THE BUFFER POINTER IS UPDATED, THE DATA    */ 00178000
*   /* SWITCH IS SET TO ONE, AND A RETURN CODE OF 0 IS PASSED TO THE */ 00179000
*   /* GTF UTILITY. THIS RETURN CODE REQUESTS GTF TO PRINT THE BUFFER*/ 00180000
*   /* AND RETURN TO THE FORMAT APPENDAGE. IF A DATA LINE IS TO BE   */ 00181000
*   /* PRINTED, THE OUTPUT BUFFER POINTER IS UPDATED BY NINE BYTES,  */ 00182000
*   /* AND THE TRANSLATE ROUTINE IS CALLED TO MOVE THE DATA TO THE   */ 00183000
*   /* BUFFER AND TRANSLATE IT TO EBCDIC. THE TRANSLATE ROUTINE IS   */ 00184000
*   /* PASSED A POINTER TO THE DATA TABLE, THE INPUT BUFFER, AND THE */ 00185000
*   /* OUTPUT BUFFER. IT WILL MOVE FROM ZERO TO FOUR BYTES TO THE    */ 00186000
*   /* OUTPUT BUFFER DEPENDING ON THE INFORMATION IN THE DATA TABLE. */ 00187000
*   /* THE TRANSLATE IS CALLED TEN TIMES, ONCE FOR EACH TEN BYTE DATA*/ 00188000
*   /* FIELD IN THE OUTPUT BUFFER. AFTER EACH CALL TO THE TRANSLATE  */ 00189000
*   /* ROUTINE, POINTERS AND THE REMAINING LENGTH OF THE DATA IN THE */ 00190000
*   /* INPUT BUFFER ARE UPDATED. THE OUTPUT BUFFER BEING FILLED, A   */ 00191000
*   /* TEST IS MADE FOR END OF DATA IN THE INPUT BUFFER. IF IT IS END*/ 00192000
*   /* OF DATA, A FINAL EXIT IS TAKEN TO THE GTF UTILITY TO PRINT THE*/ 00193000
*   /* OUTPUT BUFFER (RETURN CODE 4). IF THE END OF THE INPUT RECORD */ 00194000
*   /* HAS NOT BEEN REACHED, A CHECK IS MADE FOR THE NEXT LINE BEING */ 00195000
*   /* A TITLE. IF THE NEXT LINE IS TO BE A TITLE, FLAGS BIT 1 IS SET*/ 00196000
*   /* OFF. IF THE NEXT LINE IS TO BE DATA, FLAGS BIT 1 IS LEFT ON.  */ 00197000
*   /* GTF IS PASSED A RETURN CODE OF 0 TO PRINT THE OUTPUT BUFFER   */ 00198000
*   /* AND RETURN. FOR ALL BUT CONTROL BLOCKS WITH                   */ 00199000
*   /* TRACE-DATA-DEPENDENT PROCESSING, THIS ROUTINE CONTROLS THE    */ 00200000
*   /* BUILDING OF THE OUTPUT RECORDS. THIS ROUTINE IS ENTERED A     */ 00201000
*   /* NUMBER OF TIMES, ONCE FOR EACH OUTPUT LINE, IN THE PROCESSING */ 00202000
*   /* OF EACH INPUT TRACE RECORD.                                   */ 00203000
*   /*                                                               */ 00204000
*   /*****************************************************************/ 00205000
*                                                                  0097 00206000
*FORMON:                                                           0097 00207000
*                                                                  0097 00208000
*   /*****************************************************************/ 00209000
*   /*                                                               */ 00210000
*   /* DETERMINE WHETHER DATA OR TITLE IS TO BE PRINTED              */ 00211000
*   /*                                                               */ 00212000
*   /*****************************************************************/ 00213000
*                                                                  0097 00214000
*   IF FLAGS(2)='1'B THEN           /* BIT ON, DATA TO BE PRINTED    */ 00215000
FORMON   TM    FLAGS(WTABPTR),B'01000000'                          0097 00216000
         BO    @RT00097                                            0097 00217000
*     GOTO PRNTDAT;                 /* GO CONSTRUCT OUTPUT BUFFER  0098 00218000
*                                      FROM DATA                     */ 00219000
*   ELSE                                                           0099 00220000
*     ;                             /* TITLE TO BE PRINTED           */ 00221000
*   OUTBUFFR=TITLET;                /* MOVE TITLE TO BUFFER          */ 00222000
         L     @10,OBUFRPTR(,WTABPTR)                              0100 00223000
         MVI   OUTBUFFR+109(@10),C' '                              0100 00224000
         L     @03,TTBLPTR(,WTABPTR)                               0100 00225000
         MVC   OUTBUFFR(109,@10),TITLET(@03)                       0100 00226000
*   TTBLPTR=TTBLPTR+LENGTH(TITLET); /* INCREMENT TITLE TBL PTR       */ 00227000
         AL    @03,@CF00241                                        0101 00228000
         ST    @03,TTBLPTR(,WTABPTR)                               0101 00229000
*   FLAGS(2)='1'B;                  /* TITLE THIS TIME, CHANGE SW TO    00230000
*                                      INDICATE DATA TO BE PRINTED 0102 00231000
*                                      NEXT TIME THROUGH             */ 00232000
         OI    FLAGS(WTABPTR),B'01000000'                          0102 00233000
*RETURN0:                                                          0103 00234000
*   RD=SACALLER;                    /* PT TO SAVE AREA OF CALLER     */ 00235000
RETURN0  L     RD,SACALLER(,WTABPTR)                               0103 00236000
*   RETURN CODE(0);                 /* INDICATE THAT GTF IS TO PRINT    00237000
*                                      THE OUTPUT BUFFER AND RETURN     00238000
*                                      TO IMDUSRFF                   */ 00239000
         SLR   @15,@15                                             0104 00240000
         L     @14,12(,@13)                                        0104 00241000
         LM    @00,@12,20(@13)                                     0104 00242000
         BR    @14                                                 0104 00243000
*PRNTDAT:                                                          0105 00244000
*   OBUFRPTR=OBUFRPTR+9;            /* INCR OUTPUT BUFFER PTR TO SKIP   00245000
*                                      INITIAL BLANKS                */ 00246000
*                                                                  0105 00247000
PRNTDAT  LA    @10,9                                               0105 00248000
         AL    @10,OBUFRPTR(,WTABPTR)                              0105 00249000
         ST    @10,OBUFRPTR(,WTABPTR)                              0105 00250000
*   /*****************************************************************/ 00251000
*   /*                                                               */ 00252000
*   /* REPEATEDLY CALL TRANSLATE ROUTINE TO FILL OUTPUT BUFFER FIELDS*/ 00253000
*   /* WITH TRANSLATED DATA                                          */ 00254000
*   /*                                                               */ 00255000
*   /*****************************************************************/ 00256000
*                                                                  0106 00257000
*   DO COUNT=1 TO 10 BY 1;          /* LOOP THROUGH NO. OF DATA    0106 00258000
*                                      FIELDS IN OUTPUT BFR          */ 00259000
         LA    @10,1                                               0106 00260000
         STH   @10,COUNT(,WTABPTR)                                 0106 00261000
@DL00106 DS    0H                                                  0107 00262000
*     CALL XLATE;                   /* CALL TRANSLATE                */ 00263000
         BAL   @14,XLATE                                           0107 00264000
*     OBUFRPTR=OBUFRPTR+10;         /* INCR OUTPUT BFR PTR BY DATA 0108 00265000
*                                      FIELD LENGTH                  */ 00266000
         LA    @10,10                                              0108 00267000
         AL    @10,OBUFRPTR(,WTABPTR)                              0108 00268000
         ST    @10,OBUFRPTR(,WTABPTR)                              0108 00269000
*     BUFRPTR=BUFRPTR+DATAT;        /* INCR INPUT BFR PTR BY LENGTH     00270000
*                                      OF INPUT DATA JUST FORMATTED  */ 00271000
         L     @10,DTBLPTR(,WTABPTR)                               0109 00272000
         SLR   @03,@03                                             0109 00273000
         IC    @03,DATAT(,@10)                                     0109 00274000
         L     @15,BUFRPTR(,WTABPTR)                               0109 00275000
         ALR   @15,@03                                             0109 00276000
         ST    @15,BUFRPTR(,WTABPTR)                               0109 00277000
*     LNGTH=LNGTH-DATAT;            /* SUBTR LENGTH OF DATA JUST   0110 00278000
*                                      FORMATTED TO GET NO. BYTES  0110 00279000
*                                      LEFT IN INPUT RECORD          */ 00280000
*                                                                  0110 00281000
         LCR   @03,@03                                             0110 00282000
         AH    @03,LNGTH(,WTABPTR)                                 0110 00283000
         STH   @03,LNGTH(,WTABPTR)                                 0110 00284000
*     /***************************************************************/ 00285000
*     /*                                                             */ 00286000
*     /* CHECK FOR END OF INPUT DATA RECORD                          */ 00287000
*     /*                                                             */ 00288000
*     /***************************************************************/ 00289000
*                                                                  0111 00290000
*     IF LNGTH>0 THEN              /* NO BYTES LEFT IN INPUT      0111 00291000
*                                      RECORD--ALL DONE              */ 00292000
         LTR   @03,@03                                             0111 00293000
         BNP   @RT00111                                            0111 00294000
*       GOTO EODATA;                /* GO MAKE FINAL EXIT TO GTF     */ 00295000
*     ELSE                          /* MORE DATA LEFT TO PROCESS     */ 00296000
*       DTBLPTR=DTBLPTR+1;          /* INCR DATA TABLE PTR           */ 00297000
         AL    @10,@CF00240                                        0113 00298000
         ST    @10,DTBLPTR(,WTABPTR)                               0113 00299000
*   END;                                                           0114 00300000
*                                                                  0114 00301000
         LA    @10,1                                               0114 00302000
         AH    @10,COUNT(,WTABPTR)                                 0114 00303000
         STH   @10,COUNT(,WTABPTR)                                 0114 00304000
         C     @10,@CF00629                                        0114 00305000
         BNH   @DL00106                                            0114 00306000
*   /*****************************************************************/ 00307000
*   /*                                                               */ 00308000
*   /* CHECK LAST BYTE OF ENTRY FOR LAST ENTRY INDICATOR             */ 00309000
*   /*                                                               */ 00310000
*   /*****************************************************************/ 00311000
*                                                                  0115 00312000
*   IF DATAT='01'X THEN             /* END OF DATA TABLE ENTRIES     */ 00313000
         L     @10,DTBLPTR(,WTABPTR)                               0115 00314000
         CLI   DATAT(@10),X'01'                                    0115 00315000
         BE    @RT00115                                            0115 00316000
*     GOTO EODATA;                  /* GO MAKE FINAL EXIT TO GTF     */ 00317000
*   ELSE                            /* MORE DATA LEFT TO PROCESS     */ 00318000
*                                                                  0117 00319000
*     /***************************************************************/ 00320000
*     /*                                                             */ 00321000
*     /* DETERMINE WHETHER NEXT LINE IS DATA OR TITLE                */ 00322000
*     /*                                                             */ 00323000
*     /***************************************************************/ 00324000
*                                                                  0117 00325000
*     IF DATAT='02'X THEN           /* ANOTHER DATA LINE FOLLOWS     */ 00326000
         CLI   DATAT(@10),X'02'                                    0117 00327000
         BNE   @RF00117                                            0117 00328000
*       DO;                                                        0118 00329000
*         DTBLPTR=DTBLPTR+1;        /* INCR DATA TABLE PTR           */ 00330000
         AL    @10,@CF00240                                        0119 00331000
         ST    @10,DTBLPTR(,WTABPTR)                               0119 00332000
*         GOTO RETURN0;             /* GO RETURN TO GTF TO HAVE    0120 00333000
*                                      OUTPUT BUFFER PRINTED         */ 00334000
         B     RETURN0                                             0120 00335000
*       END;                                                       0121 00336000
*     ELSE                          /* NOT END OF DATA AND NOT DATA     00337000
*                                      LINE NEXT--TITLE NEXT         */ 00338000
*       DO;                                                        0122 00339000
@RF00117 DS    0H                                                  0123 00340000
*         DTBLPTR=DTBLPTR+1;        /* INCR DATA TABLE PTR           */ 00341000
         LA    @10,1                                               0123 00342000
         AL    @10,DTBLPTR(,WTABPTR)                               0123 00343000
         ST    @10,DTBLPTR(,WTABPTR)                               0123 00344000
*         FLAGS(2)='0'B;            /* SET SW TO TITLE NEXT          */ 00345000
         NI    FLAGS(WTABPTR),B'10111111'                          0124 00346000
*         GOTO RETURN0;             /* GO RETURN TO GTF TO HAVE    0125 00347000
*                                      OUTPUT BUFFER PRINTED         */ 00348000
         B     RETURN0                                             0125 00349000
*       END;                                                       0126 00350000
*EODATA:                                                           0127 00351000
*   RD=SACALLER;                    /* PT TO SAVE AREA OF CALLER     */ 00352000
EODATA   L     RD,SACALLER(,WTABPTR)                               0127 00353000
*   RETURN CODE(4);                 /* MAKE FINAL EXIT TO GTF. GTF 0128 00354000
*                                      WILL PRINT OUTPUT BFR         */ 00355000
*                                                                  0128 00356000
         LA    @15,4                                               0128 00357000
         L     @14,12(,@13)                                        0128 00358000
         LM    @00,@12,20(@13)                                     0128 00359000
         BR    @14                                                 0128 00360000
*   /*****************************************************************/ 00361000
*   /*                                                               */ 00362000
*   /* CONTROL BLOCK MONITOR ROUTINES THE FOLLOWING CONTROL BLOCK    */ 00363000
*   /* MONITOR ROUTINES CONTROL THE OUTPUT TITLE AND DATA FORMATTING */ 00364000
*   /* FOR CONTROL BLOCKS HAVING A VARIABLE FORMAT, I.E. A           */ 00365000
*   /* DATA-DEPENDENT FORMAT WHICH CANNOT BE DETERMINED SOLEY BY THE */ 00366000
*   /* TITLE AND DATA TABLES. DUPLICATE FIELDS CONTROL BLOCK MONITOR */ 00367000
*   /* (DUPMON) THIS ROUTINE HANDLES CONTROL BLOCKS HAVING AN        */ 00368000
*   /* INDEFINITE NO. OF SIMILAR DATA LINES, SUCH AS CCW'S AND DCB   */ 00369000
*   /* EXIT LIST ENTRIES. AFTER THE TITLE IS PRINTED ON THE FIRST    */ 00370000
*   /* ENTRY TO THIS ROUTINE, THE DATA TABLE POINTER IS RESET TO     */ 00371000
*   /* RE-USE THE SAME DATA TABLE ENTRY UNTIL END OF DATA IS REACHED.*/ 00372000
*   /*                                                               */ 00373000
*   /*****************************************************************/ 00374000
*                                                                  0129 00375000
*DUPMON:                                                           0129 00376000
*   OUTBUFFR='';                    /* CLEAR OUTPUT BUFFER           */ 00377000
*                                                                  0129 00378000
DUPMON   L     @10,OBUFRPTR(,WTABPTR)                              0129 00379000
         MVI   OUTBUFFR(@10),C' '                                  0129 00380000
         MVC   OUTBUFFR+1(109,@10),OUTBUFFR(@10)                   0129 00381000
*   /*****************************************************************/ 00382000
*   /*                                                               */ 00383000
*   /* CHECK FOR FIRST ENTRY TO THIS ROUTINE                         */ 00384000
*   /*                                                               */ 00385000
*   /*****************************************************************/ 00386000
*                                                                  0130 00387000
*   IF FLAGS(3)='0'B THEN           /* FIRST ENTRY                   */ 00388000
         TM    FLAGS(WTABPTR),B'00100000'                          0130 00389000
         BNZ   @RF00130                                            0130 00390000
*     DO;                                                          0131 00391000
*       FLAGS(3)='1'B;              /* SET SECOND ENTRY SW           */ 00392000
         OI    FLAGS(WTABPTR),B'00100000'                          0132 00393000
*       GOTO FORMON;                /* GO PRINT TITLE FIRST TIME     */ 00394000
         B     FORMON                                              0133 00395000
*     END;                                                         0134 00396000
*   ELSE                            /* NOT FIRST ENTRY               */ 00397000
*     DO;                                                          0135 00398000
@RF00130 DS    0H                                                  0136 00399000
*       DTBLPTR=DPNTR;              /* ALWAYS INITIALIZE DATA TABLE     00400000
*                                      PTR TO FIRST ENTRY            */ 00401000
         L     @10,SCANPTR(,WTABPTR)                               0136 00402000
         L     @10,DPNTR(,@10)                                     0136 00403000
         ST    @10,DTBLPTR(,WTABPTR)                               0136 00404000
*       GOTO PRNTDAT;               /* GO FORMAT AND PRINT DATA LINE */ 00405000
         B     PRNTDAT                                             0137 00406000
*     END;                                                         0138 00407000
*                                                                  0138 00408000
*   /*****************************************************************/ 00409000
*   /*                                                               */ 00410000
*   /* TAPE LABEL CONTROL BLOCK MONITOR (LBL1MON) THIS ROUTINE       */ 00411000
*   /* DETERMINES WHICH OF THE THREE LABEL TYPES IS TRACED--VOL,     */ 00412000
*   /* LBL1, OR LBL2. THE DATA AND TITLE TABLE ENTRY POINTERS ARE    */ 00413000
*   /* INITIALIZED IN THE WORK TABLE TO POINT TO THE APPROPRIATE     */ 00414000
*   /* ENTRIES (VOL, LBL1, OR LBL2). ONCE THE CORRECT TABLE ENTRIES  */ 00415000
*   /* HAVE BEEN DETERMINED, PROCESSING IS STRAIGHTFORWARD, SO THE   */ 00416000
*   /* CONTROL BLOCK MONITOR POINTER IS SET TO THE FORMAT MONITOR,   */ 00417000
*   /* WHICH IS GIVEN CONTROL TO PROCESS THE LABELS AS FIXED CONTROL */ 00418000
*   /* BLOCKS DETERMINE WHETHER HAVE VOL LABEL.                      */ 00419000
*   /*                                                               */ 00420000
*   /*****************************************************************/ 00421000
*                                                                  0139 00422000
*TLBLMON:                                                          0139 00423000
*   IF DATA(2:4)='VOL' THEN         /* HAVE VOL LABEL                */ 00424000
TLBLMON  L     @10,GPARMPTR(,WTABPTR)                              0139 00425000
         L     @10,DATAPTR(,@10)                                   0139 00426000
         CLC   DATA+1(3,@10),@CC00674                              0139 00427000
         BNE   @RF00139                                            0139 00428000
*     DO;                           /* SET TABLE PTRS FOR VOL LBL    */ 00429000
*       DTBLPTR=ADDR(VLBLD);        /* SET DATA TABLE PTR FOR VOL    */ 00430000
         LA    @10,VLBLD                                           0141 00431000
         ST    @10,DTBLPTR(,WTABPTR)                               0141 00432000
*       TTBLPTR=ADDR(VOLLABEL);     /* SET TITLE TABLE PTR FOR VOL   */ 00433000
         LA    @10,VOLLABEL                                        0142 00434000
         ST    @10,TTBLPTR(,WTABPTR)                               0142 00435000
*       GOTO SKIP12CK;              /* SKIP CHECKING FOR LBL 1 OR 2  */ 00436000
         B     SKIP12CK                                            0143 00437000
*     END;                                                         0144 00438000
*   ELSE                                                           0145 00439000
*     ;                             /* MUST HAVE LBL 1 OR 2          */ 00440000
*                                                                  0145 00441000
@RF00139 DS    0H                                                  0146 00442000
*   /*****************************************************************/ 00443000
*   /*                                                               */ 00444000
*   /* DETERMINE WHETHER HAVE LABEL1 OR LABEL2                       */ 00445000
*   /*                                                               */ 00446000
*   /*****************************************************************/ 00447000
*                                                                  0146 00448000
*   IF DATA(5)='2' THEN             /* IF FOURTH CHARACTER IS A 2, IT   00449000
*                                      IS A LABEL2.                  */ 00450000
         L     @10,GPARMPTR(,WTABPTR)                              0146 00451000
         L     @10,DATAPTR(,@10)                                   0146 00452000
         CLI   DATA+4(@10),C'2'                                    0146 00453000
         BNE   @RF00146                                            0146 00454000
*     DO;                           /* SET TABLE PTRS FOR LABEL2     */ 00455000
*       DTBLPTR=ADDR(LBL2D);        /* SET DATA TABLE PTR FOR LBL2   */ 00456000
         LA    @10,LBL2D                                           0148 00457000
         ST    @10,DTBLPTR(,WTABPTR)                               0148 00458000
*       TTBLPTR=ADDR(LBL2);         /* TITLE TABLE PTR FOR LBL2      */ 00459000
         LA    @10,LBL2                                            0149 00460000
         ST    @10,TTBLPTR(,WTABPTR)                               0149 00461000
*     END;                                                         0150 00462000
*   ELSE                                                           0151 00463000
*     ;                             /* IT IS A LABEL1, LEAVE PTRS SET   00464000
*                                      FOR LABEL1.                   */ 00465000
@RF00146 DS    0H                                                  0152 00466000
*SKIP12CK:                                                         0152 00467000
*   CBMONPTR=ADDR(FORMON);          /* SET CONTROL BLOCK MONITOR TO     00468000
*                                      THE FORMAT MONITOR. TREAT AS A   00469000
*                                      FIXED CONTROL BLOCK           */ 00470000
SKIP12CK LA    @10,FORMON                                          0152 00471000
         ST    @10,CBMONPTR(,WTABPTR)                              0152 00472000
*   GOTO FORMON;                    /* GO PROCESS BY FORMAT MONITOR  */ 00473000
*                                                                  0153 00474000
         B     FORMON                                              0153 00475000
*   /*****************************************************************/ 00476000
*   /*                                                               */ 00477000
*   /* TIOT CONTROL BLOCK MONITOR (TIOTMON) THIS ROUTINE, AFTER THE  */ 00478000
*   /* TIOT DD ENTRY HAS BEEN PRINTED IN THE NORMAL MANNER, USES THE */ 00479000
*   /* FORMAT MONITOR TO FORMAT THE DEVICE ENTRY DATA LINES BY       */ 00480000
*   /* RESETTING THE DATA TABLE POINTER (DTBLPTR) TO THE ADDRESS OF  */ 00481000
*   /* THE DEVICE ENTRY DATA TABLE ENTRY AFTER EACH LINE. THE FORMAT */ 00482000
*   /* MONITOR DETECTS THE END OF DATA AND TERMINATES PROCESSING.    */ 00483000
*   /* DETERMINE WHETHER DEVICE ENTRY HAS BEEN REACHED               */ 00484000
*   /*                                                               */ 00485000
*   /*****************************************************************/ 00486000
*                                                                  0154 00487000
*TIOTMON:                                                          0154 00488000
*   IF CBMONCTR=3 THEN              /* THREE LINES PRINTED           */ 00489000
TIOTMON  LH    @10,CBMONCTR(,WTABPTR)                              0154 00490000
         C     @10,@CF00066                                        0154 00491000
         BE    @RT00154                                            0154 00492000
*     GOTO DEVENTRY;                /* GO SET UP FOR DEVICE ENTRIES     00493000
*                                      IF 3 LINES (DD TITLE, DD DATA,   00494000
*                                      DEVICE ENTRY TITLE), PRINT  0155 00495000
*                                      CONSECUTIVE DEVICE ENTRIES    */ 00496000
*   ELSE                                                           0156 00497000
*     ;                             /* STILL ON FIRST THREE LINES    */ 00498000
*                                                                  0156 00499000
*   /*****************************************************************/ 00500000
*   /*                                                               */ 00501000
*   /* DETERMINE WHETHER PRINTING DATA OR TITLE                      */ 00502000
*   /*                                                               */ 00503000
*   /*****************************************************************/ 00504000
*                                                                  0157 00505000
*   IF FLAGS(3)='1'B THEN           /* ARE IN PROCESS OF PRINTING    */ 00506000
         TM    FLAGS(WTABPTR),B'00100000'                          0157 00507000
         BO    @RT00157                                            0157 00508000
*     GO TO DEVDATA;                /* DATA. RESET DATA PTR.         */ 00509000
*   ELSE                                                           0159 00510000
*     ;                             /* NOT PRINTING DATA             */ 00511000
*   CBMONCTR=CBMONCTR+1;            /* INCREMENT TIOT CTR BY ONE LINE*/ 00512000
         AL    @10,@CF00240                                        0160 00513000
         STH   @10,CBMONCTR(,WTABPTR)                              0160 00514000
*   GOTO FORMON;                    /* GO PRINT LINE                 */ 00515000
         B     FORMON                                              0161 00516000
*DEVENTRY:                                                         0162 00517000
*   CBMONCTR=0;                     /* RESTORE TIOT CTR              */ 00518000
DEVENTRY SLR   @10,@10                                             0162 00519000
         STH   @10,CBMONCTR(,WTABPTR)                              0162 00520000
*   FLAGS(3)='1'B;                  /* SET SW INDICATING DATA LINES     00521000
*                                      ONLY ARE LEFT TO BE PRINTED   */ 00522000
         OI    FLAGS(WTABPTR),B'00100000'                          0163 00523000
*   GOTO FORMON;                    /* GO PRINT FIRST DATA LINE OF 0164 00524000
*                                      DEVICE ENTRY                  */ 00525000
         B     FORMON                                              0164 00526000
*DEVDATA:                                                          0165 00527000
*   DTBLPTR=ADDR(TIOTDEVD);         /* RESTORE DATA TABLE PTR TO THE    00528000
*                                      DEVICE DATA ADDR. I.E. USE THE   00529000
*                                      SAME DATA TABLE ENTRY OVER  0165 00530000
*                                      AGAIN.                        */ 00531000
DEVDATA  LA    @10,TIOTDEVD                                        0165 00532000
         ST    @10,DTBLPTR(,WTABPTR)                               0165 00533000
*   GOTO FORMON;                    /* GO PRINT SUCCEEDING DATA    0166 00534000
*                                      LINES.                        */ 00535000
*                                                                  0166 00536000
         B     FORMON                                              0166 00537000
*   /*****************************************************************/ 00538000
*   /*                                                               */ 00539000
*   /* UCB CONTROL BLOCK MONITOR (UCBMON) THE FORMAT MONITOR         */ 00540000
*   /* COMPLETES PROCESSING AS FOR A FIXED CONTROL BLOCK.            */ 00541000
*   /*                                                               */ 00542000
*   /*****************************************************************/ 00543000
*                                                                  0167 00544000
*UCBMON:                                                           0167 00545000
*                                                                  0167 00546000
*   /*****************************************************************/ 00547000
*   /*                                                               */ 00548000
*   /* DETERMINE WHETHER LAST UCB COMMON DATA LINE HAS BEEN REACHED  */ 00549000
*   /*                                                               */ 00550000
*   /*****************************************************************/ 00551000
*                                                                  0167 00552000
*   IF CBMONCTR=3 THEN              /* THREE LINES PRINTED, ON DATA     00553000
*                                      LINE NOW                      */ 00554000
UCBMON   LH    @10,CBMONCTR(,WTABPTR)                              0167 00555000
         C     @10,@CF00066                                        0167 00556000
         BE    @RT00167                                            0167 00557000
*     GOTO NOT;                     /* GO DETERMINE FURTHER Y02080 0168 00558000
*                                      PROCESSING                    */ 00559000
*   CBMONCTR=CBMONCTR+1;            /* INCREMENT LINE COUNTER        */ 00560000
         AL    @10,@CF00240                                        0169 00561000
         STH   @10,CBMONCTR(,WTABPTR)                              0169 00562000
*   GOTO FORMON;                    /* GO TO FORMAT MONITOR FOR THIS    00563000
*                                      LINE                          */ 00564000
*                                                                  0170 00565000
         B     FORMON                                              0170 00566000
*   /*****************************************************************/ 00567000
*   /*                                                               */ 00568000
*   /* DETERMINE FORMAT REQUIRED Y02080                              */ 00569000
*   /*                                                               */ 00570000
*   /*****************************************************************/ 00571000
*                                                                  0171 00572000
*NOT:                                                              0171 00573000
*   CBMONPTR=ADDR(FORMON);          /* TREAT AS FIXED CB Y02080 LET     00574000
*                                      FORMAT MONITOR HANDLE IT      */ 00575000
NOT      LA    @10,FORMON                                          0171 00576000
         ST    @10,CBMONPTR(,WTABPTR)                              0171 00577000
*RSETUCBC:                                                         0172 00578000
*   CBMONCTR=0;                     /* RESET LINE COUNTER            */ 00579000
RSETUCBC SLR   @10,@10                                             0172 00580000
         STH   @10,CBMONCTR(,WTABPTR)                              0172 00581000
*   GOTO FORMON;                    /* GO FORMAT NEXT LINE           */ 00582000
*                                                                  0173 00583000
         B     FORMON                                              0173 00584000
*   /*****************************************************************/ 00585000
*   /*                                                               */ 00586000
*   /*                                                               */ 00587000
*   /*****************************************************************/ 00588000
*                                                                  0174 00589000
*XLATE:                                                            0174 00590000
*   PROC OPTIONS(NOSAVEAREA);                                      0174 00591000
*                                                                  0174 00592000
XLATE    STM   @14,@12,12(@13)                                     0174 00593000
*   /*****************************************************************/ 00594000
*   /*                                                               */ 00595000
*   /* TRANSLATE ROUTINE (XLATE) THE FOLLOWING ROUTINE MOVES DATA    */ 00596000
*   /* FROM THE INPUT BUFFER TO THE OUTBUFFER, UNPACKS IT, AND       */ 00597000
*   /* CONVERTS IT TO EBCDIC. IT USES THE ONE BYTE ENTRY IN THE DATA */ 00598000
*   /* TABLE TO DETERMINE THE LENGTH OF THE PIECE OF DATA TO BE MOVED*/ 00599000
*   /* AND CONVERTED.                                                */ 00600000
*   /*                                                               */ 00601000
*   /*****************************************************************/ 00602000
*                                                                  0175 00603000
*   DCL                                                            0175 00604000
*     R3 REG(3) PTR(31) RSTD;       /* WORK REG Y02080               */ 00605000
*   DCL                                                            0176 00606000
*     R4 REG(4) PTR(31) RSTD;       /* WORK REG Y02080               */ 00607000
*   DCL                                                            0177 00608000
*     R5 REG(5) PTR(31) RSTD;       /* WORK REG Y02080               */ 00609000
*   GEN DATA;                                                      0178 00610000
*                                                                  0178 00611000
*   /*****************************************************************/ 00612000
*   /*                                                               */ 00613000
*   /* CHECK FOR ZERO ENTRY IN DATA TABLE                            */ 00614000
*   /*                                                               */ 00615000
*   /*****************************************************************/ 00616000
*                                                                  0179 00617000
*   IF DATAT='00'X                  /* Y02080                        */ 00618000
*     THEN                          /* IF DATA TABLE ENTRY IS ZERO,     00619000
*                                      NO DATA IS TO BE MOVED        */ 00620000
         L     @10,DTBLPTR(,WTABPTR)                               0179 00621000
         CLI   DATAT(@10),X'00'                                    0179 00622000
         BE    @RT00179                                            0179 00623000
*     GOTO EXIT;                    /* GO RETURN                     */ 00624000
*   ELSE                                                           0181 00625000
*     ;                             /* DATA TO TRANSLATE, CONTINUE   */ 00626000
*   R3=ADDR(DATAT);                 /* POINTER TO DATA TABLE ENTRY   */ 00627000
         LR    R3,@10                                              0182 00628000
*   R4=0;                           /* ZERO WORK REG                 */ 00629000
         SLR   R4,R4                                               0183 00630000
*   GEN;                                                           0184 00631000
         IC    R4,ORG(R3)               PUT NO. OF CHARS TO BE MOVED    00632000
*                                       IN WORK REG                     00633000
         LR    R3,R4                                                    00634000
         SLL   R4,DBLMOV                MOVE LNG TO HI-ORDER HALF-BYTE  00635000
*                                       AND DOUBLE FOR RECEIVING        00636000
*                                       FIELD LENGTH                    00637000
         OR    R3,R4                    PUT LNG OF RECEIVING FIELD IN   00638000
*                                       REG 3. NOW REG HAS BOTH LENGTH  00639000
*                                       OF SENDING AND RECEIVING FLDS   00640000
*   R4=BUFRPTR;                     /* POINT TO INPUT BUFFER         */ 00641000
         L     R4,BUFRPTR(,WTABPTR)                                0185 00642000
*   R5=ADDR(OUTBUFFR);              /* POINT TO OUTPUT BUFFER        */ 00643000
         L     R5,OBUFRPTR(,WTABPTR)                               0186 00644000
*   GEN;                                                           0187 00645000
         EX    R3,UNPACK                UNPACK DATA TO BE PRINTED       00646000
         TR    0(TEN,R5),TRTABLE        TRANSLATE TO EBCDIC             00647000
         SRL   R3,MOVRITE               MOVE RECEIVING LENGTH TO        00648000
*                                       LOW-ORDER HALF BYTE OF REG      00649000
         AR    R5,R3                    POINT PAST TRANSLATED DATA      00650000
         MVI   ORG(R5),BLANK            BLANK SIGN THAT MAY BE LEFT     00651000
*                                       FROM UNPK INSTRUCTION           00652000
*EXIT:                                                             0188 00653000
*   RETURN;                         /* RETURN TO CALLER              */ 00654000
@EL00002 DS    0H                                                  0188 00655000
@EF00002 DS    0H                                                  0188 00656000
@ER00002 LM    @14,@12,12(@13)                                     0188 00657000
         BR    @14                                                 0188 00658000
*   END XLATE;                                                     0189 00659000
         B     @EL00002                                            0189 00660000
*   GEN DATA;                                                      0190 00661000
*   END IMDUSRFF;                                                  0191 00662000
@EL00001 DS    0H                                                  0191 00663000
@EF00001 DS    0H                                                  0191 00664000
@ER00001 LM    @14,@12,12(@13)                                     0191 00665000
         BR    @14                                                 0191 00666000
@DATA    DS    0H                                                       00667000
@DATD    DSECT                                                          00668000
         DS    0F                                                       00669000
IMDUSRFF CSECT                                                          00670000
         DS    0F                                                       00671000
@CF00240 DC    F'1'                                                     00672000
@CF00066 DC    F'3'                                                     00673000
@CF00629 DC    F'10'                                                    00674000
@CF00089 DC    F'12'                                                    00675000
@CF00241 DC    F'109'                                                   00676000
@DATD    DSECT                                                          00677000
         DS    0D                                                       00678000
IMDUSRFF CSECT                                                          00679000
         DS    0F                                                       00680000
@SIZDATD DC    AL1(0)                                                   00681000
         DC    AL3(@ENDDATD-@DATD)                                      00682000
         DS    0D                                                       00683000
@CC00674 DC    C'VOL'                                                   00684000
         DS    CL1                                                      00685000
SCANTBLE DS    CL244                                                    00686000
         ORG   SCANTBLE                                                 00687000
CODE04   DS    CL12                                                     00688000
         ORG   CODE04                                                   00689000
IOBCODE  DC    AL1(4)                                                   00690000
IOBCBPTR DC    AL3(FORMON)                                              00691000
IOBDPTR  DC    AL4(IOBD)                                                00692000
IOBTPTR  DC    AL4(IOB)                                                 00693000
         ORG   SCANTBLE+12                                              00694000
CODE08   DS    CL12                                                     00695000
         ORG   CODE08                                                   00696000
TIOTCODE DC    AL1(8)                                                   00697000
TIOCBPTR DC    AL3(TIOTMON)                                             00698000
TIOTPTR  DC    AL4(TIOTD)                                               00699000
TIOTTPTR DC    AL4(TIOT)                                                00700000
         ORG   SCANTBLE+24                                              00701000
CODE0C   DS    CL12                                                     00702000
         ORG   CODE0C                                                   00703000
JVOLCODE DC    AL1(12)                                                  00704000
JVLCBPTR DC    AL3(FORMON)                                              00705000
JVOLDPTR DC    AL4(JVOLD)                                               00706000
JVOLTPTR DC    AL4(JFCBVOLS)                                            00707000
         ORG   SCANTBLE+36                                              00708000
CODE10   DS    CL12                                                     00709000
         ORG   CODE10                                                   00710000
TLBLCODE DC    AL1(16)                                                  00711000
TLBCBPTR DC    AL3(TLBLMON)                                             00712000
TLBLDPTR DC    AL4(LBL1D)                                               00713000
TLBLTPTR DC    AL4(LBL1)                                                00714000
         ORG   SCANTBLE+48                                              00715000
CODE14   DS    CL12                                                     00716000
         ORG   CODE14                                                   00717000
JDSNCODE DC    AL1(20)                                                  00718000
JDSCBPTR DC    AL3(FORMON)                                              00719000
JDSNDPTR DC    AL4(JDSND)                                               00720000
JDSNTPTR DC    AL4(JFCBDSNM)                                            00721000
         ORG   SCANTBLE+60                                              00722000
CODE18   DS    CL12                                                     00723000
         ORG   CODE18                                                   00724000
VLBLCODE DC    AL1(24)                                                  00725000
VLBCBPTR DC    AL3(FORMON)                                              00726000
VLBLDPTR DC    AL4(VLBLD)                                               00727000
VLBLTPTR DC    AL4(VOLLABEL)                                            00728000
         ORG   SCANTBLE+72                                              00729000
CODE1C   DS    CL12                                                     00730000
         ORG   CODE1C                                                   00731000
DSCBCODE DC    AL1(28)                                                  00732000
DSCCBPTR DC    AL3(FORMON)                                              00733000
DSCBDPTR DC    AL4(F1DSCBD)                                             00734000
DSCBTPTR DC    AL4(F1DSCB)                                              00735000
         ORG   SCANTBLE+84                                              00736000
CODE20   DS    CL12                                                     00737000
         ORG   CODE20                                                   00738000
CCWCODE  DC    AL1(32)                                                  00739000
CCWCBPTR DC    AL3(DUPMON)                                              00740000
CCWDPTR  DC    AL4(CCWD)                                                00741000
CCWTPTR  DC    AL4(CCW)                                                 00742000
         ORG   SCANTBLE+96                                              00743000
CODE24   DS    CL12                                                     00744000
         ORG   CODE24                                                   00745000
UCBCODE  DC    AL1(36)                                                  00746000
UCBCBPTR DC    AL3(UCBMON)                                              00747000
UCBDPTR  DC    AL4(UCBD)                                                00748000
UCBTPTR  DC    AL4(UCB)                                                 00749000
         ORG   SCANTBLE+108                                             00750000
CODE28   DS    CL12                                                     00751000
         ORG   CODE28                                                   00752000
DCBCODE  DC    AL1(40)                                                  00753000
DCBCBPTR DC    AL3(FORMON)                                              00754000
DCBDPTR  DC    AL4(DCBD)                                                00755000
DCBTPTR  DC    AL4(DCB)                                                 00756000
         ORG   SCANTBLE+120                                             00757000
CODE34   DS    CL12                                                     00758000
         ORG   CODE34                                                   00759000
JELNCODE DC    AL1(52)                                                  00760000
JELCBPTR DC    AL3(FORMON)                                              00761000
JELNDPTR DC    AL4(JFCELNMD)                                            00762000
JELNTPTR DC    AL4(JFCBELNM)                                            00763000
         ORG   SCANTBLE+132                                             00764000
CODE38   DS    CL12                                                     00765000
         ORG   CODE38                                                   00766000
DEXLCODE DC    AL1(56)                                                  00767000
DEXCBPTR DC    AL3(DUPMON)                                              00768000
DEXLDPTR DC    AL4(DCBXLSTD)                                            00769000
DEXLPTR  DC    AL4(DCBEXLST)                                            00770000
         ORG   SCANTBLE+144                                             00771000
CODE48   DS    CL12                                                     00772000
         ORG   CODE48                                                   00773000
WK1CODE  DC    AL1(72)                                                  00774000
WK1CBPTR DC    AL3(FORMON)                                              00775000
WK1DPTR  DC    AL4(WKAREA1D)                                            00776000
WK1TPTR  DC    AL4(WKAREA1)                                             00777000
         ORG   SCANTBLE+156                                             00778000
CODE4C   DS    CL12                                                     00779000
         ORG   CODE4C                                                   00780000
WK2CODE  DC    AL1(76)                                                  00781000
WK2CBPTR DC    AL3(FORMON)                                              00782000
WK2DPTR  DC    AL4(WKAREA2D)                                            00783000
WK2TPTR  DC    AL4(WKAREA2)                                             00784000
         ORG   SCANTBLE+168                                             00785000
CODE50   DS    CL12                                                     00786000
         ORG   CODE50                                                   00787000
WK3CODE  DC    AL1(80)                                                  00788000
WK3CBPTR DC    AL3(FORMON)                                              00789000
WK3DPTR  DC    AL4(WKAREA3D)                                            00790000
WK3TPTR  DC    AL4(WKAREA3)                                             00791000
         ORG   SCANTBLE+180                                             00792000
CODE54   DS    CL12                                                     00793000
         ORG   CODE54                                                   00794000
WK4CODE  DC    AL1(84)                                                  00795000
WK4CBPTR DC    AL3(FORMON)                                              00796000
WK4DPTR  DC    AL4(WKAREA4D)                                            00797000
WK4TPTR  DC    AL4(WKAREA4)                                             00798000
         ORG   SCANTBLE+192                                             00799000
CODE64   DS    CL12                                                     00800000
         ORG   CODE64                                                   00801000
WK5CODE  DC    AL1(100)                                                 00802000
WK5CBPTR DC    AL3(FORMON)                                              00803000
WK5DPTR  DC    AL4(WKAREA5D)                                            00804000
WK5TPTR  DC    AL4(WKAREA5)                                             00805000
         ORG   SCANTBLE+204                                             00806000
CODE58   DS    CL12                                                     00807000
         ORG   CODE58                                                   00808000
F2DSCODE DC    AL1(88)                                                  00809000
F2DCBPTR DC    AL3(FORMON)                                              00810000
F2DSDPTR DC    AL4(F2DSCBD)                                             00811000
F2DSTPTR DC    AL4(F2DSCB)                                              00812000
         ORG   SCANTBLE+216                                             00813000
CODE5C   DS    CL12                                                     00814000
         ORG   CODE5C                                                   00815000
F3DSCODE DC    AL1(92)                                                  00816000
F3DCBPTR DC    AL3(FORMON)                                              00817000
F3DSDPTR DC    AL4(F3DSCBD)                                             00818000
F3DSTPTR DC    AL4(F3DSCB)                                              00819000
         ORG   SCANTBLE+228                                             00820000
CODE60   DS    CL12                                                     00821000
         ORG   CODE60                                                   00822000
WTGCODE  DC    AL1(96)                                                  00823000
WTGCBPTR DC    AL3(FORMON)                                              00824000
WTGDPTR  DC    AL4(WTGTBLD)                                             00825000
WTGTPTR  DC    AL4(WTGTBL)                                              00826000
         ORG   SCANTBLE+240                                             00827000
CODE00   DS    CL4                                                      00828000
         ORG   CODE00                                                   00829000
STOPCODE DC    A(0)                                                     00830000
         ORG   SCANTBLE+244                                             00831000
IOBD     DC    5AL1(1)                                                  00832000
         DC    AL1(3)                                                   00833000
         DC    AL1(1)                                                   00834000
         DC    AL1(3)                                                   00835000
         DC    AL1(4)                                                   00836000
         DC    AL1(1)                                                   00837000
         DC    AL1(0)                                                   00838000
         DC    AL1(3)                                                   00839000
         DC    AL1(1)                                                   00840000
         DC    AL1(3)                                                   00841000
         DC    AL1(4)                                                   00842000
         DC    2AL1(2)                                                  00843000
         DC    3AL1(4)                                                  00844000
         DC    AL1(0)                                                   00845000
         DC    AL1(1)                                                   00846000
IOB      DC    CL109'IOB      IOBFLG1   IOBFLG2   IOBSENS0  IOBSENS1  IC00847000
               OBECBCC  IOBECBPT  IOBFLG3   IOBCSW              IOBSIOCC00848000
               C'                                                       00849000
         DC    CL109'         IOBSTART  RESERVED  IOBDCBPT  IOBRESTR  IC00850000
               OBINCAM  IOBERRCT  /IOB EXTENSION'                       00851000
TIOTD    DC    4AL1(1)                                                  00852000
         DC    2AL1(4)                                                  00853000
         DC    AL1(3)                                                   00854000
         DC    AL1(1)                                                   00855000
         DC    3AL1(0)                                                  00856000
TIOT     DC    CL109'TIOT TT  TIOELNGH  TIOESTTA  TIOEWTCT  TIOELINK  TC00857000
               IOEDDNM            TIOEJFCB  TIOESTTC'                   00858000
JVOLD    DC    AL1(4)                                                   00859000
         DC    AL1(2)                                                   00860000
         DC    AL1(4)                                                   00861000
         DC    AL1(2)                                                   00862000
         DC    AL1(4)                                                   00863000
         DC    AL1(2)                                                   00864000
         DC    AL1(4)                                                   00865000
         DC    AL1(2)                                                   00866000
         DC    AL1(4)                                                   00867000
         DC    AL1(2)                                                   00868000
         DC    AL1(1)                                                   00869000
JFCBVOLS DC    CL109'JFCBVOLS (VOL SER 1)         (VOL SER 2)         (C00870000
               VOL SER 3)         (VOL SER 4)         (VOL SER 5)'      00871000
LBL1D    DC    AL1(3)                                                   00872000
         DC    AL1(1)                                                   00873000
         DC    4AL1(4)                                                  00874000
         DC    AL1(1)                                                   00875000
         DC    AL1(4)                                                   00876000
         DC    AL1(2)                                                   00877000
         DC    AL1(4)                                                   00878000
         DC    AL1(0)                                                   00879000
         DC    2AL1(4)                                                  00880000
         DC    AL1(2)                                                   00881000
         DC    AL1(4)                                                   00882000
         DC    AL1(2)                                                   00883000
         DC    AL1(4)                                                   00884000
         DC    AL1(2)                                                   00885000
         DC    AL1(1)                                                   00886000
         DC    AL1(4)                                                   00887000
         DC    AL1(2)                                                   00888000
         DC    AL1(0)                                                   00889000
         DC    3AL1(4)                                                  00890000
         DC    AL1(1)                                                   00891000
         DC    AL1(4)                                                   00892000
         DC    AL1(3)                                                   00893000
         DC    4AL1(0)                                                  00894000
         DC    AL1(1)                                                   00895000
LBL1     DC    CL109'LBL 1    FL1LABI   FL1NO     FL1ID                C00896000
                                            FL1FILSR            FL1VOLSC00897000
               Q'                                                       00898000
         DC    CL109'         FL1FILSQ  FL1GNO    FL1VNG    FL1CRDT    C00899000
                        FL1EXPDT            FL1FSEC   FL1BLKCT'         00900000
         DC    CL109'         FL1SYSCD                                RC00901000
               ESERVED'                                                 00902000
JDSND    DC    10AL1(4)                                                 00903000
         DC    AL1(2)                                                   00904000
         DC    AL1(4)                                                   00905000
         DC    9AL1(0)                                                  00906000
         DC    AL1(1)                                                   00907000
JFCBDSNM DC    CL109'JFCBDSNM'                                          00908000
VLBLD    DC    AL1(3)                                                   00909000
         DC    AL1(1)                                                   00910000
         DC    AL1(4)                                                   00911000
         DC    AL1(2)                                                   00912000
         DC    AL1(1)                                                   00913000
         DC    AL1(4)                                                   00914000
         DC    AL1(2)                                                   00915000
         DC    AL1(4)                                                   00916000
         DC    AL1(0)                                                   00917000
         DC    AL1(4)                                                   00918000
         DC    AL1(3)                                                   00919000
         DC    2AL1(4)                                                  00920000
         DC    AL1(2)                                                   00921000
         DC    5AL1(4)                                                  00922000
         DC    AL1(0)                                                   00923000
         DC    2AL1(4)                                                  00924000
         DC    AL1(2)                                                   00925000
         DC    7AL1(0)                                                  00926000
         DC    AL1(1)                                                   00927000
         DS    2XL1                                                     00928000
VOLLABEL DC    CL109'VOL LBL  VOLLABI   VOLNO     VOLSERNO            RC00929000
               ESERVED    VOLVTOC/RESERVED   RESERVED'                  00930000
         DC    CL109'         RESERVED            VOLOWNER             C00931000
                         RESERVED'                                      00932000
         DC    CL109'         RESERVED'                                 00933000
F1DSCBD  DC    AL1(1)                                                   00934000
         DC    AL1(4)                                                   00935000
         DC    2AL1(2)                                                  00936000
         DC    2AL1(3)                                                  00937000
         DC    3AL1(1)                                                  00938000
         DC    AL1(0)                                                   00939000
         DC    AL1(0)                                                   00940000
         DC    3AL1(4)                                                  00941000
         DC    AL1(1)                                                   00942000
         DC    AL1(4)                                                   00943000
         DC    AL1(3)                                                   00944000
         DC    AL1(2)                                                   00945000
         DC    2AL1(1)                                                  00946000
         DC    AL1(2)                                                   00947000
         DC    AL1(0)                                                   00948000
         DC    AL1(2)                                                   00949000
         DC    AL1(1)                                                   00950000
         DC    AL1(2)                                                   00951000
         DC    AL1(1)                                                   00952000
         DC    AL1(4)                                                   00953000
         DC    AL1(3)                                                   00954000
         DC    2AL1(2)                                                  00955000
         DC    2AL1(4)                                                  00956000
         DC    AL1(0)                                                   00957000
         DC    AL1(2)                                                   00958000
         DC    2AL1(4)                                                  00959000
         DC    AL1(2)                                                   00960000
         DC    2AL1(4)                                                  00961000
         DC    AL1(2)                                                   00962000
         DC    AL1(4)                                                   00963000
         DC    AL1(1)                                                   00964000
         DC    AL1(0)                                                   00965000
         DC    AL1(1)                                                   00966000
F1DSCB   DC    CL109'F1 DSCB  DS1FMTID  DS1DSSN             DS1VOLSQ  DC00967000
               S1CREDT  DS1EXPDT  DS1NOEPV  DS1NOBDB  RESERVED'         00968000
         DC    CL109'         DS1SYSCD                                RC00969000
               ESERVED            DS1DSORG  DS1RECFM  DS1OPTCD  DS1BLKLC00970000
               '                                                        00971000
         DC    CL109'         DS1LRECL  DS1KEYL   DS1RKP    DS1DSIND  DC00972000
               S1SCALO  DS1LSTAR  DS1TRBAL  RESERVED  DS1EXT1'          00973000
         DC    CL109'                   DS1EXT2                       DC00974000
               S1EXT3                       DS1PTRDS'                   00975000
CCWD     DC    AL1(1)                                                   00976000
         DC    AL1(3)                                                   00977000
         DC    2AL1(1)                                                  00978000
         DC    AL1(2)                                                   00979000
         DC    6AL1(0)                                                  00980000
CCW      DC    CL109'CCW      COMMAND   DATA ADDR FLAGS     RESERVED  BC00981000
               YTE CT'                                                  00982000
UCBD     DC    10AL1(1)                                                 00983000
         DC    AL1(0)                                                   00984000
         DC    3AL1(1)                                                  00985000
         DC    AL1(3)                                                   00986000
         DC    AL1(4)                                                   00987000
         DC    2AL1(2)                                                  00988000
         DC    3AL1(0)                                                  00989000
         DC    AL1(0)                                                   00990000
         DC    9AL1(4)                                                  00991000
         DC    AL1(0)                                                   00992000
         DC    AL1(1)                                                   00993000
UCB      DC    CL109'UCB COMM SRTEJBNR  UCBFLS    UCBID     SRTESTAT  UC00994000
               CBCHA    UCBUA     UCBFL1    UCBDTI    UCBETI    UCBSTI' 00995000
         DC    CL109'         UCBLCI    UCBATI    UCBWGT    UCBNAME   UC00996000
               CBTYP    UCBLTS    UCBSNS'                               00997000
DCBD     DC    5AL1(4)                                                  00998000
         DC    6AL1(0)                                                  00999000
         DC    AL1(1)                                                   01000000
         DC    AL1(3)                                                   01001000
         DC    2AL1(2)                                                  01002000
         DC    AL1(4)                                                   01003000
         DC    AL1(1)                                                   01004000
         DC    AL1(3)                                                   01005000
         DC    AL1(1)                                                   01006000
         DC    AL1(3)                                                   01007000
         DC    AL1(2)                                                   01008000
         DC    AL1(0)                                                   01009000
         DC    AL1(2)                                                   01010000
         DC    AL1(1)                                                   01011000
         DC    AL1(3)                                                   01012000
         DC    AL1(1)                                                   01013000
         DC    6AL1(0)                                                  01014000
         DC    AL1(0)                                                   01015000
         DC    AL1(3)                                                   01016000
         DC    9AL1(4)                                                  01017000
         DC    AL1(2)                                                   01018000
         DC    2AL1(4)                                                  01019000
         DC    8AL1(0)                                                  01020000
         DC    AL1(1)                                                   01021000
DCB      DC    CL109'DCB      DEVICE INTERFACE'                         01022000
         DC    CL109'         DCBBUFNO  DCBBUFCB  DCBBUFL   DCBDSORG  DC01023000
               CBIOBAD  DCBHIARC  DCBEODAD  DCBRECFM  DCBEXLST  DCBTIOTC01024000
               '                                                        01025000
         DC    CL109'         DCBMACRF  DCBIFLGS  DCBDEBAD  DCBOFLGS'   01026000
         DC    CL109'         ACCESS  METHOD INTERFACE'                 01027000
JFCELNMD DC    2AL1(4)                                                  01028000
         DC    8AL1(0)                                                  01029000
         DC    AL1(1)                                                   01030000
JFCBELNM DC    CL109'JFCBELNM'                                          01031000
DCBXLSTD DC    AL1(4)                                                   01032000
         DC    10AL1(0)                                                 01033000
DCBEXLST DC    CL109'DCBEXLST'                                          01034000
WKAREA1D DC    10AL1(4)                                                 01035000
         DC    AL1(0)                                                   01036000
         DC    10AL1(4)                                                 01037000
         DC    AL1(0)                                                   01038000
         DC    5AL1(4)                                                  01039000
         DC    5AL1(0)                                                  01040000
         DC    AL1(1)                                                   01041000
WKAREA1  DC    CL109'WKAREA 1 VOL LBL, FILE LBL, DSCBS, OR MSG AREA   +C01042000
               10       +14       +18       +1C       +20       +24'    01043000
         DC    CL109'         +28       +2C       +30       +34       +C01044000
               38       +3C       +40       +44       +48       +4C'    01045000
         DC    CL109'         +50       +54       +58       +5C       +C01046000
               60'                                                      01047000
WKAREA2D DC    10AL1(4)                                                 01048000
         DC    AL1(0)                                                   01049000
         DC    3AL1(4)                                                  01050000
         DC    AL1(1)                                                   01051000
         DC    AL1(3)                                                   01052000
         DC    AL1(4)                                                   01053000
         DC    2AL1(3)                                                  01054000
         DC    2AL1(1)                                                  01055000
         DC    AL1(0)                                                   01056000
         DC    2AL1(2)                                                  01057000
         DC    2AL1(4)                                                  01058000
         DC    2AL1(3)                                                  01059000
         DC    4AL1(1)                                                  01060000
         DC    AL1(0)                                                   01061000
         DC    AL1(2)                                                   01062000
         DC    3AL1(1)                                                  01063000
         DC    AL1(3)                                                   01064000
         DC    AL1(2)                                                   01065000
         DC    2AL1(1)                                                  01066000
         DC    2AL1(2)                                                  01067000
         DC    AL1(0)                                                   01068000
         DC    2AL1(1)                                                  01069000
         DC    AL1(4)                                                   01070000
         DC    2AL1(1)                                                  01071000
         DC    AL1(2)                                                   01072000
         DC    2AL1(1)                                                  01073000
         DC    2AL1(0)                                                  01074000
         DC    AL1(0)                                                   01075000
         DC    7AL1(4)                                                  01076000
         DC    AL1(2)                                                   01077000
         DC    AL1(1)                                                   01078000
         DC    AL1(3)                                                   01079000
         DC    AL1(0)                                                   01080000
         DC    AL1(3)                                                   01081000
         DC    AL1(1)                                                   01082000
         DC    AL1(3)                                                   01083000
         DC    AL1(1)                                                   01084000
         DC    2AL1(3)                                                  01085000
         DC    AL1(2)                                                   01086000
         DC    2AL1(3)                                                  01087000
         DC    AL1(1)                                                   01088000
         DC    AL1(0)                                                   01089000
         DC    AL1(1)                                                   01090000
         DC    9AL1(0)                                                  01091000
         DC    AL1(1)                                                   01092000
WKAREA2  DC    CL109'WKAREA 2 JFCB-JFCBDSNM'                            01093000
         DC    CL109'         (CONT.)   JFCBELNM            JFCBTSDM  JC01094000
               FCDSCB   JFCFCBID  JFCAMPTR  JFCRDBPT  JFCBLTYP  JFCBOTTC01095000
               R/'                                                      01096000
         DC    CL109'         /JFCBFLSQ JFCBVLSQ  JFCBMASK            JC01097000
               FCBCRDT  JFCBXPDT  JFCBIND1  JFCBIND2  JFCBUFNO  JFCBHIAC01098000
               R'                                                       01099000
         DC    CL109'         JFCBUFL   JFCEROPT  DEV CHAR  JFCDEN    JC01100000
               FCLIMCT  JFCDSORG  JFCRECFM  JFCOPTCD  JFCBLKSI  JFCLRECC01101000
               L'                                                       01102000
         DC    CL109'         JFCNCP    JFCNTM    SEGMENTS            JC01103000
               FCCPRI   JFCSOWA   RESERVED  JFCBNVOL'                   01104000
         DC    CL109'         JFCBVOLS                                 C01105000
                                                      JFCBEXTL  JFCBEXAC01106000
               D'                                                       01107000
         DC    CL109'         JFCBPQTY  JFCBCTRI  JFCBSQTY  RESERVED  JC01108000
               FCBDQTY  JFCBSPNM  JFCBABST  JFCBSBNM  JFCBDRLH  JFCBVLCC01109000
               T'                                                       01110000
         DC    CL109'         JFCBSPTN'                                 01111000
WKAREA3D DC    AL1(4)                                                   01112000
         DC    9AL1(0)                                                  01113000
         DC    AL1(0)                                                   01114000
         DC    AL1(1)                                                   01115000
         DC    AL1(0)                                                   01116000
         DC    4AL1(1)                                                  01117000
         DC    AL1(3)                                                   01118000
         DC    AL1(1)                                                   01119000
         DC    AL1(3)                                                   01120000
         DC    AL1(1)                                                   01121000
         DC    AL1(0)                                                   01122000
         DC    AL1(1)                                                   01123000
         DC    AL1(2)                                                   01124000
         DC    AL1(1)                                                   01125000
         DC    AL1(3)                                                   01126000
         DC    AL1(1)                                                   01127000
         DC    AL1(3)                                                   01128000
         DC    AL1(4)                                                   01129000
         DC    2AL1(2)                                                  01130000
         DC    AL1(0)                                                   01131000
         DC    AL1(0)                                                   01132000
         DC    2AL1(4)                                                  01133000
         DC    8AL1(0)                                                  01134000
         DC    AL1(0)                                                   01135000
         DC    AL1(4)                                                   01136000
         DC    AL1(0)                                                   01137000
         DC    AL1(1)                                                   01138000
         DC    AL1(3)                                                   01139000
         DC    4AL1(1)                                                  01140000
         DC    2AL1(0)                                                  01141000
         DC    AL1(0)                                                   01142000
         DC    AL1(1)                                                   01143000
         DC    AL1(3)                                                   01144000
         DC    AL1(1)                                                   01145000
         DC    AL1(3)                                                   01146000
         DC    AL1(1)                                                   01147000
         DC    AL1(0)                                                   01148000
         DC    AL1(3)                                                   01149000
         DC    AL1(1)                                                   01150000
         DC    AL1(3)                                                   01151000
         DC    AL1(1)                                                   01152000
         DC    AL1(0)                                                   01153000
         DC    AL1(3)                                                   01154000
         DC    6AL1(2)                                                  01155000
         DC    3AL1(0)                                                  01156000
         DC    AL1(0)                                                   01157000
         DC    AL1(4)                                                   01158000
         DC    9AL1(0)                                                  01159000
         DC    AL1(1)                                                   01160000
WKAREA3  DC    CL109'WKAREA 3 DXECB'                                    01161000
         DC    CL109'       * IOB-IOBFLAG1        IOBFLAG2  IOBSENS0  IC01162000
               OBSENS1  IOBECBCC  IOBECBPT  IOBFLAG3  IOBCOMAD  IOBSTATC01163000
               0'                                                       01164000
         DC    CL109'         IOBSTAT1  IOBCNT    IOBSIOCC  IOBSTART  IC01165000
               OBWGHT   IOBDCBPT  IOBRESTR  IOBINCAM  IOBERRCT'         01166000
         DC    CL109'         DXDAADDR'                                 01167000
         DC    CL109'       * DEB-DXDEBDEB        DEBOFLGS  DEBIRBAD  DC01168000
               EBOPATB  DEBQSCNT  DEBFLGS1  RESERVED'                   01169000
         DC    CL109'         DEBNMEXT  DEBUSRPG  DEBPRIOR  DEBECBAD  DC01170000
               EBPROTG/DEBDEBID   DEBDCBAD  DEBEXSCL  DEBAPPAD  DEBDVMOC01171000
               D'                                                       01172000
         DC    CL109'         DEBUCBAD  DEBBINUM  DEBSTRCC  DEBSTRHH  DC01173000
               EBENDCC  DEBENDHH  DEBNMTRK'                             01174000
         DC    CL109'       * DCB-DCBIFLGS/DCBDEBAD'                    01175000
WKAREA4D DC    10AL1(4)                                                 01176000
         DC    AL1(0)                                                   01177000
         DC    4AL1(4)                                                  01178000
         DC    6AL1(0)                                                  01179000
         DC    AL1(0)                                                   01180000
         DC    AL1(4)                                                   01181000
         DC    AL1(0)                                                   01182000
         DC    7AL1(4)                                                  01183000
         DC    AL1(0)                                                   01184000
         DC    AL1(0)                                                   01185000
         DC    AL1(2)                                                   01186000
         DC    AL1(0)                                                   01187000
         DC    AL1(2)                                                   01188000
         DC    AL1(3)                                                   01189000
         DC    AL1(1)                                                   01190000
         DC    2AL1(4)                                                  01191000
         DC    3AL1(0)                                                  01192000
         DC    AL1(0)                                                   01193000
         DC    2AL1(2)                                                  01194000
         DC    AL1(3)                                                   01195000
         DC    AL1(1)                                                   01196000
         DC    6AL1(0)                                                  01197000
         DC    AL1(1)                                                   01198000
WKAREA4  DC    CL109'WKAREA 4 7 CCW''S-DXCCW1      DXCCW2              C01199000
               DXCCW3              DXCCW4              DXCCW5'          01200000
         DC    CL109'         DXCCW6              DXCCW7'               01201000
         DC    CL109'       * REG SAVE-DXREG9     DXREGA    DXREGB    DC01202000
               XREGC    DXREGD    DXREGE    DXREG0    DXREG1'           01203000
         DC    CL109'       * MOD IDS-DXCALLID    DXRETID   DXRETTTR  DC01204000
               XRETCOD  (RESERVED)'                                     01205000
         DC    CL109'         DXABCODE  DXSAVID   DXSAVADR  DXSAVOFF'   01206000
WKAREA5D DC    6AL1(4)                                                  01207000
         DC    AL1(2)                                                   01208000
         DC    AL1(4)                                                   01209000
         DC    AL1(2)                                                   01210000
         DC    AL1(0)                                                   01211000
         DC    AL1(0)                                                   01212000
         DC    AL1(4)                                                   01213000
         DC    4AL1(2)                                                  01214000
         DC    4AL1(1)                                                  01215000
         DC    AL1(0)                                                   01216000
         DC    AL1(0)                                                   01217000
         DC    10AL1(4)                                                 01218000
         DC    AL1(0)                                                   01219000
         DC    2AL1(4)                                                  01220000
         DC    2AL1(2)                                                  01221000
         DC    2AL1(4)                                                  01222000
         DC    4AL1(0)                                                  01223000
         DC    AL1(0)                                                   01224000
         DC    6AL1(4)                                                  01225000
         DC    4AL1(0)                                                  01226000
         DC    AL1(1)                                                   01227000
WKAREA5  DC    CL109'WKAREA 5 DXWORK    DXWORK1   DXWORK2   DXWORK3   DC01228000
               XWORK4   DXVOLSR1            DXVOLSR2'                   01229000
         DC    CL109'         DXVOLSR3            DXVOLSEQ  DXNOUNIT  DC01230000
               XUNITOF  DXRESSW   DXWKEYSV  DXUKEY    DXEXTSW'          01231000
         DC    CL109'         DXASCBAD  DXTCBADR  DXJSCBAD  DXDSABQD  DC01232000
               XDSABAD  DXDSAB    DXDEBXAD  DXTIOTAD  DXUCBADR  DXUCBSAC01233000
               V'                                                       01234000
         DC    CL109'         DXUDCBAD  DXPDCBAD  DXUDCBPL  DXUDCBML  DC01235000
               XPRPARC  DXMSGADR'                                       01236000
         DC    CL109'         DXATCOM1  DXATCOM2  DXATCOM3  DXATCOM4  DC01237000
               XATEXC1  DXATEXC2'                                       01238000
F2DSCBD  DC    AL1(1)                                                   01239000
         DC    AL1(4)                                                   01240000
         DC    AL1(2)                                                   01241000
         DC    AL1(4)                                                   01242000
         DC    AL1(1)                                                   01243000
         DC    AL1(4)                                                   01244000
         DC    AL1(3)                                                   01245000
         DC    AL1(4)                                                   01246000
         DC    AL1(1)                                                   01247000
         DC    AL1(4)                                                   01248000
         DC    AL1(0)                                                   01249000
         DC    3AL1(4)                                                  01250000
         DC    AL1(3)                                                   01251000
         DC    3AL1(1)                                                  01252000
         DC    AL1(3)                                                   01253000
         DC    AL1(2)                                                   01254000
         DC    AL1(1)                                                   01255000
         DC    AL1(0)                                                   01256000
         DC    6AL1(1)                                                  01257000
         DC    AL1(2)                                                   01258000
         DC    AL1(3)                                                   01259000
         DC    AL1(2)                                                   01260000
         DC    AL1(1)                                                   01261000
         DC    AL1(0)                                                   01262000
         DC    AL1(4)                                                   01263000
         DC    AL1(1)                                                   01264000
         DC    AL1(4)                                                   01265000
         DC    AL1(3)                                                   01266000
         DC    AL1(4)                                                   01267000
         DC    AL1(3)                                                   01268000
         DC    AL1(4)                                                   01269000
         DC    AL1(3)                                                   01270000
         DC    2AL1(4)                                                  01271000
         DC    AL1(0)                                                   01272000
         DC    AL1(4)                                                   01273000
         DC    AL1(1)                                                   01274000
         DC    AL1(4)                                                   01275000
         DC    AL1(1)                                                   01276000
         DC    AL1(4)                                                   01277000
         DC    AL1(1)                                                   01278000
         DC    2AL1(4)                                                  01279000
         DC    2AL1(2)                                                  01280000
         DC    AL1(0)                                                   01281000
         DC    2AL1(2)                                                  01282000
         DC    AL1(3)                                                   01283000
         DC    AL1(4)                                                   01284000
         DC    AL1(1)                                                   01285000
         DC    5AL1(0)                                                  01286000
         DC    AL1(1)                                                   01287000
F2DSCB   DC    CL109'F2 DSCB           DS22MIND            DS2L2MEN    C01288000
                       DS23MIND            DS2L3MIN            RESERVEDC01289000
               '                                                        01290000
         DC    CL109'         RESERVED                                DC01291000
               S2FMTID  DS2NOLEV  DS2DVIND  DS21RCYL  DS2LTCYL  DS2CYLOC01292000
               V'                                                       01293000
         DC    CL109'         DS2HIRIN  DS2HIRPD  DS2HIROV  DS2RSHTR  DC01294000
               S2HIRTI  RESERVED  DS2TAGDT  DS2RORG3  DS2NOBYT  DS2NOTRC01295000
               K'                                                       01296000
         DC    CL109'         DS2PRCTR  DS2STIND  DS2CYLAD            DC01297000
               S2ADLIN            DS2ADHIN            DS2LPRAD'         01298000
         DC    CL109'         DS2LTRAD            DS2LCYAD            DC01299000
               S2LMSAD            DS2LOVAD            DS2BYOVL  DS2RORGC01300000
               2'                                                       01301000
         DC    CL109'         DS2OVRCT  DS2RORG1  DS2NIRT   DS2PTRDS'   01302000
F3DSCBD  DC    2AL1(4)                                                  01303000
         DC    AL1(2)                                                   01304000
         DC    2AL1(4)                                                  01305000
         DC    AL1(2)                                                   01306000
         DC    2AL1(4)                                                  01307000
         DC    AL1(2)                                                   01308000
         DC    2AL1(0)                                                  01309000
         DC    2AL1(4)                                                  01310000
         DC    AL1(2)                                                   01311000
         DC    AL1(1)                                                   01312000
         DC    2AL1(4)                                                  01313000
         DC    AL1(2)                                                   01314000
         DC    2AL1(4)                                                  01315000
         DC    AL1(2)                                                   01316000
         DC    AL1(2)                                                   01317000
         DC    2AL1(4)                                                  01318000
         DC    AL1(2)                                                   01319000
         DC    2AL1(4)                                                  01320000
         DC    AL1(2)                                                   01321000
         DC    2AL1(4)                                                  01322000
         DC    AL1(2)                                                   01323000
         DC    AL1(0)                                                   01324000
         DC    AL1(2)                                                   01325000
         DC    2AL1(4)                                                  01326000
         DC    AL1(2)                                                   01327000
         DC    2AL1(4)                                                  01328000
         DC    AL1(2)                                                   01329000
         DC    2AL1(4)                                                  01330000
         DC    AL1(2)                                                   01331000
         DC    AL1(0)                                                   01332000
         DC    AL1(2)                                                   01333000
         DC    2AL1(4)                                                  01334000
         DC    AL1(2)                                                   01335000
         DC    7AL1(0)                                                  01336000
         DC    AL1(1)                                                   01337000
F3DSCB   DC    CL109'F3 DSCB            DS3EXTNT'                       01338000
         DC    CL109'                                       DS3FMTID  DC01339000
               S3ADEXT'                                                 01340000
WTGTBLD  DC    AL1(4)                                                   01341000
         DC    2AL1(2)                                                  01342000
         DC    5AL1(4)                                                  01343000
         DC    AL1(2)                                                   01344000
         DC    AL1(0)                                                   01345000
         DC    AL1(0)                                                   01346000
         DC    AL1(2)                                                   01347000
         DC    AL1(4)                                                   01348000
         DC    AL1(1)                                                   01349000
         DC    AL1(3)                                                   01350000
         DC    6AL1(0)                                                  01351000
         DC    AL1(1)                                                   01352000
WTGTBL   DC    CL109'WTG TBL  WTGMODNM            WTGMODID  WTGMODEP  NC01353000
               OT USED  WTGPREFX  NOT USED'                             01354000
         DC    CL109'         WTGPATHS  *WTGENTRY-WTGIDTTR  WTGCORE'    01355000
DEVENT   DC    CL109'DEV ENT  TIOESTTB  TIOEFSRT'                       01356000
UCBDEV   DC    CL109'UCB    * DEVICE DEPENDENT SECTION                +C01357000
               28       +2C       +30       +34       +38'              01358000
LBL2     DC    CL109'LBL 2    FL2ABI    FL2NO     FL2RECFM  FL2BLKL    C01359000
                        FL2LRECL            FL2DEN    FL2ILP'           01360000
         DC    CL109'         FL2JOBD             FL2JSSP   FL2STEPD   C01361000
                        FL2TRTCH  FL2CNTRL  RESERVED  FL2BLKA   RESERVEC01362000
               D'                                                       01363000
         DC    CL109'         RESERVED'                                 01364000
TIOTDEVD DC    AL1(1)                                                   01365000
         DC    AL1(3)                                                   01366000
         DC    8AL1(0)                                                  01367000
         DC    AL1(2)                                                   01368000
LBL2D    DC    AL1(3)                                                   01369000
         DC    2AL1(1)                                                  01370000
         DC    AL1(4)                                                   01371000
         DC    AL1(1)                                                   01372000
         DC    AL1(4)                                                   01373000
         DC    3AL1(1)                                                  01374000
         DC    AL1(0)                                                   01375000
         DC    AL1(0)                                                   01376000
         DC    2AL1(4)                                                  01377000
         DC    AL1(1)                                                   01378000
         DC    2AL1(4)                                                  01379000
         DC    AL1(2)                                                   01380000
         DC    3AL1(1)                                                  01381000
         DC    AL1(4)                                                   01382000
         DC    AL1(0)                                                   01383000
         DC    9AL1(4)                                                  01384000
         DC    AL1(1)                                                   01385000
         DC    AL1(1)                                                   01386000
@DATD    DSECT                                                          01387000
*                                       /*                    Y02080  * 01388000
IMDUSRFF CSECT                                                   Y02080 01389000
DBLMOV   EQU   5                                                        01390000
TEN      EQU   10                                                       01391000
ORG      EQU   0                                                        01392000
MOVRITE  EQU   4                                                        01393000
BLANK    EQU   C' '                                                     01394000
UNPACK   UNPK  ORG(0,R5),ORG(0,R4)                                      01395000
TRTABLE  DC    240C' '                                                  01396000
         DC    C'0123456789ABCDEF'                                      01397000
@DATD    DSECT                                                          01398000
*                                       /* XCTLTABL             Y02080* 01399000
IMDUSRFF CSECT                                                   Y02080 01400000
         XCTLTABL SVC=000,BRT=YES,LENGTH=                        Y02080 01401000
@DATD    DSECT                                                          01402000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01403000
@ENDDATD EQU   *                                                        01404000
IMDUSRFF CSECT                                                          01405000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01406000
@01      EQU   01                                                       01407000
@02      EQU   02                                                       01408000
@03      EQU   03                                                       01409000
@04      EQU   04                                                       01410000
@05      EQU   05                                                       01411000
@06      EQU   06                                                       01412000
@07      EQU   07                                                       01413000
@08      EQU   08                                                       01414000
@09      EQU   09                                                       01415000
@10      EQU   10                                                       01416000
@11      EQU   11                                                       01417000
@12      EQU   12                                                       01418000
@13      EQU   13                                                       01419000
@14      EQU   14                                                       01420000
@15      EQU   15                                                       01421000
WTABPTR  EQU   @12                                                      01422000
CBMONREG EQU   @02                                                      01423000
R1       EQU   @01                                                      01424000
R2       EQU   @02                                                      01425000
RD       EQU   @13                                                      01426000
R3       EQU   @03                                                      01427000
R4       EQU   @04                                                      01428000
R5       EQU   @05                                                      01429000
GPARM    EQU   0                                                        01430000
INPTR    EQU   GPARM                                                    01431000
OUTPTR   EQU   GPARM+4                                                  01432000
DATAPTR  EQU   GPARM+16                                                 01433000
GCORPTR  EQU   GPARM+24                                                 01434000
WORKTABL EQU   0                                                        01435000
SAVAREA  EQU   WORKTABL                                                 01436000
SACALLER EQU   SAVAREA+4                                                01437000
SACALLED EQU   SAVAREA+8                                                01438000
CBMONPTR EQU   WORKTABL+72                                              01439000
BUFRPTR  EQU   WORKTABL+76                                              01440000
DTBLPTR  EQU   WORKTABL+80                                              01441000
TTBLPTR  EQU   WORKTABL+84                                              01442000
OBUFRPTR EQU   WORKTABL+88                                              01443000
GPARMPTR EQU   WORKTABL+92                                              01444000
SCANPTR  EQU   WORKTABL+96                                              01445000
LNGTH    EQU   WORKTABL+100                                             01446000
COUNT    EQU   WORKTABL+102                                             01447000
CBMONCTR EQU   WORKTABL+104                                             01448000
FLGBFR   EQU   WORKTABL+106                                             01449000
FLAGS    EQU   FLGBFR                                                   01450000
BASDSCAN EQU   0                                                        01451000
TRCCODE  EQU   BASDSCAN                                                 01452000
CBPTR    EQU   BASDSCAN+1                                               01453000
DPNTR    EQU   BASDSCAN+4                                               01454000
TITLPTR  EQU   BASDSCAN+8                                               01455000
OUTBUFFR EQU   0                                                        01456000
INBUFFER EQU   0                                                        01457000
DATA     EQU   0                                                        01458000
TITLET   EQU   0                                                        01459000
DATAT    EQU   0                                                        01460000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01461000
@NM00001 EQU   SAVAREA                                                  01462000
GFMTPPT  EQU   GPARM+28                                                 01463000
GFMTRPT  EQU   GPARM+20                                                 01464000
EIDPTR   EQU   GPARM+12                                                 01465000
OPTPTR   EQU   GPARM+8                                                  01466000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01467000
@RT00073 EQU   CALCBMN                                                  01468000
@RT00079 EQU   RETURN8                                                  01469000
@RT00081 EQU   BLDTBL                                                   01470000
@RT00097 EQU   PRNTDAT                                                  01471000
@RT00111 EQU   EODATA                                                   01472000
@RT00115 EQU   EODATA                                                   01473000
@RT00154 EQU   DEVENTRY                                                 01474000
@RT00157 EQU   DEVDATA                                                  01475000
@RT00167 EQU   NOT                                                      01476000
EXIT     EQU   @EL00002                                                 01477000
@RT00179 EQU   EXIT                                                     01478000
@ENDDATA EQU   *                                                        01479000
         END   IMDUSRFF,(C'PLS1646',0602,75005)                         01480000
./  ADD  SSI=50050115,NAME=READPSWD
         TITLE 'READPSWD                      READ PASSWORD ROUTINE - AS00200002
               SK THE OPERATOR FOR PASSWORD'                     Y02134 00250002
READPSWD CSECT                                                          01000021
*********************************************************************** 01005002
*                                                                     * 01010002
*        VS2 RELEASE 03 DELETIONS/CHANGES                             * 01012003
*0000371000                                                     ZA01517 01014003
*                                                                     * 01014403
* MODULE NAME = READPSWD (OS/VS2)                                     * 01015002
*                                                                     * 01020002
* DESCRIPTIVE NAME = READ PASSWORD ROUTINE                            * 01025002
*                                                                     * 01030002
* COPYRIGHT = NONE                                                    * 01035002
*                                                                     * 01040002
* STATUS = RELEASE 2, LEVEL 0                                         * 01045002
*                                                                     * 01050002
* FUNCTION =                                                          * 01055002
*                                                                     * 01060002
*        1. INCREMENTS THE TRY COUNT IN THE SECURITY WORK AREA.       * 01065002
*           THE OPERATOR WILL GET TWO TRIES TO RESPOND CORRECTLY.     * 01070002
*                                                                     * 01075002
*        2. FOR A NON-TSO TERMINAL TASK, THIS ROUTINE ISSUES MESSAGE  * 01080002
*           IEC301A S TO THE OPERATOR AND WAITS FOR HIS REPLY         * 01085002
*           BEFORE PASSING CONTROL TO IFG0195U.                       * 01086002
*                                                                     * 01090002
*        3. FOR A TSO TERMINAL TASK, IF THE TRY COUNT IS 1,           * 01095002
*           MESSAGE IEC113A IS ISSUED. IF THE TRY COUNT IS 2,         * 01100002
*           MESSAGES IEC115I AND IEC116A PRECEDE IEC113A.             * 01101002
*                                                                     * 01105002
* NOTES = REQUESTS TO TSO TERMINALS ARE PRECEDED WITH A BYPASS        * 01205002
*         PRINT CHARACTER TO PREVENT THE PASSWORD FROM BEING          * 01206002
*         TYPED AT THE TERMINAL WHEN IT IS KEYED IN.                  * 01207002
*                                                                     * 01210002
*    DEPENDENCIES =                                                   * 01215002
*                                                                     * 01220002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 01225002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 01230002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 01235002
*                                                                     * 01240002
*    RESTRICTIONS = NONE                                              * 01245002
*                                                                     * 01250002
*    REGISTER CONVENTIONS = SEE IECEQU MACRO.                         * 01255002
*                                                                     * 01260002
*    PATCH LABEL = SEE XCTLTABL MACRO.                                * 01265002
*                                                                     * 01270002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 01275002
*                                                                     * 01280002
*    PROCESSOR = ASSEMBLER XF                                         * 01285002
*                                                                     * 01290002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 01295002
*                  ORG STATEMENT AT END OF LISTING                    * 01300002
*                                                                     * 01305002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 01310002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 01315002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 01320002
*                                                                     * 01325002
* ENTRY POINT = READPSWD FROM IFG0195V OR IFG0195U.                   * 01330002
*                                                                     * 01335002
*    PURPOSE = TO REQUEST A PASSWORD FROM THE OPERATOR AND KEEP       * 01340002
*              A COUNT OF THE NUMBER OF TIMES IT IS REQUESTED.        * 01345002
*                                                                     * 01355002
*    LINKAGE =                                                        * 01360002
*        IECRES LOAD,MODNM=READPSWD,PREFIX=WTGPREFX,BRANCH=DIRECT     * 01365002
*                                                                     * 01370002
* INPUT = AS FOLLOWS -                                                * 01375002
*                                                                     * 01380002
*        R4 = ADDRESSABILITY TO FORCORE-LIKE WORK AREA.               * 01385002
*        R6 = ADDRESSABILITY TO WTG TABLE.                            * 01390002
*        RD = ADDRESSABILITY TO SECCORE WORK AREA                     * 01395002
*                                                                     * 01400002
* OUTPUT = PASSWORD AT MYREPLY IN SECCORE.                            * 01405002
*                                                                     * 01410002
* EXIT-NORMAL = IFG0195U - READ OR UPDATE PASSWORD RECORD.            * 01430002
*                                                                     * 01450002
* EXIT-ERROR =  IFG0195U TO ISSUE ERROR MESSAGE.                      * 01455002
*                                                                     * 01460002
* EXTERNAL REFERENCES = SEE BELOW                                     * 01465002
*                                                                     * 01470002
*    ROUTINES = IFG0195U.                                             * 01475002
*                                                                     * 01480002
*    DATA AREAS = IECDSECS SECCORE,MAIN,WTG,PREFX,RRPL                * 01485002
*                                                                     * 01490002
*    CONTROL BLOCK = CVT,TCB,JSCB,PSCB,UPT,DSAB,UCB,TIOT,ASCB.        * 01495002
*                                                                     * 01500002
* TABLES = SEE XCTLTABL MACRO.                                        * 01505002
*                                                                     * 01510002
* MACROS = WTOR,WAIT,IECRES,TCLEARQ,TGET,TPUT,                        * 01515002
*          XCTLTABL,IECDSECS,IECEQU.                                  * 01516002
*                                                                     * 01520002
* CHANGE ACTIVITY =                                                   * 01525003
*   VS2 RELEASE 3 DELETIONS                                    Z30TSRJ* 01527003
*                                                                     * 01530002
*********************************************************************** 01535002
         EJECT                                                          01540002
*                                                                       26800021
         USING FORCORE,RCORE            POINTS TO OPEN-LIKE WA   Y02134 26850002
         USING WTG,RWTG                 DEFINE BASE TO XCTL/WTG TABLE   27000021
         USING TIOENTRY,RTIOT           DEFINE BASE TO TIOT DD ENTRY    27200021
         USING SECCORE,RD               DEFINE BASE TO SECURITY WK AREA 27600021
         USING DSAB,RB                  RB WILL POINT TO DSAB    Y02134 27650002
*                                                                       27800021
         BALR  RBASE,R0                 ESTABLISH BASE REGISTER         28000002
         USING *,RBASE                  DEFINE BASE REGISTER            28200021
*                                                                Y02134 28250002
         EJECT                                                          28300002
*                                                                Y02134 28350002
*****************************************************************Y02134 28360002
*                                                                       28400021
*        INCREMENT TRY COUNT                                     Y02134 28600002
*        THE TRY COUNT IS CHECKED IN IFG0195U                    Y02134 28610002
*        THE OPERATOR IS GIVEN TWO TRIES TO SUPPLY               Y02134 28620002
*        THE CORRECT PASSWORD.                                   Y02134 28630002
*                                                                Y02134 28650002
*****************************************************************Y02134 28700002
*                                                                       28800021
         XR    R1,R1                    CLEAR REG FOR IC INST    Y02134 29000002
         IC    R1,MYCODE2               GET TRY COUNT            Y02134 29050002
         LA    R1,K1(R1)                INCREMENT TRY COUNT BY 1 Y02134 29200002
         STC   R1,MYCODE2               STORE COUNT BACK         Y02134 29300002
*                                                                Y02134 29350002
         L     R1,MYASCB                LOAD ASCB ADDRESS        Y02134 29400002
         L     RF,ASCBTSB-ASCB(,R1)     LOAD TSB ADDRESS         Y02134 29450002
         LTR   RF,RF                    TEST FOR TERMINAL TASK   Y02134 29500002
         BNZ   OSQ44000                 BRANCH IF TERMINAL TASK  Y02134 29550002
*                                                                       32800021
*********************************************************************** 33000021
*                                                                       33200021
*  CONSTRUCT 'IEC301A S JOB JOBNAMEX,STEP STEPNAME,DDNAME DDNAMEXX'     33400021
*  MESSAGE WITH OPTIONAL ',CONC000' IF CONCATENATED.                    33600021
*                                                                Y02134 33610002
*****************************************************************Y02134 33650002
*                                                                       33800021
OSQ41000 EQU   *                        CONSTRUCT MESSAGE               34000002
*                                                                       34005002
         MVC   MYMCSFLG(OSQ4830L),OSQ4830K  TURN ON MCS FLAG IN MSG AND 34200021
*                                       MOVE 'IEC301A S JOB ' TO MSG    34400021
*                                                                       34600021
         CLI   MYCODE1,K2               CHECK IF RENAME          YM7895 34650002
         BE    OSQ41500                 BRANCH IF RENAME         YM7895 34700002
         CLI   MYCODE1,K3               CHECK IF SCRATCH         YM7895 34750002
         BE    OSQ41500                 BRANCH IF SCRATCH        YM7895 34800002
*                                                                YM7895 34850002
         L     R1,MYTCB                 GET CURRENT TCB ADDR            35800002
         L     R1,TCBTIO-TCB(,R1)       GET TIOT ADDRESS                36000021
         MVC   MYMJOBN,TIOCNJOB-TIOT(R1)  JOB NAME TO MESSAGE           36200021
         MVC   MYMSTEP,OSQ4835K         ',STEP ' TO MESSAGE             36400021
         MVC   MYMSTEPN,TIOCSTEP-TIOT(R1)  JOB STEP TO MESSAGE          36600021
         MVC   MYMDDNM,OSQ4840K         ',DDNAME ' TO MESSAGE           36800021
*                                                                       37000021
         L     RB,MYDSAB                LOAD CURRENT DSAB        Y02134 37050002
         XR    RC,RC                    CLEAR CONCATENATION CTR ZA01517 37100003
*                                                                Y02134 37150002
OSQ41200 EQU   *                        LOOP TO FIND DDNAME      Y02134 37160002
*                                                                Y02134 37170002
         L     RTIOT,DSABTIOT           LOAD TIOT ENTRY          Y02134 37180002
         CLI   TIOEDDNM,BLANK           IS DD NAME PRESENT              37200021
         BNE   OSQ41300                 BRANCH IF YES            Y02134 37400002
*                                                                Y02134 37450002
         LA    RC,K1(RC)                INCREMENT COUNTER        Y02134 37500002
         L     RB,DSABBCHN              LOAD PREVIOUS DSAB       Y02134 37550002
         LTR   RB,RB                    TEST IF PREVIOUS         Y02134 37560002
         BNZ   OSQ41200                 BRANCH IF PREVIOUS       Y02134 37570002
         XR    RC,RC                    CLEAR CONCATENATION CNTR Y02134 37580002
*                                                                       37600021
OSQ41300 EQU   *                        MOVE IN DDNAME           Y02134 37650002
*                                                                Y02134 37700002
         MVC   MYMDDNMN,TIOEDDNM        DD NAME TO MESSAGE              37800021
         LA    R1,MYMDDNMN+K7           POINT TO LAST CHAR OF DDNAME    38000021
*                                                                Y02134 38200002
         LTR   RC,RC                    CHECK FOR CONCATENATION  Y02134 38250002
         BZ    OSQ42200                 BRANCH IF NONE           Y02134 38300002
*                                                                Y02134 38350002
         LA    RC,K1(,RC)               INCREMENT FOR FIRST     ZA01517 38400003
*        CONCATENATION NUMBER WILL START AT 2                           38450003
*        TO BE COMPATIBLE WITH PROBLEM DETERMINATION MESSAGE            38500003
         CVD   RC,DXWORK                CONVERT NO. TO DECIMAL   Y02134 42400002
         UNPK  MYMCONCN,DXWORK+K4       CONCATENATION NUMBER     YM7052 42600002
         OI    MYMCONCN+K2,ZONEOF       REMOVE SIGN BITS                42800021
         MVC   MYMCONC,OSQ4845K         ',CONC' TO MESSAGE              43000021
         LA    R1,MYMCONCN+K2           POINT TO LAST CHAR OF CONC000   43200021
         B     OSQ42200                 BRANCH TO ISSUE MSG      YM7895 43250002
*                                                                Y02134 43400002
OSQ41500 EQU   *                        SCRATCH OR RENAME MSG    YM7895 43500002
*                                                                YM7895 43550002
*****************************************************************YM7895 43600002
*                                                                YM7895 43650002
*  CONSTRUCT 'IEC301A S DSNAME DSNXX FOR SCRATCH AND RENAME      YM7895 43700002
*                                                                YM7895 43800002
*****************************************************************YM7895 43850002
*                                                                YM7895 43900002
         MVC   MYMDSN(MYMDSNN-MYMDSN),OSQ4855K SETUP DSNAME      YM7895 43950002
         MVC   MYMDSNN(L'MYDSN),MYDSN   DSNAME TO MESSAGE        YM7895 44000002
*                                                                YM7895 44050002
         LA    R1,MYMDSNN+L'MYDSN       POINT TO END OF MSG      YM7895 44100002
*                                                                YM7895 44150002
OSQ42000 EQU   *                        LOOP TO FIND END         YM7895 44200002
*                                                                YM7895 44250002
         CLI   MYDSN-MYDSN(R1),BLANK    CHECK IF AT END          YM7895 44300002
         BNE   OSQ42200                 BRANCH IF AT END         YM7895 44350002
         BCT   R1,OSQ42000              BACK UP/CHECK NEXT       YM7895 44400002
*                                                                YM7895 44450002
OSQ42200 EQU   *                        PREPARE TO ISSUE MESSAGE        45600002
*                                                                Y02134 45800002
         MVC   K1(K4,R1),OSQ4850K       MOVE IN DESC & ROUT CODES       46800021
         LA    RF,MYMSIZE-K1            ADDR START OF MSG-1             47000021
         SR    R1,RF                    CALCULATE MESSAGE LENGTH        47200021
         STH   R1,MYMSIZE               STORE MESSAGE LENGTH            47400021
*                                                                       47600021
*********************************************************************** 47800021
*********************************************************************** 48000021
*********************************************************************** 48200021
*********************************************************************** 48400021
*********************************************************************** 48600021
***                                                                 *** 48800021
***THE SECTION OF CODE BELOW, ENCLOSED BY COMMENTS, IS THE ONLY     *** 49000021
***SECTION OF THIS MODULE (READPSWD) WHICH CAN BE REPLACED BY THE   *** 49200021
***USER IN ORDER TO ENTER A PASSWORD FOR A SECURITY-PROTECTED DATA  *** 49400021
***SET. THE REPLACED CODE BELOW ENTERS THE PASSWORD FROM THE CONSOLE*** 49600021
***USING A WTOR. THE SECURITY WORK AREA DEFINED BY THE              *** 49800021
***DSECT SECCORE CONTAINS THE MESSAGE IEC301A S JOB..... FORMATTED  *** 50000021
***PROPERLY FOR OPEN,EOV,SCRATCH OR RENAME AND THE FIELDS WITHIN THIS** 50200021
***MESSAGE MAY BE USED AS REQUIRED. NOTE THAT WHEN THE FOLLOWING    *** 50400021
***CODE IS REPLACED, THE SYSTEM MESSAGE IEC301A..... NO LONGER      *** 50600021
***APPEARS ON THE CONSOLE. SAVE AND RESTORE REGISTERS, IF WORK      *** 50800021
***REGISTERS ARE NEEDED. GET/FREEMAIN NEEDED CORE, IF ADDITIONAL    *** 51000021
***WORK AREA IS REQUIRED. THE NET RESULT OF THIS REPLACED CODE IS   *** 51200021
***THAT THE 8-CHARACTER PASSWORD, LEFT-JUSTIFIED AND PADDED WITH    *** 51400021
***BLANKS, MUST BE PLACED IN LOCATION MYREPLY IN THE DSECT SECCORE. *** 51600021
***                                                                 *** 51800021
         LA    R1,MYREPLY               PUT ADDRESS OF REPLY            52000021
         ST    R1,MYRPLADR              INTO MYRPLADR                   52200021
         MVI   MYRPLLTH,L'MYREPLY       SET REPLY LENGTH TO 8           52400021
         LA    R1,MYECB                 PUT ECB ADDRESS          Y02134 52600002
         ST    R1,MYRPLECB              INTO MYRPLECB                   52800021
         MVI   MYECB,K0                 CLEAR ECB                Y02134 53000002
         MVI   MYREPLY,BLANK            SET REPLY                       53200002
         MVC   MYREPLY+K1(K7),MYREPLY   AREA TO BLANKS                  53400021
*                                                                       53600021
         WTOR  MF=(E,MYRPLLTH)          WRITE MESSAGE TO OPERATOR       53800021
*                                                                       54000021
         WAIT  ECB=MYECB,LONG=YES       WAIT LONG FOR REPLY     Z30TSRJ 54200003
***                                                                 *** 54400021
***THE ABOVE SECTION OF CODE IS THE ONLY SECTION IN THIS MODULE     *** 54600021
***WHICH CAN BE REPLACED.                                           *** 54800021
***                                                                 *** 55000021
*********************************************************************** 55200021
*********************************************************************** 55400021
*********************************************************************** 55600021
*********************************************************************** 55800021
*********************************************************************** 56000021
*                                                                       56200021
OSQ43000 EQU   *                        GO GET PASSWORD RECORD          56400002
*                                                                Y02134 56450002
         IECRES LOAD,MODNM=IFG0195U,BRCODE=K0,                   Y02134X56500002
               PREFIX=WTGPREFX,BRANCH=DIRECT                     Y02134 56550002
         EJECT                                                          56600002
*                                                                       58600021
*********************************************************************** 58800021
*                                                                       59000021
*        TPUT MESSAGE IEC113A TO TSO USER FOR PASSWORD                  59400021
*                                                                       59600021
*****************************************************************Y02134 59650002
*                                                                Y02134 59700002
OSQ44000 EQU   *                        CHECK TRY COUNT                 60200002
*                                                                       62400021
         CLI   MYCODE2,K1               CHECK FOR FIRST TRY      Y02134 62450002
         BNE   OSQ45000                 BRANCH IF NOT FIRST      Y02134 62500002
*                                                                Y02134 62550002
         MVC   MYMIEC(L'OSQ4860K),OSQ4860K  SET MESSAGE ID AND BODY     62600021
         MVC   MYMIEC+K36(K44),MYDSN    MOVE DSNAME TO MESSAGE   Y02134 62800002
*                                                                       63000021
*    SCAN FOR END OF DSNAME FIELD                                       63200021
*                                                                       63400021
         LA    RF,MYMIEC+K35+K44        POINT TO LAST CHAR OF DSNAME    63600021
*                                                                       63800021
OSQ44200 CLI   0(RF),BLANK              IS THIS NON-BLANK               64000021
         BNE   OSQ44400                 BR IF YES                       64200021
         BCT   RF,OSQ44200              REPEAT IF NON-BLANK NOT FOUND   64400021
*                                                                       64600021
BYPASS   EQU   X'24'                    BYPASS PRINT CHAR               64605002
OSQ44400 MVI   K1(RF),BYPASS            INSERT PRINT BYPASS CHAR        64800002
         LA    R0,K2(RF)                ADDR END OF MESSAGE + 1         65000021
         LA    R1,MYMIEC                POINT MSG BUFR TO INCLUDE ID    65200021
         SR    R0,R1                    GET MSG LENGTH           YM6920 65250002
*                                                                       65400021
OSQ44600 EQU   *                        ISSUE TSO MESSAGE        Y02134 65450002
*                                                                Y02134 65500002
         BAL   R2,OSQ47000              ISSUE MESSAGE            Y02134 67000002
         BAL   R2,OSQ46000              GET REPLY                Y02134 67050002
*                                                                       67200021
         CLI   MYRPLLTH,X'0C'           WAS REPLY TOO LONG              67400021
         BNE   OSQ43000                 BR IF NO TO CHECK PASSWORD      67600021
*                                                                       67800021
         TCLEARQ INPUT                  CLEAR INPUT QUEUE               68000021
*                                                                       68200021
         BR    RBASE                    RETURN TO REISSUE MSG    Y02134 68250002
*                                                                Y02134 68300002
         EJECT                                                          68350002
*                                                                Y02134 68360002
*********************************************************************** 68400021
*                                                                       68600021
*        TPUT MSG 'IEC115I INVALID PASSWORD' TO TERMINAL USER           69400021
*        TPUT MSG 'IEC116A REENTER-' TO REPROMPT TERMINAL USER          69600021
*                                                                       70400021
*****************************************************************Y02134 70450002
*                                                                Y02134 70500002
OSQ45000 EQU   *                        CHECK TRY COUNT                 70600002
*                                                                Y02134 70800002
         CLI   MYCODE2,K2               ALREADY TWO TRIES        Y02134 70850002
         BH    OSQ45500                 BRANCH IF ALREADY TWO    Y02134 70900002
*                                                                       71000021
*****************************************************************Y02134 71050002
*                                                                Y02134 71100002
*        TPUT MSG 'IEC115I INVALID PASSWORD' TO TERMINAL USER    Y02134 71150002
*                                                                Y02134 71200002
*****************************************************************Y02134 71250002
*                                                                Y02134 71300002
         MVC   MYMIEC(L'OSQ4870K),OSQ4870K  SET MESSAGE ID AND BODY     76000021
         LA    R0,L'OSQ4870K            SET LENGTH TO INCL ID           76200021
         LA    R1,MYMIEC                POINT MSG BUFR TO INCL ID       76400021
*                                                                       76600021
         BAL   R2,OSQ47000              ISSUE MESSAGE            Y02134 76650002
*                                                                       78400021
*****************************************************************Y02134 78450002
*                                                                Y02134 78500002
*        TPUT MSG 'IEC116A REENTER-' TO REPROMPT TERMINAL USER   Y02134 78552002
*                                                                Y02134 78560002
*****************************************************************Y02134 78570002
*                                                                Y02134 78580002
         MVC   MYMIEC(L'OSQ4880K),OSQ4880K  SET MESSAGE ID AND BODY     78600021
         LA    R1,MYMIEC                SET BUFR ADDR TO INCLUDE ID     78800021
         LA    R0,L'OSQ4880K            SET LENGTH TO INCLUDE ID        79000021
         B     OSQ44600                 PROMPT USER              Y02134 79050002
         EJECT                                                          79100002
*                                                                Y02134 79110002
*****************************************************************Y02134 79150002
*                                                                Y02134 79160002
*        RETURN TO ISSUE ERROR MESSAGE                           Y02134 79170002
*                                                                Y02134 79180002
*****************************************************************Y02134 79190002
*                                                                Y02134 79192002
OSQ45500 EQU   *                        GO ISSUE ERROR MESSAGE   Y02134 79194002
*                                                                Y02134 79196002
         MVI   MYERRCOD,K22             SET ERROR CODE           Y02134 79200002
         IECRES LOAD,MODNM=IFG0195U,BRCODE=K8,                   Y02134X79210002
               PREFIX=WTGPREFX,BRANCH=DIRECT                     Y02134 79220002
         EJECT                                                          79270002
*                                                                Y02134 79800002
*********************************************************************** 82800021
*                                                                       83000021
*        GET USER REPLY                                          Y02134 83010002
*                                                                Y02134 83050002
*****************************************************************Y02134 83100002
*                                                                Y02134 83150002
OSQ46000 EQU   *                        GET TERMINAL RESPONSE           83200002
*                                                                Y02134 83400002
         LA    R0,L'MYREPLY             SET MAX REPLY LENGTH TO 8       84000021
         LA    R1,MYREPLY               POINT TO REPLY ADDRESS          84200021
         O     R1,OSQ4894K              SET TGET WAIT OPTION            84400021
         TGET  (1),(0),R                ISSUE TGET                      84600021
         STC   RF,MYRPLLTH              SAVE TGET RETURN CODE           84800021
         OC    MYREPLY,OSQ4890K         FOLD REPLY TO UPPER CASE        85000021
*                                                                       85200021
RESTORE  EQU   X'14'                    RESTORE CHARACTER RESETS PRINT  85205002
         MVI   MYMAREA,RESTORE          PUT RESTORE CHAR IN BUFR        85400002
         LA    R0,K1                    SET MESSAGE LENGTH              85600021
         LA    R1,MYMAREA               POINT TO MESSAGE ADDRESS        85800021
*                                                                       86000021
         O     R1,OSQ4892K              SET TPUT ASIS OPTION            86400021
         TPUT  (1),(0),R                ISSUE TPUT                      86600021
         BR    RDCB                     RETURN TO MAINLINE              86800021
         EJECT                                                          86802002
*                                                                Y02134 86810002
*****************************************************************Y02134 86820002
*                                                                Y02134 86830002
*        ISSUE TPUT MESSAGE                                      Y02134 86832002
*        R0=LENGTH R1=POINTER TO MESSAGE R2=RETURN ADDRESS       Y02134 86834002
*                                                                Y02134 86840002
*****************************************************************Y02134 86842002
*                                                                Y02134 86844002
OSQ47000 EQU   *                        ISSUE TERMINAL MESSAGE   Y02134 86846002
*                                                                Y02134 86848002
         STCM  R0,B'0011',MYMCSFLG      SAVE LENGTH              Y02134 86850002
*                                                                Y02134 86900002
         L     RF,MYJSCB                GET JSCB ADDRESS         Y02134 86950002
         MVC   MYMSIZE(L'JSCBTJID),JSCBTJID-IEZJSCB(RF) ID       Y02134 86960002
         L     RF,JSCBPSCB-IEZJSCB(,RF) GET THE PSCB ADDRESS     Y02134 86970002
         LTR   RF,RF                    PSCB INITIALIZED         Y02134 86980002
         BZ    OSQ47100                 DEFAULT TPUT W/MSG ID    Y02134 86990002
*                                                                Y02134 86992002
         MODESET EXTKEY=ZERO            SWITCH TO KEY ZERO       YM6712 86992402
*                                                                Y02134 86992802
         L     RF,PSCBUPT-PSCB(,RF)     GET UPT ADDRESS          Y02134 86994002
         TM    UPTSWS-UPT(RF),UPTMID    IS MESSAGE ID REQUIRED   Y02134 86996002
         BO    OSQ47100                 BRANCH IF REQUIRED       Y02134 86998002
*                                                                Y02134 86998402
         MODESET EXTKEY=DATAMGT         RETURN TO DATAMGT KEY    YM6712 86998502
*                                                                Y02134 86998602
         ICM   R0,B'0011',MYMCSFLG      LOAD MESSAGE LENGTH      Y02134 86998802
         LA    RF,L'MYMIEC              LOAD ID LENGTH           Y02134 86999202
         SR    R0,RF                    GET NEW MESSAGE LENGTH   Y02134 86999602
         STCM  R0,B'0011',MYMCSFLG      SAVE LENGTH              Y02134 86999702
         LA    R1,MYMNOID               POINT PASSED MSG ID      Y02134 86999802
*                                                                Y02134 86999902
OSQ47100 EQU   *                        ISSUE MESSAGE            Y02134 87049902
*                                                                Y02134 87059902
         MODESET EXTKEY=DATAMGT         RETURN TO DATAMGT KEY    YM6712 87061902
*                                                                Y02134 87063902
         ICM   R0,B'1111',MYMSIZE       LOAD ID AND LENGTH       Y02134 87069902
         O     R1,OSQ4892K              SET TPUT ASIS OPTION     Y02134 87079902
         TPUT  (1),(0),R                ISSUE TPUT               Y02134 87089902
         BR    R2                       RETURN TO MAINLINE       Y02134 87091902
         EJECT                                                          87093902
*                                                                       87099902
*********************************************************************** 87200021
*                                                                       87400021
*        CONSTANTS                                                      87600021
*                                                                       87800021
*****************************************************************Y02134 87850002
*                                                                Y02134 87900002
OSQ4830K DC    X'8000'                  MCS MESSAGE FLAG                88800021
         DC    C'IEC301A S JOB '        FIXED PART OF MESSAGE           89000021
OSQ4830L EQU   *-OSQ4830K               LENGTH OF PART OF MSG           89200021
OSQ4835K DC    C',STEP '                FIXED PART OF MESSAGE           89400021
OSQ4840K DC    C',DDNAME '              FIXED PART OF MESSAGE           89600021
OSQ4845K DC    C',CONC'                 FIXED PART OF MESSAGE           89800021
OSQ4850K DC    X'40000080'              DESCRIPTOR, ROUTING CODES       90000021
OSQ4855K DC    C'DSNAME '               FIXED PART OF MESSAGE           90200021
*                                                                       90400021
OSQ4860K DC    C'IEC113A ENTER PASSWORD FOR DATA SET ' TSO MSG   Y02134 90600002
OSQ4870K DC    C'IEC115I INVALID PASSWORD ' TSO INVALID MESSAGE  Y02134 90800002
         ORG   *-1                      OVERLAY LAST MSG CHAR    Y02134 90850002
         DC    X'15'                    INSERT NEW LINE CHAR     Y02134 90900002
OSQ4880K DC    C'IEC116A REENTER- '     TSO REPROMT MESSAGE      Y02134 91200002
         ORG   *-1                      OVERLAY LAST MSG CHAR    Y02134 91250002
         DC    X'24'                    INSERT BYPASS PRINT CHAR Y02134 91300002
*                                                                       91600021
OSQ4890K DC    X'4040404040404040'      USED TO FOLD TSO REPLY TO       91800021
*                                       UPPER CASE                      92000021
OSQ4892K DC    0F'0',X'01000000'        TPUT W/ASIS OPTION              92200021
OSQ4894K DC    0F'0',X'80000000'        SVC 93 TGET OPTION              92400021
*                                                                       92600021
         XCTLTABL ID=(,IFG0195U),BRT=YES,LENGTH=                 Y02134 92800002
         IECDSECS CVT,TCB,JSCB,PSCB,UPT,DSAB,TIOT,UCB,ASCB,      Y02134X92850002
               SECCORE,MAIN,WTG,PREFX,EXPAND=YES                 Y02134 92950002
         IECEQU ,                       DEFINE EQUATES           Y02134 93050002
         END                                                            95200021
./  ADD  SSI=70670644,NAME=SECLOADA
         TITLE 'SECLOADA                      SCRATCH/RENAME/RESTART - P00200002
               PASSWORD SECURITY INITIALIZATION'                        00202002
SECLOADA CSECT                                                          00800021
*********************************************************************** 01000021
*                                                                     * 01200021
* MODULE NAME = SECLOADA (OS/VS2)                                     * 01250002
*                                                                     * 01300002
*              VS2 RELEASE 037 CHANGES                                * 01308037
*                                                                     * 01316037
*0000                                                          @ZA17953 01324037
*                                                                     * 01332037
*********************************************************************** 01340037
* DESCRIPTIVE NAME = SCRATCH/RENAME/RESTART PASSWORD                  * 01350002
*                    SECURITY INITIALIZATION                          * 01370002
*                                                                     * 01400002
* COPYRIGHT = NONE                                                    * 01450002
*                                                                     * 01500002
* STATUS = RELEASE 2, LEVEL 0                                         * 01550002
*                                                                     * 01600002
* FUNCTION =                                                          * 01650002
*                                                                     * 01700002
*        1. CHECKS FOR AUTHORIZED PASSWORD BYPASS IN THE JSCB.        * 01750002
*                                                                     * 01800002
*        2. OBTAINS FETCH PROTECTED SECURITY WORK AREA IN DATA        * 01850002
*           MANAGEMENT KEY (KEY 5).                                   * 01900002
*                                                                     * 01950002
*        3. INITIALIZES WORK AREA TO APPEAR SIMILAR TO OPEN/CLOSE/EOV * 02000002
*           WORK AREA (THIS IS DONE TO USE THE SAME ROUTINES TO       * 02050002
*           PROCESS A OPEN/EOV REQUEST - SEE IFG0195V).               * 02100002
*                                                                     * 02150002
*        4. SET INDICATOR FOR SCRATCH, RENAME, OR RESTART.            * 02200002
*                                                                     * 02250002
*        5. SET UP RETURN TO THIS ROUTINE WHEN SECURITY PROCESSING    * 02300002
*           HAS COMPLETED.                                            * 02350002
*                                                                     * 02400002
*        6. RETURNS TO CALLING ROUTINE WITH RETURN CODE WHEN          * 02450002
*           SECURITY PROCESSING IS COMPLETE.                          * 02500002
*                                                                     * 02600002
* NOTES = THIS ROUTINE IS AN INTERFACE ROUTINE BETWEEN SCRATCH,       * 02650002
*         RENAME, AND RESTART ANDTHE PASSWORD PROCESSING ROUTINES.    * 02700002
*         THE FUNCTION IN THIS ROUTINE IS SIMILAR TO THE FUNCTION     * 02750002
*         IN THE OPEN/EOV INTERFACE ROUTINE (IFG0195T).               * 02800002
*                                                                     * 02850002
*    DEPENDENCIES =                                                   * 02900002
*                                                                     * 02910002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 02950002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03000002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03050002
*            THIS ROUTINE ADHERES TO OPEN/CLOSE/EOV PROGRAMMING       * 03100002
*            CONVENTIONS AND REGISTER USAGE.                          * 03150002
*                                                                     * 03200002
*    RESTRICTIONS = NONE                                              * 03250002
*                                                                     * 03300002
*    REGISTER CONVENTIONS = SEE IECEQU MACRO.                         * 03350002
*                                                                     * 03400002
*    PATCH LABEL = SEE XCTLTABL MACRO.                                * 03450002
*                                                                     * 03500002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 03550002
*                                                                     * 03600002
*    PROCESSOR = ASSEMBLER XF                                         * 03650002
*                                                                     * 03700002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 03750002
*                  ORG STATEMENT AT END OF LISTING                    * 03800002
*                                                                     * 03850002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 03900002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 03950002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 04000002
*                                                                     * 04050002
* ENTRY POINT = SECLOADA                                              * 04100002
*                                                                     * 04250002
*    PURPOSE = SCRATCH/RENAME/RESTART INTERFACE ROUTINE TO            * 04300002
*              PASSWORD PROCESSING                                    * 04310002
*                                                                     * 04350002
*    LINKAGE = AS FOLLOWS -                                           * 04400002
*                                                                     * 04450002
*        IECRES LOAD,MODNM=SECLOADA,BRCODE=0,EXTPR=(RD),BRANCH=DIRECT * 04600002
*                                                                     * 04650002
* INPUT = AS FOLLOWS -                                                * 04700002
*                                                                     * 04750002
*        FOR RET (REG 14) = 0 (INITIAL ENTRY) -                       * 04800002
*        R1 = POINTER TO DSAB FOR DATA SET                            * 04850002
*        R4 = POINTER TO F1 DSCB IF DA                                * 04950002
*        R5 = POINTER TO DEB FOR RESTART                              * 05000002
*        RA = ID OF CALLER IN HI BYTE                                 * 05200002
*             2 = RENAME                                              * 05210002
*             3 = SCRATCH                                             * 05220002
*             4 = RESTART (DIRECT ACCESS)                             * 05230002
*             5 = RESTART (TAPE)                                      * 05240002
*        RB = POINTER TO DATA SET NAME                                * 05250002
*        RD = POINTER TO DADSM TYPE WORK AREA AND SAVE AREA           * 05300002
*                                                                     * 05350002
*        FOR RET (REG 14) = 4 (RETURNING FROM PASSWORD PROCESSING)    * 05400002
*        RD (REG 13) = POINTER TO SECURITY WORK AREA                  * 05450002
*                                                                     * 05500002
* OUTPUT = AS FOLLOWS -                                               * 05550002
*                                                                     * 05600002
*        WHEN RETURNING TO CALLER REGS 1 - 13 ARE RESTORED            * 05650002
*        HI ORDER BYTE OF REGISTER 10 CONTAINS A RETURN CODE          * 05660002
*                                                                     * 05700002
*        WHEN GOING TO PASSWORD PROCESSING -                          * 05750002
*        RCORE POINTS TO F1 DSCB FOR DA AND ZEROS FOR TAPE            * 05800002
*        RWTG POINTS TO SECURITY WTG TABLE                            * 05850002
*        RD POINTS TO SECURITY WORK AREA WITH FIELDS INITIALIZED      * 05900002
*        FOR RETURN SAVE AREA, DSNAME, DSCB, TCB, DSAB, AND JSCB.     * 05950002
*                                                                     * 06050002
* EXIT-NORMAL = AS FOLLOWS - TO CALLER                                * 06100002
*                                                                     * 06150002
*        RETURN TO RESTART -                                          * 06200002
*        IECRES LOAD,MODNM=IGC0N05B,BRCODE=0,EXTPR=(RD),BRANCH=DIRECT * 06300002
*                                                                     * 06350002
*        RETURN TO SCRATCH -                                          * 06360002
*        IECRES LOAD,MODNM=IGG0290A,BRCODE=0,EXTPR=(RD),BRANCH=DIRECT * 06370002
*                                                                     * 06372002
*        RETURN TO RENAME  -                                          * 06374002
*        IECRES LOAD,MODNM=IGG03001,BRCODE=0,EXTPR=(RD),BRANCH=DIRECT * 06376002
*                                                                     * 06380002
* EXIT-ERROR = AS ABOVE WITH CODE PASSED IN REG 10                    * 06400002
*                                                                     * 06450002
* EXTERNAL REFERENCES = SEE BELOW                                     * 06500002
*                                                                     * 06550002
*    ROUTINES = IFG0195V,IGG03001,IGG0290A,IGC0N05B.                  * 06600002
*                                                                     * 06650002
*    DATA AREAS = OPEN/EOV WORK AREA (SEE IECDSECS MAIN,WTG,PREFX.).  * 06700002
*                 SECURITY WORK AREA (SEE IECDSECS SECCORE).          * 06750002
*                                                                     * 06800002
*    CONTROL BLOCK = CVT,TCB,JSCB,DEB.                                * 06850002
*                                                                     * 06900002
* TABLES = SEE XCTLTABL.                                              * 06950002
*                                                                     * 07000002
* MACROS = IECRES,DMABCOND,XCTLTABL,IECDSECS,IECEQU.                  * 07050002
*                                                                     * 07100002
* CHANGE ACTIVITY = NEW RELEASE (LEVEL 0)                             * 07150002
*                                                                     * 07200002
*********************************************************************** 07250002
         EJECT                                                   Y02134 28200002
*                                                                Y02134 28450002
         BALR  RF,R0                    ESTABLISH BASE REGISTER  Y02134 28500002
         USING *,RF                     DEFINE BASE REGISTER     Y02134 28550002
*                                                                Y02134 28600002
         B     SRP00000(RET)            BR TO INDICATED FUNCTION Y02134 28650002
*                                                                Y02134 28700002
SRP00000 B     SRP01000                 RET=0 INITIAL ENTRY      Y02134 28750002
         B     SRP09000                 RET=4 RETURN ENTRY       Y02134 28800002
         EJECT                                                   Y02134 28950002
*                                                                Y02134 29000002
*****************************************************************Y02134 29050002
*                                                                Y02134 29100002
*        INITIAL ENTRY FROM SCRATCH/RENAME                       Y02134 29150002
*                                                                Y02134 29200002
*****************************************************************Y02134 29250002
*                                                                Y02134 29300002
SRP01000 EQU   *                        INITIAL ENTRY            Y02134 29350002
*                                                                Y02134 29400002
         XR    R0,R0                    SET ERROR CODE TO ZERO   YM5101 29450002
         USING IECREGSV,RD              RD POINTS TO SAVE AREA   Y02134 29460002
         STM   R0,RD,IECREGSV           SAVE REGS                Y02134 29500002
         DROP  RD                                                Y02134 29510002
*                                                                Y02134 29550002
         LR    R8,RD                    LOAD POINTER TO DADSM WA Y02134 29560002
         LA    R0,IECSTART-IECPREFX     GET PREFIX OFFSET        Y02134 29570002
         SR    R8,R0                    POINT TO PREFIX          Y02134 29580002
         USING IECPREFX,R8              RF POINTS TO PREFIX      Y02134 29582002
*                                                                Y02134 29590002
         L     R9,CVTPTR                LOAD CVT ADDRESS         Y02134 29610002
         USING CVT,R9                   R9 POINTS TO CVT         Y02134 29620002
         L     R9,CVTTCBP               LOAD TCB POINTERS        Y02134 29630002
         DROP  R9                                                Y02134 29640002
         L     R9,K4(,R9)               LOAD CURRENT TCB         Y02134 29642002
         USING TCB,R9                   R9 POINTS TO TCB         Y02134 29644002
         L     RA,TCBJSCB               RA POINTS TO JSCB        Y02134 29646002
         USING IEZJSCB,RA               RA POINTS TO JSCB        Y02134 29648002
         L     RA,JSCBACT               LOAD ACTIVE JSCB POINTER Y02134 29648402
         TM    JSCBSWT1,JSCBPASS        CHECK FOR BYPASS         Y02134 29700002
         BO    SRP09100                 AUTHORIZATION, BR IF YES Y02134 29750002
         DROP  RA,RF                                             Y02134 29760002
         EJECT                                                          29770002
*                                                                Y02134 29800002
*****************************************************************Y02134 29850002
*                                                                Y02134 29900002
*        GETMAIN SECURITY WORK AREA                              Y02134 29950002
*                                                                Y02134 30000002
*****************************************************************Y02134 30050002
*                                                                Y02134 30100002
         IECRES GET,LV=SECSIZE,SP=229,ID=SEWA,                   Y02134X30200002
               A=IECSTART-IECPREFX(R8),PREFIX=YES                Y02134 30250002
*                                                                Y02134 30300002
         BALR  RBASE,R0                 ESTABLISH ADDRESSABILITY Y02134 30302002
         USING *,RBASE                  ESTABLISH BASE REG       Y02134 30304002
*                                                                Y02134 30450002
         LA    RD,0(R1)                 LOAD SECURITY WORK AREA  Y02134 30500002
         USING SECCORE,RD               RD POINTS TO SEC WA      Y02134 30510002
         LA    R0,IECSTART-IECPREFX     LOAD PREFIX OFFSET       Y02134 30550002
         SR    R1,R0                    POINT TO PREFIX          Y02134 30600002
         ST    R1,MYPREFX               SAVE PREFIX POINTER      Y02134 30650002
*                                                                Y02134 30660002
         ST    R8,MYRETURN              SAVE RETURN SAVE AREA    Y02134 30700002
         ST    R9,MYTCB                 SAVE TCB ADDRESS         Y02134 30710002
         ST    RA,MYJSCB                SAVE JSCB ADDRESS        Y02134 30720002
*                                                                Y02134 30722002
         L     R1,IECREGSV+K4*R1        LOAD DSAB ADDRESS (REG 1)Y02134 30730002
         ST    R1,MYDSAB                SAVE DSAB ADDRESS        Y02134 30740002
*                                                                Y02134 30750002
         MVC   MYWTGWTO,WTOLEN          SET UP MODULE WTO        Y02134 30760002
         MVC   MYWTGNM,NAME             MODNM TO WTG TABLE       Y02134 30800002
         MVC   MYRETMOD,NAME            SET UP RETURN LOAD       Y02134 30850002
         MVI   MYRETCOD,K4              SET UP RETURN OFFSET     Y02134 30900002
*                                                                Y02134 30950002
         L     R1,IECREGSV+K4*RB        DSN POINTER (REG 11)     Y02134 31000002
         MVC   MYDSN,0(R1)              MOVE IN DSNAME           Y02134 31150002
*                                                                Y02134 32100002
         L     R1,IECREGSV+K4*RA        CALLER ID (REG 10)       Y02134 32110002
         STCM  R1,B'1000',MYCODE1       CALLER INDICATOR         Y02134 32150002
         MVI   MYDEBSYS,PLISTOUT        INDICATE OUTPUT          Y02134 32160002
*                                                                Y02134 32162002
         LA    RWTG,MYWTG               LOAD POINTER TO WTG TABL Y02134 32170002
         USING WTG,RWTG                 RWTG POINTS TO WTG TABLE Y02134 32180002
         OI    WTGPATHS,X01             SCRATCH/RENAME ENQ BYPAS Y02134 32190002
*                                                                Y02134 32190402
         LA    RCORE,MYDSCB             LOAD POINTER TO DSCB     Y02134 32192002
         USING FORCORE,RCORE            POINTS TO OPEN-LIKE WA   Y02134 32194002
*                                                                Y02134 32200002
         LA    R1,DXATCOM1              LOAD PTR TO PSUEDO RRPL  Y02134 32250002
         ST    R1,IECRRPRM-IECSTART(,RD) SAVE RRPL POINTER       Y02134 32260002
*                                                                Y02134 32270002
         CLI   MYCODE1,K4               CHECK FOR RESTART        Y02134 32300002
         BL    SRP01010                 BRANCH NOT RESTART       Y02134 32350002
*                                                                Y02134 32360002
         NI    WTGPATHS,ALLBITS-X01     SET ENQ BYPASS OFF       Y02134 32370002
*                                                                Y02134 32380002
         L     R1,IECREGSV+K4*R5        GET DEB ADDR (REG 5)     Y02134 32410002
         USING DEB,R1                   R1 POINTS TO DEB         Y02134 32420002
         MVC   MYDEBSYS(L'DEBOPATB),DEBOPATB SET OPEN ATTRIBUTES Y02134 32430002
         DROP  R1                                                Y02134 32442002
*                                                                Y02134 32452002
         CLI   MYCODE1,K5               CHECK FOR RESTART TAPE   Y02134 32492002
         BE    SRP01020                 BRANCH IF TAPE           Y02134 32542002
*                                                                Y02134 32560002
SRP01010 EQU   *                        DIRECT ACCESS            Y02134 32570002
*                                                                Y02134 32580002
         L     R1,IECREGSV+K4*RCORE     F1 DSCB POINTER (REG 4)  Y02134 32590002
         MVC   MYDSCB,0(R1)             MOVE IN F1 DSCB          Y02134 32600002
*                                                                Y02134 32650002
SRP01020 EQU   *                        TAPE                     Y02134 32660002
*                                                                Y02134 32670002
         LA    RET,K0                   SET ENTRY OFFSET         Y02134 32760002
*                                                                Y02134 32800002
         IECRES LOAD,MODNM=IFG0195V,                             Y02134X32850002
               PREFIX=WTGPREFX,BRANCH=DIRECT                     Y02134 32900002
         DROP  RWTG,RBASE,RCORE                                  Y02134 32910002
         EJECT                                                   Y02134 32950002
*                                                                Y02134 33000002
*****************************************************************Y02134 33050002
*                                                                Y02134 33100002
*        EXIT TO CALLER                                          Y02134 33150002
*                                                                Y02134 33200002
*****************************************************************Y02134 33250002
*                                                                Y02134 33750002
SRP09000 EQU   *                        ENTRY FOR RETURN         Y02134 33800002
*                                                                Y02134 33850002
         L     R8,MYRETURN              LOAD SAVE AREA           Y02134 33900002
         XR    R9,R9                    CLEAR REG FOR IC INST    Y02134 33950002
         IC    R9,MYERRCOD              GET ERROR CODE           Y02134 34000002
         ST    R9,IECREGSV+K4*R0        SAVE RETURN CODE (REG 0) Y02134 34010002
*                                                                Y02134 34020002
         IECRES FREE,PREFIX=YES,A=(RD)  FREE WORK AREA           Y02134 34050002
         DROP  RD                                                Y02134 34060002
*                                                                Y02134 34100002
SRP09100 EQU   *                        PASSWORD BYPASS ENTRY    Y02134 34300002
*                                                                Y02134 34350002
         BALR  RF,R0                    ESTABLISH ADDRESSABILITY Y02134 34400002
         USING *,RF                     SET BASE REG             Y02134 34410002
*                                                                Y02134 34420002
         MODESET EXTKEY=ZERO            RETURN IN KEY 0          YM1335 34430002
*                                                                YM1335 34440002
         LM    R0,RD,IECREGSV           RESTORE REGISTERS        Y02134 34450002
         DROP  R8                                                Y02134 34452002
         USING IECEXTPR,RD              RD POINTS TO PREFIX      Y02134 34454002
*                                                                Y02134 34456002
         OR    RA,R0                    SET ERROR RETURN REG     Y02134 34510002
         LTR   R0,R0                    TEST FOR ERROR           Y02134 34550002
         BNZ   SRP09200                 BRANCH IF ERROR          Y02134 34600002
         XR    RA,RA                    CLEAR RETURN CODE        Y02134 34650002
*                                                                Y02134 35050002
SRP09200 EQU   *                        RETURN TO CALLER         Y02134 35060002
*                                                                Y02134 35070002
         L     RET,IECWTGTB             LOAD WTG POINTER         Y02134 35080002
         USING WTG,RET                  RET POINTS TO DADSM WTG  Y02134 35090002
*                                                                Y02134 35092002
         CLI   IECREGSV+K4*RA,K2        TEST FOR RENAME          Y02134 35160002
         BE    SRP09400                 BRANCH IF RENAME         Y02134 35170002
*                                                                Y02134 35270002
         CLI   IECREGSV+K4*RA,K3        TEST FOR SCRATCH         Y02134 35272002
         BE    SRP09300                 BRANCH IF SCRATCH        Y02134 35274002
*                                                                Y02134 35274402
         MVC   WTGMODNM(K12),IGC0N05B   SET UP RESTART DA RET  @ZA17953 35274537
         CLI   IECREGSV+K4*RA,K4        CODE 4 = DA RESTART    @ZA17953 35274737
         BE    SRP09500                 BRANCH IF DA RESTART   @ZA17953 35274937
         MVC   WTGMODNM(K12),IGC0S05B   SET UP RESTART TAPE RETURN      35275137
*                                                              @ZA17953 35275337
         B     SRP09500                 CODE 5 = TAPE RESTART  @ZA17953 35275537
*                                                                Y02134 35276002
SRP09300 EQU   *                        SCRATCH RETURN           Y02134 35280002
*                                                                Y02134 35290002
         MVC   WTGMODNM(K12),IGG0290A   SET UP SCRATCH RETURN    Y02134 35292002
         B     SRP09500                 CODE 3 = SCRATCH         Y02134 35294002
*                                                                Y02134 35300002
SRP09400 EQU   *                        RENAME RETURN            Y02134 35332002
*                                                                Y02134 35334002
         MVC   WTGMODNM(K12),IGG03001   SET UP RENAME RETURN     Y02134 35336002
*                                                                Y02134 35340002
SRP09500 IECRES LOAD,BRCODE=K0,EXTPR=(RD),BRANCH=DIRECT          Y02134 35390002
         DROP  RET                                               Y02134 35440002
         EJECT                                                          35800002
*                                                                Y02134 35850002
*****************************************************************Y02134 35900002
*                                                                Y02134 35950002
*        CONSTANTS                                               Y02134 36000002
*                                                                Y02134 36050002
*****************************************************************Y02134 36100002
*                                                                Y02134 36150002
WTOLEN   DC    0XL4'00',AL2(12),AL2(0)  MODULE TRACE WTO LENGTH  Y02134 36200002
*                                                                Y02134 36250002
         XCTLTABL ID=(NAME,SECLOADA,,IFG0195V,                   Y02134X36300002
               ,IGG03001,,IGG0290A,,IGC0N05B,,IGC0S05B),       @ZA17953X36350037
               BRT=YES,LENGTH=                                 @ZA17953 39350037
         IECDSECS CVT,TCB,JSCB,DEB,                              Y02134X42350037
               SECCORE,MAIN,WTG,PREFX,EXPAND=YES                 Y02134 45350037
         IECEQU ,                       DEFINE EQUATES           Y02134 48350037
         END                                                            51350037
