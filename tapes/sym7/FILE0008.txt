./  ADD  SSI=62740244,NAME=ICBVTM00
TM00     TITLE '********  ICBVTM00:  MSVC TERMINATION PROCESSOR MODULE *00001000
                 *******'                                               00002000
ICBVTM00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVTM00  76.275'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*   RPLVPTR=REG1;                   /*                       @G24LB37*/ 00018000
         LR    RPLVPTR,REG1                                        0044 00019000
*   RFY                                                            0045 00020000
*     REG1 UNRESTRICTED;            /*                       @G24LB37*/ 00021000
*   VVIPTR=RPLVVICB;                /*                       @G24LB37*/ 00022000
         L     VVIPTR,RPLVVICB(,RPLVPTR)                           0046 00023000
*   TRMRBPTR=ADDR(RPLVUTIL);        /*                       @G24LB37*/ 00024000
         LA    TRMRBPTR,RPLVUTIL(,RPLVPTR)                         0047 00025000
*   VTMTBPTR=TRMSTHDR;              /*                       @G24LB37*/ 00026000
         L     VTMTBPTR,TRMSTHDR(,TRMRBPTR)                        0048 00027000
*   RETCODE=ZERO;                   /*                       @G24LB37*/ 00028000
*                                                                  0049 00029000
         SLR   RETCODE,RETCODE                                     0049 00030000
*   /*****************************************************************/ 00031000
*   /*                                                               */ 00032000
*   /* IF THE MSVI INVENTORY DATA SET IS NOT DISABLED THEN   @G24LB37*/ 00033000
*   /* THE PROCEXT PROCEDURE IS CALLED TO PROCESS THE STEP   @G24LB37*/ 00034000
*   /* TABLE DD ENTRIES BY ADDING BACK THE SUBTRACTED SPACE  @G24LB37*/ 00035000
*   /* WITHIN THE GROUP EXTENSION RECORD.                    @G24LB37*/ 00036000
*   /*                                                               */ 00037000
*   /*****************************************************************/ 00038000
*                                                                  0050 00039000
*   IF VVIFLG0=OFF THEN                                            0050 00040000
         TM    VVIFLG0(VVIPTR),B'10000000'                         0050 00041000
         BNZ   @RF00050                                            0050 00042000
*     CALL PROCEXT;                 /*                       @G24LB37*/ 00043000
*                                                                  0051 00044000
         BAL   @14,PROCEXT                                         0051 00045000
*   /*****************************************************************/ 00046000
*   /*                                                               */ 00047000
*   /* SET THE FLAG BIT IN THE STEP TABLE HEADER ENTRY       @G24LB37*/ 00048000
*   /* STPNOFRE TO OFF, INDICATING THE STEP TABLE ENTRY      @G24LB37*/ 00049000
*   /* CAN BE DELETED.                                       @G24LB37*/ 00050000
*   /*                                                               */ 00051000
*   /*****************************************************************/ 00052000
*                                                                  0052 00053000
*   STPNOFRE=OFF;                   /*                       @G24LB37*/ 00054000
*                                                                  0052 00055000
@RF00050 NI    STPNOFRE(VTMTBPTR),B'10111111'                      0052 00056000
*   /*****************************************************************/ 00057000
*   /*                                                               */ 00058000
*   /* RETURN TO CALLER. RETURN CODE IS IGNORED BY THE       @G24LB37*/ 00059000
*   /* CALLER (ICBVCR00).                                    @G24LB37*/ 00060000
*   /*                                                               */ 00061000
*   /*****************************************************************/ 00062000
*                                                                  0053 00063000
*   RETURN;                         /* RETURN TO CALLER      @G24LB37*/ 00064000
@EL00001 L     @13,4(,@13)                                         0053 00065000
@EF00001 DS    0H                                                  0053 00066000
@ER00001 LM    @14,@12,12(@13)                                     0053 00067000
         BR    @14                                                 0053 00068000
*                                                                  0054 00069000
*/********************************************************************/ 00070000
*/*                                                                  */ 00071000
*/*     PROCEDURE NAME - PROCEXT                             @G24LB37*/ 00072000
*/*                                                          @G24LB37*/ 00073000
*/*     FUNCTION - THIS PROCEDURE CALLS READEXT, SPACEUPT,   @G24LB37*/ 00074000
*/*                AND WRITEXT TO UPDATE THE GROUP EXTENSION @G24LB37*/ 00075000
*/*                RECORD, AND RETURNS TO ICBVTM00.  BECAUSE @G24LB37*/ 00076000
*/*                THE VOLUMES APPROXIMATE RUNNING SPACE     @G24LB37*/ 00077000
*/*                VALUES TO UPDATE CAN BE IN SEVERAL DIF-   @G24LB37*/ 00078000
*/*                FERENT GVSNE RECORDS AND BECAUSE THE LAST @G24LB37*/ 00079000
*/*                RECORD READ FOR UPDATE HAS TO BE WRITTEN  @G24LB37*/ 00080000
*/*                BEFORE THE NEXT RECORD CAN BE READ, THE   @G24LB37*/ 00081000
*/*                GVSNE TO BE PROCESSED HAS TO BE CONTROL-  @G24LB37*/ 00082000
*/*                LED.  PROCEXT MUST KEEP TRACK OF WHICH    @G24LB37*/ 00083000
*/*                RECORD WAS READ AND IF SO, HAS IT BEEN    @G24LB37*/ 00084000
*/*                WRITTEN.  PROCEXT TO ACCOMPLISH THIS WILL @G24LB37*/ 00085000
*/*                KEEP TRACK OF THE LAST GVSNE READ AND UP- @G24LB37*/ 00086000
*/*                DATED IN THE STEP TABLE, BY SAVE AREAS IN @G24LB37*/ 00087000
*/*                THIS MODULE.  WHEN THE GVSNE IN THE STEP  @G24LB37*/ 00088000
*/*                TABLE CHANGES THEN PROCEXT WILL WRITE THE @G24LB37*/ 00089000
*/*                OLD GVSNE RECORD AND READ, FOR THE STEP   @G24LB37*/ 00090000
*/*                TABLE, THE NEW GVSNE RECORD.              @G24LB37*/ 00091000
*/*                                                          @G24LB37*/ 00092000
*/*     INPUT - THE POINTER TO THE STEP TABLE HEADER ENTRY   @G24LB37*/ 00093000
*/*             TO PROCESS.                                  @G24LB37*/ 00094000
*/*                                                          @G24LB37*/ 00095000
*/*     OUTPUT -  THE GVSMTDSP FIELD IN THE GVSNE IS UPDATED @G24LB37*/ 00096000
*/*               FOR EACH DD ENTRY FOUND IN THE STEP TABLE  @G24LB37*/ 00097000
*/*               REQUIRING AN UPDATE.                       @G24LB37*/ 00098000
*/*                                                                  */ 00099000
*/********************************************************************/ 00100000
*                                                                  0054 00101000
*PROCEXT:                                                          0054 00102000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00103000
PROCEXT  ST    @14,@SA00002                                        0054 00104000
*                                                                  0055 00105000
*   /*****************************************************************/ 00106000
*   /*                                                               */ 00107000
*   /* INITIALIZE TO THE BEGINNING OF THE STEP TABLE DD      @G24LB37*/ 00108000
*   /* ENTRIES (STPDDENT). SET THE INTERNAL RESERVE FLAG     @G24LB37*/ 00109000
*   /* TO ON INDICATING TO READEXT TO CALL ICBVRR00 TO       @G24LB37*/ 00110000
*   /* RESERVE THE MSVI DATA SET, IF READEXT IS CALLED.      @G24LB37*/ 00111000
*   /* INITIALIZE THE SAVE AREAS FOR THE GROUP NAME AND      @G24LB37*/ 00112000
*   /* GROUP INDEX TO NULL VALUES, INDICATING FIRST TIME     @G24LB37*/ 00113000
*   /* THROUGH. THE RECORD UPDATE FLAG IS TURNED OFF.        @G24LB37*/ 00114000
*   /*                                                               */ 00115000
*   /*****************************************************************/ 00116000
*                                                                  0055 00117000
*   RFY                                                            0055 00118000
*     STPDDENT BASED(VTMDDPTR);     /*                       @G24LB37*/ 00119000
*   VTMDDPTR=STPDDPTR;              /*                       @G24LB37*/ 00120000
         L     VTMDDPTR,STPDDPTR(,VTMTBPTR)                        0056 00121000
*   GVSNEPTR=ADDR(GVSNEBUF);        /*                       @G24LB37*/ 00122000
         LA    GVSNEPTR,GVSNEBUF                                   0057 00123000
*   SAVEAGRP=''B;                   /*                       @G24LB37*/ 00124000
         XC    SAVEAGRP(12),SAVEAGRP                               0058 00125000
*   RESERVEF=ON;                    /*                       @G24LB37*/ 00126000
*   RECUPDTF=OFF;                   /*                       @G24LB37*/ 00127000
*                                                                  0060 00128000
         OI    RESERVEF,B'10000000'                                0060 00129000
         NI    RECUPDTF,B'10111111'                                0060 00130000
*   /*****************************************************************/ 00131000
*   /*                                                               */ 00132000
*   /* SCAN THE STEP TABLE DD ENTRIES TO LOCATE ANY ENTRIES  @G24LB37*/ 00133000
*   /* THAT REQUIRE ADDING BACK SPACE IN THE GROUP EXTENSION @G24LB37*/ 00134000
*   /* RECORDS (GVSNE).                                      @G24LB37*/ 00135000
*   /*                                                               */ 00136000
*   /*****************************************************************/ 00137000
*                                                                  0061 00138000
*   DO WHILE VTMDDPTR¬=ZERO;        /*                       @G24LB37*/ 00139000
*                                                                  0061 00140000
         B     @DE00061                                            0061 00141000
@DL00061 DS    0H                                                  0062 00142000
*     /***************************************************************/ 00143000
*     /*                                                             */ 00144000
*     /* IF THE STEP TABLE DD ENTRY FIELD IS NOT ZERO,       @G24LB37*/ 00145000
*     /* INDICATING SPACE HAS BEEN SUBTRACTED DURING THE     @G24LB37*/ 00146000
*     /* SELECTION PROCESS AND REQUIRES THE GVSNE FIELD      @G24LB37*/ 00147000
*     /* GVSMTDSP FIELD TO BE UPDATED, THEN PROCESS THE      @G24LB37*/ 00148000
*     /* STEP TABLE DD ENTRY.                                @G24LB37*/ 00149000
*     /*                                                             */ 00150000
*     /***************************************************************/ 00151000
*                                                                  0062 00152000
*     IF STPDDPRM¬=ZERO THEN                                       0062 00153000
         LH    @03,STPDDPRM(,VTMDDPTR)                             0062 00154000
         LTR   @03,@03                                             0062 00155000
         BZ    @RF00062                                            0062 00156000
*       DO;                         /*                       @G24LB37*/ 00157000
*                                                                  0064 00158000
*         /***********************************************************/ 00159000
*         /*                                                         */ 00160000
*         /* IF THE SAVED GROUP NAME AND INDEX ARE NOT EQUAL @G24LB37*/ 00161000
*         /* TO THE CURRENT GROUP NAME AND INDEX, AND THE    @G24LB37*/ 00162000
*         /* RECORD UPDATED FLAG IS ON FOR THE CURRENT GROUP @G24LB37*/ 00163000
*         /* NAME AND INDEX, THEN WRITEXT IS CALLED TO WRITE @G24LB37*/ 00164000
*         /* THE GROUP EXTENSION RECORD BACK OUT TO THE MSVI @G24LB37*/ 00165000
*         /* DATA SET.                                       @G24LB37*/ 00166000
*         /*                                                         */ 00167000
*         /***********************************************************/ 00168000
*                                                                  0064 00169000
*         IF(SAVEGRPN¬=STPDDGPN|SAVEINDX¬=STPDDGPI)&RECUPDTF=ON THEN    00170000
         CLC   SAVEGRPN(8),STPDDGPN(VTMDDPTR)                      0064 00171000
         BNE   @GL00001                                            0064 00172000
         CLC   SAVEINDX(1),STPDDGPI(VTMDDPTR)                      0064 00173000
         BE    @RF00064                                            0064 00174000
@GL00001 TM    RECUPDTF,B'01000000'                                0064 00175000
         BNO   @RF00064                                            0064 00176000
*           DO;                     /*                       @G24LB37*/ 00177000
*             CALL WRITEXT;         /*                       @G24LB37*/ 00178000
*                                                                  0066 00179000
         BAL   @14,WRITEXT                                         0066 00180000
*             /*******************************************************/ 00181000
*             /*                                                     */ 00182000
*             /* UPON RETURN, INITIALIZE THE SAVE AREAS FOR  @G24LB37*/ 00183000
*             /* THE GROUP NAME AND INDEX TO NULL VALUES.    @G24LB37*/ 00184000
*             /* SET THE RECORD UPDATED FLAG TO OFF.         @G24LB37*/ 00185000
*             /*                                                     */ 00186000
*             /*******************************************************/ 00187000
*                                                                  0067 00188000
*             SAVEAGRP=''B;         /*                       @G24LB37*/ 00189000
         XC    SAVEAGRP(12),SAVEAGRP                               0067 00190000
*             RECUPDTF=OFF;         /*                       @G24LB37*/ 00191000
         NI    RECUPDTF,B'10111111'                                0068 00192000
*           END;                    /*                       @G24LB37*/ 00193000
*                                                                  0070 00194000
*         /***********************************************************/ 00195000
*         /*                                                         */ 00196000
*         /* IF THE SAVED GROUP NAME AND GROUP INDEX ARE     @G24LB37*/ 00197000
*         /* NULL VALUES, THEN THE READEXT PROCEDURE IS      @G24LB37*/ 00198000
*         /* CALLED TO READ THE GROUP EXTENSION RECORD.      @G24LB37*/ 00199000
*         /*                                                         */ 00200000
*         /***********************************************************/ 00201000
*                                                                  0070 00202000
*         IF(SAVEGRPN=NULLAREA&SAVEINDX=NULLAREA(ONE:ONE)) THEN    0070 00203000
@RF00064 CLC   SAVEGRPN(8),NULLAREA                                0070 00204000
         BNE   @RF00070                                            0070 00205000
         CLC   SAVEINDX(1),NULLAREA                                0070 00206000
         BNE   @RF00070                                            0070 00207000
*           DO;                     /*                       @G24LB37*/ 00208000
*             CALL READEXT;         /*                       @G24LB37*/ 00209000
*                                                                  0072 00210000
         BAL   @14,READEXT                                         0072 00211000
*             /*******************************************************/ 00212000
*             /*                                                     */ 00213000
*             /* IF THE RETURN CODE IS ZERO UPON RETURN,     @G24LB37*/ 00214000
*             /* THEN SET THE NEW VALUES GROUP NAME, INDEX,  @G24LB37*/ 00215000
*             /* AND SLOT INTO THE APPROPRIATE SAVE AREAS.   @G24LB37*/ 00216000
*             /*                                                     */ 00217000
*             /*******************************************************/ 00218000
*                                                                  0073 00219000
*             IF RETCODE=ZERO THEN                                 0073 00220000
         LTR   RETCODE,RETCODE                                     0073 00221000
         BNZ   @RF00073                                            0073 00222000
*               DO;                 /*                       @G24LB37*/ 00223000
*                 SAVEGRPN=STPDDGPN;/*                       @G24LB37*/ 00224000
         MVC   SAVEGRPN(8),STPDDGPN(VTMDDPTR)                      0075 00225000
*                 SAVEINDX=STPDDGPI;/*                       @G24LB37*/ 00226000
         MVC   SAVEINDX(1),STPDDGPI(VTMDDPTR)                      0076 00227000
*               END;                /*                       @G24LB37*/ 00228000
*           END;                    /*                       @G24LB37*/ 00229000
@RF00073 DS    0H                                                  0079 00230000
*                                                                  0079 00231000
*         /***********************************************************/ 00232000
*         /*                                                         */ 00233000
*         /* IF THE RETURN CODE IS ZERO, SPACEUPT IS CALLED  @G24LB37*/ 00234000
*         /* TO CALCULATE THE AMOUNT OF CYLINDERS THAT       @G24LB37*/ 00235000
*         /* SHOULD BE IN THE GVSNE FIELD GVSMTDSP AND       @G24LB37*/ 00236000
*         /* UPDATES THAT SPACE IN THE GVSNE.                @G24LB37*/ 00237000
*         /*                                                         */ 00238000
*         /***********************************************************/ 00239000
*                                                                  0079 00240000
*         IF RETCODE=ZERO THEN                                     0079 00241000
@RF00070 LTR   RETCODE,RETCODE                                     0079 00242000
         BNZ   @RF00079                                            0079 00243000
*           DO;                     /*                       @G24LB37*/ 00244000
*             CALL SPACEUPT;        /*                       @G24LB37*/ 00245000
*                                                                  0081 00246000
         BAL   @14,SPACEUPT                                        0081 00247000
*             /*******************************************************/ 00248000
*             /*                                                     */ 00249000
*             /* IF SPACEUPT RETURNS A RETURN CODE OF ZERO,  @G24LB37*/ 00250000
*             /* THEN THE RECORD UPDATE FLAG IS TURNED ON.   @G24LB37*/ 00251000
*             /* IF THE RETURN CODE IS FOUR, THEN SET THE    @G24LB37*/ 00252000
*             /* RETURN CODE TO ZERO.                        @G24LB37*/ 00253000
*             /*                                                     */ 00254000
*             /*******************************************************/ 00255000
*                                                                  0082 00256000
*             IF RETCODE=ZERO THEN                                 0082 00257000
         LTR   RETCODE,RETCODE                                     0082 00258000
         BNZ   @RF00082                                            0082 00259000
*               RECUPDTF=ON;        /*                       @G24LB37*/ 00260000
         OI    RECUPDTF,B'01000000'                                0083 00261000
*             ELSE                                                 0084 00262000
*               RETCODE=ZERO;       /*                       @G24LB37*/ 00263000
         B     @RC00082                                            0084 00264000
@RF00082 SLR   RETCODE,RETCODE                                     0084 00265000
*           END;                    /*                       @G24LB37*/ 00266000
*                                                                  0085 00267000
*         /***********************************************************/ 00268000
*         /*                                                         */ 00269000
*         /* IF THE RETURN CODE IS NOT ZERO UPON RETURN,     @G24LB37*/ 00270000
*         /* THEN PROCESS THE NEXT ENTRY, AFTER SETTING THE  @G24LB37*/ 00271000
*         /* RETURN CODE TO ZERO.                            @G24LB37*/ 00272000
*         /*                                                         */ 00273000
*         /***********************************************************/ 00274000
*                                                                  0086 00275000
*         ELSE                                                     0086 00276000
*           RETCODE=ZERO;           /*                       @G24LB37*/ 00277000
         B     @RC00079                                            0086 00278000
@RF00079 SLR   RETCODE,RETCODE                                     0086 00279000
*       END;                        /*                       @G24LB37*/ 00280000
@RC00079 DS    0H                                                  0088 00281000
*                                                                  0088 00282000
*     /***************************************************************/ 00283000
*     /*                                                             */ 00284000
*     /* IF THE STPDDPRM FIELD IS ZERO OR THE FIELD          @G24LB37*/ 00285000
*     /* GVSMTDSP WAS UPDATED, IN THE GVSNE, THEN GO BACK    @G24LB37*/ 00286000
*     /* TO PROCESS THE NEXT STEP TABLE DD ENTRY.            @G24LB37*/ 00287000
*     /*                                                             */ 00288000
*     /***************************************************************/ 00289000
*                                                                  0088 00290000
*     VTMDDPTR=STPDDNXT;            /*                       @G24LB37*/ 00291000
@RF00062 L     VTMDDPTR,STPDDNXT(,VTMDDPTR)                        0088 00292000
*   END;                            /*                       @G24LB37*/ 00293000
*                                                                  0089 00294000
@DE00061 LTR   VTMDDPTR,VTMDDPTR                                   0089 00295000
         BNZ   @DL00061                                            0089 00296000
*   /*****************************************************************/ 00297000
*   /*                                                               */ 00298000
*   /* IF THE RECORD UPDATED FLAG IS ON, AND THE SAVE AREA   @G24LB37*/ 00299000
*   /* FOR THE GROUP NAME IS NOT A NULL VALUE, THEN WRITEXT  @G24LB37*/ 00300000
*   /* IS CALLED TO WRITE THE LAST EXTENSION RECORD BACK     @G24LB37*/ 00301000
*   /* OUT TO THE MSVI DATA SET.                             @G24LB37*/ 00302000
*   /*                                                               */ 00303000
*   /*****************************************************************/ 00304000
*                                                                  0090 00305000
*   IF RECUPDTF=ON&SAVEGRPN¬=NULLAREA THEN                         0090 00306000
         TM    RECUPDTF,B'01000000'                                0090 00307000
         BNO   @RF00090                                            0090 00308000
         CLC   SAVEGRPN(8),NULLAREA                                0090 00309000
         BE    @RF00090                                            0090 00310000
*     CALL WRITEXT;                 /*                       @G24LB37*/ 00311000
*                                                                  0091 00312000
         BAL   @14,WRITEXT                                         0091 00313000
*   /*****************************************************************/ 00314000
*   /*                                                               */ 00315000
*   /* RETURN TO CALLER, RETURN CODE IS IGNORED BY THE MAIN  @G24LB37*/ 00316000
*   /* ROUTINE ICBVTM00.                                     @G24LB37*/ 00317000
*   /*                                                               */ 00318000
*   /*****************************************************************/ 00319000
*                                                                  0092 00320000
*   RETURN;                         /* RET TO MAIN ROUTINE   @G24LB37*/ 00321000
@EL00002 DS    0H                                                  0092 00322000
@EF00002 DS    0H                                                  0092 00323000
@ER00002 L     @14,@SA00002                                        0092 00324000
         BR    @14                                                 0092 00325000
*   END PROCEXT;                    /* END OF PROCEXT PROC   @G24LB37*/ 00326000
         B     @EL00002                                            0093 00327000
*                                                                  0094 00328000
*/********************************************************************/ 00329000
*/*                                                                  */ 00330000
*/*     PROCEDURE NAME - READEXT                             @G24LB37*/ 00331000
*/*                                                          @G24LB37*/ 00332000
*/*     FUNCTION - THIS PROCEDURE CALLS ICBVRR00 TO RESERVE  @G24LB37*/ 00333000
*/*                THE MSVI DATA SET IF THIS IS THE FIRST    @G24LB37*/ 00334000
*/*                TIME CALLED, THEN CALLS ICBVIO00 TO READ  @G24LB37*/ 00335000
*/*                THE GROUP EXTENSION RECORD, AND RETURNS   @G24LB37*/ 00336000
*/*                TO THE PROCEXT PROCEDURE.                 @G24LB37*/ 00337000
*/*                                                          @G24LB37*/ 00338000
*/*     INPUT - THE POINTER TO THE STEP TABLE DD ENTRY TO    @G24LB37*/ 00339000
*/*             PROCESS, CONTAINING THE GROUP NAME AND       @G24LB37*/ 00340000
*/*             GROUP INDEX FIELDS.                          @G24LB37*/ 00341000
*/*                                                          @G24LB37*/ 00342000
*/*     OUTPUT -  THE GVSNEPTR FIELD POINTING TO THE GVSNE   @G24LB37*/ 00343000
*/*               FOR THE DD ENTRY FOUND IN THE STEP TABLE   @G24LB37*/ 00344000
*/*               REQUIRING AN UPDATE.  RETURN CODE IN       @G24LB37*/ 00345000
*/*               RETCODE AREA AS FOLLOWS:                   @G24LB37*/ 00346000
*/*               0 = SUCCESSFUL READ OF GROUP EXT RECORD.   @G24LB37*/ 00347000
*/*               4 = UNSUCCESSFUL READ OF GROUP EXT RECORD. @G24LB37*/ 00348000
*/*                                                                  */ 00349000
*/********************************************************************/ 00350000
*                                                                  0094 00351000
*READEXT:                                                          0094 00352000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00353000
READEXT  ST    @14,@SA00003                                        0094 00354000
*                                                                  0095 00355000
*   /*****************************************************************/ 00356000
*   /*                                                               */ 00357000
*   /* BEFORE MSVI PROCESSING CAN START, IF THE RESERVE      @G24LB37*/ 00358000
*   /* FLAG IS ON INDICATING THE FIRST TIME READEXT CALLED,  @G24LB37*/ 00359000
*   /* THE MSVI DATA SET IS RESERVED FOR EXCLUSIVE USE BOTH  @G24LB37*/ 00360000
*   /* FROM OTHER JOBS IN THE CPU PLUS JOBS IN OTHER CPU'S,  @G24LB37*/ 00361000
*   /* BY CALLING ICBVRR00. TURN RESERVE FLAG OFF.           @G24LB37*/ 00362000
*   /*                                                               */ 00363000
*   /*****************************************************************/ 00364000
*                                                                  0095 00365000
*   IF RESERVEF=ON THEN                                            0095 00366000
         TM    RESERVEF,B'10000000'                                0095 00367000
         BNO   @RF00095                                            0095 00368000
*     DO;                           /*                       @G24LB37*/ 00369000
*       RFY                                                        0097 00370000
*        (REG0,                                                    0097 00371000
*         REG1) RESTRICTED;         /*                       @G24LB37*/ 00372000
*       REG0=RESCODE;               /*                       @G24LB37*/ 00373000
         LA    REG0,1                                              0098 00374000
*       REG1=RPLVPTR;               /*                       @G24LB37*/ 00375000
         LR    REG1,RPLVPTR                                        0099 00376000
*       CALL ICBVRR00;              /*                       @G24LB37*/ 00377000
         L     @15,@CV00220                                        0100 00378000
         BALR  @14,@15                                             0100 00379000
*       RFY                                                        0101 00380000
*        (REG0,                                                    0101 00381000
*         REG1) UNRESTRICTED;       /*                       @G24LB37*/ 00382000
*       RESERVEF=OFF;               /*                       @G24LB37*/ 00383000
         NI    RESERVEF,B'01111111'                                0102 00384000
*     END;                          /*                       @G24LB37*/ 00385000
*                                                                  0103 00386000
*   /*****************************************************************/ 00387000
*   /*                                                               */ 00388000
*   /* BUILD THE MSVI KEY TO READ THE GROUP EXTENSION        @G24LB37*/ 00389000
*   /* RECORD DIRECT.                                        @G24LB37*/ 00390000
*   /*                                                               */ 00391000
*   /*****************************************************************/ 00392000
*                                                                  0104 00393000
*   GROUPNAM=STPDDGPN;              /*                       @G24LB37*/ 00394000
@RF00095 MVC   GROUPNAM(8),STPDDGPN(VTMDDPTR)                      0104 00395000
*   GROUPIND=STPDDGPI;              /*                       @G24LB37*/ 00396000
*                                                                  0105 00397000
         MVC   GROUPIND(1),STPDDGPI(VTMDDPTR)                      0105 00398000
*   /*****************************************************************/ 00399000
*   /*                                                               */ 00400000
*   /* BUILD THE RPLV TO READ THE GROUP EXTENSION RECORDS    @G24LB37*/ 00401000
*   /* BY READING DIRECT FOR UPDATE, SINCE ALL INFORMATION   @G24LB37*/ 00402000
*   /* IS LOCATED IN THE STEP TABLE DD ENTRY.                @G24LB37*/ 00403000
*   /*                                                               */ 00404000
*   /*****************************************************************/ 00405000
*                                                                  0106 00406000
*   RPLVKEY=ADDR(GROUPKEY);         /* ADDRESS OF GROUP KEY  @G24LB37*/ 00407000
         LA    @15,GROUPKEY                                        0106 00408000
         ST    @15,RPLVKEY(,RPLVPTR)                               0106 00409000
*   RPLVDIR=ON;                     /* READ DIRECT FLAG ON   @G24LB37*/ 00410000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0107 00411000
*   RPLVUPD=ON;                     /* READ FOR UPDATE ON    @G24LB37*/ 00412000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0108 00413000
*   RPLVTYP=RPLVREAD;               /* READ GROUP RECORD     @G24LB37*/ 00414000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0109 00415000
*   RPLVBUF=GVSNEPTR;               /* ADDRESS OF GVSNE      @G24LB37*/ 00416000
         ST    GVSNEPTR,RPLVBUF(,RPLVPTR)                          0110 00417000
*   RPLVBLN=LENGTH(GVSNE);          /* LENGTH OF BUFFER      @G24LB37*/ 00418000
         MVC   RPLVBLN(4,RPLVPTR),@CF00279                         0111 00419000
*   RFY                                                            0112 00420000
*     REG1 RESTRICTED;              /*                       @G24LB37*/ 00421000
*   REG1=RPLVPTR;                   /*                       @G24LB37*/ 00422000
         LR    REG1,RPLVPTR                                        0113 00423000
*   CALL ICBVIO00;                  /* READ GROUP EXT REC    @G24LB37*/ 00424000
         L     @15,@CV00219                                        0114 00425000
         BALR  @14,@15                                             0114 00426000
*   RFY                                                            0115 00427000
*     REG1 UNRESTRICTED;            /*                       @G24LB37*/ 00428000
*                                                                  0116 00429000
*   /*****************************************************************/ 00430000
*   /*                                                               */ 00431000
*   /* ICBVIO00 WILL ISSUE MESSAGES TO THE SPACE MANAGER     @G24LB37*/ 00432000
*   /* SHOULD AN I/O ERROR OCCUR. IF THE RETURN CODE IS      @G24LB37*/ 00433000
*   /* NOT A ZERO THEN SET RETURN CODE TO FOUR. IF THE       @G24LB37*/ 00434000
*   /* RETURN CODE IS ZERO SET THE RETURN CODE TO ZERO.      @G24LB37*/ 00435000
*   /*                                                               */ 00436000
*   /*****************************************************************/ 00437000
*                                                                  0116 00438000
*   IF RPLVRETC¬=ZERO THEN                                         0116 00439000
         LH    @15,RPLVRETC(,RPLVPTR)                              0116 00440000
         N     @15,@CF00286                                        0116 00441000
         LTR   @15,@15                                             0116 00442000
         BZ    @RF00116                                            0116 00443000
*     RETCODE=FOUR;                 /*                       @G24LB37*/ 00444000
         LA    RETCODE,4                                           0117 00445000
*   ELSE                                                           0118 00446000
*     RETCODE=ZERO;                 /*                       @G24LB37*/ 00447000
*                                                                  0118 00448000
         B     @RC00116                                            0118 00449000
@RF00116 SLR   RETCODE,RETCODE                                     0118 00450000
*   /*****************************************************************/ 00451000
*   /*                                                               */ 00452000
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB37*/ 00453000
*   /*                                                               */ 00454000
*   /*****************************************************************/ 00455000
*                                                                  0119 00456000
*   RETURN;                         /* RET TO PROCEXT PROC   @G24LB37*/ 00457000
@EL00003 DS    0H                                                  0119 00458000
@EF00003 DS    0H                                                  0119 00459000
@ER00003 L     @14,@SA00003                                        0119 00460000
         BR    @14                                                 0119 00461000
*   END READEXT;                    /* END OF READEXT PROC   @G24LB37*/ 00462000
         B     @EL00003                                            0120 00463000
*                                                                  0121 00464000
*/********************************************************************/ 00465000
*/*                                                                  */ 00466000
*/*     PROCEDURE NAME - SPACEUPT                            @G24LB37*/ 00467000
*/*                                                          @G24LB37*/ 00468000
*/*     FUNCTION - THIS PROCEDURE CALCULATES THE NUMBER OF   @G24LB37*/ 00469000
*/*                CYLINDERS TO BE ADDED BACK IN THE RUNNING @G24LB37*/ 00470000
*/*                FREE SPACE FIELD (WHICH IS APPROXIMATE    @G24LB37*/ 00471000
*/*                FREE SPACE ON THE VOLUME) IN THE GROUP    @G24LB37*/ 00472000
*/*                EXTENSION RECORD, AND RETURNS TO THE      @G24LB37*/ 00473000
*/*                PROCEXT PROCEDURE.                        @G24LB37*/ 00474000
*/*                                                          @G24LB37*/ 00475000
*/*     INPUT - THE POINTER TO THE STEP TABLE DD ENTRY TO    @G24LB37*/ 00476000
*/*             PROCESS, CONTAINING THE GROUP NAME, INDEX,   @G24LB37*/ 00477000
*/*             SLOT, AND VOLSER FIELDS.                     @G24LB37*/ 00478000
*/*                                                          @G24LB37*/ 00479000
*/*     OUTPUT -  THE GVSMTDSP FIELD UPDATED FOR THE GVSNE   @G24LB37*/ 00480000
*/*               SLOT INDEX FOUND IN THE STEP TABLE         @G24LB37*/ 00481000
*/*               REQUIRING AN UPDATE.  RETURN CODE IN       @G24LB37*/ 00482000
*/*               RETCODE AREA AS FOLLOWS:                   @G24LB37*/ 00483000
*/*               0 = SUCCESSFUL UPDATE OF GROUP EXT RECORD. @G24LB37*/ 00484000
*/*               4 = UNSUCCESSFUL UPDATE OF GROUP EXTENSION @G24LB37*/ 00485000
*/*                   RECORD.                                @G24LB37*/ 00486000
*/*                                                                  */ 00487000
*/********************************************************************/ 00488000
*                                                                  0121 00489000
*SPACEUPT:                                                         0121 00490000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00491000
SPACEUPT ST    @14,12(,@13)                                        0121 00492000
*                                                                  0122 00493000
*   /*****************************************************************/ 00494000
*   /*                                                               */ 00495000
*   /* INITIALIZE RETCODE AREA TO ZERO. IF THE VOLSER IN     @G24LB37*/ 00496000
*   /* THE GVSNE SLOT MATCHES THE ONE IN THE THE STEP TABLE, @G24LB37*/ 00497000
*   /* THEN PROCESS THE SLOT IN THE GVSNE.                   @G24LB37*/ 00498000
*   /*                                                               */ 00499000
*   /*****************************************************************/ 00500000
*                                                                  0122 00501000
*   RETCODE=ZERO;                   /*                       @G24LB37*/ 00502000
         SLR   RETCODE,RETCODE                                     0122 00503000
*   IF GVSVOLID(STPDDGPS)=STPDDVOL(ONE) THEN                       0123 00504000
         SLR   @03,@03                                             0123 00505000
         IC    @03,STPDDGPS(,VTMDDPTR)                             0123 00506000
         MH    @03,@CH00280                                        0123 00507000
         ST    @03,@TF00001                                        0123 00508000
         ALR   @03,GVSNEPTR                                        0123 00509000
         CLC   GVSVOLID-20(6,@03),STPDDVOL(VTMDDPTR)               0123 00510000
         BNE   @RF00123                                            0123 00511000
*     DO;                           /*                       @G24LB37*/ 00512000
*                                                                  0124 00513000
*       /*************************************************************/ 00514000
*       /*                                                           */ 00515000
*       /* THE FIELD STPDDPRM IN THE STEP TABLE DD ENTRY IS  @G24LB37*/ 00516000
*       /* ADDED TO THE GVSNE FIELD GVSMTDSP POINTED TO BY   @G24LB37*/ 00517000
*       /* THE SLOT INDEX PASSED BY THE PROCEXT PROCEDURE,   @G24LB37*/ 00518000
*       /* AND THAT VALUE IS INSERTED BACK INTO THE GVSMTDSP @G24LB37*/ 00519000
*       /* FIELD OF THE SAME SLOT.                           @G24LB37*/ 00520000
*       /*                                                           */ 00521000
*       /*************************************************************/ 00522000
*                                                                  0125 00523000
*       GVSMTDSP(STPDDGPS)=GVSMTDSP(STPDDGPS)+STPDDPRM;/*    @G24LB37*/ 00524000
*                                                                  0125 00525000
         L     @03,@TF00001                                        0125 00526000
         LH    @03,GVSMTDSP-20(@03,GVSNEPTR)                       0125 00527000
         AH    @03,STPDDPRM(,VTMDDPTR)                             0125 00528000
         L     @01,@TF00001                                        0125 00529000
         STH   @03,GVSMTDSP-20(@01,GVSNEPTR)                       0125 00530000
*       /*************************************************************/ 00531000
*       /*                                                           */ 00532000
*       /* BECAUSE OF THE APPROXIMATE AVAILABLE FREE SPACE   @G24LB37*/ 00533000
*       /* VALUE BEING AN APPROXIMATE VALUE, IT IS POSSIBLE  @G24LB37*/ 00534000
*       /* THAT THIS UPDATE MAY YIELD A VALUE GREATER THAN   @G24LB37*/ 00535000
*       /* 403 (MAXIMUM CYLINDERS), WHICH IS A PHYSICAL      @G24LB37*/ 00536000
*       /* IMPOSSIBILITY. IF THIS SITUATION EXISTS THE       @G24LB37*/ 00537000
*       /* VALUE IS SET TO 403, WHICH WILL INDICATE THE      @G24LB37*/ 00538000
*       /* ENTIRE VOLUME CAN BE USED.                        @G24LB37*/ 00539000
*       /*                                                           */ 00540000
*       /*************************************************************/ 00541000
*                                                                  0126 00542000
*       IF GVSMTDSP(STPDDGPS)>MAXCYLIN THEN                        0126 00543000
         LA    @15,403                                             0126 00544000
         CR    @03,@15                                             0126 00545000
         BNH   @RF00126                                            0126 00546000
*         GVSMTDSP(STPDDGPS)=MAXCYLIN;/*                     @G24LB37*/ 00547000
*                                                                  0127 00548000
         L     @03,@TF00001                                        0127 00549000
         STH   @15,GVSMTDSP-20(@03,GVSNEPTR)                       0127 00550000
*       /*************************************************************/ 00551000
*       /*                                                           */ 00552000
*       /* THE LSPACE VALUE IN THE GVSNE IS CHECKED TO MAKE  @G24LB37*/ 00553000
*       /* SURE THE SPACE ADDED BACK IS NOT GREATER THAN THE @G24LB37*/ 00554000
*       /* VALUE IN THE FIELD GVSFRESP.                      @G24LB37*/ 00555000
*       /*                                                           */ 00556000
*       /*************************************************************/ 00557000
*                                                                  0128 00558000
*       IF GVSMTDSP(STPDDGPS)>GVSFRESP(STPDDGPS) THEN              0128 00559000
@RF00126 SLR   @03,@03                                             0128 00560000
         IC    @03,STPDDGPS(,VTMDDPTR)                             0128 00561000
         MH    @03,@CH00280                                        0128 00562000
         LH    @15,GVSFRESP-20(@03,GVSNEPTR)                       0128 00563000
         CH    @15,GVSMTDSP-20(@03,GVSNEPTR)                       0128 00564000
         BNL   @RF00128                                            0128 00565000
*         GVSMTDSP(STPDDGPS)=GVSFRESP(STPDDGPS);/*           @G24LB37*/ 00566000
         STH   @15,GVSMTDSP-20(@03,GVSNEPTR)                       0129 00567000
*     END;                          /*                       @G24LB37*/ 00568000
*                                                                  0131 00569000
*   /*****************************************************************/ 00570000
*   /*                                                               */ 00571000
*   /* IF THE VOLSER DOES NOT MATCH THEN SET RETURN CODE TO  @G24LB37*/ 00572000
*   /* FOUR AND DO NOT UPDATE THE SPACE FIELD.               @G24LB37*/ 00573000
*   /*                                                               */ 00574000
*   /*****************************************************************/ 00575000
*                                                                  0131 00576000
*   ELSE                                                           0131 00577000
*     RETCODE=FOUR;                 /*                       @G24LB37*/ 00578000
*                                                                  0131 00579000
         B     @RC00123                                            0131 00580000
@RF00123 LA    RETCODE,4                                           0131 00581000
*   /*****************************************************************/ 00582000
*   /*                                                               */ 00583000
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB37*/ 00584000
*   /*                                                               */ 00585000
*   /*****************************************************************/ 00586000
*                                                                  0132 00587000
*   RETURN;                         /* RET TO PROCEXT PROC   @G24LB37*/ 00588000
@EL00004 DS    0H                                                  0132 00589000
@EF00004 DS    0H                                                  0132 00590000
@ER00004 L     @14,12(,@13)                                        0132 00591000
         BR    @14                                                 0132 00592000
*   END SPACEUPT;                   /* END OF SPACEUPT PROC  @G24LB37*/ 00593000
         B     @EL00004                                            0133 00594000
*                                                                  0134 00595000
*/********************************************************************/ 00596000
*/*                                                                  */ 00597000
*/*     PROCEDURE NAME - WRITEXT                             @G24LB37*/ 00598000
*/*                                                          @G24LB37*/ 00599000
*/*     FUNCTION - THIS PROCEDURE CALLS ICBVIO00 TO WRITE    @G24LB37*/ 00600000
*/*                THE UPDATED GROUP EXTENSION RECORD, AND   @G24LB37*/ 00601000
*/*                RETURNS TO THE PROCEXT PROCEDURE.         @G24LB37*/ 00602000
*/*                                                          @G24LB37*/ 00603000
*/*     INPUT - THE POINTER TO THE RPLV CONTAINING THE       @G24LB37*/ 00604000
*/*             GROUP NAME AND GROUP INDEX FIELDS.           @G24LB37*/ 00605000
*/*                                                          @G24LB37*/ 00606000
*/*     OUTPUT -  THE GVSNE REQUIRING AN UPDATE IS WRITTEN   @G24LB37*/ 00607000
*/*               TO THE MSVI DATA SET.  RETURN CODE IN      @G24LB37*/ 00608000
*/*               RETCODE AREA AS FOLLOWS:                   @G24LB37*/ 00609000
*/*               0 = SUCCESSFUL WRITE OF GROUP EXT RECORD.  @G24LB37*/ 00610000
*/*                                                                  */ 00611000
*/********************************************************************/ 00612000
*                                                                  0134 00613000
*WRITEXT:                                                          0134 00614000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00615000
WRITEXT  ST    @14,@SA00005                                        0134 00616000
*                                                                  0135 00617000
*   /*****************************************************************/ 00618000
*   /*                                                               */ 00619000
*   /* BUILD THE RPLV TO WRITE THE GROUP EXTENSION RECORD    @G24LB37*/ 00620000
*   /* BY WRITING DIRECT FOR UPDATE, USING THE RPLV THAT WAS @G24LB37*/ 00621000
*   /* USED FOR THE READ GROUP EXTENSION RECORD.             @G24LB37*/ 00622000
*   /*                                                               */ 00623000
*   /*****************************************************************/ 00624000
*                                                                  0135 00625000
*   RPLVTYP=RPLVPUT;                /* WRITE GROUP RECORD    @G24LB37*/ 00626000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0135 00627000
*   RFY                                                            0136 00628000
*     REG1 RESTRICTED;              /*                       @G24LB37*/ 00629000
*   REG1=RPLVPTR;                   /*                       @G24LB37*/ 00630000
         LR    REG1,RPLVPTR                                        0137 00631000
*   CALL ICBVIO00;                  /* WRITE GROUP EXT REC   @G24LB37*/ 00632000
         L     @15,@CV00219                                        0138 00633000
         BALR  @14,@15                                             0138 00634000
*   RFY                                                            0139 00635000
*     REG1 UNRESTRICTED;            /*                       @G24LB37*/ 00636000
*                                                                  0139 00637000
*   /*****************************************************************/ 00638000
*   /*                                                               */ 00639000
*   /* ICBVIO00 WILL ISSUE MESSAGES TO THE SPACE MANAGER     @G24LB37*/ 00640000
*   /* SHOULD AN I/O ERROR OCCUR. SET THE RETURN CODE TO     @G24LB37*/ 00641000
*   /* ZERO.                                                 @G24LB37*/ 00642000
*   /*                                                               */ 00643000
*   /*****************************************************************/ 00644000
*                                                                  0140 00645000
*   RETCODE=ZERO;                   /*                       @G24LB37*/ 00646000
*                                                                  0140 00647000
         SLR   RETCODE,RETCODE                                     0140 00648000
*   /*****************************************************************/ 00649000
*   /*                                                               */ 00650000
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB37*/ 00651000
*   /*                                                               */ 00652000
*   /*****************************************************************/ 00653000
*                                                                  0141 00654000
*   RETURN;                         /* RET TO PROCEXT PROC   @G24LB37*/ 00655000
@EL00005 DS    0H                                                  0141 00656000
@EF00005 DS    0H                                                  0141 00657000
@ER00005 L     @14,@SA00005                                        0141 00658000
         BR    @14                                                 0141 00659000
*   END WRITEXT;                    /* END OF WRITEXT PROC   @G24LB37*/ 00660000
*   END ICBVTM00                    /* END OF ICBVTM00       @G24LB37*/ 00661000
*                                                                  0143 00662000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00663000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 00664000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 00665000
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */ 00666000
*/*%INCLUDE SYSLIB  (IEZSTPTB)                                       */ 00667000
*                                                                  0143 00668000
*       ;                                                          0143 00669000
@DATA    DS    0H                                                       00670000
@CH00280 DC    H'20'                                                    00671000
         DS    0F                                                       00672000
@SA00001 DS    18F                                                      00673000
@SA00002 DS    1F                                                       00674000
@SA00003 DS    0F                                                       00675000
@SA00005 DS    0F                                                       00676000
         DS    1F                                                       00677000
@TF00001 DS    F                                                        00678000
         DS    0F                                                       00679000
@CF00279 DC    F'988'                                                   00680000
@CF00286 DC    XL4'0000FFFF'                                            00681000
@CV00219 DC    V(ICBVIO00)                                              00682000
@CV00220 DC    V(ICBVRR00)                                              00683000
         DS    0D                                                       00684000
NULLAREA DC    X'0000000000000000'                                      00685000
VTM00SWS DS    CL2                                                      00686000
         ORG   VTM00SWS                                                 00687000
FOUNDSW  DS    BL1                                                      00688000
@NM00016 EQU   VTM00SWS+0                                               00689000
         ORG   VTM00SWS+2                                               00690000
VTM00FGS DS    CL2                                                      00691000
         ORG   VTM00FGS                                                 00692000
RESERVEF DS    BL1                                                      00693000
RECUPDTF EQU   VTM00FGS+0                                               00694000
@NM00017 EQU   VTM00FGS+0                                               00695000
         ORG   VTM00FGS+2                                               00696000
SAVEAGRP DS    CL12                                                     00697000
         ORG   SAVEAGRP                                                 00698000
SAVEGRPN DS    CL8                                                      00699000
SAVEINDX DS    FL1                                                      00700000
@NM00018 DS    CL3                                                      00701000
         ORG   SAVEAGRP+12                                              00702000
GROUPKEY DS    CL13                                                     00703000
         ORG   GROUPKEY                                                 00704000
GROUPG   DC    CL3'G  '                                                 00705000
GROUPNAM DS    CL8                                                      00706000
GROUPBLK DC    CL1' '                                                   00707000
GROUPIND DS    FL1                                                      00708000
         ORG   GROUPKEY+13                                              00709000
         DS    CL3                                                      00710000
GVSNEBUF DS    CL988                                                    00711000
FIXAREA  DS    CL100                                                    00712000
         ORG   FIXAREA                                                  00713000
@NM00021 DC    100X'00'                                                 00714000
         ORG   FIXAREA+100                                              00715000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00716000
@01      EQU   01                                                       00717000
@02      EQU   02                                                       00718000
@03      EQU   03                                                       00719000
@04      EQU   04                                                       00720000
@05      EQU   05                                                       00721000
@06      EQU   06                                                       00722000
@07      EQU   07                                                       00723000
@08      EQU   08                                                       00724000
@09      EQU   09                                                       00725000
@10      EQU   10                                                       00726000
@11      EQU   11                                                       00727000
@12      EQU   12                                                       00728000
@13      EQU   13                                                       00729000
@14      EQU   14                                                       00730000
@15      EQU   15                                                       00731000
RETCODE  EQU   @02                                                      00732000
VTMDDPTR EQU   @04                                                      00733000
VTMTBPTR EQU   @07                                                      00734000
TRMRBPTR EQU   @02                                                      00735000
GVSNEPTR EQU   @06                                                      00736000
VVIPTR   EQU   @04                                                      00737000
RPLVPTR  EQU   @05                                                      00738000
REG0     EQU   @00                                                      00739000
REG1     EQU   @01                                                      00740000
REG14    EQU   @14                                                      00741000
RPLV     EQU   0                                                        00742000
RPLTCBPR EQU   RPLV+8                                                   00743000
RPLVVICB EQU   RPLV+12                                                  00744000
RPLFLAGA EQU   RPLV+28                                                  00745000
RPLVRETC EQU   RPLV+34                                                  00746000
RPLVSAM  EQU   RPLV+56                                                  00747000
RPLVTYP  EQU   RPLVSAM+2                                                00748000
RPLVBUF  EQU   RPLVSAM+32                                               00749000
RPLVKEY  EQU   RPLVSAM+36                                               00750000
RPLVOPT  EQU   RPLVSAM+40                                               00751000
RPLVDIR  EQU   RPLVOPT                                                  00752000
RPLVUPD  EQU   RPLVOPT+1                                                00753000
RPLVBLN  EQU   RPLVSAM+52                                               00754000
RPLVUTIL EQU   RPLV+132                                                 00755000
VVICB    EQU   0                                                        00756000
VVIFLGA  EQU   VVICB+15                                                 00757000
VVIFLG0  EQU   VVIFLGA                                                  00758000
GVSNE    EQU   0                                                        00759000
GVSHDR   EQU   GVSNE                                                    00760000
GVSNAME  EQU   GVSHDR                                                   00761000
GVSID    EQU   GVSNAME+11                                               00762000
GVSFLAGA EQU   GVSHDR+13                                                00763000
GVSTYPE  EQU   GVSFLAGA                                                 00764000
GVSSLOTS EQU   GVSNE+28                                                 00765000
GVSVOLID EQU   GVSSLOTS                                                 00766000
GVSVOLFL EQU   GVSSLOTS+6                                               00767000
GVSFRESP EQU   GVSSLOTS+10                                              00768000
GVSMTDSP EQU   GVSSLOTS+18                                              00769000
STPTB    EQU   0                                                        00770000
STPFLAGS EQU   STPTB+14                                                 00771000
STPNOFRE EQU   STPFLAGS                                                 00772000
STPDDPTR EQU   STPTB+16                                                 00773000
STPDDENT EQU   0                                                        00774000
STPDDNXT EQU   STPDDENT                                                 00775000
STPDDGPN EQU   STPDDENT+12                                              00776000
STPDDGPI EQU   STPDDENT+20                                              00777000
STPDDGPS EQU   STPDDENT+21                                              00778000
STPDDPRM EQU   STPDDENT+22                                              00779000
STPDDFLG EQU   STPDDENT+24                                              00780000
STPDDVOL EQU   STPDDENT+26                                              00781000
TRMRB    EQU   0                                                        00782000
TRMFLAGS EQU   TRMRB+5                                                  00783000
TRMSTHDR EQU   TRMRB+12                                                 00784000
*                                      START UNREFERENCED COMPONENTS    00785000
TRMJOBID EQU   TRMRB+8                                                  00786000
@NM00020 EQU   TRMRB+6                                                  00787000
@NM00019 EQU   TRMFLAGS                                                 00788000
TRMSCHAB EQU   TRMFLAGS                                                 00789000
TRMALLOK EQU   TRMFLAGS                                                 00790000
TRMRBOPC EQU   TRMRB+4                                                  00791000
TRMRBLEN EQU   TRMRB                                                    00792000
STPDDNVL EQU   STPDDENT+25                                              00793000
@NM00015 EQU   STPDDFLG                                                 00794000
STPDDSPL EQU   STPDDFLG                                                 00795000
STPDDEXC EQU   STPDDFLG                                                 00796000
STPDDDVT EQU   STPDDENT+8                                               00797000
STPDDNUM EQU   STPDDENT+6                                               00798000
STPDDLEN EQU   STPDDENT+4                                               00799000
STPICCTR EQU   STPTB+15                                                 00800000
@NM00014 EQU   STPFLAGS                                                 00801000
STPINVAL EQU   STPFLAGS                                                 00802000
STPHDRLN EQU   STPTB+12                                                 00803000
STPJOBID EQU   STPTB+8                                                  00804000
STPPRVTB EQU   STPTB+4                                                  00805000
STPNXTTB EQU   STPTB                                                    00806000
GVSEXPDT EQU   GVSSLOTS+14                                              00807000
GVSLEXT  EQU   GVSSLOTS+12                                              00808000
@NM00013 EQU   GVSVOLFL+2                                               00809000
GVSMTNSH EQU   GVSVOLFL+2                                               00810000
GVSRCFSI EQU   GVSVOLFL+2                                               00811000
GVSCPUBM EQU   GVSVOLFL                                                 00812000
@NM00012 EQU   GVSHDR+20                                                00813000
GVSESIND EQU   GVSHDR+18                                                00814000
@NM00011 EQU   GVSHDR+17                                                00815000
@NM00010 EQU   GVSFLAGA+2                                               00816000
GVSEX    EQU   GVSFLAGA+2                                               00817000
@NM00009 EQU   GVSTYPE                                                  00818000
GVSGVSEX EQU   GVSTYPE                                                  00819000
@NM00008 EQU   GVSTYPE                                                  00820000
GVSNO    EQU   GVSID+1                                                  00821000
GVSRES1  EQU   GVSID                                                    00822000
GVSVVGRP EQU   GVSNAME+3                                                00823000
GVSG     EQU   GVSNAME                                                  00824000
VVIUNUSD EQU   VVICB+116                                                00825000
VVINUSDC EQU   VVICB+112                                                00826000
VVITPFCH EQU   VVICB+108                                                00827000
VVIDVMEL EQU   VVICB+104                                                00828000
VVIVBSTF EQU   VVICB+100                                                00829000
VVISSOBA EQU   VVICB+96                                                 00830000
VVIVSCRA EQU   VVICB+92                                                 00831000
VVISTPTB EQU   VVICB+88                                                 00832000
VVIDVMTA EQU   VVICB+84                                                 00833000
VVIJUCB  EQU   VVICB+80                                                 00834000
VVIIUCB  EQU   VVICB+76                                                 00835000
VVIRES6  EQU   VVICB+72                                                 00836000
VVIRES5  EQU   VVICB+68                                                 00837000
VVIRES4  EQU   VVICB+64                                                 00838000
VVIUCB   EQU   VVICB+60                                                 00839000
VVIVJL   EQU   VVICB+56                                                 00840000
VVIVRR   EQU   VVICB+52                                                 00841000
VVIQLSPL EQU   VVICB+48                                                 00842000
VVIQRPL2 EQU   VVICB+44                                                 00843000
VVIQRPL1 EQU   VVICB+40                                                 00844000
VVIRES3  EQU   VVICB+36                                                 00845000
VVIVQMP  EQU   VVICB+32                                                 00846000
VVIECB1  EQU   VVICB+28                                                 00847000
VVICATAD EQU   VVICB+24                                                 00848000
VVIDCBAD EQU   VVICB+20                                                 00849000
VVIACBAD EQU   VVICB+16                                                 00850000
VVIFLG7  EQU   VVIFLGA                                                  00851000
VVIFLG6  EQU   VVIFLGA                                                  00852000
VVIFLG5  EQU   VVIFLGA                                                  00853000
VVIFLG4  EQU   VVIFLGA                                                  00854000
VVIFLG3  EQU   VVIFLGA                                                  00855000
VVIFLG2  EQU   VVIFLGA                                                  00856000
VVIFLG1  EQU   VVIFLGA                                                  00857000
VVIALCON EQU   VVICB+14                                                 00858000
VVICPUID EQU   VVICB+12                                                 00859000
VVIUCAT  EQU   VVICB+4                                                  00860000
VVICID   EQU   VVICB                                                    00861000
RPLVRLN  EQU   RPLVSAM+48                                               00862000
@NM00007 EQU   RPLVSAM+44                                               00863000
@NM00006 EQU   RPLVOPT                                                  00864000
RPLVKGE  EQU   RPLVOPT                                                  00865000
@NM00005 EQU   RPLVOPT                                                  00866000
RPLVNEXT EQU   RPLVOPT                                                  00867000
RPLVLOC  EQU   RPLVOPT                                                  00868000
@NM00004 EQU   RPLVSAM+28                                               00869000
RPLVACB  EQU   RPLVSAM+24                                               00870000
@NM00003 EQU   RPLVSAM+3                                                00871000
@NM00002 EQU   RPLVSAM                                                  00872000
@NM00001 EQU   RPLV+38                                                  00873000
RPLRMSCC EQU   RPLV+36                                                  00874000
RPLRCODE EQU   RPLV+32                                                  00875000
RPLVTLEN EQU   RPLV+30                                                  00876000
RPLVRES1 EQU   RPLFLAGA+1                                               00877000
RPLVJRNL EQU   RPLFLAGA                                                 00878000
RPLJRCVY EQU   RPLFLAGA                                                 00879000
RPLVVOP  EQU   RPLFLAGA                                                 00880000
RPLVVIN  EQU   RPLFLAGA                                                 00881000
RPLVCOMP EQU   RPLFLAGA                                                 00882000
RPLVPROG EQU   RPLFLAGA                                                 00883000
RPLVPOST EQU   RPLFLAGA                                                 00884000
RPLFTIME EQU   RPLFLAGA                                                 00885000
RPLVRSV3 EQU   RPLV+24                                                  00886000
RPLVRSV2 EQU   RPLV+20                                                  00887000
RPLVRSV1 EQU   RPLV+16                                                  00888000
RPLASCBP EQU   RPLTCBPR                                                 00889000
RPLVECB  EQU   RPLV+4                                                   00890000
RPLVQPTR EQU   RPLV                                                     00891000
*                                      END UNREFERENCED COMPONENTS      00892000
@RC00082 EQU   @RC00079                                                 00893000
@RF00090 EQU   @EL00002                                                 00894000
@RC00116 EQU   @EL00003                                                 00895000
@RC00123 EQU   @EL00004                                                 00896000
@RF00128 EQU   @RC00123                                                 00897000
@ENDDATA EQU   *                                                        00898000
         END   ICBVTM00,(C'PLS0545',0603,76275)                         00899000
./  ADD  SSI=62740247,NAME=ICBVTP00
         TITLE '************* ICBVTP00 - MSVC TABLE PROCESSOR **********00001000
               *****    '                                               00002000
ICBVTP00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVTP00  76.275'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @07,@SA00001                                        0001 00015000
         ST    @07,8(,@13)                                         0001 00016000
         LR    @13,@07                                             0001 00017000
*   PARMPTR=PARMADDR;               /* SAVE PARM LIST ADDR   @G24LB18*/ 00018000
         L     PARMPTR,PARMADDR(,REG1)                             0077 00019000
*   VVIPTR=ICBVVICB;                /* SET UP MSVC CB PTR    @G24LB18*/ 00020000
         L     @15,CVTPTR                                          0078 00021000
         L     @15,CVTEXT2(,@15)                                   0078 00022000
         L     @15,CVTICB(,@15)                                    0078 00023000
         L     @15,ICBVVICB(,@15)                                  0078 00024000
         ST    @15,VVIPTR                                          0078 00025000
*   RFY                                                            0079 00026000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00027000
*   RFY                                                            0080 00028000
*     TABP BASED(PARMPTR);          /* BASE TABP PARM LIST   @G24LB18*/ 00029000
*   RFY                                                            0081 00030000
*     SELRB BASED(TABSELRB);        /* BASE SELECT REQ BLK   @G24LB18*/ 00031000
*   RFY                                                            0082 00032000
*     STPTB BASED(STHDRPTR);        /* BASE STEP TABLE HDR   @G24LB18*/ 00033000
*   RFY                                                            0083 00034000
*     STPDDENT BASED(DDENTPTR);     /* BASE DD ENTRY         @G24LB18*/ 00035000
*   RETCODE=ZERO;                   /* SET RETURN CODE = 0   @G24LB18*/ 00036000
         SLR   @15,@15                                             0084 00037000
         ST    @15,RETCODE                                         0084 00038000
*                                                                  0085 00039000
*   /*****************************************************************/ 00040000
*   /*                                                               */ 00041000
*   /* DETERMINE WHICH FUNCTION WAS REQUESTED AND CALL THE   @G24LB18*/ 00042000
*   /* APPROPRIATE PROCEDURE TO PROCESS IT.                  @G24LB18*/ 00043000
*   /*                                                               */ 00044000
*   /*****************************************************************/ 00045000
*                                                                  0085 00046000
*                                                                  0085 00047000
*   /*****************************************************************/ 00048000
*   /*                                                               */ 00049000
*   /* BUILD DD ENTRY REQUEST                                @G24LB18*/ 00050000
*   /*                                                               */ 00051000
*   /*****************************************************************/ 00052000
*                                                                  0085 00053000
*   IF TABFBLDE=ON THEN             /* BUILD DD ENTRY REQ?   @G24LB18*/ 00054000
         TM    TABFBLDE(PARMPTR),B'10000000'                       0085 00055000
         BNO   @RF00085                                            0085 00056000
*     DO;                           /* YES                   @G24LB18*/ 00057000
*       CALL BLDDDENT;              /* CALL BUILD DD ENT RTN @G24LB18*/ 00058000
         BAL   @14,BLDDDENT                                        0087 00059000
*       IF RETCODE=FOUR THEN        /* DD ENTRY NOT BUILT?   @G24LB18*/ 00060000
         L     @15,RETCODE                                         0088 00061000
         C     @15,@CF00060                                        0088 00062000
         BNE   @RF00088                                            0088 00063000
*         RETURN CODE(RETCODE);     /* YES-RETURN TO CALLER  @G24LB18*/ 00064000
         L     @13,4(,@13)                                         0089 00065000
         L     @14,12(,@13)                                        0089 00066000
         LM    @00,@12,20(@13)                                     0089 00067000
         BR    @14                                                 0089 00068000
*     END;                          /* WITH RETURN CODE = 4  @G24LB18*/ 00069000
*                                                                  0090 00070000
*   /*****************************************************************/ 00071000
*   /*                                                               */ 00072000
*   /* FOR ALL REQUESTS EXCEPT 'BUILD DD ENTRY', SET THE     @G24LB18*/ 00073000
*   /* LOCAL AND CMS LOCKS BEFORE PROCESSING.                @G24LB18*/ 00074000
*   /*                                                               */ 00075000
*   /*****************************************************************/ 00076000
*                                                                  0091 00077000
*   ELSE                            /*                       @G24LB18*/ 00078000
*     DO;                           /*                       @G24LB18*/ 00079000
         B     @RC00085                                            0091 00080000
@RF00085 DS    0H                                                  0092 00081000
*       VVIFLG6=ON;                 /* SET LOCAL LOCK FLAG   @G24LB18*/ 00082000
*       VVIFLG7=ON;                 /* SET CMS LOCK FLAG     @G24LB18*/ 00083000
         L     @15,VVIPTR                                          0093 00084000
         OI    VVIFLG6(@15),B'00000011'                            0093 00085000
*       GENERATE;                                                  0094 00086000
*                                                          /*@G24LB18*/ 00087000
LGETLCL1 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               *00088000
               RELATED=(ICBVTP00(LFRELCL1))                             00089000
LGETCMS1 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,                 *00090000
               RELATED=(ICBVTP00(LFRECMS1))                             00091000
*     END;                          /*                       @G24LB18*/ 00092000
*                                                                  0095 00093000
*   /*****************************************************************/ 00094000
*   /*                                                               */ 00095000
*   /* SEARCH FOR DD ENTRY REQUEST                           @G24LB18*/ 00096000
*   /*                                                               */ 00097000
*   /*****************************************************************/ 00098000
*                                                                  0096 00099000
*   IF TABFSRCD=ON THEN             /* SEARCH FOR DD ENTRY?  @G24LB18*/ 00100000
@RC00085 TM    TABFSRCD(PARMPTR),B'01000000'                       0096 00101000
         BNO   @RF00096                                            0096 00102000
*     CALL SRCDDENT;                /* YES - CALL SEARCH RTN @G24LB18*/ 00103000
         BAL   @14,SRCDDENT                                        0097 00104000
*                                                                  0098 00105000
*   /*****************************************************************/ 00106000
*   /*                                                               */ 00107000
*   /* UPDATE BEST FIT TABLE REQUEST                         @G24LB18*/ 00108000
*   /*                                                               */ 00109000
*   /*****************************************************************/ 00110000
*                                                                  0098 00111000
*   IF TABFBFIT=ON THEN             /* UPDATE BEST FIT TAB?  @G24LB18*/ 00112000
@RF00096 TM    TABFBFIT(PARMPTR),B'00100000'                       0098 00113000
         BNO   @RF00098                                            0098 00114000
*     CALL UPDTBFTB;                /* YES-CALL UPDATE RTN   @G24LB18*/ 00115000
*                                                                  0099 00116000
         BAL   @14,UPDTBFTB                                        0099 00117000
*   /*****************************************************************/ 00118000
*   /*                                                               */ 00119000
*   /* GET TOTAL SPACE FOR VOLSER REQUEST                    @G24LB18*/ 00120000
*   /*                                                               */ 00121000
*   /*****************************************************************/ 00122000
*                                                                  0100 00123000
*   IF TABFTSPC=ON THEN             /* TOTAL SPACE REQ?      @G24LB18*/ 00124000
@RF00098 TM    TABFTSPC(PARMPTR),B'00010000'                       0100 00125000
         BNO   @RF00100                                            0100 00126000
*     CALL TOTSPACE;                /* YES-CALL SPACE RTN    @G24LB18*/ 00127000
*                                                                  0101 00128000
         BAL   @14,TOTSPACE                                        0101 00129000
*   /*****************************************************************/ 00130000
*   /*                                                               */ 00131000
*   /* RELEASE THE CMS AND LOCAL LOCKS AND RETURN TO THE     @G24LB18*/ 00132000
*   /* CALLER WITH A RETURN CODE IN REGISTER 15.             @G24LB18*/ 00133000
*   /*                                                               */ 00134000
*   /*****************************************************************/ 00135000
*                                                                  0102 00136000
*   GENERATE;                                                      0102 00137000
@RF00100 DS    0H                                                  0102 00138000
*                                                          /*@G24LB18*/ 00139000
LFRECMS1 SETLOCK RELEASE,TYPE=CMS,REGS=USE,                            *00140000
               RELATED=(ICBVTP00(LGETCMS1,LGETCMS2,LGETCMS3))           00141000
LFRELCL1 SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                          *00142000
               RELATED=(ICBVTP00(LGETLCL1,LGETLCL2,LGETLCL3))           00143000
*   VVIFLG6=OFF;                    /* TURN OFF LOCAL AND    @G24LB18*/ 00144000
*   VVIFLG7=OFF;                    /* CMS LOCK FLAGS        @G24LB18*/ 00145000
         L     @15,VVIPTR                                          0104 00146000
         NI    VVIFLG6(@15),B'11111100'                            0104 00147000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER      @G24LB18*/ 00148000
*                                                                  0105 00149000
         L     @15,RETCODE                                         0105 00150000
         L     @13,4(,@13)                                         0105 00151000
         L     @14,12(,@13)                                        0105 00152000
         LM    @00,@12,20(@13)                                     0105 00153000
         BR    @14                                                 0105 00154000
*   /*****************************************************************/ 00155000
*   /*                                                               */ 00156000
*   /* END OF MAINLINE PROCESSING FOR ICBVTP00. THE          @G24LB18*/ 00157000
*   /* REMAINDER OF THE MODULE CONSISTS OF INTERNAL          @G24LB18*/ 00158000
*   /* PROCEDURES FOR ICBVTP00.                              @G24LB18*/ 00159000
*   /*                                                               */ 00160000
*   /*****************************************************************/ 00161000
*                                                                  0106 00162000
*                                                                  0106 00163000
*/*********************************************************  @G24LB18*/ 00164000
*/*                                                          @G24LB18*/ 00165000
*/* PROCEDURE NAME - BLDDDENT                                @G24LB18*/ 00166000
*/*                                                          @G24LB18*/ 00167000
*/* FUNCTION - THIS ROUTINE IS CALLED ON BUILD DD ENTRY      @G24LB18*/ 00168000
*/*            REQUESTS. IT DETERMINES THE LENGTH OF THE     @G24LB18*/ 00169000
*/*            ENTRY, GETS STORAGE FOR IT, FILLS IT IN WITH  @G24LB18*/ 00170000
*/*            THE INFORMATION PASSED IN THE REQUEST, AND    @G24LB18*/ 00171000
*/*            ADDS IT TO THE STEP TABLE FOR THE REQUESTED   @G24LB18*/ 00172000
*/*            STEP, IF ONE EXISTS. IF NOT, IT BUILDS A NEW  @G24LB18*/ 00173000
*/*            STEP TABLE AND ADDS THE ENTRY TO IT.          @G24LB18*/ 00174000
*/*                                                          @G24LB18*/ 00175000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST, SELECT   @G24LB18*/ 00176000
*/*         REQUEST BLOCK, GROUP PARAMETERS AREA, AND VOLSER @G24LB18*/ 00177000
*/*         RETURN AREA.                                     @G24LB18*/ 00178000
*/*                                                          @G24LB18*/ 00179000
*/* OUTPUT - A NEW DD ENTRY IS BUILT AND ADDED TO THE STEP   @G24LB18*/ 00180000
*/*          TABLE CHAIN FOR THE REQUEST. A RETURN CODE OF   @G24LB18*/ 00181000
*/*          0 IS RETURNED IF THE ENTRY IS BUILT SUCCESS-    @G24LB18*/ 00182000
*/*          FULLY. A RETURN CODE OF 4 IS RETURNED IF A      @G24LB18*/ 00183000
*/*          GETMAIN FAILURE OCCURRED AND CONSOLE ERROR      @G24LB18*/ 00184000
*/*          MESSAGE ICB409I 'NO STORAGE AVAILABLE' IS       @G24LB18*/ 00185000
*/*          ISSUED.                                         @G24LB18*/ 00186000
*/*                                                          @G24LB18*/ 00187000
*/*********************************************************  @G24LB18*/ 00188000
*                                                                  0106 00189000
*BLDDDENT:                          /*                       @G24LB18*/ 00190000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00191000
BLDDDENT DS    0H                                                  0107 00192000
*   JFCBPTR=SELJFCBA;               /* SET UP JFCB PTR       @G24LB18*/ 00193000
*                                                                  0107 00194000
         L     @15,TABSELRB(,PARMPTR)                              0107 00195000
         L     @15,SELJFCBA(,@15)                                  0107 00196000
         ST    @15,JFCBPTR                                         0107 00197000
*   /*****************************************************************/ 00198000
*   /*                                                               */ 00199000
*   /* DETERMINE THE NUMBER OF VOL SERS FOR THE REQUEST.     @G24LB18*/ 00200000
*   /*                                                               */ 00201000
*   /*****************************************************************/ 00202000
*                                                                  0108 00203000
*   IF JFCBNVOL¬=ZERO THEN          /* SPECIFIC DD?          @G24LB18*/ 00204000
         CLI   JFCBNVOL(@15),0                                     0108 00205000
         BE    @RF00108                                            0108 00206000
*     NVOL=JFCBNVOL;                /* YES-NO. OF VOLS =     @G24LB18*/ 00207000
         MVC   NVOL(1),JFCBNVOL(@15)                               0109 00208000
*   ELSE                            /* JFCBNVOL              @G24LB18*/ 00209000
*     IF SELPARMT=ON THEN           /* PARALLEL MOUNT?       @G24LB18*/ 00210000
         B     @RC00108                                            0110 00211000
@RF00108 L     @15,TABSELRB(,PARMPTR)                              0110 00212000
         TM    SELPARMT(@15),B'10000000'                           0110 00213000
         BNO   @RF00110                                            0110 00214000
*       NVOL=JFCBVLCT;              /* YES-NO. OF VOLS =     @G24LB18*/ 00215000
         L     @15,JFCBPTR                                         0111 00216000
         MVC   NVOL(1),JFCBVLCT(@15)                               0111 00217000
*     ELSE                          /* JFCBVLCT              @G24LB18*/ 00218000
*       NVOL=SELUNCNT;              /* NO-NO. OF VOLS = UNIT @G24LB18   00219000
*                                      COUNT                 @G24LB18*/ 00220000
*                                                                  0112 00221000
         B     @RC00110                                            0112 00222000
@RF00110 L     @15,TABSELRB(,PARMPTR)                              0112 00223000
         MVC   NVOL(1),SELUNCNT(@15)                               0112 00224000
*   /*****************************************************************/ 00225000
*   /*                                                               */ 00226000
*   /* DETERMINE LENGTH OF DD ENTRY AND ISSUE GETMAIN FOR    @G24LB18*/ 00227000
*   /* IT FROM SUBPOOL 241. IF GETMAIN FAILS, ISSUE CONSOLE  @G24LB18*/ 00228000
*   /* ERROR MESSAGE ICB409I 'NO STORAGE AVAILABLE', SET     @G24LB18*/ 00229000
*   /* RETURN CODE = 4, AND RETURN TO MAINLINE ICBVTP00. IF  @G24LB18*/ 00230000
*   /* GETMAIN IS SUCCESSFUL, CLEAR THE GOTTEN AREA AND CALL @G24LB18*/ 00231000
*   /* SUBPROCEDURE FILDDENT TO FILL IN THE DD ENTRY.        @G24LB18*/ 00232000
*   /*                                                               */ 00233000
*   /*****************************************************************/ 00234000
*                                                                  0113 00235000
*   RFY                                                            0113 00236000
*     REG0 RSTD;                    /* RESTRICT REG 0        @G24LB18*/ 00237000
@RC00110 DS    0H                                                  0113 00238000
@RC00108 DS    0H                                                  0114 00239000
*   RFY                                                            0114 00240000
*     REG1 RSTD;                    /* RESTRICT REG 1        @G24LB18*/ 00241000
*   RFY                                                            0115 00242000
*     REG15 RSTD;                   /* RESTRICT REG 15       @G24LB18*/ 00243000
*   SAVERET1=REG14;                 /* SAVE RETURN ADDRESS   @G24LB18*/ 00244000
         ST    REG14,SAVERET1                                      0116 00245000
*   GETLEN=NVOL*SIX+LENGTH(STPDDENT);/* SET ENTRY LENGTH     @G24LB18*/ 00246000
         SLR   GETLEN,GETLEN                                       0117 00247000
         IC    GETLEN,NVOL                                         0117 00248000
         MH    GETLEN,@CH00064                                     0117 00249000
         AL    GETLEN,@CF01659                                     0117 00250000
*   REG0=GETLEN;                    /* SET LEN FOR GETMAIN   @G24LB18*/ 00251000
         LR    REG0,GETLEN                                         0118 00252000
*LGET1:                                                            0119 00253000
*   GEN(GETMAIN RC,LV=(0),SP=241);  /* GETMAIN DD ENTRY      @G24LB18*/ 00254000
LGET1    GETMAIN RC,LV=(0),SP=241                                       00255000
*   IF REG15¬=ZERO THEN             /* STORAGE GOTTEN?       @G24LB18*/ 00256000
         LTR   REG15,REG15                                         0120 00257000
         BZ    @RF00120                                            0120 00258000
*     DO;                           /* NO                    @G24LB18*/ 00259000
*       MSGRQ=''B;                  /* CLEAR MESSAGE AREA    @G24LB18*/ 00260000
         XC    MSGRQ(32),MSGRQ                                     0122 00261000
*       MSGRPLV=TABSELRB-LENGTH(RPLV);/* SET RPLV ADDR       @G24LB18*/ 00262000
         L     @07,TABSELRB(,PARMPTR)                              0123 00263000
         SL    @07,@CF01660                                        0123 00264000
         ST    @07,MSGRPLV                                         0123 00265000
*       MSGID=MSG409;               /* SET MESSAGE ID        @G24LB18*/ 00266000
         MVC   MSGID(4),@CF00083                                   0124 00267000
*       REG1=ADDR(MSGRQ);           /* GET MSG LIST ADDR     @G24LB18*/ 00268000
         LA    REG1,MSGRQ                                          0125 00269000
*       CALL ICBVOP00;              /* CALL MSG ROUTINE      @G24LB18*/ 00270000
         L     @15,@CV01597                                        0126 00271000
         BALR  @14,@15                                             0126 00272000
*       REG14=SAVERET1;             /* RESTORE RETURN ADDR   @G24LB18*/ 00273000
         L     REG14,SAVERET1                                      0127 00274000
*       RETCODE=FOUR;               /* SET RETURN CODE = 4   @G24LB18*/ 00275000
         MVC   RETCODE(4),@CF00060                                 0128 00276000
*       RETURN;                     /* RETURN TO ICBVTP00    @G24LB18*/ 00277000
@EL00002 DS    0H                                                  0129 00278000
@EF00002 DS    0H                                                  0129 00279000
@ER00002 BR    @14                                                 0129 00280000
*     END;                          /*                       @G24LB18*/ 00281000
*   DDENTPTR=REG1;                  /* SET UP DD ENTRY PTR   @G24LB18*/ 00282000
@RF00120 LR    DDENTPTR,REG1                                       0131 00283000
*   STPDDENT=STPDDENT&&STPDDENT;    /* CLEAR DD ENTRY        @G24LB18*/ 00284000
         XC    STPDDENT(26,DDENTPTR),STPDDENT(DDENTPTR)            0132 00285000
*   CALL FILDDENT;                  /* CALL FILL-IN RTN      @G24LB18*/ 00286000
*                                                                  0133 00287000
         BAL   @14,FILDDENT                                        0133 00288000
*   /*****************************************************************/ 00289000
*   /*                                                               */ 00290000
*   /* SET THE LOCAL AND CMS LOCKS AND CALL SUBPROCEDURE     @G24LB18*/ 00291000
*   /* SRCJOBID TO SEARCH FOR THE STEP TABLE FOR THE         @G24LB18*/ 00292000
*   /* REQUEST. IF RETURN CODE = 4 (STEP TABLE NOT FOUND),   @G24LB18*/ 00293000
*   /* CALL SUBPROCEDURE BLDSTHDR TO BUILD A STEP TABLE      @G24LB18*/ 00294000
*   /* HEADER FOR THE REQUESTED STEP AND TO ADD THE DD ENTRY @G24LB18*/ 00295000
*   /* TO IT, AND RETURN TO MAINLINE ICBVTP00.               @G24LB18*/ 00296000
*   /*                                                               */ 00297000
*   /*****************************************************************/ 00298000
*                                                                  0134 00299000
*   VVIFLG6=ON;                     /* SET LOCAL LOCK FLAG   @G24LB18*/ 00300000
*   VVIFLG7=ON;                     /* SET CMS LOCK FLAG     @G24LB18*/ 00301000
         L     @11,VVIPTR                                          0135 00302000
         OI    VVIFLG6(@11),B'00000011'                            0135 00303000
*   GENERATE;                                                      0136 00304000
*                                                          /*@G24LB18*/ 00305000
LGETLCL2 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               *00306000
               RELATED=(ICBVTP00(LFRELCL1,LFRELCL2))                    00307000
LGETCMS2 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,                 *00308000
               RELATED=(ICBVTP00(LFRECMS1,LFRECMS2))                    00309000
*   JOBID=SELJOBID;                 /* GET JOBID             @G24LB18*/ 00310000
         L     @11,TABSELRB(,PARMPTR)                              0137 00311000
         L     JOBID,SELJOBID(,@11)                                0137 00312000
*   CALL SRCJOBID;                  /* CALL SEARCH RTN       @G24LB18*/ 00313000
         BAL   @14,SRCJOBID                                        0138 00314000
*   IF RETCODE=FOUR THEN            /* STEP TABLE FOUND?     @G24LB18*/ 00315000
         CLC   RETCODE(4),@CF00060                                 0139 00316000
         BNE   @RF00139                                            0139 00317000
*     DO;                           /* NO                    @G24LB18*/ 00318000
*       CALL BLDSTHDR;              /* CALL BUILD HDR RTN    @G24LB18*/ 00319000
         BAL   @14,BLDSTHDR                                        0141 00320000
*       REG14=SAVERET1;             /* RESTORE RETURN ADDR   @G24LB18*/ 00321000
         L     REG14,SAVERET1                                      0142 00322000
*       RETURN;                     /* RETURN TO ICBVTP00    @G24LB18*/ 00323000
         B     @EL00002                                            0143 00324000
*     END;                          /*                       @G24LB18*/ 00325000
*                                                                  0145 00326000
*   /*****************************************************************/ 00327000
*   /*                                                               */ 00328000
*   /* IF STEP TABLE WAS FOUND, TEST FOR INITIAL CALL FROM   @G24LB18*/ 00329000
*   /* ALLOCATION. IF SO, INCREMENT THE INITIAL CALL COUNTER @G24LB18*/ 00330000
*   /* BY 1. SEARCH FOR THE LAST DD ENTRY IN THE STEP TABLE, @G24LB18*/ 00331000
*   /* CHAIN THE NEW DD ENTRY TO IT, AND RETURN TO MAINLINE  @G24LB18*/ 00332000
*   /* ICBVTP00.                                             @G24LB18*/ 00333000
*   /*                                                               */ 00334000
*   /*****************************************************************/ 00335000
*                                                                  0145 00336000
*   IF SELINITC=ON THEN             /* INITIAL CALL?         @G24LB18*/ 00337000
@RF00139 L     @07,TABSELRB(,PARMPTR)                              0145 00338000
         TM    SELINITC(@07),B'00000100'                           0145 00339000
         BNO   @RF00145                                            0145 00340000
*     STPICCTR=STPICCTR+ONE;        /* YES-INCREMENT COUNTER @G24LB18*/ 00341000
         LA    @07,1                                               0146 00342000
         SLR   @11,@11                                             0146 00343000
         IC    @11,STPICCTR(,STHDRPTR)                             0146 00344000
         ALR   @07,@11                                             0146 00345000
         STC   @07,STPICCTR(,STHDRPTR)                             0146 00346000
*   SAVENTRY=DDENTPTR;              /* SAVE NEW DD ENTRY PTR @G24LB18*/ 00347000
@RF00145 LR    SAVENTRY,DDENTPTR                                   0147 00348000
*   DDENTPTR=STPDDPTR;              /* GET 1ST DD ENTRY      @G24LB18*/ 00349000
         L     DDENTPTR,STPDDPTR(,STHDRPTR)                        0148 00350000
*   DO WHILE STPDDNXT¬=ZERO;        /* LAST DD ENTRY?        @G24LB18*/ 00351000
         B     @DE00149                                            0149 00352000
@DL00149 DS    0H                                                  0150 00353000
*     DDENTPTR=STPDDNXT;            /* NO - GET NEXT ENTRY   @G24LB18*/ 00354000
         L     DDENTPTR,STPDDNXT(,DDENTPTR)                        0150 00355000
*   END;                            /* YES - CONTINUE        @G24LB18*/ 00356000
@DE00149 L     @11,STPDDNXT(,DDENTPTR)                             0151 00357000
         LTR   @11,@11                                             0151 00358000
         BNZ   @DL00149                                            0151 00359000
*   STPDDNXT=SAVENTRY;              /* SET NEXT DD PTR OF LAST ENTRY    00360000
*                                      = NEW DD ENTRY ADDR   @G24LB18*/ 00361000
         ST    SAVENTRY,STPDDNXT(,DDENTPTR)                        0152 00362000
*   REG14=SAVERET1;                 /* RESTORE RETURN ADDR   @G24LB18*/ 00363000
         L     REG14,SAVERET1                                      0153 00364000
*   RFY                                                            0154 00365000
*     REG0 UNRSTD;                  /* UNRESTRICT REG 0      @G24LB18*/ 00366000
*   RFY                                                            0155 00367000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00368000
*   RFY                                                            0156 00369000
*     REG15 UNRSTD;                 /* UNRESTRICT REG 15     @G24LB18*/ 00370000
*   RETURN;                         /* RETURN TO ICBVTP00    @G24LB18*/ 00371000
         B     @EL00002                                            0157 00372000
*   END BLDDDENT;                   /* END BUILD DD ENT RTN  @G24LB18*/ 00373000
*                                                                  0159 00374000
*/*********************************************************  @G24LB18*/ 00375000
*/*                                                          @G24LB18*/ 00376000
*/* PROCEDURE NAME - FILDDENT                                @G24LB18*/ 00377000
*/*                                                          @G24LB18*/ 00378000
*/* FUNCTION - THIS ROUTINE IS CALLED ON BUILD DD ENTRY      @G24LB18*/ 00379000
*/*            REQUESTS WHEN STORAGE FOR THE ENTRY HAS BEEN  @G24LB18*/ 00380000
*/*            GOTTEN. IT FILLS IN THE ENTRY WITH THE        @G24LB18*/ 00381000
*/*            INFORMATION PASSED IN THE SELECT REQUEST      @G24LB18*/ 00382000
*/*            BLOCK, JFCB, GROUP PARAMETERS AREA, AND       @G24LB18*/ 00383000
*/*            VOL SER RETURN AREA. IF THERE ARE JFCB        @G24LB18*/ 00384000
*/*            EXTENSIONS, IT CALLS SUBPROCEDURE MOVEEXT     @G24LB18*/ 00385000
*/*            TO FILL IN THE VOL SERS FROM THE EXTENSIONS.  @G24LB18*/ 00386000
*/*                                                          @G24LB18*/ 00387000
*/* INPUT - SELECT REQUEST BLOCK, JFCB, NEW DD ENTRY,        @G24LB18*/ 00388000
*/*          GROUP PARAMETERS AREA, VOL SER RETURN AREA,     @G24LB18*/ 00389000
*/*          LENGTH OF DD ENTRY, AND NO. OF VOL SERS.        @G24LB18*/ 00390000
*/*                                                          @G24LB18*/ 00391000
*/* OUTPUT - COMPLETED DD ENTRY                              @G24LB18*/ 00392000
*/*                                                          @G24LB18*/ 00393000
*/*********************************************************  @G24LB18*/ 00394000
*                                                                  0159 00395000
*FILDDENT:                                                         0159 00396000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00397000
*                                                                  0159 00398000
FILDDENT DS    0H                                                  0160 00399000
*   /*****************************************************************/ 00400000
*   /*                                                               */ 00401000
*   /* STORE THE LENGTH OF THE ENTRY AND THE NO. OF VOL SERS @G24LB18*/ 00402000
*   /* REQUESTED INTO THE DD ENTRY. COPY THE DD # FROM THE   @G24LB18*/ 00403000
*   /* SELECT REQUEST BLOCK INTO THE ENTRY.                  @G24LB18*/ 00404000
*   /*                                                               */ 00405000
*   /*****************************************************************/ 00406000
*                                                                  0160 00407000
*   STPDDLEN=GETLEN;                /* STORE LENGTH INTO ENT @G24LB18*/ 00408000
         STH   GETLEN,STPDDLEN(,DDENTPTR)                          0160 00409000
*   STPDDNVL=NVOL;                  /* STORE NO. OF VOLS     @G24LB18*/ 00410000
         MVC   STPDDNVL(1,DDENTPTR),NVOL                           0161 00411000
*   STPDDNUM=SELDDNUM;              /* COPY DD #             @G24LB18*/ 00412000
*                                                                  0162 00413000
         L     @15,TABSELRB(,PARMPTR)                              0162 00414000
         LH    @07,SELDDNUM(,@15)                                  0162 00415000
         STH   @07,STPDDNUM(,DDENTPTR)                             0162 00416000
*   /*****************************************************************/ 00417000
*   /*                                                               */ 00418000
*   /* IF A SPECIFIC UNIT ADDRESS WAS REQUESTED, COPY THE    @G24LB18*/ 00419000
*   /* UCB ADDRESS FROM THE SELECT REQUEST BLOCK INTO THE    @G24LB18*/ 00420000
*   /* INTERNAL DEVICE TYPE FIELD OF THE DD ENTRY. OTHERWISE @G24LB18*/ 00421000
*   /* COPY THE INTERNAL DEVICE TYPE FROM THE SELECT REQUEST @G24LB18*/ 00422000
*   /* BLOCK INTO THE DD ENTRY.                              @G24LB18*/ 00423000
*   /*                                                               */ 00424000
*   /*****************************************************************/ 00425000
*                                                                  0163 00426000
*   IF SELUCBAD¬=ZERO THEN          /* SPECIFIC UNIT ADDR?   @G24LB18*/ 00427000
         L     @15,SELUCBAD(,@15)                                  0163 00428000
         LTR   @15,@15                                             0163 00429000
         BZ    @RF00163                                            0163 00430000
*     STPDDDVT=SELUCBAD;            /* YES-COPY UCB ADDR     @G24LB18*/ 00431000
         ST    @15,STPDDDVT(,DDENTPTR)                             0164 00432000
*   ELSE                            /* INTO INT DEV TYPE     @G24LB18*/ 00433000
*     STPDDDVT=SELDEVTP;            /* NO-COPY INT DEV TYPE  @G24LB18*/ 00434000
         B     @RC00163                                            0165 00435000
@RF00163 L     @15,TABSELRB(,PARMPTR)                              0165 00436000
         MVC   STPDDDVT(4,DDENTPTR),SELDEVTP(@15)                  0165 00437000
*                                                                  0166 00438000
*   /*****************************************************************/ 00439000
*   /*                                                               */ 00440000
*   /* IF THE REQUEST IS FOR DEFERRED MOUNT OR UNIT=AFF, OR  @G24LB18*/ 00441000
*   /* IF VOLUME COUNT > UNIT COUNT AND PARALLEL MOUNT IS    @G24LB18*/ 00442000
*   /* NOT REQUESTED, TURN ON THE EXCLUSIVE USE INDICATOR IN @G24LB18*/ 00443000
*   /* THE DD ENTRY.                                         @G24LB18*/ 00444000
*   /*                                                               */ 00445000
*   /*****************************************************************/ 00446000
*                                                                  0166 00447000
*   IF JFCBVLCT=ZERO THEN           /* ANY NON-SPECIFIC VOL? @G24LB18*/ 00448000
@RC00163 L     @15,JFCBPTR                                         0166 00449000
         CLI   JFCBVLCT(@15),0                                     0166 00450000
         BNE   @RF00166                                            0166 00451000
*     NVOL=JFCBNVOL;                /* NO-VOL CNT= JFCBNVOL  @G24LB18*/ 00452000
         MVC   NVOL(1),JFCBNVOL(@15)                               0167 00453000
*   ELSE                            /* YES -                 @G24LB18*/ 00454000
*     NVOL=JFCBVLCT;                /* VOL COUNT = JFCBVLCT  @G24LB18*/ 00455000
         B     @RC00166                                            0168 00456000
@RF00166 L     @15,JFCBPTR                                         0168 00457000
         MVC   NVOL(1),JFCBVLCT(@15)                               0168 00458000
*   IF SELDEFER=ON|                 /* DEFERRED MOUNT OR     @G24LB18*/ 00459000
*       JFCBUAFF=ON|                /* UNIT=AFF OR           @G24LB18*/ 00460000
*       (NVOL>SELUNCNT&             /* VOL CNT > UNIT CNT &  @G24LB18*/ 00461000
*       SELPARMT=OFF) THEN          /* NO PARALLEL MOUNT?    @G24LB18*/ 00462000
@RC00166 L     @15,TABSELRB(,PARMPTR)                              0169 00463000
         TM    SELDEFER(@15),B'01000000'                           0169 00464000
         BO    @RT00169                                            0169 00465000
         L     @07,JFCBPTR                                         0169 00466000
         TM    JFCBUAFF(@07),B'00000001'                           0169 00467000
         BO    @RT00169                                            0169 00468000
         CLC   NVOL(1),SELUNCNT(@15)                               0169 00469000
         BNH   @RF00169                                            0169 00470000
         TM    SELPARMT(@15),B'10000000'                           0169 00471000
         BNZ   @RF00169                                            0169 00472000
@RT00169 DS    0H                                                  0170 00473000
*     STPDDEXC=ON;                  /* YES-SET EXCLUSIVE IND @G24LB18*/ 00474000
*                                                                  0170 00475000
         OI    STPDDEXC(DDENTPTR),B'10000000'                      0170 00476000
*   /*****************************************************************/ 00477000
*   /*                                                               */ 00478000
*   /* COPY THE GROUP PARAMETERS PASSED WITH THE PARM LIST   @G24LB18*/ 00479000
*   /* INTO THE DD ENTRY.                                    @G24LB18*/ 00480000
*   /*                                                               */ 00481000
*   /*****************************************************************/ 00482000
*                                                                  0171 00483000
*   RFY                                                            0171 00484000
*     REG1 RSTD;                    /* RESTRICT REG 1        @G24LB18*/ 00485000
@RF00169 DS    0H                                                  0172 00486000
*   MOVEPTR=ADDR(STPDDGPN);         /* SET DD ENTRY ADDR     @G24LB18*/ 00487000
         LA    MOVEPTR,STPDDGPN(,DDENTPTR)                         0172 00488000
*   REG1=LENGTH(GRPPR);             /* SET GROUP PARMS LENG  @G24LB18*/ 00489000
         LA    REG1,12                                             0173 00490000
*   MOVELST(1:REG1)=GRPPR;          /* COPY IN GROUP PARMS   @G24LB18*/ 00491000
*                                                                  0174 00492000
         LR    @15,REG1                                            0174 00493000
         BCTR  @15,0                                               0174 00494000
         L     @11,TABSELRB(,PARMPTR)                              0174 00495000
         L     @10,SELGRPPR(,@11)                                  0174 00496000
         EX    @15,@SM01666                                        0174 00497000
*   /*****************************************************************/ 00498000
*   /*                                                               */ 00499000
*   /* IF THE REQUEST IS NON-SPECIFIC, MOVE THE VOLSERS FROM @G24LB18*/ 00500000
*   /* THE VOL SER RETURN AREA INTO THE DD ENTRY AND RETURN  @G24LB18*/ 00501000
*   /* TO BLDDDENT.                                          @G24LB18*/ 00502000
*   /*                                                               */ 00503000
*   /*****************************************************************/ 00504000
*                                                                  0175 00505000
*   IF JFCBNVOL=ZERO THEN           /* REQ NON-SPECIFIC?     @G24LB18*/ 00506000
         L     @15,JFCBPTR                                         0175 00507000
         CLI   JFCBNVOL(@15),0                                     0175 00508000
         BNE   @RF00175                                            0175 00509000
*     DO;                           /* YES                   @G24LB18*/ 00510000
*       RFY                                                        0177 00511000
*         REG0 RSTD;                /* RESTRICT REG 0        @G24LB18*/ 00512000
*       RFY                                                        0178 00513000
*         REG2 RSTD;                /* RESTRICT REG 2        @G24LB18*/ 00514000
*       RFY                                                        0179 00515000
*         REG3 RSTD;                /* RESTRICT REG 3        @G24LB18*/ 00516000
*       REG0=ADDR(STPDDVOL);        /* GET DD ENT VOLSER ADR @G24LB18*/ 00517000
         LA    REG0,STPDDVOL(,DDENTPTR)                            0180 00518000
*       REG1=VOLLEN-FOUR;           /* GET VOLSER LENGTH     @G24LB18*/ 00519000
         L     @15,SELVLRET(,@11)                                  0181 00520000
         LH    REG1,VOLLEN(,@15)                                   0181 00521000
         SL    REG1,@CF00060                                       0181 00522000
*       REG2=ADDR(VOLSER);          /* GET VOLRET VOLSER ADR @G24LB18*/ 00523000
         LA    REG2,VOLSER(,@15)                                   0182 00524000
*       REG3=REG1;                  /* GET LENGTH FOR MOVE   @G24LB18*/ 00525000
         LR    REG3,REG1                                           0183 00526000
*       GEN(MVCL  REG0,REG2);       /* COPY VOLSERS INTO ENT @G24LB18*/ 00527000
         MVCL  REG0,REG2                                                00528000
*       RFY                                                        0185 00529000
*         REG0 UNRSTD;              /* UNRESTRICT REG 0      @G24LB18*/ 00530000
*       RFY                                                        0186 00531000
*         REG2 UNRSTD;              /* UNRESTRICT REG 2      @G24LB18*/ 00532000
*       RFY                                                        0187 00533000
*         REG3 UNRSTD;              /* UNRESTRICT REG 3      @G24LB18*/ 00534000
*       RETURN;                     /* RETURN TO BLDDDENT    @G24LB18*/ 00535000
@EL00003 DS    0H                                                  0188 00536000
@EF00003 DS    0H                                                  0188 00537000
@ER00003 BR    @14                                                 0188 00538000
*     END;                          /*                       @G24LB18*/ 00539000
*                                                                  0189 00540000
*   /*****************************************************************/ 00541000
*   /*                                                               */ 00542000
*   /* IF THE REQUEST IS SPECIFIC,                           @G24LB18*/ 00543000
*   /* DETERMINE THE NUMBER OF VOL SERS IN THE JFCB AND MOVE @G24LB18*/ 00544000
*   /* THEM INTO THE DD ENTRY. IF THERE ARE JFCB EXTENSIONS, @G24LB18*/ 00545000
*   /* CALL SUBPROCEDURE MOVEEXT TO MOVE THE VOL SERS FROM   @G24LB18*/ 00546000
*   /* THE EXTENSIONS INTO THE DD ENTRY. RETURN TO BLDDDENT. @G24LB18*/ 00547000
*   /*                                                               */ 00548000
*   /*****************************************************************/ 00549000
*                                                                  0190 00550000
*   IF STPDDNVL>FIVE THEN           /* NO. OF VOLS > 5?      @G24LB18*/ 00551000
@RF00175 CLI   STPDDNVL(DDENTPTR),5                                0190 00552000
         BNH   @RF00190                                            0190 00553000
*     NVOL=FIVE;                    /* YES-SET NO. VOLS = 5  @G24LB18*/ 00554000
         MVI   NVOL,X'05'                                          0191 00555000
*   ELSE                            /* NO -                  @G24LB18*/ 00556000
*     NVOL=STPDDNVL;                /* SET NO. VOLS FROM ENT @G24LB18*/ 00557000
         B     @RC00190                                            0192 00558000
@RF00190 MVC   NVOL(1),STPDDNVL(DDENTPTR)                          0192 00559000
*   REG1=NVOL*SIX;                  /* GET LENGTH OF VOLSERS @G24LB18*/ 00560000
@RC00190 SLR   REG1,REG1                                           0193 00561000
         IC    REG1,NVOL                                           0193 00562000
         MH    REG1,@CH00064                                       0193 00563000
*   STPDDVOL(ONE)=JFCBVOLS(1:REG1); /* COPY VOLSERS INTO ENT @G24LB18*/ 00564000
         MVI   STPDDVOL+1(DDENTPTR),C' '                           0194 00565000
         MVC   STPDDVOL+2(4,DDENTPTR),STPDDVOL+1(DDENTPTR)         0194 00566000
         LR    @15,REG1                                            0194 00567000
         BCTR  @15,0                                               0194 00568000
         L     @07,JFCBPTR                                         0194 00569000
         EX    @15,@SM01668                                        0194 00570000
*   RFY                                                            0195 00571000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00572000
*   IF SELJFCBX¬=ZERO THEN          /* ANY JFCB EXTENSIONS?  @G24LB18*/ 00573000
         L     @15,TABSELRB(,PARMPTR)                              0196 00574000
         L     @15,SELJFCBX(,@15)                                  0196 00575000
         LTR   @15,@15                                             0196 00576000
         BZ    @RF00196                                            0196 00577000
*     DO;                           /* YES                   @G24LB18*/ 00578000
*       SAVERET2=REG14;             /* SAVE RETURN ADDRESS   @G24LB18*/ 00579000
         ST    REG14,SAVERET2                                      0198 00580000
*       CALL MOVEEXT;               /* CALL MOVE VOLSERS RTN @G24LB18*/ 00581000
         BAL   @14,MOVEEXT                                         0199 00582000
*       REG14=SAVERET2;             /* RESTORE RETURN ADDR   @G24LB18*/ 00583000
         L     REG14,SAVERET2                                      0200 00584000
*     END;                          /*                       @G24LB18*/ 00585000
*   RETURN;                         /* RETURN TO BLDDDENT    @G24LB18*/ 00586000
         B     @EL00003                                            0202 00587000
*   END FILDDENT;                   /* END FILL DD ENT RTN   @G24LB18*/ 00588000
         B     @EL00003                                            0203 00589000
*                                                                  0204 00590000
*/*********************************************************  @G24LB18*/ 00591000
*/*                                                          @G24LB18*/ 00592000
*/* PROCEDURE NAME - MOVEEXT                                 @G24LB18*/ 00593000
*/*                                                          @G24LB18*/ 00594000
*/* FUNCTION - THIS ROUTINE IS CALLED ON BUILD DD ENTRY      @G24LB18*/ 00595000
*/*            REQUESTS WITH JFCB EXTENSIONS. IT MOVES THE   @G24LB18*/ 00596000
*/*            VOL SERS FROM THE EXTENSIONS INTO THE DD      @G24LB18*/ 00597000
*/*            ENTRY.                                        @G24LB18*/ 00598000
*/*                                                          @G24LB18*/ 00599000
*/* INPUT - SELECT REQUEST BLOCK, JFCB, JFCB EXTENSIONS,     @G24LB18*/ 00600000
*/*         AND DD ENTRY.                                    @G24LB18*/ 00601000
*/*                                                          @G24LB18*/ 00602000
*/* OUTPUT - DD ENTRY CONTAINING VOL SERS FROM THE JFCB      @G24LB18*/ 00603000
*/*          EXTENSIONS.                                     @G24LB18*/ 00604000
*/*                                                          @G24LB18*/ 00605000
*/*********************************************************  @G24LB18*/ 00606000
*                                                                  0204 00607000
*MOVEEXT:                                                          0204 00608000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00609000
*                                                                  0204 00610000
MOVEEXT  DS    0H                                                  0205 00611000
*   /*****************************************************************/ 00612000
*   /*                                                               */ 00613000
*   /* INITIALIZE THE JFCB EXTENSION POINTER, THE DD ENTRY   @G24LB18*/ 00614000
*   /* VOL SER INDEX, AND THE TOTAL NO. OF VOL SERS.         @G24LB18*/ 00615000
*   /*                                                               */ 00616000
*   /*****************************************************************/ 00617000
*                                                                  0205 00618000
*   JFCBXPTR=SELJFCBX;              /* SET JFCBX PTR         @G24LB18*/ 00619000
         L     @15,TABSELRB(,PARMPTR)                              0205 00620000
         L     @15,SELJFCBX(,@15)                                  0205 00621000
         ST    @15,JFCBXPTR                                        0205 00622000
*   INDEX=SIX;                      /* INIT DD ENTRY INDEX   @G24LB18*/ 00623000
         LA    INDEX,6                                             0206 00624000
*   NVOL=JFCBNVOL-FIVE;             /* SET NO. OF VOL SERS   @G24LB18*/ 00625000
         L     @15,JFCBPTR                                         0207 00626000
         SLR   @11,@11                                             0207 00627000
         IC    @11,JFCBNVOL(,@15)                                  0207 00628000
         SL    @11,@CF00062                                        0207 00629000
         STC   @11,NVOL                                            0207 00630000
*   RFY                                                            0208 00631000
*     REG1 RSTD;                    /* RESTRICT REG 1        @G24LB18*/ 00632000
*                                                                  0208 00633000
*   /*****************************************************************/ 00634000
*   /*                                                               */ 00635000
*   /* COPY THE VOL SERS FROM EACH JFCB EXTENSION INTO THE   @G24LB18*/ 00636000
*   /* DD ENTRY AND RETURN TO FILDDENT.                      @G24LB18*/ 00637000
*   /*                                                               */ 00638000
*   /*****************************************************************/ 00639000
*                                                                  0209 00640000
*   DO WHILE JFCBXNXT¬=ZERO;        /* DO FOR EACH EXTENSION @G24LB18*/ 00641000
         B     @DE00209                                            0209 00642000
@DL00209 DS    0H                                                  0210 00643000
*     REG1=LENGTH(VOLJFCBX);        /* SET LENGTH OF VOLSERS @G24LB18*/ 00644000
         LA    REG1,90                                             0210 00645000
*     STPDDVOL(INDEX)=JFCBXVOL(1,1:REG1);/* COPY VOLSERS FROM JFCB 0211 00646000
*                                      EXTENSION             @G24LB18*/ 00647000
         LR    @15,INDEX                                           0211 00648000
         MH    @15,@CH00064                                        0211 00649000
         ALR   @15,DDENTPTR                                        0211 00650000
         MVI   STPDDVOL-5(@15),C' '                                0211 00651000
         MVC   STPDDVOL-4(4,@15),STPDDVOL-5(@15)                   0211 00652000
         LR    @11,REG1                                            0211 00653000
         BCTR  @11,0                                               0211 00654000
         L     @10,JFCBXPTR                                        0211 00655000
         EX    @11,@SM01670                                        0211 00656000
*     JFCBXPTR=JFCBXNXT;            /* GET NEXT JFCB EXTN    @G24LB18*/ 00657000
         L     @15,JFCBXNXT(,@10)                                  0212 00658000
         ST    @15,JFCBXPTR                                        0212 00659000
*     INDEX=INDEX+FIFTEEN;          /* INCREMENT DD ENT INDX @G24LB18*/ 00660000
         LA    @15,15                                              0213 00661000
         ALR   INDEX,@15                                           0213 00662000
*     NVOL=NVOL-FIFTEEN;            /* DECREMENT NO. OF VOLS @G24LB18*/ 00663000
         LCR   @15,@15                                             0214 00664000
         SLR   @00,@00                                             0214 00665000
         IC    @00,NVOL                                            0214 00666000
         ALR   @15,@00                                             0214 00667000
         STC   @15,NVOL                                            0214 00668000
*   END;                            /*                       @G24LB18*/ 00669000
@DE00209 L     @15,JFCBXPTR                                        0215 00670000
         L     @00,JFCBXNXT(,@15)                                  0215 00671000
         LTR   @00,@00                                             0215 00672000
         BNZ   @DL00209                                            0215 00673000
*   REG1=NVOL*SIX;                  /* GET LENGTH OF VOLSERS @G24LB18*/ 00674000
         LA    @11,6                                               0216 00675000
         SLR   REG1,REG1                                           0216 00676000
         IC    REG1,NVOL                                           0216 00677000
         MR    @00,@11                                             0216 00678000
*   STPDDVOL(INDEX)=VOLJFCBX(1:REG1);/* COPY VOLSERS FROM    @G24LB18   00679000
*                                      LAST EXTN             @G24LB18*/ 00680000
         MR    @10,INDEX                                           0217 00681000
         ALR   @11,DDENTPTR                                        0217 00682000
         MVI   STPDDVOL-5(@11),C' '                                0217 00683000
         MVC   STPDDVOL-4(4,@11),STPDDVOL-5(@11)                   0217 00684000
         LR    @10,REG1                                            0217 00685000
         BCTR  @10,0                                               0217 00686000
         EX    @10,@SM01672                                        0217 00687000
*   RFY                                                            0218 00688000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00689000
*   RETURN;                         /* RETURN TO FILDDENT    @G24LB18*/ 00690000
@EL00004 DS    0H                                                  0219 00691000
@EF00004 DS    0H                                                  0219 00692000
@ER00004 BR    @14                                                 0219 00693000
*   END MOVEEXT;                    /* END MOVE VOLSERS RTN  @G24LB18*/ 00694000
*                                                                  0221 00695000
*/*********************************************************  @G24LB18*/ 00696000
*/*                                                          @G24LB18*/ 00697000
*/* PROCEDURE NAME - BLDSTHDR                                @G24LB18*/ 00698000
*/*                                                          @G24LB18*/ 00699000
*/* FUNCTION - THIS ROUTINE IS CALLED ON BUILD DD ENTRY      @G24LB18*/ 00700000
*/*            REQUESTS FOR WHICH A STEP TABLE DOES NOT      @G24LB18*/ 00701000
*/*            ALREADY EXIST. IT GETS STORAGE FOR A STEP     @G24LB18*/ 00702000
*/*            TABLE HEADER, FILLS IN THE HEADER, CHAINS     @G24LB18*/ 00703000
*/*            THE NEW DD ENTRY TO THE HEADER, AND CHAINS    @G24LB18*/ 00704000
*/*            THE HEADER TO THE END OF THE STEP TABLE       @G24LB18*/ 00705000
*/*            CHAIN.                                        @G24LB18*/ 00706000
*/*                                                          @G24LB18*/ 00707000
*/* INPUT - SELECT REQUEST BLOCK, VVICB, AND NEW DD ENTRY.   @G24LB18*/ 00708000
*/*                                                          @G24LB18*/ 00709000
*/* OUTPUT - A NEW STEP TABLE HEADER WITH THE NEW DD ENTRY   @G24LB18*/ 00710000
*/*          CHAINED TO IT IS BUILT AND ADDED TO THE STEP    @G24LB18*/ 00711000
*/*          TABLE CHAIN. A RETURN CODE OF 0 IS RETURNED IF  @G24LB18*/ 00712000
*/*          THE HEADER IS BUILT SUCCESSFULLY. IF A GETMAIN  @G24LB18*/ 00713000
*/*          FAILURE OCCURS, CONSOLE ERROR MESSAGE ICB409I   @G24LB18*/ 00714000
*/*          'NO STORAGE AVAILABLE' IS ISSUED, THE NEW DD    @G24LB18*/ 00715000
*/*          ENTRY IS FREEMAINED, AND A RETURN CODE = 4 IS   @G24LB18*/ 00716000
*/*          RETURNED.                                       @G24LB18*/ 00717000
*/*                                                          @G24LB18*/ 00718000
*/*********************************************************  @G24LB18*/ 00719000
*                                                                  0221 00720000
*BLDSTHDR:                                                         0221 00721000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00722000
*                                                                  0221 00723000
BLDSTHDR DS    0H                                                  0222 00724000
*   /*****************************************************************/ 00725000
*   /*                                                               */ 00726000
*   /* RELEASE THE CMS AND LOCAL LOCKS AND ISSUE A GETMAIN   @G24LB18*/ 00727000
*   /* FOR THE STEP TABLE HEADER.                            @G24LB18*/ 00728000
*   /*                                                               */ 00729000
*   /*****************************************************************/ 00730000
*                                                                  0222 00731000
*   SAVERET2=REG14;                 /* SAVE RETURN ADDR      @G24LB18*/ 00732000
         ST    REG14,SAVERET2                                      0222 00733000
*   GENERATE;                                                      0223 00734000
*                                                          /*@G24LB18*/ 00735000
LFRECMS2 SETLOCK RELEASE,TYPE=CMS,REGS=USE,                            *00736000
               RELATED=(ICBVTP00(LGETCMS2))                             00737000
LFRELCL2 SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                          *00738000
               RELATED=(ICBVTP00(LGETLCL2))                             00739000
*   VVIFLG6=OFF;                    /* TURN OFF LOCAL AND    @G24LB18*/ 00740000
*   VVIFLG7=OFF;                    /* CMS LOCK FLAGS        @G24LB18*/ 00741000
         L     @15,VVIPTR                                          0225 00742000
         NI    VVIFLG6(@15),B'11111100'                            0225 00743000
*   RFY                                                            0226 00744000
*     REG0 RSTD;                    /* RESTRICT REG 0        @G24LB18*/ 00745000
*   RFY                                                            0227 00746000
*     REG1 RSTD;                    /* RESTRICT REG 1        @G24LB18*/ 00747000
*   RFY                                                            0228 00748000
*     REG15 RSTD;                   /* RESTRICT REG 15       @G24LB18*/ 00749000
*   RETCODE=ZERO;                   /* ZERO RETURN CODE      @G24LB18*/ 00750000
         SLR   @07,@07                                             0229 00751000
         ST    @07,RETCODE                                         0229 00752000
*   REG0=LENGTH(STPTB);             /* SET LENGTH OF HDR     @G24LB18*/ 00753000
         LA    REG0,20                                             0230 00754000
*LGET2:                                                            0231 00755000
*   GEN(GETMAIN RC,LV=(0),SP=241);  /* GETMAIN HEADER        @G24LB18*/ 00756000
LGET2    GETMAIN RC,LV=(0),SP=241                                       00757000
*                                                                  0232 00758000
*   /*****************************************************************/ 00759000
*   /*                                                               */ 00760000
*   /* IF THE GETMAIN FAILS, ISSUE CONSOLE ERROR MESSAGE     @G24LB18*/ 00761000
*   /* ICB409I 'NO STORAGE AVAILABLE', FREEMAIN THE NEW DD   @G24LB18*/ 00762000
*   /* ENTRY, SET RETURN CODE = 4, AND RETURN TO BLDDDENT.   @G24LB18*/ 00763000
*   /*                                                               */ 00764000
*   /*****************************************************************/ 00765000
*                                                                  0232 00766000
*   IF REG15¬=ZERO THEN             /* STORAGE GOTTEN?       @G24LB18*/ 00767000
         LTR   REG15,REG15                                         0232 00768000
         BZ    @RF00232                                            0232 00769000
*     DO;                           /* NO                    @G24LB18*/ 00770000
*       MSGRQ=''B;                  /* CLEAR MESSAGE AREA    @G24LB18*/ 00771000
         XC    MSGRQ(32),MSGRQ                                     0234 00772000
*       MSGRPLV=TABSELRB-LENGTH(RPLV);/* SET RPLV ADDR       @G24LB18*/ 00773000
         L     @07,TABSELRB(,PARMPTR)                              0235 00774000
         SL    @07,@CF01660                                        0235 00775000
         ST    @07,MSGRPLV                                         0235 00776000
*       MSGID=MSG409;               /* SET MESSAGE ID        @G24LB18*/ 00777000
         MVC   MSGID(4),@CF00083                                   0236 00778000
*       REG1=ADDR(MSGRQ);           /* GET MSG LIST ADDR     @G24LB18*/ 00779000
         LA    REG1,MSGRQ                                          0237 00780000
*       CALL ICBVOP00;              /* CALL MSG ROUTINE      @G24LB18*/ 00781000
         L     @15,@CV01597                                        0238 00782000
         BALR  @14,@15                                             0238 00783000
*       REG0=STPDDLEN;              /* GET LENGTH OF DD ENT  @G24LB18*/ 00784000
         LH    REG0,STPDDLEN(,DDENTPTR)                            0239 00785000
*       REG1=DDENTPTR;              /* GET ADDR OF DD ENTRY  @G24LB18*/ 00786000
         LR    REG1,DDENTPTR                                       0240 00787000
*LFREM1:                                                           0241 00788000
*       GEN(FREEMAIN RC,LV=(0),A=(1),SP=241);/* FREEMAIN ENT @G24LB18*/ 00789000
LFREM1   FREEMAIN RC,LV=(0),A=(1),SP=241                                00790000
*       REG14=SAVERET2;             /* RESTORE RETURN ADDR   @G24LB18*/ 00791000
         L     REG14,SAVERET2                                      0242 00792000
*       RETCODE=FOUR;               /* SET RETURN CODE = 4   @G24LB18*/ 00793000
         MVC   RETCODE(4),@CF00060                                 0243 00794000
*       RETURN;                     /* RETURN TO BLDDDENT    @G24LB18*/ 00795000
@EL00005 DS    0H                                                  0244 00796000
@EF00005 DS    0H                                                  0244 00797000
@ER00005 BR    @14                                                 0244 00798000
*     END;                          /*                       @G24LB18*/ 00799000
*                                                                  0245 00800000
*   /*****************************************************************/ 00801000
*   /*                                                               */ 00802000
*   /* CLEAR THE STEP TABLE HEADER AND COPY THE JOBID FROM   @G24LB18*/ 00803000
*   /* THE SELECT REQUEST BLOCK INTO IT. STORE THE LENGTH OF @G24LB18*/ 00804000
*   /* THE HEADER AND THE ADDRESS OF THE NEW DD ENTRY INTO   @G24LB18*/ 00805000
*   /* THE HEADER. INITIALIZE THE INITIAL CALL COUNTER TO 1. @G24LB18*/ 00806000
*   /*                                                               */ 00807000
*   /*****************************************************************/ 00808000
*                                                                  0246 00809000
*   STHDRPTR=REG1;                  /* SET UP HEADER PTR     @G24LB18*/ 00810000
@RF00232 LR    STHDRPTR,REG1                                       0246 00811000
*   STPTB=STPTB&&STPTB;             /* CLEAR HEADER          @G24LB18*/ 00812000
         XC    STPTB(20,STHDRPTR),STPTB(STHDRPTR)                  0247 00813000
*   STPJOBID=SELJOBID;              /* COPY JOBID INTO HDR   @G24LB18*/ 00814000
         L     @11,TABSELRB(,PARMPTR)                              0248 00815000
         L     @11,SELJOBID(,@11)                                  0248 00816000
         ST    @11,STPJOBID(,STHDRPTR)                             0248 00817000
*   STPHDRLN=LENGTH(STPTB);         /* STORE LENGTH OF HDR   @G24LB18*/ 00818000
         MVC   STPHDRLN(2,STHDRPTR),@CH01601                       0249 00819000
*   STPDDPTR=DDENTPTR;              /* CHAIN DD ENTRY TO HDR @G24LB18*/ 00820000
         ST    DDENTPTR,STPDDPTR(,STHDRPTR)                        0250 00821000
*   SAVENTRY=STHDRPTR;              /* SAVE HEADER PTR       @G24LB18*/ 00822000
         LR    SAVENTRY,STHDRPTR                                   0251 00823000
*   STPICCTR=ONE;                   /* SET INIT CALL CTR = 1 @G24LB18*/ 00824000
         MVI   STPICCTR(STHDRPTR),X'01'                            0252 00825000
*                                                                  0253 00826000
*   /*****************************************************************/ 00827000
*   /*                                                               */ 00828000
*   /* SET THE LOCAL AND CMS LOCKS AND SEARCH FOR THE END OF @G24LB18*/ 00829000
*   /* THE STEP TABLE CHAIN. ADD THE NEW STEP TABLE HEADER   @G24LB18*/ 00830000
*   /* TO THE END OF THE CHAIN AND RETURN TO BLDDDENT.       @G24LB18*/ 00831000
*   /*                                                               */ 00832000
*   /*****************************************************************/ 00833000
*                                                                  0253 00834000
*   VVIFLG6=ON;                     /* SET LOCAL LOCK FLAG   @G24LB18*/ 00835000
*   VVIFLG7=ON;                     /* SET CMS LOCK FLAG     @G24LB18*/ 00836000
         L     @11,VVIPTR                                          0254 00837000
         OI    VVIFLG6(@11),B'00000011'                            0254 00838000
*   GENERATE;                                                      0255 00839000
*                                                          /*@G24LB18*/ 00840000
LGETLCL3 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               *00841000
               RELATED=(ICBVTP00(LFRELCL1))                             00842000
LGETCMS3 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,                 *00843000
               RELATED=(ICBVTP00(LFRECMS1))                             00844000
*   STHDRPTR=ADDR(VVISTPTB);        /* GET 1ST HEADER PTR    @G24LB18*/ 00845000
         L     STHDRPTR,VVIPTR                                     0256 00846000
         LA    STHDRPTR,VVISTPTB(,STHDRPTR)                        0256 00847000
*   DO WHILE STPNXTTB¬=ZERO;        /* IS IT LAST HEADER?    @G24LB18*/ 00848000
         B     @DE00257                                            0257 00849000
@DL00257 DS    0H                                                  0258 00850000
*     STHDRPTR=STPNXTTB;            /* NO-GET NEXT HEADER    @G24LB18*/ 00851000
         L     STHDRPTR,STPNXTTB(,STHDRPTR)                        0258 00852000
*   END;                            /* YES -                 @G24LB18*/ 00853000
@DE00257 L     @11,STPNXTTB(,STHDRPTR)                             0259 00854000
         LTR   @11,@11                                             0259 00855000
         BNZ   @DL00257                                            0259 00856000
*   STPNXTTB=SAVENTRY;              /* CHAIN NEW HDR TO LAST @G24LB18*/ 00857000
         ST    SAVENTRY,STPNXTTB(,STHDRPTR)                        0260 00858000
*   SAVENTRY->STPPRVTB=STHDRPTR;    /* SET BACKWARD PTR      @G24LB18*/ 00859000
         ST    STHDRPTR,STPPRVTB(,SAVENTRY)                        0261 00860000
*   RFY                                                            0262 00861000
*     REG0 UNRSTD;                  /* UNRESTRICT REG 0      @G24LB18*/ 00862000
*   RFY                                                            0263 00863000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00864000
*   RFY                                                            0264 00865000
*     REG15 UNRSTD;                 /* UNRESTRICT REG 15     @G24LB18*/ 00866000
*   REG14=SAVERET2;                 /* RESTORE RETURN ADDR   @G24LB18*/ 00867000
         L     REG14,SAVERET2                                      0265 00868000
*   RETURN;                         /* RETURN TO BLDDDENT    @G24LB18*/ 00869000
         B     @EL00005                                            0266 00870000
*   END BLDSTHDR;                   /* END BUILD HEADER RTN  @G24LB18*/ 00871000
*                                                                  0268 00872000
*/*********************************************************  @G24LB18*/ 00873000
*/*                                                          @G24LB18*/ 00874000
*/* PROCEDURE NAME - SRCDDENT                                @G24LB18*/ 00875000
*/*                                                          @G24LB18*/ 00876000
*/* FUNCTION - THIS ROUTINE IS CALLED ON SEARCH FOR DD ENTRY @G24LB18*/ 00877000
*/*            REQUESTS. IT SEARCHES FOR THE STEP TABLE      @G24LB18*/ 00878000
*/*            HEADER FOR THE REQUEST AND THEN SEARCHES THE  @G24LB18*/ 00879000
*/*            DD ENTRIES IN THAT STEP TABLE FOR ONE WHOSE   @G24LB18*/ 00880000
*/*            DD # MATCHES THE DD # PASSED WITH THE         @G24LB18*/ 00881000
*/*            REQUEST.                                      @G24LB18*/ 00882000
*/*                                                          @G24LB18*/ 00883000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST           @G24LB18*/ 00884000
*/*                                                          @G24LB18*/ 00885000
*/* OUTPUT - IF A MATCHING DD ENTRY IS FOUND, ITS ADDRESS    @G24LB18*/ 00886000
*/*          IS RETURNED IN THE TABP PARM LIST ALONG WITH A  @G24LB18*/ 00887000
*/*          RETURN CODE = 0. IF NO MATCHING DD ENTRY IS     @G24LB18*/ 00888000
*/*          FOUND OR IF NO STEP TABLE HEADER IS FOUND FOR   @G24LB18*/ 00889000
*/*          THE REQUEST, A RETURN CODE = 4 IS RETURNED.     @G24LB18*/ 00890000
*/*                                                          @G24LB18*/ 00891000
*/*********************************************************  @G24LB18*/ 00892000
*                                                                  0268 00893000
*SRCDDENT:                                                         0268 00894000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00895000
*                                                                  0268 00896000
SRCDDENT DS    0H                                                  0269 00897000
*   /*****************************************************************/ 00898000
*   /*                                                               */ 00899000
*   /* CALL SUBPROCEDURE SRCJOBID TO SEARCH FOR THE STEP     @G24LB18*/ 00900000
*   /* TABLE HEADER FOR THE REQUEST. IF THE HEADER IS NOT    @G24LB18*/ 00901000
*   /* FOUND (RETURN CODE = 4), RETURN TO MAINLINE ICBVTP00. @G24LB18*/ 00902000
*   /*                                                               */ 00903000
*   /*****************************************************************/ 00904000
*                                                                  0269 00905000
*   SAVERET1=REG14;                 /* SAVE RETURN ADDRESS   @G24LB18*/ 00906000
         ST    REG14,SAVERET1                                      0269 00907000
*   JOBID=TABJOBID;                 /* GET JOBID             @G24LB18*/ 00908000
         L     JOBID,TABJOBID(,PARMPTR)                            0270 00909000
*   CALL SRCJOBID;                  /* CALL SEARCH RTN       @G24LB18*/ 00910000
         BAL   @14,SRCJOBID                                        0271 00911000
*   REG14=SAVERET1;                 /* RESTORE RETURN ADDR   @G24LB18*/ 00912000
         L     REG14,SAVERET1                                      0272 00913000
*   IF RETCODE=FOUR THEN            /* HEADER FOUND?         @G24LB18*/ 00914000
         CLC   RETCODE(4),@CF00060                                 0273 00915000
         BE    @RT00273                                            0273 00916000
*     RETURN;                       /* NO-RETURN TO ICBVTP00 @G24LB18*/ 00917000
*                                                                  0275 00918000
*   /*****************************************************************/ 00919000
*   /*                                                               */ 00920000
*   /* COMPARE THE DD # FROM THE PARM LIST TO THE DD # IN    @G24LB18*/ 00921000
*   /* EACH DD ENTRY IN THE STEP TABLE. IF A MATCH IS FOUND, @G24LB18*/ 00922000
*   /* STORE THE ADDRESS OF THE DD ENTRY IN THE PARM LIST    @G24LB18*/ 00923000
*   /* AND RETURN TO ICBVTP00. IF THE END OF THE STEP TABLE  @G24LB18*/ 00924000
*   /* IS REACHED BEFORE A MATCH IS FOUND, SET RETURN CODE   @G24LB18*/ 00925000
*   /* = 4 AND RETURN TO MAINLINE ICBVTP00.                  @G24LB18*/ 00926000
*   /*                                                               */ 00927000
*   /*****************************************************************/ 00928000
*                                                                  0275 00929000
*   DDENTPTR=STPDDPTR;              /* GET 1ST DD ENTRY PTR  @G24LB18*/ 00930000
         L     DDENTPTR,STPDDPTR(,STHDRPTR)                        0275 00931000
*   DO WHILE DDENTPTR¬=ZERO;        /* DO FOR EACH DD ENTRY  @G24LB18*/ 00932000
         B     @DE00276                                            0276 00933000
@DL00276 DS    0H                                                  0277 00934000
*     IF TABDDNUM=STPDDNUM THEN     /* DD #S MATCH?          @G24LB18*/ 00935000
         CLC   TABDDNUM(2,PARMPTR),STPDDNUM(DDENTPTR)              0277 00936000
         BNE   @RF00277                                            0277 00937000
*       DO;                         /* YES                   @G24LB18*/ 00938000
*         TABDDRET=DDENTPTR;        /* STORE DD ENTRY ADDR   @G24LB18*/ 00939000
         ST    DDENTPTR,TABDDRET(,PARMPTR)                         0279 00940000
*         RETURN;                   /* RETURN TO ICBVTP00    @G24LB18*/ 00941000
@EL00006 DS    0H                                                  0280 00942000
@EF00006 DS    0H                                                  0280 00943000
@ER00006 BR    @14                                                 0280 00944000
*       END;                        /*                       @G24LB18*/ 00945000
*     DDENTPTR=STPDDNXT;            /* GET NEXT DD ENTRY     @G24LB18*/ 00946000
@RF00277 L     DDENTPTR,STPDDNXT(,DDENTPTR)                        0282 00947000
*   END;                            /* NO MATCH FOUND        @G24LB18*/ 00948000
@DE00276 LTR   DDENTPTR,DDENTPTR                                   0283 00949000
         BNZ   @DL00276                                            0283 00950000
*   RETCODE=FOUR;                   /* SET RETURN CODE = 4   @G24LB18*/ 00951000
         MVC   RETCODE(4),@CF00060                                 0284 00952000
*   RETURN;                         /* RETURN TO ICBVTP00    @G24LB18*/ 00953000
         B     @EL00006                                            0285 00954000
*   END SRCDDENT;                   /* END SEARCH FOR DD RTN @G24LB18*/ 00955000
         B     @EL00006                                            0286 00956000
*                                                                  0287 00957000
*/*********************************************************  @G24LB18*/ 00958000
*/*                                                          @G24LB18*/ 00959000
*/* PROCEDURE NAME - UPDTBFTB                                @G24LB18*/ 00960000
*/*                                                          @G24LB18*/ 00961000
*/* FUNCTION - THIS ROUTINE IS CALLED ON UPDATE BEST FIT     @G24LB18*/ 00962000
*/*            TABLE REQUESTS. IT SEARCHES THE STEP TABLE    @G24LB18*/ 00963000
*/*            CHAIN FOR EACH OCCURRENCE OF EACH VOL SER     @G24LB18*/ 00964000
*/*            CONTAINED IN THE BEST FIT TABLE. WHEN AN      @G24LB18*/ 00965000
*/*            OCCURRENCE IS FOUND, IT UPDATES THE USAGE     @G24LB18*/ 00966000
*/*            AND SHAREABILITY FIELDS FOR THE VOLUME IN     @G24LB18*/ 00967000
*/*            THE BEST FIT TABLE (VIA SUBPROCEDURE          @G24LB18*/ 00968000
*/*            VOLUSAGE).                                    @G24LB18*/ 00969000
*/*                                                          @G24LB18*/ 00970000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST, VVICB,   @G24LB18*/ 00971000
*/*         AND BEST FIT TABLE.                              @G24LB18*/ 00972000
*/*                                                          @G24LB18*/ 00973000
*/* OUTPUT - UPDATED BEST FIT TABLE.                         @G24LB18*/ 00974000
*/*                                                          @G24LB18*/ 00975000
*/*********************************************************  @G24LB18*/ 00976000
*                                                                  0287 00977000
*UPDTBFTB:                                                         0287 00978000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00979000
UPDTBFTB DS    0H                                                  0288 00980000
*   RFY                                                            0288 00981000
*     BFTBL BASED(TABBFTBL);        /* BASE BEST FIT TABLE   @G24LB18*/ 00982000
*                                                                  0288 00983000
*   /*****************************************************************/ 00984000
*   /*                                                               */ 00985000
*   /* IF THERE ARE NO STEP TABLES IN THE STEP TABLE CHAIN,  @G24LB18*/ 00986000
*   /* RETURN TO MAINLINE ICBVTP00 WITHOUT PROCESSING THE    @G24LB18*/ 00987000
*   /* BEST FIT TABLE.                                       @G24LB18*/ 00988000
*   /*                                                               */ 00989000
*   /*****************************************************************/ 00990000
*                                                                  0289 00991000
*   IF VVISTPTB=ZERO THEN           /* ANY STEP TABLES?      @G24LB18*/ 00992000
         L     @15,VVIPTR                                          0289 00993000
         L     @15,VVISTPTB(,@15)                                  0289 00994000
         LTR   @15,@15                                             0289 00995000
         BZ    @RT00289                                            0289 00996000
*     RETURN;                       /* NO-RETURN TO ICBVTP00 @G24LB18*/ 00997000
*                                                                  0290 00998000
*   /*****************************************************************/ 00999000
*   /*                                                               */ 01000000
*   /* INITIALIZE THE BEST FIT TABLE ELEMENT INDEX AND THE   @G24LB18*/ 01001000
*   /* VOLUME USE COUNT. GET THE ADDRESS OF THE STEP TABLE   @G24LB18*/ 01002000
*   /* CHAIN FROM THE VVICB AND GET THE FIRST STEP TABLE     @G24LB18*/ 01003000
*   /* HEADER.                                               @G24LB18*/ 01004000
*   /*                                                               */ 01005000
*   /*****************************************************************/ 01006000
*                                                                  0291 01007000
*   SAVERET1=REG14;                 /* SAVE RETURN ADDRESS   @G24LB18*/ 01008000
         ST    REG14,SAVERET1                                      0291 01009000
*   INDEX=ONE;                      /* INIT ELEMENT INDEX    @G24LB18*/ 01010000
         LA    INDEX,1                                             0292 01011000
*   DO WHILE INDEX¬>BFTOTIDX;       /* DO FOR EACH ELEMENT   @G24LB18*/ 01012000
         B     @DE00293                                            0293 01013000
@DL00293 DS    0H                                                  0294 01014000
*     USECOUNT=ZERO;                /* INIT VOL USE COUNT    @G24LB18*/ 01015000
         MVI   USECOUNT,X'00'                                      0294 01016000
*     STHDRPTR=ADDR(VVISTPTB);      /* GET STEP TABLE CHAIN  @G24LB18*/ 01017000
         L     STHDRPTR,VVIPTR                                     0295 01018000
         LA    STHDRPTR,VVISTPTB(,STHDRPTR)                        0295 01019000
*     DO WHILE STPNXTTB¬=ZERO;      /* DO FOR EACH HEADER    @G24LB18*/ 01020000
         B     @DE00296                                            0296 01021000
@DL00296 DS    0H                                                  0297 01022000
*       STHDRPTR=STPNXTTB;          /* GET STEP TAB HEADER   @G24LB18*/ 01023000
         L     STHDRPTR,STPNXTTB(,STHDRPTR)                        0297 01024000
*                                                                  0298 01025000
*       /*************************************************************/ 01026000
*       /*                                                           */ 01027000
*       /* IF THE STEP TABLE IS NOT INVALID, GET THE FIRST   @G24LB18*/ 01028000
*       /* DD ENTRY. INITIALIZE THE VOL SER INDEX AND GET    @G24LB18*/ 01029000
*       /* THE FIRST VOL SER IN THE DD ENTRY.                @G24LB18*/ 01030000
*       /*                                                           */ 01031000
*       /*************************************************************/ 01032000
*                                                                  0298 01033000
*       IF STPINVAL=OFF THEN        /* STEP TABLE INVALID?   @G24LB18*/ 01034000
         TM    STPINVAL(STHDRPTR),B'10000000'                      0298 01035000
         BNZ   @RF00298                                            0298 01036000
*         DO;                       /* NO                    @G24LB18*/ 01037000
*           DDENTPTR=ADDR(STPDDPTR);/* GET DD ENTRY CHAIN    @G24LB18*/ 01038000
         LA    DDENTPTR,STPDDPTR(,STHDRPTR)                        0300 01039000
*           DO WHILE STPDDNXT¬=ZERO;/* DO FOR EACH DD ENT    @G24LB18*/ 01040000
         B     @DE00301                                            0301 01041000
@DL00301 DS    0H                                                  0302 01042000
*             DDENTPTR=STPDDNXT;    /* GET DD ENTRY          @G24LB18*/ 01043000
         L     DDENTPTR,STPDDNXT(,DDENTPTR)                        0302 01044000
*             VOLINDX=ONE;          /* INIT VOLSER INDEX     @G24LB18*/ 01045000
*                                                                  0303 01046000
         MVI   VOLINDX,X'01'                                       0303 01047000
*             /*******************************************************/ 01048000
*             /*                                                     */ 01049000
*             /* IF THE VOLSER FROM THE DD ENTRY MATCHES THE @G24LB18*/ 01050000
*             /* VOLSER FROM THE BEST FIT TABLE ELEMENT,     @G24LB18*/ 01051000
*             /* CALL SUBPROCEDURE VOLUSAGE TO UPDATE THE    @G24LB18*/ 01052000
*             /* BEST FIT TABLE FOR THE VOLUME. REPEAT FOR   @G24LB18*/ 01053000
*             /* EACH VOLSER IN THE DD ENTRY.                @G24LB18*/ 01054000
*             /*                                                     */ 01055000
*             /*******************************************************/ 01056000
*                                                                  0304 01057000
*             DO WHILE VOLINDX¬>STPDDNVL;/* DO FOR EACH VOL  @G24LB18*/ 01058000
         B     @DE00304                                            0304 01059000
@DL00304 DS    0H                                                  0305 01060000
*               IF STPDDVOL(VOLINDX)=BFVOLID(INDEX) THEN/*   @G24LB18   01061000
*                                      VOLSERS = ?           @G24LB18*/ 01062000
         SLR   @15,@15                                             0305 01063000
         IC    @15,VOLINDX                                         0305 01064000
         MH    @15,@CH00064                                        0305 01065000
         LR    @11,INDEX                                           0305 01066000
         MH    @11,@CH01134                                        0305 01067000
         L     @01,TABBFTBL(,PARMPTR)                              0305 01068000
         ALR   @15,DDENTPTR                                        0305 01069000
         ALR   @01,@11                                             0305 01070000
         CLC   STPDDVOL-6(6,@15),BFVOLID-18(@01)                   0305 01071000
         BNE   @RF00305                                            0305 01072000
*                 CALL VOLUSAGE;    /* YES-CALL VOLUSAGE RTN @G24LB18*/ 01073000
         BAL   @14,VOLUSAGE                                        0306 01074000
*               VOLINDX=VOLINDX+ONE;/* INCREMENT VOL INDEX   @G24LB18*/ 01075000
@RF00305 LA    @15,1                                               0307 01076000
         SLR   @11,@11                                             0307 01077000
         IC    @11,VOLINDX                                         0307 01078000
         ALR   @15,@11                                             0307 01079000
         STC   @15,VOLINDX                                         0307 01080000
*             END;                  /* END VOL SER LOOP      @G24LB18*/ 01081000
*                                                                  0308 01082000
@DE00304 CLC   VOLINDX(1),STPDDNVL(DDENTPTR)                       0308 01083000
         BNH   @DL00304                                            0308 01084000
*             /*******************************************************/ 01085000
*             /*                                                     */ 01086000
*             /* GET THE NEXT DD ENTRY AND REPEAT THE VOLSER @G24LB18*/ 01087000
*             /* LOOP. CONTINUE UNTIL ALL DD ENTRIES IN THE  @G24LB18*/ 01088000
*             /* STEP TABLE HAVE BEEN PROCESSED.             @G24LB18*/ 01089000
*             /*                                                     */ 01090000
*             /*******************************************************/ 01091000
*                                                                  0309 01092000
*           END;                    /* END DD ENTRY LOOP     @G24LB18*/ 01093000
@DE00301 L     @15,STPDDNXT(,DDENTPTR)                             0309 01094000
         LTR   @15,@15                                             0309 01095000
         BNZ   @DL00301                                            0309 01096000
*         END;                      /*                       @G24LB18*/ 01097000
*                                                                  0310 01098000
*       /*************************************************************/ 01099000
*       /*                                                           */ 01100000
*       /* GET THE NEXT STEP TABLE HEADER AND REPEAT THE     @G24LB18*/ 01101000
*       /* DD ENTRY LOOP. CONTINUE UNTIL ALL STEP TABLES     @G24LB18*/ 01102000
*       /* IN THE STEP TABLE CHAIN HAVE BEEN PROCESSED.      @G24LB18*/ 01103000
*       /*                                                           */ 01104000
*       /*************************************************************/ 01105000
*                                                                  0311 01106000
*     END;                          /* END STEP TABLE LOOP   @G24LB18*/ 01107000
@RF00298 DS    0H                                                  0311 01108000
@DE00296 L     @15,STPNXTTB(,STHDRPTR)                             0311 01109000
         LTR   @15,@15                                             0311 01110000
         BNZ   @DL00296                                            0311 01111000
*                                                                  0312 01112000
*     /***************************************************************/ 01113000
*     /*                                                             */ 01114000
*     /* IF THE VOLUME USE COUNT IS NOT 0, TURN OFF THE 'NOT @G24LB18*/ 01115000
*     /* MOUNTED' AND 'MOUNTED TO OTHER HOST' INDICATORS IN  @G24LB18*/ 01116000
*     /* THE BEST FIT TABLE ELEMENT AND INCREMENT THE        @G24LB18*/ 01117000
*     /* CONCURRENT USER COUNT IN THE ELEMENT BY THE USE     @G24LB18*/ 01118000
*     /* COUNT.                                              @G24LB18*/ 01119000
*     /*                                                             */ 01120000
*     /***************************************************************/ 01121000
*                                                                  0312 01122000
*     IF USECOUNT>ZERO THEN         /* VOL USE COUNT > 0?    @G24LB18*/ 01123000
         CLI   USECOUNT,0                                          0312 01124000
         BNH   @RF00312                                            0312 01125000
*       DO;                         /* YES                   @G24LB18*/ 01126000
*         BFNMTDFL(INDEX)=OFF;      /* TURN OFF NOT MOUNTED  @G24LB18*/ 01127000
*         BFMTDOHF(INDEX)=OFF;      /* TURN OFF MTD OTH HOST @G24LB18*/ 01128000
         LR    @15,INDEX                                           0315 01129000
         MH    @15,@CH01134                                        0315 01130000
         L     @11,TABBFTBL(,PARMPTR)                              0315 01131000
         ST    @15,@TF00001                                        0315 01132000
         ALR   @15,@11                                             0315 01133000
         NI    BFNMTDFL-18(@15),B'10011111'                        0315 01134000
*         BFCONUSE(INDEX)=BFCONUSE(INDEX)+USECOUNT;/*        @G24LB18*/ 01135000
         L     @15,@TF00001                                        0316 01136000
         SLR   @10,@10                                             0316 01137000
         IC    @10,BFCONUSE-18(@15,@11)                            0316 01138000
         SLR   @15,@15                                             0316 01139000
         IC    @15,USECOUNT                                        0316 01140000
         ALR   @10,@15                                             0316 01141000
         L     @15,@TF00001                                        0316 01142000
         STC   @10,BFCONUSE-18(@15,@11)                            0316 01143000
*       END;                        /* INCREMENT CONC USERS  @G24LB18*/ 01144000
*                                                                  0317 01145000
*     /***************************************************************/ 01146000
*     /*                                                             */ 01147000
*     /* INCREMENT THE BEST FIT TABLE ELEMENT INDEX AND      @G24LB18*/ 01148000
*     /* REPEAT THE STEP TABLE LOOP. CONTINUE UNTIL ALL      @G24LB18*/ 01149000
*     /* ELEMENTS IN THE BEST FIT TABLE HAVE BEEN PROCESSED. @G24LB18*/ 01150000
*     /* THEN RETURN TO MAINLINE ICBVTP00.                   @G24LB18*/ 01151000
*     /*                                                             */ 01152000
*     /***************************************************************/ 01153000
*                                                                  0318 01154000
*     INDEX=INDEX+ONE;              /* INCREMENT EL INDEX    @G24LB18*/ 01155000
@RF00312 AL    INDEX,@CF00052                                      0318 01156000
*   END;                            /* END ELEMENT LOOP      @G24LB18*/ 01157000
@DE00293 L     @15,TABBFTBL(,PARMPTR)                              0319 01158000
         CH    INDEX,BFTOTIDX(,@15)                                0319 01159000
         BNH   @DL00293                                            0319 01160000
*   REG14=SAVERET1;                 /* RESTORE RETURN ADDR   @G24LB18*/ 01161000
         L     REG14,SAVERET1                                      0320 01162000
*   RETURN;                         /* RETURN TO ICBVTP00    @G24LB18*/ 01163000
@EL00007 DS    0H                                                  0321 01164000
@EF00007 DS    0H                                                  0321 01165000
@ER00007 BR    @14                                                 0321 01166000
*   END UPDTBFTB;                   /* END BEST FIT TAB RTN  @G24LB18*/ 01167000
         B     @EL00007                                            0322 01168000
*                                                                  0323 01169000
*/*********************************************************  @G24LB18*/ 01170000
*/*                                                          @G24LB18*/ 01171000
*/* PROCEDURE NAME - VOLUSAGE                                @G24LB18*/ 01172000
*/*                                                          @G24LB18*/ 01173000
*/* FUNCTION - THIS ROUTINE IS CALLED ON UPDATE BEST FIT     @G24LB18*/ 01174000
*/*            TABLE REQUESTS WHEN A DD ENTRY HAS BEEN FOUND @G24LB18*/ 01175000
*/*            WITH A VOLSER WHICH MATCHES THE VOLSER IN THE @G24LB18*/ 01176000
*/*            BEST FIT TABLE ELEMENT BEING PROCESSED. THE   @G24LB18*/ 01177000
*/*            ROUTINE INCREMENTS THE USE COUNT FOR THE      @G24LB18*/ 01178000
*/*            VOLUME, DETERMINES WHETHER IT IS A WAIT       @G24LB18*/ 01179000
*/*            VOLUME OR A SHAREABILITY CONSIDERATION VOLUME @G24LB18*/ 01180000
*/*            AND SETS THE APPROPRIATE FLAGS IN THE BEST    @G24LB18*/ 01181000
*/*            FIT TABLE ELEMENT.                            @G24LB18*/ 01182000
*/*                                                          @G24LB18*/ 01183000
*/* INPUT - BEST FIT TABLE, BEST FIT TABLE ELEMENT, STEP     @G24LB18*/ 01184000
*/*         TABLE HEADER, AND DD ENTRY.                      @G24LB18*/ 01185000
*/*                                                          @G24LB18*/ 01186000
*/* OUTPUT - VOLUME USE COUNT AND UPDATED BEST FIT TABLE     @G24LB18*/ 01187000
*/*          ELEMENT.                                        @G24LB18*/ 01188000
*/*                                                          @G24LB18*/ 01189000
*/*********************************************************  @G24LB18*/ 01190000
*                                                                  0323 01191000
*VOLUSAGE:                                                         0323 01192000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 01193000
*                                                                  0323 01194000
VOLUSAGE DS    0H                                                  0324 01195000
*   /*****************************************************************/ 01196000
*   /*                                                               */ 01197000
*   /* INCREMENT THE VOLUME USE COUNT BY 1. DETERMINE        @G24LB18*/ 01198000
*   /* WHETHER THE DD ENTRY IS FROM THE REQUESTING JOB STEP. @G24LB18*/ 01199000
*   /* IF NOT, TEST TO SEE IF THE VOLUME IS A WAIT VOLUME,   @G24LB18*/ 01200000
*   /* MARK IT ACCORDINGLY IN THE BEST FIT TABLE ELEMENT,    @G24LB18*/ 01201000
*   /* AND RETURN TO UPDTBFTB.                               @G24LB18*/ 01202000
*   /*                                                               */ 01203000
*   /*****************************************************************/ 01204000
*                                                                  0324 01205000
*   USECOUNT=USECOUNT+ONE;          /* INCREMENT USE COUNT   @G24LB18*/ 01206000
         LA    @15,1                                               0324 01207000
         SLR   @11,@11                                             0324 01208000
         IC    @11,USECOUNT                                        0324 01209000
         ALR   @15,@11                                             0324 01210000
         STC   @15,USECOUNT                                        0324 01211000
*   IF STPJOBID¬=BFJOBID THEN       /* DD IN CURRENT STEP?   @G24LB18*/ 01212000
         L     @15,TABBFTBL(,PARMPTR)                              0325 01213000
         CLC   STPJOBID(4,STHDRPTR),BFJOBID(@15)                   0325 01214000
         BE    @RF00325                                            0325 01215000
*     DO;                           /* NO                    @G24LB18*/ 01216000
*       IF BFWAITFL(INDEX)=ON THEN  /* WAIT VOLUME IND ON?   @G24LB18*/ 01217000
         LR    @11,INDEX                                           0327 01218000
         MH    @11,@CH01134                                        0327 01219000
         ALR   @11,@15                                             0327 01220000
         TM    BFWAITFL-18(@11),B'01000000'                        0327 01221000
         BO    @RT00327                                            0327 01222000
*         RETURN;                   /* YES-RETURN TO UPDTBFT @G24LB18*/ 01223000
*                                                                  0328 01224000
*       /*************************************************************/ 01225000
*       /*                                                           */ 01226000
*       /* IF THE NON-SHAREABLE REQUEST FLAG IS ON IN THE    @G24LB18*/ 01227000
*       /* BEST FIT TABLE OR THE EXCLUSIVE USE FLAG IS ON IN @G24LB18*/ 01228000
*       /* THE DD ENTRY OR THE INTERNAL DEVICE TYPE FROM THE @G24LB18*/ 01229000
*       /* BEST FIT TABLE DOES NOT MATCH THAT IN THE DD      @G24LB18*/ 01230000
*       /* ENTRY, TURN ON THE 'WAIT VOLUME' INDICATOR IN THE @G24LB18*/ 01231000
*       /* BEST FIT TABLE ELEMENT AND RETURN TO UPDTBFTB.    @G24LB18*/ 01232000
*       /* OTHERWISE, JUST RETURN TO UPDTBFTB.               @G24LB18*/ 01233000
*       /*                                                           */ 01234000
*       /*************************************************************/ 01235000
*                                                                  0329 01236000
*       IF BFNSHRFL=ON|             /* REQ NON-SHARE OR      @G24LB18*/ 01237000
*           STPDDEXC=ON|            /* DD ENT EXCLUSIVE OR   @G24LB18*/ 01238000
*           BFDEVTP¬=STPDDDVT THEN  /* DEV TYPES NOT = ?     @G24LB18*/ 01239000
         TM    BFNSHRFL(@15),B'10000000'                           0329 01240000
         BO    @RT00329                                            0329 01241000
         TM    STPDDEXC(DDENTPTR),B'10000000'                      0329 01242000
         BO    @RT00329                                            0329 01243000
         CLC   BFDEVTP(4,@15),STPDDDVT(DDENTPTR)                   0329 01244000
         BE    @RF00329                                            0329 01245000
@RT00329 DS    0H                                                  0330 01246000
*         BFWAITFL(INDEX)=ON;       /* YES-SET WAIT VOLUME   @G24LB18*/ 01247000
         LR    @15,INDEX                                           0330 01248000
         MH    @15,@CH01134                                        0330 01249000
         L     @01,TABBFTBL(,PARMPTR)                              0330 01250000
         ALR   @01,@15                                             0330 01251000
         OI    BFWAITFL-18(@01),B'01000000'                        0330 01252000
*       RETURN;                     /* RETURN TO UPDTBFTB    @G24LB18*/ 01253000
@EL00008 DS    0H                                                  0331 01254000
@EF00008 DS    0H                                                  0331 01255000
@ER00008 BR    @14                                                 0331 01256000
*     END;                          /*                       @G24LB18*/ 01257000
*                                                                  0332 01258000
*   /*****************************************************************/ 01259000
*   /*                                                               */ 01260000
*   /* IF THE DD ENTRY IS FROM THE REQUESTING JOB STEP, TEST @G24LB18*/ 01261000
*   /* TO SEE IF THE VOLUME IS A SHAREABILITY CONSIDERATION  @G24LB18*/ 01262000
*   /* VOLUME, MARK IT ACCORDINGLY IN THE BEST FIT TABLE     @G24LB18*/ 01263000
*   /* ELEMENT, AND RETURN TO UPDTBFTB.                      @G24LB18*/ 01264000
*   /*                                                               */ 01265000
*   /*****************************************************************/ 01266000
*                                                                  0333 01267000
*   ELSE                            /* DD IN CURRENT STEP?   @G24LB18*/ 01268000
*     DO;                           /* YES                   @G24LB18*/ 01269000
*                                                                  0333 01270000
@RF00325 DS    0H                                                  0334 01271000
*       /*************************************************************/ 01272000
*       /*                                                           */ 01273000
*       /* IF THE NON-SHAREABLE REQUEST FLAG IS ON IN THE    @G24LB18*/ 01274000
*       /* BEST FIT TABLE OR THE EXCLUSIVE USE FLAG IS ON    @G24LB18*/ 01275000
*       /* IN THE DD ENTRY, TURN ON THE 'SHAREABILITY        @G24LB18*/ 01276000
*       /* CONSIDERATION' INDICATOR IN THE BEST FIT TABLE    @G24LB18*/ 01277000
*       /* ELEMENT AND RETURN TO UPDTBFTB. OTHERWISE, JUST   @G24LB18*/ 01278000
*       /* RETURN TO UPDTBFTB.                               @G24LB18*/ 01279000
*       /*                                                           */ 01280000
*       /*************************************************************/ 01281000
*                                                                  0334 01282000
*       IF BFNSHRFL=ON|             /* REQ NON-SHARE OR      @G24LB18*/ 01283000
*           STPDDEXC=ON THEN        /* DD ENTRY EXCLUSIVE?   @G24LB18*/ 01284000
         L     @15,TABBFTBL(,PARMPTR)                              0334 01285000
         TM    BFNSHRFL(@15),B'10000000'                           0334 01286000
         BO    @RT00334                                            0334 01287000
         TM    STPDDEXC(DDENTPTR),B'10000000'                      0334 01288000
         BNO   @RF00334                                            0334 01289000
@RT00334 DS    0H                                                  0335 01290000
*         BFSHCNFL(INDEX)=ON;       /* YES-SET SHARE CONSID  @G24LB18*/ 01291000
         LR    @15,INDEX                                           0335 01292000
         MH    @15,@CH01134                                        0335 01293000
         L     @01,TABBFTBL(,PARMPTR)                              0335 01294000
         ALR   @01,@15                                             0335 01295000
         OI    BFSHCNFL-18(@01),B'10000000'                        0335 01296000
*       RETURN;                     /* RETURN TO UPDTBFTB    @G24LB18*/ 01297000
         B     @EL00008                                            0336 01298000
*     END;                          /*                       @G24LB18*/ 01299000
*   END VOLUSAGE;                   /* END VOL USAGE RTN     @G24LB18*/ 01300000
         B     @EL00008                                            0338 01301000
*                                                                  0339 01302000
*/*********************************************************  @G24LB18*/ 01303000
*/*                                                          @G24LB18*/ 01304000
*/* PROCEDURE NAME - TOTSPACE                                @G24LB18*/ 01305000
*/*                                                          @G24LB18*/ 01306000
*/* FUNCTION - THIS ROUTINE IS CALLED ON GET TOTAL SPACE FOR @G24LB18*/ 01307000
*/*            VOL SER REQUESTS. IT SEARCHES THE STEP TABLE  @G24LB18*/ 01308000
*/*            CHAIN FOR THE VOL SER THAT IS PASSED WITH THE @G24LB18*/ 01309000
*/*            REQUEST, AND KEEPS A RUNNING TOTAL OF THE     @G24LB18*/ 01310000
*/*            PRIMARY SPACE RECORDED IN THE DD ENTRIES      @G24LB18*/ 01311000
*/*            FOUND FOR THAT VOL SER.                       @G24LB18*/ 01312000
*/*                                                          @G24LB18*/ 01313000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST, VVICB    @G24LB18*/ 01314000
*/*                                                          @G24LB18*/ 01315000
*/* OUTPUT - THE TOTAL SPACE FOUND FOR THE VOL SER IS        @G24LB18*/ 01316000
*/*          RETURNED IN THE TABP PARM LIST.                 @G24LB18*/ 01317000
*/*                                                          @G24LB18*/ 01318000
*/*********************************************************  @G24LB18*/ 01319000
*                                                                  0339 01320000
*TOTSPACE:                                                         0339 01321000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 01322000
*                                                                  0339 01323000
TOTSPACE DS    0H                                                  0340 01324000
*   /*****************************************************************/ 01325000
*   /*                                                               */ 01326000
*   /* INITIALIZE THE TOTAL SPACE TO 0. GET THE ADDRESS OF   @G24LB18*/ 01327000
*   /* THE STEP TABLE CHAIN FROM THE VVICB. IF IT IS 0,      @G24LB18*/ 01328000
*   /* STORE THE TOTAL SPACE (=0) IN THE TABP PARM LIST AND  @G24LB18*/ 01329000
*   /* RETURN TO MAINLINE ICBVTP00. OTHERWISE GET THE FIRST  @G24LB18*/ 01330000
*   /* STEP TABLE HEADER.                                    @G24LB18*/ 01331000
*   /*                                                               */ 01332000
*   /*****************************************************************/ 01333000
*                                                                  0340 01334000
*   TPSPACE=ZERO;                   /* INIT TOTAL SPACE = 0  @G24LB18*/ 01335000
         SLR   TPSPACE,TPSPACE                                     0340 01336000
*   STHDRPTR=ADDR(VVISTPTB);        /* GET STEP TABLE CHAIN  @G24LB18*/ 01337000
         L     STHDRPTR,VVIPTR                                     0341 01338000
         LA    STHDRPTR,VVISTPTB(,STHDRPTR)                        0341 01339000
*   DO WHILE STPNXTTB¬=ZERO;        /* DO FOR EACH HEADER    @G24LB18*/ 01340000
         B     @DE00342                                            0342 01341000
@DL00342 DS    0H                                                  0343 01342000
*     STHDRPTR=STPNXTTB;            /* GET STEP TAB HEADER   @G24LB18*/ 01343000
*                                                                  0343 01344000
         L     STHDRPTR,STPNXTTB(,STHDRPTR)                        0343 01345000
*     /***************************************************************/ 01346000
*     /*                                                             */ 01347000
*     /* IF THE STEP TABLE IS NOT INVALID, GET THE FIRST DD  @G24LB18*/ 01348000
*     /* ENTRY.                                              @G24LB18*/ 01349000
*     /*                                                             */ 01350000
*     /***************************************************************/ 01351000
*                                                                  0344 01352000
*     IF STPINVAL=OFF THEN          /* STEP TABLE INVALID?   @G24LB18*/ 01353000
         TM    STPINVAL(STHDRPTR),B'10000000'                      0344 01354000
         BNZ   @RF00344                                            0344 01355000
*       DO;                         /* NO                    @G24LB18*/ 01356000
*         DDENTPTR=ADDR(STPDDPTR);  /* GET DD ENTRY CHAIN    @G24LB18*/ 01357000
         LA    DDENTPTR,STPDDPTR(,STHDRPTR)                        0346 01358000
*         DO WHILE STPDDNXT¬=ZERO;  /* DO FOR EACH DD ENTRY  @G24LB18*/ 01359000
         B     @DE00347                                            0347 01360000
@DL00347 DS    0H                                                  0348 01361000
*           DDENTPTR=STPDDNXT;      /* GET DD ENTRY          @G24LB18*/ 01362000
         L     DDENTPTR,STPDDNXT(,DDENTPTR)                        0348 01363000
*                                                                  0349 01364000
*           /*********************************************************/ 01365000
*           /*                                                       */ 01366000
*           /* IF THE VOLSER FROM THE PARM LIST = THE FIRST  @G24LB18*/ 01367000
*           /* VOLSER IN THE DD ENTRY, ADD THE PRIMARY SPACE @G24LB18*/ 01368000
*           /* FROM THE DD ENTRY TO THE TOTAL SPACE.         @G24LB18*/ 01369000
*           /*                                                       */ 01370000
*           /*********************************************************/ 01371000
*                                                                  0349 01372000
*           IF STPDDVOL(ONE)=TABVOLID THEN/* VOLSERS = ?     @G24LB18*/ 01373000
         CLC   STPDDVOL(6,DDENTPTR),TABVOLID(PARMPTR)              0349 01374000
         BNE   @RF00349                                            0349 01375000
*             TPSPACE=TPSPACE+STPDDPRM;/* ADD SPACE TO TOT   @G24LB18*/ 01376000
*                                                                  0350 01377000
         AH    TPSPACE,STPDDPRM(,DDENTPTR)                         0350 01378000
*           /*********************************************************/ 01379000
*           /*                                                       */ 01380000
*           /* GET THE NEXT DD ENTRY AND REPEAT UNTIL ALL DD @G24LB18*/ 01381000
*           /* ENTRIES IN THE STEP TABLE HAVE BEEN PROCESSED.        */ 01382000
*           /*                                               @G24LB18*/ 01383000
*           /*                                                       */ 01384000
*           /*********************************************************/ 01385000
*                                                                  0351 01386000
*         END;                      /* END DD ENTRY LOOP     @G24LB18*/ 01387000
@RF00349 DS    0H                                                  0351 01388000
@DE00347 L     @15,STPDDNXT(,DDENTPTR)                             0351 01389000
         LTR   @15,@15                                             0351 01390000
         BNZ   @DL00347                                            0351 01391000
*       END;                        /*                       @G24LB18*/ 01392000
*                                                                  0352 01393000
*     /***************************************************************/ 01394000
*     /*                                                             */ 01395000
*     /* GET THE NEXT STEP TABLE HEADER AND REPEAT THE DD    @G24LB18*/ 01396000
*     /* ENTRY LOOP. CONTINUE UNTIL ALL STEP TABLES IN THE   @G24LB18*/ 01397000
*     /* STEP TABLE CHAIN HAVE BEEN PROCESSED.               @G24LB18*/ 01398000
*     /*                                                             */ 01399000
*     /***************************************************************/ 01400000
*                                                                  0353 01401000
*   END;                            /*                       @G24LB18*/ 01402000
*                                                                  0353 01403000
@RF00344 DS    0H                                                  0353 01404000
@DE00342 L     @15,STPNXTTB(,STHDRPTR)                             0353 01405000
         LTR   @15,@15                                             0353 01406000
         BNZ   @DL00342                                            0353 01407000
*   /*****************************************************************/ 01408000
*   /*                                                               */ 01409000
*   /* STORE THE TOTAL SPACE INTO THE TABP PARM LIST AND     @G24LB18*/ 01410000
*   /* RETURN TO MAINLINE ICBVTP00.                          @G24LB18*/ 01411000
*   /*                                                               */ 01412000
*   /*****************************************************************/ 01413000
*                                                                  0354 01414000
*   TABSPRET=TPSPACE;               /* STORE TOTAL SPACE     @G24LB18*/ 01415000
         STH   TPSPACE,TABSPRET(,PARMPTR)                          0354 01416000
*   RETURN;                         /* RETURN TO ICBVTP00    @G24LB18*/ 01417000
@EL00009 DS    0H                                                  0355 01418000
@EF00009 DS    0H                                                  0355 01419000
@ER00009 BR    @14                                                 0355 01420000
*   END TOTSPACE;                   /* END TOTAL SPACE RTN   @G24LB18*/ 01421000
*                                                                  0357 01422000
*/*********************************************************  @G24LB18*/ 01423000
*/*                                                          @G24LB18*/ 01424000
*/* PROCEDURE NAME - SRCJOBID                                @G24LB18*/ 01425000
*/*                                                          @G24LB18*/ 01426000
*/* FUNCTION - THIS SUBROUTINE IS CALLED WHEN THE STEP TABLE @G24LB18*/ 01427000
*/*            FOR THE CURRENT REQUEST MUST BE FOUND. THE    @G24LB18*/ 01428000
*/*            ROUTINE SEARCHES THE STEP TABLE CHAIN FOR     @G24LB18*/ 01429000
*/*            THE STEP TABLE WHOSE JOBID MATCHES THE JOBID  @G24LB18*/ 01430000
*/*            PASSED WITH THE REQUEST.                      @G24LB18*/ 01431000
*/*                                                          @G24LB18*/ 01432000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST, VVICB    @G24LB18*/ 01433000
*/*                                                          @G24LB18*/ 01434000
*/* OUTPUT - IF A STEP TABLE IS FOUND WITH A MATCHING JOBID  @G24LB18*/ 01435000
*/*          AND IT IS NOT MARKED INVALID, ITS ADDRESS IS    @G24LB18*/ 01436000
*/*          RETURNED IN FIELD STHDRPTR WITH A RETURN CODE   @G24LB18*/ 01437000
*/*          OF 0. OTHERWISE, A RETURN CODE = 4 IS RETURNED. @G24LB18*/ 01438000
*/*                                                          @G24LB18*/ 01439000
*/*********************************************************  @G24LB18*/ 01440000
*                                                                  0357 01441000
*SRCJOBID:                                                         0357 01442000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 01443000
*                                                                  0357 01444000
SRCJOBID DS    0H                                                  0358 01445000
*   /*****************************************************************/ 01446000
*   /*                                                               */ 01447000
*   /* GET THE ADDRESS OF THE STEP TABLE CHAIN FROM THE      @G24LB18*/ 01448000
*   /* VVICB. IF IT IS 0, RETURN TO THE CALLER WITH RETURN   @G24LB18*/ 01449000
*   /* CODE = 4. OTHERWISE GET THE FIRST STEP TABLE HEADER.  @G24LB18*/ 01450000
*   /*                                                               */ 01451000
*   /*****************************************************************/ 01452000
*                                                                  0358 01453000
*   STHDRPTR=ADDR(VVISTPTB);        /* GET STEP TABLE CHAIN  @G24LB18*/ 01454000
         L     STHDRPTR,VVIPTR                                     0358 01455000
         LA    STHDRPTR,VVISTPTB(,STHDRPTR)                        0358 01456000
*   DO WHILE STPNXTTB¬=ZERO;        /* DO FOR EACH HEADER    @G24LB18*/ 01457000
         B     @DE00359                                            0359 01458000
@DL00359 DS    0H                                                  0360 01459000
*     STHDRPTR=STPNXTTB;            /* GET NEXT HEADER       @G24LB18*/ 01460000
*                                                                  0360 01461000
         L     STHDRPTR,STPNXTTB(,STHDRPTR)                        0360 01462000
*     /***************************************************************/ 01463000
*     /*                                                             */ 01464000
*     /* IF THE JOBID OF THE HEADER MATCHES THE JOBID IN THE @G24LB18*/ 01465000
*     /* TABP PARM LIST AND IF THE HEADER IS NOT MARKED      @G24LB18*/ 01466000
*     /* INVALID, RETURN TO THE CALLER WITH THE ADDRESS OF   @G24LB18*/ 01467000
*     /* THE HEADER IN FIELD STHDRPTR.                       @G24LB18*/ 01468000
*     /*                                                             */ 01469000
*     /***************************************************************/ 01470000
*                                                                  0361 01471000
*     IF JOBID=STPJOBID&            /* JOBIDS MATCH AND      @G24LB18*/ 01472000
*         STPINVAL=OFF THEN         /* HEADER NOT INVALID?   @G24LB18*/ 01473000
         C     JOBID,STPJOBID(,STHDRPTR)                           0361 01474000
         BNE   @RF00361                                            0361 01475000
         TM    STPINVAL(STHDRPTR),B'10000000'                      0361 01476000
         BZ    @RT00361                                            0361 01477000
*       RETURN;                     /* YES-RETURN TO CALLER  @G24LB18*/ 01478000
*   END;                            /* END STEP TABLE SEARCH @G24LB18*/ 01479000
@RF00361 DS    0H                                                  0363 01480000
@DE00359 L     @15,STPNXTTB(,STHDRPTR)                             0363 01481000
         LTR   @15,@15                                             0363 01482000
         BNZ   @DL00359                                            0363 01483000
*                                                                  0364 01484000
*   /*****************************************************************/ 01485000
*   /*                                                               */ 01486000
*   /* IF NO VALID STEP TABLE IS FOUND WITH A MATCHING       @G24LB18*/ 01487000
*   /* JOBID, RETURN TO THE CALLER WITH A RETURN CODE = 4.   @G24LB18*/ 01488000
*   /*                                                               */ 01489000
*   /*****************************************************************/ 01490000
*                                                                  0364 01491000
*   RETCODE=FOUR;                   /* SET RETURN CODE = 4   @G24LB18*/ 01492000
         MVC   RETCODE(4),@CF00060                                 0364 01493000
*   RETURN;                         /* RETURN TO CALLER      @G24LB18*/ 01494000
@EL00010 DS    0H                                                  0365 01495000
@EF00010 DS    0H                                                  0365 01496000
@ER00010 BR    @14                                                 0365 01497000
*   END SRCJOBID;                   /* END JOBID SEARCH RTN  @G24LB18*/ 01498000
         B     @EL00010                                            0366 01499000
*   END ICBVTP00                    /* END TABLE PROCESSOR   @G24LB18*/ 01500000
*                                                                  0367 01501000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01502000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01503000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 01504000
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */ 01505000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 01506000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 01507000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */ 01508000
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                       */ 01509000
*/*%INCLUDE SYSLIB  (IEZMSGRQ)                                       */ 01510000
*/*%INCLUDE SYSLIB  (IEZSTPTB)                                       */ 01511000
*/*%INCLUDE SYSLIB  (IEZTABP )                                       */ 01512000
*/*%INCLUDE SYSLIB  (IEZBFTBL)                                       */ 01513000
*/*%INCLUDE SYSLIB  (IEZGRPPR)                                       */ 01514000
*/*%INCLUDE SYSLIB  (IEZVOLRT)                                       */ 01515000
*                                                                  0367 01516000
*       ;                                                          0367 01517000
@DATA    DS    0H                                                       01518000
@CH00064 DC    H'6'                                                     01519000
@CH01134 DC    H'18'                                                    01520000
@CH01601 DC    H'20'                                                    01521000
@SM01666 MVC   MOVELST(0,MOVEPTR),GRPPR(@10)                            01522000
@SM01668 MVC   STPDDVOL(0,DDENTPTR),JFCBVOLS(@07)                       01523000
@SM01670 MVC   STPDDVOL-6(0,@15),JFCBXVOL(@10)                          01524000
@SM01672 MVC   STPDDVOL-6(0,@11),VOLJFCBX(@15)                          01525000
         DS    0F                                                       01526000
@SA00001 DS    18F                                                      01527000
@TF00001 DS    F                                                        01528000
         DS    0F                                                       01529000
@CF00052 DC    F'1'                                                     01530000
@CF00060 DC    F'4'                                                     01531000
@CF00062 DC    F'5'                                                     01532000
@CF01659 DC    F'26'                                                    01533000
@CF01660 DC    F'132'                                                   01534000
@CF00083 DC    F'409'                                                   01535000
@CV01597 DC    V(ICBVOP00)                                              01536000
         DS    0D                                                       01537000
VVIPTR   DS    A                                                        01538000
JFCBPTR  DS    A                                                        01539000
JFCBXPTR DS    A                                                        01540000
SAVERET1 DS    F                                                        01541000
SAVERET2 DS    F                                                        01542000
RETCODE  DS    F                                                        01543000
NVOL     DS    FL1                                                      01544000
USECOUNT DS    FL1                                                      01545000
VOLINDX  DS    FL1                                                      01546000
         DS    CL1                                                      01547000
MSGRQ    DS    CL32                                                     01548000
         ORG   MSGRQ                                                    01549000
MSGID    DS    FL4                                                      01550000
MSGRPLV  DS    AL4                                                      01551000
MSGRLEN  DS    BL1                                                      01552000
MSGREPLY DS    AL3                                                      01553000
MSGLEN1  DS    BL1                                                      01554000
MSGTEXT1 DS    AL3                                                      01555000
MSGLEN2  DS    BL1                                                      01556000
MSGTEXT2 DS    AL3                                                      01557000
MSGLEN3  DS    BL1                                                      01558000
MSGTEXT3 DS    AL3                                                      01559000
MSGLEN4  DS    BL1                                                      01560000
MSGTEXT4 DS    AL3                                                      01561000
MSGLEN5  DS    BL1                                                      01562000
MSGTEXT5 DS    AL3                                                      01563000
         ORG   MSGRQ+32                                                 01564000
VTPPATCH DS    CL200                                                    01565000
         ORG   VTPPATCH                                                 01566000
@NM00051 DC    CL20'ICBVTP00 PATCH AREA '                               01567000
@NM00052 DC    XL180'0'                                                 01568000
         ORG   VTPPATCH+200                                             01569000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01570000
@01      EQU   01                                                       01571000
@02      EQU   02                                                       01572000
@03      EQU   03                                                       01573000
@04      EQU   04                                                       01574000
@05      EQU   05                                                       01575000
@06      EQU   06                                                       01576000
@07      EQU   07                                                       01577000
@08      EQU   08                                                       01578000
@09      EQU   09                                                       01579000
@10      EQU   10                                                       01580000
@11      EQU   11                                                       01581000
@12      EQU   12                                                       01582000
@13      EQU   13                                                       01583000
@14      EQU   14                                                       01584000
@15      EQU   15                                                       01585000
JOBID    EQU   @07                                                      01586000
TPSPACE  EQU   @07                                                      01587000
INDEX    EQU   @07                                                      01588000
SAVENTRY EQU   @07                                                      01589000
GETLEN   EQU   @07                                                      01590000
MOVEPTR  EQU   @07                                                      01591000
REG0     EQU   @00                                                      01592000
REG1     EQU   @01                                                      01593000
REG2     EQU   @02                                                      01594000
REG3     EQU   @03                                                      01595000
PARMPTR  EQU   @04                                                      01596000
STHDRPTR EQU   @05                                                      01597000
DDENTPTR EQU   @06                                                      01598000
REG14    EQU   @14                                                      01599000
REG15    EQU   @15                                                      01600000
CVTPTR   EQU   16                                                       01601000
PSA      EQU   0                                                        01602000
FLCRNPSW EQU   PSA                                                      01603000
FLCROPSW EQU   PSA+8                                                    01604000
FLCICCW2 EQU   PSA+16                                                   01605000
PSAEEPSW EQU   PSA+132                                                  01606000
PSAESPSW EQU   PSA+136                                                  01607000
FLCSVILC EQU   PSAESPSW+1                                               01608000
PSAEPPSW EQU   PSA+140                                                  01609000
FLCPIILC EQU   PSAEPPSW+1                                               01610000
FLCPICOD EQU   PSAEPPSW+2                                               01611000
PSAPICOD EQU   FLCPICOD+1                                               01612000
FLCTEA   EQU   PSAEPPSW+4                                               01613000
FLCPER   EQU   PSA+152                                                  01614000
FLCMCLA  EQU   PSA+168                                                  01615000
FLCIOEL  EQU   FLCMCLA+4                                                01616000
FLCIOA   EQU   FLCMCLA+16                                               01617000
FLCFSA   EQU   FLCMCLA+80                                               01618000
PSASUPER EQU   PSA+552                                                  01619000
PSASUP1  EQU   PSASUPER                                                 01620000
PSASUP2  EQU   PSASUPER+1                                               01621000
PSASUP3  EQU   PSASUPER+2                                               01622000
PSASUP4  EQU   PSASUPER+3                                               01623000
PSACLHT  EQU   PSA+640                                                  01624000
PSALKSA  EQU   PSA+696                                                  01625000
PSAHLHI  EQU   PSA+760                                                  01626000
PSADSSFL EQU   PSA+836                                                  01627000
PSADSSF1 EQU   PSADSSFL                                                 01628000
PSADSSF3 EQU   PSADSSFL+2                                               01629000
PSADSSF4 EQU   PSADSSFL+3                                               01630000
PSARSVT  EQU   PSA+896                                                  01631000
RPLVPTR  EQU   0                                                        01632000
CVTMAP   EQU   0                                                        01633000
CVTDAR   EQU   CVTMAP+72                                                01634000
CVTFLGS1 EQU   CVTDAR                                                   01635000
CVTDCB   EQU   CVTMAP+116                                               01636000
CVTIERLC EQU   CVTMAP+144                                               01637000
CVTOPTA  EQU   CVTMAP+182                                               01638000
CVTOPTB  EQU   CVTMAP+183                                               01639000
CVTGTF   EQU   CVTMAP+236                                               01640000
CVTGTFST EQU   CVTGTF                                                   01641000
CVTGTFS  EQU   CVTGTFST                                                 01642000
CVTSTATE EQU   CVTGTFST                                                 01643000
CVTTMODE EQU   CVTGTFST                                                 01644000
CVTFORM  EQU   CVTGTFST                                                 01645000
CVTAQAVT EQU   CVTMAP+240                                               01646000
CVTTCMFG EQU   CVTAQAVT                                                 01647000
CVTVOLM2 EQU   CVTMAP+244                                               01648000
CVTTATA  EQU   CVTVOLM2                                                 01649000
CVTTSKS  EQU   CVTTATA                                                  01650000
CVTVOLF2 EQU   CVTTSKS                                                  01651000
CVTTAT   EQU   CVTTATA+1                                                01652000
CVTATER  EQU   CVTMAP+248                                               01653000
CVTEXT1  EQU   CVTMAP+252                                               01654000
CVTPURG  EQU   CVTMAP+260                                               01655000
CVTQMSG  EQU   CVTMAP+268                                               01656000
CVTDMSR  EQU   CVTMAP+272                                               01657000
CVTRSV37 EQU   CVTDMSR                                                  01658000
CVTDMSRF EQU   CVTRSV37                                                 01659000
CVTERPV  EQU   CVTMAP+316                                               01660000
CVTINTLA EQU   CVTMAP+320                                               01661000
CVTAPF   EQU   CVTMAP+324                                               01662000
CVTEXT2  EQU   CVTMAP+328                                               01663000
CVTHJES  EQU   CVTMAP+332                                               01664000
CVTPGSIA EQU   CVTMAP+348                                               01665000
CVTA1F1  EQU   CVTMAP+356                                               01666000
CVTSYSK  EQU   CVTMAP+357                                               01667000
CVTVOLM1 EQU   CVTMAP+380                                               01668000
CVTVOLF1 EQU   CVTVOLM1                                                 01669000
CVTATMCT EQU   CVTMAP+388                                               01670000
CVTXTNT1 EQU   0                                                        01671000
CVTXTNT2 EQU   0                                                        01672000
CVTDSSV  EQU   CVTXTNT2                                                 01673000
CVTFLGBT EQU   CVTXTNT2+5                                               01674000
CVTQID   EQU   CVTXTNT2+24                                              01675000
CVTICB   EQU   CVTXTNT2+48                                              01676000
CVTRV400 EQU   CVTXTNT2+52                                              01677000
CVTRV409 EQU   CVTXTNT2+53                                              01678000
CVTATCVT EQU   CVTXTNT2+64                                              01679000
CVTRV429 EQU   CVTXTNT2+84                                              01680000
CVTRV438 EQU   CVTXTNT2+85                                              01681000
CVTRV457 EQU   CVTXTNT2+112                                             01682000
CVTRV466 EQU   CVTXTNT2+113                                             01683000
CVTFIX   EQU   0                                                        01684000
CVTRELNO EQU   CVTFIX+252                                               01685000
ICB2SSCB EQU   0                                                        01686000
ICBOPT   EQU   ICB2SSCB+48                                              01687000
ICBFLG   EQU   ICB2SSCB+52                                              01688000
ICBFG1   EQU   ICBFLG                                                   01689000
ICBVVICB EQU   ICB2SSCB+76                                              01690000
ICBTRACE EQU   ICB2SSCB+112                                             01691000
VVICB    EQU   0                                                        01692000
VVIFLGA  EQU   VVICB+15                                                 01693000
VVIFLG6  EQU   VVIFLGA                                                  01694000
VVIFLG7  EQU   VVIFLGA                                                  01695000
VVISTPTB EQU   VVICB+88                                                 01696000
RPLV     EQU   0                                                        01697000
RPLTCBPR EQU   RPLV+8                                                   01698000
RPLFLAGA EQU   RPLV+28                                                  01699000
RPLVSAM  EQU   RPLV+56                                                  01700000
RPLVOPT  EQU   RPLVSAM+40                                               01701000
INFMJFCB EQU   0                                                        01702000
JFCBDSNM EQU   INFMJFCB                                                 01703000
JFCBELNM EQU   INFMJFCB+44                                              01704000
JFCBTSDM EQU   INFMJFCB+52                                              01705000
JFCFCBID EQU   INFMJFCB+56                                              01706000
JFCBFRID EQU   JFCFCBID                                                 01707000
JFCBLTYP EQU   INFMJFCB+66                                              01708000
JFCBOTTR EQU   INFMJFCB+67                                              01709000
JFCBUFOF EQU   JFCBOTTR                                                 01710000
JFCBFLSQ EQU   JFCBOTTR+1                                               01711000
JFCFUNC  EQU   JFCBFLSQ                                                 01712000
JFCBMASK EQU   INFMJFCB+72                                              01713000
JFCBFLG1 EQU   JFCBMASK+5                                               01714000
JFCOPEN  EQU   JFCBFLG1                                                 01715000
JFCBFLG2 EQU   JFCBMASK+6                                               01716000
JFCDEFER EQU   JFCBFLG2                                                 01717000
JFCBIND1 EQU   INFMJFCB+86                                              01718000
JFCBIND2 EQU   INFMJFCB+87                                              01719000
JFCAMPTR EQU   INFMJFCB+88                                              01720000
JFCBUFRQ EQU   JFCAMPTR                                                 01721000
JFCBUFNO EQU   JFCBUFRQ                                                 01722000
JFCBGNCP EQU   JFCAMPTR+1                                               01723000
JFCBHIAR EQU   JFCBGNCP                                                 01724000
JFCBFALN EQU   JFCBHIAR                                                 01725000
JFCBFTEK EQU   JFCBFALN                                                 01726000
JFCBBFTA EQU   JFCBFTEK                                                 01727000
JFCEROPT EQU   INFMJFCB+92                                              01728000
JFCTRTCH EQU   INFMJFCB+93                                              01729000
JFCBX    EQU   0                                                        01730000
JFCBXVOL EQU   JFCBX+4                                                  01731000
JFCBXNXT EQU   JFCBX+172                                                01732000
STPTB    EQU   0                                                        01733000
STPNXTTB EQU   STPTB                                                    01734000
STPPRVTB EQU   STPTB+4                                                  01735000
STPJOBID EQU   STPTB+8                                                  01736000
STPHDRLN EQU   STPTB+12                                                 01737000
STPFLAGS EQU   STPTB+14                                                 01738000
STPINVAL EQU   STPFLAGS                                                 01739000
STPICCTR EQU   STPTB+15                                                 01740000
STPDDPTR EQU   STPTB+16                                                 01741000
STPDDENT EQU   0                                                        01742000
STPDDNXT EQU   STPDDENT                                                 01743000
STPDDLEN EQU   STPDDENT+4                                               01744000
STPDDNUM EQU   STPDDENT+6                                               01745000
STPDDDVT EQU   STPDDENT+8                                               01746000
STPDDGPN EQU   STPDDENT+12                                              01747000
STPDDPRM EQU   STPDDENT+22                                              01748000
STPDDFLG EQU   STPDDENT+24                                              01749000
STPDDEXC EQU   STPDDFLG                                                 01750000
STPDDNVL EQU   STPDDENT+25                                              01751000
STPDDVOL EQU   STPDDENT+26                                              01752000
TABP     EQU   0                                                        01753000
TABFLAGS EQU   TABP                                                     01754000
TABFBLDE EQU   TABFLAGS                                                 01755000
TABFSRCD EQU   TABFLAGS                                                 01756000
TABFBFIT EQU   TABFLAGS                                                 01757000
TABFTSPC EQU   TABFLAGS                                                 01758000
TABVOLID EQU   TABP+2                                                   01759000
TABDDNUM EQU   TABVOLID                                                 01760000
TABSELRB EQU   TABVOLID+2                                               01761000
TABJOBID EQU   TABSELRB                                                 01762000
TABBFTBL EQU   TABJOBID                                                 01763000
TABDDRET EQU   TABP+8                                                   01764000
TABHDRET EQU   TABDDRET                                                 01765000
TABSPRET EQU   TABHDRET                                                 01766000
BFTBL    EQU   0                                                        01767000
BFHEADER EQU   BFTBL                                                    01768000
BFTOTIDX EQU   BFHEADER+10                                              01769000
BFDEVTP  EQU   BFHEADER+12                                              01770000
BFJOBID  EQU   BFHEADER+16                                              01771000
BFREQFLS EQU   BFHEADER+20                                              01772000
BFNSHRFL EQU   BFREQFLS                                                 01773000
BFENTRY  EQU   BFTBL+21                                                 01774000
BFSLOT   EQU   BFENTRY                                                  01775000
BFVOLID  EQU   BFSLOT                                                   01776000
BFHPFLGS EQU   BFSLOT+8                                                 01777000
BFWAITFL EQU   BFHPFLGS                                                 01778000
BFLPFLGS EQU   BFSLOT+14                                                01779000
BFSHCNFL EQU   BFLPFLGS                                                 01780000
BFNMTDFL EQU   BFLPFLGS                                                 01781000
BFMTDOHF EQU   BFLPFLGS                                                 01782000
BFCONUSE EQU   BFSLOT+15                                                01783000
BFMISCFL EQU   BFSLOT+16                                                01784000
GRPPR    EQU   0                                                        01785000
VOLRT    EQU   0                                                        01786000
VOLLEN   EQU   VOLRT                                                    01787000
VOLSER   EQU   VOLRT+4                                                  01788000
SELRB    EQU   0                                                        01789000
SELFLGS1 EQU   SELRB+5                                                  01790000
SELPARMT EQU   SELFLGS1                                                 01791000
SELDEFER EQU   SELFLGS1                                                 01792000
SELFLGS2 EQU   SELRB+6                                                  01793000
SELINITC EQU   SELFLGS2                                                 01794000
SELUNCNT EQU   SELRB+7                                                  01795000
SELJOBID EQU   SELRB+8                                                  01796000
SELJFCBA EQU   SELRB+12                                                 01797000
SELDEVTP EQU   SELRB+16                                                 01798000
SELUCBAD EQU   SELRB+20                                                 01799000
SELDDNUM EQU   SELRB+44                                                 01800000
SELJFCBX EQU   SELRB+52                                                 01801000
SELVLRET EQU   SELRB+56                                                 01802000
SELGRPPR EQU   SELRB+60                                                 01803000
MOVELIST EQU   0                                                        01804000
MOVELST  EQU   MOVELIST                                                 01805000
PARMLIST EQU   0                                                        01806000
PARMADDR EQU   PARMLIST                                                 01807000
VOLJFCBX EQU   JFCBXVOL                                                 01808000
CVTS01   EQU   CVTPGSIA                                                 01809000
CVTLPDIA EQU   CVTS01+12                                                01810000
CVTDIRST EQU   CVTLPDIA                                                 01811000
CVTSLIDA EQU   CVTS01+24                                                01812000
CVTCTLFG EQU   CVTS01+50                                                01813000
CVTRV210 EQU   CVTS01+424                                               01814000
CVTRV219 EQU   CVTS01+425                                               01815000
CVTRV228 EQU   CVTS01+426                                               01816000
CVTRV237 EQU   CVTS01+427                                               01817000
CVTMFRTR EQU   CVTS01+452                                               01818000
CVTRV262 EQU   CVTS01+468                                               01819000
CVTRV271 EQU   CVTS01+469                                               01820000
CVTRV280 EQU   CVTS01+470                                               01821000
CVTRV289 EQU   CVTS01+471                                               01822000
CVTGSDA  EQU   CVTS01+600                                               01823000
PSARSVTE EQU   PSARSVT                                                  01824000
JFCKEYLE EQU   JFCTRTCH                                                 01825000
JFCCODE  EQU   JFCKEYLE                                                 01826000
JFCSTACK EQU   JFCTRTCH                                                 01827000
JFCMODE  EQU   JFCSTACK                                                 01828000
JFCSPPRT EQU   JFCTRTCH                                                 01829000
JFCBABFS EQU   JFCSPPRT+2                                               01830000
JFCLIMCT EQU   JFCBABFS                                                 01831000
JFCDSORG EQU   JFCSPPRT+5                                               01832000
JFCDSRG1 EQU   JFCDSORG                                                 01833000
JFCDSRG2 EQU   JFCDSORG+1                                               01834000
JFCRECFM EQU   JFCSPPRT+7                                               01835000
JFCRCFM  EQU   JFCRECFM                                                 01836000
JFCOPTCD EQU   JFCSPPRT+8                                               01837000
JFCWVCSP EQU   JFCOPTCD                                                 01838000
JFCWVCIS EQU   JFCWVCSP                                                 01839000
JFCWVCBD EQU   JFCWVCIS                                                 01840000
JFCALLOW EQU   JFCOPTCD                                                 01841000
JFCRSV17 EQU   JFCALLOW                                                 01842000
JFCOVER  EQU   JFCRSV17                                                 01843000
JFCPCIBT EQU   JFCOPTCD                                                 01844000
JFCMAST  EQU   JFCPCIBT                                                 01845000
JFCEXT   EQU   JFCMAST                                                  01846000
JFCBCKPT EQU   JFCOPTCD                                                 01847000
JFCIND   EQU   JFCBCKPT                                                 01848000
JFCRSV18 EQU   JFCOPTCD                                                 01849000
JFCCYL   EQU   JFCRSV18                                                 01850000
JFCACT   EQU   JFCCYL                                                   01851000
JFCREDUC EQU   JFCOPTCD                                                 01852000
JFCRSV19 EQU   JFCREDUC                                                 01853000
JFCRSV20 EQU   JFCRSV19                                                 01854000
JFCRSV21 EQU   JFCOPTCD                                                 01855000
JFCDEL   EQU   JFCRSV21                                                 01856000
JFCOPTJ  EQU   JFCOPTCD                                                 01857000
JFCREORG EQU   JFCOPTJ                                                  01858000
JFCBLKSI EQU   JFCSPPRT+9                                               01859000
JFCBUFSI EQU   JFCBLKSI                                                 01860000
JFCAMSYN EQU   JFCSPPRT+11                                              01861000
JFCNCP   EQU   JFCAMSYN+2                                               01862000
JFCNTM   EQU   JFCAMSYN+3                                               01863000
JFCBFSEQ EQU   JFCNTM                                                   01864000
JFCPCI   EQU   JFCBFSEQ                                                 01865000
JFCRESRV EQU   JFCAMSYN+4                                               01866000
JFCUCSEG EQU   JFCRESRV                                                 01867000
JFCUCSOP EQU   JFCUCSEG+4                                               01868000
JFCOUTLI EQU   JFCUCSEG+5                                               01869000
JFCTHRSH EQU   JFCOUTLI                                                 01870000
JFCCPRI  EQU   JFCTHRSH                                                 01871000
JFCBNVOL EQU   JFCUCSEG+9                                               01872000
JFCBVOLS EQU   JFCUCSEG+10                                              01873000
JFCBS001 EQU   JFCBVOLS                                                 01874000
JFCBPQTY EQU   JFCBS001+34                                              01875000
JFCBCTRI EQU   JFCBS001+37                                              01876000
JFCBSQTY EQU   JFCBS001+38                                              01877000
JFCFLGS1 EQU   JFCBS001+41                                              01878000
JFCBUAFF EQU   JFCFLGS1                                                 01879000
JFCBVLCT EQU   JFCBS001+56                                              01880000
FLC      EQU   PSA                                                      01881000
ICBPTR   EQU   CVTICB                                                   01882000
*                                      START UNREFERENCED COMPONENTS    01883000
JFCBEND  EQU   JFCBS001+58                                              01884000
JFCBSPTN EQU   JFCBS001+57                                              01885000
JFCBDRLH EQU   JFCBS001+53                                              01886000
JFCBSBNM EQU   JFCBS001+50                                              01887000
JFCBABST EQU   JFCBS001+48                                              01888000
JFCBSPNM EQU   JFCBS001+45                                              01889000
JFCBDQTY EQU   JFCBS001+42                                              01890000
JFCRSV45 EQU   JFCFLGS1                                                 01891000
JFCVRDS  EQU   JFCFLGS1                                                 01892000
JFCBCEOV EQU   JFCFLGS1                                                 01893000
JFCRSV42 EQU   JFCFLGS1                                                 01894000
JFCBADSP EQU   JFCFLGS1                                                 01895000
JFCTOPEN EQU   JFCFLGS1                                                 01896000
JFCBDLET EQU   JFCFLGS1                                                 01897000
JFCRQID  EQU   JFCBSQTY                                                 01898000
JFCROUND EQU   JFCBCTRI                                                 01899000
JFCALX   EQU   JFCBCTRI                                                 01900000
JFCMIXG  EQU   JFCBCTRI                                                 01901000
JFCONTIG EQU   JFCBCTRI                                                 01902000
JFCRSV29 EQU   JFCBCTRI                                                 01903000
JFCBMSGP EQU   JFCBCTRI                                                 01904000
JFCBSPAC EQU   JFCBCTRI                                                 01905000
JFCRUNIT EQU   JFCBPQTY                                                 01906000
JFCBEXAD EQU   JFCBS001+31                                              01907000
JFCBEXTL EQU   JFCBS001+30                                              01908000
JFCMSVGP EQU   JFCBS001+22                                              01909000
@NM00038 EQU   JFCBS001                                                 01910000
JFCAVOLS EQU   JFCBVOLS                                                 01911000
JFCBNTCS EQU   JFCUCSEG+8                                               01912000
JFCSOWA  EQU   JFCOUTLI+1                                               01913000
JFCSEND  EQU   JFCCPRI                                                  01914000
JFCEQUAL EQU   JFCCPRI                                                  01915000
JFCRECV  EQU   JFCCPRI                                                  01916000
JFCRSV34 EQU   JFCCPRI                                                  01917000
JFCRSV33 EQU   JFCCPRI                                                  01918000
JFCRSV55 EQU   JFCCPRI                                                  01919000
JFCRSV54 EQU   JFCCPRI                                                  01920000
JFCRSV53 EQU   JFCCPRI                                                  01921000
JFCRSV27 EQU   JFCUCSOP                                                 01922000
JFCRSV26 EQU   JFCUCSOP                                                 01923000
JFCFCBVR EQU   JFCUCSOP                                                 01924000
JFCFCBAL EQU   JFCUCSOP                                                 01925000
JFCVER   EQU   JFCUCSOP                                                 01926000
JFCRSV25 EQU   JFCUCSOP                                                 01927000
JFCFOLD  EQU   JFCUCSOP                                                 01928000
JFCBEXTP EQU   JFCUCSOP                                                 01929000
JFCUCSID EQU   JFCUCSEG                                                 01930000
JFCINTVL EQU   JFCSPPRT+19                                              01931000
JFCDBUFN EQU   JFCRESRV+3                                               01932000
JFCCYLOF EQU   JFCRESRV+2                                               01933000
JFCRKP   EQU   JFCRESRV                                                 01934000
JFCPCIR2 EQU   JFCPCI                                                   01935000
JFCPCIR1 EQU   JFCPCI                                                   01936000
JFCPCIN2 EQU   JFCPCI                                                   01937000
JFCPCIN1 EQU   JFCPCI                                                   01938000
JFCPCIA2 EQU   JFCPCI                                                   01939000
JFCPCIA1 EQU   JFCPCI                                                   01940000
JFCPCIX2 EQU   JFCPCI                                                   01941000
JFCPCIX1 EQU   JFCPCI                                                   01942000
JFCBUFMX EQU   JFCNCP                                                   01943000
JFCLRECL EQU   JFCAMSYN                                                 01944000
JFCBAXBF EQU   JFCBUFSI                                                 01945000
JFCREL   EQU   JFCREORG                                                 01946000
JFCRSV22 EQU   JFCDEL                                                   01947000
JFCSRCHD EQU   JFCRSV20                                                 01948000
JFCOPTQ  EQU   JFCACT                                                   01949000
JFCFEED  EQU   JFCIND                                                   01950000
JFCCBWU  EQU   JFCEXT                                                   01951000
JFCWUMSG EQU   JFCOVER                                                  01952000
JFCSDNAM EQU   JFCWVCBD                                                 01953000
@NM00037 EQU   JFCRECFM                                                 01954000
JFCCHAR  EQU   JFCRECFM                                                 01955000
JFCRFS   EQU   JFCRECFM                                                 01956000
JFCRFB   EQU   JFCRECFM                                                 01957000
JFCRFO   EQU   JFCRCFM                                                  01958000
JFCFMREC EQU   JFCRCFM                                                  01959000
JFCRSV16 EQU   JFCDSRG2                                                 01960000
JFCRSV15 EQU   JFCDSRG2                                                 01961000
JFCORGTR EQU   JFCDSRG2                                                 01962000
JFCORGAM EQU   JFCDSRG2                                                 01963000
JFCRSV13 EQU   JFCDSRG2                                                 01964000
JFCORGTQ EQU   JFCDSRG2                                                 01965000
JFCORGTX EQU   JFCDSRG2                                                 01966000
JFCORGGS EQU   JFCDSRG2                                                 01967000
JFCORGU  EQU   JFCDSRG1                                                 01968000
JFCORGPO EQU   JFCDSRG1                                                 01969000
JFCORGMQ EQU   JFCDSRG1                                                 01970000
JFCORGCQ EQU   JFCDSRG1                                                 01971000
JFCORGCX EQU   JFCDSRG1                                                 01972000
JFCORGDA EQU   JFCDSRG1                                                 01973000
JFCORGPS EQU   JFCDSRG1                                                 01974000
JFCORGIS EQU   JFCDSRG1                                                 01975000
JFCTRKBL EQU   JFCLIMCT+1                                               01976000
@NM00036 EQU   JFCLIMCT                                                 01977000
JFCDEN   EQU   JFCSPPRT+1                                               01978000
JFCPRTSP EQU   JFCSPPRT                                                 01979000
JFCONE   EQU   JFCMODE                                                  01980000
JFCTWO   EQU   JFCMODE                                                  01981000
JFCRSV07 EQU   JFCMODE                                                  01982000
JFCRSV06 EQU   JFCMODE                                                  01983000
JFCMODER EQU   JFCMODE                                                  01984000
JFCMODEO EQU   JFCMODE                                                  01985000
JFCEBCD  EQU   JFCMODE                                                  01986000
JFCBIN   EQU   JFCMODE                                                  01987000
JFCRSV32 EQU   JFCCODE                                                  01988000
JFCTTY   EQU   JFCCODE                                                  01989000
JFCASCII EQU   JFCCODE                                                  01990000
JFCNCR   EQU   JFCCODE                                                  01991000
JFCBUR   EQU   JFCCODE                                                  01992000
JFCFRI   EQU   JFCCODE                                                  01993000
JFCBCD   EQU   JFCCODE                                                  01994000
JFCNOCON EQU   JFCCODE                                                  01995000
PSARSAV  EQU   PSARSVTE+60                                              01996000
PSARSTK  EQU   PSARSVTE+56                                              01997000
PSAESAV3 EQU   PSARSVTE+52                                              01998000
PSAESTK3 EQU   PSARSVTE+48                                              01999000
PSAESAV2 EQU   PSARSVTE+44                                              02000000
PSAESTK2 EQU   PSARSVTE+40                                              02001000
PSAESAV1 EQU   PSARSVTE+36                                              02002000
PSAESTK1 EQU   PSARSVTE+32                                              02003000
PSAPSAV  EQU   PSARSVTE+28                                              02004000
PSAPSTK  EQU   PSARSVTE+24                                              02005000
PSAMSAV  EQU   PSARSVTE+20                                              02006000
PSAMSTK  EQU   PSARSVTE+16                                              02007000
PSASSAV  EQU   PSARSVTE+12                                              02008000
PSASSTK  EQU   PSARSVTE+8                                               02009000
PSANSTK  EQU   PSARSVTE+4                                               02010000
PSACSTK  EQU   PSARSVTE                                                 02011000
CVTRV628 EQU   CVTS01+728                                               02012000
CVTRV627 EQU   CVTS01+724                                               02013000
CVTRV626 EQU   CVTS01+720                                               02014000
CVTRV625 EQU   CVTS01+716                                               02015000
CVTRV624 EQU   CVTS01+712                                               02016000
CVTRV623 EQU   CVTS01+708                                               02017000
CVTRV622 EQU   CVTS01+704                                               02018000
CVTRV621 EQU   CVTS01+700                                               02019000
CVTIHASU EQU   CVTS01+696                                               02020000
CVTRV619 EQU   CVTS01+692                                               02021000
CVTRV618 EQU   CVTS01+688                                               02022000
CVTRV617 EQU   CVTS01+684                                               02023000
CVTRV616 EQU   CVTS01+680                                               02024000
CVTRV615 EQU   CVTS01+676                                               02025000
CVTRV614 EQU   CVTS01+672                                               02026000
CVTRV613 EQU   CVTS01+668                                               02027000
CVTTCASP EQU   CVTS01+664                                               02028000
CVT0PT03 EQU   CVTS01+660                                               02029000
CVT0PT0E EQU   CVTS01+656                                               02030000
CVTRV609 EQU   CVTS01+652                                               02031000
CVTCGK   EQU   CVTS01+648                                               02032000
CVTRAC   EQU   CVTS01+644                                               02033000
CVTRV606 EQU   CVTS01+640                                               02034000
CVTRV605 EQU   CVTS01+636                                               02035000
CVTRV604 EQU   CVTS01+632                                               02036000
CVTEFF02 EQU   CVTS01+628                                               02037000
CVTCBBR  EQU   CVTS01+624                                               02038000
CVTSSCR  EQU   CVTS01+620                                               02039000
CVTEVENT EQU   CVTS01+616                                               02040000
CVTCRCA  EQU   CVTS01+612                                               02041000
CVTTPIO  EQU   CVTS01+608                                               02042000
CVTADV   EQU   CVTS01+604                                               02043000
CVTGSDAB EQU   CVTGSDA                                                  02044000
CVTQV3   EQU   CVTS01+596                                               02045000
CVTQV2   EQU   CVTS01+592                                               02046000
CVTQV1   EQU   CVTS01+588                                               02047000
CVTRPT   EQU   CVTS01+584                                               02048000
CVTSSRB  EQU   CVTS01+580                                               02049000
CVTCSDRL EQU   CVTS01+576                                               02050000
CVTEXP1  EQU   CVTS01+572                                               02051000
CVTRMPMT EQU   CVTS01+568                                               02052000
CVTRMPTT EQU   CVTS01+564                                               02053000
CVTVPSA  EQU   CVTS01+560                                               02054000
CVTVSTOP EQU   CVTS01+556                                               02055000
CVTGTFR8 EQU   CVTS01+552                                               02056000
CVTQUIT  EQU   CVTS01+548                                               02057000
CVTVACR  EQU   CVTS01+544                                               02058000
CVTWTCB  EQU   CVTS01+540                                               02059000
CVTSTPRS EQU   CVTS01+536                                               02060000
CVT0PT02 EQU   CVTS01+532                                               02061000
CVTDARCM EQU   CVTS01+528                                               02062000
CVTIRECM EQU   CVTS01+524                                               02063000
CVTJRECM EQU   CVTS01+520                                               02064000
CVTVEMS0 EQU   CVTS01+516                                               02065000
CVTSPFRR EQU   CVTS01+512                                               02066000
CVTRLSTG EQU   CVTS01+508                                               02067000
CVT0TC0A EQU   CVTS01+504                                               02068000
CVTGMBR  EQU   CVTS01+500                                               02069000
CVTLFRM  EQU   CVTS01+496                                               02070000
CVTRMBR  EQU   CVTS01+492                                               02071000
CVTVIOP  EQU   CVTS01+488                                               02072000
CVTRV307 EQU   CVTS01+486                                               02073000
CVTRV306 EQU   CVTS01+484                                               02074000
CVTRV305 EQU   CVTS01+482                                               02075000
CVTRV304 EQU   CVTS01+480                                               02076000
CVTRV303 EQU   CVTS01+478                                               02077000
CVTRV302 EQU   CVTS01+476                                               02078000
CVTTRCA  EQU   CVTS01+472                                               02079000
CVTRV297 EQU   CVTRV289                                                 02080000
CVTRV296 EQU   CVTRV289                                                 02081000
CVTRV295 EQU   CVTRV289                                                 02082000
CVTRV294 EQU   CVTRV289                                                 02083000
CVTRV293 EQU   CVTRV289                                                 02084000
CVTRV292 EQU   CVTRV289                                                 02085000
CVTRV291 EQU   CVTRV289                                                 02086000
CVTRV290 EQU   CVTRV289                                                 02087000
CVTRV288 EQU   CVTRV280                                                 02088000
CVTRV287 EQU   CVTRV280                                                 02089000
CVTRV286 EQU   CVTRV280                                                 02090000
CVTRV285 EQU   CVTRV280                                                 02091000
CVTRV284 EQU   CVTRV280                                                 02092000
CVTRV283 EQU   CVTRV280                                                 02093000
CVTRV282 EQU   CVTRV280                                                 02094000
CVTRV281 EQU   CVTRV280                                                 02095000
CVTRV279 EQU   CVTRV271                                                 02096000
CVTRV278 EQU   CVTRV271                                                 02097000
CVTRV277 EQU   CVTRV271                                                 02098000
CVTRV276 EQU   CVTRV271                                                 02099000
CVTRV275 EQU   CVTRV271                                                 02100000
CVTRV274 EQU   CVTRV271                                                 02101000
CVTRV273 EQU   CVTRV271                                                 02102000
CVTRV272 EQU   CVTRV271                                                 02103000
CVTRV270 EQU   CVTRV262                                                 02104000
CVTRV269 EQU   CVTRV262                                                 02105000
CVTRV268 EQU   CVTRV262                                                 02106000
CVTRV267 EQU   CVTRV262                                                 02107000
CVTRV266 EQU   CVTRV262                                                 02108000
CVTRV265 EQU   CVTRV262                                                 02109000
CVTRV264 EQU   CVTRV262                                                 02110000
CVTRV263 EQU   CVTRV262                                                 02111000
CVTVFP   EQU   CVTS01+464                                               02112000
CVTVSI   EQU   CVTS01+460                                               02113000
CVTVPSIB EQU   CVTS01+456                                               02114000
CVTMFACT EQU   CVTMFRTR                                                 02115000
CVTMFCTL EQU   CVTS01+448                                               02116000
CVTPVBP  EQU   CVTS01+444                                               02117000
CVTPWI   EQU   CVTS01+440                                               02118000
CVTRV254 EQU   CVTS01+438                                               02119000
CVTRV253 EQU   CVTS01+436                                               02120000
CVTRV252 EQU   CVTS01+434                                               02121000
CVTRV251 EQU   CVTS01+433                                               02122000
CVTRV250 EQU   CVTS01+432                                               02123000
CVTRV249 EQU   CVTS01+431                                               02124000
CVTRV248 EQU   CVTS01+430                                               02125000
CVTRV247 EQU   CVTS01+429                                               02126000
CVTRV246 EQU   CVTS01+428                                               02127000
CVTRV245 EQU   CVTRV237                                                 02128000
CVTRV244 EQU   CVTRV237                                                 02129000
CVTRV243 EQU   CVTRV237                                                 02130000
CVTRV242 EQU   CVTRV237                                                 02131000
CVTRV241 EQU   CVTRV237                                                 02132000
CVTRV240 EQU   CVTRV237                                                 02133000
CVTRV239 EQU   CVTRV237                                                 02134000
CVTRV238 EQU   CVTRV237                                                 02135000
CVTRV236 EQU   CVTRV228                                                 02136000
CVTRV235 EQU   CVTRV228                                                 02137000
CVTRV234 EQU   CVTRV228                                                 02138000
CVTRV233 EQU   CVTRV228                                                 02139000
CVTRV232 EQU   CVTRV228                                                 02140000
CVTRV231 EQU   CVTRV228                                                 02141000
CVTRV230 EQU   CVTRV228                                                 02142000
CVTRV229 EQU   CVTRV228                                                 02143000
CVTRV227 EQU   CVTRV219                                                 02144000
CVTRV226 EQU   CVTRV219                                                 02145000
CVTRV225 EQU   CVTRV219                                                 02146000
CVTRV224 EQU   CVTRV219                                                 02147000
CVTRV223 EQU   CVTRV219                                                 02148000
CVTRV222 EQU   CVTRV219                                                 02149000
CVTRV221 EQU   CVTRV219                                                 02150000
CVTRV220 EQU   CVTRV219                                                 02151000
CVTRV218 EQU   CVTRV210                                                 02152000
CVTRV217 EQU   CVTRV210                                                 02153000
CVTRV216 EQU   CVTRV210                                                 02154000
CVTRV215 EQU   CVTRV210                                                 02155000
CVTRV214 EQU   CVTRV210                                                 02156000
CVTRV213 EQU   CVTRV210                                                 02157000
CVTRV212 EQU   CVTRV210                                                 02158000
CVTRV211 EQU   CVTRV210                                                 02159000
CVTLCCAT EQU   CVTS01+420                                               02160000
CVTPCCAT EQU   CVTS01+416                                               02161000
CVTIPCRP EQU   CVTS01+412                                               02162000
CVTIPCRI EQU   CVTS01+408                                               02163000
CVTIPCDS EQU   CVTS01+404                                               02164000
CVTAIDVT EQU   CVTS01+400                                               02165000
CVTSSAP  EQU   CVTS01+396                                               02166000
CVTEHCIR EQU   CVTS01+392                                               02167000
CVTEHDEF EQU   CVTS01+388                                               02168000
CVTDAIR  EQU   CVTS01+384                                               02169000
CVTPERFM EQU   CVTS01+380                                               02170000
CVT044R2 EQU   CVTS01+376                                               02171000
CVTFETCH EQU   CVTS01+372                                               02172000
CVTRSTWD EQU   CVTS01+368                                               02173000
CVTSPOST EQU   CVTS01+364                                               02174000
CVTIOBP  EQU   CVTS01+360                                               02175000
CVTASMVT EQU   CVTS01+356                                               02176000
CVTRECRQ EQU   CVTS01+352                                               02177000
CVTWSAC  EQU   CVTS01+348                                               02178000
CVTRV149 EQU   CVTS01+344                                               02179000
CVTWSAL  EQU   CVTS01+340                                               02180000
CVTSPSA  EQU   CVTS01+336                                               02181000
CVTGLMN  EQU   CVTS01+332                                               02182000
CVTVEAC0 EQU   CVTS01+328                                               02183000
CVT062R1 EQU   CVTS01+324                                               02184000
CVTRPOST EQU   CVTS01+320                                               02185000
CVTDQIQE EQU   CVTS01+316                                               02186000
CVTCSD   EQU   CVTS01+312                                               02187000
CVTLKRMA EQU   CVTS01+308                                               02188000
CVTRSPIE EQU   CVTS01+304                                               02189000
CVTRENQ  EQU   CVTS01+300                                               02190000
CVTLQCB  EQU   CVTS01+296                                               02191000
CVTFQCB  EQU   CVTS01+292                                               02192000
CVTQCS01 EQU   CVTS01+288                                               02193000
CVTAPFT  EQU   CVTS01+284                                               02194000
CVTPARRL EQU   CVTS01+280                                               02195000
CVTVWAIT EQU   CVTS01+276                                               02196000
CVTGSPL  EQU   CVTS01+272                                               02197000
CVTLSMQ  EQU   CVTS01+268                                               02198000
CVTGSMQ  EQU   CVTS01+264                                               02199000
CVTEXPRO EQU   CVTS01+260                                               02200000
CVTOPCTP EQU   CVTS01+256                                               02201000
CVTSIC   EQU   CVTS01+252                                               02202000
CVTTPIOS EQU   CVTS01+248                                               02203000
CVTRTMS  EQU   CVTS01+244                                               02204000
CVTSDBF  EQU   CVTS01+240                                               02205000
CVTSCBP  EQU   CVTS01+236                                               02206000
CVTSDMP  EQU   CVTS01+232                                               02207000
CVTSV60  EQU   CVTS01+228                                               02208000
CVTRTMCT EQU   CVTS01+224                                               02209000
CVTASCBL EQU   CVTS01+220                                               02210000
CVTASCBH EQU   CVTS01+216                                               02211000
CVTGDA   EQU   CVTS01+212                                               02212000
CVTASVT  EQU   CVTS01+208                                               02213000
CVTVVMDI EQU   CVTS01+204                                               02214000
CVTAQTOP EQU   CVTS01+200                                               02215000
CVTIOSCS EQU   CVTS01+196                                               02216000
CVTSDRM  EQU   CVTS01+192                                               02217000
CVTOPTE  EQU   CVTS01+188                                               02218000
CVTSTXU  EQU   CVTS01+184                                               02219000
CVTQUIS  EQU   CVTS01+180                                               02220000
CVTPARS  EQU   CVTS01+176                                               02221000
CVTS1EE  EQU   CVTS01+172                                               02222000
CVTFRAS  EQU   CVTS01+168                                               02223000
CVTQSAS  EQU   CVTS01+164                                               02224000
CVTCRAS  EQU   CVTS01+160                                               02225000
CVTCRMN  EQU   CVTS01+156                                               02226000
CVTDELCP EQU   CVTS01+152                                               02227000
CVTFRECL EQU   CVTS01+148                                               02228000
CVTGETCL EQU   CVTS01+144                                               02229000
CVTBLDCP EQU   CVTS01+140                                               02230000
CVTAUTHL EQU   CVTS01+136                                               02231000
CVTSCAN  EQU   CVTS01+132                                               02232000
CVTRV144 EQU   CVTS01+130                                               02233000
CVTMAXMP EQU   CVTS01+128                                               02234000
CVTSTCK  EQU   CVTS01+124                                               02235000
CVTRV139 EQU   CVTS01+123                                               02236000
CVTDSSAC EQU   CVTS01+122                                               02237000
CVTRV513 EQU   CVTS01+121                                               02238000
CVTIOSPL EQU   CVTS01+120                                               02239000
CVTPTGT  EQU   CVTS01+116                                               02240000
CVTCSPIE EQU   CVTS01+112                                               02241000
CVTSMFEX EQU   CVTS01+108                                               02242000
CVTOLT0A EQU   CVTS01+104                                               02243000
CVTSRBRT EQU   CVTS01+100                                               02244000
CVTPUTL  EQU   CVTS01+96                                                02245000
CVTASCRL EQU   CVTS01+92                                                02246000
CVTASCRF EQU   CVTS01+88                                                02247000
CVTRV326 EQU   CVTS01+84                                                02248000
CVTRV325 EQU   CVTS01+80                                                02249000
CVTRV324 EQU   CVTS01+76                                                02250000
CVT0VL01 EQU   CVTS01+72                                                02251000
CVTSHRVM EQU   CVTS01+68                                                02252000
CVTRV332 EQU   CVTS01+64                                                02253000
CVTTAS   EQU   CVTS01+60                                                02254000
CVTRSCN  EQU   CVTS01+56                                                02255000
CVTTRAC2 EQU   CVTS01+54                                                02256000
CVTTRACE EQU   CVTS01+52                                                02257000
CVTAPG   EQU   CVTS01+51                                                02258000
CVTSDTRC EQU   CVTCTLFG                                                 02259000
CVTGTRCE EQU   CVTCTLFG                                                 02260000
CVTNOMP  EQU   CVTCTLFG                                                 02261000
CVTRSV79 EQU   CVTCTLFG                                                 02262000
CVTDSTAT EQU   CVTCTLFG                                                 02263000
CVTRSV78 EQU   CVTCTLFG                                                 02264000
CVTRV333 EQU   CVTCTLFG                                                 02265000
CVTRV323 EQU   CVTCTLFG                                                 02266000
CVTSPVLK EQU   CVTS01+49                                                02267000
CVTRSV77 EQU   CVTS01+48                                                02268000
CVTRV331 EQU   CVTS01+44                                                02269000
CVTRV330 EQU   CVTS01+40                                                02270000
CVTRV329 EQU   CVTS01+36                                                02271000
CVTRV328 EQU   CVTS01+32                                                02272000
CVTRV322 EQU   CVTS01+28                                                02273000
CVTSLID  EQU   CVTSLIDA+1                                               02274000
CVTSYLK  EQU   CVTSLIDA                                                 02275000
CVTRV321 EQU   CVTS01+20                                                02276000
CVTRV320 EQU   CVTS01+16                                                02277000
CVTLPDIR EQU   CVTLPDIA+1                                               02278000
CVTRSV69 EQU   CVTDIRST                                                 02279000
CVTRSV68 EQU   CVTDIRST                                                 02280000
CVTRSV67 EQU   CVTDIRST                                                 02281000
CVTRSV66 EQU   CVTDIRST                                                 02282000
CVTRSV65 EQU   CVTDIRST                                                 02283000
CVTRSV64 EQU   CVTDIRST                                                 02284000
CVTRSV63 EQU   CVTDIRST                                                 02285000
CVTDICOM EQU   CVTDIRST                                                 02286000
CVTPVTP  EQU   CVTS01+8                                                 02287000
CVTLPDSR EQU   CVTS01+4                                                 02288000
CVTGETL  EQU   CVTS01                                                   02289000
SELUNUSE EQU   SELRB+64                                                 02290000
SELUNUS2 EQU   SELRB+48                                                 02291000
SELRFDDN EQU   SELRB+46                                                 02292000
SELDDCAT EQU   SELRB+42                                                 02293000
SELUNUS1 EQU   SELRB+41                                                 02294000
SELSTNUM EQU   SELRB+40                                                 02295000
SELDDNAM EQU   SELRB+32                                                 02296000
SELJOBNM EQU   SELRB+24                                                 02297000
SELNOVSL EQU   SELFLGS2                                                 02298000
SELRPRIV EQU   SELFLGS2                                                 02299000
SELCNTWT EQU   SELFLGS2                                                 02300000
SELUNSEP EQU   SELFLGS2                                                 02301000
SELSUBAL EQU   SELFLGS2                                                 02302000
SELSCSPL EQU   SELFLGS2                                                 02303000
SELPRSPL EQU   SELFLGS2                                                 02304000
SELMXESO EQU   SELFLGS1                                                 02305000
SELVRGRP EQU   SELFLGS1                                                 02306000
SELVRNEW EQU   SELFLGS1                                                 02307000
SELVOLRF EQU   SELFLGS1                                                 02308000
SELVENQV EQU   SELFLGS1                                                 02309000
SELSEPVL EQU   SELFLGS1                                                 02310000
SELRBOPC EQU   SELRB+4                                                  02311000
SELRBLEN EQU   SELRB                                                    02312000
VOLNUM   EQU   VOLRT+2                                                  02313000
GRPPRMSP EQU   GRPPR+10                                                 02314000
GRPSLOTN EQU   GRPPR+9                                                  02315000
GRPEXTIN EQU   GRPPR+8                                                  02316000
GRPNAME  EQU   GRPPR                                                    02317000
@NM00050 EQU   BFMISCFL+1                                               02318000
BFMTDOTH EQU   BFMISCFL+1                                               02319000
BFNOTMTD EQU   BFMISCFL+1                                               02320000
BFENQUED EQU   BFMISCFL                                                 02321000
BFNOENQ  EQU   BFMISCFL                                                 02322000
BFVOLREJ EQU   BFMISCFL                                                 02323000
BFJESOK  EQU   BFMISCFL                                                 02324000
BFSELSEC EQU   BFMISCFL                                                 02325000
BFSELPRI EQU   BFMISCFL                                                 02326000
BFBADSEC EQU   BFMISCFL                                                 02327000
BFBADPRI EQU   BFMISCFL                                                 02328000
@NM00049 EQU   BFLPFLGS                                                 02329000
BFVOLEXP EQU   BFSLOT+10                                                02330000
BFOVERUS EQU   BFSLOT+9                                                 02331000
@NM00048 EQU   BFHPFLGS                                                 02332000
BFHRSKFL EQU   BFHPFLGS                                                 02333000
BFGRPSLT EQU   BFSLOT+7                                                 02334000
BFGRPIDX EQU   BFSLOT+6                                                 02335000
@NM00047 EQU   BFREQFLS                                                 02336000
BFGROUP  EQU   BFHEADER+2                                               02337000
BFLEN    EQU   BFHEADER                                                 02338000
@NM00046 EQU   TABHDRET+2                                               02339000
@NM00045 EQU   TABP+1                                                   02340000
@NM00044 EQU   TABFLAGS                                                 02341000
TABFFREE EQU   TABFLAGS                                                 02342000
TABFUTRM EQU   TABFLAGS                                                 02343000
@NM00043 EQU   STPDDFLG                                                 02344000
STPDDSPL EQU   STPDDFLG                                                 02345000
STPDDGPS EQU   STPDDENT+21                                              02346000
STPDDGPI EQU   STPDDENT+20                                              02347000
@NM00042 EQU   STPFLAGS                                                 02348000
STPNOFRE EQU   STPFLAGS                                                 02349000
@NM00041 EQU   JFCBX+144                                                02350000
JFCBXDEV EQU   JFCBX+140                                                02351000
JFCBXNAM EQU   JFCBX+96                                                 02352000
@NM00040 EQU   JFCBX+94                                                 02353000
@NM00039 EQU   JFCBX+3                                                  02354000
JFCBXTTR EQU   JFCBX                                                    02355000
JFCRSV05 EQU   JFCEROPT                                                 02356000
JFCRSV04 EQU   JFCEROPT                                                 02357000
JFCRSV03 EQU   JFCEROPT                                                 02358000
JFCRSV02 EQU   JFCEROPT                                                 02359000
JFCTOPT  EQU   JFCEROPT                                                 02360000
JFCABN   EQU   JFCEROPT                                                 02361000
JFCSKP   EQU   JFCEROPT                                                 02362000
JFCACC   EQU   JFCEROPT                                                 02363000
JFCBUFL  EQU   JFCAMPTR+2                                               02364000
JFCFWORD EQU   JFCBFTEK                                                 02365000
JFCDWORD EQU   JFCBFTEK                                                 02366000
JFCHIER1 EQU   JFCBFTEK                                                 02367000
JFCDYN   EQU   JFCBFTEK                                                 02368000
JFCEXC   EQU   JFCBFTEK                                                 02369000
JFCBBFTR EQU   JFCBBFTA                                                 02370000
JFCSIM   EQU   JFCBBFTA                                                 02371000
JFCHIER  EQU   JFCBFTEK                                                 02372000
JFCBFOUT EQU   JFCBUFNO                                                 02373000
JFCBUFIN EQU   JFCBUFNO                                                 02374000
JFCTEMP  EQU   JFCBIND2                                                 02375000
JFCREQ   EQU   JFCBIND2                                                 02376000
JFCENT   EQU   JFCBIND2                                                 02377000
JFCSHARE EQU   JFCBIND2                                                 02378000
JFCSECUR EQU   JFCBIND2                                                 02379000
JFCDISP  EQU   JFCBIND2                                                 02380000
JFCPDS   EQU   JFCBIND1                                                 02381000
JFCGDG   EQU   JFCBIND1                                                 02382000
JFCADDED EQU   JFCBIND1                                                 02383000
JFCLOC   EQU   JFCBIND1                                                 02384000
JFCRLSE  EQU   JFCBIND1                                                 02385000
JFCBXPDT EQU   INFMJFCB+83                                              02386000
JFCBCRDT EQU   INFMJFCB+80                                              02387000
JFCBOPS2 EQU   JFCBMASK+7                                               02388000
JFCRCTLG EQU   JFCBFLG2                                                 02389000
JFCBBUFF EQU   JFCBFLG2                                                 02390000
JFCTRACE EQU   JFCBFLG2                                                 02391000
JFCSDRPS EQU   JFCBFLG2                                                 02392000
JFCMODNW EQU   JFCBFLG2                                                 02393000
JFCNRPS  EQU   JFCDEFER                                                 02394000
JFCOUTOP EQU   JFCBFLG2                                                 02395000
JFCINOP  EQU   JFCBFLG2                                                 02396000
JFCBPWBP EQU   JFCOPEN                                                  02397000
@NM00035 EQU   JFCOPEN                                                  02398000
JFCDUAL  EQU   JFCBFLG1                                                 02399000
JFCSLDES EQU   JFCBFLG1                                                 02400000
JFCSLCRE EQU   JFCBFLG1                                                 02401000
JFCSTAND EQU   JFCBFLG1                                                 02402000
JFCBOPS1 EQU   JFCBMASK                                                 02403000
JFCBVLSQ EQU   INFMJFCB+70                                              02404000
JFCRSV31 EQU   JFCFUNC                                                  02405000
JFCFNCBT EQU   JFCFUNC                                                  02406000
JFCFNCBX EQU   JFCFUNC                                                  02407000
JFCFNCBD EQU   JFCFUNC                                                  02408000
JFCFNCBW EQU   JFCFUNC                                                  02409000
JFCFNCBP EQU   JFCFUNC                                                  02410000
JFCFNCBR EQU   JFCFUNC                                                  02411000
JFCFNCBI EQU   JFCFUNC                                                  02412000
JFCBFOFL EQU   JFCBUFOF                                                 02413000
JFCNL    EQU   JFCBLTYP                                                 02414000
JFCSL    EQU   JFCBLTYP                                                 02415000
JFCNSL   EQU   JFCBLTYP                                                 02416000
JFCSUL   EQU   JFCBLTYP                                                 02417000
JFCBLP   EQU   JFCBLTYP                                                 02418000
JFCBLTM  EQU   JFCBLTYP                                                 02419000
JFCBAL   EQU   JFCBLTYP                                                 02420000
JFCRSV38 EQU   JFCBLTYP                                                 02421000
JFCVINDX EQU   INFMJFCB+64                                              02422000
JFCNLREC EQU   INFMJFCB+62                                              02423000
JFCBADBF EQU   INFMJFCB+60                                              02424000
JFCAMSTR EQU   JFCBFRID+2                                               02425000
JFCAMCRO EQU   JFCBFRID                                                 02426000
JFCBDSCB EQU   INFMJFCB+53                                              02427000
JFCPAT   EQU   JFCBTSDM                                                 02428000
JFCNDCB  EQU   JFCBTSDM                                                 02429000
JFCNDSCB EQU   JFCBTSDM                                                 02430000
JFCNWRIT EQU   JFCBTSDM                                                 02431000
JFCTTR   EQU   JFCBTSDM                                                 02432000
JFCSDS   EQU   JFCBTSDM                                                 02433000
JFCVSL   EQU   JFCBTSDM                                                 02434000
JFCCAT   EQU   JFCBTSDM                                                 02435000
JFCIPLTX EQU   JFCBELNM                                                 02436000
JFCBQNAM EQU   JFCBDSNM                                                 02437000
RPLVUTIL EQU   RPLV+132                                                 02438000
RPLVBLN  EQU   RPLVSAM+52                                               02439000
RPLVRLN  EQU   RPLVSAM+48                                               02440000
@NM00034 EQU   RPLVSAM+44                                               02441000
RPLVUPD  EQU   RPLVOPT+1                                                02442000
@NM00033 EQU   RPLVOPT                                                  02443000
RPLVKGE  EQU   RPLVOPT                                                  02444000
@NM00032 EQU   RPLVOPT                                                  02445000
RPLVNEXT EQU   RPLVOPT                                                  02446000
RPLVDIR  EQU   RPLVOPT                                                  02447000
RPLVLOC  EQU   RPLVOPT                                                  02448000
RPLVKEY  EQU   RPLVSAM+36                                               02449000
RPLVBUF  EQU   RPLVSAM+32                                               02450000
@NM00031 EQU   RPLVSAM+28                                               02451000
RPLVACB  EQU   RPLVSAM+24                                               02452000
@NM00030 EQU   RPLVSAM+3                                                02453000
RPLVTYP  EQU   RPLVSAM+2                                                02454000
@NM00029 EQU   RPLVSAM                                                  02455000
@NM00028 EQU   RPLV+38                                                  02456000
RPLRMSCC EQU   RPLV+36                                                  02457000
RPLVRETC EQU   RPLV+34                                                  02458000
RPLRCODE EQU   RPLV+32                                                  02459000
RPLVTLEN EQU   RPLV+30                                                  02460000
RPLVRES1 EQU   RPLFLAGA+1                                               02461000
RPLVJRNL EQU   RPLFLAGA                                                 02462000
RPLJRCVY EQU   RPLFLAGA                                                 02463000
RPLVVOP  EQU   RPLFLAGA                                                 02464000
RPLVVIN  EQU   RPLFLAGA                                                 02465000
RPLVCOMP EQU   RPLFLAGA                                                 02466000
RPLVPROG EQU   RPLFLAGA                                                 02467000
RPLVPOST EQU   RPLFLAGA                                                 02468000
RPLFTIME EQU   RPLFLAGA                                                 02469000
RPLVRSV3 EQU   RPLV+24                                                  02470000
RPLVRSV2 EQU   RPLV+20                                                  02471000
RPLVRSV1 EQU   RPLV+16                                                  02472000
RPLVVICB EQU   RPLV+12                                                  02473000
RPLASCBP EQU   RPLTCBPR                                                 02474000
RPLVECB  EQU   RPLV+4                                                   02475000
RPLVQPTR EQU   RPLV                                                     02476000
VVIUNUSD EQU   VVICB+116                                                02477000
VVINUSDC EQU   VVICB+112                                                02478000
VVITPFCH EQU   VVICB+108                                                02479000
VVIDVMEL EQU   VVICB+104                                                02480000
VVIVBSTF EQU   VVICB+100                                                02481000
VVISSOBA EQU   VVICB+96                                                 02482000
VVIVSCRA EQU   VVICB+92                                                 02483000
VVIDVMTA EQU   VVICB+84                                                 02484000
VVIJUCB  EQU   VVICB+80                                                 02485000
VVIIUCB  EQU   VVICB+76                                                 02486000
VVIRES6  EQU   VVICB+72                                                 02487000
VVIRES5  EQU   VVICB+68                                                 02488000
VVIRES4  EQU   VVICB+64                                                 02489000
VVIUCB   EQU   VVICB+60                                                 02490000
VVIVJL   EQU   VVICB+56                                                 02491000
VVIVRR   EQU   VVICB+52                                                 02492000
VVIQLSPL EQU   VVICB+48                                                 02493000
VVIQRPL2 EQU   VVICB+44                                                 02494000
VVIQRPL1 EQU   VVICB+40                                                 02495000
VVIRES3  EQU   VVICB+36                                                 02496000
VVIVQMP  EQU   VVICB+32                                                 02497000
VVIECB1  EQU   VVICB+28                                                 02498000
VVICATAD EQU   VVICB+24                                                 02499000
VVIDCBAD EQU   VVICB+20                                                 02500000
VVIACBAD EQU   VVICB+16                                                 02501000
VVIFLG5  EQU   VVIFLGA                                                  02502000
VVIFLG4  EQU   VVIFLGA                                                  02503000
VVIFLG3  EQU   VVIFLGA                                                  02504000
VVIFLG2  EQU   VVIFLGA                                                  02505000
VVIFLG1  EQU   VVIFLGA                                                  02506000
VVIFLG0  EQU   VVIFLGA                                                  02507000
VVIALCON EQU   VVICB+14                                                 02508000
VVICPUID EQU   VVICB+12                                                 02509000
VVIUCAT  EQU   VVICB+4                                                  02510000
VVICID   EQU   VVICB                                                    02511000
ICBCPUID EQU   ICB2SSCB+496                                             02512000
ICBLORD  EQU   ICBTRACE+256                                             02513000
ICBOTRC  EQU   ICBTRACE                                                 02514000
ICBFAB   EQU   ICB2SSCB+108                                             02515000
ICBMSSC  EQU   ICB2SSCB+104                                             02516000
ICBRSVP  EQU   ICB2SSCB+100                                             02517000
ICBAEAP  EQU   ICB2SSCB+96                                              02518000
ICBSIOBP EQU   ICB2SSCB+92                                              02519000
ICBIATNA EQU   ICB2SSCB+88                                              02520000
ICBIPRGA EQU   ICB2SSCB+84                                              02521000
ICBSRBP  EQU   ICB2SSCB+80                                              02522000
ICBVVIC  EQU   ICB2SSCB+72                                              02523000
ICBSIOP  EQU   ICB2SSCB+68                                              02524000
ICBMEP   EQU   ICB2SSCB+64                                              02525000
ICBIORCI EQU   ICB2SSCB+60                                              02526000
ICB2ACTP EQU   ICB2SSCB+56                                              02527000
ICBSAMP  EQU   ICBFLG+2                                                 02528000
ICBFG2   EQU   ICBFLG+1                                                 02529000
@NM00027 EQU   ICBFG1                                                   02530000
ICBMSCA  EQU   ICBFG1                                                   02531000
ICBMSCMP EQU   ICBFG1                                                   02532000
ICBS     EQU   ICBFG1                                                   02533000
ICBB     EQU   ICBFG1                                                   02534000
ICBV     EQU   ICBFG1                                                   02535000
ICBR     EQU   ICBFG1                                                   02536000
ICBI     EQU   ICBFG1                                                   02537000
ICBNVT   EQU   ICBOPT                                                   02538000
ICBVN02P EQU   ICB2SSCB+44                                              02539000
ICBTCB   EQU   ICB2SSCB+40                                              02540000
ICBQHEAD EQU   ICB2SSCB+36                                              02541000
ICBAUCB  EQU   ICB2SSCB+32                                              02542000
ICBPUCB  EQU   ICB2SSCB+28                                              02543000
ICBCOMQ  EQU   ICB2SSCB+24                                              02544000
ICBIOR   EQU   ICB2SSCB+20                                              02545000
ICBCOM   EQU   ICB2SSCB+16                                              02546000
ICBACTV  EQU   ICB2SSCB+12                                              02547000
ICBECB   EQU   ICB2SSCB+8                                               02548000
ICBSSNAM EQU   ICB2SSCB                                                 02549000
CVTLEVL  EQU   CVTRELNO+2                                               02550000
CVTNUMB  EQU   CVTRELNO                                                 02551000
CVTMDL   EQU   CVTFIX+250                                               02552000
@NM00002 EQU   CVTFIX+248                                               02553000
@NM00001 EQU   CVTFIX                                                   02554000
CVTRV482 EQU   CVTXTNT2+128                                             02555000
CVTRV481 EQU   CVTXTNT2+124                                             02556000
CVTRV480 EQU   CVTXTNT2+120                                             02557000
CVTRV479 EQU   CVTXTNT2+118                                             02558000
CVTRV478 EQU   CVTXTNT2+117                                             02559000
CVTRV477 EQU   CVTXTNT2+116                                             02560000
CVTRV476 EQU   CVTXTNT2+115                                             02561000
CVTRV475 EQU   CVTXTNT2+114                                             02562000
CVTRV474 EQU   CVTRV466                                                 02563000
CVTRV473 EQU   CVTRV466                                                 02564000
CVTRV472 EQU   CVTRV466                                                 02565000
CVTRV471 EQU   CVTRV466                                                 02566000
CVTRV470 EQU   CVTRV466                                                 02567000
CVTRV469 EQU   CVTRV466                                                 02568000
CVTRV468 EQU   CVTRV466                                                 02569000
CVTRV467 EQU   CVTRV466                                                 02570000
CVTRV465 EQU   CVTRV457                                                 02571000
CVTRV464 EQU   CVTRV457                                                 02572000
CVTRV463 EQU   CVTRV457                                                 02573000
CVTRV462 EQU   CVTRV457                                                 02574000
CVTRV461 EQU   CVTRV457                                                 02575000
CVTRV460 EQU   CVTRV457                                                 02576000
CVTRV459 EQU   CVTRV457                                                 02577000
CVTRV458 EQU   CVTRV457                                                 02578000
CVTRV456 EQU   CVTXTNT2+108                                             02579000
CVTRV455 EQU   CVTXTNT2+104                                             02580000
CVTRV454 EQU   CVTXTNT2+100                                             02581000
CVTRV453 EQU   CVTXTNT2+96                                              02582000
CVTRV452 EQU   CVTXTNT2+94                                              02583000
CVTRV451 EQU   CVTXTNT2+92                                              02584000
CVTRV450 EQU   CVTXTNT2+90                                              02585000
CVTRV449 EQU   CVTXTNT2+88                                              02586000
CVTRV448 EQU   CVTXTNT2+87                                              02587000
CVTRV447 EQU   CVTXTNT2+86                                              02588000
CVTRV446 EQU   CVTRV438                                                 02589000
CVTRV445 EQU   CVTRV438                                                 02590000
CVTRV444 EQU   CVTRV438                                                 02591000
CVTRV443 EQU   CVTRV438                                                 02592000
CVTRV442 EQU   CVTRV438                                                 02593000
CVTRV441 EQU   CVTRV438                                                 02594000
CVTRV440 EQU   CVTRV438                                                 02595000
CVTRV439 EQU   CVTRV438                                                 02596000
CVTRV437 EQU   CVTRV429                                                 02597000
CVTRV436 EQU   CVTRV429                                                 02598000
CVTRV435 EQU   CVTRV429                                                 02599000
CVTRV434 EQU   CVTRV429                                                 02600000
CVTRV433 EQU   CVTRV429                                                 02601000
CVTRV432 EQU   CVTRV429                                                 02602000
CVTRV431 EQU   CVTRV429                                                 02603000
CVTRV430 EQU   CVTRV429                                                 02604000
CVTRV428 EQU   CVTXTNT2+80                                              02605000
CVTRV427 EQU   CVTXTNT2+76                                              02606000
CVTRV426 EQU   CVTXTNT2+72                                              02607000
CVTRV425 EQU   CVTXTNT2+68                                              02608000
CVTATACT EQU   CVTATCVT                                                 02609000
CVTRV423 EQU   CVTXTNT2+62                                              02610000
CVTRV422 EQU   CVTXTNT2+60                                              02611000
CVTRV421 EQU   CVTXTNT2+58                                              02612000
CVTRV420 EQU   CVTXTNT2+56                                              02613000
CVTRV419 EQU   CVTXTNT2+55                                              02614000
CVTRV418 EQU   CVTXTNT2+54                                              02615000
CVTRV417 EQU   CVTRV409                                                 02616000
CVTRV416 EQU   CVTRV409                                                 02617000
CVTRV415 EQU   CVTRV409                                                 02618000
CVTRV414 EQU   CVTRV409                                                 02619000
CVTRV413 EQU   CVTRV409                                                 02620000
CVTRV412 EQU   CVTRV409                                                 02621000
CVTRV411 EQU   CVTRV409                                                 02622000
CVTRV410 EQU   CVTRV409                                                 02623000
CVTRV408 EQU   CVTRV400                                                 02624000
CVTRV407 EQU   CVTRV400                                                 02625000
CVTRV406 EQU   CVTRV400                                                 02626000
CVTRV405 EQU   CVTRV400                                                 02627000
CVTRV404 EQU   CVTRV400                                                 02628000
CVTRV403 EQU   CVTRV400                                                 02629000
CVTRV402 EQU   CVTRV400                                                 02630000
CVTRV401 EQU   CVTRV400                                                 02631000
CVTSKTA  EQU   CVTXTNT2+44                                              02632000
CVTRSV99 EQU   CVTXTNT2+40                                              02633000
CVTRSV98 EQU   CVTXTNT2+36                                              02634000
CVTRSV97 EQU   CVTXTNT2+34                                              02635000
CVTRSV96 EQU   CVTXTNT2+32                                              02636000
CVTOLTEP EQU   CVTXTNT2+28                                              02637000
CVTQIDA  EQU   CVTQID+1                                                 02638000
CVTRSV95 EQU   CVTQID                                                   02639000
CVTRSV94 EQU   CVTXTNT2+20                                              02640000
CVTRSV93 EQU   CVTXTNT2+16                                              02641000
CVTRSV92 EQU   CVTXTNT2+12                                              02642000
CVTDEBVR EQU   CVTXTNT2+8                                               02643000
CVTRSV91 EQU   CVTXTNT2+6                                               02644000
CVTRSV9H EQU   CVTFLGBT                                                 02645000
CVTRSV9G EQU   CVTFLGBT                                                 02646000
CVTRSV9F EQU   CVTFLGBT                                                 02647000
CVTRSV9E EQU   CVTFLGBT                                                 02648000
CVTRSV9D EQU   CVTFLGBT                                                 02649000
CVTRSV9C EQU   CVTFLGBT                                                 02650000
CVTVME   EQU   CVTFLGBT                                                 02651000
CVTNPE   EQU   CVTFLGBT                                                 02652000
CVTNUCLS EQU   CVTXTNT2+4                                               02653000
CVTDSSVA EQU   CVTDSSV+1                                                02654000
CVTRSV89 EQU   CVTDSSV                                                  02655000
CVTRSV88 EQU   CVTXTNT1+8                                               02656000
CVTRSV87 EQU   CVTXTNT1+4                                               02657000
CVTFACHN EQU   CVTXTNT1                                                 02658000
CVTRV488 EQU   CVTMAP+412                                               02659000
CVTRV487 EQU   CVTMAP+408                                               02660000
CVTRV486 EQU   CVTMAP+404                                               02661000
CVTRV485 EQU   CVTMAP+400                                               02662000
CVTACTAP EQU   CVTMAP+396                                               02663000
CVTAUTH  EQU   CVTMAP+392                                               02664000
CVTATMCA EQU   CVTATMCT+1                                               02665000
CVTATMST EQU   CVTATMCT                                                 02666000
CVTRSV61 EQU   CVTMAP+384                                               02667000
CVTVOLT1 EQU   CVTVOLM1+1                                               02668000
CVTVOLI1 EQU   CVTVOLF1                                                 02669000
CVTSTOA  EQU   CVTMAP+376                                               02670000
CVTRSV58 EQU   CVTMAP+374                                               02671000
CVTRSV57 EQU   CVTMAP+372                                               02672000
CVTDDCE  EQU   CVTMAP+368                                               02673000
CVTPNWFR EQU   CVTMAP+364                                               02674000
CVTSMF   EQU   CVTMAP+360                                               02675000
CVTSULK  EQU   CVTMAP+358                                               02676000
CVTSLKO  EQU   CVTSYSK                                                  02677000
CVTSLKP  EQU   CVTSYSK                                                  02678000
CVTSLKQ  EQU   CVTSYSK                                                  02679000
CVTSLKR  EQU   CVTSYSK                                                  02680000
CVTRSV56 EQU   CVTSYSK                                                  02681000
CVTRSV55 EQU   CVTSYSK                                                  02682000
CVTRSV54 EQU   CVTSYSK                                                  02683000
CVTRSV53 EQU   CVTSYSK                                                  02684000
CVTRSV52 EQU   CVTA1F1                                                  02685000
CVTRSV51 EQU   CVTA1F1                                                  02686000
CVTRSV50 EQU   CVTA1F1                                                  02687000
CVTRSV49 EQU   CVTA1F1                                                  02688000
CVTRSV48 EQU   CVTA1F1                                                  02689000
CVTRSV47 EQU   CVTA1F1                                                  02690000
CVTSRSW  EQU   CVTA1F1                                                  02691000
CVTPFSW  EQU   CVTA1F1                                                  02692000
CVTPCVT  EQU   CVTMAP+352                                               02693000
CVTRSV46 EQU   CVTMAP+344                                               02694000
CVTRSV45 EQU   CVTMAP+340                                               02695000
CVTRSV44 EQU   CVTMAP+338                                               02696000
CVTRSV43 EQU   CVTMAP+336                                               02697000
CVTHJESA EQU   CVTHJES+1                                                02698000
CVTRSV42 EQU   CVTHJES                                                  02699000
CVTEXT2A EQU   CVTEXT2+1                                                02700000
CVTRSV41 EQU   CVTEXT2                                                  02701000
CVTAPFA  EQU   CVTAPF+1                                                 02702000
CVTRSV40 EQU   CVTAPF                                                   02703000
CVTRV518 EQU   CVTINTLA                                                 02704000
CVTRV517 EQU   CVTERPV                                                  02705000
CVTEORM  EQU   CVTMAP+312                                               02706000
CVTMCHPR EQU   CVTMAP+308                                               02707000
CVTTZ    EQU   CVTMAP+304                                               02708000
CVTJEPS  EQU   CVTMAP+300                                               02709000
CVTJESCT EQU   CVTMAP+296                                               02710000
CVTMODE  EQU   CVTMAP+292                                               02711000
CVTPTRV  EQU   CVTMAP+288                                               02712000
CVTREAL  EQU   CVTMAP+284                                               02713000
CVTRSV39 EQU   CVTMAP+280                                               02714000
CVTRSV38 EQU   CVTMAP+276                                               02715000
CVTDMSRA EQU   CVTDMSR+1                                                02716000
CVTRV634 EQU   CVTDMSRF                                                 02717000
CVTRV633 EQU   CVTDMSRF                                                 02718000
CVTRV632 EQU   CVTDMSRF                                                 02719000
CVTRV631 EQU   CVTDMSRF                                                 02720000
CVTRV630 EQU   CVTDMSRF                                                 02721000
CVTRV629 EQU   CVTDMSRF                                                 02722000
CVTUDUMP EQU   CVTDMSRF                                                 02723000
CVTSDUMP EQU   CVTDMSRF                                                 02724000
CVTQMSGA EQU   CVTQMSG+1                                                02725000
CVTRSV36 EQU   CVTQMSG                                                  02726000
CVTAMFF  EQU   CVTMAP+264                                               02727000
CVTPURGA EQU   CVTPURG+1                                                02728000
CVTRSV35 EQU   CVTPURG                                                  02729000
CVTCBSP  EQU   CVTMAP+256                                               02730000
CVTATERA EQU   CVTATER+1                                                02731000
CVTSYST  EQU   CVTATER                                                  02732000
CVTVOLT2 EQU   CVTTAT                                                   02733000
CVTVOLI2 EQU   CVTVOLF2                                                 02734000
CVTAQAVB EQU   CVTAQAVT+1                                               02735000
CVTRSV34 EQU   CVTTCMFG                                                 02736000
CVTRSV33 EQU   CVTTCMFG                                                 02737000
CVTRSV32 EQU   CVTTCMFG                                                 02738000
CVTRSV31 EQU   CVTTCMFG                                                 02739000
CVTRSV30 EQU   CVTTCMFG                                                 02740000
CVTRSV29 EQU   CVTTCMFG                                                 02741000
CVTRSV28 EQU   CVTTCMFG                                                 02742000
CVTTCRDY EQU   CVTTCMFG                                                 02743000
CVTGTFA  EQU   CVTGTF+1                                                 02744000
CVTRSV27 EQU   CVTGTFST                                                 02745000
CVTRNIO  EQU   CVTGTFST                                                 02746000
CVTUSR   EQU   CVTGTFST                                                 02747000
CVTRV318 EQU   CVTFORM                                                  02748000
CVTRV317 EQU   CVTTMODE                                                 02749000
CVTRV316 EQU   CVTSTATE                                                 02750000
CVTRV315 EQU   CVTGTFS                                                  02751000
CVTGTFAV EQU   CVTGTFS                                                  02752000
CVT0SCR1 EQU   CVTMAP+232                                               02753000
CVTRV515 EQU   CVTMAP+228                                               02754000
CVTRMS   EQU   CVTMAP+224                                               02755000
CVTPATCH EQU   CVTMAP+220                                               02756000
CVTTSCE  EQU   CVTMAP+216                                               02757000
CVTLNKSC EQU   CVTMAP+214                                               02758000
CVTQABST EQU   CVTMAP+212                                               02759000
CVTMDLDS EQU   CVTMAP+208                                               02760000
CVTUSER  EQU   CVTMAP+204                                               02761000
CVTABEND EQU   CVTMAP+200                                               02762000
CVTSMCA  EQU   CVTMAP+196                                               02763000
CVTRSV18 EQU   CVTMAP+192                                               02764000
CVTQLPAQ EQU   CVTMAP+188                                               02765000
CVTQCDSR EQU   CVTMAP+184                                               02766000
CVTRSV17 EQU   CVTOPTB                                                  02767000
CVTRSV16 EQU   CVTOPTB                                                  02768000
CVTFP    EQU   CVTOPTB                                                  02769000
CVTAPTHR EQU   CVTOPTB                                                  02770000
CVTNLOG  EQU   CVTOPTB                                                  02771000
CVTTOD   EQU   CVTOPTB                                                  02772000
CVTCTIMS EQU   CVTOPTB                                                  02773000
CVTPROT  EQU   CVTOPTB                                                  02774000
CVTXPFP  EQU   CVTOPTA                                                  02775000
CVTASCII EQU   CVTOPTA                                                  02776000
CVTRSV13 EQU   CVTOPTA                                                  02777000
CVTRSV12 EQU   CVTOPTA                                                  02778000
CVTNIP   EQU   CVTOPTA                                                  02779000
CVTDDR   EQU   CVTOPTA                                                  02780000
CVTAPR   EQU   CVTOPTA                                                  02781000
CVTCCH   EQU   CVTOPTA                                                  02782000
CVTSNCTR EQU   CVTMAP+180                                               02783000
CVTQMWR  EQU   CVTMAP+176                                               02784000
CVTQOCR  EQU   CVTMAP+172                                               02785000
CVT1EF00 EQU   CVTMAP+168                                               02786000
CVTMZ00  EQU   CVTMAP+164                                               02787000
CVTHEAD  EQU   CVTMAP+160                                               02788000
CVTRSV11 EQU   CVTMAP+156                                               02789000
CVT0PT01 EQU   CVTMAP+152                                               02790000
CVTMSER  EQU   CVTMAP+148                                               02791000
CVTRV516 EQU   CVTIERLC                                                 02792000
CVTILCH  EQU   CVTMAP+140                                               02793000
CVT0DS   EQU   CVTMAP+136                                               02794000
CVTFBOSV EQU   CVTMAP+132                                               02795000
CVTNUCB  EQU   CVTMAP+128                                               02796000
CVTIXAVL EQU   CVTMAP+124                                               02797000
CVTIOQET EQU   CVTMAP+120                                               02798000
CVTDCBA  EQU   CVTMAP+117                                               02799000
CVTMVS2  EQU   CVTDCB                                                   02800000
CVT6DAT  EQU   CVTDCB                                                   02801000
CVT4MPS  EQU   CVTDCB                                                   02802000
CVTRSV09 EQU   CVTDCB                                                   02803000
CVT4MS1  EQU   CVTDCB                                                   02804000
CVT2SPS  EQU   CVTDCB                                                   02805000
CVT1SSS  EQU   CVTDCB                                                   02806000
CVTRSV08 EQU   CVTDCB                                                   02807000
CVTSTB   EQU   CVTMAP+112                                               02808000
CVTQTD00 EQU   CVTMAP+108                                               02809000
CVTQTE00 EQU   CVTMAP+104                                               02810000
CVTCUCB  EQU   CVTMAP+100                                               02811000
CVTSJQ   EQU   CVTMAP+96                                                02812000
CVTPBLDL EQU   CVTMAP+92                                                02813000
CVTTPC   EQU   CVTMAP+88                                                02814000
CVTSVDCB EQU   CVTMAP+84                                                02815000
CVTBRET  EQU   CVTMAP+82                                                02816000
CVTEXIT  EQU   CVTMAP+80                                                02817000
CVT0FN00 EQU   CVTMAP+76                                                02818000
CVTDARA  EQU   CVTDAR+1                                                 02819000
CVTRSV07 EQU   CVTFLGS1                                                 02820000
CVTRSV06 EQU   CVTFLGS1                                                 02821000
CVTRSV05 EQU   CVTFLGS1                                                 02822000
CVTRSV04 EQU   CVTFLGS1                                                 02823000
CVTRSV03 EQU   CVTFLGS1                                                 02824000
CVTRSV02 EQU   CVTFLGS1                                                 02825000
CVTRSV01 EQU   CVTFLGS1                                                 02826000
CVTDMPLK EQU   CVTFLGS1                                                 02827000
CVTXITP  EQU   CVTMAP+68                                                02828000
CVTZDTAB EQU   CVTMAP+64                                                02829000
CVTMSLT  EQU   CVTMAP+60                                                02830000
CVTDATE  EQU   CVTMAP+56                                                02831000
CVTBTERM EQU   CVTMAP+52                                                02832000
CVTSYSAD EQU   CVTMAP+48                                                02833000
CVTXTLER EQU   CVTMAP+44                                                02834000
CVTILK2  EQU   CVTMAP+40                                                02835000
CVTILK1  EQU   CVTMAP+36                                                02836000
CVTPRLTV EQU   CVTMAP+32                                                02837000
CVTPCNVT EQU   CVTMAP+28                                                02838000
CVT0VL00 EQU   CVTMAP+24                                                02839000
CVTXAPG  EQU   CVTMAP+20                                                02840000
CVTBUF   EQU   CVTMAP+16                                                02841000
CVTJOB   EQU   CVTMAP+12                                                02842000
CVTLINK  EQU   CVTMAP+8                                                 02843000
CVT0EF00 EQU   CVTMAP+4                                                 02844000
CVTTCBP  EQU   CVTMAP                                                   02845000
CVT      EQU   CVTMAP                                                   02846000
@NM00026 EQU   PSA+3668                                                 02847000
PSASTAK  EQU   PSA+3072                                                 02848000
@NM00025 EQU   PSA+1048                                                 02849000
PSAUSEND EQU   PSA+1048                                                 02850000
PSARV062 EQU   PSA+1044                                                 02851000
PSACDAL  EQU   PSA+1040                                                 02852000
PSAWTCOD EQU   PSA+1036                                                 02853000
PSAATCVT EQU   PSA+1032                                                 02854000
PSAPCPSW EQU   PSA+1024                                                 02855000
PSAPIR2  EQU   PSA+1020                                                 02856000
PSARV059 EQU   PSA+1018                                                 02857000
PSASVC13 EQU   PSA+1016                                                 02858000
PSALSFCC EQU   PSA+1012                                                 02859000
PSASFACC EQU   PSA+1008                                                 02860000
PSASTOP  EQU   PSA+992                                                  02861000
PSASTART EQU   PSA+976                                                  02862000
PSARSPSW EQU   PSA+968                                                  02863000
PSASRPSW EQU   PSA+960                                                  02864000
PSARV045 EQU   PSA+892                                                  02865000
PSARV044 EQU   PSA+888                                                  02866000
PSARV043 EQU   PSA+884                                                  02867000
PSARV042 EQU   PSA+880                                                  02868000
PSARV041 EQU   PSA+876                                                  02869000
PSARV040 EQU   PSA+872                                                  02870000
PSARV025 EQU   PSA+868                                                  02871000
PSADSSED EQU   PSA+868                                                  02872000
PSADSSPR EQU   PSA+864                                                  02873000
PSADSSFW EQU   PSA+860                                                  02874000
PSADSS14 EQU   PSA+856                                                  02875000
PSADSSPP EQU   PSA+848                                                  02876000
PSADSSRP EQU   PSA+840                                                  02877000
PSADSS05 EQU   PSADSSF4                                                 02878000
PSADSS10 EQU   PSADSSF4                                                 02879000
PSADSSVE EQU   PSADSSF4                                                 02880000
PSADSSDE EQU   PSADSSF4                                                 02881000
PSADSSC0 EQU   PSADSSF4                                                 02882000
PSADSSIE EQU   PSADSSF4                                                 02883000
PSADSS12 EQU   PSADSSF4                                                 02884000
PSADSSRC EQU   PSADSSF4                                                 02885000
PSARV057 EQU   PSADSSF3                                                 02886000
PSARV056 EQU   PSADSSF3                                                 02887000
PSARV055 EQU   PSADSSF3                                                 02888000
PSADSSMC EQU   PSADSSF3                                                 02889000
PSADSSRW EQU   PSADSSF3                                                 02890000
PSADSSNM EQU   PSADSSF3                                                 02891000
PSADSSES EQU   PSADSSF3                                                 02892000
PSADSSGP EQU   PSADSSF3                                                 02893000
PSADSSF2 EQU   PSADSSFL+1                                               02894000
PSADSSPI EQU   PSADSSF1                                                 02895000
PSADSSOI EQU   PSADSSF1                                                 02896000
PSADSSSP EQU   PSADSSF1                                                 02897000
PSADSSTP EQU   PSADSSF1                                                 02898000
PSADSSDW EQU   PSADSSF1                                                 02899000
PSADSSDD EQU   PSADSSF1                                                 02900000
PSADSSDM EQU   PSADSSF1                                                 02901000
PSADSSMV EQU   PSADSSF1                                                 02902000
PSADSSTS EQU   PSA+816                                                  02903000
PSADSSWK EQU   PSA+812                                                  02904000
PSADSSR3 EQU   PSA+808                                                  02905000
PSADSSR2 EQU   PSA+804                                                  02906000
PSADSSRS EQU   PSA+800                                                  02907000
PSASTOR  EQU   PSA+796                                                  02908000
PSACPUSA EQU   PSA+794                                                  02909000
PSAVSTAP EQU   PSA+792                                                  02910000
PSAWKVAP EQU   PSA+788                                                  02911000
PSAWKRAP EQU   PSA+784                                                  02912000
PSAMCHIC EQU   PSA+783                                                  02913000
PSARV061 EQU   PSA+782                                                  02914000
PSASYMSK EQU   PSA+781                                                  02915000
PSAMCHFL EQU   PSA+780                                                  02916000
PSACR0   EQU   PSA+776                                                  02917000
PSAPSWSV EQU   PSA+768                                                  02918000
PSALITA  EQU   PSA+764                                                  02919000
PSACLHS  EQU   PSAHLHI                                                  02920000
PSALKR15 EQU   PSALKSA+60                                               02921000
PSALKR14 EQU   PSALKSA+56                                               02922000
PSALKR13 EQU   PSALKSA+52                                               02923000
PSALKR12 EQU   PSALKSA+48                                               02924000
PSALKR11 EQU   PSALKSA+44                                               02925000
PSALKR10 EQU   PSALKSA+40                                               02926000
PSALKR9  EQU   PSALKSA+36                                               02927000
PSALKR8  EQU   PSALKSA+32                                               02928000
PSALKR7  EQU   PSALKSA+28                                               02929000
PSALKR6  EQU   PSALKSA+24                                               02930000
PSALKR5  EQU   PSALKSA+20                                               02931000
PSALKR4  EQU   PSALKSA+16                                               02932000
PSALKR3  EQU   PSALKSA+12                                               02933000
PSALKR2  EQU   PSALKSA+8                                                02934000
PSALKR1  EQU   PSALKSA+4                                                02935000
PSALKR0  EQU   PSALKSA                                                  02936000
PSARV023 EQU   PSACLHT+52                                               02937000
PSALOCAL EQU   PSACLHT+48                                               02938000
PSACMSL  EQU   PSACLHT+44                                               02939000
PSAOPTL  EQU   PSACLHT+40                                               02940000
PSATPACL EQU   PSACLHT+36                                               02941000
PSATPDNL EQU   PSACLHT+32                                               02942000
PSATPNCL EQU   PSACLHT+28                                               02943000
PSAIOSLL EQU   PSACLHT+24                                               02944000
PSAIOSUL EQU   PSACLHT+20                                               02945000
PSAIOSCL EQU   PSACLHT+16                                               02946000
PSAIOSSL EQU   PSACLHT+12                                               02947000
PSASALCL EQU   PSACLHT+8                                                02948000
PSAASML  EQU   PSACLHT+4                                                02949000
PSADISPL EQU   PSACLHT                                                  02950000
PSASRSA  EQU   PSA+636                                                  02951000
PSARV050 EQU   PSA+634                                                  02952000
PSADSSGO EQU   PSA+633                                                  02953000
PSARECUR EQU   PSA+632                                                  02954000
PSAHLHIS EQU   PSA+628                                                  02955000
PSAIPCSA EQU   PSA+624                                                  02956000
@NM00024 EQU   PSA+621                                                  02957000
PSAIPCDM EQU   PSA+620                                                  02958000
PSAIPCD  EQU   PSA+616                                                  02959000
@NM00023 EQU   PSA+613                                                  02960000
PSAIPCRM EQU   PSA+612                                                  02961000
PSAIPCR  EQU   PSA+608                                                  02962000
PSAMCHEX EQU   PSA+600                                                  02963000
PSAMPSW  EQU   PSA+592                                                  02964000
PSAEXPS2 EQU   PSA+584                                                  02965000
PSAEXPS1 EQU   PSA+576                                                  02966000
PSAPIREG EQU   PSA+572                                                  02967000
PSARSREG EQU   PSA+568                                                  02968000
PSAGPREG EQU   PSA+556                                                  02969000
PSARV022 EQU   PSASUP4                                                  02970000
PSARV021 EQU   PSASUP4                                                  02971000
PSARV020 EQU   PSASUP4                                                  02972000
PSARV019 EQU   PSASUP4                                                  02973000
PSARV018 EQU   PSASUP4                                                  02974000
PSARV017 EQU   PSASUP4                                                  02975000
PSARV016 EQU   PSASUP4                                                  02976000
PSARV015 EQU   PSASUP4                                                  02977000
PSARV014 EQU   PSASUP3                                                  02978000
PSARV013 EQU   PSASUP3                                                  02979000
PSARV012 EQU   PSASUP3                                                  02980000
PSAESTA  EQU   PSASUP3                                                  02981000
PSASPR   EQU   PSASUP3                                                  02982000
PSAPSREG EQU   PSASUP3                                                  02983000
PSAPI2   EQU   PSASUP3                                                  02984000
PSAIOSUP EQU   PSASUP3                                                  02985000
PSALCR   EQU   PSASUP2                                                  02986000
PSARTM   EQU   PSASUP2                                                  02987000
PSAACR   EQU   PSASUP2                                                  02988000
PSAIPCE2 EQU   PSASUP2                                                  02989000
PSAIPCES EQU   PSASUP2                                                  02990000
PSAIPCEC EQU   PSASUP2                                                  02991000
PSAGTF   EQU   PSASUP2                                                  02992000
PSAIPCRI EQU   PSASUP2                                                  02993000
PSATYPE6 EQU   PSASUP1                                                  02994000
PSATCTL  EQU   PSASUP1                                                  02995000
PSADISP  EQU   PSASUP1                                                  02996000
PSALOCK  EQU   PSASUP1                                                  02997000
PSAPI    EQU   PSASUP1                                                  02998000
PSAEXT   EQU   PSASUP1                                                  02999000
PSASVC   EQU   PSASUP1                                                  03000000
PSAIO    EQU   PSASUP1                                                  03001000
PSAAOLD  EQU   PSA+548                                                  03002000
PSAANEW  EQU   PSA+544                                                  03003000
PSATOLD  EQU   PSA+540                                                  03004000
PSATNEW  EQU   PSA+536                                                  03005000
PSALCCAR EQU   PSA+532                                                  03006000
PSALCCAV EQU   PSA+528                                                  03007000
PSAPCCAR EQU   PSA+524                                                  03008000
PSAPCCAV EQU   PSA+520                                                  03009000
PSACPULA EQU   PSA+518                                                  03010000
PSACPUPA EQU   PSA+516                                                  03011000
PSAPSA   EQU   PSA+512                                                  03012000
FLCHDEND EQU   PSA+512                                                  03013000
FLCCRSAV EQU   FLCMCLA+280                                              03014000
FLCGRSAV EQU   FLCMCLA+216                                              03015000
FLCFPSAV EQU   FLCMCLA+184                                              03016000
FLCFLA   EQU   FLCMCLA+88                                               03017000
FLCRGNCD EQU   FLCMCLA+84                                               03018000
FLCFSAA  EQU   FLCFSA+1                                                 03019000
@NM00022 EQU   FLCFSA                                                   03020000
@NM00021 EQU   FLCMCLA+72                                               03021000
FLCMCIC  EQU   FLCMCLA+64                                               03022000
@NM00020 EQU   FLCMCLA+20                                               03023000
FLCIOAA  EQU   FLCIOA+1                                                 03024000
@NM00019 EQU   FLCIOA                                                   03025000
@NM00018 EQU   FLCMCLA+15                                               03026000
@NM00017 EQU   FLCMCLA+14                                               03027000
@NM00016 EQU   FLCMCLA+12                                               03028000
FLCLCL   EQU   FLCMCLA+8                                                03029000
FLCIOELA EQU   FLCIOEL+1                                                03030000
@NM00015 EQU   FLCIOEL                                                  03031000
FLCCHNID EQU   FLCMCLA                                                  03032000
@NM00014 EQU   PSA+160                                                  03033000
FLCMTRCD EQU   PSA+157                                                  03034000
@NM00013 EQU   PSA+156                                                  03035000
FLCPERA  EQU   FLCPER+1                                                 03036000
@NM00012 EQU   FLCPER                                                   03037000
@NM00011 EQU   PSA+151                                                  03038000
FLCPERCD EQU   PSA+150                                                  03039000
FLCMCNUM EQU   PSA+149                                                  03040000
@NM00010 EQU   PSA+148                                                  03041000
FLCTEAA  EQU   FLCTEA+1                                                 03042000
@NM00009 EQU   FLCTEA                                                   03043000
PSAPIPC  EQU   PSAPICOD                                                 03044000
PSAPIMC  EQU   PSAPICOD                                                 03045000
PSAPIPER EQU   PSAPICOD                                                 03046000
PSARV049 EQU   FLCPICOD                                                 03047000
FLCPILCB EQU   FLCPIILC                                                 03048000
@NM00008 EQU   FLCPIILC                                                 03049000
@NM00007 EQU   PSAEPPSW                                                 03050000
FLCSVCN  EQU   PSAESPSW+2                                               03051000
FLCSILCB EQU   FLCSVILC                                                 03052000
@NM00006 EQU   FLCSVILC                                                 03053000
@NM00005 EQU   PSAESPSW                                                 03054000
FLCEICOD EQU   PSAEEPSW+2                                               03055000
PSASPAD  EQU   PSAEEPSW                                                 03056000
@NM00004 EQU   PSA+128                                                  03057000
FLCINPSW EQU   PSA+120                                                  03058000
FLCMNPSW EQU   PSA+112                                                  03059000
FLCPNPSW EQU   PSA+104                                                  03060000
FLCSNPSW EQU   PSA+96                                                   03061000
FLCENPSW EQU   PSA+88                                                   03062000
FLCTRACE EQU   PSA+84                                                   03063000
FLCTIMER EQU   PSA+80                                                   03064000
FLCCVT2  EQU   PSA+76                                                   03065000
FLCCAW   EQU   PSA+72                                                   03066000
FLCCSW   EQU   PSA+64                                                   03067000
FLCIOPSW EQU   PSA+56                                                   03068000
FLCMOPSW EQU   PSA+48                                                   03069000
FLCPOPSW EQU   PSA+40                                                   03070000
FLCSOPSW EQU   PSA+32                                                   03071000
FLCEOPSW EQU   PSA+24                                                   03072000
@NM00003 EQU   FLCICCW2+4                                               03073000
FLCCVT   EQU   FLCICCW2                                                 03074000
FLCICCW1 EQU   FLCROPSW                                                 03075000
FLCIPPSW EQU   FLCRNPSW                                                 03076000
*                                      END UNREFERENCED COMPONENTS      03077000
@RF00088 EQU   @RC00085                                                 03078000
@RF00196 EQU   @EL00003                                                 03079000
@RT00273 EQU   @EL00006                                                 03080000
@RT00289 EQU   @EL00007                                                 03081000
@RT00327 EQU   @EL00008                                                 03082000
@RF00329 EQU   @EL00008                                                 03083000
@RF00334 EQU   @EL00008                                                 03084000
@RT00361 EQU   @EL00010                                                 03085000
@ENDDATA EQU   *                                                        03086000
         END   ICBVTP00,(C'PLS0549',0603,76275)                         03087000
./  ADD  SSI=63490214,NAME=ICBVTP01
         TITLE '************* ICBVTP01 - MSVC TABLE PROCESSOR **********00001000
               *****    '                                               00002000
ICBVTP01 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVTP01  76.349'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         LM    @00,@01,20(@13)                                     0001 00018000
*   PARMPTR=PARMADDR;               /* SAVE PARM LIST ADDR   @G24LB18*/ 00019000
         L     PARMPTR,PARMADDR(,REG1)                             0061 00020000
*   VVIPTR=ICBVVICB;                /* SET UP MSVC CB PTR    @G24LB18*/ 00021000
         L     @15,CVTPTR                                          0062 00022000
         L     @15,CVTEXT2(,@15)                                   0062 00023000
         L     @15,CVTICB(,@15)                                    0062 00024000
         L     @15,ICBVVICB(,@15)                                  0062 00025000
         ST    @15,VVIPTR                                          0062 00026000
*   RFY                                                            0063 00027000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00028000
*   RFY                                                            0064 00029000
*     TABP BASED(PARMPTR);          /* BASE TABP PARM LIST   @G24LB18*/ 00030000
*   RFY                                                            0065 00031000
*     SELRB BASED(TABSELRB);        /* BASE SELECT REQ BLK   @G24LB18*/ 00032000
*   RFY                                                            0066 00033000
*     STPTB BASED(STHDRPTR);        /* BASE STEP TABLE HDR   @G24LB18*/ 00034000
*   RFY                                                            0067 00035000
*     STPDDENT BASED(DDENTPTR);     /* BASE DD ENTRY         @G24LB18*/ 00036000
*   RETCODE=ZERO;                   /* SET RETURN CODE = 0   @G24LB18*/ 00037000
         SLR   RETCODE,RETCODE                                     0068 00038000
*                                                                  0069 00039000
*   /*****************************************************************/ 00040000
*   /*                                                               */ 00041000
*   /* DETERMINE WHICH FUNCTION WAS REQUESTED AND CALL THE   @G24LB18*/ 00042000
*   /* APPROPRIATE PROCEDURE TO PROCESS IT.                  @G24LB18*/ 00043000
*   /*                                                               */ 00044000
*   /*****************************************************************/ 00045000
*                                                                  0069 00046000
*                                                                  0069 00047000
*   /*****************************************************************/ 00048000
*   /*                                                               */ 00049000
*   /* BUILD DD ENTRY REQUEST                                @G24LB18*/ 00050000
*   /*                                                               */ 00051000
*   /*****************************************************************/ 00052000
*                                                                  0069 00053000
*   IF TABFBLDE=ON THEN             /* BUILD DD ENTRY REQ?   @G24LB18*/ 00054000
         TM    TABFBLDE(PARMPTR),B'10000000'                       0069 00055000
         BNO   @RF00069                                            0069 00056000
*     DO;                           /* YES                   @G24LB18*/ 00057000
*       CALL BLDDDENT;              /* CALL BUILD DD ENT RTN @G24LB18*/ 00058000
         BAL   @14,BLDDDENT                                        0071 00059000
*       IF RETCODE=FOUR THEN        /* DD ENTRY NOT BUILT?   @G24LB18*/ 00060000
         C     RETCODE,@CF00057                                    0072 00061000
         BNE   @RF00072                                            0072 00062000
*         RETURN CODE(RETCODE);     /* YES-RETURN TO CALLER  @G24LB18*/ 00063000
         L     @00,@SIZDATD                                        0073 00064000
         LR    @01,@11                                             0073 00065000
         FREEMAIN R,LV=(0),A=(1)                                        00066000
         LR    @15,@10                                             0073 00067000
         L     @14,12(,@13)                                        0073 00068000
         LM    @00,@12,20(@13)                                     0073 00069000
         BR    @14                                                 0073 00070000
*     END;                          /* WITH RETURN CODE = 4  @G24LB18*/ 00071000
*                                                                  0074 00072000
*   /*****************************************************************/ 00073000
*   /*                                                               */ 00074000
*   /* FOR ALL REQUESTS EXCEPT 'BUILD DD ENTRY', SET THE     @G24LB18*/ 00075000
*   /* LOCAL AND CMS LOCKS BEFORE PROCESSING.                @G24LB18*/ 00076000
*   /*                                                               */ 00077000
*   /*****************************************************************/ 00078000
*                                                                  0075 00079000
*   ELSE                            /*                       @G24LB18*/ 00080000
*     DO;                           /*                       @G24LB18*/ 00081000
         B     @RC00069                                            0075 00082000
@RF00069 DS    0H                                                  0076 00083000
*       GENERATE;                                                  0076 00084000
*                                                          /*@G24LB18*/ 00085000
LGETLCL1 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               *00086000
               RELATED=(ICBVTP01(LFRELCL1))                             00087000
LGETCMS1 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,                 *00088000
               RELATED=(ICBVTP01(LFRECMS1))                             00089000
*     END;                          /*                       @G24LB18*/ 00090000
*                                                                  0077 00091000
*   /*****************************************************************/ 00092000
*   /*                                                               */ 00093000
*   /* SEARCH FOR DD ENTRY REQUEST                           @G24LB18*/ 00094000
*   /*                                                               */ 00095000
*   /*****************************************************************/ 00096000
*                                                                  0078 00097000
*   IF TABFSRCD=ON THEN             /* SEARCH FOR DD ENTRY?  @G24LB18*/ 00098000
@RC00069 TM    TABFSRCD(PARMPTR),B'01000000'                       0078 00099000
         BNO   @RF00078                                            0078 00100000
*     CALL SRCDDENT;                /* YES - CALL SEARCH RTN @G24LB18*/ 00101000
         BAL   @14,SRCDDENT                                        0079 00102000
*                                                                  0080 00103000
*   /*****************************************************************/ 00104000
*   /*                                                               */ 00105000
*   /* UNSUCCESSFUL TERMINATION REQUEST                      @G24LB18*/ 00106000
*   /*                                                               */ 00107000
*   /*****************************************************************/ 00108000
*                                                                  0080 00109000
*   IF TABFUTRM=ON THEN             /* UNSUCCESSFUL TERM?    @G24LB18*/ 00110000
@RF00078 TM    TABFUTRM(PARMPTR),B'00001000'                       0080 00111000
         BNO   @RF00080                                            0080 00112000
*     CALL UNSUCTRM;                /* YES - CALL TERM RTN   @G24LB18*/ 00113000
*                                                                  0081 00114000
         BAL   @14,UNSUCTRM                                        0081 00115000
*   /*****************************************************************/ 00116000
*   /*                                                               */ 00117000
*   /* FREE STEP TABLE REQUEST                               @G24LB18*/ 00118000
*   /*                                                               */ 00119000
*   /*****************************************************************/ 00120000
*                                                                  0082 00121000
*   IF TABFFREE=ON THEN             /* FREE STEP TABLE REQ?  @G24LB18*/ 00122000
@RF00080 TM    TABFFREE(PARMPTR),B'00000100'                       0082 00123000
         BNO   @RF00082                                            0082 00124000
*     DO;                           /*                       @G24LB18*/ 00125000
*       CALL FREESTAB;              /* CALL FREE TABLE RTN   @G24LB18*/ 00126000
         BAL   @14,FREESTAB                                        0084 00127000
*       RETURN CODE(RETCODE);       /* RETURN TO CALLER      @G24LB18*/ 00128000
         L     @00,@SIZDATD                                        0085 00129000
         LR    @01,@11                                             0085 00130000
         FREEMAIN R,LV=(0),A=(1)                                        00131000
         LR    @15,@10                                             0085 00132000
         L     @14,12(,@13)                                        0085 00133000
         LM    @00,@12,20(@13)                                     0085 00134000
         BR    @14                                                 0085 00135000
*     END;                          /* WITH RETURN CODE = 0  @G24LB18*/ 00136000
*                                                                  0086 00137000
*   /*****************************************************************/ 00138000
*   /*                                                               */ 00139000
*   /* RELEASE THE CMS AND LOCAL LOCKS AND RETURN TO THE     @G24LB18*/ 00140000
*   /* CALLER WITH A RETURN CODE IN REGISTER 15.             @G24LB18*/ 00141000
*   /*                                                               */ 00142000
*   /*****************************************************************/ 00143000
*                                                                  0087 00144000
*   GENERATE;                                                      0087 00145000
@RF00082 DS    0H                                                  0087 00146000
*                                                          /*@G24LB18*/ 00147000
LFRECMS1 SETLOCK RELEASE,TYPE=CMS,REGS=USE,                            *00148000
               RELATED=(ICBVTP01(LGETCMS1,LGETCMS2,LGETCMS3))           00149000
LFRELCL1 SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                          *00150000
               RELATED=(ICBVTP01(LGETLCL1,LGETLCL2,LGETLCL3))           00151000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER      @G24LB18*/ 00152000
*                                                                  0088 00153000
         L     @00,@SIZDATD                                        0088 00154000
         LR    @01,@11                                             0088 00155000
         FREEMAIN R,LV=(0),A=(1)                                        00156000
         LR    @15,@10                                             0088 00157000
         L     @14,12(,@13)                                        0088 00158000
         LM    @00,@12,20(@13)                                     0088 00159000
         BR    @14                                                 0088 00160000
*   /*****************************************************************/ 00161000
*   /*                                                               */ 00162000
*   /* END OF MAINLINE PROCESSING FOR ICBVTP01. THE          @G24LB18*/ 00163000
*   /* REMAINDER OF THE MODULE CONSISTS OF INTERNAL          @G24LB18*/ 00164000
*   /* PROCEDURES FOR ICBVTP01.                              @G24LB18*/ 00165000
*   /*                                                               */ 00166000
*   /*****************************************************************/ 00167000
*                                                                  0089 00168000
*                                                                  0089 00169000
*/*********************************************************  @G24LB18*/ 00170000
*/*                                                          @G24LB18*/ 00171000
*/* PROCEDURE NAME - BLDDDENT                                @G24LB18*/ 00172000
*/*                                                          @G24LB18*/ 00173000
*/* FUNCTION - THIS ROUTINE IS CALLED ON BUILD DD ENTRY      @G24LB18*/ 00174000
*/*            REQUESTS. IT DETERMINES THE LENGTH OF THE     @G24LB18*/ 00175000
*/*            ENTRY, GETS STORAGE FOR IT, FILLS IT IN WITH  @G24LB18*/ 00176000
*/*            THE INFORMATION PASSED IN THE REQUEST, AND    @G24LB18*/ 00177000
*/*            ADDS IT TO THE STEP TABLE FOR THE REQUESTED   @G24LB18*/ 00178000
*/*            STEP, IF ONE EXISTS. IF NOT, IT BUILDS A NEW  @G24LB18*/ 00179000
*/*            STEP TABLE AND ADDS THE ENTRY TO IT.          @G24LB18*/ 00180000
*/*                                                          @G24LB18*/ 00181000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST, SELECT   @G24LB18*/ 00182000
*/*         REQUEST BLOCK                                    @G24LB18*/ 00183000
*/*                                                          @G24LB18*/ 00184000
*/* OUTPUT - A NEW DD ENTRY IS BUILT AND ADDED TO THE STEP   @G24LB18*/ 00185000
*/*          TABLE CHAIN FOR THE REQUEST. A RETURN CODE OF   @G24LB18*/ 00186000
*/*          0 IS RETURNED IF THE ENTRY IS BUILT SUCCESS-    @G24LB18*/ 00187000
*/*          FULLY. A RETURN CODE OF 4 IS RETURNED IF A      @G24LB18*/ 00188000
*/*          GETMAIN FAILURE OCCURRED AND CONSOLE ERROR      @G24LB18*/ 00189000
*/*          MESSAGE ICB409I 'NO STORAGE AVAILABLE' IS       @G24LB18*/ 00190000
*/*          ISSUED.                                         @G24LB18*/ 00191000
*/*                                                          @G24LB18*/ 00192000
*/*********************************************************  @G24LB18*/ 00193000
*                                                                  0089 00194000
*BLDDDENT:                          /*                       @G24LB18*/ 00195000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00196000
BLDDDENT DS    0H                                                  0090 00197000
*   JFCBPTR=SELJFCBA;               /* SET UP JFCB PTR       @G24LB18*/ 00198000
*                                                                  0090 00199000
         L     @15,TABSELRB(,PARMPTR)                              0090 00200000
         L     @15,SELJFCBA(,@15)                                  0090 00201000
         ST    @15,JFCBPTR                                         0090 00202000
*   /*****************************************************************/ 00203000
*   /*                                                               */ 00204000
*   /* DETERMINE THE NUMBER OF VOL SERS FOR THE REQUEST.     @G24LB18*/ 00205000
*   /*                                                               */ 00206000
*   /*****************************************************************/ 00207000
*                                                                  0091 00208000
*   IF JFCBNVOL¬=ZERO THEN          /* SPECIFIC DD?          @G24LB18*/ 00209000
         CLI   JFCBNVOL(@15),0                                     0091 00210000
         BE    @RF00091                                            0091 00211000
*     NVOL=JFCBNVOL;                /* YES-NO. OF VOLS =     @G24LB18*/ 00212000
         SLR   NVOL,NVOL                                           0092 00213000
         IC    NVOL,JFCBNVOL(,@15)                                 0092 00214000
*   ELSE                            /* JFCBNVOL              @G24LB18*/ 00215000
*     IF SELPARMT=ON THEN           /* PARALLEL MOUNT?       @G24LB18*/ 00216000
         B     @RC00091                                            0093 00217000
@RF00091 L     @15,TABSELRB(,PARMPTR)                              0093 00218000
         TM    SELPARMT(@15),B'10000000'                           0093 00219000
         BNO   @RF00093                                            0093 00220000
*       NVOL=JFCBVLCT;              /* YES-NO. OF VOLS =     @G24LB18*/ 00221000
         L     @15,JFCBPTR                                         0094 00222000
         SLR   NVOL,NVOL                                           0094 00223000
         IC    NVOL,JFCBVLCT(,@15)                                 0094 00224000
*     ELSE                          /* JFCBVLCT              @G24LB18*/ 00225000
*       NVOL=SELUNCNT;              /* NO-NO. OF VOLS = UNIT @G24LB18   00226000
*                                      COUNT                 @G24LB18*/ 00227000
*                                                                  0095 00228000
         B     @RC00093                                            0095 00229000
@RF00093 L     @15,TABSELRB(,PARMPTR)                              0095 00230000
         SLR   NVOL,NVOL                                           0095 00231000
         IC    NVOL,SELUNCNT(,@15)                                 0095 00232000
*   /*****************************************************************/ 00233000
*   /*                                                               */ 00234000
*   /* DETERMINE LENGTH OF DD ENTRY AND ISSUE GETMAIN FOR    @G24LB18*/ 00235000
*   /* IT FROM SUBPOOL 241. IF GETMAIN FAILS, ISSUE CONSOLE  @G24LB18*/ 00236000
*   /* ERROR MESSAGE ICB409I 'NO STORAGE AVAILABLE', SET     @G24LB18*/ 00237000
*   /* RETURN CODE = 4, AND RETURN TO MAINLINE ICBVTP01. IF  @G24LB18*/ 00238000
*   /* GETMAIN IS SUCCESSFUL, CLEAR THE GOTTEN AREA AND CALL @G24LB18*/ 00239000
*   /* SUBPROCEDURE FILDDENT TO FILL IN THE DD ENTRY.        @G24LB18*/ 00240000
*   /*                                                               */ 00241000
*   /*****************************************************************/ 00242000
*                                                                  0096 00243000
*   RFY                                                            0096 00244000
*     REG0 RSTD;                    /* RESTRICT REG 0        @G24LB18*/ 00245000
@RC00093 DS    0H                                                  0096 00246000
@RC00091 DS    0H                                                  0097 00247000
*   RFY                                                            0097 00248000
*     REG1 RSTD;                    /* RESTRICT REG 1        @G24LB18*/ 00249000
*   RFY                                                            0098 00250000
*     REG15 RSTD;                   /* RESTRICT REG 15       @G24LB18*/ 00251000
*   GETLEN=NVOL*SIX+LENGTH(STPDDENT);/* SET ENTRY LENGTH     @G24LB18*/ 00252000
         LR    @08,NVOL                                            0099 00253000
         MH    @08,@CH00061                                        0099 00254000
         AL    @08,@CF01544                                        0099 00255000
         ST    @08,GETLEN                                          0099 00256000
*   REG0=GETLEN;                    /* SET LEN FOR GETMAIN   @G24LB18*/ 00257000
         LR    REG0,@08                                            0100 00258000
*LGET1:                                                            0101 00259000
*   GEN(GETMAIN RC,LV=(0),SP=241);  /* GETMAIN DD ENTRY      @G24LB18*/ 00260000
LGET1    GETMAIN RC,LV=(0),SP=241                                       00261000
*   IF REG15¬=ZERO THEN             /* STORAGE GOTTEN?       @G24LB18*/ 00262000
         LTR   REG15,REG15                                         0102 00263000
         BZ    @RF00102                                            0102 00264000
*     DO;                           /* NO                    @G24LB18*/ 00265000
*       REG1=ADDR(MSG1);            /* POINT TO ERROR MSG    @G24LB18*/ 00266000
         LA    REG1,MSG1                                           0104 00267000
*LWTO1:                                                            0105 00268000
*       GEN(WTO   MF=(E,(REG1)));   /* SEND ERROR MESSAGE    @G24LB18*/ 00269000
LWTO1    WTO   MF=(E,(REG1))                                            00270000
*       RETCODE=FOUR;               /* SET RETURN CODE = 4   @G24LB18*/ 00271000
         LA    RETCODE,4                                           0106 00272000
*       RETURN;                     /* RETURN TO ICBVTP01    @G24LB18*/ 00273000
@EL00002 DS    0H                                                  0107 00274000
@EF00002 DS    0H                                                  0107 00275000
@ER00002 BR    @14                                                 0107 00276000
*     END;                          /*                       @G24LB18*/ 00277000
*   SAVERET1=REG14;                 /* SAVE RETURN ADDRESS   @G24LB18*/ 00278000
@RF00102 ST    REG14,SAVERET1                                      0109 00279000
*   DDENTPTR=REG1;                  /* SET UP DD ENTRY PTR   @G24LB18*/ 00280000
         LR    DDENTPTR,REG1                                       0110 00281000
*   STPDDENT=STPDDENT&&STPDDENT;    /* CLEAR DD ENTRY        @G24LB18*/ 00282000
         XC    STPDDENT(26,DDENTPTR),STPDDENT(DDENTPTR)            0111 00283000
*   CALL FILDDENT;                  /* CALL FILL-IN RTN      @G24LB18*/ 00284000
*                                                                  0112 00285000
         BAL   @14,FILDDENT                                        0112 00286000
*   /*****************************************************************/ 00287000
*   /*                                                               */ 00288000
*   /* SET THE LOCAL AND CMS LOCKS AND CALL SUBPROCEDURE     @G24LB18*/ 00289000
*   /* SRCJOBID TO SEARCH FOR THE STEP TABLE FOR THE         @G24LB18*/ 00290000
*   /* REQUEST. IF RETURN CODE = 4 (STEP TABLE NOT FOUND),   @G24LB18*/ 00291000
*   /* CALL SUBPROCEDURE BLDSTHDR TO BUILD A STEP TABLE      @G24LB18*/ 00292000
*   /* HEADER FOR THE REQUESTED STEP AND TO ADD THE DD ENTRY @G24LB18*/ 00293000
*   /* TO IT, AND RETURN TO MAINLINE ICBVTP01.               @G24LB18*/ 00294000
*   /*                                                               */ 00295000
*   /*****************************************************************/ 00296000
*                                                                  0113 00297000
*   GENERATE;                                                      0113 00298000
*                                                          /*@G24LB18*/ 00299000
LGETLCL2 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               *00300000
               RELATED=(ICBVTP01(LFRELCL1,LFRELCL2))                    00301000
LGETCMS2 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,                 *00302000
               RELATED=(ICBVTP01(LFRECMS1,LFRECMS2))                    00303000
*   JOBID=SELJOBID;                 /* GET JOBID             @G24LB18*/ 00304000
         L     @07,TABSELRB(,PARMPTR)                              0114 00305000
         L     JOBID,SELJOBID(,@07)                                0114 00306000
*   CALL SRCJOBID;                  /* CALL SEARCH RTN       @G24LB18*/ 00307000
         BAL   @14,SRCJOBID                                        0115 00308000
*   IF RETCODE=FOUR THEN            /* STEP TABLE FOUND?     @G24LB18*/ 00309000
         C     RETCODE,@CF00057                                    0116 00310000
         BNE   @RF00116                                            0116 00311000
*     DO;                           /* NO                    @G24LB18*/ 00312000
*       CALL BLDSTHDR;              /* CALL BUILD HDR RTN    @G24LB18*/ 00313000
         BAL   @14,BLDSTHDR                                        0118 00314000
*       REG14=SAVERET1;             /* RESTORE RETURN ADDR   @G24LB18*/ 00315000
         L     REG14,SAVERET1                                      0119 00316000
*       RETURN;                     /* RETURN TO ICBVTP01    @G24LB18*/ 00317000
         B     @EL00002                                            0120 00318000
*     END;                          /*                       @G24LB18*/ 00319000
*                                                                  0122 00320000
*   /*****************************************************************/ 00321000
*   /*                                                               */ 00322000
*   /* IF STEP TABLE WAS FOUND, TEST FOR INITIAL CALL FROM   @G24LB18*/ 00323000
*   /* ALLOCATION. IF SO, INCREMENT THE INITIAL CALL COUNTER @G24LB18*/ 00324000
*   /* BY 1. SEARCH FOR THE LAST DD ENTRY IN THE STEP TABLE, @G24LB18*/ 00325000
*   /* CHAIN THE NEW DD ENTRY TO IT, AND RETURN TO MAINLINE  @G24LB18*/ 00326000
*   /* ICBVTP01.                                             @G24LB18*/ 00327000
*   /*                                                               */ 00328000
*   /*****************************************************************/ 00329000
*                                                                  0122 00330000
*   IF SELINITC=ON THEN             /* INITIAL CALL?         @G24LB18*/ 00331000
@RF00116 L     @07,TABSELRB(,PARMPTR)                              0122 00332000
         TM    SELINITC(@07),B'00000100'                           0122 00333000
         BNO   @RF00122                                            0122 00334000
*     STPICCTR=STPICCTR+ONE;        /* YES-INCREMENT COUNTER @G24LB18*/ 00335000
         LA    @07,1                                               0123 00336000
         SLR   @09,@09                                             0123 00337000
         IC    @09,STPICCTR(,STHDRPTR)                             0123 00338000
         ALR   @07,@09                                             0123 00339000
         STC   @07,STPICCTR(,STHDRPTR)                             0123 00340000
*   SAVENTRY=DDENTPTR;              /* SAVE NEW DD ENTRY PTR @G24LB18*/ 00341000
@RF00122 LR    SAVENTRY,DDENTPTR                                   0124 00342000
*   DDENTPTR=STPDDPTR;              /* GET 1ST DD ENTRY      @G24LB18*/ 00343000
         L     DDENTPTR,STPDDPTR(,STHDRPTR)                        0125 00344000
*   DO WHILE STPDDNXT¬=ZERO;        /* LAST DD ENTRY?        @G24LB18*/ 00345000
         B     @DE00126                                            0126 00346000
@DL00126 DS    0H                                                  0127 00347000
*     DDENTPTR=STPDDNXT;            /* NO - GET NEXT ENTRY   @G24LB18*/ 00348000
         L     DDENTPTR,STPDDNXT(,DDENTPTR)                        0127 00349000
*   END;                            /* YES - CONTINUE        @G24LB18*/ 00350000
@DE00126 L     @08,STPDDNXT(,DDENTPTR)                             0128 00351000
         LTR   @08,@08                                             0128 00352000
         BNZ   @DL00126                                            0128 00353000
*   STPDDNXT=SAVENTRY;              /* SET NEXT DD PTR OF LAST ENTRY    00354000
*                                      = NEW DD ENTRY ADDR   @G24LB18*/ 00355000
         ST    SAVENTRY,STPDDNXT(,DDENTPTR)                        0129 00356000
*   REG14=SAVERET1;                 /* RESTORE RETURN ADDR   @G24LB18*/ 00357000
         L     REG14,SAVERET1                                      0130 00358000
*   RFY                                                            0131 00359000
*     REG0 UNRSTD;                  /* UNRESTRICT REG 0      @G24LB18*/ 00360000
*   RFY                                                            0132 00361000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00362000
*   RFY                                                            0133 00363000
*     REG15 UNRSTD;                 /* UNRESTRICT REG 15     @G24LB18*/ 00364000
*   RETURN;                         /* RETURN TO ICBVTP01    @G24LB18*/ 00365000
         B     @EL00002                                            0134 00366000
*   END BLDDDENT;                   /* END BUILD DD ENT RTN  @G24LB18*/ 00367000
*                                                                  0136 00368000
*/*********************************************************  @G24LB18*/ 00369000
*/*                                                          @G24LB18*/ 00370000
*/* PROCEDURE NAME - FILDDENT                                @G24LB18*/ 00371000
*/*                                                          @G24LB18*/ 00372000
*/* FUNCTION - THIS ROUTINE IS CALLED ON BUILD DD ENTRY      @G24LB18*/ 00373000
*/*            REQUESTS WHEN STORAGE FOR THE ENTRY HAS BEEN  @G24LB18*/ 00374000
*/*            GOTTEN. IT FILLS IN THE ENTRY WITH THE        @G24LB18*/ 00375000
*/*            INFORMATION PASSED IN THE SELECT REQUEST      @G24LB18*/ 00376000
*/*            BLOCK AND THE JFCB. IF THERE ARE JFCB         @G24LB18*/ 00377000
*/*            EXTENSIONS, IT CALLS SUBPROCEDURE MOVEEXT     @G24LB18*/ 00378000
*/*            TO FILL IN THE VOL SERS FROM THE EXTENSIONS.  @G24LB18*/ 00379000
*/*                                                          @G24LB18*/ 00380000
*/* INPUT - SELECT REQUEST BLOCK, JFCB, NEW DD ENTRY,        @G24LB18*/ 00381000
*/*          LENGTH OF DD ENTRY, AND NO. OF VOL SERS.        @G24LB18*/ 00382000
*/*                                                          @G24LB18*/ 00383000
*/* OUTPUT - COMPLETED DD ENTRY                              @G24LB18*/ 00384000
*/*                                                          @G24LB18*/ 00385000
*/*********************************************************  @G24LB18*/ 00386000
*                                                                  0136 00387000
*FILDDENT:                                                         0136 00388000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00389000
*                                                                  0136 00390000
FILDDENT DS    0H                                                  0137 00391000
*   /*****************************************************************/ 00392000
*   /*                                                               */ 00393000
*   /* STORE THE LENGTH OF THE ENTRY AND THE NO. OF VOL SERS @G24LB18*/ 00394000
*   /* REQUESTED INTO THE DD ENTRY. COPY THE DD # FROM THE   @G24LB18*/ 00395000
*   /* SELECT REQUEST BLOCK INTO THE ENTRY.                  @G24LB18*/ 00396000
*   /*                                                               */ 00397000
*   /*****************************************************************/ 00398000
*                                                                  0137 00399000
*   STPDDLEN=GETLEN;                /* STORE LENGTH INTO ENT @G24LB18*/ 00400000
         L     @15,GETLEN                                          0137 00401000
         STH   @15,STPDDLEN(,DDENTPTR)                             0137 00402000
*   STPDDNVL=NVOL;                  /* STORE NO. OF VOLS     @G24LB18*/ 00403000
         STC   NVOL,STPDDNVL(,DDENTPTR)                            0138 00404000
*   STPDDNUM=SELDDNUM;              /* COPY DD #             @G24LB18*/ 00405000
*                                                                  0139 00406000
         L     @15,TABSELRB(,PARMPTR)                              0139 00407000
         LH    @07,SELDDNUM(,@15)                                  0139 00408000
         STH   @07,STPDDNUM(,DDENTPTR)                             0139 00409000
*   /*****************************************************************/ 00410000
*   /*                                                               */ 00411000
*   /* IF A SPECIFIC UNIT ADDRESS WAS REQUESTED, COPY THE    @G24LB18*/ 00412000
*   /* UCB ADDRESS FROM THE SELECT REQUEST BLOCK INTO THE    @G24LB18*/ 00413000
*   /* INTERNAL DEVICE TYPE FIELD OF THE DD ENTRY. OTHERWISE @G24LB18*/ 00414000
*   /* COPY THE INTERNAL DEVICE TYPE FROM THE SELECT REQUEST @G24LB18*/ 00415000
*   /* BLOCK INTO THE DD ENTRY.                              @G24LB18*/ 00416000
*   /*                                                               */ 00417000
*   /*****************************************************************/ 00418000
*                                                                  0140 00419000
*   IF SELUCBAD¬=ZERO THEN          /* SPECIFIC UNIT ADDR?   @G24LB18*/ 00420000
         L     @15,SELUCBAD(,@15)                                  0140 00421000
         LTR   @15,@15                                             0140 00422000
         BZ    @RF00140                                            0140 00423000
*     STPDDDVT=SELUCBAD;            /* YES-COPY UCB ADDR     @G24LB18*/ 00424000
         ST    @15,STPDDDVT(,DDENTPTR)                             0141 00425000
*   ELSE                            /* INTO INT DEV TYPE     @G24LB18*/ 00426000
*     STPDDDVT=SELDEVTP;            /* NO-COPY INT DEV TYPE  @G24LB18*/ 00427000
         B     @RC00140                                            0142 00428000
@RF00140 L     @15,TABSELRB(,PARMPTR)                              0142 00429000
         MVC   STPDDDVT(4,DDENTPTR),SELDEVTP(@15)                  0142 00430000
*                                                                  0143 00431000
*   /*****************************************************************/ 00432000
*   /*                                                               */ 00433000
*   /* IF THE REQUEST IS FOR DEFERRED MOUNT OR UNIT=AFF, OR  @G24LB18*/ 00434000
*   /* IF VOLUME COUNT > UNIT COUNT AND PARALLEL MOUNT IS    @G24LB18*/ 00435000
*   /* NOT REQUESTED, TURN ON THE EXCLUSIVE USE INDICATOR IN @G24LB18*/ 00436000
*   /* THE DD ENTRY.                                         @G24LB18*/ 00437000
*   /*                                                               */ 00438000
*   /*****************************************************************/ 00439000
*                                                                  0143 00440000
*   IF JFCBVLCT=ZERO THEN           /* ANY NON-SPECIFIC VOL? @G24LB18*/ 00441000
@RC00140 L     @15,JFCBPTR                                         0143 00442000
         CLI   JFCBVLCT(@15),0                                     0143 00443000
         BNE   @RF00143                                            0143 00444000
*     NVOL=JFCBNVOL;                /* NO-VOL CNT= JFCBNVOL  @G24LB18*/ 00445000
         SLR   NVOL,NVOL                                           0144 00446000
         IC    NVOL,JFCBNVOL(,@15)                                 0144 00447000
*   ELSE                            /* YES -                 @G24LB18*/ 00448000
*     NVOL=JFCBVLCT;                /* VOL COUNT = JFCBVLCT  @G24LB18*/ 00449000
         B     @RC00143                                            0145 00450000
@RF00143 L     @15,JFCBPTR                                         0145 00451000
         SLR   NVOL,NVOL                                           0145 00452000
         IC    NVOL,JFCBVLCT(,@15)                                 0145 00453000
*   IF SELDEFER=ON|                 /* DEFERRED MOUNT OR     @G24LB18*/ 00454000
*       JFCBUAFF=ON|                /* UNIT=AFF OR           @G24LB18*/ 00455000
*       (NVOL>SELUNCNT&             /* VOL CNT > UNIT CNT &  @G24LB18*/ 00456000
*       SELPARMT=OFF) THEN          /* NO PARALLEL MOUNT?    @G24LB18*/ 00457000
@RC00143 L     @15,TABSELRB(,PARMPTR)                              0146 00458000
         TM    SELDEFER(@15),B'01000000'                           0146 00459000
         BO    @RT00146                                            0146 00460000
         L     @08,JFCBPTR                                         0146 00461000
         TM    JFCBUAFF(@08),B'00000001'                           0146 00462000
         BO    @RT00146                                            0146 00463000
         SLR   @08,@08                                             0146 00464000
         IC    @08,SELUNCNT(,@15)                                  0146 00465000
         CR    NVOL,@08                                            0146 00466000
         BNH   @RF00146                                            0146 00467000
         TM    SELPARMT(@15),B'10000000'                           0146 00468000
         BNZ   @RF00146                                            0146 00469000
@RT00146 DS    0H                                                  0147 00470000
*     STPDDEXC=ON;                  /* YES-SET EXCLUSIVE IND @G24LB18*/ 00471000
*                                                                  0147 00472000
         OI    STPDDEXC(DDENTPTR),B'10000000'                      0147 00473000
*   /*****************************************************************/ 00474000
*   /*                                                               */ 00475000
*   /* DETERMINE THE NUMBER OF VOL SERS IN THE JFCB AND MOVE @G24LB18*/ 00476000
*   /* THEM INTO THE DD ENTRY. IF THERE ARE JFCB EXTENSIONS, @G24LB18*/ 00477000
*   /* CALL SUBPROCEDURE MOVEEXT TO MOVE THE VOL SERS FROM   @G24LB18*/ 00478000
*   /* THE EXTENSIONS INTO THE DD ENTRY. RETURN TO BLDDDENT. @G24LB18*/ 00479000
*   /*                                                               */ 00480000
*   /*****************************************************************/ 00481000
*                                                                  0148 00482000
*   IF STPDDNVL>FIVE THEN           /* NO. OF VOLS > 5?      @G24LB18*/ 00483000
@RF00146 CLI   STPDDNVL(DDENTPTR),5                                0148 00484000
         BNH   @RF00148                                            0148 00485000
*     NVOL=FIVE;                    /* YES-SET NO. VOLS = 5  @G24LB18*/ 00486000
         LA    NVOL,5                                              0149 00487000
*   ELSE                            /* NO -                  @G24LB18*/ 00488000
*     NVOL=STPDDNVL;                /* SET NO. VOLS FROM ENT @G24LB18*/ 00489000
         B     @RC00148                                            0150 00490000
@RF00148 SLR   NVOL,NVOL                                           0150 00491000
         IC    NVOL,STPDDNVL(,DDENTPTR)                            0150 00492000
*   RFY                                                            0151 00493000
*     REG1 RSTD;                    /* RESTRICT REG 1        @G24LB18*/ 00494000
@RC00148 DS    0H                                                  0152 00495000
*   REG1=NVOL*SIX;                  /* GET LENGTH OF VOLSERS @G24LB18*/ 00496000
         LR    REG1,NVOL                                           0152 00497000
         MH    REG1,@CH00061                                       0152 00498000
*   STPDDVOL(ONE)=JFCBVOLS(1:REG1); /* COPY VOLSERS INTO ENT @G24LB18*/ 00499000
         MVI   STPDDVOL+1(DDENTPTR),C' '                           0153 00500000
         MVC   STPDDVOL+2(4,DDENTPTR),STPDDVOL+1(DDENTPTR)         0153 00501000
         LR    @15,REG1                                            0153 00502000
         BCTR  @15,0                                               0153 00503000
         L     @07,JFCBPTR                                         0153 00504000
         EX    @15,@SM01548                                        0153 00505000
*   RFY                                                            0154 00506000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00507000
*   IF SELJFCBX¬=ZERO THEN          /* ANY JFCB EXTENSIONS?  @G24LB18*/ 00508000
         L     @15,TABSELRB(,PARMPTR)                              0155 00509000
         L     @15,SELJFCBX(,@15)                                  0155 00510000
         LTR   @15,@15                                             0155 00511000
         BZ    @RF00155                                            0155 00512000
*     DO;                           /* YES                   @G24LB18*/ 00513000
*       SAVERET2=REG14;             /* SAVE RETURN ADDRESS   @G24LB18*/ 00514000
         ST    REG14,SAVERET2                                      0157 00515000
*       CALL MOVEEXT;               /* CALL MOVE VOLSERS RTN @G24LB18*/ 00516000
         BAL   @14,MOVEEXT                                         0158 00517000
*       REG14=SAVERET2;             /* RESTORE RETURN ADDR   @G24LB18*/ 00518000
         L     REG14,SAVERET2                                      0159 00519000
*     END;                          /*                       @G24LB18*/ 00520000
*   RETURN;                         /* RETURN TO BLDDDENT    @G24LB18*/ 00521000
@EL00003 DS    0H                                                  0161 00522000
@EF00003 DS    0H                                                  0161 00523000
@ER00003 BR    @14                                                 0161 00524000
*   END FILDDENT;                   /* END FILL DD ENT RTN   @G24LB18*/ 00525000
         B     @EL00003                                            0162 00526000
*                                                                  0163 00527000
*/*********************************************************  @G24LB18*/ 00528000
*/*                                                          @G24LB18*/ 00529000
*/* PROCEDURE NAME - MOVEEXT                                 @G24LB18*/ 00530000
*/*                                                          @G24LB18*/ 00531000
*/* FUNCTION - THIS ROUTINE IS CALLED ON BUILD DD ENTRY      @G24LB18*/ 00532000
*/*            REQUESTS WITH JFCB EXTENSIONS. IT MOVES THE   @G24LB18*/ 00533000
*/*            VOL SERS FROM THE EXTENSIONS INTO THE DD      @G24LB18*/ 00534000
*/*            ENTRY.                                        @G24LB18*/ 00535000
*/*                                                          @G24LB18*/ 00536000
*/* INPUT - SELECT REQUEST BLOCK, JFCB, JFCB EXTENSIONS,     @G24LB18*/ 00537000
*/*         AND DD ENTRY.                                    @G24LB18*/ 00538000
*/*                                                          @G24LB18*/ 00539000
*/* OUTPUT - DD ENTRY CONTAINING VOL SERS FROM THE JFCB      @G24LB18*/ 00540000
*/*          EXTENSIONS.                                     @G24LB18*/ 00541000
*/*                                                          @G24LB18*/ 00542000
*/*********************************************************  @G24LB18*/ 00543000
*                                                                  0163 00544000
*MOVEEXT:                                                          0163 00545000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00546000
*                                                                  0163 00547000
MOVEEXT  DS    0H                                                  0164 00548000
*   /*****************************************************************/ 00549000
*   /*                                                               */ 00550000
*   /* INITIALIZE THE JFCB EXTENSION POINTER, THE DD ENTRY   @G24LB18*/ 00551000
*   /* VOL SER INDEX, AND THE TOTAL NO. OF VOL SERS.         @G24LB18*/ 00552000
*   /*                                                               */ 00553000
*   /*****************************************************************/ 00554000
*                                                                  0164 00555000
*   JFCBXPTR=SELJFCBX;              /* SET JFCBX PTR         @G24LB18*/ 00556000
         L     @15,TABSELRB(,PARMPTR)                              0164 00557000
         L     JFCBXPTR,SELJFCBX(,@15)                             0164 00558000
*   INDEX=SIX;                      /* INIT DD ENTRY INDEX   @G24LB18*/ 00559000
         MVI   INDEX,X'06'                                         0165 00560000
*   NVOL=JFCBNVOL-FIVE;             /* SET NO. OF VOL SERS   @G24LB18*/ 00561000
         L     @15,JFCBPTR                                         0166 00562000
         SLR   NVOL,NVOL                                           0166 00563000
         IC    NVOL,JFCBNVOL(,@15)                                 0166 00564000
         SL    NVOL,@CF00059                                       0166 00565000
*   RFY                                                            0167 00566000
*     REG1 RSTD;                    /* RESTRICT REG 1        @G24LB18*/ 00567000
*                                                                  0167 00568000
*   /*****************************************************************/ 00569000
*   /*                                                               */ 00570000
*   /* COPY THE VOL SERS FROM EACH JFCB EXTENSION INTO THE   @G24LB18*/ 00571000
*   /* DD ENTRY AND RETURN TO FILDDENT.                      @G24LB18*/ 00572000
*   /*                                                               */ 00573000
*   /*****************************************************************/ 00574000
*                                                                  0168 00575000
*   DO WHILE JFCBXNXT¬=ZERO;        /* DO FOR EACH EXTENSION @G24LB18*/ 00576000
         B     @DE00168                                            0168 00577000
@DL00168 DS    0H                                                  0169 00578000
*     STPDDVOL(INDEX,1:LENGTH(VOLJFCBX))=VOLJFCBX;/* COPY VOLSERS  0169 00579000
*                                      FROM EXTENSION        @G24LB18*/ 00580000
         SLR   @15,@15                                             0169 00581000
         IC    @15,INDEX                                           0169 00582000
         LR    @08,@15                                             0169 00583000
         MH    @08,@CH00061                                        0169 00584000
         ALR   @08,DDENTPTR                                        0169 00585000
         MVC   STPDDVOL-6(90,@08),VOLJFCBX(JFCBXPTR)               0169 00586000
*     JFCBXPTR=JFCBXNXT;            /* GET NEXT JFCB EXTN    @G24LB18*/ 00587000
         L     JFCBXPTR,JFCBXNXT(,JFCBXPTR)                        0170 00588000
*     INDEX=INDEX+FIFTEEN;          /* INCREMENT DD ENT INDX @G24LB18*/ 00589000
         LA    @08,15                                              0171 00590000
         ALR   @15,@08                                             0171 00591000
         STC   @15,INDEX                                           0171 00592000
*     NVOL=NVOL-FIFTEEN;            /* DECREMENT NO. OF VOLS @G24LB18*/ 00593000
         SLR   NVOL,@08                                            0172 00594000
*   END;                            /*                       @G24LB18*/ 00595000
@DE00168 L     @15,JFCBXNXT(,JFCBXPTR)                             0173 00596000
         LTR   @15,@15                                             0173 00597000
         BNZ   @DL00168                                            0173 00598000
*   REG1=NVOL*SIX;                  /* GET LENGTH OF VOLSERS @G24LB18*/ 00599000
         LA    @15,6                                               0174 00600000
         LR    REG1,NVOL                                           0174 00601000
         MR    @00,@15                                             0174 00602000
*   STPDDVOL(INDEX)=JFCBXVOL(1,1:REG1);/* COPY VOLSERS FROM  @G24LB18   00603000
*                                      LAST EXTN             @G24LB18*/ 00604000
         LR    @03,@15                                             0175 00605000
         SLR   @15,@15                                             0175 00606000
         IC    @15,INDEX                                           0175 00607000
         MR    @02,@15                                             0175 00608000
         ALR   @03,DDENTPTR                                        0175 00609000
         MVI   STPDDVOL-5(@03),C' '                                0175 00610000
         MVC   STPDDVOL-4(4,@03),STPDDVOL-5(@03)                   0175 00611000
         LR    @15,REG1                                            0175 00612000
         BCTR  @15,0                                               0175 00613000
         EX    @15,@SM01550                                        0175 00614000
*   RFY                                                            0176 00615000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00616000
*   RETURN;                         /* RETURN TO FILDDENT    @G24LB18*/ 00617000
@EL00004 DS    0H                                                  0177 00618000
@EF00004 DS    0H                                                  0177 00619000
@ER00004 BR    @14                                                 0177 00620000
*   END MOVEEXT;                    /* END MOVE VOLSERS RTN  @G24LB18*/ 00621000
*                                                                  0179 00622000
*/*********************************************************  @G24LB18*/ 00623000
*/*                                                          @G24LB18*/ 00624000
*/* PROCEDURE NAME - BLDSTHDR                                @G24LB18*/ 00625000
*/*                                                          @G24LB18*/ 00626000
*/* FUNCTION - THIS ROUTINE IS CALLED ON BUILD DD ENTRY      @G24LB18*/ 00627000
*/*            REQUESTS FOR WHICH A STEP TABLE DOES NOT      @G24LB18*/ 00628000
*/*            ALREADY EXIST. IT GETS STORAGE FOR A STEP     @G24LB18*/ 00629000
*/*            TABLE HEADER, FILLS IN THE HEADER, CHAINS     @G24LB18*/ 00630000
*/*            THE NEW DD ENTRY TO THE HEADER, AND CHAINS    @G24LB18*/ 00631000
*/*            THE HEADER TO THE END OF THE STEP TABLE       @G24LB18*/ 00632000
*/*            CHAIN.                                        @G24LB18*/ 00633000
*/*                                                          @G24LB18*/ 00634000
*/* INPUT - SELECT REQUEST BLOCK, VVICB, AND NEW DD ENTRY.   @G24LB18*/ 00635000
*/*                                                          @G24LB18*/ 00636000
*/* OUTPUT - A NEW STEP TABLE HEADER WITH THE NEW DD ENTRY   @G24LB18*/ 00637000
*/*          CHAINED TO IT IS BUILT AND ADDED TO THE STEP    @G24LB18*/ 00638000
*/*          TABLE CHAIN. A RETURN CODE OF 0 IS RETURNED IF  @G24LB18*/ 00639000
*/*          THE HEADER IS BUILT SUCCESSFULLY. IF A GETMAIN  @G24LB18*/ 00640000
*/*          FAILURE OCCURS, CONSOLE ERROR MESSAGE ICB409I   @G24LB18*/ 00641000
*/*          'NO STORAGE AVAILABLE' IS ISSUED, THE NEW DD    @G24LB18*/ 00642000
*/*          ENTRY IS FREEMAINED, AND A RETURN CODE = 4 IS   @G24LB18*/ 00643000
*/*          RETURNED.                                       @G24LB18*/ 00644000
*/*                                                          @G24LB18*/ 00645000
*/*********************************************************  @G24LB18*/ 00646000
*                                                                  0179 00647000
*BLDSTHDR:                                                         0179 00648000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00649000
*                                                                  0179 00650000
BLDSTHDR DS    0H                                                  0180 00651000
*   /*****************************************************************/ 00652000
*   /*                                                               */ 00653000
*   /* RELEASE THE CMS AND LOCAL LOCKS AND ISSUE A GETMAIN   @G24LB18*/ 00654000
*   /* FOR THE STEP TABLE HEADER.                            @G24LB18*/ 00655000
*   /*                                                               */ 00656000
*   /*****************************************************************/ 00657000
*                                                                  0180 00658000
*   SAVERET2=REG14;                 /* SAVE RETURN ADDR      @G24LB18*/ 00659000
         ST    REG14,SAVERET2                                      0180 00660000
*   GENERATE;                                                      0181 00661000
*                                                          /*@G24LB18*/ 00662000
LFRECMS2 SETLOCK RELEASE,TYPE=CMS,REGS=USE,                            *00663000
               RELATED=(ICBVTP01(LGETCMS2))                             00664000
LFRELCL2 SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                          *00665000
               RELATED=(ICBVTP01(LGETLCL2))                             00666000
*   RFY                                                            0182 00667000
*     REG0 RSTD;                    /* RESTRICT REG 0        @G24LB18*/ 00668000
*   RFY                                                            0183 00669000
*     REG1 RSTD;                    /* RESTRICT REG 1        @G24LB18*/ 00670000
*   RFY                                                            0184 00671000
*     REG15 RSTD;                   /* RESTRICT REG 15       @G24LB18*/ 00672000
*   RETCODE=ZERO;                   /* ZERO RETURN CODE      @G24LB18*/ 00673000
         SLR   RETCODE,RETCODE                                     0185 00674000
*   REG0=LENGTH(STPTB);             /* SET LENGTH OF HDR     @G24LB18*/ 00675000
         LA    REG0,20                                             0186 00676000
*LGET2:                                                            0187 00677000
*   GEN(GETMAIN RC,LV=(0),SP=241);  /* GETMAIN HEADER        @G24LB18*/ 00678000
LGET2    GETMAIN RC,LV=(0),SP=241                                       00679000
*                                                                  0188 00680000
*   /*****************************************************************/ 00681000
*   /*                                                               */ 00682000
*   /* IF THE GETMAIN FAILS, ISSUE CONSOLE ERROR MESSAGE     @G24LB18*/ 00683000
*   /* ICB409I 'NO STORAGE AVAILABLE', FREEMAIN THE NEW DD   @G24LB18*/ 00684000
*   /* ENTRY, SET RETURN CODE = 4, AND RETURN TO BLDDDENT.   @G24LB18*/ 00685000
*   /*                                                               */ 00686000
*   /*****************************************************************/ 00687000
*                                                                  0188 00688000
*   IF REG15¬=ZERO THEN             /* STORAGE GOTTEN?       @G24LB18*/ 00689000
         LTR   REG15,REG15                                         0188 00690000
         BZ    @RF00188                                            0188 00691000
*     DO;                           /* NO                    @G24LB18*/ 00692000
*       REG1=ADDR(MSG1);            /* POINT TO ERROR MSG    @G24LB18*/ 00693000
         LA    REG1,MSG1                                           0190 00694000
*LWTO2:                                                            0191 00695000
*       GEN(WTO   MF=(E,(REG1)));   /* ISSUE ERROR MESSAGE   @G24LB18*/ 00696000
LWTO2    WTO   MF=(E,(REG1))                                            00697000
*       REG0=STPDDLEN;              /* GET LENGTH OF DD ENT  @G24LB18*/ 00698000
         LH    REG0,STPDDLEN(,DDENTPTR)                            0192 00699000
*       REG1=DDENTPTR;              /* GET ADDR OF DD ENTRY  @G24LB18*/ 00700000
         LR    REG1,DDENTPTR                                       0193 00701000
*LFREM1:                                                           0194 00702000
*       GEN(FREEMAIN RC,LV=(0),A=(1),SP=241);/* FREEMAIN ENT @G24LB18*/ 00703000
LFREM1   FREEMAIN RC,LV=(0),A=(1),SP=241                                00704000
*       REG14=SAVERET2;             /* RESTORE RET ADDR      @G24LB18*/ 00705000
         L     REG14,SAVERET2                                      0195 00706000
*       RETCODE=FOUR;               /* SET RETURN CODE = 4   @G24LB18*/ 00707000
         LA    RETCODE,4                                           0196 00708000
*       RETURN;                     /* RETURN TO BLDDDENT    @G24LB18*/ 00709000
@EL00005 DS    0H                                                  0197 00710000
@EF00005 DS    0H                                                  0197 00711000
@ER00005 BR    @14                                                 0197 00712000
*     END;                          /*                       @G24LB18*/ 00713000
*                                                                  0198 00714000
*   /*****************************************************************/ 00715000
*   /*                                                               */ 00716000
*   /* CLEAR THE STEP TABLE HEADER AND COPY THE JOBID FROM   @G24LB18*/ 00717000
*   /* THE SELECT REQUEST BLOCK INTO IT. STORE THE LENGTH OF @G24LB18*/ 00718000
*   /* THE HEADER AND THE ADDRESS OF THE NEW DD ENTRY INTO   @G24LB18*/ 00719000
*   /* THE HEADER. INITIALIZE THE INITIAL CALL COUNTER TO 1. @G24LB18*/ 00720000
*   /*                                                               */ 00721000
*   /*****************************************************************/ 00722000
*                                                                  0199 00723000
*   STHDRPTR=REG1;                  /* SET UP HEADER PTR     @G24LB18*/ 00724000
@RF00188 LR    STHDRPTR,REG1                                       0199 00725000
*   STPTB=STPTB&&STPTB;             /* CLEAR HEADER          @G24LB18*/ 00726000
         XC    STPTB(20,STHDRPTR),STPTB(STHDRPTR)                  0200 00727000
*   STPJOBID=SELJOBID;              /* COPY JOBID INTO HDR   @G24LB18*/ 00728000
         L     @08,TABSELRB(,PARMPTR)                              0201 00729000
         L     @08,SELJOBID(,@08)                                  0201 00730000
         ST    @08,STPJOBID(,STHDRPTR)                             0201 00731000
*   STPHDRLN=LENGTH(STPTB);         /* STORE LENGTH OF HDR   @G24LB18*/ 00732000
         MVC   STPHDRLN(2,STHDRPTR),@CH01481                       0202 00733000
*   STPDDPTR=DDENTPTR;              /* CHAIN DD ENTRY TO HDR @G24LB18*/ 00734000
         ST    DDENTPTR,STPDDPTR(,STHDRPTR)                        0203 00735000
*   SAVENTRY=STHDRPTR;              /* SAVE HEADER PTR       @G24LB18*/ 00736000
         LR    SAVENTRY,STHDRPTR                                   0204 00737000
*   STPICCTR=ONE;                   /* SET INIT CALL CTR = 1 @G24LB18*/ 00738000
         MVI   STPICCTR(STHDRPTR),X'01'                            0205 00739000
*                                                                  0206 00740000
*   /*****************************************************************/ 00741000
*   /*                                                               */ 00742000
*   /* SET THE LOCAL AND CMS LOCKS AND SEARCH FOR THE END OF @G24LB18*/ 00743000
*   /* THE STEP TABLE CHAIN. ADD THE NEW STEP TABLE HEADER   @G24LB18*/ 00744000
*   /* TO THE END OF THE CHAIN AND RETURN TO BLDDDENT.       @G24LB18*/ 00745000
*   /*                                                               */ 00746000
*   /*****************************************************************/ 00747000
*                                                                  0206 00748000
*   GENERATE;                                                      0206 00749000
*                                                          /*@G24LB18*/ 00750000
LGETLCL3 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               *00751000
               RELATED=(ICBVTP01(LFRELCL1))                             00752000
LGETCMS3 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,                 *00753000
               RELATED=(ICBVTP01(LFRECMS1))                             00754000
*   STHDRPTR=ADDR(VVISTPTB);        /* GET 1ST HEADER PTR    @G24LB18*/ 00755000
         L     STHDRPTR,VVIPTR                                     0207 00756000
         LA    STHDRPTR,VVISTPTB(,STHDRPTR)                        0207 00757000
*   DO WHILE STPNXTTB¬=ZERO;        /* IS IT LAST HEADER?    @G24LB18*/ 00758000
         B     @DE00208                                            0208 00759000
@DL00208 DS    0H                                                  0209 00760000
*     STHDRPTR=STPNXTTB;            /* NO-GET NEXT HEADER    @G24LB18*/ 00761000
         L     STHDRPTR,STPNXTTB(,STHDRPTR)                        0209 00762000
*   END;                            /* YES -                 @G24LB18*/ 00763000
@DE00208 L     @08,STPNXTTB(,STHDRPTR)                             0210 00764000
         LTR   @08,@08                                             0210 00765000
         BNZ   @DL00208                                            0210 00766000
*   STPNXTTB=SAVENTRY;              /* CHAIN NEW HDR TO LAST @G24LB18*/ 00767000
         ST    SAVENTRY,STPNXTTB(,STHDRPTR)                        0211 00768000
*   SAVENTRY->STPPRVTB=STHDRPTR;    /* SET BACKWARD PTR      @G24LB18*/ 00769000
         ST    STHDRPTR,STPPRVTB(,SAVENTRY)                        0212 00770000
*   RFY                                                            0213 00771000
*     REG0 UNRSTD;                  /* UNRESTRICT REG 0      @G24LB18*/ 00772000
*   RFY                                                            0214 00773000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 00774000
*   RFY                                                            0215 00775000
*     REG15 UNRSTD;                 /* UNRESTRICT REG 15     @G24LB18*/ 00776000
*   REG14=SAVERET2;                 /* RESTORE RETURN ADDR   @G24LB18*/ 00777000
         L     REG14,SAVERET2                                      0216 00778000
*   RETURN;                         /* RETURN TO BLDDDENT    @G24LB18*/ 00779000
         B     @EL00005                                            0217 00780000
*   END BLDSTHDR;                   /* END BUILD HEADER RTN  @G24LB18*/ 00781000
*                                                                  0219 00782000
*/*********************************************************  @G24LB18*/ 00783000
*/*                                                          @G24LB18*/ 00784000
*/* PROCEDURE NAME - SRCDDENT                                @G24LB18*/ 00785000
*/*                                                          @G24LB18*/ 00786000
*/* FUNCTION - THIS ROUTINE IS CALLED ON SEARCH FOR DD ENTRY @G24LB18*/ 00787000
*/*            REQUESTS. IT SEARCHES FOR THE STEP TABLE      @G24LB18*/ 00788000
*/*            HEADER FOR THE REQUEST AND THEN SEARCHES THE  @G24LB18*/ 00789000
*/*            DD ENTRIES IN THAT STEP TABLE FOR ONE WHOSE   @G24LB18*/ 00790000
*/*            DD # MATCHES THE DD # PASSED WITH THE         @G24LB18*/ 00791000
*/*            REQUEST.                                      @G24LB18*/ 00792000
*/*                                                          @G24LB18*/ 00793000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST           @G24LB18*/ 00794000
*/*                                                          @G24LB18*/ 00795000
*/* OUTPUT - IF A MATCHING DD ENTRY IS FOUND, ITS ADDRESS    @G24LB18*/ 00796000
*/*          IS RETURNED IN THE TABP PARM LIST ALONG WITH A  @G24LB18*/ 00797000
*/*          RETURN CODE = 0. IF NO MATCHING DD ENTRY IS     @G24LB18*/ 00798000
*/*          FOUND OR IF NO STEP TABLE HEADER IS FOUND FOR   @G24LB18*/ 00799000
*/*          THE REQUEST, A RETURN CODE = 4 IS RETURNED.     @G24LB18*/ 00800000
*/*                                                          @G24LB18*/ 00801000
*/*********************************************************  @G24LB18*/ 00802000
*                                                                  0219 00803000
*SRCDDENT:                                                         0219 00804000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00805000
*                                                                  0219 00806000
SRCDDENT DS    0H                                                  0220 00807000
*   /*****************************************************************/ 00808000
*   /*                                                               */ 00809000
*   /* CALL SUBPROCEDURE SRCJOBID TO SEARCH FOR THE STEP     @G24LB18*/ 00810000
*   /* TABLE HEADER FOR THE REQUEST. IF THE HEADER IS NOT    @G24LB18*/ 00811000
*   /* FOUND (RETURN CODE = 4), RETURN TO MAINLINE ICBVTP01. @G24LB18*/ 00812000
*   /*                                                               */ 00813000
*   /*****************************************************************/ 00814000
*                                                                  0220 00815000
*   SAVERET1=REG14;                 /* SAVE RETURN ADDRESS   @G24LB18*/ 00816000
         ST    REG14,SAVERET1                                      0220 00817000
*   JOBID=TABJOBID;                 /* GET JOBID             @G24LB18*/ 00818000
         L     JOBID,TABJOBID(,PARMPTR)                            0221 00819000
*   CALL SRCJOBID;                  /* CALL SEARCH RTN       @G24LB18*/ 00820000
         BAL   @14,SRCJOBID                                        0222 00821000
*   REG14=SAVERET1;                 /* RESTORE RETURN ADDR   @G24LB18*/ 00822000
         L     REG14,SAVERET1                                      0223 00823000
*   IF RETCODE=FOUR THEN            /* HEADER FOUND?         @G24LB18*/ 00824000
         C     RETCODE,@CF00057                                    0224 00825000
         BE    @RT00224                                            0224 00826000
*     RETURN;                       /* NO-RETURN TO ICBVTP01 @G24LB18*/ 00827000
*                                                                  0226 00828000
*   /*****************************************************************/ 00829000
*   /*                                                               */ 00830000
*   /* COMPARE THE DD # FROM THE PARM LIST TO THE DD # IN    @G24LB18*/ 00831000
*   /* EACH DD ENTRY IN THE STEP TABLE. IF A MATCH IS FOUND, @G24LB18*/ 00832000
*   /* STORE THE ADDRESS OF THE DD ENTRY IN THE PARM LIST    @G24LB18*/ 00833000
*   /* AND RETURN TO ICBVTP01. IF THE END OF THE STEP TABLE  @G24LB18*/ 00834000
*   /* IS REACHED BEFORE A MATCH IS FOUND, SET RETURN CODE   @G24LB18*/ 00835000
*   /* = 4 AND RETURN TO MAINLINE ICBVTP01.                  @G24LB18*/ 00836000
*   /*                                                               */ 00837000
*   /*****************************************************************/ 00838000
*                                                                  0226 00839000
*   DDENTPTR=STPDDPTR;              /* GET 1ST DD ENTRY PTR  @G24LB18*/ 00840000
         L     DDENTPTR,STPDDPTR(,STHDRPTR)                        0226 00841000
*   DO WHILE DDENTPTR¬=ZERO;        /* DO FOR EACH DD ENTRY  @G24LB18*/ 00842000
         B     @DE00227                                            0227 00843000
@DL00227 DS    0H                                                  0228 00844000
*     IF TABDDNUM=STPDDNUM THEN     /* DD #S MATCH?          @G24LB18*/ 00845000
         CLC   TABDDNUM(2,PARMPTR),STPDDNUM(DDENTPTR)              0228 00846000
         BNE   @RF00228                                            0228 00847000
*       DO;                         /* YES                   @G24LB18*/ 00848000
*         TABDDRET=DDENTPTR;        /* STORE DD ENTRY ADDR   @G24LB18*/ 00849000
         ST    DDENTPTR,TABDDRET(,PARMPTR)                         0230 00850000
*         RETURN;                   /* RETURN TO ICBVTP01    @G24LB18*/ 00851000
@EL00006 DS    0H                                                  0231 00852000
@EF00006 DS    0H                                                  0231 00853000
@ER00006 BR    @14                                                 0231 00854000
*       END;                        /*                       @G24LB18*/ 00855000
*     DDENTPTR=STPDDNXT;            /* GET NEXT DD ENTRY     @G24LB18*/ 00856000
@RF00228 L     DDENTPTR,STPDDNXT(,DDENTPTR)                        0233 00857000
*   END;                            /* NO MATCH FOUND        @G24LB18*/ 00858000
@DE00227 LTR   DDENTPTR,DDENTPTR                                   0234 00859000
         BNZ   @DL00227                                            0234 00860000
*   RETCODE=FOUR;                   /* SET RETURN CODE = 4   @G24LB18*/ 00861000
         LA    RETCODE,4                                           0235 00862000
*   RETURN;                         /* RETURN TO ICBVTP01    @G24LB18*/ 00863000
         B     @EL00006                                            0236 00864000
*   END SRCDDENT;                   /* END SEARCH FOR DD RTN @G24LB18*/ 00865000
         B     @EL00006                                            0237 00866000
*                                                                  0238 00867000
*/*********************************************************  @G24LB18*/ 00868000
*/*                                                          @G24LB18*/ 00869000
*/* PROCEDURE NAME - UNSUCTRM                                @G24LB18*/ 00870000
*/*                                                          @G24LB18*/ 00871000
*/* FUNCTION - THIS ROUTINE IS CALLED ON UNSUCCESSFUL        @G24LB18*/ 00872000
*/*            TERMINATION REQUESTS. IT SEARCHES FOR THE     @G24LB18*/ 00873000
*/*            STEP TABLE HEADER FOR THE REQUEST, MARKS IT   @G24LB18*/ 00874000
*/*            INVALID AND NOT TO BE FREED, AND RETURNS ITS  @G24LB18*/ 00875000
*/*            ADDRESS TO THE CALLER IN THE TABP PARM LIST.  @G24LB18*/ 00876000
*/*                                                          @G24LB18*/ 00877000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST           @G24LB18*/ 00878000
*/*                                                          @G24LB18*/ 00879000
*/* OUTPUT - IF THE STEP TABLE HEADER FOR THE REQUEST IS     @G24LB18*/ 00880000
*/*          FOUND, THE ADDRESS OF THE HEADER IS RETURNED    @G24LB18*/ 00881000
*/*          IN THE TABP PARM LIST ALONG WITH A RETURN       @G24LB18*/ 00882000
*/*          CODE = 0. IF THE HEADER IS NOT FOUND, A RETURN  @G24LB18*/ 00883000
*/*          CODE = 4 IS RETURNED.                           @G24LB18*/ 00884000
*/*                                                          @G24LB18*/ 00885000
*/*********************************************************  @G24LB18*/ 00886000
*                                                                  0238 00887000
*UNSUCTRM:                                                         0238 00888000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00889000
*                                                                  0238 00890000
UNSUCTRM DS    0H                                                  0239 00891000
*   /*****************************************************************/ 00892000
*   /*                                                               */ 00893000
*   /* CALL SUBPROCEDURE SRCJOBID TO SEARCH FOR THE STEP     @G24LB18*/ 00894000
*   /* TABLE HEADER FOR THE REQUEST. IF THE HEADER IS NOT    @G24LB18*/ 00895000
*   /* FOUND (RETURN CODE = 4), RETURN TO MAINLINE ICBVTP01. @G24LB18*/ 00896000
*   /*                                                               */ 00897000
*   /*****************************************************************/ 00898000
*                                                                  0239 00899000
*   SAVERET1=REG14;                 /* SAVE RETURN ADDRESS   @G24LB18*/ 00900000
         ST    REG14,SAVERET1                                      0239 00901000
*   JOBID=TABJOBID;                 /* GET JOBID             @G24LB18*/ 00902000
         L     JOBID,TABJOBID(,PARMPTR)                            0240 00903000
*   CALL SRCJOBID;                  /* CALL SEARCH RTN       @G24LB18*/ 00904000
         BAL   @14,SRCJOBID                                        0241 00905000
*   REG14=SAVERET1;                 /* RESTORE RETURN ADDR   @G24LB18*/ 00906000
         L     REG14,SAVERET1                                      0242 00907000
*   IF RETCODE=FOUR THEN            /* HEADER FOUND?         @G24LB18*/ 00908000
         C     RETCODE,@CF00057                                    0243 00909000
         BE    @RT00243                                            0243 00910000
*     RETURN;                       /* NO-RETURN TO ICBVTP01 @G24LB18*/ 00911000
*                                                                  0244 00912000
*   /*****************************************************************/ 00913000
*   /*                                                               */ 00914000
*   /* STORE THE ADDRESS OF THE STEP TABLE HEADER IN THE     @G24LB18*/ 00915000
*   /* PARM LIST. TURN ON THE INVALID AND DON'T FREE         @G24LB18*/ 00916000
*   /* INDICATORS IN THE HEADER AND RETURN TO MAINLINE       @G24LB18*/ 00917000
*   /* ICBVTP01.                                             @G24LB18*/ 00918000
*   /*                                                               */ 00919000
*   /*****************************************************************/ 00920000
*                                                                  0245 00921000
*   TABHDRET=STHDRPTR;              /* STORE HEADER ADDR     @G24LB18*/ 00922000
         ST    STHDRPTR,TABHDRET(,PARMPTR)                         0245 00923000
*   STPINVAL=ON;                    /* TURN ON INVALID IND   @G24LB18*/ 00924000
*   STPNOFRE=ON;                    /* TURN ON DON'T FREE    @G24LB18*/ 00925000
         OI    STPINVAL(STHDRPTR),B'11000000'                      0247 00926000
*   RETURN;                         /* RETURN TO ICBVTP01    @G24LB18*/ 00927000
@EL00007 DS    0H                                                  0248 00928000
@EF00007 DS    0H                                                  0248 00929000
@ER00007 BR    @14                                                 0248 00930000
*   END UNSUCTRM;                   /* END TERMINATION RTN   @G24LB18*/ 00931000
         B     @EL00007                                            0249 00932000
*                                                                  0250 00933000
*/*********************************************************  @G24LB18*/ 00934000
*/*                                                          @G24LB18*/ 00935000
*/* PROCEDURE NAME - FREESTAB                                @G24LB18*/ 00936000
*/*                                                          @G24LB18*/ 00937000
*/* FUNCTION - THIS ROUTINE IS CALLED ON FREE STEP TABLE     @G24LB18*/ 00938000
*/*            REQUESTS. IT BUILDS A CHAIN OF STEP TABLES TO @G24LB18*/ 00939000
*/*            BE FREED (VIA SUBPROCEDURE DECHAIN),          @G24LB18*/ 00940000
*/*            INCLUDING THE STEP TABLE FOR THE REQUEST AND  @G24LB18*/ 00941000
*/*            ALL INVALID TABLES THAT ARE NOT MARKED NOT TO @G24LB18*/ 00942000
*/*            BE FREED. IT THEN FREES THE HEADERS AND THE   @G24LB18*/ 00943000
*/*            DD ENTRIES ONE AT A TIME.                     @G24LB18*/ 00944000
*/*                                                          @G24LB18*/ 00945000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST, VVICB.   @G24LB18*/ 00946000
*/*                                                          @G24LB18*/ 00947000
*/* OUTPUT - FREED STEP TABLE HEADERS AND DD ENTRIES FOR THE @G24LB18*/ 00948000
*/*          REQUESTED STEP TABLE AND ANY INVALID FREEABLE   @G24LB18*/ 00949000
*/*          STEP TABLES.                                    @G24LB18*/ 00950000
*/*                                                          @G24LB18*/ 00951000
*/*********************************************************  @G24LB18*/ 00952000
*                                                                  0250 00953000
*FREESTAB:                                                         0250 00954000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 00955000
*                                                                  0250 00956000
FREESTAB DS    0H                                                  0251 00957000
*   /*****************************************************************/ 00958000
*   /*                                                               */ 00959000
*   /* CALL SUBPROCEDURE DECHAIN TO BUILD A CHAIN OF STEP    @G24LB18*/ 00960000
*   /* TABLES TO BE FREED.                                   @G24LB18*/ 00961000
*   /*                                                               */ 00962000
*   /*****************************************************************/ 00963000
*                                                                  0251 00964000
*   SAVERET1=REG14;                 /* SAVE RETURN ADDRESS   @G24LB18*/ 00965000
         ST    REG14,SAVERET1                                      0251 00966000
*   CALL DECHAIN;                   /* CALL DECHAIN RTN      @G24LB18*/ 00967000
*                                                                  0252 00968000
         BAL   @14,DECHAIN                                         0252 00969000
*   /*****************************************************************/ 00970000
*   /*                                                               */ 00971000
*   /* RELEASE CMS AND LOCAL LOCKS. IF FREE CHAIN POINTER    @G24LB18*/ 00972000
*   /* IS 0, RETURN TO MAINLINE ICBVTP01. DECHAIN THE 1ST    @G24LB18*/ 00973000
*   /* STEP TABLE AND SAVE THE 1ST DD ENTRY POINTER. FREE    @G24LB18*/ 00974000
*   /* THE STEP TABLE HEADER, THEN FREE EACH DD ENTRY,       @G24LB18*/ 00975000
*   /* SAVING THE NEXT DD ENTRY POINTER EACH TIME BEFORE     @G24LB18*/ 00976000
*   /* FREEING THE CURRENT ENTRY. WHEN THE NEXT DD ENTRY     @G24LB18*/ 00977000
*   /* POINTER IS 0, GET THE NEXT STEP TABLE ON THE FREE     @G24LB18*/ 00978000
*   /* CHAIN AND REPEAT THE PROCESS UNTIL THE FREE CHAIN     @G24LB18*/ 00979000
*   /* IS EMPTY. THEN RETURN TO MAINLINE ICBVTP01.           @G24LB18*/ 00980000
*   /*                                                               */ 00981000
*   /*****************************************************************/ 00982000
*                                                                  0253 00983000
*   RFY                                                            0253 00984000
*     REG0 RSTD;                    /* RESTRICT REG 0        @G24LB18*/ 00985000
*   RFY                                                            0254 00986000
*     REG1 RSTD;                    /* RESTRICT REG 1        @G24LB18*/ 00987000
*   GENERATE;                                                      0255 00988000
*                                                          /*@G24LB18*/ 00989000
LFRECMS3 SETLOCK RELEASE,TYPE=CMS,REGS=USE,                            *00990000
               RELATED=(ICBVTP01(LGETCMS1))                             00991000
LFRELCL3 SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                          *00992000
               RELATED=(ICBVTP01(LGETLCL1))                             00993000
*   DO WHILE VVITPFCH¬=ZERO;        /* DO FOR EACH TABLE     @G24LB18*/ 00994000
         B     @DE00256                                            0256 00995000
@DL00256 DS    0H                                                  0257 00996000
*     STHDRPTR=VVITPFCH;            /* GET STEP TABLE PTR    @G24LB18*/ 00997000
         L     @15,VVIPTR                                          0257 00998000
         L     STHDRPTR,VVITPFCH(,@15)                             0257 00999000
*     VVITPFCH=STPNXTTB;            /* DECHAIN STEP TABLE    @G24LB18*/ 01000000
         L     @08,STPNXTTB(,STHDRPTR)                             0258 01001000
         ST    @08,VVITPFCH(,@15)                                  0258 01002000
*     SAVENTRY=STPDDPTR;            /* SAVE 1ST DD ENTRY PTR @G24LB18*/ 01003000
         L     SAVENTRY,STPDDPTR(,STHDRPTR)                        0259 01004000
*     REG0=STPHDRLN;                /* GET HEADER LENGTH     @G24LB18*/ 01005000
         LH    REG0,STPHDRLN(,STHDRPTR)                            0260 01006000
*     REG1=STHDRPTR;                /* GET ADDR OF HEADER    @G24LB18*/ 01007000
         LR    REG1,STHDRPTR                                       0261 01008000
*LFREM2:                                                           0262 01009000
*     GEN(FREEMAIN RC,LV=(0),A=(1),SP=241);/* FREEMAIN HDR   @G24LB18*/ 01010000
LFREM2   FREEMAIN RC,LV=(0),A=(1),SP=241                                01011000
*     DO WHILE SAVENTRY¬=ZERO;      /* DO FOR EACH DD ENTRY  @G24LB18*/ 01012000
         B     @DE00263                                            0263 01013000
@DL00263 DS    0H                                                  0264 01014000
*       DDENTPTR=SAVENTRY;          /* GET DD ENTRY PTR      @G24LB18*/ 01015000
         LR    DDENTPTR,SAVENTRY                                   0264 01016000
*       SAVENTRY=STPDDNXT;          /* SAVE NEXT DD ENT PTR  @G24LB18*/ 01017000
         L     SAVENTRY,STPDDNXT(,DDENTPTR)                        0265 01018000
*       REG0=STPDDLEN;              /* GET LENGTH OF DD ENT  @G24LB18*/ 01019000
         LH    REG0,STPDDLEN(,DDENTPTR)                            0266 01020000
*       REG1=DDENTPTR;              /* GET ADDR OF DD ENTRY  @G24LB18*/ 01021000
         LR    REG1,DDENTPTR                                       0267 01022000
*LFREM3:                                                           0268 01023000
*       GEN(FREEMAIN RC,LV=(0),A=(1),SP=241);/* FREEMAIN ENT @G24LB18*/ 01024000
LFREM3   FREEMAIN RC,LV=(0),A=(1),SP=241                                01025000
*     END;                          /* END DD ENTRY LOOP     @G24LB18*/ 01026000
@DE00263 LTR   SAVENTRY,SAVENTRY                                   0269 01027000
         BNZ   @DL00263                                            0269 01028000
*   END;                            /* END STEP TABLE LOOP   @G24LB18*/ 01029000
@DE00256 L     @15,VVIPTR                                          0270 01030000
         L     @15,VVITPFCH(,@15)                                  0270 01031000
         LTR   @15,@15                                             0270 01032000
         BNZ   @DL00256                                            0270 01033000
*   RFY                                                            0271 01034000
*     REG0 UNRSTD;                  /* UNRESTRICT REG 0      @G24LB18*/ 01035000
*   RFY                                                            0272 01036000
*     REG1 UNRSTD;                  /* UNRESTRICT REG 1      @G24LB18*/ 01037000
*   REG14=SAVERET1;                 /* RESTORE RETURN ADDR   @G24LB18*/ 01038000
         L     REG14,SAVERET1                                      0273 01039000
*   RETURN;                         /* RETURN TO ICBVTP01    @G24LB18*/ 01040000
@EL00008 DS    0H                                                  0274 01041000
@EF00008 DS    0H                                                  0274 01042000
@ER00008 BR    @14                                                 0274 01043000
*   END FREESTAB;                   /* END FREE TABLES RTN   @G24LB18*/ 01044000
*                                                                  0276 01045000
*/*********************************************************  @G24LB18*/ 01046000
*/*                                                          @G24LB18*/ 01047000
*/* PROCEDURE NAME - DECHAIN                                 @G24LB18*/ 01048000
*/*                                                          @G24LB18*/ 01049000
*/* FUNCTION - THIS ROUTINE IS CALLED ON FREE STEP TABLE     @G24LB18*/ 01050000
*/*            REQUESTS. IT SEARCHES THE STEP TABLE CHAIN    @G24LB18*/ 01051000
*/*            FOR THE TABLE WHOSE JOBID MATCHES THE JOBID   @G24LB18*/ 01052000
*/*            PASSED WITH THE REQUEST. IT DECREMENTS THE    @G24LB18*/ 01053000
*/*            INITIAL CALL COUNTER FOR THE STEP BY ONE.     @G24LB18*/ 01054000
*/*            IF IT IS NOW 0, IT DECHAINS THE TABLE FROM    @G24LB18*/ 01055000
*/*            THE STEP TABLE CHAIN AND RECHAINS IT TO A     @G24LB18*/ 01056000
*/*            FREE CHAIN OF TABLES TO BE FREED. THE         @G24LB18*/ 01057000
*/*            ROUTINE ALSO SEARCHES THE STEP TABLE CHAIN    @G24LB18*/ 01058000
*/*            FOR ALL INVALID STEP TABLES WHICH CAN BE      @G24LB18*/ 01059000
*/*            FREED, DECHAINS THEM FROM THE STEP TABLE      @G24LB18*/ 01060000
*/*            CHAIN, AND RECHAINS THEM TO THE FREE CHAIN.   @G24LB18*/ 01061000
*/*                                                          @G24LB18*/ 01062000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST, VVICB    @G24LB18*/ 01063000
*/*                                                          @G24LB18*/ 01064000
*/* OUTPUT - THE STEP TABLE CHAIN WITH THE REQUESTED STEP    @G24LB18*/ 01065000
*/*          TABLE (IF THE INITIAL CALL COUNTER = 0) AND ALL @G24LB18*/ 01066000
*/*          INVALID FREEABLE STEP TABLES REMOVED, AND A     @G24LB18*/ 01067000
*/*          FREE CHAIN CONTAINING THE TABLES REMOVED FROM   @G24LB18*/ 01068000
*/*          THE STEP TABLE CHAIN.                           @G24LB18*/ 01069000
*/*                                                          @G24LB18*/ 01070000
*/*********************************************************  @G24LB18*/ 01071000
*                                                                  0276 01072000
*DECHAIN:                                                          0276 01073000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 01074000
*                                                                  0276 01075000
DECHAIN  DS    0H                                                  0277 01076000
*   /*****************************************************************/ 01077000
*   /*                                                               */ 01078000
*   /* GET THE ADDRESS OF STEP TABLE CHAIN FROM THE VVICB.   @G24LB18*/ 01079000
*   /* IF IT IS 0, RETURN TO FREESTAB. OTHERWISE GET THE     @G24LB18*/ 01080000
*   /* FIRST STEP TABLE HEADER.                              @G24LB18*/ 01081000
*   /*                                                               */ 01082000
*   /*****************************************************************/ 01083000
*                                                                  0277 01084000
*   STHDRPTR=VVISTPTB;              /* GET STEP TABLE CHAIN  @G24LB18*/ 01085000
         L     @15,VVIPTR                                          0277 01086000
         L     STHDRPTR,VVISTPTB(,@15)                             0277 01087000
*   DO WHILE STHDRPTR¬=ZERO;        /* DO FOR EACH HEADER    @G24LB18*/ 01088000
         B     @DE00278                                            0278 01089000
@DL00278 DS    0H                                                  0279 01090000
*                                                                  0279 01091000
*     /***************************************************************/ 01092000
*     /*                                                             */ 01093000
*     /* IF THE JOBID OF THE HEADER MATCHES THE JOBID IN THE @G24LB18*/ 01094000
*     /* PARM LIST, DECREMENT THE INITIAL CALL COUNTER BY 1. @G24LB18*/ 01095000
*     /* IF THE HEADER IS MARKED INVALID AND FREEABLE OR IF  @G24LB18*/ 01096000
*     /* THE JOBIDS MATCH AND THE INITIAL CALL COUNTER = 0,  @G24LB18*/ 01097000
*     /* DECHAIN THE HEADER FROM THE STEP TABLE CHAIN,       @G24LB18*/ 01098000
*     /* SAVING THE POINTER TO THE NEXT HEADER IN THE CHAIN. @G24LB18*/ 01099000
*     /*                                                             */ 01100000
*     /***************************************************************/ 01101000
*                                                                  0279 01102000
*     IF TABJOBID=STPJOBID THEN     /* JOBIDS MATCH?         @G24LB18*/ 01103000
         CLC   TABJOBID(4,PARMPTR),STPJOBID(STHDRPTR)              0279 01104000
         BNE   @RF00279                                            0279 01105000
*       STPICCTR=STPICCTR-ONE;      /* YES-DECREMENT COUNTER @G24LB18*/ 01106000
         SLR   @15,@15                                             0280 01107000
         IC    @15,STPICCTR(,STHDRPTR)                             0280 01108000
         BCTR  @15,0                                               0280 01109000
         STC   @15,STPICCTR(,STHDRPTR)                             0280 01110000
*     IF(STPINVAL=ON&               /* HEADER INVALID AND    @G24LB18*/ 01111000
*         STPNOFRE=OFF)|            /* FREEABLE OR           @G24LB18*/ 01112000
*         (TABJOBID=STPJOBID&       /* JOBIDS MATCH AND      @G24LB18*/ 01113000
*         STPICCTR=ZERO) THEN       /* INIT CALL CTR = 0?    @G24LB18*/ 01114000
@RF00279 TM    STPINVAL(STHDRPTR),B'10000000'                      0281 01115000
         BNO   @GL00004                                            0281 01116000
         TM    STPNOFRE(STHDRPTR),B'01000000'                      0281 01117000
         BZ    @RT00281                                            0281 01118000
@GL00004 CLC   TABJOBID(4,PARMPTR),STPJOBID(STHDRPTR)              0281 01119000
         BNE   @RF00281                                            0281 01120000
         CLI   STPICCTR(STHDRPTR),0                                0281 01121000
         BNE   @RF00281                                            0281 01122000
@RT00281 DS    0H                                                  0282 01123000
*       DO;                         /* YES                   @G24LB18*/ 01124000
*         NXTHDRSV=STPNXTTB;        /* SAVE NEXT HDR PTR     @G24LB18*/ 01125000
         L     @15,STPNXTTB(,STHDRPTR)                             0283 01126000
         LR    NXTHDRSV,@15                                        0283 01127000
*         STPPRVTB->STPNXTTB=STPNXTTB;/* DECHAIN HDR FROM PREV HDR   */ 01128000
         L     @07,STPPRVTB(,STHDRPTR)                             0284 01129000
         ST    @15,STPNXTTB(,@07)                                  0284 01130000
*         IF STPNXTTB¬=ZERO THEN    /* IF NEXT HDR EXISTS,   @G24LB18*/ 01131000
         LTR   @15,@15                                             0285 01132000
         BZ    @RF00285                                            0285 01133000
*           STPNXTTB->STPPRVTB=STPPRVTB;/* RECHAIN IT TO PREV HDR    */ 01134000
*                                                                  0286 01135000
         ST    @07,STPPRVTB(,@15)                                  0286 01136000
*         /***********************************************************/ 01137000
*         /*                                                         */ 01138000
*         /* GET THE FREE CHAIN POINTER. IF IT IS 0, CHAIN   @G24LB18*/ 01139000
*         /* THE DECHAINED HEADER TO IT. OTHERWISE SEARCH    @G24LB18*/ 01140000
*         /* THE FREE CHAIN FOR THE LAST ENTRY AND CHAIN THE @G24LB18*/ 01141000
*         /* DECHAINED HEADER TO IT. ZERO THE NEXT HEADER    @G24LB18*/ 01142000
*         /* POINTER FIELD IN THE HEADER, RESTORE THE        @G24LB18*/ 01143000
*         /* ADDRESS OF THE NEXT HEADER IN THE STEP TABLE    @G24LB18*/ 01144000
*         /* CHAIN AND CONTINUE SEARCHING FOR TABLES TO BE   @G24LB18*/ 01145000
*         /* FREED.                                          @G24LB18*/ 01146000
*         /*                                                         */ 01147000
*         /***********************************************************/ 01148000
*                                                                  0287 01149000
*         STPNXTTB=ZERO;            /* ZERO NEXT HDR PTR     @G24LB18*/ 01150000
@RF00285 SLR   @15,@15                                             0287 01151000
         ST    @15,STPNXTTB(,STHDRPTR)                             0287 01152000
*         SAVENTRY=STHDRPTR;        /* SAVE DECHAINED HDR    @G24LB18*/ 01153000
         LR    SAVENTRY,STHDRPTR                                   0288 01154000
*         STHDRPTR=ADDR(VVITPFCH);  /* GET FREE CHAIN PTR    @G24LB18*/ 01155000
         L     STHDRPTR,VVIPTR                                     0289 01156000
         LA    STHDRPTR,VVITPFCH(,STHDRPTR)                        0289 01157000
*         DO WHILE STPNXTTB¬=ZERO;  /* IS IT LAST HEADER?    @G24LB18*/ 01158000
         B     @DE00290                                            0290 01159000
@DL00290 DS    0H                                                  0291 01160000
*           STHDRPTR=STPNXTTB;      /* NO-GET NEXT HEADER    @G24LB18*/ 01161000
         L     STHDRPTR,STPNXTTB(,STHDRPTR)                        0291 01162000
*         END;                      /* LAST HEADER FOUND     @G24LB18*/ 01163000
@DE00290 L     @15,STPNXTTB(,STHDRPTR)                             0292 01164000
         LTR   @15,@15                                             0292 01165000
         BNZ   @DL00290                                            0292 01166000
*         STPNXTTB=SAVENTRY;        /* CHAIN HDR TO LAST     @G24LB18*/ 01167000
         ST    SAVENTRY,STPNXTTB(,STHDRPTR)                        0293 01168000
*         STHDRPTR=NXTHDRSV;        /* RESTORE NEXT HDR PTR  @G24LB18*/ 01169000
         LR    STHDRPTR,NXTHDRSV                                   0294 01170000
*       END;                        /* END STEP TABLE SEARCH @G24LB18*/ 01171000
*     ELSE                          /*                       @G24LB18*/ 01172000
*       STHDRPTR=STPNXTTB;          /* GET NEXT HEADER       @G24LB18*/ 01173000
         B     @RC00281                                            0296 01174000
@RF00281 L     STHDRPTR,STPNXTTB(,STHDRPTR)                        0296 01175000
*   END;                            /* END STEP TABLE SEARCH @G24LB18*/ 01176000
@RC00281 DS    0H                                                  0297 01177000
@DE00278 LTR   STHDRPTR,STHDRPTR                                   0297 01178000
         BNZ   @DL00278                                            0297 01179000
*   RETURN;                         /* RETURN TO FREESTAB    @G24LB18*/ 01180000
@EL00009 DS    0H                                                  0298 01181000
@EF00009 DS    0H                                                  0298 01182000
@ER00009 BR    @14                                                 0298 01183000
*   END DECHAIN;                    /* END DECHAIN TABLE RTN @G24LB18*/ 01184000
*                                                                  0300 01185000
*/*********************************************************  @G24LB18*/ 01186000
*/*                                                          @G24LB18*/ 01187000
*/* PROCEDURE NAME - SRCJOBID                                @G24LB18*/ 01188000
*/*                                                          @G24LB18*/ 01189000
*/* FUNCTION - THIS SUBROUTINE IS CALLED WHEN THE STEP TABLE @G24LB18*/ 01190000
*/*            FOR THE CURRENT REQUEST MUST BE FOUND. THE    @G24LB18*/ 01191000
*/*            ROUTINE SEARCHES THE STEP TABLE CHAIN FOR     @G24LB18*/ 01192000
*/*            THE STEP TABLE WHOSE JOBID MATCHES THE JOBID  @G24LB18*/ 01193000
*/*            PASSED WITH THE REQUEST.                      @G24LB18*/ 01194000
*/*                                                          @G24LB18*/ 01195000
*/* INPUT - TABLE PROCESSOR REQUEST PARAMETER LIST, VVICB    @G24LB18*/ 01196000
*/*                                                          @G24LB18*/ 01197000
*/* OUTPUT - IF A STEP TABLE IS FOUND WITH A MATCHING JOBID  @G24LB18*/ 01198000
*/*          AND IT IS NOT MARKED INVALID, ITS ADDRESS IS    @G24LB18*/ 01199000
*/*          RETURNED IN FIELD STHDRPTR WITH A RETURN CODE   @G24LB18*/ 01200000
*/*          OF 0. OTHERWISE, A RETURN CODE = 4 IS RETURNED. @G24LB18*/ 01201000
*/*                                                          @G24LB18*/ 01202000
*/*********************************************************  @G24LB18*/ 01203000
*                                                                  0300 01204000
*SRCJOBID:                                                         0300 01205000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB18*/ 01206000
*                                                                  0300 01207000
SRCJOBID DS    0H                                                  0301 01208000
*   /*****************************************************************/ 01209000
*   /*                                                               */ 01210000
*   /* GET THE ADDRESS OF THE STEP TABLE CHAIN FROM THE      @G24LB18*/ 01211000
*   /* VVICB. IF IT IS 0, RETURN TO THE CALLER WITH RETURN   @G24LB18*/ 01212000
*   /* CODE = 4. OTHERWISE GET THE FIRST STEP TABLE HEADER.  @G24LB18*/ 01213000
*   /*                                                               */ 01214000
*   /*****************************************************************/ 01215000
*                                                                  0301 01216000
*   STHDRPTR=ADDR(VVISTPTB);        /* GET STEP TABLE CHAIN  @G24LB18*/ 01217000
         L     STHDRPTR,VVIPTR                                     0301 01218000
         LA    STHDRPTR,VVISTPTB(,STHDRPTR)                        0301 01219000
*   DO WHILE STPNXTTB¬=ZERO;        /* DO FOR EACH HEADER    @G24LB18*/ 01220000
         B     @DE00302                                            0302 01221000
@DL00302 DS    0H                                                  0303 01222000
*     STHDRPTR=STPNXTTB;            /* GET NEXT HEADER       @G24LB18*/ 01223000
*                                                                  0303 01224000
         L     STHDRPTR,STPNXTTB(,STHDRPTR)                        0303 01225000
*     /***************************************************************/ 01226000
*     /*                                                             */ 01227000
*     /* IF THE JOBID OF THE HEADER MATCHES THE JOBID IN THE @G24LB18*/ 01228000
*     /* TABP PARM LIST AND IF THE HEADER IS NOT MARKED      @G24LB18*/ 01229000
*     /* INVALID, RETURN TO THE CALLER WITH THE ADDRESS OF   @G24LB18*/ 01230000
*     /* THE HEADER IN FIELD STHDRPTR.                       @G24LB18*/ 01231000
*     /*                                                             */ 01232000
*     /***************************************************************/ 01233000
*                                                                  0304 01234000
*     IF JOBID=STPJOBID&            /* JOBIDS MATCH AND      @G24LB18*/ 01235000
*         STPINVAL=OFF THEN         /* HEADER NOT INVALID?   @G24LB18*/ 01236000
         C     JOBID,STPJOBID(,STHDRPTR)                           0304 01237000
         BNE   @RF00304                                            0304 01238000
         TM    STPINVAL(STHDRPTR),B'10000000'                      0304 01239000
         BZ    @RT00304                                            0304 01240000
*       RETURN;                     /* YES-RETURN TO CALLER  @G24LB18*/ 01241000
*   END;                            /* END STEP TABLE SEARCH @G24LB18*/ 01242000
@RF00304 DS    0H                                                  0306 01243000
@DE00302 L     @15,STPNXTTB(,STHDRPTR)                             0306 01244000
         LTR   @15,@15                                             0306 01245000
         BNZ   @DL00302                                            0306 01246000
*                                                                  0307 01247000
*   /*****************************************************************/ 01248000
*   /*                                                               */ 01249000
*   /* IF NO VALID STEP TABLE IS FOUND WITH A MATCHING       @G24LB18*/ 01250000
*   /* JOBID, RETURN TO THE CALLER WITH A RETURN CODE = 4.   @G24LB18*/ 01251000
*   /*                                                               */ 01252000
*   /*****************************************************************/ 01253000
*                                                                  0307 01254000
*   RETCODE=FOUR;                   /* SET RETURN CODE = 4   @G24LB18*/ 01255000
         LA    RETCODE,4                                           0307 01256000
*   RETURN;                         /* RETURN TO CALLER      @G24LB18*/ 01257000
@EL00010 DS    0H                                                  0308 01258000
@EF00010 DS    0H                                                  0308 01259000
@ER00010 BR    @14                                                 0308 01260000
*   END SRCJOBID;                   /* END JOBID SEARCH RTN  @G24LB18*/ 01261000
         B     @EL00010                                            0309 01262000
*   END ICBVTP01                    /* END TABLE PROCESSOR   @G24LB18*/ 01263000
*                                                                  0310 01264000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01265000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01266000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 01267000
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */ 01268000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 01269000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */ 01270000
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                       */ 01271000
*/*%INCLUDE SYSLIB  (IEZSTPTB)                                       */ 01272000
*/*%INCLUDE SYSLIB  (IEZTABP )                                       */ 01273000
*                                                                  0310 01274000
*       ;                                                          0310 01275000
@DATA    DS    0H                                                       01276000
@CH00061 DC    H'6'                                                     01277000
@CH01481 DC    H'20'                                                    01278000
@SM01548 MVC   STPDDVOL(0,DDENTPTR),JFCBVOLS(@07)                       01279000
@SM01550 MVC   STPDDVOL-6(0,@03),JFCBXVOL(JFCBXPTR)                     01280000
@DATD    DSECT                                                          01281000
         DS    0F                                                       01282000
ICBVTP01 CSECT                                                          01283000
         DS    0F                                                       01284000
@CF00057 DC    F'4'                                                     01285000
@CF00059 DC    F'5'                                                     01286000
@CF01544 DC    F'26'                                                    01287000
@DATD    DSECT                                                          01288000
         DS    0D                                                       01289000
VVIPTR   DS    A                                                        01290000
JFCBPTR  DS    A                                                        01291000
GETLEN   DS    F                                                        01292000
SAVERET1 DS    F                                                        01293000
SAVERET2 DS    F                                                        01294000
INDEX    DS    FL1                                                      01295000
ICBVTP01 CSECT                                                          01296000
         DS    0F                                                       01297000
@SIZDATD DC    AL1(252)                                                 01298000
         DC    AL3(@ENDDATD-@DATD)                                      01299000
         DS    0D                                                       01300000
VTPPATCH DS    CL200                                                    01301000
         ORG   VTPPATCH                                                 01302000
@NM00040 DC    CL20'ICBVTP01 PATCH AREA '                               01303000
@NM00041 DC    XL180'0'                                                 01304000
         ORG   VTPPATCH+200                                             01305000
ICBVTP01 CSECT                                                          01306000
*                                                          /*@G24LB18*/ 01307000
MSG1     WTO   'ICB409I NO STORAGE AVAILABLE',                         *01308000
               ROUTCDE=(2,11),DESC=6,MF=L                               01309000
@DATD    DSECT                                                          01310000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01311000
@ENDDATD EQU   *                                                        01312000
ICBVTP01 CSECT                                                          01313000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01314000
@01      EQU   01                                                       01315000
@02      EQU   02                                                       01316000
@03      EQU   03                                                       01317000
@04      EQU   04                                                       01318000
@05      EQU   05                                                       01319000
@06      EQU   06                                                       01320000
@07      EQU   07                                                       01321000
@08      EQU   08                                                       01322000
@09      EQU   09                                                       01323000
@10      EQU   10                                                       01324000
@11      EQU   11                                                       01325000
@12      EQU   12                                                       01326000
@13      EQU   13                                                       01327000
@14      EQU   14                                                       01328000
@15      EQU   15                                                       01329000
JOBID    EQU   @09                                                      01330000
NXTHDRSV EQU   @02                                                      01331000
SAVENTRY EQU   @09                                                      01332000
NVOL     EQU   @09                                                      01333000
RETCODE  EQU   @10                                                      01334000
JFCBXPTR EQU   @07                                                      01335000
REG0     EQU   @00                                                      01336000
REG1     EQU   @01                                                      01337000
PARMPTR  EQU   @04                                                      01338000
STHDRPTR EQU   @05                                                      01339000
DDENTPTR EQU   @06                                                      01340000
REG14    EQU   @14                                                      01341000
REG15    EQU   @15                                                      01342000
CVTPTR   EQU   16                                                       01343000
PSA      EQU   0                                                        01344000
FLCRNPSW EQU   PSA                                                      01345000
FLCROPSW EQU   PSA+8                                                    01346000
FLCICCW2 EQU   PSA+16                                                   01347000
PSAEEPSW EQU   PSA+132                                                  01348000
PSAESPSW EQU   PSA+136                                                  01349000
FLCSVILC EQU   PSAESPSW+1                                               01350000
PSAEPPSW EQU   PSA+140                                                  01351000
FLCPIILC EQU   PSAEPPSW+1                                               01352000
FLCPICOD EQU   PSAEPPSW+2                                               01353000
PSAPICOD EQU   FLCPICOD+1                                               01354000
FLCTEA   EQU   PSAEPPSW+4                                               01355000
FLCPER   EQU   PSA+152                                                  01356000
FLCMCLA  EQU   PSA+168                                                  01357000
FLCIOEL  EQU   FLCMCLA+4                                                01358000
FLCIOA   EQU   FLCMCLA+16                                               01359000
FLCFSA   EQU   FLCMCLA+80                                               01360000
PSASUPER EQU   PSA+552                                                  01361000
PSASUP1  EQU   PSASUPER                                                 01362000
PSASUP2  EQU   PSASUPER+1                                               01363000
PSASUP3  EQU   PSASUPER+2                                               01364000
PSASUP4  EQU   PSASUPER+3                                               01365000
PSACLHT  EQU   PSA+640                                                  01366000
PSALKSA  EQU   PSA+696                                                  01367000
PSAHLHI  EQU   PSA+760                                                  01368000
PSADSSFL EQU   PSA+836                                                  01369000
PSADSSF1 EQU   PSADSSFL                                                 01370000
PSADSSF3 EQU   PSADSSFL+2                                               01371000
PSADSSF4 EQU   PSADSSFL+3                                               01372000
PSARSVT  EQU   PSA+896                                                  01373000
CVTMAP   EQU   0                                                        01374000
CVTDAR   EQU   CVTMAP+72                                                01375000
CVTFLGS1 EQU   CVTDAR                                                   01376000
CVTDCB   EQU   CVTMAP+116                                               01377000
CVTIERLC EQU   CVTMAP+144                                               01378000
CVTOPTA  EQU   CVTMAP+182                                               01379000
CVTOPTB  EQU   CVTMAP+183                                               01380000
CVTGTF   EQU   CVTMAP+236                                               01381000
CVTGTFST EQU   CVTGTF                                                   01382000
CVTGTFS  EQU   CVTGTFST                                                 01383000
CVTSTATE EQU   CVTGTFST                                                 01384000
CVTTMODE EQU   CVTGTFST                                                 01385000
CVTFORM  EQU   CVTGTFST                                                 01386000
CVTAQAVT EQU   CVTMAP+240                                               01387000
CVTTCMFG EQU   CVTAQAVT                                                 01388000
CVTVOLM2 EQU   CVTMAP+244                                               01389000
CVTTATA  EQU   CVTVOLM2                                                 01390000
CVTTSKS  EQU   CVTTATA                                                  01391000
CVTVOLF2 EQU   CVTTSKS                                                  01392000
CVTTAT   EQU   CVTTATA+1                                                01393000
CVTATER  EQU   CVTMAP+248                                               01394000
CVTEXT1  EQU   CVTMAP+252                                               01395000
CVTPURG  EQU   CVTMAP+260                                               01396000
CVTQMSG  EQU   CVTMAP+268                                               01397000
CVTDMSR  EQU   CVTMAP+272                                               01398000
CVTRSV37 EQU   CVTDMSR                                                  01399000
CVTDMSRF EQU   CVTRSV37                                                 01400000
CVTERPV  EQU   CVTMAP+316                                               01401000
CVTINTLA EQU   CVTMAP+320                                               01402000
CVTAPF   EQU   CVTMAP+324                                               01403000
CVTEXT2  EQU   CVTMAP+328                                               01404000
CVTHJES  EQU   CVTMAP+332                                               01405000
CVTPGSIA EQU   CVTMAP+348                                               01406000
CVTA1F1  EQU   CVTMAP+356                                               01407000
CVTSYSK  EQU   CVTMAP+357                                               01408000
CVTVOLM1 EQU   CVTMAP+380                                               01409000
CVTVOLF1 EQU   CVTVOLM1                                                 01410000
CVTATMCT EQU   CVTMAP+388                                               01411000
CVTXTNT1 EQU   0                                                        01412000
CVTXTNT2 EQU   0                                                        01413000
CVTDSSV  EQU   CVTXTNT2                                                 01414000
CVTFLGBT EQU   CVTXTNT2+5                                               01415000
CVTQID   EQU   CVTXTNT2+24                                              01416000
CVTICB   EQU   CVTXTNT2+48                                              01417000
CVTRV400 EQU   CVTXTNT2+52                                              01418000
CVTRV409 EQU   CVTXTNT2+53                                              01419000
CVTATCVT EQU   CVTXTNT2+64                                              01420000
CVTRV429 EQU   CVTXTNT2+84                                              01421000
CVTRV438 EQU   CVTXTNT2+85                                              01422000
CVTRV457 EQU   CVTXTNT2+112                                             01423000
CVTRV466 EQU   CVTXTNT2+113                                             01424000
CVTFIX   EQU   0                                                        01425000
CVTRELNO EQU   CVTFIX+252                                               01426000
ICB2SSCB EQU   0                                                        01427000
ICBOPT   EQU   ICB2SSCB+48                                              01428000
ICBFLG   EQU   ICB2SSCB+52                                              01429000
ICBFG1   EQU   ICBFLG                                                   01430000
ICBVVICB EQU   ICB2SSCB+76                                              01431000
ICBTRACE EQU   ICB2SSCB+112                                             01432000
VVICB    EQU   0                                                        01433000
VVIFLGA  EQU   VVICB+15                                                 01434000
VVISTPTB EQU   VVICB+88                                                 01435000
VVITPFCH EQU   VVICB+108                                                01436000
INFMJFCB EQU   0                                                        01437000
JFCBDSNM EQU   INFMJFCB                                                 01438000
JFCBELNM EQU   INFMJFCB+44                                              01439000
JFCBTSDM EQU   INFMJFCB+52                                              01440000
JFCFCBID EQU   INFMJFCB+56                                              01441000
JFCBFRID EQU   JFCFCBID                                                 01442000
JFCBLTYP EQU   INFMJFCB+66                                              01443000
JFCBOTTR EQU   INFMJFCB+67                                              01444000
JFCBUFOF EQU   JFCBOTTR                                                 01445000
JFCBFLSQ EQU   JFCBOTTR+1                                               01446000
JFCFUNC  EQU   JFCBFLSQ                                                 01447000
JFCBMASK EQU   INFMJFCB+72                                              01448000
JFCBFLG1 EQU   JFCBMASK+5                                               01449000
JFCOPEN  EQU   JFCBFLG1                                                 01450000
JFCBFLG2 EQU   JFCBMASK+6                                               01451000
JFCDEFER EQU   JFCBFLG2                                                 01452000
JFCBIND1 EQU   INFMJFCB+86                                              01453000
JFCBIND2 EQU   INFMJFCB+87                                              01454000
JFCAMPTR EQU   INFMJFCB+88                                              01455000
JFCBUFRQ EQU   JFCAMPTR                                                 01456000
JFCBUFNO EQU   JFCBUFRQ                                                 01457000
JFCBGNCP EQU   JFCAMPTR+1                                               01458000
JFCBHIAR EQU   JFCBGNCP                                                 01459000
JFCBFALN EQU   JFCBHIAR                                                 01460000
JFCBFTEK EQU   JFCBFALN                                                 01461000
JFCBBFTA EQU   JFCBFTEK                                                 01462000
JFCEROPT EQU   INFMJFCB+92                                              01463000
JFCTRTCH EQU   INFMJFCB+93                                              01464000
JFCBX    EQU   0                                                        01465000
JFCBXVOL EQU   JFCBX+4                                                  01466000
JFCBXNXT EQU   JFCBX+172                                                01467000
STPTB    EQU   0                                                        01468000
STPNXTTB EQU   STPTB                                                    01469000
STPPRVTB EQU   STPTB+4                                                  01470000
STPJOBID EQU   STPTB+8                                                  01471000
STPHDRLN EQU   STPTB+12                                                 01472000
STPFLAGS EQU   STPTB+14                                                 01473000
STPINVAL EQU   STPFLAGS                                                 01474000
STPNOFRE EQU   STPFLAGS                                                 01475000
STPICCTR EQU   STPTB+15                                                 01476000
STPDDPTR EQU   STPTB+16                                                 01477000
STPDDENT EQU   0                                                        01478000
STPDDNXT EQU   STPDDENT                                                 01479000
STPDDLEN EQU   STPDDENT+4                                               01480000
STPDDNUM EQU   STPDDENT+6                                               01481000
STPDDDVT EQU   STPDDENT+8                                               01482000
STPDDFLG EQU   STPDDENT+24                                              01483000
STPDDEXC EQU   STPDDFLG                                                 01484000
STPDDNVL EQU   STPDDENT+25                                              01485000
STPDDVOL EQU   STPDDENT+26                                              01486000
TABP     EQU   0                                                        01487000
TABFLAGS EQU   TABP                                                     01488000
TABFBLDE EQU   TABFLAGS                                                 01489000
TABFSRCD EQU   TABFLAGS                                                 01490000
TABFUTRM EQU   TABFLAGS                                                 01491000
TABFFREE EQU   TABFLAGS                                                 01492000
TABVOLID EQU   TABP+2                                                   01493000
TABDDNUM EQU   TABVOLID                                                 01494000
TABSELRB EQU   TABVOLID+2                                               01495000
TABJOBID EQU   TABSELRB                                                 01496000
TABDDRET EQU   TABP+8                                                   01497000
TABHDRET EQU   TABDDRET                                                 01498000
SELRB    EQU   0                                                        01499000
SELFLGS1 EQU   SELRB+5                                                  01500000
SELPARMT EQU   SELFLGS1                                                 01501000
SELDEFER EQU   SELFLGS1                                                 01502000
SELFLGS2 EQU   SELRB+6                                                  01503000
SELINITC EQU   SELFLGS2                                                 01504000
SELUNCNT EQU   SELRB+7                                                  01505000
SELJOBID EQU   SELRB+8                                                  01506000
SELJFCBA EQU   SELRB+12                                                 01507000
SELDEVTP EQU   SELRB+16                                                 01508000
SELUCBAD EQU   SELRB+20                                                 01509000
SELDDNUM EQU   SELRB+44                                                 01510000
SELJFCBX EQU   SELRB+52                                                 01511000
PARMLIST EQU   0                                                        01512000
PARMADDR EQU   PARMLIST                                                 01513000
VOLJFCBX EQU   JFCBXVOL                                                 01514000
CVTS01   EQU   CVTPGSIA                                                 01515000
CVTLPDIA EQU   CVTS01+12                                                01516000
CVTDIRST EQU   CVTLPDIA                                                 01517000
CVTSLIDA EQU   CVTS01+24                                                01518000
CVTCTLFG EQU   CVTS01+50                                                01519000
CVTRV210 EQU   CVTS01+424                                               01520000
CVTRV219 EQU   CVTS01+425                                               01521000
CVTRV228 EQU   CVTS01+426                                               01522000
CVTRV237 EQU   CVTS01+427                                               01523000
CVTMFRTR EQU   CVTS01+452                                               01524000
CVTRV262 EQU   CVTS01+468                                               01525000
CVTRV271 EQU   CVTS01+469                                               01526000
CVTRV280 EQU   CVTS01+470                                               01527000
CVTRV289 EQU   CVTS01+471                                               01528000
CVTGSDA  EQU   CVTS01+600                                               01529000
PSARSVTE EQU   PSARSVT                                                  01530000
JFCKEYLE EQU   JFCTRTCH                                                 01531000
JFCCODE  EQU   JFCKEYLE                                                 01532000
JFCSTACK EQU   JFCTRTCH                                                 01533000
JFCMODE  EQU   JFCSTACK                                                 01534000
JFCSPPRT EQU   JFCTRTCH                                                 01535000
JFCBABFS EQU   JFCSPPRT+2                                               01536000
JFCLIMCT EQU   JFCBABFS                                                 01537000
JFCDSORG EQU   JFCSPPRT+5                                               01538000
JFCDSRG1 EQU   JFCDSORG                                                 01539000
JFCDSRG2 EQU   JFCDSORG+1                                               01540000
JFCRECFM EQU   JFCSPPRT+7                                               01541000
JFCRCFM  EQU   JFCRECFM                                                 01542000
JFCOPTCD EQU   JFCSPPRT+8                                               01543000
JFCWVCSP EQU   JFCOPTCD                                                 01544000
JFCWVCIS EQU   JFCWVCSP                                                 01545000
JFCWVCBD EQU   JFCWVCIS                                                 01546000
JFCALLOW EQU   JFCOPTCD                                                 01547000
JFCRSV17 EQU   JFCALLOW                                                 01548000
JFCOVER  EQU   JFCRSV17                                                 01549000
JFCPCIBT EQU   JFCOPTCD                                                 01550000
JFCMAST  EQU   JFCPCIBT                                                 01551000
JFCEXT   EQU   JFCMAST                                                  01552000
JFCBCKPT EQU   JFCOPTCD                                                 01553000
JFCIND   EQU   JFCBCKPT                                                 01554000
JFCRSV18 EQU   JFCOPTCD                                                 01555000
JFCCYL   EQU   JFCRSV18                                                 01556000
JFCACT   EQU   JFCCYL                                                   01557000
JFCREDUC EQU   JFCOPTCD                                                 01558000
JFCRSV19 EQU   JFCREDUC                                                 01559000
JFCRSV20 EQU   JFCRSV19                                                 01560000
JFCRSV21 EQU   JFCOPTCD                                                 01561000
JFCDEL   EQU   JFCRSV21                                                 01562000
JFCOPTJ  EQU   JFCOPTCD                                                 01563000
JFCREORG EQU   JFCOPTJ                                                  01564000
JFCBLKSI EQU   JFCSPPRT+9                                               01565000
JFCBUFSI EQU   JFCBLKSI                                                 01566000
JFCAMSYN EQU   JFCSPPRT+11                                              01567000
JFCNCP   EQU   JFCAMSYN+2                                               01568000
JFCNTM   EQU   JFCAMSYN+3                                               01569000
JFCBFSEQ EQU   JFCNTM                                                   01570000
JFCPCI   EQU   JFCBFSEQ                                                 01571000
JFCRESRV EQU   JFCAMSYN+4                                               01572000
JFCUCSEG EQU   JFCRESRV                                                 01573000
JFCUCSOP EQU   JFCUCSEG+4                                               01574000
JFCOUTLI EQU   JFCUCSEG+5                                               01575000
JFCTHRSH EQU   JFCOUTLI                                                 01576000
JFCCPRI  EQU   JFCTHRSH                                                 01577000
JFCBNVOL EQU   JFCUCSEG+9                                               01578000
JFCBVOLS EQU   JFCUCSEG+10                                              01579000
JFCBS001 EQU   JFCBVOLS                                                 01580000
JFCBPQTY EQU   JFCBS001+34                                              01581000
JFCBCTRI EQU   JFCBS001+37                                              01582000
JFCBSQTY EQU   JFCBS001+38                                              01583000
JFCFLGS1 EQU   JFCBS001+41                                              01584000
JFCBUAFF EQU   JFCFLGS1                                                 01585000
JFCBVLCT EQU   JFCBS001+56                                              01586000
FLC      EQU   PSA                                                      01587000
ICBPTR   EQU   CVTICB                                                   01588000
*                                      START UNREFERENCED COMPONENTS    01589000
JFCBEND  EQU   JFCBS001+58                                              01590000
JFCBSPTN EQU   JFCBS001+57                                              01591000
JFCBDRLH EQU   JFCBS001+53                                              01592000
JFCBSBNM EQU   JFCBS001+50                                              01593000
JFCBABST EQU   JFCBS001+48                                              01594000
JFCBSPNM EQU   JFCBS001+45                                              01595000
JFCBDQTY EQU   JFCBS001+42                                              01596000
JFCRSV45 EQU   JFCFLGS1                                                 01597000
JFCVRDS  EQU   JFCFLGS1                                                 01598000
JFCBCEOV EQU   JFCFLGS1                                                 01599000
JFCRSV42 EQU   JFCFLGS1                                                 01600000
JFCBADSP EQU   JFCFLGS1                                                 01601000
JFCTOPEN EQU   JFCFLGS1                                                 01602000
JFCBDLET EQU   JFCFLGS1                                                 01603000
JFCRQID  EQU   JFCBSQTY                                                 01604000
JFCROUND EQU   JFCBCTRI                                                 01605000
JFCALX   EQU   JFCBCTRI                                                 01606000
JFCMIXG  EQU   JFCBCTRI                                                 01607000
JFCONTIG EQU   JFCBCTRI                                                 01608000
JFCRSV29 EQU   JFCBCTRI                                                 01609000
JFCBMSGP EQU   JFCBCTRI                                                 01610000
JFCBSPAC EQU   JFCBCTRI                                                 01611000
JFCRUNIT EQU   JFCBPQTY                                                 01612000
JFCBEXAD EQU   JFCBS001+31                                              01613000
JFCBEXTL EQU   JFCBS001+30                                              01614000
JFCMSVGP EQU   JFCBS001+22                                              01615000
@NM00031 EQU   JFCBS001                                                 01616000
JFCAVOLS EQU   JFCBVOLS                                                 01617000
JFCBNTCS EQU   JFCUCSEG+8                                               01618000
JFCSOWA  EQU   JFCOUTLI+1                                               01619000
JFCSEND  EQU   JFCCPRI                                                  01620000
JFCEQUAL EQU   JFCCPRI                                                  01621000
JFCRECV  EQU   JFCCPRI                                                  01622000
JFCRSV34 EQU   JFCCPRI                                                  01623000
JFCRSV33 EQU   JFCCPRI                                                  01624000
JFCRSV55 EQU   JFCCPRI                                                  01625000
JFCRSV54 EQU   JFCCPRI                                                  01626000
JFCRSV53 EQU   JFCCPRI                                                  01627000
JFCRSV27 EQU   JFCUCSOP                                                 01628000
JFCRSV26 EQU   JFCUCSOP                                                 01629000
JFCFCBVR EQU   JFCUCSOP                                                 01630000
JFCFCBAL EQU   JFCUCSOP                                                 01631000
JFCVER   EQU   JFCUCSOP                                                 01632000
JFCRSV25 EQU   JFCUCSOP                                                 01633000
JFCFOLD  EQU   JFCUCSOP                                                 01634000
JFCBEXTP EQU   JFCUCSOP                                                 01635000
JFCUCSID EQU   JFCUCSEG                                                 01636000
JFCINTVL EQU   JFCSPPRT+19                                              01637000
JFCDBUFN EQU   JFCRESRV+3                                               01638000
JFCCYLOF EQU   JFCRESRV+2                                               01639000
JFCRKP   EQU   JFCRESRV                                                 01640000
JFCPCIR2 EQU   JFCPCI                                                   01641000
JFCPCIR1 EQU   JFCPCI                                                   01642000
JFCPCIN2 EQU   JFCPCI                                                   01643000
JFCPCIN1 EQU   JFCPCI                                                   01644000
JFCPCIA2 EQU   JFCPCI                                                   01645000
JFCPCIA1 EQU   JFCPCI                                                   01646000
JFCPCIX2 EQU   JFCPCI                                                   01647000
JFCPCIX1 EQU   JFCPCI                                                   01648000
JFCBUFMX EQU   JFCNCP                                                   01649000
JFCLRECL EQU   JFCAMSYN                                                 01650000
JFCBAXBF EQU   JFCBUFSI                                                 01651000
JFCREL   EQU   JFCREORG                                                 01652000
JFCRSV22 EQU   JFCDEL                                                   01653000
JFCSRCHD EQU   JFCRSV20                                                 01654000
JFCOPTQ  EQU   JFCACT                                                   01655000
JFCFEED  EQU   JFCIND                                                   01656000
JFCCBWU  EQU   JFCEXT                                                   01657000
JFCWUMSG EQU   JFCOVER                                                  01658000
JFCSDNAM EQU   JFCWVCBD                                                 01659000
@NM00030 EQU   JFCRECFM                                                 01660000
JFCCHAR  EQU   JFCRECFM                                                 01661000
JFCRFS   EQU   JFCRECFM                                                 01662000
JFCRFB   EQU   JFCRECFM                                                 01663000
JFCRFO   EQU   JFCRCFM                                                  01664000
JFCFMREC EQU   JFCRCFM                                                  01665000
JFCRSV16 EQU   JFCDSRG2                                                 01666000
JFCRSV15 EQU   JFCDSRG2                                                 01667000
JFCORGTR EQU   JFCDSRG2                                                 01668000
JFCORGAM EQU   JFCDSRG2                                                 01669000
JFCRSV13 EQU   JFCDSRG2                                                 01670000
JFCORGTQ EQU   JFCDSRG2                                                 01671000
JFCORGTX EQU   JFCDSRG2                                                 01672000
JFCORGGS EQU   JFCDSRG2                                                 01673000
JFCORGU  EQU   JFCDSRG1                                                 01674000
JFCORGPO EQU   JFCDSRG1                                                 01675000
JFCORGMQ EQU   JFCDSRG1                                                 01676000
JFCORGCQ EQU   JFCDSRG1                                                 01677000
JFCORGCX EQU   JFCDSRG1                                                 01678000
JFCORGDA EQU   JFCDSRG1                                                 01679000
JFCORGPS EQU   JFCDSRG1                                                 01680000
JFCORGIS EQU   JFCDSRG1                                                 01681000
JFCTRKBL EQU   JFCLIMCT+1                                               01682000
@NM00029 EQU   JFCLIMCT                                                 01683000
JFCDEN   EQU   JFCSPPRT+1                                               01684000
JFCPRTSP EQU   JFCSPPRT                                                 01685000
JFCONE   EQU   JFCMODE                                                  01686000
JFCTWO   EQU   JFCMODE                                                  01687000
JFCRSV07 EQU   JFCMODE                                                  01688000
JFCRSV06 EQU   JFCMODE                                                  01689000
JFCMODER EQU   JFCMODE                                                  01690000
JFCMODEO EQU   JFCMODE                                                  01691000
JFCEBCD  EQU   JFCMODE                                                  01692000
JFCBIN   EQU   JFCMODE                                                  01693000
JFCRSV32 EQU   JFCCODE                                                  01694000
JFCTTY   EQU   JFCCODE                                                  01695000
JFCASCII EQU   JFCCODE                                                  01696000
JFCNCR   EQU   JFCCODE                                                  01697000
JFCBUR   EQU   JFCCODE                                                  01698000
JFCFRI   EQU   JFCCODE                                                  01699000
JFCBCD   EQU   JFCCODE                                                  01700000
JFCNOCON EQU   JFCCODE                                                  01701000
PSARSAV  EQU   PSARSVTE+60                                              01702000
PSARSTK  EQU   PSARSVTE+56                                              01703000
PSAESAV3 EQU   PSARSVTE+52                                              01704000
PSAESTK3 EQU   PSARSVTE+48                                              01705000
PSAESAV2 EQU   PSARSVTE+44                                              01706000
PSAESTK2 EQU   PSARSVTE+40                                              01707000
PSAESAV1 EQU   PSARSVTE+36                                              01708000
PSAESTK1 EQU   PSARSVTE+32                                              01709000
PSAPSAV  EQU   PSARSVTE+28                                              01710000
PSAPSTK  EQU   PSARSVTE+24                                              01711000
PSAMSAV  EQU   PSARSVTE+20                                              01712000
PSAMSTK  EQU   PSARSVTE+16                                              01713000
PSASSAV  EQU   PSARSVTE+12                                              01714000
PSASSTK  EQU   PSARSVTE+8                                               01715000
PSANSTK  EQU   PSARSVTE+4                                               01716000
PSACSTK  EQU   PSARSVTE                                                 01717000
CVTRV628 EQU   CVTS01+728                                               01718000
CVTRV627 EQU   CVTS01+724                                               01719000
CVTRV626 EQU   CVTS01+720                                               01720000
CVTRV625 EQU   CVTS01+716                                               01721000
CVTRV624 EQU   CVTS01+712                                               01722000
CVTRV623 EQU   CVTS01+708                                               01723000
CVTRV622 EQU   CVTS01+704                                               01724000
CVTRV621 EQU   CVTS01+700                                               01725000
CVTIHASU EQU   CVTS01+696                                               01726000
CVTRV619 EQU   CVTS01+692                                               01727000
CVTRV618 EQU   CVTS01+688                                               01728000
CVTRV617 EQU   CVTS01+684                                               01729000
CVTRV616 EQU   CVTS01+680                                               01730000
CVTRV615 EQU   CVTS01+676                                               01731000
CVTRV614 EQU   CVTS01+672                                               01732000
CVTRV613 EQU   CVTS01+668                                               01733000
CVTTCASP EQU   CVTS01+664                                               01734000
CVT0PT03 EQU   CVTS01+660                                               01735000
CVT0PT0E EQU   CVTS01+656                                               01736000
CVTRV609 EQU   CVTS01+652                                               01737000
CVTCGK   EQU   CVTS01+648                                               01738000
CVTRAC   EQU   CVTS01+644                                               01739000
CVTRV606 EQU   CVTS01+640                                               01740000
CVTRV605 EQU   CVTS01+636                                               01741000
CVTRV604 EQU   CVTS01+632                                               01742000
CVTEFF02 EQU   CVTS01+628                                               01743000
CVTCBBR  EQU   CVTS01+624                                               01744000
CVTSSCR  EQU   CVTS01+620                                               01745000
CVTEVENT EQU   CVTS01+616                                               01746000
CVTCRCA  EQU   CVTS01+612                                               01747000
CVTTPIO  EQU   CVTS01+608                                               01748000
CVTADV   EQU   CVTS01+604                                               01749000
CVTGSDAB EQU   CVTGSDA                                                  01750000
CVTQV3   EQU   CVTS01+596                                               01751000
CVTQV2   EQU   CVTS01+592                                               01752000
CVTQV1   EQU   CVTS01+588                                               01753000
CVTRPT   EQU   CVTS01+584                                               01754000
CVTSSRB  EQU   CVTS01+580                                               01755000
CVTCSDRL EQU   CVTS01+576                                               01756000
CVTEXP1  EQU   CVTS01+572                                               01757000
CVTRMPMT EQU   CVTS01+568                                               01758000
CVTRMPTT EQU   CVTS01+564                                               01759000
CVTVPSA  EQU   CVTS01+560                                               01760000
CVTVSTOP EQU   CVTS01+556                                               01761000
CVTGTFR8 EQU   CVTS01+552                                               01762000
CVTQUIT  EQU   CVTS01+548                                               01763000
CVTVACR  EQU   CVTS01+544                                               01764000
CVTWTCB  EQU   CVTS01+540                                               01765000
CVTSTPRS EQU   CVTS01+536                                               01766000
CVT0PT02 EQU   CVTS01+532                                               01767000
CVTDARCM EQU   CVTS01+528                                               01768000
CVTIRECM EQU   CVTS01+524                                               01769000
CVTJRECM EQU   CVTS01+520                                               01770000
CVTVEMS0 EQU   CVTS01+516                                               01771000
CVTSPFRR EQU   CVTS01+512                                               01772000
CVTRLSTG EQU   CVTS01+508                                               01773000
CVT0TC0A EQU   CVTS01+504                                               01774000
CVTGMBR  EQU   CVTS01+500                                               01775000
CVTLFRM  EQU   CVTS01+496                                               01776000
CVTRMBR  EQU   CVTS01+492                                               01777000
CVTVIOP  EQU   CVTS01+488                                               01778000
CVTRV307 EQU   CVTS01+486                                               01779000
CVTRV306 EQU   CVTS01+484                                               01780000
CVTRV305 EQU   CVTS01+482                                               01781000
CVTRV304 EQU   CVTS01+480                                               01782000
CVTRV303 EQU   CVTS01+478                                               01783000
CVTRV302 EQU   CVTS01+476                                               01784000
CVTTRCA  EQU   CVTS01+472                                               01785000
CVTRV297 EQU   CVTRV289                                                 01786000
CVTRV296 EQU   CVTRV289                                                 01787000
CVTRV295 EQU   CVTRV289                                                 01788000
CVTRV294 EQU   CVTRV289                                                 01789000
CVTRV293 EQU   CVTRV289                                                 01790000
CVTRV292 EQU   CVTRV289                                                 01791000
CVTRV291 EQU   CVTRV289                                                 01792000
CVTRV290 EQU   CVTRV289                                                 01793000
CVTRV288 EQU   CVTRV280                                                 01794000
CVTRV287 EQU   CVTRV280                                                 01795000
CVTRV286 EQU   CVTRV280                                                 01796000
CVTRV285 EQU   CVTRV280                                                 01797000
CVTRV284 EQU   CVTRV280                                                 01798000
CVTRV283 EQU   CVTRV280                                                 01799000
CVTRV282 EQU   CVTRV280                                                 01800000
CVTRV281 EQU   CVTRV280                                                 01801000
CVTRV279 EQU   CVTRV271                                                 01802000
CVTRV278 EQU   CVTRV271                                                 01803000
CVTRV277 EQU   CVTRV271                                                 01804000
CVTRV276 EQU   CVTRV271                                                 01805000
CVTRV275 EQU   CVTRV271                                                 01806000
CVTRV274 EQU   CVTRV271                                                 01807000
CVTRV273 EQU   CVTRV271                                                 01808000
CVTRV272 EQU   CVTRV271                                                 01809000
CVTRV270 EQU   CVTRV262                                                 01810000
CVTRV269 EQU   CVTRV262                                                 01811000
CVTRV268 EQU   CVTRV262                                                 01812000
CVTRV267 EQU   CVTRV262                                                 01813000
CVTRV266 EQU   CVTRV262                                                 01814000
CVTRV265 EQU   CVTRV262                                                 01815000
CVTRV264 EQU   CVTRV262                                                 01816000
CVTRV263 EQU   CVTRV262                                                 01817000
CVTVFP   EQU   CVTS01+464                                               01818000
CVTVSI   EQU   CVTS01+460                                               01819000
CVTVPSIB EQU   CVTS01+456                                               01820000
CVTMFACT EQU   CVTMFRTR                                                 01821000
CVTMFCTL EQU   CVTS01+448                                               01822000
CVTPVBP  EQU   CVTS01+444                                               01823000
CVTPWI   EQU   CVTS01+440                                               01824000
CVTRV254 EQU   CVTS01+438                                               01825000
CVTRV253 EQU   CVTS01+436                                               01826000
CVTRV252 EQU   CVTS01+434                                               01827000
CVTRV251 EQU   CVTS01+433                                               01828000
CVTRV250 EQU   CVTS01+432                                               01829000
CVTRV249 EQU   CVTS01+431                                               01830000
CVTRV248 EQU   CVTS01+430                                               01831000
CVTRV247 EQU   CVTS01+429                                               01832000
CVTRV246 EQU   CVTS01+428                                               01833000
CVTRV245 EQU   CVTRV237                                                 01834000
CVTRV244 EQU   CVTRV237                                                 01835000
CVTRV243 EQU   CVTRV237                                                 01836000
CVTRV242 EQU   CVTRV237                                                 01837000
CVTRV241 EQU   CVTRV237                                                 01838000
CVTRV240 EQU   CVTRV237                                                 01839000
CVTRV239 EQU   CVTRV237                                                 01840000
CVTRV238 EQU   CVTRV237                                                 01841000
CVTRV236 EQU   CVTRV228                                                 01842000
CVTRV235 EQU   CVTRV228                                                 01843000
CVTRV234 EQU   CVTRV228                                                 01844000
CVTRV233 EQU   CVTRV228                                                 01845000
CVTRV232 EQU   CVTRV228                                                 01846000
CVTRV231 EQU   CVTRV228                                                 01847000
CVTRV230 EQU   CVTRV228                                                 01848000
CVTRV229 EQU   CVTRV228                                                 01849000
CVTRV227 EQU   CVTRV219                                                 01850000
CVTRV226 EQU   CVTRV219                                                 01851000
CVTRV225 EQU   CVTRV219                                                 01852000
CVTRV224 EQU   CVTRV219                                                 01853000
CVTRV223 EQU   CVTRV219                                                 01854000
CVTRV222 EQU   CVTRV219                                                 01855000
CVTRV221 EQU   CVTRV219                                                 01856000
CVTRV220 EQU   CVTRV219                                                 01857000
CVTRV218 EQU   CVTRV210                                                 01858000
CVTRV217 EQU   CVTRV210                                                 01859000
CVTRV216 EQU   CVTRV210                                                 01860000
CVTRV215 EQU   CVTRV210                                                 01861000
CVTRV214 EQU   CVTRV210                                                 01862000
CVTRV213 EQU   CVTRV210                                                 01863000
CVTRV212 EQU   CVTRV210                                                 01864000
CVTRV211 EQU   CVTRV210                                                 01865000
CVTLCCAT EQU   CVTS01+420                                               01866000
CVTPCCAT EQU   CVTS01+416                                               01867000
CVTIPCRP EQU   CVTS01+412                                               01868000
CVTIPCRI EQU   CVTS01+408                                               01869000
CVTIPCDS EQU   CVTS01+404                                               01870000
CVTAIDVT EQU   CVTS01+400                                               01871000
CVTSSAP  EQU   CVTS01+396                                               01872000
CVTEHCIR EQU   CVTS01+392                                               01873000
CVTEHDEF EQU   CVTS01+388                                               01874000
CVTDAIR  EQU   CVTS01+384                                               01875000
CVTPERFM EQU   CVTS01+380                                               01876000
CVT044R2 EQU   CVTS01+376                                               01877000
CVTFETCH EQU   CVTS01+372                                               01878000
CVTRSTWD EQU   CVTS01+368                                               01879000
CVTSPOST EQU   CVTS01+364                                               01880000
CVTIOBP  EQU   CVTS01+360                                               01881000
CVTASMVT EQU   CVTS01+356                                               01882000
CVTRECRQ EQU   CVTS01+352                                               01883000
CVTWSAC  EQU   CVTS01+348                                               01884000
CVTRV149 EQU   CVTS01+344                                               01885000
CVTWSAL  EQU   CVTS01+340                                               01886000
CVTSPSA  EQU   CVTS01+336                                               01887000
CVTGLMN  EQU   CVTS01+332                                               01888000
CVTVEAC0 EQU   CVTS01+328                                               01889000
CVT062R1 EQU   CVTS01+324                                               01890000
CVTRPOST EQU   CVTS01+320                                               01891000
CVTDQIQE EQU   CVTS01+316                                               01892000
CVTCSD   EQU   CVTS01+312                                               01893000
CVTLKRMA EQU   CVTS01+308                                               01894000
CVTRSPIE EQU   CVTS01+304                                               01895000
CVTRENQ  EQU   CVTS01+300                                               01896000
CVTLQCB  EQU   CVTS01+296                                               01897000
CVTFQCB  EQU   CVTS01+292                                               01898000
CVTQCS01 EQU   CVTS01+288                                               01899000
CVTAPFT  EQU   CVTS01+284                                               01900000
CVTPARRL EQU   CVTS01+280                                               01901000
CVTVWAIT EQU   CVTS01+276                                               01902000
CVTGSPL  EQU   CVTS01+272                                               01903000
CVTLSMQ  EQU   CVTS01+268                                               01904000
CVTGSMQ  EQU   CVTS01+264                                               01905000
CVTEXPRO EQU   CVTS01+260                                               01906000
CVTOPCTP EQU   CVTS01+256                                               01907000
CVTSIC   EQU   CVTS01+252                                               01908000
CVTTPIOS EQU   CVTS01+248                                               01909000
CVTRTMS  EQU   CVTS01+244                                               01910000
CVTSDBF  EQU   CVTS01+240                                               01911000
CVTSCBP  EQU   CVTS01+236                                               01912000
CVTSDMP  EQU   CVTS01+232                                               01913000
CVTSV60  EQU   CVTS01+228                                               01914000
CVTRTMCT EQU   CVTS01+224                                               01915000
CVTASCBL EQU   CVTS01+220                                               01916000
CVTASCBH EQU   CVTS01+216                                               01917000
CVTGDA   EQU   CVTS01+212                                               01918000
CVTASVT  EQU   CVTS01+208                                               01919000
CVTVVMDI EQU   CVTS01+204                                               01920000
CVTAQTOP EQU   CVTS01+200                                               01921000
CVTIOSCS EQU   CVTS01+196                                               01922000
CVTSDRM  EQU   CVTS01+192                                               01923000
CVTOPTE  EQU   CVTS01+188                                               01924000
CVTSTXU  EQU   CVTS01+184                                               01925000
CVTQUIS  EQU   CVTS01+180                                               01926000
CVTPARS  EQU   CVTS01+176                                               01927000
CVTS1EE  EQU   CVTS01+172                                               01928000
CVTFRAS  EQU   CVTS01+168                                               01929000
CVTQSAS  EQU   CVTS01+164                                               01930000
CVTCRAS  EQU   CVTS01+160                                               01931000
CVTCRMN  EQU   CVTS01+156                                               01932000
CVTDELCP EQU   CVTS01+152                                               01933000
CVTFRECL EQU   CVTS01+148                                               01934000
CVTGETCL EQU   CVTS01+144                                               01935000
CVTBLDCP EQU   CVTS01+140                                               01936000
CVTAUTHL EQU   CVTS01+136                                               01937000
CVTSCAN  EQU   CVTS01+132                                               01938000
CVTRV144 EQU   CVTS01+130                                               01939000
CVTMAXMP EQU   CVTS01+128                                               01940000
CVTSTCK  EQU   CVTS01+124                                               01941000
CVTRV139 EQU   CVTS01+123                                               01942000
CVTDSSAC EQU   CVTS01+122                                               01943000
CVTRV513 EQU   CVTS01+121                                               01944000
CVTIOSPL EQU   CVTS01+120                                               01945000
CVTPTGT  EQU   CVTS01+116                                               01946000
CVTCSPIE EQU   CVTS01+112                                               01947000
CVTSMFEX EQU   CVTS01+108                                               01948000
CVTOLT0A EQU   CVTS01+104                                               01949000
CVTSRBRT EQU   CVTS01+100                                               01950000
CVTPUTL  EQU   CVTS01+96                                                01951000
CVTASCRL EQU   CVTS01+92                                                01952000
CVTASCRF EQU   CVTS01+88                                                01953000
CVTRV326 EQU   CVTS01+84                                                01954000
CVTRV325 EQU   CVTS01+80                                                01955000
CVTRV324 EQU   CVTS01+76                                                01956000
CVT0VL01 EQU   CVTS01+72                                                01957000
CVTSHRVM EQU   CVTS01+68                                                01958000
CVTRV332 EQU   CVTS01+64                                                01959000
CVTTAS   EQU   CVTS01+60                                                01960000
CVTRSCN  EQU   CVTS01+56                                                01961000
CVTTRAC2 EQU   CVTS01+54                                                01962000
CVTTRACE EQU   CVTS01+52                                                01963000
CVTAPG   EQU   CVTS01+51                                                01964000
CVTSDTRC EQU   CVTCTLFG                                                 01965000
CVTGTRCE EQU   CVTCTLFG                                                 01966000
CVTNOMP  EQU   CVTCTLFG                                                 01967000
CVTRSV79 EQU   CVTCTLFG                                                 01968000
CVTDSTAT EQU   CVTCTLFG                                                 01969000
CVTRSV78 EQU   CVTCTLFG                                                 01970000
CVTRV333 EQU   CVTCTLFG                                                 01971000
CVTRV323 EQU   CVTCTLFG                                                 01972000
CVTSPVLK EQU   CVTS01+49                                                01973000
CVTRSV77 EQU   CVTS01+48                                                01974000
CVTRV331 EQU   CVTS01+44                                                01975000
CVTRV330 EQU   CVTS01+40                                                01976000
CVTRV329 EQU   CVTS01+36                                                01977000
CVTRV328 EQU   CVTS01+32                                                01978000
CVTRV322 EQU   CVTS01+28                                                01979000
CVTSLID  EQU   CVTSLIDA+1                                               01980000
CVTSYLK  EQU   CVTSLIDA                                                 01981000
CVTRV321 EQU   CVTS01+20                                                01982000
CVTRV320 EQU   CVTS01+16                                                01983000
CVTLPDIR EQU   CVTLPDIA+1                                               01984000
CVTRSV69 EQU   CVTDIRST                                                 01985000
CVTRSV68 EQU   CVTDIRST                                                 01986000
CVTRSV67 EQU   CVTDIRST                                                 01987000
CVTRSV66 EQU   CVTDIRST                                                 01988000
CVTRSV65 EQU   CVTDIRST                                                 01989000
CVTRSV64 EQU   CVTDIRST                                                 01990000
CVTRSV63 EQU   CVTDIRST                                                 01991000
CVTDICOM EQU   CVTDIRST                                                 01992000
CVTPVTP  EQU   CVTS01+8                                                 01993000
CVTLPDSR EQU   CVTS01+4                                                 01994000
CVTGETL  EQU   CVTS01                                                   01995000
SELUNUSE EQU   SELRB+64                                                 01996000
SELGRPPR EQU   SELRB+60                                                 01997000
SELVLRET EQU   SELRB+56                                                 01998000
SELUNUS2 EQU   SELRB+48                                                 01999000
SELRFDDN EQU   SELRB+46                                                 02000000
SELDDCAT EQU   SELRB+42                                                 02001000
SELUNUS1 EQU   SELRB+41                                                 02002000
SELSTNUM EQU   SELRB+40                                                 02003000
SELDDNAM EQU   SELRB+32                                                 02004000
SELJOBNM EQU   SELRB+24                                                 02005000
SELNOVSL EQU   SELFLGS2                                                 02006000
SELRPRIV EQU   SELFLGS2                                                 02007000
SELCNTWT EQU   SELFLGS2                                                 02008000
SELUNSEP EQU   SELFLGS2                                                 02009000
SELSUBAL EQU   SELFLGS2                                                 02010000
SELSCSPL EQU   SELFLGS2                                                 02011000
SELPRSPL EQU   SELFLGS2                                                 02012000
SELMXESO EQU   SELFLGS1                                                 02013000
SELVRGRP EQU   SELFLGS1                                                 02014000
SELVRNEW EQU   SELFLGS1                                                 02015000
SELVOLRF EQU   SELFLGS1                                                 02016000
SELVENQV EQU   SELFLGS1                                                 02017000
SELSEPVL EQU   SELFLGS1                                                 02018000
SELRBOPC EQU   SELRB+4                                                  02019000
SELRBLEN EQU   SELRB                                                    02020000
@NM00039 EQU   TABHDRET+2                                               02021000
TABSPRET EQU   TABHDRET                                                 02022000
TABBFTBL EQU   TABJOBID                                                 02023000
@NM00038 EQU   TABP+1                                                   02024000
@NM00037 EQU   TABFLAGS                                                 02025000
TABFTSPC EQU   TABFLAGS                                                 02026000
TABFBFIT EQU   TABFLAGS                                                 02027000
@NM00036 EQU   STPDDFLG                                                 02028000
STPDDSPL EQU   STPDDFLG                                                 02029000
STPDDPRM EQU   STPDDENT+22                                              02030000
STPDDGPS EQU   STPDDENT+21                                              02031000
STPDDGPI EQU   STPDDENT+20                                              02032000
STPDDGPN EQU   STPDDENT+12                                              02033000
@NM00035 EQU   STPFLAGS                                                 02034000
@NM00034 EQU   JFCBX+144                                                02035000
JFCBXDEV EQU   JFCBX+140                                                02036000
JFCBXNAM EQU   JFCBX+96                                                 02037000
@NM00033 EQU   JFCBX+94                                                 02038000
@NM00032 EQU   JFCBX+3                                                  02039000
JFCBXTTR EQU   JFCBX                                                    02040000
JFCRSV05 EQU   JFCEROPT                                                 02041000
JFCRSV04 EQU   JFCEROPT                                                 02042000
JFCRSV03 EQU   JFCEROPT                                                 02043000
JFCRSV02 EQU   JFCEROPT                                                 02044000
JFCTOPT  EQU   JFCEROPT                                                 02045000
JFCABN   EQU   JFCEROPT                                                 02046000
JFCSKP   EQU   JFCEROPT                                                 02047000
JFCACC   EQU   JFCEROPT                                                 02048000
JFCBUFL  EQU   JFCAMPTR+2                                               02049000
JFCFWORD EQU   JFCBFTEK                                                 02050000
JFCDWORD EQU   JFCBFTEK                                                 02051000
JFCHIER1 EQU   JFCBFTEK                                                 02052000
JFCDYN   EQU   JFCBFTEK                                                 02053000
JFCEXC   EQU   JFCBFTEK                                                 02054000
JFCBBFTR EQU   JFCBBFTA                                                 02055000
JFCSIM   EQU   JFCBBFTA                                                 02056000
JFCHIER  EQU   JFCBFTEK                                                 02057000
JFCBFOUT EQU   JFCBUFNO                                                 02058000
JFCBUFIN EQU   JFCBUFNO                                                 02059000
JFCTEMP  EQU   JFCBIND2                                                 02060000
JFCREQ   EQU   JFCBIND2                                                 02061000
JFCENT   EQU   JFCBIND2                                                 02062000
JFCSHARE EQU   JFCBIND2                                                 02063000
JFCSECUR EQU   JFCBIND2                                                 02064000
JFCDISP  EQU   JFCBIND2                                                 02065000
JFCPDS   EQU   JFCBIND1                                                 02066000
JFCGDG   EQU   JFCBIND1                                                 02067000
JFCADDED EQU   JFCBIND1                                                 02068000
JFCLOC   EQU   JFCBIND1                                                 02069000
JFCRLSE  EQU   JFCBIND1                                                 02070000
JFCBXPDT EQU   INFMJFCB+83                                              02071000
JFCBCRDT EQU   INFMJFCB+80                                              02072000
JFCBOPS2 EQU   JFCBMASK+7                                               02073000
JFCRCTLG EQU   JFCBFLG2                                                 02074000
JFCBBUFF EQU   JFCBFLG2                                                 02075000
JFCTRACE EQU   JFCBFLG2                                                 02076000
JFCSDRPS EQU   JFCBFLG2                                                 02077000
JFCMODNW EQU   JFCBFLG2                                                 02078000
JFCNRPS  EQU   JFCDEFER                                                 02079000
JFCOUTOP EQU   JFCBFLG2                                                 02080000
JFCINOP  EQU   JFCBFLG2                                                 02081000
JFCBPWBP EQU   JFCOPEN                                                  02082000
@NM00028 EQU   JFCOPEN                                                  02083000
JFCDUAL  EQU   JFCBFLG1                                                 02084000
JFCSLDES EQU   JFCBFLG1                                                 02085000
JFCSLCRE EQU   JFCBFLG1                                                 02086000
JFCSTAND EQU   JFCBFLG1                                                 02087000
JFCBOPS1 EQU   JFCBMASK                                                 02088000
JFCBVLSQ EQU   INFMJFCB+70                                              02089000
JFCRSV31 EQU   JFCFUNC                                                  02090000
JFCFNCBT EQU   JFCFUNC                                                  02091000
JFCFNCBX EQU   JFCFUNC                                                  02092000
JFCFNCBD EQU   JFCFUNC                                                  02093000
JFCFNCBW EQU   JFCFUNC                                                  02094000
JFCFNCBP EQU   JFCFUNC                                                  02095000
JFCFNCBR EQU   JFCFUNC                                                  02096000
JFCFNCBI EQU   JFCFUNC                                                  02097000
JFCBFOFL EQU   JFCBUFOF                                                 02098000
JFCNL    EQU   JFCBLTYP                                                 02099000
JFCSL    EQU   JFCBLTYP                                                 02100000
JFCNSL   EQU   JFCBLTYP                                                 02101000
JFCSUL   EQU   JFCBLTYP                                                 02102000
JFCBLP   EQU   JFCBLTYP                                                 02103000
JFCBLTM  EQU   JFCBLTYP                                                 02104000
JFCBAL   EQU   JFCBLTYP                                                 02105000
JFCRSV38 EQU   JFCBLTYP                                                 02106000
JFCVINDX EQU   INFMJFCB+64                                              02107000
JFCNLREC EQU   INFMJFCB+62                                              02108000
JFCBADBF EQU   INFMJFCB+60                                              02109000
JFCAMSTR EQU   JFCBFRID+2                                               02110000
JFCAMCRO EQU   JFCBFRID                                                 02111000
JFCBDSCB EQU   INFMJFCB+53                                              02112000
JFCPAT   EQU   JFCBTSDM                                                 02113000
JFCNDCB  EQU   JFCBTSDM                                                 02114000
JFCNDSCB EQU   JFCBTSDM                                                 02115000
JFCNWRIT EQU   JFCBTSDM                                                 02116000
JFCTTR   EQU   JFCBTSDM                                                 02117000
JFCSDS   EQU   JFCBTSDM                                                 02118000
JFCVSL   EQU   JFCBTSDM                                                 02119000
JFCCAT   EQU   JFCBTSDM                                                 02120000
JFCIPLTX EQU   JFCBELNM                                                 02121000
JFCBQNAM EQU   JFCBDSNM                                                 02122000
VVIUNUSD EQU   VVICB+116                                                02123000
VVINUSDC EQU   VVICB+112                                                02124000
VVIDVMEL EQU   VVICB+104                                                02125000
VVIVBSTF EQU   VVICB+100                                                02126000
VVISSOBA EQU   VVICB+96                                                 02127000
VVIVSCRA EQU   VVICB+92                                                 02128000
VVIDVMTA EQU   VVICB+84                                                 02129000
VVIJUCB  EQU   VVICB+80                                                 02130000
VVIIUCB  EQU   VVICB+76                                                 02131000
VVIRES6  EQU   VVICB+72                                                 02132000
VVIRES5  EQU   VVICB+68                                                 02133000
VVIRES4  EQU   VVICB+64                                                 02134000
VVIUCB   EQU   VVICB+60                                                 02135000
VVIVJL   EQU   VVICB+56                                                 02136000
VVIVRR   EQU   VVICB+52                                                 02137000
VVIQLSPL EQU   VVICB+48                                                 02138000
VVIQRPL2 EQU   VVICB+44                                                 02139000
VVIQRPL1 EQU   VVICB+40                                                 02140000
VVIRES3  EQU   VVICB+36                                                 02141000
VVIVQMP  EQU   VVICB+32                                                 02142000
VVIECB1  EQU   VVICB+28                                                 02143000
VVICATAD EQU   VVICB+24                                                 02144000
VVIDCBAD EQU   VVICB+20                                                 02145000
VVIACBAD EQU   VVICB+16                                                 02146000
VVIFLG7  EQU   VVIFLGA                                                  02147000
VVIFLG6  EQU   VVIFLGA                                                  02148000
VVIFLG5  EQU   VVIFLGA                                                  02149000
VVIFLG4  EQU   VVIFLGA                                                  02150000
VVIFLG3  EQU   VVIFLGA                                                  02151000
VVIFLG2  EQU   VVIFLGA                                                  02152000
VVIFLG1  EQU   VVIFLGA                                                  02153000
VVIFLG0  EQU   VVIFLGA                                                  02154000
VVIALCON EQU   VVICB+14                                                 02155000
VVICPUID EQU   VVICB+12                                                 02156000
VVIUCAT  EQU   VVICB+4                                                  02157000
VVICID   EQU   VVICB                                                    02158000
ICBCPUID EQU   ICB2SSCB+496                                             02159000
ICBLORD  EQU   ICBTRACE+256                                             02160000
ICBOTRC  EQU   ICBTRACE                                                 02161000
ICBFAB   EQU   ICB2SSCB+108                                             02162000
ICBMSSC  EQU   ICB2SSCB+104                                             02163000
ICBRSVP  EQU   ICB2SSCB+100                                             02164000
ICBAEAP  EQU   ICB2SSCB+96                                              02165000
ICBSIOBP EQU   ICB2SSCB+92                                              02166000
ICBIATNA EQU   ICB2SSCB+88                                              02167000
ICBIPRGA EQU   ICB2SSCB+84                                              02168000
ICBSRBP  EQU   ICB2SSCB+80                                              02169000
ICBVVIC  EQU   ICB2SSCB+72                                              02170000
ICBSIOP  EQU   ICB2SSCB+68                                              02171000
ICBMEP   EQU   ICB2SSCB+64                                              02172000
ICBIORCI EQU   ICB2SSCB+60                                              02173000
ICB2ACTP EQU   ICB2SSCB+56                                              02174000
ICBSAMP  EQU   ICBFLG+2                                                 02175000
ICBFG2   EQU   ICBFLG+1                                                 02176000
@NM00027 EQU   ICBFG1                                                   02177000
ICBMSCA  EQU   ICBFG1                                                   02178000
ICBMSCMP EQU   ICBFG1                                                   02179000
ICBS     EQU   ICBFG1                                                   02180000
ICBB     EQU   ICBFG1                                                   02181000
ICBV     EQU   ICBFG1                                                   02182000
ICBR     EQU   ICBFG1                                                   02183000
ICBI     EQU   ICBFG1                                                   02184000
ICBNVT   EQU   ICBOPT                                                   02185000
ICBVN02P EQU   ICB2SSCB+44                                              02186000
ICBTCB   EQU   ICB2SSCB+40                                              02187000
ICBQHEAD EQU   ICB2SSCB+36                                              02188000
ICBAUCB  EQU   ICB2SSCB+32                                              02189000
ICBPUCB  EQU   ICB2SSCB+28                                              02190000
ICBCOMQ  EQU   ICB2SSCB+24                                              02191000
ICBIOR   EQU   ICB2SSCB+20                                              02192000
ICBCOM   EQU   ICB2SSCB+16                                              02193000
ICBACTV  EQU   ICB2SSCB+12                                              02194000
ICBECB   EQU   ICB2SSCB+8                                               02195000
ICBSSNAM EQU   ICB2SSCB                                                 02196000
CVTLEVL  EQU   CVTRELNO+2                                               02197000
CVTNUMB  EQU   CVTRELNO                                                 02198000
CVTMDL   EQU   CVTFIX+250                                               02199000
@NM00002 EQU   CVTFIX+248                                               02200000
@NM00001 EQU   CVTFIX                                                   02201000
CVTRV482 EQU   CVTXTNT2+128                                             02202000
CVTRV481 EQU   CVTXTNT2+124                                             02203000
CVTRV480 EQU   CVTXTNT2+120                                             02204000
CVTRV479 EQU   CVTXTNT2+118                                             02205000
CVTRV478 EQU   CVTXTNT2+117                                             02206000
CVTRV477 EQU   CVTXTNT2+116                                             02207000
CVTRV476 EQU   CVTXTNT2+115                                             02208000
CVTRV475 EQU   CVTXTNT2+114                                             02209000
CVTRV474 EQU   CVTRV466                                                 02210000
CVTRV473 EQU   CVTRV466                                                 02211000
CVTRV472 EQU   CVTRV466                                                 02212000
CVTRV471 EQU   CVTRV466                                                 02213000
CVTRV470 EQU   CVTRV466                                                 02214000
CVTRV469 EQU   CVTRV466                                                 02215000
CVTRV468 EQU   CVTRV466                                                 02216000
CVTRV467 EQU   CVTRV466                                                 02217000
CVTRV465 EQU   CVTRV457                                                 02218000
CVTRV464 EQU   CVTRV457                                                 02219000
CVTRV463 EQU   CVTRV457                                                 02220000
CVTRV462 EQU   CVTRV457                                                 02221000
CVTRV461 EQU   CVTRV457                                                 02222000
CVTRV460 EQU   CVTRV457                                                 02223000
CVTRV459 EQU   CVTRV457                                                 02224000
CVTRV458 EQU   CVTRV457                                                 02225000
CVTRV456 EQU   CVTXTNT2+108                                             02226000
CVTRV455 EQU   CVTXTNT2+104                                             02227000
CVTRV454 EQU   CVTXTNT2+100                                             02228000
CVTRV453 EQU   CVTXTNT2+96                                              02229000
CVTRV452 EQU   CVTXTNT2+94                                              02230000
CVTRV451 EQU   CVTXTNT2+92                                              02231000
CVTRV450 EQU   CVTXTNT2+90                                              02232000
CVTRV449 EQU   CVTXTNT2+88                                              02233000
CVTRV448 EQU   CVTXTNT2+87                                              02234000
CVTRV447 EQU   CVTXTNT2+86                                              02235000
CVTRV446 EQU   CVTRV438                                                 02236000
CVTRV445 EQU   CVTRV438                                                 02237000
CVTRV444 EQU   CVTRV438                                                 02238000
CVTRV443 EQU   CVTRV438                                                 02239000
CVTRV442 EQU   CVTRV438                                                 02240000
CVTRV441 EQU   CVTRV438                                                 02241000
CVTRV440 EQU   CVTRV438                                                 02242000
CVTRV439 EQU   CVTRV438                                                 02243000
CVTRV437 EQU   CVTRV429                                                 02244000
CVTRV436 EQU   CVTRV429                                                 02245000
CVTRV435 EQU   CVTRV429                                                 02246000
CVTRV434 EQU   CVTRV429                                                 02247000
CVTRV433 EQU   CVTRV429                                                 02248000
CVTRV432 EQU   CVTRV429                                                 02249000
CVTRV431 EQU   CVTRV429                                                 02250000
CVTRV430 EQU   CVTRV429                                                 02251000
CVTRV428 EQU   CVTXTNT2+80                                              02252000
CVTRV427 EQU   CVTXTNT2+76                                              02253000
CVTRV426 EQU   CVTXTNT2+72                                              02254000
CVTRV425 EQU   CVTXTNT2+68                                              02255000
CVTATACT EQU   CVTATCVT                                                 02256000
CVTRV423 EQU   CVTXTNT2+62                                              02257000
CVTRV422 EQU   CVTXTNT2+60                                              02258000
CVTRV421 EQU   CVTXTNT2+58                                              02259000
CVTRV420 EQU   CVTXTNT2+56                                              02260000
CVTRV419 EQU   CVTXTNT2+55                                              02261000
CVTRV418 EQU   CVTXTNT2+54                                              02262000
CVTRV417 EQU   CVTRV409                                                 02263000
CVTRV416 EQU   CVTRV409                                                 02264000
CVTRV415 EQU   CVTRV409                                                 02265000
CVTRV414 EQU   CVTRV409                                                 02266000
CVTRV413 EQU   CVTRV409                                                 02267000
CVTRV412 EQU   CVTRV409                                                 02268000
CVTRV411 EQU   CVTRV409                                                 02269000
CVTRV410 EQU   CVTRV409                                                 02270000
CVTRV408 EQU   CVTRV400                                                 02271000
CVTRV407 EQU   CVTRV400                                                 02272000
CVTRV406 EQU   CVTRV400                                                 02273000
CVTRV405 EQU   CVTRV400                                                 02274000
CVTRV404 EQU   CVTRV400                                                 02275000
CVTRV403 EQU   CVTRV400                                                 02276000
CVTRV402 EQU   CVTRV400                                                 02277000
CVTRV401 EQU   CVTRV400                                                 02278000
CVTSKTA  EQU   CVTXTNT2+44                                              02279000
CVTRSV99 EQU   CVTXTNT2+40                                              02280000
CVTRSV98 EQU   CVTXTNT2+36                                              02281000
CVTRSV97 EQU   CVTXTNT2+34                                              02282000
CVTRSV96 EQU   CVTXTNT2+32                                              02283000
CVTOLTEP EQU   CVTXTNT2+28                                              02284000
CVTQIDA  EQU   CVTQID+1                                                 02285000
CVTRSV95 EQU   CVTQID                                                   02286000
CVTRSV94 EQU   CVTXTNT2+20                                              02287000
CVTRSV93 EQU   CVTXTNT2+16                                              02288000
CVTRSV92 EQU   CVTXTNT2+12                                              02289000
CVTDEBVR EQU   CVTXTNT2+8                                               02290000
CVTRSV91 EQU   CVTXTNT2+6                                               02291000
CVTRSV9H EQU   CVTFLGBT                                                 02292000
CVTRSV9G EQU   CVTFLGBT                                                 02293000
CVTRSV9F EQU   CVTFLGBT                                                 02294000
CVTRSV9E EQU   CVTFLGBT                                                 02295000
CVTRSV9D EQU   CVTFLGBT                                                 02296000
CVTRSV9C EQU   CVTFLGBT                                                 02297000
CVTVME   EQU   CVTFLGBT                                                 02298000
CVTNPE   EQU   CVTFLGBT                                                 02299000
CVTNUCLS EQU   CVTXTNT2+4                                               02300000
CVTDSSVA EQU   CVTDSSV+1                                                02301000
CVTRSV89 EQU   CVTDSSV                                                  02302000
CVTRSV88 EQU   CVTXTNT1+8                                               02303000
CVTRSV87 EQU   CVTXTNT1+4                                               02304000
CVTFACHN EQU   CVTXTNT1                                                 02305000
CVTRV488 EQU   CVTMAP+412                                               02306000
CVTRV487 EQU   CVTMAP+408                                               02307000
CVTRV486 EQU   CVTMAP+404                                               02308000
CVTRV485 EQU   CVTMAP+400                                               02309000
CVTACTAP EQU   CVTMAP+396                                               02310000
CVTAUTH  EQU   CVTMAP+392                                               02311000
CVTATMCA EQU   CVTATMCT+1                                               02312000
CVTATMST EQU   CVTATMCT                                                 02313000
CVTRSV61 EQU   CVTMAP+384                                               02314000
CVTVOLT1 EQU   CVTVOLM1+1                                               02315000
CVTVOLI1 EQU   CVTVOLF1                                                 02316000
CVTSTOA  EQU   CVTMAP+376                                               02317000
CVTRSV58 EQU   CVTMAP+374                                               02318000
CVTRSV57 EQU   CVTMAP+372                                               02319000
CVTDDCE  EQU   CVTMAP+368                                               02320000
CVTPNWFR EQU   CVTMAP+364                                               02321000
CVTSMF   EQU   CVTMAP+360                                               02322000
CVTSULK  EQU   CVTMAP+358                                               02323000
CVTSLKO  EQU   CVTSYSK                                                  02324000
CVTSLKP  EQU   CVTSYSK                                                  02325000
CVTSLKQ  EQU   CVTSYSK                                                  02326000
CVTSLKR  EQU   CVTSYSK                                                  02327000
CVTRSV56 EQU   CVTSYSK                                                  02328000
CVTRSV55 EQU   CVTSYSK                                                  02329000
CVTRSV54 EQU   CVTSYSK                                                  02330000
CVTRSV53 EQU   CVTSYSK                                                  02331000
CVTRSV52 EQU   CVTA1F1                                                  02332000
CVTRSV51 EQU   CVTA1F1                                                  02333000
CVTRSV50 EQU   CVTA1F1                                                  02334000
CVTRSV49 EQU   CVTA1F1                                                  02335000
CVTRSV48 EQU   CVTA1F1                                                  02336000
CVTRSV47 EQU   CVTA1F1                                                  02337000
CVTSRSW  EQU   CVTA1F1                                                  02338000
CVTPFSW  EQU   CVTA1F1                                                  02339000
CVTPCVT  EQU   CVTMAP+352                                               02340000
CVTRSV46 EQU   CVTMAP+344                                               02341000
CVTRSV45 EQU   CVTMAP+340                                               02342000
CVTRSV44 EQU   CVTMAP+338                                               02343000
CVTRSV43 EQU   CVTMAP+336                                               02344000
CVTHJESA EQU   CVTHJES+1                                                02345000
CVTRSV42 EQU   CVTHJES                                                  02346000
CVTEXT2A EQU   CVTEXT2+1                                                02347000
CVTRSV41 EQU   CVTEXT2                                                  02348000
CVTAPFA  EQU   CVTAPF+1                                                 02349000
CVTRSV40 EQU   CVTAPF                                                   02350000
CVTRV518 EQU   CVTINTLA                                                 02351000
CVTRV517 EQU   CVTERPV                                                  02352000
CVTEORM  EQU   CVTMAP+312                                               02353000
CVTMCHPR EQU   CVTMAP+308                                               02354000
CVTTZ    EQU   CVTMAP+304                                               02355000
CVTJEPS  EQU   CVTMAP+300                                               02356000
CVTJESCT EQU   CVTMAP+296                                               02357000
CVTMODE  EQU   CVTMAP+292                                               02358000
CVTPTRV  EQU   CVTMAP+288                                               02359000
CVTREAL  EQU   CVTMAP+284                                               02360000
CVTRSV39 EQU   CVTMAP+280                                               02361000
CVTRSV38 EQU   CVTMAP+276                                               02362000
CVTDMSRA EQU   CVTDMSR+1                                                02363000
CVTRV634 EQU   CVTDMSRF                                                 02364000
CVTRV633 EQU   CVTDMSRF                                                 02365000
CVTRV632 EQU   CVTDMSRF                                                 02366000
CVTRV631 EQU   CVTDMSRF                                                 02367000
CVTRV630 EQU   CVTDMSRF                                                 02368000
CVTRV629 EQU   CVTDMSRF                                                 02369000
CVTUDUMP EQU   CVTDMSRF                                                 02370000
CVTSDUMP EQU   CVTDMSRF                                                 02371000
CVTQMSGA EQU   CVTQMSG+1                                                02372000
CVTRSV36 EQU   CVTQMSG                                                  02373000
CVTAMFF  EQU   CVTMAP+264                                               02374000
CVTPURGA EQU   CVTPURG+1                                                02375000
CVTRSV35 EQU   CVTPURG                                                  02376000
CVTCBSP  EQU   CVTMAP+256                                               02377000
CVTATERA EQU   CVTATER+1                                                02378000
CVTSYST  EQU   CVTATER                                                  02379000
CVTVOLT2 EQU   CVTTAT                                                   02380000
CVTVOLI2 EQU   CVTVOLF2                                                 02381000
CVTAQAVB EQU   CVTAQAVT+1                                               02382000
CVTRSV34 EQU   CVTTCMFG                                                 02383000
CVTRSV33 EQU   CVTTCMFG                                                 02384000
CVTRSV32 EQU   CVTTCMFG                                                 02385000
CVTRSV31 EQU   CVTTCMFG                                                 02386000
CVTRSV30 EQU   CVTTCMFG                                                 02387000
CVTRSV29 EQU   CVTTCMFG                                                 02388000
CVTRSV28 EQU   CVTTCMFG                                                 02389000
CVTTCRDY EQU   CVTTCMFG                                                 02390000
CVTGTFA  EQU   CVTGTF+1                                                 02391000
CVTRSV27 EQU   CVTGTFST                                                 02392000
CVTRNIO  EQU   CVTGTFST                                                 02393000
CVTUSR   EQU   CVTGTFST                                                 02394000
CVTRV318 EQU   CVTFORM                                                  02395000
CVTRV317 EQU   CVTTMODE                                                 02396000
CVTRV316 EQU   CVTSTATE                                                 02397000
CVTRV315 EQU   CVTGTFS                                                  02398000
CVTGTFAV EQU   CVTGTFS                                                  02399000
CVT0SCR1 EQU   CVTMAP+232                                               02400000
CVTRV515 EQU   CVTMAP+228                                               02401000
CVTRMS   EQU   CVTMAP+224                                               02402000
CVTPATCH EQU   CVTMAP+220                                               02403000
CVTTSCE  EQU   CVTMAP+216                                               02404000
CVTLNKSC EQU   CVTMAP+214                                               02405000
CVTQABST EQU   CVTMAP+212                                               02406000
CVTMDLDS EQU   CVTMAP+208                                               02407000
CVTUSER  EQU   CVTMAP+204                                               02408000
CVTABEND EQU   CVTMAP+200                                               02409000
CVTSMCA  EQU   CVTMAP+196                                               02410000
CVTRSV18 EQU   CVTMAP+192                                               02411000
CVTQLPAQ EQU   CVTMAP+188                                               02412000
CVTQCDSR EQU   CVTMAP+184                                               02413000
CVTRSV17 EQU   CVTOPTB                                                  02414000
CVTRSV16 EQU   CVTOPTB                                                  02415000
CVTFP    EQU   CVTOPTB                                                  02416000
CVTAPTHR EQU   CVTOPTB                                                  02417000
CVTNLOG  EQU   CVTOPTB                                                  02418000
CVTTOD   EQU   CVTOPTB                                                  02419000
CVTCTIMS EQU   CVTOPTB                                                  02420000
CVTPROT  EQU   CVTOPTB                                                  02421000
CVTXPFP  EQU   CVTOPTA                                                  02422000
CVTASCII EQU   CVTOPTA                                                  02423000
CVTRSV13 EQU   CVTOPTA                                                  02424000
CVTRSV12 EQU   CVTOPTA                                                  02425000
CVTNIP   EQU   CVTOPTA                                                  02426000
CVTDDR   EQU   CVTOPTA                                                  02427000
CVTAPR   EQU   CVTOPTA                                                  02428000
CVTCCH   EQU   CVTOPTA                                                  02429000
CVTSNCTR EQU   CVTMAP+180                                               02430000
CVTQMWR  EQU   CVTMAP+176                                               02431000
CVTQOCR  EQU   CVTMAP+172                                               02432000
CVT1EF00 EQU   CVTMAP+168                                               02433000
CVTMZ00  EQU   CVTMAP+164                                               02434000
CVTHEAD  EQU   CVTMAP+160                                               02435000
CVTRSV11 EQU   CVTMAP+156                                               02436000
CVT0PT01 EQU   CVTMAP+152                                               02437000
CVTMSER  EQU   CVTMAP+148                                               02438000
CVTRV516 EQU   CVTIERLC                                                 02439000
CVTILCH  EQU   CVTMAP+140                                               02440000
CVT0DS   EQU   CVTMAP+136                                               02441000
CVTFBOSV EQU   CVTMAP+132                                               02442000
CVTNUCB  EQU   CVTMAP+128                                               02443000
CVTIXAVL EQU   CVTMAP+124                                               02444000
CVTIOQET EQU   CVTMAP+120                                               02445000
CVTDCBA  EQU   CVTMAP+117                                               02446000
CVTMVS2  EQU   CVTDCB                                                   02447000
CVT6DAT  EQU   CVTDCB                                                   02448000
CVT4MPS  EQU   CVTDCB                                                   02449000
CVTRSV09 EQU   CVTDCB                                                   02450000
CVT4MS1  EQU   CVTDCB                                                   02451000
CVT2SPS  EQU   CVTDCB                                                   02452000
CVT1SSS  EQU   CVTDCB                                                   02453000
CVTRSV08 EQU   CVTDCB                                                   02454000
CVTSTB   EQU   CVTMAP+112                                               02455000
CVTQTD00 EQU   CVTMAP+108                                               02456000
CVTQTE00 EQU   CVTMAP+104                                               02457000
CVTCUCB  EQU   CVTMAP+100                                               02458000
CVTSJQ   EQU   CVTMAP+96                                                02459000
CVTPBLDL EQU   CVTMAP+92                                                02460000
CVTTPC   EQU   CVTMAP+88                                                02461000
CVTSVDCB EQU   CVTMAP+84                                                02462000
CVTBRET  EQU   CVTMAP+82                                                02463000
CVTEXIT  EQU   CVTMAP+80                                                02464000
CVT0FN00 EQU   CVTMAP+76                                                02465000
CVTDARA  EQU   CVTDAR+1                                                 02466000
CVTRSV07 EQU   CVTFLGS1                                                 02467000
CVTRSV06 EQU   CVTFLGS1                                                 02468000
CVTRSV05 EQU   CVTFLGS1                                                 02469000
CVTRSV04 EQU   CVTFLGS1                                                 02470000
CVTRSV03 EQU   CVTFLGS1                                                 02471000
CVTRSV02 EQU   CVTFLGS1                                                 02472000
CVTRSV01 EQU   CVTFLGS1                                                 02473000
CVTDMPLK EQU   CVTFLGS1                                                 02474000
CVTXITP  EQU   CVTMAP+68                                                02475000
CVTZDTAB EQU   CVTMAP+64                                                02476000
CVTMSLT  EQU   CVTMAP+60                                                02477000
CVTDATE  EQU   CVTMAP+56                                                02478000
CVTBTERM EQU   CVTMAP+52                                                02479000
CVTSYSAD EQU   CVTMAP+48                                                02480000
CVTXTLER EQU   CVTMAP+44                                                02481000
CVTILK2  EQU   CVTMAP+40                                                02482000
CVTILK1  EQU   CVTMAP+36                                                02483000
CVTPRLTV EQU   CVTMAP+32                                                02484000
CVTPCNVT EQU   CVTMAP+28                                                02485000
CVT0VL00 EQU   CVTMAP+24                                                02486000
CVTXAPG  EQU   CVTMAP+20                                                02487000
CVTBUF   EQU   CVTMAP+16                                                02488000
CVTJOB   EQU   CVTMAP+12                                                02489000
CVTLINK  EQU   CVTMAP+8                                                 02490000
CVT0EF00 EQU   CVTMAP+4                                                 02491000
CVTTCBP  EQU   CVTMAP                                                   02492000
CVT      EQU   CVTMAP                                                   02493000
@NM00026 EQU   PSA+3668                                                 02494000
PSASTAK  EQU   PSA+3072                                                 02495000
@NM00025 EQU   PSA+1048                                                 02496000
PSAUSEND EQU   PSA+1048                                                 02497000
PSARV062 EQU   PSA+1044                                                 02498000
PSACDAL  EQU   PSA+1040                                                 02499000
PSAWTCOD EQU   PSA+1036                                                 02500000
PSAATCVT EQU   PSA+1032                                                 02501000
PSAPCPSW EQU   PSA+1024                                                 02502000
PSAPIR2  EQU   PSA+1020                                                 02503000
PSARV059 EQU   PSA+1018                                                 02504000
PSASVC13 EQU   PSA+1016                                                 02505000
PSALSFCC EQU   PSA+1012                                                 02506000
PSASFACC EQU   PSA+1008                                                 02507000
PSASTOP  EQU   PSA+992                                                  02508000
PSASTART EQU   PSA+976                                                  02509000
PSARSPSW EQU   PSA+968                                                  02510000
PSASRPSW EQU   PSA+960                                                  02511000
PSARV045 EQU   PSA+892                                                  02512000
PSARV044 EQU   PSA+888                                                  02513000
PSARV043 EQU   PSA+884                                                  02514000
PSARV042 EQU   PSA+880                                                  02515000
PSARV041 EQU   PSA+876                                                  02516000
PSARV040 EQU   PSA+872                                                  02517000
PSARV025 EQU   PSA+868                                                  02518000
PSADSSED EQU   PSA+868                                                  02519000
PSADSSPR EQU   PSA+864                                                  02520000
PSADSSFW EQU   PSA+860                                                  02521000
PSADSS14 EQU   PSA+856                                                  02522000
PSADSSPP EQU   PSA+848                                                  02523000
PSADSSRP EQU   PSA+840                                                  02524000
PSADSS05 EQU   PSADSSF4                                                 02525000
PSADSS10 EQU   PSADSSF4                                                 02526000
PSADSSVE EQU   PSADSSF4                                                 02527000
PSADSSDE EQU   PSADSSF4                                                 02528000
PSADSSC0 EQU   PSADSSF4                                                 02529000
PSADSSIE EQU   PSADSSF4                                                 02530000
PSADSS12 EQU   PSADSSF4                                                 02531000
PSADSSRC EQU   PSADSSF4                                                 02532000
PSARV057 EQU   PSADSSF3                                                 02533000
PSARV056 EQU   PSADSSF3                                                 02534000
PSARV055 EQU   PSADSSF3                                                 02535000
PSADSSMC EQU   PSADSSF3                                                 02536000
PSADSSRW EQU   PSADSSF3                                                 02537000
PSADSSNM EQU   PSADSSF3                                                 02538000
PSADSSES EQU   PSADSSF3                                                 02539000
PSADSSGP EQU   PSADSSF3                                                 02540000
PSADSSF2 EQU   PSADSSFL+1                                               02541000
PSADSSPI EQU   PSADSSF1                                                 02542000
PSADSSOI EQU   PSADSSF1                                                 02543000
PSADSSSP EQU   PSADSSF1                                                 02544000
PSADSSTP EQU   PSADSSF1                                                 02545000
PSADSSDW EQU   PSADSSF1                                                 02546000
PSADSSDD EQU   PSADSSF1                                                 02547000
PSADSSDM EQU   PSADSSF1                                                 02548000
PSADSSMV EQU   PSADSSF1                                                 02549000
PSADSSTS EQU   PSA+816                                                  02550000
PSADSSWK EQU   PSA+812                                                  02551000
PSADSSR3 EQU   PSA+808                                                  02552000
PSADSSR2 EQU   PSA+804                                                  02553000
PSADSSRS EQU   PSA+800                                                  02554000
PSASTOR  EQU   PSA+796                                                  02555000
PSACPUSA EQU   PSA+794                                                  02556000
PSAVSTAP EQU   PSA+792                                                  02557000
PSAWKVAP EQU   PSA+788                                                  02558000
PSAWKRAP EQU   PSA+784                                                  02559000
PSAMCHIC EQU   PSA+783                                                  02560000
PSARV061 EQU   PSA+782                                                  02561000
PSASYMSK EQU   PSA+781                                                  02562000
PSAMCHFL EQU   PSA+780                                                  02563000
PSACR0   EQU   PSA+776                                                  02564000
PSAPSWSV EQU   PSA+768                                                  02565000
PSALITA  EQU   PSA+764                                                  02566000
PSACLHS  EQU   PSAHLHI                                                  02567000
PSALKR15 EQU   PSALKSA+60                                               02568000
PSALKR14 EQU   PSALKSA+56                                               02569000
PSALKR13 EQU   PSALKSA+52                                               02570000
PSALKR12 EQU   PSALKSA+48                                               02571000
PSALKR11 EQU   PSALKSA+44                                               02572000
PSALKR10 EQU   PSALKSA+40                                               02573000
PSALKR9  EQU   PSALKSA+36                                               02574000
PSALKR8  EQU   PSALKSA+32                                               02575000
PSALKR7  EQU   PSALKSA+28                                               02576000
PSALKR6  EQU   PSALKSA+24                                               02577000
PSALKR5  EQU   PSALKSA+20                                               02578000
PSALKR4  EQU   PSALKSA+16                                               02579000
PSALKR3  EQU   PSALKSA+12                                               02580000
PSALKR2  EQU   PSALKSA+8                                                02581000
PSALKR1  EQU   PSALKSA+4                                                02582000
PSALKR0  EQU   PSALKSA                                                  02583000
PSARV023 EQU   PSACLHT+52                                               02584000
PSALOCAL EQU   PSACLHT+48                                               02585000
PSACMSL  EQU   PSACLHT+44                                               02586000
PSAOPTL  EQU   PSACLHT+40                                               02587000
PSATPACL EQU   PSACLHT+36                                               02588000
PSATPDNL EQU   PSACLHT+32                                               02589000
PSATPNCL EQU   PSACLHT+28                                               02590000
PSAIOSLL EQU   PSACLHT+24                                               02591000
PSAIOSUL EQU   PSACLHT+20                                               02592000
PSAIOSCL EQU   PSACLHT+16                                               02593000
PSAIOSSL EQU   PSACLHT+12                                               02594000
PSASALCL EQU   PSACLHT+8                                                02595000
PSAASML  EQU   PSACLHT+4                                                02596000
PSADISPL EQU   PSACLHT                                                  02597000
PSASRSA  EQU   PSA+636                                                  02598000
PSARV050 EQU   PSA+634                                                  02599000
PSADSSGO EQU   PSA+633                                                  02600000
PSARECUR EQU   PSA+632                                                  02601000
PSAHLHIS EQU   PSA+628                                                  02602000
PSAIPCSA EQU   PSA+624                                                  02603000
@NM00024 EQU   PSA+621                                                  02604000
PSAIPCDM EQU   PSA+620                                                  02605000
PSAIPCD  EQU   PSA+616                                                  02606000
@NM00023 EQU   PSA+613                                                  02607000
PSAIPCRM EQU   PSA+612                                                  02608000
PSAIPCR  EQU   PSA+608                                                  02609000
PSAMCHEX EQU   PSA+600                                                  02610000
PSAMPSW  EQU   PSA+592                                                  02611000
PSAEXPS2 EQU   PSA+584                                                  02612000
PSAEXPS1 EQU   PSA+576                                                  02613000
PSAPIREG EQU   PSA+572                                                  02614000
PSARSREG EQU   PSA+568                                                  02615000
PSAGPREG EQU   PSA+556                                                  02616000
PSARV022 EQU   PSASUP4                                                  02617000
PSARV021 EQU   PSASUP4                                                  02618000
PSARV020 EQU   PSASUP4                                                  02619000
PSARV019 EQU   PSASUP4                                                  02620000
PSARV018 EQU   PSASUP4                                                  02621000
PSARV017 EQU   PSASUP4                                                  02622000
PSARV016 EQU   PSASUP4                                                  02623000
PSARV015 EQU   PSASUP4                                                  02624000
PSARV014 EQU   PSASUP3                                                  02625000
PSARV013 EQU   PSASUP3                                                  02626000
PSARV012 EQU   PSASUP3                                                  02627000
PSAESTA  EQU   PSASUP3                                                  02628000
PSASPR   EQU   PSASUP3                                                  02629000
PSAPSREG EQU   PSASUP3                                                  02630000
PSAPI2   EQU   PSASUP3                                                  02631000
PSAIOSUP EQU   PSASUP3                                                  02632000
PSALCR   EQU   PSASUP2                                                  02633000
PSARTM   EQU   PSASUP2                                                  02634000
PSAACR   EQU   PSASUP2                                                  02635000
PSAIPCE2 EQU   PSASUP2                                                  02636000
PSAIPCES EQU   PSASUP2                                                  02637000
PSAIPCEC EQU   PSASUP2                                                  02638000
PSAGTF   EQU   PSASUP2                                                  02639000
PSAIPCRI EQU   PSASUP2                                                  02640000
PSATYPE6 EQU   PSASUP1                                                  02641000
PSATCTL  EQU   PSASUP1                                                  02642000
PSADISP  EQU   PSASUP1                                                  02643000
PSALOCK  EQU   PSASUP1                                                  02644000
PSAPI    EQU   PSASUP1                                                  02645000
PSAEXT   EQU   PSASUP1                                                  02646000
PSASVC   EQU   PSASUP1                                                  02647000
PSAIO    EQU   PSASUP1                                                  02648000
PSAAOLD  EQU   PSA+548                                                  02649000
PSAANEW  EQU   PSA+544                                                  02650000
PSATOLD  EQU   PSA+540                                                  02651000
PSATNEW  EQU   PSA+536                                                  02652000
PSALCCAR EQU   PSA+532                                                  02653000
PSALCCAV EQU   PSA+528                                                  02654000
PSAPCCAR EQU   PSA+524                                                  02655000
PSAPCCAV EQU   PSA+520                                                  02656000
PSACPULA EQU   PSA+518                                                  02657000
PSACPUPA EQU   PSA+516                                                  02658000
PSAPSA   EQU   PSA+512                                                  02659000
FLCHDEND EQU   PSA+512                                                  02660000
FLCCRSAV EQU   FLCMCLA+280                                              02661000
FLCGRSAV EQU   FLCMCLA+216                                              02662000
FLCFPSAV EQU   FLCMCLA+184                                              02663000
FLCFLA   EQU   FLCMCLA+88                                               02664000
FLCRGNCD EQU   FLCMCLA+84                                               02665000
FLCFSAA  EQU   FLCFSA+1                                                 02666000
@NM00022 EQU   FLCFSA                                                   02667000
@NM00021 EQU   FLCMCLA+72                                               02668000
FLCMCIC  EQU   FLCMCLA+64                                               02669000
@NM00020 EQU   FLCMCLA+20                                               02670000
FLCIOAA  EQU   FLCIOA+1                                                 02671000
@NM00019 EQU   FLCIOA                                                   02672000
@NM00018 EQU   FLCMCLA+15                                               02673000
@NM00017 EQU   FLCMCLA+14                                               02674000
@NM00016 EQU   FLCMCLA+12                                               02675000
FLCLCL   EQU   FLCMCLA+8                                                02676000
FLCIOELA EQU   FLCIOEL+1                                                02677000
@NM00015 EQU   FLCIOEL                                                  02678000
FLCCHNID EQU   FLCMCLA                                                  02679000
@NM00014 EQU   PSA+160                                                  02680000
FLCMTRCD EQU   PSA+157                                                  02681000
@NM00013 EQU   PSA+156                                                  02682000
FLCPERA  EQU   FLCPER+1                                                 02683000
@NM00012 EQU   FLCPER                                                   02684000
@NM00011 EQU   PSA+151                                                  02685000
FLCPERCD EQU   PSA+150                                                  02686000
FLCMCNUM EQU   PSA+149                                                  02687000
@NM00010 EQU   PSA+148                                                  02688000
FLCTEAA  EQU   FLCTEA+1                                                 02689000
@NM00009 EQU   FLCTEA                                                   02690000
PSAPIPC  EQU   PSAPICOD                                                 02691000
PSAPIMC  EQU   PSAPICOD                                                 02692000
PSAPIPER EQU   PSAPICOD                                                 02693000
PSARV049 EQU   FLCPICOD                                                 02694000
FLCPILCB EQU   FLCPIILC                                                 02695000
@NM00008 EQU   FLCPIILC                                                 02696000
@NM00007 EQU   PSAEPPSW                                                 02697000
FLCSVCN  EQU   PSAESPSW+2                                               02698000
FLCSILCB EQU   FLCSVILC                                                 02699000
@NM00006 EQU   FLCSVILC                                                 02700000
@NM00005 EQU   PSAESPSW                                                 02701000
FLCEICOD EQU   PSAEEPSW+2                                               02702000
PSASPAD  EQU   PSAEEPSW                                                 02703000
@NM00004 EQU   PSA+128                                                  02704000
FLCINPSW EQU   PSA+120                                                  02705000
FLCMNPSW EQU   PSA+112                                                  02706000
FLCPNPSW EQU   PSA+104                                                  02707000
FLCSNPSW EQU   PSA+96                                                   02708000
FLCENPSW EQU   PSA+88                                                   02709000
FLCTRACE EQU   PSA+84                                                   02710000
FLCTIMER EQU   PSA+80                                                   02711000
FLCCVT2  EQU   PSA+76                                                   02712000
FLCCAW   EQU   PSA+72                                                   02713000
FLCCSW   EQU   PSA+64                                                   02714000
FLCIOPSW EQU   PSA+56                                                   02715000
FLCMOPSW EQU   PSA+48                                                   02716000
FLCPOPSW EQU   PSA+40                                                   02717000
FLCSOPSW EQU   PSA+32                                                   02718000
FLCEOPSW EQU   PSA+24                                                   02719000
@NM00003 EQU   FLCICCW2+4                                               02720000
FLCCVT   EQU   FLCICCW2                                                 02721000
FLCICCW1 EQU   FLCROPSW                                                 02722000
FLCIPPSW EQU   FLCRNPSW                                                 02723000
*                                      END UNREFERENCED COMPONENTS      02724000
@RF00072 EQU   @RC00069                                                 02725000
@RF00155 EQU   @EL00003                                                 02726000
@RT00224 EQU   @EL00006                                                 02727000
@RT00243 EQU   @EL00007                                                 02728000
@RT00304 EQU   @EL00010                                                 02729000
@ENDDATA EQU   *                                                        02730000
         END   ICBVTP01,(C'PLS1851',0603,76349)                         02731000
./  ADD  SSI=62790221,NAME=ICBVUP00
UP00     TITLE '**********  ICBVUP00:  MSVC UNIT PROCESSOR MODULE  *****00001000
               *******  '                                               00002000
ICBVUP00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVUP00  76.279'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
         MVC   @PC00001(8),0(@01)                                  0001 00018000
*   VVIPTR=ADDR(VVICBLK);           /*                       @G24LB37*/ 00019000
         L     VVIPTR,@PC00001+4                                   0069 00020000
*   UNITPTR=ADDR(UNITRPL);          /*                       @G24LB37*/ 00021000
         L     UNITPTR,@PC00001                                    0070 00022000
*   RETCODE=FOUR;                   /*                       @G24LB37*/ 00023000
*                                                                  0071 00024000
         LA    RETCODE,4                                           0071 00025000
*   /*****************************************************************/ 00026000
*   /*                                                               */ 00027000
*   /* IF, IN THE UNITP, THE UNIFMTD FLAG IS ON, REQUESTING  @G24LB37*/ 00028000
*   /* THE UNIT PROCESSOR TO DETERMINE IF THE GIVEN VOLUME   @G24LB37*/ 00029000
*   /* SERIAL IS MOUNTED ON A 3330V UNIT, WITHIN THE SYSTEM, @G24LB37*/ 00030000
*   /* CALL SCANUCBS.                                        @G24LB37*/ 00031000
*   /*                                                               */ 00032000
*   /*****************************************************************/ 00033000
*                                                                  0072 00034000
*   IF UNIFMTD=ON THEN                                             0072 00035000
         TM    UNIFMTD(UNITPTR),B'10000000'                        0072 00036000
         BNO   @RF00072                                            0072 00037000
*     CALL SCANUCBS;                /*                       @G24LB37*/ 00038000
*                                                                  0073 00039000
         BAL   @14,SCANUCBS                                        0073 00040000
*   /*****************************************************************/ 00041000
*   /*                                                               */ 00042000
*   /* IF THE UNIFINCL FLAG IS ON, THEN CALL UNITINCL TO     @G24LB37*/ 00043000
*   /* DETERMINE IF THE SPECIFIED UCB ADDRESS IS INCLUDED    @G24LB37*/ 00044000
*   /* OR NOT INCLUDED WITHIN THE SPECIFIED DEVICE TYPE.     @G24LB37*/ 00045000
*   /*                                                               */ 00046000
*   /*****************************************************************/ 00047000
*                                                                  0074 00048000
*   ELSE                                                           0074 00049000
*     IF UNIFINCL=ON THEN                                          0074 00050000
         B     @RC00072                                            0074 00051000
@RF00072 TM    UNIFINCL(UNITPTR),B'01000000'                       0074 00052000
         BNO   @RF00074                                            0074 00053000
*       CALL UNITINCL;              /*                       @G24LB37*/ 00054000
*                                                                  0075 00055000
         BAL   @14,UNITINCL                                        0075 00056000
*   /*****************************************************************/ 00057000
*   /*                                                               */ 00058000
*   /* IF THE UNIFALLV FLAG IS ON, THEN CALL ALLVIRT TO      @G24LB37*/ 00059000
*   /* DETERMINE IF THE SPECIFIED DEVICE TYPE IS ALL 3330V   @G24LB37*/ 00060000
*   /* UNITS.                                                @G24LB37*/ 00061000
*   /*                                                               */ 00062000
*   /*****************************************************************/ 00063000
*                                                                  0076 00064000
*     ELSE                                                         0076 00065000
*       IF UNIFALLV=ON THEN                                        0076 00066000
         B     @RC00074                                            0076 00067000
@RF00074 TM    UNIFALLV(UNITPTR),B'00100000'                       0076 00068000
         BNO   @RF00076                                            0076 00069000
*         CALL ALLVIRT;             /*                       @G24LB37*/ 00070000
         BAL   @14,ALLVIRT                                         0077 00071000
*                                                                  0078 00072000
*   /*****************************************************************/ 00073000
*   /*                                                               */ 00074000
*   /* RETURN TO CALLER. RETURN CODE IS RETURNED IN REG 15.  @G24LB37*/ 00075000
*   /*                                                               */ 00076000
*   /*****************************************************************/ 00077000
*                                                                  0078 00078000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER      @G24LB37*/ 00079000
@RF00076 DS    0H                                                  0078 00080000
@RC00074 DS    0H                                                  0078 00081000
@RC00072 LR    @15,RETCODE                                         0078 00082000
         L     @13,4(,@13)                                         0078 00083000
         L     @14,12(,@13)                                        0078 00084000
         LM    @00,@12,20(@13)                                     0078 00085000
         BR    @14                                                 0078 00086000
*                                                                  0079 00087000
*/********************************************************************/ 00088000
*/*                                                                  */ 00089000
*/*     PROCEDURE NAME - SCANUCBS                            @G24LB37*/ 00090000
*/*                                                          @G24LB37*/ 00091000
*/*     FUNCTION - THIS PROCEDURE SCANS THE 3330V UCB TABLE  @G24LB37*/ 00092000
*/*                BUILT BY MSVC FOR THE UCB THAT CONTAINS   @G24LB37*/ 00093000
*/*                THE VOLUME SERIAL IN THE UCBVOLI FIELD    @G24LB37*/ 00094000
*/*                WHICH MATCHES THE ONE PASSED BY THE       @G24LB37*/ 00095000
*/*                CALLER.                                   @G24LB37*/ 00096000
*/*                                                          @G24LB37*/ 00097000
*/*     INPUT - THE VOLUME SERIAL TO SEARCH FOR IN THE UCBS. @G24LB37*/ 00098000
*/*             THE POINTER TO THE MSVC UCB LOOK UP TABLE    @G24LB37*/ 00099000
*/*             IN THE VVICB.                                @G24LB37*/ 00100000
*/*                                                          @G24LB37*/ 00101000
*/*     OUTPUT -   THE ADDRESS OF THE UCB THAT THE VOLUME    @G24LB37*/ 00102000
*/*                WAS FOUND MOUNTED ON AND/OR A RETURN      @G24LB37*/ 00103000
*/*                CODE IN RETCODE AREA AS FOLLOWS:          @G24LB37*/ 00104000
*/*                0 = SUCCESSFUL                            @G24LB37*/ 00105000
*/*                4 = NOT FOUND                             @G24LB37*/ 00106000
*/*                                                                  */ 00107000
*/********************************************************************/ 00108000
*                                                                  0079 00109000
*SCANUCBS:                                                         0079 00110000
*   PROCEDURE OPTIONS(NOSAVE);      /*                       @G24LB37*/ 00111000
SCANUCBS DS    0H                                                  0080 00112000
*                                                                  0080 00113000
*   /*****************************************************************/ 00114000
*   /*                                                               */ 00115000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE MSVC   @G24LB37*/ 00116000
*   /* 3330V UCB ADDRESS TABLE USING THE VVIUCB FIELD IN THE @G24LB37*/ 00117000
*   /* VVICB CONTROL BLOCK. TURN FOUNDSW OFF.                @G24LB37*/ 00118000
*   /*                                                               */ 00119000
*   /*****************************************************************/ 00120000
*                                                                  0080 00121000
*   MSVLKPTR=VVIUCB;                /*                       @G24LB37*/ 00122000
         L     MSVLKPTR,VVIUCB(,VVIPTR)                            0080 00123000
*   FOUNDSW=OFF;                    /*                       @G24LB37*/ 00124000
*                                                                  0081 00125000
         NI    FOUNDSW,B'01111111'                                 0081 00126000
*   /*****************************************************************/ 00127000
*   /*                                                               */ 00128000
*   /* SCAN THE MSVC 3330V UCB ADDRESS TABLE, TAKE EACH UCB  @G24LB37*/ 00129000
*   /* ADDRESS AND CHECK THE UCBVOLI FIELD FOR THE MATCHING  @G24LB37*/ 00130000
*   /* VOLSER THAT WAS PASSED IN THE UNITP. ADD A PLUS FOUR  @G24LB37*/ 00131000
*   /* TO THE ADDRESS OF THE TABLE TO INCREMENT TO THE NEXT  @G24LB37*/ 00132000
*   /* UCB ADDRESS ENTRY. IF THE UCB ADDRESS IS ALL HEX      @G24LB37*/ 00133000
*   /* FOXES THEN THE END OF THE TABLE HAS BEEN REACHED.     @G24LB37*/ 00134000
*   /*                                                               */ 00135000
*   /*****************************************************************/ 00136000
*                                                                  0082 00137000
*   DO WHILE(MSVUCBP¬=UCBDELIM)&(FOUNDSW=OFF);/*             @G24LB37*/ 00138000
         B     @DE00082                                            0082 00139000
@DL00082 DS    0H                                                  0083 00140000
*     UCBPTR=MSVUCBP;               /*                       @G24LB37*/ 00141000
         L     UCBPTR,MSVUCBP(,MSVLKPTR)                           0083 00142000
*     IF UCBVOLI=UNIVOL THEN                                       0084 00143000
         CLC   UCBVOLI(6,UCBPTR),UNIVOL(UNITPTR)                   0084 00144000
         BNE   @RF00084                                            0084 00145000
*       DO;                         /*                       @G24LB37*/ 00146000
*                                                                  0085 00147000
*         /***********************************************************/ 00148000
*         /*                                                         */ 00149000
*         /* IF THE VOLSER IS FOUND TO BE MOUNTED SET THE    @G24LB37*/ 00150000
*         /* RETURN CODE TO ZERO AND INSERT THE UCB ADDRESS  @G24LB37*/ 00151000
*         /* INTO THE UNITP FIELD UNIUCBP, AND TURN ON THE   @G24LB37*/ 00152000
*         /* FOUND SWITCH. IF THE VOLSER IS NOT FOUND        @G24LB37*/ 00153000
*         /* (END OF TABLE REACHED), THEN THE RETURN CODE    @G24LB37*/ 00154000
*         /* IS ALREADY SET TO FOUR.                         @G24LB37*/ 00155000
*         /*                                                         */ 00156000
*         /***********************************************************/ 00157000
*                                                                  0086 00158000
*         FOUNDSW=ON;               /*                       @G24LB37*/ 00159000
         OI    FOUNDSW,B'10000000'                                 0086 00160000
*         UNIUCBP=UCBPTR;           /*                       @G24LB37*/ 00161000
         ST    UCBPTR,UNIUCBP(,UNITPTR)                            0087 00162000
*         RETCODE=ZERO;             /*                       @G24LB37*/ 00163000
         SLR   RETCODE,RETCODE                                     0088 00164000
*       END;                        /*                       @G24LB37*/ 00165000
*     ELSE                                                         0090 00166000
*       MSVLKPTR=MSVLKPTR+FOUR;     /*                       @G24LB37*/ 00167000
         B     @RC00084                                            0090 00168000
@RF00084 AL    MSVLKPTR,@CF00039                                   0090 00169000
*   END;                            /*                       @G24LB37*/ 00170000
*                                                                  0091 00171000
@RC00084 DS    0H                                                  0091 00172000
@DE00082 CLC   MSVUCBP(4,MSVLKPTR),UCBDELIM                        0091 00173000
         BE    @DC00082                                            0091 00174000
         TM    FOUNDSW,B'10000000'                                 0091 00175000
         BZ    @DL00082                                            0091 00176000
@DC00082 DS    0H                                                  0092 00177000
*   /*****************************************************************/ 00178000
*   /*                                                               */ 00179000
*   /* RETURN CODE IS SET IN RETCODE AREA.                   @G24LB37*/ 00180000
*   /*                                                               */ 00181000
*   /*****************************************************************/ 00182000
*                                                                  0092 00183000
*   RETURN;                         /* RET TO MAIN ROUTINE   @G24LB37*/ 00184000
@EL00002 DS    0H                                                  0092 00185000
@EF00002 DS    0H                                                  0092 00186000
@ER00002 BR    @14                                                 0092 00187000
*   END SCANUCBS;                   /* END OF SCANUCBS PROC  @G24LB37*/ 00188000
*                                                                  0094 00189000
*/********************************************************************/ 00190000
*/*                                                                  */ 00191000
*/*     PROCEDURE NAME - ALLVIRT                             @G24LB37*/ 00192000
*/*                                                          @G24LB37*/ 00193000
*/*     FUNCTION - THIS PROCEDURE DETERMINES IF THE PASSED   @G24LB37*/ 00194000
*/*                DEVICE TYPE HAS ANY UCB'S WITHIN THE      @G24LB37*/ 00195000
*/*                ESOTERIC GROUP THAT ARE NOT 3330V         @G24LB37*/ 00196000
*/*                DEVICES (I.E. MIXED ESOTERIC).            @G24LB37*/ 00197000
*/*                                                          @G24LB37*/ 00198000
*/*     INPUT - THE DEVICE TYPE TO SEARCH FOR, PASSED IN THE @G24LB37*/ 00199000
*/*             UNITP.  THE DEVICE MASK TABLE POINTED TO BY  @G24LB37*/ 00200000
*/*             THE VVICB FIELD VVIDVMTA, AND THE LENGTH OF  @G24LB37*/ 00201000
*/*             A DEVICE MASK ENTRY IN VVICB FIELD VVIDVMEL. @G24LB37*/ 00202000
*/*                                                          @G24LB37*/ 00203000
*/*     OUTPUT -   RETURN CODE IS RETURNED IN RETCODE AREA   @G24LB37*/ 00204000
*/*                AS FOLLOWS:                               @G24LB37*/ 00205000
*/*                0 = DEVICE TYPE IS ALL 3330V'S            @G24LB37*/ 00206000
*/*                4 = DEVICE TYPE HAS AT LEAST ONE NON-     @G24LB37*/ 00207000
*/*                    3330V UNIT                            @G24LB37*/ 00208000
*/*                                                                  */ 00209000
*/********************************************************************/ 00210000
*                                                                  0094 00211000
*ALLVIRT:                                                          0094 00212000
*   PROCEDURE OPTIONS(NOSAVE);      /*                       @G24LB37*/ 00213000
ALLVIRT  DS    0H                                                  0095 00214000
*                                                                  0095 00215000
*   /*****************************************************************/ 00216000
*   /*                                                               */ 00217000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE DEVICE @G24LB37*/ 00218000
*   /* MASK TABLE USING THE VVIDVMTA FIELD IN THE VVICB      @G24LB37*/ 00219000
*   /* CONTROL BLOCK. TAKE THE NUMBER OF WORDS IN VVIDVMEL,  @G24LB37*/ 00220000
*   /* ADD TWO TO THAT TOTAL FOR THE TWO EXTRA WORDS IN A    @G24LB37*/ 00221000
*   /* ENTRY AND MULTIPLY BY 4 TO GET THE NUMBER OF BYTES.   @G24LB37*/ 00222000
*   /*                                                               */ 00223000
*   /*****************************************************************/ 00224000
*                                                                  0095 00225000
*   DVMSKPTR=VVIDVMTA;              /*                       @G24LB37*/ 00226000
         L     DVMSKPTR,VVIDVMTA(,VVIPTR)                          0095 00227000
*   DVMSKMLN=VVIDVMEL*FOUR;         /*                       @G24LB37*/ 00228000
         L     @11,VVIDVMEL(,VVIPTR)                               0096 00229000
         LR    DVMSKMLN,@11                                        0096 00230000
         SLA   DVMSKMLN,2                                          0096 00231000
*   DVMSKELN=(VVIDVMEL+TWO)*FOUR;   /*                       @G24LB37*/ 00232000
         AL    @11,@CF00043                                        0097 00233000
         SLA   @11,2                                               0097 00234000
         LR    DVMSKELN,@11                                        0097 00235000
*   DVMSKELP=ADDR(DEVMSKEL);        /*                       @G24LB37*/ 00236000
         LA    DVMSKELP,DEVMSKEL(,DVMSKPTR)                        0098 00237000
*   FOUNDSW=OFF;                    /*                       @G24LB37*/ 00238000
*   EXITSW=OFF;                     /*                       @G24LB37*/ 00239000
         NI    FOUNDSW,B'00111111'                                 0100 00240000
*   SAV3330P=ZERO;                  /*                       @G24LB37*/ 00241000
*                                                                  0101 00242000
         SLR   SAV3330P,SAV3330P                                   0101 00243000
*   /*****************************************************************/ 00244000
*   /*                                                               */ 00245000
*   /* SCAN THE DEVICE MASK TABLE FOR THE 3330V DEVICE MASK  @G24LB37*/ 00246000
*   /* USING THE CONSTANT '30582009'X DEVICE TYPE. IF THE    @G24LB37*/ 00247000
*   /* DEVICE TYPE IS FOUND, SAVE THE ADDRESS. ALSO,         @G24LB37*/ 00248000
*   /* TAKE THE PASSED DEVICE TYPE AND FIND ITS CORRESPOND-  @G24LB37*/ 00249000
*   /* ING DEVICE BIT MASK, IN THE DEVICE MASK TABLE.        @G24LB37*/ 00250000
*   /*                                                               */ 00251000
*   /*****************************************************************/ 00252000
*                                                                  0102 00253000
*   DO X=ONE TO DEVNUMEL WHILE EXITSW=OFF;/*                 @G24LB37*/ 00254000
         LA    X,1                                                 0102 00255000
         B     @DE00102                                            0102 00256000
@DL00102 TM    EXITSW,B'01000000'                                  0102 00257000
         BNZ   @DC00102                                            0102 00258000
*     IF DEVTYPE=DEV3330V THEN                                     0103 00259000
         CLC   DEVTYPE(4,DVMSKELP),DEV3330V                        0103 00260000
         BNE   @RF00103                                            0103 00261000
*       SAV3330P=DVMSKELP;          /*                       @G24LB37*/ 00262000
         LR    SAV3330P,DVMSKELP                                   0104 00263000
*     IF DEVTYPE=UNIDEVTP THEN                                     0105 00264000
@RF00103 CLC   DEVTYPE(4,DVMSKELP),UNIDEVTP(UNITPTR)               0105 00265000
         BNE   @RF00105                                            0105 00266000
*       DO;                         /*                       @G24LB37*/ 00267000
*         FOUNDSW=ON;               /*                       @G24LB37*/ 00268000
         OI    FOUNDSW,B'10000000'                                 0107 00269000
*         SAVDEVTP=DVMSKELP;        /*                       @G24LB37*/ 00270000
         ST    DVMSKELP,SAVDEVTP                                   0108 00271000
*       END;                        /*                       @G24LB37*/ 00272000
*     IF SAV3330P¬=ZERO&FOUNDSW=ON THEN                            0110 00273000
@RF00105 LTR   SAV3330P,SAV3330P                                   0110 00274000
         BZ    @RF00110                                            0110 00275000
         TM    FOUNDSW,B'10000000'                                 0110 00276000
         BNO   @RF00110                                            0110 00277000
*       EXITSW=ON;                  /*                       @G24LB37*/ 00278000
         OI    EXITSW,B'01000000'                                  0111 00279000
*     DVMSKELP=DVMSKELP+DVMSKELN;   /*                       @G24LB37*/ 00280000
@RF00110 ALR   DVMSKELP,DVMSKELN                                   0112 00281000
*   END;                            /*                       @G24LB37*/ 00282000
         AL    X,@CF00048                                          0113 00283000
@DE00102 CH    X,DEVNUMEL(,DVMSKPTR)                               0113 00284000
         BNH   @DL00102                                            0113 00285000
@DC00102 DS    0H                                                  0114 00286000
*                                                                  0114 00287000
*   /*****************************************************************/ 00288000
*   /*                                                               */ 00289000
*   /* IF THE FOUND SWITCH IS ON, THEN 'AND' THE TWO MASKS   @G24LB37*/ 00290000
*   /* TOGETHER AND CHECK THE RESULT FOR AN EQUAL CONDITION. @G24LB37*/ 00291000
*   /* IF THE RESULT IS EQUAL THEN THE DEVICE TYPE IS NOT    @G24LB37*/ 00292000
*   /* MIXED. SET THE RETURN CODE TO ZERO IF EQUAL, ELSE,    @G24LB37*/ 00293000
*   /* SET THE RETURN CODE TO EIGHT, INDICATING THE DEVICE   @G24LB37*/ 00294000
*   /* TYPE PASSED IS NOT ALL 3330V UNITS.                   @G24LB37*/ 00295000
*   /*                                                               */ 00296000
*   /*****************************************************************/ 00297000
*                                                                  0114 00298000
*   IF FOUNDSW=ON THEN                                             0114 00299000
         TM    FOUNDSW,B'10000000'                                 0114 00300000
         BNO   @RF00114                                            0114 00301000
*     DO;                           /*                       @G24LB37*/ 00302000
*       DVMSKELP=SAVDEVTP;          /*                       @G24LB37*/ 00303000
         L     DVMSKELP,SAVDEVTP                                   0116 00304000
*       WORKMASK(ONE:DVMSKMLN)=DEVMASK(ONE:DVMSKMLN)&SAVMASK(ONE:  0117 00305000
*           DVMSKMLN);              /*                       @G24LB37*/ 00306000
         LR    @06,DVMSKMLN                                        0117 00307000
         BCTR  @06,0                                               0117 00308000
         EX    @06,@SM01249                                        0117 00309000
         EX    @06,@SN01251                                        0117 00310000
*       IF WORKMASK(ONE:DVMSKMLN)=DEVMASK(ONE:DVMSKMLN) THEN       0118 00311000
         EX    @06,@SC01253                                        0118 00312000
         BNE   @RF00118                                            0118 00313000
*         RETCODE=ZERO;             /*                       @G24LB37*/ 00314000
         SLR   RETCODE,RETCODE                                     0119 00315000
*       ELSE                                                       0120 00316000
*         RETCODE=EIGHT;            /*                       @G24LB37*/ 00317000
         B     @RC00118                                            0120 00318000
@RF00118 LA    RETCODE,8                                           0120 00319000
*     END;                          /*                       @G24LB37*/ 00320000
*   ELSE                                                           0122 00321000
*     RETCODE=EIGHT;                /*                       @G24LB37*/ 00322000
         B     @RC00114                                            0122 00323000
@RF00114 LA    RETCODE,8                                           0122 00324000
*   RETURN;                         /* RET TO MAIN ROUTINE   @G24LB37*/ 00325000
@EL00003 DS    0H                                                  0123 00326000
@EF00003 DS    0H                                                  0123 00327000
@ER00003 BR    @14                                                 0123 00328000
*   END ALLVIRT;                    /* END OF ALLVIRT PROC   @G24LB37*/ 00329000
         B     @EL00003                                            0124 00330000
*                                                                  0125 00331000
*/********************************************************************/ 00332000
*/*                                                                  */ 00333000
*/*     PROCEDURE NAME - UNITINCL                            @G24LB37*/ 00334000
*/*                                                          @G24LB37*/ 00335000
*/*     FUNCTION - THIS PROCEDURE DETERMINES IF THE PASSED   @G24LB37*/ 00336000
*/*                UCB ADDRESS IS INCLUDED WITHIN THE SPEC-  @G24LB37*/ 00337000
*/*                IFIED DEVICE TYPE, CALLS SCANLKUP TO SCAN @G24LB37*/ 00338000
*/*                THE UCB LOOK UP TABLE FOR THE PASSED UCB  @G24LB37*/ 00339000
*/*                ADDRESS, AND TO COUNT ITS OFFSET WITHIN   @G24LB37*/ 00340000
*/*                THE LOOK UP TABLE.  IF THE SCAN IS SUC-   @G24LB37*/ 00341000
*/*                CESSFUL, THEN CALLS THE SCANMASK PROC-    @G24LB37*/ 00342000
*/*                EDURE TO DETERMINE BY SCANNING THE DEVICE @G24LB37*/ 00343000
*/*                MASK TABLE IF THE UCB OFFSET BIT IN THE   @G24LB37*/ 00344000
*/*                MASK IS ON FOR THAT DEVICE TYPE.          @G24LB37*/ 00345000
*/*                                                          @G24LB37*/ 00346000
*/*     INPUT - THE DEVICE TYPE AND THE UCB ADDRESS OF THE   @G24LB37*/ 00347000
*/*             UNIT TO DETERMINE IF INCLUDED, PASSED IN THE @G24LB37*/ 00348000
*/*             FIELDS UNIDEVTP AND UNIUCBP IN THE UNITP.    @G24LB37*/ 00349000
*/*                                                          @G24LB37*/ 00350000
*/*     OUTPUT -   RETURN CODE IS RETURNED IN RETCODE AREA   @G24LB37*/ 00351000
*/*                AS FOLLOWS:                               @G24LB37*/ 00352000
*/*                0 = UCB ADDRESS IS INCLUDED WITHIN THE    @G24LB37*/ 00353000
*/*                    SPECIFIED DEVICE TYPE                 @G24LB37*/ 00354000
*/*                4 = UCB ADDRESS IS NOT INCLUDED WITHIN    @G24LB37*/ 00355000
*/*                    THE SPECIFIED DEVICE TYPE, OR THE     @G24LB37*/ 00356000
*/*                    SPECIFIED DEVICE TYPE OR UCB ADDRESS  @G24LB37*/ 00357000
*/*                    WAS NOT FOUND                         @G24LB37*/ 00358000
*/*                                                                  */ 00359000
*/********************************************************************/ 00360000
*                                                                  0125 00361000
*UNITINCL:                                                         0125 00362000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00363000
UNITINCL ST    @14,@SA00004                                        0125 00364000
*                                                                  0126 00365000
*   /*****************************************************************/ 00366000
*   /*                                                               */ 00367000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE UCB    @G24LB37*/ 00368000
*   /* BY SETTING THE PASSED UCB ADDRESS INTO THE UCBPTR.    @G24LB37*/ 00369000
*   /*                                                               */ 00370000
*   /*****************************************************************/ 00371000
*                                                                  0126 00372000
*   UCBPTR=UNIUCBP;                 /*                       @G24LB37*/ 00373000
*                                                                  0126 00374000
         L     UCBPTR,UNIUCBP(,UNITPTR)                            0126 00375000
*   /*****************************************************************/ 00376000
*   /*                                                               */ 00377000
*   /* CALL THE SCANLKUP PROCEDURE TO SCAN THE SYSTEM UCB    @G24LB37*/ 00378000
*   /* LOOK UP TABLE TO FIND THE MATCHING UCB ADDRESS AS     @G24LB37*/ 00379000
*   /* THE ONE PASSED, TO COMPARE AGAINST THE DEVICE MASK    @G24LB37*/ 00380000
*   /* TABLE. IF THE UCB ADDRESS IS NOT FOUND, A RETURN      @G24LB37*/ 00381000
*   /* CODE OF FOUR WILL BE RETURNED. IF FOUND A COUNTER     @G24LB37*/ 00382000
*   /* (UCBCNTR) WILL BE SET INDICATING WHAT POSITION WITHIN @G24LB37*/ 00383000
*   /* THE LOOK UP TABLE THE ADDRESS WAS FOUND (1ST, 2ND,    @G24LB37*/ 00384000
*   /* ETC.), AND A RETURN CODE OF ZERO.                     @G24LB37*/ 00385000
*   /*                                                               */ 00386000
*   /*****************************************************************/ 00387000
*                                                                  0127 00388000
*   CALL SCANLKUP;                  /*                       @G24LB37*/ 00389000
*                                                                  0127 00390000
         BAL   @14,SCANLKUP                                        0127 00391000
*   /*****************************************************************/ 00392000
*   /*                                                               */ 00393000
*   /* IF RETURN CODE IS ZERO, CALL THE SCANMASK PROCEDURE   @G24LB37*/ 00394000
*   /* TO DETERMINE IF THE UCB IS INCLUDED WITHIN THE        @G24LB37*/ 00395000
*   /* SPECIFIED DEVICE TYPE. A RETURN CODE OF ZERO WILL BE  @G24LB37*/ 00396000
*   /* RETURNED IF INCLUDED, OR A RETURN CODE OF FOUR, IF    @G24LB37*/ 00397000
*   /* NOT INCLUDED.                                         @G24LB37*/ 00398000
*   /*                                                               */ 00399000
*   /*****************************************************************/ 00400000
*                                                                  0128 00401000
*   IF RETCODE=ZERO THEN                                           0128 00402000
         LTR   RETCODE,RETCODE                                     0128 00403000
         BNZ   @RF00128                                            0128 00404000
*     CALL SCANMASK;                /*                       @G24LB37*/ 00405000
         BAL   @14,SCANMASK                                        0129 00406000
*   RETURN;                         /* RET TO MAIN ROUTINE   @G24LB37*/ 00407000
@EL00004 DS    0H                                                  0130 00408000
@EF00004 DS    0H                                                  0130 00409000
@ER00004 L     @14,@SA00004                                        0130 00410000
         BR    @14                                                 0130 00411000
*   END UNITINCL;                   /* END OF UNITINCL PROC  @G24LB37*/ 00412000
         B     @EL00004                                            0131 00413000
*                                                                  0132 00414000
*/********************************************************************/ 00415000
*/*                                                                  */ 00416000
*/*     PROCEDURE NAME - SCANLKUP                            @G24LB37*/ 00417000
*/*                                                          @G24LB37*/ 00418000
*/*     FUNCTION - THIS PROCEDURE DETERMINES IF THE PASSED   @G24LB37*/ 00419000
*/*                UCB ADDRESS IS IN THE SYSTEM LOOK UP      @G24LB37*/ 00420000
*/*                TABLE, AND COUNTS THE UCB'S OFFSET WITHIN @G24LB37*/ 00421000
*/*                THE SYSTEM UCB LOOK UP TABLE.             @G24LB37*/ 00422000
*/*                                                          @G24LB37*/ 00423000
*/*     INPUT - THE UCB ADDRESS OF THE UNIT, PASSED IN THE   @G24LB37*/ 00424000
*/*             UNITP.  THE ADDRESS OF THE SYSTEM LOOK UP    @G24LB37*/ 00425000
*/*             TABLE IN THE CVT FIELD CVTILK2.              @G24LB37*/ 00426000
*/*                                                          @G24LB37*/ 00427000
*/*     OUTPUT -   RETURN CODE IS RETURNED IN RETCODE AREA   @G24LB37*/ 00428000
*/*                AS FOLLOWS:                               @G24LB37*/ 00429000
*/*                0 = UCB ADDRESS WAS FOUND                 @G24LB37*/ 00430000
*/*                4 = UCB ADDRESS WAS NOT FOUND             @G24LB37*/ 00431000
*/*                                                                  */ 00432000
*/********************************************************************/ 00433000
*                                                                  0132 00434000
*SCANLKUP:                                                         0132 00435000
*   PROCEDURE OPTIONS(NOSAVE);      /*                       @G24LB37*/ 00436000
SCANLKUP DS    0H                                                  0133 00437000
*                                                                  0133 00438000
*   /*****************************************************************/ 00439000
*   /*                                                               */ 00440000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE SYSTEM @G24LB37*/ 00441000
*   /* UCB LOOK UP TABLE USING THE CVTILK2 FIELD IN THE CVT. @G24LB37*/ 00442000
*   /* CLEAR COUNTER AND TURN FOUNDSW OFF.                   @G24LB37*/ 00443000
*   /*                                                               */ 00444000
*   /*****************************************************************/ 00445000
*                                                                  0133 00446000
*   UCBLOKUP=CVTILK2;               /*                       @G24LB37*/ 00447000
         L     @09,CVTPTR                                          0133 00448000
         L     UCBLOKUP,CVTILK2(,@09)                              0133 00449000
*   UCBCNTR=ZERO;                   /*                       @G24LB37*/ 00450000
         SLR   UCBCNTR,UCBCNTR                                     0134 00451000
*   FOUNDSW=OFF;                    /*                       @G24LB37*/ 00452000
*                                                                  0135 00453000
         NI    FOUNDSW,B'01111111'                                 0135 00454000
*   /*****************************************************************/ 00455000
*   /*                                                               */ 00456000
*   /* SCAN THE SYSTEM UCB LOOK UP TABLE, TAKE EACH UCB      @G24LB37*/ 00457000
*   /* ADDRESS AND CHECK THAT ADDRESS FIELD FOR THE MATCHING @G24LB37*/ 00458000
*   /* UCBADDR THAT WAS PASSED IN THE UNITP. ADD A PLUS TWO  @G24LB37*/ 00459000
*   /* TO THE ADDRESS OF THE TABLE TO INCREMENT TO THE NEXT  @G24LB37*/ 00460000
*   /* UCB ADDRESS ENTRY. IF THE UCB ADDRESS IS ALL HEX      @G24LB37*/ 00461000
*   /* FOXES THEN THE END OF THE TABLE HAS BEEN REACHED.     @G24LB37*/ 00462000
*   /*                                                               */ 00463000
*   /*****************************************************************/ 00464000
*                                                                  0136 00465000
*   DO WHILE(UCBADDR¬=UCBDELIM(ONE:TWO))&(FOUNDSW=OFF);/*    @G24LB37*/ 00466000
         B     @DE00136                                            0136 00467000
@DL00136 DS    0H                                                  0137 00468000
*     IF UCBADDR=UCBPTR THEN                                       0137 00469000
         LH    @09,UCBADDR(,UCBLOKUP)                              0137 00470000
         N     @09,@CF01255                                        0137 00471000
         CR    UCBPTR,@09                                          0137 00472000
         BNE   @RF00137                                            0137 00473000
*       FOUNDSW=ON;                 /*                       @G24LB37*/ 00474000
         OI    FOUNDSW,B'10000000'                                 0138 00475000
*     ELSE                                                         0139 00476000
*       UCBCNTR=UCBCNTR+ONE;        /*                       @G24LB37*/ 00477000
         B     @RC00137                                            0139 00478000
@RF00137 AL    UCBCNTR,@CF00048                                    0139 00479000
*     UCBLOKUP=UCBLOKUP+TWO;        /*                       @G24LB37*/ 00480000
@RC00137 AL    UCBLOKUP,@CF00043                                   0140 00481000
*   END;                            /*                       @G24LB37*/ 00482000
*                                                                  0141 00483000
@DE00136 CLC   UCBADDR(2,UCBLOKUP),UCBDELIM                        0141 00484000
         BE    @DC00136                                            0141 00485000
         TM    FOUNDSW,B'10000000'                                 0141 00486000
         BZ    @DL00136                                            0141 00487000
@DC00136 DS    0H                                                  0142 00488000
*   /*****************************************************************/ 00489000
*   /*                                                               */ 00490000
*   /* IF THE UCB ADDRESS IS FOUND IN THE SYSTEM LOOK UP     @G24LB37*/ 00491000
*   /* TABLE, THEN SET THE RETURN CODE TO ZERO. IF THE UCB   @G24LB37*/ 00492000
*   /* ADDRESS IS NOT FOUND (END OF TABLE REACHED), THEN     @G24LB37*/ 00493000
*   /* THE RETURN CODE IS ALREADY SET TO FOUR.               @G24LB37*/ 00494000
*   /*                                                               */ 00495000
*   /*****************************************************************/ 00496000
*                                                                  0142 00497000
*   IF FOUNDSW=ON THEN                                             0142 00498000
         TM    FOUNDSW,B'10000000'                                 0142 00499000
         BNO   @RF00142                                            0142 00500000
*     RETCODE=ZERO;                 /*                       @G24LB37*/ 00501000
         SLR   RETCODE,RETCODE                                     0143 00502000
*   RETURN;                         /* RET TO UNITINCL PROC  @G24LB37*/ 00503000
@EL00005 DS    0H                                                  0144 00504000
@EF00005 DS    0H                                                  0144 00505000
@ER00005 BR    @14                                                 0144 00506000
*   END SCANLKUP;                   /* END OF SCANLKUP PROC  @G24LB37*/ 00507000
         B     @EL00005                                            0145 00508000
*                                                                  0146 00509000
*/********************************************************************/ 00510000
*/*                                                                  */ 00511000
*/*     PROCEDURE NAME - SCANMASK                            @G24LB37*/ 00512000
*/*                                                          @G24LB37*/ 00513000
*/*     FUNCTION - THIS PROCEDURE DETERMINES BY USING THE    @G24LB37*/ 00514000
*/*                UCB ADDRESS OFFSET COUNTER INITIALIZED BY @G24LB37*/ 00515000
*/*                THE SCANLKUP PROCEDURE, TO SCAN THE       @G24LB37*/ 00516000
*/*                DEVICE MASK TABLE ENTRY, TO DETERMINE IF  @G24LB37*/ 00517000
*/*                THE UCB OFFSET BIT IN THE MASK IS ON      @G24LB37*/ 00518000
*/*                FOR THAT DEVICE TYPE.                     @G24LB37*/ 00519000
*/*                                                          @G24LB37*/ 00520000
*/*     INPUT - THE DEVICE TYPE, PASSED IN FIELD UNIDEVTP,   @G24LB37*/ 00521000
*/*             AND THE UCB ADDRESS OFFSET COUNTER FROM      @G24LB37*/ 00522000
*/*             THE SCANLKUP PROCEDURE.  THE ADDRESS OF THE  @G24LB37*/ 00523000
*/*             DEVICE MASK TABLE AND THE ELEMENT LENGTH     @G24LB37*/ 00524000
*/*             PASSED IN THE VVICB CONTROL BLOCK.           @G24LB37*/ 00525000
*/*                                                          @G24LB37*/ 00526000
*/*     OUTPUT -   RETURN CODE IS RETURNED IN RETCODE AREA   @G24LB37*/ 00527000
*/*                AS FOLLOWS:                               @G24LB37*/ 00528000
*/*                0 = UCB ADDRESS IS INCLUDED WITHIN THE    @G24LB37*/ 00529000
*/*                    SPECIFIED DEVICE TYPE                 @G24LB37*/ 00530000
*/*                4 = UCB ADDRESS IS NOT INCLUDED WITHIN    @G24LB37*/ 00531000
*/*                    THE SPECIFIED DEVICE TYPE, OR THE     @G24LB37*/ 00532000
*/*                    SPECIFIED DEVICE TYPE WAS NOT FOUND   @G24LB37*/ 00533000
*/*                                                                  */ 00534000
*/********************************************************************/ 00535000
*                                                                  0146 00536000
*SCANMASK:                                                         0146 00537000
*   PROCEDURE OPTIONS(NOSAVE);      /*                       @G24LB37*/ 00538000
SCANMASK DS    0H                                                  0147 00539000
*                                                                  0147 00540000
*   /*****************************************************************/ 00541000
*   /*                                                               */ 00542000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE DEVICE @G24LB37*/ 00543000
*   /* MASK TABLE (DEVMASKT). COMPUTE THE TOTAL ENTRY        @G24LB37*/ 00544000
*   /* LENGTH OF THE DEVICE MASK TABLE BY TAKING THE FIELD   @G24LB37*/ 00545000
*   /* VVIDVMEL AND ADDING A PLUS TWO TO THE FIELD AND PUT   @G24LB37*/ 00546000
*   /* IN THE ELEMENT INDEX FIELD. THE TWO WORDS ADDED ARE   @G24LB37*/ 00547000
*   /* FOR THE DEVICE TYPE AND THE NUMBER OF BITS IN THE     @G24LB37*/ 00548000
*   /* MASK FIELDS.                                          @G24LB37*/ 00549000
*   /*                                                               */ 00550000
*   /*****************************************************************/ 00551000
*                                                                  0147 00552000
*   DVMSKPTR=VVIDVMTA;              /*                       @G24LB37*/ 00553000
         L     DVMSKPTR,VVIDVMTA(,VVIPTR)                          0147 00554000
*   DVMSKMLN=VVIDVMEL*FOUR;         /*                       @G24LB37*/ 00555000
         L     @11,VVIDVMEL(,VVIPTR)                               0148 00556000
         LR    DVMSKMLN,@11                                        0148 00557000
         SLA   DVMSKMLN,2                                          0148 00558000
*   DVMSKELN=(VVIDVMEL+TWO)*FOUR;   /*                       @G24LB37*/ 00559000
         AL    @11,@CF00043                                        0149 00560000
         SLA   @11,2                                               0149 00561000
         LR    DVMSKELN,@11                                        0149 00562000
*   DVMSKELP=ADDR(DEVMSKEL);        /*                       @G24LB37*/ 00563000
         LA    DVMSKELP,DEVMSKEL(,DVMSKPTR)                        0150 00564000
*   SAV3330P=ZERO;                  /*                       @G24LB37*/ 00565000
         SLR   SAV3330P,SAV3330P                                   0151 00566000
*   WORKAREA=''B;                   /*                       @G24LB37*/ 00567000
*                                                                  0152 00568000
         XC    WORKAREA(4),WORKAREA                                0152 00569000
*   /*****************************************************************/ 00570000
*   /*                                                               */ 00571000
*   /* SCAN THE DEVICE MASK TABLE FOR THE PASSED DEVICE TYPE @G24LB37*/ 00572000
*   /* IN THE UNITP. ONCE A COMPARE EQUAL IS FOUND SAVE      @G24LB37*/ 00573000
*   /* THAT ENTRIES ADDRESS FOR THE NEXT STEP. IF NOT FOUND  @G24LB37*/ 00574000
*   /* SET THE RETURN CODE TO FOUR.                          @G24LB37*/ 00575000
*   /*                                                               */ 00576000
*   /*****************************************************************/ 00577000
*                                                                  0153 00578000
*   DO X=ONE TO DEVNUMEL WHILE SAV3330P=ZERO;/*              @G24LB37*/ 00579000
         LA    X,1                                                 0153 00580000
         B     @DE00153                                            0153 00581000
@DL00153 LTR   SAV3330P,SAV3330P                                   0153 00582000
         BNZ   @DC00153                                            0153 00583000
*     IF DEVTYPE=UNIDEVTP THEN                                     0154 00584000
         CLC   DEVTYPE(4,DVMSKELP),UNIDEVTP(UNITPTR)               0154 00585000
         BNE   @RF00154                                            0154 00586000
*       SAV3330P=DVMSKELP;          /*                       @G24LB37*/ 00587000
         LR    SAV3330P,DVMSKELP                                   0155 00588000
*     ELSE                                                         0156 00589000
*       DVMSKELP=DVMSKELP+DVMSKELN; /*                       @G24LB37*/ 00590000
         B     @RC00154                                            0156 00591000
@RF00154 ALR   DVMSKELP,DVMSKELN                                   0156 00592000
*   END;                            /*                       @G24LB37*/ 00593000
*                                                                  0157 00594000
@RC00154 AL    X,@CF00048                                          0157 00595000
@DE00153 CH    X,DEVNUMEL(,DVMSKPTR)                               0157 00596000
         BNH   @DL00153                                            0157 00597000
@DC00153 DS    0H                                                  0158 00598000
*   /*****************************************************************/ 00599000
*   /*                                                               */ 00600000
*   /* IF THE ENTRY WAS FOUND THEN DETERMINE IF THE BIT IS   @G24LB37*/ 00601000
*   /* ON CORRESPONDING TO THE PASSED SYSTEM UCB LOOK UP     @G24LB37*/ 00602000
*   /* OFFSET NUMBER.                                        @G24LB37*/ 00603000
*   /*                                                               */ 00604000
*   /*****************************************************************/ 00605000
*                                                                  0158 00606000
*   IF SAV3330P¬=ZERO THEN                                         0158 00607000
         LTR   SAV3330P,SAV3330P                                   0158 00608000
         BZ    @RF00158                                            0158 00609000
*     DO;                           /*                       @G24LB37*/ 00610000
*                                                                  0160 00611000
*       /*************************************************************/ 00612000
*       /*                                                           */ 00613000
*       /* THE BIT OFFSET IS DIVIDED BY EIGHT TO GET THE     @G24LB37*/ 00614000
*       /* BYTE OFFSET IN THE MASK ENTRY. THE REMAINDER OF   @G24LB37*/ 00615000
*       /* THE DIVIDE IS THE BIT OFFSET WITHIN THE BYTE.     @G24LB37*/ 00616000
*       /*                                                           */ 00617000
*       /*************************************************************/ 00618000
*                                                                  0160 00619000
*       BYTOFFST=UCBCNTR/EIGHT;     /*                       @G24LB37*/ 00620000
         LR    @00,UCBCNTR                                         0160 00621000
         SRDA  @00,32                                              0160 00622000
         D     @00,@CF00057                                        0160 00623000
         LR    BYTOFFST,@01                                        0160 00624000
*       BITOFFST=UCBCNTR//EIGHT;    /*                       @G24LB37*/ 00625000
*                                                                  0161 00626000
         LR    @00,UCBCNTR                                         0161 00627000
         SRDA  @00,32                                              0161 00628000
         D     @00,@CF00057                                        0161 00629000
         LR    BITOFFST,@00                                        0161 00630000
*       /*************************************************************/ 00631000
*       /*                                                           */ 00632000
*       /* TAKE THE BYTE COMPUTED IN THE DIVIDE AND 'AND'    @G24LB37*/ 00633000
*       /* THE BITMASK TO THE UNIT BIT WITHIN THE BYTE       @G24LB37*/ 00634000
*       /* USING THE BIT OFFSET. THIS IS DONE TO ELIMINATE   @G24LB37*/ 00635000
*       /* ALL OTHER BITS IN THE BYTE FOR THE SHIFT TO GIVE  @G24LB37*/ 00636000
*       /* CORRECT RESULTS(CONDITION CODE). PUT THE BYTE     @G24LB37*/ 00637000
*       /* INTO THE HIGH ORDER BYTE OF THE REGISTER.         @G24LB37*/ 00638000
*       /*                                                           */ 00639000
*       /*************************************************************/ 00640000
*                                                                  0162 00641000
*       WORKBYTE=DEVMASK(BYTOFFST+ONE);/*                    @G24LB37*/ 00642000
         LR    @01,DVMSKELP                                        0162 00643000
         ALR   @01,BYTOFFST                                        0162 00644000
         MVC   WORKBYTE(1),DEVMASK(@01)                            0162 00645000
*       WORKBYTE=BITMASK(BITOFFST+ONE)&WORKBYTE;/*           @G24LB37*/ 00646000
         LA    @04,BITMASK(BITOFFST)                               0163 00647000
         NC    WORKBYTE(1),0(@04)                                  0163 00648000
*       RFY                                                        0164 00649000
*         REG4 RESTRICTED;          /*                       @G24LB37*/ 00650000
*       REG4=WORKAREA;              /*                       @G24LB37*/ 00651000
*                                                                  0165 00652000
         ICM   REG4,15,WORKAREA                                    0165 00653000
*       /*************************************************************/ 00654000
*       /*                                                           */ 00655000
*       /* SHIFT THE REGISTER THE NUMBER OF BITS INDICATED   @G24LB37*/ 00656000
*       /* BY THE BIT OFFSET AND TEST THE RESULTS FOR A      @G24LB37*/ 00657000
*       /* MINUS OR AN OVERFLOW CONDITION, WHICH WILL BE     @G24LB37*/ 00658000
*       /* ONLY TRUE IF THE BIT IS ON. BRANCH TO END OF      @G24LB37*/ 00659000
*       /* THE PROCEDURE IF MINUS OR AN OVERFLOW CONDITION,  @G24LB37*/ 00660000
*       /* RETCODE IS ALREADY ZERO, ELSE SET RETCODE TO      @G24LB37*/ 00661000
*       /* FOUR, THE BIT IS NOT ON IN THE MASK.              @G24LB37*/ 00662000
*       /*                                                           */ 00663000
*       /*************************************************************/ 00664000
*                                                                  0166 00665000
*       SLA(REG4,BITOFFST);         /*                       @G24LB37*/ 00666000
         SLA   REG4,0(BITOFFST)                                    0166 00667000
*       BC(FIVE,BITON);             /*                       @G24LB37*/ 00668000
         BC    5,BITON                                             0167 00669000
*       RFY                                                        0168 00670000
*         REG4 UNRESTRICTED;        /*                       @G24LB37*/ 00671000
*       RETCODE=FOUR;               /*                       @G24LB37*/ 00672000
         LA    RETCODE,4                                           0169 00673000
*     END;                          /*                       @G24LB37*/ 00674000
*                                                                  0171 00675000
*   /*****************************************************************/ 00676000
*   /*                                                               */ 00677000
*   /* SET RETURN CODE TO FOUR, DEVICE TYPE WAS NOT FOUND.   @G24LB37*/ 00678000
*   /*                                                               */ 00679000
*   /*****************************************************************/ 00680000
*                                                                  0171 00681000
*   ELSE                                                           0171 00682000
*     RETCODE=FOUR;                 /*                       @G24LB37*/ 00683000
*                                                                  0171 00684000
         B     @RC00158                                            0171 00685000
@RF00158 LA    RETCODE,4                                           0171 00686000
*   /*****************************************************************/ 00687000
*   /*                                                               */ 00688000
*   /* RETURN TO CALLER, THE RETCODE AREA IS SET WITH RETURN @G24LB37*/ 00689000
*   /* CODE.                                                 @G24LB37*/ 00690000
*   /*                                                               */ 00691000
*   /*****************************************************************/ 00692000
*                                                                  0172 00693000
*BITON:                                                            0172 00694000
*   RETURN;                         /* RET TO UNITINCL PROC  @G24LB37*/ 00695000
@EL00006 DS    0H                                                  0172 00696000
@EF00006 DS    0H                                                  0172 00697000
@ER00006 BR    @14                                                 0172 00698000
*   END SCANMASK;                   /* END OF SCANMASK PROC  @G24LB37*/ 00699000
         B     @EL00006                                            0173 00700000
*   END ICBVUP00                    /* END OF ICBVUP00       @G24LB37*/ 00701000
*                                                                  0174 00702000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00703000
*/*%INCLUDE SYSLIB  (IEZUNITP)                                       */ 00704000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 00705000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 00706000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 00707000
*                                                                  0174 00708000
*       ;                                                          0174 00709000
@DATA    DS    0H                                                       00710000
@SM01249 MVC   WORKMASK(0),DEVMASK(DVMSKELP)                            00711000
@SN01251 NC    WORKMASK(0),SAVMASK(SAV3330P)                            00712000
@SC01253 CLC   WORKMASK(0),DEVMASK(DVMSKELP)                            00713000
         DS    0F                                                       00714000
@SA00001 DS    18F                                                      00715000
@PC00001 DS    2F                                                       00716000
@SA00004 DS    1F                                                       00717000
         DS    0F                                                       00718000
@CF00048 DC    F'1'                                                     00719000
@CF00043 DC    F'2'                                                     00720000
@CF00039 DC    F'4'                                                     00721000
@CF00057 DC    F'8'                                                     00722000
@CF01255 DC    XL4'0000FFFF'                                            00723000
         DS    0D                                                       00724000
SAVDEVTP DS    A                                                        00725000
DEV3330V DC    X'30582009'                                              00726000
UCBDELIM DC    X'FFFFFFFF'                                              00727000
VUP00SWS DS    CL2                                                      00728000
         ORG   VUP00SWS                                                 00729000
FOUNDSW  DS    BL1                                                      00730000
EXITSW   EQU   VUP00SWS+0                                               00731000
@NM00009 EQU   VUP00SWS+0                                               00732000
         ORG   VUP00SWS+2                                               00733000
WORKAREA DS    CL4                                                      00734000
         ORG   WORKAREA                                                 00735000
WORKBYTE DS    CL1                                                      00736000
@NM00010 DS    CL3                                                      00737000
         ORG   WORKAREA+4                                               00738000
WORKMASK DS    CL256                                                    00739000
         DS    CL2                                                      00740000
FIXAREA  DS    CL100                                                    00741000
         ORG   FIXAREA                                                  00742000
@NM00012 DC    100X'00'                                                 00743000
         ORG   FIXAREA+100                                              00744000
BITMASK  DC    X'80'                                                    00745000
         DC    X'40'                                                    00746000
         DC    X'20'                                                    00747000
         DC    X'10'                                                    00748000
         DC    X'08'                                                    00749000
         DC    X'04'                                                    00750000
         DC    X'02'                                                    00751000
         DC    X'01'                                                    00752000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00753000
@01      EQU   01                                                       00754000
@02      EQU   02                                                       00755000
@03      EQU   03                                                       00756000
@04      EQU   04                                                       00757000
@05      EQU   05                                                       00758000
@06      EQU   06                                                       00759000
@07      EQU   07                                                       00760000
@08      EQU   08                                                       00761000
@09      EQU   09                                                       00762000
@10      EQU   10                                                       00763000
@11      EQU   11                                                       00764000
@12      EQU   12                                                       00765000
@13      EQU   13                                                       00766000
@14      EQU   14                                                       00767000
@15      EQU   15                                                       00768000
BITOFFST EQU   @03                                                      00769000
BYTOFFST EQU   @04                                                      00770000
UCBCNTR  EQU   @08                                                      00771000
DVMSKMLN EQU   @07                                                      00772000
DVMSKELN EQU   @10                                                      00773000
RETCODE  EQU   @05                                                      00774000
X        EQU   @09                                                      00775000
SAV3330P EQU   @03                                                      00776000
DVMSKELP EQU   @02                                                      00777000
DVMSKPTR EQU   @04                                                      00778000
UCBLOKUP EQU   @02                                                      00779000
MSVLKPTR EQU   @02                                                      00780000
UNITPTR  EQU   @06                                                      00781000
UCBPTR   EQU   @04                                                      00782000
VVIPTR   EQU   @03                                                      00783000
REG4     EQU   @04                                                      00784000
REG14    EQU   @14                                                      00785000
REG0     EQU   @00                                                      00786000
REG1     EQU   @01                                                      00787000
REG15    EQU   @15                                                      00788000
CVTPTR   EQU   16                                                       00789000
UNITP    EQU   0                                                        00790000
UNIDEVTP EQU   UNITP                                                    00791000
UNIVOL   EQU   UNITP+4                                                  00792000
UNIUCBP  EQU   UNITP+12                                                 00793000
UNIFLAGS EQU   UNITP+16                                                 00794000
UNIFMTD  EQU   UNIFLAGS                                                 00795000
UNIFINCL EQU   UNIFLAGS                                                 00796000
UNIFALLV EQU   UNIFLAGS                                                 00797000
VVICB    EQU   0                                                        00798000
VVIFLGA  EQU   VVICB+15                                                 00799000
VVIUCB   EQU   VVICB+60                                                 00800000
VVIDVMTA EQU   VVICB+84                                                 00801000
VVIDVMEL EQU   VVICB+104                                                00802000
CVTMAP   EQU   0                                                        00803000
CVTILK2  EQU   CVTMAP+40                                                00804000
CVTDAR   EQU   CVTMAP+72                                                00805000
CVTFLGS1 EQU   CVTDAR                                                   00806000
CVTDCB   EQU   CVTMAP+116                                               00807000
CVTIERLC EQU   CVTMAP+144                                               00808000
CVTOPTA  EQU   CVTMAP+182                                               00809000
CVTOPTB  EQU   CVTMAP+183                                               00810000
CVTGTF   EQU   CVTMAP+236                                               00811000
CVTGTFST EQU   CVTGTF                                                   00812000
CVTGTFS  EQU   CVTGTFST                                                 00813000
CVTSTATE EQU   CVTGTFST                                                 00814000
CVTTMODE EQU   CVTGTFST                                                 00815000
CVTFORM  EQU   CVTGTFST                                                 00816000
CVTAQAVT EQU   CVTMAP+240                                               00817000
CVTTCMFG EQU   CVTAQAVT                                                 00818000
CVTVOLM2 EQU   CVTMAP+244                                               00819000
CVTTATA  EQU   CVTVOLM2                                                 00820000
CVTTSKS  EQU   CVTTATA                                                  00821000
CVTVOLF2 EQU   CVTTSKS                                                  00822000
CVTTAT   EQU   CVTTATA+1                                                00823000
CVTATER  EQU   CVTMAP+248                                               00824000
CVTEXT1  EQU   CVTMAP+252                                               00825000
CVTPURG  EQU   CVTMAP+260                                               00826000
CVTQMSG  EQU   CVTMAP+268                                               00827000
CVTDMSR  EQU   CVTMAP+272                                               00828000
CVTRSV37 EQU   CVTDMSR                                                  00829000
CVTDMSRF EQU   CVTRSV37                                                 00830000
CVTERPV  EQU   CVTMAP+316                                               00831000
CVTINTLA EQU   CVTMAP+320                                               00832000
CVTAPF   EQU   CVTMAP+324                                               00833000
CVTEXT2  EQU   CVTMAP+328                                               00834000
CVTHJES  EQU   CVTMAP+332                                               00835000
CVTPGSIA EQU   CVTMAP+348                                               00836000
CVTA1F1  EQU   CVTMAP+356                                               00837000
CVTSYSK  EQU   CVTMAP+357                                               00838000
CVTVOLM1 EQU   CVTMAP+380                                               00839000
CVTVOLF1 EQU   CVTVOLM1                                                 00840000
CVTATMCT EQU   CVTMAP+388                                               00841000
CVTXTNT1 EQU   0                                                        00842000
CVTXTNT2 EQU   0                                                        00843000
CVTDSSV  EQU   CVTXTNT2                                                 00844000
CVTFLGBT EQU   CVTXTNT2+5                                               00845000
CVTQID   EQU   CVTXTNT2+24                                              00846000
CVTRV400 EQU   CVTXTNT2+52                                              00847000
CVTRV409 EQU   CVTXTNT2+53                                              00848000
CVTATCVT EQU   CVTXTNT2+64                                              00849000
CVTRV429 EQU   CVTXTNT2+84                                              00850000
CVTRV438 EQU   CVTXTNT2+85                                              00851000
CVTRV457 EQU   CVTXTNT2+112                                             00852000
CVTRV466 EQU   CVTXTNT2+113                                             00853000
CVTFIX   EQU   0                                                        00854000
CVTRELNO EQU   CVTFIX+252                                               00855000
UCB      EQU   0                                                        00856000
UCBOB    EQU   0                                                        00857000
UCBJBNR  EQU   UCBOB                                                    00858000
UCBFL5   EQU   UCBOB+1                                                  00859000
UCBAF    EQU   UCBFL5                                                   00860000
UCBSTAT  EQU   UCBOB+3                                                  00861000
UCBCHAN  EQU   UCBOB+4                                                  00862000
UCBSFLS  EQU   UCBOB+6                                                  00863000
UCBFLA   EQU   UCBSFLS                                                  00864000
UCBFL1   EQU   UCBFLA                                                   00865000
UCBBSY   EQU   UCBFL1                                                   00866000
UCBNRY   EQU   UCBFL1                                                   00867000
UCBPST   EQU   UCBFL1                                                   00868000
UCBCUB   EQU   UCBFL1                                                   00869000
UCBFLB   EQU   UCBSFLS+1                                                00870000
UCBCHM   EQU   UCBOB+8                                                  00871000
UCBCHM1  EQU   UCBCHM                                                   00872000
UCBPTH0  EQU   UCBCHM1                                                  00873000
UCBPTH1  EQU   UCBCHM1                                                  00874000
UCBWGT   EQU   UCBOB+12                                                 00875000
UCBTYP   EQU   UCBOB+16                                                 00876000
UCBTBYT1 EQU   UCBTYP                                                   00877000
UCB1FEA5 EQU   UCBTBYT1                                                 00878000
UCB1FEA6 EQU   UCBTBYT1                                                 00879000
UCBTBYT2 EQU   UCBTYP+1                                                 00880000
UCB2OPT2 EQU   UCBTBYT2                                                 00881000
UCBDUDN1 EQU   UCB2OPT2                                                 00882000
UCB2OPT3 EQU   UCBTBYT2                                                 00883000
UCBDUDN2 EQU   UCB2OPT3                                                 00884000
UCB2OPT4 EQU   UCBTBYT2                                                 00885000
UCBRWTAU EQU   UCB2OPT4                                                 00886000
UCB2OPT6 EQU   UCBTBYT2                                                 00887000
UCB2OPT7 EQU   UCBTBYT2                                                 00888000
UCBTBYT3 EQU   UCBTYP+2                                                 00889000
UCBDVCLS EQU   UCBTBYT3                                                 00890000
UCBTBYT4 EQU   UCBTYP+3                                                 00891000
UCBEXTPT EQU   UCBOB+20                                                 00892000
UCBFLC   EQU   UCBEXTPT                                                 00893000
UCBDEV   EQU   UCBOB+24                                                 00894000
UCBCMEXT EQU   0                                                        00895000
UCBATI   EQU   UCBCMEXT+3                                               00896000
@NM00008 EQU   UCBATI                                                   00897000
UCBFLP1  EQU   UCBCMEXT+5                                               00898000
UCBMT    EQU   0                                                        00899000
UCBOCR   EQU   0                                                        00900000
UCB3540X EQU   0                                                        00901000
UCBDKBYT EQU   UCB3540X+6                                               00902000
UCB3800X EQU   0                                                        00903000
UCBOPTNS EQU   UCB3800X                                                 00904000
UCBACTIV EQU   UCB3800X+3                                               00905000
UCBMDRBF EQU   UCB3800X+36                                              00906000
UCBUCS   EQU   0                                                        00907000
UCBUCSOP EQU   UCBUCS+4                                                 00908000
UCBFCBOP EQU   UCBUCS+5                                                 00909000
MSVLKUPT EQU   0                                                        00910000
MSVUCBP  EQU   MSVLKUPT                                                 00911000
SYSLKUPT EQU   0                                                        00912000
UCBADDR  EQU   SYSLKUPT                                                 00913000
DEVMASKT EQU   0                                                        00914000
DEVNUMEL EQU   DEVMASKT                                                 00915000
DEVMSKEL EQU   DEVMASKT+4                                               00916000
DEVMASKE EQU   0                                                        00917000
DEVTYPE  EQU   DEVMASKE+4                                               00918000
DEVMASK  EQU   DEVMASKE+8                                               00919000
SAVMASKE EQU   0                                                        00920000
SAVMASK  EQU   SAVMASKE+8                                               00921000
UCBBGN   EQU   0                                                        00922000
UNITRPL  EQU   0                                                        00923000
VVICBLK  EQU   0                                                        00924000
CVTS01   EQU   CVTPGSIA                                                 00925000
CVTLPDIA EQU   CVTS01+12                                                00926000
CVTDIRST EQU   CVTLPDIA                                                 00927000
CVTSLIDA EQU   CVTS01+24                                                00928000
CVTCTLFG EQU   CVTS01+50                                                00929000
CVTRV210 EQU   CVTS01+424                                               00930000
CVTRV219 EQU   CVTS01+425                                               00931000
CVTRV228 EQU   CVTS01+426                                               00932000
CVTRV237 EQU   CVTS01+427                                               00933000
CVTMFRTR EQU   CVTS01+452                                               00934000
CVTRV262 EQU   CVTS01+468                                               00935000
CVTRV271 EQU   CVTS01+469                                               00936000
CVTRV280 EQU   CVTS01+470                                               00937000
CVTRV289 EQU   CVTS01+471                                               00938000
CVTGSDA  EQU   CVTS01+600                                               00939000
UCBOBS01 EQU   UCBDEV                                                   00940000
UCBVOLI  EQU   UCBOBS01+4                                               00941000
UCBSTAB  EQU   UCBOBS01+10                                              00942000
UCBBSVL  EQU   UCBSTAB                                                  00943000
UCBPRSRS EQU   UCBSTAB                                                  00944000
UCBDMCT  EQU   UCBOBS01+11                                              00945000
UCBFL4   EQU   UCBOBS01+13                                              00946000
UCBOBS02 EQU   UCBDEV                                                   00947000
UCBTFL1  EQU   UCBOBS02+19                                              00948000
UCBXTN   EQU   UCBOBS02+20                                              00949000
UCBVOPT  EQU   UCBXTN                                                   00950000
UCBOBS03 EQU   UCBDEV                                                   00951000
UCBXTADR EQU   UCBOBS03                                                 00952000
UCBOBS04 EQU   UCBDEV                                                   00953000
UCBBTA   EQU   UCBOBS04+12                                              00954000
UCBOBS06 EQU   UCBDEV                                                   00955000
UCBAOF   EQU   UCBOBS06                                                 00956000
UCBAOF1  EQU   UCBAOF                                                   00957000
UCBAOF2  EQU   UCBAOF+1                                                 00958000
@NM00007 EQU   UCBOBS06+3                                               00959000
UCBIRB   EQU   UCBOBS06+4                                               00960000
UCBGRAF  EQU   UCBIRB                                                   00961000
UCBLDNCA EQU   UCBOBS06+8                                               00962000
UCBRDYQ  EQU   UCBLDNCA                                                 00963000
UCBIRLN  EQU   UCBRDYQ                                                  00964000
UCBLDNCB EQU   UCBRDYQ+1                                                00965000
UCBCTLNK EQU   UCBOBS06+12                                              00966000
UCBOBS07 EQU   UCBDEV                                                   00967000
UCBOBS08 EQU   UCBDEV                                                   00968000
UCBCTCAD EQU   UCBOBS08                                                 00969000
UCBCTCF1 EQU   UCBOBS08+4                                               00970000
UCBOBS09 EQU   UCBDEV                                                   00971000
*                                      START UNREFERENCED COMPONENTS    00972000
UCBRV066 EQU   UCBOBS09+4                                               00973000
UCBIOSBA EQU   UCBOBS09                                                 00974000
UCBRV042 EQU   UCBOBS08+5                                               00975000
UCBRV082 EQU   UCBCTCF1                                                 00976000
UCBRV081 EQU   UCBCTCF1                                                 00977000
UCBRV080 EQU   UCBCTCF1                                                 00978000
UCBRV079 EQU   UCBCTCF1                                                 00979000
UCBRV078 EQU   UCBCTCF1                                                 00980000
UCBRV077 EQU   UCBCTCF1                                                 00981000
UCBRV076 EQU   UCBCTCF1                                                 00982000
UCBCTC80 EQU   UCBCTCF1                                                 00983000
UCBCTCAL EQU   UCBCTCAD                                                 00984000
UCBICNCB EQU   UCBOBS07+4                                               00985000
UCBRV040 EQU   UCBOBS07                                                 00986000
UCBCTLNA EQU   UCBCTLNK+1                                               00987000
UCBRLN   EQU   UCBCTLNK                                                 00988000
UCBRDYQA EQU   UCBLDNCB                                                 00989000
UCBINRLN EQU   UCBIRLN                                                  00990000
UCBIRBA  EQU   UCBIRB+1                                                 00991000
UCBRV039 EQU   UCBGRAF                                                  00992000
UCBDWNR  EQU   UCBGRAF                                                  00993000
UCBRPND  EQU   UCBGRAF                                                  00994000
UCBUPM   EQU   UCBGRAF                                                  00995000
UCBBTAM  EQU   UCBGRAF                                                  00996000
UCBDRNO  EQU   UCBGRAF                                                  00997000
UCBDRO   EQU   UCBGRAF                                                  00998000
UCBOIP   EQU   UCBGRAF                                                  00999000
UCBATRCD EQU   @NM00007                                                 01000000
UCBSKPFG EQU   @NM00007                                                 01001000
UCBRIPND EQU   @NM00007                                                 01002000
UCBRTIAC EQU   @NM00007                                                 01003000
UCBRSV79 EQU   @NM00007                                                 01004000
UCBRSV78 EQU   @NM00007                                                 01005000
UCBRSV77 EQU   @NM00007                                                 01006000
UCBOLTEP EQU   @NM00007                                                 01007000
UCBATNCT EQU   UCBOBS06+2                                               01008000
UCBRSV76 EQU   UCBAOF2                                                  01009000
UCBRSV75 EQU   UCBAOF2                                                  01010000
UCBRSV74 EQU   UCBAOF2                                                  01011000
UCBRSV73 EQU   UCBAOF2                                                  01012000
UCBRSV72 EQU   UCBAOF2                                                  01013000
UCBRSV71 EQU   UCBAOF2                                                  01014000
UCBRSV70 EQU   UCBAOF2                                                  01015000
UCBRSV69 EQU   UCBAOF2                                                  01016000
UCBRSV68 EQU   UCBAOF1                                                  01017000
UCBRSV67 EQU   UCBAOF1                                                  01018000
UCBRSV66 EQU   UCBAOF1                                                  01019000
UCBRSV65 EQU   UCBAOF1                                                  01020000
UCBRSV64 EQU   UCBAOF1                                                  01021000
UCBOFNL  EQU   UCBAOF1                                                  01022000
UCBOFSP  EQU   UCBAOF1                                                  01023000
UCBOFMCR EQU   UCBAOF1                                                  01024000
UCBBTB   EQU   UCBBTA+1                                                 01025000
UCBDI    EQU   UCBBTA                                                   01026000
UCBSNS   EQU   UCBOBS04+8                                               01027000
UCBTEB   EQU   UCBOBS04+4                                               01028000
UCBGCB   EQU   UCBOBS04+3                                               01029000
UCBOPEN  EQU   UCBOBS04+2                                               01030000
UCBSTART EQU   UCBOBS04                                                 01031000
UCBXTNB  EQU   UCBXTN+1                                                 01032000
UCBRSV22 EQU   UCBVOPT                                                  01033000
UCBRSV21 EQU   UCBVOPT                                                  01034000
UCBRSV20 EQU   UCBVOPT                                                  01035000
UCBESVE  EQU   UCBVOPT                                                  01036000
UCBERPC  EQU   UCBVOPT                                                  01037000
UCBESVC  EQU   UCBVOPT                                                  01038000
UCBEVA   EQU   UCBVOPT                                                  01039000
UCBESV   EQU   UCBVOPT                                                  01040000
UCBRV009 EQU   UCBTFL1                                                  01041000
UCBRV008 EQU   UCBTFL1                                                  01042000
UCBRV007 EQU   UCBTFL1                                                  01043000
UCBRV006 EQU   UCBTFL1                                                  01044000
UCBRV005 EQU   UCBTFL1                                                  01045000
UCBRV038 EQU   UCBTFL1                                                  01046000
UCBNSLTP EQU   UCBTFL1                                                  01047000
UCBNLTP  EQU   UCBTFL1                                                  01048000
UCBRES1B EQU   UCBOBS02+18                                              01049000
UCBFSER  EQU   UCBOBS02+12                                              01050000
@NM00006 EQU   UCBOBS02+4                                               01051000
UCBFSEQ  EQU   UCBOBS02+2                                               01052000
UCBFSCT  EQU   UCBOBS02                                                 01053000
UCBNEXP  EQU   UCBOBS01+20                                              01054000
UCBBASE  EQU   UCBOBS01+16                                              01055000
UCBRES1A EQU   UCBOBS01+15                                              01056000
UCBUSER  EQU   UCBOBS01+14                                              01057000
UCBFL47  EQU   UCBFL4                                                   01058000
UCBMAT   EQU   UCBFL4                                                   01059000
UCBHOLD  EQU   UCBFL4                                                   01060000
UCBATTN  EQU   UCBFL4                                                   01061000
UCBDSS   EQU   UCBFL4                                                   01062000
UCBRESVP EQU   UCBFL4                                                   01063000
UCBWDAV  EQU   UCBFL4                                                   01064000
UCBDAVV  EQU   UCBFL4                                                   01065000
UCBSQC   EQU   UCBOBS01+12                                              01066000
UCBDATP  EQU   UCBOBS01+12                                              01067000
UCBDMC   EQU   UCBDMCT                                                  01068000
UCBMOUNT EQU   UCBDMCT                                                  01069000
UCBBNUL  EQU   UCBSTAB                                                  01070000
UCBSHAR  EQU   UCBSTAB                                                  01071000
UCBBSTR  EQU   UCBSTAB                                                  01072000
UCBBPUB  EQU   UCBSTAB                                                  01073000
UCBBPRV  EQU   UCBSTAB                                                  01074000
UCBBALB  EQU   UCBPRSRS                                                 01075000
UCBPGFL  EQU   UCBSTAB                                                  01076000
UCBDVSHR EQU   UCBBSVL                                                  01077000
UCBVTOC  EQU   UCBOBS01                                                 01078000
CVTRV628 EQU   CVTS01+728                                               01079000
CVTRV627 EQU   CVTS01+724                                               01080000
CVTRV626 EQU   CVTS01+720                                               01081000
CVTRV625 EQU   CVTS01+716                                               01082000
CVTRV624 EQU   CVTS01+712                                               01083000
CVTRV623 EQU   CVTS01+708                                               01084000
CVTRV622 EQU   CVTS01+704                                               01085000
CVTRV621 EQU   CVTS01+700                                               01086000
CVTIHASU EQU   CVTS01+696                                               01087000
CVTRV619 EQU   CVTS01+692                                               01088000
CVTRV618 EQU   CVTS01+688                                               01089000
CVTRV617 EQU   CVTS01+684                                               01090000
CVTRV616 EQU   CVTS01+680                                               01091000
CVTRV615 EQU   CVTS01+676                                               01092000
CVTRV614 EQU   CVTS01+672                                               01093000
CVTRV613 EQU   CVTS01+668                                               01094000
CVTTCASP EQU   CVTS01+664                                               01095000
CVT0PT03 EQU   CVTS01+660                                               01096000
CVT0PT0E EQU   CVTS01+656                                               01097000
CVTRV609 EQU   CVTS01+652                                               01098000
CVTCGK   EQU   CVTS01+648                                               01099000
CVTRAC   EQU   CVTS01+644                                               01100000
CVTRV606 EQU   CVTS01+640                                               01101000
CVTRV605 EQU   CVTS01+636                                               01102000
CVTRV604 EQU   CVTS01+632                                               01103000
CVTEFF02 EQU   CVTS01+628                                               01104000
CVTCBBR  EQU   CVTS01+624                                               01105000
CVTSSCR  EQU   CVTS01+620                                               01106000
CVTEVENT EQU   CVTS01+616                                               01107000
CVTCRCA  EQU   CVTS01+612                                               01108000
CVTTPIO  EQU   CVTS01+608                                               01109000
CVTADV   EQU   CVTS01+604                                               01110000
CVTGSDAB EQU   CVTGSDA                                                  01111000
CVTQV3   EQU   CVTS01+596                                               01112000
CVTQV2   EQU   CVTS01+592                                               01113000
CVTQV1   EQU   CVTS01+588                                               01114000
CVTRPT   EQU   CVTS01+584                                               01115000
CVTSSRB  EQU   CVTS01+580                                               01116000
CVTCSDRL EQU   CVTS01+576                                               01117000
CVTEXP1  EQU   CVTS01+572                                               01118000
CVTRMPMT EQU   CVTS01+568                                               01119000
CVTRMPTT EQU   CVTS01+564                                               01120000
CVTVPSA  EQU   CVTS01+560                                               01121000
CVTVSTOP EQU   CVTS01+556                                               01122000
CVTGTFR8 EQU   CVTS01+552                                               01123000
CVTQUIT  EQU   CVTS01+548                                               01124000
CVTVACR  EQU   CVTS01+544                                               01125000
CVTWTCB  EQU   CVTS01+540                                               01126000
CVTSTPRS EQU   CVTS01+536                                               01127000
CVT0PT02 EQU   CVTS01+532                                               01128000
CVTDARCM EQU   CVTS01+528                                               01129000
CVTIRECM EQU   CVTS01+524                                               01130000
CVTJRECM EQU   CVTS01+520                                               01131000
CVTVEMS0 EQU   CVTS01+516                                               01132000
CVTSPFRR EQU   CVTS01+512                                               01133000
CVTRLSTG EQU   CVTS01+508                                               01134000
CVT0TC0A EQU   CVTS01+504                                               01135000
CVTGMBR  EQU   CVTS01+500                                               01136000
CVTLFRM  EQU   CVTS01+496                                               01137000
CVTRMBR  EQU   CVTS01+492                                               01138000
CVTVIOP  EQU   CVTS01+488                                               01139000
CVTRV307 EQU   CVTS01+486                                               01140000
CVTRV306 EQU   CVTS01+484                                               01141000
CVTRV305 EQU   CVTS01+482                                               01142000
CVTRV304 EQU   CVTS01+480                                               01143000
CVTRV303 EQU   CVTS01+478                                               01144000
CVTRV302 EQU   CVTS01+476                                               01145000
CVTTRCA  EQU   CVTS01+472                                               01146000
CVTRV297 EQU   CVTRV289                                                 01147000
CVTRV296 EQU   CVTRV289                                                 01148000
CVTRV295 EQU   CVTRV289                                                 01149000
CVTRV294 EQU   CVTRV289                                                 01150000
CVTRV293 EQU   CVTRV289                                                 01151000
CVTRV292 EQU   CVTRV289                                                 01152000
CVTRV291 EQU   CVTRV289                                                 01153000
CVTRV290 EQU   CVTRV289                                                 01154000
CVTRV288 EQU   CVTRV280                                                 01155000
CVTRV287 EQU   CVTRV280                                                 01156000
CVTRV286 EQU   CVTRV280                                                 01157000
CVTRV285 EQU   CVTRV280                                                 01158000
CVTRV284 EQU   CVTRV280                                                 01159000
CVTRV283 EQU   CVTRV280                                                 01160000
CVTRV282 EQU   CVTRV280                                                 01161000
CVTRV281 EQU   CVTRV280                                                 01162000
CVTRV279 EQU   CVTRV271                                                 01163000
CVTRV278 EQU   CVTRV271                                                 01164000
CVTRV277 EQU   CVTRV271                                                 01165000
CVTRV276 EQU   CVTRV271                                                 01166000
CVTRV275 EQU   CVTRV271                                                 01167000
CVTRV274 EQU   CVTRV271                                                 01168000
CVTRV273 EQU   CVTRV271                                                 01169000
CVTRV272 EQU   CVTRV271                                                 01170000
CVTRV270 EQU   CVTRV262                                                 01171000
CVTRV269 EQU   CVTRV262                                                 01172000
CVTRV268 EQU   CVTRV262                                                 01173000
CVTRV267 EQU   CVTRV262                                                 01174000
CVTRV266 EQU   CVTRV262                                                 01175000
CVTRV265 EQU   CVTRV262                                                 01176000
CVTRV264 EQU   CVTRV262                                                 01177000
CVTRV263 EQU   CVTRV262                                                 01178000
CVTVFP   EQU   CVTS01+464                                               01179000
CVTVSI   EQU   CVTS01+460                                               01180000
CVTVPSIB EQU   CVTS01+456                                               01181000
CVTMFACT EQU   CVTMFRTR                                                 01182000
CVTMFCTL EQU   CVTS01+448                                               01183000
CVTPVBP  EQU   CVTS01+444                                               01184000
CVTPWI   EQU   CVTS01+440                                               01185000
CVTRV254 EQU   CVTS01+438                                               01186000
CVTRV253 EQU   CVTS01+436                                               01187000
CVTRV252 EQU   CVTS01+434                                               01188000
CVTRV251 EQU   CVTS01+433                                               01189000
CVTRV250 EQU   CVTS01+432                                               01190000
CVTRV249 EQU   CVTS01+431                                               01191000
CVTRV248 EQU   CVTS01+430                                               01192000
CVTRV247 EQU   CVTS01+429                                               01193000
CVTRV246 EQU   CVTS01+428                                               01194000
CVTRV245 EQU   CVTRV237                                                 01195000
CVTRV244 EQU   CVTRV237                                                 01196000
CVTRV243 EQU   CVTRV237                                                 01197000
CVTRV242 EQU   CVTRV237                                                 01198000
CVTRV241 EQU   CVTRV237                                                 01199000
CVTRV240 EQU   CVTRV237                                                 01200000
CVTRV239 EQU   CVTRV237                                                 01201000
CVTRV238 EQU   CVTRV237                                                 01202000
CVTRV236 EQU   CVTRV228                                                 01203000
CVTRV235 EQU   CVTRV228                                                 01204000
CVTRV234 EQU   CVTRV228                                                 01205000
CVTRV233 EQU   CVTRV228                                                 01206000
CVTRV232 EQU   CVTRV228                                                 01207000
CVTRV231 EQU   CVTRV228                                                 01208000
CVTRV230 EQU   CVTRV228                                                 01209000
CVTRV229 EQU   CVTRV228                                                 01210000
CVTRV227 EQU   CVTRV219                                                 01211000
CVTRV226 EQU   CVTRV219                                                 01212000
CVTRV225 EQU   CVTRV219                                                 01213000
CVTRV224 EQU   CVTRV219                                                 01214000
CVTRV223 EQU   CVTRV219                                                 01215000
CVTRV222 EQU   CVTRV219                                                 01216000
CVTRV221 EQU   CVTRV219                                                 01217000
CVTRV220 EQU   CVTRV219                                                 01218000
CVTRV218 EQU   CVTRV210                                                 01219000
CVTRV217 EQU   CVTRV210                                                 01220000
CVTRV216 EQU   CVTRV210                                                 01221000
CVTRV215 EQU   CVTRV210                                                 01222000
CVTRV214 EQU   CVTRV210                                                 01223000
CVTRV213 EQU   CVTRV210                                                 01224000
CVTRV212 EQU   CVTRV210                                                 01225000
CVTRV211 EQU   CVTRV210                                                 01226000
CVTLCCAT EQU   CVTS01+420                                               01227000
CVTPCCAT EQU   CVTS01+416                                               01228000
CVTIPCRP EQU   CVTS01+412                                               01229000
CVTIPCRI EQU   CVTS01+408                                               01230000
CVTIPCDS EQU   CVTS01+404                                               01231000
CVTAIDVT EQU   CVTS01+400                                               01232000
CVTSSAP  EQU   CVTS01+396                                               01233000
CVTEHCIR EQU   CVTS01+392                                               01234000
CVTEHDEF EQU   CVTS01+388                                               01235000
CVTDAIR  EQU   CVTS01+384                                               01236000
CVTPERFM EQU   CVTS01+380                                               01237000
CVT044R2 EQU   CVTS01+376                                               01238000
CVTFETCH EQU   CVTS01+372                                               01239000
CVTRSTWD EQU   CVTS01+368                                               01240000
CVTSPOST EQU   CVTS01+364                                               01241000
CVTIOBP  EQU   CVTS01+360                                               01242000
CVTASMVT EQU   CVTS01+356                                               01243000
CVTRECRQ EQU   CVTS01+352                                               01244000
CVTWSAC  EQU   CVTS01+348                                               01245000
CVTRV149 EQU   CVTS01+344                                               01246000
CVTWSAL  EQU   CVTS01+340                                               01247000
CVTSPSA  EQU   CVTS01+336                                               01248000
CVTGLMN  EQU   CVTS01+332                                               01249000
CVTVEAC0 EQU   CVTS01+328                                               01250000
CVT062R1 EQU   CVTS01+324                                               01251000
CVTRPOST EQU   CVTS01+320                                               01252000
CVTDQIQE EQU   CVTS01+316                                               01253000
CVTCSD   EQU   CVTS01+312                                               01254000
CVTLKRMA EQU   CVTS01+308                                               01255000
CVTRSPIE EQU   CVTS01+304                                               01256000
CVTRENQ  EQU   CVTS01+300                                               01257000
CVTLQCB  EQU   CVTS01+296                                               01258000
CVTFQCB  EQU   CVTS01+292                                               01259000
CVTQCS01 EQU   CVTS01+288                                               01260000
CVTAPFT  EQU   CVTS01+284                                               01261000
CVTPARRL EQU   CVTS01+280                                               01262000
CVTVWAIT EQU   CVTS01+276                                               01263000
CVTGSPL  EQU   CVTS01+272                                               01264000
CVTLSMQ  EQU   CVTS01+268                                               01265000
CVTGSMQ  EQU   CVTS01+264                                               01266000
CVTEXPRO EQU   CVTS01+260                                               01267000
CVTOPCTP EQU   CVTS01+256                                               01268000
CVTSIC   EQU   CVTS01+252                                               01269000
CVTTPIOS EQU   CVTS01+248                                               01270000
CVTRTMS  EQU   CVTS01+244                                               01271000
CVTSDBF  EQU   CVTS01+240                                               01272000
CVTSCBP  EQU   CVTS01+236                                               01273000
CVTSDMP  EQU   CVTS01+232                                               01274000
CVTSV60  EQU   CVTS01+228                                               01275000
CVTRTMCT EQU   CVTS01+224                                               01276000
CVTASCBL EQU   CVTS01+220                                               01277000
CVTASCBH EQU   CVTS01+216                                               01278000
CVTGDA   EQU   CVTS01+212                                               01279000
CVTASVT  EQU   CVTS01+208                                               01280000
CVTVVMDI EQU   CVTS01+204                                               01281000
CVTAQTOP EQU   CVTS01+200                                               01282000
CVTIOSCS EQU   CVTS01+196                                               01283000
CVTSDRM  EQU   CVTS01+192                                               01284000
CVTOPTE  EQU   CVTS01+188                                               01285000
CVTSTXU  EQU   CVTS01+184                                               01286000
CVTQUIS  EQU   CVTS01+180                                               01287000
CVTPARS  EQU   CVTS01+176                                               01288000
CVTS1EE  EQU   CVTS01+172                                               01289000
CVTFRAS  EQU   CVTS01+168                                               01290000
CVTQSAS  EQU   CVTS01+164                                               01291000
CVTCRAS  EQU   CVTS01+160                                               01292000
CVTCRMN  EQU   CVTS01+156                                               01293000
CVTDELCP EQU   CVTS01+152                                               01294000
CVTFRECL EQU   CVTS01+148                                               01295000
CVTGETCL EQU   CVTS01+144                                               01296000
CVTBLDCP EQU   CVTS01+140                                               01297000
CVTAUTHL EQU   CVTS01+136                                               01298000
CVTSCAN  EQU   CVTS01+132                                               01299000
CVTRV144 EQU   CVTS01+130                                               01300000
CVTMAXMP EQU   CVTS01+128                                               01301000
CVTSTCK  EQU   CVTS01+124                                               01302000
CVTRV139 EQU   CVTS01+123                                               01303000
CVTDSSAC EQU   CVTS01+122                                               01304000
CVTRV513 EQU   CVTS01+121                                               01305000
CVTIOSPL EQU   CVTS01+120                                               01306000
CVTPTGT  EQU   CVTS01+116                                               01307000
CVTCSPIE EQU   CVTS01+112                                               01308000
CVTSMFEX EQU   CVTS01+108                                               01309000
CVTOLT0A EQU   CVTS01+104                                               01310000
CVTSRBRT EQU   CVTS01+100                                               01311000
CVTPUTL  EQU   CVTS01+96                                                01312000
CVTASCRL EQU   CVTS01+92                                                01313000
CVTASCRF EQU   CVTS01+88                                                01314000
CVTRV326 EQU   CVTS01+84                                                01315000
CVTRV325 EQU   CVTS01+80                                                01316000
CVTRV324 EQU   CVTS01+76                                                01317000
CVT0VL01 EQU   CVTS01+72                                                01318000
CVTSHRVM EQU   CVTS01+68                                                01319000
CVTRV332 EQU   CVTS01+64                                                01320000
CVTTAS   EQU   CVTS01+60                                                01321000
CVTRSCN  EQU   CVTS01+56                                                01322000
CVTTRAC2 EQU   CVTS01+54                                                01323000
CVTTRACE EQU   CVTS01+52                                                01324000
CVTAPG   EQU   CVTS01+51                                                01325000
CVTSDTRC EQU   CVTCTLFG                                                 01326000
CVTGTRCE EQU   CVTCTLFG                                                 01327000
CVTNOMP  EQU   CVTCTLFG                                                 01328000
CVTRSV79 EQU   CVTCTLFG                                                 01329000
CVTDSTAT EQU   CVTCTLFG                                                 01330000
CVTRSV78 EQU   CVTCTLFG                                                 01331000
CVTRV333 EQU   CVTCTLFG                                                 01332000
CVTRV323 EQU   CVTCTLFG                                                 01333000
CVTSPVLK EQU   CVTS01+49                                                01334000
CVTRSV77 EQU   CVTS01+48                                                01335000
CVTRV331 EQU   CVTS01+44                                                01336000
CVTRV330 EQU   CVTS01+40                                                01337000
CVTRV329 EQU   CVTS01+36                                                01338000
CVTRV328 EQU   CVTS01+32                                                01339000
CVTRV322 EQU   CVTS01+28                                                01340000
CVTSLID  EQU   CVTSLIDA+1                                               01341000
CVTSYLK  EQU   CVTSLIDA                                                 01342000
CVTRV321 EQU   CVTS01+20                                                01343000
CVTRV320 EQU   CVTS01+16                                                01344000
CVTLPDIR EQU   CVTLPDIA+1                                               01345000
CVTRSV69 EQU   CVTDIRST                                                 01346000
CVTRSV68 EQU   CVTDIRST                                                 01347000
CVTRSV67 EQU   CVTDIRST                                                 01348000
CVTRSV66 EQU   CVTDIRST                                                 01349000
CVTRSV65 EQU   CVTDIRST                                                 01350000
CVTRSV64 EQU   CVTDIRST                                                 01351000
CVTRSV63 EQU   CVTDIRST                                                 01352000
CVTDICOM EQU   CVTDIRST                                                 01353000
CVTPVTP  EQU   CVTS01+8                                                 01354000
CVTLPDSR EQU   CVTS01+4                                                 01355000
CVTGETL  EQU   CVTS01                                                   01356000
SAVTYPE  EQU   SAVMASKE+4                                               01357000
SAVNOBIT EQU   SAVMASKE                                                 01358000
DEVNOBIT EQU   DEVMASKE                                                 01359000
@NM00011 EQU   DEVMASKT+2                                               01360000
UCBERADR EQU   UCBUCS+12                                                01361000
UCBFCBID EQU   UCBUCS+8                                                 01362000
UCBERCNT EQU   UCBUCS+7                                                 01363000
UCBRSV51 EQU   UCBUCS+6                                                 01364000
UCBRSV50 EQU   UCBFCBOP                                                 01365000
UCBRSV49 EQU   UCBFCBOP                                                 01366000
UCBRSV48 EQU   UCBFCBOP                                                 01367000
UCBRSV47 EQU   UCBFCBOP                                                 01368000
UCBRSV46 EQU   UCBFCBOP                                                 01369000
UCBRSV45 EQU   UCBFCBOP                                                 01370000
UCBRSV44 EQU   UCBFCBOP                                                 01371000
UCBFCBO1 EQU   UCBFCBOP                                                 01372000
UCBUCSPE EQU   UCBUCSOP                                                 01373000
UCBRSV43 EQU   UCBUCSOP                                                 01374000
UCBRSV42 EQU   UCBUCSOP                                                 01375000
UCBRSV41 EQU   UCBUCSOP                                                 01376000
UCBRSV40 EQU   UCBUCSOP                                                 01377000
UCBRSV39 EQU   UCBUCSOP                                                 01378000
UCBUCSO2 EQU   UCBUCSOP                                                 01379000
UCBUCSO1 EQU   UCBUCSOP                                                 01380000
UCBUCSID EQU   UCBUCS                                                   01381000
UCBMDRBA EQU   UCBMDRBF+1                                               01382000
UCBRV075 EQU   UCBMDRBF                                                 01383000
UCBRV074 EQU   UCB3800X+32                                              01384000
UCBIMAGE EQU   UCB3800X+28                                              01385000
UCBFCBNM EQU   UCB3800X+24                                              01386000
UCBCHAR4 EQU   UCB3800X+20                                              01387000
UCBCHAR3 EQU   UCB3800X+16                                              01388000
UCBCHAR2 EQU   UCB3800X+12                                              01389000
UCBCHAR1 EQU   UCB3800X+8                                               01390000
UCBCGMID EQU   UCB3800X+4                                               01391000
UCBBRSTA EQU   UCBACTIV                                                 01392000
UCBRV063 EQU   UCBACTIV                                                 01393000
UCBRV062 EQU   UCBACTIV                                                 01394000
UCBRV061 EQU   UCBACTIV                                                 01395000
UCBRV060 EQU   UCBACTIV                                                 01396000
UCBRV059 EQU   UCBACTIV                                                 01397000
UCBRV058 EQU   UCBACTIV                                                 01398000
UCBRV057 EQU   UCBACTIV                                                 01399000
UCBRV050 EQU   UCB3800X+2                                               01400000
UCBCGMNO EQU   UCB3800X+1                                               01401000
UCBRV083 EQU   UCBOPTNS                                                 01402000
UCBBRSTR EQU   UCBOPTNS                                                 01403000
UCBRV056 EQU   UCBOPTNS                                                 01404000
UCBRV055 EQU   UCBOPTNS                                                 01405000
UCBRV054 EQU   UCBOPTNS                                                 01406000
UCBRV053 EQU   UCBOPTNS                                                 01407000
UCBRV052 EQU   UCBOPTNS                                                 01408000
UCBRV051 EQU   UCBOPTNS                                                 01409000
UCBRV073 EQU   UCB3540X+7                                               01410000
UCBRV072 EQU   UCBDKBYT                                                 01411000
UCBRV071 EQU   UCBDKBYT                                                 01412000
UCBRV070 EQU   UCBDKBYT                                                 01413000
UCBRV069 EQU   UCBDKBYT                                                 01414000
UCBRV068 EQU   UCBDKBYT                                                 01415000
UCBRV067 EQU   UCBDKBYT                                                 01416000
UCBVLVER EQU   UCBDKBYT                                                 01417000
UCBDKAMX EQU   UCBDKBYT                                                 01418000
UCBVLSER EQU   UCB3540X                                                 01419000
UCBRDATA EQU   UCBOCR+4                                                 01420000
UCBFRID  EQU   UCBOCR                                                   01421000
UCBCLN   EQU   UCBMT+14                                                 01422000
UCBERG   EQU   UCBMT+12                                                 01423000
UCBMS    EQU   UCBMT+11                                                 01424000
UCBNB    EQU   UCBMT+10                                                 01425000
UCBPW    EQU   UCBMT+9                                                  01426000
UCBPR    EQU   UCBMT+8                                                  01427000
UCBSIO   EQU   UCBMT+6                                                  01428000
UCBTW    EQU   UCBMT+5                                                  01429000
UCBTR    EQU   UCBMT+4                                                  01430000
UCBTWT   EQU   UCBMT+3                                                  01431000
UCBTRT   EQU   UCBMT+2                                                  01432000
UCBCTD   EQU   UCBMT                                                    01433000
UCBWTOID EQU   UCBCMEXT+17                                              01434000
UCBMIHTI EQU   UCBCMEXT+16                                              01435000
UCBASID  EQU   UCBCMEXT+14                                              01436000
UCBMFCNT EQU   UCBCMEXT+12                                              01437000
UCBPMSK  EQU   UCBCMEXT+10                                              01438000
UCBCCWOF EQU   UCBCMEXT+8                                               01439000
UCBRV041 EQU   UCBCMEXT+6                                               01440000
UCBRV036 EQU   UCBFLP1                                                  01441000
UCBRV035 EQU   UCBFLP1                                                  01442000
UCBERLOG EQU   UCBFLP1                                                  01443000
UCBRV033 EQU   UCBFLP1                                                  01444000
UCBRV032 EQU   UCBFLP1                                                  01445000
UCBRV031 EQU   UCBFLP1                                                  01446000
UCBSHRUP EQU   UCBFLP1                                                  01447000
UCBNSRCH EQU   UCBFLP1                                                  01448000
UCBSNSCT EQU   UCBCMEXT+4                                               01449000
UCBHPDV  EQU   @NM00008                                                 01450000
UCBHALI  EQU   @NM00008                                                 01451000
UCBRSV09 EQU   @NM00008                                                 01452000
UCBRSV08 EQU   @NM00008                                                 01453000
UCBRSV07 EQU   @NM00008                                                 01454000
UCBRSV06 EQU   @NM00008                                                 01455000
UCBRSV05 EQU   @NM00008                                                 01456000
UCBRSV04 EQU   @NM00008                                                 01457000
UCBDTI   EQU   UCBCMEXT+2                                               01458000
UCBSTI   EQU   UCBCMEXT+1                                               01459000
UCBETI   EQU   UCBCMEXT                                                 01460000
UCBEXTP  EQU   UCBEXTPT+1                                               01461000
UCBDDRSW EQU   UCBFLC                                                   01462000
UCBTICBT EQU   UCBFLC                                                   01463000
UCBIVRR  EQU   UCBFLC                                                   01464000
UCBIVRS  EQU   UCBFLC                                                   01465000
UCBITF   EQU   UCBFLC                                                   01466000
UCBUDE   EQU   UCBFLC                                                   01467000
UCBWAA   EQU   UCBFLC                                                   01468000
UCBATTP  EQU   UCBFLC                                                   01469000
UCBUNTYP EQU   UCBTBYT4                                                 01470000
UCBRSV11 EQU   UCBDVCLS                                                 01471000
UCBRSV10 EQU   UCBDVCLS                                                 01472000
UCB3CHAR EQU   UCBDVCLS                                                 01473000
UCB3UREC EQU   UCBDVCLS                                                 01474000
UCB3DISP EQU   UCBDVCLS                                                 01475000
UCB3DACC EQU   UCBDVCLS                                                 01476000
UCB3COMM EQU   UCBDVCLS                                                 01477000
UCB3TAPE EQU   UCBDVCLS                                                 01478000
UCBDVPWR EQU   UCB2OPT7                                                 01479000
UCBVLPWR EQU   UCB2OPT6                                                 01480000
UCB2OPT5 EQU   UCBTBYT2                                                 01481000
UCBRVDEV EQU   UCBRWTAU                                                 01482000
UCBRPS   EQU   UCBDUDN2                                                 01483000
UCBRR    EQU   UCBDUDN1                                                 01484000
UCB2OPT1 EQU   UCBTBYT2                                                 01485000
UCB2OPT0 EQU   UCBTBYT2                                                 01486000
UCB1FEA7 EQU   UCBTBYT1                                                 01487000
UCBD6250 EQU   UCB1FEA6                                                 01488000
UCBD1600 EQU   UCB1FEA5                                                 01489000
UCB1FEA4 EQU   UCBTBYT1                                                 01490000
UCB1FEA3 EQU   UCBTBYT1                                                 01491000
UCB1FEA2 EQU   UCBTBYT1                                                 01492000
UCB1FEA1 EQU   UCBTBYT1                                                 01493000
UCB1FEA0 EQU   UCBTBYT1                                                 01494000
UCBNAME  EQU   UCBOB+13                                                 01495000
UCBRV029 EQU   UCBWGT                                                   01496000
UCBVHRSN EQU   UCBWGT                                                   01497000
UCBVORSN EQU   UCBWGT                                                   01498000
UCBMTPXP EQU   UCBWGT                                                   01499000
UCBREW   EQU   UCBWGT                                                   01500000
UCBPUB   EQU   UCBWGT                                                   01501000
UCBOUT   EQU   UCBWGT                                                   01502000
UCBIN    EQU   UCBWGT                                                   01503000
UCBCPU   EQU   UCBOB+11                                                 01504000
UCBLCI   EQU   UCBOB+10                                                 01505000
UCBCNT   EQU   UCBOB+9                                                  01506000
UCBRV017 EQU   UCBCHM1                                                  01507000
UCBRV016 EQU   UCBCHM1                                                  01508000
UCBRV015 EQU   UCBCHM1                                                  01509000
UCBRV014 EQU   UCBCHM1                                                  01510000
UCBSPB   EQU   UCBPTH1                                                  01511000
UCBPPB   EQU   UCBPTH1                                                  01512000
UCBSPA   EQU   UCBPTH0                                                  01513000
UCBPPA   EQU   UCBPTH0                                                  01514000
UCBSIGP  EQU   UCBFLB                                                   01515000
UCBVALPH EQU   UCBFLB                                                   01516000
UCBCRHSN EQU   UCBFLB                                                   01517000
UCBCRHRV EQU   UCBFLB                                                   01518000
UCBRESVH EQU   UCBFLB                                                   01519000
UCBSPST  EQU   UCBFLB                                                   01520000
UCBASNS  EQU   UCBFLB                                                   01521000
UCBIORST EQU   UCBFLB                                                   01522000
UCBQISCE EQU   UCBFL1                                                   01523000
UCBACTV  EQU   UCBFL1                                                   01524000
UCBSAP   EQU   UCBFL1                                                   01525000
UCBNOTRC EQU   UCBCUB                                                   01526000
UCBPSNS  EQU   UCBFL1                                                   01527000
UCBUSING EQU   UCBPST                                                   01528000
UCBNOTRD EQU   UCBNRY                                                   01529000
UCBBUSYD EQU   UCBBSY                                                   01530000
UCBUA    EQU   UCBCHAN+1                                                01531000
UCBCHA   EQU   UCBCHAN                                                  01532000
UCBDADI  EQU   UCBSTAT                                                  01533000
UCBSYSR  EQU   UCBSTAT                                                  01534000
UCBPRES  EQU   UCBSTAT                                                  01535000
UCBALOC  EQU   UCBSTAT                                                  01536000
UCBUNLD  EQU   UCBSTAT                                                  01537000
UCBRESV  EQU   UCBSTAT                                                  01538000
UCBCHGS  EQU   UCBSTAT                                                  01539000
UCBONLI  EQU   UCBSTAT                                                  01540000
UCBID    EQU   UCBOB+2                                                  01541000
UCBALTPH EQU   UCBFL5                                                   01542000
UCBALTCU EQU   UCBFL5                                                   01543000
UCBNALOC EQU   UCBFL5                                                   01544000
UCBENVRD EQU   UCBFL5                                                   01545000
UCBVSDR  EQU   UCBFL5                                                   01546000
UCBSASK  EQU   UCBFL5                                                   01547000
UCBAMV   EQU   UCBAF                                                    01548000
UCBDCC   EQU   UCBFL5                                                   01549000
UCBMONT  EQU   UCBJBNR                                                  01550000
UCBRV011 EQU   UCBJBNR                                                  01551000
UCBRSV02 EQU   UCBJBNR                                                  01552000
UCBOLDSM EQU   UCBJBNR                                                  01553000
UCBRV003 EQU   UCBJBNR                                                  01554000
UCBDUC   EQU   UCBJBNR                                                  01555000
UCBJES3  EQU   UCBJBNR                                                  01556000
UCBVRDEV EQU   UCBJBNR                                                  01557000
UCBCMSEG EQU   UCBOB                                                    01558000
UCBPFXND EQU   UCB+512                                                  01559000
UCBIOQ   EQU   UCB+508                                                  01560000
UCBLOCK  EQU   UCB+504                                                  01561000
UCBPXST  EQU   UCB+504                                                  01562000
@NM00005 EQU   UCB                                                      01563000
CVTLEVL  EQU   CVTRELNO+2                                               01564000
CVTNUMB  EQU   CVTRELNO                                                 01565000
CVTMDL   EQU   CVTFIX+250                                               01566000
@NM00004 EQU   CVTFIX+248                                               01567000
@NM00003 EQU   CVTFIX                                                   01568000
CVTRV482 EQU   CVTXTNT2+128                                             01569000
CVTRV481 EQU   CVTXTNT2+124                                             01570000
CVTRV480 EQU   CVTXTNT2+120                                             01571000
CVTRV479 EQU   CVTXTNT2+118                                             01572000
CVTRV478 EQU   CVTXTNT2+117                                             01573000
CVTRV477 EQU   CVTXTNT2+116                                             01574000
CVTRV476 EQU   CVTXTNT2+115                                             01575000
CVTRV475 EQU   CVTXTNT2+114                                             01576000
CVTRV474 EQU   CVTRV466                                                 01577000
CVTRV473 EQU   CVTRV466                                                 01578000
CVTRV472 EQU   CVTRV466                                                 01579000
CVTRV471 EQU   CVTRV466                                                 01580000
CVTRV470 EQU   CVTRV466                                                 01581000
CVTRV469 EQU   CVTRV466                                                 01582000
CVTRV468 EQU   CVTRV466                                                 01583000
CVTRV467 EQU   CVTRV466                                                 01584000
CVTRV465 EQU   CVTRV457                                                 01585000
CVTRV464 EQU   CVTRV457                                                 01586000
CVTRV463 EQU   CVTRV457                                                 01587000
CVTRV462 EQU   CVTRV457                                                 01588000
CVTRV461 EQU   CVTRV457                                                 01589000
CVTRV460 EQU   CVTRV457                                                 01590000
CVTRV459 EQU   CVTRV457                                                 01591000
CVTRV458 EQU   CVTRV457                                                 01592000
CVTRV456 EQU   CVTXTNT2+108                                             01593000
CVTRV455 EQU   CVTXTNT2+104                                             01594000
CVTRV454 EQU   CVTXTNT2+100                                             01595000
CVTRV453 EQU   CVTXTNT2+96                                              01596000
CVTRV452 EQU   CVTXTNT2+94                                              01597000
CVTRV451 EQU   CVTXTNT2+92                                              01598000
CVTRV450 EQU   CVTXTNT2+90                                              01599000
CVTRV449 EQU   CVTXTNT2+88                                              01600000
CVTRV448 EQU   CVTXTNT2+87                                              01601000
CVTRV447 EQU   CVTXTNT2+86                                              01602000
CVTRV446 EQU   CVTRV438                                                 01603000
CVTRV445 EQU   CVTRV438                                                 01604000
CVTRV444 EQU   CVTRV438                                                 01605000
CVTRV443 EQU   CVTRV438                                                 01606000
CVTRV442 EQU   CVTRV438                                                 01607000
CVTRV441 EQU   CVTRV438                                                 01608000
CVTRV440 EQU   CVTRV438                                                 01609000
CVTRV439 EQU   CVTRV438                                                 01610000
CVTRV437 EQU   CVTRV429                                                 01611000
CVTRV436 EQU   CVTRV429                                                 01612000
CVTRV435 EQU   CVTRV429                                                 01613000
CVTRV434 EQU   CVTRV429                                                 01614000
CVTRV433 EQU   CVTRV429                                                 01615000
CVTRV432 EQU   CVTRV429                                                 01616000
CVTRV431 EQU   CVTRV429                                                 01617000
CVTRV430 EQU   CVTRV429                                                 01618000
CVTRV428 EQU   CVTXTNT2+80                                              01619000
CVTRV427 EQU   CVTXTNT2+76                                              01620000
CVTRV426 EQU   CVTXTNT2+72                                              01621000
CVTRV425 EQU   CVTXTNT2+68                                              01622000
CVTATACT EQU   CVTATCVT                                                 01623000
CVTRV423 EQU   CVTXTNT2+62                                              01624000
CVTRV422 EQU   CVTXTNT2+60                                              01625000
CVTRV421 EQU   CVTXTNT2+58                                              01626000
CVTRV420 EQU   CVTXTNT2+56                                              01627000
CVTRV419 EQU   CVTXTNT2+55                                              01628000
CVTRV418 EQU   CVTXTNT2+54                                              01629000
CVTRV417 EQU   CVTRV409                                                 01630000
CVTRV416 EQU   CVTRV409                                                 01631000
CVTRV415 EQU   CVTRV409                                                 01632000
CVTRV414 EQU   CVTRV409                                                 01633000
CVTRV413 EQU   CVTRV409                                                 01634000
CVTRV412 EQU   CVTRV409                                                 01635000
CVTRV411 EQU   CVTRV409                                                 01636000
CVTRV410 EQU   CVTRV409                                                 01637000
CVTRV408 EQU   CVTRV400                                                 01638000
CVTRV407 EQU   CVTRV400                                                 01639000
CVTRV406 EQU   CVTRV400                                                 01640000
CVTRV405 EQU   CVTRV400                                                 01641000
CVTRV404 EQU   CVTRV400                                                 01642000
CVTRV403 EQU   CVTRV400                                                 01643000
CVTRV402 EQU   CVTRV400                                                 01644000
CVTRV401 EQU   CVTRV400                                                 01645000
CVTICB   EQU   CVTXTNT2+48                                              01646000
CVTSKTA  EQU   CVTXTNT2+44                                              01647000
CVTRSV99 EQU   CVTXTNT2+40                                              01648000
CVTRSV98 EQU   CVTXTNT2+36                                              01649000
CVTRSV97 EQU   CVTXTNT2+34                                              01650000
CVTRSV96 EQU   CVTXTNT2+32                                              01651000
CVTOLTEP EQU   CVTXTNT2+28                                              01652000
CVTQIDA  EQU   CVTQID+1                                                 01653000
CVTRSV95 EQU   CVTQID                                                   01654000
CVTRSV94 EQU   CVTXTNT2+20                                              01655000
CVTRSV93 EQU   CVTXTNT2+16                                              01656000
CVTRSV92 EQU   CVTXTNT2+12                                              01657000
CVTDEBVR EQU   CVTXTNT2+8                                               01658000
CVTRSV91 EQU   CVTXTNT2+6                                               01659000
CVTRSV9H EQU   CVTFLGBT                                                 01660000
CVTRSV9G EQU   CVTFLGBT                                                 01661000
CVTRSV9F EQU   CVTFLGBT                                                 01662000
CVTRSV9E EQU   CVTFLGBT                                                 01663000
CVTRSV9D EQU   CVTFLGBT                                                 01664000
CVTRSV9C EQU   CVTFLGBT                                                 01665000
CVTVME   EQU   CVTFLGBT                                                 01666000
CVTNPE   EQU   CVTFLGBT                                                 01667000
CVTNUCLS EQU   CVTXTNT2+4                                               01668000
CVTDSSVA EQU   CVTDSSV+1                                                01669000
CVTRSV89 EQU   CVTDSSV                                                  01670000
CVTRSV88 EQU   CVTXTNT1+8                                               01671000
CVTRSV87 EQU   CVTXTNT1+4                                               01672000
CVTFACHN EQU   CVTXTNT1                                                 01673000
CVTRV488 EQU   CVTMAP+412                                               01674000
CVTRV487 EQU   CVTMAP+408                                               01675000
CVTRV486 EQU   CVTMAP+404                                               01676000
CVTRV485 EQU   CVTMAP+400                                               01677000
CVTACTAP EQU   CVTMAP+396                                               01678000
CVTAUTH  EQU   CVTMAP+392                                               01679000
CVTATMCA EQU   CVTATMCT+1                                               01680000
CVTATMST EQU   CVTATMCT                                                 01681000
CVTRSV61 EQU   CVTMAP+384                                               01682000
CVTVOLT1 EQU   CVTVOLM1+1                                               01683000
CVTVOLI1 EQU   CVTVOLF1                                                 01684000
CVTSTOA  EQU   CVTMAP+376                                               01685000
CVTRSV58 EQU   CVTMAP+374                                               01686000
CVTRSV57 EQU   CVTMAP+372                                               01687000
CVTDDCE  EQU   CVTMAP+368                                               01688000
CVTPNWFR EQU   CVTMAP+364                                               01689000
CVTSMF   EQU   CVTMAP+360                                               01690000
CVTSULK  EQU   CVTMAP+358                                               01691000
CVTSLKO  EQU   CVTSYSK                                                  01692000
CVTSLKP  EQU   CVTSYSK                                                  01693000
CVTSLKQ  EQU   CVTSYSK                                                  01694000
CVTSLKR  EQU   CVTSYSK                                                  01695000
CVTRSV56 EQU   CVTSYSK                                                  01696000
CVTRSV55 EQU   CVTSYSK                                                  01697000
CVTRSV54 EQU   CVTSYSK                                                  01698000
CVTRSV53 EQU   CVTSYSK                                                  01699000
CVTRSV52 EQU   CVTA1F1                                                  01700000
CVTRSV51 EQU   CVTA1F1                                                  01701000
CVTRSV50 EQU   CVTA1F1                                                  01702000
CVTRSV49 EQU   CVTA1F1                                                  01703000
CVTRSV48 EQU   CVTA1F1                                                  01704000
CVTRSV47 EQU   CVTA1F1                                                  01705000
CVTSRSW  EQU   CVTA1F1                                                  01706000
CVTPFSW  EQU   CVTA1F1                                                  01707000
CVTPCVT  EQU   CVTMAP+352                                               01708000
CVTRSV46 EQU   CVTMAP+344                                               01709000
CVTRSV45 EQU   CVTMAP+340                                               01710000
CVTRSV44 EQU   CVTMAP+338                                               01711000
CVTRSV43 EQU   CVTMAP+336                                               01712000
CVTHJESA EQU   CVTHJES+1                                                01713000
CVTRSV42 EQU   CVTHJES                                                  01714000
CVTEXT2A EQU   CVTEXT2+1                                                01715000
CVTRSV41 EQU   CVTEXT2                                                  01716000
CVTAPFA  EQU   CVTAPF+1                                                 01717000
CVTRSV40 EQU   CVTAPF                                                   01718000
CVTRV518 EQU   CVTINTLA                                                 01719000
CVTRV517 EQU   CVTERPV                                                  01720000
CVTEORM  EQU   CVTMAP+312                                               01721000
CVTMCHPR EQU   CVTMAP+308                                               01722000
CVTTZ    EQU   CVTMAP+304                                               01723000
CVTJEPS  EQU   CVTMAP+300                                               01724000
CVTJESCT EQU   CVTMAP+296                                               01725000
CVTMODE  EQU   CVTMAP+292                                               01726000
CVTPTRV  EQU   CVTMAP+288                                               01727000
CVTREAL  EQU   CVTMAP+284                                               01728000
CVTRSV39 EQU   CVTMAP+280                                               01729000
CVTRSV38 EQU   CVTMAP+276                                               01730000
CVTDMSRA EQU   CVTDMSR+1                                                01731000
CVTRV634 EQU   CVTDMSRF                                                 01732000
CVTRV633 EQU   CVTDMSRF                                                 01733000
CVTRV632 EQU   CVTDMSRF                                                 01734000
CVTRV631 EQU   CVTDMSRF                                                 01735000
CVTRV630 EQU   CVTDMSRF                                                 01736000
CVTRV629 EQU   CVTDMSRF                                                 01737000
CVTUDUMP EQU   CVTDMSRF                                                 01738000
CVTSDUMP EQU   CVTDMSRF                                                 01739000
CVTQMSGA EQU   CVTQMSG+1                                                01740000
CVTRSV36 EQU   CVTQMSG                                                  01741000
CVTAMFF  EQU   CVTMAP+264                                               01742000
CVTPURGA EQU   CVTPURG+1                                                01743000
CVTRSV35 EQU   CVTPURG                                                  01744000
CVTCBSP  EQU   CVTMAP+256                                               01745000
CVTATERA EQU   CVTATER+1                                                01746000
CVTSYST  EQU   CVTATER                                                  01747000
CVTVOLT2 EQU   CVTTAT                                                   01748000
CVTVOLI2 EQU   CVTVOLF2                                                 01749000
CVTAQAVB EQU   CVTAQAVT+1                                               01750000
CVTRSV34 EQU   CVTTCMFG                                                 01751000
CVTRSV33 EQU   CVTTCMFG                                                 01752000
CVTRSV32 EQU   CVTTCMFG                                                 01753000
CVTRSV31 EQU   CVTTCMFG                                                 01754000
CVTRSV30 EQU   CVTTCMFG                                                 01755000
CVTRSV29 EQU   CVTTCMFG                                                 01756000
CVTRSV28 EQU   CVTTCMFG                                                 01757000
CVTTCRDY EQU   CVTTCMFG                                                 01758000
CVTGTFA  EQU   CVTGTF+1                                                 01759000
CVTRSV27 EQU   CVTGTFST                                                 01760000
CVTRNIO  EQU   CVTGTFST                                                 01761000
CVTUSR   EQU   CVTGTFST                                                 01762000
CVTRV318 EQU   CVTFORM                                                  01763000
CVTRV317 EQU   CVTTMODE                                                 01764000
CVTRV316 EQU   CVTSTATE                                                 01765000
CVTRV315 EQU   CVTGTFS                                                  01766000
CVTGTFAV EQU   CVTGTFS                                                  01767000
CVT0SCR1 EQU   CVTMAP+232                                               01768000
CVTRV515 EQU   CVTMAP+228                                               01769000
CVTRMS   EQU   CVTMAP+224                                               01770000
CVTPATCH EQU   CVTMAP+220                                               01771000
CVTTSCE  EQU   CVTMAP+216                                               01772000
CVTLNKSC EQU   CVTMAP+214                                               01773000
CVTQABST EQU   CVTMAP+212                                               01774000
CVTMDLDS EQU   CVTMAP+208                                               01775000
CVTUSER  EQU   CVTMAP+204                                               01776000
CVTABEND EQU   CVTMAP+200                                               01777000
CVTSMCA  EQU   CVTMAP+196                                               01778000
CVTRSV18 EQU   CVTMAP+192                                               01779000
CVTQLPAQ EQU   CVTMAP+188                                               01780000
CVTQCDSR EQU   CVTMAP+184                                               01781000
CVTRSV17 EQU   CVTOPTB                                                  01782000
CVTRSV16 EQU   CVTOPTB                                                  01783000
CVTFP    EQU   CVTOPTB                                                  01784000
CVTAPTHR EQU   CVTOPTB                                                  01785000
CVTNLOG  EQU   CVTOPTB                                                  01786000
CVTTOD   EQU   CVTOPTB                                                  01787000
CVTCTIMS EQU   CVTOPTB                                                  01788000
CVTPROT  EQU   CVTOPTB                                                  01789000
CVTXPFP  EQU   CVTOPTA                                                  01790000
CVTASCII EQU   CVTOPTA                                                  01791000
CVTRSV13 EQU   CVTOPTA                                                  01792000
CVTRSV12 EQU   CVTOPTA                                                  01793000
CVTNIP   EQU   CVTOPTA                                                  01794000
CVTDDR   EQU   CVTOPTA                                                  01795000
CVTAPR   EQU   CVTOPTA                                                  01796000
CVTCCH   EQU   CVTOPTA                                                  01797000
CVTSNCTR EQU   CVTMAP+180                                               01798000
CVTQMWR  EQU   CVTMAP+176                                               01799000
CVTQOCR  EQU   CVTMAP+172                                               01800000
CVT1EF00 EQU   CVTMAP+168                                               01801000
CVTMZ00  EQU   CVTMAP+164                                               01802000
CVTHEAD  EQU   CVTMAP+160                                               01803000
CVTRSV11 EQU   CVTMAP+156                                               01804000
CVT0PT01 EQU   CVTMAP+152                                               01805000
CVTMSER  EQU   CVTMAP+148                                               01806000
CVTRV516 EQU   CVTIERLC                                                 01807000
CVTILCH  EQU   CVTMAP+140                                               01808000
CVT0DS   EQU   CVTMAP+136                                               01809000
CVTFBOSV EQU   CVTMAP+132                                               01810000
CVTNUCB  EQU   CVTMAP+128                                               01811000
CVTIXAVL EQU   CVTMAP+124                                               01812000
CVTIOQET EQU   CVTMAP+120                                               01813000
CVTDCBA  EQU   CVTMAP+117                                               01814000
CVTMVS2  EQU   CVTDCB                                                   01815000
CVT6DAT  EQU   CVTDCB                                                   01816000
CVT4MPS  EQU   CVTDCB                                                   01817000
CVTRSV09 EQU   CVTDCB                                                   01818000
CVT4MS1  EQU   CVTDCB                                                   01819000
CVT2SPS  EQU   CVTDCB                                                   01820000
CVT1SSS  EQU   CVTDCB                                                   01821000
CVTRSV08 EQU   CVTDCB                                                   01822000
CVTSTB   EQU   CVTMAP+112                                               01823000
CVTQTD00 EQU   CVTMAP+108                                               01824000
CVTQTE00 EQU   CVTMAP+104                                               01825000
CVTCUCB  EQU   CVTMAP+100                                               01826000
CVTSJQ   EQU   CVTMAP+96                                                01827000
CVTPBLDL EQU   CVTMAP+92                                                01828000
CVTTPC   EQU   CVTMAP+88                                                01829000
CVTSVDCB EQU   CVTMAP+84                                                01830000
CVTBRET  EQU   CVTMAP+82                                                01831000
CVTEXIT  EQU   CVTMAP+80                                                01832000
CVT0FN00 EQU   CVTMAP+76                                                01833000
CVTDARA  EQU   CVTDAR+1                                                 01834000
CVTRSV07 EQU   CVTFLGS1                                                 01835000
CVTRSV06 EQU   CVTFLGS1                                                 01836000
CVTRSV05 EQU   CVTFLGS1                                                 01837000
CVTRSV04 EQU   CVTFLGS1                                                 01838000
CVTRSV03 EQU   CVTFLGS1                                                 01839000
CVTRSV02 EQU   CVTFLGS1                                                 01840000
CVTRSV01 EQU   CVTFLGS1                                                 01841000
CVTDMPLK EQU   CVTFLGS1                                                 01842000
CVTXITP  EQU   CVTMAP+68                                                01843000
CVTZDTAB EQU   CVTMAP+64                                                01844000
CVTMSLT  EQU   CVTMAP+60                                                01845000
CVTDATE  EQU   CVTMAP+56                                                01846000
CVTBTERM EQU   CVTMAP+52                                                01847000
CVTSYSAD EQU   CVTMAP+48                                                01848000
CVTXTLER EQU   CVTMAP+44                                                01849000
CVTILK1  EQU   CVTMAP+36                                                01850000
CVTPRLTV EQU   CVTMAP+32                                                01851000
CVTPCNVT EQU   CVTMAP+28                                                01852000
CVT0VL00 EQU   CVTMAP+24                                                01853000
CVTXAPG  EQU   CVTMAP+20                                                01854000
CVTBUF   EQU   CVTMAP+16                                                01855000
CVTJOB   EQU   CVTMAP+12                                                01856000
CVTLINK  EQU   CVTMAP+8                                                 01857000
CVT0EF00 EQU   CVTMAP+4                                                 01858000
CVTTCBP  EQU   CVTMAP                                                   01859000
CVT      EQU   CVTMAP                                                   01860000
VVIUNUSD EQU   VVICB+116                                                01861000
VVINUSDC EQU   VVICB+112                                                01862000
VVITPFCH EQU   VVICB+108                                                01863000
VVIVBSTF EQU   VVICB+100                                                01864000
VVISSOBA EQU   VVICB+96                                                 01865000
VVIVSCRA EQU   VVICB+92                                                 01866000
VVISTPTB EQU   VVICB+88                                                 01867000
VVIJUCB  EQU   VVICB+80                                                 01868000
VVIIUCB  EQU   VVICB+76                                                 01869000
VVIRES6  EQU   VVICB+72                                                 01870000
VVIRES5  EQU   VVICB+68                                                 01871000
VVIRES4  EQU   VVICB+64                                                 01872000
VVIVJL   EQU   VVICB+56                                                 01873000
VVIVRR   EQU   VVICB+52                                                 01874000
VVIQLSPL EQU   VVICB+48                                                 01875000
VVIQRPL2 EQU   VVICB+44                                                 01876000
VVIQRPL1 EQU   VVICB+40                                                 01877000
VVIRES3  EQU   VVICB+36                                                 01878000
VVIVQMP  EQU   VVICB+32                                                 01879000
VVIECB1  EQU   VVICB+28                                                 01880000
VVICATAD EQU   VVICB+24                                                 01881000
VVIDCBAD EQU   VVICB+20                                                 01882000
VVIACBAD EQU   VVICB+16                                                 01883000
VVIFLG7  EQU   VVIFLGA                                                  01884000
VVIFLG6  EQU   VVIFLGA                                                  01885000
VVIFLG5  EQU   VVIFLGA                                                  01886000
VVIFLG4  EQU   VVIFLGA                                                  01887000
VVIFLG3  EQU   VVIFLGA                                                  01888000
VVIFLG2  EQU   VVIFLGA                                                  01889000
VVIFLG1  EQU   VVIFLGA                                                  01890000
VVIFLG0  EQU   VVIFLGA                                                  01891000
VVIALCON EQU   VVICB+14                                                 01892000
VVICPUID EQU   VVICB+12                                                 01893000
VVIUCAT  EQU   VVICB+4                                                  01894000
VVICID   EQU   VVICB                                                    01895000
@NM00002 EQU   UNIFLAGS                                                 01896000
@NM00001 EQU   UNITP+10                                                 01897000
*                                      END UNREFERENCED COMPONENTS      01898000
@RC00114 EQU   @EL00003                                                 01899000
@RF00128 EQU   @EL00004                                                 01900000
@RF00142 EQU   @EL00005                                                 01901000
@RC00158 EQU   @EL00006                                                 01902000
BITON    EQU   @EL00006                                                 01903000
@RC00118 EQU   @RC00114                                                 01904000
@ENDDATA EQU   *                                                        01905000
         END   ICBVUP00,(C'PLS1821',0603,76279)                         01906000
./  ADD  SSI=62790224,NAME=ICBVUP01
UP01     TITLE '**********  ICBVUP01:  MSVC UNIT PROCESSOR MODULE  *****00001000
               *******  '                                               00002000
ICBVUP01 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVUP01  76.279'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(8),0(@01)                                  0001 00022000
*   VVIPTR=ADDR(VVICBLK);           /*                       @G24LB37*/ 00023000
         L     VVIPTR,@PC00001+4                                   0069 00024000
*   UNITPTR=ADDR(UNITRPL);          /*                       @G24LB37*/ 00025000
         L     UNITPTR,@PC00001                                    0070 00026000
*   RETCODE=FOUR;                   /*                       @G24LB37*/ 00027000
*                                                                  0071 00028000
         LA    RETCODE,4                                           0071 00029000
*   /*****************************************************************/ 00030000
*   /*                                                               */ 00031000
*   /* IF, IN THE UNITP, THE UNIFMTD FLAG IS ON, REQUESTING  @G24LB37*/ 00032000
*   /* THE UNIT PROCESSOR TO DETERMINE IF THE GIVEN VOLUME   @G24LB37*/ 00033000
*   /* SERIAL IS MOUNTED ON A 3330V UNIT, WITHIN THE SYSTEM, @G24LB37*/ 00034000
*   /* CALL SCANUCBS.                                        @G24LB37*/ 00035000
*   /*                                                               */ 00036000
*   /*****************************************************************/ 00037000
*                                                                  0072 00038000
*   IF UNIFMTD=ON THEN                                             0072 00039000
         TM    UNIFMTD(UNITPTR),B'10000000'                        0072 00040000
         BNO   @RF00072                                            0072 00041000
*     CALL SCANUCBS;                /*                       @G24LB37*/ 00042000
*                                                                  0073 00043000
         BAL   @14,SCANUCBS                                        0073 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* IF THE UNIFINCL FLAG IS ON, THEN CALL UNITINCL TO     @G24LB37*/ 00047000
*   /* DETERMINE IF THE SPECIFIED UCB ADDRESS IS INCLUDED    @G24LB37*/ 00048000
*   /* OR NOT INCLUDED WITHIN THE SPECIFIED DEVICE TYPE.     @G24LB37*/ 00049000
*   /*                                                               */ 00050000
*   /*****************************************************************/ 00051000
*                                                                  0074 00052000
*   ELSE                                                           0074 00053000
*     IF UNIFINCL=ON THEN                                          0074 00054000
         B     @RC00072                                            0074 00055000
@RF00072 TM    UNIFINCL(UNITPTR),B'01000000'                       0074 00056000
         BNO   @RF00074                                            0074 00057000
*       CALL UNITINCL;              /*                       @G24LB37*/ 00058000
*                                                                  0075 00059000
         BAL   @14,UNITINCL                                        0075 00060000
*   /*****************************************************************/ 00061000
*   /*                                                               */ 00062000
*   /* IF THE UNIFALLV FLAG IS ON, THEN CALL ALLVIRT TO      @G24LB37*/ 00063000
*   /* DETERMINE IF THE SPECIFIED DEVICE TYPE IS ALL 3330V   @G24LB37*/ 00064000
*   /* UNITS.                                                @G24LB37*/ 00065000
*   /*                                                               */ 00066000
*   /*****************************************************************/ 00067000
*                                                                  0076 00068000
*     ELSE                                                         0076 00069000
*       IF UNIFALLV=ON THEN                                        0076 00070000
         B     @RC00074                                            0076 00071000
@RF00074 TM    UNIFALLV(UNITPTR),B'00100000'                       0076 00072000
         BNO   @RF00076                                            0076 00073000
*         CALL ALLVIRT;             /*                       @G24LB37*/ 00074000
         BAL   @14,ALLVIRT                                         0077 00075000
*                                                                  0078 00076000
*   /*****************************************************************/ 00077000
*   /*                                                               */ 00078000
*   /* RETURN TO CALLER. RETURN CODE IS RETURNED IN REG 15.  @G24LB37*/ 00079000
*   /*                                                               */ 00080000
*   /*****************************************************************/ 00081000
*                                                                  0078 00082000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER      @G24LB37*/ 00083000
@RF00076 DS    0H                                                  0078 00084000
@RC00074 DS    0H                                                  0078 00085000
@RC00072 L     @13,4(,@13)                                         0078 00086000
         L     @00,@SIZDATD                                        0078 00087000
         LR    @01,@11                                             0078 00088000
         FREEMAIN R,LV=(0),A=(1)                                        00089000
         LR    @15,@05                                             0078 00090000
         L     @14,12(,@13)                                        0078 00091000
         LM    @00,@12,20(@13)                                     0078 00092000
         BR    @14                                                 0078 00093000
*                                                                  0079 00094000
*/********************************************************************/ 00095000
*/*                                                                  */ 00096000
*/*     PROCEDURE NAME - SCANUCBS                            @G24LB37*/ 00097000
*/*                                                          @G24LB37*/ 00098000
*/*     FUNCTION - THIS PROCEDURE SCANS THE 3330V UCB TABLE  @G24LB37*/ 00099000
*/*                BUILT BY MSVC FOR THE UCB THAT CONTAINS   @G24LB37*/ 00100000
*/*                THE VOLUME SERIAL IN THE UCBVOLI FIELD    @G24LB37*/ 00101000
*/*                WHICH MATCHES THE ONE PASSED BY THE       @G24LB37*/ 00102000
*/*                CALLER.                                   @G24LB37*/ 00103000
*/*                                                          @G24LB37*/ 00104000
*/*     INPUT - THE VOLUME SERIAL TO SEARCH FOR IN THE UCBS. @G24LB37*/ 00105000
*/*             THE POINTER TO THE MSVC UCB LOOK UP TABLE    @G24LB37*/ 00106000
*/*             IN THE VVICB.                                @G24LB37*/ 00107000
*/*                                                          @G24LB37*/ 00108000
*/*     OUTPUT -   THE ADDRESS OF THE UCB THAT THE VOLUME    @G24LB37*/ 00109000
*/*                WAS FOUND MOUNTED ON AND/OR A RETURN      @G24LB37*/ 00110000
*/*                CODE IN RETCODE AREA AS FOLLOWS:          @G24LB37*/ 00111000
*/*                0 = SUCCESSFUL                            @G24LB37*/ 00112000
*/*                4 = NOT FOUND                             @G24LB37*/ 00113000
*/*                                                                  */ 00114000
*/********************************************************************/ 00115000
*                                                                  0079 00116000
*SCANUCBS:                                                         0079 00117000
*   PROCEDURE OPTIONS(NOSAVE);      /*                       @G24LB37*/ 00118000
SCANUCBS DS    0H                                                  0080 00119000
*                                                                  0080 00120000
*   /*****************************************************************/ 00121000
*   /*                                                               */ 00122000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE MSVC   @G24LB37*/ 00123000
*   /* 3330V UCB ADDRESS TABLE USING THE VVIUCB FIELD IN THE @G24LB37*/ 00124000
*   /* VVICB CONTROL BLOCK. TURN FOUNDSW OFF.                @G24LB37*/ 00125000
*   /*                                                               */ 00126000
*   /*****************************************************************/ 00127000
*                                                                  0080 00128000
*   MSVLKPTR=VVIUCB;                /*                       @G24LB37*/ 00129000
         L     MSVLKPTR,VVIUCB(,VVIPTR)                            0080 00130000
*   FOUNDSW=OFF;                    /*                       @G24LB37*/ 00131000
*                                                                  0081 00132000
         NI    FOUNDSW,B'01111111'                                 0081 00133000
*   /*****************************************************************/ 00134000
*   /*                                                               */ 00135000
*   /* SCAN THE MSVC 3330V UCB ADDRESS TABLE, TAKE EACH UCB  @G24LB37*/ 00136000
*   /* ADDRESS AND CHECK THE UCBVOLI FIELD FOR THE MATCHING  @G24LB37*/ 00137000
*   /* VOLSER THAT WAS PASSED IN THE UNITP. ADD A PLUS FOUR  @G24LB37*/ 00138000
*   /* TO THE ADDRESS OF THE TABLE TO INCREMENT TO THE NEXT  @G24LB37*/ 00139000
*   /* UCB ADDRESS ENTRY. IF THE UCB ADDRESS IS ALL HEX      @G24LB37*/ 00140000
*   /* FOXES THEN THE END OF THE TABLE HAS BEEN REACHED.     @G24LB37*/ 00141000
*   /*                                                               */ 00142000
*   /*****************************************************************/ 00143000
*                                                                  0082 00144000
*   DO WHILE(MSVUCBP¬=UCBDELIM)&(FOUNDSW=OFF);/*             @G24LB37*/ 00145000
         B     @DE00082                                            0082 00146000
@DL00082 DS    0H                                                  0083 00147000
*     UCBPTR=MSVUCBP;               /*                       @G24LB37*/ 00148000
         L     UCBPTR,MSVUCBP(,MSVLKPTR)                           0083 00149000
*     IF UCBVOLI=UNIVOL THEN                                       0084 00150000
         CLC   UCBVOLI(6,UCBPTR),UNIVOL(UNITPTR)                   0084 00151000
         BNE   @RF00084                                            0084 00152000
*       DO;                         /*                       @G24LB37*/ 00153000
*                                                                  0085 00154000
*         /***********************************************************/ 00155000
*         /*                                                         */ 00156000
*         /* IF THE VOLSER IS FOUND TO BE MOUNTED SET THE    @G24LB37*/ 00157000
*         /* RETURN CODE TO ZERO AND INSERT THE UCB ADDRESS  @G24LB37*/ 00158000
*         /* INTO THE UNITP FIELD UNIUCBP, AND TURN ON THE   @G24LB37*/ 00159000
*         /* FOUND SWITCH. IF THE VOLSER IS NOT FOUND        @G24LB37*/ 00160000
*         /* (END OF TABLE REACHED), THEN THE RETURN CODE    @G24LB37*/ 00161000
*         /* IS ALREADY SET TO FOUR.                         @G24LB37*/ 00162000
*         /*                                                         */ 00163000
*         /***********************************************************/ 00164000
*                                                                  0086 00165000
*         FOUNDSW=ON;               /*                       @G24LB37*/ 00166000
         OI    FOUNDSW,B'10000000'                                 0086 00167000
*         UNIUCBP=UCBPTR;           /*                       @G24LB37*/ 00168000
         ST    UCBPTR,UNIUCBP(,UNITPTR)                            0087 00169000
*         RETCODE=ZERO;             /*                       @G24LB37*/ 00170000
         SLR   RETCODE,RETCODE                                     0088 00171000
*       END;                        /*                       @G24LB37*/ 00172000
*     ELSE                                                         0090 00173000
*       MSVLKPTR=MSVLKPTR+FOUR;     /*                       @G24LB37*/ 00174000
         B     @RC00084                                            0090 00175000
@RF00084 AL    MSVLKPTR,@CF00040                                   0090 00176000
*   END;                            /*                       @G24LB37*/ 00177000
*                                                                  0091 00178000
@RC00084 DS    0H                                                  0091 00179000
@DE00082 CLC   MSVUCBP(4,MSVLKPTR),UCBDELIM                        0091 00180000
         BE    @DC00082                                            0091 00181000
         TM    FOUNDSW,B'10000000'                                 0091 00182000
         BZ    @DL00082                                            0091 00183000
@DC00082 DS    0H                                                  0092 00184000
*   /*****************************************************************/ 00185000
*   /*                                                               */ 00186000
*   /* RETURN CODE IS SET IN RETCODE AREA.                   @G24LB37*/ 00187000
*   /*                                                               */ 00188000
*   /*****************************************************************/ 00189000
*                                                                  0092 00190000
*   RETURN;                         /* RET TO MAIN ROUTINE   @G24LB37*/ 00191000
@EL00002 DS    0H                                                  0092 00192000
@EF00002 DS    0H                                                  0092 00193000
@ER00002 BR    @14                                                 0092 00194000
*   END SCANUCBS;                   /* END OF SCANUCBS PROC  @G24LB37*/ 00195000
*                                                                  0094 00196000
*/********************************************************************/ 00197000
*/*                                                                  */ 00198000
*/*     PROCEDURE NAME - ALLVIRT                             @G24LB37*/ 00199000
*/*                                                          @G24LB37*/ 00200000
*/*     FUNCTION - THIS PROCEDURE DETERMINES IF THE PASSED   @G24LB37*/ 00201000
*/*                DEVICE TYPE HAS ANY UCB'S WITHIN THE      @G24LB37*/ 00202000
*/*                ESOTERIC GROUP THAT ARE NOT 3330V         @G24LB37*/ 00203000
*/*                DEVICES (I.E. MIXED ESOTERIC).            @G24LB37*/ 00204000
*/*                                                          @G24LB37*/ 00205000
*/*     INPUT - THE DEVICE TYPE TO SEARCH FOR, PASSED IN THE @G24LB37*/ 00206000
*/*             UNITP.  THE DEVICE MASK TABLE POINTED TO BY  @G24LB37*/ 00207000
*/*             THE VVICB FIELD VVIDVMTA, AND THE LENGTH OF  @G24LB37*/ 00208000
*/*             A DEVICE MASK ENTRY IN VVICB FIELD VVIDVMEL. @G24LB37*/ 00209000
*/*                                                          @G24LB37*/ 00210000
*/*     OUTPUT -   RETURN CODE IS RETURNED IN RETCODE AREA   @G24LB37*/ 00211000
*/*                AS FOLLOWS:                               @G24LB37*/ 00212000
*/*                0 = DEVICE TYPE IS ALL 3330V'S            @G24LB37*/ 00213000
*/*                4 = DEVICE TYPE HAS AT LEAST ONE NON-     @G24LB37*/ 00214000
*/*                    3330V UNIT                            @G24LB37*/ 00215000
*/*                                                                  */ 00216000
*/********************************************************************/ 00217000
*                                                                  0094 00218000
*ALLVIRT:                                                          0094 00219000
*   PROCEDURE OPTIONS(NOSAVE);      /*                       @G24LB37*/ 00220000
ALLVIRT  DS    0H                                                  0095 00221000
*                                                                  0095 00222000
*   /*****************************************************************/ 00223000
*   /*                                                               */ 00224000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE DEVICE @G24LB37*/ 00225000
*   /* MASK TABLE USING THE VVIDVMTA FIELD IN THE VVICB      @G24LB37*/ 00226000
*   /* CONTROL BLOCK. TAKE THE NUMBER OF WORDS IN VVIDVMEL,  @G24LB37*/ 00227000
*   /* ADD TWO TO THAT TOTAL FOR THE TWO EXTRA WORDS IN A    @G24LB37*/ 00228000
*   /* ENTRY AND MULTIPLY BY 4 TO GET THE NUMBER OF BYTES.   @G24LB37*/ 00229000
*   /*                                                               */ 00230000
*   /*****************************************************************/ 00231000
*                                                                  0095 00232000
*   DVMSKPTR=VVIDVMTA;              /*                       @G24LB37*/ 00233000
         L     DVMSKPTR,VVIDVMTA(,VVIPTR)                          0095 00234000
*   DVMSKMLN=VVIDVMEL*FOUR;         /*                       @G24LB37*/ 00235000
         L     @05,VVIDVMEL(,VVIPTR)                               0096 00236000
         LR    DVMSKMLN,@05                                        0096 00237000
         SLA   DVMSKMLN,2                                          0096 00238000
*   DVMSKELN=(VVIDVMEL+TWO)*FOUR;   /*                       @G24LB37*/ 00239000
         AL    @05,@CF00044                                        0097 00240000
         SLA   @05,2                                               0097 00241000
         LR    DVMSKELN,@05                                        0097 00242000
*   DVMSKELP=ADDR(DEVMSKEL);        /*                       @G24LB37*/ 00243000
         LA    DVMSKELP,DEVMSKEL(,DVMSKPTR)                        0098 00244000
*   FOUNDSW=OFF;                    /*                       @G24LB37*/ 00245000
*   EXITSW=OFF;                     /*                       @G24LB37*/ 00246000
         NI    FOUNDSW,B'00111111'                                 0100 00247000
*   SAV3330P=ZERO;                  /*                       @G24LB37*/ 00248000
*                                                                  0101 00249000
         SLR   SAV3330P,SAV3330P                                   0101 00250000
*   /*****************************************************************/ 00251000
*   /*                                                               */ 00252000
*   /* SCAN THE DEVICE MASK TABLE FOR THE 3330V DEVICE MASK  @G24LB37*/ 00253000
*   /* USING THE CONSTANT '30582009'X DEVICE TYPE. IF THE    @G24LB37*/ 00254000
*   /* DEVICE TYPE IS FOUND, SAVE THE ADDRESS. ALSO,         @G24LB37*/ 00255000
*   /* TAKE THE PASSED DEVICE TYPE AND FIND ITS CORRESPOND-  @G24LB37*/ 00256000
*   /* ING DEVICE BIT MASK, IN THE DEVICE MASK TABLE.        @G24LB37*/ 00257000
*   /*                                                               */ 00258000
*   /*****************************************************************/ 00259000
*                                                                  0102 00260000
*   DO X=ONE TO DEVNUMEL WHILE EXITSW=OFF;/*                 @G24LB37*/ 00261000
         LA    X,1                                                 0102 00262000
         B     @DE00102                                            0102 00263000
@DL00102 TM    EXITSW,B'01000000'                                  0102 00264000
         BNZ   @DC00102                                            0102 00265000
*     IF DEVTYPE=DEV3330V THEN                                     0103 00266000
         CLC   DEVTYPE(4,DVMSKELP),DEV3330V                        0103 00267000
         BNE   @RF00103                                            0103 00268000
*       SAV3330P=DVMSKELP;          /*                       @G24LB37*/ 00269000
         LR    SAV3330P,DVMSKELP                                   0104 00270000
*     IF DEVTYPE=UNIDEVTP THEN                                     0105 00271000
@RF00103 CLC   DEVTYPE(4,DVMSKELP),UNIDEVTP(UNITPTR)               0105 00272000
         BNE   @RF00105                                            0105 00273000
*       DO;                         /*                       @G24LB37*/ 00274000
*         FOUNDSW=ON;               /*                       @G24LB37*/ 00275000
         OI    FOUNDSW,B'10000000'                                 0107 00276000
*         SAVDEVTP=DVMSKELP;        /*                       @G24LB37*/ 00277000
         LR    SAVDEVTP,DVMSKELP                                   0108 00278000
*       END;                        /*                       @G24LB37*/ 00279000
*     IF SAV3330P¬=ZERO&FOUNDSW=ON THEN                            0110 00280000
@RF00105 LTR   SAV3330P,SAV3330P                                   0110 00281000
         BZ    @RF00110                                            0110 00282000
         TM    FOUNDSW,B'10000000'                                 0110 00283000
         BNO   @RF00110                                            0110 00284000
*       EXITSW=ON;                  /*                       @G24LB37*/ 00285000
         OI    EXITSW,B'01000000'                                  0111 00286000
*     DVMSKELP=DVMSKELP+DVMSKELN;   /*                       @G24LB37*/ 00287000
@RF00110 ALR   DVMSKELP,DVMSKELN                                   0112 00288000
*   END;                            /*                       @G24LB37*/ 00289000
         AL    X,@CF00049                                          0113 00290000
@DE00102 CH    X,DEVNUMEL(,DVMSKPTR)                               0113 00291000
         BNH   @DL00102                                            0113 00292000
@DC00102 DS    0H                                                  0114 00293000
*                                                                  0114 00294000
*   /*****************************************************************/ 00295000
*   /*                                                               */ 00296000
*   /* IF THE FOUND SWITCH IS ON, THEN 'AND' THE TWO MASKS   @G24LB37*/ 00297000
*   /* TOGETHER AND CHECK THE RESULT FOR AN EQUAL CONDITION. @G24LB37*/ 00298000
*   /* IF THE RESULT IS EQUAL THEN THE DEVICE TYPE IS NOT    @G24LB37*/ 00299000
*   /* MIXED. SET THE RETURN CODE TO ZERO IF EQUAL, ELSE,    @G24LB37*/ 00300000
*   /* SET THE RETURN CODE TO EIGHT, INDICATING THE DEVICE   @G24LB37*/ 00301000
*   /* TYPE PASSED IS NOT ALL 3330V UNITS.                   @G24LB37*/ 00302000
*   /*                                                               */ 00303000
*   /*****************************************************************/ 00304000
*                                                                  0114 00305000
*   IF FOUNDSW=ON THEN                                             0114 00306000
         TM    FOUNDSW,B'10000000'                                 0114 00307000
         BNO   @RF00114                                            0114 00308000
*     DO;                           /*                       @G24LB37*/ 00309000
*       DVMSKELP=SAVDEVTP;          /*                       @G24LB37*/ 00310000
         LR    DVMSKELP,SAVDEVTP                                   0116 00311000
*       WORKMASK(ONE:DVMSKMLN)=DEVMASK(ONE:DVMSKMLN)&SAVMASK(ONE:  0117 00312000
*           DVMSKMLN);              /*                       @G24LB37*/ 00313000
         LR    @10,DVMSKMLN                                        0117 00314000
         BCTR  @10,0                                               0117 00315000
         EX    @10,@SM01250                                        0117 00316000
         EX    @10,@SN01252                                        0117 00317000
*       IF WORKMASK(ONE:DVMSKMLN)=DEVMASK(ONE:DVMSKMLN) THEN       0118 00318000
         EX    @10,@SC01254                                        0118 00319000
         BNE   @RF00118                                            0118 00320000
*         RETCODE=ZERO;             /*                       @G24LB37*/ 00321000
         SLR   RETCODE,RETCODE                                     0119 00322000
*       ELSE                                                       0120 00323000
*         RETCODE=EIGHT;            /*                       @G24LB37*/ 00324000
         B     @RC00118                                            0120 00325000
@RF00118 LA    RETCODE,8                                           0120 00326000
*     END;                          /*                       @G24LB37*/ 00327000
*   ELSE                                                           0122 00328000
*     RETCODE=EIGHT;                /*                       @G24LB37*/ 00329000
         B     @RC00114                                            0122 00330000
@RF00114 LA    RETCODE,8                                           0122 00331000
*   RETURN;                         /* RET TO MAIN ROUTINE   @G24LB37*/ 00332000
@EL00003 DS    0H                                                  0123 00333000
@EF00003 DS    0H                                                  0123 00334000
@ER00003 BR    @14                                                 0123 00335000
*   END ALLVIRT;                    /* END OF ALLVIRT PROC   @G24LB37*/ 00336000
         B     @EL00003                                            0124 00337000
*                                                                  0125 00338000
*/********************************************************************/ 00339000
*/*                                                                  */ 00340000
*/*     PROCEDURE NAME - UNITINCL                            @G24LB37*/ 00341000
*/*                                                          @G24LB37*/ 00342000
*/*     FUNCTION - THIS PROCEDURE DETERMINES IF THE PASSED   @G24LB37*/ 00343000
*/*                UCB ADDRESS IS INCLUDED WITHIN THE SPEC-  @G24LB37*/ 00344000
*/*                IFIED DEVICE TYPE, CALLS SCANLKUP TO SCAN @G24LB37*/ 00345000
*/*                THE UCB LOOK UP TABLE FOR THE PASSED UCB  @G24LB37*/ 00346000
*/*                ADDRESS, AND TO COUNT ITS OFFSET WITHIN   @G24LB37*/ 00347000
*/*                THE LOOK UP TABLE.  IF THE SCAN IS SUC-   @G24LB37*/ 00348000
*/*                CESSFUL, THEN CALLS THE SCANMASK PROC-    @G24LB37*/ 00349000
*/*                EDURE TO DETERMINE BY SCANNING THE DEVICE @G24LB37*/ 00350000
*/*                MASK TABLE IF THE UCB OFFSET BIT IN THE   @G24LB37*/ 00351000
*/*                MASK IS ON FOR THAT DEVICE TYPE.          @G24LB37*/ 00352000
*/*                                                          @G24LB37*/ 00353000
*/*     INPUT - THE DEVICE TYPE AND THE UCB ADDRESS OF THE   @G24LB37*/ 00354000
*/*             UNIT TO DETERMINE IF INCLUDED, PASSED IN THE @G24LB37*/ 00355000
*/*             FIELDS UNIDEVTP AND UNIUCBP IN THE UNITP.    @G24LB37*/ 00356000
*/*                                                          @G24LB37*/ 00357000
*/*     OUTPUT -   RETURN CODE IS RETURNED IN RETCODE AREA   @G24LB37*/ 00358000
*/*                AS FOLLOWS:                               @G24LB37*/ 00359000
*/*                0 = UCB ADDRESS IS INCLUDED WITHIN THE    @G24LB37*/ 00360000
*/*                    SPECIFIED DEVICE TYPE                 @G24LB37*/ 00361000
*/*                4 = UCB ADDRESS IS NOT INCLUDED WITHIN    @G24LB37*/ 00362000
*/*                    THE SPECIFIED DEVICE TYPE, OR THE     @G24LB37*/ 00363000
*/*                    SPECIFIED DEVICE TYPE OR UCB ADDRESS  @G24LB37*/ 00364000
*/*                    WAS NOT FOUND                         @G24LB37*/ 00365000
*/*                                                                  */ 00366000
*/********************************************************************/ 00367000
*                                                                  0125 00368000
*UNITINCL:                                                         0125 00369000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00370000
UNITINCL ST    @14,@SA00004                                        0125 00371000
*                                                                  0126 00372000
*   /*****************************************************************/ 00373000
*   /*                                                               */ 00374000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE UCB    @G24LB37*/ 00375000
*   /* BY SETTING THE PASSED UCB ADDRESS INTO THE UCBPTR.    @G24LB37*/ 00376000
*   /*                                                               */ 00377000
*   /*****************************************************************/ 00378000
*                                                                  0126 00379000
*   UCBPTR=UNIUCBP;                 /*                       @G24LB37*/ 00380000
*                                                                  0126 00381000
         L     UCBPTR,UNIUCBP(,UNITPTR)                            0126 00382000
*   /*****************************************************************/ 00383000
*   /*                                                               */ 00384000
*   /* CALL THE SCANLKUP PROCEDURE TO SCAN THE SYSTEM UCB    @G24LB37*/ 00385000
*   /* LOOK UP TABLE TO FIND THE MATCHING UCB ADDRESS AS     @G24LB37*/ 00386000
*   /* THE ONE PASSED, TO COMPARE AGAINST THE DEVICE MASK    @G24LB37*/ 00387000
*   /* TABLE. IF THE UCB ADDRESS IS NOT FOUND, A RETURN      @G24LB37*/ 00388000
*   /* CODE OF FOUR WILL BE RETURNED. IF FOUND A COUNTER     @G24LB37*/ 00389000
*   /* (UCBCNTR) WILL BE SET INDICATING WHAT POSITION WITHIN @G24LB37*/ 00390000
*   /* THE LOOK UP TABLE THE ADDRESS WAS FOUND (1ST, 2ND,    @G24LB37*/ 00391000
*   /* ETC.), AND A RETURN CODE OF ZERO.                     @G24LB37*/ 00392000
*   /*                                                               */ 00393000
*   /*****************************************************************/ 00394000
*                                                                  0127 00395000
*   CALL SCANLKUP;                  /*                       @G24LB37*/ 00396000
*                                                                  0127 00397000
         BAL   @14,SCANLKUP                                        0127 00398000
*   /*****************************************************************/ 00399000
*   /*                                                               */ 00400000
*   /* IF RETURN CODE IS ZERO, CALL THE SCANMASK PROCEDURE   @G24LB37*/ 00401000
*   /* TO DETERMINE IF THE UCB IS INCLUDED WITHIN THE        @G24LB37*/ 00402000
*   /* SPECIFIED DEVICE TYPE. A RETURN CODE OF ZERO WILL BE  @G24LB37*/ 00403000
*   /* RETURNED IF INCLUDED, OR A RETURN CODE OF FOUR, IF    @G24LB37*/ 00404000
*   /* NOT INCLUDED.                                         @G24LB37*/ 00405000
*   /*                                                               */ 00406000
*   /*****************************************************************/ 00407000
*                                                                  0128 00408000
*   IF RETCODE=ZERO THEN                                           0128 00409000
         LTR   RETCODE,RETCODE                                     0128 00410000
         BNZ   @RF00128                                            0128 00411000
*     CALL SCANMASK;                /*                       @G24LB37*/ 00412000
         BAL   @14,SCANMASK                                        0129 00413000
*   RETURN;                         /* RET TO MAIN ROUTINE   @G24LB37*/ 00414000
@EL00004 DS    0H                                                  0130 00415000
@EF00004 DS    0H                                                  0130 00416000
@ER00004 L     @14,@SA00004                                        0130 00417000
         BR    @14                                                 0130 00418000
*   END UNITINCL;                   /* END OF UNITINCL PROC  @G24LB37*/ 00419000
         B     @EL00004                                            0131 00420000
*                                                                  0132 00421000
*/********************************************************************/ 00422000
*/*                                                                  */ 00423000
*/*     PROCEDURE NAME - SCANLKUP                            @G24LB37*/ 00424000
*/*                                                          @G24LB37*/ 00425000
*/*     FUNCTION - THIS PROCEDURE DETERMINES IF THE PASSED   @G24LB37*/ 00426000
*/*                UCB ADDRESS IS IN THE SYSTEM LOOK UP      @G24LB37*/ 00427000
*/*                TABLE, AND COUNTS THE UCB'S OFFSET WITHIN @G24LB37*/ 00428000
*/*                THE SYSTEM UCB LOOK UP TABLE.             @G24LB37*/ 00429000
*/*                                                          @G24LB37*/ 00430000
*/*     INPUT - THE UCB ADDRESS OF THE UNIT, PASSED IN THE   @G24LB37*/ 00431000
*/*             UNITP.  THE ADDRESS OF THE SYSTEM LOOK UP    @G24LB37*/ 00432000
*/*             TABLE IN THE CVT FIELD CVTILK2.              @G24LB37*/ 00433000
*/*                                                          @G24LB37*/ 00434000
*/*     OUTPUT -   RETURN CODE IS RETURNED IN RETCODE AREA   @G24LB37*/ 00435000
*/*                AS FOLLOWS:                               @G24LB37*/ 00436000
*/*                0 = UCB ADDRESS WAS FOUND                 @G24LB37*/ 00437000
*/*                4 = UCB ADDRESS WAS NOT FOUND             @G24LB37*/ 00438000
*/*                                                                  */ 00439000
*/********************************************************************/ 00440000
*                                                                  0132 00441000
*SCANLKUP:                                                         0132 00442000
*   PROCEDURE OPTIONS(NOSAVE);      /*                       @G24LB37*/ 00443000
SCANLKUP DS    0H                                                  0133 00444000
*                                                                  0133 00445000
*   /*****************************************************************/ 00446000
*   /*                                                               */ 00447000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE SYSTEM @G24LB37*/ 00448000
*   /* UCB LOOK UP TABLE USING THE CVTILK2 FIELD IN THE CVT. @G24LB37*/ 00449000
*   /* CLEAR COUNTER AND TURN FOUNDSW OFF.                   @G24LB37*/ 00450000
*   /*                                                               */ 00451000
*   /*****************************************************************/ 00452000
*                                                                  0133 00453000
*   UCBLOKUP=CVTILK2;               /*                       @G24LB37*/ 00454000
         L     @10,CVTPTR                                          0133 00455000
         L     UCBLOKUP,CVTILK2(,@10)                              0133 00456000
*   UCBCNTR=ZERO;                   /*                       @G24LB37*/ 00457000
         SLR   UCBCNTR,UCBCNTR                                     0134 00458000
*   FOUNDSW=OFF;                    /*                       @G24LB37*/ 00459000
*                                                                  0135 00460000
         NI    FOUNDSW,B'01111111'                                 0135 00461000
*   /*****************************************************************/ 00462000
*   /*                                                               */ 00463000
*   /* SCAN THE SYSTEM UCB LOOK UP TABLE, TAKE EACH UCB      @G24LB37*/ 00464000
*   /* ADDRESS AND CHECK THAT ADDRESS FIELD FOR THE MATCHING @G24LB37*/ 00465000
*   /* UCBADDR THAT WAS PASSED IN THE UNITP. ADD A PLUS TWO  @G24LB37*/ 00466000
*   /* TO THE ADDRESS OF THE TABLE TO INCREMENT TO THE NEXT  @G24LB37*/ 00467000
*   /* UCB ADDRESS ENTRY. IF THE UCB ADDRESS IS ALL HEX      @G24LB37*/ 00468000
*   /* FOXES THEN THE END OF THE TABLE HAS BEEN REACHED.     @G24LB37*/ 00469000
*   /*                                                               */ 00470000
*   /*****************************************************************/ 00471000
*                                                                  0136 00472000
*   DO WHILE(UCBADDR¬=UCBDELIM(ONE:TWO))&(FOUNDSW=OFF);/*    @G24LB37*/ 00473000
         B     @DE00136                                            0136 00474000
@DL00136 DS    0H                                                  0137 00475000
*     IF UCBADDR=UCBPTR THEN                                       0137 00476000
         LH    @10,UCBADDR(,UCBLOKUP)                              0137 00477000
         N     @10,@CF01256                                        0137 00478000
         CR    UCBPTR,@10                                          0137 00479000
         BNE   @RF00137                                            0137 00480000
*       FOUNDSW=ON;                 /*                       @G24LB37*/ 00481000
         OI    FOUNDSW,B'10000000'                                 0138 00482000
*     ELSE                                                         0139 00483000
*       UCBCNTR=UCBCNTR+ONE;        /*                       @G24LB37*/ 00484000
         B     @RC00137                                            0139 00485000
@RF00137 AL    UCBCNTR,@CF00049                                    0139 00486000
*     UCBLOKUP=UCBLOKUP+TWO;        /*                       @G24LB37*/ 00487000
@RC00137 AL    UCBLOKUP,@CF00044                                   0140 00488000
*   END;                            /*                       @G24LB37*/ 00489000
*                                                                  0141 00490000
@DE00136 CLC   UCBADDR(2,UCBLOKUP),UCBDELIM                        0141 00491000
         BE    @DC00136                                            0141 00492000
         TM    FOUNDSW,B'10000000'                                 0141 00493000
         BZ    @DL00136                                            0141 00494000
@DC00136 DS    0H                                                  0142 00495000
*   /*****************************************************************/ 00496000
*   /*                                                               */ 00497000
*   /* IF THE UCB ADDRESS IS FOUND IN THE SYSTEM LOOK UP     @G24LB37*/ 00498000
*   /* TABLE, THEN SET THE RETURN CODE TO ZERO. IF THE UCB   @G24LB37*/ 00499000
*   /* ADDRESS IS NOT FOUND (END OF TABLE REACHED), THEN     @G24LB37*/ 00500000
*   /* THE RETURN CODE IS ALREADY SET TO FOUR.               @G24LB37*/ 00501000
*   /*                                                               */ 00502000
*   /*****************************************************************/ 00503000
*                                                                  0142 00504000
*   IF FOUNDSW=ON THEN                                             0142 00505000
         TM    FOUNDSW,B'10000000'                                 0142 00506000
         BNO   @RF00142                                            0142 00507000
*     RETCODE=ZERO;                 /*                       @G24LB37*/ 00508000
         SLR   RETCODE,RETCODE                                     0143 00509000
*   RETURN;                         /* RET TO UNITINCL PROC  @G24LB37*/ 00510000
@EL00005 DS    0H                                                  0144 00511000
@EF00005 DS    0H                                                  0144 00512000
@ER00005 BR    @14                                                 0144 00513000
*   END SCANLKUP;                   /* END OF SCANLKUP PROC  @G24LB37*/ 00514000
         B     @EL00005                                            0145 00515000
*                                                                  0146 00516000
*/********************************************************************/ 00517000
*/*                                                                  */ 00518000
*/*     PROCEDURE NAME - SCANMASK                            @G24LB37*/ 00519000
*/*                                                          @G24LB37*/ 00520000
*/*     FUNCTION - THIS PROCEDURE DETERMINES BY USING THE    @G24LB37*/ 00521000
*/*                UCB ADDRESS OFFSET COUNTER INITIALIZED BY @G24LB37*/ 00522000
*/*                THE SCANLKUP PROCEDURE, TO SCAN THE       @G24LB37*/ 00523000
*/*                DEVICE MASK TABLE ENTRY, TO DETERMINE IF  @G24LB37*/ 00524000
*/*                THE UCB OFFSET BIT IN THE MASK IS ON      @G24LB37*/ 00525000
*/*                FOR THAT DEVICE TYPE.                     @G24LB37*/ 00526000
*/*                                                          @G24LB37*/ 00527000
*/*     INPUT - THE DEVICE TYPE, PASSED IN FIELD UNIDEVTP,   @G24LB37*/ 00528000
*/*             AND THE UCB ADDRESS OFFSET COUNTER FROM      @G24LB37*/ 00529000
*/*             THE SCANLKUP PROCEDURE.  THE ADDRESS OF THE  @G24LB37*/ 00530000
*/*             DEVICE MASK TABLE AND THE ELEMENT LENGTH     @G24LB37*/ 00531000
*/*             PASSED IN THE VVICB CONTROL BLOCK.           @G24LB37*/ 00532000
*/*                                                          @G24LB37*/ 00533000
*/*     OUTPUT -   RETURN CODE IS RETURNED IN RETCODE AREA   @G24LB37*/ 00534000
*/*                AS FOLLOWS:                               @G24LB37*/ 00535000
*/*                0 = UCB ADDRESS IS INCLUDED WITHIN THE    @G24LB37*/ 00536000
*/*                    SPECIFIED DEVICE TYPE                 @G24LB37*/ 00537000
*/*                4 = UCB ADDRESS IS NOT INCLUDED WITHIN    @G24LB37*/ 00538000
*/*                    THE SPECIFIED DEVICE TYPE, OR THE     @G24LB37*/ 00539000
*/*                    SPECIFIED DEVICE TYPE WAS NOT FOUND   @G24LB37*/ 00540000
*/*                                                                  */ 00541000
*/********************************************************************/ 00542000
*                                                                  0146 00543000
*SCANMASK:                                                         0146 00544000
*   PROCEDURE OPTIONS(NOSAVE);      /*                       @G24LB37*/ 00545000
SCANMASK DS    0H                                                  0147 00546000
*                                                                  0147 00547000
*   /*****************************************************************/ 00548000
*   /*                                                               */ 00549000
*   /* INITIALIZE AND ESTABLISH ADDRESSIBILITY TO THE DEVICE @G24LB37*/ 00550000
*   /* MASK TABLE (DEVMASKT). COMPUTE THE TOTAL ENTRY        @G24LB37*/ 00551000
*   /* LENGTH OF THE DEVICE MASK TABLE BY TAKING THE FIELD   @G24LB37*/ 00552000
*   /* VVIDVMEL AND ADDING A PLUS TWO TO THE FIELD AND PUT   @G24LB37*/ 00553000
*   /* IN THE ELEMENT INDEX FIELD. THE TWO WORDS ADDED ARE   @G24LB37*/ 00554000
*   /* FOR THE DEVICE TYPE AND THE NUMBER OF BITS IN THE     @G24LB37*/ 00555000
*   /* MASK FIELDS.                                          @G24LB37*/ 00556000
*   /*                                                               */ 00557000
*   /*****************************************************************/ 00558000
*                                                                  0147 00559000
*   DVMSKPTR=VVIDVMTA;              /*                       @G24LB37*/ 00560000
         L     DVMSKPTR,VVIDVMTA(,VVIPTR)                          0147 00561000
*   DVMSKMLN=VVIDVMEL*FOUR;         /*                       @G24LB37*/ 00562000
         L     @15,VVIDVMEL(,VVIPTR)                               0148 00563000
         LR    DVMSKMLN,@15                                        0148 00564000
         SLA   DVMSKMLN,2                                          0148 00565000
*   DVMSKELN=(VVIDVMEL+TWO)*FOUR;   /*                       @G24LB37*/ 00566000
         AL    @15,@CF00044                                        0149 00567000
         SLA   @15,2                                               0149 00568000
         LR    DVMSKELN,@15                                        0149 00569000
*   DVMSKELP=ADDR(DEVMSKEL);        /*                       @G24LB37*/ 00570000
         LA    DVMSKELP,DEVMSKEL(,DVMSKPTR)                        0150 00571000
*   SAV3330P=ZERO;                  /*                       @G24LB37*/ 00572000
         SLR   SAV3330P,SAV3330P                                   0151 00573000
*   WORKAREA=''B;                   /*                       @G24LB37*/ 00574000
*                                                                  0152 00575000
         XC    WORKAREA(4),WORKAREA                                0152 00576000
*   /*****************************************************************/ 00577000
*   /*                                                               */ 00578000
*   /* SCAN THE DEVICE MASK TABLE FOR THE PASSED DEVICE TYPE @G24LB37*/ 00579000
*   /* IN THE UNITP. ONCE A COMPARE EQUAL IS FOUND SAVE      @G24LB37*/ 00580000
*   /* THAT ENTRIES ADDRESS FOR THE NEXT STEP. IF NOT FOUND  @G24LB37*/ 00581000
*   /* SET THE RETURN CODE TO FOUR.                          @G24LB37*/ 00582000
*   /*                                                               */ 00583000
*   /*****************************************************************/ 00584000
*                                                                  0153 00585000
*   DO X=ONE TO DEVNUMEL WHILE SAV3330P=ZERO;/*              @G24LB37*/ 00586000
         LA    X,1                                                 0153 00587000
         B     @DE00153                                            0153 00588000
@DL00153 LTR   SAV3330P,SAV3330P                                   0153 00589000
         BNZ   @DC00153                                            0153 00590000
*     IF DEVTYPE=UNIDEVTP THEN                                     0154 00591000
         CLC   DEVTYPE(4,DVMSKELP),UNIDEVTP(UNITPTR)               0154 00592000
         BNE   @RF00154                                            0154 00593000
*       SAV3330P=DVMSKELP;          /*                       @G24LB37*/ 00594000
         LR    SAV3330P,DVMSKELP                                   0155 00595000
*     ELSE                                                         0156 00596000
*       DVMSKELP=DVMSKELP+DVMSKELN; /*                       @G24LB37*/ 00597000
         B     @RC00154                                            0156 00598000
@RF00154 ALR   DVMSKELP,DVMSKELN                                   0156 00599000
*   END;                            /*                       @G24LB37*/ 00600000
*                                                                  0157 00601000
@RC00154 AL    X,@CF00049                                          0157 00602000
@DE00153 CH    X,DEVNUMEL(,DVMSKPTR)                               0157 00603000
         BNH   @DL00153                                            0157 00604000
@DC00153 DS    0H                                                  0158 00605000
*   /*****************************************************************/ 00606000
*   /*                                                               */ 00607000
*   /* IF THE ENTRY WAS FOUND THEN DETERMINE IF THE BIT IS   @G24LB37*/ 00608000
*   /* ON CORRESPONDING TO THE PASSED SYSTEM UCB LOOK UP     @G24LB37*/ 00609000
*   /* OFFSET NUMBER.                                        @G24LB37*/ 00610000
*   /*                                                               */ 00611000
*   /*****************************************************************/ 00612000
*                                                                  0158 00613000
*   IF SAV3330P¬=ZERO THEN                                         0158 00614000
         LTR   SAV3330P,SAV3330P                                   0158 00615000
         BZ    @RF00158                                            0158 00616000
*     DO;                           /*                       @G24LB37*/ 00617000
*                                                                  0160 00618000
*       /*************************************************************/ 00619000
*       /*                                                           */ 00620000
*       /* THE BIT OFFSET IS DIVIDED BY EIGHT TO GET THE     @G24LB37*/ 00621000
*       /* BYTE OFFSET IN THE MASK ENTRY. THE REMAINDER OF   @G24LB37*/ 00622000
*       /* THE DIVIDE IS THE BIT OFFSET WITHIN THE BYTE.     @G24LB37*/ 00623000
*       /*                                                           */ 00624000
*       /*************************************************************/ 00625000
*                                                                  0160 00626000
*       BYTOFFST=UCBCNTR/EIGHT;     /*                       @G24LB37*/ 00627000
         LR    @00,UCBCNTR                                         0160 00628000
         SRDA  @00,32                                              0160 00629000
         D     @00,@CF00058                                        0160 00630000
         LR    BYTOFFST,@01                                        0160 00631000
*       BITOFFST=UCBCNTR//EIGHT;    /*                       @G24LB37*/ 00632000
*                                                                  0161 00633000
         LR    @00,UCBCNTR                                         0161 00634000
         SRDA  @00,32                                              0161 00635000
         D     @00,@CF00058                                        0161 00636000
         LR    BITOFFST,@00                                        0161 00637000
*       /*************************************************************/ 00638000
*       /*                                                           */ 00639000
*       /* TAKE THE BYTE COMPUTED IN THE DIVIDE AND 'AND'    @G24LB37*/ 00640000
*       /* THE BITMASK TO THE UNIT BIT WITHIN THE BYTE       @G24LB37*/ 00641000
*       /* USING THE BIT OFFSET. THIS IS DONE TO ELIMINATE   @G24LB37*/ 00642000
*       /* ALL OTHER BITS IN THE BYTE FOR THE SHIFT TO GIVE  @G24LB37*/ 00643000
*       /* CORRECT RESULTS(CONDITION CODE). PUT THE BYTE     @G24LB37*/ 00644000
*       /* INTO THE HIGH ORDER BYTE OF THE REGISTER.         @G24LB37*/ 00645000
*       /*                                                           */ 00646000
*       /*************************************************************/ 00647000
*                                                                  0162 00648000
*       WORKBYTE=DEVMASK(BYTOFFST+ONE);/*                    @G24LB37*/ 00649000
         LR    @10,DVMSKELP                                        0162 00650000
         ALR   @10,BYTOFFST                                        0162 00651000
         MVC   WORKBYTE(1),DEVMASK(@10)                            0162 00652000
*       WORKBYTE=BITMASK(BITOFFST+ONE)&WORKBYTE;/*           @G24LB37*/ 00653000
         LA    @10,BITMASK(BITOFFST)                               0163 00654000
         NC    WORKBYTE(1),0(@10)                                  0163 00655000
*       RFY                                                        0164 00656000
*         REG4 RESTRICTED;          /*                       @G24LB37*/ 00657000
*       REG4=WORKAREA;              /*                       @G24LB37*/ 00658000
*                                                                  0165 00659000
         ICM   REG4,15,WORKAREA                                    0165 00660000
*       /*************************************************************/ 00661000
*       /*                                                           */ 00662000
*       /* SHIFT THE REGISTER THE NUMBER OF BITS INDICATED   @G24LB37*/ 00663000
*       /* BY THE BIT OFFSET AND TEST THE RESULTS FOR A      @G24LB37*/ 00664000
*       /* MINUS OR AN OVERFLOW CONDITION, WHICH WILL BE     @G24LB37*/ 00665000
*       /* ONLY TRUE IF THE BIT IS ON. BRANCH TO END OF      @G24LB37*/ 00666000
*       /* THE PROCEDURE IF MINUS OR AN OVERFLOW CONDITION,  @G24LB37*/ 00667000
*       /* RETCODE IS ALREADY ZERO, ELSE SET RETCODE TO      @G24LB37*/ 00668000
*       /* FOUR, THE BIT IS NOT ON IN THE MASK.              @G24LB37*/ 00669000
*       /*                                                           */ 00670000
*       /*************************************************************/ 00671000
*                                                                  0166 00672000
*       SLA(REG4,BITOFFST);         /*                       @G24LB37*/ 00673000
         SLA   REG4,0(BITOFFST)                                    0166 00674000
*       BC(FIVE,BITON);             /*                       @G24LB37*/ 00675000
         BC    5,BITON                                             0167 00676000
*       RFY                                                        0168 00677000
*         REG4 UNRESTRICTED;        /*                       @G24LB37*/ 00678000
*       RETCODE=FOUR;               /*                       @G24LB37*/ 00679000
         LA    RETCODE,4                                           0169 00680000
*     END;                          /*                       @G24LB37*/ 00681000
*                                                                  0171 00682000
*   /*****************************************************************/ 00683000
*   /*                                                               */ 00684000
*   /* SET RETURN CODE TO FOUR, DEVICE TYPE WAS NOT FOUND.   @G24LB37*/ 00685000
*   /*                                                               */ 00686000
*   /*****************************************************************/ 00687000
*                                                                  0171 00688000
*   ELSE                                                           0171 00689000
*     RETCODE=FOUR;                 /*                       @G24LB37*/ 00690000
*                                                                  0171 00691000
         B     @RC00158                                            0171 00692000
@RF00158 LA    RETCODE,4                                           0171 00693000
*   /*****************************************************************/ 00694000
*   /*                                                               */ 00695000
*   /* RETURN TO CALLER, THE RETCODE AREA IS SET WITH RETURN @G24LB37*/ 00696000
*   /* CODE.                                                 @G24LB37*/ 00697000
*   /*                                                               */ 00698000
*   /*****************************************************************/ 00699000
*                                                                  0172 00700000
*BITON:                                                            0172 00701000
*   RETURN;                         /* RET TO UNITINCL PROC  @G24LB37*/ 00702000
@EL00006 DS    0H                                                  0172 00703000
@EF00006 DS    0H                                                  0172 00704000
@ER00006 BR    @14                                                 0172 00705000
*   END SCANMASK;                   /* END OF SCANMASK PROC  @G24LB37*/ 00706000
         B     @EL00006                                            0173 00707000
*   END ICBVUP01                    /* END OF ICBVUP01       @G24LB37*/ 00708000
*                                                                  0174 00709000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00710000
*/*%INCLUDE SYSLIB  (IEZUNITP)                                       */ 00711000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 00712000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 00713000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 00714000
*                                                                  0174 00715000
*       ;                                                          0174 00716000
@DATA    DS    0H                                                       00717000
@SM01250 MVC   WORKMASK(0),DEVMASK(DVMSKELP)                            00718000
@SN01252 NC    WORKMASK(0),SAVMASK(SAV3330P)                            00719000
@SC01254 CLC   WORKMASK(0),DEVMASK(DVMSKELP)                            00720000
@DATD    DSECT                                                          00721000
         DS    0F                                                       00722000
@SA00001 DS    18F                                                      00723000
@PC00001 DS    2F                                                       00724000
@SA00004 DS    1F                                                       00725000
ICBVUP01 CSECT                                                          00726000
         DS    0F                                                       00727000
@CF00049 DC    F'1'                                                     00728000
@CF00044 DC    F'2'                                                     00729000
@CF00040 DC    F'4'                                                     00730000
@CF00058 DC    F'8'                                                     00731000
@CF01256 DC    XL4'0000FFFF'                                            00732000
@DATD    DSECT                                                          00733000
         DS    0D                                                       00734000
VUP01SWS DS    CL2                                                      00735000
         ORG   VUP01SWS                                                 00736000
FOUNDSW  DS    BL1                                                      00737000
EXITSW   EQU   VUP01SWS+0                                               00738000
@NM00009 EQU   VUP01SWS+0                                               00739000
         ORG   VUP01SWS+2                                               00740000
WORKAREA DS    CL4                                                      00741000
         ORG   WORKAREA                                                 00742000
WORKBYTE DS    CL1                                                      00743000
@NM00010 DS    CL3                                                      00744000
         ORG   WORKAREA+4                                               00745000
WORKMASK DS    CL256                                                    00746000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00747000
@ENDDATD EQU   *                                                        00748000
ICBVUP01 CSECT                                                          00749000
         DS    0F                                                       00750000
@SIZDATD DC    AL1(252)                                                 00751000
         DC    AL3(@ENDDATD-@DATD)                                      00752000
         DS    0D                                                       00753000
DEV3330V DC    X'30582009'                                              00754000
UCBDELIM DC    X'FFFFFFFF'                                              00755000
FIXAREA  DS    CL100                                                    00756000
         ORG   FIXAREA                                                  00757000
@NM00012 DC    100X'00'                                                 00758000
         ORG   FIXAREA+100                                              00759000
BITMASK  DC    X'80'                                                    00760000
         DC    X'40'                                                    00761000
         DC    X'20'                                                    00762000
         DC    X'10'                                                    00763000
         DC    X'08'                                                    00764000
         DC    X'04'                                                    00765000
         DC    X'02'                                                    00766000
         DC    X'01'                                                    00767000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00768000
@01      EQU   01                                                       00769000
@02      EQU   02                                                       00770000
@03      EQU   03                                                       00771000
@04      EQU   04                                                       00772000
@05      EQU   05                                                       00773000
@06      EQU   06                                                       00774000
@07      EQU   07                                                       00775000
@08      EQU   08                                                       00776000
@09      EQU   09                                                       00777000
@10      EQU   10                                                       00778000
@11      EQU   11                                                       00779000
@12      EQU   12                                                       00780000
@13      EQU   13                                                       00781000
@14      EQU   14                                                       00782000
@15      EQU   15                                                       00783000
BITOFFST EQU   @03                                                      00784000
BYTOFFST EQU   @04                                                      00785000
UCBCNTR  EQU   @07                                                      00786000
DVMSKMLN EQU   @08                                                      00787000
DVMSKELN EQU   @10                                                      00788000
RETCODE  EQU   @05                                                      00789000
X        EQU   @09                                                      00790000
SAVDEVTP EQU   @07                                                      00791000
SAV3330P EQU   @03                                                      00792000
DVMSKELP EQU   @02                                                      00793000
DVMSKPTR EQU   @04                                                      00794000
UCBLOKUP EQU   @02                                                      00795000
MSVLKPTR EQU   @02                                                      00796000
UNITPTR  EQU   @06                                                      00797000
UCBPTR   EQU   @04                                                      00798000
VVIPTR   EQU   @03                                                      00799000
REG4     EQU   @04                                                      00800000
REG14    EQU   @14                                                      00801000
REG0     EQU   @00                                                      00802000
REG1     EQU   @01                                                      00803000
REG15    EQU   @15                                                      00804000
CVTPTR   EQU   16                                                       00805000
UNITP    EQU   0                                                        00806000
UNIDEVTP EQU   UNITP                                                    00807000
UNIVOL   EQU   UNITP+4                                                  00808000
UNIUCBP  EQU   UNITP+12                                                 00809000
UNIFLAGS EQU   UNITP+16                                                 00810000
UNIFMTD  EQU   UNIFLAGS                                                 00811000
UNIFINCL EQU   UNIFLAGS                                                 00812000
UNIFALLV EQU   UNIFLAGS                                                 00813000
VVICB    EQU   0                                                        00814000
VVIFLGA  EQU   VVICB+15                                                 00815000
VVIUCB   EQU   VVICB+60                                                 00816000
VVIDVMTA EQU   VVICB+84                                                 00817000
VVIDVMEL EQU   VVICB+104                                                00818000
CVTMAP   EQU   0                                                        00819000
CVTILK2  EQU   CVTMAP+40                                                00820000
CVTDAR   EQU   CVTMAP+72                                                00821000
CVTFLGS1 EQU   CVTDAR                                                   00822000
CVTDCB   EQU   CVTMAP+116                                               00823000
CVTIERLC EQU   CVTMAP+144                                               00824000
CVTOPTA  EQU   CVTMAP+182                                               00825000
CVTOPTB  EQU   CVTMAP+183                                               00826000
CVTGTF   EQU   CVTMAP+236                                               00827000
CVTGTFST EQU   CVTGTF                                                   00828000
CVTGTFS  EQU   CVTGTFST                                                 00829000
CVTSTATE EQU   CVTGTFST                                                 00830000
CVTTMODE EQU   CVTGTFST                                                 00831000
CVTFORM  EQU   CVTGTFST                                                 00832000
CVTAQAVT EQU   CVTMAP+240                                               00833000
CVTTCMFG EQU   CVTAQAVT                                                 00834000
CVTVOLM2 EQU   CVTMAP+244                                               00835000
CVTTATA  EQU   CVTVOLM2                                                 00836000
CVTTSKS  EQU   CVTTATA                                                  00837000
CVTVOLF2 EQU   CVTTSKS                                                  00838000
CVTTAT   EQU   CVTTATA+1                                                00839000
CVTATER  EQU   CVTMAP+248                                               00840000
CVTEXT1  EQU   CVTMAP+252                                               00841000
CVTPURG  EQU   CVTMAP+260                                               00842000
CVTQMSG  EQU   CVTMAP+268                                               00843000
CVTDMSR  EQU   CVTMAP+272                                               00844000
CVTRSV37 EQU   CVTDMSR                                                  00845000
CVTDMSRF EQU   CVTRSV37                                                 00846000
CVTERPV  EQU   CVTMAP+316                                               00847000
CVTINTLA EQU   CVTMAP+320                                               00848000
CVTAPF   EQU   CVTMAP+324                                               00849000
CVTEXT2  EQU   CVTMAP+328                                               00850000
CVTHJES  EQU   CVTMAP+332                                               00851000
CVTPGSIA EQU   CVTMAP+348                                               00852000
CVTA1F1  EQU   CVTMAP+356                                               00853000
CVTSYSK  EQU   CVTMAP+357                                               00854000
CVTVOLM1 EQU   CVTMAP+380                                               00855000
CVTVOLF1 EQU   CVTVOLM1                                                 00856000
CVTATMCT EQU   CVTMAP+388                                               00857000
CVTXTNT1 EQU   0                                                        00858000
CVTXTNT2 EQU   0                                                        00859000
CVTDSSV  EQU   CVTXTNT2                                                 00860000
CVTFLGBT EQU   CVTXTNT2+5                                               00861000
CVTQID   EQU   CVTXTNT2+24                                              00862000
CVTRV400 EQU   CVTXTNT2+52                                              00863000
CVTRV409 EQU   CVTXTNT2+53                                              00864000
CVTATCVT EQU   CVTXTNT2+64                                              00865000
CVTRV429 EQU   CVTXTNT2+84                                              00866000
CVTRV438 EQU   CVTXTNT2+85                                              00867000
CVTRV457 EQU   CVTXTNT2+112                                             00868000
CVTRV466 EQU   CVTXTNT2+113                                             00869000
CVTFIX   EQU   0                                                        00870000
CVTRELNO EQU   CVTFIX+252                                               00871000
UCB      EQU   0                                                        00872000
UCBOB    EQU   0                                                        00873000
UCBJBNR  EQU   UCBOB                                                    00874000
UCBFL5   EQU   UCBOB+1                                                  00875000
UCBAF    EQU   UCBFL5                                                   00876000
UCBSTAT  EQU   UCBOB+3                                                  00877000
UCBCHAN  EQU   UCBOB+4                                                  00878000
UCBSFLS  EQU   UCBOB+6                                                  00879000
UCBFLA   EQU   UCBSFLS                                                  00880000
UCBFL1   EQU   UCBFLA                                                   00881000
UCBBSY   EQU   UCBFL1                                                   00882000
UCBNRY   EQU   UCBFL1                                                   00883000
UCBPST   EQU   UCBFL1                                                   00884000
UCBCUB   EQU   UCBFL1                                                   00885000
UCBFLB   EQU   UCBSFLS+1                                                00886000
UCBCHM   EQU   UCBOB+8                                                  00887000
UCBCHM1  EQU   UCBCHM                                                   00888000
UCBPTH0  EQU   UCBCHM1                                                  00889000
UCBPTH1  EQU   UCBCHM1                                                  00890000
UCBWGT   EQU   UCBOB+12                                                 00891000
UCBTYP   EQU   UCBOB+16                                                 00892000
UCBTBYT1 EQU   UCBTYP                                                   00893000
UCB1FEA5 EQU   UCBTBYT1                                                 00894000
UCB1FEA6 EQU   UCBTBYT1                                                 00895000
UCBTBYT2 EQU   UCBTYP+1                                                 00896000
UCB2OPT2 EQU   UCBTBYT2                                                 00897000
UCBDUDN1 EQU   UCB2OPT2                                                 00898000
UCB2OPT3 EQU   UCBTBYT2                                                 00899000
UCBDUDN2 EQU   UCB2OPT3                                                 00900000
UCB2OPT4 EQU   UCBTBYT2                                                 00901000
UCBRWTAU EQU   UCB2OPT4                                                 00902000
UCB2OPT6 EQU   UCBTBYT2                                                 00903000
UCB2OPT7 EQU   UCBTBYT2                                                 00904000
UCBTBYT3 EQU   UCBTYP+2                                                 00905000
UCBDVCLS EQU   UCBTBYT3                                                 00906000
UCBTBYT4 EQU   UCBTYP+3                                                 00907000
UCBEXTPT EQU   UCBOB+20                                                 00908000
UCBFLC   EQU   UCBEXTPT                                                 00909000
UCBDEV   EQU   UCBOB+24                                                 00910000
UCBCMEXT EQU   0                                                        00911000
UCBATI   EQU   UCBCMEXT+3                                               00912000
@NM00008 EQU   UCBATI                                                   00913000
UCBFLP1  EQU   UCBCMEXT+5                                               00914000
UCBMT    EQU   0                                                        00915000
UCBOCR   EQU   0                                                        00916000
UCB3540X EQU   0                                                        00917000
UCBDKBYT EQU   UCB3540X+6                                               00918000
UCB3800X EQU   0                                                        00919000
UCBOPTNS EQU   UCB3800X                                                 00920000
UCBACTIV EQU   UCB3800X+3                                               00921000
UCBMDRBF EQU   UCB3800X+36                                              00922000
UCBUCS   EQU   0                                                        00923000
UCBUCSOP EQU   UCBUCS+4                                                 00924000
UCBFCBOP EQU   UCBUCS+5                                                 00925000
MSVLKUPT EQU   0                                                        00926000
MSVUCBP  EQU   MSVLKUPT                                                 00927000
SYSLKUPT EQU   0                                                        00928000
UCBADDR  EQU   SYSLKUPT                                                 00929000
DEVMASKT EQU   0                                                        00930000
DEVNUMEL EQU   DEVMASKT                                                 00931000
DEVMSKEL EQU   DEVMASKT+4                                               00932000
DEVMASKE EQU   0                                                        00933000
DEVTYPE  EQU   DEVMASKE+4                                               00934000
DEVMASK  EQU   DEVMASKE+8                                               00935000
SAVMASKE EQU   0                                                        00936000
SAVMASK  EQU   SAVMASKE+8                                               00937000
UCBBGN   EQU   0                                                        00938000
UNITRPL  EQU   0                                                        00939000
VVICBLK  EQU   0                                                        00940000
CVTS01   EQU   CVTPGSIA                                                 00941000
CVTLPDIA EQU   CVTS01+12                                                00942000
CVTDIRST EQU   CVTLPDIA                                                 00943000
CVTSLIDA EQU   CVTS01+24                                                00944000
CVTCTLFG EQU   CVTS01+50                                                00945000
CVTRV210 EQU   CVTS01+424                                               00946000
CVTRV219 EQU   CVTS01+425                                               00947000
CVTRV228 EQU   CVTS01+426                                               00948000
CVTRV237 EQU   CVTS01+427                                               00949000
CVTMFRTR EQU   CVTS01+452                                               00950000
CVTRV262 EQU   CVTS01+468                                               00951000
CVTRV271 EQU   CVTS01+469                                               00952000
CVTRV280 EQU   CVTS01+470                                               00953000
CVTRV289 EQU   CVTS01+471                                               00954000
CVTGSDA  EQU   CVTS01+600                                               00955000
UCBOBS01 EQU   UCBDEV                                                   00956000
UCBVOLI  EQU   UCBOBS01+4                                               00957000
UCBSTAB  EQU   UCBOBS01+10                                              00958000
UCBBSVL  EQU   UCBSTAB                                                  00959000
UCBPRSRS EQU   UCBSTAB                                                  00960000
UCBDMCT  EQU   UCBOBS01+11                                              00961000
UCBFL4   EQU   UCBOBS01+13                                              00962000
UCBOBS02 EQU   UCBDEV                                                   00963000
UCBTFL1  EQU   UCBOBS02+19                                              00964000
UCBXTN   EQU   UCBOBS02+20                                              00965000
UCBVOPT  EQU   UCBXTN                                                   00966000
UCBOBS03 EQU   UCBDEV                                                   00967000
UCBXTADR EQU   UCBOBS03                                                 00968000
UCBOBS04 EQU   UCBDEV                                                   00969000
UCBBTA   EQU   UCBOBS04+12                                              00970000
UCBOBS06 EQU   UCBDEV                                                   00971000
UCBAOF   EQU   UCBOBS06                                                 00972000
UCBAOF1  EQU   UCBAOF                                                   00973000
UCBAOF2  EQU   UCBAOF+1                                                 00974000
@NM00007 EQU   UCBOBS06+3                                               00975000
UCBIRB   EQU   UCBOBS06+4                                               00976000
UCBGRAF  EQU   UCBIRB                                                   00977000
UCBLDNCA EQU   UCBOBS06+8                                               00978000
UCBRDYQ  EQU   UCBLDNCA                                                 00979000
UCBIRLN  EQU   UCBRDYQ                                                  00980000
UCBLDNCB EQU   UCBRDYQ+1                                                00981000
UCBCTLNK EQU   UCBOBS06+12                                              00982000
UCBOBS07 EQU   UCBDEV                                                   00983000
UCBOBS08 EQU   UCBDEV                                                   00984000
UCBCTCAD EQU   UCBOBS08                                                 00985000
UCBCTCF1 EQU   UCBOBS08+4                                               00986000
UCBOBS09 EQU   UCBDEV                                                   00987000
*                                      START UNREFERENCED COMPONENTS    00988000
UCBRV066 EQU   UCBOBS09+4                                               00989000
UCBIOSBA EQU   UCBOBS09                                                 00990000
UCBRV042 EQU   UCBOBS08+5                                               00991000
UCBRV082 EQU   UCBCTCF1                                                 00992000
UCBRV081 EQU   UCBCTCF1                                                 00993000
UCBRV080 EQU   UCBCTCF1                                                 00994000
UCBRV079 EQU   UCBCTCF1                                                 00995000
UCBRV078 EQU   UCBCTCF1                                                 00996000
UCBRV077 EQU   UCBCTCF1                                                 00997000
UCBRV076 EQU   UCBCTCF1                                                 00998000
UCBCTC80 EQU   UCBCTCF1                                                 00999000
UCBCTCAL EQU   UCBCTCAD                                                 01000000
UCBICNCB EQU   UCBOBS07+4                                               01001000
UCBRV040 EQU   UCBOBS07                                                 01002000
UCBCTLNA EQU   UCBCTLNK+1                                               01003000
UCBRLN   EQU   UCBCTLNK                                                 01004000
UCBRDYQA EQU   UCBLDNCB                                                 01005000
UCBINRLN EQU   UCBIRLN                                                  01006000
UCBIRBA  EQU   UCBIRB+1                                                 01007000
UCBRV039 EQU   UCBGRAF                                                  01008000
UCBDWNR  EQU   UCBGRAF                                                  01009000
UCBRPND  EQU   UCBGRAF                                                  01010000
UCBUPM   EQU   UCBGRAF                                                  01011000
UCBBTAM  EQU   UCBGRAF                                                  01012000
UCBDRNO  EQU   UCBGRAF                                                  01013000
UCBDRO   EQU   UCBGRAF                                                  01014000
UCBOIP   EQU   UCBGRAF                                                  01015000
UCBATRCD EQU   @NM00007                                                 01016000
UCBSKPFG EQU   @NM00007                                                 01017000
UCBRIPND EQU   @NM00007                                                 01018000
UCBRTIAC EQU   @NM00007                                                 01019000
UCBRSV79 EQU   @NM00007                                                 01020000
UCBRSV78 EQU   @NM00007                                                 01021000
UCBRSV77 EQU   @NM00007                                                 01022000
UCBOLTEP EQU   @NM00007                                                 01023000
UCBATNCT EQU   UCBOBS06+2                                               01024000
UCBRSV76 EQU   UCBAOF2                                                  01025000
UCBRSV75 EQU   UCBAOF2                                                  01026000
UCBRSV74 EQU   UCBAOF2                                                  01027000
UCBRSV73 EQU   UCBAOF2                                                  01028000
UCBRSV72 EQU   UCBAOF2                                                  01029000
UCBRSV71 EQU   UCBAOF2                                                  01030000
UCBRSV70 EQU   UCBAOF2                                                  01031000
UCBRSV69 EQU   UCBAOF2                                                  01032000
UCBRSV68 EQU   UCBAOF1                                                  01033000
UCBRSV67 EQU   UCBAOF1                                                  01034000
UCBRSV66 EQU   UCBAOF1                                                  01035000
UCBRSV65 EQU   UCBAOF1                                                  01036000
UCBRSV64 EQU   UCBAOF1                                                  01037000
UCBOFNL  EQU   UCBAOF1                                                  01038000
UCBOFSP  EQU   UCBAOF1                                                  01039000
UCBOFMCR EQU   UCBAOF1                                                  01040000
UCBBTB   EQU   UCBBTA+1                                                 01041000
UCBDI    EQU   UCBBTA                                                   01042000
UCBSNS   EQU   UCBOBS04+8                                               01043000
UCBTEB   EQU   UCBOBS04+4                                               01044000
UCBGCB   EQU   UCBOBS04+3                                               01045000
UCBOPEN  EQU   UCBOBS04+2                                               01046000
UCBSTART EQU   UCBOBS04                                                 01047000
UCBXTNB  EQU   UCBXTN+1                                                 01048000
UCBRSV22 EQU   UCBVOPT                                                  01049000
UCBRSV21 EQU   UCBVOPT                                                  01050000
UCBRSV20 EQU   UCBVOPT                                                  01051000
UCBESVE  EQU   UCBVOPT                                                  01052000
UCBERPC  EQU   UCBVOPT                                                  01053000
UCBESVC  EQU   UCBVOPT                                                  01054000
UCBEVA   EQU   UCBVOPT                                                  01055000
UCBESV   EQU   UCBVOPT                                                  01056000
UCBRV009 EQU   UCBTFL1                                                  01057000
UCBRV008 EQU   UCBTFL1                                                  01058000
UCBRV007 EQU   UCBTFL1                                                  01059000
UCBRV006 EQU   UCBTFL1                                                  01060000
UCBRV005 EQU   UCBTFL1                                                  01061000
UCBRV038 EQU   UCBTFL1                                                  01062000
UCBNSLTP EQU   UCBTFL1                                                  01063000
UCBNLTP  EQU   UCBTFL1                                                  01064000
UCBRES1B EQU   UCBOBS02+18                                              01065000
UCBFSER  EQU   UCBOBS02+12                                              01066000
@NM00006 EQU   UCBOBS02+4                                               01067000
UCBFSEQ  EQU   UCBOBS02+2                                               01068000
UCBFSCT  EQU   UCBOBS02                                                 01069000
UCBNEXP  EQU   UCBOBS01+20                                              01070000
UCBBASE  EQU   UCBOBS01+16                                              01071000
UCBRES1A EQU   UCBOBS01+15                                              01072000
UCBUSER  EQU   UCBOBS01+14                                              01073000
UCBFL47  EQU   UCBFL4                                                   01074000
UCBMAT   EQU   UCBFL4                                                   01075000
UCBHOLD  EQU   UCBFL4                                                   01076000
UCBATTN  EQU   UCBFL4                                                   01077000
UCBDSS   EQU   UCBFL4                                                   01078000
UCBRESVP EQU   UCBFL4                                                   01079000
UCBWDAV  EQU   UCBFL4                                                   01080000
UCBDAVV  EQU   UCBFL4                                                   01081000
UCBSQC   EQU   UCBOBS01+12                                              01082000
UCBDATP  EQU   UCBOBS01+12                                              01083000
UCBDMC   EQU   UCBDMCT                                                  01084000
UCBMOUNT EQU   UCBDMCT                                                  01085000
UCBBNUL  EQU   UCBSTAB                                                  01086000
UCBSHAR  EQU   UCBSTAB                                                  01087000
UCBBSTR  EQU   UCBSTAB                                                  01088000
UCBBPUB  EQU   UCBSTAB                                                  01089000
UCBBPRV  EQU   UCBSTAB                                                  01090000
UCBBALB  EQU   UCBPRSRS                                                 01091000
UCBPGFL  EQU   UCBSTAB                                                  01092000
UCBDVSHR EQU   UCBBSVL                                                  01093000
UCBVTOC  EQU   UCBOBS01                                                 01094000
CVTRV628 EQU   CVTS01+728                                               01095000
CVTRV627 EQU   CVTS01+724                                               01096000
CVTRV626 EQU   CVTS01+720                                               01097000
CVTRV625 EQU   CVTS01+716                                               01098000
CVTRV624 EQU   CVTS01+712                                               01099000
CVTRV623 EQU   CVTS01+708                                               01100000
CVTRV622 EQU   CVTS01+704                                               01101000
CVTRV621 EQU   CVTS01+700                                               01102000
CVTIHASU EQU   CVTS01+696                                               01103000
CVTRV619 EQU   CVTS01+692                                               01104000
CVTRV618 EQU   CVTS01+688                                               01105000
CVTRV617 EQU   CVTS01+684                                               01106000
CVTRV616 EQU   CVTS01+680                                               01107000
CVTRV615 EQU   CVTS01+676                                               01108000
CVTRV614 EQU   CVTS01+672                                               01109000
CVTRV613 EQU   CVTS01+668                                               01110000
CVTTCASP EQU   CVTS01+664                                               01111000
CVT0PT03 EQU   CVTS01+660                                               01112000
CVT0PT0E EQU   CVTS01+656                                               01113000
CVTRV609 EQU   CVTS01+652                                               01114000
CVTCGK   EQU   CVTS01+648                                               01115000
CVTRAC   EQU   CVTS01+644                                               01116000
CVTRV606 EQU   CVTS01+640                                               01117000
CVTRV605 EQU   CVTS01+636                                               01118000
CVTRV604 EQU   CVTS01+632                                               01119000
CVTEFF02 EQU   CVTS01+628                                               01120000
CVTCBBR  EQU   CVTS01+624                                               01121000
CVTSSCR  EQU   CVTS01+620                                               01122000
CVTEVENT EQU   CVTS01+616                                               01123000
CVTCRCA  EQU   CVTS01+612                                               01124000
CVTTPIO  EQU   CVTS01+608                                               01125000
CVTADV   EQU   CVTS01+604                                               01126000
CVTGSDAB EQU   CVTGSDA                                                  01127000
CVTQV3   EQU   CVTS01+596                                               01128000
CVTQV2   EQU   CVTS01+592                                               01129000
CVTQV1   EQU   CVTS01+588                                               01130000
CVTRPT   EQU   CVTS01+584                                               01131000
CVTSSRB  EQU   CVTS01+580                                               01132000
CVTCSDRL EQU   CVTS01+576                                               01133000
CVTEXP1  EQU   CVTS01+572                                               01134000
CVTRMPMT EQU   CVTS01+568                                               01135000
CVTRMPTT EQU   CVTS01+564                                               01136000
CVTVPSA  EQU   CVTS01+560                                               01137000
CVTVSTOP EQU   CVTS01+556                                               01138000
CVTGTFR8 EQU   CVTS01+552                                               01139000
CVTQUIT  EQU   CVTS01+548                                               01140000
CVTVACR  EQU   CVTS01+544                                               01141000
CVTWTCB  EQU   CVTS01+540                                               01142000
CVTSTPRS EQU   CVTS01+536                                               01143000
CVT0PT02 EQU   CVTS01+532                                               01144000
CVTDARCM EQU   CVTS01+528                                               01145000
CVTIRECM EQU   CVTS01+524                                               01146000
CVTJRECM EQU   CVTS01+520                                               01147000
CVTVEMS0 EQU   CVTS01+516                                               01148000
CVTSPFRR EQU   CVTS01+512                                               01149000
CVTRLSTG EQU   CVTS01+508                                               01150000
CVT0TC0A EQU   CVTS01+504                                               01151000
CVTGMBR  EQU   CVTS01+500                                               01152000
CVTLFRM  EQU   CVTS01+496                                               01153000
CVTRMBR  EQU   CVTS01+492                                               01154000
CVTVIOP  EQU   CVTS01+488                                               01155000
CVTRV307 EQU   CVTS01+486                                               01156000
CVTRV306 EQU   CVTS01+484                                               01157000
CVTRV305 EQU   CVTS01+482                                               01158000
CVTRV304 EQU   CVTS01+480                                               01159000
CVTRV303 EQU   CVTS01+478                                               01160000
CVTRV302 EQU   CVTS01+476                                               01161000
CVTTRCA  EQU   CVTS01+472                                               01162000
CVTRV297 EQU   CVTRV289                                                 01163000
CVTRV296 EQU   CVTRV289                                                 01164000
CVTRV295 EQU   CVTRV289                                                 01165000
CVTRV294 EQU   CVTRV289                                                 01166000
CVTRV293 EQU   CVTRV289                                                 01167000
CVTRV292 EQU   CVTRV289                                                 01168000
CVTRV291 EQU   CVTRV289                                                 01169000
CVTRV290 EQU   CVTRV289                                                 01170000
CVTRV288 EQU   CVTRV280                                                 01171000
CVTRV287 EQU   CVTRV280                                                 01172000
CVTRV286 EQU   CVTRV280                                                 01173000
CVTRV285 EQU   CVTRV280                                                 01174000
CVTRV284 EQU   CVTRV280                                                 01175000
CVTRV283 EQU   CVTRV280                                                 01176000
CVTRV282 EQU   CVTRV280                                                 01177000
CVTRV281 EQU   CVTRV280                                                 01178000
CVTRV279 EQU   CVTRV271                                                 01179000
CVTRV278 EQU   CVTRV271                                                 01180000
CVTRV277 EQU   CVTRV271                                                 01181000
CVTRV276 EQU   CVTRV271                                                 01182000
CVTRV275 EQU   CVTRV271                                                 01183000
CVTRV274 EQU   CVTRV271                                                 01184000
CVTRV273 EQU   CVTRV271                                                 01185000
CVTRV272 EQU   CVTRV271                                                 01186000
CVTRV270 EQU   CVTRV262                                                 01187000
CVTRV269 EQU   CVTRV262                                                 01188000
CVTRV268 EQU   CVTRV262                                                 01189000
CVTRV267 EQU   CVTRV262                                                 01190000
CVTRV266 EQU   CVTRV262                                                 01191000
CVTRV265 EQU   CVTRV262                                                 01192000
CVTRV264 EQU   CVTRV262                                                 01193000
CVTRV263 EQU   CVTRV262                                                 01194000
CVTVFP   EQU   CVTS01+464                                               01195000
CVTVSI   EQU   CVTS01+460                                               01196000
CVTVPSIB EQU   CVTS01+456                                               01197000
CVTMFACT EQU   CVTMFRTR                                                 01198000
CVTMFCTL EQU   CVTS01+448                                               01199000
CVTPVBP  EQU   CVTS01+444                                               01200000
CVTPWI   EQU   CVTS01+440                                               01201000
CVTRV254 EQU   CVTS01+438                                               01202000
CVTRV253 EQU   CVTS01+436                                               01203000
CVTRV252 EQU   CVTS01+434                                               01204000
CVTRV251 EQU   CVTS01+433                                               01205000
CVTRV250 EQU   CVTS01+432                                               01206000
CVTRV249 EQU   CVTS01+431                                               01207000
CVTRV248 EQU   CVTS01+430                                               01208000
CVTRV247 EQU   CVTS01+429                                               01209000
CVTRV246 EQU   CVTS01+428                                               01210000
CVTRV245 EQU   CVTRV237                                                 01211000
CVTRV244 EQU   CVTRV237                                                 01212000
CVTRV243 EQU   CVTRV237                                                 01213000
CVTRV242 EQU   CVTRV237                                                 01214000
CVTRV241 EQU   CVTRV237                                                 01215000
CVTRV240 EQU   CVTRV237                                                 01216000
CVTRV239 EQU   CVTRV237                                                 01217000
CVTRV238 EQU   CVTRV237                                                 01218000
CVTRV236 EQU   CVTRV228                                                 01219000
CVTRV235 EQU   CVTRV228                                                 01220000
CVTRV234 EQU   CVTRV228                                                 01221000
CVTRV233 EQU   CVTRV228                                                 01222000
CVTRV232 EQU   CVTRV228                                                 01223000
CVTRV231 EQU   CVTRV228                                                 01224000
CVTRV230 EQU   CVTRV228                                                 01225000
CVTRV229 EQU   CVTRV228                                                 01226000
CVTRV227 EQU   CVTRV219                                                 01227000
CVTRV226 EQU   CVTRV219                                                 01228000
CVTRV225 EQU   CVTRV219                                                 01229000
CVTRV224 EQU   CVTRV219                                                 01230000
CVTRV223 EQU   CVTRV219                                                 01231000
CVTRV222 EQU   CVTRV219                                                 01232000
CVTRV221 EQU   CVTRV219                                                 01233000
CVTRV220 EQU   CVTRV219                                                 01234000
CVTRV218 EQU   CVTRV210                                                 01235000
CVTRV217 EQU   CVTRV210                                                 01236000
CVTRV216 EQU   CVTRV210                                                 01237000
CVTRV215 EQU   CVTRV210                                                 01238000
CVTRV214 EQU   CVTRV210                                                 01239000
CVTRV213 EQU   CVTRV210                                                 01240000
CVTRV212 EQU   CVTRV210                                                 01241000
CVTRV211 EQU   CVTRV210                                                 01242000
CVTLCCAT EQU   CVTS01+420                                               01243000
CVTPCCAT EQU   CVTS01+416                                               01244000
CVTIPCRP EQU   CVTS01+412                                               01245000
CVTIPCRI EQU   CVTS01+408                                               01246000
CVTIPCDS EQU   CVTS01+404                                               01247000
CVTAIDVT EQU   CVTS01+400                                               01248000
CVTSSAP  EQU   CVTS01+396                                               01249000
CVTEHCIR EQU   CVTS01+392                                               01250000
CVTEHDEF EQU   CVTS01+388                                               01251000
CVTDAIR  EQU   CVTS01+384                                               01252000
CVTPERFM EQU   CVTS01+380                                               01253000
CVT044R2 EQU   CVTS01+376                                               01254000
CVTFETCH EQU   CVTS01+372                                               01255000
CVTRSTWD EQU   CVTS01+368                                               01256000
CVTSPOST EQU   CVTS01+364                                               01257000
CVTIOBP  EQU   CVTS01+360                                               01258000
CVTASMVT EQU   CVTS01+356                                               01259000
CVTRECRQ EQU   CVTS01+352                                               01260000
CVTWSAC  EQU   CVTS01+348                                               01261000
CVTRV149 EQU   CVTS01+344                                               01262000
CVTWSAL  EQU   CVTS01+340                                               01263000
CVTSPSA  EQU   CVTS01+336                                               01264000
CVTGLMN  EQU   CVTS01+332                                               01265000
CVTVEAC0 EQU   CVTS01+328                                               01266000
CVT062R1 EQU   CVTS01+324                                               01267000
CVTRPOST EQU   CVTS01+320                                               01268000
CVTDQIQE EQU   CVTS01+316                                               01269000
CVTCSD   EQU   CVTS01+312                                               01270000
CVTLKRMA EQU   CVTS01+308                                               01271000
CVTRSPIE EQU   CVTS01+304                                               01272000
CVTRENQ  EQU   CVTS01+300                                               01273000
CVTLQCB  EQU   CVTS01+296                                               01274000
CVTFQCB  EQU   CVTS01+292                                               01275000
CVTQCS01 EQU   CVTS01+288                                               01276000
CVTAPFT  EQU   CVTS01+284                                               01277000
CVTPARRL EQU   CVTS01+280                                               01278000
CVTVWAIT EQU   CVTS01+276                                               01279000
CVTGSPL  EQU   CVTS01+272                                               01280000
CVTLSMQ  EQU   CVTS01+268                                               01281000
CVTGSMQ  EQU   CVTS01+264                                               01282000
CVTEXPRO EQU   CVTS01+260                                               01283000
CVTOPCTP EQU   CVTS01+256                                               01284000
CVTSIC   EQU   CVTS01+252                                               01285000
CVTTPIOS EQU   CVTS01+248                                               01286000
CVTRTMS  EQU   CVTS01+244                                               01287000
CVTSDBF  EQU   CVTS01+240                                               01288000
CVTSCBP  EQU   CVTS01+236                                               01289000
CVTSDMP  EQU   CVTS01+232                                               01290000
CVTSV60  EQU   CVTS01+228                                               01291000
CVTRTMCT EQU   CVTS01+224                                               01292000
CVTASCBL EQU   CVTS01+220                                               01293000
CVTASCBH EQU   CVTS01+216                                               01294000
CVTGDA   EQU   CVTS01+212                                               01295000
CVTASVT  EQU   CVTS01+208                                               01296000
CVTVVMDI EQU   CVTS01+204                                               01297000
CVTAQTOP EQU   CVTS01+200                                               01298000
CVTIOSCS EQU   CVTS01+196                                               01299000
CVTSDRM  EQU   CVTS01+192                                               01300000
CVTOPTE  EQU   CVTS01+188                                               01301000
CVTSTXU  EQU   CVTS01+184                                               01302000
CVTQUIS  EQU   CVTS01+180                                               01303000
CVTPARS  EQU   CVTS01+176                                               01304000
CVTS1EE  EQU   CVTS01+172                                               01305000
CVTFRAS  EQU   CVTS01+168                                               01306000
CVTQSAS  EQU   CVTS01+164                                               01307000
CVTCRAS  EQU   CVTS01+160                                               01308000
CVTCRMN  EQU   CVTS01+156                                               01309000
CVTDELCP EQU   CVTS01+152                                               01310000
CVTFRECL EQU   CVTS01+148                                               01311000
CVTGETCL EQU   CVTS01+144                                               01312000
CVTBLDCP EQU   CVTS01+140                                               01313000
CVTAUTHL EQU   CVTS01+136                                               01314000
CVTSCAN  EQU   CVTS01+132                                               01315000
CVTRV144 EQU   CVTS01+130                                               01316000
CVTMAXMP EQU   CVTS01+128                                               01317000
CVTSTCK  EQU   CVTS01+124                                               01318000
CVTRV139 EQU   CVTS01+123                                               01319000
CVTDSSAC EQU   CVTS01+122                                               01320000
CVTRV513 EQU   CVTS01+121                                               01321000
CVTIOSPL EQU   CVTS01+120                                               01322000
CVTPTGT  EQU   CVTS01+116                                               01323000
CVTCSPIE EQU   CVTS01+112                                               01324000
CVTSMFEX EQU   CVTS01+108                                               01325000
CVTOLT0A EQU   CVTS01+104                                               01326000
CVTSRBRT EQU   CVTS01+100                                               01327000
CVTPUTL  EQU   CVTS01+96                                                01328000
CVTASCRL EQU   CVTS01+92                                                01329000
CVTASCRF EQU   CVTS01+88                                                01330000
CVTRV326 EQU   CVTS01+84                                                01331000
CVTRV325 EQU   CVTS01+80                                                01332000
CVTRV324 EQU   CVTS01+76                                                01333000
CVT0VL01 EQU   CVTS01+72                                                01334000
CVTSHRVM EQU   CVTS01+68                                                01335000
CVTRV332 EQU   CVTS01+64                                                01336000
CVTTAS   EQU   CVTS01+60                                                01337000
CVTRSCN  EQU   CVTS01+56                                                01338000
CVTTRAC2 EQU   CVTS01+54                                                01339000
CVTTRACE EQU   CVTS01+52                                                01340000
CVTAPG   EQU   CVTS01+51                                                01341000
CVTSDTRC EQU   CVTCTLFG                                                 01342000
CVTGTRCE EQU   CVTCTLFG                                                 01343000
CVTNOMP  EQU   CVTCTLFG                                                 01344000
CVTRSV79 EQU   CVTCTLFG                                                 01345000
CVTDSTAT EQU   CVTCTLFG                                                 01346000
CVTRSV78 EQU   CVTCTLFG                                                 01347000
CVTRV333 EQU   CVTCTLFG                                                 01348000
CVTRV323 EQU   CVTCTLFG                                                 01349000
CVTSPVLK EQU   CVTS01+49                                                01350000
CVTRSV77 EQU   CVTS01+48                                                01351000
CVTRV331 EQU   CVTS01+44                                                01352000
CVTRV330 EQU   CVTS01+40                                                01353000
CVTRV329 EQU   CVTS01+36                                                01354000
CVTRV328 EQU   CVTS01+32                                                01355000
CVTRV322 EQU   CVTS01+28                                                01356000
CVTSLID  EQU   CVTSLIDA+1                                               01357000
CVTSYLK  EQU   CVTSLIDA                                                 01358000
CVTRV321 EQU   CVTS01+20                                                01359000
CVTRV320 EQU   CVTS01+16                                                01360000
CVTLPDIR EQU   CVTLPDIA+1                                               01361000
CVTRSV69 EQU   CVTDIRST                                                 01362000
CVTRSV68 EQU   CVTDIRST                                                 01363000
CVTRSV67 EQU   CVTDIRST                                                 01364000
CVTRSV66 EQU   CVTDIRST                                                 01365000
CVTRSV65 EQU   CVTDIRST                                                 01366000
CVTRSV64 EQU   CVTDIRST                                                 01367000
CVTRSV63 EQU   CVTDIRST                                                 01368000
CVTDICOM EQU   CVTDIRST                                                 01369000
CVTPVTP  EQU   CVTS01+8                                                 01370000
CVTLPDSR EQU   CVTS01+4                                                 01371000
CVTGETL  EQU   CVTS01                                                   01372000
SAVTYPE  EQU   SAVMASKE+4                                               01373000
SAVNOBIT EQU   SAVMASKE                                                 01374000
DEVNOBIT EQU   DEVMASKE                                                 01375000
@NM00011 EQU   DEVMASKT+2                                               01376000
UCBERADR EQU   UCBUCS+12                                                01377000
UCBFCBID EQU   UCBUCS+8                                                 01378000
UCBERCNT EQU   UCBUCS+7                                                 01379000
UCBRSV51 EQU   UCBUCS+6                                                 01380000
UCBRSV50 EQU   UCBFCBOP                                                 01381000
UCBRSV49 EQU   UCBFCBOP                                                 01382000
UCBRSV48 EQU   UCBFCBOP                                                 01383000
UCBRSV47 EQU   UCBFCBOP                                                 01384000
UCBRSV46 EQU   UCBFCBOP                                                 01385000
UCBRSV45 EQU   UCBFCBOP                                                 01386000
UCBRSV44 EQU   UCBFCBOP                                                 01387000
UCBFCBO1 EQU   UCBFCBOP                                                 01388000
UCBUCSPE EQU   UCBUCSOP                                                 01389000
UCBRSV43 EQU   UCBUCSOP                                                 01390000
UCBRSV42 EQU   UCBUCSOP                                                 01391000
UCBRSV41 EQU   UCBUCSOP                                                 01392000
UCBRSV40 EQU   UCBUCSOP                                                 01393000
UCBRSV39 EQU   UCBUCSOP                                                 01394000
UCBUCSO2 EQU   UCBUCSOP                                                 01395000
UCBUCSO1 EQU   UCBUCSOP                                                 01396000
UCBUCSID EQU   UCBUCS                                                   01397000
UCBMDRBA EQU   UCBMDRBF+1                                               01398000
UCBRV075 EQU   UCBMDRBF                                                 01399000
UCBRV074 EQU   UCB3800X+32                                              01400000
UCBIMAGE EQU   UCB3800X+28                                              01401000
UCBFCBNM EQU   UCB3800X+24                                              01402000
UCBCHAR4 EQU   UCB3800X+20                                              01403000
UCBCHAR3 EQU   UCB3800X+16                                              01404000
UCBCHAR2 EQU   UCB3800X+12                                              01405000
UCBCHAR1 EQU   UCB3800X+8                                               01406000
UCBCGMID EQU   UCB3800X+4                                               01407000
UCBBRSTA EQU   UCBACTIV                                                 01408000
UCBRV063 EQU   UCBACTIV                                                 01409000
UCBRV062 EQU   UCBACTIV                                                 01410000
UCBRV061 EQU   UCBACTIV                                                 01411000
UCBRV060 EQU   UCBACTIV                                                 01412000
UCBRV059 EQU   UCBACTIV                                                 01413000
UCBRV058 EQU   UCBACTIV                                                 01414000
UCBRV057 EQU   UCBACTIV                                                 01415000
UCBRV050 EQU   UCB3800X+2                                               01416000
UCBCGMNO EQU   UCB3800X+1                                               01417000
UCBRV083 EQU   UCBOPTNS                                                 01418000
UCBBRSTR EQU   UCBOPTNS                                                 01419000
UCBRV056 EQU   UCBOPTNS                                                 01420000
UCBRV055 EQU   UCBOPTNS                                                 01421000
UCBRV054 EQU   UCBOPTNS                                                 01422000
UCBRV053 EQU   UCBOPTNS                                                 01423000
UCBRV052 EQU   UCBOPTNS                                                 01424000
UCBRV051 EQU   UCBOPTNS                                                 01425000
UCBRV073 EQU   UCB3540X+7                                               01426000
UCBRV072 EQU   UCBDKBYT                                                 01427000
UCBRV071 EQU   UCBDKBYT                                                 01428000
UCBRV070 EQU   UCBDKBYT                                                 01429000
UCBRV069 EQU   UCBDKBYT                                                 01430000
UCBRV068 EQU   UCBDKBYT                                                 01431000
UCBRV067 EQU   UCBDKBYT                                                 01432000
UCBVLVER EQU   UCBDKBYT                                                 01433000
UCBDKAMX EQU   UCBDKBYT                                                 01434000
UCBVLSER EQU   UCB3540X                                                 01435000
UCBRDATA EQU   UCBOCR+4                                                 01436000
UCBFRID  EQU   UCBOCR                                                   01437000
UCBCLN   EQU   UCBMT+14                                                 01438000
UCBERG   EQU   UCBMT+12                                                 01439000
UCBMS    EQU   UCBMT+11                                                 01440000
UCBNB    EQU   UCBMT+10                                                 01441000
UCBPW    EQU   UCBMT+9                                                  01442000
UCBPR    EQU   UCBMT+8                                                  01443000
UCBSIO   EQU   UCBMT+6                                                  01444000
UCBTW    EQU   UCBMT+5                                                  01445000
UCBTR    EQU   UCBMT+4                                                  01446000
UCBTWT   EQU   UCBMT+3                                                  01447000
UCBTRT   EQU   UCBMT+2                                                  01448000
UCBCTD   EQU   UCBMT                                                    01449000
UCBWTOID EQU   UCBCMEXT+17                                              01450000
UCBMIHTI EQU   UCBCMEXT+16                                              01451000
UCBASID  EQU   UCBCMEXT+14                                              01452000
UCBMFCNT EQU   UCBCMEXT+12                                              01453000
UCBPMSK  EQU   UCBCMEXT+10                                              01454000
UCBCCWOF EQU   UCBCMEXT+8                                               01455000
UCBRV041 EQU   UCBCMEXT+6                                               01456000
UCBRV036 EQU   UCBFLP1                                                  01457000
UCBRV035 EQU   UCBFLP1                                                  01458000
UCBERLOG EQU   UCBFLP1                                                  01459000
UCBRV033 EQU   UCBFLP1                                                  01460000
UCBRV032 EQU   UCBFLP1                                                  01461000
UCBRV031 EQU   UCBFLP1                                                  01462000
UCBSHRUP EQU   UCBFLP1                                                  01463000
UCBNSRCH EQU   UCBFLP1                                                  01464000
UCBSNSCT EQU   UCBCMEXT+4                                               01465000
UCBHPDV  EQU   @NM00008                                                 01466000
UCBHALI  EQU   @NM00008                                                 01467000
UCBRSV09 EQU   @NM00008                                                 01468000
UCBRSV08 EQU   @NM00008                                                 01469000
UCBRSV07 EQU   @NM00008                                                 01470000
UCBRSV06 EQU   @NM00008                                                 01471000
UCBRSV05 EQU   @NM00008                                                 01472000
UCBRSV04 EQU   @NM00008                                                 01473000
UCBDTI   EQU   UCBCMEXT+2                                               01474000
UCBSTI   EQU   UCBCMEXT+1                                               01475000
UCBETI   EQU   UCBCMEXT                                                 01476000
UCBEXTP  EQU   UCBEXTPT+1                                               01477000
UCBDDRSW EQU   UCBFLC                                                   01478000
UCBTICBT EQU   UCBFLC                                                   01479000
UCBIVRR  EQU   UCBFLC                                                   01480000
UCBIVRS  EQU   UCBFLC                                                   01481000
UCBITF   EQU   UCBFLC                                                   01482000
UCBUDE   EQU   UCBFLC                                                   01483000
UCBWAA   EQU   UCBFLC                                                   01484000
UCBATTP  EQU   UCBFLC                                                   01485000
UCBUNTYP EQU   UCBTBYT4                                                 01486000
UCBRSV11 EQU   UCBDVCLS                                                 01487000
UCBRSV10 EQU   UCBDVCLS                                                 01488000
UCB3CHAR EQU   UCBDVCLS                                                 01489000
UCB3UREC EQU   UCBDVCLS                                                 01490000
UCB3DISP EQU   UCBDVCLS                                                 01491000
UCB3DACC EQU   UCBDVCLS                                                 01492000
UCB3COMM EQU   UCBDVCLS                                                 01493000
UCB3TAPE EQU   UCBDVCLS                                                 01494000
UCBDVPWR EQU   UCB2OPT7                                                 01495000
UCBVLPWR EQU   UCB2OPT6                                                 01496000
UCB2OPT5 EQU   UCBTBYT2                                                 01497000
UCBRVDEV EQU   UCBRWTAU                                                 01498000
UCBRPS   EQU   UCBDUDN2                                                 01499000
UCBRR    EQU   UCBDUDN1                                                 01500000
UCB2OPT1 EQU   UCBTBYT2                                                 01501000
UCB2OPT0 EQU   UCBTBYT2                                                 01502000
UCB1FEA7 EQU   UCBTBYT1                                                 01503000
UCBD6250 EQU   UCB1FEA6                                                 01504000
UCBD1600 EQU   UCB1FEA5                                                 01505000
UCB1FEA4 EQU   UCBTBYT1                                                 01506000
UCB1FEA3 EQU   UCBTBYT1                                                 01507000
UCB1FEA2 EQU   UCBTBYT1                                                 01508000
UCB1FEA1 EQU   UCBTBYT1                                                 01509000
UCB1FEA0 EQU   UCBTBYT1                                                 01510000
UCBNAME  EQU   UCBOB+13                                                 01511000
UCBRV029 EQU   UCBWGT                                                   01512000
UCBVHRSN EQU   UCBWGT                                                   01513000
UCBVORSN EQU   UCBWGT                                                   01514000
UCBMTPXP EQU   UCBWGT                                                   01515000
UCBREW   EQU   UCBWGT                                                   01516000
UCBPUB   EQU   UCBWGT                                                   01517000
UCBOUT   EQU   UCBWGT                                                   01518000
UCBIN    EQU   UCBWGT                                                   01519000
UCBCPU   EQU   UCBOB+11                                                 01520000
UCBLCI   EQU   UCBOB+10                                                 01521000
UCBCNT   EQU   UCBOB+9                                                  01522000
UCBRV017 EQU   UCBCHM1                                                  01523000
UCBRV016 EQU   UCBCHM1                                                  01524000
UCBRV015 EQU   UCBCHM1                                                  01525000
UCBRV014 EQU   UCBCHM1                                                  01526000
UCBSPB   EQU   UCBPTH1                                                  01527000
UCBPPB   EQU   UCBPTH1                                                  01528000
UCBSPA   EQU   UCBPTH0                                                  01529000
UCBPPA   EQU   UCBPTH0                                                  01530000
UCBSIGP  EQU   UCBFLB                                                   01531000
UCBVALPH EQU   UCBFLB                                                   01532000
UCBCRHSN EQU   UCBFLB                                                   01533000
UCBCRHRV EQU   UCBFLB                                                   01534000
UCBRESVH EQU   UCBFLB                                                   01535000
UCBSPST  EQU   UCBFLB                                                   01536000
UCBASNS  EQU   UCBFLB                                                   01537000
UCBIORST EQU   UCBFLB                                                   01538000
UCBQISCE EQU   UCBFL1                                                   01539000
UCBACTV  EQU   UCBFL1                                                   01540000
UCBSAP   EQU   UCBFL1                                                   01541000
UCBNOTRC EQU   UCBCUB                                                   01542000
UCBPSNS  EQU   UCBFL1                                                   01543000
UCBUSING EQU   UCBPST                                                   01544000
UCBNOTRD EQU   UCBNRY                                                   01545000
UCBBUSYD EQU   UCBBSY                                                   01546000
UCBUA    EQU   UCBCHAN+1                                                01547000
UCBCHA   EQU   UCBCHAN                                                  01548000
UCBDADI  EQU   UCBSTAT                                                  01549000
UCBSYSR  EQU   UCBSTAT                                                  01550000
UCBPRES  EQU   UCBSTAT                                                  01551000
UCBALOC  EQU   UCBSTAT                                                  01552000
UCBUNLD  EQU   UCBSTAT                                                  01553000
UCBRESV  EQU   UCBSTAT                                                  01554000
UCBCHGS  EQU   UCBSTAT                                                  01555000
UCBONLI  EQU   UCBSTAT                                                  01556000
UCBID    EQU   UCBOB+2                                                  01557000
UCBALTPH EQU   UCBFL5                                                   01558000
UCBALTCU EQU   UCBFL5                                                   01559000
UCBNALOC EQU   UCBFL5                                                   01560000
UCBENVRD EQU   UCBFL5                                                   01561000
UCBVSDR  EQU   UCBFL5                                                   01562000
UCBSASK  EQU   UCBFL5                                                   01563000
UCBAMV   EQU   UCBAF                                                    01564000
UCBDCC   EQU   UCBFL5                                                   01565000
UCBMONT  EQU   UCBJBNR                                                  01566000
UCBRV011 EQU   UCBJBNR                                                  01567000
UCBRSV02 EQU   UCBJBNR                                                  01568000
UCBOLDSM EQU   UCBJBNR                                                  01569000
UCBRV003 EQU   UCBJBNR                                                  01570000
UCBDUC   EQU   UCBJBNR                                                  01571000
UCBJES3  EQU   UCBJBNR                                                  01572000
UCBVRDEV EQU   UCBJBNR                                                  01573000
UCBCMSEG EQU   UCBOB                                                    01574000
UCBPFXND EQU   UCB+512                                                  01575000
UCBIOQ   EQU   UCB+508                                                  01576000
UCBLOCK  EQU   UCB+504                                                  01577000
UCBPXST  EQU   UCB+504                                                  01578000
@NM00005 EQU   UCB                                                      01579000
CVTLEVL  EQU   CVTRELNO+2                                               01580000
CVTNUMB  EQU   CVTRELNO                                                 01581000
CVTMDL   EQU   CVTFIX+250                                               01582000
@NM00004 EQU   CVTFIX+248                                               01583000
@NM00003 EQU   CVTFIX                                                   01584000
CVTRV482 EQU   CVTXTNT2+128                                             01585000
CVTRV481 EQU   CVTXTNT2+124                                             01586000
CVTRV480 EQU   CVTXTNT2+120                                             01587000
CVTRV479 EQU   CVTXTNT2+118                                             01588000
CVTRV478 EQU   CVTXTNT2+117                                             01589000
CVTRV477 EQU   CVTXTNT2+116                                             01590000
CVTRV476 EQU   CVTXTNT2+115                                             01591000
CVTRV475 EQU   CVTXTNT2+114                                             01592000
CVTRV474 EQU   CVTRV466                                                 01593000
CVTRV473 EQU   CVTRV466                                                 01594000
CVTRV472 EQU   CVTRV466                                                 01595000
CVTRV471 EQU   CVTRV466                                                 01596000
CVTRV470 EQU   CVTRV466                                                 01597000
CVTRV469 EQU   CVTRV466                                                 01598000
CVTRV468 EQU   CVTRV466                                                 01599000
CVTRV467 EQU   CVTRV466                                                 01600000
CVTRV465 EQU   CVTRV457                                                 01601000
CVTRV464 EQU   CVTRV457                                                 01602000
CVTRV463 EQU   CVTRV457                                                 01603000
CVTRV462 EQU   CVTRV457                                                 01604000
CVTRV461 EQU   CVTRV457                                                 01605000
CVTRV460 EQU   CVTRV457                                                 01606000
CVTRV459 EQU   CVTRV457                                                 01607000
CVTRV458 EQU   CVTRV457                                                 01608000
CVTRV456 EQU   CVTXTNT2+108                                             01609000
CVTRV455 EQU   CVTXTNT2+104                                             01610000
CVTRV454 EQU   CVTXTNT2+100                                             01611000
CVTRV453 EQU   CVTXTNT2+96                                              01612000
CVTRV452 EQU   CVTXTNT2+94                                              01613000
CVTRV451 EQU   CVTXTNT2+92                                              01614000
CVTRV450 EQU   CVTXTNT2+90                                              01615000
CVTRV449 EQU   CVTXTNT2+88                                              01616000
CVTRV448 EQU   CVTXTNT2+87                                              01617000
CVTRV447 EQU   CVTXTNT2+86                                              01618000
CVTRV446 EQU   CVTRV438                                                 01619000
CVTRV445 EQU   CVTRV438                                                 01620000
CVTRV444 EQU   CVTRV438                                                 01621000
CVTRV443 EQU   CVTRV438                                                 01622000
CVTRV442 EQU   CVTRV438                                                 01623000
CVTRV441 EQU   CVTRV438                                                 01624000
CVTRV440 EQU   CVTRV438                                                 01625000
CVTRV439 EQU   CVTRV438                                                 01626000
CVTRV437 EQU   CVTRV429                                                 01627000
CVTRV436 EQU   CVTRV429                                                 01628000
CVTRV435 EQU   CVTRV429                                                 01629000
CVTRV434 EQU   CVTRV429                                                 01630000
CVTRV433 EQU   CVTRV429                                                 01631000
CVTRV432 EQU   CVTRV429                                                 01632000
CVTRV431 EQU   CVTRV429                                                 01633000
CVTRV430 EQU   CVTRV429                                                 01634000
CVTRV428 EQU   CVTXTNT2+80                                              01635000
CVTRV427 EQU   CVTXTNT2+76                                              01636000
CVTRV426 EQU   CVTXTNT2+72                                              01637000
CVTRV425 EQU   CVTXTNT2+68                                              01638000
CVTATACT EQU   CVTATCVT                                                 01639000
CVTRV423 EQU   CVTXTNT2+62                                              01640000
CVTRV422 EQU   CVTXTNT2+60                                              01641000
CVTRV421 EQU   CVTXTNT2+58                                              01642000
CVTRV420 EQU   CVTXTNT2+56                                              01643000
CVTRV419 EQU   CVTXTNT2+55                                              01644000
CVTRV418 EQU   CVTXTNT2+54                                              01645000
CVTRV417 EQU   CVTRV409                                                 01646000
CVTRV416 EQU   CVTRV409                                                 01647000
CVTRV415 EQU   CVTRV409                                                 01648000
CVTRV414 EQU   CVTRV409                                                 01649000
CVTRV413 EQU   CVTRV409                                                 01650000
CVTRV412 EQU   CVTRV409                                                 01651000
CVTRV411 EQU   CVTRV409                                                 01652000
CVTRV410 EQU   CVTRV409                                                 01653000
CVTRV408 EQU   CVTRV400                                                 01654000
CVTRV407 EQU   CVTRV400                                                 01655000
CVTRV406 EQU   CVTRV400                                                 01656000
CVTRV405 EQU   CVTRV400                                                 01657000
CVTRV404 EQU   CVTRV400                                                 01658000
CVTRV403 EQU   CVTRV400                                                 01659000
CVTRV402 EQU   CVTRV400                                                 01660000
CVTRV401 EQU   CVTRV400                                                 01661000
CVTICB   EQU   CVTXTNT2+48                                              01662000
CVTSKTA  EQU   CVTXTNT2+44                                              01663000
CVTRSV99 EQU   CVTXTNT2+40                                              01664000
CVTRSV98 EQU   CVTXTNT2+36                                              01665000
CVTRSV97 EQU   CVTXTNT2+34                                              01666000
CVTRSV96 EQU   CVTXTNT2+32                                              01667000
CVTOLTEP EQU   CVTXTNT2+28                                              01668000
CVTQIDA  EQU   CVTQID+1                                                 01669000
CVTRSV95 EQU   CVTQID                                                   01670000
CVTRSV94 EQU   CVTXTNT2+20                                              01671000
CVTRSV93 EQU   CVTXTNT2+16                                              01672000
CVTRSV92 EQU   CVTXTNT2+12                                              01673000
CVTDEBVR EQU   CVTXTNT2+8                                               01674000
CVTRSV91 EQU   CVTXTNT2+6                                               01675000
CVTRSV9H EQU   CVTFLGBT                                                 01676000
CVTRSV9G EQU   CVTFLGBT                                                 01677000
CVTRSV9F EQU   CVTFLGBT                                                 01678000
CVTRSV9E EQU   CVTFLGBT                                                 01679000
CVTRSV9D EQU   CVTFLGBT                                                 01680000
CVTRSV9C EQU   CVTFLGBT                                                 01681000
CVTVME   EQU   CVTFLGBT                                                 01682000
CVTNPE   EQU   CVTFLGBT                                                 01683000
CVTNUCLS EQU   CVTXTNT2+4                                               01684000
CVTDSSVA EQU   CVTDSSV+1                                                01685000
CVTRSV89 EQU   CVTDSSV                                                  01686000
CVTRSV88 EQU   CVTXTNT1+8                                               01687000
CVTRSV87 EQU   CVTXTNT1+4                                               01688000
CVTFACHN EQU   CVTXTNT1                                                 01689000
CVTRV488 EQU   CVTMAP+412                                               01690000
CVTRV487 EQU   CVTMAP+408                                               01691000
CVTRV486 EQU   CVTMAP+404                                               01692000
CVTRV485 EQU   CVTMAP+400                                               01693000
CVTACTAP EQU   CVTMAP+396                                               01694000
CVTAUTH  EQU   CVTMAP+392                                               01695000
CVTATMCA EQU   CVTATMCT+1                                               01696000
CVTATMST EQU   CVTATMCT                                                 01697000
CVTRSV61 EQU   CVTMAP+384                                               01698000
CVTVOLT1 EQU   CVTVOLM1+1                                               01699000
CVTVOLI1 EQU   CVTVOLF1                                                 01700000
CVTSTOA  EQU   CVTMAP+376                                               01701000
CVTRSV58 EQU   CVTMAP+374                                               01702000
CVTRSV57 EQU   CVTMAP+372                                               01703000
CVTDDCE  EQU   CVTMAP+368                                               01704000
CVTPNWFR EQU   CVTMAP+364                                               01705000
CVTSMF   EQU   CVTMAP+360                                               01706000
CVTSULK  EQU   CVTMAP+358                                               01707000
CVTSLKO  EQU   CVTSYSK                                                  01708000
CVTSLKP  EQU   CVTSYSK                                                  01709000
CVTSLKQ  EQU   CVTSYSK                                                  01710000
CVTSLKR  EQU   CVTSYSK                                                  01711000
CVTRSV56 EQU   CVTSYSK                                                  01712000
CVTRSV55 EQU   CVTSYSK                                                  01713000
CVTRSV54 EQU   CVTSYSK                                                  01714000
CVTRSV53 EQU   CVTSYSK                                                  01715000
CVTRSV52 EQU   CVTA1F1                                                  01716000
CVTRSV51 EQU   CVTA1F1                                                  01717000
CVTRSV50 EQU   CVTA1F1                                                  01718000
CVTRSV49 EQU   CVTA1F1                                                  01719000
CVTRSV48 EQU   CVTA1F1                                                  01720000
CVTRSV47 EQU   CVTA1F1                                                  01721000
CVTSRSW  EQU   CVTA1F1                                                  01722000
CVTPFSW  EQU   CVTA1F1                                                  01723000
CVTPCVT  EQU   CVTMAP+352                                               01724000
CVTRSV46 EQU   CVTMAP+344                                               01725000
CVTRSV45 EQU   CVTMAP+340                                               01726000
CVTRSV44 EQU   CVTMAP+338                                               01727000
CVTRSV43 EQU   CVTMAP+336                                               01728000
CVTHJESA EQU   CVTHJES+1                                                01729000
CVTRSV42 EQU   CVTHJES                                                  01730000
CVTEXT2A EQU   CVTEXT2+1                                                01731000
CVTRSV41 EQU   CVTEXT2                                                  01732000
CVTAPFA  EQU   CVTAPF+1                                                 01733000
CVTRSV40 EQU   CVTAPF                                                   01734000
CVTRV518 EQU   CVTINTLA                                                 01735000
CVTRV517 EQU   CVTERPV                                                  01736000
CVTEORM  EQU   CVTMAP+312                                               01737000
CVTMCHPR EQU   CVTMAP+308                                               01738000
CVTTZ    EQU   CVTMAP+304                                               01739000
CVTJEPS  EQU   CVTMAP+300                                               01740000
CVTJESCT EQU   CVTMAP+296                                               01741000
CVTMODE  EQU   CVTMAP+292                                               01742000
CVTPTRV  EQU   CVTMAP+288                                               01743000
CVTREAL  EQU   CVTMAP+284                                               01744000
CVTRSV39 EQU   CVTMAP+280                                               01745000
CVTRSV38 EQU   CVTMAP+276                                               01746000
CVTDMSRA EQU   CVTDMSR+1                                                01747000
CVTRV634 EQU   CVTDMSRF                                                 01748000
CVTRV633 EQU   CVTDMSRF                                                 01749000
CVTRV632 EQU   CVTDMSRF                                                 01750000
CVTRV631 EQU   CVTDMSRF                                                 01751000
CVTRV630 EQU   CVTDMSRF                                                 01752000
CVTRV629 EQU   CVTDMSRF                                                 01753000
CVTUDUMP EQU   CVTDMSRF                                                 01754000
CVTSDUMP EQU   CVTDMSRF                                                 01755000
CVTQMSGA EQU   CVTQMSG+1                                                01756000
CVTRSV36 EQU   CVTQMSG                                                  01757000
CVTAMFF  EQU   CVTMAP+264                                               01758000
CVTPURGA EQU   CVTPURG+1                                                01759000
CVTRSV35 EQU   CVTPURG                                                  01760000
CVTCBSP  EQU   CVTMAP+256                                               01761000
CVTATERA EQU   CVTATER+1                                                01762000
CVTSYST  EQU   CVTATER                                                  01763000
CVTVOLT2 EQU   CVTTAT                                                   01764000
CVTVOLI2 EQU   CVTVOLF2                                                 01765000
CVTAQAVB EQU   CVTAQAVT+1                                               01766000
CVTRSV34 EQU   CVTTCMFG                                                 01767000
CVTRSV33 EQU   CVTTCMFG                                                 01768000
CVTRSV32 EQU   CVTTCMFG                                                 01769000
CVTRSV31 EQU   CVTTCMFG                                                 01770000
CVTRSV30 EQU   CVTTCMFG                                                 01771000
CVTRSV29 EQU   CVTTCMFG                                                 01772000
CVTRSV28 EQU   CVTTCMFG                                                 01773000
CVTTCRDY EQU   CVTTCMFG                                                 01774000
CVTGTFA  EQU   CVTGTF+1                                                 01775000
CVTRSV27 EQU   CVTGTFST                                                 01776000
CVTRNIO  EQU   CVTGTFST                                                 01777000
CVTUSR   EQU   CVTGTFST                                                 01778000
CVTRV318 EQU   CVTFORM                                                  01779000
CVTRV317 EQU   CVTTMODE                                                 01780000
CVTRV316 EQU   CVTSTATE                                                 01781000
CVTRV315 EQU   CVTGTFS                                                  01782000
CVTGTFAV EQU   CVTGTFS                                                  01783000
CVT0SCR1 EQU   CVTMAP+232                                               01784000
CVTRV515 EQU   CVTMAP+228                                               01785000
CVTRMS   EQU   CVTMAP+224                                               01786000
CVTPATCH EQU   CVTMAP+220                                               01787000
CVTTSCE  EQU   CVTMAP+216                                               01788000
CVTLNKSC EQU   CVTMAP+214                                               01789000
CVTQABST EQU   CVTMAP+212                                               01790000
CVTMDLDS EQU   CVTMAP+208                                               01791000
CVTUSER  EQU   CVTMAP+204                                               01792000
CVTABEND EQU   CVTMAP+200                                               01793000
CVTSMCA  EQU   CVTMAP+196                                               01794000
CVTRSV18 EQU   CVTMAP+192                                               01795000
CVTQLPAQ EQU   CVTMAP+188                                               01796000
CVTQCDSR EQU   CVTMAP+184                                               01797000
CVTRSV17 EQU   CVTOPTB                                                  01798000
CVTRSV16 EQU   CVTOPTB                                                  01799000
CVTFP    EQU   CVTOPTB                                                  01800000
CVTAPTHR EQU   CVTOPTB                                                  01801000
CVTNLOG  EQU   CVTOPTB                                                  01802000
CVTTOD   EQU   CVTOPTB                                                  01803000
CVTCTIMS EQU   CVTOPTB                                                  01804000
CVTPROT  EQU   CVTOPTB                                                  01805000
CVTXPFP  EQU   CVTOPTA                                                  01806000
CVTASCII EQU   CVTOPTA                                                  01807000
CVTRSV13 EQU   CVTOPTA                                                  01808000
CVTRSV12 EQU   CVTOPTA                                                  01809000
CVTNIP   EQU   CVTOPTA                                                  01810000
CVTDDR   EQU   CVTOPTA                                                  01811000
CVTAPR   EQU   CVTOPTA                                                  01812000
CVTCCH   EQU   CVTOPTA                                                  01813000
CVTSNCTR EQU   CVTMAP+180                                               01814000
CVTQMWR  EQU   CVTMAP+176                                               01815000
CVTQOCR  EQU   CVTMAP+172                                               01816000
CVT1EF00 EQU   CVTMAP+168                                               01817000
CVTMZ00  EQU   CVTMAP+164                                               01818000
CVTHEAD  EQU   CVTMAP+160                                               01819000
CVTRSV11 EQU   CVTMAP+156                                               01820000
CVT0PT01 EQU   CVTMAP+152                                               01821000
CVTMSER  EQU   CVTMAP+148                                               01822000
CVTRV516 EQU   CVTIERLC                                                 01823000
CVTILCH  EQU   CVTMAP+140                                               01824000
CVT0DS   EQU   CVTMAP+136                                               01825000
CVTFBOSV EQU   CVTMAP+132                                               01826000
CVTNUCB  EQU   CVTMAP+128                                               01827000
CVTIXAVL EQU   CVTMAP+124                                               01828000
CVTIOQET EQU   CVTMAP+120                                               01829000
CVTDCBA  EQU   CVTMAP+117                                               01830000
CVTMVS2  EQU   CVTDCB                                                   01831000
CVT6DAT  EQU   CVTDCB                                                   01832000
CVT4MPS  EQU   CVTDCB                                                   01833000
CVTRSV09 EQU   CVTDCB                                                   01834000
CVT4MS1  EQU   CVTDCB                                                   01835000
CVT2SPS  EQU   CVTDCB                                                   01836000
CVT1SSS  EQU   CVTDCB                                                   01837000
CVTRSV08 EQU   CVTDCB                                                   01838000
CVTSTB   EQU   CVTMAP+112                                               01839000
CVTQTD00 EQU   CVTMAP+108                                               01840000
CVTQTE00 EQU   CVTMAP+104                                               01841000
CVTCUCB  EQU   CVTMAP+100                                               01842000
CVTSJQ   EQU   CVTMAP+96                                                01843000
CVTPBLDL EQU   CVTMAP+92                                                01844000
CVTTPC   EQU   CVTMAP+88                                                01845000
CVTSVDCB EQU   CVTMAP+84                                                01846000
CVTBRET  EQU   CVTMAP+82                                                01847000
CVTEXIT  EQU   CVTMAP+80                                                01848000
CVT0FN00 EQU   CVTMAP+76                                                01849000
CVTDARA  EQU   CVTDAR+1                                                 01850000
CVTRSV07 EQU   CVTFLGS1                                                 01851000
CVTRSV06 EQU   CVTFLGS1                                                 01852000
CVTRSV05 EQU   CVTFLGS1                                                 01853000
CVTRSV04 EQU   CVTFLGS1                                                 01854000
CVTRSV03 EQU   CVTFLGS1                                                 01855000
CVTRSV02 EQU   CVTFLGS1                                                 01856000
CVTRSV01 EQU   CVTFLGS1                                                 01857000
CVTDMPLK EQU   CVTFLGS1                                                 01858000
CVTXITP  EQU   CVTMAP+68                                                01859000
CVTZDTAB EQU   CVTMAP+64                                                01860000
CVTMSLT  EQU   CVTMAP+60                                                01861000
CVTDATE  EQU   CVTMAP+56                                                01862000
CVTBTERM EQU   CVTMAP+52                                                01863000
CVTSYSAD EQU   CVTMAP+48                                                01864000
CVTXTLER EQU   CVTMAP+44                                                01865000
CVTILK1  EQU   CVTMAP+36                                                01866000
CVTPRLTV EQU   CVTMAP+32                                                01867000
CVTPCNVT EQU   CVTMAP+28                                                01868000
CVT0VL00 EQU   CVTMAP+24                                                01869000
CVTXAPG  EQU   CVTMAP+20                                                01870000
CVTBUF   EQU   CVTMAP+16                                                01871000
CVTJOB   EQU   CVTMAP+12                                                01872000
CVTLINK  EQU   CVTMAP+8                                                 01873000
CVT0EF00 EQU   CVTMAP+4                                                 01874000
CVTTCBP  EQU   CVTMAP                                                   01875000
CVT      EQU   CVTMAP                                                   01876000
VVIUNUSD EQU   VVICB+116                                                01877000
VVINUSDC EQU   VVICB+112                                                01878000
VVITPFCH EQU   VVICB+108                                                01879000
VVIVBSTF EQU   VVICB+100                                                01880000
VVISSOBA EQU   VVICB+96                                                 01881000
VVIVSCRA EQU   VVICB+92                                                 01882000
VVISTPTB EQU   VVICB+88                                                 01883000
VVIJUCB  EQU   VVICB+80                                                 01884000
VVIIUCB  EQU   VVICB+76                                                 01885000
VVIRES6  EQU   VVICB+72                                                 01886000
VVIRES5  EQU   VVICB+68                                                 01887000
VVIRES4  EQU   VVICB+64                                                 01888000
VVIVJL   EQU   VVICB+56                                                 01889000
VVIVRR   EQU   VVICB+52                                                 01890000
VVIQLSPL EQU   VVICB+48                                                 01891000
VVIQRPL2 EQU   VVICB+44                                                 01892000
VVIQRPL1 EQU   VVICB+40                                                 01893000
VVIRES3  EQU   VVICB+36                                                 01894000
VVIVQMP  EQU   VVICB+32                                                 01895000
VVIECB1  EQU   VVICB+28                                                 01896000
VVICATAD EQU   VVICB+24                                                 01897000
VVIDCBAD EQU   VVICB+20                                                 01898000
VVIACBAD EQU   VVICB+16                                                 01899000
VVIFLG7  EQU   VVIFLGA                                                  01900000
VVIFLG6  EQU   VVIFLGA                                                  01901000
VVIFLG5  EQU   VVIFLGA                                                  01902000
VVIFLG4  EQU   VVIFLGA                                                  01903000
VVIFLG3  EQU   VVIFLGA                                                  01904000
VVIFLG2  EQU   VVIFLGA                                                  01905000
VVIFLG1  EQU   VVIFLGA                                                  01906000
VVIFLG0  EQU   VVIFLGA                                                  01907000
VVIALCON EQU   VVICB+14                                                 01908000
VVICPUID EQU   VVICB+12                                                 01909000
VVIUCAT  EQU   VVICB+4                                                  01910000
VVICID   EQU   VVICB                                                    01911000
@NM00002 EQU   UNIFLAGS                                                 01912000
@NM00001 EQU   UNITP+10                                                 01913000
*                                      END UNREFERENCED COMPONENTS      01914000
@RC00114 EQU   @EL00003                                                 01915000
@RF00128 EQU   @EL00004                                                 01916000
@RF00142 EQU   @EL00005                                                 01917000
@RC00158 EQU   @EL00006                                                 01918000
BITON    EQU   @EL00006                                                 01919000
@RC00118 EQU   @RC00114                                                 01920000
@ENDDATA EQU   *                                                        01921000
         END   ICBVUP01,(C'PLS1912',0603,76279)                         01922000
./  ADD  SSI=81570168,NAME=ICBVUT00
         TITLE 'ICBVUT00 - DEFV, MCRT, COVC PROCESSOR (OCT 9, 1974) MVS*00001000
               S        '                                               00002000
ICBVUT00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'ICBVUT00  78.157'                                 0001 00009000
ICBVUCHI DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP02562-ICBVUCHI)                                   00013000
         ENTRY ICBVUCHI                                                 00014000
ICBVUCHO DS    0H                                                  0001 00015000
         USING *,@15                                               0001 00016000
         B     @PROLOG                                             0001 00017000
         DC    AL2(@EP02779-ICBVUCHO)                                   00018000
         ENTRY ICBVUCHO                                                 00019000
ICBVUPGH DS    0H                                                  0001 00020000
         USING *,@15                                               0001 00021000
         B     @PROLOG                                             0001 00022000
         DC    AL2(@EP02929-ICBVUPGH)                                   00023000
         ENTRY ICBVUPGH                                                 00024000
         DROP  @15                                                      00025000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00026000
         BALR  @12,0                                               0001 00027000
@PSTART  LA    @11,4095(,@12)                                      0001 00028000
         LA    @10,4095(,@11)                                      0001 00029000
         LA    @09,4095(,@10)                                      0001 00030000
         LA    @08,4095(,@09)                                      0001 00031000
         LA    @07,4095(,@08)                                      0001 00032000
         USING @PSTART,@12                                         0001 00033000
         USING @PSTART+4095,@11                                    0001 00034000
         USING @PSTART+8190,@10                                    0001 00035000
         USING @PSTART+12285,@09                                   0001 00036000
         USING @PSTART+16380,@08                                   0001 00037000
         USING @PSTART+20475,@07                                   0001 00038000
         ST    @13,@SA00001+4                                      0001 00039000
         LA    @14,@SA00001                                        0001 00040000
         ST    @14,8(,@13)                                         0001 00041000
         LR    @13,@14                                             0001 00042000
         AH    @15,4(,@15)                                         0001 00043000
         BR    @15                                                 0001 00044000
@EP00001 DS    0H                                                  0002 00045000
*   RPLVPTR=RG1;                    /* ADDR TO REQUEST BLK   @Y30LB25*/ 00046000
         ST    RG1,RPLVPTR                                         0141 00047000
*   RESPECIFY                                                      0142 00048000
*     RG1 UNRSTD;                   /* FREE REG1             @Y30LB25*/ 00049000
*   VVIPTR=RPLVVICB;                /* ADDR TO MSVCB         @Y30LB25*/ 00050000
         L     @03,RPLVPTR                                         0143 00051000
         L     @15,RPLVVICB(,@03)                                  0143 00052000
         ST    @15,VVIPTR                                          0143 00053000
*   MCRTPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBMCRT       @Y30LB25*/ 00054000
         LA    @14,RPLVUTIL(,@03)                                  0144 00055000
         LR    MCRTPTR,@14                                         0144 00056000
*   DEFVPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBDEFV       @Y30LB25*/ 00057000
         LR    DEFVPTR,@14                                         0145 00058000
*   CVOLPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBCOVC       @Y30LB25*/ 00059000
         ST    @14,CVOLPTR                                         0146 00060000
*   MCRTEPTR=MCRTPTR+MCRTLEN;       /* ADDR TO ICBMCRTE      @Y30LB25*/ 00061000
         LR    @01,MCRTPTR                                         0147 00062000
         AL    @01,MCRTLEN(,MCRTPTR)                               0147 00063000
         ST    @01,MCRTEPTR                                        0147 00064000
*   DEFVEPTR=DEFVPTR+DEFVLEN;       /* ADDR TO ICBDEFVE      @Y30LB25*/ 00065000
         LR    DEFVEPTR,DEFVPTR                                    0148 00066000
         AL    DEFVEPTR,DEFVLEN(,DEFVPTR)                          0148 00067000
*   COVCEPTR=CVOLPTR+CVOLLEN;       /* ADDR TO ICBCOVCE      @Y30LB25*/ 00068000
         LR    @01,@14                                             0149 00069000
         AL    @01,CVOLLEN(,@14)                                   0149 00070000
         ST    @01,COVCEPTR                                        0149 00071000
*   GROUPPTR=ADDR(GROUPBUF);        /* ADDR GRP BUF          @Y30LB25*/ 00072000
         LA    @14,GROUPBUF                                        0150 00073000
         ST    @14,GROUPPTR                                        0150 00074000
*   NGVRPTR=ADDR(NGVRBUF);          /* ADDR NON-GRP BUF      @Y30LB25*/ 00075000
         LA    NGVRPTR,NGVRBUF                                     0151 00076000
*   COPYVPTR=ADDR(COPYBUF);         /* ADDR CVR BUF          @Y30LB25*/ 00077000
         LA    @14,COPYBUF                                         0152 00078000
         ST    @14,COPYVPTR                                        0152 00079000
*   BASEVPTR=ADDR(BASEBUF);         /* ADDR BVR BUF          @Y30LB25*/ 00080000
         LA    @14,BASEBUF                                         0153 00081000
         ST    @14,BASEVPTR                                        0153 00082000
*   INDEXPTR=ADDR(INDEXBUF);        /* ADDR CIR BUF          @Y30LB25*/ 00083000
         LA    @14,INDEXBUF                                        0154 00084000
         ST    @14,INDEXPTR                                        0154 00085000
*   DUPVPTR=ADDR(DUPVBUF);          /* ADDR DUP BUF          @Y30LB25*/ 00086000
         LA    @14,DUPVBUF                                         0155 00087000
         ST    @14,DUPVPTR                                         0155 00088000
*   WORKAREA=WORKAREA&&WORKAREA;    /* ZERO WORK AREA        @Y30LB25*/ 00089000
         XC    WORKAREA(23),WORKAREA                               0156 00090000
*   CIDKY=FIXONE;                   /* CVR ID TO 1           @Y30LB25*/ 00091000
         MVI   CIDKY,X'01'                                         0157 00092000
*   DIDKY=FIXONE;                   /* DVR ID TO 1           @Y30LB25*/ 00093000
         MVI   DIDKY,X'01'                                         0158 00094000
*                                                                  0159 00095000
*   /*****************************************************************/ 00096000
*   /*                                                               */ 00097000
*   /* CHECK FOR MSVC DISABLED                               @Y30LB25*/ 00098000
*   /*                                                               */ 00099000
*   /*****************************************************************/ 00100000
*                                                                  0159 00101000
*   IF VVIFLG0=ON                   /* DISABLED?             @Y30LB25*/ 00102000
*     THEN                          /* YES                   @Y30LB25*/ 00103000
         TM    VVIFLG0(@15),B'10000000'                            0159 00104000
         BNO   @RF00159                                            0159 00105000
*     DO;                           /*                       @Y30LB25*/ 00106000
*       RPLVRETC=FIXFOUR;           /* ERROR RETURN CODE     @Y30LB25*/ 00107000
         MVC   RPLVRETC(2,@03),@CH00041                            0161 00108000
*       RPLRCODE=DISABLED;          /* REASON CODE           @Y30LB25*/ 00109000
         MVC   RPLRCODE(2,@03),@CB00723                            0162 00110000
*       RETURN;                     /*                       @Y30LB25*/ 00111000
@EL00001 L     @13,4(,@13)                                         0163 00112000
@EF00001 DS    0H                                                  0163 00113000
@ER00001 LM    @14,@12,12(@13)                                     0163 00114000
         BR    @14                                                 0163 00115000
*     END;                          /*                       @Y30LB25*/ 00116000
*                                                                  0165 00117000
*   /*****************************************************************/ 00118000
*   /*                                                               */ 00119000
*   /* CHECK FOR BEFORE OR AFTER MSC CALL AND DETERMINE      @Y30LB25*/ 00120000
*   /* THE CORRECT MSVC FUNCTION TO PERFORM.                 @Y30LB25*/ 00121000
*   /*                                                               */ 00122000
*   /*****************************************************************/ 00123000
*                                                                  0165 00124000
*   IF RPLFTIME=OFF                 /* BEFORE MSC CALL?      @Y30LB25*/ 00125000
*     THEN                          /* YES                   @Y30LB25*/ 00126000
@RF00159 L     @01,RPLVPTR                                         0165 00127000
         TM    RPLFTIME(@01),B'10000000'                           0165 00128000
         BNZ   @RF00165                                            0165 00129000
*     DO;                           /*                       @Y30LB25*/ 00130000
*       CALL BEFRMSC;               /* PROCESS BEFORE MSC    @Y30LB25*/ 00131000
         BAL   @14,BEFRMSC                                         0167 00132000
*       RETURN;                     /*                       @Y30LB25*/ 00133000
         B     @EL00001                                            0168 00134000
*     END;                          /*                       @Y30LB25*/ 00135000
*   ELSE                            /* PROCESS AFTER MSC     @Y30LB25*/ 00136000
*     DO;                           /*                       @Y30LB25*/ 00137000
@RF00165 DS    0H                                                  0171 00138000
*       CALL AFTRMSC;               /*                       @Y30LB25*/ 00139000
         BAL   @14,AFTRMSC                                         0171 00140000
*       RETURN;                     /*                       @Y30LB25*/ 00141000
         B     @EL00001                                            0172 00142000
*     END;                          /*                       @Y30LB25*/ 00143000
*                                                                  0174 00144000
*   /*****************************************************************/ 00145000
*   /*                                                               */ 00146000
*   /* PROCEDURE NAME - BEFRMSC                              @Y30LB25*/ 00147000
*   /*                                                       @Y30LB25*/ 00148000
*   /* FUNCTION - PROCESS MSVC BEFORE THE CALL TO THE MSC.   @Y30LB25*/ 00149000
*   /*                                                       @Y30LB25*/ 00150000
*   /* INPUT -                                               @Y30LB25*/ 00151000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 00152000
*   /*                                                       @Y30LB25*/ 00153000
*   /* OUTPUT -                                              @Y30LB25*/ 00154000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 00155000
*   /* AN ERROR                                              @Y30LB25*/ 00156000
*   /*                                                               */ 00157000
*   /*****************************************************************/ 00158000
*                                                                  0174 00159000
*BEFRMSC:                           /*                       @Y30LB25*/ 00160000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 00161000
*                                                                  0174 00162000
BEFRMSC  ST    @14,@SA00002                                        0174 00163000
*   /*****************************************************************/ 00164000
*   /*                                                               */ 00165000
*   /* CHECK FOR .MSVIJRNL DISABLED AND RECOVERY PROCESSING  @Y30LB25*/ 00166000
*   /*                                                               */ 00167000
*   /*****************************************************************/ 00168000
*                                                                  0175 00169000
*   IF VVIFLG2=ON&RPLJRCVY=OFF      /* JRNL DISABLED & NO    @Y30LB25   00170000
*                                      RECOVERY PROC?        @Y30LB25*/ 00171000
*     THEN                          /* YES                   @Y30LB25*/ 00172000
         L     @01,VVIPTR                                          0175 00173000
         TM    VVIFLG2(@01),B'00100000'                            0175 00174000
         BNO   @RF00175                                            0175 00175000
         L     @15,RPLVPTR                                         0175 00176000
         TM    RPLJRCVY(@15),B'00000010'                           0175 00177000
         BNZ   @RF00175                                            0175 00178000
*     DO;                           /*                       @Y30LB25*/ 00179000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 00180000
         MVC   RPLVRETC(2,@15),@CH00041                            0177 00181000
*       RPLRCODE=JRNLDISB;          /* JRNL DISABLED         @Y30LB25*/ 00182000
         MVC   RPLRCODE(2,@15),@CB00725                            0178 00183000
*       RETURN;                     /*                       @Y30LB25*/ 00184000
@EL00002 DS    0H                                                  0179 00185000
@EF00002 DS    0H                                                  0179 00186000
@ER00002 L     @14,@SA00002                                        0179 00187000
         BR    @14                                                 0179 00188000
*     END;                          /*                       @Y30LB25*/ 00189000
*                                                                  0180 00190000
*   /*****************************************************************/ 00191000
*   /*                                                               */ 00192000
*   /* CHECK FOR DEFINE VOLUME.                              @Y30LB25*/ 00193000
*   /*                                                               */ 00194000
*   /*****************************************************************/ 00195000
*                                                                  0181 00196000
*   IF DEFVOPCD=DEFVOL              /* DEFINE VOL            @Y30LB25*/ 00197000
*     THEN                          /* YES                   @Y30LB25*/ 00198000
@RF00175 CLI   DEFVOPCD(DEFVPTR),24                                0181 00199000
         BNE   @RF00181                                            0181 00200000
*     DO;                           /*                       @Y30LB25*/ 00201000
*                                                                  0182 00202000
*       /*************************************************************/ 00203000
*       /*                                                           */ 00204000
*       /* CHECK FOR ACTIVATE AN INACTIVE VOLUME.            @Y30LB25*/ 00205000
*       /*                                                           */ 00206000
*       /*************************************************************/ 00207000
*                                                                  0183 00208000
*       IF DEFVACT=ON               /* ACT INACT VOL?        @Y30LB25*/ 00209000
*         THEN                      /* YES                   @Y30LB25*/ 00210000
         TM    DEFVACT(DEFVPTR),B'00000010'                        0183 00211000
         BNO   @RF00183                                            0183 00212000
*         DO;                       /*                       @Y30LB25*/ 00213000
*           CALL ACTVOL1;           /*                       @Y30LB25   00214000
*                                      ACTIVATE AN INACT     @Y30LB25   00215000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00216000
         BAL   @14,ACTVOL1                                         0185 00217000
*           RETURN;                 /*                       @Y30LB25*/ 00218000
         B     @EL00002                                            0186 00219000
*         END;                      /*                       @Y30LB25*/ 00220000
*                                                                  0187 00221000
*       /*************************************************************/ 00222000
*       /*                                                           */ 00223000
*       /* CHECK FOR CREATE AN INACTIVE VOLUME.              @Y30LB25*/ 00224000
*       /*                                                           */ 00225000
*       /*************************************************************/ 00226000
*                                                                  0188 00227000
*       IF DEFVCR=ON                /* CRT INACT VOL?        @Y30LB25*/ 00228000
*         THEN                      /* YES                   @Y30LB25*/ 00229000
@RF00183 TM    DEFVCR(DEFVPTR),B'10000000'                         0188 00230000
         BNO   @RF00188                                            0188 00231000
*         DO;                       /*                       @Y30LB25*/ 00232000
*           CALL CRTINCV1;          /*                       @Y30LB25   00233000
*                                      CREATE AN INACT       @Y30LB25   00234000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00235000
         BAL   @14,CRTINCV1                                        0190 00236000
*           IF RPLVRETC=FIXZERO     /*                       @VS32198   00237000
*                                      ERROR?                @VS32198*/ 00238000
*             THEN                  /* YES                   @VS32198*/ 00239000
         L     @06,RPLVPTR                                         0191 00240000
         LH    @06,RPLVRETC(,@06)                                  0191 00241000
         N     @06,@CF01129                                        0191 00242000
         LTR   @06,@06                                             0191 00243000
         BNZ   @RF00191                                            0191 00244000
*             CALL JRNLRPLV;        /*                       @VS32198   00245000
*                                      JOURNAL RPLV          @VS32198*/ 00246000
         BAL   @14,JRNLRPLV                                        0192 00247000
*           RETURN;                 /*                       #Y30LB25*/ 00248000
         B     @EL00002                                            0193 00249000
*         END;                      /*                       #Y30LB25*/ 00250000
*                                                                  0194 00251000
*       /*************************************************************/ 00252000
*       /*                                                           */ 00253000
*       /* CHECK FOR REPLACE VOLUME FLAGS.                   #Y30LB25*/ 00254000
*       /*                                                           */ 00255000
*       /*************************************************************/ 00256000
*                                                                  0195 00257000
*       IF DEFVREP=ON               /* REPLACE VOL FLGS?     #Y30LB25*/ 00258000
*         THEN                      /* YES                   @Y30LB25*/ 00259000
@RF00188 TM    DEFVREP(DEFVPTR),B'00010000'                        0195 00260000
         BNO   @RF00195                                            0195 00261000
*         DO;                       /*                       @Y30LB25*/ 00262000
*           CALL REPVFLG1;          /*                       @Y30LB25   00263000
*                                      REPLACE VOL FLAGS     @Y30LB25   00264000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00265000
         BAL   @14,REPVFLG1                                        0197 00266000
*           RETURN;                 /*                       @Y30LB25*/ 00267000
         B     @EL00002                                            0198 00268000
*         END;                      /*                       @Y30LB25*/ 00269000
*                                                                  0199 00270000
*       /*************************************************************/ 00271000
*       /*                                                           */ 00272000
*       /* CHECK FOR RENAME AN ACTIVE OR INACTIVE VOLUME.    @Y30LB25*/ 00273000
*       /*                                                           */ 00274000
*       /*************************************************************/ 00275000
*                                                                  0200 00276000
*       IF DEFVRNM=ON|DEFVRNTR=ON   /*                       @Y30LB25   00277000
*                                      RENAME ACT VOL OR     @Y30LB25   00278000
*                                      RENAME INAC VOL?      @Y30LB25*/ 00279000
*         THEN                      /* YES                   @Y30LB25*/ 00280000
@RF00195 TM    DEFVRNM(DEFVPTR),B'00100100'                        0200 00281000
         BZ    @RF00200                                            0200 00282000
*         DO;                       /*                       @Y30LB25*/ 00283000
*           CALL RENAME1;           /*                       @Y30LB25   00284000
*                                      RENAME ACT VOL OR     @Y30LB25   00285000
*                                      RENAME INAC VOL       @Y30LB25   00286000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00287000
         BAL   @14,RENAME1                                         0202 00288000
*           IF RPLVRETC=FIXZERO     /*                       @VS32198   00289000
*                                      ERROR?                @VS32198*/ 00290000
*             THEN                  /* YES                   @VS32198*/ 00291000
         L     @06,RPLVPTR                                         0203 00292000
         LH    @06,RPLVRETC(,@06)                                  0203 00293000
         N     @06,@CF01129                                        0203 00294000
         LTR   @06,@06                                             0203 00295000
         BNZ   @RF00203                                            0203 00296000
*             CALL JRNLRPLV;        /*                       @VS32198   00297000
*                                      JOURNAL RPLV          @VS32198*/ 00298000
         BAL   @14,JRNLRPLV                                        0204 00299000
*           RETURN;                 /*                       @Y30LB25*/ 00300000
         B     @EL00002                                            0205 00301000
*         END;                      /*                       @Y30LB25*/ 00302000
*                                                                  0206 00303000
*       /*************************************************************/ 00304000
*       /*                                                           */ 00305000
*       /* CHECK FOR ELIMINATE AN ACTIVE VOLUME.             @Y30LB25*/ 00306000
*       /*                                                           */ 00307000
*       /*************************************************************/ 00308000
*                                                                  0207 00309000
*       IF DEFVELM=ON               /* ELIMINAT ACT VOL?     @Y30LB25*/ 00310000
*         THEN                      /* YES                   @Y30LB25*/ 00311000
@RF00200 TM    DEFVELM(DEFVPTR),B'01000000'                        0207 00312000
         BNO   @RF00207                                            0207 00313000
*         DO;                       /*                       @Y30LB25*/ 00314000
*           CALL RMSVI;             /*                       @Y30LB25   00315000
*                                      RESERVE .MSVI         @Y30LB25*/ 00316000
         BAL   @14,RMSVI                                           0209 00317000
*           CALL ELACREN1;          /*                       @Y30LB25   00318000
*                                      ELIMINATE ACT VOL     @Y30LB25   00319000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00320000
         BAL   @14,ELACREN1                                        0210 00321000
*           IF RPLVRETC=FIXZERO     /*                       @VS32198   00322000
*                                      ERROR?                @VS32198*/ 00323000
*             THEN                  /* YES                   @VS32198*/ 00324000
         L     @06,RPLVPTR                                         0211 00325000
         LH    @06,RPLVRETC(,@06)                                  0211 00326000
         N     @06,@CF01129                                        0211 00327000
         LTR   @06,@06                                             0211 00328000
         BNZ   @RF00211                                            0211 00329000
*             CALL JRNLRPLV;        /*                       @VS32198   00330000
*                                      JOURNAL RPLV          @VS32198*/ 00331000
         BAL   @14,JRNLRPLV                                        0212 00332000
*           RETURN;                 /*                       @Y30LB25*/ 00333000
         B     @EL00002                                            0213 00334000
*         END;                      /*                       @Y30LB25*/ 00335000
*                                                                  0214 00336000
*       /*************************************************************/ 00337000
*       /*                                                           */ 00338000
*       /* CHECK FOR ELIMINATE AN INACTIVE VOLUME.           @Y30LB25*/ 00339000
*       /*                                                           */ 00340000
*       /*************************************************************/ 00341000
*                                                                  0215 00342000
*       IF DEFVELTR=ON              /* ELIMIN INACT VOL?     @Y30LB25*/ 00343000
*         THEN                      /* YES                   @Y30LB25*/ 00344000
@RF00207 TM    DEFVELTR(DEFVPTR),B'00001000'                       0215 00345000
         BNO   @RF00215                                            0215 00346000
*         DO;                       /*                       @Y30LB25*/ 00347000
*           CALL RMSVIS;            /*                       @Y30LB25   00348000
*                                      RESERVE .MSVI         @Y30LB25*/ 00349000
         BAL   @14,RMSVIS                                          0217 00350000
*           IVOLKY=DEFVCSN1;        /*                       @Y30LB25   00351000
*                                      CSN TO CIR KEY        @Y30LB25*/ 00352000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        0218 00353000
*           CALL GETRECLC;          /*                       @Y30LB25   00354000
*                                      ELIMINATE INAC VOL    @Y30LB25   00355000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00356000
         BAL   @14,GETRECLC                                        0219 00357000
*           RETURN;                 /*                       @Y30LB25*/ 00358000
         B     @EL00002                                            0220 00359000
*         END;                      /*                       @Y30LB25*/ 00360000
*                                                                  0221 00361000
*       /*************************************************************/ 00362000
*       /*                                                           */ 00363000
*       /* CHECK FOR DEACTIVATE AN ACTIVE VOLUME.            @Y30LB25*/ 00364000
*       /*                                                           */ 00365000
*       /*************************************************************/ 00366000
*                                                                  0222 00367000
*       IF DEFVDACT=ON              /* DEACTIV ACT VOL?      @Y30LB25*/ 00368000
*         THEN                      /* YES                   @Y30LB25*/ 00369000
@RF00215 TM    DEFVDACT(DEFVPTR),B'00000001'                       0222 00370000
         BNO   @RF00222                                            0222 00371000
*         DO;                       /*                       @Y30LB25*/ 00372000
*           CALL RMSVIS;            /*                       @Y30LB25   00373000
*                                      RESERVE .MSVI         @Y30LB25*/ 00374000
         BAL   @14,RMSVIS                                          0224 00375000
*           BVOLKY=DEFVOLD;         /*                       @Y30LB25   00376000
*                                      VOLID TO BVR KEY      @Y30LB25*/ 00377000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          0225 00378000
*           RPLVKEY=ADDR(BKEY);     /*                       @Y30LB25   00379000
*                                      KEY ADDR              @Y30LB25*/ 00380000
         LA    @06,BKEY                                            0226 00381000
         L     @01,RPLVPTR                                         0226 00382000
         ST    @06,RPLVKEY(,@01)                                   0226 00383000
*           CALL READLOC;           /*                       @Y30LB25   00384000
*                                      DEACTIVATE ACT VOL    @Y30LB25   00385000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00386000
         BAL   @14,READLOC                                         0227 00387000
*           RETURN;                 /*                       @Y30LB25*/ 00388000
         B     @EL00002                                            0228 00389000
*         END;                      /*                       @Y30LB25*/ 00390000
*                                                                  0229 00391000
*       /*************************************************************/ 00392000
*       /*                                                           */ 00393000
*       /* INVALID DEFINE REQUEST.                           @Y30LB25*/ 00394000
*       /*                                                           */ 00395000
*       /*************************************************************/ 00396000
*                                                                  0230 00397000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 00398000
@RF00222 L     @06,RPLVPTR                                         0230 00399000
         MVC   RPLVRETC(2,@06),@CH00041                            0230 00400000
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/ 00401000
         MVC   RPLRCODE(2,@06),@CB00727                            0231 00402000
*       RETURN;                     /*                       @Y30LB25*/ 00403000
         B     @EL00002                                            0232 00404000
*     END;                          /*                       @Y30LB25*/ 00405000
*                                                                  0233 00406000
*   /*****************************************************************/ 00407000
*   /*                                                               */ 00408000
*   /* CHECK FOR MOVE CARTRIDGE.                             @Y30LB25*/ 00409000
*   /*                                                               */ 00410000
*   /*****************************************************************/ 00411000
*                                                                  0234 00412000
*   IF MCRTOPCD=MVCRT               /* MOVE CART?            @Y30LB25*/ 00413000
*     THEN                          /* YES                   @Y30LB25*/ 00414000
*                                                                  0234 00415000
@RF00181 CLI   MCRTOPCD(MCRTPTR),14                                0234 00416000
         BNE   @RF00234                                            0234 00417000
*     /***************************************************************/ 00418000
*     /*                                                             */ 00419000
*     /* CHECK FOR MOVE AN INACTIVE VOLUME.                  @Y30LB25*/ 00420000
*     /*                                                             */ 00421000
*     /***************************************************************/ 00422000
*                                                                  0235 00423000
*     IF MCRTTRAN=ON                /* MOVE INACT CART?      @Y30LB25*/ 00424000
*       THEN                        /* YES                   @Y30LB25*/ 00425000
         TM    MCRTTRAN(MCRTPTR),B'00100000'                       0235 00426000
         BNO   @RF00235                                            0235 00427000
*       DO;                         /*                       @Y30LB25*/ 00428000
*         CALL INACVOL1;            /* MOVE INACT VOL        @Y30LB25   00429000
*                                      BEFORE MSC CALL       @Y30LB25*/ 00430000
         BAL   @14,INACVOL1                                        0237 00431000
*         RETURN;                   /*                       @Y30LB25*/ 00432000
         B     @EL00002                                            0238 00433000
*       END;                        /*                       @Y30LB25*/ 00434000
*                                                                  0239 00435000
*   /*****************************************************************/ 00436000
*   /*                                                               */ 00437000
*   /* INVALID MOVE REQUEST.                                 @Y30LB25*/ 00438000
*   /*                                                               */ 00439000
*   /*****************************************************************/ 00440000
*                                                                  0240 00441000
*     ELSE                          /* ERROR                 @Y30LB25*/ 00442000
*       DO;                         /*                       @Y30LB25*/ 00443000
@RF00235 DS    0H                                                  0241 00444000
*         RPLVRETC=FIXFOUR;         /* ERROR RETN CODE       @Y30LB25*/ 00445000
         L     @06,RPLVPTR                                         0241 00446000
         MVC   RPLVRETC(2,@06),@CH00041                            0241 00447000
*         RPLRCODE=INVALOP;         /* INVALID REQUEST       @Y30LB25*/ 00448000
         MVC   RPLRCODE(2,@06),@CB00727                            0242 00449000
*         RETURN;                   /*                       @Y30LB25*/ 00450000
         B     @EL00002                                            0243 00451000
*       END;                        /*                       @Y30LB25*/ 00452000
*                                                                  0244 00453000
*   /*****************************************************************/ 00454000
*   /*                                                               */ 00455000
*   /* CHECK FOR COPY VOLUME.                                @Y30LB25*/ 00456000
*   /*                                                               */ 00457000
*   /*****************************************************************/ 00458000
*                                                                  0245 00459000
*   IF CVOLOPCD=CPYVOL              /* COPY VOL?             @Y30LB25*/ 00460000
*     THEN                          /* YES                   @Y30LB25*/ 00461000
@RF00234 L     @06,CVOLPTR                                         0245 00462000
         CLI   CVOLOPCD(@06),X'2A'                                 0245 00463000
         BNE   @RF00245                                            0245 00464000
*     DO;                           /*                       @Y30LB25*/ 00465000
*                                                                  0246 00466000
*       /*************************************************************/ 00467000
*       /*                                                           */ 00468000
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/ 00469000
*       /* DASD TO CARTRIDGE.                                @Y30LB25*/ 00470000
*       /*                                                           */ 00471000
*       /*************************************************************/ 00472000
*                                                                  0247 00473000
*       IF CVODASCR=ON              /* TRANSFER DATA         @Y30LB25   00474000
*                                      DASD TO CART?         @Y30LB25*/ 00475000
*         THEN                      /* YES?                  @Y30LB25*/ 00476000
         TM    CVODASCR(@06),B'10000000'                           0247 00477000
         BNO   @RF00247                                            0247 00478000
*         DO;                       /*                       @Y30LB25*/ 00479000
*           CALL RMSVIS;            /*                       @Y30LB25   00480000
*                                      RESERVE .MSVI         @Y30LB25*/ 00481000
         BAL   @14,RMSVIS                                          0249 00482000
*           BVOLKY=CVOLID;          /*                       @Y30LB25   00483000
*                                      VOLID TO BVR          @Y30LB25*/ 00484000
         L     @06,CVOLPTR                                         0250 00485000
         MVC   BVOLKY(6),CVOLID(@06)                               0250 00486000
*           RPLVKEY=ADDR(BKEY);     /*                       @Y30LB25   00487000
*                                      KEY ADDR              @Y30LB25*/ 00488000
         LA    @06,BKEY                                            0251 00489000
         L     @01,RPLVPTR                                         0251 00490000
         ST    @06,RPLVKEY(,@01)                                   0251 00491000
*           CALL READLOC;           /*                       @Y30LB25   00492000
*                                      TRANSFER DATA         @Y30LB25   00493000
*                                      DASD TO CART          @Y30LB25*/ 00494000
         BAL   @14,READLOC                                         0252 00495000
*           RETURN;                 /*                       @Y30LB25*/ 00496000
         B     @EL00002                                            0253 00497000
*         END;                      /*                       @Y30LB25*/ 00498000
*                                                                  0254 00499000
*       /*************************************************************/ 00500000
*       /*                                                           */ 00501000
*       /* TRANSFER DATA FROM AN ACTIVE TO AN                @Y30LB25*/ 00502000
*       /* INACTIVE VOLUME, OR TRANSFER                      @Y30LB25*/ 00503000
*       /* DATA FROM AN INACTIVE TO AN                       @Y30LB25*/ 00504000
*       /* ACTIVE VOLUME.                                    @Y30LB25*/ 00505000
*       /*                                                           */ 00506000
*       /*************************************************************/ 00507000
*                                                                  0255 00508000
*       IF CVOCRCR=ON|CVOCRCRV=ON   /* TRANSFER DATA         @Y30LB25   00509000
*                                      ACT VOL TO INACT      @Y30LB25   00510000
*                                      VOL? OR TRANSFER      @Y30LB25   00511000
*                                      DATA INACT TO         @Y30LB25   00512000
*                                      ACT VOL?              @Y30LB25*/ 00513000
*         THEN                      /* YES?                  @Y30LB25*/ 00514000
@RF00247 L     @06,CVOLPTR                                         0255 00515000
         TM    CVOCRCR(@06),B'00110000'                            0255 00516000
         BNZ   @RT00255                                            0255 00517000
*         RETURN;                   /*                       @Y30LB25*/ 00518000
*                                                                  0256 00519000
*       /*************************************************************/ 00520000
*       /*                                                           */ 00521000
*       /* INVALID COPY REQUEST.                             @Y30LB25*/ 00522000
*       /*                                                           */ 00523000
*       /*************************************************************/ 00524000
*                                                                  0257 00525000
*       RPLVRETC=FIXFOUR;           /* ERROR                 @Y30LB25*/ 00526000
         L     @06,RPLVPTR                                         0257 00527000
         MVC   RPLVRETC(2,@06),@CH00041                            0257 00528000
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/ 00529000
         MVC   RPLRCODE(2,@06),@CB00727                            0258 00530000
*       RETURN;                     /*                       @Y30LB25*/ 00531000
         B     @EL00002                                            0259 00532000
*     END;                          /*                       @Y30LB25*/ 00533000
*                                                                  0260 00534000
*   /*****************************************************************/ 00535000
*   /*                                                               */ 00536000
*   /* CHECK FOR COPY CARTRIDGE WHICH IS TO BE               @Y30LB25*/ 00537000
*   /* PROCESSED BY ICBVMS00.                                @Y30LB25*/ 00538000
*   /*                                                               */ 00539000
*   /*****************************************************************/ 00540000
*                                                                  0261 00541000
*   IF CVOLOPCD=CPYCART             /* COPY CART?            @Y30LB25*/ 00542000
*     THEN                          /* YES                   @Y30LB25*/ 00543000
@RF00245 L     @06,CVOLPTR                                         0261 00544000
         CLI   CVOLOPCD(@06),X'28'                                 0261 00545000
         BE    @RT00261                                            0261 00546000
*     RETURN;                       /*                       @Y30LB25*/ 00547000
*                                                                  0262 00548000
*   /*****************************************************************/ 00549000
*   /*                                                               */ 00550000
*   /* INVALID FUNCTION.                                     @Y30LB25*/ 00551000
*   /*                                                               */ 00552000
*   /*****************************************************************/ 00553000
*                                                                  0263 00554000
*   RPLRCODE=FIXFOUR;               /* ERROR RETN CODE       @Y30LB25*/ 00555000
         L     @06,RPLVPTR                                         0263 00556000
         MVC   RPLRCODE(2,@06),@CH00041                            0263 00557000
*   RPLRCODE=INVALOP;               /* INVALID REQUEST       @Y30LB25*/ 00558000
         MVC   RPLRCODE(2,@06),@CB00727                            0264 00559000
*   END BEFRMSC;                    /*                       @Y30LB25*/ 00560000
         B     @EL00002                                            0265 00561000
*                                                                  0266 00562000
*   /*****************************************************************/ 00563000
*   /*                                                               */ 00564000
*   /* PROCEDURE NAME - AFTRMSC                              @Y30LB25*/ 00565000
*   /*                                                       @Y30LB25*/ 00566000
*   /* FUNCTION - PROCESS MSVC AFTER THE CALL TO THE MSC.    @Y30LB25*/ 00567000
*   /*                                                       @Y30LB25*/ 00568000
*   /* INPUT -                                               @Y30LB25*/ 00569000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 00570000
*   /*                                                       @Y30LB25*/ 00571000
*   /* OUTPUT -                                              @Y30LB25*/ 00572000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 00573000
*   /* AN ERROR                                              @Y30LB25*/ 00574000
*   /*                                                               */ 00575000
*   /*****************************************************************/ 00576000
*                                                                  0266 00577000
*AFTRMSC:                           /*                       @Y30LB25*/ 00578000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 00579000
*                                                                  0266 00580000
AFTRMSC  ST    @14,@SA00003                                        0266 00581000
*   /*****************************************************************/ 00582000
*   /*                                                               */ 00583000
*   /* CHECK FOR DEFINE VOLUME.                              @Y30LB25*/ 00584000
*   /*                                                               */ 00585000
*   /*****************************************************************/ 00586000
*                                                                  0267 00587000
*   IF DEFVOPCD=DEFVOL              /* DEFINE VOL            @Y30LB25*/ 00588000
*     THEN                          /* YES                   @Y30LB25*/ 00589000
         CLI   DEFVOPCD(DEFVPTR),24                                0267 00590000
         BNE   @RF00267                                            0267 00591000
*     DO;                           /*                       @Y30LB25*/ 00592000
*                                                                  0268 00593000
*       /*************************************************************/ 00594000
*       /*                                                           */ 00595000
*       /* CHECK FOR ACTIVATE AN INACTIVE VOLUME.            @Y30LB25*/ 00596000
*       /*                                                           */ 00597000
*       /*************************************************************/ 00598000
*                                                                  0269 00599000
*       IF DEFVACT=ON               /* ACT INACT VOL?        @Y30LB25*/ 00600000
*         THEN                      /* YES                   @Y30LB25*/ 00601000
         TM    DEFVACT(DEFVPTR),B'00000010'                        0269 00602000
         BNO   @RF00269                                            0269 00603000
*         DO;                       /*                       @Y30LB25*/ 00604000
*           CALL ACTVOL2;           /*                       @Y30LB25   00605000
*                                      ACTIVATE AN INACT     @Y30LB25   00606000
*                                      AFTER MCS CALL        @Y30LB25*/ 00607000
         BAL   @14,ACTVOL2                                         0271 00608000
*           RETURN;                 /*                       @Y30LB25*/ 00609000
@EL00003 DS    0H                                                  0272 00610000
@EF00003 DS    0H                                                  0272 00611000
@ER00003 L     @14,@SA00003                                        0272 00612000
         BR    @14                                                 0272 00613000
*         END;                      /*                       @Y30LB25*/ 00614000
*                                                                  0273 00615000
*       /*************************************************************/ 00616000
*       /*                                                           */ 00617000
*       /* CHECK FOR CREATE AN INACTIVE VOLUME.              @Y30LB25*/ 00618000
*       /*                                                           */ 00619000
*       /*************************************************************/ 00620000
*                                                                  0274 00621000
*       IF DEFVCR=ON                /* CRT INACT VOL?        @Y30LB25*/ 00622000
*         THEN                      /* YES                   @Y30LB25*/ 00623000
@RF00269 TM    DEFVCR(DEFVPTR),B'10000000'                         0274 00624000
         BNO   @RF00274                                            0274 00625000
*         DO;                       /*                       @Y30LB25*/ 00626000
*           CALL CRTINCV2;          /*                       @Y30LB25   00627000
*                                      CREATE AN INACT       @Y30LB25   00628000
*                                      AFTER MCS CALL        @Y30LB25*/ 00629000
         BAL   @14,CRTINCV2                                        0276 00630000
*           RETURN;                 /*                       @Y30LB25*/ 00631000
         B     @EL00003                                            0277 00632000
*         END;                      /*                       @Y30LB25*/ 00633000
*                                                                  0278 00634000
*       /*************************************************************/ 00635000
*       /*                                                           */ 00636000
*       /* CHECK FOR REPLACE VOLUME FLAGS.                   @Y30LB25*/ 00637000
*       /*                                                           */ 00638000
*       /*************************************************************/ 00639000
*                                                                  0279 00640000
*       IF DEFVREP=ON               /* REPLACE VOL FLGS?     @Y30LB25*/ 00641000
*         THEN                      /* YES                   @Y30LB25*/ 00642000
@RF00274 TM    DEFVREP(DEFVPTR),B'00010000'                        0279 00643000
         BNO   @RF00279                                            0279 00644000
*         DO;                       /*                       @Y30LB25*/ 00645000
*           CALL REPVFLG2;          /*                       @Y30LB25   00646000
*                                      REPLACE VOL FLAGS     @Y30LB25   00647000
*                                      A FTER MCS CALL       @Y30LB25*/ 00648000
         BAL   @14,REPVFLG2                                        0281 00649000
*           RETURN;                 /*                       @Y30LB25*/ 00650000
         B     @EL00003                                            0282 00651000
*         END;                      /*                       @Y30LB25*/ 00652000
*                                                                  0283 00653000
*       /*************************************************************/ 00654000
*       /*                                                           */ 00655000
*       /* CHECK FOR RENAME AN ACTIVE OR INACTIVE VOLUME.    @Y30LB25*/ 00656000
*       /*                                                           */ 00657000
*       /*************************************************************/ 00658000
*                                                                  0284 00659000
*       IF DEFVRNM=ON|DEFVRNTR=ON   /* RENAME ACT VOL OR     @Y30LB25   00660000
*                                      INACT VOL?            @Y30LB25*/ 00661000
*         THEN                      /* YES                   @Y30LB25*/ 00662000
@RF00279 TM    DEFVRNM(DEFVPTR),B'00100100'                        0284 00663000
         BZ    @RF00284                                            0284 00664000
*         DO;                       /*                       @Y30LB25*/ 00665000
*           CALL RENAME2;           /*                       @Y30LB25   00666000
*                                      RENAME ACT VOL OR     @Y30LB25   00667000
*                                      INACT VOL             @Y30LB25   00668000
*                                      AFTER MCS CALL        @Y30LB25*/ 00669000
         BAL   @14,RENAME2                                         0286 00670000
*           RETURN;                 /*                       @Y30LB25*/ 00671000
         B     @EL00003                                            0287 00672000
*         END;                      /*                       @Y30LB25*/ 00673000
*                                                                  0288 00674000
*       /*************************************************************/ 00675000
*       /*                                                           */ 00676000
*       /* CHECK FOR ELIMINATE AN ACTIVE VOLUME.             @Y30LB25*/ 00677000
*       /*                                                           */ 00678000
*       /*************************************************************/ 00679000
*                                                                  0289 00680000
*       IF DEFVELM=ON               /* ELIMINAT ACT VOL?     @Y30LB25*/ 00681000
*         THEN                      /* YES                   @Y30LB25*/ 00682000
@RF00284 TM    DEFVELM(DEFVPTR),B'01000000'                        0289 00683000
         BNO   @RF00289                                            0289 00684000
*         DO;                       /*                       @Y30LB25*/ 00685000
*           CALL ELMACTV2;          /*                       @Y30LB25   00686000
*                                      ELIMINATE ACT VOL     @Y30LB25   00687000
*                                      AFTER MCS CALL        @Y30LB25*/ 00688000
         BAL   @14,ELMACTV2                                        0291 00689000
*           RETURN;                 /*                       @Y30LB25*/ 00690000
         B     @EL00003                                            0292 00691000
*         END;                      /*                       @Y30LB25*/ 00692000
*                                                                  0293 00693000
*       /*************************************************************/ 00694000
*       /*                                                           */ 00695000
*       /* CHECK FOR ELIMINATE AN INACTIVE VOLUME.           @Y30LB25*/ 00696000
*       /*                                                           */ 00697000
*       /*************************************************************/ 00698000
*                                                                  0294 00699000
*       IF DEFVELTR=ON              /* ELIMIN INACT VOL?     @Y30LB25*/ 00700000
*         THEN                      /* YES                   @Y30LB25*/ 00701000
@RF00289 TM    DEFVELTR(DEFVPTR),B'00001000'                       0294 00702000
         BNO   @RF00294                                            0294 00703000
*         DO;                       /*                       @Y30LB25*/ 00704000
*           CALL ELINACV2;          /*                       @Y30LB25   00705000
*                                      ELIMINATE INAC VOL    @Y30LB25   00706000
*                                      AFTER MCS CALL        @Y30LB25*/ 00707000
         BAL   @14,ELINACV2                                        0296 00708000
*           RETURN;                 /*                       @Y30LB25*/ 00709000
         B     @EL00003                                            0297 00710000
*         END;                      /*                       @Y30LB25*/ 00711000
*                                                                  0298 00712000
*       /*************************************************************/ 00713000
*       /*                                                           */ 00714000
*       /* CHECK FOR DEACTIVE AN ACTIVE VOLUME.              @Y30LB25*/ 00715000
*       /*                                                           */ 00716000
*       /*************************************************************/ 00717000
*                                                                  0299 00718000
*       IF DEFVDACT=ON              /* DEACTIV ACT VOL?      @Y30LB25*/ 00719000
*         THEN                      /* YES                   @Y30LB25*/ 00720000
@RF00294 TM    DEFVDACT(DEFVPTR),B'00000001'                       0299 00721000
         BNO   @RF00299                                            0299 00722000
*         DO;                       /*                       @Y30LB25*/ 00723000
*           CALL DEACTV2;           /*                       @Y30LB25   00724000
*                                      DEACTIVATE ACT VOL    @Y30LB25   00725000
*                                      AFTER MCS CALL        @Y30LB25*/ 00726000
         BAL   @14,DEACTV2                                         0301 00727000
*           RETURN;                 /*                       @Y30LB25*/ 00728000
         B     @EL00003                                            0302 00729000
*         END;                      /*                       @Y30LB25*/ 00730000
*                                                                  0303 00731000
*       /*************************************************************/ 00732000
*       /*                                                           */ 00733000
*       /* INVALID DEFINE REQUEST.                           @Y30LB25*/ 00734000
*       /*                                                           */ 00735000
*       /*************************************************************/ 00736000
*                                                                  0304 00737000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 00738000
@RF00299 L     @06,RPLVPTR                                         0304 00739000
         MVC   RPLVRETC(2,@06),@CH00041                            0304 00740000
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/ 00741000
         MVC   RPLRCODE(2,@06),@CB00727                            0305 00742000
*       RETURN;                     /*                       @Y30LB25*/ 00743000
         B     @EL00003                                            0306 00744000
*     END;                          /*                       @Y30LB25*/ 00745000
*                                                                  0307 00746000
*   /*****************************************************************/ 00747000
*   /*                                                               */ 00748000
*   /* CHECK FOR MOVE CARTRIDGE.                             @Y30LB25*/ 00749000
*   /*                                                               */ 00750000
*   /*****************************************************************/ 00751000
*                                                                  0308 00752000
*   IF MCRTOPCD=MVCRT               /* MOVE CART?            @Y30LB25*/ 00753000
*     THEN                          /* YES                   @Y30LB25*/ 00754000
*                                                                  0308 00755000
@RF00267 CLI   MCRTOPCD(MCRTPTR),14                                0308 00756000
         BNE   @RF00308                                            0308 00757000
*     /***************************************************************/ 00758000
*     /*                                                             */ 00759000
*     /* CHECK FOR MOVE AN INACTIVE VOLUME.                  @Y30LB25*/ 00760000
*     /*                                                             */ 00761000
*     /***************************************************************/ 00762000
*                                                                  0309 00763000
*     IF MCRTTRAN=ON                /* MOVE INAC VOL?        @Y30LB25*/ 00764000
*       THEN                        /* YES                   @Y30LB25*/ 00765000
         TM    MCRTTRAN(MCRTPTR),B'00100000'                       0309 00766000
         BNO   @RF00309                                            0309 00767000
*       DO;                         /*                       @Y30LB25*/ 00768000
*         CALL INACVOL2;            /* MOVE INACT VOL        @Y30LB25   00769000
*                                      AFTER MSC CALL        @Y30LB25*/ 00770000
         BAL   @14,INACVOL2                                        0311 00771000
*         RETURN;                   /*                       @Y30LB25*/ 00772000
         B     @EL00003                                            0312 00773000
*       END;                        /*                       @Y30LB25*/ 00774000
*                                                                  0313 00775000
*   /*****************************************************************/ 00776000
*   /*                                                               */ 00777000
*   /* INVALID MOVE REQUEST.                                 @Y30LB25*/ 00778000
*   /*                                                               */ 00779000
*   /*****************************************************************/ 00780000
*                                                                  0314 00781000
*     ELSE                          /* ERROR                 @Y30LB25*/ 00782000
*       DO;                         /*                       @Y30LB25*/ 00783000
@RF00309 DS    0H                                                  0315 00784000
*         RPLVRETC=FIXFOUR;         /* ERROR RETN CODE       @Y30LB25*/ 00785000
         L     @06,RPLVPTR                                         0315 00786000
         MVC   RPLVRETC(2,@06),@CH00041                            0315 00787000
*         RPLRCODE=INVALOP;         /* INVALID REQUEST       @Y30LB25*/ 00788000
         MVC   RPLRCODE(2,@06),@CB00727                            0316 00789000
*         RETURN;                   /*                       @Y30LB25*/ 00790000
         B     @EL00003                                            0317 00791000
*       END;                        /*                       @Y30LB25*/ 00792000
*                                                                  0318 00793000
*   /*****************************************************************/ 00794000
*   /*                                                               */ 00795000
*   /* CHECK FOR COPY VOLUME.                                @Y30LB25*/ 00796000
*   /*                                                               */ 00797000
*   /*****************************************************************/ 00798000
*                                                                  0319 00799000
*   IF CVOLOPCD=CPYVOL              /* COPY VOL?             @Y30LB25*/ 00800000
*     THEN                          /* YES                   @Y30LB25*/ 00801000
@RF00308 L     @06,CVOLPTR                                         0319 00802000
         CLI   CVOLOPCD(@06),X'2A'                                 0319 00803000
         BNE   @RF00319                                            0319 00804000
*     DO;                           /*                       @Y30LB25*/ 00805000
*                                                                  0320 00806000
*       /*************************************************************/ 00807000
*       /*                                                           */ 00808000
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/ 00809000
*       /* DASD TO CARTRIDGE, OR                             @Y30LB25*/ 00810000
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/ 00811000
*       /* AN INACTIVE TO AN ACTIVE VOLUME.                  @Y30LB25*/ 00812000
*       /*                                                           */ 00813000
*       /*************************************************************/ 00814000
*                                                                  0321 00815000
*       IF CVODASCR=ON|CVOCRCRV=ON  /* TRANSFER DATA         @Y30LB25   00816000
*                                      DASD TO CART OR       @Y30LB25   00817000
*                                      TRANSFER DATA         @Y30LB25   00818000
*                                      INACT TO ACT?         @Y30LB25*/ 00819000
*         THEN                      /* YES?                  @Y30LB25*/ 00820000
         TM    CVODASCR(@06),B'10010000'                           0321 00821000
         BZ    @RF00321                                            0321 00822000
*         DO;                       /*                       @Y30LB25*/ 00823000
*           CALL TRANDAT2;          /*                       @Y30LB25   00824000
*                                      TRANSFER DATA         @Y30LB25   00825000
*                                      DASD TO CART OR       @Y30LB25   00826000
*                                      TRANSFER DATA         @Y30LB25   00827000
*                                      INACT TO ACT          @Y30LB25   00828000
*                                      AFTER MSC             @Y30LB25*/ 00829000
         BAL   @14,TRANDAT2                                        0323 00830000
*           RETURN;                 /*                       @Y30LB25*/ 00831000
         B     @EL00003                                            0324 00832000
*         END;                      /*                       @Y30LB25*/ 00833000
*                                                                  0325 00834000
*       /*************************************************************/ 00835000
*       /*                                                           */ 00836000
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/ 00837000
*       /* AN ACTIVE TO AN INACTIVE VOLUME.                  @Y30LB25*/ 00838000
*       /*                                                           */ 00839000
*       /*************************************************************/ 00840000
*                                                                  0326 00841000
*       IF CVOCRCR=ON               /* TRANSFER DATA         @Y30LB25   00842000
*                                      ACT TO INACT?         @Y30LB25*/ 00843000
*         THEN                      /* YES?                  @Y30LB25*/ 00844000
@RF00321 L     @06,CVOLPTR                                         0326 00845000
         TM    CVOCRCR(@06),B'00100000'                            0326 00846000
         BNO   @RF00326                                            0326 00847000
*         DO;                       /*                       @Y30LB25*/ 00848000
*           CALL ACINACV2;          /*                       @Y30LB25   00849000
*                                      TRANSFER DATA         @Y30LB25   00850000
*                                      ACT TO INAC VOL       @Y30LB25   00851000
*                                      AFTER MSC             @Y30LB25*/ 00852000
         BAL   @14,ACINACV2                                        0328 00853000
*           RETURN;                 /*                       @Y30LB25*/ 00854000
         B     @EL00003                                            0329 00855000
*         END;                      /*                       @Y30LB25*/ 00856000
*                                                                  0330 00857000
*       /*************************************************************/ 00858000
*       /*                                                           */ 00859000
*       /* INVALID COPY REQUEST.                             @Y30LB25*/ 00860000
*       /*                                                           */ 00861000
*       /*************************************************************/ 00862000
*                                                                  0331 00863000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 00864000
@RF00326 L     @06,RPLVPTR                                         0331 00865000
         MVC   RPLVRETC(2,@06),@CH00041                            0331 00866000
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/ 00867000
         MVC   RPLRCODE(2,@06),@CB00727                            0332 00868000
*       RETURN;                     /*                       @Y30LB25*/ 00869000
         B     @EL00003                                            0333 00870000
*     END;                          /*                       @Y30LB25*/ 00871000
*                                                                  0334 00872000
*   /*****************************************************************/ 00873000
*   /*                                                               */ 00874000
*   /* CHECK FOR COPY CARTRIDGE WHICH IS TO BE               @Y30LB25*/ 00875000
*   /* PROCESSED BY ICBVMS00.                                @Y30LB25*/ 00876000
*   /*                                                               */ 00877000
*   /*****************************************************************/ 00878000
*                                                                  0335 00879000
*   IF CVOLOPCD=CPYCART             /* COPY CART?            @Y30LB25*/ 00880000
*     THEN                          /* YES                   @Y30LB25*/ 00881000
@RF00319 L     @06,CVOLPTR                                         0335 00882000
         CLI   CVOLOPCD(@06),X'28'                                 0335 00883000
         BE    @RT00335                                            0335 00884000
*     RETURN;                       /*                       @Y30LB25*/ 00885000
*                                                                  0336 00886000
*   /*****************************************************************/ 00887000
*   /*                                                               */ 00888000
*   /* INVALID FUNCTION.                                     @Y30LB25*/ 00889000
*   /*                                                               */ 00890000
*   /*****************************************************************/ 00891000
*                                                                  0337 00892000
*   RPLRCODE=FIXFOUR;               /* ERROR RETN CODE       @Y30LB25*/ 00893000
         L     @06,RPLVPTR                                         0337 00894000
         MVC   RPLRCODE(2,@06),@CH00041                            0337 00895000
*   RPLRCODE=INVALOP;               /* INVALID REQUEST       @Y30LB25*/ 00896000
         MVC   RPLRCODE(2,@06),@CB00727                            0338 00897000
*   RETURN;                         /*                       @Y30LB25*/ 00898000
         B     @EL00003                                            0339 00899000
*   END AFTRMSC;                    /*                       @Y30LB25*/ 00900000
         B     @EL00003                                            0340 00901000
*                                                                  0341 00902000
*   /*****************************************************************/ 00903000
*   /*                                                               */ 00904000
*   /* PROCEDURE NAME - JRNLRPLV                             @Y30LB25*/ 00905000
*   /*                                                       @Y30LB25*/ 00906000
*   /* FUNCTION - WRITE THE RPLV TO .MSVIJRNL BEFORE AND/OR  @VS32198*/ 00907000
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/ 00908000
*   /*                                                       @Y30LB25*/ 00909000
*   /* INPUT -                                               @Y30LB25*/ 00910000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 00911000
*   /*                                                       @Y30LB25*/ 00912000
*   /* OUTPUT -                                              @Y30LB25*/ 00913000
*   /* RPLV WAS JOURNALLED FLAG IN PASSBYTE                  @Y30LB25*/ 00914000
*   /*                                                               */ 00915000
*   /*****************************************************************/ 00916000
*                                                                  0341 00917000
*                                                                  0341 00918000
*   /*****************************************************************/ 00919000
*   /*                                                               */ 00920000
*   /* RESERVE/RELEASE RETURNS ZERO REASON/RETURN CODES.     @Y30LB25*/ 00921000
*   /* RPLV WILL BE JOURNALLED, BECAUSE CHECK FOR DISABLED   @Y30LB25*/ 00922000
*   /* WAS MADE BEFORE CALL TO THE MSC. THEREFORE,           @Y30LB25*/ 00923000
*   /* THIS INCOMPLETELY PROCESSED FUNCTION WILL BE ALLOWED  @Y30LB25*/ 00924000
*   /* TO COMPLETE EVEN IF THE JOURNAL HAS BEEN DISABLED     @Y30LB25*/ 00925000
*   /* SINCE THE LAST CHECK. THE JOURNAL ALWAYS HAS          @Y30LB25*/ 00926000
*   /* SPACE RESERVED FOR SUCH A SITUATION.                  @Y30LB25*/ 00927000
*   /*                                                               */ 00928000
*   /*****************************************************************/ 00929000
*                                                                  0341 00930000
*JRNLRPLV:                          /*                       @Y30LB25*/ 00931000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 00932000
JRNLRPLV ST    @14,@SA00004                                        0341 00933000
*   RESPECIFY                       /*                       @Y30LB25*/ 00934000
*     RG0 RSTD;                     /* RESTRICT REG 0        @Y30LB25*/ 00935000
*   RESPECIFY                       /*                       @Y30LB25*/ 00936000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 00937000
*   RG0=RESEXVJL;                   /* RESERVE JRNL FLAG     @Y30LB25*/ 00938000
         LA    RG0,17                                              0344 00939000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 00940000
         L     RG1,RPLVPTR                                         0345 00941000
*   CALL ICBVRR00;                  /* RESERVE JOURNNAL      @Y30LB25*/ 00942000
         L     @15,@CV00763                                        0346 00943000
         BALR  @14,@15                                             0346 00944000
*   CALL ICBVJL00;                  /* JRNL THE RPLV         @Y30LB25*/ 00945000
         L     @15,@CV00764                                        0347 00946000
         BALR  @14,@15                                             0347 00947000
*   RG0=DEQJRNL;                    /* RELEASE JRNL FLAG     @Y30LB25*/ 00948000
         LA    RG0,16                                              0348 00949000
*   CALL ICBVRR00;                  /* RELEASE JOURNAL       @Y30LB25*/ 00950000
         L     @15,@CV00763                                        0349 00951000
         BALR  @14,@15                                             0349 00952000
*   RESPECIFY                       /*                       @Y30LB25*/ 00953000
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Y30LB25*/ 00954000
*   RESPECIFY                       /*                       @Y30LB25*/ 00955000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 00956000
*   RPLVFLG=ON;                     /* RPLV IS JRNLED        @Y30LB25*/ 00957000
         OI    RPLVFLG,B'00000001'                                 0352 00958000
*   RETURN;                         /*                       @Y30LB25*/ 00959000
@EL00004 DS    0H                                                  0353 00960000
@EF00004 DS    0H                                                  0353 00961000
@ER00004 L     @14,@SA00004                                        0353 00962000
         BR    @14                                                 0353 00963000
*   END JRNLRPLV;                   /*                       @Y30LB25*/ 00964000
*                                                                  0355 00965000
*   /*****************************************************************/ 00966000
*   /*                                                               */ 00967000
*   /* PROCEDURE NAME - RMSVI                                @Y30LB25*/ 00968000
*   /*                                                       @Y30LB25*/ 00969000
*   /* FUNCTION - RESERVE .MSVI EXCLUSIVE.                   @Y30LB25*/ 00970000
*   /*                                                       @Y30LB25*/ 00971000
*   /* INPUT -                                               @Y30LB25*/ 00972000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 00973000
*   /*                                                       @Y30LB25*/ 00974000
*   /* OUTPUT -                                              @Y30LB25*/ 00975000
*   /* NONE                                                  @Y30LB25*/ 00976000
*   /*                                                               */ 00977000
*   /*****************************************************************/ 00978000
*                                                                  0355 00979000
*RMSVI:                             /*                       @Y30LB25*/ 00980000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 00981000
RMSVI    ST    @14,@SA00005                                        0355 00982000
*   RESPECIFY                       /*                       @Y30LB25*/ 00983000
*     RG0 RSTD;                     /* RESTRICT REG 0        @Y30LB25*/ 00984000
*   RESPECIFY                       /*                       @Y30LB25*/ 00985000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 00986000
*   RG0=RESEXINV;                   /* RESERVE .MSVI FLAG    @Y30LB25*/ 00987000
         LA    RG0,1                                               0358 00988000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 00989000
         L     RG1,RPLVPTR                                         0359 00990000
*   CALL ICBVRR00;                  /* RESERVE .MSVI         @Y30LB25*/ 00991000
         L     @15,@CV00763                                        0360 00992000
         BALR  @14,@15                                             0360 00993000
*   RESPECIFY                       /*                       @Y30LB25*/ 00994000
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Y30LB25*/ 00995000
*   RESPECIFY                       /*                       @Y30LB25*/ 00996000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 00997000
*   END RMSVI;                      /*                       @Y30LB25*/ 00998000
@EL00005 DS    0H                                                  0363 00999000
@EF00005 DS    0H                                                  0363 01000000
@ER00005 L     @14,@SA00005                                        0363 01001000
         BR    @14                                                 0363 01002000
*                                                                  0364 01003000
*   /*****************************************************************/ 01004000
*   /*                                                               */ 01005000
*   /* PROCEDURE NAME - RMSVIS                               @Y30LB25*/ 01006000
*   /*                                                       @Y30LB25*/ 01007000
*   /* FUNCTION - RESERVE .MSVI SHARED.                      @Y30LB25*/ 01008000
*   /*                                                       @Y30LB25*/ 01009000
*   /* INPUT -                                               @Y30LB25*/ 01010000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01011000
*   /*                                                       @Y30LB25*/ 01012000
*   /* OUTPUT -                                              @Y30LB25*/ 01013000
*   /* NONE                                                  @Y30LB25*/ 01014000
*   /*                                                               */ 01015000
*   /*****************************************************************/ 01016000
*                                                                  0364 01017000
*RMSVIS:                            /*                       @Y30LB25*/ 01018000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01019000
RMSVIS   ST    @14,@SA00006                                        0364 01020000
*   RESPECIFY                       /*                       @Y30LB25*/ 01021000
*     RG0 RSTD;                     /* RESTRICT REG 0        @Y30LB25*/ 01022000
*   RESPECIFY                       /*                       @Y30LB25*/ 01023000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 01024000
*   RG0=RESSHINV;                   /* RESERVE .MSVI FLAG    @Y30LB25*/ 01025000
         LA    RG0,2                                               0367 01026000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 01027000
         L     RG1,RPLVPTR                                         0368 01028000
*   CALL ICBVRR00;                  /* RESERVE .MSVI         @Y30LB25*/ 01029000
         L     @15,@CV00763                                        0369 01030000
         BALR  @14,@15                                             0369 01031000
*   RESPECIFY                       /*                       @Y30LB25*/ 01032000
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Y30LB25*/ 01033000
*   RESPECIFY                       /*                       @Y30LB25*/ 01034000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 01035000
*   END RMSVIS;                     /*                       @Y30LB25*/ 01036000
@EL00006 DS    0H                                                  0372 01037000
@EF00006 DS    0H                                                  0372 01038000
@ER00006 L     @14,@SA00006                                        0372 01039000
         BR    @14                                                 0372 01040000
*                                                                  0373 01041000
*   /*****************************************************************/ 01042000
*   /*                                                               */ 01043000
*   /* PROCEDURE NAME - INACVOL1                             @Y30LB25*/ 01044000
*   /*                                                       @Y30LB25*/ 01045000
*   /* FUNCTION - PROCESS MOVE AN INACTIVE VOLUME BEFORE     @Y30LB25*/ 01046000
*   /* THE CALL TO THE MSC.                                  @Y30LB25*/ 01047000
*   /* AN ICBMCRT EXTENSION IS REQUIRED.                     @Y30LB25*/ 01048000
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY. @Y30LB25*/ 01049000
*   /*                                                       @Y30LB25*/ 01050000
*   /* INPUT -                                               @Y30LB25*/ 01051000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01052000
*   /*                                                       @Y30LB25*/ 01053000
*   /* OUTPUT -                                              @Y30LB25*/ 01054000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01055000
*   /* AN ERROR                                              @Y30LB25*/ 01056000
*   /*                                                               */ 01057000
*   /*****************************************************************/ 01058000
*                                                                  0373 01059000
*INACVOL1:                          /*                       @Y30LB25*/ 01060000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01061000
*                                                                  0373 01062000
INACVOL1 ST    @14,@SA00007                                        0373 01063000
*   /*****************************************************************/ 01064000
*   /*                                                               */ 01065000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 01066000
*   /*                                                               */ 01067000
*   /*****************************************************************/ 01068000
*                                                                  0374 01069000
*   CALL RMSVIS;                    /* RESERVE .MSVI         @Y30LB25*/ 01070000
*                                                                  0374 01071000
         BAL   @14,RMSVIS                                          0374 01072000
*   /*****************************************************************/ 01073000
*   /*                                                               */ 01074000
*   /* READ FOR CIR TO GET TO THE CVR, DVR, OR BVR KEY.      @Y30LB25*/ 01075000
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    @Y30LB25*/ 01076000
*   /* NOT FOR UPDATE.                                       @Y30LB25*/ 01077000
*   /*                                                               */ 01078000
*   /*****************************************************************/ 01079000
*                                                                  0375 01080000
*   IVOLKY=MCRTCSN;                 /* SET CIR KEY           @Y30LB25*/ 01081000
         MVC   IVOLKY(12),MCRTCSN(MCRTPTR)                         0375 01082000
*   CALL GETRECLC;                  /* GET RECORD            @Y30LB25*/ 01083000
         BAL   @14,GETRECLC                                        0376 01084000
*   IF RPLRCODE=IOERROR             /* I/O ERROR?            @Y30LB25*/ 01085000
*     THEN                          /* YES                   @Y30LB25*/ 01086000
         L     @15,RPLVPTR                                         0377 01087000
         CLC   RPLRCODE(2,@15),@CB00713                            0377 01088000
         BE    @RT00377                                            0377 01089000
*     RETURN;                       /*                       @Y30LB25*/ 01090000
*   IF RPLRCODE=NORECFND&           /* NO RECD FND WITH      @Y30LB25*/ 01091000
*       (MCRTVEXT¬=FIXZERO&MCRREC=ON)/* RECORD OPTION ON?    @Y30LB25*/ 01092000
*     THEN                          /* YES                   @Y30LB25*/ 01093000
         CLC   RPLRCODE(2,@15),@CB00711                            0379 01094000
         BNE   @RF00379                                            0379 01095000
         L     @14,MCRTVEXT(,MCRTPTR)                              0379 01096000
         LTR   @14,@14                                             0379 01097000
         BZ    @RF00379                                            0379 01098000
         L     @01,MCRTEPTR                                        0379 01099000
         TM    MCRREC(@01),B'10000000'                             0379 01100000
         BNO   @RF00379                                            0379 01101000
*     DO;                           /*                       @Y30LB25*/ 01102000
*       RPLRCODE=RECDOPTN;          /* ERROR                 @Y30LB25*/ 01103000
         MVC   RPLRCODE(2,@15),@CB00733                            0381 01104000
*       RETURN;                     /*                       @Y30LB25*/ 01105000
@EL00007 DS    0H                                                  0382 01106000
@EF00007 DS    0H                                                  0382 01107000
@ER00007 L     @14,@SA00007                                        0382 01108000
         BR    @14                                                 0382 01109000
*     END;                          /*                       @Y30LB25*/ 01110000
*   IF RPLRCODE=NORECFND            /* NO RECD FND?          @Y30LB25*/ 01111000
*     THEN                          /* YES                   @Y30LB25*/ 01112000
@RF00379 L     @15,RPLVPTR                                         0384 01113000
         CLC   RPLRCODE(2,@15),@CB00711                            0384 01114000
         BNE   @RF00384                                            0384 01115000
*     DO;                           /*                       @Y30LB25*/ 01116000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* OK -                  @Y30LB25*/ 01117000
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0386 01118000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* NO ERROR              @Y30LB25*/ 01119000
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0387 01120000
*       RETURN;                     /*                       @Y30LB25*/ 01121000
         B     @EL00007                                            0388 01122000
*     END;                          /*                       @Y30LB25*/ 01123000
*   BCDVPTR=RPLVBUF;                /* ADDR OF MSVC RECD     @Y30LB25*/ 01124000
@RF00384 L     @01,RPLVPTR                                         0390 01125000
         L     @15,RPLVBUF(,@01)                                   0390 01126000
         ST    @15,BCDVPTR                                         0390 01127000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 01128000
*     THEN                          /* YES                   @Y30LB25*/ 01129000
         TM    BCDCOPY(@15),B'00010000'                            0391 01130000
         BO    @RT00391                                            0391 01131000
*     RETURN;                       /*                       @Y30LB25*/ 01132000
*                                                                  0392 01133000
*   /*****************************************************************/ 01134000
*   /*                                                               */ 01135000
*   /* PROCESS THE MOVE CARTRIDGE EXTENSION.                 @Y30LB25*/ 01136000
*   /*                                                               */ 01137000
*   /*****************************************************************/ 01138000
*                                                                  0393 01139000
*   CALL PROMCRTE;                  /* PROCESS IEZMCRTE      @Y30LB25*/ 01140000
         BAL   @14,PROMCRTE                                        0393 01141000
*   RETURN;                         /*                       @Y30LB25*/ 01142000
         B     @EL00007                                            0394 01143000
*   END INACVOL1;                   /*                       @Y30LB25*/ 01144000
         B     @EL00007                                            0395 01145000
*                                                                  0396 01146000
*   /*****************************************************************/ 01147000
*   /*                                                               */ 01148000
*   /* PROCEDURE NAME - GETRECLC                             @Y30LB25*/ 01149000
*   /*                                                       @Y30LB25*/ 01150000
*   /* FUNCTION - READ FOR A CIR USING THE INPUT CSN, THEN   @Y30LB25*/ 01151000
*   /* GET THE MSVC RECORD FROM ITS KEY IN THE CIR           @Y30LB25*/ 01152000
*   /* ALL IN THE LOCATE MODE.                               @Y30LB25*/ 01153000
*   /*                                                       @Y30LB25*/ 01154000
*   /* INPUT -                                               @Y30LB25*/ 01155000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01156000
*   /*                                                       @Y30LB25*/ 01157000
*   /* OUTPUT -                                              @Y30LB25*/ 01158000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01159000
*   /* AN ERROR                                              @Y30LB25*/ 01160000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/ 01161000
*   /*                                                               */ 01162000
*   /*****************************************************************/ 01163000
*                                                                  0396 01164000
*GETRECLC:                          /*                       @Y30LB25*/ 01165000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01166000
GETRECLC ST    @14,@SA00008                                        0396 01167000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           @Y30LB25*/ 01168000
         L     @15,RPLVPTR                                         0397 01169000
         LA    @14,IKEY                                            0397 01170000
         ST    @14,RPLVKEY(,@15)                                   0397 01171000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 01172000
         MVI   RPLVTYP(@15),X'00'                                  0398 01173000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 01174000
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/ 01175000
         OI    RPLVDIR(@15),B'11000000'                            0400 01176000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/ 01177000
         NI    RPLVUPD(@15),B'11111101'                            0401 01178000
*   RESPECIFY                       /*                       @Y30LB25*/ 01179000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 01180000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 01181000
         LR    RG1,@15                                             0403 01182000
*   CALL ICBVIO00;                  /* READ CIR              @Y30LB25*/ 01183000
         L     @15,@CV00762                                        0404 01184000
         BALR  @14,@15                                             0404 01185000
*   IF RPLVRETC¬=FIXZERO            /* ERROR                 @Y30LB25*/ 01186000
*     THEN                          /* YES                   @Y30LB25*/ 01187000
         L     @15,RPLVPTR                                         0405 01188000
         LH    @00,RPLVRETC(,@15)                                  0405 01189000
         N     @00,@CF01129                                        0405 01190000
         LTR   @00,@00                                             0405 01191000
         BNZ   @RT00405                                            0405 01192000
*     RETURN;                       /*                       @Y30LB25*/ 01193000
*   INDEXPTR=RPLVBUF;               /* SET MAPPING           @Y30LB25*/ 01194000
         L     @00,RPLVBUF(,@15)                                   0407 01195000
         ST    @00,INDEXPTR                                        0407 01196000
*   BCDKEY=INDRECKY;                /* SET KEY               @Y30LB25*/ 01197000
         LR    @14,@00                                             0408 01198000
         MVC   BCDKEY(13),INDRECKY(@14)                            0408 01199000
*   RPLVKEY=ADDR(BCDKEY);           /* SET KEY ADDR          @Y30LB25*/ 01200000
         LA    @00,BCDKEY                                          0409 01201000
         ST    @00,RPLVKEY(,@15)                                   0409 01202000
*   CALL ICBVIO00;                  /* READ RECORD           @Y30LB25*/ 01203000
         L     @15,@CV00762                                        0410 01204000
         BALR  @14,@15                                             0410 01205000
*   RESPECIFY                       /*                       @Y30LB25*/ 01206000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 01207000
*   RETURN;                         /*                       @Y30LB25*/ 01208000
@EL00008 DS    0H                                                  0412 01209000
@EF00008 DS    0H                                                  0412 01210000
@ER00008 L     @14,@SA00008                                        0412 01211000
         BR    @14                                                 0412 01212000
*   END GETRECLC;                   /*                       @Y30LB25*/ 01213000
         B     @EL00008                                            0413 01214000
*                                                                  0414 01215000
*   /*****************************************************************/ 01216000
*   /*                                                               */ 01217000
*   /* PROCEDURE NAME - INACVOL2                             @Y30LB25*/ 01218000
*   /*                                                       @Y30LB25*/ 01219000
*   /* FUNCTION - PROCESS MOVE AN INACTIVE VOLUME AFTER      @Y30LB25*/ 01220000
*   /* THE CALL TO THE MSC.                                  @Y30LB25*/ 01221000
*   /* AN ICBMCRT EXTENSION IS REQUIRED.                     @Y30LB25*/ 01222000
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY  @Y30LB25*/ 01223000
*   /*                                                       @Y30LB25*/ 01224000
*   /* INPUT -                                               @Y30LB25*/ 01225000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01226000
*   /*                                                       @Y30LB25*/ 01227000
*   /* OUTPUT -                                              @Y30LB25*/ 01228000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01229000
*   /* AN ERROR                                              @Y30LB25*/ 01230000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/ 01231000
*   /*                                                               */ 01232000
*   /*****************************************************************/ 01233000
*                                                                  0414 01234000
*INACVOL2:                          /*                       @Y30LB25*/ 01235000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01236000
*                                                                  0414 01237000
INACVOL2 ST    @14,@SA00009                                        0414 01238000
*   /*****************************************************************/ 01239000
*   /*                                                               */ 01240000
*   /* CHECK FOR AN MSC ERRROR OTHER THAT ONE                @VS32198*/ 01241000
*   /* CARTRIDGE EJECTED.                                    @VS32198*/ 01242000
*   /*                                                               */ 01243000
*   /*****************************************************************/ 01244000
*                                                                  0415 01245000
*   IF RPLRCODE¬=EJEC1CRT&RPLVRETC¬=FIXZERO/* MSC ERROR?     @ZA13487*/ 01246000
*     THEN                          /* YES                   @Y30LB25*/ 01247000
         L     @15,RPLVPTR                                         0415 01248000
         CLC   RPLRCODE(2,@15),@CB00701                            0415 01249000
         BE    @RF00415                                            0415 01250000
         LH    @14,RPLVRETC(,@15)                                  0415 01251000
         N     @14,@CF01129                                        0415 01252000
         LTR   @14,@14                                             0415 01253000
         BZ    @RF00415                                            0415 01254000
*     DO;                           /*                       @VS32198*/ 01255000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @VS32198*/ 01256000
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0417 01257000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @VS32198*/ 01258000
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0418 01259000
*       RETURN;                     /*                       @VS32198*/ 01260000
@EL00009 DS    0H                                                  0419 01261000
@EF00009 DS    0H                                                  0419 01262000
@ER00009 L     @14,@SA00009                                        0419 01263000
         BR    @14                                                 0419 01264000
*     END;                          /*                       @VS32198*/ 01265000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @VS32198   01266000
*                                      RESERVE .MSVI         @VS32198*/ 01267000
*                                                                  0421 01268000
@RF00415 BAL   @14,HOUSKEEP                                        0421 01269000
*   /*****************************************************************/ 01270000
*   /*                                                               */ 01271000
*   /* ONE CARTRIDGE EJECTED IS OK.                          @VS32198*/ 01272000
*   /*                                                               */ 01273000
*   /*****************************************************************/ 01274000
*                                                                  0422 01275000
*   IF RPLRCODE=EJEC1CRT            /* 1 CART EJECTED?       @VS32198*/ 01276000
*     THEN                          /* YES                   @VS32198*/ 01277000
         L     @15,RPLVPTR                                         0422 01278000
         CLC   RPLRCODE(2,@15),@CB00701                            0422 01279000
         BNE   @RF00422                                            0422 01280000
*     DO;                           /* OK                    @VS32198*/ 01281000
*       REACODE=RPLRCODE;           /* SAVE REASON CODE      @VS32198*/ 01282000
         MVC   REACODE(2),RPLRCODE(@15)                            0424 01283000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 01284000
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0425 01285000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 01286000
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0426 01287000
*     END;                          /*                       @VS32198*/ 01288000
*                                                                  0427 01289000
*   /*****************************************************************/ 01290000
*   /*                                                               */ 01291000
*   /* READ FOR CIR TO GET THE CVR, BVR, OR DVR KEY.         @Y30LB25*/ 01292000
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    @Y30LB25*/ 01293000
*   /* FOR UPDATE                                            @Y30LB25*/ 01294000
*   /*                                                               */ 01295000
*   /*****************************************************************/ 01296000
*                                                                  0428 01297000
*   IVOLKY=MCRTCSN;                 /* SET CIR KEY           @Y30LB25*/ 01298000
@RF00422 MVC   IVOLKY(12),MCRTCSN(MCRTPTR)                         0428 01299000
*   CALL GETRECUD;                  /* GET RECORD            @Y30LB25*/ 01300000
         BAL   @14,GETRECUD                                        0429 01301000
*   IF RPLRCODE=IOERROR             /* I/O ERROR?            @Y30LB25*/ 01302000
*     THEN                          /* YES                   @Y30LB25*/ 01303000
         L     @15,RPLVPTR                                         0430 01304000
         CLC   RPLRCODE(2,@15),@CB00713                            0430 01305000
         BE    @RT00430                                            0430 01306000
*     RETURN;                       /*                       @Y30LB25*/ 01307000
*   IF RPLRCODE=NORECFND            /* NO RECD FND?          @Y30LB25*/ 01308000
*     THEN                          /* YES                   @Y30LB25*/ 01309000
         CLC   RPLRCODE(2,@15),@CB00711                            0432 01310000
         BNE   @RF00432                                            0432 01311000
*     DO;                           /*                       @Y30LB25*/ 01312000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* OK -                  @Y30LB25*/ 01313000
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0434 01314000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* NO ERROR              @Y30LB25*/ 01315000
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0435 01316000
*       RETURN;                     /*                       @Y30LB25*/ 01317000
         B     @EL00009                                            0436 01318000
*     END;                          /*                       @Y30LB25*/ 01319000
*                                                                  0437 01320000
*   /*****************************************************************/ 01321000
*   /*                                                               */ 01322000
*   /* PROCESS MCRTE                                         @Y30LB25*/ 01323000
*   /*                                                               */ 01324000
*   /*****************************************************************/ 01325000
*                                                                  0438 01326000
*   BCDVPTR=BASEVPTR;               /* ADDR OF MSVC RECD     @Y30LB25*/ 01327000
@RF00432 L     @15,BASEVPTR                                        0438 01328000
         ST    @15,BCDVPTR                                         0438 01329000
*   INDEXPTR=ADDR(INDEXBUF);        /* RESET BUF PTR         @Y30LB25*/ 01330000
         LA    @15,INDEXBUF                                        0439 01331000
         ST    @15,INDEXPTR                                        0439 01332000
*   CALL PROMCRTE;                  /* PROCESS IEZMCRTE      @Y30LB25*/ 01333000
         BAL   @14,PROMCRTE                                        0440 01334000
*   RETURN;                         /*                       @Y30LB25*/ 01335000
         B     @EL00009                                            0441 01336000
*   END INACVOL2;                   /*                       @Y30LB25*/ 01337000
         B     @EL00009                                            0442 01338000
*                                                                  0443 01339000
*   /*****************************************************************/ 01340000
*   /*                                                               */ 01341000
*   /* PROCEDURE NAME - HOUSKEEP                             @Y30LB25*/ 01342000
*   /*                                                       @Y30LB25*/ 01343000
*   /* FUNCTION-                                             @Y30LB25*/ 01344000
*   /* JOURNALS THE RPLV AND RESERVES .MSVI FOR PROCESSING   @Y30LB25*/ 01345000
*   /* AFTER THE MSC IS DONE.                                @Y30LB25*/ 01346000
*   /*                                                       @Y30LB25*/ 01347000
*   /* INPUT -                                               @Y30LB25*/ 01348000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01349000
*   /*                                                       @Y30LB25*/ 01350000
*   /* OUTPUT -                                              @Y30LB25*/ 01351000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01352000
*   /* AN ERROR                                              @Y30LB25*/ 01353000
*   /*                                                               */ 01354000
*   /*****************************************************************/ 01355000
*                                                                  0443 01356000
*HOUSKEEP:                          /*                       @Y30LB25*/ 01357000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01358000
*                                                                  0443 01359000
HOUSKEEP ST    @14,@SA00010                                        0443 01360000
*   /*****************************************************************/ 01361000
*   /*                                                               */ 01362000
*   /* JOURNAL THE RPLV                                      @Y30LB25*/ 01363000
*   /*                                                               */ 01364000
*   /*****************************************************************/ 01365000
*                                                                  0444 01366000
*   RETCODE=RPLVRETC;               /* SAVE RETN CODE        @VS32192*/ 01367000
         L     @15,RPLVPTR                                         0444 01368000
         MVC   RETCODE(2),RPLVRETC(@15)                            0444 01369000
*   REACODE=RPLRCODE;               /* SAVE RESN CODE        @VS32192*/ 01370000
         MVC   REACODE(2),RPLRCODE(@15)                            0445 01371000
*   CALL JRNLRPLV;                  /* JOURNAL RPLV          @Y30LB25*/ 01372000
*                                                                  0446 01373000
         BAL   @14,JRNLRPLV                                        0446 01374000
*   /*****************************************************************/ 01375000
*   /*                                                               */ 01376000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 01377000
*   /*                                                               */ 01378000
*   /*****************************************************************/ 01379000
*                                                                  0447 01380000
*   CALL RMSVI;                     /* RESERVE MSVI          @Y30LB25*/ 01381000
         BAL   @14,RMSVI                                           0447 01382000
*   RPLVRETC=RETCODE;               /* REST RETN CODE        @VS32192*/ 01383000
         L     @15,RPLVPTR                                         0448 01384000
         MVC   RPLVRETC(2,@15),RETCODE                             0448 01385000
*   RPLRCODE=REACODE;               /* REST RESN CODE        @VS32192*/ 01386000
         MVC   RPLRCODE(2,@15),REACODE                             0449 01387000
*   RETURN;                         /*                       #Y30LB25*/ 01388000
@EL00010 DS    0H                                                  0450 01389000
@EF00010 DS    0H                                                  0450 01390000
@ER00010 L     @14,@SA00010                                        0450 01391000
         BR    @14                                                 0450 01392000
*   END HOUSKEEP;                   /*                       #Y30LB25*/ 01393000
*                                                                  0452 01394000
*   /*****************************************************************/ 01395000
*   /*                                                               */ 01396000
*   /* PROCEDURE NAME - GETRECUD                             @Y30LB25*/ 01397000
*   /*                                                       @Y30LB25*/ 01398000
*   /* FUNCTION - READ A CIR IN THE LOCATE MODE USING        @Y30LB25*/ 01399000
*   /* THE INPUT CSN, GET THE MSVC RECORD FOR UPDATE         @Y30LB25*/ 01400000
*   /* FROM ITS KEY IN THE CIR.                              @Y30LB25*/ 01401000
*   /*                                                       @Y30LB25*/ 01402000
*   /* INPUT -                                               @Y30LB25*/ 01403000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01404000
*   /*                                                       @Y30LB25*/ 01405000
*   /* OUTPUT -                                              @Y30LB25*/ 01406000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01407000
*   /* AN ERROR                                              @Y30LB25*/ 01408000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/ 01409000
*   /*                                                               */ 01410000
*   /*****************************************************************/ 01411000
*                                                                  0452 01412000
*GETRECUD:                          /*                       @Y30LB25*/ 01413000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01414000
GETRECUD ST    @14,@SA00011                                        0452 01415000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           @Y30LB25*/ 01416000
         L     @15,RPLVPTR                                         0453 01417000
         LA    @14,IKEY                                            0453 01418000
         ST    @14,RPLVKEY(,@15)                                   0453 01419000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 01420000
         MVI   RPLVTYP(@15),X'00'                                  0454 01421000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 01422000
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/ 01423000
         OI    RPLVDIR(@15),B'11000000'                            0456 01424000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/ 01425000
         NI    RPLVUPD(@15),B'11111101'                            0457 01426000
*   RESPECIFY                       /*                       @Y30LB25*/ 01427000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 01428000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 01429000
         LR    RG1,@15                                             0459 01430000
*   CALL ICBVIO00;                  /* READ CIR              @Y30LB25*/ 01431000
         L     @15,@CV00762                                        0460 01432000
         BALR  @14,@15                                             0460 01433000
*   IF RPLVRETC¬=FIXZERO            /* ERROR                 @Y30LB25*/ 01434000
*     THEN                          /* YES                   @Y30LB25*/ 01435000
         L     @15,RPLVPTR                                         0461 01436000
         LH    @00,RPLVRETC(,@15)                                  0461 01437000
         N     @00,@CF01129                                        0461 01438000
         LTR   @00,@00                                             0461 01439000
         BNZ   @RT00461                                            0461 01440000
*     RETURN;                       /*                       @Y30LB25*/ 01441000
*   INDEXPTR=RPLVBUF;               /* SET MAPPING           @Y30LB25*/ 01442000
         L     @00,RPLVBUF(,@15)                                   0463 01443000
         ST    @00,INDEXPTR                                        0463 01444000
*   BCDKEY=INDRECKY;                /* SET KEY               @Y30LB25*/ 01445000
         LR    @14,@00                                             0464 01446000
         MVC   BCDKEY(13),INDRECKY(@14)                            0464 01447000
*   RPLVKEY=ADDR(BCDKEY);           /* SET KEY ADDR          @Y30LB25*/ 01448000
         LA    @00,BCDKEY                                          0465 01449000
         ST    @00,RPLVKEY(,@15)                                   0465 01450000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 01451000
         NI    RPLVLOC(@15),B'01111111'                            0466 01452000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 01453000
         OI    RPLVUPD(@15),B'00000010'                            0467 01454000
*   RPLVBUF=ADDR(BASEBUF);          /* BUF ADDR              @Y30LB25*/ 01455000
         LA    @00,BASEBUF                                         0468 01456000
         ST    @00,RPLVBUF(,@15)                                   0468 01457000
*   RPLVBLN=LENGTH(BASEBUF);        /* BUFF LENGTH           @Y30LB25*/ 01458000
         MVC   RPLVBLN(4,@15),@CF01103                             0469 01459000
*   CALL ICBVIO00;                  /* READ RECORD           @Y30LB25*/ 01460000
         L     @15,@CV00762                                        0470 01461000
         BALR  @14,@15                                             0470 01462000
*   RESPECIFY                       /*                       @Y30LB25*/ 01463000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 01464000
*   RETURN;                         /*                       @Y30LB25*/ 01465000
@EL00011 DS    0H                                                  0472 01466000
@EF00011 DS    0H                                                  0472 01467000
@ER00011 L     @14,@SA00011                                        0472 01468000
         BR    @14                                                 0472 01469000
*   END GETRECUD;                   /*                       @Y30LB25*/ 01470000
         B     @EL00011                                            0473 01471000
*                                                                  0474 01472000
*   /*****************************************************************/ 01473000
*   /*                                                               */ 01474000
*   /* PROCEDURE NAME - PROMCRTE                             @Y30LB25*/ 01475000
*   /*                                                       @Y30LB25*/ 01476000
*   /* FUNCTION - PROCESS IEZMCRTE.                          @Y30LB25*/ 01477000
*   /*                                                       @Y30LB25*/ 01478000
*   /* INPUT -                                               @Y30LB25*/ 01479000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01480000
*   /*                                                       @Y30LB25*/ 01481000
*   /* OUTPUT -                                              @Y30LB25*/ 01482000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01483000
*   /* AN ERROR                                              @Y30LB25*/ 01484000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/ 01485000
*   /*                                                               */ 01486000
*   /*****************************************************************/ 01487000
*                                                                  0474 01488000
*PROMCRTE:                          /*                       @Y30LB25*/ 01489000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01490000
*                                                                  0474 01491000
PROMCRTE ST    @14,@SA00012                                        0474 01492000
*   /*****************************************************************/ 01493000
*   /*                                                               */ 01494000
*   /* CHECK FOR BEFORE THE CALL TO THE MSC.                 @Y30LB25*/ 01495000
*   /*                                                               */ 01496000
*   /*****************************************************************/ 01497000
*                                                                  0475 01498000
*   IF RPLFTIME=OFF                 /* BEFORE MSC CALL?      @Y30LB25*/ 01499000
*     THEN                          /* YES                   @Y30LB25*/ 01500000
         L     @15,RPLVPTR                                         0475 01501000
         TM    RPLFTIME(@15),B'10000000'                           0475 01502000
         BNZ   @RF00475                                            0475 01503000
*     DO;                           /*                       @Y30LB25*/ 01504000
*                                                                  0476 01505000
*       /*************************************************************/ 01506000
*       /*                                                           */ 01507000
*       /* CHECK FOR DVR WITH KEEP RECORD OPTION ON.         @Y30LB25*/ 01508000
*       /*                                                           */ 01509000
*       /*************************************************************/ 01510000
*                                                                  0477 01511000
*       IF BCDDUP=ON&               /* DVR WITH RECORD       @Y30LB25*/ 01512000
*           (MCRTVEXT¬=FIXZERO&MCRREC=ON)/* OPTION ON?       @Y30LB25*/ 01513000
*         THEN                      /* YES                   @Y30LB25*/ 01514000
         L     @01,BCDVPTR                                         0477 01515000
         TM    BCDDUP(@01),B'00000100'                             0477 01516000
         BNO   @RF00477                                            0477 01517000
         L     @14,MCRTVEXT(,MCRTPTR)                              0477 01518000
         LTR   @14,@14                                             0477 01519000
         BZ    @RF00477                                            0477 01520000
         L     @01,MCRTEPTR                                        0477 01521000
         TM    MCRREC(@01),B'10000000'                             0477 01522000
         BNO   @RF00477                                            0477 01523000
*         DO;                       /*                       @Y30LB25*/ 01524000
*           RPLVRETC=FIXFOUR;       /* ERROR RETURN CODE     @Y30LB25*/ 01525000
         MVC   RPLVRETC(2,@15),@CH00041                            0479 01526000
*           RPLRCODE=RECOPDVR;      /* ERROR REASON CODE     @Y30LB25*/ 01527000
         MVC   RPLRCODE(2,@15),@CB00717                            0480 01528000
*           RETURN;                 /*                       @Y30LB25*/ 01529000
@EL00012 DS    0H                                                  0481 01530000
@EF00012 DS    0H                                                  0481 01531000
@ER00012 L     @14,@SA00012                                        0481 01532000
         BR    @14                                                 0481 01533000
*         END;                      /*                       @Y30LB25*/ 01534000
*                                                                  0482 01535000
*       /*************************************************************/ 01536000
*       /*                                                           */ 01537000
*       /* CHECK FOR BVR WITH COPIES, BUT KEEP RECORD        @Y30LB25*/ 01538000
*       /* OPTION OFF.                                       @Y30LB25*/ 01539000
*       /*                                                           */ 01540000
*       /*************************************************************/ 01541000
*                                                                  0483 01542000
*       BASEVPTR=RPLVBUF;           /* MAP BVR               @Y30LB25*/ 01543000
@RF00477 L     @15,RPLVPTR                                         0483 01544000
         L     @14,RPLVBUF(,@15)                                   0483 01545000
         ST    @14,BASEVPTR                                        0483 01546000
*       IF BCDBASE=ON&(MCRTVEXT¬=FIXZERO&MCRREC=OFF)&BASNCOPY¬=FIXZERO  01547000
*                                   /* BVR, RECORD OPTN      @Y30LB25   01548000
*                                      OFF, - WITH CPYS?     @Y30LB25*/ 01549000
*         THEN                      /* YES                   @Y30LB25*/ 01550000
         L     @01,BCDVPTR                                         0484 01551000
         TM    BCDBASE(@01),B'00100000'                            0484 01552000
         BNO   @RF00484                                            0484 01553000
         L     @05,MCRTVEXT(,MCRTPTR)                              0484 01554000
         LTR   @05,@05                                             0484 01555000
         BZ    @RF00484                                            0484 01556000
         L     @01,MCRTEPTR                                        0484 01557000
         TM    MCRREC(@01),B'10000000'                             0484 01558000
         BNZ   @RF00484                                            0484 01559000
         CLI   BASNCOPY(@14),0                                     0484 01560000
         BE    @RF00484                                            0484 01561000
*         DO;                       /*                       @Y30LB25*/ 01562000
*           RPLVRETC=FIXFOUR;       /* ERROR RETURN CODE     @Y30LB25*/ 01563000
         MVC   RPLVRETC(2,@15),@CH00041                            0486 01564000
*           RPLRCODE=RECOPBVR;      /* ERROR REASON CODE     @Y30LB25*/ 01565000
         MVC   RPLRCODE(2,@15),@CB00719                            0487 01566000
*           RETURN;                 /*                       @Y30LB25*/ 01567000
         B     @EL00012                                            0488 01568000
*         END;                      /*                       @Y30LB25*/ 01569000
*                                                                  0489 01570000
*       /*************************************************************/ 01571000
*       /*                                                           */ 01572000
*       /* CHECK FOR REASSIGNED BVR.                         @Y30LB25*/ 01573000
*       /*                                                           */ 01574000
*       /*************************************************************/ 01575000
*                                                                  0490 01576000
*       IF BCDBASE=ON&BASREASS=ON   /* REASS BVR?            @Y30LB25*/ 01577000
*         THEN                      /* YES                   @Y30LB25*/ 01578000
@RF00484 L     @06,BCDVPTR                                         0490 01579000
         TM    BCDBASE(@06),B'00100000'                            0490 01580000
         BNO   @RF00490                                            0490 01581000
         L     @06,BASEVPTR                                        0490 01582000
         TM    BASREASS(@06),B'00100000'                           0490 01583000
         BNO   @RF00490                                            0490 01584000
*         DO;                       /*                       @Y30LB25*/ 01585000
*           RPLVRETC=FIXFOUR;       /* ERROR RETN CODE       @Y30LB25*/ 01586000
         L     @06,RPLVPTR                                         0492 01587000
         MVC   RPLVRETC(2,@06),@CH00041                            0492 01588000
*           RPLRCODE=REASSIGN;      /* REASSIGNED            @Y30LB25*/ 01589000
         MVC   RPLRCODE(2,@06),@CB00737                            0493 01590000
*         END;                      /*                       @Y30LB25*/ 01591000
*       RETURN;                     /*                       @Y30LB25*/ 01592000
         B     @EL00012                                            0495 01593000
*     END;                          /*                       @Y30LB25*/ 01594000
*                                                                  0496 01595000
*   /*****************************************************************/ 01596000
*   /*                                                               */ 01597000
*   /* PROCESSING AFTER THE MSC WAS CALLED.                  @Y30LB25*/ 01598000
*   /*                                                               */ 01599000
*   /*****************************************************************/ 01600000
*                                                                  0497 01601000
*   ELSE                            /* AFTER MSC CALL        @Y30LB25*/ 01602000
*     DO;                           /*                       @Y30LB25*/ 01603000
*                                                                  0497 01604000
@RF00475 DS    0H                                                  0498 01605000
*       /*************************************************************/ 01606000
*       /*                                                           */ 01607000
*       /* CHECK KEEP RECORD OPTION                          @Y30LB25*/ 01608000
*       /*                                                           */ 01609000
*       /*************************************************************/ 01610000
*                                                                  0498 01611000
*       IF(MCRTVEXT¬=FIXZERO&MCRREC=ON)|MCRTVEXT=FIXZERO/* KEEP RECD    01612000
*                                      OPT ON?               @Y30LB25*/ 01613000
*         THEN                      /* YES                   @Y30LB25*/ 01614000
         L     @15,MCRTVEXT(,MCRTPTR)                              0498 01615000
         LTR   @15,@15                                             0498 01616000
         BZ    @GL00011                                            0498 01617000
         L     @01,MCRTEPTR                                        0498 01618000
         TM    MCRREC(@01),B'10000000'                             0498 01619000
         BO    @RT00498                                            0498 01620000
@GL00011 L     @15,MCRTVEXT(,MCRTPTR)                              0498 01621000
         LTR   @15,@15                                             0498 01622000
         BNZ   @RF00498                                            0498 01623000
@RT00498 DS    0H                                                  0499 01624000
*         DO;                       /*                       @Y30LB25*/ 01625000
*                                                                  0499 01626000
*           /*********************************************************/ 01627000
*           /*                                                       */ 01628000
*           /* NULL LIB ID FIELD(S).                         @Y30LB25*/ 01629000
*           /*                                                       */ 01630000
*           /*********************************************************/ 01631000
*                                                                  0500 01632000
*           IF REACODE=EJEC1CRT     /* 1 CART EJECTED?       @Y30LB25*/ 01633000
*             THEN                  /* YES                   @Y30LB25*/ 01634000
         CLC   REACODE(2),@CB00701                                 0500 01635000
         BNE   @RF00500                                            0500 01636000
*             BCDLIB1=FIX1F;        /* NULL LIBID1           @Y30LB25*/ 01637000
         L     @01,BCDVPTR                                         0501 01638000
         MVI   BCDLIB1(@01),X'FF'                                  0501 01639000
*           ELSE                    /*                       @Y30LB25*/ 01640000
*             DO;                   /* 2 CARTS EJSCTED       @Y30LB25*/ 01641000
         B     @RC00500                                            0502 01642000
@RF00500 DS    0H                                                  0503 01643000
*               BCDLIB1=FIX1F;      /*                       @Y30LB25   01644000
*                                      NULL LIBID1           @Y30LB25*/ 01645000
         L     @15,BCDVPTR                                         0503 01646000
         MVI   BCDLIB1(@15),X'FF'                                  0503 01647000
*               BCDLIB2=FIX1F;      /*                       @Y30LB25   01648000
*                                      NULL LIBID2           @Y30LB25*/ 01649000
         MVI   BCDLIB2(@15),X'FF'                                  0504 01650000
*             END;                  /*                       @Y30LB25*/ 01651000
*                                                                  0505 01652000
*           /*********************************************************/ 01653000
*           /*                                                       */ 01654000
*           /* CHECK FOR RECOVERY RPLV AND IF SO USE THE     @ZA13484*/ 01655000
*           /* DATE THE RPLV WAS CREATED.                    @ZA13484*/ 01656000
*           /*                                                       */ 01657000
*           /*********************************************************/ 01658000
*                                                                  0506 01659000
*           IF RPLJRCVY=ON&RPLVDATE¬=NULLDATE THEN/* RECOVERY?     0506 01660000
*                                                            @ZA13484*/ 01661000
@RC00500 L     @15,RPLVPTR                                         0506 01662000
         TM    RPLJRCVY(@15),B'00000010'                           0506 01663000
         BNO   @RF00506                                            0506 01664000
         CLC   RPLVDATE(4,@15),NULLDATE                            0506 01665000
         BE    @RF00506                                            0506 01666000
*             DO;                   /* YES                   @ZA13484*/ 01667000
*               IF BCDCOPY=ON THEN  /* CVR?                  @ZA13484*/ 01668000
         L     @06,BCDVPTR                                         0508 01669000
         TM    BCDCOPY(@06),B'00010000'                            0508 01670000
         BNO   @RF00508                                            0508 01671000
*                 DO;               /* YES                   @ZA13484*/ 01672000
*                   COPYVPTR=BCDVPTR;/* SET CVR PTR          @ZA13484*/ 01673000
         ST    @06,COPYVPTR                                        0510 01674000
*                   COPDTREM=RPLVDATE;/* SET DATE            @ZA13484*/ 01675000
         MVC   COPDTREM(4,@06),RPLVDATE(@15)                       0511 01676000
*                 END;              /*                       @ZA13484*/ 01677000
*               IF BCDBASE=ON THEN  /* BVR?                  @ZA13484*/ 01678000
@RF00508 L     @06,BCDVPTR                                         0513 01679000
         TM    BCDBASE(@06),B'00100000'                            0513 01680000
         BNO   @RF00513                                            0513 01681000
*                 BASDTREM=RPLVDATE;/* SET DATE              @ZA13484*/ 01682000
         L     @06,BASEVPTR                                        0514 01683000
         L     @01,RPLVPTR                                         0514 01684000
         MVC   BASDTREM(4,@06),RPLVDATE(@01)                       0514 01685000
*             END;                  /*                       @ZA13484*/ 01686000
*           ELSE                                                   0516 01687000
*             DO;                   /*                       @ZA13484*/ 01688000
*                                                                  0516 01689000
         B     @RC00506                                            0516 01690000
@RF00506 DS    0H                                                  0517 01691000
*               /*****************************************************/ 01692000
*               /*                                                   */ 01693000
*               /* UPDATE THE LOCATION AND EJECT DATE.       @Y30LB25*/ 01694000
*               /* GET AND SET THE CURRENT DATE              @Y30LB25*/ 01695000
*               /*                                                   */ 01696000
*               /*****************************************************/ 01697000
*                                                                  0517 01698000
*               CALL ICBVUEXP(FIXZERO,RPLVPTR,EXPRDT);/*     @ZA30662   01699000
*                                      GET CURRENT DATE      @Y30LB25*/ 01700000
         L     @15,@CV00768                                        0517 01701000
         LA    @01,@AL00517                                        0517 01702000
         BALR  @14,@15                                             0517 01703000
*               IF BCDCOPY=ON       /* CVR LOCATION?         @Y30LB25*/ 01704000
*                 THEN              /* YES                   @Y30LB25*/ 01705000
         L     @15,BCDVPTR                                         0518 01706000
         TM    BCDCOPY(@15),B'00010000'                            0518 01707000
         BNO   @RF00518                                            0518 01708000
*                 DO;               /*                       @Y30LB25*/ 01709000
*                   COPYVPTR=BCDVPTR;/*                      @Y30LB25   01710000
*                                      ADDR CVR              @Y30LB25*/ 01711000
         ST    @15,COPYVPTR                                        0520 01712000
*                   IF MCRTVEXT¬=FIXZERO&MCRSPLOC=ON THEN          0521 01713000
         L     @14,MCRTVEXT(,MCRTPTR)                              0521 01714000
         LTR   @14,@14                                             0521 01715000
         BZ    @RF00521                                            0521 01716000
         L     @14,MCRTEPTR                                        0521 01717000
         TM    MCRSPLOC(@14),B'10000000'                           0521 01718000
         BNO   @RF00521                                            0521 01719000
*                     COPDEST=MCRLOC;/* UPDATE DESTIN        @Y30LB25*/ 01720000
         MVC   COPDEST(30,@15),MCRLOC(@14)                         0522 01721000
*                   COPDTREM=EXPRDT;/*                       @Y30LB25   01722000
*                                      SET EJECT DATE        @Y30LB25*/ 01723000
@RF00521 L     @01,COPYVPTR                                        0523 01724000
         MVC   COPDTREM(4,@01),EXPRDT                              0523 01725000
*                 END;              /*                       @Y30LB25*/ 01726000
*               IF BCDBASE=ON       /* BVR LOCATION?         @Y30LB25*/ 01727000
*                 THEN              /* YES                   @Y30LB25*/ 01728000
@RF00518 L     @01,BCDVPTR                                         0525 01729000
         TM    BCDBASE(@01),B'00100000'                            0525 01730000
         BNO   @RF00525                                            0525 01731000
*                 DO;               /*                       @Y30LB25*/ 01732000
*                   IF MCRTVEXT¬=FIXZERO&MCRSPLOC=ON THEN          0527 01733000
         L     @15,MCRTVEXT(,MCRTPTR)                              0527 01734000
         LTR   @15,@15                                             0527 01735000
         BZ    @RF00527                                            0527 01736000
         L     @15,MCRTEPTR                                        0527 01737000
         TM    MCRSPLOC(@15),B'10000000'                           0527 01738000
         BNO   @RF00527                                            0527 01739000
*                     BASDEST=MCRLOC;/* UPDATE DESTIN        @Y30LB25*/ 01740000
         L     @06,BASEVPTR                                        0528 01741000
         MVC   BASDEST(30,@06),MCRLOC(@15)                         0528 01742000
*                   BASDTREM=EXPRDT;/*                       @Y30LB25   01743000
*                                      SET EJECT DATE        @Y30LB25*/ 01744000
@RF00527 L     @06,BASEVPTR                                        0529 01745000
         MVC   BASDTREM(4,@06),EXPRDT                              0529 01746000
*                 END;              /*                       @Y30LB25*/ 01747000
*             END;                  /*                       @ZA13484*/ 01748000
*                                                                  0531 01749000
@RF00525 DS    0H                                                  0532 01750000
*           /*********************************************************/ 01751000
*           /*                                                       */ 01752000
*           /* WRITE THE BVR OR CVR.                         @Y30LB25*/ 01753000
*           /*                                                       */ 01754000
*           /*********************************************************/ 01755000
*                                                                  0532 01756000
*           CALL WRITRECD;          /* WRITE BVR OR CVR      @Y30LB25*/ 01757000
@RC00506 BAL   @14,WRITRECD                                        0532 01758000
*           RETURN;                 /*                       @Y30LB25*/ 01759000
         B     @EL00012                                            0533 01760000
*         END;                      /*                       @Y30LB25*/ 01761000
*                                                                  0534 01762000
*       /*************************************************************/ 01763000
*       /*                                                           */ 01764000
*       /* KEEP RECORD OPTION IS OFF.                        @Y30LB25*/ 01765000
*       /*                                                           */ 01766000
*       /*************************************************************/ 01767000
*                                                                  0535 01768000
*       ELSE                        /* KEEP RECORD           @Y30LB25   01769000
*                                      OPTION IS OFF         @Y30LB25*/ 01770000
*         DO;                       /*                       @Y30LB25*/ 01771000
*                                                                  0535 01772000
@RF00498 DS    0H                                                  0536 01773000
*           /*********************************************************/ 01774000
*           /*                                                       */ 01775000
*           /* NULL LIB ID FIELD(S).                         @Y30LB25*/ 01776000
*           /*                                                       */ 01777000
*           /*********************************************************/ 01778000
*                                                                  0536 01779000
*           IF REACODE=EJEC1CRT     /* 1 CART EJECTED?       @Y30LB25*/ 01780000
*             THEN                  /* YES                   @Y30LB25*/ 01781000
         CLC   REACODE(2),@CB00701                                 0536 01782000
         BNE   @RF00536                                            0536 01783000
*             BCDLIB1=FIX1F;        /* NULL LIBID1           @Y30LB25*/ 01784000
         L     @06,BCDVPTR                                         0537 01785000
         MVI   BCDLIB1(@06),X'FF'                                  0537 01786000
*           ELSE                    /*                       @Y30LB25*/ 01787000
*             DO;                   /* 2 CARTS EJSCTED       @Y30LB25*/ 01788000
         B     @RC00536                                            0538 01789000
@RF00536 DS    0H                                                  0539 01790000
*               BCDLIB1=FIX1F;      /*                       @Y30LB25   01791000
*                                      NULL LIBID1           @Y30LB25*/ 01792000
         L     @06,BCDVPTR                                         0539 01793000
         MVI   BCDLIB1(@06),X'FF'                                  0539 01794000
*               BCDLIB2=FIX1F;      /*                       @Y30LB25   01795000
*                                      NULL LIBID2           @Y30LB25*/ 01796000
         MVI   BCDLIB2(@06),X'FF'                                  0540 01797000
*             END;                  /*                       @Y30LB25*/ 01798000
*                                                                  0541 01799000
*           /*********************************************************/ 01800000
*           /*                                                       */ 01801000
*           /* BOTH LIBID FIELDS NULL, THEN DELETE           @Y30LB25*/ 01802000
*           /* THE RECORD. OTHERWISE, WRITE THE RECORD.      @Y30LB25*/ 01803000
*           /*                                                       */ 01804000
*           /*********************************************************/ 01805000
*                                                                  0542 01806000
*           IF BCDLIB1=FIX1F&BCDLIB2=FIX1F/*                 @Y30LB25   01807000
*                                      DELETE OR WRITE?      @Y30LB25*/ 01808000
*             THEN                  /* DELETE                @Y30LB25*/ 01809000
@RC00536 L     @06,BCDVPTR                                         0542 01810000
         CLI   BCDLIB1(@06),255                                    0542 01811000
         BNE   @RF00542                                            0542 01812000
         CLI   BCDLIB2(@06),255                                    0542 01813000
         BNE   @RF00542                                            0542 01814000
*             RPLVTYP=RPLVDEL;      /*                       @Y30LB25*/ 01815000
         L     @06,RPLVPTR                                         0543 01816000
         MVI   RPLVTYP(@06),X'05'                                  0543 01817000
*           ELSE                    /*                       @Y30LB25*/ 01818000
*             RPLVTYP=RPLVPUT;      /* WRITE                 @Y30LB25*/ 01819000
         B     @RC00542                                            0544 01820000
@RF00542 L     @06,RPLVPTR                                         0544 01821000
         MVI   RPLVTYP(@06),X'01'                                  0544 01822000
*           RESPECIFY               /*                       @Y30LB25*/ 01823000
*             RG1 RSTD;             /* RESTRICT REG 1        @Y30LB25*/ 01824000
@RC00542 DS    0H                                                  0546 01825000
*           RG1=RPLVPTR;            /* SET RPLVPTR           @Y30LB25*/ 01826000
         L     RG1,RPLVPTR                                         0546 01827000
*           CALL ICBVIO00;          /* WRITE/DELETE BVR,     @Y30LB25   01828000
*                                      CVR, OR DVR           @Y30LB25*/ 01829000
         L     @15,@CV00762                                        0547 01830000
         BALR  @14,@15                                             0547 01831000
*           RESPECIFY               /*                       @Y30LB25*/ 01832000
*             RG1 UNRSTD;           /* UNRESTRICT REG 1      @Y30LB25*/ 01833000
*           IF RPLVRETC¬=FIXZERO    /* ERROR?                @Y30LB25*/ 01834000
*             THEN                  /* YES                   @Y30LB25*/ 01835000
         L     @06,RPLVPTR                                         0549 01836000
         LH    @15,RPLVRETC(,@06)                                  0549 01837000
         N     @15,@CF01129                                        0549 01838000
         LTR   @15,@15                                             0549 01839000
         BNZ   @RT00549                                            0549 01840000
*             RETURN;               /*                       @Y30LB25*/ 01841000
*                                                                  0550 01842000
*           /*********************************************************/ 01843000
*           /*                                                       */ 01844000
*           /* RETURN IF BOTH LIBID FIELDS ARE NOT FF        @ZA17163*/ 01845000
*           /*                                                       */ 01846000
*           /*********************************************************/ 01847000
*                                                                  0551 01848000
*           IF BCDLIB1¬=FIX1F|BCDLIB2¬=FIX1F/*               @ZA17163*/ 01849000
*             THEN                  /* NO                    @ZA17163*/ 01850000
         L     @15,BCDVPTR                                         0551 01851000
         CLI   BCDLIB1(@15),255                                    0551 01852000
         BNE   @RT00551                                            0551 01853000
         CLI   BCDLIB2(@15),255                                    0551 01854000
         BNE   @RT00551                                            0551 01855000
*             RETURN;               /*                       @ZA17163*/ 01856000
*                                                                  0552 01857000
*           /*********************************************************/ 01858000
*           /*                                                       */ 01859000
*           /* DELETE THE CIR.                               @Y30LB25*/ 01860000
*           /*                                                       */ 01861000
*           /*********************************************************/ 01862000
*                                                                  0553 01863000
*           IVOLKY=BCDCSN1;         /* SET CIR KEY           @Y30LB25*/ 01864000
         MVC   IVOLKY(12),BCDCSN1(@15)                             0553 01865000
*           RPLVKEY=ADDR(IKEY);     /* ADDR OF KEY           @Y30LB25*/ 01866000
         LA    @15,IKEY                                            0554 01867000
         ST    @15,RPLVKEY(,@06)                                   0554 01868000
*           RPLVBUF=INDEXPTR;       /* BUF PTR               @Y30LB25*/ 01869000
         L     @15,INDEXPTR                                        0555 01870000
         ST    @15,RPLVBUF(,@06)                                   0555 01871000
*           RPLVBLN=LENGTH(INDEXBUF);/*                      @Y30LB25   01872000
*                                      SET BUFFER LENGTH     @Y30LB25*/ 01873000
         MVC   RPLVBLN(4,@06),@CF00339                             0556 01874000
*           CALL DELTRECD;          /* DELETE CIR            @Y30LB25*/ 01875000
*                                                                  0557 01876000
         BAL   @14,DELTRECD                                        0557 01877000
*           /*********************************************************/ 01878000
*           /*                                                       */ 01879000
*           /* DISREGARD ANY ERROR AND CONTINUE              @Y30LB25*/ 01880000
*           /*                                                       */ 01881000
*           /*********************************************************/ 01882000
*                                                                  0558 01883000
*           RPLVRETC=RPLVRETC&&RPLVRETC;/*                   @Y30LB25*/ 01884000
         L     @06,RPLVPTR                                         0558 01885000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0558 01886000
*           RPLRCODE=RPLRCODE&&RPLRCODE;/*                   @Y30LB25*/ 01887000
*                                                                  0559 01888000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0559 01889000
*           /*********************************************************/ 01890000
*           /*                                                       */ 01891000
*           /* CHECK IF OK TO DELETE OTHER                   @Y30LB25*/ 01892000
*           /* CIR, BECAUSE ONLY ONE                         @Y30LB25*/ 01893000
*           /* CARTRIDGE MAY HAVE BEEN                       @Y30LB25*/ 01894000
*           /* EJECTED BY THE MSC.                           @Y30LB25*/ 01895000
*           /*                                                       */ 01896000
*           /*********************************************************/ 01897000
*                                                                  0560 01898000
*           IF BCDLIB2=FIX1F        /* 2ND CART EJECTED?     @Y30LB25*/ 01899000
*             THEN                  /* YES                   @Y30LB25*/ 01900000
         L     @06,BCDVPTR                                         0560 01901000
         CLI   BCDLIB2(@06),255                                    0560 01902000
         BNE   @RF00560                                            0560 01903000
*             DO;                   /*                       @Y30LB25*/ 01904000
*               IVOLKY=BCDCSN2;     /* SET CIR KEY           @Y30LB25*/ 01905000
         MVC   IVOLKY(12),BCDCSN2(@06)                             0562 01906000
*               CALL DELTRECD;      /* DELETE CIR            @Y30LB25*/ 01907000
*                                                                  0563 01908000
         BAL   @14,DELTRECD                                        0563 01909000
*               /*****************************************************/ 01910000
*               /*                                                   */ 01911000
*               /* DISREGARD ANY ERROR AND CONTINUE          @Y30LB25*/ 01912000
*               /*                                                   */ 01913000
*               /*****************************************************/ 01914000
*                                                                  0564 01915000
*               RPLVRETC=RPLVRETC&&RPLVRETC;/*               @Y30LB25*/ 01916000
         L     @06,RPLVPTR                                         0564 01917000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0564 01918000
*               RPLRCODE=RPLRCODE&&RPLRCODE;/*               @Y30LB25*/ 01919000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0565 01920000
*             END;                  /*                       @Y30LB25*/ 01921000
*                                                                  0566 01922000
*           /*********************************************************/ 01923000
*           /*                                                       */ 01924000
*           /* RETURN IF RECORD IS A DUPLICATE               @Y30LB25*/ 01925000
*           /*                                                       */ 01926000
*           /*********************************************************/ 01927000
*                                                                  0567 01928000
*           IF BCDDUP=ON            /*                       @ZA17163*/ 01929000
*             THEN                  /*                       @Y30LB25*/ 01930000
@RF00560 L     @06,BCDVPTR                                         0567 01931000
         TM    BCDDUP(@06),B'00000100'                             0567 01932000
         BO    @RT00567                                            0567 01933000
*             RETURN;               /*                       @Y30LB25*/ 01934000
*                                                                  0568 01935000
*           /*********************************************************/ 01936000
*           /*                                                       */ 01937000
*           /* FOR A CVR, UPDATE ITS BVR.                    @Y30LB25*/ 01938000
*           /*                                                       */ 01939000
*           /*********************************************************/ 01940000
*                                                                  0569 01941000
*           IF BCDCOPY=ON           /* CVR?                  @Y30LB25*/ 01942000
*             THEN                  /* YES                   @Y30LB25*/ 01943000
         TM    BCDCOPY(@06),B'00010000'                            0569 01944000
         BNO   @RF00569                                            0569 01945000
*             DO;                   /*                       @Y30LB25*/ 01946000
*               ADDSUB=OFF;         /*                       @Y30LB25   01947000
*                                      DELETE CVR            @Y30LB25*/ 01948000
         NI    ADDSUB,B'10111111'                                  0571 01949000
*               CALL ICBVUBVR(BCDVPTR,RPLVPTR,PASSBYTE);/*   @Y30LB25   01950000
*                                      UPDT CVR'S BVR        @Y30LB25*/ 01951000
         L     @15,@CV00769                                        0572 01952000
         LA    @01,@AL00572                                        0572 01953000
         BALR  @14,@15                                             0572 01954000
*             END;                  /*                       @Y30LB25*/ 01955000
*           ELSE                    /* BVR                   @Y30LB25*/ 01956000
*             DO;                   /*                       @Y30LB25*/ 01957000
*                                                                  0574 01958000
         B     @RC00569                                            0574 01959000
@RF00569 DS    0H                                                  0575 01960000
*               /*****************************************************/ 01961000
*               /*                                                   */ 01962000
*               /* CHECK FOR GROUPED                         @Y30LB25*/ 01963000
*               /*                                                   */ 01964000
*               /*****************************************************/ 01965000
*                                                                  0575 01966000
*               IF BASGRPV=ON       /* GROUPED?              @Y30LB25*/ 01967000
*                 THEN              /* YES                   @Y30LB25*/ 01968000
         L     @06,BASEVPTR                                        0575 01969000
         TM    BASGRPV(@06),B'00100000'                            0575 01970000
         BNO   @RF00575                                            0575 01971000
*                 DO;               /*                       @Y30LB25*/ 01972000
*                   CALL INACGVR;   /*                       @Y30LB25   01973000
*                                      DECREM # INAC VOLS    @Y30LB25*/ 01974000
         BAL   @14,INACGVR                                         0577 01975000
*                   IF RPLVRETC¬=FIXZERO/* ERROR?            @Y30LB25*/ 01976000
*                     THEN          /* YES                   @Y30LB25*/ 01977000
         L     @06,RPLVPTR                                         0578 01978000
         LH    @06,RPLVRETC(,@06)                                  0578 01979000
         N     @06,@CF01129                                        0578 01980000
         LTR   @06,@06                                             0578 01981000
         BNZ   @RT00578                                            0578 01982000
*                     RETURN;       /*                       @Y30LB25*/ 01983000
*                 END;              /*                       @Y30LB25*/ 01984000
*                                                                  0580 01985000
*               /*****************************************************/ 01986000
*               /*                                                   */ 01987000
*               /* FOR A BVR, UPDATE ITS GVR OR NGVR.        @Y30LB25*/ 01988000
*               /*                                                   */ 01989000
*               /*****************************************************/ 01990000
*                                                                  0581 01991000
*               CALL PROCBVR;       /* PROCESS BVR           @Y30LB25*/ 01992000
@RF00575 BAL   @14,PROCBVR                                         0581 01993000
*             END;                  /*                       @Y30LB25*/ 01994000
*           RETURN;                 /*                       @Y30LB25*/ 01995000
         B     @EL00012                                            0583 01996000
*         END;                      /*                       @Y30LB25*/ 01997000
*     END;                          /*                       @Y30LB25*/ 01998000
*   END PROMCRTE;                   /*                       @Y30LB25*/ 01999000
         B     @EL00012                                            0586 02000000
*                                                                  0587 02001000
*   /*****************************************************************/ 02002000
*   /*                                                               */ 02003000
*   /* PROCEDURE NAME - INACGVR                              @Y30LB25*/ 02004000
*   /*                                                       @Y30LB25*/ 02005000
*   /* FUNCTION -                                            @Y30LB25*/ 02006000
*   /* DECREMENTS THE COUNT OF INACTIVE VOLUMES IN THE       @Y30LB25*/ 02007000
*   /* GROUP VOLUME RECORD.                                  @Y30LB25*/ 02008000
*   /*                                                       @Y30LB25*/ 02009000
*   /* INPUT -                                               @Y30LB25*/ 02010000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02011000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02012000
*   /*                                                       @Y30LB25*/ 02013000
*   /* OUTPUT -                                              @Y30LB25*/ 02014000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02015000
*   /* AN ERROR                                              @Y30LB25*/ 02016000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 02017000
*   /*                                                               */ 02018000
*   /*****************************************************************/ 02019000
*                                                                  0587 02020000
*INACGVR:                           /*                       @Y30LB25*/ 02021000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02022000
INACGVR  ST    @14,@SA00013                                        0587 02023000
*   GROUPKY=BASGROUP;               /* SET GROUP NAME        @Y30LB25*/ 02024000
         L     @06,BASEVPTR                                        0588 02025000
         MVC   GROUPKY(8),BASGROUP(@06)                            0588 02026000
*   RPLVKEY=ADDR(GKEY);             /* SET KEY ADDR          @Y30LB25*/ 02027000
         LA    @06,GKEY                                            0589 02028000
         L     @01,RPLVPTR                                         0589 02029000
         ST    @06,RPLVKEY(,@01)                                   0589 02030000
*   CALL READUPD1;                  /* READ GVR              @Y30LB25*/ 02031000
         BAL   @14,READUPD1                                        0590 02032000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 02033000
*     THEN                          /* YES                   @Y30LB25*/ 02034000
         L     @06,RPLVPTR                                         0591 02035000
         LH    @15,RPLVRETC(,@06)                                  0591 02036000
         N     @15,@CF01129                                        0591 02037000
         LTR   @15,@15                                             0591 02038000
         BNZ   @RT00591                                            0591 02039000
*     RETURN;                       /*                       @Y30LB25*/ 02040000
*   GROUPBUF=BASEBUF1;              /* USE CORRECT BUF       @Y30LB25*/ 02041000
         MVC   GROUPBUF(224),BASEBUF1                              0593 02042000
*   GRONINAC=GRONINAC-FIXONE;       /* DECREM INAC VOLS      @Y30LB25*/ 02043000
         L     @15,GROUPPTR                                        0594 02044000
         LH    @14,GRONINAC(,@15)                                  0594 02045000
         BCTR  @14,0                                               0594 02046000
         STH   @14,GRONINAC(,@15)                                  0594 02047000
*   RPLVBUF=ADDR(GROUPBUF);         /* BUFFER ADDR           @Y30LB25*/ 02048000
         LA    @15,GROUPBUF                                        0595 02049000
         ST    @15,RPLVBUF(,@06)                                   0595 02050000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 02051000
         BAL   @14,WRITRECD                                        0596 02052000
*   RETURN;                         /*                       @Y30LB25*/ 02053000
@EL00013 DS    0H                                                  0597 02054000
@EF00013 DS    0H                                                  0597 02055000
@ER00013 L     @14,@SA00013                                        0597 02056000
         BR    @14                                                 0597 02057000
*   END INACGVR;                    /*                       @Y30LB25*/ 02058000
         B     @EL00013                                            0598 02059000
*                                                                  0599 02060000
*   /*****************************************************************/ 02061000
*   /*                                                               */ 02062000
*   /* PROCEDURE NAME - DELTRECD                             @Y30LB25*/ 02063000
*   /*                                                       @Y30LB25*/ 02064000
*   /* FUNCTION - READ AND DELETE AN MSVC RECORD.            @Y30LB25*/ 02065000
*   /*                                                       @Y30LB25*/ 02066000
*   /* INPUT -                                               @Y30LB25*/ 02067000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02068000
*   /* KEY OF RECORD IN RPLVKEY                              @Y30LB25*/ 02069000
*   /* ADDRESS OF RECORD BUFFER IN RPLVBUF                   @Y30LB25*/ 02070000
*   /* LENGTH OF BUFFER IN RPLVBLN                           @Y30LB25*/ 02071000
*   /*                                                       @Y30LB25*/ 02072000
*   /* OUTPUT -                                              @Y30LB25*/ 02073000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02074000
*   /* AN ERROR                                              @Y30LB25*/ 02075000
*   /*                                                               */ 02076000
*   /*****************************************************************/ 02077000
*                                                                  0599 02078000
*DELTRECD:                          /*                       @Y30LB25*/ 02079000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02080000
DELTRECD ST    @14,@SA00014                                        0599 02081000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 02082000
         L     @06,RPLVPTR                                         0600 02083000
         MVI   RPLVTYP(@06),X'00'                                  0600 02084000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 02085000
         NI    RPLVLOC(@06),B'01111111'                            0601 02086000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 02087000
         OI    RPLVUPD(@06),B'00000010'                            0602 02088000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 02089000
         OI    RPLVDIR(@06),B'01000000'                            0603 02090000
*   RESPECIFY                       /*                       @Y30LB25*/ 02091000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 02092000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 02093000
         LR    RG1,@06                                             0605 02094000
*   CALL ICBVIO00;                  /* READ MSVC RECORD      @Y30LB25*/ 02095000
         L     @15,@CV00762                                        0606 02096000
         BALR  @14,@15                                             0606 02097000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 02098000
*     THEN                          /* YES                   @Y30LB25*/ 02099000
         L     @06,RPLVPTR                                         0607 02100000
         LH    @00,RPLVRETC(,@06)                                  0607 02101000
         N     @00,@CF01129                                        0607 02102000
         LTR   @00,@00                                             0607 02103000
         BNZ   @RT00607                                            0607 02104000
*     RETURN;                       /*                       @Y30LB25*/ 02105000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Y30LB25*/ 02106000
         MVI   RPLVTYP(@06),X'05'                                  0609 02107000
*   CALL ICBVIO00;                  /* DELETE MSVC RECORD    @Y30LB25*/ 02108000
         L     @15,@CV00762                                        0610 02109000
         BALR  @14,@15                                             0610 02110000
*   RESPECIFY                       /*                       @Y30LB25*/ 02111000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 02112000
*   RETURN;                         /*                       @Y30LB25*/ 02113000
@EL00014 DS    0H                                                  0612 02114000
@EF00014 DS    0H                                                  0612 02115000
@ER00014 L     @14,@SA00014                                        0612 02116000
         BR    @14                                                 0612 02117000
*   END DELTRECD;                   /*                       @Y30LB25*/ 02118000
         B     @EL00014                                            0613 02119000
*                                                                  0614 02120000
*   /*****************************************************************/ 02121000
*   /*                                                               */ 02122000
*   /* PROCEDURE NAME - PROCBVR                              @Y30LB25*/ 02123000
*   /*                                                       @Y30LB25*/ 02124000
*   /* FUNCTION - THE INPUT BVR HAS ALREADY BEEN DELETED.    @Y30LB25*/ 02125000
*   /* IF THE BVR IS GROUPED, GET THE GVR, UPDATE IT, CHAIN  @Y30LB25*/ 02126000
*   /* THE BVR OUT OF THE GVR, AND WRITE THE GVR.            @Y30LB25*/ 02127000
*   /* IF THE BVR WAS GROUPED, ACTIVE AND GENERAL-USE        @Y30LB25*/ 02128000
*   /* DELETE ITS GROUP VOLUME SERIAL NUMBER EXTENSION       @Y30LB25*/ 02129000
*   /* SLOT. LOCATE A DVR FOR THE BVR, IF ANY, AND MAKE      @Y30LB25*/ 02130000
*   /* IT THE BVR. IF NO DVR IS FOUND, THEN DELETE THE       @Y30LB25*/ 02131000
*   /* BVR FROM THE NGVR CHAIN OF BVRS, IF THE BVR           @Y30LB25*/ 02132000
*   /* IS NON-GROUPED.                                       @Y30LB25*/ 02133000
*   /*                                                       @Y30LB25*/ 02134000
*   /* INPUT -                                               @Y30LB25*/ 02135000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02136000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02137000
*   /*                                                       @Y30LB25*/ 02138000
*   /* OUTPUT -                                              @Y30LB25*/ 02139000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02140000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02141000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 02142000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 02143000
*   /*                                                               */ 02144000
*   /*****************************************************************/ 02145000
*                                                                  0614 02146000
*PROCBVR:                           /*                       @Y30LB25*/ 02147000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02148000
PROCBVR  ST    @14,@SA00015                                        0614 02149000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 02150000
*     THEN                          /* YES                   @Y30LB25*/ 02151000
         L     @06,BASEVPTR                                        0615 02152000
         TM    BASGRPV(@06),B'00100000'                            0615 02153000
         BNO   @RF00615                                            0615 02154000
*     DO;                           /*                       @Y30LB25*/ 02155000
*                                                                  0616 02156000
*       /*************************************************************/ 02157000
*       /*                                                           */ 02158000
*       /* GET AND UPDATE THE GROUP VOLUME RECORD            @Y30LB25*/ 02159000
*       /*                                                           */ 02160000
*       /*************************************************************/ 02161000
*                                                                  0617 02162000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/ 02163000
         MVC   GROUPKY(8),BASGROUP(@06)                            0617 02164000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY ADDR          @Y30LB25*/ 02165000
         LA    @06,GKEY                                            0618 02166000
         L     @01,RPLVPTR                                         0618 02167000
         ST    @06,RPLVKEY(,@01)                                   0618 02168000
*       CALL READUPD1;              /* GET GVR               @Y30LB25*/ 02169000
         BAL   @14,READUPD1                                        0619 02170000
*       IF RPLVRETC¬=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/ 02171000
*         THEN                      /* ERROR                 @Y30LB25*/ 02172000
         L     @06,RPLVPTR                                         0620 02173000
         LH    @06,RPLVRETC(,@06)                                  0620 02174000
         N     @06,@CF01129                                        0620 02175000
         LTR   @06,@06                                             0620 02176000
         BNZ   @RT00620                                            0620 02177000
*         RETURN;                   /*                       @Y30LB25*/ 02178000
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUFF      @Y30LB25*/ 02179000
         MVC   GROUPBUF(224),BASEBUF1                              0622 02180000
*       GRPFLG=ON;                  /* SET GROUP FLAG        @Y30LB25*/ 02181000
         OI    GRPFLG,B'00010000'                                  0623 02182000
*       CALL VUCHO;                 /* CHAIN BVR OUT GVR     @Y30LB25*/ 02183000
         BAL   @14,VUCHO                                           0624 02184000
*       IF RPLVRETC¬=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/ 02185000
*         THEN                      /* ERROR                 @Y30LB25*/ 02186000
         L     @06,RPLVPTR                                         0625 02187000
         LH    @15,RPLVRETC(,@06)                                  0625 02188000
         N     @15,@CF01129                                        0625 02189000
         LTR   @15,@15                                             0625 02190000
         BNZ   @RT00625                                            0625 02191000
*         RETURN;                   /*                       @Y30LB25*/ 02192000
*                                                                  0626 02193000
*       /*************************************************************/ 02194000
*       /*                                                           */ 02195000
*       /* REESTABLISH RPLV FOR WRITING THE GVR              @Y30LB25*/ 02196000
*       /*                                                           */ 02197000
*       /*************************************************************/ 02198000
*                                                                  0627 02199000
*       GROUPKY=BASGROUP;           /* SET THE KEY           @Y30LB25*/ 02200000
         L     @01,BASEVPTR                                        0627 02201000
         MVC   GROUPKY(8),BASGROUP(@01)                            0627 02202000
*       RPLVKEY=ADDR(GKEY);         /* PTR TO KEY            @Y30LB25*/ 02203000
         LA    @15,GKEY                                            0628 02204000
         ST    @15,RPLVKEY(,@06)                                   0628 02205000
*       CALL READUPD1;              /* GET GVR               @Y30LB25*/ 02206000
         BAL   @14,READUPD1                                        0629 02207000
*       IF RPLVRETC¬=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/ 02208000
*         THEN                      /* ERROR                 @Y30LB25*/ 02209000
         L     @06,RPLVPTR                                         0630 02210000
         LH    @15,RPLVRETC(,@06)                                  0630 02211000
         N     @15,@CF01129                                        0630 02212000
         LTR   @15,@15                                             0630 02213000
         BNZ   @RT00630                                            0630 02214000
*         RETURN;                   /*                       @Y30LB25*/ 02215000
*       RPLVBUF=ADDR(GROUPBUF);     /* PTR TO GVR            @Y30LB25*/ 02216000
         LA    @15,GROUPBUF                                        0632 02217000
         ST    @15,RPLVBUF(,@06)                                   0632 02218000
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/ 02219000
         BAL   @14,WRITRECD                                        0633 02220000
*       IF RPLVRETC¬=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/ 02221000
*         THEN                      /* ERROR                 @Y30LB25*/ 02222000
         L     @06,RPLVPTR                                         0634 02223000
         LH    @06,RPLVRETC(,@06)                                  0634 02224000
         N     @06,@CF01129                                        0634 02225000
         LTR   @06,@06                                             0634 02226000
         BNZ   @RT00634                                            0634 02227000
*         RETURN;                   /*                       @Y30LB25*/ 02228000
*                                                                  0635 02229000
*       /*************************************************************/ 02230000
*       /*                                                           */ 02231000
*       /* CHECK FOR ACTIVE GENERAL-USE TO DELETE            @Y30LB25*/ 02232000
*       /* ITS GVSNER SLOT.                                  @Y30LB25*/ 02233000
*       /*                                                           */ 02234000
*       /*************************************************************/ 02235000
*                                                                  0636 02236000
*       IF BASINAC=OFF&BASGENUS=ON  /* ACT & GEN-USE?        @Y30LB25*/ 02237000
*         THEN                      /* YES                   @Y30LB25*/ 02238000
         L     @06,BASEVPTR                                        0636 02239000
         TM    BASGENUS(@06),B'00010000'                           0636 02240000
         BNO   @RF00636                                            0636 02241000
         TM    BASINAC(@06),B'00000100'                            0636 02242000
         BNZ   @RF00636                                            0636 02243000
*         DO;                       /*                       @Y30LB25*/ 02244000
*           ADDSUBSL=OFF;           /* DELETE SLOT           @Y30LB25*/ 02245000
         NI    ADDSUBSL,B'11111101'                                0638 02246000
*           EXPSLOT=OFF;            /* NO UPDT EXPIR DATE    @Y30LB25*/ 02247000
         NI    EXPSLOT,B'01111111'                                 0639 02248000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   0640 02249000
*                                      DELETE GVSNER SLOT    @Y30LB25*/ 02250000
         L     @15,@CV00767                                        0640 02251000
         LA    @01,@AL00640                                        0640 02252000
         BALR  @14,@15                                             0640 02253000
*           IF RPLVRETC¬=FIXZERO    /* ERROR?                @Y30LB25*/ 02254000
*             THEN                  /* YES                   @Y30LB25*/ 02255000
         L     @06,RPLVPTR                                         0641 02256000
         LH    @06,RPLVRETC(,@06)                                  0641 02257000
         N     @06,@CF01129                                        0641 02258000
         LTR   @06,@06                                             0641 02259000
         BNZ   @RT00641                                            0641 02260000
*             RETURN;               /*                       @Y30LB25*/ 02261000
*         END;                      /*                       @Y30LB25*/ 02262000
*     END;                          /*                       @Y30LB25*/ 02263000
*                                                                  0644 02264000
@RF00636 DS    0H                                                  0645 02265000
*   /*****************************************************************/ 02266000
*   /*                                                               */ 02267000
*   /* CHECK FOR A DUP VOLUME RECORD FOR THE DELETED         @Y30LB25*/ 02268000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02269000
*   /*                                                               */ 02270000
*   /*****************************************************************/ 02271000
*                                                                  0645 02272000
*   DVOLKY=BASSERNO;                /* SET VOLID IN KEY      @Y30LB25*/ 02273000
@RF00615 L     @06,BASEVPTR                                        0645 02274000
         MVC   DVOLKY(6),BASSERNO(@06)                             0645 02275000
*   DIDKY=FIXONE;                   /* SET KEY               @Y30LB25*/ 02276000
         MVI   DIDKY,X'01'                                         0646 02277000
*   RPLVKEY=ADDR(DKEY);             /* ADDR OF KEY           @Y30LB25*/ 02278000
         L     @06,RPLVPTR                                         0647 02279000
         LA    @15,DKEY                                            0647 02280000
         ST    @15,RPLVKEY(,@06)                                   0647 02281000
*   RPLVTYP=RPLVREAD;               /* READ OPTION ON        @Y30LB25*/ 02282000
         MVI   RPLVTYP(@06),X'00'                                  0648 02283000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 02284000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 02285000
         OI    RPLVDIR(@06),B'01000000'                            0650 02286000
         NI    RPLVLOC(@06),B'01111111'                            0650 02287000
*   RPLVUPD=ON;                     /* SET UPDATE            @Y30LB25*/ 02288000
         OI    RPLVUPD(@06),B'00000010'                            0651 02289000
*   RPLVKGE=ON;                     /* READ KEY = OR >       @Y30LB25*/ 02290000
         OI    RPLVKGE(@06),B'00000100'                            0652 02291000
*   RPLVBUF=DUPVPTR;                /* BUFFER PTR            @Y30LB25*/ 02292000
         L     @15,DUPVPTR                                         0653 02293000
         ST    @15,RPLVBUF(,@06)                                   0653 02294000
*   RPLVBLN=LENGTH(DUPVBUF);        /* BUFFER LENGTH         @Y30LB25*/ 02295000
         MVC   RPLVBLN(4,@06),@CF01103                             0654 02296000
*   RESPECIFY                                                      0655 02297000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 02298000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 02299000
         LR    RG1,@06                                             0656 02300000
*   CALL ICBVIO00;                  /* READ FOR DVR          @Y30LB25*/ 02301000
         L     @15,@CV00762                                        0657 02302000
         BALR  @14,@15                                             0657 02303000
*   RESPECIFY                                                      0658 02304000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 02305000
*   RPLVKGE=OFF;                    /* NO > OR =             @Y30LB25*/ 02306000
         L     @06,RPLVPTR                                         0659 02307000
         NI    RPLVKGE(@06),B'11111011'                            0659 02308000
*   IF RPLRCODE=IOERROR             /* CHECK REASON CODE     @Y30LB25*/ 02309000
*     THEN                          /* YES                   @Y30LB25*/ 02310000
         CLC   RPLRCODE(2,@06),@CB00713                            0660 02311000
         BE    @RT00660                                            0660 02312000
*     RETURN;                       /*                       @Y30LB25*/ 02313000
*   IF DKY¬=DUPD|DVOLKY¬=DUPSERNO   /* DVR FOUND?            @Y30LB25*/ 02314000
*     THEN                          /* NO                    @Y30LB25*/ 02315000
         L     @06,DUPVPTR                                         0662 02316000
         CLC   DKY(5),DUPD(@06)                                    0662 02317000
         BNE   @RT00662                                            0662 02318000
         CLC   DVOLKY(6),DUPSERNO(@06)                             0662 02319000
         BE    @RF00662                                            0662 02320000
@RT00662 DS    0H                                                  0663 02321000
*     DO;                           /*                       @Y30LB25*/ 02322000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETURN CODE      @Y30LB25*/ 02323000
         L     @06,RPLVPTR                                         0664 02324000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0664 02325000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASON CODE      @Y30LB25*/ 02326000
*                                                                  0665 02327000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0665 02328000
*       /*************************************************************/ 02329000
*       /*                                                           */ 02330000
*       /* NO DVR WAS FOUND                                  #Y30LB25*/ 02331000
*       /*                                                           */ 02332000
*       /*************************************************************/ 02333000
*                                                                  0666 02334000
*       IF BASGRPV=OFF              /* BVR NOT GRPD?         @Y30LB25*/ 02335000
*         THEN                      /* YES                   @Y30LB25*/ 02336000
         L     @06,BASEVPTR                                        0666 02337000
         TM    BASGRPV(@06),B'00100000'                            0666 02338000
         BNZ   @RF00666                                            0666 02339000
*         DO;                       /*                       @Y30LB25*/ 02340000
*           GRPFLG=OFF;             /* NON-GROUPED           @Y30LB25*/ 02341000
         NI    GRPFLG,B'11101111'                                  0668 02342000
*           CALL VUCHO;             /* CHAIN BVR OUT NGVR    @Y30LB25*/ 02343000
         BAL   @14,VUCHO                                           0669 02344000
*         END;                      /*                       @Y30LB25*/ 02345000
*       RETURN;                     /*                       @Y30LB25*/ 02346000
@EL00015 DS    0H                                                  0671 02347000
@EF00015 DS    0H                                                  0671 02348000
@ER00015 L     @14,@SA00015                                        0671 02349000
         BR    @14                                                 0671 02350000
*     END;                          /*                       @Y30LB25*/ 02351000
*                                                                  0672 02352000
*   /*****************************************************************/ 02353000
*   /*                                                               */ 02354000
*   /* DVR WAS FOUND                                         @Y30LB25*/ 02355000
*   /*                                                               */ 02356000
*   /*****************************************************************/ 02357000
*                                                                  0673 02358000
*   ELSE                            /* DVR WAS FOUND         @Y30LB25*/ 02359000
*     DO;                           /*                       @Y30LB25*/ 02360000
@RF00662 DS    0H                                                  0674 02361000
*       IF BASGRPV=ON               /* BVR GROUPED?          @Y30LB25*/ 02362000
*         THEN                      /* YES                   @Y30LB25*/ 02363000
         L     @06,BASEVPTR                                        0674 02364000
         TM    BASGRPV(@06),B'00100000'                            0674 02365000
         BNO   @RF00674                                            0674 02366000
*         DO;                       /*                       @Y30LB25*/ 02367000
*                                                                  0675 02368000
*           /*********************************************************/ 02369000
*           /*                                                       */ 02370000
*           /* MAKE DVR INTO A BASE AND CHAIN INTO NGVR      @Y30LB25*/ 02371000
*           /* ICBVUDBR RETURNS THE POINTER TO THE           @Y30LB25*/ 02372000
*           /* BVR IT CREATED IN BASEVPTR                    @Y30LB25*/ 02373000
*           /*                                                       */ 02374000
*           /*********************************************************/ 02375000
*                                                                  0676 02376000
*           GRPDV=ON;               /* GROUPED FLAG ON       @Y30LB25*/ 02377000
         OI    GRPDV,B'10000000'                                   0676 02378000
*           CALL ICBVUDBR(DUPVPTR,BASEVPTR,RPLVPTR,PASSBYTE,/*     0677 02379000
*                                                            @Y30LB25*/ 02380000
*               FIXZERO,FIXZERO);   /*                       @Y30LB25   02381000
*                                      MAKE DVR A BVR        @Y30LB25*/ 02382000
         L     @15,@CV00766                                        0677 02383000
         LA    @01,@AL00677                                        0677 02384000
         BALR  @14,@15                                             0677 02385000
*           IF RPLVRETC¬=FIXZERO    /* CHECK RETURN CODE     @Y30LB25*/ 02386000
*             THEN                  /* ERROR                 @Y30LB25*/ 02387000
         L     @06,RPLVPTR                                         0678 02388000
         LH    @06,RPLVRETC(,@06)                                  0678 02389000
         N     @06,@CF01129                                        0678 02390000
         LTR   @06,@06                                             0678 02391000
         BNZ   @RT00678                                            0678 02392000
*             RETURN;               /*                       @Y30LB25*/ 02393000
*           GRPFLG=OFF;             /* NON-GROUPED           @Y30LB25*/ 02394000
         NI    GRPFLG,B'11101111'                                  0680 02395000
*           CALL VUCHI;             /* CHAIN BVR IN NGVR     @Y30LB25*/ 02396000
         BAL   @14,VUCHI                                           0681 02397000
*           IF RPLVRETC¬=FIXZERO    /* CHECK RETURN CODE     @Y30LB25*/ 02398000
*             THEN                  /* ERROR                 @Y30LB25*/ 02399000
         L     @06,RPLVPTR                                         0682 02400000
         LH    @06,RPLVRETC(,@06)                                  0682 02401000
         N     @06,@CF01129                                        0682 02402000
         LTR   @06,@06                                             0682 02403000
         BNZ   @RT00682                                            0682 02404000
*             RETURN;               /*                       @Y30LB25*/ 02405000
*         END;                      /*                       @Y30LB25*/ 02406000
*       ELSE                        /* NOT GROUPED           @Y30LB25*/ 02407000
*                                                                  0685 02408000
*         /***********************************************************/ 02409000
*         /*                                                         */ 02410000
*         /* MAKE THE DVR INTO A BVR                         @Y30LB25*/ 02411000
*         /*                                                         */ 02412000
*         /***********************************************************/ 02413000
*                                                                  0685 02414000
*         DO;                       /*                       @Y30LB25*/ 02415000
         B     @RC00674                                            0685 02416000
@RF00674 DS    0H                                                  0686 02417000
*           GRPDV=OFF;              /* GROUPED FLAG OFF      @Y30LB25*/ 02418000
         NI    GRPDV,B'01111111'                                   0686 02419000
*           IF BASFIRST=ON          /* 1ST BVR IN CHAIN?     @Y30LB25*/ 02420000
*             THEN                  /* YES                   @Y30LB25*/ 02421000
         L     @06,BASEVPTR                                        0687 02422000
         TM    BASFIRST(@06),B'00010000'                           0687 02423000
         BNO   @RF00687                                            0687 02424000
*             FRSTDV=ON;            /* SET 1ST FLG ON        @Y30LB25*/ 02425000
         OI    FRSTDV,B'01000000'                                  0688 02426000
*           IF BASLAST=ON           /* LAST BVR IN CHAIN?    @Y30LB25*/ 02427000
*             THEN                  /* YES                   @Y30LB25*/ 02428000
@RF00687 L     @06,BASEVPTR                                        0689 02429000
         TM    BASLAST(@06),B'00001000'                            0689 02430000
         BNO   @RF00689                                            0689 02431000
*             LASTDV=ON;            /* SET LAST FLG ON       @Y30LB25*/ 02432000
         OI    LASTDV,B'00100000'                                  0690 02433000
*           CALL ICBVUDBR(DUPVPTR,BASEVPTR,RPLVPTR,PASSBYTE,/*     0691 02434000
*                                                            @Y30LB25*/ 02435000
*               BASPREV,BASNEXTV);  /*                       @Y30LB25   02436000
*                                      MAKE DVR A BVR        @Y30LB25*/ 02437000
@RF00689 MVC   @AL00001(16),@AL00691                               0691 02438000
         L     @06,BASEVPTR                                        0691 02439000
         LA    @15,BASPREV(,@06)                                   0691 02440000
         ST    @15,@AL00001+16                                     0691 02441000
         LA    @06,BASNEXTV(,@06)                                  0691 02442000
         ST    @06,@AL00001+20                                     0691 02443000
         L     @15,@CV00766                                        0691 02444000
         LA    @01,@AL00001                                        0691 02445000
         BALR  @14,@15                                             0691 02446000
*           IF RPLVRETC¬=FIXZERO    /* CHECK RETURN CODE     @Y30LB25*/ 02447000
*             THEN                  /* ERROR                 @Y30LB25*/ 02448000
         L     @06,RPLVPTR                                         0692 02449000
         LH    @06,RPLVRETC(,@06)                                  0692 02450000
         N     @06,@CF01129                                        0692 02451000
         LTR   @06,@06                                             0692 02452000
         BNZ   @RT00692                                            0692 02453000
*             RETURN;               /*                       @Y30LB25*/ 02454000
*         END;                      /*                       @Y30LB25*/ 02455000
*     END;                          /*                       @Y30LB25*/ 02456000
*                                                                  0695 02457000
@RC00674 DS    0H                                                  0696 02458000
*   /*****************************************************************/ 02459000
*   /*                                                               */ 02460000
*   /* WRITE THE NEW BVR                                     @Y30LB25*/ 02461000
*   /*                                                               */ 02462000
*   /*****************************************************************/ 02463000
*                                                                  0696 02464000
*   RPLVTYP=RPLVPUT;                /* WRITE BVR             @Y30LB25*/ 02465000
         L     @06,RPLVPTR                                         0696 02466000
         MVI   RPLVTYP(@06),X'01'                                  0696 02467000
*   RPLVBUF=BASEVPTR;               /* PTR TO BVR            @Y30LB25*/ 02468000
         L     @15,BASEVPTR                                        0697 02469000
         ST    @15,RPLVBUF(,@06)                                   0697 02470000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/ 02471000
         NI    RPLVUPD(@06),B'11111101'                            0698 02472000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 02473000
         NI    RPLVLOC(@06),B'01111111'                            0699 02474000
*   RPLVBLN=LENGTH(BASEBUF);        /* SET BUF LENGTH        @Y30LB25*/ 02475000
         LA    @15,224                                             0700 02476000
         ST    @15,RPLVBLN(,@06)                                   0700 02477000
*   RPLVRLN=LENGTH(BASEBUF);        /* SET BVR LENGTH        @Y30LB25*/ 02478000
         ST    @15,RPLVRLN(,@06)                                   0701 02479000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 02480000
         BAL   @14,WRITRECD                                        0702 02481000
*   RETURN;                         /*                       @Y30LB25*/ 02482000
         B     @EL00015                                            0703 02483000
*   END PROCBVR;                    /*                       @Y30LB25*/ 02484000
         B     @EL00015                                            0704 02485000
*                                                                  0705 02486000
*   /*****************************************************************/ 02487000
*   /*                                                               */ 02488000
*   /* PROCEDURE NAME - ACTVOL1                              @Y30LB25*/ 02489000
*   /*                                                       @Y30LB25*/ 02490000
*   /* FUNCTION - PROCESS A VOLUME BEFORE THE CALL TO THE    @Y30LB25*/ 02491000
*   /* MSC WHICH IS TO BECOME ACTIVE.                        @Y30LB25*/ 02492000
*   /*                                                       @Y30LB25*/ 02493000
*   /* INPUT -                                               @Y30LB25*/ 02494000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02495000
*   /*                                                       @Y30LB25*/ 02496000
*   /* OUTPUT -                                              @Y30LB25*/ 02497000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02498000
*   /* AN ERROR                                              @Y30LB25*/ 02499000
*   /*                                                               */ 02500000
*   /*****************************************************************/ 02501000
*                                                                  0705 02502000
*ACTVOL1:                           /*                       @Y30LB25*/ 02503000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02504000
*                                                                  0705 02505000
ACTVOL1  ST    @14,@SA00016                                        0705 02506000
*   /*****************************************************************/ 02507000
*   /*                                                               */ 02508000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 02509000
*   /*                                                               */ 02510000
*   /*****************************************************************/ 02511000
*                                                                  0706 02512000
*   CALL RMSVIS;                    /* RESERVE .MSVI         @Y30LB25*/ 02513000
*                                                                  0706 02514000
         BAL   @14,RMSVIS                                          0706 02515000
*   /*****************************************************************/ 02516000
*   /*                                                               */ 02517000
*   /* READ FOR CIR TO GET TO THE BVR OR CVR KEY.            @ZDR2054*/ 02518000
*   /* THEN GET THE BASE OR COPY RECORD FROM ITS KEY         @ZDR2054*/ 02519000
*   /* IN THE CIR - NOT FOR UPDATE.                          @ZDR2054*/ 02520000
*   /*                                                               */ 02521000
*   /*****************************************************************/ 02522000
*                                                                  0707 02523000
*   IVOLKY=DEFVCSN1;                /* SET UP KEY            @Y30LB25*/ 02524000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        0707 02525000
*   CALL GETRECLC;                  /* GET RECORD            @Y30LB25*/ 02526000
         BAL   @14,GETRECLC                                        0708 02527000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 02528000
*     THEN                          /* YES                   @Y30LB25*/ 02529000
         L     @06,RPLVPTR                                         0709 02530000
         LH    @15,RPLVRETC(,@06)                                  0709 02531000
         N     @15,@CF01129                                        0709 02532000
         LTR   @15,@15                                             0709 02533000
         BNZ   @RT00709                                            0709 02534000
*     RETURN;                       /*                       @Y30LB25*/ 02535000
*   BASEBUF=BUFFER;                 /* SAVE BVR IN CASE      @Y30LB25   02536000
*                                      GVR IS READ           @Y30LB25*/ 02537000
         L     @06,RPLVBUF(,@06)                                   0711 02538000
         MVC   BASEBUF(224),BUFFER(@06)                            0711 02539000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP BVR BUF    @ZDR2054*/ 02540000
*                                                                  0712 02541000
         LA    @06,BASEBUF                                         0712 02542000
         ST    @06,BCDVPTR                                         0712 02543000
*   /*****************************************************************/ 02544000
*   /*                                                               */ 02545000
*   /* CHECK FOR VALID 'TO' OR 'FOR' EXPIRATION DATE.        @Y30LB25*/ 02546000
*   /*                                                               */ 02547000
*   /*****************************************************************/ 02548000
*                                                                  0713 02549000
*   CALL EXPCK;                     /* CK EXPIR DATE         @Y30LB25*/ 02550000
         BAL   @14,EXPCK                                           0713 02551000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 02552000
*     THEN                          /* YES                   @Y30LB25*/ 02553000
         L     @06,RPLVPTR                                         0714 02554000
         LH    @15,RPLVRETC(,@06)                                  0714 02555000
         N     @15,@CF01129                                        0714 02556000
         LTR   @15,@15                                             0714 02557000
         BNZ   @RT00714                                            0714 02558000
*     RETURN;                       /*                       @Y30LB25*/ 02559000
*                                                                  0715 02560000
*   /*****************************************************************/ 02561000
*   /*                                                               */ 02562000
*   /* CHECK FOR A BVR                                       @ZDR2054*/ 02563000
*   /*                                                               */ 02564000
*   /*****************************************************************/ 02565000
*                                                                  0716 02566000
*   IF BCDBASE=ON THEN              /* BVR?                  @ZDR2054*/ 02567000
         L     @01,BCDVPTR                                         0716 02568000
         TM    BCDBASE(@01),B'00100000'                            0716 02569000
         BNO   @RF00716                                            0716 02570000
*     DO;                           /* YES                   @ZDR2054*/ 02571000
*                                                                  0717 02572000
*       /*************************************************************/ 02573000
*       /*                                                           */ 02574000
*       /* CHECK IF ENTERED FROM THE CAS WHILE MSVC WAS DISABLED     */ 02575000
*       /*                                                   @Y30LB25*/ 02576000
*       /*                                                           */ 02577000
*       /*************************************************************/ 02578000
*                                                                  0718 02579000
*       IF BASLIB1=FIX1F&BASLIB2=FIX1F/* ENTERED AT CAS?     @Y30LB25*/ 02580000
*         THEN                      /* YES                   @Y30LB25*/ 02581000
         L     @15,BASEVPTR                                        0718 02582000
         CLI   BASLIB1(@15),255                                    0718 02583000
         BNE   @RF00718                                            0718 02584000
         CLI   BASLIB2(@15),255                                    0718 02585000
         BNE   @RF00718                                            0718 02586000
*         DO;                       /* ERROR                 @Y30LB25*/ 02587000
*           RPLVRETC=FIXFOUR;       /* SET RETURN CODE       @Y30LB25*/ 02588000
         MVC   RPLVRETC(2,@06),@CH00041                            0720 02589000
*           RPLRCODE=NULLIBID;      /* SET REASON CODE       @Y30LB25*/ 02590000
         MVC   RPLRCODE(2,@06),@CB00735                            0721 02591000
*           RETURN;                 /*                       @Y30LB25*/ 02592000
@EL00016 DS    0H                                                  0722 02593000
@EF00016 DS    0H                                                  0722 02594000
@ER00016 L     @14,@SA00016                                        0722 02595000
         BR    @14                                                 0722 02596000
*         END;                      /*                       @Y30LB25*/ 02597000
*                                                                  0723 02598000
*       /*************************************************************/ 02599000
*       /*                                                           */ 02600000
*       /* CHECK FOR REASSIGNED                              @Y30LB25*/ 02601000
*       /*                                                           */ 02602000
*       /*************************************************************/ 02603000
*                                                                  0724 02604000
*       IF BASREASS=ON              /* REASSIGNED?           @Y30LB25*/ 02605000
*         THEN                      /* YES                   @Y30LB25*/ 02606000
@RF00718 L     @06,BASEVPTR                                        0724 02607000
         TM    BASREASS(@06),B'00100000'                           0724 02608000
         BNO   @RF00724                                            0724 02609000
*         DO;                       /* ERROR                 @Y30LB25*/ 02610000
*           RPLVRETC=FIXFOUR;       /* SET RETURN CODE       @Y30LB25*/ 02611000
         L     @06,RPLVPTR                                         0726 02612000
         MVC   RPLVRETC(2,@06),@CH00041                            0726 02613000
*           RPLRCODE=REASSIGN;      /* SET REASON CODE       @Y30LB25*/ 02614000
         MVC   RPLRCODE(2,@06),@CB00737                            0727 02615000
*           RETURN;                 /*                       @Y30LB25*/ 02616000
         B     @EL00016                                            0728 02617000
*         END;                      /*                       @Y30LB25*/ 02618000
*     END;                          /*                       @ZDR2054*/ 02619000
*                                                                  0730 02620000
@RF00724 DS    0H                                                  0731 02621000
*   /*****************************************************************/ 02622000
*   /*                                                               */ 02623000
*   /* FOR ACTIVATING A CVR, GET ITS BVR FOR CHECKING        @ZDR2054*/ 02624000
*   /* THE ATTRIBUTES                                        @ZDR2054*/ 02625000
*   /*                                                               */ 02626000
*   /*****************************************************************/ 02627000
*                                                                  0731 02628000
*   IF BCDCOPY=ON THEN              /* CVR?                  @ZDR2054*/ 02629000
@RF00716 L     @06,BCDVPTR                                         0731 02630000
         TM    BCDCOPY(@06),B'00010000'                            0731 02631000
         BNO   @RF00731                                            0731 02632000
*     DO;                           /* YES                   @ZDR2054*/ 02633000
*       BVOLKY=BCDSERNO;            /* SERIAL NUMBER         @ZDR2054*/ 02634000
         MVC   BVOLKY(6),BCDSERNO(@06)                             0733 02635000
*       RPLVKEY=ADDR(BKEY);         /* KEY ADDR              @ZDR2054*/ 02636000
         LA    @06,BKEY                                            0734 02637000
         L     @01,RPLVPTR                                         0734 02638000
         ST    @06,RPLVKEY(,@01)                                   0734 02639000
*       CALL READLOC;               /* READ BVR              @ZDR2054*/ 02640000
         BAL   @14,READLOC                                         0735 02641000
*       IF RPLVRETC¬=FIXZERO THEN   /* ERROR?                @ZDR2054*/ 02642000
         L     @06,RPLVPTR                                         0736 02643000
         LH    @15,RPLVRETC(,@06)                                  0736 02644000
         N     @15,@CF01129                                        0736 02645000
         LTR   @15,@15                                             0736 02646000
         BNZ   @RT00736                                            0736 02647000
*         RETURN;                   /*                       @ZDR2054*/ 02648000
*       BASEVPTR=RPLVPTR;           /* SET BVR PTR           @ZDR2054*/ 02649000
         ST    @06,BASEVPTR                                        0738 02650000
*     END;                          /*                       @ZDR2054*/ 02651000
*                                                                  0739 02652000
*   /*****************************************************************/ 02653000
*   /*                                                               */ 02654000
*   /* CHECK ATTRIBUTES IF GENERAL-USE, GROUPED.             @Y30LB25*/ 02655000
*   /*                                                               */ 02656000
*   /*****************************************************************/ 02657000
*                                                                  0740 02658000
*   CALL CKATTRIB;                  /* CHECK ATTRIB'S        @Y30LB25*/ 02659000
@RF00731 BAL   @14,CKATTRIB                                        0740 02660000
*   RETURN;                         /*                       @Y30LB25*/ 02661000
         B     @EL00016                                            0741 02662000
*   END ACTVOL1;                    /*                       @Y30LB25*/ 02663000
         B     @EL00016                                            0742 02664000
*                                                                  0743 02665000
*   /*****************************************************************/ 02666000
*   /*                                                               */ 02667000
*   /* PROCEDURE NAME - EXPCK                                @Y30LB25*/ 02668000
*   /*                                                       @Y30LB25*/ 02669000
*   /* FUNCTION -                                            @Y30LB25*/ 02670000
*   /* THIS ROUTINE IS USED BY DEFINEV FUNCTIONS,            @Y30LB25*/ 02671000
*   /* BEFORE THE CALL TO THE MSC.                           @Y30LB25*/ 02672000
*   /* IT READS THE GROUP VOLUME RECORD IF EITHER            @Y30LB25*/ 02673000
*   /* TO OR FOR EXPIRATION DATES WERE SPECIFIED.            @Y30LB25*/ 02674000
*   /* IF THERE IS NO RETENTION FOR THE GROUP                @Y30LB25*/ 02675000
*   /* IT RETURNS WITH AN ERROR REASON CODE.                 @Y30LB25*/ 02676000
*   /*                                                       @Y30LB25*/ 02677000
*   /* INPUT -                                               @Y30LB25*/ 02678000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02679000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02680000
*   /*                                                       @Y30LB25*/ 02681000
*   /* OUTPUT -                                              @Y30LB25*/ 02682000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02683000
*   /* AN ERROR                                              @Y30LB25*/ 02684000
*   /*                                                               */ 02685000
*   /*****************************************************************/ 02686000
*                                                                  0743 02687000
*EXPCK:                                                            0743 02688000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02689000
*                                                                  0743 02690000
EXPCK    ST    @14,@SA00017                                        0743 02691000
*   /*****************************************************************/ 02692000
*   /*                                                               */ 02693000
*   /* BE SURE THAT 'TO' OR 'FOR' WERE SPECIFIED AND         @Y30LB25*/ 02694000
*   /* THAT THERE IS A DEFINE EXTENSION.                     @Y30LB25*/ 02695000
*   /*                                                               */ 02696000
*   /*****************************************************************/ 02697000
*                                                                  0744 02698000
*   IF DEFVVEXT¬=FIXZERO&(DEFPFOR=ON|DEFPTO=ON) THEN               0744 02699000
         L     @06,DEFVVEXT(,DEFVPTR)                              0744 02700000
         LTR   @06,@06                                             0744 02701000
         BZ    @RF00744                                            0744 02702000
         TM    DEFPFOR(DEFVEPTR),B'10001000'                       0744 02703000
         BZ    @RF00744                                            0744 02704000
*     DO;                           /*                       @Y30LB25*/ 02705000
*                                                                  0745 02706000
*       /*************************************************************/ 02707000
*       /*                                                           */ 02708000
*       /* SEE IF BASE RECORD IS GOING GROUPED OR IS         @Y30LB25*/ 02709000
*       /* GROUPED GENERAL-USE OR STAYING                    @Y30LB25*/ 02710000
*       /* GROUPED GENERAL-USE.                              @Y30LB25*/ 02711000
*       /*                                                           */ 02712000
*       /*************************************************************/ 02713000
*                                                                  0746 02714000
*       IF((DEFPGRO=ON|BASGRPV=ON)&DEFGENUS=ON)|/*           @Y30LB25*/ 02715000
*           (BASGENUS=ON&DEFNGRP=OFF&DEFRSTD=OFF)/*          @Y30LB25*/ 02716000
*         THEN                                                     0746 02717000
*                                                                  0746 02718000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0746 02719000
         BO    @GL00022                                            0746 02720000
         L     @06,BASEVPTR                                        0746 02721000
         TM    BASGRPV(@06),B'00100000'                            0746 02722000
         BNO   @GL00021                                            0746 02723000
@GL00022 TM    DEFGENUS(DEFVEPTR),B'10000000'                      0746 02724000
         BO    @RT00746                                            0746 02725000
@GL00021 L     @06,BASEVPTR                                        0746 02726000
         TM    BASGENUS(@06),B'00010000'                           0746 02727000
         BNO   @RF00746                                            0746 02728000
         TM    DEFNGRP(DEFVEPTR),B'10000000'                       0746 02729000
         BNZ   @RF00746                                            0746 02730000
         TM    DEFRSTD(DEFVEPTR),B'01000000'                       0746 02731000
         BNZ   @RF00746                                            0746 02732000
@RT00746 DS    0H                                                  0747 02733000
*         /***********************************************************/ 02734000
*         /*                                                         */ 02735000
*         /* GET GROUP NAME FROM CORRECT SOURCE              @Y30LB25*/ 02736000
*         /*                                                         */ 02737000
*         /***********************************************************/ 02738000
*                                                                  0747 02739000
*         DO;                       /*                       @Y30LB25*/ 02740000
*           IF DEFPGRO=ON THEN      /* GROUP SPECIFIED ?     @Y30LB25*/ 02741000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0748 02742000
         BNO   @RF00748                                            0748 02743000
*             GROUPKY=DEFGROUP;     /* GROUP FROM REQ BLK    @Y30LB25*/ 02744000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       0749 02745000
*           ELSE                    /*                       @Y30LB25*/ 02746000
*             GROUPKY=BASGROUP;     /* GROUP FROM BASE REC   @Y30LB25*/ 02747000
*                                                                  0750 02748000
         B     @RC00748                                            0750 02749000
@RF00748 L     @06,BASEVPTR                                        0750 02750000
         MVC   GROUPKY(8),BASGROUP(@06)                            0750 02751000
*           /*********************************************************/ 02752000
*           /*                                                       */ 02753000
*           /* SET UP REMAINING PARAMETERS                   @Y30LB25*/ 02754000
*           /* AND READ THE GROUP RECORD                     @Y30LB25*/ 02755000
*           /* TO SEE IF IT HAS RETENTION                    @Y30LB25*/ 02756000
*           /* SPECIFIED FOR THE GROUP.                      @Y30LB25*/ 02757000
*           /*                                                       */ 02758000
*           /*********************************************************/ 02759000
*                                                                  0751 02760000
*           RPLVKEY=ADDR(GKEY);     /* ADDR OF KEY           @Y30LB25*/ 02761000
@RC00748 LA    @06,GKEY                                            0751 02762000
         L     @01,RPLVPTR                                         0751 02763000
         ST    @06,RPLVKEY(,@01)                                   0751 02764000
*           CALL READLOC;           /* READ GROUP RECORD     @Y30LB25*/ 02765000
         BAL   @14,READLOC                                         0752 02766000
*           IF RPLVRETC¬=FIXZERO THEN/* CHECK RETURN?        @Y30LB25*/ 02767000
         L     @06,RPLVPTR                                         0753 02768000
         LH    @15,RPLVRETC(,@06)                                  0753 02769000
         N     @15,@CF01129                                        0753 02770000
         LTR   @15,@15                                             0753 02771000
         BNZ   @RT00753                                            0753 02772000
*             RETURN;               /*                       @Y30LB25*/ 02773000
*                                                                  0754 02774000
*           /*********************************************************/ 02775000
*           /*                                                       */ 02776000
*           /* GET ADDRESS OF GROUP RECORD AND CHECK         @Y30LB25*/ 02777000
*           /* IF RETENTION CHECKING IN EFFECT.              @Y30LB25*/ 02778000
*           /*                                                       */ 02779000
*           /*********************************************************/ 02780000
*                                                                  0755 02781000
*           GROUPPTR=RPLVBUF;       /* ADDRESSING TO BUFFER  @Y30LB25*/ 02782000
         L     @15,RPLVBUF(,@06)                                   0755 02783000
         ST    @15,GROUPPTR                                        0755 02784000
*           IF GRORETN=OFF THEN     /* NO RET DATE?          @Y30LB25*/ 02785000
*                                                                  0756 02786000
         TM    GRORETN(@15),B'00000100'                            0756 02787000
         BNZ   @RF00756                                            0756 02788000
*             /*******************************************************/ 02789000
*             /*                                                     */ 02790000
*             /* IF RETENTION CHECKING NOT IN                @Y30LB25*/ 02791000
*             /* EFFECT, ERROR.                              @Y30LB25*/ 02792000
*             /*                                                     */ 02793000
*             /*******************************************************/ 02794000
*                                                                  0757 02795000
*             DO;                   /*                       @Y30LB25*/ 02796000
*               RPLVRETC=FIXFOUR;   /* SET BAD RETURN        @Y30LB25*/ 02797000
         MVC   RPLVRETC(2,@06),@CH00041                            0758 02798000
*               RPLRCODE=NOEXPICK;  /* NO GROUP EXPIRATION   @Y30LB25*/ 02799000
         MVC   RPLRCODE(2,@06),@CB00729                            0759 02800000
*               RETURN;             /*                       @Y30LB25*/ 02801000
@EL00017 DS    0H                                                  0760 02802000
@EF00017 DS    0H                                                  0760 02803000
@ER00017 L     @14,@SA00017                                        0760 02804000
         BR    @14                                                 0760 02805000
*             END;                  /*                       @Y30LB25*/ 02806000
*         END;                      /*                       @Y30LB25*/ 02807000
*                                                                  0762 02808000
*       /*************************************************************/ 02809000
*       /*                                                           */ 02810000
*       /* IF BASE VOLUME IS NOT BECOMMING A GROUPED GENERAL @Y30LB25*/ 02811000
*       /* USE, OR NOT STAYING A GROUPED GENERAL USE, THEN   @Y30LB25*/ 02812000
*       /* 'TO' OR 'FOR' SHOULD NOT HAVE BEEN SPECIFIED.     @Y30LB25*/ 02813000
*       /*                                                           */ 02814000
*       /*************************************************************/ 02815000
*                                                                  0763 02816000
*       ELSE                        /*                       @Y30LB25*/ 02817000
*         DO;                       /*                       @Y30LB25*/ 02818000
         B     @RC00746                                            0763 02819000
@RF00746 DS    0H                                                  0764 02820000
*           RPLVRETC=FIXFOUR;       /* SET BAD RET CODE      @Y30LB25*/ 02821000
         L     @06,RPLVPTR                                         0764 02822000
         MVC   RPLVRETC(2,@06),@CH00041                            0764 02823000
*           RPLRCODE=NOEXPICK;      /* NO EXPIRATION CK      @Y30LB25*/ 02824000
         MVC   RPLRCODE(2,@06),@CB00729                            0765 02825000
*           RETURN;                 /*                       @Y30LB25*/ 02826000
         B     @EL00017                                            0766 02827000
*         END;                      /*                       @Y30LB25*/ 02828000
*     END;                          /*                       @Y30LB25*/ 02829000
*   RETURN;                         /*                       @Y30LB25*/ 02830000
         B     @EL00017                                            0769 02831000
*   END EXPCK;                      /*                       @Y30LB25*/ 02832000
         B     @EL00017                                            0770 02833000
*                                                                  0771 02834000
*   /*****************************************************************/ 02835000
*   /*                                                               */ 02836000
*   /* PROCEDURE NAME - CKATTRIB                             @Y30LB25*/ 02837000
*   /*                                                       @Y30LB25*/ 02838000
*   /* FUNCTION -                                            @Y30LB25*/ 02839000
*   /* CHECK THE ATTRIBUTES IF THE BVR INDICATES THE VOLUME  @Y30LB25*/ 02840000
*   /* IS GROUPED GENERAL-USE OR THE DEFVE EXTENSION         @Y30LB25*/ 02841000
*   /* INDICATES THAT THE VOLUME WILL BE GROUPED             @Y30LB25*/ 02842000
*   /* GENERAL-USE.                                          @Y30LB25*/ 02843000
*   /*                                                       @Y30LB25*/ 02844000
*   /* INPUT -                                               @Y30LB25*/ 02845000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02846000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02847000
*   /*                                                       @Y30LB25*/ 02848000
*   /* OUTPUT -                                              @Y30LB25*/ 02849000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02850000
*   /* AN ERROR                                              @Y30LB25*/ 02851000
*   /*                                                               */ 02852000
*   /*****************************************************************/ 02853000
*                                                                  0771 02854000
*CKATTRIB:                                                         0771 02855000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02856000
*                                                                  0771 02857000
CKATTRIB ST    @14,@SA00018                                        0771 02858000
*   /*****************************************************************/ 02859000
*   /*                                                               */ 02860000
*   /* CHECK FOR A DEFVE AND IF THE BVR IS GOING TO BE       @Y30LB25*/ 02861000
*   /* GROUPED, OR IS NOW GROUPED.                           @Y30LB25*/ 02862000
*   /*                                                               */ 02863000
*   /*****************************************************************/ 02864000
*                                                                  0772 02865000
*   IF(DEFVVEXT¬=FIXZERO&DEFPGRO=ON)|(DEFVVEXT=FIXZERO&BASGRPV=ON)|(    02866000
*       DEFVVEXT¬=FIXZERO&BASGRPV=ON&DEFNGRP=OFF) THEN             0772 02867000
*                                                                  0772 02868000
         L     @06,DEFVVEXT(,DEFVPTR)                              0772 02869000
         LTR   @06,@06                                             0772 02870000
         BZ    @GL00027                                            0772 02871000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0772 02872000
         BO    @RT00772                                            0772 02873000
@GL00027 L     @06,DEFVVEXT(,DEFVPTR)                              0772 02874000
         LTR   @06,@06                                             0772 02875000
         BNZ   @GL00026                                            0772 02876000
         L     @06,BASEVPTR                                        0772 02877000
         TM    BASGRPV(@06),B'00100000'                            0772 02878000
         BO    @RT00772                                            0772 02879000
@GL00026 L     @06,DEFVVEXT(,DEFVPTR)                              0772 02880000
         LTR   @06,@06                                             0772 02881000
         BZ    @RF00772                                            0772 02882000
         L     @06,BASEVPTR                                        0772 02883000
         TM    BASGRPV(@06),B'00100000'                            0772 02884000
         BNO   @RF00772                                            0772 02885000
         TM    DEFNGRP(DEFVEPTR),B'10000000'                       0772 02886000
         BNZ   @RF00772                                            0772 02887000
@RT00772 DS    0H                                                  0773 02888000
*     /***************************************************************/ 02889000
*     /*                                                             */ 02890000
*     /* CHECK IF IT IS BECOMING OR NOW IS GENERAL-USE.      @Y30LB25*/ 02891000
*     /*                                                             */ 02892000
*     /***************************************************************/ 02893000
*                                                                  0773 02894000
*     IF(DEFVVEXT¬=FIXZERO&DEFGENUS=ON)|(DEFVVEXT=FIXZERO&BASGENUS=ON)| 02895000
*         (DEFVVEXT¬=FIXZERO&BASGENUS=ON&DEFRSTD=OFF) THEN/* @Y30LB25*/ 02896000
         L     @06,DEFVVEXT(,DEFVPTR)                              0773 02897000
         LTR   @06,@06                                             0773 02898000
         BZ    @GL00033                                            0773 02899000
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      0773 02900000
         BO    @RT00773                                            0773 02901000
@GL00033 L     @06,DEFVVEXT(,DEFVPTR)                              0773 02902000
         LTR   @06,@06                                             0773 02903000
         BNZ   @GL00032                                            0773 02904000
         L     @06,BASEVPTR                                        0773 02905000
         TM    BASGENUS(@06),B'00010000'                           0773 02906000
         BO    @RT00773                                            0773 02907000
@GL00032 L     @06,DEFVVEXT(,DEFVPTR)                              0773 02908000
         LTR   @06,@06                                             0773 02909000
         BZ    @RF00773                                            0773 02910000
         L     @06,BASEVPTR                                        0773 02911000
         TM    BASGENUS(@06),B'00010000'                           0773 02912000
         BNO   @RF00773                                            0773 02913000
         TM    DEFRSTD(DEFVEPTR),B'01000000'                       0773 02914000
         BNZ   @RF00773                                            0773 02915000
@RT00773 DS    0H                                                  0774 02916000
*       DO;                         /*                       @Y30LB25*/ 02917000
*                                                                  0774 02918000
*         /***********************************************************/ 02919000
*         /*                                                         */ 02920000
*         /* OBTAIN THE CORRECT GROUP NAME                   @Y30LB25*/ 02921000
*         /*                                                         */ 02922000
*         /***********************************************************/ 02923000
*                                                                  0775 02924000
*         IF DEFVVEXT¬=FIXZERO&DEFPGRO=ON THEN/*             @Y30LB25*/ 02925000
         L     @06,DEFVVEXT(,DEFVPTR)                              0775 02926000
         LTR   @06,@06                                             0775 02927000
         BZ    @RF00775                                            0775 02928000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0775 02929000
         BNO   @RF00775                                            0775 02930000
*           GROUPKY=DEFGROUP;       /*                       @Y30LB25*/ 02931000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       0776 02932000
*         ELSE                      /*                       @Y30LB25*/ 02933000
*           GROUPKY=BASGROUP;       /*                       @Y30LB25*/ 02934000
*                                                                  0777 02935000
         B     @RC00775                                            0777 02936000
@RF00775 L     @06,BASEVPTR                                        0777 02937000
         MVC   GROUPKY(8),BASGROUP(@06)                            0777 02938000
*         /***********************************************************/ 02939000
*         /*                                                         */ 02940000
*         /* READ GVR.                                       @Y30LB25*/ 02941000
*         /*                                                         */ 02942000
*         /***********************************************************/ 02943000
*                                                                  0778 02944000
*         RPLVKEY=ADDR(GKEY);       /* SET KEY ADDR          @Y30LB25*/ 02945000
@RC00775 LA    @06,GKEY                                            0778 02946000
         L     @01,RPLVPTR                                         0778 02947000
         ST    @06,RPLVKEY(,@01)                                   0778 02948000
*         CALL READLOC;             /* READ GVR              @Y30LB25*/ 02949000
         BAL   @14,READLOC                                         0779 02950000
*         IF RPLVRETC¬=FIXZERO      /* ERROR?                @Y30LB25*/ 02951000
*           THEN                    /* YES                   @Y30LB25*/ 02952000
         L     @06,RPLVPTR                                         0780 02953000
         LH    @15,RPLVRETC(,@06)                                  0780 02954000
         N     @15,@CF01129                                        0780 02955000
         LTR   @15,@15                                             0780 02956000
         BNZ   @RT00780                                            0780 02957000
*           RETURN;                 /*                       @Y30LB25*/ 02958000
*         GROUPPTR=RPLVBUF;         /* MAPPING ADDR          @Y30LB25*/ 02959000
*                                                                  0782 02960000
         L     @06,RPLVBUF(,@06)                                   0782 02961000
         ST    @06,GROUPPTR                                        0782 02962000
*         /***********************************************************/ 02963000
*         /*                                                         */ 02964000
*         /* CHECK ATTRIBUTES                                @Y30LB25*/ 02965000
*         /*                                                         */ 02966000
*         /***********************************************************/ 02967000
*                                                                  0783 02968000
*         IF DEFVACT=ON|(DEFVRNM=ON&DEFVVFLG=FIX1F) THEN           0783 02969000
*                                                                  0783 02970000
         TM    DEFVACT(DEFVPTR),B'00000010'                        0783 02971000
         BO    @RT00783                                            0783 02972000
         TM    DEFVRNM(DEFVPTR),B'00100000'                        0783 02973000
         BNO   @RF00783                                            0783 02974000
         CLI   DEFVVFLG(DEFVPTR),X'FF'                             0783 02975000
         BNE   @RF00783                                            0783 02976000
@RT00783 DS    0H                                                  0784 02977000
*           /*********************************************************/ 02978000
*           /*                                                       */ 02979000
*           /* CHECK THE ATTRIBUTES BETWEEN THE BVR          @Y30LB25*/ 02980000
*           /* AND THE GVR                                   @Y30LB25*/ 02981000
*           /*                                                       */ 02982000
*           /*********************************************************/ 02983000
*                                                                  0784 02984000
*           DO;                     /*                       @Y30LB25*/ 02985000
*             IF(BASEXCL=OFF&GROEXCL=OFF)|(BASEXCL=ON&GROEXCL=ON)/*     02986000
*                                      EXCLUS MATCH?         @Y30LB25*/ 02987000
*               THEN                /* YES                   @Y30LB25*/ 02988000
         L     @06,BASEVPTR                                        0785 02989000
         TM    BASEXCL(@06),B'00000001'                            0785 02990000
         BNZ   @GL00041                                            0785 02991000
         L     @06,GROUPPTR                                        0785 02992000
         TM    GROEXCL(@06),B'01000000'                            0785 02993000
         BZ    @RT00785                                            0785 02994000
@GL00041 L     @06,BASEVPTR                                        0785 02995000
         TM    BASEXCL(@06),B'00000001'                            0785 02996000
         BNO   @RF00785                                            0785 02997000
         L     @06,GROUPPTR                                        0785 02998000
         TM    GROEXCL(@06),B'01000000'                            0785 02999000
         BNO   @RF00785                                            0785 03000000
@RT00785 DS    0H                                                  0786 03001000
*               DO;                 /*                       @Y30LB25*/ 03002000
*                 IF(BASBIND=OFF&GROBIND=OFF)|(BASBIND=ON&GROBIND=ON)   03003000
*                                   /* BIND MATCH?           @Y30LB25*/ 03004000
*                   THEN            /* YES                   @Y30LB25*/ 03005000
         L     @06,BASEVPTR                                        0787 03006000
         TM    BASBIND(@06),B'00000010'                            0787 03007000
         BNZ   @GL00044                                            0787 03008000
         L     @06,GROUPPTR                                        0787 03009000
         TM    GROBIND(@06),B'10000000'                            0787 03010000
         BZ    @RT00787                                            0787 03011000
@GL00044 L     @06,BASEVPTR                                        0787 03012000
         TM    BASBIND(@06),B'00000010'                            0787 03013000
         BNO   @RF00787                                            0787 03014000
         L     @06,GROUPPTR                                        0787 03015000
         TM    GROBIND(@06),B'10000000'                            0787 03016000
         BNO   @RF00787                                            0787 03017000
@RT00787 DS    0H                                                  0788 03018000
*                   DO;             /*                       @Y30LB25*/ 03019000
*                     IF(BASDAERA=OFF&GRODAERA=OFF)|(BASDAERA=ON&  0789 03020000
*                         GRODAERA=ON)/* DASD ERASE MATCH?   @Y30LB25*/ 03021000
*                       THEN        /* YES                   @Y30LB25*/ 03022000
         L     @06,BASEVPTR                                        0789 03023000
         TM    BASDAERA(@06),B'10000000'                           0789 03024000
         BNZ   @GL00047                                            0789 03025000
         L     @06,GROUPPTR                                        0789 03026000
         TM    GRODAERA(@06),B'00100000'                           0789 03027000
         BZ    @RT00789                                            0789 03028000
@GL00047 L     @06,BASEVPTR                                        0789 03029000
         TM    BASDAERA(@06),B'10000000'                           0789 03030000
         BNO   @RF00789                                            0789 03031000
         L     @06,GROUPPTR                                        0789 03032000
         TM    GRODAERA(@06),B'00100000'                           0789 03033000
         BNO   @RF00789                                            0789 03034000
@RT00789 DS    0H                                                  0790 03035000
*                       A=A;        /* DUMMY INSTRUC         @Y30LB25*/ 03036000
         L     @06,A                                               0790 03037000
         ST    @06,A                                               0790 03038000
*                     ELSE          /* ERROR                 @Y30LB25*/ 03039000
*                       DO;         /*                       @Y30LB25*/ 03040000
         B     @RC00789                                            0791 03041000
@RF00789 DS    0H                                                  0792 03042000
*                         RPLVRETC=FIXFOUR;/*                @Y30LB25*/ 03043000
         L     @06,RPLVPTR                                         0792 03044000
         MVC   RPLVRETC(2,@06),@CH00041                            0792 03045000
*                         RPLRCODE=MISATTB;/*                @Y30LB25*/ 03046000
         MVC   RPLRCODE(2,@06),@CB00731                            0793 03047000
*                         RETURN;   /*                       @Y30LB25*/ 03048000
@EL00018 DS    0H                                                  0794 03049000
@EF00018 DS    0H                                                  0794 03050000
@ER00018 L     @14,@SA00018                                        0794 03051000
         BR    @14                                                 0794 03052000
*                       END;        /*                       @Y30LB25*/ 03053000
*                   END;            /*                       @Y30LB25*/ 03054000
*                 ELSE              /* ERROR                 @Y30LB25*/ 03055000
*                   DO;             /*                       @Y30LB25*/ 03056000
         B     @RC00787                                            0797 03057000
@RF00787 DS    0H                                                  0798 03058000
*                     RPLVRETC=FIXFOUR;/*                    @Y30LB25*/ 03059000
         L     @06,RPLVPTR                                         0798 03060000
         MVC   RPLVRETC(2,@06),@CH00041                            0798 03061000
*                     RPLRCODE=MISATTB;/*                    @Y30LB25*/ 03062000
         MVC   RPLRCODE(2,@06),@CB00731                            0799 03063000
*                     RETURN;       /*                       @Y30LB25*/ 03064000
         B     @EL00018                                            0800 03065000
*                   END;            /*                       @Y30LB25*/ 03066000
*               END;                /*                       @Y30LB25*/ 03067000
*             ELSE                  /* ERROR                 @Y30LB25*/ 03068000
*               DO;                 /*                       @Y30LB25*/ 03069000
         B     @RC00785                                            0803 03070000
@RF00785 DS    0H                                                  0804 03071000
*                 RPLVRETC=FIXFOUR; /*                       @Y30LB25*/ 03072000
         L     @06,RPLVPTR                                         0804 03073000
         MVC   RPLVRETC(2,@06),@CH00041                            0804 03074000
*                 RPLRCODE=MISATTB; /*                       @Y30LB25*/ 03075000
         MVC   RPLRCODE(2,@06),@CB00731                            0805 03076000
*                 RETURN;           /*                       @Y30LB25*/ 03077000
         B     @EL00018                                            0806 03078000
*               END;                /*                       @Y30LB25*/ 03079000
*           END;                    /*                       @Y30LB25*/ 03080000
*                                                                  0808 03081000
*         /***********************************************************/ 03082000
*         /*                                                         */ 03083000
*         /* CHECK ATTRIBUTES BETWEEN THE GVR AND            @Y30LB25*/ 03084000
*         /* THE ICBDEFV REQUEST BLOCK                       @Y30LB25*/ 03085000
*         /*                                                         */ 03086000
*         /***********************************************************/ 03087000
*                                                                  0809 03088000
*         ELSE                                                     0809 03089000
*           DO;                     /*                       @Y30LB25*/ 03090000
         B     @RC00783                                            0809 03091000
@RF00783 DS    0H                                                  0810 03092000
*             IF(DEFVEXCL=OFF&GROEXCL=OFF)|(DEFVEXCL=ON&GROEXCL=ON)/*   03093000
*                                      EXCLUS MATCH?         @Y30LB25*/ 03094000
*               THEN                /* YES                   @Y30LB25*/ 03095000
         TM    DEFVEXCL(DEFVPTR),B'00010000'                       0810 03096000
         BNZ   @GL00050                                            0810 03097000
         L     @06,GROUPPTR                                        0810 03098000
         TM    GROEXCL(@06),B'01000000'                            0810 03099000
         BZ    @RT00810                                            0810 03100000
@GL00050 TM    DEFVEXCL(DEFVPTR),B'00010000'                       0810 03101000
         BNO   @RF00810                                            0810 03102000
         L     @06,GROUPPTR                                        0810 03103000
         TM    GROEXCL(@06),B'01000000'                            0810 03104000
         BNO   @RF00810                                            0810 03105000
@RT00810 DS    0H                                                  0811 03106000
*               DO;                 /*                       @Y30LB25*/ 03107000
*                 IF(DEFVBIND=OFF&GROBIND=OFF)|(DEFVBIND=ON&GROBIND=ON) 03108000
*                                   /* BIND MATCH?           @Y30LB25*/ 03109000
*                   THEN            /* YES                   @Y30LB25*/ 03110000
         TM    DEFVBIND(DEFVPTR),B'00000100'                       0812 03111000
         BNZ   @GL00053                                            0812 03112000
         L     @06,GROUPPTR                                        0812 03113000
         TM    GROBIND(@06),B'10000000'                            0812 03114000
         BZ    @RT00812                                            0812 03115000
@GL00053 TM    DEFVBIND(DEFVPTR),B'00000100'                       0812 03116000
         BNO   @RF00812                                            0812 03117000
         L     @06,GROUPPTR                                        0812 03118000
         TM    GROBIND(@06),B'10000000'                            0812 03119000
         BNO   @RF00812                                            0812 03120000
@RT00812 DS    0H                                                  0813 03121000
*                   DO;             /*                       @Y30LB25*/ 03122000
*                     IF(DEFVSEC=OFF&GRODAERA=OFF)|(DEFVSEC=ON&GRODAERA 03123000
*                         =ON)      /* DASD ERASE MATCH?     @Y30LB25*/ 03124000
*                       THEN        /* YES                   @Y30LB25*/ 03125000
         TM    DEFVSEC(DEFVPTR),B'00100000'                        0814 03126000
         BNZ   @GL00056                                            0814 03127000
         L     @06,GROUPPTR                                        0814 03128000
         TM    GRODAERA(@06),B'00100000'                           0814 03129000
         BZ    @RT00814                                            0814 03130000
@GL00056 TM    DEFVSEC(DEFVPTR),B'00100000'                        0814 03131000
         BNO   @RF00814                                            0814 03132000
         L     @06,GROUPPTR                                        0814 03133000
         TM    GRODAERA(@06),B'00100000'                           0814 03134000
         BNO   @RF00814                                            0814 03135000
@RT00814 DS    0H                                                  0815 03136000
*                       A=A;        /* DUMMY INSTRUC         @Y30LB25*/ 03137000
         L     @06,A                                               0815 03138000
         ST    @06,A                                               0815 03139000
*                     ELSE          /* ERROR                 @Y30LB25*/ 03140000
*                       DO;         /*                       @Y30LB25*/ 03141000
         B     @RC00814                                            0816 03142000
@RF00814 DS    0H                                                  0817 03143000
*                         RPLVRETC=FIXFOUR;/*                @Y30LB25*/ 03144000
         L     @06,RPLVPTR                                         0817 03145000
         MVC   RPLVRETC(2,@06),@CH00041                            0817 03146000
*                         RPLRCODE=MISATTB;/*                @Y30LB25*/ 03147000
         MVC   RPLRCODE(2,@06),@CB00731                            0818 03148000
*                         RETURN;   /*                       @Y30LB25*/ 03149000
         B     @EL00018                                            0819 03150000
*                       END;        /*                       @Y30LB25*/ 03151000
*                   END;            /*                       @Y30LB25*/ 03152000
*                 ELSE              /* ERROR                 @Y30LB25*/ 03153000
*                   DO;             /*                       @Y30LB25*/ 03154000
         B     @RC00812                                            0822 03155000
@RF00812 DS    0H                                                  0823 03156000
*                     RPLVRETC=FIXFOUR;/*                    @Y30LB25*/ 03157000
         L     @06,RPLVPTR                                         0823 03158000
         MVC   RPLVRETC(2,@06),@CH00041                            0823 03159000
*                     RPLRCODE=MISATTB;/*                    @Y30LB25*/ 03160000
         MVC   RPLRCODE(2,@06),@CB00731                            0824 03161000
*                     RETURN;       /*                       @Y30LB25*/ 03162000
         B     @EL00018                                            0825 03163000
*                   END;            /*                       @Y30LB25*/ 03164000
*               END;                /*                       @Y30LB25*/ 03165000
*             ELSE                  /* ERROR                 @Y30LB25*/ 03166000
*               DO;                 /*                       @Y30LB25*/ 03167000
         B     @RC00810                                            0828 03168000
@RF00810 DS    0H                                                  0829 03169000
*                 RPLVRETC=FIXFOUR; /*                       @Y30LB25*/ 03170000
         L     @06,RPLVPTR                                         0829 03171000
         MVC   RPLVRETC(2,@06),@CH00041                            0829 03172000
*                 RPLRCODE=MISATTB; /*                       @Y30LB25*/ 03173000
         MVC   RPLRCODE(2,@06),@CB00731                            0830 03174000
*                 RETURN;           /*                       @Y30LB25*/ 03175000
         B     @EL00018                                            0831 03176000
*               END;                /*                       @Y30LB25*/ 03177000
*           END;                    /*                       @Y30LB25*/ 03178000
*                                                                  0833 03179000
@RC00810 DS    0H                                                  0834 03180000
*         /***********************************************************/ 03181000
*         /*                                                         */ 03182000
*         /* CHECK READ ONLY FOR - REPLACE VOLUME FLAGS.     @Y30LB25*/ 03183000
*         /*                                                         */ 03184000
*         /***********************************************************/ 03185000
*                                                                  0834 03186000
*         IF DEFVREP=ON             /* REPLACE VOL FLAGS     @Y30LB25*/ 03187000
*           THEN                    /* YES                   @Y30LB25*/ 03188000
@RC00783 TM    DEFVREP(DEFVPTR),B'00010000'                        0834 03189000
         BNO   @RF00834                                            0834 03190000
*           IF(DEFVWINH=OFF&GRORONLY=OFF)|(DEFVWINH=ON&GRORONLY=ON)/*   03191000
*                                      READ ONLY MATCH?      @Y30LB25*/ 03192000
*             THEN                  /* YES                   @Y30LB25*/ 03193000
         TM    DEFVWINH(DEFVPTR),B'00000010'                       0835 03194000
         BNZ   @GL00059                                            0835 03195000
         L     @06,GROUPPTR                                        0835 03196000
         TM    GRORONLY(@06),B'00010000'                           0835 03197000
         BZ    @RT00835                                            0835 03198000
@GL00059 TM    DEFVWINH(DEFVPTR),B'00000010'                       0835 03199000
         BNO   @RF00835                                            0835 03200000
         L     @06,GROUPPTR                                        0835 03201000
         TM    GRORONLY(@06),B'00010000'                           0835 03202000
         BO    @RT00835                                            0835 03203000
*             RETURN;               /*                       @Y30LB25*/ 03204000
*           ELSE                    /* NO                    @Y30LB25*/ 03205000
*             DO;                   /*                       @Y30LB25*/ 03206000
@RF00835 DS    0H                                                  0838 03207000
*               RPLVRETC=FIXFOUR;   /*                       @Y30LB25*/ 03208000
         L     @06,RPLVPTR                                         0838 03209000
         MVC   RPLVRETC(2,@06),@CH00041                            0838 03210000
*               RPLRCODE=MISATTB;   /*                       @Y30LB25*/ 03211000
         MVC   RPLRCODE(2,@06),@CB00731                            0839 03212000
*             END;                  /*                       @Y30LB25*/ 03213000
*       END;                        /*                       @Y30LB25*/ 03214000
*   RETURN;                         /*                       @Y30LB25*/ 03215000
         B     @EL00018                                            0842 03216000
*   END CKATTRIB;                   /*                       @Y30LB25*/ 03217000
         B     @EL00018                                            0843 03218000
*                                                                  0844 03219000
*   /*****************************************************************/ 03220000
*   /*                                                               */ 03221000
*   /* PROCEDURE NAME - ACTVOL2                              @Y30LB25*/ 03222000
*   /*                                                       @Y30LB25*/ 03223000
*   /* FUNCTION - PROCESS A VOLUME AFTER THE CALL TO THE     @Y30LB25*/ 03224000
*   /* MSC WHICH HAS JUST MADE IT ACTIVE.                    @Y30LB25*/ 03225000
*   /*                                                       @Y30LB25*/ 03226000
*   /* RESTRICTIONS - CAN NOT CHANGE THE VOLUME FROM         @Y30LB25*/ 03227000
*   /* GENERAL TO RESTRICTED OR RESTRICTED TO GENERAL,       @Y30LB25*/ 03228000
*   /* REMOVE OR ADD A VOLUME TO A GROUP, AND MOVE           @Y30LB25*/ 03229000
*   /* A VOLUME FROM ONE GROUP TO ANOTHER GROUP.             @Y30LB25*/ 03230000
*   /* THIS WILL RESULT IN MSVI PROBLEMS.                    @Y30LB25*/ 03231000
*   /*                                                       @Y30LB25*/ 03232000
*   /* INPUT -                                               @Y30LB25*/ 03233000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 03234000
*   /*                                                       @Y30LB25*/ 03235000
*   /* OUTPUT -                                              @Y30LB25*/ 03236000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 03237000
*   /* AN ERROR                                              @Y30LB25*/ 03238000
*   /*                                                               */ 03239000
*   /*****************************************************************/ 03240000
*                                                                  0844 03241000
*ACTVOL2:                           /*                       @Y30LB25*/ 03242000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 03243000
ACTVOL2  ST    @14,@SA00019                                        0844 03244000
*   IF RPLRCODE¬=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 03245000
*     THEN                          /* YES                   @Y30LB25*/ 03246000
         L     @06,RPLVPTR                                         0845 03247000
         LH    @15,RPLRCODE(,@06)                                  0845 03248000
         N     @15,@CF01129                                        0845 03249000
         LTR   @15,@15                                             0845 03250000
         BZ    @RF00845                                            0845 03251000
*     DO;                           /*                       @Y30LB25*/ 03252000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 03253000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0847 03254000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 03255000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0848 03256000
*       RETURN;                     /*                       @Y30LB25*/ 03257000
@EL00019 DS    0H                                                  0849 03258000
@EF00019 DS    0H                                                  0849 03259000
@ER00019 L     @14,@SA00019                                        0849 03260000
         BR    @14                                                 0849 03261000
*     END;                          /*                       @Y30LB25*/ 03262000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   03263000
*                                      RESERVE .MSVI         @Y30LB25*/ 03264000
*                                                                  0851 03265000
@RF00845 BAL   @14,HOUSKEEP                                        0851 03266000
*   /*****************************************************************/ 03267000
*   /*                                                               */ 03268000
*   /* READ FOR CIR TO GET THE BVR OR CVR KEY.               @ZDR2054*/ 03269000
*   /* THEN GET THE BASE OR COPY RECORD FROM ITS KEY         @ZDR2054*/ 03270000
*   /* IN THE CIR - FOR UPDATE                               @ZDR2054*/ 03271000
*   /*                                                               */ 03272000
*   /*****************************************************************/ 03273000
*                                                                  0852 03274000
*   IVOLKY=DEFVCSN1;                /* SET UP KEY            @Y30LB25*/ 03275000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        0852 03276000
*   CALL GETRECUD;                  /* GET RECORD            @Y30LB25*/ 03277000
         BAL   @14,GETRECUD                                        0853 03278000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 03279000
*     THEN                          /* YES                   @Y30LB25*/ 03280000
         L     @06,RPLVPTR                                         0854 03281000
         LH    @06,RPLVRETC(,@06)                                  0854 03282000
         N     @06,@CF01129                                        0854 03283000
         LTR   @06,@06                                             0854 03284000
         BNZ   @RT00854                                            0854 03285000
*     RETURN;                       /*                       @Y30LB25*/ 03286000
*                                                                  0855 03287000
*   /*****************************************************************/ 03288000
*   /*                                                               */ 03289000
*   /* CHECK FOR ACTIVATE OF A CVR                           @ZDR2054*/ 03290000
*   /*                                                               */ 03291000
*   /*****************************************************************/ 03292000
*                                                                  0856 03293000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP BVR BUF    @ZDR2054*/ 03294000
         LA    @06,BASEBUF                                         0856 03295000
         ST    @06,BCDVPTR                                         0856 03296000
*   IF BCDCOPY=ON THEN              /* CVR?                  @ZDR2054*/ 03297000
         TM    BCDCOPY(@06),B'00010000'                            0857 03298000
         BNO   @RF00857                                            0857 03299000
*     DO;                           /* YES                   @ZDR2054*/ 03300000
*       COPYBUF=BASEBUF;            /* CVR TO CVR BUF        @ZDR2054*/ 03301000
*                                                                  0859 03302000
         MVC   COPYBUF(224),BASEBUF                                0859 03303000
*       /*************************************************************/ 03304000
*       /*                                                           */ 03305000
*       /* MAKE THE CVR INTO A BVR                           @ZDR2054*/ 03306000
*       /*                                                           */ 03307000
*       /*************************************************************/ 03308000
*                                                                  0860 03309000
*       CALL CVRTOBVR;              /* CVR TO A BVR          @ZDR2054*/ 03310000
         BAL   @14,CVRTOBVR                                        0860 03311000
*       IF RPLVRETC¬=FIXZERO THEN   /* ERROR?                @ZDR2054*/ 03312000
         L     @06,RPLVPTR                                         0861 03313000
         LH    @06,RPLVRETC(,@06)                                  0861 03314000
         N     @06,@CF01129                                        0861 03315000
         LTR   @06,@06                                             0861 03316000
         BNZ   @RT00861                                            0861 03317000
*         RETURN;                   /* YES                   @ZDR2054*/ 03318000
*     END;                          /*                       @ZDR2054*/ 03319000
*                                                                  0863 03320000
*   /*****************************************************************/ 03321000
*   /*                                                               */ 03322000
*   /* UPDATE THE BVR                                        @Y30LB25*/ 03323000
*   /*                                                               */ 03324000
*   /*****************************************************************/ 03325000
*                                                                  0864 03326000
*   BASINAC=OFF;                    /* MAKE ACTIVE           @Y30LB25*/ 03327000
@RF00857 L     @06,BASEVPTR                                        0864 03328000
         NI    BASINAC(@06),B'11111011'                            0864 03329000
*   BASHOLD=OFF;                    /* MAKE NOT A PHOLD      @ZA17163*/ 03330000
         NI    BASHOLD(@06),B'01111111'                            0865 03331000
*   IF BASLIB1=FIX1F&BASLIB2¬=FIX1F /* NULL LIBID 1?         @Y30LB25*/ 03332000
*     THEN                          /* YES                   @Y30LB25*/ 03333000
         CLI   BASLIB1(@06),255                                    0866 03334000
         BNE   @RF00866                                            0866 03335000
         CLI   BASLIB2(@06),255                                    0866 03336000
         BE    @RF00866                                            0866 03337000
*     BASLIB1=BASLIB2;              /* SET LIBID 1           @Y30LB25*/ 03338000
         IC    @15,BASLIB2(,@06)                                   0867 03339000
         STC   @15,BASLIB1(,@06)                                   0867 03340000
*   IF BASLIB2=FIX1F&BASLIB1¬=FIX1F /* NULL LIBID 2?         @Y30LB25*/ 03341000
*     THEN                          /* YES                   @Y30LB25*/ 03342000
@RF00866 L     @06,BASEVPTR                                        0868 03343000
         CLI   BASLIB2(@06),255                                    0868 03344000
         BNE   @RF00868                                            0868 03345000
         CLI   BASLIB1(@06),255                                    0868 03346000
         BE    @RF00868                                            0868 03347000
*     BASLIB2=BASLIB1;              /* SET LIBID 2           @Y30LB25*/ 03348000
*                                                                  0869 03349000
         IC    @15,BASLIB1(,@06)                                   0869 03350000
         STC   @15,BASLIB2(,@06)                                   0869 03351000
*   /*****************************************************************/ 03352000
*   /*                                                               */ 03353000
*   /* CHECK FOR AN EXTENSION (IEZDEFVE)                     @Y30LB25*/ 03354000
*   /*                                                               */ 03355000
*   /*****************************************************************/ 03356000
*                                                                  0870 03357000
*   IF DEFVVEXT¬=FIXZERO            /* A DEFVE?              @Y30LB25*/ 03358000
*     THEN                          /* YES                   @Y30LB25*/ 03359000
@RF00868 L     @06,DEFVVEXT(,DEFVPTR)                              0870 03360000
         LTR   @06,@06                                             0870 03361000
         BZ    @RF00870                                            0870 03362000
*     DO;                           /*                       @Y30LB25*/ 03363000
*       BCDVPTR=BASEVPTR;           /* SET COM MAP PTR       @Y30LB25*/ 03364000
         L     @06,BASEVPTR                                        0872 03365000
         ST    @06,BCDVPTR                                         0872 03366000
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/ 03367000
         BAL   @14,PRODEFVE                                        0873 03368000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 03369000
*         THEN                      /* YES                   @Y30LB25*/ 03370000
         L     @06,RPLVPTR                                         0874 03371000
         LH    @06,RPLVRETC(,@06)                                  0874 03372000
         N     @06,@CF01129                                        0874 03373000
         LTR   @06,@06                                             0874 03374000
         BNZ   @RT00874                                            0874 03375000
*         RETURN;                   /*                       @Y30LB25*/ 03376000
*     END;                          /*                       @Y30LB25*/ 03377000
*                                                                  0876 03378000
*   /*****************************************************************/ 03379000
*   /*                                                               */ 03380000
*   /* CHECK IF VOLUME IS GROUPED                            @Y30LB25*/ 03381000
*   /* GROUP CHANGES WILL NOT OCCUR ON AN ACTIVE VOLUME.     @Y30LB25*/ 03382000
*   /*                                                               */ 03383000
*   /*****************************************************************/ 03384000
*                                                                  0877 03385000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 03386000
*     THEN                          /* YES                   @Y30LB25*/ 03387000
@RF00870 L     @06,BASEVPTR                                        0877 03388000
         TM    BASGRPV(@06),B'00100000'                            0877 03389000
         BNO   @RF00877                                            0877 03390000
*     DO;                           /*                       @Y30LB25*/ 03391000
*                                                                  0878 03392000
*       /*************************************************************/ 03393000
*       /*                                                           */ 03394000
*       /* GET AND UPDATE THE GROUP VOLUME RECORD            @Y30LB25*/ 03395000
*       /*                                                           */ 03396000
*       /*************************************************************/ 03397000
*                                                                  0879 03398000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/ 03399000
         MVC   GROUPKY(8),BASGROUP(@06)                            0879 03400000
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @Y30LB25*/ 03401000
         LA    @06,GKEY                                            0880 03402000
         L     @01,RPLVPTR                                         0880 03403000
         ST    @06,RPLVKEY(,@01)                                   0880 03404000
*       CALL READUPD1;              /* READ GVR              @Y30LB25*/ 03405000
         BAL   @14,READUPD1                                        0881 03406000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 03407000
*         THEN                      /* YES                   @Y30LB25*/ 03408000
         L     @06,RPLVPTR                                         0882 03409000
         LH    @06,RPLVRETC(,@06)                                  0882 03410000
         N     @06,@CF01129                                        0882 03411000
         LTR   @06,@06                                             0882 03412000
         BNZ   @RT00882                                            0882 03413000
*         RETURN;                   /*                       @Y30LB25*/ 03414000
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUFF      @Y30LB25*/ 03415000
         MVC   GROUPBUF(224),BASEBUF1                              0884 03416000
*       GRONINAC=GRONINAC-FIXONE;   /* DECR # INACT VOLS     @Y30LB25*/ 03417000
         L     @06,GROUPPTR                                        0885 03418000
         LH    @15,GRONINAC(,@06)                                  0885 03419000
         BCTR  @15,0                                               0885 03420000
         STH   @15,GRONINAC(,@06)                                  0885 03421000
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 03422000
*         THEN                      /* YES                   @Y30LB25*/ 03423000
         L     @01,BASEVPTR                                        0886 03424000
         TM    BASRSTD(@01),B'00001000'                            0886 03425000
         BNO   @RF00886                                            0886 03426000
*         GRONRSTD=GRONRSTD+FIXONE; /*                       @Y30LB25   03427000
*                                      INCR # RSTD VOLS      @Y30LB25*/ 03428000
         LA    @15,1                                               0887 03429000
         AH    @15,GRONRSTD(,@06)                                  0887 03430000
         STH   @15,GRONRSTD(,@06)                                  0887 03431000
*       ELSE                        /* CK GEN-USE            @Y30LB25*/ 03432000
*         IF BASGENUS=ON            /* GENERAL-USE?          @Y30LB25*/ 03433000
*           THEN                    /* YES                   @Y30LB25*/ 03434000
         B     @RC00886                                            0888 03435000
@RF00886 L     @06,BASEVPTR                                        0888 03436000
         TM    BASGENUS(@06),B'00010000'                           0888 03437000
         BNO   @RF00888                                            0888 03438000
*           DO;                     /*                       @Y30LB25*/ 03439000
*             GRONGEN=GRONGEN+FIXONE;/*                      @Y30LB25   03440000
*                                      INCR # G-USE VOLS     @Y30LB25*/ 03441000
*                                                                  0890 03442000
         L     @06,GROUPPTR                                        0890 03443000
         LA    @15,1                                               0890 03444000
         AH    @15,GRONGEN(,@06)                                   0890 03445000
         STH   @15,GRONGEN(,@06)                                   0890 03446000
*             /*******************************************************/ 03447000
*             /*                                                     */ 03448000
*             /* PROCESS GROUP VOLUME RECORD                 @Y30LB25*/ 03449000
*             /*                                                     */ 03450000
*             /*******************************************************/ 03451000
*                                                                  0891 03452000
*             ADDSUBGR=ON;          /* ADD                   @Y30LB25*/ 03453000
         OI    ADDSUBGR,B'00001000'                                0891 03454000
*             CALL VUPGH;           /* UPDATE GVR            @Y30LB25*/ 03455000
         BAL   @14,VUPGH                                           0892 03456000
*           END;                    /*                       @Y30LB25*/ 03457000
*       RPLVBUF=ADDR(GROUPBUF);     /* GVR BUF ADDR          @Y30LB25*/ 03458000
@RF00888 DS    0H                                                  0894 03459000
@RC00886 LA    @06,GROUPBUF                                        0894 03460000
         L     @01,RPLVPTR                                         0894 03461000
         ST    @06,RPLVBUF(,@01)                                   0894 03462000
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/ 03463000
         BAL   @14,WRITRECD                                        0895 03464000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 03465000
*         THEN                      /* YES                   @Y30LB25*/ 03466000
         L     @06,RPLVPTR                                         0896 03467000
         LH    @06,RPLVRETC(,@06)                                  0896 03468000
         N     @06,@CF01129                                        0896 03469000
         LTR   @06,@06                                             0896 03470000
         BNZ   @RT00896                                            0896 03471000
*         RETURN;                   /*                       @Y30LB25*/ 03472000
*                                                                  0897 03473000
*       /*************************************************************/ 03474000
*       /*                                                           */ 03475000
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/ 03476000
*       /*                                                           */ 03477000
*       /*************************************************************/ 03478000
*                                                                  0898 03479000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Y30LB25*/ 03480000
*         THEN                      /* YES                   @Y30LB25*/ 03481000
*                                                                  0898 03482000
         L     @06,BASEVPTR                                        0898 03483000
         TM    BASGENUS(@06),B'00010000'                           0898 03484000
         BNO   @RF00898                                            0898 03485000
*         /***********************************************************/ 03486000
*         /*                                                         */ 03487000
*         /* ADD A GROUP VOLUME SERIAL NUMBER EXTENSION SLOT @Y30LB25*/ 03488000
*         /*                                                         */ 03489000
*         /***********************************************************/ 03490000
*                                                                  0899 03491000
*         DO;                       /*                       @Y30LB25*/ 03492000
*           EXPSLOT=OFF;            /* NO EXPIR DATE         @Y30LB25*/ 03493000
         NI    EXPSLOT,B'01111111'                                 0900 03494000
*           ADDSUBSL=ON;            /* ADD                   @Y30LB25*/ 03495000
         OI    ADDSUBSL,B'00000010'                                0901 03496000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   0902 03497000
*                                                            @Y30LB25   03498000
*                                      CREATE A SLOT         @Y30LB25*/ 03499000
         L     @15,@CV00767                                        0902 03500000
         LA    @01,@AL00902                                        0902 03501000
         BALR  @14,@15                                             0902 03502000
*           IF RPLVRETC¬=FIXZERO    /* ERROR?                @Y30LB25*/ 03503000
*             THEN                  /* YES                   @Y30LB25*/ 03504000
         L     @06,RPLVPTR                                         0903 03505000
         LH    @06,RPLVRETC(,@06)                                  0903 03506000
         N     @06,@CF01129                                        0903 03507000
         LTR   @06,@06                                             0903 03508000
         BNZ   @RT00903                                            0903 03509000
*             RETURN;               /*                       @Y30LB25*/ 03510000
*         END;                      /*                       @Y30LB25*/ 03511000
*     END;                          /*                       @Y30LB25*/ 03512000
*                                                                  0906 03513000
@RF00898 DS    0H                                                  0907 03514000
*   /*****************************************************************/ 03515000
*   /*                                                               */ 03516000
*   /* REESABLISH BVR RPL                                    @Y30LB25*/ 03517000
*   /*                                                               */ 03518000
*   /*****************************************************************/ 03519000
*                                                                  0907 03520000
*   BVOLKY=BASSERNO;                /* RESET VOLID           @Y30LB25*/ 03521000
@RF00877 L     @06,BASEVPTR                                        0907 03522000
         MVC   BVOLKY(6),BASSERNO(@06)                             0907 03523000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 03524000
         LA    @06,BKEY                                            0908 03525000
         L     @01,RPLVPTR                                         0908 03526000
         ST    @06,RPLVKEY(,@01)                                   0908 03527000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 03528000
         BAL   @14,READUPD1                                        0909 03529000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 03530000
*     THEN                          /* YES                   @Y30LB25*/ 03531000
         L     @06,RPLVPTR                                         0910 03532000
         LH    @15,RPLVRETC(,@06)                                  0910 03533000
         N     @15,@CF01129                                        0910 03534000
         LTR   @15,@15                                             0910 03535000
         BNZ   @RT00910                                            0910 03536000
*     RETURN;                       /*                       @Y30LB25*/ 03537000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Y30LB25*/ 03538000
         LA    @15,BASEBUF                                         0912 03539000
         ST    @15,RPLVBUF(,@06)                                   0912 03540000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 03541000
         BAL   @14,WRITRECD                                        0913 03542000
*   RETURN;                         /*                       @Y30LB25*/ 03543000
         B     @EL00019                                            0914 03544000
*   END ACTVOL2;                    /*                       @Y30LB25*/ 03545000
         B     @EL00019                                            0915 03546000
*                                                                  0916 03547000
*   /*****************************************************************/ 03548000
*   /*                                                               */ 03549000
*   /* PROCEDURE NAME - CVRTOBVR                             @ZDR2054*/ 03550000
*   /*                                                       @ZDR2054*/ 03551000
*   /* FUNCTION - MAKE A COPY VOLUME WHOSE BASE VOLUME       @ZDR2054*/ 03552000
*   /* HAS HAD ITS CARTRIDGES REASSIGNED OR EJECTED          @ZDR2054*/ 03553000
*   /* INTO A BASE VOLUME WITH THE SAME VOLID. THE           @ZDR2054*/ 03554000
*   /* CHECK FOR THE CARTRIDGES BEING REASSIGNED OR          @ZDR2054*/ 03555000
*   /* EJECTED HAS BEEN MADE BY THE ADDV UTILITY.            @ZDR2054*/ 03556000
*   /*                                                       @ZDR2054*/ 03557000
*   /* INPUT -                                               @ZDR2054*/ 03558000
*   /* MSVC REQUEST PARAMETER LIST                           @ZDR2054*/ 03559000
*   /* BASE VOLUME RECORD                                    @ZDR2054*/ 03560000
*   /* COPY VOLUME RECORD                                    @ZDR2054*/ 03561000
*   /*                                                       @ZDR2054*/ 03562000
*   /* OUTPUT -                                              @ZDR2054*/ 03563000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @ZDR2054*/ 03564000
*   /* AN ERROR                                              @ZDR2054*/ 03565000
*   /* BASE VOLUME RECORD                                    @ZDR2054*/ 03566000
*   /*                                                               */ 03567000
*   /*****************************************************************/ 03568000
*                                                                  0916 03569000
*CVRTOBVR:                          /*                       @ZDR2054*/ 03570000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 03571000
*                                                                  0916 03572000
CVRTOBVR ST    @14,@SA00020                                        0916 03573000
*   /*****************************************************************/ 03574000
*   /*                                                               */ 03575000
*   /* DELETE THE CVR                                        @ZDR2054*/ 03576000
*   /*                                                               */ 03577000
*   /*****************************************************************/ 03578000
*                                                                  0917 03579000
*   RPLVBUF=ADDR(COPYBUF);          /* CVR BUF ADDR          @ZDR2054*/ 03580000
         L     @06,RPLVPTR                                         0917 03581000
         LA    @15,COPYBUF                                         0917 03582000
         ST    @15,RPLVBUF(,@06)                                   0917 03583000
*   RPLVTYP=RPLVDEL;                /* DELETE                @ZDR2054*/ 03584000
         MVI   RPLVTYP(@06),X'05'                                  0918 03585000
*   RESPECIFY                                                      0919 03586000
*     RG1 RSTD;                     /* RESTRICT REG 1        @ZDR2054*/ 03587000
*   RG1=RPLVPTR;                    /* PT TO RPLV            @ZDR2054*/ 03588000
         LR    RG1,@06                                             0920 03589000
*   CALL ICBVIO00;                  /* DELET BVR PLC HOLD    @ZDR2054*/ 03590000
         L     @15,@CV00762                                        0921 03591000
         BALR  @14,@15                                             0921 03592000
*   RESPECIFY                                                      0922 03593000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @ZDR2054*/ 03594000
*                                                                  0922 03595000
*   /*****************************************************************/ 03596000
*   /*                                                               */ 03597000
*   /* READ THE BVR FOR UPDATE                               @ZDR2054*/ 03598000
*   /*                                                               */ 03599000
*   /*****************************************************************/ 03600000
*                                                                  0923 03601000
*   BVOLKY=COPSERNO;                /* SERIAL NUMBER         @ZDR2054*/ 03602000
         L     @06,COPYVPTR                                        0923 03603000
         MVC   BVOLKY(6),COPSERNO(@06)                             0923 03604000
*   RPLVKEY=ADDR(BKEY);             /* KEY ADDR              @ZDR2054*/ 03605000
         LA    @06,BKEY                                            0924 03606000
         L     @01,RPLVPTR                                         0924 03607000
         ST    @06,RPLVKEY(,@01)                                   0924 03608000
*   CALL READUPD1;                  /* READ BVR              @ZDR2054*/ 03609000
         BAL   @14,READUPD1                                        0925 03610000
*   IF RPLVRETC¬=FIXZERO THEN       /* ERROR?                @ZDR2054*/ 03611000
         L     @06,RPLVPTR                                         0926 03612000
         LH    @15,RPLVRETC(,@06)                                  0926 03613000
         N     @15,@CF01129                                        0926 03614000
         LTR   @15,@15                                             0926 03615000
         BNZ   @RT00926                                            0926 03616000
*     RETURN;                       /* YES                   @ZDR2054*/ 03617000
*   BASEBUF=BASEBUF1;               /* BVR TO BVR BUF        @ZDR2054*/ 03618000
*                                                                  0928 03619000
         MVC   BASEBUF(224),BASEBUF1                               0928 03620000
*   /*****************************************************************/ 03621000
*   /*                                                               */ 03622000
*   /* GET AND DELETE THE BVR'S CIRS.                        @ZDR2054*/ 03623000
*   /* DO NOT CHECK RETURN CODE FROM DELTRECD BECAUSE        @ZDR2054*/ 03624000
*   /* MSVC WILL CLEAN UP CIR UPON CARTRIDGE ENTRY.          @ZDR2054*/ 03625000
*   /*                                                               */ 03626000
*   /*****************************************************************/ 03627000
*                                                                  0929 03628000
*   IVOLKY=BASCSN1;                 /* CIR KEY FOR CSN1      @ZDR2054*/ 03629000
         L     @01,BASEVPTR                                        0929 03630000
         MVC   IVOLKY(12),BASCSN1(@01)                             0929 03631000
*   RPLVKEY=ADDR(IKEY);             /* KEY ADDR              @ZDR2054*/ 03632000
         LA    @15,IKEY                                            0930 03633000
         ST    @15,RPLVKEY(,@06)                                   0930 03634000
*   RPLVBUF=ADDR(INDEXBUF);         /* CIR BUF ADDR          @ZDR2054*/ 03635000
         LA    @15,INDEXBUF                                        0931 03636000
         ST    @15,RPLVBUF(,@06)                                   0931 03637000
*   RPLVBLN=LENGTH(INDEXBUF);       /* CIR BUF LENGTH        @ZDR2054*/ 03638000
         MVC   RPLVBLN(4,@06),@CF00339                             0932 03639000
*   CALL DELTRECD;                  /* DELT CIR FOR CSN1     @ZDR2054*/ 03640000
         BAL   @14,DELTRECD                                        0933 03641000
*   IVOLKY=BASCSN2;                 /* CIR KEY FOR CSN2      @ZDR2054*/ 03642000
         L     @06,BASEVPTR                                        0934 03643000
         MVC   IVOLKY(12),BASCSN2(@06)                             0934 03644000
*   CALL DELTRECD;                  /* DELT CIR FOR CSN2     @ZDR2054*/ 03645000
*                                                                  0935 03646000
         BAL   @14,DELTRECD                                        0935 03647000
*   /*****************************************************************/ 03648000
*   /*                                                               */ 03649000
*   /* INITIALIZE AND RESET BVR FIELDS FROM THE CVR          @ZDR2054*/ 03650000
*   /*                                                               */ 03651000
*   /*****************************************************************/ 03652000
*                                                                  0936 03653000
*   BASREASS=OFF;                   /* CART NOT REASSIGN     @ZDR2054*/ 03654000
         L     @06,BASEVPTR                                        0936 03655000
         NI    BASREASS(@06),B'11011111'                           0936 03656000
*   BASCSN1=COPCSN1;                /* SET CSN 1             @ZDR2054*/ 03657000
         L     @15,COPYVPTR                                        0937 03658000
         MVC   BASCSN1(12,@06),COPCSN1(@15)                        0937 03659000
*   BASLIB1=COPLIB1;                /* MSF 1                 @ZDR2054*/ 03660000
         IC    @14,COPLIB1(,@15)                                   0938 03661000
         STC   @14,BASLIB1(,@06)                                   0938 03662000
*   BASCSN2=COPCSN2;                /* SET CSN 2             @ZDR2054*/ 03663000
         MVC   BASCSN2(12,@06),COPCSN2(@15)                        0939 03664000
*   BASLIB2=COPLIB2;                /* MSF 2                 @ZDR2054*/ 03665000
         IC    @14,COPLIB2(,@15)                                   0940 03666000
         STC   @14,BASLIB2(,@06)                                   0940 03667000
*   BASFRESP=COPFRESP;              /* # FREE CYLANDERS      @ZDR2054*/ 03668000
         LH    @14,COPFRESP(,@15)                                  0941 03669000
         STH   @14,BASFRESP(,@06)                                  0941 03670000
*   BASLEXT=COPLEXT;                /* # CYL IN LARGEST      @ZDR2054   03671000
*                                      FREE EXTENT           @ZDR2054*/ 03672000
         LH    @14,COPLEXT(,@15)                                   0942 03673000
         STH   @14,BASLEXT(,@06)                                   0942 03674000
*   BASFREXT=COPFREXT;              /* # FREE EXTENTS        @ZDR2054*/ 03675000
         L     @14,COPFREXT(,@15)                                  0943 03676000
         ST    @14,BASFREXT(,@06)                                  0943 03677000
*   BASOWNER=COPOWNER;              /* OWNER                 @ZDR2054*/ 03678000
         MVC   BASOWNER(10,@06),COPOWNER(@15)                      0944 03679000
*   BASDESCR=COPDESCR;              /* DESCRIPTION           @ZDR2054*/ 03680000
         MVC   BASDESCR(30,@06),COPDESCR(@15)                      0945 03681000
*   IF COPDLSPF=ON THEN             /* DOWN LEVEL SPACE?     @ZDR2054*/ 03682000
         TM    COPDLSPF(@15),B'01000000'                           0946 03683000
         BNO   @RF00946                                            0946 03684000
*     BASDLSF=ON;                   /* YES                   @ZDR2054*/ 03685000
         OI    BASDLSF(@06),B'10000000'                            0947 03686000
*   ELSE                                                           0948 03687000
*     BASDLSF=OFF;                  /* NO                    @ZDR2054*/ 03688000
         B     @RC00946                                            0948 03689000
@RF00946 L     @06,BASEVPTR                                        0948 03690000
         NI    BASDLSF(@06),B'01111111'                            0948 03691000
*   BASDLMTD=BLANK4;                /* DATE LAST MOUNT       @ZDR2054*/ 03692000
@RC00946 L     @06,BASEVPTR                                        0949 03693000
         MVI   BASDLMTD+1(@06),C' '                                0949 03694000
         MVC   BASDLMTD+2(2,@06),BASDLMTD+1(@06)                   0949 03695000
         MVI   BASDLMTD(@06),C' '                                  0949 03696000
*   BASDTREM=BLANK4;                /* EJECT DATE            @ZDR2054*/ 03697000
         MVI   BASDTREM+1(@06),C' '                                0950 03698000
         MVC   BASDTREM+2(2,@06),BASDTREM+1(@06)                   0950 03699000
         MVI   BASDTREM(@06),C' '                                  0950 03700000
*   BASDEST=BLANK30;                /* EJECT DESTINATION     @ZDR2054*/ 03701000
         MVI   BASDEST+1(@06),C' '                                 0951 03702000
         MVC   BASDEST+2(28,@06),BASDEST+1(@06)                    0951 03703000
         MVI   BASDEST(@06),C' '                                   0951 03704000
*   BASEXPDT=FIX4FS;                /* EXPIRATION DATE       @ZDR2054*/ 03705000
         MVC   BASEXPDT(4,@06),@CB00677                            0952 03706000
*   BASRECOV=BLANK6;                /* RECOVERY VOLID        @ZDR2054*/ 03707000
*                                                                  0953 03708000
         MVI   BASRECOV+1(@06),C' '                                0953 03709000
         MVC   BASRECOV+2(4,@06),BASRECOV+1(@06)                   0953 03710000
         MVI   BASRECOV(@06),C' '                                  0953 03711000
*   /*****************************************************************/ 03712000
*   /*                                                               */ 03713000
*   /* REESTABLISH THE RPLV                                  @ZDR2054*/ 03714000
*   /*                                                               */ 03715000
*   /*****************************************************************/ 03716000
*                                                                  0954 03717000
*   BVOLKY=BASSERNO;                /* RESET VOLID           @ZDR2054*/ 03718000
         MVC   BVOLKY(6),BASSERNO(@06)                             0954 03719000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @ZDR2054*/ 03720000
         LA    @06,BKEY                                            0955 03721000
         L     @01,RPLVPTR                                         0955 03722000
         ST    @06,RPLVKEY(,@01)                                   0955 03723000
*   CALL READUPD1;                  /* READ BVR              @ZDR2054*/ 03724000
         BAL   @14,READUPD1                                        0956 03725000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @ZDR2054*/ 03726000
*     THEN                          /* YES                   @ZDR2054*/ 03727000
         L     @06,RPLVPTR                                         0957 03728000
         LH    @15,RPLVRETC(,@06)                                  0957 03729000
         N     @15,@CF01129                                        0957 03730000
         LTR   @15,@15                                             0957 03731000
         BNZ   @RT00957                                            0957 03732000
*     RETURN;                       /*                       @ZDR2054*/ 03733000
*                                                                  0958 03734000
*   /*****************************************************************/ 03735000
*   /*                                                               */ 03736000
*   /* WRITE THE BVR                                         @ZDR2054*/ 03737000
*   /*                                                               */ 03738000
*   /*****************************************************************/ 03739000
*                                                                  0959 03740000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @ZDR2054*/ 03741000
         LA    @15,BASEBUF                                         0959 03742000
         ST    @15,RPLVBUF(,@06)                                   0959 03743000
*   CALL WRITRECD;                  /* WRITE BVR             @ZDR2054*/ 03744000
         BAL   @14,WRITRECD                                        0960 03745000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @ZDR2054*/ 03746000
*     THEN                          /* YES                   @ZDR2054*/ 03747000
         L     @06,RPLVPTR                                         0961 03748000
         LH    @06,RPLVRETC(,@06)                                  0961 03749000
         N     @06,@CF01129                                        0961 03750000
         LTR   @06,@06                                             0961 03751000
         BNZ   @RT00961                                            0961 03752000
*     RETURN;                       /*                       @ZDR2054*/ 03753000
*                                                                  0962 03754000
*   /*****************************************************************/ 03755000
*   /*                                                               */ 03756000
*   /* UPDATE THE CIRS OF THE NEW BVR.                       @ZDR2054*/ 03757000
*   /* BCDVPTR IS SET IN ACTVOL2.                            @ZDR2054*/ 03758000
*   /*                                                               */ 03759000
*   /*****************************************************************/ 03760000
*                                                                  0963 03761000
*   CALL UPDCIR;                    /* SET NEW VOLID         @ZDR2054*/ 03762000
         BAL   @14,UPDCIR                                          0963 03763000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @ZDR2054*/ 03764000
*     THEN                          /* YES                   @ZDR2054*/ 03765000
         L     @06,RPLVPTR                                         0964 03766000
         LH    @06,RPLVRETC(,@06)                                  0964 03767000
         N     @06,@CF01129                                        0964 03768000
         LTR   @06,@06                                             0964 03769000
         BNZ   @RT00964                                            0964 03770000
*     RETURN;                       /*                       @ZDR2054*/ 03771000
*                                                                  0965 03772000
*   /*****************************************************************/ 03773000
*   /*                                                               */ 03774000
*   /* UPDATE THE NEW BVR TO REFLECT THE DELETION OF         @ZDR2054*/ 03775000
*   /* THE CVR                                               @ZDR2054*/ 03776000
*   /*                                                               */ 03777000
*   /*****************************************************************/ 03778000
*                                                                  0966 03779000
*   ADDSUB=OFF;                     /* CVR DELTED            @ZDR2054*/ 03780000
         NI    ADDSUB,B'10111111'                                  0966 03781000
*   CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*              @ZDR2054*/ 03782000
         L     @15,@CV00769                                        0967 03783000
         LA    @01,@AL00967                                        0967 03784000
         BALR  @14,@15                                             0967 03785000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @ZDR2054*/ 03786000
*     THEN                          /* YES                   @ZDR2054*/ 03787000
         L     @06,RPLVPTR                                         0968 03788000
         LH    @15,RPLVRETC(,@06)                                  0968 03789000
         N     @15,@CF01129                                        0968 03790000
         LTR   @15,@15                                             0968 03791000
         BNZ   @RT00968                                            0968 03792000
*     RETURN;                       /*                       @ZDR2054*/ 03793000
*                                                                  0969 03794000
*   /*****************************************************************/ 03795000
*   /*                                                               */ 03796000
*   /* READ THE BVR FOR UPDATE SO PROCESSING CAN             @ZDR2054*/ 03797000
*   /* CONTINUE IN ACTVOL2. BVOLKY IS STILL OK.              @ZDR2054*/ 03798000
*   /*                                                               */ 03799000
*   /*****************************************************************/ 03800000
*                                                                  0970 03801000
*   RPLVKEY=ADDR(BKEY);             /* BVR KEY ADDR          @ZDR2054*/ 03802000
         LA    @15,BKEY                                            0970 03803000
         ST    @15,RPLVKEY(,@06)                                   0970 03804000
*   CALL READUPD1;                  /* READ BVR              @ZDR2054*/ 03805000
         BAL   @14,READUPD1                                        0971 03806000
*   BASEBUF=BASEBUF1;               /* CORRECT BVR BUF       @ZDR2054*/ 03807000
         MVC   BASEBUF(224),BASEBUF1                               0972 03808000
*   RETURN;                         /*                       @ZDR2054*/ 03809000
@EL00020 DS    0H                                                  0973 03810000
@EF00020 DS    0H                                                  0973 03811000
@ER00020 L     @14,@SA00020                                        0973 03812000
         BR    @14                                                 0973 03813000
*   END CVRTOBVR;                   /*                       @ZDR2054*/ 03814000
         B     @EL00020                                            0974 03815000
*                                                                  0975 03816000
*   /*****************************************************************/ 03817000
*   /*                                                               */ 03818000
*   /* PROCEDURE NAME - PRODEFVE                             #Y30LB25*/ 03819000
*   /*                                                       @Y30LB25*/ 03820000
*   /* FUNCTION - PROCESS IEZDEFVE.                          @Y30LB25*/ 03821000
*   /*                                                       @Y30LB25*/ 03822000
*   /* INPUT -                                               @Y30LB25*/ 03823000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 03824000
*   /* BASE OR COPY VOLUME RECORD                            @Y30LB25*/ 03825000
*   /* POINTER TO COPY OR BASE VOLUME RECORD IN              @Y30LB25*/ 03826000
*   /* BCDVPTR                                               @Y30LB25*/ 03827000
*   /* POINTER TO BASE VOLUME RECORD IN BASEVPTR             @Y30LB25*/ 03828000
*   /*                                                       @Y30LB25*/ 03829000
*   /* OUTPUT -                                              @Y30LB25*/ 03830000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 03831000
*   /* AN ERROR                                              @Y30LB25*/ 03832000
*   /*                                                               */ 03833000
*   /*****************************************************************/ 03834000
*                                                                  0975 03835000
*PRODEFVE:                          /*                       @Y30LB25*/ 03836000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 03837000
*                                                                  0975 03838000
PRODEFVE ST    @14,@SA00021                                        0975 03839000
*   /*****************************************************************/ 03840000
*   /*                                                               */ 03841000
*   /* CHECK FOR COPY OR BASE VOLUME RECORD                  @Y30LB25*/ 03842000
*   /*                                                               */ 03843000
*   /*****************************************************************/ 03844000
*                                                                  0976 03845000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 03846000
*     THEN                          /* YES                   @Y30LB25*/ 03847000
         L     @06,BCDVPTR                                         0976 03848000
         TM    BCDCOPY(@06),B'00010000'                            0976 03849000
         BNO   @RF00976                                            0976 03850000
*     DO;                           /*                       @Y30LB25*/ 03851000
*       COPYVPTR=BCDVPTR;           /* SET CVR PTR           @Y30LB25*/ 03852000
         ST    @06,COPYVPTR                                        0978 03853000
*       CALL PCVRE;                 /* PROCESS DEFVE         @Y30LB25*/ 03854000
         BAL   @14,PCVRE                                           0979 03855000
*       RETURN;                     /*                       @Y30LB25*/ 03856000
@EL00021 DS    0H                                                  0980 03857000
@EF00021 DS    0H                                                  0980 03858000
@ER00021 L     @14,@SA00021                                        0980 03859000
         BR    @14                                                 0980 03860000
*     END;                          /*                       @Y30LB25*/ 03861000
*                                                                  0981 03862000
*   /*****************************************************************/ 03863000
*   /*                                                               */ 03864000
*   /* CHECK TO SEE IF GROUP WAS SPECIFIED                   @Y30LB25*/ 03865000
*   /*                                                               */ 03866000
*   /*****************************************************************/ 03867000
*                                                                  0982 03868000
*   IF DEFPGRO=ON THEN              /* GOING GROUPED         @Y30LB25*/ 03869000
@RF00976 TM    DEFPGRO(DEFVEPTR),B'00100000'                       0982 03870000
         BNO   @RF00982                                            0982 03871000
*     DO;                           /*                       @Y30LB25*/ 03872000
*                                                                  0983 03873000
*       /*************************************************************/ 03874000
*       /*                                                           */ 03875000
*       /* SEE IF RECORD WAS IN GROUP BEFORE                 @Y30LB25*/ 03876000
*       /*                                                           */ 03877000
*       /*************************************************************/ 03878000
*                                                                  0984 03879000
*       IF BASGRPV=ON THEN          /* VOLUME GROUPED        @Y30LB25*/ 03880000
*                                                                  0984 03881000
         L     @06,BASEVPTR                                        0984 03882000
         TM    BASGRPV(@06),B'00100000'                            0984 03883000
         BNO   @RF00984                                            0984 03884000
*         /***********************************************************/ 03885000
*         /*                                                         */ 03886000
*         /* GO REMOVE RECORD FROM GROUP CHAIN               @Y30LB25*/ 03887000
*         /*                                                         */ 03888000
*         /***********************************************************/ 03889000
*                                                                  0985 03890000
*         DO;                       /*                       @Y30LB25*/ 03891000
*           CALL GROUPOUT;          /* GET REC OUT OF GROUP  @Y30LB25*/ 03892000
         BAL   @14,GROUPOUT                                        0986 03893000
*           IF RPLVRETC¬=FIXZERO THEN/* CK RETURN CODE       @Y30LB25*/ 03894000
         L     @06,RPLVPTR                                         0987 03895000
         LH    @06,RPLVRETC(,@06)                                  0987 03896000
         N     @06,@CF01129                                        0987 03897000
         LTR   @06,@06                                             0987 03898000
         BNZ   @RT00987                                            0987 03899000
*             RETURN;               /*                       @Y30LB25*/ 03900000
*         END;                      /*                       @Y30LB25*/ 03901000
*       ELSE                        /*                       @Y30LB25*/ 03902000
*                                                                  0990 03903000
*         /***********************************************************/ 03904000
*         /*                                                         */ 03905000
*         /* GO TAKE RECORD OUT OF NON-GROUP                 @Y30LB25*/ 03906000
*         /*                                                         */ 03907000
*         /***********************************************************/ 03908000
*                                                                  0990 03909000
*         DO;                       /*                       @Y30LB25*/ 03910000
         B     @RC00984                                            0990 03911000
@RF00984 DS    0H                                                  0991 03912000
*           GRPFLG=OFF;             /* NON-GRP               @Y30LB25*/ 03913000
         NI    GRPFLG,B'11101111'                                  0991 03914000
*           CALL VUCHO;             /* GET REC OUT NON-GRP   @Y30LB25*/ 03915000
         BAL   @14,VUCHO                                           0992 03916000
*           IF RPLVRETC¬=FIXZERO THEN/* CK RETURN            @Y30LB25*/ 03917000
         L     @06,RPLVPTR                                         0993 03918000
         LH    @06,RPLVRETC(,@06)                                  0993 03919000
         N     @06,@CF01129                                        0993 03920000
         LTR   @06,@06                                             0993 03921000
         BNZ   @RT00993                                            0993 03922000
*             RETURN;               /*                       @Y30LB25*/ 03923000
*         END;                      /*                       @Y30LB25*/ 03924000
*                                                                  0995 03925000
*       /*************************************************************/ 03926000
*       /*                                                           */ 03927000
*       /* GO PUT RECORD INTO GROUP                          @Y30LB25*/ 03928000
*       /*                                                           */ 03929000
*       /*************************************************************/ 03930000
*                                                                  0996 03931000
*       CALL GROUPIN;               /* PUT RECORD INTO GRP   @Y30LB25*/ 03932000
@RC00984 BAL   @14,GROUPIN                                         0996 03933000
*       IF RPLVRETC¬=FIXZERO THEN   /* WAS IT SUCCESSFUL     @Y30LB25*/ 03934000
         L     @06,RPLVPTR                                         0997 03935000
         LH    @06,RPLVRETC(,@06)                                  0997 03936000
         N     @06,@CF01129                                        0997 03937000
         LTR   @06,@06                                             0997 03938000
         BNZ   @RT00997                                            0997 03939000
*         RETURN;                   /*                       @Y30LB25*/ 03940000
*                                                                  0998 03941000
*       /*************************************************************/ 03942000
*       /*                                                           */ 03943000
*       /* GO UPDATE THE COMMON FIELDS IN THE BASE REC       @Y30LB25*/ 03944000
*       /*                                                           */ 03945000
*       /*************************************************************/ 03946000
*                                                                  0999 03947000
*       CALL COMMON;                /* UPD COM FIELD IN BASE @Y30LB25*/ 03948000
         BAL   @14,COMMON                                          0999 03949000
*       RETURN;                     /*                       @Y30LB25*/ 03950000
         B     @EL00021                                            1000 03951000
*     END;                          /*                       @Y30LB25*/ 03952000
*                                                                  1001 03953000
*   /*****************************************************************/ 03954000
*   /*                                                               */ 03955000
*   /* CHECK FOR CHANGE TO NON-GROUPED                       @Y30LB25*/ 03956000
*   /*                                                               */ 03957000
*   /*****************************************************************/ 03958000
*                                                                  1002 03959000
*   IF DEFNGRP=ON&BASGRPV=ON THEN   /* GOING NON-GRP?        @Y30LB25*/ 03960000
@RF00982 TM    DEFNGRP(DEFVEPTR),B'10000000'                       1002 03961000
         BNO   @RF01002                                            1002 03962000
         L     @06,BASEVPTR                                        1002 03963000
         TM    BASGRPV(@06),B'00100000'                            1002 03964000
         BNO   @RF01002                                            1002 03965000
*     DO;                           /*                       @Y30LB25*/ 03966000
*                                                                  1003 03967000
*       /*************************************************************/ 03968000
*       /*                                                           */ 03969000
*       /* GO TAKE RECORD OUT OF GROUP THAT IT IS NOW IN     @Y30LB25*/ 03970000
*       /*                                                           */ 03971000
*       /*************************************************************/ 03972000
*                                                                  1004 03973000
*       CALL GROUPOUT;              /* GET IT OUT OF GRP     @Y30LB25*/ 03974000
         BAL   @14,GROUPOUT                                        1004 03975000
*       IF RPLVRETC¬=FIXZERO THEN   /* CK RETURN             @Y30LB25*/ 03976000
         L     @06,RPLVPTR                                         1005 03977000
         LH    @06,RPLVRETC(,@06)                                  1005 03978000
         N     @06,@CF01129                                        1005 03979000
         LTR   @06,@06                                             1005 03980000
         BNZ   @RT01005                                            1005 03981000
*         RETURN;                   /*                       @Y30LB25*/ 03982000
*                                                                  1006 03983000
*       /*************************************************************/ 03984000
*       /*                                                           */ 03985000
*       /* GO PUT RECORD IN NON-GROUP CATAGORY               @Y30LB25*/ 03986000
*       /*                                                           */ 03987000
*       /*************************************************************/ 03988000
*                                                                  1007 03989000
*       CALL NGROUPIN;              /* PUT IN NON-GRPED      @Y30LB25*/ 03990000
         BAL   @14,NGROUPIN                                        1007 03991000
*       IF RPLVRETC¬=FIXZERO THEN   /* CK RETURN CODE        @Y30LB25*/ 03992000
         L     @06,RPLVPTR                                         1008 03993000
         LH    @06,RPLVRETC(,@06)                                  1008 03994000
         N     @06,@CF01129                                        1008 03995000
         LTR   @06,@06                                             1008 03996000
         BNZ   @RT01008                                            1008 03997000
*         RETURN;                   /*                       @Y30LB25*/ 03998000
*                                                                  1009 03999000
*       /*************************************************************/ 04000000
*       /*                                                           */ 04001000
*       /* GO UPDATE COMMON FIELDS IN BASE REC               @Y30LB25*/ 04002000
*       /*                                                           */ 04003000
*       /*************************************************************/ 04004000
*                                                                  1010 04005000
*       CALL COMMON;                /* UPDATE COMMON FIELDS  @Y30LB25*/ 04006000
         BAL   @14,COMMON                                          1010 04007000
*       RETURN;                     /*                       @Y30LB25*/ 04008000
         B     @EL00021                                            1011 04009000
*     END;                          /*                       @Y30LB25*/ 04010000
*                                                                  1012 04011000
*   /*****************************************************************/ 04012000
*   /*                                                               */ 04013000
*   /* THIS A GROUPED VOLUME ?                               @Y30LB25*/ 04014000
*   /*                                                               */ 04015000
*   /*****************************************************************/ 04016000
*                                                                  1013 04017000
*   IF BASGRPV=ON THEN              /* THIS A GRPED VOL?     @Y30LB25*/ 04018000
@RF01002 L     @06,BASEVPTR                                        1013 04019000
         TM    BASGRPV(@06),B'00100000'                            1013 04020000
         BNO   @RF01013                                            1013 04021000
*     DO;                           /*                       @Y30LB25*/ 04022000
*                                                                  1014 04023000
*       /*************************************************************/ 04024000
*       /*                                                           */ 04025000
*       /* WANT TO CHANGE TO GENERAL USE ?                   @Y30LB25*/ 04026000
*       /*                                                           */ 04027000
*       /*************************************************************/ 04028000
*                                                                  1015 04029000
*       IF DEFGENUS=ON THEN         /* WANT GENERAL USE?     @Y30LB25*/ 04030000
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      1015 04031000
         BNO   @RF01015                                            1015 04032000
*         DO;                       /*                       @Y30LB25*/ 04033000
*                                                                  1016 04034000
*           /*********************************************************/ 04035000
*           /*                                                       */ 04036000
*           /* WAS IT RESTRICTED BEFORE ?                    @Y30LB25*/ 04037000
*           /*                                                       */ 04038000
*           /*********************************************************/ 04039000
*                                                                  1017 04040000
*           IF BASRSTD=ON THEN      /* WAS RESTRICTED?       @Y30LB25*/ 04041000
*                                                                  1017 04042000
         TM    BASRSTD(@06),B'00001000'                            1017 04043000
         BNO   @RF01017                                            1017 04044000
*             /*******************************************************/ 04045000
*             /*                                                     */ 04046000
*             /* SINCE RESTRICTED BEFORE AND GOING GENERAL   @Y30LB25*/ 04047000
*             /* GO MAKE INTO A GENERAL VOLUME IN THE        @Y30LB25*/ 04048000
*             /* SAME GROUP                                  @Y30LB25*/ 04049000
*             /*                                                     */ 04050000
*             /*******************************************************/ 04051000
*                                                                  1018 04052000
*             DO;                   /*                       @Y30LB25*/ 04053000
*               CALL GENERAL;       /* GO FROM RESTRCTED-GEN @Y30LB25*/ 04054000
         BAL   @14,GENERAL                                         1019 04055000
*               IF RPLRCODE¬=FIXZERO THEN/* RETURN CODE      @Y30LB25*/ 04056000
         L     @06,RPLVPTR                                         1020 04057000
         LH    @06,RPLRCODE(,@06)                                  1020 04058000
         N     @06,@CF01129                                        1020 04059000
         LTR   @06,@06                                             1020 04060000
         BNZ   @RT01020                                            1020 04061000
*                 RETURN;           /*                       @Y30LB25*/ 04062000
*                                                                  1021 04063000
*               /*****************************************************/ 04064000
*               /*                                                   */ 04065000
*               /* GO FILL IN ANY COMMON FIELDS IN BASE VOL  @Y30LB25*/ 04066000
*               /*                                                   */ 04067000
*               /*****************************************************/ 04068000
*                                                                  1022 04069000
*               CALL COMMON;        /* UPDATE COMMON FIELDS  @Y30LB25*/ 04070000
         BAL   @14,COMMON                                          1022 04071000
*               RETURN;             /*                       @Y30LB25*/ 04072000
         B     @EL00021                                            1023 04073000
*             END;                  /*                       @Y30LB25*/ 04074000
*         END;                      /*                       @Y30LB25*/ 04075000
*                                                                  1025 04076000
@RF01017 DS    0H                                                  1026 04077000
*       /*************************************************************/ 04078000
*       /*                                                           */ 04079000
*       /* IS A CHANGE TO RESTRICTED USE BEING CALLED FOR ?  @Y30LB25*/ 04080000
*       /*                                                           */ 04081000
*       /*************************************************************/ 04082000
*                                                                  1026 04083000
*       IF DEFRSTD=ON THEN          /* WANT RESTRICTED USE?  @Y30LB25*/ 04084000
@RF01015 TM    DEFRSTD(DEFVEPTR),B'01000000'                       1026 04085000
         BNO   @RF01026                                            1026 04086000
*         DO;                       /*                       @Y30LB25*/ 04087000
*                                                                  1027 04088000
*           /*********************************************************/ 04089000
*           /*                                                       */ 04090000
*           /* WAS IT A GENERAL USE VOL BEFORE ?             @Y30LB25*/ 04091000
*           /*                                                       */ 04092000
*           /*********************************************************/ 04093000
*                                                                  1028 04094000
*           IF BASGENUS=ON THEN     /* WAS GENERAL BEFORE?   @Y30LB25*/ 04095000
*                                                                  1028 04096000
         L     @06,BASEVPTR                                        1028 04097000
         TM    BASGENUS(@06),B'00010000'                           1028 04098000
         BNO   @RF01028                                            1028 04099000
*             /*******************************************************/ 04100000
*             /*                                                     */ 04101000
*             /* SINCE WAS GENERAL USE BEFORE AND IS GOING   @Y30LB25*/ 04102000
*             /* RESTRICTED, GO MAKE RESTRICTED IN THE SAME  @Y30LB25*/ 04103000
*             /* GROUP THAT IT WAS IN                        @Y30LB25*/ 04104000
*             /*                                                     */ 04105000
*             /*******************************************************/ 04106000
*                                                                  1029 04107000
*             DO;                   /*                       @Y30LB25*/ 04108000
*               CALL RESTRICT;      /* PROCESS AS RESTRCTED  @Y30LB25*/ 04109000
         BAL   @14,RESTRICT                                        1030 04110000
*               IF RPLVRETC¬=FIXZERO THEN/* CK RETURN CODE   @Y30LB25*/ 04111000
         L     @06,RPLVPTR                                         1031 04112000
         LH    @06,RPLVRETC(,@06)                                  1031 04113000
         N     @06,@CF01129                                        1031 04114000
         LTR   @06,@06                                             1031 04115000
         BNZ   @RT01031                                            1031 04116000
*                 RETURN;           /*                       @Y30LB25*/ 04117000
*                                                                  1032 04118000
*               /*****************************************************/ 04119000
*               /*                                                   */ 04120000
*               /* FILL IN COMMON FIELDS IN BASE REC         @Y30LB25*/ 04121000
*               /*                                                   */ 04122000
*               /*****************************************************/ 04123000
*                                                                  1033 04124000
*               CALL COMMON;        /* FIELD IN COM FIELDS   @Y30LB25*/ 04125000
         BAL   @14,COMMON                                          1033 04126000
*               RETURN;             /*                       @Y30LB25*/ 04127000
         B     @EL00021                                            1034 04128000
*             END;                  /*                       @Y30LB25*/ 04129000
*         END;                      /*                       @Y30LB25*/ 04130000
@RF01028 DS    0H                                                  1037 04131000
*     END;                          /*                       @Y30LB25*/ 04132000
*                                                                  1037 04133000
@RF01026 DS    0H                                                  1038 04134000
*   /*****************************************************************/ 04135000
*   /*                                                               */ 04136000
*   /* IF VOLUME DID NOT CHANGE GROUPS OR CLASIFICATION,     @Y30LB25*/ 04137000
*   /* CALL COMMON TO CHANGE ANY OTHER FIELDS SPECIFIED      @Y30LB25*/ 04138000
*   /*                                                               */ 04139000
*   /*****************************************************************/ 04140000
*                                                                  1038 04141000
*   CALL COMMON;                    /* UPDATE REMAINING      @Y30LB25*/ 04142000
@RF01013 BAL   @14,COMMON                                          1038 04143000
*   RETURN;                         /*                       @Y30LB25*/ 04144000
         B     @EL00021                                            1039 04145000
*   END PRODEFVE;                   /*                       @Y30LB25*/ 04146000
         B     @EL00021                                            1040 04147000
*                                                                  1041 04148000
*   /*****************************************************************/ 04149000
*   /*                                                               */ 04150000
*   /* PROCEDURE NAME - GROUPOUT                             @Y30LB25*/ 04151000
*   /*                                                       @Y30LB25*/ 04152000
*   /* FUNCTION -                                            @Y30LB25*/ 04153000
*   /* THIS ROUTINE TAKES A BASE VOLUME RECORD OUT OF        @Y30LB25*/ 04154000
*   /* THE GROUP IT IS IN AND GETS IT READY TO GO            @Y30LB25*/ 04155000
*   /* EITHER INTO ANOTHER GROUP OR BECOME NON-GROUPED.      @Y30LB25*/ 04156000
*   /*                                                       @Y30LB25*/ 04157000
*   /* INPUT -                                               @Y30LB25*/ 04158000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04159000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04160000
*   /*                                                       @Y30LB25*/ 04161000
*   /* OUTPUT -                                              @Y30LB25*/ 04162000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 04163000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04164000
*   /* AN ERROR                                              @Y30LB25*/ 04165000
*   /*                                                               */ 04166000
*   /*****************************************************************/ 04167000
*                                                                  1041 04168000
*GROUPOUT:                                                         1041 04169000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04170000
*                                                                  1041 04171000
GROUPOUT ST    @14,@SA00022                                        1041 04172000
*   /*****************************************************************/ 04173000
*   /*                                                               */ 04174000
*   /* READ THE OLD GROUP RECORD SO CAN GET VOL OUT OF IT    @Y30LB25*/ 04175000
*   /*                                                               */ 04176000
*   /*****************************************************************/ 04177000
*                                                                  1042 04178000
*   GROUPKY=BASGROUP;               /* GROUP NAME            @Y30LB25*/ 04179000
         L     @06,BASEVPTR                                        1042 04180000
         MVC   GROUPKY(8),BASGROUP(@06)                            1042 04181000
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @Y30LB25*/ 04182000
         LA    @06,GKEY                                            1043 04183000
         L     @01,RPLVPTR                                         1043 04184000
         ST    @06,RPLVKEY(,@01)                                   1043 04185000
*   CALL READUPD1;                  /* READ GROUP REC        @Y30LB25*/ 04186000
*                                                                  1044 04187000
         BAL   @14,READUPD1                                        1044 04188000
*   /*****************************************************************/ 04189000
*   /*                                                               */ 04190000
*   /* RETURN CODE FROM I/O PROCESSOR                        @Y30LB25*/ 04191000
*   /*                                                               */ 04192000
*   /*****************************************************************/ 04193000
*                                                                  1045 04194000
*   IF RPLVRETC¬=FIXZERO THEN       /* CK RETURN             @Y30LB25*/ 04195000
         L     @06,RPLVPTR                                         1045 04196000
         LH    @06,RPLVRETC(,@06)                                  1045 04197000
         N     @06,@CF01129                                        1045 04198000
         LTR   @06,@06                                             1045 04199000
         BNZ   @RT01045                                            1045 04200000
*     RETURN;                       /*                       @Y30LB25*/ 04201000
*                                                                  1046 04202000
*   /*****************************************************************/ 04203000
*   /*                                                               */ 04204000
*   /* GET ADDRESS OF RECORD JUST READ                       @Y30LB25*/ 04205000
*   /*                                                               */ 04206000
*   /*****************************************************************/ 04207000
*                                                                  1047 04208000
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 04209000
         MVC   GRPBUF1(224),BASEBUF1                               1047 04210000
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDRESSING TO BUFFER  @Y30LB25*/ 04211000
*                                                                  1048 04212000
         LA    @06,GRPBUF1                                         1048 04213000
         ST    @06,GROUPPTR                                        1048 04214000
*   /*****************************************************************/ 04215000
*   /*                                                               */ 04216000
*   /* IF GENERAL USE BEFORE, DECREASE COUNT BY ONE          @Y30LB25*/ 04217000
*   /*                                                               */ 04218000
*   /*****************************************************************/ 04219000
*                                                                  1049 04220000
*   IF BASGENUS=ON&BASINAC=OFF      /* GEN USE & ACT?        @Y30LB25*/ 04221000
*     THEN                          /* YES                   @Y30LB25*/ 04222000
         L     @01,BASEVPTR                                        1049 04223000
         TM    BASGENUS(@01),B'00010000'                           1049 04224000
         BNO   @RF01049                                            1049 04225000
         TM    BASINAC(@01),B'00000100'                            1049 04226000
         BNZ   @RF01049                                            1049 04227000
*     GRONGEN=GRONGEN-FIXONE;       /* DECREASE COUNT        @Y30LB25*/ 04228000
*                                                                  1050 04229000
         LH    @15,GRONGEN(,@06)                                   1050 04230000
         BCTR  @15,0                                               1050 04231000
         STH   @15,GRONGEN(,@06)                                   1050 04232000
*   /*****************************************************************/ 04233000
*   /*                                                               */ 04234000
*   /* RESTRICTED, DECREASE RESTRICTED COUNT                 @Y30LB25*/ 04235000
*   /*                                                               */ 04236000
*   /*****************************************************************/ 04237000
*                                                                  1051 04238000
*   IF BASRSTD=ON&BASINAC=OFF       /* RESTD & ACT?          @Y30LB25*/ 04239000
*     THEN                          /* YES                   @Y30LB25*/ 04240000
@RF01049 L     @06,BASEVPTR                                        1051 04241000
         TM    BASRSTD(@06),B'00001000'                            1051 04242000
         BNO   @RF01051                                            1051 04243000
         TM    BASINAC(@06),B'00000100'                            1051 04244000
         BNZ   @RF01051                                            1051 04245000
*     GRONRSTD=GRONRSTD-FIXONE;     /* DECR COUNT            @Y30LB25*/ 04246000
*                                                                  1052 04247000
         L     @06,GROUPPTR                                        1052 04248000
         LH    @15,GRONRSTD(,@06)                                  1052 04249000
         BCTR  @15,0                                               1052 04250000
         STH   @15,GRONRSTD(,@06)                                  1052 04251000
*   /*****************************************************************/ 04252000
*   /*                                                               */ 04253000
*   /* CHECK FOR INACTIVE                                    @Y30LB25*/ 04254000
*   /*                                                               */ 04255000
*   /*****************************************************************/ 04256000
*                                                                  1053 04257000
*   IF BASINAC=ON                   /* INACTIVE              @Y30LB25*/ 04258000
*     THEN                          /* YES                   @Y30LB25*/ 04259000
@RF01051 L     @06,BASEVPTR                                        1053 04260000
         TM    BASINAC(@06),B'00000100'                            1053 04261000
         BNO   @RF01053                                            1053 04262000
*     GRONINAC=GRONINAC-FIXONE;     /* DECREM COUNT          @Y30LB25*/ 04263000
*                                                                  1054 04264000
         L     @06,GROUPPTR                                        1054 04265000
         LH    @15,GRONINAC(,@06)                                  1054 04266000
         BCTR  @15,0                                               1054 04267000
         STH   @15,GRONINAC(,@06)                                  1054 04268000
*   /*****************************************************************/ 04269000
*   /*                                                               */ 04270000
*   /* IF BASE VOL IS A GENERAL USE TYPE, GO REMOVE ITS      @Y30LB25*/ 04271000
*   /* SLOT IN THE EXTENSION RECORD                          @Y30LB25*/ 04272000
*   /*                                                               */ 04273000
*   /*****************************************************************/ 04274000
*                                                                  1055 04275000
*   IF BASGENUS=ON&BASINAC=OFF THEN /* GEN USE & ACT?        @Y30LB25*/ 04276000
@RF01053 L     @06,BASEVPTR                                        1055 04277000
         TM    BASGENUS(@06),B'00010000'                           1055 04278000
         BNO   @RF01055                                            1055 04279000
         TM    BASINAC(@06),B'00000100'                            1055 04280000
         BNZ   @RF01055                                            1055 04281000
*     DO;                           /*                       @Y30LB25*/ 04282000
*                                                                  1056 04283000
*       /*************************************************************/ 04284000
*       /*                                                           */ 04285000
*       /* REMOVE THE SLOT                                   @Y30LB25*/ 04286000
*       /*                                                           */ 04287000
*       /*************************************************************/ 04288000
*                                                                  1057 04289000
*       ADDSUBSL=OFF;               /* DELETE SLOT           @Y30LB25*/ 04290000
         NI    ADDSUBSL,B'11111101'                                1057 04291000
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/ 04292000
         NI    EXPSLOT,B'01111111'                                 1058 04293000
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @Y30LB25*/ 04294000
         L     @15,@CV00767                                        1059 04295000
         LA    @01,@AL01059                                        1059 04296000
         BALR  @14,@15                                             1059 04297000
*       IF RPLVRETC¬=FIXZERO THEN   /* ERROR?                @Y30LB25*/ 04298000
         L     @06,RPLVPTR                                         1060 04299000
         LH    @06,RPLVRETC(,@06)                                  1060 04300000
         N     @06,@CF01129                                        1060 04301000
         LTR   @06,@06                                             1060 04302000
         BNZ   @RT01060                                            1060 04303000
*         RETURN;                   /*                       @Y30LB25*/ 04304000
*                                                                  1061 04305000
*       /*************************************************************/ 04306000
*       /*                                                           */ 04307000
*       /* UPDATE THE GVR                                    @Y30LB25*/ 04308000
*       /*                                                           */ 04309000
*       /*************************************************************/ 04310000
*                                                                  1062 04311000
*       ADDSUBGR=OFF;               /* SUBTRACT              @Y30LB25*/ 04312000
         NI    ADDSUBGR,B'11110111'                                1062 04313000
*       CALL VUPGH;                 /* UPDATE GVR            @Y30LB25*/ 04314000
         BAL   @14,VUPGH                                           1063 04315000
*     END;                          /*                       @Y30LB25*/ 04316000
*                                                                  1064 04317000
*   /*****************************************************************/ 04318000
*   /*                                                               */ 04319000
*   /* GO GET BASE RECORD OUT OF GROUP CHAIN                 @Y30LB25*/ 04320000
*   /*                                                               */ 04321000
*   /*****************************************************************/ 04322000
*                                                                  1065 04323000
*   GRPFLG=ON;                      /* INDICATE GROUPED      @Y30LB25*/ 04324000
@RF01055 OI    GRPFLG,B'00010000'                                  1065 04325000
*   CALL VUCHO;                     /*                       @Y30LB25*/ 04326000
         BAL   @14,VUCHO                                           1066 04327000
*   IF RPLVRETC¬=FIXZERO THEN       /*                       @Y30LB25*/ 04328000
         L     @06,RPLVPTR                                         1067 04329000
         LH    @06,RPLVRETC(,@06)                                  1067 04330000
         N     @06,@CF01129                                        1067 04331000
         LTR   @06,@06                                             1067 04332000
         BNZ   @RT01067                                            1067 04333000
*     RETURN;                       /*                       @Y30LB25*/ 04334000
*                                                                  1068 04335000
*   /*****************************************************************/ 04336000
*   /*                                                               */ 04337000
*   /* SET REQUIRED DEFAULTS FOR GROUPIN                     @ZA00687*/ 04338000
*   /* IF VOLUME IS NEITHER RESTRICTED OR GENERAL USE        @ZA00687*/ 04339000
*   /* DEFAULT IS GENERAL USE                                @ZA00687*/ 04340000
*   /* OTHERWISE SET REQUIRED DEFAULT TO VOLUME ATTRIBUTE    @ZA00687*/ 04341000
*   /*                                                               */ 04342000
*   /*****************************************************************/ 04343000
*                                                                  1069 04344000
*   IF DEFRSTD=OFF&DEFGENUS=OFF THEN                               1069 04345000
         TM    DEFRSTD(DEFVEPTR),B'11000000'                       1069 04346000
         BNZ   @RF01069                                            1069 04347000
*     DO;                           /*                       @ZA00687*/ 04348000
*       IF BASRSTD=OFF&BASGENUS=OFF THEN                           1071 04349000
         L     @06,BASEVPTR                                        1071 04350000
         TM    BASRSTD(@06),B'00011000'                            1071 04351000
         BNZ   @RF01071                                            1071 04352000
*         DEFGENUS=ON;              /*                       @ZA00687*/ 04353000
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1072 04354000
*       IF BASRSTD=OFF&BASGENUS=ON THEN                            1073 04355000
@RF01071 L     @06,BASEVPTR                                        1073 04356000
         TM    BASGENUS(@06),B'00010000'                           1073 04357000
         BNO   @RF01073                                            1073 04358000
         TM    BASRSTD(@06),B'00001000'                            1073 04359000
         BNZ   @RF01073                                            1073 04360000
*         DEFGENUS=ON;              /*                       @XA07821*/ 04361000
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1074 04362000
*       IF BASRSTD=ON&BASGENUS=OFF THEN                            1075 04363000
@RF01073 L     @06,BASEVPTR                                        1075 04364000
         TM    BASRSTD(@06),B'00001000'                            1075 04365000
         BNO   @RF01075                                            1075 04366000
         TM    BASGENUS(@06),B'00010000'                           1075 04367000
         BNZ   @RF01075                                            1075 04368000
*         DEFRSTD=ON;               /*                       @ZA00687*/ 04369000
         OI    DEFRSTD(DEFVEPTR),B'01000000'                       1076 04370000
*     END;                          /*                       @ZA00687*/ 04371000
*                                                                  1077 04372000
@RF01075 DS    0H                                                  1078 04373000
*   /*****************************************************************/ 04374000
*   /*                                                               */ 04375000
*   /* CLEAR OUT FIELDS IN THE BASE VOL RECORD THAT          #Y30LB25*/ 04376000
*   /* HAVE BAD INFORMATION IN THEM FROM PREV GROUP          @Y30LB25*/ 04377000
*   /*                                                               */ 04378000
*   /*****************************************************************/ 04379000
*                                                                  1078 04380000
*   BASGROUP=BLANK8;                /* NULL GRP NAME         @Y30LB25*/ 04381000
@RF01069 L     @06,BASEVPTR                                        1078 04382000
         MVI   BASGROUP+1(@06),C' '                                1078 04383000
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   1078 04384000
         MVI   BASGROUP(@06),C' '                                  1078 04385000
*   BASGRPV=OFF;                    /* NON-GRPED             @Y30LB25*/ 04386000
*   BASGENUS=OFF;                   /* NOT GENERAL           @Y30LB25*/ 04387000
*   BASRSTD=OFF;                    /* NOT RESTRICTED        @Y30LB25*/ 04388000
         NI    BASGRPV(@06),B'11000111'                            1081 04389000
*   BASEXPDT=FIX4FS;                /* CLEAR EXPIRATION      @Y30LB25*/ 04390000
*                                                                  1082 04391000
         MVC   BASEXPDT(4,@06),@CB00677                            1082 04392000
*   /*****************************************************************/ 04393000
*   /*                                                               */ 04394000
*   /* READ GROUP RECORD FOR UPDATE SO IT CAN BE WRITTEN     @Y30LB25*/ 04395000
*   /*                                                               */ 04396000
*   /*****************************************************************/ 04397000
*                                                                  1083 04398000
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @Y30LB25*/ 04399000
         LA    @06,GKEY                                            1083 04400000
         L     @01,RPLVPTR                                         1083 04401000
         ST    @06,RPLVKEY(,@01)                                   1083 04402000
*   CALL READUPD1;                  /* RD GRP REC FOR UPDATE @Y30LB25*/ 04403000
         BAL   @14,READUPD1                                        1084 04404000
*   IF RPLVRETC¬=FIXZERO THEN       /* CHECK RETURN CODE     @Y30LB25*/ 04405000
         L     @06,RPLVPTR                                         1085 04406000
         LH    @15,RPLVRETC(,@06)                                  1085 04407000
         N     @15,@CF01129                                        1085 04408000
         LTR   @15,@15                                             1085 04409000
         BNZ   @RT01085                                            1085 04410000
*     RETURN;                       /*                       @Y30LB25*/ 04411000
*                                                                  1086 04412000
*   /*****************************************************************/ 04413000
*   /*                                                               */ 04414000
*   /* WRITE GROUP RECORD                                    @Y30LB25*/ 04415000
*   /*                                                               */ 04416000
*   /*****************************************************************/ 04417000
*                                                                  1087 04418000
*   RPLVBUF=ADDR(GRPBUF1);          /* ADDR RECORD TO PUT    @Y30LB25*/ 04419000
         LA    @15,GRPBUF1                                         1087 04420000
         ST    @15,RPLVBUF(,@06)                                   1087 04421000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 04422000
         BAL   @14,WRITRECD                                        1088 04423000
*   RETURN;                         /*                       @Y30LB25*/ 04424000
@EL00022 DS    0H                                                  1089 04425000
@EF00022 DS    0H                                                  1089 04426000
@ER00022 L     @14,@SA00022                                        1089 04427000
         BR    @14                                                 1089 04428000
*   END GROUPOUT;                   /*                       @Y30LB25*/ 04429000
         B     @EL00022                                            1090 04430000
*                                                                  1091 04431000
*   /*****************************************************************/ 04432000
*   /*                                                               */ 04433000
*   /* PROCEDURE NAME - GROUPIN                              @Y30LB25*/ 04434000
*   /*                                                       @Y30LB25*/ 04435000
*   /* FUNCTION -                                            @Y30LB25*/ 04436000
*   /* THIS ROUTINE PUTS A BASE VOL REC INTO A GROUP.        @Y30LB25*/ 04437000
*   /*                                                       @Y30LB25*/ 04438000
*   /* INPUT -                                               @Y30LB25*/ 04439000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04440000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04441000
*   /*                                                       @Y30LB25*/ 04442000
*   /* OUTPUT -                                              @Y30LB25*/ 04443000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 04444000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04445000
*   /* AN ERROR                                              @Y30LB25*/ 04446000
*   /*                                                               */ 04447000
*   /*****************************************************************/ 04448000
*                                                                  1091 04449000
*GROUPIN:                                                          1091 04450000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04451000
*                                                                  1091 04452000
GROUPIN  ST    @14,@SA00023                                        1091 04453000
*   /*****************************************************************/ 04454000
*   /*                                                               */ 04455000
*   /* READ THE NEW GROUP RECORD                             @Y30LB25*/ 04456000
*   /*                                                               */ 04457000
*   /*****************************************************************/ 04458000
*                                                                  1092 04459000
*   GROUPKY=DEFGROUP;               /* GROUP NAME TO KEY     @Y30LB25*/ 04460000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1092 04461000
*   RPLVKEY=ADDR(GKEY);             /* ADDR IF KEY           @Y30LB25*/ 04462000
         LA    @06,GKEY                                            1093 04463000
         L     @01,RPLVPTR                                         1093 04464000
         ST    @06,RPLVKEY(,@01)                                   1093 04465000
*   CALL READUPD1;                  /* FREE                  @Y30LB25*/ 04466000
         BAL   @14,READUPD1                                        1094 04467000
*   IF RPLVRETC¬=FIXZERO THEN       /* CK RETURN CODE        @Y30LB25*/ 04468000
         L     @06,RPLVPTR                                         1095 04469000
         LH    @06,RPLVRETC(,@06)                                  1095 04470000
         N     @06,@CF01129                                        1095 04471000
         LTR   @06,@06                                             1095 04472000
         BNZ   @RT01095                                            1095 04473000
*     RETURN;                       /*                       @Y30LB25*/ 04474000
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 04475000
         MVC   GRPBUF1(224),BASEBUF1                               1097 04476000
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDR TO RECORD        @Y30LB25*/ 04477000
*                                                                  1098 04478000
         LA    @06,GRPBUF1                                         1098 04479000
         ST    @06,GROUPPTR                                        1098 04480000
*   /*****************************************************************/ 04481000
*   /*                                                               */ 04482000
*   /* IF GENERAL USE THEN ADD ONE TO GENERAL USE            @Y30LB25*/ 04483000
*   /* IN GROUP RECORD AND INDICATE GENERAL IN               @Y30LB25*/ 04484000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04485000
*   /*                                                               */ 04486000
*   /*****************************************************************/ 04487000
*                                                                  1099 04488000
*   IF DEFGENUS=ON&BASINAC=OFF      /* GEN-USE & ACT?        @Y30LB25*/ 04489000
*     THEN                          /* YES                   @Y30LB25*/ 04490000
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      1099 04491000
         BNO   @RF01099                                            1099 04492000
         L     @15,BASEVPTR                                        1099 04493000
         TM    BASINAC(@15),B'00000100'                            1099 04494000
         BNZ   @RF01099                                            1099 04495000
*     DO;                           /*                       @Y30LB25*/ 04496000
*       GRONGEN=GRONGEN+FIXONE;     /* ADD ON TO GENERAL     @Y30LB25*/ 04497000
         LA    @14,1                                               1101 04498000
         AH    @14,GRONGEN(,@06)                                   1101 04499000
         STH   @14,GRONGEN(,@06)                                   1101 04500000
*       BASGENUS=ON;                /* INDICATE GENERAL      @Y30LB25*/ 04501000
         OI    BASGENUS(@15),B'00010000'                           1102 04502000
*     END;                          /*                       @Y30LB25*/ 04503000
*                                                                  1103 04504000
*   /*****************************************************************/ 04505000
*   /*                                                               */ 04506000
*   /* IF RESTRICTED USE, ADD ONE TO COUNT IN GROUP          @Y30LB25*/ 04507000
*   /* RECORD AND INDICATE RESTRICTED IN BASE RECORD         @Y30LB25*/ 04508000
*   /*                                                               */ 04509000
*   /*****************************************************************/ 04510000
*                                                                  1104 04511000
*   IF DEFRSTD=ON&BASINAC=OFF       /* RESTD & ACT?          @Y30LB25*/ 04512000
*     THEN                          /* YES                   @Y30LB25*/ 04513000
@RF01099 TM    DEFRSTD(DEFVEPTR),B'01000000'                       1104 04514000
         BNO   @RF01104                                            1104 04515000
         L     @06,BASEVPTR                                        1104 04516000
         TM    BASINAC(@06),B'00000100'                            1104 04517000
         BNZ   @RF01104                                            1104 04518000
*     DO;                           /*                       @Y30LB25*/ 04519000
*       GRONRSTD=GRONRSTD+FIXONE;   /* ADD ONE RESTRICTED    @Y30LB25*/ 04520000
         L     @15,GROUPPTR                                        1106 04521000
         LA    @14,1                                               1106 04522000
         AH    @14,GRONRSTD(,@15)                                  1106 04523000
         STH   @14,GRONRSTD(,@15)                                  1106 04524000
*       BASRSTD=ON;                 /* INDICATE RESTRICTED   @Y30LB25*/ 04525000
         OI    BASRSTD(@06),B'00001000'                            1107 04526000
*     END;                          /*                       @Y30LB25*/ 04527000
*                                                                  1108 04528000
*   /*****************************************************************/ 04529000
*   /*                                                               */ 04530000
*   /* CHECK FOR INACTIVE VOLUME AND SET VOLUME TYPE         @Y30LB25*/ 04531000
*   /*                                                               */ 04532000
*   /*****************************************************************/ 04533000
*                                                                  1109 04534000
*   IF BASINAC=ON                   /* INACTIVE?             @Y30LB25*/ 04535000
*     THEN                          /* YES                   @Y30LB25*/ 04536000
@RF01104 L     @06,BASEVPTR                                        1109 04537000
         TM    BASINAC(@06),B'00000100'                            1109 04538000
         BNO   @RF01109                                            1109 04539000
*     DO;                           /*                       @Y30LB25*/ 04540000
*       GRONINAC=GRONINAC+FIXONE;   /* INCR # INACT VOLS     @Y30LB25*/ 04541000
*                                                                  1111 04542000
         L     @15,GROUPPTR                                        1111 04543000
         LA    @14,1                                               1111 04544000
         AH    @14,GRONINAC(,@15)                                  1111 04545000
         STH   @14,GRONINAC(,@15)                                  1111 04546000
*       /*************************************************************/ 04547000
*       /*                                                           */ 04548000
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/ 04549000
*       /*                                                           */ 04550000
*       /*************************************************************/ 04551000
*                                                                  1112 04552000
*       IF DEFGENUS=ON              /* GENERAL-USE?          @Y30LB25*/ 04553000
*         THEN                      /* YES                   @Y30LB25*/ 04554000
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      1112 04555000
         BNO   @RF01112                                            1112 04556000
*         DO;                       /*                       @Y30LB25*/ 04557000
*           BASGENUS=ON;            /* SET GEN-USE ON        @Y30LB25*/ 04558000
*           BASRSTD=OFF;            /* SET RESTRICT OFF      @Y30LB25*/ 04559000
         OI    BASGENUS(@06),B'00010000'                           1115 04560000
         NI    BASRSTD(@06),B'11110111'                            1115 04561000
*         END;                      /*                       @Y30LB25*/ 04562000
*                                                                  1116 04563000
*       /*************************************************************/ 04564000
*       /*                                                           */ 04565000
*       /* CHECK FOR RESTRICTED                              @Y30LB25*/ 04566000
*       /*                                                           */ 04567000
*       /*************************************************************/ 04568000
*                                                                  1117 04569000
*       IF DEFRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 04570000
*         THEN                      /* YES                   @Y30LB25*/ 04571000
@RF01112 TM    DEFRSTD(DEFVEPTR),B'01000000'                       1117 04572000
         BNO   @RF01117                                            1117 04573000
*         DO;                       /*                       @Y30LB25*/ 04574000
*           BASGENUS=OFF;           /* SET GEN-USE OFF       @Y30LB25*/ 04575000
*           BASRSTD=ON;             /* SET RESTRICT ON       @Y30LB25*/ 04576000
         L     @06,BASEVPTR                                        1120 04577000
         OI    BASRSTD(@06),B'00001000'                            1120 04578000
         NI    BASGENUS(@06),B'11101111'                           1120 04579000
*         END;                      /*                       @Y30LB25*/ 04580000
*     END;                          /*                       @Y30LB25*/ 04581000
*                                                                  1122 04582000
@RF01117 DS    0H                                                  1123 04583000
*   /*****************************************************************/ 04584000
*   /*                                                               */ 04585000
*   /* CHECK IF VOLUME IS GOING TO BE GENERAL USE            @Y30LB25*/ 04586000
*   /*                                                               */ 04587000
*   /*****************************************************************/ 04588000
*                                                                  1123 04589000
*   IF DEFGENUS=ON&BASINAC=OFF THEN /* GEN-USE & ACT?        @Y30LB25*/ 04590000
@RF01109 TM    DEFGENUS(DEFVEPTR),B'10000000'                      1123 04591000
         BNO   @RF01123                                            1123 04592000
         L     @06,BASEVPTR                                        1123 04593000
         TM    BASINAC(@06),B'00000100'                            1123 04594000
         BNZ   @RF01123                                            1123 04595000
*     DO;                           /*                       @Y30LB25*/ 04596000
*                                                                  1124 04597000
*       /*************************************************************/ 04598000
*       /*                                                           */ 04599000
*       /* SET FLAG INDICATING ADDING TO GROUP AND GO        @ZM31004*/ 04600000
*       /* PUT NEW SPACE VALUES IN GROUP RECORD              @ZM31004*/ 04601000
*       /*                                                           */ 04602000
*       /*************************************************************/ 04603000
*                                                                  1125 04604000
*       ADDSUBGR=ON;                /* INDIC ADDING TO GRP   @ZM31004*/ 04605000
         OI    ADDSUBGR,B'00001000'                                1125 04606000
*       CALL VUPGH;                 /*                       @ZM31004*/ 04607000
*                                                                  1126 04608000
         BAL   @14,VUPGH                                           1126 04609000
*       /*************************************************************/ 04610000
*       /*                                                           */ 04611000
*       /* CHECK RETURN FROM PROCESS GROUP HEADER            @ZM31004*/ 04612000
*       /*                                                           */ 04613000
*       /*************************************************************/ 04614000
*                                                                  1127 04615000
*       IF RPLVRETC¬=FIXZERO THEN   /* CK RETURN             @ZM31004*/ 04616000
         L     @06,RPLVPTR                                         1127 04617000
         LH    @06,RPLVRETC(,@06)                                  1127 04618000
         N     @06,@CF01129                                        1127 04619000
         LTR   @06,@06                                             1127 04620000
         BNZ   @RT01127                                            1127 04621000
*         RETURN;                   /*                       @ZM31004*/ 04622000
*                                                                  1128 04623000
*       /*************************************************************/ 04624000
*       /*                                                           */ 04625000
*       /* GO PUT A SLOT IN EXTENSION RECORD FOR THIS        @Y30LB25*/ 04626000
*       /* GROUPED GENERAL USE BASE VOLUME                   @Y30LB25*/ 04627000
*       /*                                                           */ 04628000
*       /*************************************************************/ 04629000
*                                                                  1129 04630000
*       ADDSUBSL=ON;                /* INDICATE ADDING SLOT  @Y30LB25*/ 04631000
         OI    ADDSUBSL,B'00000010'                                1129 04632000
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/ 04633000
         NI    EXPSLOT,B'01111111'                                 1130 04634000
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @ZM31004   04635000
*                                      ADD SLOT              @ZM31004*/ 04636000
         L     @15,@CV00767                                        1131 04637000
         LA    @01,@AL01131                                        1131 04638000
         BALR  @14,@15                                             1131 04639000
*       IF RPLVRETC¬=FIXZERO THEN   /*                       @Y30LB25*/ 04640000
         L     @06,RPLVPTR                                         1132 04641000
         LH    @06,RPLVRETC(,@06)                                  1132 04642000
         N     @06,@CF01129                                        1132 04643000
         LTR   @06,@06                                             1132 04644000
         BNZ   @RT01132                                            1132 04645000
*         RETURN;                   /*                       @Y30LB25*/ 04646000
*     END;                          /*                       @Y30LB25*/ 04647000
*                                                                  1134 04648000
*   /*****************************************************************/ 04649000
*   /*                                                               */ 04650000
*   /* INDICATE GROUPED AND PUT GROUP NAME IN VOLUME         @Y30LB25*/ 04651000
*   /*                                                               */ 04652000
*   /*****************************************************************/ 04653000
*                                                                  1135 04654000
*   BASGRPV=ON;                     /* INDICATE GROUPED      @Y30LB25*/ 04655000
@RF01123 L     @06,BASEVPTR                                        1135 04656000
         OI    BASGRPV(@06),B'00100000'                            1135 04657000
*   BASGROUP=DEFGROUP;              /* GROUP NAME IN BASE    @Y30LB25*/ 04658000
*                                                                  1136 04659000
         MVC   BASGROUP(8,@06),DEFGROUP(DEFVEPTR)                  1136 04660000
*   /*****************************************************************/ 04661000
*   /*                                                               */ 04662000
*   /* CALL CHAIN IN ROUTINE TO CHAIN BASE RECORD INTO GROUP @Y30LB25*/ 04663000
*   /*                                                               */ 04664000
*   /*****************************************************************/ 04665000
*                                                                  1137 04666000
*   GRPFLG=ON;                      /* INDICATE GROUPED      @Y30LB25*/ 04667000
         OI    GRPFLG,B'00010000'                                  1137 04668000
*   CALL VUCHI;                     /*                       @Y30LB25*/ 04669000
         BAL   @14,VUCHI                                           1138 04670000
*   IF RPLVRETC¬=FIXZERO THEN       /* ERROR?                @Y30LB25*/ 04671000
         L     @06,RPLVPTR                                         1139 04672000
         LH    @15,RPLVRETC(,@06)                                  1139 04673000
         N     @15,@CF01129                                        1139 04674000
         LTR   @15,@15                                             1139 04675000
         BNZ   @RT01139                                            1139 04676000
*     RETURN;                       /*                       @Y30LB25*/ 04677000
*                                                                  1140 04678000
*   /*****************************************************************/ 04679000
*   /*                                                               */ 04680000
*   /* READ GROUP RECORD FOR UPDATE SO IT CAN BE WRITTEN     @Y30LB25*/ 04681000
*   /*                                                               */ 04682000
*   /*****************************************************************/ 04683000
*                                                                  1141 04684000
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY              @Y30LB25*/ 04685000
         LA    @15,GKEY                                            1141 04686000
         ST    @15,RPLVKEY(,@06)                                   1141 04687000
*   CALL READUPD1;                  /* READ GROUP UPDATE     @Y30LB25*/ 04688000
*                                                                  1142 04689000
         BAL   @14,READUPD1                                        1142 04690000
*   /*****************************************************************/ 04691000
*   /*                                                               */ 04692000
*   /* CHECK RETURN FROM DUMMY READ                          @Y30LB25*/ 04693000
*   /*                                                               */ 04694000
*   /*****************************************************************/ 04695000
*                                                                  1143 04696000
*   IF RPLVRETC¬=FIXZERO THEN       /* CK RETURN CODE        @Y30LB25*/ 04697000
         L     @06,RPLVPTR                                         1143 04698000
         LH    @15,RPLVRETC(,@06)                                  1143 04699000
         N     @15,@CF01129                                        1143 04700000
         LTR   @15,@15                                             1143 04701000
         BNZ   @RT01143                                            1143 04702000
*     RETURN;                       /*                       @Y30LB25*/ 04703000
*                                                                  1144 04704000
*   /*****************************************************************/ 04705000
*   /*                                                               */ 04706000
*   /* WRITE GROUP RECORD THAT IS ALL FIXED UP NOW           @Y30LB25*/ 04707000
*   /*                                                               */ 04708000
*   /*****************************************************************/ 04709000
*                                                                  1145 04710000
*   RPLVBUF=ADDR(GRPBUF1);          /* ADDR READ GROUP REC   @Y30LB25*/ 04711000
         LA    @15,GRPBUF1                                         1145 04712000
         ST    @15,RPLVBUF(,@06)                                   1145 04713000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 04714000
         BAL   @14,WRITRECD                                        1146 04715000
*   RETURN;                         /*                       @Y30LB25*/ 04716000
@EL00023 DS    0H                                                  1147 04717000
@EF00023 DS    0H                                                  1147 04718000
@ER00023 L     @14,@SA00023                                        1147 04719000
         BR    @14                                                 1147 04720000
*   END GROUPIN;                    /*                       @Y30LB25*/ 04721000
         B     @EL00023                                            1148 04722000
*                                                                  1149 04723000
*   /*****************************************************************/ 04724000
*   /*                                                               */ 04725000
*   /* PROCEDURE NAME - NGROUPIN                             @Y30LB25*/ 04726000
*   /*                                                       @Y30LB25*/ 04727000
*   /* FUNCTION -                                            @Y30LB25*/ 04728000
*   /* THIS ROUTINE PUTS A BASE VOLUME RECORD INTO           @Y30LB25*/ 04729000
*   /* THE NON-GROUPED CHAIN.                                @Y30LB25*/ 04730000
*   /*                                                       @Y30LB25*/ 04731000
*   /* INPUT -                                               @Y30LB25*/ 04732000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04733000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04734000
*   /*                                                       @Y30LB25*/ 04735000
*   /* OUTPUT -                                              @Y30LB25*/ 04736000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 04737000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04738000
*   /* AN ERROR                                              @Y30LB25*/ 04739000
*   /*                                                               */ 04740000
*   /*****************************************************************/ 04741000
*                                                                  1149 04742000
*NGROUPIN:                                                         1149 04743000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04744000
NGROUPIN ST    @14,@SA00024                                        1149 04745000
*   GRPFLG=OFF;                     /* INDICATE NON-GRPED    @Y30LB25*/ 04746000
*                                                                  1150 04747000
         NI    GRPFLG,B'11101111'                                  1150 04748000
*   /*****************************************************************/ 04749000
*   /*                                                               */ 04750000
*   /* GO CHAIN VOLUME INTO NON-GROUPED                      @Y30LB25*/ 04751000
*   /* AND CHECK RETURN CODE                                 @Y30LB25*/ 04752000
*   /*                                                               */ 04753000
*   /*****************************************************************/ 04754000
*                                                                  1151 04755000
*   CALL VUCHI;                     /*                       @Y30LB25*/ 04756000
         BAL   @14,VUCHI                                           1151 04757000
*   IF RPLVRETC¬=FIXZERO THEN       /*                       @Y30LB25*/ 04758000
         L     @06,RPLVPTR                                         1152 04759000
         LH    @06,RPLVRETC(,@06)                                  1152 04760000
         N     @06,@CF01129                                        1152 04761000
         LTR   @06,@06                                             1152 04762000
         BNZ   @RT01152                                            1152 04763000
*     RETURN;                       /*                       @Y30LB25*/ 04764000
*                                                                  1153 04765000
*   /*****************************************************************/ 04766000
*   /*                                                               */ 04767000
*   /* UPDATE FIELDS IN THE BASE VOLUME RECORD THAT          @Y30LB25*/ 04768000
*   /* NEED TO BE UPDATED WHEN GOING NON-GROUPED CATAGORY    @Y30LB25*/ 04769000
*   /*                                                               */ 04770000
*   /*****************************************************************/ 04771000
*                                                                  1154 04772000
*   BASGRPV=OFF;                    /* CLEAR GROUP FLAG      @Y30LB25*/ 04773000
*   BASGENUS=OFF;                   /* CLEAR GENERAL USED    @Y30LB25*/ 04774000
*   BASRSTD=OFF;                    /* CLEAR RESTRICTED      @Y30LB25*/ 04775000
         L     @06,BASEVPTR                                        1156 04776000
         NI    BASGRPV(@06),B'11000111'                            1156 04777000
*   BASEXPDT=FIX4FS;                /* CLEAR EXPIRATION      @Y30LB25*/ 04778000
         MVC   BASEXPDT(4,@06),@CB00677                            1157 04779000
*   BASGROUP=BLANK8;                /* BLANK GROUP NAME      @Y30LB25*/ 04780000
         MVI   BASGROUP+1(@06),C' '                                1158 04781000
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   1158 04782000
         MVI   BASGROUP(@06),C' '                                  1158 04783000
*   RETURN;                         /*                       @Y30LB25*/ 04784000
@EL00024 DS    0H                                                  1159 04785000
@EF00024 DS    0H                                                  1159 04786000
@ER00024 L     @14,@SA00024                                        1159 04787000
         BR    @14                                                 1159 04788000
*   END NGROUPIN;                   /*                       @Y30LB25*/ 04789000
         B     @EL00024                                            1160 04790000
*                                                                  1161 04791000
*   /*****************************************************************/ 04792000
*   /*                                                               */ 04793000
*   /* PROCEDURE NAME - RESTRICT                             @Y30LB25*/ 04794000
*   /*                                                       @Y30LB25*/ 04795000
*   /* FUNCTION -                                            @Y30LB25*/ 04796000
*   /* THIS ROUTINE IS CALLED WHEN A GROUPED VOLUME IS       @Y30LB25*/ 04797000
*   /* CURRENTLY GENERAL USE, BUT IS GOING RESTRICTED        @Y30LB25*/ 04798000
*   /* IN THE SAME GROUP.                                    @Y30LB25*/ 04799000
*   /*                                                       @Y30LB25*/ 04800000
*   /* INPUT -                                               @Y30LB25*/ 04801000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04802000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04803000
*   /*                                                       @Y30LB25*/ 04804000
*   /* OUTPUT -                                              @Y30LB25*/ 04805000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 04806000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04807000
*   /* AN ERROR                                              @Y30LB25*/ 04808000
*   /*                                                               */ 04809000
*   /*****************************************************************/ 04810000
*                                                                  1161 04811000
*RESTRICT:                                                         1161 04812000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04813000
*                                                                  1161 04814000
RESTRICT ST    @14,@SA00025                                        1161 04815000
*   /*****************************************************************/ 04816000
*   /*                                                               */ 04817000
*   /* GET GROUP NAME AND SET UP TO READ GROUP RECORD        @Y30LB25*/ 04818000
*   /*                                                               */ 04819000
*   /*****************************************************************/ 04820000
*                                                                  1162 04821000
*   GROUPKY=BASGROUP;               /* GROUP NAME            @Y30LB25*/ 04822000
         L     @06,BASEVPTR                                        1162 04823000
         MVC   GROUPKY(8),BASGROUP(@06)                            1162 04824000
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY              @Y30LB25*/ 04825000
         LA    @06,GKEY                                            1163 04826000
         L     @01,RPLVPTR                                         1163 04827000
         ST    @06,RPLVKEY(,@01)                                   1163 04828000
*   CALL READUPD1;                  /* READ GROUP RECORD     @Y30LB25*/ 04829000
         BAL   @14,READUPD1                                        1164 04830000
*   IF RPLVRETC¬=FIXZERO THEN       /* CHECK RETURN?         @Y30LB25*/ 04831000
         L     @06,RPLVPTR                                         1165 04832000
         LH    @06,RPLVRETC(,@06)                                  1165 04833000
         N     @06,@CF01129                                        1165 04834000
         LTR   @06,@06                                             1165 04835000
         BNZ   @RT01165                                            1165 04836000
*     RETURN;                       /*                       @Y30LB25*/ 04837000
*                                                                  1166 04838000
*   /*****************************************************************/ 04839000
*   /*                                                               */ 04840000
*   /* UPDATE FIELDS IN THE GROUP RECORD THAT CHANGE         @Y30LB25*/ 04841000
*   /* WHEN ONE OF ITS VOLUMES GOES FROM GENERAL TO          @Y30LB25*/ 04842000
*   /* RESTRICTED                                            @Y30LB25*/ 04843000
*   /*                                                               */ 04844000
*   /*****************************************************************/ 04845000
*                                                                  1167 04846000
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 04847000
         MVC   GRPBUF1(224),BASEBUF1                               1167 04848000
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDR TO GROUP REC     @Y30LB25*/ 04849000
*                                                                  1168 04850000
         LA    @06,GRPBUF1                                         1168 04851000
         ST    @06,GROUPPTR                                        1168 04852000
*   /*****************************************************************/ 04853000
*   /*                                                               */ 04854000
*   /* CHECK FOR ACTIVE VOLUME                               @Y30LB25*/ 04855000
*   /*                                                               */ 04856000
*   /*****************************************************************/ 04857000
*                                                                  1169 04858000
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/ 04859000
*     THEN                          /* YES                   @Y30LB25*/ 04860000
         L     @01,BASEVPTR                                        1169 04861000
         TM    BASINAC(@01),B'00000100'                            1169 04862000
         BNZ   @RF01169                                            1169 04863000
*     DO;                           /*                       @Y30LB25*/ 04864000
*       GRONGEN=GRONGEN-FIXONE;     /* 1 LESS GENERAL USE    @Y30LB25*/ 04865000
         LH    @15,GRONGEN(,@06)                                   1171 04866000
         BCTR  @15,0                                               1171 04867000
         STH   @15,GRONGEN(,@06)                                   1171 04868000
*       GRONRSTD=GRONRSTD+FIXONE;   /* ONE MORE RESTRICTED   @Y30LB25*/ 04869000
         LA    @15,1                                               1172 04870000
         AH    @15,GRONRSTD(,@06)                                  1172 04871000
         STH   @15,GRONRSTD(,@06)                                  1172 04872000
*       ADDSUBGR=OFF;               /* INDICATE TAKING OUT   @Y30LB25*/ 04873000
*                                                                  1173 04874000
         NI    ADDSUBGR,B'11110111'                                1173 04875000
*       /*************************************************************/ 04876000
*       /*                                                           */ 04877000
*       /* GO TAKE SOME SPACE OUT OF GROUPS GENERAL VOLUME   @Y30LB25*/ 04878000
*       /* TOTALS SINCE IT IS GOING RESTRICTED               @Y30LB25*/ 04879000
*       /*                                                           */ 04880000
*       /*************************************************************/ 04881000
*                                                                  1174 04882000
*       CALL VUPGH;                 /*                       @Y30LB25*/ 04883000
         BAL   @14,VUPGH                                           1174 04884000
*       IF RPLVRETC¬=FIXZERO THEN   /* CHECK RETURN          @Y30LB25*/ 04885000
         L     @06,RPLVPTR                                         1175 04886000
         LH    @06,RPLVRETC(,@06)                                  1175 04887000
         N     @06,@CF01129                                        1175 04888000
         LTR   @06,@06                                             1175 04889000
         BNZ   @RT01175                                            1175 04890000
*         RETURN;                   /*                       @Y30LB25*/ 04891000
*     END;                          /*                       @Y30LB25*/ 04892000
*                                                                  1177 04893000
*   /*****************************************************************/ 04894000
*   /*                                                               */ 04895000
*   /* UPDATE FIELDS IN THE BASE VOLUME RECORD THAT          @Y30LB25*/ 04896000
*   /* CHANGE WHEN GOING FRON GENERAL TO RESTRICTED          @Y30LB25*/ 04897000
*   /*                                                               */ 04898000
*   /*****************************************************************/ 04899000
*                                                                  1178 04900000
*   BASGENUS=OFF;                   /* NOT GENERAL USE       @Y30LB25*/ 04901000
@RF01169 DS    0H                                                  1179 04902000
*   BASRSTD=ON;                     /* RESTRICTED USE        @Y30LB25*/ 04903000
         L     @06,BASEVPTR                                        1179 04904000
         OI    BASRSTD(@06),B'00001000'                            1179 04905000
         NI    BASGENUS(@06),B'11101111'                           1179 04906000
*   BASEXPDT=FIX4FS;                /* CLEAR EXPIRATION      @Y30LB25*/ 04907000
*                                                                  1180 04908000
         MVC   BASEXPDT(4,@06),@CB00677                            1180 04909000
*   /*****************************************************************/ 04910000
*   /*                                                               */ 04911000
*   /* WRITE THE GROUP RECORD JUST PREVIOUSLY READ           @Y30LB25*/ 04912000
*   /*                                                               */ 04913000
*   /*****************************************************************/ 04914000
*                                                                  1181 04915000
*   RPLVBUF=ADDR(GRPBUF1);          /* BUFFER ADDR           @Y30LB25*/ 04916000
         LA    @06,GRPBUF1                                         1181 04917000
         L     @01,RPLVPTR                                         1181 04918000
         ST    @06,RPLVBUF(,@01)                                   1181 04919000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 04920000
         BAL   @14,WRITRECD                                        1182 04921000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 04922000
*     THEN                          /* YES                   @Y30LB25*/ 04923000
         L     @06,RPLVPTR                                         1183 04924000
         LH    @06,RPLVRETC(,@06)                                  1183 04925000
         N     @06,@CF01129                                        1183 04926000
         LTR   @06,@06                                             1183 04927000
         BNZ   @RT01183                                            1183 04928000
*     RETURN;                       /*                       @Y30LB25*/ 04929000
*                                                                  1184 04930000
*   /*****************************************************************/ 04931000
*   /*                                                               */ 04932000
*   /* REMOVE THE SLOT, IF ACTIVE VOLUME                     @Y30LB25*/ 04933000
*   /*                                                               */ 04934000
*   /*****************************************************************/ 04935000
*                                                                  1185 04936000
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/ 04937000
*     THEN                          /* YES                   @Y30LB25*/ 04938000
         L     @06,BASEVPTR                                        1185 04939000
         TM    BASINAC(@06),B'00000100'                            1185 04940000
         BNZ   @RF01185                                            1185 04941000
*     DO;                           /*                       @Y30LB25*/ 04942000
*       ADDSUBSL=OFF;               /* DELETE                @Y30LB25*/ 04943000
         NI    ADDSUBSL,B'11111101'                                1187 04944000
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/ 04945000
         NI    EXPSLOT,B'01111111'                                 1188 04946000
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @Y30LB25*/ 04947000
         L     @15,@CV00767                                        1189 04948000
         LA    @01,@AL01189                                        1189 04949000
         BALR  @14,@15                                             1189 04950000
*     END;                          /*                       @Y30LB25*/ 04951000
*   RETURN;                         /*                       @Y30LB25*/ 04952000
@EL00025 DS    0H                                                  1191 04953000
@EF00025 DS    0H                                                  1191 04954000
@ER00025 L     @14,@SA00025                                        1191 04955000
         BR    @14                                                 1191 04956000
*   END RESTRICT;                   /*                       @Y30LB25*/ 04957000
         B     @EL00025                                            1192 04958000
*                                                                  1193 04959000
*   /*****************************************************************/ 04960000
*   /*                                                               */ 04961000
*   /* PROCEDURE NAME - GENERAL                              @Y30LB25*/ 04962000
*   /*                                                       @Y30LB25*/ 04963000
*   /* FUNCTION -                                            @Y30LB25*/ 04964000
*   /* THIS ROUTINE IS CALLED WHEN A BASE VOLUME RECORD      @Y30LB25*/ 04965000
*   /* IS GOING FROM RESTRICTED TO GENERAL USE IN THE        @Y30LB25*/ 04966000
*   /* SAME GROUP.                                           @Y30LB25*/ 04967000
*   /*                                                       @Y30LB25*/ 04968000
*   /* INPUT -                                               @Y30LB25*/ 04969000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04970000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04971000
*   /*                                                       @Y30LB25*/ 04972000
*   /* OUTPUT -                                              @Y30LB25*/ 04973000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 04974000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04975000
*   /* AN ERROR                                              @Y30LB25*/ 04976000
*   /*                                                               */ 04977000
*   /*****************************************************************/ 04978000
*                                                                  1193 04979000
*GENERAL:                                                          1193 04980000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04981000
*                                                                  1193 04982000
GENERAL  ST    @14,@SA00026                                        1193 04983000
*   /*****************************************************************/ 04984000
*   /*                                                               */ 04985000
*   /* GET GROUP NAME FROM BASE RECORD AND SET UP TO         @Y30LB25*/ 04986000
*   /* READ THE GROUP RECORD                                 @Y30LB25*/ 04987000
*   /*                                                               */ 04988000
*   /*****************************************************************/ 04989000
*                                                                  1194 04990000
*   GROUPKY=BASGROUP;               /* GET NEW GROUP NAME    @Y30LB25*/ 04991000
         L     @06,BASEVPTR                                        1194 04992000
         MVC   GROUPKY(8),BASGROUP(@06)                            1194 04993000
*   RPLVKEY=ADDR(GKEY);             /* ADDR GROUP KEY        @Y30LB25*/ 04994000
         LA    @06,GKEY                                            1195 04995000
         L     @01,RPLVPTR                                         1195 04996000
         ST    @06,RPLVKEY(,@01)                                   1195 04997000
*   CALL READUPD1;                  /* READ GROUP RECORD     @Y30LB25*/ 04998000
         BAL   @14,READUPD1                                        1196 04999000
*   IF RPLVRETC¬=FIXZERO THEN       /* CHECK RETURN?         @Y30LB25*/ 05000000
         L     @06,RPLVPTR                                         1197 05001000
         LH    @06,RPLVRETC(,@06)                                  1197 05002000
         N     @06,@CF01129                                        1197 05003000
         LTR   @06,@06                                             1197 05004000
         BNZ   @RT01197                                            1197 05005000
*     RETURN;                       /*                       @Y30LB25*/ 05006000
*                                                                  1198 05007000
*   /*****************************************************************/ 05008000
*   /*                                                               */ 05009000
*   /* GET ADDRESS OF GROUP RECORD, UPDATE REQUIRED FIELDS   @Y30LB25*/ 05010000
*   /*                                                               */ 05011000
*   /*****************************************************************/ 05012000
*                                                                  1199 05013000
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 05014000
         MVC   GRPBUF1(224),BASEBUF1                               1199 05015000
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDRESSING TO GRP REC @Y30LB25*/ 05016000
*                                                                  1200 05017000
         LA    @06,GRPBUF1                                         1200 05018000
         ST    @06,GROUPPTR                                        1200 05019000
*   /*****************************************************************/ 05020000
*   /*                                                               */ 05021000
*   /* CHECK FOR ACTIVE VOLUME                               @Y30LB25*/ 05022000
*   /*                                                               */ 05023000
*   /*****************************************************************/ 05024000
*                                                                  1201 05025000
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/ 05026000
*     THEN                          /* YES                   @Y30LB25*/ 05027000
         L     @01,BASEVPTR                                        1201 05028000
         TM    BASINAC(@01),B'00000100'                            1201 05029000
         BNZ   @RF01201                                            1201 05030000
*     DO;                           /*                       @Y30LB25*/ 05031000
*       GRONGEN=GRONGEN+FIXONE;     /* ONE MORE GENERAL USE  @Y30LB25*/ 05032000
         LA    @15,1                                               1203 05033000
         AH    @15,GRONGEN(,@06)                                   1203 05034000
         STH   @15,GRONGEN(,@06)                                   1203 05035000
*       GRONRSTD=GRONRSTD-FIXONE;   /* ONE LESS RESTRICTED   @Y30LB25*/ 05036000
*                                                                  1204 05037000
         LH    @15,GRONRSTD(,@06)                                  1204 05038000
         BCTR  @15,0                                               1204 05039000
         STH   @15,GRONRSTD(,@06)                                  1204 05040000
*       /*************************************************************/ 05041000
*       /*                                                           */ 05042000
*       /* GO ADD SOME SPACE TO THE GROUP FIELDS SINCE IT IS @Y30LB25*/ 05043000
*       /* GETTING A GENERAL TYPE VOLUME                     @Y30LB25*/ 05044000
*       /*                                                           */ 05045000
*       /*************************************************************/ 05046000
*                                                                  1205 05047000
*       ADDSUBGR=ON;                /* INDICATE ADDING GEN   @Y30LB25*/ 05048000
         OI    ADDSUBGR,B'00001000'                                1205 05049000
*       CALL VUPGH;                 /*                       @Y30LB25*/ 05050000
         BAL   @14,VUPGH                                           1206 05051000
*       IF RPLVRETC¬=FIXZERO THEN   /* CHECK RETURN          @Y30LB25*/ 05052000
         L     @06,RPLVPTR                                         1207 05053000
         LH    @06,RPLVRETC(,@06)                                  1207 05054000
         N     @06,@CF01129                                        1207 05055000
         LTR   @06,@06                                             1207 05056000
         BNZ   @RT01207                                            1207 05057000
*         RETURN;                   /*                       @Y30LB25*/ 05058000
*     END;                          /*                       @Y30LB25*/ 05059000
*                                                                  1209 05060000
*   /*****************************************************************/ 05061000
*   /*                                                               */ 05062000
*   /* CHANGE INDICATORS IN BASE VOLUME TO GENERAL-USE       @Y30LB25*/ 05063000
*   /*                                                               */ 05064000
*   /*****************************************************************/ 05065000
*                                                                  1210 05066000
*   BASGENUS=ON;                    /* GENERAL USE           @Y30LB25*/ 05067000
@RF01201 DS    0H                                                  1211 05068000
*   BASRSTD=OFF;                    /* NOT RESTRICTED USE    @Y30LB25*/ 05069000
*                                                                  1211 05070000
         L     @06,BASEVPTR                                        1211 05071000
         OI    BASGENUS(@06),B'00010000'                           1211 05072000
         NI    BASRSTD(@06),B'11110111'                            1211 05073000
*   /*****************************************************************/ 05074000
*   /*                                                               */ 05075000
*   /* WRITE GROUP RECORD                                    @Y30LB25*/ 05076000
*   /*                                                               */ 05077000
*   /*****************************************************************/ 05078000
*                                                                  1212 05079000
*   RPLVBUF=ADDR(GRPBUF1);          /* BUFFER ADDR           @Y30LB25*/ 05080000
         LA    @06,GRPBUF1                                         1212 05081000
         L     @01,RPLVPTR                                         1212 05082000
         ST    @06,RPLVBUF(,@01)                                   1212 05083000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 05084000
         BAL   @14,WRITRECD                                        1213 05085000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 05086000
*     THEN                          /* YES                   @Y30LB25*/ 05087000
         L     @06,RPLVPTR                                         1214 05088000
         LH    @06,RPLVRETC(,@06)                                  1214 05089000
         N     @06,@CF01129                                        1214 05090000
         LTR   @06,@06                                             1214 05091000
         BNZ   @RT01214                                            1214 05092000
*     RETURN;                       /*                       @Y30LB25*/ 05093000
*                                                                  1215 05094000
*   /*****************************************************************/ 05095000
*   /*                                                               */ 05096000
*   /* ADD A SLOT, IF VOLUME IS ACTIVE                       @Y30LB25*/ 05097000
*   /*                                                               */ 05098000
*   /*****************************************************************/ 05099000
*                                                                  1216 05100000
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/ 05101000
*     THEN                          /* YES                   @Y30LB25*/ 05102000
         L     @06,BASEVPTR                                        1216 05103000
         TM    BASINAC(@06),B'00000100'                            1216 05104000
         BNZ   @RF01216                                            1216 05105000
*     DO;                           /*                       @Y30LB25*/ 05106000
*       ADDSUBSL=ON;                /* ADD                   @Y30LB25*/ 05107000
         OI    ADDSUBSL,B'00000010'                                1218 05108000
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/ 05109000
         NI    EXPSLOT,B'01111111'                                 1219 05110000
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @Y30LB25*/ 05111000
         L     @15,@CV00767                                        1220 05112000
         LA    @01,@AL01220                                        1220 05113000
         BALR  @14,@15                                             1220 05114000
*     END;                          /*                       @Y30LB25*/ 05115000
*   RETURN;                         /*                       @Y30LB25*/ 05116000
@EL00026 DS    0H                                                  1222 05117000
@EF00026 DS    0H                                                  1222 05118000
@ER00026 L     @14,@SA00026                                        1222 05119000
         BR    @14                                                 1222 05120000
*   END GENERAL;                    /*                       @Y30LB25*/ 05121000
         B     @EL00026                                            1223 05122000
*                                                                  1224 05123000
*   /*****************************************************************/ 05124000
*   /*                                                               */ 05125000
*   /* PROCEDURE NAME - COMMON                               @Y30LB25*/ 05126000
*   /*                                                       @Y30LB25*/ 05127000
*   /* FUNCTION -                                            @Y30LB25*/ 05128000
*   /* ROUTINE UPDATES THE REMAINING FIELDS IN THE BASE      @Y30LB25*/ 05129000
*   /* VOLUME RECORD THAT HAVE NOTHING TO DO WITH THE GROUP. @Y30LB25*/ 05130000
*   /*                                                       @Y30LB25*/ 05131000
*   /* INPUT -                                               @Y30LB25*/ 05132000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05133000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 05134000
*   /*                                                       @Y30LB25*/ 05135000
*   /* OUTPUT -                                              @Y30LB25*/ 05136000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 05137000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 05138000
*   /* AN ERROR                                              @Y30LB25*/ 05139000
*   /*                                                               */ 05140000
*   /*****************************************************************/ 05141000
*                                                                  1224 05142000
*COMMON:                                                           1224 05143000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 05144000
*                                                                  1224 05145000
COMMON   ST    @14,@SA00027                                        1224 05146000
*   /*****************************************************************/ 05147000
*   /*                                                               */ 05148000
*   /* IF GENERAL USE VOLUME THEN HANDLE EXPIRATION          @Y30LB25*/ 05149000
*   /* CHANGES IF CALLED FOR                                 @Y30LB25*/ 05150000
*   /*                                                               */ 05151000
*   /*****************************************************************/ 05152000
*                                                                  1225 05153000
*   IF BASGRPV=ON&BASGENUS=ON&      /* GENERAL USE VOL?      @Y30LB25*/ 05154000
*       (DEFNEXPD=ON|DEFPFOR=ON|DEFPTO=ON) THEN/* CHNGN EXP  @Y30LB25*/ 05155000
         L     @06,BASEVPTR                                        1225 05156000
         TM    BASGRPV(@06),B'00110000'                            1225 05157000
         BNO   @RF01225                                            1225 05158000
         TM    DEFNEXPD(DEFVEPTR),B'00100000'                      1225 05159000
         BO    @RT01225                                            1225 05160000
         TM    DEFPFOR(DEFVEPTR),B'10001000'                       1225 05161000
         BZ    @RF01225                                            1225 05162000
@RT01225 DS    0H                                                  1226 05163000
*     DO;                           /*                       @Y30LB25*/ 05164000
*       GROUPKY=BASGROUP;           /* GET GROUP NAME        @Y30LB25*/ 05165000
         L     @06,BASEVPTR                                        1227 05166000
         MVC   GROUPKY(8),BASGROUP(@06)                            1227 05167000
*       RPLVKEY=ADDR(GKEY);         /* ADDR GROUP KEY        @Y30LB25*/ 05168000
         LA    @06,GKEY                                            1228 05169000
         L     @01,RPLVPTR                                         1228 05170000
         ST    @06,RPLVKEY(,@01)                                   1228 05171000
*       CALL READUPD1;              /* READ GROUP RECORD     @ZA13484*/ 05172000
         BAL   @14,READUPD1                                        1229 05173000
*       IF RPLVRETC¬=FIXZERO THEN   /* CK RETURN             @Y30LB25*/ 05174000
         L     @06,RPLVPTR                                         1230 05175000
         LH    @06,RPLVRETC(,@06)                                  1230 05176000
         N     @06,@CF01129                                        1230 05177000
         LTR   @06,@06                                             1230 05178000
         BNZ   @RT01230                                            1230 05179000
*         RETURN;                   /*                       @Y30LB25*/ 05180000
*                                                                  1231 05181000
*       /*************************************************************/ 05182000
*       /*                                                           */ 05183000
*       /* SET ADDR TO GROUP RECORD JUST READ                @Y30LB25*/ 05184000
*       /*                                                           */ 05185000
*       /*************************************************************/ 05186000
*                                                                  1232 05187000
*       GRPBUF1=BASEBUF1;           /* USE CORRECT BUFF      @ZA13484*/ 05188000
         MVC   GRPBUF1(224),BASEBUF1                               1232 05189000
*       GROUPPTR=ADDR(GRPBUF1);     /* ADDRESSING TO GRP REC @ZA13484*/ 05190000
*                                                                  1233 05191000
         LA    @06,GRPBUF1                                         1233 05192000
         ST    @06,GROUPPTR                                        1233 05193000
*       /*************************************************************/ 05194000
*       /*                                                           */ 05195000
*       /* NULLIFY EXPIRATION DATE BASE RECORD               @Y30LB25*/ 05196000
*       /* CALL ROUTINE TO UPDATE SLOT IN EXTENSION RECORD   @ZA00687*/ 05197000
*       /* TO MATCH RETENTION DATE IN BASE VOLUME RECORD     @ZA00687*/ 05198000
*       /* FOR RETENTION DATE. REMOVE FROM CURRENT SLOT AND  @ZA00687*/ 05199000
*       /* ADD IN LAST EXTENSION SLOT                        @ZA00687*/ 05200000
*       /*                                                           */ 05201000
*       /*************************************************************/ 05202000
*                                                                  1234 05203000
*       IF DEFNEXPD=ON THEN         /* NULL EXPIRATION DATE? @ZA00687*/ 05204000
         TM    DEFNEXPD(DEFVEPTR),B'00100000'                      1234 05205000
         BNO   @RF01234                                            1234 05206000
*         DO;                       /*                       @ZA00687*/ 05207000
*           BASEXPDT=FIX4FS;        /* NULLIFY EXPIRATION    @ZA00687*/ 05208000
         L     @06,BASEVPTR                                        1236 05209000
         MVC   BASEXPDT(4,@06),@CB00677                            1236 05210000
*           IF BASINAC=OFF THEN     /* IS VOL INACTIVE       @ZA17177*/ 05211000
         TM    BASINAC(@06),B'00000100'                            1237 05212000
         BNZ   @RF01237                                            1237 05213000
*             DO;                   /*                       @ZA17177*/ 05214000
*               EXPSLOT=OFF;        /* INDICATE DELETE       @ZA00687*/ 05215000
         NI    EXPSLOT,B'01111111'                                 1239 05216000
*               ADDSUBSL=OFF;       /* INDICATE DELETE       @ZA00687*/ 05217000
         NI    ADDSUBSL,B'11111101'                                1240 05218000
*               CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE); 1241 05219000
         L     @15,@CV00767                                        1241 05220000
         LA    @01,@AL01241                                        1241 05221000
         BALR  @14,@15                                             1241 05222000
*               IF RPLVRETC¬=FIXZERO THEN/* CK RETURN        @ZA00687*/ 05223000
         L     @06,RPLVPTR                                         1242 05224000
         LH    @06,RPLVRETC(,@06)                                  1242 05225000
         N     @06,@CF01129                                        1242 05226000
         LTR   @06,@06                                             1242 05227000
         BNZ   @RT01242                                            1242 05228000
*                 RETURN;           /*                       @ZA00687*/ 05229000
*               ADDSUBSL=ON;        /* INDICATE ADD          @ZA00687*/ 05230000
         OI    ADDSUBSL,B'00000010'                                1244 05231000
*               CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE); 1245 05232000
         L     @15,@CV00767                                        1245 05233000
         LA    @01,@AL01245                                        1245 05234000
         BALR  @14,@15                                             1245 05235000
*               IF RPLVRETC¬=FIXZERO THEN/* CK RETURN        @ZA00687*/ 05236000
         L     @06,RPLVPTR                                         1246 05237000
         LH    @06,RPLVRETC(,@06)                                  1246 05238000
         N     @06,@CF01129                                        1246 05239000
         LTR   @06,@06                                             1246 05240000
         BNZ   @RT01246                                            1246 05241000
*                 RETURN;           /*                       @ZA00687*/ 05242000
*             END;                  /*                       @ZA17177*/ 05243000
*         END;                      /*                       @ZA00687*/ 05244000
*       ELSE                        /*                       #Y30LB25*/ 05245000
*                                                                  1250 05246000
*         /***********************************************************/ 05247000
*         /*                                                         */ 05248000
*         /* OTHERWISE CHECK IF TO OR FOR SPECIFIED          #Y30LB25*/ 05249000
*         /*                                                         */ 05250000
*         /***********************************************************/ 05251000
*                                                                  1250 05252000
*         DO;                       /*                       @Y30LB25*/ 05253000
*                                                                  1250 05254000
         B     @RC01234                                            1250 05255000
@RF01234 DS    0H                                                  1251 05256000
*           /*********************************************************/ 05257000
*           /*                                                       */ 05258000
*           /* IF FOR SPECIFIED, GO CALCULATE EXPIRATION     @Y30LB25*/ 05259000
*           /* DATE AND PUT IT IN BASE RECORD                @Y30LB25*/ 05260000
*           /*                                                       */ 05261000
*           /*********************************************************/ 05262000
*                                                                  1251 05263000
*           IF DEFPFOR=ON THEN      /* FOR SPECIFIED?        @Y30LB25*/ 05264000
         TM    DEFPFOR(DEFVEPTR),B'10000000'                       1251 05265000
         BNO   @RF01251                                            1251 05266000
*             DO;                   /*                       @Y30LB25*/ 05267000
*               CALL ICBVUEXP(DEFFOR,EXPRDT);/*              @Y30LB25*/ 05268000
         LA    @06,DEFFOR(,DEFVEPTR)                               1253 05269000
         ST    @06,@AL00001                                        1253 05270000
         LA    @06,EXPRDT                                          1253 05271000
         ST    @06,@AL00001+4                                      1253 05272000
         L     @15,@CV00768                                        1253 05273000
         LA    @01,@AL00001                                        1253 05274000
         BALR  @14,@15                                             1253 05275000
*               BASEXPDT=EXPRDT;    /* RET IN BASE REC       @Y30LB25*/ 05276000
         L     @06,BASEVPTR                                        1254 05277000
         MVC   BASEXPDT(4,@06),EXPRDT                              1254 05278000
*             END;                  /*                       @Y30LB25*/ 05279000
*                                                                  1255 05280000
*           /*********************************************************/ 05281000
*           /*                                                       */ 05282000
*           /* IF TO WAS SPECIFIED, IF IT EXCEEDS MAXIMUM,   @Y30LB25*/ 05283000
*           /* PUT IN MAXIMUM DATE, OTHERWISE PUT IN TO DATE @Y30LB25*/ 05284000
*           /*                                                       */ 05285000
*           /*********************************************************/ 05286000
*                                                                  1256 05287000
*           IF DEFPTO=ON THEN       /* TO SPECIFIED?         @Y30LB25*/ 05288000
@RF01251 TM    DEFPTO(DEFVEPTR),B'00001000'                        1256 05289000
         BNO   @RF01256                                            1256 05290000
*             DO;                   /*                       @Y30LB25*/ 05291000
*               IF DEFTO>MAXDATE THEN/* CHECK DATE?          @Y30LB25*/ 05292000
         CLC   DEFTO(4,DEFVEPTR),MAXDATE                           1258 05293000
         BNH   @RF01258                                            1258 05294000
*                 BASEXPDT=MAXDATE; /* SET TO MAX DATE       @Y30LB25*/ 05295000
         L     @06,BASEVPTR                                        1259 05296000
         MVC   BASEXPDT(4,@06),MAXDATE                             1259 05297000
*               ELSE                /*                       @Y30LB25*/ 05298000
*                 BASEXPDT=DEFTO;   /* SET TO GIVEN DATE     @Y30LB25*/ 05299000
         B     @RC01258                                            1260 05300000
@RF01258 L     @06,BASEVPTR                                        1260 05301000
         MVC   BASEXPDT(4,@06),DEFTO(DEFVEPTR)                     1260 05302000
*             END;                  /*                       @Y30LB25*/ 05303000
@RC01258 DS    0H                                                  1262 05304000
*         END;                      /*                       @Y30LB25*/ 05305000
*                                                                  1262 05306000
@RF01256 DS    0H                                                  1263 05307000
*       /*************************************************************/ 05308000
*       /*                                                           */ 05309000
*       /* CALL ROUTINE TO UPDATE SLOT IN EXTENSION RECORD   @Y30LB25*/ 05310000
*       /* TO MATCH EXPIRATION DATE IN BASE VOLUME RECORD    @Y30LB25*/ 05311000
*       /* IF THE VOLUME IS ACTIVE.                          @Y30LB25*/ 05312000
*       /*                                                           */ 05313000
*       /*************************************************************/ 05314000
*                                                                  1263 05315000
*       IF BASINAC=OFF              /* ACTIVE?               @Y30LB25*/ 05316000
*         THEN                      /* YES                   @Y30LB25*/ 05317000
@RC01234 L     @06,BASEVPTR                                        1263 05318000
         TM    BASINAC(@06),B'00000100'                            1263 05319000
         BNZ   @RF01263                                            1263 05320000
*         DO;                       /*                       @Y30LB25*/ 05321000
*           EXPSLOT=ON;             /* ADD EXPIR DATE        @Y30LB25*/ 05322000
         OI    EXPSLOT,B'10000000'                                 1265 05323000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   1266 05324000
*                                                            @Y30LB25*/ 05325000
         L     @15,@CV00767                                        1266 05326000
         LA    @01,@AL01266                                        1266 05327000
         BALR  @14,@15                                             1266 05328000
*           IF RPLVRETC¬=FIXZERO THEN/* CK RETURN            @Y30LB25*/ 05329000
         L     @06,RPLVPTR                                         1267 05330000
         LH    @06,RPLVRETC(,@06)                                  1267 05331000
         N     @06,@CF01129                                        1267 05332000
         LTR   @06,@06                                             1267 05333000
         BNZ   @RT01267                                            1267 05334000
*             RETURN;               /*                       @Y30LB25*/ 05335000
*         END;                      /*                       @Y30LB25*/ 05336000
*       GROUPPTR=ADDR(GROUPBUF);    /* RESET GROUP PTR       @ZA13058*/ 05337000
@RF01263 LA    @06,GROUPBUF                                        1270 05338000
         ST    @06,GROUPPTR                                        1270 05339000
*     END;                          /*                       @Y30LB25*/ 05340000
*                                                                  1271 05341000
*   /*****************************************************************/ 05342000
*   /*                                                               */ 05343000
*   /* IF NULLIFY DESCRIPTION CALLED FOR, NULLIFY IT         @Y30LB25*/ 05344000
*   /*                                                               */ 05345000
*   /*****************************************************************/ 05346000
*                                                                  1272 05347000
*   IF DEFNDESC=ON THEN             /* NULLIFY DEXCRIPTION?  @Y30LB25*/ 05348000
@RF01225 TM    DEFNDESC(DEFVEPTR),B'01000000'                      1272 05349000
         BNO   @RF01272                                            1272 05350000
*     BASDESCR=BLANK30;             /* NULLIFT DESCRIP       @Y30LB25*/ 05351000
         L     @06,BASEVPTR                                        1273 05352000
         MVI   BASDESCR+1(@06),C' '                                1273 05353000
         MVC   BASDESCR+2(28,@06),BASDESCR+1(@06)                  1273 05354000
         MVI   BASDESCR(@06),C' '                                  1273 05355000
*   ELSE                            /*                       @Y30LB25*/ 05356000
*                                                                  1274 05357000
*     /***************************************************************/ 05358000
*     /*                                                             */ 05359000
*     /* OTHERWISE SEE IF NEW DESCRIPTION CALLED FOR         @Y30LB25*/ 05360000
*     /*                                                             */ 05361000
*     /***************************************************************/ 05362000
*                                                                  1274 05363000
*     IF DEFPDESC=ON THEN           /* DESCR SPEC?           @Y30LB25*/ 05364000
         B     @RC01272                                            1274 05365000
@RF01272 TM    DEFPDESC(DEFVEPTR),B'00010000'                      1274 05366000
         BNO   @RF01274                                            1274 05367000
*       BASDESCR=DEFDESCR;          /* MODIFY DESCRIPTION    @Y30LB25*/ 05368000
*                                                                  1275 05369000
         L     @06,BASEVPTR                                        1275 05370000
         MVC   BASDESCR(30,@06),DEFDESCR(DEFVEPTR)                 1275 05371000
*   /*****************************************************************/ 05372000
*   /*                                                               */ 05373000
*   /* IF NEW BACKUP NUMBER SPECIFIED, PUT IT IN             @Y30LB25*/ 05374000
*   /*                                                               */ 05375000
*   /*****************************************************************/ 05376000
*                                                                  1276 05377000
*   IF DEFPBKUP=ON THEN             /* BACKUP SPEC?          @Y30LB25*/ 05378000
@RF01274 DS    0H                                                  1276 05379000
@RC01272 TM    DEFPBKUP(DEFVEPTR),B'00000100'                      1276 05380000
         BNO   @RF01276                                            1276 05381000
*     BASBKLMT=DEFBKUPN;            /* SET MAX BACKUPS       @Y30LB25*/ 05382000
*                                                                  1277 05383000
         IC    @06,DEFBKUPN(,DEFVEPTR)                             1277 05384000
         L     @01,BASEVPTR                                        1277 05385000
         STC   @06,BASBKLMT(,@01)                                  1277 05386000
*   /*****************************************************************/ 05387000
*   /*                                                               */ 05388000
*   /* CLEAR AND/OR SET ERROR RECOVERY FLAGS                 @Y30LB25*/ 05389000
*   /*                                                               */ 05390000
*   /*****************************************************************/ 05391000
*                                                                  1278 05392000
*   BCDVPTR=BASEVPTR;               /* PT TO BVR             @Y30LB25*/ 05393000
@RF01276 L     @06,BASEVPTR                                        1278 05394000
         ST    @06,BCDVPTR                                         1278 05395000
*   CALL SETCLRDF;                  /* CLEAR - SET RECOVERY  @Y30LB25*/ 05396000
         BAL   @14,SETCLRDF                                        1279 05397000
*   RETURN;                         /*                       @Y30LB25*/ 05398000
@EL00027 DS    0H                                                  1280 05399000
@EF00027 DS    0H                                                  1280 05400000
@ER00027 L     @14,@SA00027                                        1280 05401000
         BR    @14                                                 1280 05402000
*   END COMMON;                     /*                       @Y30LB25*/ 05403000
         B     @EL00027                                            1281 05404000
*                                                                  1282 05405000
*   /*****************************************************************/ 05406000
*   /*                                                               */ 05407000
*   /* PROCEDURE NAME - PCVRE                                @Y30LB25*/ 05408000
*   /*                                                       @Y30LB25*/ 05409000
*   /* FUNCTION -                                            @Y30LB25*/ 05410000
*   /* PROCESS THE IEZDEFVE FOR A CVR.                       @Y30LB25*/ 05411000
*   /*                                                       @Y30LB25*/ 05412000
*   /* INPUT -                                               @Y30LB25*/ 05413000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05414000
*   /* COPY VOLUME RECORD                                    @Y30LB25*/ 05415000
*   /*                                                       @Y30LB25*/ 05416000
*   /* OUTPUT -                                              @Y30LB25*/ 05417000
*   /* COPY VOLUME RECORD                                    @Y30LB25*/ 05418000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 05419000
*   /* AN ERROR                                              @Y30LB25*/ 05420000
*   /*                                                               */ 05421000
*   /*****************************************************************/ 05422000
*                                                                  1282 05423000
*PCVRE:                                                            1282 05424000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 05425000
*                                                                  1282 05426000
PCVRE    ST    @14,@SA00028                                        1282 05427000
*   /*****************************************************************/ 05428000
*   /*                                                               */ 05429000
*   /* CHECK FOR DESCRIPTION                                 @Y30LB25*/ 05430000
*   /*                                                               */ 05431000
*   /*****************************************************************/ 05432000
*                                                                  1283 05433000
*   IF DEFPDESC=ON                  /* ADD DESCRPT?          @Y30LB25*/ 05434000
*     THEN                          /* YES                   @Y30LB25*/ 05435000
         TM    DEFPDESC(DEFVEPTR),B'00010000'                      1283 05436000
         BNO   @RF01283                                            1283 05437000
*     COPDESCR=DEFDESCR;            /* SET NEW DESCRPT       @Y30LB25*/ 05438000
         L     @06,COPYVPTR                                        1284 05439000
         MVC   COPDESCR(30,@06),DEFDESCR(DEFVEPTR)                 1284 05440000
*   IF DEFNDESC=ON                  /* NULLIFY?              @Y30LB25*/ 05441000
*     THEN                          /* YES                   @Y30LB25*/ 05442000
@RF01283 TM    DEFNDESC(DEFVEPTR),B'01000000'                      1285 05443000
         BNO   @RF01285                                            1285 05444000
*     COPDESCR=BLANK30;             /* BLANK DESCRPT         @Y30LB25*/ 05445000
*                                                                  1286 05446000
         L     @06,COPYVPTR                                        1286 05447000
         MVI   COPDESCR+1(@06),C' '                                1286 05448000
         MVC   COPDESCR+2(28,@06),COPDESCR+1(@06)                  1286 05449000
         MVI   COPDESCR(@06),C' '                                  1286 05450000
*   /*****************************************************************/ 05451000
*   /*                                                               */ 05452000
*   /* CHECK IF THE MAXIMUM NUMBER OF BACKUPS IS TO CHANGE   @Y30LB25*/ 05453000
*   /*                                                               */ 05454000
*   /*****************************************************************/ 05455000
*                                                                  1287 05456000
*   IF DEFPBKUP=ON                  /* BACKUP?               @Y30LB25*/ 05457000
*     THEN                          /* YES                   @Y30LB25*/ 05458000
@RF01285 TM    DEFPBKUP(DEFVEPTR),B'00000100'                      1287 05459000
         BNO   @RF01287                                            1287 05460000
*     DO;                           /*                       @Y30LB25*/ 05461000
*       BVOLKY=COPSERNO;            /* SET VOLID             @Y30LB25*/ 05462000
         L     @06,COPYVPTR                                        1289 05463000
         MVC   BVOLKY(6),COPSERNO(@06)                             1289 05464000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 05465000
         LA    @06,BKEY                                            1290 05466000
         L     @01,RPLVPTR                                         1290 05467000
         ST    @06,RPLVKEY(,@01)                                   1290 05468000
*       CALL READUPD1;              /* READ CVR'S BVR        @Y30LB25*/ 05469000
         BAL   @14,READUPD1                                        1291 05470000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 05471000
*         THEN                      /* YES                   @Y30LB25*/ 05472000
         L     @06,RPLVPTR                                         1292 05473000
         LH    @06,RPLVRETC(,@06)                                  1292 05474000
         N     @06,@CF01129                                        1292 05475000
         LTR   @06,@06                                             1292 05476000
         BNZ   @RT01292                                            1292 05477000
*         RETURN;                   /*                       @Y30LB25*/ 05478000
*       BASEVPTR=ADDR(BASEBUF1);    /* MAP OF BVR            @Y30LB25*/ 05479000
         LA    @06,BASEBUF1                                        1294 05480000
         ST    @06,BASEVPTR                                        1294 05481000
*       BASBKLMT=DEFBKUPN;          /* SET MAX # BKUP        @Y30LB25*/ 05482000
         IC    @15,DEFBKUPN(,DEFVEPTR)                             1295 05483000
         STC   @15,BASBKLMT(,@06)                                  1295 05484000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 05485000
         BAL   @14,WRITRECD                                        1296 05486000
*       BASEVPTR=ADDR(BASEBUF);     /* RESTORE MAP           @Y30LB25*/ 05487000
         LA    @06,BASEBUF                                         1297 05488000
         ST    @06,BASEVPTR                                        1297 05489000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 05490000
*         THEN                      /* YES                   @Y30LB25*/ 05491000
         L     @06,RPLVPTR                                         1298 05492000
         LH    @06,RPLVRETC(,@06)                                  1298 05493000
         N     @06,@CF01129                                        1298 05494000
         LTR   @06,@06                                             1298 05495000
         BNZ   @RT01298                                            1298 05496000
*         RETURN;                   /*                       @Y30LB25*/ 05497000
*     END;                          /*                       @Y30LB25*/ 05498000
*                                                                  1300 05499000
*   /*****************************************************************/ 05500000
*   /*                                                               */ 05501000
*   /* CLEAR AND/OR SET ERROR RECOVERY FLAGS                 @Y30LB25*/ 05502000
*   /*                                                               */ 05503000
*   /*****************************************************************/ 05504000
*                                                                  1301 05505000
*   CALL SETCLRDF;                  /* SET - CLEAR           @Y30LB25   05506000
*                                      RECOVERY FLGS         @Y30LB25*/ 05507000
@RF01287 BAL   @14,SETCLRDF                                        1301 05508000
*   RETURN;                         /*                       @Y30LB25*/ 05509000
@EL00028 DS    0H                                                  1302 05510000
@EF00028 DS    0H                                                  1302 05511000
@ER00028 L     @14,@SA00028                                        1302 05512000
         BR    @14                                                 1302 05513000
*   END PCVRE;                      /*                       @Y30LB25*/ 05514000
         B     @EL00028                                            1303 05515000
*                                                                  1304 05516000
*   /*****************************************************************/ 05517000
*   /*                                                               */ 05518000
*   /* PROCEDURE NAME - SETCLRDF                             @Y30LB25*/ 05519000
*   /*                                                       @Y30LB25*/ 05520000
*   /* FUNCTION -                                            @Y30LB25*/ 05521000
*   /* SET AND THE CLEAR ERROR RECOVERY FLAGS                @Y30LB25*/ 05522000
*   /* FOR THE DEFINEV.                                      @Y30LB25*/ 05523000
*   /*                                                       @Y30LB25*/ 05524000
*   /* INPUT -                                               @Y30LB25*/ 05525000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05526000
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/ 05527000
*   /*                                                       @Y30LB25*/ 05528000
*   /* OUTPUT -                                              @Y30LB25*/ 05529000
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/ 05530000
*   /*                                                               */ 05531000
*   /*****************************************************************/ 05532000
*                                                                  1304 05533000
*SETCLRDF:                                                         1304 05534000
*   PROC OPTIONS(NOSAVEAREA);       /*                       @ZDR2054*/ 05535000
*                                                                  1304 05536000
SETCLRDF STM   @14,@12,12(@13)                                     1304 05537000
*   /*****************************************************************/ 05538000
*   /*                                                               */ 05539000
*   /* SET ERROR RECOVERY FLAGS ON.                          @Y30LB25*/ 05540000
*   /*                                                               */ 05541000
*   /*****************************************************************/ 05542000
*                                                                  1305 05543000
*   IF DEFSRCVY=ON                  /* SET RECOVERY FLAGS    @Y30LB25*/ 05544000
*     THEN                          /* YES                   @Y30LB25*/ 05545000
         TM    DEFSRCVY(DEFVEPTR),B'10000000'                      1305 05546000
         BNO   @RF01305                                            1305 05547000
*     DO;                           /*                       @Y30LB25*/ 05548000
*       IF DEFICOPY=ON              /* INCOMP COPY?          @Y30LB25*/ 05549000
*         THEN                      /* YES                   @Y30LB25*/ 05550000
         TM    DEFICOPY(DEFVEPTR),B'10000000'                      1307 05551000
         BNO   @RF01307                                            1307 05552000
*         BCDIVCPY=ON;              /* SET FLAG              @Y30LB25*/ 05553000
         L     @06,BCDVPTR                                         1308 05554000
         OI    BCDIVCPY(@06),B'01000000'                           1308 05555000
*       IF DEFCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/ 05556000
*         THEN                      /* YES                   @Y30LB25*/ 05557000
@RF01307 TM    DEFCREAT(DEFVEPTR),B'01000000'                      1309 05558000
         BNO   @RF01309                                            1309 05559000
*         BCDIVCRE=ON;              /* SET FLAG              @Y30LB25*/ 05560000
         L     @06,BCDVPTR                                         1310 05561000
         OI    BCDIVCRE(@06),B'10000000'                           1310 05562000
*       IF DEFLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/ 05563000
*         THEN                      /* YES                   @Y30LB25*/ 05564000
@RF01309 TM    DEFLAMIS(DEFVEPTR),B'00100000'                      1311 05565000
         BNO   @RF01311                                            1311 05566000
*         DO;                       /*                       @Y30LB25*/ 05567000
*           BCDVSMIS=ON;            /* SET FLAG              @Y30LB25*/ 05568000
         L     @06,BCDVPTR                                         1313 05569000
         OI    BCDVSMIS(@06),B'00100000'                           1313 05570000
*           IF BCDBASE=ON           /* BVR?                  @Y30LB25*/ 05571000
*             THEN                  /* YES                   @Y30LB25*/ 05572000
         TM    BCDBASE(@06),B'00100000'                            1314 05573000
         BNO   @RF01314                                            1314 05574000
*             BASRECOV=DEFLABEL;    /*                       @Y30LB25   05575000
*                                      SET LABEL             @Y30LB25*/ 05576000
         L     @06,BASEVPTR                                        1315 05577000
         MVC   BASRECOV(6,@06),DEFLABEL(DEFVEPTR)                  1315 05578000
*         END;                      /*                       @Y30LB25*/ 05579000
@RF01314 DS    0H                                                  1317 05580000
*     END;                          /*                       @Y30LB25*/ 05581000
*                                                                  1317 05582000
@RF01311 DS    0H                                                  1318 05583000
*   /*****************************************************************/ 05584000
*   /*                                                               */ 05585000
*   /* SET ERROR RECOVERY FLAGS OFF (CLEAR).                 @Y30LB25*/ 05586000
*   /*                                                               */ 05587000
*   /*****************************************************************/ 05588000
*                                                                  1318 05589000
*   IF DEFCRCVY=ON                  /* CLEAR RECOVERY FLAGS          */ 05590000
*     THEN                          /* YES                   @Y30LB25*/ 05591000
@RF01305 TM    DEFCRCVY(DEFVEPTR),B'01000000'                      1318 05592000
         BNO   @RF01318                                            1318 05593000
*     DO;                           /*                       @Y30LB25*/ 05594000
*       IF DEFICOPY=ON              /* INCOMP COPY?          @Y30LB25*/ 05595000
*         THEN                      /* YES                   @Y30LB25*/ 05596000
         TM    DEFICOPY(DEFVEPTR),B'10000000'                      1320 05597000
         BNO   @RF01320                                            1320 05598000
*         BCDIVCPY=OFF;             /* CLR FLAG              @Y30LB25*/ 05599000
         L     @06,BCDVPTR                                         1321 05600000
         NI    BCDIVCPY(@06),B'10111111'                           1321 05601000
*       IF DEFCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/ 05602000
*         THEN                      /* YES                   @Y30LB25*/ 05603000
@RF01320 TM    DEFCREAT(DEFVEPTR),B'01000000'                      1322 05604000
         BNO   @RF01322                                            1322 05605000
*         BCDIVCRE=OFF;             /* CLR FLAG              @Y30LB25*/ 05606000
         L     @06,BCDVPTR                                         1323 05607000
         NI    BCDIVCRE(@06),B'01111111'                           1323 05608000
*       IF DEFLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/ 05609000
*         THEN                      /* YES                   @Y30LB25*/ 05610000
@RF01322 TM    DEFLAMIS(DEFVEPTR),B'00100000'                      1324 05611000
         BNO   @RF01324                                            1324 05612000
*         DO;                       /*                       @Y30LB25*/ 05613000
*           BCDVSMIS=OFF;           /* CLR FLAG              @Y30LB25*/ 05614000
         L     @06,BCDVPTR                                         1326 05615000
         NI    BCDVSMIS(@06),B'11011111'                           1326 05616000
*           IF BCDBASE=ON           /* BVR?                  @Y30LB25*/ 05617000
*             THEN                  /* YES                   @Y30LB25*/ 05618000
         TM    BCDBASE(@06),B'00100000'                            1327 05619000
         BNO   @RF01327                                            1327 05620000
*             BASRECOV=DEFLABEL;    /*                       @Y30LB25   05621000
*                                      CLR LABEL             @Y30LB25*/ 05622000
         L     @06,BASEVPTR                                        1328 05623000
         MVC   BASRECOV(6,@06),DEFLABEL(DEFVEPTR)                  1328 05624000
*         END;                      /*                       @Y30LB25*/ 05625000
*     END;                          /*                       @Y30LB25*/ 05626000
*   RETURN;                         /*                       @Y30LB25*/ 05627000
@EL00029 DS    0H                                                  1331 05628000
@EF00029 DS    0H                                                  1331 05629000
@ER00029 LM    @14,@12,12(@13)                                     1331 05630000
         BR    @14                                                 1331 05631000
*   END SETCLRDF;                   /*                       @Y30LB25*/ 05632000
         B     @EL00029                                            1332 05633000
*                                                                  1333 05634000
*   /*****************************************************************/ 05635000
*   /*                                                               */ 05636000
*   /* PROCEDURE NAME - SETCLRCV                             @Y30LB25*/ 05637000
*   /*                                                       @Y30LB25*/ 05638000
*   /* FUNCTION -                                            @Y30LB25*/ 05639000
*   /* SET AND THE CLEAR ERROR RECOVERY FLAGS                @Y30LB25*/ 05640000
*   /* FOR THE CVOL.                                         @Y30LB25*/ 05641000
*   /*                                                       @Y30LB25*/ 05642000
*   /* INPUT -                                               @Y30LB25*/ 05643000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05644000
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/ 05645000
*   /*                                                       @Y30LB25*/ 05646000
*   /* OUTPUT -                                              @Y30LB25*/ 05647000
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/ 05648000
*   /*                                                               */ 05649000
*   /*****************************************************************/ 05650000
*                                                                  1333 05651000
*SETCLRCV:                                                         1333 05652000
*   PROC OPTIONS(NOSAVEAREA);       /*                       @ZDR2054*/ 05653000
*                                                                  1333 05654000
SETCLRCV STM   @14,@12,12(@13)                                     1333 05655000
*   /*****************************************************************/ 05656000
*   /*                                                               */ 05657000
*   /* SET ERROR RECOVERY FLAGS ON.                          @Y30LB25*/ 05658000
*   /*                                                               */ 05659000
*   /*****************************************************************/ 05660000
*                                                                  1334 05661000
*   IF COVSRCVY=ON                  /* SET RECOVERY FLAGS    @Y30LB25*/ 05662000
*     THEN                          /* YES                   @Y30LB25*/ 05663000
         L     @06,COVCEPTR                                        1334 05664000
         TM    COVSRCVY(@06),B'10000000'                           1334 05665000
         BNO   @RF01334                                            1334 05666000
*     DO;                           /*                       @Y30LB25*/ 05667000
*       IF COVICOPY=ON              /* INCOMP COPY?          @Y30LB25*/ 05668000
*         THEN                      /* YES                   @Y30LB25*/ 05669000
         TM    COVICOPY(@06),B'10000000'                           1336 05670000
         BNO   @RF01336                                            1336 05671000
*         BCDIVCPY=ON;              /* SET FLAG              @Y30LB25*/ 05672000
         L     @06,BCDVPTR                                         1337 05673000
         OI    BCDIVCPY(@06),B'01000000'                           1337 05674000
*       IF COVCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/ 05675000
*         THEN                      /* YES                   @Y30LB25*/ 05676000
@RF01336 L     @06,COVCEPTR                                        1338 05677000
         TM    COVCREAT(@06),B'01000000'                           1338 05678000
         BNO   @RF01338                                            1338 05679000
*         BCDIVCRE=ON;              /* SET FLAG              @Y30LB25*/ 05680000
         L     @06,BCDVPTR                                         1339 05681000
         OI    BCDIVCRE(@06),B'10000000'                           1339 05682000
*       IF COVLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/ 05683000
*         THEN                      /* YES                   @Y30LB25*/ 05684000
@RF01338 L     @06,COVCEPTR                                        1340 05685000
         TM    COVLAMIS(@06),B'00100000'                           1340 05686000
         BNO   @RF01340                                            1340 05687000
*         BCDVSMIS=ON;              /* SET FLAG              @Y30LB25*/ 05688000
         L     @06,BCDVPTR                                         1341 05689000
         OI    BCDVSMIS(@06),B'00100000'                           1341 05690000
*     END;                          /*                       @Y30LB25*/ 05691000
*                                                                  1342 05692000
@RF01340 DS    0H                                                  1343 05693000
*   /*****************************************************************/ 05694000
*   /*                                                               */ 05695000
*   /* SET ERROR RECOVERY FLAGS OFF (CLEAR).                 @Y30LB25*/ 05696000
*   /*                                                               */ 05697000
*   /*****************************************************************/ 05698000
*                                                                  1343 05699000
*   IF COVCRCVY=ON                  /* CLEAR RECOVERY FLAGS          */ 05700000
*     THEN                          /* YES                   @Y30LB25*/ 05701000
@RF01334 L     @06,COVCEPTR                                        1343 05702000
         TM    COVCRCVY(@06),B'01000000'                           1343 05703000
         BNO   @RF01343                                            1343 05704000
*     DO;                           /*                       @Y30LB25*/ 05705000
*       IF COVICOPY=ON              /* INCOMP COPY?          @Y30LB25*/ 05706000
*         THEN                      /* YES                   @Y30LB25*/ 05707000
         TM    COVICOPY(@06),B'10000000'                           1345 05708000
         BNO   @RF01345                                            1345 05709000
*         BCDIVCPY=OFF;             /* CLR FLAG              @Y30LB25*/ 05710000
         L     @06,BCDVPTR                                         1346 05711000
         NI    BCDIVCPY(@06),B'10111111'                           1346 05712000
*       IF COVCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/ 05713000
*         THEN                      /* YES                   @Y30LB25*/ 05714000
@RF01345 L     @06,COVCEPTR                                        1347 05715000
         TM    COVCREAT(@06),B'01000000'                           1347 05716000
         BNO   @RF01347                                            1347 05717000
*         BCDIVCRE=OFF;             /* CLR FLAG              @Y30LB25*/ 05718000
         L     @06,BCDVPTR                                         1348 05719000
         NI    BCDIVCRE(@06),B'01111111'                           1348 05720000
*       IF COVLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/ 05721000
*         THEN                      /* YES                   @Y30LB25*/ 05722000
@RF01347 L     @06,COVCEPTR                                        1349 05723000
         TM    COVLAMIS(@06),B'00100000'                           1349 05724000
         BNO   @RF01349                                            1349 05725000
*         BCDVSMIS=OFF;             /* CLR FLAG              @Y30LB25*/ 05726000
         L     @06,BCDVPTR                                         1350 05727000
         NI    BCDVSMIS(@06),B'11011111'                           1350 05728000
*     END;                          /*                       @Y30LB25*/ 05729000
*   RETURN;                         /*                       @Y30LB25*/ 05730000
@EL00030 DS    0H                                                  1352 05731000
@EF00030 DS    0H                                                  1352 05732000
@ER00030 LM    @14,@12,12(@13)                                     1352 05733000
         BR    @14                                                 1352 05734000
*   END SETCLRCV;                   /*                       @Y30LB25*/ 05735000
         B     @EL00030                                            1353 05736000
*                                                                  1354 05737000
*   /*****************************************************************/ 05738000
*   /*                                                               */ 05739000
*   /* PROCEDURE NAME - REPVFLG1                             @Y30LB25*/ 05740000
*   /*                                                       @Y30LB25*/ 05741000
*   /* FUNCTION -                                            @Y30LB25*/ 05742000
*   /* REPLACE VOLUME FLAGS PROCESSING BEFORE THE MSC        @Y30LB25*/ 05743000
*   /* IS CALLED.                                            @Y30LB25*/ 05744000
*   /*                                                       @Y30LB25*/ 05745000
*   /* INPUT -                                               @Y30LB25*/ 05746000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05747000
*   /*                                                       @Y30LB25*/ 05748000
*   /* OUTPUT -                                              @Y30LB25*/ 05749000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 05750000
*   /* AN ERROR                                              @Y30LB25*/ 05751000
*   /*                                                               */ 05752000
*   /*****************************************************************/ 05753000
*                                                                  1354 05754000
*REPVFLG1:                                                         1354 05755000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 05756000
*                                                                  1354 05757000
REPVFLG1 ST    @14,@SA00031                                        1354 05758000
*   /*****************************************************************/ 05759000
*   /*                                                               */ 05760000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 05761000
*   /*                                                               */ 05762000
*   /*****************************************************************/ 05763000
*                                                                  1355 05764000
*   CALL RMSVIS;                    /* RESERVE .MSVI         @Y30LB25*/ 05765000
*                                                                  1355 05766000
         BAL   @14,RMSVIS                                          1355 05767000
*   /*****************************************************************/ 05768000
*   /*                                                               */ 05769000
*   /* IF NECESSARY, INSURE A GROUP EXISTS                   @VS32198*/ 05770000
*   /*                                                               */ 05771000
*   /*****************************************************************/ 05772000
*                                                                  1356 05773000
*   IF DEFVVEXT¬=FIXZERO&DEFPGRO=ON /* GROUP SPECIFIED?      @ZA28871*/ 05774000
*     THEN                          /* YES                   @VS32198*/ 05775000
         L     @06,DEFVVEXT(,DEFVPTR)                              1356 05776000
         LTR   @06,@06                                             1356 05777000
         BZ    @RF01356                                            1356 05778000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       1356 05779000
         BNO   @RF01356                                            1356 05780000
*     DO;                           /*                       @VS32198*/ 05781000
*       GROUPKY=DEFGROUP;           /* SET GROUP NAME        @VS32198*/ 05782000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1358 05783000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY               @VS32198*/ 05784000
         LA    @06,GKEY                                            1359 05785000
         L     @01,RPLVPTR                                         1359 05786000
         ST    @06,RPLVKEY(,@01)                                   1359 05787000
*       CALL READLOC;               /* GET GVR               @VS32198*/ 05788000
         BAL   @14,READLOC                                         1360 05789000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @VS32198*/ 05790000
*         THEN                      /* YES                   @VS32198*/ 05791000
         L     @06,RPLVPTR                                         1361 05792000
         LH    @15,RPLVRETC(,@06)                                  1361 05793000
         N     @15,@CF01129                                        1361 05794000
         LTR   @15,@15                                             1361 05795000
         BZ    @RF01361                                            1361 05796000
*         DO;                       /*                       @VS32198*/ 05797000
*           IF RPLRCODE=NORECFND    /* NONE FOUND?           @VS32198*/ 05798000
*             THEN                  /* RIGHT                 @VS32198*/ 05799000
         CLC   RPLRCODE(2,@06),@CB00711                            1363 05800000
         BNE   @RF01363                                            1363 05801000
*             RPLRCODE=NOGRPFND;    /*                       @VS32198   05802000
*                                      NO GROUP FND          @VS32198*/ 05803000
         MVC   RPLRCODE(2,@06),@CB00707                            1364 05804000
*           RETURN;                 /*                       @VS32198*/ 05805000
@EL00031 DS    0H                                                  1365 05806000
@EF00031 DS    0H                                                  1365 05807000
@ER00031 L     @14,@SA00031                                        1365 05808000
         BR    @14                                                 1365 05809000
*         END;                      /*                       @VS32198*/ 05810000
*     END;                          /*                       @VS32198*/ 05811000
*                                                                  1367 05812000
@RF01361 DS    0H                                                  1368 05813000
*   /*****************************************************************/ 05814000
*   /*                                                               */ 05815000
*   /* GET THE VOLUME                                        #Y30LB25*/ 05816000
*   /*                                                               */ 05817000
*   /*****************************************************************/ 05818000
*                                                                  1368 05819000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             #Y30LB25*/ 05820000
@RF01356 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1368 05821000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          #Y30LB25*/ 05822000
         LA    @06,BKEY                                            1369 05823000
         L     @01,RPLVPTR                                         1369 05824000
         ST    @06,RPLVKEY(,@01)                                   1369 05825000
*   CALL READLOC;                   /* READ BVR              #Y30LB25*/ 05826000
         BAL   @14,READLOC                                         1370 05827000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                #Y30LB25*/ 05828000
*     THEN                          /* YES                   @Y30LB25*/ 05829000
         L     @06,RPLVPTR                                         1371 05830000
         LH    @15,RPLVRETC(,@06)                                  1371 05831000
         N     @15,@CF01129                                        1371 05832000
         LTR   @15,@15                                             1371 05833000
         BNZ   @RT01371                                            1371 05834000
*     RETURN;                       /*                       @Y30LB25*/ 05835000
*   BASEBUF=BUFFER;                 /* SAVE BVR IN CASE      @Y30LB25   05836000
*                                      GVR IS READ           @Y30LB25*/ 05837000
*                                                                  1373 05838000
         L     @06,RPLVBUF(,@06)                                   1373 05839000
         MVC   BASEBUF(224),BUFFER(@06)                            1373 05840000
*   /*****************************************************************/ 05841000
*   /*                                                               */ 05842000
*   /* CHECK FOR VALID 'TO' OR 'FOR' EXPIRATION DATE.        @Y30LB25*/ 05843000
*   /*                                                               */ 05844000
*   /*****************************************************************/ 05845000
*                                                                  1374 05846000
*   CALL EXPCK;                     /* CK EXPIR DATE         @Y30LB25*/ 05847000
         BAL   @14,EXPCK                                           1374 05848000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 05849000
*     THEN                          /* YES                   @Y30LB25*/ 05850000
         L     @06,RPLVPTR                                         1375 05851000
         LH    @06,RPLVRETC(,@06)                                  1375 05852000
         N     @06,@CF01129                                        1375 05853000
         LTR   @06,@06                                             1375 05854000
         BNZ   @RT01375                                            1375 05855000
*     RETURN;                       /*                       @Y30LB25*/ 05856000
*                                                                  1376 05857000
*   /*****************************************************************/ 05858000
*   /*                                                               */ 05859000
*   /* CHECK ATTRIBUTES IF NECESSARY.                        @Y30LB25*/ 05860000
*   /*                                                               */ 05861000
*   /*****************************************************************/ 05862000
*                                                                  1377 05863000
*   CALL CKATTRIB;                  /* CK ATTRIBUTES         @Y30LB25*/ 05864000
         BAL   @14,CKATTRIB                                        1377 05865000
*   RETURN;                         /*                       @Y30LB25*/ 05866000
         B     @EL00031                                            1378 05867000
*   END REPVFLG1;                   /*                       @Y30LB25*/ 05868000
         B     @EL00031                                            1379 05869000
*                                                                  1380 05870000
*   /*****************************************************************/ 05871000
*   /*                                                               */ 05872000
*   /* PROCEDURE NAME - REPVFLG2                             @Y30LB25*/ 05873000
*   /*                                                       @Y30LB25*/ 05874000
*   /* FUNCTION -                                            @Y30LB25*/ 05875000
*   /* REPLACE VOLUME FLAGS PROCESSING AFTER THE MSC         @Y30LB25*/ 05876000
*   /* WAS CALLED.                                           @Y30LB25*/ 05877000
*   /*                                                       @Y30LB25*/ 05878000
*   /* INPUT -                                               @Y30LB25*/ 05879000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05880000
*   /*                                                       @Y30LB25*/ 05881000
*   /* OUTPUT -                                              @Y30LB25*/ 05882000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 05883000
*   /* AN ERROR                                              @Y30LB25*/ 05884000
*   /*                                                               */ 05885000
*   /*****************************************************************/ 05886000
*                                                                  1380 05887000
*REPVFLG2:                          /*                       @Y30LB25*/ 05888000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 05889000
REPVFLG2 ST    @14,@SA00032                                        1380 05890000
*   IF RPLRCODE¬=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 05891000
*     THEN                          /* YES                   @Y30LB25*/ 05892000
         L     @06,RPLVPTR                                         1381 05893000
         LH    @15,RPLRCODE(,@06)                                  1381 05894000
         N     @15,@CF01129                                        1381 05895000
         LTR   @15,@15                                             1381 05896000
         BZ    @RF01381                                            1381 05897000
*     DO;                           /*                       @Y30LB25*/ 05898000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 05899000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1383 05900000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 05901000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1384 05902000
*       RETURN;                     /*                       @Y30LB25*/ 05903000
@EL00032 DS    0H                                                  1385 05904000
@EF00032 DS    0H                                                  1385 05905000
@ER00032 L     @14,@SA00032                                        1385 05906000
         BR    @14                                                 1385 05907000
*     END;                          /*                       @Y30LB25*/ 05908000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           #Y30LB25   05909000
*                                      RESERVE .MSVI         #Y30LB25*/ 05910000
*                                                                  1387 05911000
@RF01381 BAL   @14,HOUSKEEP                                        1387 05912000
*   /*****************************************************************/ 05913000
*   /*                                                               */ 05914000
*   /* GET THE VOLUME RECORD                                 @Y30LB25*/ 05915000
*   /*                                                               */ 05916000
*   /*****************************************************************/ 05917000
*                                                                  1388 05918000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 05919000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1388 05920000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 05921000
         LA    @06,BKEY                                            1389 05922000
         L     @01,RPLVPTR                                         1389 05923000
         ST    @06,RPLVKEY(,@01)                                   1389 05924000
*   CALL READUPD1;                  /* GET RECORD            @Y30LB25*/ 05925000
         BAL   @14,READUPD1                                        1390 05926000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 05927000
*     THEN                          /* YES                   @Y30LB25*/ 05928000
         L     @06,RPLVPTR                                         1391 05929000
         LH    @06,RPLVRETC(,@06)                                  1391 05930000
         N     @06,@CF01129                                        1391 05931000
         LTR   @06,@06                                             1391 05932000
         BNZ   @RT01391                                            1391 05933000
*     RETURN;                       /*                       @Y30LB25*/ 05934000
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUF       @Y30LB25*/ 05935000
*                                                                  1393 05936000
         MVC   BASEBUF(224),BASEBUF1                               1393 05937000
*   /*****************************************************************/ 05938000
*   /*                                                               */ 05939000
*   /* UPDATE BVR EXCLUSIVE ATTRIBUTE                        @Y30LB25*/ 05940000
*   /*                                                               */ 05941000
*   /*****************************************************************/ 05942000
*                                                                  1394 05943000
*   IF DEFVEXCL=ON                  /* EXCL ON?              @Y30LB25*/ 05944000
*     THEN                          /* YES                   @Y30LB25*/ 05945000
         TM    DEFVEXCL(DEFVPTR),B'00010000'                       1394 05946000
         BNO   @RF01394                                            1394 05947000
*     BASEXCL=ON;                   /* SET ON                @Y30LB25*/ 05948000
         L     @06,BASEVPTR                                        1395 05949000
         OI    BASEXCL(@06),B'00000001'                            1395 05950000
*   ELSE                            /* EXCL IS OFF           @Y30LB25*/ 05951000
*     BASEXCL=OFF;                  /* SET OFF               @Y30LB25*/ 05952000
*                                                                  1396 05953000
         B     @RC01394                                            1396 05954000
@RF01394 L     @06,BASEVPTR                                        1396 05955000
         NI    BASEXCL(@06),B'11111110'                            1396 05956000
*   /*****************************************************************/ 05957000
*   /*                                                               */ 05958000
*   /* UPDATE BVR BIND ATTRIBUTE                             @Y30LB25*/ 05959000
*   /*                                                               */ 05960000
*   /*****************************************************************/ 05961000
*                                                                  1397 05962000
*   IF DEFVBIND=ON                  /* BIND ON?              @Y30LB25*/ 05963000
*     THEN                          /* YES                   @Y30LB25*/ 05964000
@RC01394 TM    DEFVBIND(DEFVPTR),B'00000100'                       1397 05965000
         BNO   @RF01397                                            1397 05966000
*     BASBIND=ON;                   /* SET ON                @Y30LB25*/ 05967000
         L     @06,BASEVPTR                                        1398 05968000
         OI    BASBIND(@06),B'00000010'                            1398 05969000
*   ELSE                            /* BIND IS OFF           @Y30LB25*/ 05970000
*     BASBIND=OFF;                  /* SET OFF               @Y30LB25*/ 05971000
*                                                                  1399 05972000
         B     @RC01397                                            1399 05973000
@RF01397 L     @06,BASEVPTR                                        1399 05974000
         NI    BASBIND(@06),B'11111101'                            1399 05975000
*   /*****************************************************************/ 05976000
*   /*                                                               */ 05977000
*   /* UPDATE DASD ERASE ATTRIBUTE                           @Y30LB25*/ 05978000
*   /*                                                               */ 05979000
*   /*****************************************************************/ 05980000
*                                                                  1400 05981000
*   IF DEFVSEC=ON                   /* SECURE ON?            @Y30LB25*/ 05982000
*     THEN                          /* YES                   @Y30LB25*/ 05983000
@RC01397 TM    DEFVSEC(DEFVPTR),B'00100000'                        1400 05984000
         BNO   @RF01400                                            1400 05985000
*     BASDAERA=ON;                  /* SET ON                @Y30LB25*/ 05986000
         L     @06,BASEVPTR                                        1401 05987000
         OI    BASDAERA(@06),B'10000000'                           1401 05988000
*   ELSE                            /* SECURE IS OFF         @Y30LB25*/ 05989000
*     BASDAERA=OFF;                 /* SET OFF               @Y30LB25*/ 05990000
*                                                                  1402 05991000
         B     @RC01400                                            1402 05992000
@RF01400 L     @06,BASEVPTR                                        1402 05993000
         NI    BASDAERA(@06),B'01111111'                           1402 05994000
*   /*****************************************************************/ 05995000
*   /*                                                               */ 05996000
*   /* UPDATE BVR READ ONLY ATTRIBUTE                        @Y30LB25*/ 05997000
*   /*                                                               */ 05998000
*   /*****************************************************************/ 05999000
*                                                                  1403 06000000
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/ 06001000
*     THEN                          /* YES                   @Y30LB25*/ 06002000
@RC01400 TM    DEFVWINH(DEFVPTR),B'00000010'                       1403 06003000
         BNO   @RF01403                                            1403 06004000
*     BASRONLY=ON;                  /* SET ON                @Y30LB25*/ 06005000
         L     @06,BASEVPTR                                        1404 06006000
         OI    BASRONLY(@06),B'01000000'                           1404 06007000
*   ELSE                            /* READ ONLY IS OFF      @Y30LB25*/ 06008000
*     BASRONLY=OFF;                 /* SET OFF               @Y30LB25*/ 06009000
*                                                                  1405 06010000
         B     @RC01403                                            1405 06011000
@RF01403 L     @06,BASEVPTR                                        1405 06012000
         NI    BASRONLY(@06),B'10111111'                           1405 06013000
*   /*****************************************************************/ 06014000
*   /*                                                               */ 06015000
*   /* CHECK FOR DEVFE TO BE PROCESSED                       @Y30LB25*/ 06016000
*   /*                                                               */ 06017000
*   /*****************************************************************/ 06018000
*                                                                  1406 06019000
*   IF DEFVVEXT¬=FIXZERO            /* DEFVE?                @Y30LB25*/ 06020000
*     THEN                          /* YES                   @Y30LB25*/ 06021000
@RC01403 L     @06,DEFVVEXT(,DEFVPTR)                              1406 06022000
         LTR   @06,@06                                             1406 06023000
         BZ    @RF01406                                            1406 06024000
*     DO;                           /*                       @Y30LB25*/ 06025000
*       BCDVPTR=BASEVPTR;           /* SET BVR PTR           @Y30LB25*/ 06026000
         L     @06,BASEVPTR                                        1408 06027000
         ST    @06,BCDVPTR                                         1408 06028000
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/ 06029000
         BAL   @14,PRODEFVE                                        1409 06030000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 06031000
*         THEN                      /* YES                   @Y30LB25*/ 06032000
         L     @06,RPLVPTR                                         1410 06033000
         LH    @15,RPLVRETC(,@06)                                  1410 06034000
         N     @15,@CF01129                                        1410 06035000
         LTR   @15,@15                                             1410 06036000
         BNZ   @RT01410                                            1410 06037000
*         RETURN;                   /*                       @Y30LB25*/ 06038000
*                                                                  1411 06039000
*       /*************************************************************/ 06040000
*       /*                                                           */ 06041000
*       /* REESTABLISH BVR'S RPLV                            @Y30LB25*/ 06042000
*       /*                                                           */ 06043000
*       /*************************************************************/ 06044000
*                                                                  1412 06045000
*       BVOLKY=BASSERNO;            /* RESET VOLID           @Y30LB25*/ 06046000
         L     @01,BASEVPTR                                        1412 06047000
         MVC   BVOLKY(6),BASSERNO(@01)                             1412 06048000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 06049000
         LA    @15,BKEY                                            1413 06050000
         ST    @15,RPLVKEY(,@06)                                   1413 06051000
*       CALL READUPD1;              /* READ BVR              @Y30LB25*/ 06052000
         BAL   @14,READUPD1                                        1414 06053000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 06054000
*         THEN                      /* YES                   @Y30LB25*/ 06055000
         L     @06,RPLVPTR                                         1415 06056000
         LH    @06,RPLVRETC(,@06)                                  1415 06057000
         N     @06,@CF01129                                        1415 06058000
         LTR   @06,@06                                             1415 06059000
         BNZ   @RT01415                                            1415 06060000
*         RETURN;                   /*                       @Y30LB25*/ 06061000
*     END;                          /*                       @Y30LB25*/ 06062000
*   RPLVBUF=ADDR(BASEBUF);          /* ADDR OF BVR BUF       @Y30LB25*/ 06063000
@RF01406 LA    @06,BASEBUF                                         1418 06064000
         L     @01,RPLVPTR                                         1418 06065000
         ST    @06,RPLVBUF(,@01)                                   1418 06066000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 06067000
         BAL   @14,WRITRECD                                        1419 06068000
*   RETURN;                         /*                       @Y30LB25*/ 06069000
         B     @EL00032                                            1420 06070000
*   END REPVFLG2;                   /*                       @Y30LB25*/ 06071000
         B     @EL00032                                            1421 06072000
*                                                                  1422 06073000
*   /*****************************************************************/ 06074000
*   /*                                                               */ 06075000
*   /* PROCEDURE NAME - CRTINCV1                             @Y30LB25*/ 06076000
*   /*                                                       @Y30LB25*/ 06077000
*   /* FUNCTION -                                            @Y30LB25*/ 06078000
*   /* PROCESS THE CREATION OF AN INACTIVE VOLUME BEFORE     @Y30LB25*/ 06079000
*   /* THE MSC IS CALLED.                                    @Y30LB25*/ 06080000
*   /* AN ICBDEFV EXTENSION IS REQUIRED.                     @Y30LB25*/ 06081000
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY  @Y30LB25*/ 06082000
*   /*                                                       @Y30LB25*/ 06083000
*   /* INPUT -                                               @Y30LB25*/ 06084000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06085000
*   /*                                                       @Y30LB25*/ 06086000
*   /* OUTPUT -                                              @Y30LB25*/ 06087000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06088000
*   /* AN ERROR                                              @Y30LB25*/ 06089000
*   /*                                                               */ 06090000
*   /*****************************************************************/ 06091000
*                                                                  1422 06092000
*CRTINCV1:                          /*                       @Y30LB25*/ 06093000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06094000
*                                                                  1422 06095000
CRTINCV1 ST    @14,@SA00033                                        1422 06096000
*   /*****************************************************************/ 06097000
*   /*                                                               */ 06098000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 06099000
*   /*                                                               */ 06100000
*   /*****************************************************************/ 06101000
*                                                                  1423 06102000
*   CALL RMSVI;                     /* RESERVE .MSVI         @Y30LB25*/ 06103000
*                                                                  1423 06104000
         BAL   @14,RMSVI                                           1423 06105000
*   /*****************************************************************/ 06106000
*   /*                                                               */ 06107000
*   /* IF NECESSARY, INSURE A GROUP EXISTS                   @VS32198*/ 06108000
*   /*                                                               */ 06109000
*   /*****************************************************************/ 06110000
*                                                                  1424 06111000
*   IF DEFPGRO=ON&DEFVVEXT¬=FIXZERO /* GROUP SPECIFIED?      @VS34305*/ 06112000
*     THEN                          /* YES                   @VS32198*/ 06113000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       1424 06114000
         BNO   @RF01424                                            1424 06115000
         L     @06,DEFVVEXT(,DEFVPTR)                              1424 06116000
         LTR   @06,@06                                             1424 06117000
         BZ    @RF01424                                            1424 06118000
*     DO;                           /*                       @VS32198*/ 06119000
*       GROUPKY=DEFGROUP;           /* SET GROUP NAME        @VS32198*/ 06120000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1426 06121000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY               @VS32198*/ 06122000
         LA    @06,GKEY                                            1427 06123000
         L     @01,RPLVPTR                                         1427 06124000
         ST    @06,RPLVKEY(,@01)                                   1427 06125000
*       CALL READLOC;               /* GET GVR               @VS32198*/ 06126000
         BAL   @14,READLOC                                         1428 06127000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @VS32198*/ 06128000
*         THEN                      /* YES                   @VS32198*/ 06129000
         L     @06,RPLVPTR                                         1429 06130000
         LH    @15,RPLVRETC(,@06)                                  1429 06131000
         N     @15,@CF01129                                        1429 06132000
         LTR   @15,@15                                             1429 06133000
         BZ    @RF01429                                            1429 06134000
*         DO;                       /*                       @VS32198*/ 06135000
*           IF RPLRCODE=NORECFND    /* NONE FOUND?           @VS32198*/ 06136000
*             THEN                  /* RIGHT                 @VS32198*/ 06137000
         CLC   RPLRCODE(2,@06),@CB00711                            1431 06138000
         BNE   @RF01431                                            1431 06139000
*             RPLRCODE=NOGRPFND;    /*                       @VS32198   06140000
*                                      NO GROUP FND          @VS32198*/ 06141000
         MVC   RPLRCODE(2,@06),@CB00707                            1432 06142000
*           RETURN;                 /*                       @VS32198*/ 06143000
@EL00033 DS    0H                                                  1433 06144000
@EF00033 DS    0H                                                  1433 06145000
@ER00033 L     @14,@SA00033                                        1433 06146000
         BR    @14                                                 1433 06147000
*         END;                      /*                       @VS32198*/ 06148000
*     END;                          /*                       @VS32198*/ 06149000
*                                                                  1435 06150000
@RF01429 DS    0H                                                  1436 06151000
*   /*****************************************************************/ 06152000
*   /*                                                               */ 06153000
*   /* CHECK FOR CREATE A COPY VOLUME RECORD                 #Y30LB25*/ 06154000
*   /*                                                               */ 06155000
*   /*****************************************************************/ 06156000
*                                                                  1436 06157000
*   IF DEFVVEXT¬=FIXZERO&DEFCOPY=ON /* CREATE A CVR?         #Y30LB25*/ 06158000
*     THEN                          /* YES                   #Y30LB25*/ 06159000
@RF01424 L     @06,DEFVVEXT(,DEFVPTR)                              1436 06160000
         LTR   @06,@06                                             1436 06161000
         BZ    @RF01436                                            1436 06162000
         TM    DEFCOPY(DEFVEPTR),B'00010000'                       1436 06163000
         BNO   @RF01436                                            1436 06164000
*     DO;                           /*                       @Y30LB25*/ 06165000
*                                                                  1437 06166000
*       /*************************************************************/ 06167000
*       /*                                                           */ 06168000
*       /* GET CVR'S BVR                                     @Y30LB25*/ 06169000
*       /*                                                           */ 06170000
*       /*************************************************************/ 06171000
*                                                                  1438 06172000
*       BVOLKY=DEFVOLD;             /* SET VOLID             @Y30LB25*/ 06173000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1438 06174000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 06175000
         LA    @06,BKEY                                            1439 06176000
         L     @05,RPLVPTR                                         1439 06177000
         ST    @06,RPLVKEY(,@05)                                   1439 06178000
*       CALL READLOC;               /* READ BVR              @Y30LB25*/ 06179000
         BAL   @14,READLOC                                         1440 06180000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 06181000
*         THEN                      /* YES                   @Y30LB25*/ 06182000
         L     @06,RPLVPTR                                         1441 06183000
         LH    @05,RPLVRETC(,@06)                                  1441 06184000
         N     @05,@CF01129                                        1441 06185000
         LTR   @05,@05                                             1441 06186000
         BNZ   @RT01441                                            1441 06187000
*         RETURN;                   /*                       @Y30LB25*/ 06188000
*       BASEBUF=BUFFER;             /* SAVE BVR IN CASE      @Y30LB25   06189000
*                                      CVR IS READ           @Y30LB25*/ 06190000
*                                                                  1443 06191000
         L     @05,RPLVBUF(,@06)                                   1443 06192000
         MVC   BASEBUF(224),BUFFER(@05)                            1443 06193000
*       /*************************************************************/ 06194000
*       /*                                                           */ 06195000
*       /* CHECK IF COPIES ARE ALLOWED                       @Y30LB25*/ 06196000
*       /*                                                           */ 06197000
*       /*************************************************************/ 06198000
*                                                                  1444 06199000
*       IF BASNOCPY=ON              /* COPIES ALLOWED?       @Y30LB25*/ 06200000
*         THEN                      /* NO                    @Y30LB25*/ 06201000
         L     @05,BASEVPTR                                        1444 06202000
         TM    BASNOCPY(@05),B'01000000'                           1444 06203000
         BNO   @RF01444                                            1444 06204000
*         DO;                       /*                       @Y30LB25*/ 06205000
*           RPLVRETC=FIXFOUR;       /* ERROR RETURN CODE     @Y30LB25*/ 06206000
         MVC   RPLVRETC(2,@06),@CH00041                            1446 06207000
*           RPLRCODE=NOCPYBVR;      /* ERROR REASON CODE     @Y30LB25*/ 06208000
         MVC   RPLRCODE(2,@06),@CB00721                            1447 06209000
*         END;                      /*                       @Y30LB25*/ 06210000
*                                                                  1448 06211000
*       /*************************************************************/ 06212000
*       /*                                                           */ 06213000
*       /* CREATE A PLACE HOLDER CVR                         @Y30LB25*/ 06214000
*       /*                                                           */ 06215000
*       /*************************************************************/ 06216000
*                                                                  1449 06217000
*       CALL CRTCVR1;               /* CREATE PLACE HOLD     @Y30LB25*/ 06218000
@RF01444 BAL   @14,CRTCVR1                                         1449 06219000
*       RETURN;                     /*                       @Y30LB25*/ 06220000
         B     @EL00033                                            1450 06221000
*     END;                          /*                       @Y30LB25*/ 06222000
*                                                                  1451 06223000
*   /*****************************************************************/ 06224000
*   /*                                                               */ 06225000
*   /* CHECK ATTRIBUTES, IF NECESSARY.                       @Y30LB25*/ 06226000
*   /* CKATTRIB WILL ONLY CHECK IF THE VOLUME IS TO          @Y30LB25*/ 06227000
*   /* BE GROUPED.                                           @Y30LB25*/ 06228000
*   /*                                                               */ 06229000
*   /*****************************************************************/ 06230000
*                                                                  1452 06231000
*   BASGENUS=OFF;                   /* NO GEN-USE            @Y30LB25*/ 06232000
@RF01436 DS    0H                                                  1453 06233000
*   BASGRPV=OFF;                    /* NOT GROUPED           @Y30LB25*/ 06234000
         L     @06,BASEVPTR                                        1453 06235000
         NI    BASGENUS(@06),B'11001111'                           1453 06236000
*   CALL CKATTRIB;                  /* CK ATTRIBUTES         @Y30LB25*/ 06237000
         BAL   @14,CKATTRIB                                        1454 06238000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 06239000
*     THEN                          /* YES                   @Y30LB25*/ 06240000
         L     @06,RPLVPTR                                         1455 06241000
         LH    @06,RPLVRETC(,@06)                                  1455 06242000
         N     @06,@CF01129                                        1455 06243000
         LTR   @06,@06                                             1455 06244000
         BNZ   @RT01455                                            1455 06245000
*     RETURN;                       /*                       @Y30LB25*/ 06246000
*                                                                  1456 06247000
*   /*****************************************************************/ 06248000
*   /*                                                               */ 06249000
*   /* CREATE AND WRITE A PLACE HOLDER BASE VOLUME RECORD    @Y30LB25*/ 06250000
*   /*                                                               */ 06251000
*   /*****************************************************************/ 06252000
*                                                                  1457 06253000
*   BVOLKY=DEFVOLD;                 /* SET KEY               @Y30LB25*/ 06254000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1457 06255000
*   CALL CRTPHOLD;                  /* CREATE BVR PLACE      @Y30LB25   06256000
*                                      HOLDER                @Y30LB25*/ 06257000
         BAL   @14,CRTPHOLD                                        1458 06258000
*   RETURN;                         /*                       @Y30LB25*/ 06259000
         B     @EL00033                                            1459 06260000
*   END CRTINCV1;                   /*                       @Y30LB25*/ 06261000
         B     @EL00033                                            1460 06262000
*                                                                  1461 06263000
*   /*****************************************************************/ 06264000
*   /*                                                               */ 06265000
*   /* PROCEDURE NAME - READLOC                              @Y30LB25*/ 06266000
*   /*                                                       @Y30LB25*/ 06267000
*   /* FUNCTION -                                            @Y30LB25*/ 06268000
*   /* READ AN MSVC RECORD IN THE LOCATE MODE.               @Y30LB25*/ 06269000
*   /*                                                       @Y30LB25*/ 06270000
*   /* INPUT -                                               @Y30LB25*/ 06271000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06272000
*   /* ADDRESS OF THE KEY TO READ IN RPLVKEY                 @Y30LB25*/ 06273000
*   /*                                                       @Y30LB25*/ 06274000
*   /* OUTPUT -                                              @Y30LB25*/ 06275000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06276000
*   /* AN ERROR                                              @Y30LB25*/ 06277000
*   /*                                                               */ 06278000
*   /*****************************************************************/ 06279000
*                                                                  1461 06280000
*READLOC:                           /*                       @Y30LB25*/ 06281000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06282000
READLOC  ST    @14,@SA00034                                        1461 06283000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 06284000
         L     @06,RPLVPTR                                         1462 06285000
         MVI   RPLVTYP(@06),X'00'                                  1462 06286000
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/ 06287000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 06288000
         OI    RPLVLOC(@06),B'11000000'                            1464 06289000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/ 06290000
         NI    RPLVUPD(@06),B'11111101'                            1465 06291000
*   RESPECIFY                                                      1466 06292000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 06293000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 06294000
         LR    RG1,@06                                             1467 06295000
*   CALL ICBVIO00;                  /* READ RECORD           @Y30LB25*/ 06296000
         L     @15,@CV00762                                        1468 06297000
         BALR  @14,@15                                             1468 06298000
*   RESPECIFY                                                      1469 06299000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 06300000
*   RETURN;                         /*                       @Y30LB25*/ 06301000
@EL00034 DS    0H                                                  1470 06302000
@EF00034 DS    0H                                                  1470 06303000
@ER00034 L     @14,@SA00034                                        1470 06304000
         BR    @14                                                 1470 06305000
*   END READLOC;                    /*                       @Y30LB25*/ 06306000
*                                                                  1472 06307000
*   /*****************************************************************/ 06308000
*   /*                                                               */ 06309000
*   /* PROCEDURE NAME - CRTPHOLD                             @Y30LB25*/ 06310000
*   /*                                                       @Y30LB25*/ 06311000
*   /* FUNCTION -                                            @Y30LB25*/ 06312000
*   /* CREATE AND WRITE A PLACE HOLDER BVR.                  @Y30LB25*/ 06313000
*   /*                                                       @Y30LB25*/ 06314000
*   /* INPUT -                                               @Y30LB25*/ 06315000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06316000
*   /* BKEY                                                  @Y30LB25*/ 06317000
*   /*                                                       @Y30LB25*/ 06318000
*   /* OUTPUT -                                              @Y30LB25*/ 06319000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06320000
*   /* AN ERROR                                              @Y30LB25*/ 06321000
*   /*                                                               */ 06322000
*   /*****************************************************************/ 06323000
*                                                                  1472 06324000
*CRTPHOLD:                          /*                       @Y30LB25*/ 06325000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06326000
CRTPHOLD ST    @14,@SA00035                                        1472 06327000
*   BASEBUF=BASEBUF&&BASEBUF;       /* CLEAR BVR BUF         @Y30LB25*/ 06328000
         XC    BASEBUF(224),BASEBUF                                1473 06329000
*   BASNAME=BKEY;                   /* SET KEY               @Y30LB25*/ 06330000
         L     @06,BASEVPTR                                        1474 06331000
         MVC   BASNAME(13,@06),BKEY                                1474 06332000
*   BASBASVR=ON;                    /* BVR FLAG              @Y30LB25*/ 06333000
         OI    BASBASVR(@06),B'00100000'                           1475 06334000
*   BASHOLD=ON;                     /* PLACE HOLDER          @Y30LB25*/ 06335000
         OI    BASHOLD(@06),B'10000000'                            1476 06336000
*   BASINAC=ON;                     /* INACTIVE              @Y30LB25*/ 06337000
         OI    BASINAC(@06),B'00000100'                            1477 06338000
*   BASCSN1=BLANK12;                /* CSN1                  @Y30LB25*/ 06339000
         MVC   BASCSN1(12,@06),@CC00689                            1478 06340000
*   BASCSN2=BLANK12;                /* CSN2                  @Y30LB25*/ 06341000
         MVC   BASCSN2(12,@06),@CC00689                            1479 06342000
*   RPLVBLN=LENGTH(BASEBUF);        /* LENGTH BVR BUF        @Y30LB25*/ 06343000
         LA    @06,224                                             1480 06344000
         L     @15,RPLVPTR                                         1480 06345000
         ST    @06,RPLVBLN(,@15)                                   1480 06346000
*   RPLVRLN=LENGTH(BASEBUF);        /* BVR LENGTH            @Y30LB25*/ 06347000
         ST    @06,RPLVRLN(,@15)                                   1481 06348000
*   RPLVBUF=ADDR(BASEBUF);          /* SET BUF ADDR          @Y30LB25*/ 06349000
         LA    @06,BASEBUF                                         1482 06350000
         ST    @06,RPLVBUF(,@15)                                   1482 06351000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 06352000
         NI    RPLVLOC(@15),B'01111111'                            1483 06353000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/ 06354000
         NI    RPLVUPD(@15),B'11111101'                            1484 06355000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 06356000
         BAL   @14,WRITRECD                                        1485 06357000
*   RETURN;                         /*                       @Y30LB25*/ 06358000
@EL00035 DS    0H                                                  1486 06359000
@EF00035 DS    0H                                                  1486 06360000
@ER00035 L     @14,@SA00035                                        1486 06361000
         BR    @14                                                 1486 06362000
*   END CRTPHOLD;                   /*                       @Y30LB25*/ 06363000
*                                                                  1488 06364000
*   /*****************************************************************/ 06365000
*   /*                                                               */ 06366000
*   /* PROCEDURE NAME - CRTINCV2                             @Y30LB25*/ 06367000
*   /*                                                       @Y30LB25*/ 06368000
*   /* FUNCTION -                                            @Y30LB25*/ 06369000
*   /* PROCESS THE CREATION OF AN INACTIVE VOLUME AFTER      @Y30LB25*/ 06370000
*   /* THE MSC WAS CALLED.                                   @Y30LB25*/ 06371000
*   /* AN ICBDEFV EXTENSION IS REQUIRED.                     @Y30LB25*/ 06372000
*   /* ONE IS NOT SUPPLIED DURING USER TASK RECOVERY THOUGH. @Y30LB25*/ 06373000
*   /* CIRS ARE CREATED BY ICBVMS00 WHEN IT RECEIVES         @Y30LB25*/ 06374000
*   /* THE 04 MESSAGE.                                       @Y30LB25*/ 06375000
*   /*                                                       @Y30LB25*/ 06376000
*   /* INPUT -                                               @Y30LB25*/ 06377000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06378000
*   /*                                                       @Y30LB25*/ 06379000
*   /* OUTPUT -                                              @Y30LB25*/ 06380000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06381000
*   /* AN ERROR                                              @Y30LB25*/ 06382000
*   /*                                                               */ 06383000
*   /*****************************************************************/ 06384000
*                                                                  1488 06385000
*CRTINCV2:                          /*                       @Y30LB25*/ 06386000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06387000
CRTINCV2 ST    @14,@SA00036                                        1488 06388000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   06389000
*                                      RESERVE .MSVI         @Y30LB25*/ 06390000
         BAL   @14,HOUSKEEP                                        1489 06391000
*   IF RPLRCODE¬=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 06392000
*     THEN                          /* YES                   @Y30LB25*/ 06393000
         L     @06,RPLVPTR                                         1490 06394000
         LH    @15,RPLRCODE(,@06)                                  1490 06395000
         N     @15,@CF01129                                        1490 06396000
         LTR   @15,@15                                             1490 06397000
         BZ    @RF01490                                            1490 06398000
*     DO;                           /*                       @Y30LB25*/ 06399000
*                                                                  1491 06400000
*       /*************************************************************/ 06401000
*       /*                                                           */ 06402000
*       /* ZERO MSC'S RETURN AND REASON CODE                 @Y30LB25*/ 06403000
*       /*                                                           */ 06404000
*       /*************************************************************/ 06405000
*                                                                  1492 06406000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/*                       @Y30LB25   06407000
*                                      0 RPLV RETN CODE      @Y30LB25*/ 06408000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1492 06409000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/*                       @Y30LB25   06410000
*                                      0 RPLV RETN CODE      @Y30LB25*/ 06411000
*                                                                  1493 06412000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1493 06413000
*       /*************************************************************/ 06414000
*       /*                                                           */ 06415000
*       /* READ FOR THE BVR                                  @Y30LB25*/ 06416000
*       /*                                                           */ 06417000
*       /*************************************************************/ 06418000
*                                                                  1494 06419000
*       BVOLKY=DEFVOLD;             /*                       @Y30LB25*/ 06420000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1494 06421000
*       RPLVKEY=ADDR(BKEY);         /*                       @Y30LB25*/ 06422000
         LA    @05,BKEY                                            1495 06423000
         ST    @05,RPLVKEY(,@06)                                   1495 06424000
*       CALL READUPD1;              /*                       @Y30LB25*/ 06425000
         BAL   @14,READUPD1                                        1496 06426000
*       BASEBUF=BASEBUF1;           /*                       @Y30LB25*/ 06427000
         MVC   BASEBUF(224),BASEBUF1                               1497 06428000
*       IF RPLVRETC¬=FIXZERO THEN                                  1498 06429000
         L     @06,RPLVPTR                                         1498 06430000
         LH    @05,RPLVRETC(,@06)                                  1498 06431000
         N     @05,@CF01129                                        1498 06432000
         LTR   @05,@05                                             1498 06433000
         BNZ   @RT01498                                            1498 06434000
*         RETURN;                   /*                       @Y30LB25*/ 06435000
*                                                                  1499 06436000
*       /*************************************************************/ 06437000
*       /*                                                           */ 06438000
*       /* DELETE THE PLACE HOLDER BASE OR COPY              @Y30LB25*/ 06439000
*       /* VOLUME RECORD WHICH WAS CREATED BEFORE THE        @Y30LB25*/ 06440000
*       /* CALL TO THE MSC.                                  @Y30LB25*/ 06441000
*       /*                                                           */ 06442000
*       /*************************************************************/ 06443000
*                                                                  1500 06444000
*       IF BASHOLD=ON               /* BVR CREATED?          @Y30LB25*/ 06445000
*         THEN                      /* YES                   @Y30LB25*/ 06446000
         L     @05,BASEVPTR                                        1500 06447000
         TM    BASHOLD(@05),B'10000000'                            1500 06448000
         BNO   @RF01500                                            1500 06449000
*         DO;                       /*                       @Y30LB25*/ 06450000
*                                                                  1501 06451000
*           /*********************************************************/ 06452000
*           /*                                                       */ 06453000
*           /* DELETE THE BVR PLACE HOLDER                   @Y30LB25*/ 06454000
*           /*                                                       */ 06455000
*           /*********************************************************/ 06456000
*                                                                  1502 06457000
*           RPLVTYP=RPLVDEL;        /* DELETE                @Y30LB25*/ 06458000
         MVI   RPLVTYP(@06),X'05'                                  1502 06459000
*           RESPECIFY                                              1503 06460000
*             RG1 RSTD;             /* RESTRICT REG 1        @Y30LB25*/ 06461000
*           RG1=RPLVPTR;            /* PT TO RPLV            @Y30LB25*/ 06462000
         LR    RG1,@06                                             1504 06463000
*           CALL ICBVIO00;          /* DELET BVR PLC HOLD    @Y30LB25*/ 06464000
         L     @15,@CV00762                                        1505 06465000
         BALR  @14,@15                                             1505 06466000
*           RESPECIFY                                              1506 06467000
*             RG1 UNRSTD;           /* UNRESTRICT REG 1      @Y30LB25*/ 06468000
*         END;                      /*                       @Y30LB25*/ 06469000
*                                                                  1507 06470000
*       /*************************************************************/ 06471000
*       /*                                                           */ 06472000
*       /* FIND THE PLACE HOLDER CVR                         @Y30LB25*/ 06473000
*       /*                                                           */ 06474000
*       /*************************************************************/ 06475000
*                                                                  1508 06476000
*       ELSE                                                       1508 06477000
*         DO;                       /*                       @Y30LB25*/ 06478000
         B     @RC01500                                            1508 06479000
@RF01500 DS    0H                                                  1509 06480000
*           CALL FNDCVRUP;          /* FIND PLACE HOLD       @Y30LB25*/ 06481000
         BAL   @14,FNDCVRUP                                        1509 06482000
*           IF RPLVRETC¬=FIXZERO    /* ERROR?                @Y30LB25*/ 06483000
*             THEN                  /* YES                   @Y30LB25*/ 06484000
         L     @06,RPLVPTR                                         1510 06485000
         LH    @15,RPLVRETC(,@06)                                  1510 06486000
         N     @15,@CF01129                                        1510 06487000
         LTR   @15,@15                                             1510 06488000
         BNZ   @RT01510                                            1510 06489000
*             RETURN;               /*                       @Y30LB25*/ 06490000
*                                                                  1511 06491000
*           /*********************************************************/ 06492000
*           /*                                                       */ 06493000
*           /* DELETE THE CVR PLACE HOLDER                   @Y30LB25*/ 06494000
*           /*                                                       */ 06495000
*           /*********************************************************/ 06496000
*                                                                  1512 06497000
*           RPLVTYP=RPLVDEL;        /* DELETE                @Y30LB25*/ 06498000
         MVI   RPLVTYP(@06),X'05'                                  1512 06499000
*           RESPECIFY                                              1513 06500000
*             RG1 RSTD;             /* RESTRICT REG 1        @Y30LB25*/ 06501000
*           RG1=RPLVPTR;            /* PT TO RPLV            @Y30LB25*/ 06502000
         LR    RG1,@06                                             1514 06503000
*           CALL ICBVIO00;          /* DELET CVR PLC HOLD    @Y30LB25*/ 06504000
         L     @15,@CV00762                                        1515 06505000
         BALR  @14,@15                                             1515 06506000
*           RESPECIFY                                              1516 06507000
*             RG1 UNRSTD;           /* UNRESTRICT REG 1      @Y30LB25*/ 06508000
*         END;                      /*                       @Y30LB25*/ 06509000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 06510000
@RC01500 L     @06,RPLVPTR                                         1518 06511000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1518 06512000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 06513000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1519 06514000
*       RETURN;                     /*                       @Y30LB25*/ 06515000
@EL00036 DS    0H                                                  1520 06516000
@EF00036 DS    0H                                                  1520 06517000
@ER00036 L     @14,@SA00036                                        1520 06518000
         BR    @14                                                 1520 06519000
*     END;                          /*                       @Y30LB25*/ 06520000
*                                                                  1521 06521000
*   /*****************************************************************/ 06522000
*   /*                                                               */ 06523000
*   /* READ FOR THE BVR                                      @Y30LB25*/ 06524000
*   /*                                                               */ 06525000
*   /*****************************************************************/ 06526000
*                                                                  1522 06527000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 06528000
@RF01490 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1522 06529000
*   RPLVKEY=ADDR(BKEY);             /* KEY ADDR              @Y30LB25*/ 06530000
         LA    @06,BKEY                                            1523 06531000
         L     @01,RPLVPTR                                         1523 06532000
         ST    @06,RPLVKEY(,@01)                                   1523 06533000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 06534000
         BAL   @14,READUPD1                                        1524 06535000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 06536000
*     THEN                          /* YES                   @Y30LB25*/ 06537000
         L     @06,RPLVPTR                                         1525 06538000
         LH    @06,RPLVRETC(,@06)                                  1525 06539000
         N     @06,@CF01129                                        1525 06540000
         LTR   @06,@06                                             1525 06541000
         BNZ   @RT01525                                            1525 06542000
*     RETURN;                       /*                       @Y30LB25*/ 06543000
*   BASEBUF=BASEBUF1;               /*                       @Y30LB25*/ 06544000
*                                                                  1527 06545000
         MVC   BASEBUF(224),BASEBUF1                               1527 06546000
*   /*****************************************************************/ 06547000
*   /*                                                               */ 06548000
*   /* CREATE A COPY VOLUME RECORD FROM A PLACE HOLDER       @Y30LB25*/ 06549000
*   /*                                                               */ 06550000
*   /*****************************************************************/ 06551000
*                                                                  1528 06552000
*   IF BASHOLD=OFF                  /* CREATE CVR?           @Y30LB25*/ 06553000
*     THEN                          /* YES                   @Y30LB25*/ 06554000
         L     @06,BASEVPTR                                        1528 06555000
         TM    BASHOLD(@06),B'10000000'                            1528 06556000
         BNZ   @RF01528                                            1528 06557000
*     DO;                           /*                       @Y30LB25*/ 06558000
*       CALL FNDCVRUP;              /* FIND PLACE HOLD       @Y30LB25*/ 06559000
         BAL   @14,FNDCVRUP                                        1530 06560000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 06561000
*         THEN                      /* YES                   @Y30LB25*/ 06562000
         L     @06,RPLVPTR                                         1531 06563000
         LH    @06,RPLVRETC(,@06)                                  1531 06564000
         N     @06,@CF01129                                        1531 06565000
         LTR   @06,@06                                             1531 06566000
         BNZ   @RT01531                                            1531 06567000
*         RETURN;                   /*                       @Y30LB25*/ 06568000
*       CALL CRTCVR2;               /* MAKE A CVR            @Y30LB25*/ 06569000
         BAL   @14,CRTCVR2                                         1533 06570000
*     END;                          /*                       @Y30LB25*/ 06571000
*                                                                  1534 06572000
*   /*****************************************************************/ 06573000
*   /*                                                               */ 06574000
*   /* CREATE A BASE VOLUME RECORD                           @Y30LB25*/ 06575000
*   /*                                                               */ 06576000
*   /*****************************************************************/ 06577000
*                                                                  1535 06578000
*   ELSE                            /* CREATE BVR            @Y30LB25*/ 06579000
*     CALL CRTBVR;                  /* PROCESS BVR           @Y30LB25*/ 06580000
         B     @RC01528                                            1535 06581000
@RF01528 BAL   @14,CRTBVR                                          1535 06582000
*   RETURN;                         /*                       @Y30LB25*/ 06583000
         B     @EL00036                                            1536 06584000
*   END CRTINCV2;                   /*                       @Y30LB25*/ 06585000
         B     @EL00036                                            1537 06586000
*                                                                  1538 06587000
*   /*****************************************************************/ 06588000
*   /*                                                               */ 06589000
*   /* PROCEDURE NAME - CRTCVR1                              @Y30LB25*/ 06590000
*   /*                                                       @Y30LB25*/ 06591000
*   /* FUNCTION -                                            @Y30LB25*/ 06592000
*   /* CREATE A PLACE HOLDER COPY VOLUME RECORD.             @Y30LB25*/ 06593000
*   /* THE PLACE HOLDER CVR IS NEEDED TO INSURE 04           @Y30LB25*/ 06594000
*   /* SOLICITED MESSAGE CAN BE PROCESSED.                   @Y30LB25*/ 06595000
*   /* CALLED BEFORE THE MSC.                                @Y30LB25*/ 06596000
*   /*                                                       @Y30LB25*/ 06597000
*   /* INPUT -                                               @Y30LB25*/ 06598000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06599000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 06600000
*   /*                                                       @Y30LB25*/ 06601000
*   /* OUTPUT -                                              @Y30LB25*/ 06602000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06603000
*   /* AN ERROR                                              @Y30LB25*/ 06604000
*   /* COPY VOLUME RECORD (PLACE HOLDER)                     @Y30LB25*/ 06605000
*   /*                                                               */ 06606000
*   /*****************************************************************/ 06607000
*                                                                  1538 06608000
*CRTCVR1:                                                          1538 06609000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06610000
*                                                                  1538 06611000
CRTCVR1  ST    @14,@SA00037                                        1538 06612000
*   /*****************************************************************/ 06613000
*   /*                                                               */ 06614000
*   /* GET KEY OF NEXT AVAILABLE CVR.                        @Y30LB25*/ 06615000
*   /*                                                               */ 06616000
*   /*****************************************************************/ 06617000
*                                                                  1539 06618000
*   CALL CALCVRID;                  /* LOC KEY ID            @Y30LB25*/ 06619000
         BAL   @14,CALCVRID                                        1539 06620000
*   IF RPLVRETC¬=FIXZERO&RPLVRETC¬=NORECFND/* ERROR?         @Y30LB25*/ 06621000
*     THEN                          /* YES                   @Y30LB25*/ 06622000
         L     @06,RPLVPTR                                         1540 06623000
         LH    @05,RPLVRETC(,@06)                                  1540 06624000
         N     @05,@CF01129                                        1540 06625000
         LTR   @05,@05                                             1540 06626000
         BZ    @RF01540                                            1540 06627000
         CLC   RPLVRETC(2,@06),@CB00711                            1540 06628000
         BNE   @RT01540                                            1540 06629000
*     RETURN;                       /*                       @Y30LB25*/ 06630000
*   COPYVPTR=ADDR(COPYBUF);         /* RESET CVR BUF PTR     @Y30LB25*/ 06631000
*                                                                  1542 06632000
@RF01540 LA    @06,COPYBUF                                         1542 06633000
         ST    @06,COPYVPTR                                        1542 06634000
*   /*****************************************************************/ 06635000
*   /*                                                               */ 06636000
*   /* INITIALIZE THE PLACE HOLDER CVR.                      @Y30LB25*/ 06637000
*   /* CSNS WILL BE SET BY ICBVMS00.                         @Y30LB25*/ 06638000
*   /*                                                               */ 06639000
*   /*****************************************************************/ 06640000
*                                                                  1543 06641000
*   COPYBUF=COPYBUF&&COPYBUF;       /* ZERO CVR BUF          @Y30LB25*/ 06642000
         XC    COPYBUF(224),COPYBUF                                1543 06643000
*   COPNAME=CKEY;                   /* SET THE KEY           @Y30LB25*/ 06644000
         MVC   COPNAME(13,@06),CKEY                                1544 06645000
*   COPSERNO=DEFVOLD;               /* RESET VOLID           @Y30LB25*/ 06646000
         MVC   COPSERNO(6,@06),DEFVOLD(DEFVPTR)                    1545 06647000
*   COPCOPYV=ON;                    /* CVR FLAG              @Y30LB25*/ 06648000
         OI    COPCOPYV(@06),B'00010000'                           1546 06649000
*   COPHOLD=ON;                     /* PLACE HOLDER          @Y30LB25*/ 06650000
         OI    COPHOLD(@06),B'10000000'                            1547 06651000
*   COPLIB1=DEFVLIB;                /* SET LIB1 ID           @Y30LB25*/ 06652000
         IC    @05,DEFVLIB(,DEFVPTR)                               1548 06653000
         STC   @05,COPLIB1(,@06)                                   1548 06654000
*   COPLIB2=DEFVLIB;                /* SET LIB2 ID           @Y30LB25*/ 06655000
         IC    @05,DEFVLIB(,DEFVPTR)                               1549 06656000
         STC   @05,COPLIB2(,@06)                                   1549 06657000
*   IF DEFOWNID(1:10)¬=FIX10ZRO     /* OWNER ID SPECIFD?     @Y30LB25*/ 06658000
*     THEN                          /* YES                   @Y30LB25*/ 06659000
         CLC   DEFOWNID(10,DEFVPTR),@CB00681                       1550 06660000
         BE    @RF01550                                            1550 06661000
*     COPOWNER=DEFOWNID;            /* SET OWNER             @Y30LB25*/ 06662000
         MVC   COPOWNER(10,@06),DEFOWNID(DEFVPTR)                  1551 06663000
*   ELSE                            /* NO                    @Y30LB25*/ 06664000
*     COPOWNER=BLANK10;             /* NULL OWNER            @Y30LB25*/ 06665000
         B     @RC01550                                            1552 06666000
@RF01550 L     @06,COPYVPTR                                        1552 06667000
         MVI   COPOWNER+1(@06),C' '                                1552 06668000
         MVC   COPOWNER+2(8,@06),COPOWNER+1(@06)                   1552 06669000
         MVI   COPOWNER(@06),C' '                                  1552 06670000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 06671000
*     THEN                          /* YES                   @Y30LB25*/ 06672000
@RC01550 L     @06,BASEVPTR                                        1553 06673000
         TM    BASGRPV(@06),B'00100000'                            1553 06674000
         BNO   @RF01553                                            1553 06675000
*     COPGROUP=ON;                  /* GROUP                 @Y30LB25*/ 06676000
         L     @06,COPYVPTR                                        1554 06677000
         OI    COPGROUP(@06),B'10000000'                           1554 06678000
*   IF BASGENUS=ON                  /* GENERAL-USE?          @Y30LB25*/ 06679000
*     THEN                          /* YES                   @Y30LB25*/ 06680000
@RF01553 L     @06,BASEVPTR                                        1555 06681000
         TM    BASGENUS(@06),B'00010000'                           1555 06682000
         BNO   @RF01555                                            1555 06683000
*     COPGENUS=ON;                  /* GENERAL-USE           @Y30LB25*/ 06684000
         L     @06,COPYVPTR                                        1556 06685000
         OI    COPGENUS(@06),B'00100000'                           1556 06686000
*   ELSE                                                           1557 06687000
*     IF BASRSTD=ON                 /* RESTRICTED?           @Y30LB25*/ 06688000
*       THEN                        /* YES                   @Y30LB25*/ 06689000
         B     @RC01555                                            1557 06690000
@RF01555 L     @06,BASEVPTR                                        1557 06691000
         TM    BASRSTD(@06),B'00001000'                            1557 06692000
         BNO   @RF01557                                            1557 06693000
*       COPRSTD=ON;                 /* RESTRICTED            @Y30LB25*/ 06694000
*                                                                  1558 06695000
         L     @06,COPYVPTR                                        1558 06696000
         OI    COPRSTD(@06),B'00010000'                            1558 06697000
*   /*****************************************************************/ 06698000
*   /*                                                               */ 06699000
*   /* SET UP THE ATTRIBUTES                                 @Y30LB25*/ 06700000
*   /*                                                               */ 06701000
*   /*****************************************************************/ 06702000
*                                                                  1559 06703000
*   IF DEFVEXCL=ON                  /* EXCLUSIVE?            @Y30LB25*/ 06704000
*     THEN                          /* YES                   @Y30LB25*/ 06705000
@RF01557 DS    0H                                                  1559 06706000
@RC01555 TM    DEFVEXCL(DEFVPTR),B'00010000'                       1559 06707000
         BNO   @RF01559                                            1559 06708000
*     COPEXCL=ON;                   /* EXCLUSIVE             @Y30LB25*/ 06709000
         L     @06,COPYVPTR                                        1560 06710000
         OI    COPEXCL(@06),B'00000010'                            1560 06711000
*   IF DEFVBIND=ON                  /* BIND?                 @Y30LB25*/ 06712000
*     THEN                          /* YES                   @Y30LB25*/ 06713000
@RF01559 TM    DEFVBIND(DEFVPTR),B'00000100'                       1561 06714000
         BNO   @RF01561                                            1561 06715000
*     COPBIND=ON;                   /* BIND                  @Y30LB25*/ 06716000
         L     @06,COPYVPTR                                        1562 06717000
         OI    COPBIND(@06),B'00000100'                            1562 06718000
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/ 06719000
*     THEN                          /* YES                   @Y30LB25*/ 06720000
@RF01561 TM    DEFVWINH(DEFVPTR),B'00000010'                       1563 06721000
         BNO   @RF01563                                            1563 06722000
*     COPRONLY=ON;                  /* READ ONLY             @Y30LB25*/ 06723000
         L     @06,COPYVPTR                                        1564 06724000
         OI    COPRONLY(@06),B'10000000'                           1564 06725000
*   IF DEFVSEC=ON                   /* DASD ERASE?           @Y30LB25*/ 06726000
*     THEN                          /* YES                   @Y30LB25*/ 06727000
@RF01563 TM    DEFVSEC(DEFVPTR),B'00100000'                        1565 06728000
         BNO   @RF01565                                            1565 06729000
*     COPDAERA=ON;                  /* DASD ERASE            @Y30LB25*/ 06730000
*                                                                  1566 06731000
         L     @06,COPYVPTR                                        1566 06732000
         OI    COPDAERA(@06),B'00000001'                           1566 06733000
*   /*****************************************************************/ 06734000
*   /*                                                               */ 06735000
*   /* CHECK FOR RECOVERY AND IF SO USE THE DATE             @ZA13484*/ 06736000
*   /* THE RPLV WAS CREATED.                                 @ZA13484*/ 06737000
*   /*                                                               */ 06738000
*   /*****************************************************************/ 06739000
*                                                                  1567 06740000
*   IF RPLJRCVY=ON&RPLVDATE¬=NULLDATE THEN/* RECOVERY?       @ZA13484*/ 06741000
@RF01565 L     @06,RPLVPTR                                         1567 06742000
         TM    RPLJRCVY(@06),B'00000010'                           1567 06743000
         BNO   @RF01567                                            1567 06744000
         CLC   RPLVDATE(4,@06),NULLDATE                            1567 06745000
         BE    @RF01567                                            1567 06746000
*     COPDATE=RPLVDATE;             /* DATE                  @ZA13484*/ 06747000
         L     @01,COPYVPTR                                        1568 06748000
         MVC   COPDATE(4,@01),RPLVDATE(@06)                        1568 06749000
*   ELSE                                                           1569 06750000
*     DO;                           /*                       @ZA13484*/ 06751000
*                                                                  1569 06752000
         B     @RC01567                                            1569 06753000
@RF01567 DS    0H                                                  1570 06754000
*       /*************************************************************/ 06755000
*       /*                                                           */ 06756000
*       /* GET AND SET THE CURRENT DATE                      @Y30LB25*/ 06757000
*       /*                                                           */ 06758000
*       /*************************************************************/ 06759000
*                                                                  1570 06760000
*       CALL ICBVUEXP(FIXZERO,RPLVPTR,EXPRDT);/* GET DATE    @ZA30662*/ 06761000
         L     @15,@CV00768                                        1570 06762000
         LA    @01,@AL01570                                        1570 06763000
         BALR  @14,@15                                             1570 06764000
*       COPDATE=EXPRDT;             /* DATE COPY MADE        @Y30LB25*/ 06765000
         L     @06,COPYVPTR                                        1571 06766000
         MVC   COPDATE(4,@06),EXPRDT                               1571 06767000
*     END;                          /*                       @ZA13484*/ 06768000
*                                                                  1572 06769000
*   /*****************************************************************/ 06770000
*   /*                                                               */ 06771000
*   /* BLANK REMAINING FIELDS                                @Y30LB25*/ 06772000
*   /*                                                               */ 06773000
*   /*****************************************************************/ 06774000
*                                                                  1573 06775000
*   COPDESCR=BLANK30;               /* BLANK DESCR           @Y30LB25*/ 06776000
@RC01567 L     @06,COPYVPTR                                        1573 06777000
         MVI   COPDESCR+1(@06),C' '                                1573 06778000
         MVC   COPDESCR+2(28,@06),COPDESCR+1(@06)                  1573 06779000
         MVI   COPDESCR(@06),C' '                                  1573 06780000
*   COPDTREM=BLANK4;                /* EJECT DATE            @Y30LB25*/ 06781000
         MVI   COPDTREM+1(@06),C' '                                1574 06782000
         MVC   COPDTREM+2(2,@06),COPDTREM+1(@06)                   1574 06783000
         MVI   COPDTREM(@06),C' '                                  1574 06784000
*   COPDEST=BLANK30;                /* DESTINATION           @Y30LB25*/ 06785000
         MVI   COPDEST+1(@06),C' '                                 1575 06786000
         MVC   COPDEST+2(28,@06),COPDEST+1(@06)                    1575 06787000
         MVI   COPDEST(@06),C' '                                   1575 06788000
*   COPCSN1=BLANK12;                /* CSN1                  @Y30LB25*/ 06789000
         MVC   COPCSN1(12,@06),@CC00689                            1576 06790000
*   COPCSN2=BLANK12;                /* CSN2                  @Y30LB25*/ 06791000
*                                                                  1577 06792000
         MVC   COPCSN2(12,@06),@CC00689                            1577 06793000
*   /*****************************************************************/ 06794000
*   /*                                                               */ 06795000
*   /* WRITE THE CVR                                         @Y30LB25*/ 06796000
*   /*                                                               */ 06797000
*   /*****************************************************************/ 06798000
*                                                                  1578 06799000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/ 06800000
         L     @06,RPLVPTR                                         1578 06801000
         NI    RPLVUPD(@06),B'11111101'                            1578 06802000
*   RPLVBLN=LENGTH(COPYBUF);        /* CVR BUF LENGTH        @Y30LB25*/ 06803000
         MVC   RPLVBLN(4,@06),@CF01103                             1579 06804000
*   RPLVBUF=ADDR(COPYBUF);          /* SET BUF ADDR          @Y30LB25*/ 06805000
         LA    @15,COPYBUF                                         1580 06806000
         ST    @15,RPLVBUF(,@06)                                   1580 06807000
*   RPLVRLN=LENGTH(COPYV);          /* CVR LENGTH            @Y30LB25*/ 06808000
         MVC   RPLVRLN(4,@06),@CF01104                             1581 06809000
*   CALL WRITRECD;                  /* WRITE CVR             @Y30LB25*/ 06810000
         BAL   @14,WRITRECD                                        1582 06811000
*   RETURN;                         /*                       @Y30LB25*/ 06812000
@EL00037 DS    0H                                                  1583 06813000
@EF00037 DS    0H                                                  1583 06814000
@ER00037 L     @14,@SA00037                                        1583 06815000
         BR    @14                                                 1583 06816000
*   END CRTCVR1;                    /*                       @Y30LB25*/ 06817000
         B     @EL00037                                            1584 06818000
*                                                                  1585 06819000
*   /*****************************************************************/ 06820000
*   /*                                                               */ 06821000
*   /* PROCEDURE NAME - CALCVRID                             @Y30LB25*/ 06822000
*   /*                                                       @Y30LB25*/ 06823000
*   /* FUNCTION -                                            @Y30LB25*/ 06824000
*   /* CALCULATE A NEW COPY VOLUME RECORD ID.                @Y30LB25*/ 06825000
*   /*                                                       @Y30LB25*/ 06826000
*   /* INPUT -                                               @Y30LB25*/ 06827000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06828000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 06829000
*   /*                                                       @Y30LB25*/ 06830000
*   /* OUTPUT -                                              @Y30LB25*/ 06831000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06832000
*   /* AN ERROR                                              @Y30LB25*/ 06833000
*   /* COPY VOLUME RECORD ID                                 @Y30LB25*/ 06834000
*   /*                                                               */ 06835000
*   /*****************************************************************/ 06836000
*                                                                  1585 06837000
*CALCVRID:                                                         1585 06838000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06839000
*                                                                  1585 06840000
CALCVRID ST    @14,@SA00038                                        1585 06841000
*   /*****************************************************************/ 06842000
*   /*                                                               */ 06843000
*   /* GET KEY OF NEXT AVAILABLE CVR.                        @Y30LB25*/ 06844000
*   /*                                                               */ 06845000
*   /*****************************************************************/ 06846000
*                                                                  1586 06847000
*   CVOLKY=BASSERNO;                /* SET VOLID             @Y30LB25*/ 06848000
         L     @06,BASEVPTR                                        1586 06849000
         MVC   CVOLKY(6),BASSERNO(@06)                             1586 06850000
*   CIDKY=FIXONE;                   /* SET CVR ID            @Y30LB25*/ 06851000
         MVI   CIDKY,X'01'                                         1587 06852000
*   IF BASCOPNO=FIX255&BASNCOPY>FIXZERO/* ANY AVAIL CVR KEY? @Y30LB25*/ 06853000
*     THEN                          /* NO                    @Y30LB25*/ 06854000
         CLI   BASCOPNO(@06),255                                   1588 06855000
         BNE   @RF01588                                            1588 06856000
         CLI   BASNCOPY(@06),0                                     1588 06857000
         BNH   @RF01588                                            1588 06858000
*     DO;                           /*                       @Y30LB25*/ 06859000
*                                                                  1589 06860000
*       /*************************************************************/ 06861000
*       /*                                                           */ 06862000
*       /* REORDER AND COMPRESS CVRS.                        @Y30LB25*/ 06863000
*       /*                                                           */ 06864000
*       /*************************************************************/ 06865000
*                                                                  1590 06866000
*       CALL REORDCVR;              /* PROCESS CVRS          @Y30LB25*/ 06867000
         BAL   @14,REORDCVR                                        1590 06868000
*     END;                          /*                       @Y30LB25*/ 06869000
*                                                                  1591 06870000
*   /*****************************************************************/ 06871000
*   /*                                                               */ 06872000
*   /* CALCULATE THE NEXT AVAILABLE CVR KEY FROM ITS BVR.    @Y30LB25*/ 06873000
*   /*                                                               */ 06874000
*   /*****************************************************************/ 06875000
*                                                                  1592 06876000
*   ELSE                                                           1592 06877000
*     DO;                           /*                       @Y30LB25*/ 06878000
         B     @RC01588                                            1592 06879000
@RF01588 DS    0H                                                  1593 06880000
*       IF BASNCOPY>FIXZERO         /* CVR EXIST?            @Y30LB25*/ 06881000
*         THEN                      /* YES                   @Y30LB25*/ 06882000
         L     @06,BASEVPTR                                        1593 06883000
         CLI   BASNCOPY(@06),0                                     1593 06884000
         BNH   @RF01593                                            1593 06885000
*         BASCOPNO=BASCOPNO+FIXONE; /* INCREM KEY ID         @Y30LB25*/ 06886000
         LA    @05,1                                               1594 06887000
         SLR   @15,@15                                             1594 06888000
         IC    @15,BASCOPNO(,@06)                                  1594 06889000
         ALR   @05,@15                                             1594 06890000
         STC   @05,BASCOPNO(,@06)                                  1594 06891000
*       ELSE                        /* NO                    @Y30LB25*/ 06892000
*         BASCOPNO=FIXONE;          /* SET TO 1              @Y30LB25*/ 06893000
         B     @RC01593                                            1595 06894000
@RF01593 L     @06,BASEVPTR                                        1595 06895000
         MVI   BASCOPNO(@06),X'01'                                 1595 06896000
*       CIDKY=BASCOPNO;             /* SET KEY ID            @Y30LB25*/ 06897000
@RC01593 L     @06,BASEVPTR                                        1596 06898000
         IC    @05,BASCOPNO(,@06)                                  1596 06899000
         STC   @05,CIDKY                                           1596 06900000
*     END;                          /*                       @Y30LB25*/ 06901000
*   RETURN;                         /*                       @Y30LB25*/ 06902000
@EL00038 DS    0H                                                  1598 06903000
@EF00038 DS    0H                                                  1598 06904000
@ER00038 L     @14,@SA00038                                        1598 06905000
         BR    @14                                                 1598 06906000
*   END CALCVRID;                   /*                       @Y30LB25*/ 06907000
         B     @EL00038                                            1599 06908000
*                                                                  1600 06909000
*   /*****************************************************************/ 06910000
*   /*                                                               */ 06911000
*   /* PROCEDURE NAME - REORDCVR                             @Y30LB25*/ 06912000
*   /*                                                       @Y30LB25*/ 06913000
*   /* FUNCTION -                                            @Y30LB25*/ 06914000
*   /* REORDER AND COMPRESS THE CHAIN OF CVRS.               @Y30LB25*/ 06915000
*   /*                                                       @Y30LB25*/ 06916000
*   /* INPUT -                                               @Y30LB25*/ 06917000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06918000
*   /*                                                       @Y30LB25*/ 06919000
*   /* OUTPUT -                                              @Y30LB25*/ 06920000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06921000
*   /* AN ERROR                                              @Y30LB25*/ 06922000
*   /* ID NUMBER OF NEXT AVAILABLE COPY VOLUME               @Y30LB25*/ 06923000
*   /* RECORD IN CIDKY                                       @Y30LB25*/ 06924000
*   /*                                                               */ 06925000
*   /*****************************************************************/ 06926000
*                                                                  1600 06927000
*REORDCVR:                                                         1600 06928000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06929000
*                                                                  1600 06930000
REORDCVR ST    @14,@SA00039                                        1600 06931000
*   /*****************************************************************/ 06932000
*   /*                                                               */ 06933000
*   /* SETUP FOR READ OF CVR CHAIN                           @Y30LB25*/ 06934000
*   /*                                                               */ 06935000
*   /*****************************************************************/ 06936000
*                                                                  1601 06937000
*   COPYVPTR=ADDR(BASEBUF1);        /* SET BUFF PTR          @Y30LB25*/ 06938000
         LA    @06,BASEBUF1                                        1601 06939000
         ST    @06,COPYVPTR                                        1601 06940000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 06941000
         L     @05,RPLVPTR                                         1602 06942000
         OI    RPLVDIR(@05),B'01000000'                            1602 06943000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 06944000
         OI    RPLVUPD(@05),B'00000010'                            1603 06945000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 06946000
*   RPLVKGE=ON;                     /* > OR =                @Y30LB25*/ 06947000
         OI    RPLVKGE(@05),B'00000100'                            1605 06948000
         NI    RPLVLOC(@05),B'01111111'                            1605 06949000
*   RPLVKEY=ADDR(CKEY);             /* KEY ADDR              @Y30LB25*/ 06950000
         LA    @15,CKEY                                            1606 06951000
         ST    @15,RPLVKEY(,@05)                                   1606 06952000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 06953000
         MVI   RPLVTYP(@05),X'00'                                  1607 06954000
*   RPLVBLN=LENGTH(BASEBUF1);       /* CVR BUF LENGTH        @Y30LB25*/ 06955000
         MVC   RPLVBLN(4,@05),@CF01103                             1608 06956000
*   RPLVBUF=ADDR(BASEBUF1);         /* CVR BUF ADDR          @Y30LB25*/ 06957000
         ST    @06,RPLVBUF(,@05)                                   1609 06958000
*   A=FIXONE;                       /* FIRST READ            @Y30LB25*/ 06959000
         MVC   A(4),@CF00046                                       1610 06960000
*   RESPECIFY                                                      1611 06961000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 06962000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 06963000
         LR    RG1,@05                                             1612 06964000
*   DO WHILE CKY=COPV&COPSERNO=BASSERNO&RPLVRETC=FIXZERO;/*  @Y30LB25   06965000
*                                      READ CVR CHAIN        @Y30LB25*/ 06966000
         B     @DE01613                                            1613 06967000
@DL01613 DS    0H                                                  1614 06968000
*     CALL ICBVIO00;                /* READ A CVR            @Y30LB25*/ 06969000
*                                                                  1614 06970000
         L     @15,@CV00762                                        1614 06971000
         BALR  @14,@15                                             1614 06972000
*     /***************************************************************/ 06973000
*     /*                                                             */ 06974000
*     /* IF NOT THE SAME CVR, THEN DELETE THE ONE READ       @Y30LB25*/ 06975000
*     /* AND WRITE THE NEW KEYED CVR                         @Y30LB25*/ 06976000
*     /*                                                             */ 06977000
*     /***************************************************************/ 06978000
*                                                                  1615 06979000
*     IF COPNO¬=A                   /* SAME CVR?             @Y30LB25*/ 06980000
*       THEN                        /* NO                    @Y30LB25*/ 06981000
         L     @06,COPYVPTR                                        1615 06982000
         SLR   @05,@05                                             1615 06983000
         IC    @05,COPNO(,@06)                                     1615 06984000
         C     @05,A                                               1615 06985000
         BE    @RF01615                                            1615 06986000
*       DO;                         /*                       @Y30LB25*/ 06987000
*         RPLVTYP=RPLVDEL;          /* DELETE                @Y30LB25*/ 06988000
         L     @06,RPLVPTR                                         1617 06989000
         MVI   RPLVTYP(@06),X'05'                                  1617 06990000
*         CALL ICBVIO00;            /* DELETE THE CVR        @Y30LB25*/ 06991000
         L     @15,@CV00762                                        1618 06992000
         BALR  @14,@15                                             1618 06993000
*         IF RPLVRETC¬=FIXZERO      /* ERROR?                @Y30LB25*/ 06994000
*           THEN                    /* YES                   @Y30LB25*/ 06995000
         L     @06,RPLVPTR                                         1619 06996000
         LH    @05,RPLVRETC(,@06)                                  1619 06997000
         N     @05,@CF01129                                        1619 06998000
         LTR   @05,@05                                             1619 06999000
         BNZ   @RT01619                                            1619 07000000
*           RETURN;                 /*                       @Y30LB25*/ 07001000
*         COPNO=A;                  /* SET NEW ID            @Y30LB25*/ 07002000
         L     @05,A                                               1621 07003000
         L     @15,COPYVPTR                                        1621 07004000
         STC   @05,COPNO(,@15)                                     1621 07005000
*         RPLVUPD=OFF;              /* NEW RECORD            @Y30LB25*/ 07006000
         NI    RPLVUPD(@06),B'11111101'                            1622 07007000
*         CALL ICBVIO00;            /* WRITE CVR             @Y30LB25*/ 07008000
         L     @15,@CV00762                                        1623 07009000
         BALR  @14,@15                                             1623 07010000
*         RPLVDIR=ON;               /* RESET DIRECT          @Y30LB25*/ 07011000
         L     @06,RPLVPTR                                         1624 07012000
         OI    RPLVDIR(@06),B'01000000'                            1624 07013000
*         RPLVTYP=RPLVREAD;         /* RESET RESD            @Y30LB25*/ 07014000
         MVI   RPLVTYP(@06),X'00'                                  1625 07015000
*       END;                        /*                       @Y30LB25*/ 07016000
*     A=A+FIXONE;                   /* NEXT CVR ID           @Y30LB25*/ 07017000
@RF01615 LA    @06,1                                               1627 07018000
         AL    @06,A                                               1627 07019000
         ST    @06,A                                               1627 07020000
*     CIDKY=A;                      /* SET CVR ID            @Y30LB25*/ 07021000
         STC   @06,CIDKY                                           1628 07022000
*     IF A=FIX256                   /* END?                  @Y30LB25*/ 07023000
*       THEN                        /* YES                   @Y30LB25*/ 07024000
         C     @06,@CF00666                                        1629 07025000
         BNE   @RF01629                                            1629 07026000
*       DO;                         /*                       @Y30LB25*/ 07027000
*         RPLVRETC=FIXFOUR;         /* ERROR RETURN CODE     @Y30LB25*/ 07028000
         L     @06,RPLVPTR                                         1631 07029000
         MVC   RPLVRETC(2,@06),@CH00041                            1631 07030000
*         RPLRCODE=NOCVR;           /* ERROR REASON CODE     @Y30LB25*/ 07031000
         MVC   RPLRCODE(2,@06),@CB00703                            1632 07032000
*         RETURN;                   /*                       @Y30LB25*/ 07033000
@EL00039 DS    0H                                                  1633 07034000
@EF00039 DS    0H                                                  1633 07035000
@ER00039 L     @14,@SA00039                                        1633 07036000
         BR    @14                                                 1633 07037000
*       END;                        /*                       @Y30LB25*/ 07038000
*   END;                            /*                       @Y30LB25*/ 07039000
@RF01629 DS    0H                                                  1635 07040000
@DE01613 L     @06,COPYVPTR                                        1635 07041000
         CLC   CKY(5),COPV(@06)                                    1635 07042000
         BNE   @DC01613                                            1635 07043000
         L     @05,BASEVPTR                                        1635 07044000
         CLC   COPSERNO(6,@06),BASSERNO(@05)                       1635 07045000
         BNE   @DC01613                                            1635 07046000
         L     @06,RPLVPTR                                         1635 07047000
         LH    @06,RPLVRETC(,@06)                                  1635 07048000
         N     @06,@CF01129                                        1635 07049000
         LTR   @06,@06                                             1635 07050000
         BZ    @DL01613                                            1635 07051000
@DC01613 DS    0H                                                  1636 07052000
*   RESPECIFY                                                      1636 07053000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 07054000
*   RPLVKGE=OFF;                    /* NO > OR =             @Y30LB25*/ 07055000
         L     @06,RPLVPTR                                         1637 07056000
         NI    RPLVKGE(@06),B'11111011'                            1637 07057000
*   RETURN;                         /*                       @Y30LB25*/ 07058000
         B     @EL00039                                            1638 07059000
*   END REORDCVR;                   /*                       @Y30LB25*/ 07060000
         B     @EL00039                                            1639 07061000
*                                                                  1640 07062000
*   /*****************************************************************/ 07063000
*   /*                                                               */ 07064000
*   /* PROCEDURE NAME - CRTBVR                               @Y30LB25*/ 07065000
*   /*                                                       @Y30LB25*/ 07066000
*   /* FUNCTION -                                            @Y30LB25*/ 07067000
*   /* CREATE AND WRITE A BASE VOLUME RECORD FROM A PLACE    @Y30LB25*/ 07068000
*   /* HOLDER BVR CREATED BEFORE THE MSC WAS CALLED.         @Y30LB25*/ 07069000
*   /*                                                       @Y30LB25*/ 07070000
*   /* INPUT -                                               @Y30LB25*/ 07071000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 07072000
*   /* PLACE HOLDER BASE VOLUME RECORD IN BASEBUF            @Y30LB25*/ 07073000
*   /* CSNS SETUP IN BASEBUF FOR RENAME                      @Y30LB25*/ 07074000
*   /*                                                       @Y30LB25*/ 07075000
*   /* OUTPUT -                                              @Y30LB25*/ 07076000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 07077000
*   /* AN ERROR                                              @Y30LB25*/ 07078000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 07079000
*   /*                                                               */ 07080000
*   /*****************************************************************/ 07081000
*                                                                  1640 07082000
*CRTBVR:                                                           1640 07083000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 07084000
*                                                                  1640 07085000
CRTBVR   ST    @14,@SA00040                                        1640 07086000
*   /*****************************************************************/ 07087000
*   /*                                                               */ 07088000
*   /* INITIALIZE THE BVR.                                   @Y30LB25*/ 07089000
*   /* CSNS WILL BE SET BY ICBVMS00.                         @Y30LB25*/ 07090000
*   /* USED BY CREATE AN INACTIVE VOLUME                     @Y30LB25*/ 07091000
*   /* AFTER THE MAS WAS CALLED.                             @Y30LB25*/ 07092000
*   /*                                                               */ 07093000
*   /*****************************************************************/ 07094000
*                                                                  1641 07095000
*   BASHOLD=OFF;                    /* NO PLACE HOLD         @Y30LB25*/ 07096000
         L     @06,BASEVPTR                                        1641 07097000
         NI    BASHOLD(@06),B'01111111'                            1641 07098000
*   BASDLSF=ON;                     /* SET DOWN LEV SPC      @Y30LB25*/ 07099000
         OI    BASDLSF(@06),B'10000000'                            1642 07100000
*   BASLIB1=DEFVLIB;                /* LIB1 ID               @Y30LB25*/ 07101000
         IC    @15,DEFVLIB(,DEFVPTR)                               1643 07102000
         STC   @15,BASLIB1(,@06)                                   1643 07103000
*   BASLIB2=DEFVLIB;                /* LIB2 ID               @Y30LB25*/ 07104000
         IC    @15,DEFVLIB(,DEFVPTR)                               1644 07105000
         STC   @15,BASLIB2(,@06)                                   1644 07106000
*   BASINAC=ON;                     /* INACTIVE              @Y30LB25*/ 07107000
         OI    BASINAC(@06),B'00000100'                            1645 07108000
*   BASPREV=BLANK6;                 /* PREV PTR              @Y30LB25*/ 07109000
         MVI   BASPREV+1(@06),C' '                                 1646 07110000
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     1646 07111000
         MVI   BASPREV(@06),C' '                                   1646 07112000
*   BASNEXTV=BLANK6;                /* NEXT PTR              @Y30LB25*/ 07113000
         MVI   BASNEXTV+1(@06),C' '                                1647 07114000
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   1647 07115000
         MVI   BASNEXTV(@06),C' '                                  1647 07116000
*   BASKLCPY=BLANK13;               /* LASTEST COPY          @Y30LB25*/ 07117000
         MVC   BASKLCPY(13,@06),@CC00692                           1648 07118000
*   BASDLMTD=BLANK4;                /* LAST MNT DATE         @Y30LB25*/ 07119000
         MVI   BASDLMTD+1(@06),C' '                                1649 07120000
         MVC   BASDLMTD+2(2,@06),BASDLMTD+1(@06)                   1649 07121000
         MVI   BASDLMTD(@06),C' '                                  1649 07122000
*   BASEXPDT=FIX4FS;                /* EXPIR DATE            @Y30LB25*/ 07123000
         MVC   BASEXPDT(4,@06),@CB00677                            1650 07124000
*   BASDTREM=BLANK4;                /* EJECT DATE            @Y30LB25*/ 07125000
         MVI   BASDTREM+1(@06),C' '                                1651 07126000
         MVC   BASDTREM+2(2,@06),BASDTREM+1(@06)                   1651 07127000
         MVI   BASDTREM(@06),C' '                                  1651 07128000
*   BASDESCR=BLANK30;               /* DESCRIPTION           @Y30LB25*/ 07129000
         MVI   BASDESCR+1(@06),C' '                                1652 07130000
         MVC   BASDESCR+2(28,@06),BASDESCR+1(@06)                  1652 07131000
         MVI   BASDESCR(@06),C' '                                  1652 07132000
*   BASDEST=BLANK30;                /* DESTINATION           @Y30LB25*/ 07133000
         MVI   BASDEST+1(@06),C' '                                 1653 07134000
         MVC   BASDEST+2(28,@06),BASDEST+1(@06)                    1653 07135000
         MVI   BASDEST(@06),C' '                                   1653 07136000
*   BASRECOV=BLANK6;                /* SER #                 @Y30LB25*/ 07137000
         MVI   BASRECOV+1(@06),C' '                                1654 07138000
         MVC   BASRECOV+2(4,@06),BASRECOV+1(@06)                   1654 07139000
         MVI   BASRECOV(@06),C' '                                  1654 07140000
*   BASGROUP=BLANK8;                /* GROUP                 @Y30LB25*/ 07141000
         MVI   BASGROUP+1(@06),C' '                                1655 07142000
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   1655 07143000
         MVI   BASGROUP(@06),C' '                                  1655 07144000
*   BASLEXT=FIX2FS;                 /* LARGE EXTENT          @Y30LB25*/ 07145000
         L     @15,@CF00672                                        1656 07146000
         STH   @15,BASLEXT(,@06)                                   1656 07147000
*   BASFRESP=FIX2FS;                /* FREE SPACE            @Y30LB25*/ 07148000
         STH   @15,BASFRESP(,@06)                                  1657 07149000
*   BASFREXT=FIX4FS;                /* FREE EXTENTS          @Y30LB25*/ 07150000
         MVC   BASFREXT(4,@06),@CF00677                            1658 07151000
*   BASBKLMT=FIXONE;                /* BACKUP LMT            @Y30LB25*/ 07152000
         MVI   BASBKLMT(@06),X'01'                                 1659 07153000
*   IF DEFOWNID(1:10)¬=FIX10ZRO     /* OWNER ID SPECIFD?     @Y30LB25*/ 07154000
*     THEN                          /* YES                   @Y30LB25*/ 07155000
         CLC   DEFOWNID(10,DEFVPTR),@CB00681                       1660 07156000
         BE    @RF01660                                            1660 07157000
*     BASOWNER=DEFOWNID;            /* SET OWNER             @Y30LB25*/ 07158000
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  1661 07159000
*   ELSE                            /* NO                    @Y30LB25*/ 07160000
*     BASOWNER=BLANK10;             /* NULL OWNER            @Y30LB25*/ 07161000
*                                                                  1662 07162000
         B     @RC01660                                            1662 07163000
@RF01660 L     @06,BASEVPTR                                        1662 07164000
         MVI   BASOWNER+1(@06),C' '                                1662 07165000
         MVC   BASOWNER+2(8,@06),BASOWNER+1(@06)                   1662 07166000
         MVI   BASOWNER(@06),C' '                                  1662 07167000
*   /*****************************************************************/ 07168000
*   /*                                                               */ 07169000
*   /* SET THE ATTRIBUTES                                    @Y30LB25*/ 07170000
*   /*                                                               */ 07171000
*   /*****************************************************************/ 07172000
*                                                                  1663 07173000
*   IF DEFVEXCL=ON                  /* EXCLUSIVE?            @Y30LB25*/ 07174000
*     THEN                          /* YES                   @Y30LB25*/ 07175000
@RC01660 TM    DEFVEXCL(DEFVPTR),B'00010000'                       1663 07176000
         BNO   @RF01663                                            1663 07177000
*     BASEXCL=ON;                   /* EXCLUSIVE             @Y30LB25*/ 07178000
         L     @06,BASEVPTR                                        1664 07179000
         OI    BASEXCL(@06),B'00000001'                            1664 07180000
*   IF DEFVBIND=ON                  /* BIND?                 @Y30LB25*/ 07181000
*     THEN                          /* YES                   @Y30LB25*/ 07182000
@RF01663 TM    DEFVBIND(DEFVPTR),B'00000100'                       1665 07183000
         BNO   @RF01665                                            1665 07184000
*     BASBIND=ON;                   /* BIND                  @Y30LB25*/ 07185000
         L     @06,BASEVPTR                                        1666 07186000
         OI    BASBIND(@06),B'00000010'                            1666 07187000
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/ 07188000
*     THEN                          /* YES                   @Y30LB25*/ 07189000
@RF01665 TM    DEFVWINH(DEFVPTR),B'00000010'                       1667 07190000
         BNO   @RF01667                                            1667 07191000
*     BASRONLY=ON;                  /* READ ONLY             @Y30LB25*/ 07192000
         L     @06,BASEVPTR                                        1668 07193000
         OI    BASRONLY(@06),B'01000000'                           1668 07194000
*   IF DEFVSEC=ON                   /* DASD ERASE?           @Y30LB25*/ 07195000
*     THEN                          /* YES                   @Y30LB25*/ 07196000
@RF01667 TM    DEFVSEC(DEFVPTR),B'00100000'                        1669 07197000
         BNO   @RF01669                                            1669 07198000
*     BASDAERA=ON;                  /* DASD ERASE            @Y30LB25*/ 07199000
*                                                                  1670 07200000
         L     @06,BASEVPTR                                        1670 07201000
         OI    BASDAERA(@06),B'10000000'                           1670 07202000
*   /*****************************************************************/ 07203000
*   /*                                                               */ 07204000
*   /* CHAIN BVR INTO NON-GROUP VOLUME RECORD                @Y30LB25*/ 07205000
*   /*                                                               */ 07206000
*   /*****************************************************************/ 07207000
*                                                                  1671 07208000
*   GRPFLG=OFF;                     /* NGVR                  @Y30LB25*/ 07209000
@RF01669 NI    GRPFLG,B'11101111'                                  1671 07210000
*   CALL VUCHI;                     /* CHAIN IN BVR          @Y30LB25*/ 07211000
         BAL   @14,VUCHI                                           1672 07212000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 07213000
*     THEN                          /* YES                   @Y30LB25*/ 07214000
         L     @06,RPLVPTR                                         1673 07215000
         LH    @06,RPLVRETC(,@06)                                  1673 07216000
         N     @06,@CF01129                                        1673 07217000
         LTR   @06,@06                                             1673 07218000
         BNZ   @RT01673                                            1673 07219000
*     RETURN;                       /*                       @Y30LB25*/ 07220000
*                                                                  1674 07221000
*   /*****************************************************************/ 07222000
*   /*                                                               */ 07223000
*   /* PROCESS THE DEFINEV EXTENSION.                        @Y30LB25*/ 07224000
*   /*                                                               */ 07225000
*   /*****************************************************************/ 07226000
*                                                                  1675 07227000
*   BCDVPTR=BASEVPTR;               /* SET COMM PTR          @Y30LB25*/ 07228000
         L     @06,BASEVPTR                                        1675 07229000
         ST    @06,BCDVPTR                                         1675 07230000
*   IF DEFVVEXT¬=FIXZERO            /* EXTENSION?            @Y30LB25*/ 07231000
*     THEN                                                         1676 07232000
         L     @06,DEFVVEXT(,DEFVPTR)                              1676 07233000
         LTR   @06,@06                                             1676 07234000
         BZ    @RF01676                                            1676 07235000
*     DO;                           /* YES                   @Y30LB25*/ 07236000
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/ 07237000
         BAL   @14,PRODEFVE                                        1678 07238000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 07239000
*         THEN                      /* YES                   @Y30LB25*/ 07240000
         L     @06,RPLVPTR                                         1679 07241000
         LH    @06,RPLVRETC(,@06)                                  1679 07242000
         N     @06,@CF01129                                        1679 07243000
         LTR   @06,@06                                             1679 07244000
         BNZ   @RT01679                                            1679 07245000
*         RETURN;                   /*                       @Y30LB25*/ 07246000
*     END;                          /*                       @Y30LB25*/ 07247000
*   ELSE                                                           1682 07248000
*     BCDIVCRE=ON;                  /*                       @Y30LB25*/ 07249000
*                                                                  1682 07250000
         B     @RC01676                                            1682 07251000
@RF01676 L     @06,BCDVPTR                                         1682 07252000
         OI    BCDIVCRE(@06),B'10000000'                           1682 07253000
*   /*****************************************************************/ 07254000
*   /*                                                               */ 07255000
*   /* REESTABLISH THE BVR'S RPLV                            @Y30LB25*/ 07256000
*   /*                                                               */ 07257000
*   /*****************************************************************/ 07258000
*                                                                  1683 07259000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 07260000
@RC01676 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1683 07261000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 07262000
         LA    @06,BKEY                                            1684 07263000
         L     @01,RPLVPTR                                         1684 07264000
         ST    @06,RPLVKEY(,@01)                                   1684 07265000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 07266000
         BAL   @14,READUPD1                                        1685 07267000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 07268000
*     THEN                          /* YES                   @Y30LB25*/ 07269000
         L     @06,RPLVPTR                                         1686 07270000
         LH    @15,RPLVRETC(,@06)                                  1686 07271000
         N     @15,@CF01129                                        1686 07272000
         LTR   @15,@15                                             1686 07273000
         BNZ   @RT01686                                            1686 07274000
*     RETURN;                       /*                       @Y30LB25*/ 07275000
*                                                                  1687 07276000
*   /*****************************************************************/ 07277000
*   /*                                                               */ 07278000
*   /* WRITE THE BVR                                         @Y30LB25*/ 07279000
*   /*                                                               */ 07280000
*   /*****************************************************************/ 07281000
*                                                                  1688 07282000
*   RPLVBUF=ADDR(BASEBUF);          /* PT TO BVR TO WRITE    @Y30LB25*/ 07283000
         LA    @15,BASEBUF                                         1688 07284000
         ST    @15,RPLVBUF(,@06)                                   1688 07285000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 07286000
         BAL   @14,WRITRECD                                        1689 07287000
*   RETURN;                         /*                       @Y30LB25*/ 07288000
@EL00040 DS    0H                                                  1690 07289000
@EF00040 DS    0H                                                  1690 07290000
@ER00040 L     @14,@SA00040                                        1690 07291000
         BR    @14                                                 1690 07292000
*   END CRTBVR;                     /*                       @Y30LB25*/ 07293000
         B     @EL00040                                            1691 07294000
*                                                                  1692 07295000
*   /*****************************************************************/ 07296000
*   /*                                                               */ 07297000
*   /* PROCEDURE NAME - CRTCVR2                              @Y30LB25*/ 07298000
*   /*                                                       @Y30LB25*/ 07299000
*   /* FUNCTION -                                            @Y30LB25*/ 07300000
*   /* MAKE A PLACE HOLDER CVR INTO A CVR AFTER THE MSC.     @Y30LB25*/ 07301000
*   /*                                                       @Y30LB25*/ 07302000
*   /* INPUT -                                               @Y30LB25*/ 07303000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 07304000
*   /* PLACE HOLDER COPY VOLUME RECORD                       @Y30LB25*/ 07305000
*   /*                                                       @Y30LB25*/ 07306000
*   /* OUTPUT -                                              @Y30LB25*/ 07307000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 07308000
*   /* AN ERROR                                              @Y30LB25*/ 07309000
*   /* COPY VOLUME RECORD                                    @Y30LB25*/ 07310000
*   /*                                                               */ 07311000
*   /*****************************************************************/ 07312000
*                                                                  1692 07313000
*CRTCVR2:                           /*                       @Y30LB25*/ 07314000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 07315000
*                                                                  1692 07316000
CRTCVR2  ST    @14,@SA00041                                        1692 07317000
*   /*****************************************************************/ 07318000
*   /*                                                               */ 07319000
*   /* PROCESS THE DEFINE EXTENSION                          @Y30LB25*/ 07320000
*   /*                                                               */ 07321000
*   /*****************************************************************/ 07322000
*                                                                  1693 07323000
*   BCDVPTR=COPYVPTR;               /* SET COMM PTR          @Y30LB25*/ 07324000
         L     @06,COPYVPTR                                        1693 07325000
         ST    @06,BCDVPTR                                         1693 07326000
*   COPHOLD=OFF;                    /*                       @Y30LB25*/ 07327000
         NI    COPHOLD(@06),B'01111111'                            1694 07328000
*   IF DEFVVEXT¬=FIXZERO            /* DEFINE EXTENSION?     @Y30LB25*/ 07329000
*     THEN                          /* YES                   @Y30LB25*/ 07330000
         L     @06,DEFVVEXT(,DEFVPTR)                              1695 07331000
         LTR   @06,@06                                             1695 07332000
         BZ    @RF01695                                            1695 07333000
*     DO;                           /*                       @Y30LB25*/ 07334000
*       CALL PRODEFVE;              /* PROC DEFVE            @Y30LB25*/ 07335000
         BAL   @14,PRODEFVE                                        1697 07336000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 07337000
*         THEN                      /* YES                   @Y30LB25*/ 07338000
         L     @06,RPLVPTR                                         1698 07339000
         LH    @06,RPLVRETC(,@06)                                  1698 07340000
         N     @06,@CF01129                                        1698 07341000
         LTR   @06,@06                                             1698 07342000
         BNZ   @RT01698                                            1698 07343000
*         RETURN;                   /*                       @Y30LB25*/ 07344000
*     END;                          /*                       @Y30LB25*/ 07345000
*   ELSE                                                           1701 07346000
*     BCDIVCPY=ON;                  /*                       @Y30LB25*/ 07347000
*                                                                  1701 07348000
         B     @RC01695                                            1701 07349000
@RF01695 L     @06,BCDVPTR                                         1701 07350000
         OI    BCDIVCPY(@06),B'01000000'                           1701 07351000
*   /*****************************************************************/ 07352000
*   /*                                                               */ 07353000
*   /* REESTABLISH THE CVR'S RPLV                            @Y30LB25*/ 07354000
*   /*                                                               */ 07355000
*   /*****************************************************************/ 07356000
*                                                                  1702 07357000
*   CKEY=COPNAME;                   /* SET KEY               @Y30LB25*/ 07358000
@RC01695 L     @06,COPYVPTR                                        1702 07359000
         MVC   CKEY(13),COPNAME(@06)                               1702 07360000
*   RPLVKEY=ADDR(CKEY);             /* KEY ADDR              @Y30LB25*/ 07361000
         LA    @06,CKEY                                            1703 07362000
         L     @01,RPLVPTR                                         1703 07363000
         ST    @06,RPLVKEY(,@01)                                   1703 07364000
*   CALL READUPD1;                  /* READ CVR              @Y30LB25*/ 07365000
         BAL   @14,READUPD1                                        1704 07366000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 07367000
*     THEN                          /* YES                   @Y30LB25*/ 07368000
         L     @06,RPLVPTR                                         1705 07369000
         LH    @15,RPLVRETC(,@06)                                  1705 07370000
         N     @15,@CF01129                                        1705 07371000
         LTR   @15,@15                                             1705 07372000
         BNZ   @RT01705                                            1705 07373000
*     RETURN;                       /*                       @Y30LB25*/ 07374000
*                                                                  1706 07375000
*   /*****************************************************************/ 07376000
*   /*                                                               */ 07377000
*   /* WRITE THE CVR                                         @Y30LB25*/ 07378000
*   /*                                                               */ 07379000
*   /*****************************************************************/ 07380000
*                                                                  1707 07381000
*   RPLVBUF=COPYVPTR;               /*                       @Y30LB25*/ 07382000
         L     @15,COPYVPTR                                        1707 07383000
         ST    @15,RPLVBUF(,@06)                                   1707 07384000
*   CALL WRITRECD;                  /* WRITE CVR             @Y30LB25*/ 07385000
         BAL   @14,WRITRECD                                        1708 07386000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 07387000
*     THEN                          /* YES                   @Y30LB25*/ 07388000
         L     @06,RPLVPTR                                         1709 07389000
         LH    @06,RPLVRETC(,@06)                                  1709 07390000
         N     @06,@CF01129                                        1709 07391000
         LTR   @06,@06                                             1709 07392000
         BNZ   @RT01709                                            1709 07393000
*     RETURN;                       /*                       @Y30LB25*/ 07394000
*                                                                  1710 07395000
*   /*****************************************************************/ 07396000
*   /*                                                               */ 07397000
*   /* PROCESS THE CVR'S BVR.                                @Y30LB25*/ 07398000
*   /*                                                               */ 07399000
*   /*****************************************************************/ 07400000
*                                                                  1711 07401000
*   ADDSUB=ON;                      /* ADD A CVR             @Y30LB25*/ 07402000
         OI    ADDSUB,B'01000000'                                  1711 07403000
*   CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*              @Y30LB25   07404000
*                                      UPDT CVR'S BVR        @Y30LB25*/ 07405000
         L     @15,@CV00769                                        1712 07406000
         LA    @01,@AL01712                                        1712 07407000
         BALR  @14,@15                                             1712 07408000
*   RETURN;                         /*                       @Y30LB25*/ 07409000
@EL00041 DS    0H                                                  1713 07410000
@EF00041 DS    0H                                                  1713 07411000
@ER00041 L     @14,@SA00041                                        1713 07412000
         BR    @14                                                 1713 07413000
*   END CRTCVR2;                    /*                       @Y30LB25*/ 07414000
         B     @EL00041                                            1714 07415000
*                                                                  1715 07416000
*   /*****************************************************************/ 07417000
*   /*                                                               */ 07418000
*   /* PROCEDURE NAME - FNDCVRUP                             @Y30LB25*/ 07419000
*   /*                                                       @Y30LB25*/ 07420000
*   /* FUNCTION -                                            @Y30LB25*/ 07421000
*   /* FIND THE PLACE HOLDER CVR CREATED BEFORE THE          @Y30LB25*/ 07422000
*   /* MSC WAS CALLED.                                       @Y30LB25*/ 07423000
*   /*                                                       @Y30LB25*/ 07424000
*   /* INPUT -                                               @Y30LB25*/ 07425000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 07426000
*   /*                                                       @Y30LB25*/ 07427000
*   /* OUTPUT -                                              @Y30LB25*/ 07428000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 07429000
*   /* AN ERROR                                              @Y30LB25*/ 07430000
*   /* COPY VOLUME RECORD (PLACE HOLDER)                     @Y30LB25*/ 07431000
*   /*                                                               */ 07432000
*   /*****************************************************************/ 07433000
*                                                                  1715 07434000
*FNDCVRUP:                          /*                       @Y30LB25*/ 07435000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 07436000
*                                                                  1715 07437000
FNDCVRUP ST    @14,@SA00042                                        1715 07438000
*   /*****************************************************************/ 07439000
*   /*                                                               */ 07440000
*   /* FIND THE PLACE HOLDER CVR                             @Y30LB25*/ 07441000
*   /*                                                               */ 07442000
*   /*****************************************************************/ 07443000
*                                                                  1716 07444000
*   CVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 07445000
         MVC   CVOLKY(6),DEFVOLD(DEFVPTR)                          1716 07446000
*   CIDKY=FIXONE;                   /* ID = 1                @Y30LB25*/ 07447000
         LA    @06,1                                               1717 07448000
         STC   @06,CIDKY                                           1717 07449000
*   RPLVKEY=ADDR(CKEY);             /* KEY ADDR              @Y30LB25*/ 07450000
         L     @15,RPLVPTR                                         1718 07451000
         LA    @14,CKEY                                            1718 07452000
         ST    @14,RPLVKEY(,@15)                                   1718 07453000
*   RPLVBUF=ADDR(COPYBUF);          /* CVR BUFFER            @Y30LB25*/ 07454000
         LA    @14,COPYBUF                                         1719 07455000
         ST    @14,RPLVBUF(,@15)                                   1719 07456000
*   RPLVBLN=LENGTH(COPYBUF);        /* CVR BUF LENGTH        @Y30LB25*/ 07457000
         MVC   RPLVBLN(4,@15),@CF01103                             1720 07458000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 07459000
         MVI   RPLVTYP(@15),X'00'                                  1721 07460000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 07461000
         OI    RPLVDIR(@15),B'01000000'                            1722 07462000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 07463000
         OI    RPLVUPD(@15),B'00000010'                            1723 07464000
*   A=CIDKY;                        /* LOOP CONTROL          @Y30LB25*/ 07465000
         ST    @06,A                                               1724 07466000
*   DO CIDKY=A BY 1 TO 255;         /* FIND CVR              @Y30LB25*/ 07467000
         STC   @06,CIDKY                                           1725 07468000
         B     @DE01725                                            1725 07469000
@DL01725 DS    0H                                                  1726 07470000
*     RESPECIFY                                                    1726 07471000
*       RG1 RSTD;                   /* RESTRICT REG 1        @Y30LB25*/ 07472000
*     RG1=RPLVPTR;                  /* PT TO RPLV            @Y30LB25*/ 07473000
         L     RG1,RPLVPTR                                         1727 07474000
*     CALL ICBVIO00;                /* READ CVR              @Y30LB25*/ 07475000
         L     @15,@CV00762                                        1728 07476000
         BALR  @14,@15                                             1728 07477000
*     RESPECIFY                                                    1729 07478000
*       RG1 UNRSTD;                 /* UNRESTRICT REG 1      @Y30LB25*/ 07479000
*                                                                  1729 07480000
*     /***************************************************************/ 07481000
*     /*                                                             */ 07482000
*     /* CHECK FOR PLACE HOLDER CVR OR AN I/0 ERROR          @Y30LB25*/ 07483000
*     /* OR END OF DATA.                                     @Y30LB25*/ 07484000
*     /*                                                             */ 07485000
*     /***************************************************************/ 07486000
*                                                                  1730 07487000
*     IF(RPLVRETC¬=FIXZERO&RPLRCODE¬=NORECFND)|(RPLVRETC=FIXZERO&  1730 07488000
*         COPHOLD=ON)               /* CHECK VALID RETURN    @Y30LB25*/ 07489000
*       THEN                                                       1730 07490000
         L     @06,RPLVPTR                                         1730 07491000
         LH    @15,RPLVRETC(,@06)                                  1730 07492000
         N     @15,@CF01129                                        1730 07493000
         LTR   @15,@15                                             1730 07494000
         BZ    @GL00078                                            1730 07495000
         CLC   RPLRCODE(2,@06),@CB00711                            1730 07496000
         BNE   @RT01730                                            1730 07497000
@GL00078 L     @06,RPLVPTR                                         1730 07498000
         LH    @06,RPLVRETC(,@06)                                  1730 07499000
         N     @06,@CF01129                                        1730 07500000
         LTR   @06,@06                                             1730 07501000
         BNZ   @RF01730                                            1730 07502000
         L     @06,COPYVPTR                                        1730 07503000
         TM    COPHOLD(@06),B'10000000'                            1730 07504000
         BO    @RT01730                                            1730 07505000
*       RETURN;                     /*                       @Y30LB25*/ 07506000
*   END;                            /*                       @Y30LB25*/ 07507000
*                                                                  1732 07508000
@RF01730 LA    @06,1                                               1732 07509000
         SLR   @15,@15                                             1732 07510000
         IC    @15,CIDKY                                           1732 07511000
         ALR   @06,@15                                             1732 07512000
         STC   @06,CIDKY                                           1732 07513000
@DE01725 C     @06,@CF00668                                        1732 07514000
         BNH   @DL01725                                            1732 07515000
*   /*****************************************************************/ 07516000
*   /*                                                               */ 07517000
*   /* NO CVR PLACE HOLDER WAS FOUND                         @Y30LB25*/ 07518000
*   /* OCCURRED                                              @Y30LB25*/ 07519000
*   /*                                                               */ 07520000
*   /*****************************************************************/ 07521000
*                                                                  1733 07522000
*   RPLVRETC=FIXFOUR;               /* ERROR RETURN CODE     @Y30LB25*/ 07523000
         L     @06,RPLVPTR                                         1733 07524000
         MVC   RPLVRETC(2,@06),@CH00041                            1733 07525000
*   RPLRCODE=NORECFND;              /* ERROR REASON CODE     @Y30LB25*/ 07526000
         MVC   RPLRCODE(2,@06),@CB00711                            1734 07527000
*   RETURN;                         /*                       @Y30LB25*/ 07528000
@EL00042 DS    0H                                                  1735 07529000
@EF00042 DS    0H                                                  1735 07530000
@ER00042 L     @14,@SA00042                                        1735 07531000
         BR    @14                                                 1735 07532000
*   END FNDCVRUP;                   /*                       @Y30LB25*/ 07533000
         B     @EL00042                                            1736 07534000
*                                                                  1737 07535000
*   /*****************************************************************/ 07536000
*   /*                                                               */ 07537000
*   /* PROCEDURE NAME - ACINACV2                             #Y30LB25*/ 07538000
*   /*                                                       @Y30LB25*/ 07539000
*   /* FUNCTION -                                            @Y30LB25*/ 07540000
*   /* TRANSFER DATA FROM AN ACTIVE TO AN INACTIVE VOLUME    @Y30LB25*/ 07541000
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/ 07542000
*   /* AN ICBCOVC EXTENSION IS REQUIRED.                     @Y30LB25*/ 07543000
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY  @Y30LB25*/ 07544000
*   /*                                                       @Y30LB25*/ 07545000
*   /* INPUT -                                               @Y30LB25*/ 07546000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 07547000
*   /*                                                       @Y30LB25*/ 07548000
*   /* OUTPUT -                                              @Y30LB25*/ 07549000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 07550000
*   /* AN ERROR                                              @Y30LB25*/ 07551000
*   /*                                                               */ 07552000
*   /*****************************************************************/ 07553000
*                                                                  1737 07554000
*ACINACV2:                          /*                       @Y30LB25*/ 07555000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 07556000
ACINACV2 ST    @14,@SA00043                                        1737 07557000
*   IF RPLRCODE¬=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 07558000
*     THEN                          /* YES                   @Y30LB25*/ 07559000
         L     @06,RPLVPTR                                         1738 07560000
         LH    @15,RPLRCODE(,@06)                                  1738 07561000
         N     @15,@CF01129                                        1738 07562000
         LTR   @15,@15                                             1738 07563000
         BZ    @RF01738                                            1738 07564000
*     DO;                           /*                       @Y30LB25*/ 07565000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 07566000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1740 07567000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 07568000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1741 07569000
*       RETURN;                     /*                       @Y30LB25*/ 07570000
@EL00043 DS    0H                                                  1742 07571000
@EF00043 DS    0H                                                  1742 07572000
@ER00043 L     @14,@SA00043                                        1742 07573000
         BR    @14                                                 1742 07574000
*     END;                          /*                       @Y30LB25*/ 07575000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   07576000
*                                      RESERVE .MSVI         @Y30LB25*/ 07577000
*                                                                  1744 07578000
@RF01738 BAL   @14,HOUSKEEP                                        1744 07579000
*   /*****************************************************************/ 07580000
*   /*                                                               */ 07581000
*   /* READ FOR CIR TO GET THE MSVC RECORD.                  @Y30LB25*/ 07582000
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    @Y30LB25*/ 07583000
*   /* FOR UPDATE                                            @Y30LB25*/ 07584000
*   /*                                                               */ 07585000
*   /*****************************************************************/ 07586000
*                                                                  1745 07587000
*   IVOLKY=CVOLCSN;                 /* SET UP KEY            @Y30LB25*/ 07588000
         L     @06,CVOLPTR                                         1745 07589000
         MVC   IVOLKY(12),CVOLCSN(@06)                             1745 07590000
*   CALL GETRECUD;                  /* GET RECORD            @Y30LB25*/ 07591000
         BAL   @14,GETRECUD                                        1746 07592000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 07593000
*     THEN                          /* YES                   @Y30LB25*/ 07594000
         L     @06,RPLVPTR                                         1747 07595000
         LH    @06,RPLVRETC(,@06)                                  1747 07596000
         N     @06,@CF01129                                        1747 07597000
         LTR   @06,@06                                             1747 07598000
         BNZ   @RT01747                                            1747 07599000
*     RETURN;                       /*                       @Y30LB25*/ 07600000
*                                                                  1748 07601000
*   /*****************************************************************/ 07602000
*   /*                                                               */ 07603000
*   /* CHECK IF A COPY VOLUME RECORD WAS CREATED BY A        @Y30LB25*/ 07604000
*   /* PREVIOUS CREATE AN INACTIVE VOLUME REQUEST.           @Y30LB25*/ 07605000
*   /*                                                               */ 07606000
*   /*****************************************************************/ 07607000
*                                                                  1749 07608000
*   IF CVOLVEXT¬=FIXZERO&COVREUSE=OFF/* DON'T REUSE OLD      @Y30LB25   07609000
*                                      CVR?                  @Y30LB25*/ 07610000
*     THEN                          /* YES                   @Y30LB25*/ 07611000
         L     @06,CVOLPTR                                         1749 07612000
         L     @06,CVOLVEXT(,@06)                                  1749 07613000
         LTR   @06,@06                                             1749 07614000
         BZ    @RF01749                                            1749 07615000
         L     @06,COVCEPTR                                        1749 07616000
         TM    COVREUSE(@06),B'01000000'                           1749 07617000
         BNZ   @RF01749                                            1749 07618000
*     DO;                           /*                       @Y30LB25*/ 07619000
*       COPYBUF=BASEBUF;            /* PLACE CVR IN BUF      @Y30LB25*/ 07620000
         MVC   COPYBUF(224),BASEBUF                                1751 07621000
*       BCDVPTR=COPYVPTR;           /* COMMON MAP            @Y30LB25*/ 07622000
         L     @06,COPYVPTR                                        1752 07623000
         ST    @06,BCDVPTR                                         1752 07624000
*       CALL PROCOVCE;              /* PROCESS COVC EXTEN    @Y30LB25*/ 07625000
         BAL   @14,PROCOVCE                                        1753 07626000
*       BVOLKY=COPSERNO;            /* SERIAL NUMBER         @ZDR2054*/ 07627000
         L     @06,COPYVPTR                                        1754 07628000
         MVC   BVOLKY(6),COPSERNO(@06)                             1754 07629000
*       RPLVKEY=ADDR(BKEY);         /* KEY ADDR              @ZDR2054*/ 07630000
         LA    @06,BKEY                                            1755 07631000
         L     @01,RPLVPTR                                         1755 07632000
         ST    @06,RPLVKEY(,@01)                                   1755 07633000
*       CALL READLOC;               /* READ BVR              @ZDR2054*/ 07634000
         BAL   @14,READLOC                                         1756 07635000
*       IF RPLVRETC¬=FIXZERO THEN   /* ERROR?                @ZDR2054*/ 07636000
         L     @06,RPLVPTR                                         1757 07637000
         LH    @15,RPLVRETC(,@06)                                  1757 07638000
         N     @15,@CF01129                                        1757 07639000
         LTR   @15,@15                                             1757 07640000
         BNZ   @RT01757                                            1757 07641000
*         RETURN;                   /* YES                   @ZDR2054*/ 07642000
*       BASEVPTR=RPLVBUF;           /* SET BUF PTR           @ZDR2054*/ 07643000
         L     @06,RPLVBUF(,@06)                                   1759 07644000
         ST    @06,BASEVPTR                                        1759 07645000
*       COPFRESP=BASFRESP;          /* # FREE CYLANDERS      @ZDR2054*/ 07646000
         L     @15,COPYVPTR                                        1760 07647000
         LH    @14,BASFRESP(,@06)                                  1760 07648000
         N     @14,@CF01129                                        1760 07649000
         STH   @14,COPFRESP(,@15)                                  1760 07650000
*       COPLEXT=BASLEXT;            /* # CYL IN LARGEST      @ZDR2054   07651000
*                                      FREE EXTENT           @ZDR2054*/ 07652000
         LH    @14,BASLEXT(,@06)                                   1761 07653000
         N     @14,@CF01129                                        1761 07654000
         STH   @14,COPLEXT(,@15)                                   1761 07655000
*       COPFREXT=BASFREXT;          /* # FREE EXTENTS        @ZDR2054*/ 07656000
         L     @14,BASFREXT(,@06)                                  1762 07657000
         ST    @14,COPFREXT(,@15)                                  1762 07658000
*       IF BASDLSF=ON THEN          /* DOWN LEVEL SPACE?     @ZDR2054*/ 07659000
         TM    BASDLSF(@06),B'10000000'                            1763 07660000
         BNO   @RF01763                                            1763 07661000
*         COPDLSPF=ON;              /* YES                   @ZDR2054*/ 07662000
         OI    COPDLSPF(@15),B'01000000'                           1764 07663000
*       IVOLKY=CVOLCSN;             /* GET CVR               @ZDR2054*/ 07664000
@RF01763 L     @06,CVOLPTR                                         1765 07665000
         MVC   IVOLKY(12),CVOLCSN(@06)                             1765 07666000
*       CALL GETRECUD;              /* READ UPDATE           @ZDR2054*/ 07667000
         BAL   @14,GETRECUD                                        1766 07668000
*       IF RPLVRETC¬=FIXZERO THEN   /* ERROR?                @ZDR2054*/ 07669000
         L     @06,RPLVPTR                                         1767 07670000
         LH    @15,RPLVRETC(,@06)                                  1767 07671000
         N     @15,@CF01129                                        1767 07672000
         LTR   @15,@15                                             1767 07673000
         BNZ   @RT01767                                            1767 07674000
*         RETURN;                   /* YES                   @ZDR2054*/ 07675000
*       RPLVBUF=ADDR(COPYBUF);      /* SET CVR BUF PTR       @Y30LB25*/ 07676000
         LA    @15,COPYBUF                                         1769 07677000
         ST    @15,RPLVBUF(,@06)                                   1769 07678000
*       CALL WRITRECD;              /* WRITE CVR             @Y30LB25*/ 07679000
         BAL   @14,WRITRECD                                        1770 07680000
*       RETURN;                     /*                       @Y30LB25*/ 07681000
         B     @EL00043                                            1771 07682000
*     END;                          /*                       @Y30LB25*/ 07683000
*                                                                  1772 07684000
*   /*****************************************************************/ 07685000
*   /*                                                               */ 07686000
*   /* NO COPY VOLUME RECORD WAS PREVIOUSLY CREATED.         @Y30LB25*/ 07687000
*   /*                                                               */ 07688000
*   /*****************************************************************/ 07689000
*                                                                  1773 07690000
*   ELSE                            /* REUSE OLD CVR         @Y30LB25*/ 07691000
*     DO;                           /*                       @Y30LB25*/ 07692000
@RF01749 DS    0H                                                  1774 07693000
*       RPLVTYP=RPLVDEL;            /* DELETE OLD CVR        @Y30LB25*/ 07694000
         L     @06,RPLVPTR                                         1774 07695000
         MVI   RPLVTYP(@06),X'05'                                  1774 07696000
*       RESPECIFY                                                  1775 07697000
*         RG1 RSTD;                 /*                       @Y30LB25*/ 07698000
*       RG1=RPLVPTR;                /* SET RPLV PTR          @Y30LB25*/ 07699000
         LR    RG1,@06                                             1776 07700000
*       CALL ICBVIO00;              /* DELETE CVR            @Y30LB25*/ 07701000
         L     @15,@CV00762                                        1777 07702000
         BALR  @14,@15                                             1777 07703000
*       RESPECIFY                                                  1778 07704000
*         RG1 UNRSTD;               /*                       @Y30LB25*/ 07705000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 07706000
*         THEN                      /* YES                   @Y30LB25*/ 07707000
         L     @06,RPLVPTR                                         1779 07708000
         LH    @06,RPLVRETC(,@06)                                  1779 07709000
         N     @06,@CF01129                                        1779 07710000
         LTR   @06,@06                                             1779 07711000
         BNZ   @RT01779                                            1779 07712000
*         RETURN;                   /*                       @Y30LB25*/ 07713000
*                                                                  1780 07714000
*       /*************************************************************/ 07715000
*       /*                                                           */ 07716000
*       /* UPDATE CVR'S BVR TO REFLECT ITS DELETION.         @Y30LB25*/ 07717000
*       /*                                                           */ 07718000
*       /*************************************************************/ 07719000
*                                                                  1781 07720000
*       ADDSUB=OFF;                 /* CVR DELETED           @Y30LB25*/ 07721000
         NI    ADDSUB,B'10111111'                                  1781 07722000
*       COPYBUF=BASEBUF;            /* CVR IN CVR BUF        @Y30LB25*/ 07723000
         MVC   COPYBUF(224),BASEBUF                                1782 07724000
*       CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*          @Y30LB25   07725000
*                                      UPDATE BVR            @Y30LB25*/ 07726000
         L     @15,@CV00769                                        1783 07727000
         LA    @01,@AL01783                                        1783 07728000
         BALR  @14,@15                                             1783 07729000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 07730000
*         THEN                      /* YES                   @Y30LB25*/ 07731000
         L     @06,RPLVPTR                                         1784 07732000
         LH    @15,RPLVRETC(,@06)                                  1784 07733000
         N     @15,@CF01129                                        1784 07734000
         LTR   @15,@15                                             1784 07735000
         BNZ   @RT01784                                            1784 07736000
*         RETURN;                   /*                       @Y30LB25*/ 07737000
*                                                                  1785 07738000
*       /*************************************************************/ 07739000
*       /*                                                           */ 07740000
*       /* GET CVR'S BVR FOR KEY OF NEXT AVAILABLE CVR       @Y30LB25*/ 07741000
*       /*                                                           */ 07742000
*       /*************************************************************/ 07743000
*                                                                  1786 07744000
*       BVOLKY=COPSERNO;            /* BVR VOLID KEY         @Y30LB25*/ 07745000
         L     @01,COPYVPTR                                        1786 07746000
         MVC   BVOLKY(6),COPSERNO(@01)                             1786 07747000
*       RPLVKEY=ADDR(BKEY);         /* KEY ADDR              @Y30LB25*/ 07748000
         LA    @15,BKEY                                            1787 07749000
         ST    @15,RPLVKEY(,@06)                                   1787 07750000
*       CALL READLOC;               /* GET BVR               @Y30LB25*/ 07751000
         BAL   @14,READLOC                                         1788 07752000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 07753000
*         THEN                      /* YES                   @Y30LB25*/ 07754000
         L     @06,RPLVPTR                                         1789 07755000
         LH    @15,RPLVRETC(,@06)                                  1789 07756000
         N     @15,@CF01129                                        1789 07757000
         LTR   @15,@15                                             1789 07758000
         BNZ   @RT01789                                            1789 07759000
*         RETURN;                   /*                       @Y30LB25*/ 07760000
*       BASEVPTR=RPLVBUF;           /* MAP BVR               @Y30LB25*/ 07761000
*                                                                  1791 07762000
         L     @06,RPLVBUF(,@06)                                   1791 07763000
         ST    @06,BASEVPTR                                        1791 07764000
*       /*************************************************************/ 07765000
*       /*                                                           */ 07766000
*       /* CALCULATE THE KEY FOR THE NEXT CVR.               @Y30LB25*/ 07767000
*       /*                                                           */ 07768000
*       /*************************************************************/ 07769000
*                                                                  1792 07770000
*       CALL CALCVRID;              /* GET ID                @Y30LB25*/ 07771000
         BAL   @14,CALCVRID                                        1792 07772000
*       IF RPLVRETC¬=FIXZERO&RPLRCODE¬=NORECFND/*            @Y30LB25   07773000
*                                      ERROR?                @Y30LB25*/ 07774000
*         THEN                      /* YES                   @Y30LB25*/ 07775000
         L     @06,RPLVPTR                                         1793 07776000
         LH    @15,RPLVRETC(,@06)                                  1793 07777000
         N     @15,@CF01129                                        1793 07778000
         LTR   @15,@15                                             1793 07779000
         BZ    @RF01793                                            1793 07780000
         CLC   RPLRCODE(2,@06),@CB00711                            1793 07781000
         BNE   @RT01793                                            1793 07782000
*         RETURN;                   /*                       @Y30LB25*/ 07783000
*       COPYVPTR=ADDR(COPYBUF);     /* RESET BUF PTR         @Y30LB25*/ 07784000
*                                                                  1795 07785000
@RF01793 LA    @06,COPYBUF                                         1795 07786000
         ST    @06,COPYVPTR                                        1795 07787000
*       /*************************************************************/ 07788000
*       /*                                                           */ 07789000
*       /* USE CVR IN THE CVR BUFFER TO CREATE               @Y30LB25*/ 07790000
*       /* THE NEW CVR.                                      @Y30LB25*/ 07791000
*       /*                                                           */ 07792000
*       /*************************************************************/ 07793000
*                                                                  1796 07794000
*       COPNO=CIDKY;                /* SET NEW ID            @Y30LB25*/ 07795000
         IC    @15,CIDKY                                           1796 07796000
         STC   @15,COPNO(,@06)                                     1796 07797000
*       COPBKUP=OFF;                /* NO BACKUP             @Y30LB25*/ 07798000
         NI    COPBKUP(@06),B'11110111'                            1797 07799000
*       COPDESCR=BLANK30;           /* NULL DESCR            @Y30LB25*/ 07800000
*                                                                  1798 07801000
         MVI   COPDESCR+1(@06),C' '                                1798 07802000
         MVC   COPDESCR+2(28,@06),COPDESCR+1(@06)                  1798 07803000
         MVI   COPDESCR(@06),C' '                                  1798 07804000
*       /*************************************************************/ 07805000
*       /*                                                           */ 07806000
*       /* CHECK FOR RECOVERY AND IF SO USE THE DATE         @ZA13484*/ 07807000
*       /* THE RPLV WAS CREATED.                             @ZA13484*/ 07808000
*       /*                                                           */ 07809000
*       /*************************************************************/ 07810000
*                                                                  1799 07811000
*       IF RPLJRCVY=ON&RPLVDATE¬=NULLDATE THEN/* RECOVERY?   @ZA13484*/ 07812000
         L     @15,RPLVPTR                                         1799 07813000
         TM    RPLJRCVY(@15),B'00000010'                           1799 07814000
         BNO   @RF01799                                            1799 07815000
         CLC   RPLVDATE(4,@15),NULLDATE                            1799 07816000
         BE    @RF01799                                            1799 07817000
*         COPDATE=RPLVDATE;         /* DATE                  @ZA13484*/ 07818000
         MVC   COPDATE(4,@06),RPLVDATE(@15)                        1800 07819000
*       ELSE                                                       1801 07820000
*         DO;                       /*                       @ZA13484*/ 07821000
*                                                                  1801 07822000
         B     @RC01799                                            1801 07823000
@RF01799 DS    0H                                                  1802 07824000
*           /*********************************************************/ 07825000
*           /*                                                       */ 07826000
*           /* GET AN SET CURRENT DATE                       @Y30LB25*/ 07827000
*           /*                                                       */ 07828000
*           /*********************************************************/ 07829000
*                                                                  1802 07830000
*           CALL ICBVUEXP(FIXZERO,RPLVPRT,EXPRDT);/*         @ZA30662*/ 07831000
         L     @15,@CV00768                                        1802 07832000
         LA    @01,@AL01802                                        1802 07833000
         BALR  @14,@15                                             1802 07834000
*           COPDATE=EXPRDT;         /* SET CURRENT DATE      @Y30LB25*/ 07835000
         L     @06,COPYVPTR                                        1803 07836000
         MVC   COPDATE(4,@06),EXPRDT                               1803 07837000
*         END;                      /*                       @ZA13484*/ 07838000
*                                                                  1804 07839000
*       /*************************************************************/ 07840000
*       /*                                                           */ 07841000
*       /* SET GROUPED OR NON-GROUPED                        @Y30LB25*/ 07842000
*       /*                                                           */ 07843000
*       /*************************************************************/ 07844000
*                                                                  1805 07845000
*       IF BASGRPV=ON               /* GROUPED?              @Y30LB25*/ 07846000
*         THEN                      /* YES                   @Y30LB25*/ 07847000
@RC01799 L     @06,BASEVPTR                                        1805 07848000
         TM    BASGRPV(@06),B'00100000'                            1805 07849000
         BNO   @RF01805                                            1805 07850000
*         COPGROUP=ON;              /* GROUPED               @Y30LB25*/ 07851000
         L     @06,COPYVPTR                                        1806 07852000
         OI    COPGROUP(@06),B'10000000'                           1806 07853000
*       ELSE                        /* NON-GRPD              @Y30LB25*/ 07854000
*         COPGROUP=OFF;             /*                       @Y30LB25*/ 07855000
*                                                                  1807 07856000
         B     @RC01805                                            1807 07857000
@RF01805 L     @06,COPYVPTR                                        1807 07858000
         NI    COPGROUP(@06),B'01111111'                           1807 07859000
*       /*************************************************************/ 07860000
*       /*                                                           */ 07861000
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/ 07862000
*       /*                                                           */ 07863000
*       /*************************************************************/ 07864000
*                                                                  1808 07865000
*       IF BASGENUS=ON              /* GEN-USE               @Y30LB25*/ 07866000
*         THEN                      /* YES                   @Y30LB25*/ 07867000
@RC01805 L     @06,BASEVPTR                                        1808 07868000
         TM    BASGENUS(@06),B'00010000'                           1808 07869000
         BNO   @RF01808                                            1808 07870000
*         COPGENUS=ON;              /*                       @Y30LB25*/ 07871000
         L     @06,COPYVPTR                                        1809 07872000
         OI    COPGENUS(@06),B'00100000'                           1809 07873000
*       ELSE                        /* NO GEN-USE            @Y30LB25*/ 07874000
*         COPGENUS=OFF;             /*                       @Y30LB25*/ 07875000
*                                                                  1810 07876000
         B     @RC01808                                            1810 07877000
@RF01808 L     @06,COPYVPTR                                        1810 07878000
         NI    COPGENUS(@06),B'11011111'                           1810 07879000
*       /*************************************************************/ 07880000
*       /*                                                           */ 07881000
*       /* CHECK FOR RESTRICTED                              @Y30LB25*/ 07882000
*       /*                                                           */ 07883000
*       /*************************************************************/ 07884000
*                                                                  1811 07885000
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 07886000
*         THEN                      /* YES                   @Y30LB25*/ 07887000
@RC01808 L     @06,BASEVPTR                                        1811 07888000
         TM    BASRSTD(@06),B'00001000'                            1811 07889000
         BNO   @RF01811                                            1811 07890000
*         COPRSTD=ON;               /* RESTRICTED            @Y30LB25*/ 07891000
         L     @06,COPYVPTR                                        1812 07892000
         OI    COPRSTD(@06),B'00010000'                            1812 07893000
*       ELSE                        /* NOT RESTRICTED        @Y30LB25*/ 07894000
*         COPRSTD=OFF;              /*                       @Y30LB25*/ 07895000
*                                                                  1813 07896000
         B     @RC01811                                            1813 07897000
@RF01811 L     @06,COPYVPTR                                        1813 07898000
         NI    COPRSTD(@06),B'11101111'                            1813 07899000
*       /*************************************************************/ 07900000
*       /*                                                           */ 07901000
*       /* CHECK FOR DOWN LEVEL SPACE                        @Y30LB25*/ 07902000
*       /*                                                           */ 07903000
*       /*************************************************************/ 07904000
*                                                                  1814 07905000
*       IF BASDLSF=ON               /* DOWN LEVEL SPACE?     @Y30LB25*/ 07906000
*         THEN                      /* YES                   @Y30LB25*/ 07907000
@RC01811 L     @06,BASEVPTR                                        1814 07908000
         TM    BASDLSF(@06),B'10000000'                            1814 07909000
         BNO   @RF01814                                            1814 07910000
*         COPDLSPF=ON;              /* DOWN LEVEL SPACE      @Y30LB25*/ 07911000
         L     @06,COPYVPTR                                        1815 07912000
         OI    COPDLSPF(@06),B'01000000'                           1815 07913000
*       ELSE                        /* NO DOWN SPACE         @Y30LB25*/ 07914000
*         COPDLSPF=OFF;             /*                       @Y30LB25*/ 07915000
*                                                                  1816 07916000
         B     @RC01814                                            1816 07917000
@RF01814 L     @06,COPYVPTR                                        1816 07918000
         NI    COPDLSPF(@06),B'10111111'                           1816 07919000
*       /*************************************************************/ 07920000
*       /*                                                           */ 07921000
*       /* SET SPACE REQUIRMENTS                             @Y30LB25*/ 07922000
*       /*                                                           */ 07923000
*       /*************************************************************/ 07924000
*                                                                  1817 07925000
*       COPFRESP=BASFRESP;          /* FREE SPACE            @Y30LB25*/ 07926000
@RC01814 L     @06,COPYVPTR                                        1817 07927000
         L     @15,BASEVPTR                                        1817 07928000
         LH    @14,BASFRESP(,@15)                                  1817 07929000
         N     @14,@CF01129                                        1817 07930000
         STH   @14,COPFRESP(,@06)                                  1817 07931000
*       COPLEXT=BASLEXT;            /* LARGEST FREE EXTNT    @Y30LB25*/ 07932000
         LH    @14,BASLEXT(,@15)                                   1818 07933000
         N     @14,@CF01129                                        1818 07934000
         STH   @14,COPLEXT(,@06)                                   1818 07935000
*       COPFREXT=BASFREXT;          /* FREE EXTENTS          @Y30LB25*/ 07936000
*                                                                  1819 07937000
         L     @15,BASFREXT(,@15)                                  1819 07938000
         ST    @15,COPFREXT(,@06)                                  1819 07939000
*       /*************************************************************/ 07940000
*       /*                                                           */ 07941000
*       /* PROCESS THE EXTENSION.                            @Y30LB25*/ 07942000
*       /* NOT REQUIRED FOR RECOVERY.                        @Y30LB25*/ 07943000
*       /*                                                           */ 07944000
*       /*************************************************************/ 07945000
*                                                                  1820 07946000
*       BCDVPTR=COPYVPTR;           /* COMMON MAP            #Y30LB25*/ 07947000
         ST    @06,BCDVPTR                                         1820 07948000
*       IF CVOLVEXT¬=FIXZERO        /* EXTENSION?            @Y30LB25*/ 07949000
*         THEN                      /* YES                   @Y30LB25*/ 07950000
         L     @06,CVOLPTR                                         1821 07951000
         L     @06,CVOLVEXT(,@06)                                  1821 07952000
         LTR   @06,@06                                             1821 07953000
         BZ    @RF01821                                            1821 07954000
*         CALL PROCOVCE;            /* PROCESS COVC EXTEN    @Y30LB25*/ 07955000
*                                                                  1822 07956000
         BAL   @14,PROCOVCE                                        1822 07957000
*       /*************************************************************/ 07958000
*       /*                                                           */ 07959000
*       /* WRITE THE NEW CVR                                 @Y30LB25*/ 07960000
*       /*                                                           */ 07961000
*       /*************************************************************/ 07962000
*                                                                  1823 07963000
*       RPLVBUF=ADDR(COPYBUF);      /* CVR BUF               @Y30LB25*/ 07964000
@RF01821 L     @06,RPLVPTR                                         1823 07965000
         LA    @15,COPYBUF                                         1823 07966000
         ST    @15,RPLVBUF(,@06)                                   1823 07967000
*       RPLVBLN=LENGTH(COPYBUF);    /* CVR BUF LENGTH        @Y30LB25*/ 07968000
         MVC   RPLVBLN(4,@06),@CF01103                             1824 07969000
*       RPLVRLN=LENGTH(COPYV);      /* CVR LENGTH            @Y30LB25*/ 07970000
         MVC   RPLVRLN(4,@06),@CF01104                             1825 07971000
*       RPLVUPD=OFF;                /* NEW RECORD            @Y30LB25*/ 07972000
         NI    RPLVUPD(@06),B'11111101'                            1826 07973000
*       CALL WRITRECD;              /* WRITE CVR             @Y30LB25*/ 07974000
         BAL   @14,WRITRECD                                        1827 07975000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 07976000
*         THEN                      /* YES                   @Y30LB25*/ 07977000
         L     @06,RPLVPTR                                         1828 07978000
         LH    @06,RPLVRETC(,@06)                                  1828 07979000
         N     @06,@CF01129                                        1828 07980000
         LTR   @06,@06                                             1828 07981000
         BNZ   @RT01828                                            1828 07982000
*         RETURN;                   /*                       @Y30LB25*/ 07983000
*                                                                  1829 07984000
*       /*************************************************************/ 07985000
*       /*                                                           */ 07986000
*       /* UPDATE THE CVR'S BVR TO REFLECT THE NEW CVR       @Y30LB25*/ 07987000
*       /*                                                           */ 07988000
*       /*************************************************************/ 07989000
*                                                                  1830 07990000
*       ADDSUB=ON;                  /* ADD CVR               @Y30LB25*/ 07991000
         OI    ADDSUB,B'01000000'                                  1830 07992000
*       CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*          @Y30LB25*/ 07993000
         L     @15,@CV00769                                        1831 07994000
         LA    @01,@AL01831                                        1831 07995000
         BALR  @14,@15                                             1831 07996000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 07997000
*         THEN                      /* YES                   @Y30LB25*/ 07998000
         L     @06,RPLVPTR                                         1832 07999000
         LH    @06,RPLVRETC(,@06)                                  1832 08000000
         N     @06,@CF01129                                        1832 08001000
         LTR   @06,@06                                             1832 08002000
         BNZ   @RT01832                                            1832 08003000
*         RETURN;                   /*                       @Y30LB25*/ 08004000
*                                                                  1833 08005000
*       /*************************************************************/ 08006000
*       /*                                                           */ 08007000
*       /* UPDATE THE CIRS TO POINT TO THE NEW CVR           @Y30LB25*/ 08008000
*       /*                                                           */ 08009000
*       /*************************************************************/ 08010000
*                                                                  1834 08011000
*       CALL UPDCIR;                /* CORRECT CIRS          @Y30LB25*/ 08012000
         BAL   @14,UPDCIR                                          1834 08013000
*       RETURN;                     /*                       @Y30LB25*/ 08014000
         B     @EL00043                                            1835 08015000
*     END;                          /*                       @Y30LB25*/ 08016000
*   END ACINACV2;                   /*                       @Y30LB25*/ 08017000
         B     @EL00043                                            1837 08018000
*                                                                  1838 08019000
*   /*****************************************************************/ 08020000
*   /*                                                               */ 08021000
*   /* PROCEDURE NAME - PROCOVCE                             @Y30LB25*/ 08022000
*   /*                                                       @Y30LB25*/ 08023000
*   /* FUNCTION -                                            @Y30LB25*/ 08024000
*   /* PROCESS IEZCOVCE.                                     @Y30LB25*/ 08025000
*   /*                                                       @Y30LB25*/ 08026000
*   /* INPUT -                                               @Y30LB25*/ 08027000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08028000
*   /* BASE OR COPY VOLUME RECORD                            @Y30LB25*/ 08029000
*   /*                                                       @Y30LB25*/ 08030000
*   /* OUTPUT -                                              @Y30LB25*/ 08031000
*   /* BASE OR COPY VOLUME RECORD                            @Y30LB25*/ 08032000
*   /*                                                               */ 08033000
*   /*****************************************************************/ 08034000
*                                                                  1838 08035000
*PROCOVCE:                          /*                       @Y30LB25*/ 08036000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08037000
PROCOVCE ST    @14,@SA00044                                        1838 08038000
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/ 08039000
*     THEN                          /* YES                   @Y30LB25*/ 08040000
         L     @06,BCDVPTR                                         1839 08041000
         TM    BCDBASE(@06),B'00100000'                            1839 08042000
         BNO   @RF01839                                            1839 08043000
*     IF COVSPDES=ON                /* DESCRIP GIVEN?        @Y30LB25*/ 08044000
*       THEN                        /* YES                   @Y30LB25*/ 08045000
         L     @06,COVCEPTR                                        1840 08046000
         TM    COVSPDES(@06),B'10000000'                           1840 08047000
         BNO   @RF01840                                            1840 08048000
*       BASDESCR=COVDESCR;          /* UPDATE DESCR          @Y30LB25*/ 08049000
         L     @01,BASEVPTR                                        1841 08050000
         MVC   BASDESCR(30,@01),COVDESCR(@06)                      1841 08051000
*     ELSE                                                         1842 08052000
*       ;                           /*                       @Y30LB25*/ 08053000
@RF01840 DS    0H                                                  1843 08054000
*   ELSE                            /* CVR                   @Y30LB25*/ 08055000
*     DO;                           /*                       @Y30LB25*/ 08056000
         B     @RC01839                                            1843 08057000
@RF01839 DS    0H                                                  1844 08058000
*       IF COVSPDES=ON              /* DESCRIP GIVEN?        @Y30LB25*/ 08059000
*         THEN                      /* YES                   @Y30LB25*/ 08060000
         L     @06,COVCEPTR                                        1844 08061000
         TM    COVSPDES(@06),B'10000000'                           1844 08062000
         BNO   @RF01844                                            1844 08063000
*         COPDESCR=COVDESCR;        /* UPDATE DESCR          @Y30LB25*/ 08064000
         L     @01,COPYVPTR                                        1845 08065000
         MVC   COPDESCR(30,@01),COVDESCR(@06)                      1845 08066000
*       IF COVSAM=ON                /* VSAM VOL?             @Y30LB25*/ 08067000
*         THEN                      /* YES                   @Y30LB25*/ 08068000
@RF01844 L     @06,COVCEPTR                                        1846 08069000
         TM    COVSAM(@06),B'10000000'                             1846 08070000
         BNO   @RF01846                                            1846 08071000
*         COPVSAM=ON;               /* VSAM VOL              @Y30LB25*/ 08072000
         L     @06,COPYVPTR                                        1847 08073000
         OI    COPVSAM(@06),B'01000000'                            1847 08074000
*     END;                          /*                       @Y30LB25*/ 08075000
*                                                                  1848 08076000
@RF01846 DS    0H                                                  1849 08077000
*   /*****************************************************************/ 08078000
*   /*                                                               */ 08079000
*   /* SET AND/OR CLEAR ERROR RECOVERY FLAGS.                @Y30LB25*/ 08080000
*   /*                                                               */ 08081000
*   /*****************************************************************/ 08082000
*                                                                  1849 08083000
*   CALL SETCLRCV;                  /* PROC FLAGS            @Y30LB25*/ 08084000
@RC01839 BAL   @14,SETCLRCV                                        1849 08085000
*   RETURN;                         /*                       @Y30LB25*/ 08086000
@EL00044 DS    0H                                                  1850 08087000
@EF00044 DS    0H                                                  1850 08088000
@ER00044 L     @14,@SA00044                                        1850 08089000
         BR    @14                                                 1850 08090000
*   END PROCOVCE;                   /*                       @Y30LB25*/ 08091000
*                                                                  1852 08092000
*   /*****************************************************************/ 08093000
*   /*                                                               */ 08094000
*   /* PROCEDURE NAME - TRANDAT2                             @Y30LB25*/ 08095000
*   /*                                                       @Y30LB25*/ 08096000
*   /* FUNCTION -                                            @Y30LB25*/ 08097000
*   /* TRANSFER DATA FROM AN INACTIVE TO AN ACTIVE VOLUME    @Y30LB25*/ 08098000
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/ 08099000
*   /* TRANSFER DATA FROM DASD TO CARTRIDGE AFTER THE        @Y30LB25*/ 08100000
*   /* MSC WAS CALLED.                                       @Y30LB25*/ 08101000
*   /*                                                       @Y30LB25*/ 08102000
*   /* INPUT -                                               @Y30LB25*/ 08103000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08104000
*   /*                                                       @Y30LB25*/ 08105000
*   /* OUTPUT -                                              @Y30LB25*/ 08106000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08107000
*   /* AN ERROR                                              @Y30LB25*/ 08108000
*   /*                                                               */ 08109000
*   /*****************************************************************/ 08110000
*                                                                  1852 08111000
*TRANDAT2:                          /*                       @Y30LB25*/ 08112000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08113000
*                                                                  1852 08114000
TRANDAT2 ST    @14,@SA00045                                        1852 08115000
*   /*****************************************************************/ 08116000
*   /*                                                               */ 08117000
*   /* CHECK MSC RETURN CONDITION.                           @Y30LB25*/ 08118000
*   /*                                                               */ 08119000
*   /*****************************************************************/ 08120000
*                                                                  1853 08121000
*   IF RPLRCODE¬=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 08122000
*     THEN                          /* YES                   @Y30LB25*/ 08123000
         L     @06,RPLVPTR                                         1853 08124000
         LH    @15,RPLRCODE(,@06)                                  1853 08125000
         N     @15,@CF01129                                        1853 08126000
         LTR   @15,@15                                             1853 08127000
         BZ    @RF01853                                            1853 08128000
*     DO;                           /*                       @Y30LB25*/ 08129000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 08130000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1855 08131000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 08132000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1856 08133000
*       RETURN;                     /*                       @Y30LB25*/ 08134000
@EL00045 DS    0H                                                  1857 08135000
@EF00045 DS    0H                                                  1857 08136000
@ER00045 L     @14,@SA00045                                        1857 08137000
         BR    @14                                                 1857 08138000
*     END;                          /*                       @Y30LB25*/ 08139000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   08140000
*                                      RESERVE .MSVI         @Y30LB25*/ 08141000
*                                                                  1859 08142000
@RF01853 BAL   @14,HOUSKEEP                                        1859 08143000
*   /*****************************************************************/ 08144000
*   /*                                                               */ 08145000
*   /* GET BVR.                                              @Y30LB25*/ 08146000
*   /*                                                               */ 08147000
*   /*****************************************************************/ 08148000
*                                                                  1860 08149000
*   BVOLKY=CVOLID;                  /* SET VOLID             @Y30LB25*/ 08150000
         L     @06,CVOLPTR                                         1860 08151000
         MVC   BVOLKY(6),CVOLID(@06)                               1860 08152000
*   RPLVKEY=ADDR(BKEY);             /* KEY ADDR              @Y30LB25*/ 08153000
         LA    @06,BKEY                                            1861 08154000
         L     @01,RPLVPTR                                         1861 08155000
         ST    @06,RPLVKEY(,@01)                                   1861 08156000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 08157000
         BAL   @14,READUPD1                                        1862 08158000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 08159000
*     THEN                          /* YES                   @Y30LB25*/ 08160000
         L     @06,RPLVPTR                                         1863 08161000
         LH    @06,RPLVRETC(,@06)                                  1863 08162000
         N     @06,@CF01129                                        1863 08163000
         LTR   @06,@06                                             1863 08164000
         BNZ   @RT01863                                            1863 08165000
*     RETURN;                       /*                       @Y30LB25*/ 08166000
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 08167000
*                                                                  1865 08168000
         MVC   BASEBUF(224),BASEBUF1                               1865 08169000
*   /*****************************************************************/ 08170000
*   /*                                                               */ 08171000
*   /* CHECK FOR CARTRIDGE TO DASD.                          @Y30LB25*/ 08172000
*   /*                                                               */ 08173000
*   /*****************************************************************/ 08174000
*                                                                  1866 08175000
*   IF CVODASCR=ON                  /* CART TO DASD          @Y30LB25*/ 08176000
*     THEN                          /* YES                   @Y30LB25*/ 08177000
         L     @06,CVOLPTR                                         1866 08178000
         TM    CVODASCR(@06),B'10000000'                           1866 08179000
         BNO   @RF01866                                            1866 08180000
*     BASDLSF=ON;                   /* DOWN LEVEL SPACE      @Y30LB25*/ 08181000
         L     @06,BASEVPTR                                        1867 08182000
         OI    BASDLSF(@06),B'10000000'                            1867 08183000
*   ELSE                                                           1868 08184000
*                                                                  1868 08185000
*     /***************************************************************/ 08186000
*     /*                                                             */ 08187000
*     /* GET CVR FROM THE CIR                                @Y30LB25*/ 08188000
*     /*                                                             */ 08189000
*     /***************************************************************/ 08190000
*                                                                  1868 08191000
*     DO;                           /*                       @Y30LB25*/ 08192000
         B     @RC01866                                            1868 08193000
@RF01866 DS    0H                                                  1869 08194000
*       IVOLKY=CVOLCSN;             /* SET CSN               @Y30LB25*/ 08195000
         L     @06,CVOLPTR                                         1869 08196000
         MVC   IVOLKY(12),CVOLCSN(@06)                             1869 08197000
*       CALL GETRECLC;              /* GET CVR               @Y30LB25*/ 08198000
         BAL   @14,GETRECLC                                        1870 08199000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 08200000
*         THEN                      /* YES                   @Y30LB25*/ 08201000
         L     @06,RPLVPTR                                         1871 08202000
         LH    @15,RPLVRETC(,@06)                                  1871 08203000
         N     @15,@CF01129                                        1871 08204000
         LTR   @15,@15                                             1871 08205000
         BNZ   @RT01871                                            1871 08206000
*         RETURN;                   /*                       @Y30LB25*/ 08207000
*       COPYVPTR=RPLVBUF;           /* MAP BUFFER            @Y30LB25*/ 08208000
*                                                                  1873 08209000
         L     @06,RPLVBUF(,@06)                                   1873 08210000
         ST    @06,COPYVPTR                                        1873 08211000
*       /*************************************************************/ 08212000
*       /*                                                           */ 08213000
*       /* CHECK DOWN LEVEL SPACE FLAG                       @Y30LB25*/ 08214000
*       /*                                                           */ 08215000
*       /*************************************************************/ 08216000
*                                                                  1874 08217000
*       IF COPDLSPF=ON              /* DOWN LEVEL SPACE?     @Y30LB25*/ 08218000
*         THEN                      /* YES                   @Y30LB25*/ 08219000
         TM    COPDLSPF(@06),B'01000000'                           1874 08220000
         BNO   @RF01874                                            1874 08221000
*         BASDLSF=ON;               /* DOWN LEVEL SPACE      @Y30LB25*/ 08222000
         L     @06,BASEVPTR                                        1875 08223000
         OI    BASDLSF(@06),B'10000000'                            1875 08224000
*       ELSE                        /* NO DOWN LEVEL SPC     @Y30LB25*/ 08225000
*         BASDLSF=OFF;              /*                       @Y30LB25*/ 08226000
*                                                                  1876 08227000
         B     @RC01874                                            1876 08228000
@RF01874 L     @06,BASEVPTR                                        1876 08229000
         NI    BASDLSF(@06),B'01111111'                            1876 08230000
*       /*************************************************************/ 08231000
*       /*                                                           */ 08232000
*       /* SET SPACE REQUIRMENTS                             @Y30LB25*/ 08233000
*       /*                                                           */ 08234000
*       /*************************************************************/ 08235000
*                                                                  1877 08236000
*       BASFRESP=COPFRESP;          /* FREE SPACE            @Y30LB25*/ 08237000
@RC01874 L     @06,BASEVPTR                                        1877 08238000
         L     @15,COPYVPTR                                        1877 08239000
         LH    @14,COPFRESP(,@15)                                  1877 08240000
         STH   @14,BASFRESP(,@06)                                  1877 08241000
*       BASLEXT=COPLEXT;            /* LARGE FREE EXTENT     @Y30LB25*/ 08242000
         LH    @14,COPLEXT(,@15)                                   1878 08243000
         STH   @14,BASLEXT(,@06)                                   1878 08244000
*       BASFREXT=COPFREXT;          /* FREE EXTENT           @Y30LB25*/ 08245000
*                                                                  1879 08246000
         L     @15,COPFREXT(,@15)                                  1879 08247000
         ST    @15,BASFREXT(,@06)                                  1879 08248000
*       /*************************************************************/ 08249000
*       /*                                                           */ 08250000
*       /* REESTABLISH THE RPL FOR A WRITE                   @Y30LB25*/ 08251000
*       /*                                                           */ 08252000
*       /*************************************************************/ 08253000
*                                                                  1880 08254000
*       BVOLKY=CVOLID;              /* SET VOLID             @Y30LB25*/ 08255000
         L     @06,CVOLPTR                                         1880 08256000
         MVC   BVOLKY(6),CVOLID(@06)                               1880 08257000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 08258000
         LA    @06,BKEY                                            1881 08259000
         L     @01,RPLVPTR                                         1881 08260000
         ST    @06,RPLVKEY(,@01)                                   1881 08261000
*       CALL READUPD1;              /* READ BVR              @Y30LB25*/ 08262000
         BAL   @14,READUPD1                                        1882 08263000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 08264000
*         THEN                      /* YES                   @Y30LB25*/ 08265000
         L     @06,RPLVPTR                                         1883 08266000
         LH    @06,RPLVRETC(,@06)                                  1883 08267000
         N     @06,@CF01129                                        1883 08268000
         LTR   @06,@06                                             1883 08269000
         BNZ   @RT01883                                            1883 08270000
*         RETURN;                   /*                       @Y30LB25*/ 08271000
*     END;                          /*                       @Y30LB25*/ 08272000
*                                                                  1885 08273000
*   /*****************************************************************/ 08274000
*   /*                                                               */ 08275000
*   /* CHECK FOR AN ICBCOVC EXTENSION                        @Y30LB25*/ 08276000
*   /*                                                               */ 08277000
*   /*****************************************************************/ 08278000
*                                                                  1886 08279000
*   IF CVOLVEXT¬=FIXZERO            /* EXTENSION?            @Y30LB25*/ 08280000
*     THEN                          /* YES                   @Y30LB25*/ 08281000
@RC01866 L     @06,CVOLPTR                                         1886 08282000
         L     @06,CVOLVEXT(,@06)                                  1886 08283000
         LTR   @06,@06                                             1886 08284000
         BZ    @RF01886                                            1886 08285000
*     DO;                           /*                       @Y30LB25*/ 08286000
*       BCDVPTR=BASEVPTR;           /* COMMON MAP            @Y30LB25*/ 08287000
         L     @06,BASEVPTR                                        1888 08288000
         ST    @06,BCDVPTR                                         1888 08289000
*       CALL PROCOVCE;              /*                       @Y30LB25*/ 08290000
         BAL   @14,PROCOVCE                                        1889 08291000
*     END;                          /*                       @Y30LB25*/ 08292000
*                                                                  1890 08293000
*   /*****************************************************************/ 08294000
*   /*                                                               */ 08295000
*   /* WRITE THE BVR                                         @Y30LB25*/ 08296000
*   /*                                                               */ 08297000
*   /*****************************************************************/ 08298000
*                                                                  1891 08299000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFFER ADDR           @Y30LB25*/ 08300000
@RF01886 LA    @06,BASEBUF                                         1891 08301000
         L     @01,RPLVPTR                                         1891 08302000
         ST    @06,RPLVBUF(,@01)                                   1891 08303000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 08304000
         BAL   @14,WRITRECD                                        1892 08305000
*   RETURN;                         /*                       @Y30LB25*/ 08306000
         B     @EL00045                                            1893 08307000
*   END TRANDAT2;                   /*                       @Y30LB25*/ 08308000
         B     @EL00045                                            1894 08309000
*                                                                  1895 08310000
*   /*****************************************************************/ 08311000
*   /*                                                               */ 08312000
*   /* PROCEDURE NAME - ELINACV2                             @Y30LB25*/ 08313000
*   /*                                                       @Y30LB25*/ 08314000
*   /* FUNCTION -                                            @Y30LB25*/ 08315000
*   /* PROCESS THE ELIMINATION OF AN INACTIVE VOLUME         @Y30LB25*/ 08316000
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/ 08317000
*   /*                                                       @Y30LB25*/ 08318000
*   /* INPUT -                                               @Y30LB25*/ 08319000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08320000
*   /*                                                       @Y30LB25*/ 08321000
*   /* OUTPUT -                                              @Y30LB25*/ 08322000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08323000
*   /* AN ERROR                                              @Y30LB25*/ 08324000
*   /*                                                               */ 08325000
*   /*****************************************************************/ 08326000
*                                                                  1895 08327000
*ELINACV2:                          /*                       @Y30LB25*/ 08328000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08329000
ELINACV2 ST    @14,@SA00046                                        1895 08330000
*   IF RPLRCODE¬=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 08331000
*     THEN                          /* YES                   @Y30LB25*/ 08332000
         L     @06,RPLVPTR                                         1896 08333000
         LH    @05,RPLRCODE(,@06)                                  1896 08334000
         N     @05,@CF01129                                        1896 08335000
         LTR   @05,@05                                             1896 08336000
         BZ    @RF01896                                            1896 08337000
*     DO;                           /*                       @Y30LB25*/ 08338000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 08339000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1898 08340000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 08341000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1899 08342000
*       RETURN;                     /*                       @Y30LB25*/ 08343000
@EL00046 DS    0H                                                  1900 08344000
@EF00046 DS    0H                                                  1900 08345000
@ER00046 L     @14,@SA00046                                        1900 08346000
         BR    @14                                                 1900 08347000
*     END;                          /*                       @Y30LB25*/ 08348000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           #Y30LB25   08349000
*                                      RESERVE .MSVI         #Y30LB25*/ 08350000
*                                                                  1902 08351000
@RF01896 BAL   @14,HOUSKEEP                                        1902 08352000
*   /*****************************************************************/ 08353000
*   /*                                                               */ 08354000
*   /* READ FOR CIR TO GET THE BVR OR CVR KEY.               #Y30LB25*/ 08355000
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    #Y30LB25*/ 08356000
*   /* FOR UPDATE                                            #Y30LB25*/ 08357000
*   /*                                                               */ 08358000
*   /*****************************************************************/ 08359000
*                                                                  1903 08360000
*   IVOLKY=DEFVCSN1;                /* SET UP KEY            #Y30LB25*/ 08361000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        1903 08362000
*   CALL GETRECUD;                  /* GET RECORD            #Y30LB25*/ 08363000
         BAL   @14,GETRECUD                                        1904 08364000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                #Y30LB25*/ 08365000
*     THEN                          /* YES                   #Y30LB25*/ 08366000
         L     @06,RPLVPTR                                         1905 08367000
         LH    @15,RPLVRETC(,@06)                                  1905 08368000
         N     @15,@CF01129                                        1905 08369000
         LTR   @15,@15                                             1905 08370000
         BNZ   @RT01905                                            1905 08371000
*     RETURN;                       /*                       #Y30LB25*/ 08372000
*                                                                  1906 08373000
*   /*****************************************************************/ 08374000
*   /*                                                               */ 08375000
*   /* DELETE THE CVR OR BVR.                                @Y30LB25*/ 08376000
*   /*                                                               */ 08377000
*   /*****************************************************************/ 08378000
*                                                                  1907 08379000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Y30LB25*/ 08380000
         MVI   RPLVTYP(@06),X'05'                                  1907 08381000
*   RESPECIFY                                                      1908 08382000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 08383000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 08384000
         LR    RG1,@06                                             1909 08385000
*   CALL ICBVIO00;                  /* DELETE BVR OR CVR     @Y30LB25*/ 08386000
         L     @15,@CV00762                                        1910 08387000
         BALR  @14,@15                                             1910 08388000
*   RESPECIFY                                                      1911 08389000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 08390000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 08391000
*     THEN                          /* YES                   @Y30LB25*/ 08392000
         L     @06,RPLVPTR                                         1912 08393000
         LH    @15,RPLVRETC(,@06)                                  1912 08394000
         N     @15,@CF01129                                        1912 08395000
         LTR   @15,@15                                             1912 08396000
         BNZ   @RT01912                                            1912 08397000
*     RETURN;                       /*                       @Y30LB25*/ 08398000
*                                                                  1913 08399000
*   /*****************************************************************/ 08400000
*   /*                                                               */ 08401000
*   /* DELETE THEIR CIRS.                                    @Y30LB25*/ 08402000
*   /*                                                               */ 08403000
*   /*****************************************************************/ 08404000
*                                                                  1914 08405000
*   BCDVPTR=BASEVPTR;               /* COMM MAP              @Y30LB25*/ 08406000
         L     @15,BASEVPTR                                        1914 08407000
         ST    @15,BCDVPTR                                         1914 08408000
*   RPLVBUF=ADDR(INDEXBUF);         /* CIR BUF               @Y30LB25*/ 08409000
         LA    @14,INDEXBUF                                        1915 08410000
         ST    @14,RPLVBUF(,@06)                                   1915 08411000
*   RPLVBLN=LENGTH(INDEXBUF);       /* CIR BUF LENGTH        @Y30LB25*/ 08412000
         MVC   RPLVBLN(4,@06),@CF00339                             1916 08413000
*   RPLVKEY=ADDR(IKEY);             /* KEY ADDR              @Y30LB25*/ 08414000
         LA    @14,IKEY                                            1917 08415000
         ST    @14,RPLVKEY(,@06)                                   1917 08416000
*   IVOLKY=BCDCSN1;                 /* CSN1 TO KEY           @Y30LB25*/ 08417000
         MVC   IVOLKY(12),BCDCSN1(@15)                             1918 08418000
*   CALL DELTRECD;                  /* DELETE CSN1 CIR       @Y30LB25*/ 08419000
         BAL   @14,DELTRECD                                        1919 08420000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* IGNORE ERROR          @Y30LB25*/ 08421000
         L     @06,RPLVPTR                                         1920 08422000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1920 08423000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* IGNORE ERROR          @Y30LB25*/ 08424000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1921 08425000
*   IVOLKY=BCDCSN2;                 /* CSN2 TO KEY           @Y30LB25*/ 08426000
         L     @06,BCDVPTR                                         1922 08427000
         MVC   IVOLKY(12),BCDCSN2(@06)                             1922 08428000
*   CALL DELTRECD;                  /* DELETE CSN2 CIR       @Y30LB25*/ 08429000
         BAL   @14,DELTRECD                                        1923 08430000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* IGNORE ERROR          @Y30LB25*/ 08431000
         L     @06,RPLVPTR                                         1924 08432000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1924 08433000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* IGNORE ERROR          @Y30LB25*/ 08434000
*                                                                  1925 08435000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1925 08436000
*   /*****************************************************************/ 08437000
*   /*                                                               */ 08438000
*   /* CKECK FOR A BASE VOLUME RECORD.                       @Y30LB25*/ 08439000
*   /* UPDATE ITS GVR OR NGVR.                               @Y30LB25*/ 08440000
*   /*                                                               */ 08441000
*   /*****************************************************************/ 08442000
*                                                                  1926 08443000
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/ 08444000
*     THEN                          /* YES                   @Y30LB25*/ 08445000
         L     @06,BCDVPTR                                         1926 08446000
         TM    BCDBASE(@06),B'00100000'                            1926 08447000
         BNO   @RF01926                                            1926 08448000
*     DO;                           /*                       @Y30LB25*/ 08449000
*       IF BASGRPV=ON               /* GROUPED BVR?          @Y30LB25*/ 08450000
*         THEN                      /* YES                   @Y30LB25*/ 08451000
         L     @06,BASEVPTR                                        1928 08452000
         TM    BASGRPV(@06),B'00100000'                            1928 08453000
         BNO   @RF01928                                            1928 08454000
*         DO;                       /*                       @Y30LB25*/ 08455000
*           CALL INACGVR;           /* DECREM # INAC VOLS    @Y30LB25*/ 08456000
         BAL   @14,INACGVR                                         1930 08457000
*           IF RPLVRETC¬=FIXZERO    /* ERROR?                @Y30LB25*/ 08458000
*             THEN                  /* YES                   @Y30LB25*/ 08459000
         L     @06,RPLVPTR                                         1931 08460000
         LH    @06,RPLVRETC(,@06)                                  1931 08461000
         N     @06,@CF01129                                        1931 08462000
         LTR   @06,@06                                             1931 08463000
         BNZ   @RT01931                                            1931 08464000
*             RETURN;               /*                       @Y30LB25*/ 08465000
*         END;                      /*                       @Y30LB25*/ 08466000
*       CALL PROCBVR;               /* PROCESS THE BVR       @Y30LB25*/ 08467000
@RF01928 BAL   @14,PROCBVR                                         1934 08468000
*     END;                          /*                       @Y30LB25*/ 08469000
*                                                                  1935 08470000
*   /*****************************************************************/ 08471000
*   /*                                                               */ 08472000
*   /* CHECK FOR A DELETED COPY VOLUME RECORD                @Y30LB25*/ 08473000
*   /* IF PRESENT, THEN UPDATE THE CVR'S BVR TO REFLECT      @Y30LB25*/ 08474000
*   /* THE DELETION OF THE CVR.                              @Y30LB25*/ 08475000
*   /*                                                               */ 08476000
*   /*****************************************************************/ 08477000
*                                                                  1936 08478000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 08479000
*     THEN                          /* YES                   @Y30LB25*/ 08480000
@RF01926 L     @06,BCDVPTR                                         1936 08481000
         TM    BCDCOPY(@06),B'00010000'                            1936 08482000
         BNO   @RF01936                                            1936 08483000
*     DO;                           /*                       @Y30LB25*/ 08484000
*       COPYBUF=BASEBUF;            /* CVR TO CVR BUF        @Y30LB25*/ 08485000
         MVC   COPYBUF(224),BASEBUF                                1938 08486000
*       ADDSUB=OFF;                 /* DELETED CVR           @Y30LB25*/ 08487000
         NI    ADDSUB,B'10111111'                                  1939 08488000
*       CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*          @Y30LB25   08489000
*                                      UPDATE CVR'S BVR      @Y30LB25*/ 08490000
         L     @15,@CV00769                                        1940 08491000
         LA    @01,@AL01940                                        1940 08492000
         BALR  @14,@15                                             1940 08493000
*     END;                          /*                       @Y30LB25*/ 08494000
*   RETURN;                         /*                       @Y30LB25*/ 08495000
         B     @EL00046                                            1942 08496000
*   END ELINACV2;                   /*                       @Y30LB25*/ 08497000
         B     @EL00046                                            1943 08498000
*                                                                  1944 08499000
*   /*****************************************************************/ 08500000
*   /*                                                               */ 08501000
*   /* PROCEDURE NAME - RENAME1                              @Y30LB25*/ 08502000
*   /*                                                       @Y30LB25*/ 08503000
*   /* FUNCTION -                                            @Y30LB25*/ 08504000
*   /* PROCESS THE RENAME OF AN ACTIVE OR INACTIVE           @Y30LB25*/ 08505000
*   /* VOLUME BEFORE THE MSC IS CALLED.                      @Y30LB25*/ 08506000
*   /*                                                       @Y30LB25*/ 08507000
*   /* INPUT -                                               @Y30LB25*/ 08508000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08509000
*   /*                                                       @Y30LB25*/ 08510000
*   /* OUTPUT -                                              @Y30LB25*/ 08511000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08512000
*   /* AN ERROR                                              @Y30LB25*/ 08513000
*   /*                                                               */ 08514000
*   /*****************************************************************/ 08515000
*                                                                  1944 08516000
*RENAME1:                           /*                       @Y30LB25*/ 08517000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08518000
RENAME1  ST    @14,@SA00047                                        1944 08519000
*   CALL RMSVI;                     /* RESERVE .MSVI         @Y30LB25*/ 08520000
*                                                                  1945 08521000
         BAL   @14,RMSVI                                           1945 08522000
*   /*****************************************************************/ 08523000
*   /*                                                               */ 08524000
*   /* IF NECESSARY, INSURE A GROUP EXISTS                   @VS32198*/ 08525000
*   /*                                                               */ 08526000
*   /*****************************************************************/ 08527000
*                                                                  1946 08528000
*   IF DEFPGRO=ON&DEFVVEXT¬=FIXZERO /* GROUP SPECIFIED?      @VS34305*/ 08529000
*     THEN                          /* YES                   @VS32198*/ 08530000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       1946 08531000
         BNO   @RF01946                                            1946 08532000
         L     @06,DEFVVEXT(,DEFVPTR)                              1946 08533000
         LTR   @06,@06                                             1946 08534000
         BZ    @RF01946                                            1946 08535000
*     DO;                           /*                       @VS32198*/ 08536000
*       GROUPKY=DEFGROUP;           /* SET GROUP NAME        @VS32198*/ 08537000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1948 08538000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY               @VS32198*/ 08539000
         LA    @06,GKEY                                            1949 08540000
         L     @01,RPLVPTR                                         1949 08541000
         ST    @06,RPLVKEY(,@01)                                   1949 08542000
*       CALL READLOC;               /* GET GVR               @VS32198*/ 08543000
         BAL   @14,READLOC                                         1950 08544000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @VS32198*/ 08545000
*         THEN                      /* YES                   @VS32198*/ 08546000
         L     @06,RPLVPTR                                         1951 08547000
         LH    @15,RPLVRETC(,@06)                                  1951 08548000
         N     @15,@CF01129                                        1951 08549000
         LTR   @15,@15                                             1951 08550000
         BZ    @RF01951                                            1951 08551000
*         DO;                       /*                       @VS32198*/ 08552000
*           IF RPLRCODE=NORECFND    /* NONE FOUND?           @VS32198*/ 08553000
*             THEN                  /* RIGHT                 @VS32198*/ 08554000
         CLC   RPLRCODE(2,@06),@CB00711                            1953 08555000
         BNE   @RF01953                                            1953 08556000
*             RPLRCODE=NOGRPFND;    /*                       @VS32198   08557000
*                                      NO GROUP FND          @VS32198*/ 08558000
         MVC   RPLRCODE(2,@06),@CB00707                            1954 08559000
*           RETURN;                 /*                       @VS32198*/ 08560000
@EL00047 DS    0H                                                  1955 08561000
@EF00047 DS    0H                                                  1955 08562000
@ER00047 L     @14,@SA00047                                        1955 08563000
         BR    @14                                                 1955 08564000
*         END;                      /*                       @VS32198*/ 08565000
*     END;                          /*                       @VS32198*/ 08566000
*                                                                  1957 08567000
@RF01951 DS    0H                                                  1958 08568000
*   /*****************************************************************/ 08569000
*   /*                                                               */ 08570000
*   /* CHECK FOR CREATE A BASE VOLUME RECORD                 #Y30LB25*/ 08571000
*   /* CHECK IF A BVR ALREADY EXISTS FOR DEFVNVOL.           @Y30LB25*/ 08572000
*   /*                                                               */ 08573000
*   /*****************************************************************/ 08574000
*                                                                  1958 08575000
*   BVOLKY=DEFVNVOL;                /* SET VOLID IN KEY      @Y30LB25*/ 08576000
@RF01946 MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         1958 08577000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 08578000
         LA    @06,BKEY                                            1959 08579000
         L     @01,RPLVPTR                                         1959 08580000
         ST    @06,RPLVKEY(,@01)                                   1959 08581000
*   CALL READLOC;                   /* READ FOR BVR          @Y30LB25*/ 08582000
         BAL   @14,READLOC                                         1960 08583000
*   IF RPLRCODE=IOERROR             /* I/O ERROR?            @Y30LB25*/ 08584000
*     THEN                          /* YES                   @Y30LB25*/ 08585000
         L     @06,RPLVPTR                                         1961 08586000
         CLC   RPLRCODE(2,@06),@CB00713                            1961 08587000
         BE    @RT01961                                            1961 08588000
*     RETURN;                       /*                       @Y30LB25*/ 08589000
*                                                                  1962 08590000
*   /*****************************************************************/ 08591000
*   /*                                                               */ 08592000
*   /* CHECK IF BVR ALREADY EXISTS FOR DEFVNVOL              @Y30LB25*/ 08593000
*   /*                                                               */ 08594000
*   /*****************************************************************/ 08595000
*                                                                  1963 08596000
*   IF RPLRCODE=NORECFND            /* NO RECORD FND?        @Y30LB25*/ 08597000
*     THEN                          /* RIGHT                 @Y30LB25*/ 08598000
         CLC   RPLRCODE(2,@06),@CB00711                            1963 08599000
         BNE   @RF01963                                            1963 08600000
*     DO;                           /*                       @Y30LB25*/ 08601000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETURN CODE      @Y30LB25*/ 08602000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1965 08603000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASON CODE      @Y30LB25*/ 08604000
*                                                                  1966 08605000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1966 08606000
*       /*************************************************************/ 08607000
*       /*                                                           */ 08608000
*       /* RENAME AN INACTIVE VOLUME                         @Y30LB25*/ 08609000
*       /*                                                           */ 08610000
*       /*************************************************************/ 08611000
*                                                                  1967 08612000
*       IF DEFVRNTR=ON              /* RENAME INAC VOL?      @Y30LB25*/ 08613000
*         THEN                      /* YES                   @Y30LB25*/ 08614000
         TM    DEFVRNTR(DEFVPTR),B'00000100'                       1967 08615000
         BNO   @RF01967                                            1967 08616000
*         DO;                       /*                       @Y30LB25*/ 08617000
*                                                                  1968 08618000
*           /*********************************************************/ 08619000
*           /*                                                       */ 08620000
*           /* GET MSC RECORD FOR THE INACTIVE VOLUME        @Y30LB25*/ 08621000
*           /*                                                       */ 08622000
*           /*********************************************************/ 08623000
*                                                                  1969 08624000
*           IVOLKY=DEFVCSN1;        /* CSN TO CIR            @Y30LB25*/ 08625000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        1969 08626000
*           CALL GETRECLC;          /* GET MSC RECD          @Y30LB25*/ 08627000
         BAL   @14,GETRECLC                                        1970 08628000
*         END;                      /*                       @Y30LB25*/ 08629000
*                                                                  1971 08630000
*       /*************************************************************/ 08631000
*       /*                                                           */ 08632000
*       /* RENAME AN ACTIVE VOLUME                           @Y30LB25*/ 08633000
*       /*                                                           */ 08634000
*       /*************************************************************/ 08635000
*                                                                  1972 08636000
*       ELSE                                                       1972 08637000
*                                                                  1972 08638000
*         /***********************************************************/ 08639000
*         /*                                                         */ 08640000
*         /* GET BVR FOR THE ACTIVE VOLUME                   @Y30LB25*/ 08641000
*         /*                                                         */ 08642000
*         /***********************************************************/ 08643000
*                                                                  1972 08644000
*         DO;                       /*                       @Y30LB25*/ 08645000
         B     @RC01967                                            1972 08646000
@RF01967 DS    0H                                                  1973 08647000
*           BVOLKY=DEFVOLD;         /* VOLID TO BVR          @Y30LB25*/ 08648000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1973 08649000
*           RPLVKEY=ADDR(BKEY);     /* SET KEY ADDR          @Y30LB25*/ 08650000
         LA    @06,BKEY                                            1974 08651000
         L     @01,RPLVPTR                                         1974 08652000
         ST    @06,RPLVKEY(,@01)                                   1974 08653000
*           CALL READLOC;           /* GET BVR               @Y30LB25*/ 08654000
         BAL   @14,READLOC                                         1975 08655000
*         END;                      /*                       @Y30LB25*/ 08656000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 08657000
*         THEN                      /* YES                   @Y30LB25*/ 08658000
@RC01967 L     @06,RPLVPTR                                         1977 08659000
         LH    @15,RPLVRETC(,@06)                                  1977 08660000
         N     @15,@CF01129                                        1977 08661000
         LTR   @15,@15                                             1977 08662000
         BNZ   @RT01977                                            1977 08663000
*         RETURN;                   /*                       @Y30LB25*/ 08664000
*                                                                  1978 08665000
*       /*************************************************************/ 08666000
*       /*                                                           */ 08667000
*       /* MSVC RECORD FOR VOLUME TO BE RENAMED EXISTS.      @Y30LB25*/ 08668000
*       /* RENAMED VOLUME IS TO BECOME A BVR.                @Y30LB25*/ 08669000
*       /*                                                           */ 08670000
*       /*************************************************************/ 08671000
*                                                                  1979 08672000
*       BASEBUF=BUFFER;             /* SAVE BVR IN CASE      @Y30LB25   08673000
*                                      GVR IS READ           @Y30LB25*/ 08674000
         L     @06,RPLVBUF(,@06)                                   1979 08675000
         MVC   BASEBUF(224),BUFFER(@06)                            1979 08676000
*       BCDVPTR=BASEVPTR;           /* COMMON MAP            @Y30LB25*/ 08677000
         L     @06,BASEVPTR                                        1980 08678000
         ST    @06,BCDVPTR                                         1980 08679000
*       CALL RENBVR1;               /* PROCESS BVR           @Y30LB25*/ 08680000
         BAL   @14,RENBVR1                                         1981 08681000
*       RETURN;                     /*                       @Y30LB25*/ 08682000
         B     @EL00047                                            1982 08683000
*     END;                          /*                       @Y30LB25*/ 08684000
*                                                                  1983 08685000
*   /*****************************************************************/ 08686000
*   /*                                                               */ 08687000
*   /* CHECK IF THE OLD VOLID EQUALS THE NEW VOLID           @Y30LB25*/ 08688000
*   /* FOR RENAME AN ACTIVE VOLUME                           @Y30LB25*/ 08689000
*   /*                                                               */ 08690000
*   /*****************************************************************/ 08691000
*                                                                  1984 08692000
*   IF DEFVRNM=ON                   /* RENAME ACT VOL?       @Y30LB25*/ 08693000
*     THEN                          /* YES                   @Y30LB25*/ 08694000
@RF01963 TM    DEFVRNM(DEFVPTR),B'00100000'                        1984 08695000
         BNO   @RF01984                                            1984 08696000
*     DO;                           /*                       @Y30LB25*/ 08697000
*       IF DEFVOLD=DEFVNVOL         /* NVOLID = VOLID?       @Y30LB25*/ 08698000
*         THEN                      /* YES                   @Y30LB25*/ 08699000
         CLC   DEFVOLD(6,DEFVPTR),DEFVNVOL(DEFVPTR)                1986 08700000
         BNE   @RF01986                                            1986 08701000
*         DO;                       /*                       @Y30LB25*/ 08702000
*           BASEBUF=BUFFER;         /* SAVE BVR IN CASE      @Y30LB25   08703000
*                                      GVR IS READ           @Y30LB25*/ 08704000
         L     @06,RPLVPTR                                         1988 08705000
         L     @06,RPLVBUF(,@06)                                   1988 08706000
         MVC   BASEBUF(224),BUFFER(@06)                            1988 08707000
*           CALL CKATTRIB;          /*                       @Y30LB25*/ 08708000
         BAL   @14,CKATTRIB                                        1989 08709000
*           RETURN;                 /*                       @Y30LB25*/ 08710000
         B     @EL00047                                            1990 08711000
*         END;                      /*                       @Y30LB25*/ 08712000
*     END;                          /*                       @Y30LB25*/ 08713000
*                                                                  1992 08714000
@RF01986 DS    0H                                                  1993 08715000
*   /*****************************************************************/ 08716000
*   /*                                                               */ 08717000
*   /* CHECK IF THE OLD VOLID EQUALS THE NEW VOLID           @Y30LB25*/ 08718000
*   /* RENAME AN INACTIVE VOLUME.                            @Y30LB25*/ 08719000
*   /*                                                               */ 08720000
*   /*****************************************************************/ 08721000
*                                                                  1993 08722000
*   IF DEFVRNTR=ON                  /* RENAME INACT VOL?     @Y30LB25*/ 08723000
*     THEN                          /* YES                   @Y30LB25*/ 08724000
@RF01984 TM    DEFVRNTR(DEFVPTR),B'00000100'                       1993 08725000
         BNO   @RF01993                                            1993 08726000
*     DO;                           /*                       @Y30LB25*/ 08727000
*       IVOLKY=DEFVCSN1;            /* SET CSN               @Y30LB25*/ 08728000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        1995 08729000
*       CALL GETRECLC;              /* GET MSVC RECORD       @Y30LB25*/ 08730000
         BAL   @14,GETRECLC                                        1996 08731000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 08732000
*         THEN                      /* YES                   @Y30LB25*/ 08733000
         L     @06,RPLVPTR                                         1997 08734000
         LH    @15,RPLVRETC(,@06)                                  1997 08735000
         N     @15,@CF01129                                        1997 08736000
         LTR   @15,@15                                             1997 08737000
         BNZ   @RT01997                                            1997 08738000
*         RETURN;                   /*                       @Y30LB25*/ 08739000
*       BCDVPTR=RPLVBUF;            /* PT TO RECORD          @Y30LB25*/ 08740000
         L     @06,RPLVBUF(,@06)                                   1999 08741000
         ST    @06,BCDVPTR                                         1999 08742000
*       IF BCDSERNO=DEFVNVOL        /* SAME VOLIDS?          @Y30LB25*/ 08743000
*         THEN                      /* YES                   @Y30LB25*/ 08744000
         CLC   BCDSERNO(6,@06),DEFVNVOL(DEFVPTR)                   2000 08745000
         BE    @RT02000                                            2000 08746000
*         RETURN;                   /*                       @Y30LB25*/ 08747000
*     END;                          /*                       @Y30LB25*/ 08748000
*                                                                  2002 08749000
*   /*****************************************************************/ 08750000
*   /*                                                               */ 08751000
*   /* BVR EXISTS FOR DEFVNVOL. CHECK IF A DVR CAN           @Y30LB25*/ 08752000
*   /* BE CREATED. AN ICBDEFV EXTENSION MUST EXIST.          @Y30LB25*/ 08753000
*   /*                                                               */ 08754000
*   /*****************************************************************/ 08755000
*                                                                  2003 08756000
*   IF DEFVVEXT¬=FIXZERO&DEFDUP=ON  /* CREATE A DVR?         @Y30LB25*/ 08757000
*     THEN                          /* YES                   @Y30LB25*/ 08758000
@RF01993 L     @06,DEFVVEXT(,DEFVPTR)                              2003 08759000
         LTR   @06,@06                                             2003 08760000
         BZ    @RF02003                                            2003 08761000
         TM    DEFDUP(DEFVEPTR),B'00100000'                        2003 08762000
         BNO   @RF02003                                            2003 08763000
*     DO;                           /*                       @Y30LB25*/ 08764000
*       CALL ELACREN1;              /* PROCESS BVR           @Y30LB25*/ 08765000
         BAL   @14,ELACREN1                                        2005 08766000
*       RETURN;                     /*                       @Y30LB25*/ 08767000
         B     @EL00047                                            2006 08768000
*     END;                          /*                       @Y30LB25*/ 08769000
*                                                                  2007 08770000
*   /*****************************************************************/ 08771000
*   /*                                                               */ 08772000
*   /* ERROR - BVR EXISTS FOR DEFVNVOL AND CAN'T             @Y30LB25*/ 08773000
*   /* CREATE A DVR.                                         @Y30LB25*/ 08774000
*   /*                                                               */ 08775000
*   /*****************************************************************/ 08776000
*                                                                  2008 08777000
*   RPLVRETC=FIXFOUR;               /* ERROR RETN CODE       @Y30LB25*/ 08778000
@RF02003 L     @06,RPLVPTR                                         2008 08779000
         MVC   RPLVRETC(2,@06),@CH00041                            2008 08780000
*   RPLRCODE=NODVRSPC;              /* DVR NO SPECIFIED      @Y30LB25*/ 08781000
         MVC   RPLRCODE(2,@06),@CB00705                            2009 08782000
*   RETURN;                         /*                       @Y30LB25*/ 08783000
         B     @EL00047                                            2010 08784000
*   END RENAME1;                    /*                       @Y30LB25*/ 08785000
         B     @EL00047                                            2011 08786000
*                                                                  2012 08787000
*   /*****************************************************************/ 08788000
*   /*                                                               */ 08789000
*   /* PROCEDURE NAME - RENBVR1                              @Y30LB25*/ 08790000
*   /*                                                       @Y30LB25*/ 08791000
*   /* FUNCTION -                                            @Y30LB25*/ 08792000
*   /* MAKE CHECKS FOR RENAME A VOLUME WHICH WILL            @Y30LB25*/ 08793000
*   /* RESULT IN A BVR BEING CREATED. CALLED BEFORE THE      @Y30LB25*/ 08794000
*   /* MSC IS CALLED.                                        @Y30LB25*/ 08795000
*   /*                                                       @Y30LB25*/ 08796000
*   /* INPUT -                                               @Y30LB25*/ 08797000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08798000
*   /* RPLVBUF - MSC RECORD MAPPED BY BCDVPTR                @Y30LB25*/ 08799000
*   /*                                                       @Y30LB25*/ 08800000
*   /* OUTPUT -                                              @Y30LB25*/ 08801000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08802000
*   /* AN ERROR                                              @Y30LB25*/ 08803000
*   /* PLACE HOLDER BASE VOLUME RECORD                       @Y30LB25*/ 08804000
*   /*                                                               */ 08805000
*   /*****************************************************************/ 08806000
*                                                                  2012 08807000
*RENBVR1:                           /*                       @Y30LB25*/ 08808000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08809000
*                                                                  2012 08810000
RENBVR1  ST    @14,@SA00048                                        2012 08811000
*   /*****************************************************************/ 08812000
*   /*                                                               */ 08813000
*   /* CHECK FOR A BVR                                       @Y30LB25*/ 08814000
*   /*                                                               */ 08815000
*   /*****************************************************************/ 08816000
*                                                                  2013 08817000
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/ 08818000
*     THEN                          /* YES                   @Y30LB25*/ 08819000
         L     @06,BCDVPTR                                         2013 08820000
         TM    BCDBASE(@06),B'00100000'                            2013 08821000
         BNO   @RF02013                                            2013 08822000
*     DO;                           /*                       @Y30LB25*/ 08823000
*       BASEVPTR=BCDVPTR;           /* BVR MAP               @Y30LB25*/ 08824000
*                                                                  2015 08825000
         ST    @06,BASEVPTR                                        2015 08826000
*       /*************************************************************/ 08827000
*       /*                                                           */ 08828000
*       /* CHECK FOR RENAME AN ACTIVE VOLUME                 @Y30LB25*/ 08829000
*       /*                                                           */ 08830000
*       /*************************************************************/ 08831000
*                                                                  2016 08832000
*       IF DEFVRNM=ON               /* RENAME ACT VOL?       @Y30LB25*/ 08833000
*         THEN                      /* YES                   @Y30LB25*/ 08834000
         TM    DEFVRNM(DEFVPTR),B'00100000'                        2016 08835000
         BNO   @RF02016                                            2016 08836000
*         DO;                       /*                       @Y30LB25*/ 08837000
*                                                                  2017 08838000
*           /*********************************************************/ 08839000
*           /*                                                       */ 08840000
*           /* CHECK THE ATTRIBUTES                          @Y30LB25*/ 08841000
*           /*                                                       */ 08842000
*           /*********************************************************/ 08843000
*                                                                  2018 08844000
*           CALL CKATTRIB;          /* CK ATTRIBUTES         @Y30LB25*/ 08845000
         BAL   @14,CKATTRIB                                        2018 08846000
*           IF RPLVRETC¬=FIXZERO    /* ERROR?                @Y30LB25*/ 08847000
*             THEN                  /* YES                   @Y30LB25*/ 08848000
         L     @06,RPLVPTR                                         2019 08849000
         LH    @06,RPLVRETC(,@06)                                  2019 08850000
         N     @06,@CF01129                                        2019 08851000
         LTR   @06,@06                                             2019 08852000
         BNZ   @RT02019                                            2019 08853000
*             RETURN;               /*                       @Y30LB25*/ 08854000
*         END;                      /*                       @Y30LB25*/ 08855000
*                                                                  2021 08856000
*       /*************************************************************/ 08857000
*       /*                                                           */ 08858000
*       /* CHECK FOR VALID 'TO' OR 'FOR' EXPIRATION DATE     @Y30LB25*/ 08859000
*       /*                                                           */ 08860000
*       /*************************************************************/ 08861000
*                                                                  2022 08862000
*       CALL EXPCK;                 /* CK TO OR FOR          @Y30LB25*/ 08863000
@RF02016 BAL   @14,EXPCK                                           2022 08864000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 08865000
*         THEN                      /* YES                   @Y30LB25*/ 08866000
         L     @06,RPLVPTR                                         2023 08867000
         LH    @06,RPLVRETC(,@06)                                  2023 08868000
         N     @06,@CF01129                                        2023 08869000
         LTR   @06,@06                                             2023 08870000
         BNZ   @RT02023                                            2023 08871000
*         RETURN;                   /*                       @Y30LB25*/ 08872000
*                                                                  2024 08873000
*       /*************************************************************/ 08874000
*       /*                                                           */ 08875000
*       /* CHECK IF COPIES EXIST AND STOP COPIES             @Y30LB25*/ 08876000
*       /* FROM BEING MADE                                   @Y30LB25*/ 08877000
*       /*                                                           */ 08878000
*       /*************************************************************/ 08879000
*                                                                  2025 08880000
*       CALL ELACREN1;              /* CK COPIES             @Y30LB25*/ 08881000
         BAL   @14,ELACREN1                                        2025 08882000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 08883000
*         THEN                      /* YES                   @Y30LB25*/ 08884000
         L     @06,RPLVPTR                                         2026 08885000
         LH    @06,RPLVRETC(,@06)                                  2026 08886000
         N     @06,@CF01129                                        2026 08887000
         LTR   @06,@06                                             2026 08888000
         BNZ   @RT02026                                            2026 08889000
*         RETURN;                   /*                       @Y30LB25*/ 08890000
*     END;                          /*                       @Y30LB25*/ 08891000
*                                                                  2028 08892000
*   /*****************************************************************/ 08893000
*   /*                                                               */ 08894000
*   /* CREATE A PLACE HOLDER BVR FOR DEFVNVOL                @Y30LB25*/ 08895000
*   /*                                                               */ 08896000
*   /*****************************************************************/ 08897000
*                                                                  2029 08898000
*   BVOLKY=DEFVNVOL;                /* SET VOLID IN KEY      @Y30LB25*/ 08899000
@RF02013 MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2029 08900000
*   CALL CRTPHOLD;                  /* CRT PLACE HOLD BVR    @Y30LB25*/ 08901000
         BAL   @14,CRTPHOLD                                        2030 08902000
*   RETURN;                         /*                       @Y30LB25*/ 08903000
@EL00048 DS    0H                                                  2031 08904000
@EF00048 DS    0H                                                  2031 08905000
@ER00048 L     @14,@SA00048                                        2031 08906000
         BR    @14                                                 2031 08907000
*   END RENBVR1;                    /*                       @Y30LB25*/ 08908000
         B     @EL00048                                            2032 08909000
*                                                                  2033 08910000
*   /*****************************************************************/ 08911000
*   /*                                                               */ 08912000
*   /* PROCEDURE NAME - ELACREN1                             @Y30LB25*/ 08913000
*   /*                                                       @Y30LB25*/ 08914000
*   /* FUNCTION -                                            @Y30LB25*/ 08915000
*   /* MAKE CHECKS FOR RENAME AN ACTIVE OR INACTIVE          @Y30LB25*/ 08916000
*   /* VOLUME WHICH WILL RESULT IN A BVR OR DVR              @Y30LB25*/ 08917000
*   /* BEING CREATED. ALSO, MAKES CHECKS FOR ELIMINATE       @Y30LB25*/ 08918000
*   /* AN ACTIVE VOLUME. IN EITHER CASE, THE RESULT          @Y30LB25*/ 08919000
*   /* IS NO COPIES WILL BE ALLOWED. IT IT CALLED            @Y30LB25*/ 08920000
*   /* BEFORE THE MSC IS CALLED.                             @Y30LB25*/ 08921000
*   /*                                                       @Y30LB25*/ 08922000
*   /* INPUT -                                               @Y30LB25*/ 08923000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08924000
*   /* RPLVBUF - BVR RECORD MAPPED BY BCDVPTR                @Y30LB25*/ 08925000
*   /*                                                       @Y30LB25*/ 08926000
*   /* OUTPUT -                                              @Y30LB25*/ 08927000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08928000
*   /* AN ERROR                                              @Y30LB25*/ 08929000
*   /*                                                               */ 08930000
*   /*****************************************************************/ 08931000
*                                                                  2033 08932000
*ELACREN1:                          /*                       @Y30LB25*/ 08933000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08934000
*                                                                  2033 08935000
ELACREN1 ST    @14,@SA00049                                        2033 08936000
*   /*****************************************************************/ 08937000
*   /*                                                               */ 08938000
*   /* CHECK FOR RENAME AN INACTIVE VOLUME                   @Y30LB25*/ 08939000
*   /*                                                               */ 08940000
*   /*****************************************************************/ 08941000
*                                                                  2034 08942000
*   IF DEFVRNTR=ON                  /* RENAME INACT VOL?     @Y30LB25*/ 08943000
*     THEN                          /* YES                   @Y30LB25*/ 08944000
         TM    DEFVRNTR(DEFVPTR),B'00000100'                       2034 08945000
         BNO   @RF02034                                            2034 08946000
*     DO;                           /*                       @Y30LB25*/ 08947000
*                                                                  2035 08948000
*       /*************************************************************/ 08949000
*       /*                                                           */ 08950000
*       /* GET MSC RECORD TO BE RENAMED                      @Y30LB25*/ 08951000
*       /*                                                           */ 08952000
*       /*************************************************************/ 08953000
*                                                                  2036 08954000
*       IVOLKY=DEFVCSN1;            /* SET CSN IN CIR        @Y30LB25*/ 08955000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        2036 08956000
*       CALL GETRECUD;              /* GET RECORD            @Y30LB25*/ 08957000
         BAL   @14,GETRECUD                                        2037 08958000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 08959000
*         THEN                      /* YES                   @Y30LB25*/ 08960000
         L     @06,RPLVPTR                                         2038 08961000
         LH    @06,RPLVRETC(,@06)                                  2038 08962000
         N     @06,@CF01129                                        2038 08963000
         LTR   @06,@06                                             2038 08964000
         BNZ   @RT02038                                            2038 08965000
*         RETURN;                   /*                       @Y30LB25*/ 08966000
*                                                                  2039 08967000
*       /*************************************************************/ 08968000
*       /*                                                           */ 08969000
*       /* NEED ONLY A BVR                                   @Y30LB25*/ 08970000
*       /*                                                           */ 08971000
*       /*************************************************************/ 08972000
*                                                                  2040 08973000
*       BCDVPTR=ADDR(BASEBUF);      /* COMMON MAP            @Y30LB25*/ 08974000
         LA    @06,BASEBUF                                         2040 08975000
         ST    @06,BCDVPTR                                         2040 08976000
*       IF BCDCOPY=ON|BCDDUP=ON     /* DVR OR CVR?           @Y30LB25*/ 08977000
*         THEN                      /* YES                   @Y30LB25*/ 08978000
         TM    BCDCOPY(@06),B'00010100'                            2041 08979000
         BNZ   @RT02041                                            2041 08980000
*         RETURN;                   /*                       @Y30LB25*/ 08981000
*     END;                          /*                       @Y30LB25*/ 08982000
*                                                                  2043 08983000
*   /*****************************************************************/ 08984000
*   /*                                                               */ 08985000
*   /* RENAME AN ACTIVE VOLUME OR ELIMINATE AN ACTIVE        @Y30LB25*/ 08986000
*   /* VOLUME                                                @Y30LB25*/ 08987000
*   /*                                                               */ 08988000
*   /*****************************************************************/ 08989000
*                                                                  2044 08990000
*   ELSE                                                           2044 08991000
*     DO;                           /*                       @Y30LB25*/ 08992000
         B     @RC02034                                            2044 08993000
@RF02034 DS    0H                                                  2045 08994000
*       BVOLKY=DEFVOLD;             /* VOLID TO KEY          @Y30LB25*/ 08995000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2045 08996000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 08997000
         LA    @06,BKEY                                            2046 08998000
         L     @05,RPLVPTR                                         2046 08999000
         ST    @06,RPLVKEY(,@05)                                   2046 09000000
*       CALL READUPD1;              /* READ BVR              @Y30LB25*/ 09001000
         BAL   @14,READUPD1                                        2047 09002000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 09003000
*         THEN                      /* YES                   @Y30LB25*/ 09004000
         L     @06,RPLVPTR                                         2048 09005000
         LH    @06,RPLVRETC(,@06)                                  2048 09006000
         N     @06,@CF01129                                        2048 09007000
         LTR   @06,@06                                             2048 09008000
         BNZ   @RT02048                                            2048 09009000
*         RETURN;                   /*                       @Y30LB25*/ 09010000
*       BASEBUF=BASEBUF1;           /* SWAP BUFFERS          @Y30LB25*/ 09011000
         MVC   BASEBUF(224),BASEBUF1                               2050 09012000
*     END;                          /*                       @Y30LB25*/ 09013000
*                                                                  2051 09014000
*   /*****************************************************************/ 09015000
*   /*                                                               */ 09016000
*   /* CHECK FOR COPIES                                      @Y30LB25*/ 09017000
*   /*                                                               */ 09018000
*   /*****************************************************************/ 09019000
*                                                                  2052 09020000
*   BASEVPTR=ADDR(BASEBUF);         /* MAP BVR               @Y30LB25*/ 09021000
@RC02034 LA    @06,BASEBUF                                         2052 09022000
         ST    @06,BASEVPTR                                        2052 09023000
*   IF BASNCOPY¬=FIXZERO            /* ANY COPIES?           @Y30LB25*/ 09024000
*     THEN                          /* YES                   @Y30LB25*/ 09025000
         CLI   BASNCOPY(@06),0                                     2053 09026000
         BE    @RF02053                                            2053 09027000
*     DO;                           /*                       @Y30LB25*/ 09028000
*       RPLVRETC=FIXFOUR;           /* ERROR RETURN CODE     @Y30LB25*/ 09029000
         L     @06,RPLVPTR                                         2055 09030000
         MVC   RPLVRETC(2,@06),@CH00041                            2055 09031000
*       RPLRCODE=BVRWCOPS;          /* BVR HAS COPIES        @Y30LB25*/ 09032000
         MVC   RPLRCODE(2,@06),@CB00739                            2056 09033000
*       RETURN;                     /*                       @Y30LB25*/ 09034000
@EL00049 DS    0H                                                  2057 09035000
@EF00049 DS    0H                                                  2057 09036000
@ER00049 L     @14,@SA00049                                        2057 09037000
         BR    @14                                                 2057 09038000
*     END;                          /*                       @Y30LB25*/ 09039000
*                                                                  2058 09040000
*   /*****************************************************************/ 09041000
*   /*                                                               */ 09042000
*   /* ALLOW NO MORE COPIES                                  @Y30LB25*/ 09043000
*   /*                                                               */ 09044000
*   /*****************************************************************/ 09045000
*                                                                  2059 09046000
*   BASNOCPY=ON;                    /* CAN'T COPY            @Y30LB25*/ 09047000
*                                                                  2059 09048000
@RF02053 L     @06,BASEVPTR                                        2059 09049000
         OI    BASNOCPY(@06),B'01000000'                           2059 09050000
*   /*****************************************************************/ 09051000
*   /*                                                               */ 09052000
*   /* WRITE THE BVR                                         @Y30LB25*/ 09053000
*   /*                                                               */ 09054000
*   /*****************************************************************/ 09055000
*                                                                  2060 09056000
*   RPLVBUF=ADDR(BASEBUF);          /* RESET BUF ADDR        @Y30LB25*/ 09057000
         LA    @06,BASEBUF                                         2060 09058000
         L     @05,RPLVPTR                                         2060 09059000
         ST    @06,RPLVBUF(,@05)                                   2060 09060000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 09061000
         BAL   @14,WRITRECD                                        2061 09062000
*   RETURN;                         /*                       @Y30LB25*/ 09063000
         B     @EL00049                                            2062 09064000
*   END ELACREN1;                   /*                       @Y30LB25*/ 09065000
         B     @EL00049                                            2063 09066000
*                                                                  2064 09067000
*   /*****************************************************************/ 09068000
*   /*                                                               */ 09069000
*   /* PROCEDURE NAME - RENAME2                              @Y30LB25*/ 09070000
*   /*                                                       @Y30LB25*/ 09071000
*   /* FUNCTION -                                            @Y30LB25*/ 09072000
*   /* PROCESS THE RENAME OF AN ACTIVE OR INACTIVE           @Y30LB25*/ 09073000
*   /* VOLUME AFTER THE MSC WAS CALLED.                      @Y30LB25*/ 09074000
*   /*                                                       @Y30LB25*/ 09075000
*   /* INPUT -                                               @Y30LB25*/ 09076000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 09077000
*   /*                                                       @Y30LB25*/ 09078000
*   /* OUTPUT -                                              @Y30LB25*/ 09079000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 09080000
*   /* AN ERROR                                              @Y30LB25*/ 09081000
*   /*                                                               */ 09082000
*   /*****************************************************************/ 09083000
*                                                                  2064 09084000
*RENAME2:                           /*                       @Y30LB25*/ 09085000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 09086000
RENAME2  ST    @14,@SA00050                                        2064 09087000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @VS32198   09088000
*                                      RESERVE .MSVI         @VS32198*/ 09089000
*                                                                  2065 09090000
         BAL   @14,HOUSKEEP                                        2065 09091000
*   /*****************************************************************/ 09092000
*   /*                                                               */ 09093000
*   /* CHECK FOR AN MSC ERROR.                               @Y30LB25*/ 09094000
*   /*                                                               */ 09095000
*   /*****************************************************************/ 09096000
*                                                                  2066 09097000
*   IF RPLRCODE¬=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 09098000
*     THEN                          /* YES                   @Y30LB25*/ 09099000
         L     @06,RPLVPTR                                         2066 09100000
         LH    @15,RPLRCODE(,@06)                                  2066 09101000
         N     @15,@CF01129                                        2066 09102000
         LTR   @15,@15                                             2066 09103000
         BZ    @RF02066                                            2066 09104000
*     DO;                           /*                       @Y30LB25*/ 09105000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 09106000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2068 09107000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASN CODE       @Y30LB25*/ 09108000
*                                                                  2069 09109000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2069 09110000
*       /*************************************************************/ 09111000
*       /*                                                           */ 09112000
*       /* DELETE PLACE HOLDER BVR AND ALLOW COPIES,         @Y30LB25*/ 09113000
*       /* IF RENAME AN ACTIVE VOLUME AND THE NVOLID EQUALS  @Y30LB25*/ 09114000
*       /* THE OLD VOLID.                                    @Y30LB25*/ 09115000
*       /*                                                           */ 09116000
*       /*************************************************************/ 09117000
*                                                                  2070 09118000
*       IF DEFVRNM=ON&DEFVOLD¬=DEFVNVOL/* RENAME ACT VOL &   @Y30LB25*/ 09119000
*         THEN                      /* OVOLID ¬= NVOLID      @Y30LB25*/ 09120000
         TM    DEFVRNM(DEFVPTR),B'00100000'                        2070 09121000
         BNO   @RF02070                                            2070 09122000
         CLC   DEFVOLD(6,DEFVPTR),DEFVNVOL(DEFVPTR)                2070 09123000
         BE    @RF02070                                            2070 09124000
*         CALL RMSCERR2;            /* DELETE BEFORE MSC     @Y30LB25   09125000
*                                      PROCESSING            @Y30LB25*/ 09126000
*                                                                  2071 09127000
         BAL   @14,RMSCERR2                                        2071 09128000
*       /*************************************************************/ 09129000
*       /*                                                           */ 09130000
*       /* CHECK FOR RENAME AN INACTIVE VOLUME.              @Y30LB25*/ 09131000
*       /* DELETE PLACE HOLDER BVR AND ALLOW COPIES          @Y30LB25*/ 09132000
*       /* IF VOLIDS ARE NOT EQUAL.                          @Y30LB25*/ 09133000
*       /*                                                           */ 09134000
*       /*************************************************************/ 09135000
*                                                                  2072 09136000
*       IF DEFVRNTR=ON              /* RENAME INACT VOL?     @Y30LB25*/ 09137000
*         THEN                      /* YES                   @Y30LB25*/ 09138000
@RF02070 TM    DEFVRNTR(DEFVPTR),B'00000100'                       2072 09139000
         BNO   @RF02072                                            2072 09140000
*         DO;                       /*                       @Y30LB25*/ 09141000
*           IVOLKY=DEFVCSN1;        /* SET CSN IN KEY        @Y30LB25*/ 09142000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        2074 09143000
*           CALL GETRECLC;          /* GET BVR               @Y30LB25*/ 09144000
         BAL   @14,GETRECLC                                        2075 09145000
*           IF RPLVRETC¬=FIXZERO    /* ERROR?                @Y30LB25*/ 09146000
*             THEN                  /* YES                   @Y30LB25*/ 09147000
         L     @06,RPLVPTR                                         2076 09148000
         LH    @06,RPLVRETC(,@06)                                  2076 09149000
         N     @06,@CF01129                                        2076 09150000
         LTR   @06,@06                                             2076 09151000
         BNZ   @RT02076                                            2076 09152000
*             RETURN;               /*                       @Y30LB25*/ 09153000
*           IF BCDSERNO¬=DEFVNVOL   /* VOLS NOT =?           @Y30LB25*/ 09154000
*             THEN                  /* YES                   @Y30LB25*/ 09155000
         L     @06,BCDVPTR                                         2078 09156000
         CLC   BCDSERNO(6,@06),DEFVNVOL(DEFVPTR)                   2078 09157000
         BE    @RF02078                                            2078 09158000
*             CALL RMSCERR2;        /* DELETE BEFORE MSC     @Y30LB25   09159000
*                                      PROCESSING            @Y30LB25*/ 09160000
         BAL   @14,RMSCERR2                                        2079 09161000
*         END;                      /*                       @Y30LB25*/ 09162000
*                                                                  2080 09163000
@RF02078 DS    0H                                                  2081 09164000
*       /*************************************************************/ 09165000
*       /*                                                           */ 09166000
*       /* RETURN ZERO RETURN AND REASON CODE                @Y30LB25*/ 09167000
*       /*                                                           */ 09168000
*       /*************************************************************/ 09169000
*                                                                  2081 09170000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 09171000
@RF02072 L     @06,RPLVPTR                                         2081 09172000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2081 09173000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 09174000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2082 09175000
*       RETURN;                     /*                       @Y30LB25*/ 09176000
@EL00050 DS    0H                                                  2083 09177000
@EF00050 DS    0H                                                  2083 09178000
@ER00050 L     @14,@SA00050                                        2083 09179000
         BR    @14                                                 2083 09180000
*     END;                          /*                       @Y30LB25*/ 09181000
*                                                                  2084 09182000
*   /*****************************************************************/ 09183000
*   /*                                                               */ 09184000
*   /* GET THE MSVC RECORD FOR THE VOLUME TO BE RENAMED      @Y30LB25*/ 09185000
*   /*                                                               */ 09186000
*   /*****************************************************************/ 09187000
*                                                                  2085 09188000
*   CALL RDRENUPD;                  /* GET MSVC RECORD       @Y30LB25*/ 09189000
@RF02066 BAL   @14,RDRENUPD                                        2085 09190000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 09191000
*     THEN                          /* YES                   @Y30LB25*/ 09192000
         L     @06,RPLVPTR                                         2086 09193000
         LH    @06,RPLVRETC(,@06)                                  2086 09194000
         N     @06,@CF01129                                        2086 09195000
         LTR   @06,@06                                             2086 09196000
         BNZ   @RT02086                                            2086 09197000
*     RETURN;                       /*                       @Y30LB25*/ 09198000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/ 09199000
*                                                                  2088 09200000
         LA    @06,BASEBUF                                         2088 09201000
         ST    @06,BCDVPTR                                         2088 09202000
*   /*****************************************************************/ 09203000
*   /*                                                               */ 09204000
*   /* CHECK FOR RENAME AN ACTIVE VOLUME AND                 @Y30LB25*/ 09205000
*   /* OLD VOLID IS EQUAL TO NEW VOLID                       @Y30LB25*/ 09206000
*   /*                                                               */ 09207000
*   /*****************************************************************/ 09208000
*                                                                  2089 09209000
*   IF DEFVRNM=ON&DEFVOLD=DEFVNVOL  /* VOLIDS = &            @Y30LB25*/ 09210000
*     THEN                          /* RENAME ACT VOL?       @Y30LB25*/ 09211000
         TM    DEFVRNM(DEFVPTR),B'00100000'                        2089 09212000
         BNO   @RF02089                                            2089 09213000
         CLC   DEFVOLD(6,DEFVPTR),DEFVNVOL(DEFVPTR)                2089 09214000
         BNE   @RF02089                                            2089 09215000
*     DO;                           /* YES                   @Y30LB25*/ 09216000
*                                                                  2090 09217000
*       /*************************************************************/ 09218000
*       /*                                                           */ 09219000
*       /* CHECK FOR ICBDEFV EXTENSION                       @Y30LB25*/ 09220000
*       /*                                                           */ 09221000
*       /*************************************************************/ 09222000
*                                                                  2091 09223000
*       IF DEFVVEXT¬=FIXZERO        /* EXTENSION?            @Y30LB25*/ 09224000
*         THEN                      /* YES                   @Y30LB25*/ 09225000
         L     @06,DEFVVEXT(,DEFVPTR)                              2091 09226000
         LTR   @06,@06                                             2091 09227000
         BZ    @RF02091                                            2091 09228000
*         DO;                       /*                       @Y30LB25*/ 09229000
*           CALL PRODEFVE;          /* PROCESS EXTENS        @Y30LB25*/ 09230000
         BAL   @14,PRODEFVE                                        2093 09231000
*           IF RPLVRETC¬=FIXZERO    /* ERROR?                @Y30LB25*/ 09232000
*             THEN                  /* YES                   @Y30LB25*/ 09233000
         L     @06,RPLVPTR                                         2094 09234000
         LH    @06,RPLVRETC(,@06)                                  2094 09235000
         N     @06,@CF01129                                        2094 09236000
         LTR   @06,@06                                             2094 09237000
         BNZ   @RT02094                                            2094 09238000
*             RETURN;               /*                       @Y30LB25*/ 09239000
*         END;                      /*                       @Y30LB25*/ 09240000
*                                                                  2096 09241000
*       /*************************************************************/ 09242000
*       /*                                                           */ 09243000
*       /* MAKE BASE VOLUME INACTIVE                         @Y30LB25*/ 09244000
*       /*                                                           */ 09245000
*       /*************************************************************/ 09246000
*                                                                  2097 09247000
*       BASINAC=ON;                 /* INACT VOL             @Y30LB25*/ 09248000
*                                                                  2097 09249000
@RF02091 L     @06,BASEVPTR                                        2097 09250000
         OI    BASINAC(@06),B'00000100'                            2097 09251000
*       /*************************************************************/ 09252000
*       /*                                                           */ 09253000
*       /* CHECK OWNER ID                                    @Y30LB25*/ 09254000
*       /*                                                           */ 09255000
*       /*************************************************************/ 09256000
*                                                                  2098 09257000
*       IF DEFOWNID(1:10)¬=FIX10ZRO /* OWNER ID?             @Y30LB25*/ 09258000
*         THEN                      /* YES                   @Y30LB25*/ 09259000
         CLC   DEFOWNID(10,DEFVPTR),@CB00681                       2098 09260000
         BE    @RF02098                                            2098 09261000
*         BASOWNER=DEFOWNID;        /* SET NEW OWNER         @Y30LB25*/ 09262000
*                                                                  2099 09263000
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  2099 09264000
*       /*************************************************************/ 09265000
*       /*                                                           */ 09266000
*       /* CHECK IF ATTRIBUTES SPECIFIED                     @Y30LB25*/ 09267000
*       /*                                                           */ 09268000
*       /*************************************************************/ 09269000
*                                                                  2100 09270000
*       IF DEFVVFLG¬=FIX1F          /* NEW ATTRB?            @Y30LB25*/ 09271000
*         THEN                      /* YES                   @Y30LB25*/ 09272000
@RF02098 CLI   DEFVVFLG(DEFVPTR),X'FF'                             2100 09273000
         BE    @RF02100                                            2100 09274000
*         CALL SETATTRB;            /* SET ATTRIBUTES        @Y30LB25*/ 09275000
*                                                                  2101 09276000
         BAL   @14,SETATTRB                                        2101 09277000
*       /*************************************************************/ 09278000
*       /*                                                           */ 09279000
*       /* VOLUME IS NOW INACTIVE, UPDATE ITS GVR AND        @Y30LB25*/ 09280000
*       /* GVSNER SLOT AS NECESSARY.                         @Y30LB25*/ 09281000
*       /*                                                           */ 09282000
*       /*************************************************************/ 09283000
*                                                                  2102 09284000
*       CALL ACTINAC;               /* BVR INACT NOW         @Y30LB25*/ 09285000
@RF02100 BAL   @14,ACTINAC                                         2102 09286000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 09287000
*         THEN                      /* YES                   @Y30LB25*/ 09288000
         L     @06,RPLVPTR                                         2103 09289000
         LH    @06,RPLVRETC(,@06)                                  2103 09290000
         N     @06,@CF01129                                        2103 09291000
         LTR   @06,@06                                             2103 09292000
         BNZ   @RT02103                                            2103 09293000
*         RETURN;                   /*                       @Y30LB25*/ 09294000
*                                                                  2104 09295000
*       /*************************************************************/ 09296000
*       /*                                                           */ 09297000
*       /* REESTABLISH THE RPL FOR THE BVR                   @Y30LB25*/ 09298000
*       /*                                                           */ 09299000
*       /*************************************************************/ 09300000
*                                                                  2105 09301000
*       COPYBUF=BASEBUF;            /* SAVE BVR              @Y30LB25*/ 09302000
         MVC   COPYBUF(224),BASEBUF                                2105 09303000
*       CALL RDRENUPD;              /* GET MSVC RECORD       @Y30LB25*/ 09304000
         BAL   @14,RDRENUPD                                        2106 09305000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 09306000
*         THEN                      /* YES                   @Y30LB25*/ 09307000
         L     @06,RPLVPTR                                         2107 09308000
         LH    @15,RPLVRETC(,@06)                                  2107 09309000
         N     @15,@CF01129                                        2107 09310000
         LTR   @15,@15                                             2107 09311000
         BNZ   @RT02107                                            2107 09312000
*         RETURN;                   /*                       @Y30LB25*/ 09313000
*                                                                  2108 09314000
*       /*************************************************************/ 09315000
*       /*                                                           */ 09316000
*       /* WRITE THE BVR                                     @Y30LB25*/ 09317000
*       /*                                                           */ 09318000
*       /*************************************************************/ 09319000
*                                                                  2109 09320000
*       RPLVBUF=ADDR(COPYBUF);      /* ADDR OF BVR BUF       @Y30LB25*/ 09321000
         LA    @15,COPYBUF                                         2109 09322000
         ST    @15,RPLVBUF(,@06)                                   2109 09323000
*       CALL WRITRECD;              /* WRITE THE BVR         @Y30LB25*/ 09324000
         BAL   @14,WRITRECD                                        2110 09325000
*       RETURN;                     /*                       @Y30LB25*/ 09326000
         B     @EL00050                                            2111 09327000
*     END;                          /*                       @Y30LB25*/ 09328000
*                                                                  2112 09329000
*   /*****************************************************************/ 09330000
*   /*                                                               */ 09331000
*   /* CHECK FOR RENAME AN INACTIVE VOLUME AND               @Y30LB25*/ 09332000
*   /* OLD VOLID IS EQUAL TO NEW VOLID                       @Y30LB25*/ 09333000
*   /*                                                               */ 09334000
*   /*****************************************************************/ 09335000
*                                                                  2113 09336000
*   IF DEFVRNTR=ON&BCDSERNO=DEFVNVOL/* RENAME INACT VOL&     @Y30LB25*/ 09337000
*     THEN                          /* VOLIDS = ?            @Y30LB25*/ 09338000
@RF02089 TM    DEFVRNTR(DEFVPTR),B'00000100'                       2113 09339000
         BNO   @RF02113                                            2113 09340000
         L     @06,BCDVPTR                                         2113 09341000
         CLC   BCDSERNO(6,@06),DEFVNVOL(DEFVPTR)                   2113 09342000
         BNE   @RF02113                                            2113 09343000
*     DO;                           /* YES                   @Y30LB25*/ 09344000
*                                                                  2114 09345000
*       /*************************************************************/ 09346000
*       /*                                                           */ 09347000
*       /* CHECK FOR AN ICBDEFV EXTENSION AND A CVR OR BVR   @Y30LB25*/ 09348000
*       /*                                                           */ 09349000
*       /*************************************************************/ 09350000
*                                                                  2115 09351000
*       IF DEFVVEXT¬=FIXZERO&BCDDUP=OFF THEN                       2115 09352000
         L     @15,DEFVVEXT(,DEFVPTR)                              2115 09353000
         LTR   @15,@15                                             2115 09354000
         BZ    @RF02115                                            2115 09355000
         TM    BCDDUP(@06),B'00000100'                             2115 09356000
         BNZ   @RF02115                                            2115 09357000
*         DO;                       /*                       @Y30LB25*/ 09358000
*           CALL PRODEFVE;          /* PROCESS EXTENS        @Y30LB25*/ 09359000
         BAL   @14,PRODEFVE                                        2117 09360000
*           IF RPLVRETC¬=FIXZERO    /* ERROR?                @Y30LB25*/ 09361000
*             THEN                  /* YES                   @Y30LB25*/ 09362000
         L     @06,RPLVPTR                                         2118 09363000
         LH    @06,RPLVRETC(,@06)                                  2118 09364000
         N     @06,@CF01129                                        2118 09365000
         LTR   @06,@06                                             2118 09366000
         BNZ   @RT02118                                            2118 09367000
*             RETURN;               /*                       @Y30LB25*/ 09368000
*         END;                      /*                       @Y30LB25*/ 09369000
*                                                                  2120 09370000
*       /*************************************************************/ 09371000
*       /*                                                           */ 09372000
*       /* RENAME AN INACTIVE VOLUME TO ITSELF ONLY          @Y30LB25*/ 09373000
*       /* SUPPORTS OWNER ID AND ATTRIBITES IF THE VOLUME    @Y30LB25*/ 09374000
*       /* BEING RENAMED IS A BVR                            @Y30LB25*/ 09375000
*       /* CHECK OWNER ID                                    @Y30LB25*/ 09376000
*       /*                                                           */ 09377000
*       /*************************************************************/ 09378000
*                                                                  2121 09379000
*       IF DEFOWNID(1:10)¬=FIX10ZRO&BCDBASE=ON/*             @Y30LB25*/ 09380000
*         THEN                      /*                       @Y30LB25*/ 09381000
@RF02115 CLC   DEFOWNID(10,DEFVPTR),@CB00681                       2121 09382000
         BE    @RF02121                                            2121 09383000
         L     @06,BCDVPTR                                         2121 09384000
         TM    BCDBASE(@06),B'00100000'                            2121 09385000
         BNO   @RF02121                                            2121 09386000
*         BASOWNER=DEFOWNID;        /* SET NEW OWNER         @Y30LB25*/ 09387000
*                                                                  2122 09388000
         L     @06,BASEVPTR                                        2122 09389000
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  2122 09390000
*       /*************************************************************/ 09391000
*       /*                                                           */ 09392000
*       /* CHECK IF ATTRIBUTES SPECIFIED                     @Y30LB25*/ 09393000
*       /*                                                           */ 09394000
*       /*************************************************************/ 09395000
*                                                                  2123 09396000
*       IF DEFVVFLG¬=FIX1F&BCDBASE=ON/* NEW ATTRB?           @Y30LB25*/ 09397000
*         THEN                      /* YES                   @Y30LB25*/ 09398000
@RF02121 CLI   DEFVVFLG(DEFVPTR),X'FF'                             2123 09399000
         BE    @RF02123                                            2123 09400000
         L     @06,BCDVPTR                                         2123 09401000
         TM    BCDBASE(@06),B'00100000'                            2123 09402000
         BNO   @RF02123                                            2123 09403000
*         CALL SETATTRB;            /* SET ATTRIBUTES        @Y30LB25*/ 09404000
*                                                                  2124 09405000
         BAL   @14,SETATTRB                                        2124 09406000
*       /*************************************************************/ 09407000
*       /*                                                           */ 09408000
*       /* REESTABLISH THE RPL FOR THE BVR                   @Y30LB25*/ 09409000
*       /*                                                           */ 09410000
*       /*************************************************************/ 09411000
*                                                                  2125 09412000
*       COPYBUF=BASEBUF;            /* SAVE BVR              @Y30LB25*/ 09413000
@RF02123 MVC   COPYBUF(224),BASEBUF                                2125 09414000
*       CALL RDRENUPD;              /* GET MSVC RECORD       @Y30LB25*/ 09415000
         BAL   @14,RDRENUPD                                        2126 09416000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 09417000
*         THEN                      /* YES                   @Y30LB25*/ 09418000
         L     @06,RPLVPTR                                         2127 09419000
         LH    @15,RPLVRETC(,@06)                                  2127 09420000
         N     @15,@CF01129                                        2127 09421000
         LTR   @15,@15                                             2127 09422000
         BNZ   @RT02127                                            2127 09423000
*         RETURN;                   /*                       @Y30LB25*/ 09424000
*                                                                  2128 09425000
*       /*************************************************************/ 09426000
*       /*                                                           */ 09427000
*       /* WRITE THE BVR                                     @Y30LB25*/ 09428000
*       /*                                                           */ 09429000
*       /*************************************************************/ 09430000
*                                                                  2129 09431000
*       RPLVBUF=ADDR(COPYBUF);      /* ADDR OF BVR BUF       @Y30LB25*/ 09432000
         LA    @15,COPYBUF                                         2129 09433000
         ST    @15,RPLVBUF(,@06)                                   2129 09434000
*       CALL WRITRECD;              /* WRITE THE BVR         @Y30LB25*/ 09435000
         BAL   @14,WRITRECD                                        2130 09436000
*       RETURN;                     /*                       @Y30LB25*/ 09437000
         B     @EL00050                                            2131 09438000
*     END;                          /*                       @Y30LB25*/ 09439000
*                                                                  2132 09440000
*   /*****************************************************************/ 09441000
*   /*                                                               */ 09442000
*   /* OLD VOLID IS NOT EQUAL TO THE NEW VOLID.              @Y30LB25*/ 09443000
*   /* GET AND DELETE THE RECORD TO BE RENAMED.              @Y30LB25*/ 09444000
*   /* RECORD WILL BE RETURNED IN BASEBUF.                   @Y30LB25*/ 09445000
*   /* RECORD IS A CVR OR BVR OR DVR.                        @Y30LB25*/ 09446000
*   /*                                                               */ 09447000
*   /*****************************************************************/ 09448000
*                                                                  2133 09449000
*   CALL PROCDREC;                  /* DELT REN'D RECD       @Y30LB25*/ 09450000
@RF02113 BAL   @14,PROCDREC                                        2133 09451000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 09452000
*     THEN                          /* YES                   @Y30LB25*/ 09453000
         L     @06,RPLVPTR                                         2134 09454000
         LH    @15,RPLVRETC(,@06)                                  2134 09455000
         N     @15,@CF01129                                        2134 09456000
         LTR   @15,@15                                             2134 09457000
         BNZ   @RT02134                                            2134 09458000
*     RETURN;                       /*                       @Y30LB25*/ 09459000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/ 09460000
*                                                                  2136 09461000
         LA    @15,BASEBUF                                         2136 09462000
         ST    @15,BCDVPTR                                         2136 09463000
*   /*****************************************************************/ 09464000
*   /*                                                               */ 09465000
*   /* CHECK IF A PLACE HOLDER BVR EXISTS.                   @Y30LB25*/ 09466000
*   /*                                                               */ 09467000
*   /*****************************************************************/ 09468000
*                                                                  2137 09469000
*   BVOLKY=DEFVNVOL;                /* SET VOLID             @Y30LB25*/ 09470000
         MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2137 09471000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 09472000
         LA    @15,BKEY                                            2138 09473000
         ST    @15,RPLVKEY(,@06)                                   2138 09474000
*   CALL READUPD1;                  /* GET PLACE HOLD        @Y30LB25   09475000
*                                      BVR                   @Y30LB25*/ 09476000
         BAL   @14,READUPD1                                        2139 09477000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 09478000
*     THEN                          /* YES                   @Y30LB25*/ 09479000
         L     @06,RPLVPTR                                         2140 09480000
         LH    @06,RPLVRETC(,@06)                                  2140 09481000
         N     @06,@CF01129                                        2140 09482000
         LTR   @06,@06                                             2140 09483000
         BNZ   @RT02140                                            2140 09484000
*     RETURN;                       /*                       @Y30LB25*/ 09485000
*   BASEVPTR=ADDR(BASEBUF1);        /* MAP PLACE HOLD BVR    @Y30LB25*/ 09486000
*                                                                  2142 09487000
         LA    @06,BASEBUF1                                        2142 09488000
         ST    @06,BASEVPTR                                        2142 09489000
*   /*****************************************************************/ 09490000
*   /*                                                               */ 09491000
*   /* CHECK IF A DVR SHOULD BE CREATED.                     @Y30LB25*/ 09492000
*   /*                                                               */ 09493000
*   /*****************************************************************/ 09494000
*                                                                  2143 09495000
*   IF BASHOLD=OFF                  /* PLACE HOLD BVR?       @Y30LB25*/ 09496000
*     THEN                          /* NO                    @Y30LB25*/ 09497000
         TM    BASHOLD(@06),B'10000000'                            2143 09498000
         BNZ   @RF02143                                            2143 09499000
*     DO;                           /*                       @Y30LB25*/ 09500000
*                                                                  2144 09501000
*       /*************************************************************/ 09502000
*       /*                                                           */ 09503000
*       /* CREATE A DVR                                      @Y30LB25*/ 09504000
*       /*                                                           */ 09505000
*       /*************************************************************/ 09506000
*                                                                  2145 09507000
*       CALL CRTDVR;                /* CRT A DVR             @Y30LB25*/ 09508000
         BAL   @14,CRTDVR                                          2145 09509000
*       RETURN;                     /*                       @Y30LB25*/ 09510000
         B     @EL00050                                            2146 09511000
*     END;                          /*                       @Y30LB25*/ 09512000
*                                                                  2147 09513000
*   /*****************************************************************/ 09514000
*   /*                                                               */ 09515000
*   /* UPDATE PLACE HOLDER BVR                               @Y30LB25*/ 09516000
*   /*                                                               */ 09517000
*   /*****************************************************************/ 09518000
*                                                                  2148 09519000
*   BASCSN1=BCDCSN1;                /* SET CSN1              @Y30LB25*/ 09520000
@RF02143 L     @06,BASEVPTR                                        2148 09521000
         L     @15,BCDVPTR                                         2148 09522000
         MVC   BASCSN1(12,@06),BCDCSN1(@15)                        2148 09523000
*   BASCSN2=BCDCSN2;                /* SET CSN2              @Y30LB25*/ 09524000
         MVC   BASCSN2(12,@06),BCDCSN2(@15)                        2149 09525000
*   BASLIB1=BCDLIB1;                /* SET LIB ID 1          @Y30LB25*/ 09526000
         IC    @14,BCDLIB1(,@15)                                   2150 09527000
         STC   @14,BASLIB1(,@06)                                   2150 09528000
*   BASLIB2=BCDLIB2;                /* SET LIB ID 2          @Y30LB25*/ 09529000
         IC    @14,BCDLIB2(,@15)                                   2151 09530000
         STC   @14,BASLIB2(,@06)                                   2151 09531000
*   BASHOLD=OFF;                    /* NO PLAC HOLD          @Y30LB25*/ 09532000
         NI    BASHOLD(@06),B'01111111'                            2152 09533000
*   BASPREV=BLANK6;                 /* NO PREV BVR           @Y30LB25*/ 09534000
         MVI   BASPREV+1(@06),C' '                                 2153 09535000
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     2153 09536000
         MVI   BASPREV(@06),C' '                                   2153 09537000
*   BASNEXTV=BLANK6;                /* NO NEXT BVR           @Y30LB25*/ 09538000
         MVI   BASNEXTV+1(@06),C' '                                2154 09539000
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   2154 09540000
         MVI   BASNEXTV(@06),C' '                                  2154 09541000
*   BASGROUP=BLANK8;                /* NO GROUP              @Y30LB25*/ 09542000
         MVI   BASGROUP+1(@06),C' '                                2155 09543000
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   2155 09544000
         MVI   BASGROUP(@06),C' '                                  2155 09545000
*   BASBKLMT=FIXONE;                /* BACKUP LMT            @Y30LB25*/ 09546000
         MVI   BASBKLMT(@06),X'01'                                 2156 09547000
*   BASDLMTD=BLANK4;                /* NO MOUNT DATE         @Y30LB25*/ 09548000
         MVI   BASDLMTD+1(@06),C' '                                2157 09549000
         MVC   BASDLMTD+2(2,@06),BASDLMTD+1(@06)                   2157 09550000
         MVI   BASDLMTD(@06),C' '                                  2157 09551000
*   BASDTREM=BLANK4;                /* NO EJECT DATE         @Y30LB25*/ 09552000
         MVI   BASDTREM+1(@06),C' '                                2158 09553000
         MVC   BASDTREM+2(2,@06),BASDTREM+1(@06)                   2158 09554000
         MVI   BASDTREM(@06),C' '                                  2158 09555000
*   BASEXPDT=FIX4FS;                /* NO EXPIR DATE         @Y30LB25*/ 09556000
         MVC   BASEXPDT(4,@06),@CB00677                            2159 09557000
*   BASDESCR=BLANK30;               /* NO DESCRIPT           @Y30LB25*/ 09558000
         MVI   BASDESCR+1(@06),C' '                                2160 09559000
         MVC   BASDESCR+2(28,@06),BASDESCR+1(@06)                  2160 09560000
         MVI   BASDESCR(@06),C' '                                  2160 09561000
*   BASOWNER=BLANK10;               /* NO OWNER              @Y30LB25*/ 09562000
         MVI   BASOWNER+1(@06),C' '                                2161 09563000
         MVC   BASOWNER+2(8,@06),BASOWNER+1(@06)                   2161 09564000
         MVI   BASOWNER(@06),C' '                                  2161 09565000
*   BASRECOV=BLANK6;                /* RECOVERY SER #        @Y30LB25*/ 09566000
         MVI   BASRECOV+1(@06),C' '                                2162 09567000
         MVC   BASRECOV+2(4,@06),BASRECOV+1(@06)                   2162 09568000
         MVI   BASRECOV(@06),C' '                                  2162 09569000
*   BASDEST=BLANK30;                /* NO DESTINATION        @Y30LB25*/ 09570000
         MVI   BASDEST+1(@06),C' '                                 2163 09571000
         MVC   BASDEST+2(28,@06),BASDEST+1(@06)                    2163 09572000
         MVI   BASDEST(@06),C' '                                   2163 09573000
*   BASKLCPY=BLANK13;               /* NO LATEST COPY        @Y30LB25*/ 09574000
*                                                                  2164 09575000
         MVC   BASKLCPY(13,@06),@CC00692                           2164 09576000
*   /*****************************************************************/ 09577000
*   /*                                                               */ 09578000
*   /* CHECK IF UPDATING FROM A CVR                          @Y30LB25*/ 09579000
*   /*                                                               */ 09580000
*   /*****************************************************************/ 09581000
*                                                                  2165 09582000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 09583000
*     THEN                          /* YES                   @Y30LB25*/ 09584000
         TM    BCDCOPY(@15),B'00010000'                            2165 09585000
         BNO   @RF02165                                            2165 09586000
*     DO;                           /*                       @Y30LB25*/ 09587000
*       COPYVPTR=BCDVPTR;           /* MAP CVR TO BE         @Y30LB25   09588000
*                                      RENAMED               @Y30LB25*/ 09589000
         ST    @15,COPYVPTR                                        2167 09590000
*       BASOWNER=COPOWNER;          /* SET OWNER             #Y30LB25*/ 09591000
         MVC   BASOWNER(10,@06),COPOWNER(@15)                      2168 09592000
*       BASDESCR=COPDESCR;          /* SET DESCRIPTION       #Y30LB25*/ 09593000
         MVC   BASDESCR(30,@06),COPDESCR(@15)                      2169 09594000
*       BASFREXT=COPFREXT;          /* SET FREE EXTENT       #Y30LB25*/ 09595000
         L     @14,COPFREXT(,@15)                                  2170 09596000
         ST    @14,BASFREXT(,@06)                                  2170 09597000
*       BASLEXT=COPLEXT;            /* SET LARGE FREE EXT    #Y30LB25*/ 09598000
         LH    @14,COPLEXT(,@15)                                   2171 09599000
         STH   @14,BASLEXT(,@06)                                   2171 09600000
*       BASFRESP=COPFRESP;          /* SET FREE SPACE        #Y30LB25*/ 09601000
*                                                                  2172 09602000
         LH    @14,COPFRESP(,@15)                                  2172 09603000
         STH   @14,BASFRESP(,@06)                                  2172 09604000
*       /*************************************************************/ 09605000
*       /*                                                           */ 09606000
*       /* SET BIND                                          #Y30LB25*/ 09607000
*       /*                                                           */ 09608000
*       /*************************************************************/ 09609000
*                                                                  2173 09610000
*       IF COPBIND=ON               /* BIND?                 #Y30LB25*/ 09611000
*         THEN                      /* YES                   #Y30LB25*/ 09612000
         TM    COPBIND(@15),B'00000100'                            2173 09613000
         BNO   @RF02173                                            2173 09614000
*         BASBIND=ON;               /* BIND                  #Y30LB25*/ 09615000
         OI    BASBIND(@06),B'00000010'                            2174 09616000
*       ELSE                                                       2175 09617000
*         BASBIND=OFF;              /* NO BIND               #Y30LB25*/ 09618000
*                                                                  2175 09619000
         B     @RC02173                                            2175 09620000
@RF02173 L     @06,BASEVPTR                                        2175 09621000
         NI    BASBIND(@06),B'11111101'                            2175 09622000
*       /*************************************************************/ 09623000
*       /*                                                           */ 09624000
*       /* SET EXCLUSIVE                                     #Y30LB25*/ 09625000
*       /*                                                           */ 09626000
*       /*************************************************************/ 09627000
*                                                                  2176 09628000
*       IF COPEXCL=ON               /* EXCLUSIVE?            #Y30LB25*/ 09629000
*         THEN                      /* YES                   #Y30LB25*/ 09630000
@RC02173 L     @06,COPYVPTR                                        2176 09631000
         TM    COPEXCL(@06),B'00000010'                            2176 09632000
         BNO   @RF02176                                            2176 09633000
*         BASEXCL=ON;               /* EXCLUSIVE             #Y30LB25*/ 09634000
         L     @06,BASEVPTR                                        2177 09635000
         OI    BASEXCL(@06),B'00000001'                            2177 09636000
*       ELSE                                                       2178 09637000
*         BASEXCL=OFF;              /* NO EXCL               #Y30LB25*/ 09638000
*                                                                  2178 09639000
         B     @RC02176                                            2178 09640000
@RF02176 L     @06,BASEVPTR                                        2178 09641000
         NI    BASEXCL(@06),B'11111110'                            2178 09642000
*       /*************************************************************/ 09643000
*       /*                                                           */ 09644000
*       /* SET DASD ERASE (SECURE)                           #Y30LB25*/ 09645000
*       /*                                                           */ 09646000
*       /*************************************************************/ 09647000
*                                                                  2179 09648000
*       IF COPDAERA=ON              /* SECURE?               #Y30LB25*/ 09649000
*         THEN                      /* YES                   #Y30LB25*/ 09650000
@RC02176 L     @06,COPYVPTR                                        2179 09651000
         TM    COPDAERA(@06),B'00000001'                           2179 09652000
         BNO   @RF02179                                            2179 09653000
*         BASDAERA=ON;              /* SECURE                #Y30LB25*/ 09654000
         L     @06,BASEVPTR                                        2180 09655000
         OI    BASDAERA(@06),B'10000000'                           2180 09656000
*       ELSE                                                       2181 09657000
*         BASDAERA=OFF;             /* NO SECURE             #Y30LB25*/ 09658000
*                                                                  2181 09659000
         B     @RC02179                                            2181 09660000
@RF02179 L     @06,BASEVPTR                                        2181 09661000
         NI    BASDAERA(@06),B'01111111'                           2181 09662000
*       /*************************************************************/ 09663000
*       /*                                                           */ 09664000
*       /* SET READ ONLY                                     #Y30LB25*/ 09665000
*       /*                                                           */ 09666000
*       /*************************************************************/ 09667000
*                                                                  2182 09668000
*       IF COPRONLY=ON              /* READ ONLY?            #Y30LB25*/ 09669000
*         THEN                      /* YES                   #Y30LB25*/ 09670000
@RC02179 L     @06,COPYVPTR                                        2182 09671000
         TM    COPRONLY(@06),B'10000000'                           2182 09672000
         BNO   @RF02182                                            2182 09673000
*         BASRONLY=ON;              /* READ ONLY             #Y30LB25*/ 09674000
         L     @06,BASEVPTR                                        2183 09675000
         OI    BASRONLY(@06),B'01000000'                           2183 09676000
*       ELSE                                                       2184 09677000
*         BASRONLY=OFF;             /* NO READ ONLY          #Y30LB25*/ 09678000
*                                                                  2184 09679000
         B     @RC02182                                            2184 09680000
@RF02182 L     @06,BASEVPTR                                        2184 09681000
         NI    BASRONLY(@06),B'10111111'                           2184 09682000
*       /*************************************************************/ 09683000
*       /*                                                           */ 09684000
*       /* SET DOWN LEVEL SPACE                              #Y30LB25*/ 09685000
*       /*                                                           */ 09686000
*       /*************************************************************/ 09687000
*                                                                  2185 09688000
*       IF COPDLSPF=ON              /* DOWN LEVEL SPC?       #Y30LB25*/ 09689000
*         THEN                      /* YES                   #Y30LB25*/ 09690000
@RC02182 L     @06,COPYVPTR                                        2185 09691000
         TM    COPDLSPF(@06),B'01000000'                           2185 09692000
         BNO   @RF02185                                            2185 09693000
*         BASDLSF=ON;               /* DOWN LEVEL SPC        #Y30LB25*/ 09694000
         L     @06,BASEVPTR                                        2186 09695000
         OI    BASDLSF(@06),B'10000000'                            2186 09696000
*       ELSE                                                       2187 09697000
*         BASDLSF=OFF;              /* NO DWN LEV SPC        #Y30LB25*/ 09698000
         B     @RC02185                                            2187 09699000
@RF02185 L     @06,BASEVPTR                                        2187 09700000
         NI    BASDLSF(@06),B'01111111'                            2187 09701000
*     END;                          /*                       #Y30LB25*/ 09702000
*                                                                  2188 09703000
@RC02185 DS    0H                                                  2189 09704000
*   /*****************************************************************/ 09705000
*   /*                                                               */ 09706000
*   /* CHECK IF UPDATING FROM A BVR                          #Y30LB25*/ 09707000
*   /*                                                               */ 09708000
*   /*****************************************************************/ 09709000
*                                                                  2189 09710000
*   IF BCDBASE=ON                   /* BVR?                  #Y30LB25*/ 09711000
*     THEN                          /* YES                   #Y30LB25*/ 09712000
@RF02165 L     @06,BCDVPTR                                         2189 09713000
         TM    BCDBASE(@06),B'00100000'                            2189 09714000
         BNO   @RF02189                                            2189 09715000
*     DO;                           /*                       #Y30LB25*/ 09716000
*                                                                  2190 09717000
*       /*************************************************************/ 09718000
*       /*                                                           */ 09719000
*       /* SET BIND                                          #Y30LB25*/ 09720000
*       /*                                                           */ 09721000
*       /*************************************************************/ 09722000
*                                                                  2191 09723000
*       IF BCDVPTR->BASBIND=ON      /* BIND?                 @ZA17177*/ 09724000
*         THEN                      /* YES                   #Y30LB25*/ 09725000
         TM    BASBIND(@06),B'00000010'                            2191 09726000
         BNO   @RF02191                                            2191 09727000
*         BASBIND=ON;               /* BIND                  #Y30LB25*/ 09728000
         L     @06,BASEVPTR                                        2192 09729000
         OI    BASBIND(@06),B'00000010'                            2192 09730000
*       ELSE                                                       2193 09731000
*         BASBIND=OFF;              /* NO BIND               #Y30LB25*/ 09732000
*                                                                  2193 09733000
         B     @RC02191                                            2193 09734000
@RF02191 L     @06,BASEVPTR                                        2193 09735000
         NI    BASBIND(@06),B'11111101'                            2193 09736000
*       /*************************************************************/ 09737000
*       /*                                                           */ 09738000
*       /* SET EXCLUSIVE                                     #Y30LB25*/ 09739000
*       /*                                                           */ 09740000
*       /*************************************************************/ 09741000
*                                                                  2194 09742000
*       IF BCDVPTR->BASEXCL=ON      /* EXCLUSIVE?            @ZA17177*/ 09743000
*         THEN                      /* YES                   #Y30LB25*/ 09744000
@RC02191 L     @06,BCDVPTR                                         2194 09745000
         TM    BASEXCL(@06),B'00000001'                            2194 09746000
         BNO   @RF02194                                            2194 09747000
*         BASEXCL=ON;               /* EXCLUSIVE             #Y30LB25*/ 09748000
         L     @06,BASEVPTR                                        2195 09749000
         OI    BASEXCL(@06),B'00000001'                            2195 09750000
*       ELSE                                                       2196 09751000
*         BASEXCL=OFF;              /* NO EXCL               #Y30LB25*/ 09752000
*                                                                  2196 09753000
         B     @RC02194                                            2196 09754000
@RF02194 L     @06,BASEVPTR                                        2196 09755000
         NI    BASEXCL(@06),B'11111110'                            2196 09756000
*       /*************************************************************/ 09757000
*       /*                                                           */ 09758000
*       /* SET DASD ERASE (SECURE)                           #Y30LB25*/ 09759000
*       /*                                                           */ 09760000
*       /*************************************************************/ 09761000
*                                                                  2197 09762000
*       IF BCDVPTR->BASDAERA=ON     /* SECURE?               @ZA17177*/ 09763000
*         THEN                      /* YES                   #Y30LB25*/ 09764000
@RC02194 L     @06,BCDVPTR                                         2197 09765000
         TM    BASDAERA(@06),B'10000000'                           2197 09766000
         BNO   @RF02197                                            2197 09767000
*         BASDAERA=ON;              /* SECURE                #Y30LB25*/ 09768000
         L     @06,BASEVPTR                                        2198 09769000
         OI    BASDAERA(@06),B'10000000'                           2198 09770000
*       ELSE                                                       2199 09771000
*         BASDAERA=OFF;             /* NO SECURE             #Y30LB25*/ 09772000
*                                                                  2199 09773000
         B     @RC02197                                            2199 09774000
@RF02197 L     @06,BASEVPTR                                        2199 09775000
         NI    BASDAERA(@06),B'01111111'                           2199 09776000
*       /*************************************************************/ 09777000
*       /*                                                           */ 09778000
*       /* SET READ ONLY                                     #Y30LB25*/ 09779000
*       /*                                                           */ 09780000
*       /*************************************************************/ 09781000
*                                                                  2200 09782000
*       IF BCDVPTR->BASRONLY=ON     /* READ ONLY?            @ZA17177*/ 09783000
*         THEN                      /* YES                   #Y30LB25*/ 09784000
@RC02197 L     @06,BCDVPTR                                         2200 09785000
         TM    BASRONLY(@06),B'01000000'                           2200 09786000
         BNO   @RF02200                                            2200 09787000
*         BASRONLY=ON;              /* READ ONLY             #Y30LB25*/ 09788000
         L     @06,BASEVPTR                                        2201 09789000
         OI    BASRONLY(@06),B'01000000'                           2201 09790000
*       ELSE                                                       2202 09791000
*         BASRONLY=OFF;             /* NO READ ONLY          #Y30LB25*/ 09792000
*                                                                  2202 09793000
         B     @RC02200                                            2202 09794000
@RF02200 L     @06,BASEVPTR                                        2202 09795000
         NI    BASRONLY(@06),B'10111111'                           2202 09796000
*       /*************************************************************/ 09797000
*       /*                                                           */ 09798000
*       /* SET DOWN LEVEL SPACE                              #Y30LB25*/ 09799000
*       /*                                                           */ 09800000
*       /*************************************************************/ 09801000
*                                                                  2203 09802000
*       IF BCDVPTR->BASDLSF=ON      /* DOWN LEVEL SPC?       @ZA17177*/ 09803000
*         THEN                      /* YES                   #Y30LB25*/ 09804000
@RC02200 L     @06,BCDVPTR                                         2203 09805000
         TM    BASDLSF(@06),B'10000000'                            2203 09806000
         BNO   @RF02203                                            2203 09807000
*         BASDLSF=ON;               /* DOWN LEVEL SPC        #Y30LB25*/ 09808000
         L     @06,BASEVPTR                                        2204 09809000
         OI    BASDLSF(@06),B'10000000'                            2204 09810000
*       ELSE                                                       2205 09811000
*         BASDLSF=OFF;              /* NO DWN LEV SPC        #Y30LB25*/ 09812000
*                                                                  2205 09813000
         B     @RC02203                                            2205 09814000
@RF02203 L     @06,BASEVPTR                                        2205 09815000
         NI    BASDLSF(@06),B'01111111'                            2205 09816000
*       /*************************************************************/ 09817000
*       /*                                                           */ 09818000
*       /* SET OTHER BVR FIELDS                              #Y30LB25*/ 09819000
*       /*                                                           */ 09820000
*       /*************************************************************/ 09821000
*                                                                  2206 09822000
*       BASBKLMT=BCDVPTR->BASBKLMT; /* BACKUP LMT            @ZA17177*/ 09823000
@RC02203 L     @06,BASEVPTR                                        2206 09824000
         L     @15,BCDVPTR                                         2206 09825000
         IC    @14,BASBKLMT(,@15)                                  2206 09826000
         STC   @14,BASBKLMT(,@06)                                  2206 09827000
*       BASFRESP=BCDVPTR->BASFRESP; /* FREE SPACE            @ZA17177*/ 09828000
         LH    @14,BASFRESP(,@15)                                  2207 09829000
         N     @14,@CF01129                                        2207 09830000
         STH   @14,BASFRESP(,@06)                                  2207 09831000
*       BASLEXT=BCDVPTR->BASLEXT;   /* LARGEST FREE EXTNT    @ZA17177*/ 09832000
         LH    @14,BASLEXT(,@15)                                   2208 09833000
         N     @14,@CF01129                                        2208 09834000
         STH   @14,BASLEXT(,@06)                                   2208 09835000
*       BASFREXT=BCDVPTR->BASFREXT; /* FREE EXTENTS          @ZA17177*/ 09836000
         L     @14,BASFREXT(,@15)                                  2209 09837000
         ST    @14,BASFREXT(,@06)                                  2209 09838000
*       BASDLMTD=BCDVPTR->BASDLMTD; /* DATE LAST MNTD        @ZA17177*/ 09839000
         MVC   BASDLMTD(4,@06),BASDLMTD(@15)                       2210 09840000
*       BASEXPDT=BCDVPTR->BASEXPDT; /* EXPIRDATE             @ZA17177*/ 09841000
         MVC   BASEXPDT(4,@06),BASEXPDT(@15)                       2211 09842000
*       BASDESCR=BCDVPTR->BASDESCR; /* DESCRIPTION           @ZA17177*/ 09843000
         MVC   BASDESCR(30,@06),BASDESCR(@15)                      2212 09844000
*       BASOWNER=BCDVPTR->BASOWNER; /* OWNER                 @ZA17177*/ 09845000
*                                                                  2213 09846000
         MVC   BASOWNER(10,@06),BASOWNER(@15)                      2213 09847000
*       /*************************************************************/ 09848000
*       /*                                                           */ 09849000
*       /* PUT GROUP NAME IN EXTENSION IF NOT THERE          @ZA17177*/ 09850000
*       /*                                                           */ 09851000
*       /*************************************************************/ 09852000
*                                                                  2214 09853000
*       IF DEFVVEXT¬=FIXZERO&DEFPGRO=OFF&/* IS THERE EXT     @ZA17177*/ 09854000
*           BCDVPTR->BASGRPV=ON THEN/* IS THERE GRP          @ZA17177*/ 09855000
         L     @06,DEFVVEXT(,DEFVPTR)                              2214 09856000
         LTR   @06,@06                                             2214 09857000
         BZ    @RF02214                                            2214 09858000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       2214 09859000
         BNZ   @RF02214                                            2214 09860000
         TM    BASGRPV(@15),B'00100000'                            2214 09861000
         BNO   @RF02214                                            2214 09862000
*         DO;                       /* YES                   @ZA17177*/ 09863000
*           DEFGROUP=BCDVPTR->BASGROUP;/* PUT GRP NAME IN EXT      2216 09864000
*                                                            @ZA17177*/ 09865000
         MVC   DEFGROUP(8,DEFVEPTR),BASGROUP(@15)                  2216 09866000
*           DEFPGRO=ON;             /* TURN GRP FLG ON       @ZA17177*/ 09867000
         OI    DEFPGRO(DEFVEPTR),B'00100000'                       2217 09868000
*           IF BCDVPTR->BASGENUS=ON THEN/* IS THIS VOL GEN USE     2218 09869000
*                                                            @ZA17177*/ 09870000
         TM    BASGENUS(@15),B'00010000'                           2218 09871000
         BNO   @RF02218                                            2218 09872000
*             DEFGENUS=ON;          /* GEN USE BIT IN EXT    @ZA17177*/ 09873000
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      2219 09874000
*           ELSE                                                   2220 09875000
*             DEFRSTD=ON;           /* RSTD BIT ON IN EXT    @ZA17177*/ 09876000
         B     @RC02218                                            2220 09877000
@RF02218 OI    DEFRSTD(DEFVEPTR),B'01000000'                       2220 09878000
*         END;                      /*                       @ZA17177*/ 09879000
@RC02218 DS    0H                                                  2222 09880000
*     END;                          /*                       @ZA28475*/ 09881000
*                                                                  2222 09882000
@RF02214 DS    0H                                                  2223 09883000
*   /*****************************************************************/ 09884000
*   /*                                                               */ 09885000
*   /* CHECK IF ATTRIBUTES CHANGED                           #Y30LB25*/ 09886000
*   /*                                                               */ 09887000
*   /*****************************************************************/ 09888000
*                                                                  2223 09889000
*   IF DEFVVFLG¬=FIX1F              /* ATTRIBUTES?           #Y30LB25*/ 09890000
*     THEN                          /* YES                   #Y30LB25*/ 09891000
@RF02189 CLI   DEFVVFLG(DEFVPTR),X'FF'                             2223 09892000
         BE    @RF02223                                            2223 09893000
*     CALL SETATTRB;                /* SET ATTRIBUTES        #Y30LB25*/ 09894000
*                                                                  2224 09895000
         BAL   @14,SETATTRB                                        2224 09896000
*   /*****************************************************************/ 09897000
*   /*                                                               */ 09898000
*   /* CHECK OWNER                                           #Y30LB25*/ 09899000
*   /*                                                               */ 09900000
*   /*****************************************************************/ 09901000
*                                                                  2225 09902000
*   IF DEFOWNID(1:10)¬=FIX10ZRO     /* OWNER SPECIFIED?      #Y30LB25*/ 09903000
*     THEN                          /* YES                   #Y30LB25*/ 09904000
@RF02223 CLC   DEFOWNID(10,DEFVPTR),@CB00681                       2225 09905000
         BE    @RF02225                                            2225 09906000
*     BASOWNER=DEFOWNID;            /* SET NEW OWNER         #Y30LB25*/ 09907000
*                                                                  2226 09908000
         L     @06,BASEVPTR                                        2226 09909000
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  2226 09910000
*   /*****************************************************************/ 09911000
*   /*                                                               */ 09912000
*   /* UPDATE THE EXISTING CIRS                              #Y30LB25*/ 09913000
*   /*                                                               */ 09914000
*   /*****************************************************************/ 09915000
*                                                                  2227 09916000
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUFFER    #Y30LB25*/ 09917000
@RF02225 MVC   BASEBUF(224),BASEBUF1                               2227 09918000
*   BASEVPTR=ADDR(BASEBUF);         /* RESET MAPPING         #Y30LB25*/ 09919000
         LA    @06,BASEBUF                                         2228 09920000
         ST    @06,BASEVPTR                                        2228 09921000
*   BCDVPTR=BASEVPTR;               /* COMMON MAP            #Y30LB25*/ 09922000
         ST    @06,BCDVPTR                                         2229 09923000
*   CALL UPDCIR;                    /* UPDT CIRS             @Y30LB25*/ 09924000
         BAL   @14,UPDCIR                                          2230 09925000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 09926000
*     THEN                          /* YES                   @Y30LB25*/ 09927000
         L     @06,RPLVPTR                                         2231 09928000
         LH    @06,RPLVRETC(,@06)                                  2231 09929000
         N     @06,@CF01129                                        2231 09930000
         LTR   @06,@06                                             2231 09931000
         BNZ   @RT02231                                            2231 09932000
*     RETURN;                       /*                       @Y30LB25*/ 09933000
*                                                                  2232 09934000
*   /*****************************************************************/ 09935000
*   /*                                                               */ 09936000
*   /* CHAIN BVR INTO NGVR                                   @Y30LB25*/ 09937000
*   /*                                                               */ 09938000
*   /*****************************************************************/ 09939000
*                                                                  2233 09940000
*   GRPFLG=OFF;                     /* CHAIN INTO NGVR       @Y30LB25*/ 09941000
         NI    GRPFLG,B'11101111'                                  2233 09942000
*   CALL VUCHI;                     /* CHAIN IN              @Y30LB25*/ 09943000
         BAL   @14,VUCHI                                           2234 09944000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 09945000
*     THEN                          /* YES                   @Y30LB25*/ 09946000
         L     @06,RPLVPTR                                         2235 09947000
         LH    @06,RPLVRETC(,@06)                                  2235 09948000
         N     @06,@CF01129                                        2235 09949000
         LTR   @06,@06                                             2235 09950000
         BNZ   @RT02235                                            2235 09951000
*     RETURN;                       /*                       @Y30LB25*/ 09952000
*                                                                  2236 09953000
*   /*****************************************************************/ 09954000
*   /*                                                               */ 09955000
*   /* CHECK FOR AN ICBDEFV EXTENSION                        @Y30LB25*/ 09956000
*   /*                                                               */ 09957000
*   /*****************************************************************/ 09958000
*                                                                  2237 09959000
*   IF DEFVVEXT¬=FIXZERO            /* EXTENSION?            @Y30LB25*/ 09960000
*     THEN                          /* YES                   @Y30LB25*/ 09961000
         L     @06,DEFVVEXT(,DEFVPTR)                              2237 09962000
         LTR   @06,@06                                             2237 09963000
         BZ    @RF02237                                            2237 09964000
*     DO;                           /*                       @Y30LB25*/ 09965000
*       CALL PRODEFVE;              /* PROCESS EXTEN         @Y30LB25*/ 09966000
         BAL   @14,PRODEFVE                                        2239 09967000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 09968000
*         THEN                      /* YES                   @Y30LB25*/ 09969000
         L     @06,RPLVPTR                                         2240 09970000
         LH    @06,RPLVRETC(,@06)                                  2240 09971000
         N     @06,@CF01129                                        2240 09972000
         LTR   @06,@06                                             2240 09973000
         BNZ   @RT02240                                            2240 09974000
*         RETURN;                   /*                       @Y30LB25*/ 09975000
*     END;                          /*                       @Y30LB25*/ 09976000
*                                                                  2242 09977000
*   /*****************************************************************/ 09978000
*   /*                                                               */ 09979000
*   /* REESTABLISH THE BVR'S RPLV                            @Y30LB25*/ 09980000
*   /*                                                               */ 09981000
*   /*****************************************************************/ 09982000
*                                                                  2243 09983000
*   BVOLKY=DEFVNVOL;                /* SET VOLID             @Y30LB25*/ 09984000
@RF02237 MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2243 09985000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 09986000
         LA    @06,BKEY                                            2244 09987000
         L     @01,RPLVPTR                                         2244 09988000
         ST    @06,RPLVKEY(,@01)                                   2244 09989000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 09990000
         BAL   @14,READUPD1                                        2245 09991000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 09992000
*     THEN                          /* YES                   @Y30LB25*/ 09993000
         L     @06,RPLVPTR                                         2246 09994000
         LH    @15,RPLVRETC(,@06)                                  2246 09995000
         N     @15,@CF01129                                        2246 09996000
         LTR   @15,@15                                             2246 09997000
         BNZ   @RT02246                                            2246 09998000
*     RETURN;                       /*                       @Y30LB25*/ 09999000
*                                                                  2247 10000000
*   /*****************************************************************/ 10001000
*   /*                                                               */ 10002000
*   /* WRITE THE BVR                                         @Y30LB25*/ 10003000
*   /*                                                               */ 10004000
*   /*****************************************************************/ 10005000
*                                                                  2248 10006000
*   RPLVBUF=ADDR(BASEBUF);          /* SET BVR BUFF ADDR     @Y30LB25*/ 10007000
         LA    @15,BASEBUF                                         2248 10008000
         ST    @15,RPLVBUF(,@06)                                   2248 10009000
*   CALL WRITRECD;                  /* WRITE THE BVR         @Y30LB25*/ 10010000
         BAL   @14,WRITRECD                                        2249 10011000
*   RETURN;                         /*                       @Y30LB25*/ 10012000
         B     @EL00050                                            2250 10013000
*   END RENAME2;                    /*                       @Y30LB25*/ 10014000
         B     @EL00050                                            2251 10015000
*                                                                  2252 10016000
*   /*****************************************************************/ 10017000
*   /*                                                               */ 10018000
*   /* PROCEDURE NAME - SETATTRB                             @Y30LB25*/ 10019000
*   /*                                                       @Y30LB25*/ 10020000
*   /* FUNCTION -                                            @Y30LB25*/ 10021000
*   /* SET THE VOLUME ATTRIBUTES IN THE BVR FROM             @Y30LB25*/ 10022000
*   /* THOSE SPECIFIED IN THE ICBDEFV EXTENSION.             @Y30LB25*/ 10023000
*   /*                                                       @Y30LB25*/ 10024000
*   /* INPUT -                                               @Y30LB25*/ 10025000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 10026000
*   /* ICBDEFV EXTENSION                                     @Y30LB25*/ 10027000
*   /*                                                       @Y30LB25*/ 10028000
*   /* OUTPUT -                                              @Y30LB25*/ 10029000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 10030000
*   /*                                                               */ 10031000
*   /*****************************************************************/ 10032000
*                                                                  2252 10033000
*SETATTRB:                          /*                       @Y30LB25*/ 10034000
*   PROC OPTIONS(NOSAVEAREA);       /*                       @ZDR2054*/ 10035000
*                                                                  2252 10036000
SETATTRB STM   @14,@12,12(@13)                                     2252 10037000
*   /*****************************************************************/ 10038000
*   /*                                                               */ 10039000
*   /* CHECK EXCLUSIVE                                       @Y30LB25*/ 10040000
*   /*                                                               */ 10041000
*   /*****************************************************************/ 10042000
*                                                                  2253 10043000
*   IF DEFVEXCL=ON                  /* EXCLUSIVE?            @Y30LB25*/ 10044000
*     THEN                          /* YES                   @Y30LB25*/ 10045000
         TM    DEFVEXCL(DEFVPTR),B'00010000'                       2253 10046000
         BNO   @RF02253                                            2253 10047000
*     BASEXCL=ON;                   /* EXCLUSIVE             @Y30LB25*/ 10048000
         L     @06,BASEVPTR                                        2254 10049000
         OI    BASEXCL(@06),B'00000001'                            2254 10050000
*   ELSE                                                           2255 10051000
*     BASEXCL=OFF;                  /* NO EXCLUSIVE          @Y30LB25*/ 10052000
*                                                                  2255 10053000
         B     @RC02253                                            2255 10054000
@RF02253 L     @06,BASEVPTR                                        2255 10055000
         NI    BASEXCL(@06),B'11111110'                            2255 10056000
*   /*****************************************************************/ 10057000
*   /*                                                               */ 10058000
*   /* CHECK BIND                                            @Y30LB25*/ 10059000
*   /*                                                               */ 10060000
*   /*****************************************************************/ 10061000
*                                                                  2256 10062000
*   IF DEFVBIND=ON                  /* BIND?                 @Y30LB25*/ 10063000
*     THEN                          /* YES                   @Y30LB25*/ 10064000
@RC02253 TM    DEFVBIND(DEFVPTR),B'00000100'                       2256 10065000
         BNO   @RF02256                                            2256 10066000
*     BASBIND=ON;                   /* BIND                  @Y30LB25*/ 10067000
         L     @06,BASEVPTR                                        2257 10068000
         OI    BASBIND(@06),B'00000010'                            2257 10069000
*   ELSE                                                           2258 10070000
*     BASBIND=OFF;                  /* NO BIND               @Y30LB25*/ 10071000
*                                                                  2258 10072000
         B     @RC02256                                            2258 10073000
@RF02256 L     @06,BASEVPTR                                        2258 10074000
         NI    BASBIND(@06),B'11111101'                            2258 10075000
*   /*****************************************************************/ 10076000
*   /*                                                               */ 10077000
*   /* CHECK READ ONLY                                       @Y30LB25*/ 10078000
*   /*                                                               */ 10079000
*   /*****************************************************************/ 10080000
*                                                                  2259 10081000
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/ 10082000
*     THEN                          /* YES                   @Y30LB25*/ 10083000
@RC02256 TM    DEFVWINH(DEFVPTR),B'00000010'                       2259 10084000
         BNO   @RF02259                                            2259 10085000
*     BASRONLY=ON;                  /* READ ONLY             @Y30LB25*/ 10086000
         L     @06,BASEVPTR                                        2260 10087000
         OI    BASRONLY(@06),B'01000000'                           2260 10088000
*   ELSE                                                           2261 10089000
*     BASRONLY=OFF;                 /* NO READ ONLY          @Y30LB25*/ 10090000
*                                                                  2261 10091000
         B     @RC02259                                            2261 10092000
@RF02259 L     @06,BASEVPTR                                        2261 10093000
         NI    BASRONLY(@06),B'10111111'                           2261 10094000
*   /*****************************************************************/ 10095000
*   /*                                                               */ 10096000
*   /* CHECK DASD ERASE                                      @Y30LB25*/ 10097000
*   /*                                                               */ 10098000
*   /*****************************************************************/ 10099000
*                                                                  2262 10100000
*   IF DEFVSEC=ON                   /* SECURE?               @Y30LB25*/ 10101000
*     THEN                          /* YES                   @Y30LB25*/ 10102000
@RC02259 TM    DEFVSEC(DEFVPTR),B'00100000'                        2262 10103000
         BNO   @RF02262                                            2262 10104000
*     BASDAERA=ON;                  /* DASD ERASE            @Y30LB25*/ 10105000
         L     @06,BASEVPTR                                        2263 10106000
         OI    BASDAERA(@06),B'10000000'                           2263 10107000
*   ELSE                                                           2264 10108000
*     BASDAERA=OFF;                 /* NO SECURE             @Y30LB25*/ 10109000
         B     @RC02262                                            2264 10110000
@RF02262 L     @06,BASEVPTR                                        2264 10111000
         NI    BASDAERA(@06),B'01111111'                           2264 10112000
*   RETURN;                         /*                       @Y30LB25*/ 10113000
@EL00051 DS    0H                                                  2265 10114000
@EF00051 DS    0H                                                  2265 10115000
@ER00051 LM    @14,@12,12(@13)                                     2265 10116000
         BR    @14                                                 2265 10117000
*   END SETATTRB;                   /*                       @Y30LB25*/ 10118000
         B     @EL00051                                            2266 10119000
*                                                                  2267 10120000
*   /*****************************************************************/ 10121000
*   /*                                                               */ 10122000
*   /* PROCEDURE NAME - RMSCERR2                             @Y30LB25*/ 10123000
*   /*                                                       @Y30LB25*/ 10124000
*   /* FUNCTION -                                            @Y30LB25*/ 10125000
*   /* IF A PLACE HOLDER BVR EXISTS FOR DEFVNVOL, DELETE     @Y30LB25*/ 10126000
*   /* IT. ALLOW THE BASE VOLUME RECORD WHICH WAS            @Y30LB25*/ 10127000
*   /* TO BE RENAMED TO BE COPIED.                           @Y30LB25*/ 10128000
*   /*                                                       @Y30LB25*/ 10129000
*   /* INPUT -                                               @Y30LB25*/ 10130000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10131000
*   /*                                                       @Y30LB25*/ 10132000
*   /* OUTPUT -                                              @Y30LB25*/ 10133000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10134000
*   /* AN ERROR                                              @Y30LB25*/ 10135000
*   /*                                                               */ 10136000
*   /*****************************************************************/ 10137000
*                                                                  2267 10138000
*RMSCERR2:                          /*                       @Y30LB25*/ 10139000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10140000
*                                                                  2267 10141000
RMSCERR2 ST    @14,@SA00052                                        2267 10142000
*   /*****************************************************************/ 10143000
*   /*                                                               */ 10144000
*   /* CHECK FOR PLACE HOLDER BVR AND IF FOUND DELETE IT.    @Y30LB25*/ 10145000
*   /*                                                               */ 10146000
*   /*****************************************************************/ 10147000
*                                                                  2268 10148000
*   BVOLKY=DEFVNVOL;                /* SET VOLID             @Y30LB25*/ 10149000
         MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2268 10150000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 10151000
         L     @06,RPLVPTR                                         2269 10152000
         LA    @05,BKEY                                            2269 10153000
         ST    @05,RPLVKEY(,@06)                                   2269 10154000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFFER ADDR           @Y30LB25*/ 10155000
         LA    @05,BASEBUF                                         2270 10156000
         ST    @05,RPLVBUF(,@06)                                   2270 10157000
*   RPLVBLN=LENGTH(BASEBUF);        /* SET BUFF LENGTH       @Y30LB25*/ 10158000
         MVC   RPLVBLN(4,@06),@CF01103                             2271 10159000
*   CALL DELTRECD;                  /* DELETE BVR            @Y30LB25*/ 10160000
*                                                                  2272 10161000
         BAL   @14,DELTRECD                                        2272 10162000
*   /*****************************************************************/ 10163000
*   /*                                                               */ 10164000
*   /* CLEAR RETURN/REASON CODES, ONLY MSC CODES             @Y30LB25*/ 10165000
*   /* WILL BE RETURNED.                                     @Y30LB25*/ 10166000
*   /*                                                               */ 10167000
*   /*****************************************************************/ 10168000
*                                                                  2273 10169000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* CLEAR RETN CODE       @Y30LB25*/ 10170000
         L     @06,RPLVPTR                                         2273 10171000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2273 10172000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CLEAR REAS CODE       @Y30LB25*/ 10173000
*                                                                  2274 10174000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2274 10175000
*   /*****************************************************************/ 10176000
*   /*                                                               */ 10177000
*   /* GET BVR WHICH WAS TO BE RENAMED.                      @Y30LB25*/ 10178000
*   /* CHECK FOR RENAME AN INACTIVE VOLUME                   @Y30LB25*/ 10179000
*   /*                                                               */ 10180000
*   /*****************************************************************/ 10181000
*                                                                  2275 10182000
*   CALL RDRENUPD;                  /* GET MSVC RECORD       @Y30LB25*/ 10183000
         BAL   @14,RDRENUPD                                        2275 10184000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 10185000
*     THEN                          /* YES                   @Y30LB25*/ 10186000
         L     @06,RPLVPTR                                         2276 10187000
         LH    @05,RPLVRETC(,@06)                                  2276 10188000
         N     @05,@CF01129                                        2276 10189000
         LTR   @05,@05                                             2276 10190000
         BNZ   @RT02276                                            2276 10191000
*     RETURN;                       /*                       @Y30LB25*/ 10192000
*                                                                  2277 10193000
*   /*****************************************************************/ 10194000
*   /*                                                               */ 10195000
*   /* RECORD RETURNED IN BASEBUF                            @Y30LB25*/ 10196000
*   /*                                                               */ 10197000
*   /*****************************************************************/ 10198000
*                                                                  2278 10199000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/ 10200000
         LA    @05,BASEBUF                                         2278 10201000
         ST    @05,BCDVPTR                                         2278 10202000
*   IF BCDCOPY=ON|BCDDUP=ON         /* CVR OR DVR?           @Y30LB25*/ 10203000
*     THEN                          /* YES                   @Y30LB25*/ 10204000
         TM    BCDCOPY(@05),B'00010100'                            2279 10205000
         BNZ   @RT02279                                            2279 10206000
*     RETURN;                       /*                       @Y30LB25*/ 10207000
*                                                                  2280 10208000
*   /*****************************************************************/ 10209000
*   /*                                                               */ 10210000
*   /* ALLOW COPIES AND WRITE THE BVR.                       @Y30LB25*/ 10211000
*   /*                                                               */ 10212000
*   /*****************************************************************/ 10213000
*                                                                  2281 10214000
*   BASNOCPY=OFF;                   /* ALLOW COPIES          @Y30LB25*/ 10215000
         L     @01,BASEVPTR                                        2281 10216000
         NI    BASNOCPY(@01),B'10111111'                           2281 10217000
*   RPLVBUF=ADDR(BASEBUF);          /* INSURE CORRECT BUF    @Y30LB25*/ 10218000
         ST    @05,RPLVBUF(,@06)                                   2282 10219000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 10220000
         BAL   @14,WRITRECD                                        2283 10221000
*   RETURN;                         /*                       @Y30LB25*/ 10222000
@EL00052 DS    0H                                                  2284 10223000
@EF00052 DS    0H                                                  2284 10224000
@ER00052 L     @14,@SA00052                                        2284 10225000
         BR    @14                                                 2284 10226000
*   END RMSCERR2;                   /*                       @Y30LB25*/ 10227000
         B     @EL00052                                            2285 10228000
*                                                                  2286 10229000
*   /*****************************************************************/ 10230000
*   /*                                                               */ 10231000
*   /* PROCEDURE NAME - PROCDREC                             @Y30LB25*/ 10232000
*   /*                                                       @Y30LB25*/ 10233000
*   /* FUNCTION -                                            @Y30LB25*/ 10234000
*   /* DELETE A BVR OR CVR OR DVR WHICH IS TO BE RENAMED.    @Y30LB25*/ 10235000
*   /* IF A BVR, UPDATE ITS GVR OR NGVR AND IF ACTIVE ITS    @Y30LB25*/ 10236000
*   /* GVSNER SLOT. IF A CVR, UPDATE ITS BVR.                @Y30LB25*/ 10237000
*   /*                                                       @Y30LB25*/ 10238000
*   /* INPUT -                                               @Y30LB25*/ 10239000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10240000
*   /*                                                       @Y30LB25*/ 10241000
*   /* OUTPUT -                                              @Y30LB25*/ 10242000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10243000
*   /* AN ERROR                                              @Y30LB25*/ 10244000
*   /*                                                               */ 10245000
*   /*****************************************************************/ 10246000
*                                                                  2286 10247000
*PROCDREC:                          /*                       @Y30LB25*/ 10248000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10249000
*                                                                  2286 10250000
PROCDREC ST    @14,@SA00053                                        2286 10251000
*   /*****************************************************************/ 10252000
*   /*                                                               */ 10253000
*   /* GET AND DELETE THE CVR OR BVR OR DVR TO BE RENAMED.   @Y30LB25*/ 10254000
*   /* THE DELETED RECORD WILL BE IN BASEBUF UPON            @Y30LB25*/ 10255000
*   /* RETURN.                                               @Y30LB25*/ 10256000
*   /*                                                               */ 10257000
*   /*****************************************************************/ 10258000
*                                                                  2287 10259000
*   CALL RDRENUPD;                  /* GET MSVC RECD TO      @Y30LB25   10260000
*                                      BE RENAMED            @Y30LB25*/ 10261000
         BAL   @14,RDRENUPD                                        2287 10262000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 10263000
*     THEN                          /* YES                   @Y30LB25*/ 10264000
         L     @06,RPLVPTR                                         2288 10265000
         LH    @15,RPLVRETC(,@06)                                  2288 10266000
         N     @15,@CF01129                                        2288 10267000
         LTR   @15,@15                                             2288 10268000
         BNZ   @RT02288                                            2288 10269000
*     RETURN;                       /*                       @Y30LB25*/ 10270000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Y30LB25*/ 10271000
         MVI   RPLVTYP(@06),X'05'                                  2290 10272000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Y30LB25*/ 10273000
         LA    @15,BASEBUF                                         2291 10274000
         ST    @15,RPLVBUF(,@06)                                   2291 10275000
*   RESPECIFY                                                      2292 10276000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 10277000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 10278000
         LR    RG1,@06                                             2293 10279000
*   CALL ICBVIO00;                  /* DELETE MSVC RECD              */ 10280000
         L     @15,@CV00762                                        2294 10281000
         BALR  @14,@15                                             2294 10282000
*   RESPECIFY                                                      2295 10283000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 10284000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 10285000
*     THEN                          /* YES                   @Y30LB25*/ 10286000
         L     @06,RPLVPTR                                         2296 10287000
         LH    @06,RPLVRETC(,@06)                                  2296 10288000
         N     @06,@CF01129                                        2296 10289000
         LTR   @06,@06                                             2296 10290000
         BNZ   @RT02296                                            2296 10291000
*     RETURN;                       /*                       @Y30LB25*/ 10292000
*                                                                  2297 10293000
*   /*****************************************************************/ 10294000
*   /*                                                               */ 10295000
*   /* CHECK FOR DELETION OF A BVR OR A CVR                  @Y30LB25*/ 10296000
*   /*                                                               */ 10297000
*   /*****************************************************************/ 10298000
*                                                                  2298 10299000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/ 10300000
*                                                                  2298 10301000
         LA    @06,BASEBUF                                         2298 10302000
         ST    @06,BCDVPTR                                         2298 10303000
*   /*****************************************************************/ 10304000
*   /*                                                               */ 10305000
*   /* CHECK FOR RENAME A BVR.                               @Y30LB25*/ 10306000
*   /* UPDATE ITS GVR OR NGVR.                               @Y30LB25*/ 10307000
*   /*                                                               */ 10308000
*   /*****************************************************************/ 10309000
*                                                                  2299 10310000
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/ 10311000
*     THEN                          /* YES                   @Y30LB25*/ 10312000
         TM    BCDBASE(@06),B'00100000'                            2299 10313000
         BNO   @RF02299                                            2299 10314000
*     DO;                           /*                       @Y30LB25*/ 10315000
*                                                                  2300 10316000
*       /*************************************************************/ 10317000
*       /*                                                           */ 10318000
*       /* CHECK IF GROUPED                                  @Y30LB25*/ 10319000
*       /*                                                           */ 10320000
*       /*************************************************************/ 10321000
*                                                                  2301 10322000
*       IF BASGRPV=ON               /* GROUPED?              @Y30LB25*/ 10323000
*         THEN                      /* YES                   @Y30LB25*/ 10324000
         L     @06,BASEVPTR                                        2301 10325000
         TM    BASGRPV(@06),B'00100000'                            2301 10326000
         BNO   @RF02301                                            2301 10327000
*         DO;                       /*                       @Y30LB25*/ 10328000
*                                                                  2302 10329000
*           /*********************************************************/ 10330000
*           /*                                                       */ 10331000
*           /* CHECK FOR INACTIVE                            @Y30LB25*/ 10332000
*           /*                                                       */ 10333000
*           /*********************************************************/ 10334000
*                                                                  2303 10335000
*           IF BASINAC=ON           /* INACTIVE?             @Y30LB25*/ 10336000
*             THEN                  /* YES                   @Y30LB25*/ 10337000
         TM    BASINAC(@06),B'00000100'                            2303 10338000
         BNO   @RF02303                                            2303 10339000
*             DO;                   /*                       @Y30LB25*/ 10340000
*               CALL INACGVR;       /* DEC # INAC VOLS       @Y30LB25*/ 10341000
         BAL   @14,INACGVR                                         2305 10342000
*               IF RPLVRETC¬=FIXZERO/* ERROR?                @Y30LB25*/ 10343000
*                 THEN              /* YES                   @Y30LB25*/ 10344000
         L     @06,RPLVPTR                                         2306 10345000
         LH    @06,RPLVRETC(,@06)                                  2306 10346000
         N     @06,@CF01129                                        2306 10347000
         LTR   @06,@06                                             2306 10348000
         BNZ   @RT02306                                            2306 10349000
*                 RETURN;           /*                       @Y30LB25*/ 10350000
*             END;                  /*                       @Y30LB25*/ 10351000
*                                                                  2308 10352000
*           /*********************************************************/ 10353000
*           /*                                                       */ 10354000
*           /* IT IS ACTIVE                                  @Y30LB25*/ 10355000
*           /*                                                       */ 10356000
*           /*********************************************************/ 10357000
*                                                                  2309 10358000
*           ELSE                    /* ACTIVE                @Y30LB25*/ 10359000
*             DO;                   /*                       @Y30LB25*/ 10360000
*                                                                  2309 10361000
         B     @RC02303                                            2309 10362000
@RF02303 DS    0H                                                  2310 10363000
*               /*****************************************************/ 10364000
*               /*                                                   */ 10365000
*               /* UPDATE GVR                                @Y30LB25*/ 10366000
*               /*                                                   */ 10367000
*               /*****************************************************/ 10368000
*                                                                  2310 10369000
*               CALL ACTGVR;        /* READ GVR              @Y30LB25*/ 10370000
         BAL   @14,ACTGVR                                          2310 10371000
*               IF RPLVRETC¬=FIXZERO/* ERROR?                @Y30LB25*/ 10372000
*                 THEN              /* YES                   @Y30LB25*/ 10373000
         L     @06,RPLVPTR                                         2311 10374000
         LH    @06,RPLVRETC(,@06)                                  2311 10375000
         N     @06,@CF01129                                        2311 10376000
         LTR   @06,@06                                             2311 10377000
         BNZ   @RT02311                                            2311 10378000
*                 RETURN;           /*                       @Y30LB25*/ 10379000
*             END;                  /*                       @Y30LB25*/ 10380000
*         END;                      /*                       @Y30LB25*/ 10381000
*                                                                  2314 10382000
@RC02303 DS    0H                                                  2315 10383000
*       /*************************************************************/ 10384000
*       /*                                                           */ 10385000
*       /* PROCESS BVR                                       @Y30LB25*/ 10386000
*       /*                                                           */ 10387000
*       /*************************************************************/ 10388000
*                                                                  2315 10389000
*       CALL PROCBVR;               /* PROCESS BVR           @Y30LB25*/ 10390000
@RF02301 BAL   @14,PROCBVR                                         2315 10391000
*     END;                          /*                       @Y30LB25*/ 10392000
*                                                                  2316 10393000
*   /*****************************************************************/ 10394000
*   /*                                                               */ 10395000
*   /* CHECK FOR RENAME A CVR.                               @Y30LB25*/ 10396000
*   /*                                                               */ 10397000
*   /*****************************************************************/ 10398000
*                                                                  2317 10399000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 10400000
*     THEN                          /* YES                   @Y30LB25*/ 10401000
@RF02299 L     @06,BCDVPTR                                         2317 10402000
         TM    BCDCOPY(@06),B'00010000'                            2317 10403000
         BNO   @RF02317                                            2317 10404000
*     DO;                           /*                       @Y30LB25*/ 10405000
*       ADDSUB=OFF;                 /* DELETE CVR            @Y30LB25*/ 10406000
         NI    ADDSUB,B'10111111'                                  2319 10407000
*       CALL ICBVUBVR(BCDVPTR,RPLVPTR,PASSBYTE);/*           @Y30LB25   10408000
*                                      UPDATE CVR'S BVR      @Y30LB25*/ 10409000
         L     @15,@CV00769                                        2320 10410000
         LA    @01,@AL02320                                        2320 10411000
         BALR  @14,@15                                             2320 10412000
*     END;                          /*                       @Y30LB25*/ 10413000
*   RETURN;                         /*                       @Y30LB25*/ 10414000
@EL00053 DS    0H                                                  2322 10415000
@EF00053 DS    0H                                                  2322 10416000
@ER00053 L     @14,@SA00053                                        2322 10417000
         BR    @14                                                 2322 10418000
*   END PROCDREC;                   /*                       @Y30LB25*/ 10419000
         B     @EL00053                                            2323 10420000
*                                                                  2324 10421000
*   /*****************************************************************/ 10422000
*   /*                                                               */ 10423000
*   /* PROCEDURE NAME - ACTGVR                               @Y30LB25*/ 10424000
*   /*                                                       @Y30LB25*/ 10425000
*   /* FUNCTION -                                            @Y30LB25*/ 10426000
*   /* DECREMENT EITHER THE NUMBER OF GENERAL-USE            @Y30LB25*/ 10427000
*   /* OR THE NUMBER OF RESTRICTED VOLUMES KEPT IN           @Y30LB25*/ 10428000
*   /* THE GROUP VOLUME RECORD. DECREMENT SPACE              @Y30LB25*/ 10429000
*   /* COUNT IN THE GROUP RECORD. DONE FOR AN ACTIVE         @Y30LB25*/ 10430000
*   /* VOLUME BEING DELETED.                                 @Y30LB25*/ 10431000
*   /*                                                       @Y30LB25*/ 10432000
*   /* INPUT -                                               @Y30LB25*/ 10433000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10434000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 10435000
*   /*                                                       @Y30LB25*/ 10436000
*   /* OUTPUT -                                              @Y30LB25*/ 10437000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10438000
*   /* AN ERROR                                              @Y30LB25*/ 10439000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 10440000
*   /*                                                               */ 10441000
*   /*****************************************************************/ 10442000
*                                                                  2324 10443000
*ACTGVR:                            /*                       @Y30LB25*/ 10444000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10445000
ACTGVR   ST    @14,@SA00054                                        2324 10446000
*   GROUPKY=BASGROUP;               /* SET GROUP NAME        @Y30LB25*/ 10447000
         L     @06,BASEVPTR                                        2325 10448000
         MVC   GROUPKY(8),BASGROUP(@06)                            2325 10449000
*   RPLVKEY=ADDR(GKEY);             /* SET KEY ADDR          @Y30LB25*/ 10450000
         LA    @06,GKEY                                            2326 10451000
         L     @01,RPLVPTR                                         2326 10452000
         ST    @06,RPLVKEY(,@01)                                   2326 10453000
*   CALL READUPD1;                  /* READ GVR              @Y30LB25*/ 10454000
         BAL   @14,READUPD1                                        2327 10455000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 10456000
*     THEN                          /* YES                   @Y30LB25*/ 10457000
         L     @06,RPLVPTR                                         2328 10458000
         LH    @06,RPLVRETC(,@06)                                  2328 10459000
         N     @06,@CF01129                                        2328 10460000
         LTR   @06,@06                                             2328 10461000
         BNZ   @RT02328                                            2328 10462000
*     RETURN;                       /*                       @Y30LB25*/ 10463000
*                                                                  2329 10464000
*   /*****************************************************************/ 10465000
*   /*                                                               */ 10466000
*   /* DECREMENT TYPE OF VOLUME COUNT                        @Y30LB25*/ 10467000
*   /*                                                               */ 10468000
*   /*****************************************************************/ 10469000
*                                                                  2330 10470000
*   GROUPBUF=BASEBUF1;              /* USE CORRECT BUF       @Y30LB25*/ 10471000
         MVC   GROUPBUF(224),BASEBUF1                              2330 10472000
*   IF BASGENUS=ON                  /* GENERAL-USE?          @Y30LB25*/ 10473000
*     THEN                          /* YES                   @Y30LB25*/ 10474000
         L     @06,BASEVPTR                                        2331 10475000
         TM    BASGENUS(@06),B'00010000'                           2331 10476000
         BNO   @RF02331                                            2331 10477000
*     DO;                           /*                       @Y30LB25*/ 10478000
*       GRONGEN=GRONGEN-FIXONE;     /* DEC # GEN-USE         @Y30LB25*/ 10479000
*                                                                  2333 10480000
         L     @06,GROUPPTR                                        2333 10481000
         LH    @15,GRONGEN(,@06)                                   2333 10482000
         BCTR  @15,0                                               2333 10483000
         STH   @15,GRONGEN(,@06)                                   2333 10484000
*       /*************************************************************/ 10485000
*       /*                                                           */ 10486000
*       /* UPDATE THE GVR                                    @Y30LB25*/ 10487000
*       /*                                                           */ 10488000
*       /*************************************************************/ 10489000
*                                                                  2334 10490000
*       ADDSUBGR=OFF;               /* SUBTRACT              @Y30LB25*/ 10491000
         NI    ADDSUBGR,B'11110111'                                2334 10492000
*       CALL VUPGH;                 /* UPDATE GVR            @Y30LB25*/ 10493000
         BAL   @14,VUPGH                                           2335 10494000
*     END;                          /*                       @Y30LB25*/ 10495000
*   ELSE                            /* RESTRICTED            @Y30LB25*/ 10496000
*     IF BASRSTD=ON                 /* RESTRICTED?           @Y30LB25*/ 10497000
*       THEN                        /* YES                   @Y30LB25*/ 10498000
         B     @RC02331                                            2337 10499000
@RF02331 L     @06,BASEVPTR                                        2337 10500000
         TM    BASRSTD(@06),B'00001000'                            2337 10501000
         BNO   @RF02337                                            2337 10502000
*       GRONRSTD=GRONRSTD-FIXONE;   /* DEC # RESTD VOLS      @Y30LB25*/ 10503000
*                                                                  2338 10504000
         L     @06,GROUPPTR                                        2338 10505000
         LH    @15,GRONRSTD(,@06)                                  2338 10506000
         BCTR  @15,0                                               2338 10507000
         STH   @15,GRONRSTD(,@06)                                  2338 10508000
*   /*****************************************************************/ 10509000
*   /*                                                               */ 10510000
*   /* WRITE GVR                                             @Y30LB25*/ 10511000
*   /*                                                               */ 10512000
*   /*****************************************************************/ 10513000
*                                                                  2339 10514000
*   RPLVBUF=ADDR(GROUPBUF);         /* SET BUFF ADDR         @Y30LB25*/ 10515000
@RF02337 DS    0H                                                  2339 10516000
@RC02331 LA    @06,GROUPBUF                                        2339 10517000
         L     @01,RPLVPTR                                         2339 10518000
         ST    @06,RPLVBUF(,@01)                                   2339 10519000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 10520000
         BAL   @14,WRITRECD                                        2340 10521000
*   RETURN;                         /*                       @Y30LB25*/ 10522000
@EL00054 DS    0H                                                  2341 10523000
@EF00054 DS    0H                                                  2341 10524000
@ER00054 L     @14,@SA00054                                        2341 10525000
         BR    @14                                                 2341 10526000
*   END ACTGVR;                     /*                       @Y30LB25*/ 10527000
         B     @EL00054                                            2342 10528000
*                                                                  2343 10529000
*   /*****************************************************************/ 10530000
*   /*                                                               */ 10531000
*   /* PROCEDURE NAME - RERENUPD                             @Y30LB25*/ 10532000
*   /*                                                       @Y30LB25*/ 10533000
*   /* FUNCTION -                                            @Y30LB25*/ 10534000
*   /* GET THE MSVC RECORD FOR UPDATE WHICH IS               @Y30LB25*/ 10535000
*   /* TO BE RENAMED.                                        @Y30LB25*/ 10536000
*   /*                                                       @Y30LB25*/ 10537000
*   /* INPUT -                                               @Y30LB25*/ 10538000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10539000
*   /*                                                       @Y30LB25*/ 10540000
*   /* OUTPUT -                                              @Y30LB25*/ 10541000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10542000
*   /* AN ERROR                                              @Y30LB25*/ 10543000
*   /* MSC RECORD TO BE RENAMED IN BASEBUF                   @Y30LB25*/ 10544000
*   /*                                                               */ 10545000
*   /*****************************************************************/ 10546000
*                                                                  2343 10547000
*RDRENUPD:                          /*                       @Y30LB25*/ 10548000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10549000
*                                                                  2343 10550000
RDRENUPD ST    @14,@SA00055                                        2343 10551000
*   /*****************************************************************/ 10552000
*   /*                                                               */ 10553000
*   /* CHECK FOR RENAME AN INACTIVE VOLUME                   @Y30LB25*/ 10554000
*   /*                                                               */ 10555000
*   /*****************************************************************/ 10556000
*                                                                  2344 10557000
*   IF DEFVRNTR=ON                  /* RENAME INACT VOL?     @Y30LB25*/ 10558000
*     THEN                          /* YES                   @Y30LB25*/ 10559000
         TM    DEFVRNTR(DEFVPTR),B'00000100'                       2344 10560000
         BNO   @RF02344                                            2344 10561000
*     DO;                           /*                       @Y30LB25*/ 10562000
*       IVOLKY=DEFVCSN1;            /* SET CSN IN KEY        @Y30LB25*/ 10563000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        2346 10564000
*       CALL GETRECUD;              /* GET MSC RECORD        @Y30LB25*/ 10565000
         BAL   @14,GETRECUD                                        2347 10566000
*     END;                          /*                       @Y30LB25*/ 10567000
*                                                                  2348 10568000
*   /*****************************************************************/ 10569000
*   /*                                                               */ 10570000
*   /* IT IS RENAME AN ACTIVE VOLUME                         @Y30LB25*/ 10571000
*   /*                                                               */ 10572000
*   /*****************************************************************/ 10573000
*                                                                  2349 10574000
*   ELSE                                                           2349 10575000
*     DO;                           /*                       @Y30LB25*/ 10576000
         B     @RC02344                                            2349 10577000
@RF02344 DS    0H                                                  2350 10578000
*       BVOLKY=DEFVOLD;             /* SET VOLID             @Y30LB25*/ 10579000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2350 10580000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 10581000
         LA    @06,BKEY                                            2351 10582000
         L     @01,RPLVPTR                                         2351 10583000
         ST    @06,RPLVKEY(,@01)                                   2351 10584000
*       CALL READUPD1;              /* GET BVR               @Y30LB25*/ 10585000
         BAL   @14,READUPD1                                        2352 10586000
*       BASEBUF=BASEBUF1;           /* USE CORRECT BUFF      @Y30LB25*/ 10587000
         MVC   BASEBUF(224),BASEBUF1                               2353 10588000
*     END;                          /*                       @Y30LB25*/ 10589000
*   RETURN;                         /*                       @Y30LB25*/ 10590000
@EL00055 DS    0H                                                  2355 10591000
@EF00055 DS    0H                                                  2355 10592000
@ER00055 L     @14,@SA00055                                        2355 10593000
         BR    @14                                                 2355 10594000
*   END RDRENUPD;                   /*                       @Y30LB25*/ 10595000
         B     @EL00055                                            2356 10596000
*                                                                  2357 10597000
*   /*****************************************************************/ 10598000
*   /*                                                               */ 10599000
*   /* PROCEDURE NAME - ACTINAC                              @Y30LB25*/ 10600000
*   /*                                                       @Y30LB25*/ 10601000
*   /* FUNCTION -                                            @Y30LB25*/ 10602000
*   /* THIS PROCEDURE HANDLES A GROUP RECORD FOR             @Y30LB25*/ 10603000
*   /* RENAMING AN ACTIVE VOLUME BACK TO ITSELF IF IT IS     @Y30LB25*/ 10604000
*   /* GROUPED AND GENERAL-USE.                              @Y30LB25*/ 10605000
*   /*                                                       @Y30LB25*/ 10606000
*   /* INPUT -                                               @Y30LB25*/ 10607000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10608000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 10609000
*   /*                                                       @Y30LB25*/ 10610000
*   /* OUTPUT -                                              @Y30LB25*/ 10611000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10612000
*   /* AN ERROR                                              @Y30LB25*/ 10613000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 10614000
*   /* GROUP VOLUME EXTENSION RECORD                         @Y30LB25*/ 10615000
*   /*                                                               */ 10616000
*   /*****************************************************************/ 10617000
*                                                                  2357 10618000
*ACTINAC:                           /*                       @Y30LB25*/ 10619000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10620000
*                                                                  2357 10621000
ACTINAC  ST    @14,@SA00056                                        2357 10622000
*   /*****************************************************************/ 10623000
*   /*                                                               */ 10624000
*   /* CHECK FOR GROUPED BVR                                 @Y30LB25*/ 10625000
*   /*                                                               */ 10626000
*   /*****************************************************************/ 10627000
*                                                                  2358 10628000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 10629000
*     THEN                          /* YES                   @Y30LB25*/ 10630000
         L     @06,BASEVPTR                                        2358 10631000
         TM    BASGRPV(@06),B'00100000'                            2358 10632000
         BNO   @RF02358                                            2358 10633000
*     DO;                           /*                       @Y30LB25*/ 10634000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/ 10635000
         MVC   GROUPKY(8),BASGROUP(@06)                            2360 10636000
*       RPLVKEY=ADDR(GKEY);         /* KEY ADDR              @Y30LB25*/ 10637000
         LA    @06,GKEY                                            2361 10638000
         L     @05,RPLVPTR                                         2361 10639000
         ST    @06,RPLVKEY(,@05)                                   2361 10640000
*       CALL READUPD1;              /* GET GVR               @Y30LB25*/ 10641000
         BAL   @14,READUPD1                                        2362 10642000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 10643000
*         THEN                      /* YES                   @Y30LB25*/ 10644000
         L     @06,RPLVPTR                                         2363 10645000
         LH    @06,RPLVRETC(,@06)                                  2363 10646000
         N     @06,@CF01129                                        2363 10647000
         LTR   @06,@06                                             2363 10648000
         BNZ   @RT02363                                            2363 10649000
*         RETURN;                   /*                       @Y30LB25*/ 10650000
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUF       @Y30LB25*/ 10651000
         MVC   GROUPBUF(224),BASEBUF1                              2365 10652000
*       GROUPPTR=ADDR(GROUPBUF);    /* SET MAPPING           @VS34305*/ 10653000
*                                                                  2366 10654000
         LA    @06,GROUPBUF                                        2366 10655000
         ST    @06,GROUPPTR                                        2366 10656000
*       /*************************************************************/ 10657000
*       /*                                                           */ 10658000
*       /* UPDATE THE GVR                                    @Y30LB25*/ 10659000
*       /*                                                           */ 10660000
*       /*************************************************************/ 10661000
*                                                                  2367 10662000
*       GRONINAC=GRONINAC+FIXONE;   /* INCR # INACT VOLS     @Y30LB25*/ 10663000
*                                                                  2367 10664000
         LA    @05,1                                               2367 10665000
         AH    @05,GRONINAC(,@06)                                  2367 10666000
         STH   @05,GRONINAC(,@06)                                  2367 10667000
*       /*************************************************************/ 10668000
*       /*                                                           */ 10669000
*       /* UPDATE THE NUMBER OF RESTRICTED OR                @Y30LB25*/ 10670000
*       /* GENERAL-USE VOLUMES                               @Y30LB25*/ 10671000
*       /*                                                           */ 10672000
*       /*************************************************************/ 10673000
*                                                                  2368 10674000
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 10675000
*         THEN                      /* YES                   @Y30LB25*/ 10676000
         L     @05,BASEVPTR                                        2368 10677000
         TM    BASRSTD(@05),B'00001000'                            2368 10678000
         BNO   @RF02368                                            2368 10679000
*         GRONRSTD=GRONRSTD-FIXONE; /*                       @Y30LB25   10680000
*                                      DECR # RESTD VOLS     @Y30LB25*/ 10681000
         LH    @05,GRONRSTD(,@06)                                  2369 10682000
         BCTR  @05,0                                               2369 10683000
         STH   @05,GRONRSTD(,@06)                                  2369 10684000
*       ELSE                                                       2370 10685000
*         IF BASGENUS=ON            /* GENEAL-USE?           @Y30LB25*/ 10686000
*           THEN                    /* YES                   @Y30LB25*/ 10687000
         B     @RC02368                                            2370 10688000
@RF02368 L     @06,BASEVPTR                                        2370 10689000
         TM    BASGENUS(@06),B'00010000'                           2370 10690000
         BNO   @RF02370                                            2370 10691000
*           DO;                     /*                       @Y30LB25*/ 10692000
*             GRONGEN=GRONGEN-FIXONE;/*                      @Y30LB25   10693000
*                                      DECR # GEN-USE        @Y30LB25*/ 10694000
*                                                                  2372 10695000
         L     @06,GROUPPTR                                        2372 10696000
         LH    @05,GRONGEN(,@06)                                   2372 10697000
         BCTR  @05,0                                               2372 10698000
         STH   @05,GRONGEN(,@06)                                   2372 10699000
*             /*******************************************************/ 10700000
*             /*                                                     */ 10701000
*             /* UPDATE THE GVR                              @Y30LB25*/ 10702000
*             /*                                                     */ 10703000
*             /*******************************************************/ 10704000
*                                                                  2373 10705000
*             ADDSUBGR=OFF;         /* DELETE                @Y30LB25*/ 10706000
         NI    ADDSUBGR,B'11110111'                                2373 10707000
*             CALL VUPGH;           /* PROCESS GVR           @Y30LB25*/ 10708000
         BAL   @14,VUPGH                                           2374 10709000
*           END;                    /*                       @Y30LB25*/ 10710000
*                                                                  2375 10711000
*       /*************************************************************/ 10712000
*       /*                                                           */ 10713000
*       /* WRITE THE GVR                                     @Y30LB25*/ 10714000
*       /*                                                           */ 10715000
*       /*************************************************************/ 10716000
*                                                                  2376 10717000
*       RPLVBUF=ADDR(GROUPBUF);     /* GVR BUF PTR           @Y30LB25*/ 10718000
@RF02370 DS    0H                                                  2376 10719000
@RC02368 LA    @06,GROUPBUF                                        2376 10720000
         L     @05,RPLVPTR                                         2376 10721000
         ST    @06,RPLVBUF(,@05)                                   2376 10722000
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/ 10723000
         BAL   @14,WRITRECD                                        2377 10724000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 10725000
*         THEN                      /* YES                   @Y30LB25*/ 10726000
         L     @06,RPLVPTR                                         2378 10727000
         LH    @06,RPLVRETC(,@06)                                  2378 10728000
         N     @06,@CF01129                                        2378 10729000
         LTR   @06,@06                                             2378 10730000
         BNZ   @RT02378                                            2378 10731000
*         RETURN;                   /*                       @Y30LB25*/ 10732000
*                                                                  2379 10733000
*       /*************************************************************/ 10734000
*       /*                                                           */ 10735000
*       /* CHECK FOR GENERAL-USE TO DELETE ITS SLOT          @Y30LB25*/ 10736000
*       /*                                                           */ 10737000
*       /*************************************************************/ 10738000
*                                                                  2380 10739000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Y30LB25*/ 10740000
*         THEN                      /* YES                   @Y30LB25*/ 10741000
         L     @06,BASEVPTR                                        2380 10742000
         TM    BASGENUS(@06),B'00010000'                           2380 10743000
         BNO   @RF02380                                            2380 10744000
*         DO;                       /*                       @Y30LB25*/ 10745000
*           EXPSLOT=OFF;            /* NO UPDATE DATE        @Y30LB25*/ 10746000
         NI    EXPSLOT,B'01111111'                                 2382 10747000
*           ADDSUBSL=OFF;           /* DELETE                @Y30LB25*/ 10748000
         NI    ADDSUBSL,B'11111101'                                2383 10749000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   2384 10750000
*                                                            @Y30LB25*/ 10751000
         L     @15,@CV00767                                        2384 10752000
         LA    @01,@AL02384                                        2384 10753000
         BALR  @14,@15                                             2384 10754000
*         END;                      /*                       @Y30LB25*/ 10755000
*     END;                          /*                       @Y30LB25*/ 10756000
*   RETURN;                         /*                       @Y30LB25*/ 10757000
@EL00056 DS    0H                                                  2387 10758000
@EF00056 DS    0H                                                  2387 10759000
@ER00056 L     @14,@SA00056                                        2387 10760000
         BR    @14                                                 2387 10761000
*   END ACTINAC;                    /*                       @Y30LB25*/ 10762000
         B     @EL00056                                            2388 10763000
*                                                                  2389 10764000
*   /*****************************************************************/ 10765000
*   /*                                                               */ 10766000
*   /* PROCEDURE NAME - CRTDVR                               @Y30LB25*/ 10767000
*   /*                                                       @Y30LB25*/ 10768000
*   /* FUNCTION -                                            @Y30LB25*/ 10769000
*   /* CREATE A DUPLICATE VOLUME RECORD FROM A BASE          @Y30LB25*/ 10770000
*   /* VOLUME RECORD (ACTIVE OR INACTIVE) OR FROM A          @Y30LB25*/ 10771000
*   /* COPY VOLUME RECORD, EITHER OF WHICH HAS ALREADY       @Y30LB25*/ 10772000
*   /* BEEN DELETED.                                         @Y30LB25*/ 10773000
*   /*                                                       @Y30LB25*/ 10774000
*   /* INPUT -                                               @Y30LB25*/ 10775000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10776000
*   /* BCDVPTR POINTS TO BASEBUF WHICH CONTAINS              @Y30LB25*/ 10777000
*   /* THE DELETED BASE OR COPY VOLUME RECORD                @Y30LB25*/ 10778000
*   /* FOR THE OLD VOLID. BASEVPTR POINTS TO                 @Y30LB25*/ 10779000
*   /* THE BASE VOLUME RECORD FOR THE NEW VOLID              @Y30LB25*/ 10780000
*   /* IN BASEBUF1. THE DUPLICATE VOLUME WILL BE             @Y30LB25*/ 10781000
*   /* CREATE FOR THE NEW VOLID.                             @Y30LB25*/ 10782000
*   /*                                                       @Y30LB25*/ 10783000
*   /* OUTPUT -                                              @Y30LB25*/ 10784000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10785000
*   /* AN ERROR                                              @Y30LB25*/ 10786000
*   /* DUPLICATE VOLUME RECORD                               @Y30LB25*/ 10787000
*   /*                                                               */ 10788000
*   /*****************************************************************/ 10789000
*                                                                  2389 10790000
*CRTDVR:                            /*                       @Y30LB25*/ 10791000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10792000
*                                                                  2389 10793000
CRTDVR   ST    @14,@SA00057                                        2389 10794000
*   /*****************************************************************/ 10795000
*   /*                                                               */ 10796000
*   /* FIND THE ID OF THE NEXT AVAILABLE DVR FOR NVOLID      @Y30LB25*/ 10797000
*   /*                                                               */ 10798000
*   /*****************************************************************/ 10799000
*                                                                  2390 10800000
*   DVOLKY=BASSERNO;                /* SET VOLID             @Y30LB25*/ 10801000
         L     @06,BASEVPTR                                        2390 10802000
         MVC   DVOLKY(6),BASSERNO(@06)                             2390 10803000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 10804000
         L     @06,RPLVPTR                                         2391 10805000
         MVI   RPLVTYP(@06),X'00'                                  2391 10806000
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/ 10807000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 10808000
         OI    RPLVLOC(@06),B'11000000'                            2393 10809000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/ 10810000
         NI    RPLVUPD(@06),B'11111101'                            2394 10811000
*   RPLVKEY=ADDR(DKEY);             /* ADDR OF KEY           @Y30LB25*/ 10812000
         LA    @15,DKEY                                            2395 10813000
         ST    @15,RPLVKEY(,@06)                                   2395 10814000
*   DIDKY=FIXZERO;                  /* START DVR 0           @Y30LB25*/ 10815000
         MVI   DIDKY,X'00'                                         2396 10816000
*   RESPECIFY                       /*                       @Y30LB25*/ 10817000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 10818000
*   RG1=RPLVPTR;                    /* PTR TO RPLV           @Y30LB25*/ 10819000
         LR    RG1,@06                                             2398 10820000
*   A=FIXONE;                       /* LOOP CONTROL          @Y30LB25*/ 10821000
         MVC   A(4),@CF00046                                       2399 10822000
*   DO WHILE A=1;                   /* FIND AVAIL DVR        @Y30LB25*/ 10823000
         B     @DE02400                                            2400 10824000
@DL02400 DS    0H                                                  2401 10825000
*     DIDKY=DIDKY+FIXONE;           /* NEXT KEY              @Y30LB25*/ 10826000
         IC    @06,DIDKY                                           2401 10827000
         LA    @06,1(,@06)                                         2401 10828000
         STC   @06,DIDKY                                           2401 10829000
*     CALL ICBVIO00;                /* READ FOR DVR          @Y30LB25*/ 10830000
         L     @15,@CV00762                                        2402 10831000
         BALR  @14,@15                                             2402 10832000
*     IF RPLVRETC¬=FIXZERO|DIDKY=FIX255/* ERROR?             @Y30LB25*/ 10833000
*       THEN                        /* YES                   @Y30LB25*/ 10834000
         L     @06,RPLVPTR                                         2403 10835000
         LH    @06,RPLVRETC(,@06)                                  2403 10836000
         N     @06,@CF01129                                        2403 10837000
         LTR   @06,@06                                             2403 10838000
         BNZ   @RT02403                                            2403 10839000
         CLI   DIDKY,255                                           2403 10840000
         BNE   @RF02403                                            2403 10841000
@RT02403 DS    0H                                                  2404 10842000
*       A=FIXZERO;                  /* END LOOP              @Y30LB25*/ 10843000
         SLR   @06,@06                                             2404 10844000
         ST    @06,A                                               2404 10845000
*   END;                            /*                       @Y30LB25*/ 10846000
@RF02403 DS    0H                                                  2405 10847000
@DE02400 CLC   A(4),@CF00046                                       2405 10848000
         BE    @DL02400                                            2405 10849000
*   RESPECIFY                       /*                       @Y30LB25*/ 10850000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 10851000
*   IF RPLVRETC=FIXZERO             /* ERROR?                @Y30LB25*/ 10852000
*     THEN                          /* YES                   @Y30LB25*/ 10853000
         L     @06,RPLVPTR                                         2407 10854000
         LH    @15,RPLVRETC(,@06)                                  2407 10855000
         N     @15,@CF01129                                        2407 10856000
         LTR   @15,@15                                             2407 10857000
         BNZ   @RF02407                                            2407 10858000
*     DO;                           /*                       @Y30LB25*/ 10859000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 10860000
         MVC   RPLVRETC(2,@06),@CH00041                            2409 10861000
*       RPLRCODE=NODVR;             /* 255 DVRS              @Y30LB25*/ 10862000
         MVC   RPLRCODE(2,@06),@CB00709                            2410 10863000
*       RETURN;                     /*                       @Y30LB25*/ 10864000
@EL00057 DS    0H                                                  2411 10865000
@EF00057 DS    0H                                                  2411 10866000
@ER00057 L     @14,@SA00057                                        2411 10867000
         BR    @14                                                 2411 10868000
*     END;                          /*                       @Y30LB25*/ 10869000
*   IF RPLRCODE=IOERROR             /* I?O ERROR?            @Y30LB25*/ 10870000
*     THEN                          /* YES                   @Y30LB25*/ 10871000
@RF02407 L     @06,RPLVPTR                                         2413 10872000
         CLC   RPLRCODE(2,@06),@CB00713                            2413 10873000
         BE    @RT02413                                            2413 10874000
*     RETURN;                       /*                       @Y30LB25*/ 10875000
*                                                                  2414 10876000
*   /*****************************************************************/ 10877000
*   /*                                                               */ 10878000
*   /* BUILD THE DVR FOR NVOLID                              @Y30LB25*/ 10879000
*   /*                                                               */ 10880000
*   /*****************************************************************/ 10881000
*                                                                  2415 10882000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* ZERO REASON CODE      @Y30LB25*/ 10883000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2415 10884000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ZERO RETURN CODE      @Y30LB25*/ 10885000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2416 10886000
*   DUPVBUF=DUPVBUF&&DUPVBUF;       /* ZERO DVR BUFFER       @Y30LB25*/ 10887000
         XC    DUPVBUF(224),DUPVBUF                                2417 10888000
*   DUPNAME=DKEY;                   /* SET KEY               @Y30LB25*/ 10889000
         L     @06,DUPVPTR                                         2418 10890000
         MVC   DUPNAME(13,@06),DKEY                                2418 10891000
*   DUPCSN1=BCDCSN1;                /* SET CSN1              @Y30LB25*/ 10892000
         L     @15,BCDVPTR                                         2419 10893000
         MVC   DUPCSN1(12,@06),BCDCSN1(@15)                        2419 10894000
*   DUPLIB1=BCDLIB1;                /* SET LIB ID 1          @Y30LB25*/ 10895000
         IC    @14,BCDLIB1(,@15)                                   2420 10896000
         STC   @14,DUPLIB1(,@06)                                   2420 10897000
*   DUPCSN2=BCDCSN2;                /* SET CSN2              @Y30LB25*/ 10898000
         MVC   DUPCSN2(12,@06),BCDCSN2(@15)                        2421 10899000
*   DUPLIB2=BCDLIB2;                /* SET LIB ID 2          @Y30LB25*/ 10900000
         IC    @14,BCDLIB2(,@15)                                   2422 10901000
         STC   @14,DUPLIB2(,@06)                                   2422 10902000
*   DUPDUPLR=ON;                    /* DVR                   @Y30LB25*/ 10903000
*                                                                  2423 10904000
         OI    DUPDUPLR(@06),B'00000100'                           2423 10905000
*   /*****************************************************************/ 10906000
*   /*                                                               */ 10907000
*   /* WRITE THE DVR                                         @Y30LB25*/ 10908000
*   /*                                                               */ 10909000
*   /*****************************************************************/ 10910000
*                                                                  2424 10911000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/ 10912000
         L     @06,RPLVPTR                                         2424 10913000
         NI    RPLVUPD(@06),B'11111101'                            2424 10914000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 10915000
         NI    RPLVLOC(@06),B'01111111'                            2425 10916000
*   RPLVRLN=LENGTH(DUPV);           /* RECORD LENGTH         @Y30LB25*/ 10917000
         MVC   RPLVRLN(4,@06),@CF01105                             2426 10918000
*   RPLVBLN=LENGTH(DUPVBUF);        /* BUFFER LENGTH         @Y30LB25*/ 10919000
         MVC   RPLVBLN(4,@06),@CF01103                             2427 10920000
*   RPLVBUF=ADDR(DUPVBUF);          /* DVR BUF ADDR          @Y30LB25*/ 10921000
         LA    @15,DUPVBUF                                         2428 10922000
         ST    @15,RPLVBUF(,@06)                                   2428 10923000
*   CALL WRITRECD;                  /* WRITE DVR             @Y30LB25*/ 10924000
         BAL   @14,WRITRECD                                        2429 10925000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 10926000
*     THEN                          /* YES                   @Y30LB25*/ 10927000
         L     @06,RPLVPTR                                         2430 10928000
         LH    @06,RPLVRETC(,@06)                                  2430 10929000
         N     @06,@CF01129                                        2430 10930000
         LTR   @06,@06                                             2430 10931000
         BNZ   @RT02430                                            2430 10932000
*     RETURN;                       /*                       @Y30LB25*/ 10933000
*                                                                  2431 10934000
*   /*****************************************************************/ 10935000
*   /*                                                               */ 10936000
*   /* UPDATE THE CIRS                                       @Y30LB25*/ 10937000
*   /*                                                               */ 10938000
*   /*****************************************************************/ 10939000
*                                                                  2432 10940000
*   BCDVPTR=ADDR(DUPVBUF);          /* DVR PTR               @Y30LB25*/ 10941000
         LA    @06,DUPVBUF                                         2432 10942000
         ST    @06,BCDVPTR                                         2432 10943000
*   CALL UPDCIR;                    /* UPDATE CIRS           @Y30LB25*/ 10944000
         BAL   @14,UPDCIR                                          2433 10945000
*   RETURN;                         /*                       @Y30LB25*/ 10946000
         B     @EL00057                                            2434 10947000
*   END CRTDVR;                     /*                       @Y30LB25*/ 10948000
         B     @EL00057                                            2435 10949000
*                                                                  2436 10950000
*   /*****************************************************************/ 10951000
*   /*                                                               */ 10952000
*   /* PROCEDURE NAME - UPDCIR                               @Y30LB25*/ 10953000
*   /*                                                       @Y30LB25*/ 10954000
*   /* FUNCTION -                                            @Y30LB25*/ 10955000
*   /* GET THE CARTRIDGE INDEX RECORDS FOR THE               @Y30LB25*/ 10956000
*   /* BASE VOLUME RECORD (ACTIVE OR INACTIVE)               @Y30LB25*/ 10957000
*   /* OR THE COPY OR DUPLICATE VOLUME RECORD, AND UPDATE    @Y30LB25*/ 10958000
*   /* THEM TO REFLECT THE VOLID OF THE NEW DUPLICATE OR     @Y30LB25*/ 10959000
*   /* BASE OR COPY VOLUME RECORD.                           @Y30LB25*/ 10960000
*   /*                                                       @Y30LB25*/ 10961000
*   /* INPUT -                                               @Y30LB25*/ 10962000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10963000
*   /* BCDVPTR POINTING TO CONTAINS                          @Y30LB25*/ 10964000
*   /* THE BASE OR DUPLICATE VOLUME RECORD                   @Y30LB25*/ 10965000
*   /*                                                       @Y30LB25*/ 10966000
*   /* OUTPUT -                                              @Y30LB25*/ 10967000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10968000
*   /* AN ERROR                                              @Y30LB25*/ 10969000
*   /* CARTRIDGE INDEX RECORDS                               @Y30LB25*/ 10970000
*   /*                                                               */ 10971000
*   /*****************************************************************/ 10972000
*                                                                  2436 10973000
*UPDCIR:                            /*                       @Y30LB25*/ 10974000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10975000
*                                                                  2436 10976000
UPDCIR   ST    @14,@SA00058                                        2436 10977000
*   /*****************************************************************/ 10978000
*   /*                                                               */ 10979000
*   /* GET AND UPDATE CIR FOR CSN1                           @Y30LB25*/ 10980000
*   /*                                                               */ 10981000
*   /*****************************************************************/ 10982000
*                                                                  2437 10983000
*   IVOLKY=BCDCSN1;                 /* SET CSN1 TO KEY       @Y30LB25*/ 10984000
         L     @06,BCDVPTR                                         2437 10985000
         MVC   IVOLKY(12),BCDCSN1(@06)                             2437 10986000
*   RPLVKEY=ADDR(IKEY);             /* SET KEY ADDR          @Y30LB25*/ 10987000
         LA    @06,IKEY                                            2438 10988000
         L     @01,RPLVPTR                                         2438 10989000
         ST    @06,RPLVKEY(,@01)                                   2438 10990000
*   CALL READUPD1;                  /* GET CIR FOR CSN1      @Y30LB25*/ 10991000
         BAL   @14,READUPD1                                        2439 10992000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 10993000
*     THEN                          /* YES                   @Y30LB25*/ 10994000
         L     @06,RPLVPTR                                         2440 10995000
         LH    @06,RPLVRETC(,@06)                                  2440 10996000
         N     @06,@CF01129                                        2440 10997000
         LTR   @06,@06                                             2440 10998000
         BNZ   @RT02440                                            2440 10999000
*     RETURN;                       /*                       @Y30LB25*/ 11000000
*   INDEXPTR=ADDR(BASEBUF1);        /* MAP CIR               @Y30LB25*/ 11001000
         LA    @06,BASEBUF1                                        2442 11002000
         ST    @06,INDEXPTR                                        2442 11003000
*   INDRECKY=BCDNAME;               /* SET KEY TO CIR        @Y30LB25*/ 11004000
         L     @01,BCDVPTR                                         2443 11005000
         MVC   INDRECKY(13,@06),BCDNAME(@01)                       2443 11006000
*   CALL WRITRECD;                  /* WRITE CIR FOR CSN1    @Y30LB25*/ 11007000
         BAL   @14,WRITRECD                                        2444 11008000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 11009000
*     THEN                          /* YES                   @Y30LB25*/ 11010000
         L     @06,RPLVPTR                                         2445 11011000
         LH    @06,RPLVRETC(,@06)                                  2445 11012000
         N     @06,@CF01129                                        2445 11013000
         LTR   @06,@06                                             2445 11014000
         BNZ   @RT02445                                            2445 11015000
*     RETURN;                       /*                       @Y30LB25*/ 11016000
*                                                                  2446 11017000
*   /*****************************************************************/ 11018000
*   /*                                                               */ 11019000
*   /* GET AND UPDATE CIR FOR CSN2                           @Y30LB25*/ 11020000
*   /*                                                               */ 11021000
*   /*****************************************************************/ 11022000
*                                                                  2447 11023000
*   IVOLKY=BCDCSN2;                 /* SET CSN2 TO KEY       @Y30LB25*/ 11024000
         L     @06,BCDVPTR                                         2447 11025000
         MVC   IVOLKY(12),BCDCSN2(@06)                             2447 11026000
*   CALL READUPD1;                  /* GET CIR FOR CSN1      @Y30LB25*/ 11027000
         BAL   @14,READUPD1                                        2448 11028000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 11029000
*     THEN                          /* YES                   @Y30LB25*/ 11030000
         L     @06,RPLVPTR                                         2449 11031000
         LH    @06,RPLVRETC(,@06)                                  2449 11032000
         N     @06,@CF01129                                        2449 11033000
         LTR   @06,@06                                             2449 11034000
         BNZ   @RT02449                                            2449 11035000
*     RETURN;                       /*                       @Y30LB25*/ 11036000
*   INDRECKY=BCDNAME;               /* SET KEY TO CIR        @Y30LB25*/ 11037000
         L     @06,INDEXPTR                                        2451 11038000
         L     @01,BCDVPTR                                         2451 11039000
         MVC   INDRECKY(13,@06),BCDNAME(@01)                       2451 11040000
*   CALL WRITRECD;                  /* WRITE CIR FOR CSN2    @Y30LB25*/ 11041000
         BAL   @14,WRITRECD                                        2452 11042000
*   RETURN;                         /*                       @Y30LB25*/ 11043000
@EL00058 DS    0H                                                  2453 11044000
@EF00058 DS    0H                                                  2453 11045000
@ER00058 L     @14,@SA00058                                        2453 11046000
         BR    @14                                                 2453 11047000
*   END UPDCIR;                     /*                       @Y30LB25*/ 11048000
         B     @EL00058                                            2454 11049000
*                                                                  2455 11050000
*   /*****************************************************************/ 11051000
*   /*                                                               */ 11052000
*   /* PROCEDURE NAME - ELMACTV2                             @Y30LB25*/ 11053000
*   /*                                                       @Y30LB25*/ 11054000
*   /* FUNCTION -                                            @Y30LB25*/ 11055000
*   /* PROCESS THE ELIMINATION OF AN ACTIVE                  @Y30LB25*/ 11056000
*   /* VOLUME AFTER THE MSC WAS CALLED.                      @Y30LB25*/ 11057000
*   /*                                                       @Y30LB25*/ 11058000
*   /* INPUT -                                               @Y30LB25*/ 11059000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 11060000
*   /*                                                       @Y30LB25*/ 11061000
*   /* OUTPUT -                                              @Y30LB25*/ 11062000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 11063000
*   /* AN ERROR                                              @Y30LB25*/ 11064000
*   /*                                                               */ 11065000
*   /*****************************************************************/ 11066000
*                                                                  2455 11067000
*ELMACTV2:                          /*                       @Y30LB25*/ 11068000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 11069000
ELMACTV2 ST    @14,@SA00059                                        2455 11070000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   11071000
*                                      RESERVE .MSVI         @Y30LB25*/ 11072000
*                                                                  2456 11073000
         BAL   @14,HOUSKEEP                                        2456 11074000
*   /*****************************************************************/ 11075000
*   /*                                                               */ 11076000
*   /* CHECK FOR AN MSC ERROR.                               @Y30LB25*/ 11077000
*   /*                                                               */ 11078000
*   /*****************************************************************/ 11079000
*                                                                  2457 11080000
*   IF RPLRCODE¬=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 11081000
*     THEN                          /* YES                   @Y30LB25*/ 11082000
         L     @06,RPLVPTR                                         2457 11083000
         LH    @05,RPLRCODE(,@06)                                  2457 11084000
         N     @05,@CF01129                                        2457 11085000
         LTR   @05,@05                                             2457 11086000
         BZ    @RF02457                                            2457 11087000
*     DO;                           /*                       @Y30LB25*/ 11088000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 11089000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2459 11090000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASN CODE       @Y30LB25*/ 11091000
*                                                                  2460 11092000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2460 11093000
*       /*************************************************************/ 11094000
*       /*                                                           */ 11095000
*       /* ALLOW COPIES                                      @Y30LB25*/ 11096000
*       /*                                                           */ 11097000
*       /*************************************************************/ 11098000
*                                                                  2461 11099000
*       BVOLKY=DEFVOLD;             /* SET VOLID             @Y30LB25*/ 11100000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2461 11101000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 11102000
         LA    @15,BKEY                                            2462 11103000
         ST    @15,RPLVKEY(,@06)                                   2462 11104000
*       CALL READUPD1;              /* GET BVR               @Y30LB25*/ 11105000
         BAL   @14,READUPD1                                        2463 11106000
*       IF RPLVRETC=FIXZERO         /* ERROR?                @Y30LB25*/ 11107000
*         THEN                      /* YES                   @Y30LB25*/ 11108000
         L     @06,RPLVPTR                                         2464 11109000
         LH    @06,RPLVRETC(,@06)                                  2464 11110000
         N     @06,@CF01129                                        2464 11111000
         LTR   @06,@06                                             2464 11112000
         BNZ   @RF02464                                            2464 11113000
*         DO;                       /*                       @Y30LB25*/ 11114000
*           BASEVPTR=ADDR(BASEBUF1);/*                       @Y30LB25   11115000
*                                      SET UP MAP            @Y30LB25*/ 11116000
         LA    @06,BASEBUF1                                        2466 11117000
         ST    @06,BASEVPTR                                        2466 11118000
*           BASNOCPY=OFF;           /* ALLOW COPIES          @Y30LB25*/ 11119000
         NI    BASNOCPY(@06),B'10111111'                           2467 11120000
*           CALL WRITRECD;          /* WRITE BVR             @Y30LB25*/ 11121000
         BAL   @14,WRITRECD                                        2468 11122000
*         END;                      /*                       @Y30LB25*/ 11123000
*                                                                  2469 11124000
*       /*************************************************************/ 11125000
*       /*                                                           */ 11126000
*       /* RETURN ZERO RETURN AND REASON CODE                @Y30LB25*/ 11127000
*       /*                                                           */ 11128000
*       /*************************************************************/ 11129000
*                                                                  2470 11130000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 11131000
@RF02464 L     @06,RPLVPTR                                         2470 11132000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2470 11133000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 11134000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2471 11135000
*       RETURN;                     /*                       @Y30LB25*/ 11136000
@EL00059 DS    0H                                                  2472 11137000
@EF00059 DS    0H                                                  2472 11138000
@ER00059 L     @14,@SA00059                                        2472 11139000
         BR    @14                                                 2472 11140000
*     END;                          /*                       @Y30LB25*/ 11141000
*                                                                  2473 11142000
*   /*****************************************************************/ 11143000
*   /*                                                               */ 11144000
*   /* DELETE THE BVR                                        @Y30LB25*/ 11145000
*   /*                                                               */ 11146000
*   /*****************************************************************/ 11147000
*                                                                  2474 11148000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 11149000
@RF02457 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2474 11150000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 11151000
         L     @06,RPLVPTR                                         2475 11152000
         LA    @15,BKEY                                            2475 11153000
         ST    @15,RPLVKEY(,@06)                                   2475 11154000
*   RPLVBUF=ADDR(BASEBUF);          /* BVR BUFF ADDR         @Y30LB25*/ 11155000
         LA    @15,BASEBUF                                         2476 11156000
         ST    @15,RPLVBUF(,@06)                                   2476 11157000
*   RPLVBLN=LENGTH(BASEBUF);        /* BVR BUFF LENGTH       @Y30LB25*/ 11158000
         MVC   RPLVBLN(4,@06),@CF01103                             2477 11159000
*   CALL DELTRECD;                  /* GET & DELETE BVR      @Y30LB25*/ 11160000
         BAL   @14,DELTRECD                                        2478 11161000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 11162000
*     THEN                          /* YES                   @Y30LB25*/ 11163000
         L     @06,RPLVPTR                                         2479 11164000
         LH    @15,RPLVRETC(,@06)                                  2479 11165000
         N     @15,@CF01129                                        2479 11166000
         LTR   @15,@15                                             2479 11167000
         BNZ   @RT02479                                            2479 11168000
*     RETURN;                       /*                       @Y30LB25*/ 11169000
*                                                                  2480 11170000
*   /*****************************************************************/ 11171000
*   /*                                                               */ 11172000
*   /* DELETE THE CIR FOR CSN1                               @Y30LB25*/ 11173000
*   /*                                                               */ 11174000
*   /*****************************************************************/ 11175000
*                                                                  2481 11176000
*   IVOLKY=BASCSN1;                 /* SET CSN1 IN CIR       @Y30LB25*/ 11177000
         L     @01,BASEVPTR                                        2481 11178000
         MVC   IVOLKY(12),BASCSN1(@01)                             2481 11179000
*   RPLVKEY=ADDR(IKEY);             /* SET CIR KEY ADDR      @Y30LB25*/ 11180000
         LA    @15,IKEY                                            2482 11181000
         ST    @15,RPLVKEY(,@06)                                   2482 11182000
*   RPLVBUF=ADDR(INDEXBUF);         /* SET BUF ADDR          @Y30LB25*/ 11183000
         LA    @15,INDEXBUF                                        2483 11184000
         ST    @15,RPLVBUF(,@06)                                   2483 11185000
*   RPLVBLN=LENGTH(INDEXBUF);       /* SET BUFF LENGTH       @Y30LB25*/ 11186000
         MVC   RPLVBLN(4,@06),@CF00339                             2484 11187000
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Y30LB25*/ 11188000
         BAL   @14,DELTRECD                                        2485 11189000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Y30LB25*/ 11190000
         L     @06,RPLVPTR                                         2486 11191000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2486 11192000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Y30LB25*/ 11193000
*                                                                  2487 11194000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2487 11195000
*   /*****************************************************************/ 11196000
*   /*                                                               */ 11197000
*   /* DELETE THE CIR FOR CSN2                               @Y30LB25*/ 11198000
*   /*                                                               */ 11199000
*   /*****************************************************************/ 11200000
*                                                                  2488 11201000
*   IVOLKY=BASCSN2;                 /* SET CSN2 IN CIR       @Y30LB25*/ 11202000
         L     @06,BASEVPTR                                        2488 11203000
         MVC   IVOLKY(12),BASCSN2(@06)                             2488 11204000
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Y30LB25*/ 11205000
         BAL   @14,DELTRECD                                        2489 11206000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Y30LB25*/ 11207000
         L     @06,RPLVPTR                                         2490 11208000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2490 11209000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Y30LB25*/ 11210000
*                                                                  2491 11211000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2491 11212000
*   /*****************************************************************/ 11213000
*   /*                                                               */ 11214000
*   /* CHECK IF GVR NEEDS PROCESSING                         @Y30LB25*/ 11215000
*   /*                                                               */ 11216000
*   /*****************************************************************/ 11217000
*                                                                  2492 11218000
*   IF BASGRPV=ON                   /* BVR GROUPED?          @Y30LB25*/ 11219000
*     THEN                          /* YES                   @Y30LB25*/ 11220000
         L     @06,BASEVPTR                                        2492 11221000
         TM    BASGRPV(@06),B'00100000'                            2492 11222000
         BNO   @RF02492                                            2492 11223000
*     DO;                           /*                       @Y30LB25*/ 11224000
*                                                                  2493 11225000
*       /*************************************************************/ 11226000
*       /*                                                           */ 11227000
*       /* DECREMENT TYPE OF VOLUME COUNT AND                @Y30LB25*/ 11228000
*       /* PROCESS GVR                                       @Y30LB25*/ 11229000
*       /*                                                           */ 11230000
*       /*************************************************************/ 11231000
*                                                                  2494 11232000
*       CALL ACTGVR;                /* PROCESS GVR           @Y30LB25*/ 11233000
         BAL   @14,ACTGVR                                          2494 11234000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 11235000
*         THEN                      /* YES                   @Y30LB25*/ 11236000
         L     @06,RPLVPTR                                         2495 11237000
         LH    @06,RPLVRETC(,@06)                                  2495 11238000
         N     @06,@CF01129                                        2495 11239000
         LTR   @06,@06                                             2495 11240000
         BNZ   @RT02495                                            2495 11241000
*         RETURN;                   /*                       @Y30LB25*/ 11242000
*     END;                          /*                       @Y30LB25*/ 11243000
*                                                                  2497 11244000
*   /*****************************************************************/ 11245000
*   /*                                                               */ 11246000
*   /* PROCESS THE DELETED BVR                               @Y30LB25*/ 11247000
*   /*                                                               */ 11248000
*   /*****************************************************************/ 11249000
*                                                                  2498 11250000
*   CALL PROCBVR;                   /* PROCESS BVR           @Y30LB25*/ 11251000
@RF02492 BAL   @14,PROCBVR                                         2498 11252000
*   RETURN;                         /*                       @Y30LB25*/ 11253000
         B     @EL00059                                            2499 11254000
*   END ELMACTV2;                   /*                       @Y30LB25*/ 11255000
         B     @EL00059                                            2500 11256000
*                                                                  2501 11257000
*   /*****************************************************************/ 11258000
*   /*                                                               */ 11259000
*   /* PROCEDURE NAME - DEACTV2                              @Y30LB25*/ 11260000
*   /*                                                       @Y30LB25*/ 11261000
*   /* FUNCTION -                                            @Y30LB25*/ 11262000
*   /* PROCESS THE DEACTIVATION OF AN ACTIVE                 @Y30LB25*/ 11263000
*   /* VOLUME AFTER THE MSC WAS CALLED.                      @Y30LB25*/ 11264000
*   /*                                                       @Y30LB25*/ 11265000
*   /* RESTRICTIONS -                                        @Y30LB25*/ 11266000
*   /* GROUP CHANGES DURING ACTIVATE OF A VOLUME SUCH AS -   @Y30LB25*/ 11267000
*   /* CHANGING A VOLUME FROM GENERAL-USE TO RESTICTED OR    @Y30LB25*/ 11268000
*   /* RESTRICTED TO GENERAL-USE, REMOVING OR ADDING A       @Y30LB25*/ 11269000
*   /* VOLUME TO A GROUP, OR CHANGING A VOLUME FROM ONE      @Y30LB25*/ 11270000
*   /* GROUP TO ANOTHER GROUP, WILL CAUSE INVENTORY          @Y30LB25*/ 11271000
*   /* PROBLEMS.                                             @Y30LB25*/ 11272000
*   /*                                                       @Y30LB25*/ 11273000
*   /* INPUT -                                               @Y30LB25*/ 11274000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 11275000
*   /*                                                       @Y30LB25*/ 11276000
*   /* OUTPUT -                                              @Y30LB25*/ 11277000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 11278000
*   /* AN ERROR                                              @Y30LB25*/ 11279000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 11280000
*   /*                                                               */ 11281000
*   /*****************************************************************/ 11282000
*                                                                  2501 11283000
*DEACTV2:                           /*                       @Y30LB25*/ 11284000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 11285000
*                                                                  2501 11286000
DEACTV2  ST    @14,@SA00060                                        2501 11287000
*   /*****************************************************************/ 11288000
*   /*                                                               */ 11289000
*   /* CHECK FOR AN MSC ERROR.                               @Y30LB25*/ 11290000
*   /*                                                               */ 11291000
*   /*****************************************************************/ 11292000
*                                                                  2502 11293000
*   IF RPLRCODE¬=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 11294000
*     THEN                          /* YES                   @Y30LB25*/ 11295000
         L     @06,RPLVPTR                                         2502 11296000
         LH    @15,RPLRCODE(,@06)                                  2502 11297000
         N     @15,@CF01129                                        2502 11298000
         LTR   @15,@15                                             2502 11299000
         BZ    @RF02502                                            2502 11300000
*     DO;                           /*                       @Y30LB25*/ 11301000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 11302000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2504 11303000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 11304000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2505 11305000
*       RETURN;                     /*                       @Y30LB25*/ 11306000
@EL00060 DS    0H                                                  2506 11307000
@EF00060 DS    0H                                                  2506 11308000
@ER00060 L     @14,@SA00060                                        2506 11309000
         BR    @14                                                 2506 11310000
*     END;                          /*                       @Y30LB25*/ 11311000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   11312000
*                                      RESERVE .MSVI         @Y30LB25*/ 11313000
*                                                                  2508 11314000
@RF02502 BAL   @14,HOUSKEEP                                        2508 11315000
*   /*****************************************************************/ 11316000
*   /*                                                               */ 11317000
*   /* GET THE BVR                                           @Y30LB25*/ 11318000
*   /*                                                               */ 11319000
*   /*****************************************************************/ 11320000
*                                                                  2509 11321000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 11322000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2509 11323000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 11324000
         LA    @06,BKEY                                            2510 11325000
         L     @01,RPLVPTR                                         2510 11326000
         ST    @06,RPLVKEY(,@01)                                   2510 11327000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 11328000
         BAL   @14,READUPD1                                        2511 11329000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 11330000
*     THEN                          /* YES                   @Y30LB25*/ 11331000
         L     @06,RPLVPTR                                         2512 11332000
         LH    @06,RPLVRETC(,@06)                                  2512 11333000
         N     @06,@CF01129                                        2512 11334000
         LTR   @06,@06                                             2512 11335000
         BNZ   @RT02512                                            2512 11336000
*     RETURN;                       /*                       @Y30LB25*/ 11337000
*                                                                  2513 11338000
*   /*****************************************************************/ 11339000
*   /*                                                               */ 11340000
*   /* MAKE BVR REFLECT INACTIVE VOLUME                      @Y30LB25*/ 11341000
*   /*                                                               */ 11342000
*   /*****************************************************************/ 11343000
*                                                                  2514 11344000
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUF       @Y30LB25*/ 11345000
         MVC   BASEBUF(224),BASEBUF1                               2514 11346000
*   BASINAC=ON;                     /* MAKE INACTIVE         @Y30LB25*/ 11347000
*                                                                  2515 11348000
         L     @06,BASEVPTR                                        2515 11349000
         OI    BASINAC(@06),B'00000100'                            2515 11350000
*   /*****************************************************************/ 11351000
*   /*                                                               */ 11352000
*   /* CHECK FOR AN EXTENSION (IEZDEFVE)                     @Y30LB25*/ 11353000
*   /*                                                               */ 11354000
*   /*****************************************************************/ 11355000
*                                                                  2516 11356000
*   IF DEFVVEXT¬=FIXZERO            /* A DEFVE?              @Y30LB25*/ 11357000
*     THEN                          /* YES                   @Y30LB25*/ 11358000
         L     @15,DEFVVEXT(,DEFVPTR)                              2516 11359000
         LTR   @15,@15                                             2516 11360000
         BZ    @RF02516                                            2516 11361000
*     DO;                           /*                       @Y30LB25*/ 11362000
*       BCDVPTR=BASEVPTR;           /* SET COM MAP PTR       @Y30LB25*/ 11363000
         ST    @06,BCDVPTR                                         2518 11364000
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/ 11365000
         BAL   @14,PRODEFVE                                        2519 11366000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 11367000
*         THEN                      /* YES                   @Y30LB25*/ 11368000
         L     @06,RPLVPTR                                         2520 11369000
         LH    @06,RPLVRETC(,@06)                                  2520 11370000
         N     @06,@CF01129                                        2520 11371000
         LTR   @06,@06                                             2520 11372000
         BNZ   @RT02520                                            2520 11373000
*         RETURN;                   /*                       @Y30LB25*/ 11374000
*     END;                          /*                       @Y30LB25*/ 11375000
*                                                                  2522 11376000
*   /*****************************************************************/ 11377000
*   /*                                                               */ 11378000
*   /* CHECK IF VOLUME IS GROUPED                            @Y30LB25*/ 11379000
*   /*                                                               */ 11380000
*   /*****************************************************************/ 11381000
*                                                                  2523 11382000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 11383000
*     THEN                          /* YES                   @Y30LB25*/ 11384000
@RF02516 L     @06,BASEVPTR                                        2523 11385000
         TM    BASGRPV(@06),B'00100000'                            2523 11386000
         BNO   @RF02523                                            2523 11387000
*     DO;                           /*                       @Y30LB25*/ 11388000
*                                                                  2524 11389000
*       /*************************************************************/ 11390000
*       /*                                                           */ 11391000
*       /* GET AND UPDATE THE GROUP VOLUME RECORD            @Y30LB25*/ 11392000
*       /*                                                           */ 11393000
*       /*************************************************************/ 11394000
*                                                                  2525 11395000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/ 11396000
         MVC   GROUPKY(8),BASGROUP(@06)                            2525 11397000
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @Y30LB25*/ 11398000
         LA    @06,GKEY                                            2526 11399000
         L     @01,RPLVPTR                                         2526 11400000
         ST    @06,RPLVKEY(,@01)                                   2526 11401000
*       CALL READUPD1;              /* READ GVR              @Y30LB25*/ 11402000
         BAL   @14,READUPD1                                        2527 11403000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 11404000
*         THEN                      /* YES                   @Y30LB25*/ 11405000
         L     @06,RPLVPTR                                         2528 11406000
         LH    @06,RPLVRETC(,@06)                                  2528 11407000
         N     @06,@CF01129                                        2528 11408000
         LTR   @06,@06                                             2528 11409000
         BNZ   @RT02528                                            2528 11410000
*         RETURN;                   /*                       @Y30LB25*/ 11411000
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUFF      @Y30LB25*/ 11412000
         MVC   GROUPBUF(224),BASEBUF1                              2530 11413000
*       GRONINAC=GRONINAC+FIXONE;   /* INCR # INACT VOLS     @Y30LB25*/ 11414000
         L     @06,GROUPPTR                                        2531 11415000
         LA    @15,1                                               2531 11416000
         AH    @15,GRONINAC(,@06)                                  2531 11417000
         STH   @15,GRONINAC(,@06)                                  2531 11418000
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 11419000
*         THEN                      /* YES                   @Y30LB25*/ 11420000
         L     @01,BASEVPTR                                        2532 11421000
         TM    BASRSTD(@01),B'00001000'                            2532 11422000
         BNO   @RF02532                                            2532 11423000
*         GRONRSTD=GRONRSTD-FIXONE; /*                       @Y30LB25   11424000
*                                      DECR # RSTD VOLS      @Y30LB25*/ 11425000
         LH    @15,GRONRSTD(,@06)                                  2533 11426000
         BCTR  @15,0                                               2533 11427000
         STH   @15,GRONRSTD(,@06)                                  2533 11428000
*       ELSE                        /* CK GEN-USE            @Y30LB25*/ 11429000
*         IF BASGENUS=ON            /* GENERAL-USE?          @Y30LB25*/ 11430000
*           THEN                    /* YES                   @Y30LB25*/ 11431000
         B     @RC02532                                            2534 11432000
@RF02532 L     @06,BASEVPTR                                        2534 11433000
         TM    BASGENUS(@06),B'00010000'                           2534 11434000
         BNO   @RF02534                                            2534 11435000
*           DO;                     /*                       @Y30LB25*/ 11436000
*             GRONGEN=GRONGEN-FIXONE;/*                      @Y30LB25   11437000
*                                      DECR # G-USE VOLS     @Y30LB25*/ 11438000
*                                                                  2536 11439000
         L     @06,GROUPPTR                                        2536 11440000
         LH    @15,GRONGEN(,@06)                                   2536 11441000
         BCTR  @15,0                                               2536 11442000
         STH   @15,GRONGEN(,@06)                                   2536 11443000
*             /*******************************************************/ 11444000
*             /*                                                     */ 11445000
*             /* PROCESS GROUP VOLUME RECORD                 @Y30LB25*/ 11446000
*             /*                                                     */ 11447000
*             /*******************************************************/ 11448000
*                                                                  2537 11449000
*             ADDSUBGR=OFF;         /* SUBTRACT              @Y30LB25*/ 11450000
         NI    ADDSUBGR,B'11110111'                                2537 11451000
*             CALL VUPGH;           /* UPDATE GVR            @Y30LB25*/ 11452000
         BAL   @14,VUPGH                                           2538 11453000
*           END;                    /*                       @Y30LB25*/ 11454000
*       RPLVBUF=ADDR(GROUPBUF);     /* GVR BUF ADDR          @Y30LB25*/ 11455000
@RF02534 DS    0H                                                  2540 11456000
@RC02532 LA    @06,GROUPBUF                                        2540 11457000
         L     @01,RPLVPTR                                         2540 11458000
         ST    @06,RPLVBUF(,@01)                                   2540 11459000
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/ 11460000
         BAL   @14,WRITRECD                                        2541 11461000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 11462000
*         THEN                      /* YES                   @Y30LB25*/ 11463000
         L     @06,RPLVPTR                                         2542 11464000
         LH    @06,RPLVRETC(,@06)                                  2542 11465000
         N     @06,@CF01129                                        2542 11466000
         LTR   @06,@06                                             2542 11467000
         BNZ   @RT02542                                            2542 11468000
*         RETURN;                   /*                       @Y30LB25*/ 11469000
*                                                                  2543 11470000
*       /*************************************************************/ 11471000
*       /*                                                           */ 11472000
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/ 11473000
*       /*                                                           */ 11474000
*       /*************************************************************/ 11475000
*                                                                  2544 11476000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Y30LB25*/ 11477000
*         THEN                      /* YES                   @Y30LB25*/ 11478000
*                                                                  2544 11479000
         L     @06,BASEVPTR                                        2544 11480000
         TM    BASGENUS(@06),B'00010000'                           2544 11481000
         BNO   @RF02544                                            2544 11482000
*         /***********************************************************/ 11483000
*         /*                                                         */ 11484000
*         /* DELETE A GROUP VOLUME SERIAL NUMBER EXTENSION SLOT      */ 11485000
*         /*                                                 @Y30LB25*/ 11486000
*         /*                                                         */ 11487000
*         /***********************************************************/ 11488000
*                                                                  2545 11489000
*         DO;                       /*                       @Y30LB25*/ 11490000
*           EXPSLOT=OFF;            /* NO EXPIR DATE         @Y30LB25*/ 11491000
         NI    EXPSLOT,B'01111111'                                 2546 11492000
*           ADDSUBSL=OFF;           /* SUBTRACT              @Y30LB25*/ 11493000
         NI    ADDSUBSL,B'11111101'                                2547 11494000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   2548 11495000
*                                                            @Y30LB25   11496000
*                                      CREATE A SLOT         @Y30LB25*/ 11497000
         L     @15,@CV00767                                        2548 11498000
         LA    @01,@AL02548                                        2548 11499000
         BALR  @14,@15                                             2548 11500000
*           IF RPLVRETC¬=FIXZERO    /*                       @Y30LB25   11501000
*                                      ERROR?                @Y30LB25*/ 11502000
*             THEN                  /* YES                   @Y30LB25*/ 11503000
         L     @06,RPLVPTR                                         2549 11504000
         LH    @06,RPLVRETC(,@06)                                  2549 11505000
         N     @06,@CF01129                                        2549 11506000
         LTR   @06,@06                                             2549 11507000
         BNZ   @RT02549                                            2549 11508000
*             RETURN;               /*                       @Y30LB25*/ 11509000
*         END;                      /*                       @Y30LB25*/ 11510000
*     END;                          /*                       @Y30LB25*/ 11511000
*                                                                  2552 11512000
@RF02544 DS    0H                                                  2553 11513000
*   /*****************************************************************/ 11514000
*   /*                                                               */ 11515000
*   /* REESABLISH BVR RPL                                    @Y30LB25*/ 11516000
*   /*                                                               */ 11517000
*   /*****************************************************************/ 11518000
*                                                                  2553 11519000
*   BVOLKY=BASSERNO;                /* RESET VOLID           @Y30LB25*/ 11520000
@RF02523 L     @06,BASEVPTR                                        2553 11521000
         MVC   BVOLKY(6),BASSERNO(@06)                             2553 11522000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 11523000
         LA    @06,BKEY                                            2554 11524000
         L     @01,RPLVPTR                                         2554 11525000
         ST    @06,RPLVKEY(,@01)                                   2554 11526000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 11527000
         BAL   @14,READUPD1                                        2555 11528000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 11529000
*     THEN                          /* YES                   @Y30LB25*/ 11530000
         L     @06,RPLVPTR                                         2556 11531000
         LH    @15,RPLVRETC(,@06)                                  2556 11532000
         N     @15,@CF01129                                        2556 11533000
         LTR   @15,@15                                             2556 11534000
         BNZ   @RT02556                                            2556 11535000
*     RETURN;                       /*                       @Y30LB25*/ 11536000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Y30LB25*/ 11537000
         LA    @15,BASEBUF                                         2558 11538000
         ST    @15,RPLVBUF(,@06)                                   2558 11539000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 11540000
         BAL   @14,WRITRECD                                        2559 11541000
*   RETURN;                         /*                       @Y30LB25*/ 11542000
         B     @EL00060                                            2560 11543000
*   END DEACTV2;                    /*                       @Y30LB25*/ 11544000
         B     @EL00060                                            2561 11545000
*                                                                  2562 11546000
*   /*****************************************************************/ 11547000
*   /*                                                               */ 11548000
*   /* ENTRY NAME - ICBVUCHI                                 @Y30LB25*/ 11549000
*   /*                                                       @Y30LB25*/ 11550000
*   /* FUNCTION - CHAIN A BVR INTO EITHER A GROUP VOLUME     @Y30LB25*/ 11551000
*   /* RECORD (GVR) OR A NON-GROUP VOLUME RECORD (NGVR).     @Y30LB25*/ 11552000
*   /* FOR A NGVR THIS ROUTINE WILL GET, UPDATE, AND WRITE   @Y30LB25*/ 11553000
*   /* IT. THE CALLER MUST WRITE THE BASE VOLUME RECORD      @Y30LB25*/ 11554000
*   /* (BVR) WHICH WAS CHAINED IN TO EITHER THE GVR OR       @Y30LB25*/ 11555000
*   /* NGVR. ALSO, IF THE BVR WAS CHAINED IN THE GVR,        @Y30LB25*/ 11556000
*   /* THEN THE CALLER MUST SUPPLY AND THEN WRITE THE        @Y30LB25*/ 11557000
*   /* GVR. FINALLY, THE CALLER MUST FIRST UPDATE THE        @Y30LB25*/ 11558000
*   /* NUMBER OF GENERAL-USE, RESTRICTED, OR INACTIVE        @Y30LB25*/ 11559000
*   /* VOLUMES IN THE GVR.                                   @Y30LB25*/ 11560000
*   /*                                                       @Y30LB25*/ 11561000
*   /* INPUT -                                               @Y30LB25*/ 11562000
*   /* MSVC REQUEST PARAMETER LIST PTR IN RPLVPTR            @Y30LB25*/ 11563000
*   /* GROUP VOLUME RECORD PTR IN GROUPPTR (OPTIONAL)        @Y30LB25*/ 11564000
*   /* BASE VOLUME RECORD PTR IN BASEVPTR                    @Y30LB25*/ 11565000
*   /* FLAG IN PASSBYTE                                      @Y30LB25*/ 11566000
*   /* INDICATES GROUPED OR NON-GROUPED                      @Y30LB25*/ 11567000
*   /*                                                       @Y30LB25*/ 11568000
*   /* OUTPUT -                                              @Y30LB25*/ 11569000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 11570000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 11571000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 11572000
*   /* AN ERROR                                              @Y30LB25*/ 11573000
*   /*                                                               */ 11574000
*   /*****************************************************************/ 11575000
*                                                                  2562 11576000
*ICBVUCHI:                          /*                       @Y30LB25*/ 11577000
*   ENTRY(PTRGROUP,PTRBASEV,PTRRPLV,BYTEPASS);/*             @Y30LB25*/ 11578000
*                                                                  2562 11579000
@EP02562 MVC   @PC00001(16),0(@01)                                 2562 11580000
*   /*****************************************************************/ 11581000
*   /*                                                               */ 11582000
*   /* DECLARES FOR PASSED PARAMETERS                        @Y30LB25*/ 11583000
*   /* PTRGROUP, PTRBASEV, PTRRPLV, BYTEPASS                 @Y30LB25*/ 11584000
*   /*                                                               */ 11585000
*   /*****************************************************************/ 11586000
*                                                                  2563 11587000
*   DCL                                                            2563 11588000
*     PTRGROUP PTR(31);             /* PTR TO GVR            @Y30LB25*/ 11589000
*   DCL                                                            2564 11590000
*     PTRBASEV PTR(31);             /* PTR TO BVR            @Y30LB25*/ 11591000
*   DCL                                                            2565 11592000
*     PTRRPLV PTR(31);              /* RPLV PTR              @Y30LB25*/ 11593000
*   DCL                                                            2566 11594000
*     BYTEPASS CHAR(2);             /* GVR OR NGVR           @Y30LB25   11595000
*                                      ADD OR SUBTRACT       @Y30LB25*/ 11596000
*                                                                  2566 11597000
*   /*****************************************************************/ 11598000
*   /*                                                               */ 11599000
*   /* DECLARES                                              @Y30LB25*/ 11600000
*   /*                                                               */ 11601000
*   /*****************************************************************/ 11602000
*                                                                  2567 11603000
*   DCL                                                            2567 11604000
*     BASEBUF1 CHAR(LENGTH(BASEV)); /* BVR BUFFER            @Y30LB25*/ 11605000
*   DCL                                                            2568 11606000
*     SAVSERNO CHAR(6);             /* SAVE SERNO            @Y30LB25*/ 11607000
*   DCL                                                            2569 11608000
*     SAVSERN1 CHAR(6);             /* SAVE NEXT SERNO       @Y30LB25*/ 11609000
*   DCL                                                            2570 11610000
*     SAVBASPT PTR(31);             /* SAVE BVR PTR          @Y30LB25*/ 11611000
*   GROUPPTR=PTRGROUP;              /* SET GROUP PTR         @Y30LB25*/ 11612000
         L     @06,@PC00001                                        2571 11613000
         L     @06,PTRGROUP(,@06)                                  2571 11614000
         ST    @06,GROUPPTR                                        2571 11615000
*   BASEVPTR=PTRBASEV;              /* SET BASE PTR          @Y30LB25*/ 11616000
         L     @06,@PC00001+4                                      2572 11617000
         L     @06,PTRBASEV(,@06)                                  2572 11618000
         ST    @06,BASEVPTR                                        2572 11619000
*   RPLVPTR=PTRRPLV;                /* SET RPLV PTR          @Y30LB25*/ 11620000
         L     @06,@PC00001+8                                      2573 11621000
         L     @06,PTRRPLV(,@06)                                   2573 11622000
         ST    @06,RPLVPTR                                         2573 11623000
*   PASSBYTE=BYTEPASS;              /* GVR OR NGVR FLAG      @Y30LB25*/ 11624000
         L     @06,@PC00001+12                                     2574 11625000
         MVC   PASSBYTE(2),BYTEPASS(@06)                           2574 11626000
*   DIDKY=FIXONE;                   /* DVR ID OF 1           @Y30LB25*/ 11627000
         MVI   DIDKY,X'01'                                         2575 11628000
*   CIDKY=FIXONE;                   /* CVR ID OF 1           @Y30LB25*/ 11629000
         MVI   CIDKY,X'01'                                         2576 11630000
*   CALL VUCHI;                     /* CHAIN IN BVR          @Y30LB25*/ 11631000
         BAL   @14,VUCHI                                           2577 11632000
*   RETURN;                         /*                       @Y30LB25*/ 11633000
         B     @EL00001                                            2578 11634000
*                                                                  2579 11635000
*   /*****************************************************************/ 11636000
*   /*                                                               */ 11637000
*   /* PROCEDURE VUCHI IS CODED SO THAT COMMON ENTRY         @Y30LB25*/ 11638000
*   /* CODE IN ICBVUCHI CAN BE USED BY THIS MODULE           @Y30LB25*/ 11639000
*   /* AND BY OTHER MODULES. OTHER MODULES CALL              @Y30LB25*/ 11640000
*   /* ENTRY ICBVUCHI. THIS MODULE CALLS PROCEDURE           @Y30LB25*/ 11641000
*   /* VUCHI.                                                @Y30LB25*/ 11642000
*   /*                                                               */ 11643000
*   /*****************************************************************/ 11644000
*                                                                  2579 11645000
*VUCHI:                             /*                       @Y30LB25*/ 11646000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 11647000
VUCHI    ST    @14,@SA00061                                        2579 11648000
*   SAVBASPT=BASEVPTR;              /* SAVE BVR PTR          @Y30LB25*/ 11649000
         L     SAVBASPT,BASEVPTR                                   2580 11650000
*   NGVRPTR=ADDR(NGVRBUF);          /* MAP NGVR BUF          @ZDR2054*/ 11651000
         LA    NGVRPTR,NGVRBUF                                     2581 11652000
*   IF GRPFLG=ON                    /* GVR?                  @Y30LB25*/ 11653000
*     THEN                          /* YES                   @Y30LB25*/ 11654000
         TM    GRPFLG,B'00010000'                                  2582 11655000
         BNO   @RF02582                                            2582 11656000
*     DO;                           /*                       @Y30LB25*/ 11657000
*       CALL PROCGVRI;              /* PROCESS GVR           @Y30LB25*/ 11658000
         BAL   @14,PROCGVRI                                        2584 11659000
*       RETURN;                     /*                       @Y30LB25*/ 11660000
@EL00061 DS    0H                                                  2585 11661000
@EF00061 DS    0H                                                  2585 11662000
@ER00061 L     @14,@SA00061                                        2585 11663000
         BR    @14                                                 2585 11664000
*     END;                          /*                       @Y30LB25*/ 11665000
*                                                                  2586 11666000
*   /*****************************************************************/ 11667000
*   /*                                                               */ 11668000
*   /* READ FOR NON-GROUP VOLUME RECORD                      @Y30LB25*/ 11669000
*   /*                                                               */ 11670000
*   /*****************************************************************/ 11671000
*                                                                  2587 11672000
*   RPLVKEY=ADDR(NGKEY);            /* SET NGVR KEY          @Y30LB25*/ 11673000
@RF02582 LA    @03,NGKEY                                           2587 11674000
         L     @01,RPLVPTR                                         2587 11675000
         ST    @03,RPLVKEY(,@01)                                   2587 11676000
*   CALL READUPD1;                  /* READ NGVR             @Y30LB25*/ 11677000
         BAL   @14,READUPD1                                        2588 11678000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 11679000
*     THEN                          /* YES                   @Y30LB25*/ 11680000
         L     @03,RPLVPTR                                         2589 11681000
         LH    @15,RPLVRETC(,@03)                                  2589 11682000
         N     @15,@CF01129                                        2589 11683000
         LTR   @15,@15                                             2589 11684000
         BNZ   @RT02589                                            2589 11685000
*     RETURN;                       /*                       @Y30LB25*/ 11686000
*   NGVRBUF=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 11687000
         MVC   NGVRBUF(224),BASEBUF1                               2591 11688000
*   RPLVBUF=ADDR(NGVRBUF);          /* BUF ADDR FOR WRITE    @Y30LB25*/ 11689000
*                                                                  2592 11690000
         LA    @15,NGVRBUF                                         2592 11691000
         ST    @15,RPLVBUF(,@03)                                   2592 11692000
*   /*****************************************************************/ 11693000
*   /*                                                               */ 11694000
*   /* BVR IS TO BE THE VERY FIRST VOLUME IN THE NGVR CHAIN. @Y30LB25*/ 11695000
*   /*                                                               */ 11696000
*   /*****************************************************************/ 11697000
*                                                                  2593 11698000
*   IF NGVNOVOL=FIXZERO             /* ANY VOLS IN CHAIN?    @Y30LB25*/ 11699000
*     THEN                          /* NO                    @Y30LB25*/ 11700000
         LH    @03,NGVNOVOL(,NGVRPTR)                              2593 11701000
         LTR   @03,@03                                             2593 11702000
         BNZ   @RF02593                                            2593 11703000
*     DO;                           /*                       @Y30LB25*/ 11704000
*       BASFIRST=ON;                /* FIRST IN CHAIN        @Y30LB25*/ 11705000
*       BASLAST=ON;                 /* ALSO LAST IN CHAIN    @Y30LB25*/ 11706000
         L     @06,BASEVPTR                                        2596 11707000
         OI    BASFIRST(@06),B'00011000'                           2596 11708000
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/ 11709000
         MVI   BASPREV+1(@06),C' '                                 2597 11710000
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     2597 11711000
         MVI   BASPREV(@06),C' '                                   2597 11712000
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/ 11713000
         MVI   BASNEXTV+1(@06),C' '                                2598 11714000
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   2598 11715000
         MVI   BASNEXTV(@06),C' '                                  2598 11716000
*       NGVFVOL=BASSERNO;           /* 1ST SERIAL #          @Y30LB25*/ 11717000
         MVC   NGVFVOL(6,NGVRPTR),BASSERNO(@06)                    2599 11718000
*       NGVLVOL=BASSERNO;           /* LAST SERIAL #         @Y30LB25*/ 11719000
         MVC   NGVLVOL(6,NGVRPTR),BASSERNO(@06)                    2600 11720000
*       NGVNOVOL=FIXONE;            /* 1 VOL IN CHAIN        @Y30LB25*/ 11721000
         MVC   NGVNOVOL(2,NGVRPTR),@CH00046                        2601 11722000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 11723000
         BAL   @14,WRITRECD                                        2602 11724000
*       RETURN;                     /*                       @Y30LB25*/ 11725000
         B     @EL00061                                            2603 11726000
*     END;                          /*                       @Y30LB25*/ 11727000
*                                                                  2604 11728000
*   /*****************************************************************/ 11729000
*   /*                                                               */ 11730000
*   /* BVR TO BE FIRST IN THE EXISTING CHAIN                 @Y30LB25*/ 11731000
*   /*                                                               */ 11732000
*   /*****************************************************************/ 11733000
*                                                                  2605 11734000
*   IF BASSERNO<NGVFVOL             /* FIRST IN CHAIN?       @Y30LB25*/ 11735000
*     THEN                          /* YES                   @Y30LB25*/ 11736000
@RF02593 L     @03,BASEVPTR                                        2605 11737000
         CLC   BASSERNO(6,@03),NGVFVOL(NGVRPTR)                    2605 11738000
         BNL   @RF02605                                            2605 11739000
*     DO;                           /*                       @Y30LB25*/ 11740000
*       BASNEXTV=NGVFVOL;           /* PT TO OLD 1ST BVR     @Y30LB25*/ 11741000
         MVC   BASNEXTV(6,@03),NGVFVOL(NGVRPTR)                    2607 11742000
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/ 11743000
         MVI   BASPREV+1(@03),C' '                                 2608 11744000
         MVC   BASPREV+2(4,@03),BASPREV+1(@03)                     2608 11745000
         MVI   BASPREV(@03),C' '                                   2608 11746000
*       NGVFVOL=BASSERNO;           /* NEW 1ST BVR           @Y30LB25*/ 11747000
         MVC   NGVFVOL(6,NGVRPTR),BASSERNO(@03)                    2609 11748000
*       BASFIRST=ON;                /* 1ST FLAG ON           @Y30LB25*/ 11749000
*       BASLAST=OFF;                /* NOT LAST IN CHAIN     @Y30LB25*/ 11750000
         OI    BASFIRST(@03),B'00010000'                           2611 11751000
         NI    BASLAST(@03),B'11110111'                            2611 11752000
*       NGVNOVOL=NGVNOVOL+FIXONE;   /* INCREM # VOLS         @Y30LB25*/ 11753000
         LA    @03,1                                               2612 11754000
         AH    @03,NGVNOVOL(,NGVRPTR)                              2612 11755000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2612 11756000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 11757000
         BAL   @14,WRITRECD                                        2613 11758000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 11759000
*         THEN                      /* YES                   @Y30LB25*/ 11760000
         L     @03,RPLVPTR                                         2614 11761000
         LH    @15,RPLVRETC(,@03)                                  2614 11762000
         N     @15,@CF01129                                        2614 11763000
         LTR   @15,@15                                             2614 11764000
         BNZ   @RT02614                                            2614 11765000
*         RETURN;                   /*                       @Y30LB25*/ 11766000
*       BVOLKY=BASNEXTV;            /* KEY - OLD 1ST BVR     @Y30LB25*/ 11767000
         L     @01,BASEVPTR                                        2616 11768000
         MVC   BVOLKY(6),BASNEXTV(@01)                             2616 11769000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 11770000
         LA    @15,BKEY                                            2617 11771000
         ST    @15,RPLVKEY(,@03)                                   2617 11772000
*       CALL READUPD1;              /* GET OLD 1ST BVR       @Y30LB25*/ 11773000
         BAL   @14,READUPD1                                        2618 11774000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 11775000
*         THEN                      /* YES                   @Y30LB25*/ 11776000
         L     @03,RPLVPTR                                         2619 11777000
         LH    @03,RPLVRETC(,@03)                                  2619 11778000
         N     @03,@CF01129                                        2619 11779000
         LTR   @03,@03                                             2619 11780000
         BNZ   @RT02619                                            2619 11781000
*         RETURN;                   /*                       @Y30LB25*/ 11782000
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD 1ST BVR BUF       @Y30LB25*/ 11783000
         LA    @03,BASEBUF1                                        2621 11784000
         ST    @03,BASEVPTR                                        2621 11785000
*       BASFIRST=OFF;               /* 1ST IN CHAIN OFF      @Y30LB25*/ 11786000
         NI    BASFIRST(@03),B'11101111'                           2622 11787000
*       BASPREV=NGVFVOL;            /* PT BACK CHAIN         @Y30LB25*/ 11788000
         MVC   BASPREV(6,@03),NGVFVOL(NGVRPTR)                     2623 11789000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 11790000
         ST    SAVBASPT,BASEVPTR                                   2624 11791000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 11792000
         BAL   @14,WRITRECD                                        2625 11793000
*       RETURN;                     /*                       @Y30LB25*/ 11794000
         B     @EL00061                                            2626 11795000
*     END;                          /*                       @Y30LB25*/ 11796000
*                                                                  2627 11797000
*   /*****************************************************************/ 11798000
*   /*                                                               */ 11799000
*   /* BVR TO BE LAST IN THE EXISTING CHAIN                  @Y30LB25*/ 11800000
*   /*                                                               */ 11801000
*   /*****************************************************************/ 11802000
*                                                                  2628 11803000
*   IF BASSERNO>NGVLVOL             /* LAST IN CHAIN?        @Y30LB25*/ 11804000
*     THEN                          /* YES                   @Y30LB25*/ 11805000
@RF02605 L     @03,BASEVPTR                                        2628 11806000
         CLC   BASSERNO(6,@03),NGVLVOL(NGVRPTR)                    2628 11807000
         BNH   @RF02628                                            2628 11808000
*     DO;                           /*                       @Y30LB25*/ 11809000
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/ 11810000
         MVI   BASNEXTV+1(@03),C' '                                2630 11811000
         MVC   BASNEXTV+2(4,@03),BASNEXTV+1(@03)                   2630 11812000
         MVI   BASNEXTV(@03),C' '                                  2630 11813000
*       BASPREV=NGVLVOL;            /* PT TO OLD LAST        @Y30LB25   11814000
*                                      IN CHAIN              @Y30LB25*/ 11815000
         MVC   BASPREV(6,@03),NGVLVOL(NGVRPTR)                     2631 11816000
*       NGVLVOL=BASSERNO;           /* NEW LAST BVR          @Y30LB25*/ 11817000
         MVC   NGVLVOL(6,NGVRPTR),BASSERNO(@03)                    2632 11818000
*       BASFIRST=OFF;               /* NOT 1ST IN CHAIN      @Y30LB25*/ 11819000
*       BASLAST=ON;                 /* SET LAST FLAG         @Y30LB25*/ 11820000
         OI    BASLAST(@03),B'00001000'                            2634 11821000
         NI    BASFIRST(@03),B'11101111'                           2634 11822000
*       NGVNOVOL=NGVNOVOL+FIXONE;   /* INCREM # VOLS         @Y30LB25*/ 11823000
         LA    @03,1                                               2635 11824000
         AH    @03,NGVNOVOL(,NGVRPTR)                              2635 11825000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2635 11826000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 11827000
         BAL   @14,WRITRECD                                        2636 11828000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 11829000
*         THEN                      /* YES                   @Y30LB25*/ 11830000
         L     @03,RPLVPTR                                         2637 11831000
         LH    @15,RPLVRETC(,@03)                                  2637 11832000
         N     @15,@CF01129                                        2637 11833000
         LTR   @15,@15                                             2637 11834000
         BNZ   @RT02637                                            2637 11835000
*         RETURN;                   /*                       @Y30LB25*/ 11836000
*       BVOLKY=BASPREV;             /* GET OLD LAST BVR      @Y30LB25*/ 11837000
         L     @01,BASEVPTR                                        2639 11838000
         MVC   BVOLKY(6),BASPREV(@01)                              2639 11839000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 11840000
         LA    @15,BKEY                                            2640 11841000
         ST    @15,RPLVKEY(,@03)                                   2640 11842000
*       CALL READUPD1;              /* GET OLD LAST BVR      @Y30LB25*/ 11843000
         BAL   @14,READUPD1                                        2641 11844000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 11845000
*         THEN                      /* YES                   @Y30LB25*/ 11846000
         L     @03,RPLVPTR                                         2642 11847000
         LH    @03,RPLVRETC(,@03)                                  2642 11848000
         N     @03,@CF01129                                        2642 11849000
         LTR   @03,@03                                             2642 11850000
         BNZ   @RT02642                                            2642 11851000
*         RETURN;                   /*                       @Y30LB25*/ 11852000
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD 1ST BVR BUF       @Y30LB25*/ 11853000
         LA    @03,BASEBUF1                                        2644 11854000
         ST    @03,BASEVPTR                                        2644 11855000
*       BASLAST=OFF;                /* LAST IN CHAIN OFF     @Y30LB25*/ 11856000
         NI    BASLAST(@03),B'11110111'                            2645 11857000
*       BASNEXTV=NGVLVOL;           /* PT AHEAD CHAIN        @Y30LB25*/ 11858000
         MVC   BASNEXTV(6,@03),NGVLVOL(NGVRPTR)                    2646 11859000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 11860000
         ST    SAVBASPT,BASEVPTR                                   2647 11861000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 11862000
         BAL   @14,WRITRECD                                        2648 11863000
*       RETURN;                     /*                       @Y30LB25*/ 11864000
         B     @EL00061                                            2649 11865000
*     END;                          /*                       @Y30LB25*/ 11866000
*                                                                  2650 11867000
*   /*****************************************************************/ 11868000
*   /*                                                               */ 11869000
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/ 11870000
*   /*                                                               */ 11871000
*   /*****************************************************************/ 11872000
*                                                                  2651 11873000
*   NGVNOVOL=NGVNOVOL+FIXONE;       /* INCR # CHAIN VOLS     @Y30LB25*/ 11874000
@RF02628 LA    @03,1                                               2651 11875000
         AH    @03,NGVNOVOL(,NGVRPTR)                              2651 11876000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2651 11877000
*   CALL WRITRECD;                  /* WRITE NGVR            @Y30LB25*/ 11878000
         BAL   @14,WRITRECD                                        2652 11879000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 11880000
*     THEN                          /* YES                   @Y30LB25*/ 11881000
         L     @03,RPLVPTR                                         2653 11882000
         LH    @03,RPLVRETC(,@03)                                  2653 11883000
         N     @03,@CF01129                                        2653 11884000
         LTR   @03,@03                                             2653 11885000
         BNZ   @RT02653                                            2653 11886000
*     RETURN;                       /*                       @Y30LB25*/ 11887000
*   BVOLKY=NGVFVOL;                 /* BEGIN OF CHAIN        @Y30LB25*/ 11888000
         MVC   BVOLKY(6),NGVFVOL(NGVRPTR)                          2655 11889000
*   CALL PROCBVRI;                  /* CHAIN INTO CHAIN      @Y30LB25*/ 11890000
         BAL   @14,PROCBVRI                                        2656 11891000
*   RETURN;                         /*                       @Y30LB25*/ 11892000
         B     @EL00061                                            2657 11893000
*   END VUCHI;                      /*                       @Y30LB25*/ 11894000
         B     @EL00061                                            2658 11895000
*                                                                  2659 11896000
*   /*****************************************************************/ 11897000
*   /*                                                               */ 11898000
*   /* PROCEDURE NAME - PROCGVRI                             @Y30LB25*/ 11899000
*   /*                                                       @Y30LB25*/ 11900000
*   /* FUNCTION - CHAIN A BVR INTO A GROUP VOLUME            @Y30LB25*/ 11901000
*   /* RECORD (GVR).                                         @Y30LB25*/ 11902000
*   /*                                                       @Y30LB25*/ 11903000
*   /* INPUT -                                               @Y30LB25*/ 11904000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 11905000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 11906000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 11907000
*   /*                                                       @Y30LB25*/ 11908000
*   /* OUTPUT -                                              @Y30LB25*/ 11909000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 11910000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 11911000
*   /* AN ERROR                                              @Y30LB25*/ 11912000
*   /*                                                               */ 11913000
*   /*****************************************************************/ 11914000
*                                                                  2659 11915000
*PROCGVRI:                          /*                       @Y30LB25*/ 11916000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 11917000
*                                                                  2659 11918000
PROCGVRI ST    @14,@SA00062                                        2659 11919000
*   /*****************************************************************/ 11920000
*   /*                                                               */ 11921000
*   /* BVR IS TO BE THE VERY FIRST VOLUME IN THE GVR CHAIN.  @Y30LB25*/ 11922000
*   /*                                                               */ 11923000
*   /*****************************************************************/ 11924000
*                                                                  2660 11925000
*   IF GRONGEN+GRONRSTD+GRONINAC<FIXTWO/* SET BY CALLER      @Y30LB25*/ 11926000
*     THEN                          /* YES                   @Y30LB25*/ 11927000
         L     @15,GROUPPTR                                        2660 11928000
         LH    @14,GRONGEN(,@15)                                   2660 11929000
         AH    @14,GRONRSTD(,@15)                                  2660 11930000
         AH    @14,GRONINAC(,@15)                                  2660 11931000
         C     @14,@CF00044                                        2660 11932000
         BNL   @RF02660                                            2660 11933000
*     DO;                           /*                       @Y30LB25*/ 11934000
*       BASFIRST=ON;                /* 1ST IN CHAIN          @Y30LB25*/ 11935000
*       BASLAST=ON;                 /* LAST IN CHAIN         @Y30LB25*/ 11936000
         L     @06,BASEVPTR                                        2663 11937000
         OI    BASFIRST(@06),B'00011000'                           2663 11938000
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/ 11939000
         MVI   BASPREV+1(@06),C' '                                 2664 11940000
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     2664 11941000
         MVI   BASPREV(@06),C' '                                   2664 11942000
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/ 11943000
         MVI   BASNEXTV+1(@06),C' '                                2665 11944000
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   2665 11945000
         MVI   BASNEXTV(@06),C' '                                  2665 11946000
*       GROFSN=BASSERNO;            /* 1ST SERIAL NUMBER     @Y30LB25*/ 11947000
         MVC   GROFSN(6,@15),BASSERNO(@06)                         2666 11948000
*       GROLSN=BASSERNO;            /* LAST SERIAL #         @Y30LB25*/ 11949000
         MVC   GROLSN(6,@15),BASSERNO(@06)                         2667 11950000
*       RETURN;                     /*                       @Y30LB25*/ 11951000
@EL00062 DS    0H                                                  2668 11952000
@EF00062 DS    0H                                                  2668 11953000
@ER00062 L     @14,@SA00062                                        2668 11954000
         BR    @14                                                 2668 11955000
*     END;                          /*                       @Y30LB25*/ 11956000
*                                                                  2669 11957000
*   /*****************************************************************/ 11958000
*   /*                                                               */ 11959000
*   /* BVR TO BE FIRST IN THE EXISTING CHAIN                 @Y30LB25*/ 11960000
*   /*                                                               */ 11961000
*   /*****************************************************************/ 11962000
*                                                                  2670 11963000
*   IF BASSERNO<GROFSN              /* 1ST IN CHAIN?         @Y30LB25*/ 11964000
*     THEN                          /* YES                   @Y30LB25*/ 11965000
@RF02660 L     @15,BASEVPTR                                        2670 11966000
         L     @14,GROUPPTR                                        2670 11967000
         CLC   BASSERNO(6,@15),GROFSN(@14)                         2670 11968000
         BNL   @RF02670                                            2670 11969000
*     DO;                           /*                       @Y30LB25*/ 11970000
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/ 11971000
         MVI   BASPREV+1(@15),C' '                                 2672 11972000
         MVC   BASPREV+2(4,@15),BASPREV+1(@15)                     2672 11973000
         MVI   BASPREV(@15),C' '                                   2672 11974000
*       BASNEXTV=GROFSN;            /* PT TO OLD 1ST BVR     @Y30LB25*/ 11975000
         MVC   BASNEXTV(6,@15),GROFSN(@14)                         2673 11976000
*       GROFSN=BASSERNO;            /* NEW 1ST BVR           @Y30LB25*/ 11977000
         MVC   GROFSN(6,@14),BASSERNO(@15)                         2674 11978000
*       BASFIRST=ON;                /* 1ST FLAG ON           @Y30LB25*/ 11979000
*       BASLAST=OFF;                /* NOT LAST              @Y30LB25*/ 11980000
         OI    BASFIRST(@15),B'00010000'                           2676 11981000
         NI    BASLAST(@15),B'11110111'                            2676 11982000
*       BVOLKY=BASNEXTV;            /* KEY OF OLD 1ST BVR    @Y30LB25*/ 11983000
         MVC   BVOLKY(6),BASNEXTV(@15)                             2677 11984000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 11985000
         LA    @15,BKEY                                            2678 11986000
         L     @14,RPLVPTR                                         2678 11987000
         ST    @15,RPLVKEY(,@14)                                   2678 11988000
*       CALL READUPD1;              /* GET OLD 1ST BVR       @Y30LB25*/ 11989000
         BAL   @14,READUPD1                                        2679 11990000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 11991000
*         THEN                      /* YES                   @Y30LB25*/ 11992000
         L     @01,RPLVPTR                                         2680 11993000
         LH    @15,RPLVRETC(,@01)                                  2680 11994000
         N     @15,@CF01129                                        2680 11995000
         LTR   @15,@15                                             2680 11996000
         BNZ   @RT02680                                            2680 11997000
*         RETURN;                   /*                       @Y30LB25*/ 11998000
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD 1ST BVR BUF       @Y30LB25*/ 11999000
         LA    @15,BASEBUF1                                        2682 12000000
         ST    @15,BASEVPTR                                        2682 12001000
*       BASFIRST=OFF;               /* 1ST FLAG OFF          @Y30LB25*/ 12002000
         NI    BASFIRST(@15),B'11101111'                           2683 12003000
*       BASPREV=GROFSN;             /* PT TO NEW 1ST BVR     @Y30LB25*/ 12004000
         L     @14,GROUPPTR                                        2684 12005000
         MVC   BASPREV(6,@15),GROFSN(@14)                          2684 12006000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 12007000
         ST    SAVBASPT,BASEVPTR                                   2685 12008000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 12009000
         BAL   @14,WRITRECD                                        2686 12010000
*       RETURN;                     /*                       @Y30LB25*/ 12011000
         B     @EL00062                                            2687 12012000
*     END;                          /*                       @Y30LB25*/ 12013000
*                                                                  2688 12014000
*   /*****************************************************************/ 12015000
*   /*                                                               */ 12016000
*   /* BVR TO BE LAST IN THE EXISTING CHAIN                  @Y30LB25*/ 12017000
*   /*                                                               */ 12018000
*   /*****************************************************************/ 12019000
*                                                                  2689 12020000
*   IF BASSERNO>GROLSN              /* LAST IN CHAIN?        @Y30LB25*/ 12021000
*     THEN                          /* YES                   @Y30LB25*/ 12022000
@RF02670 L     @15,BASEVPTR                                        2689 12023000
         L     @14,GROUPPTR                                        2689 12024000
         CLC   BASSERNO(6,@15),GROLSN(@14)                         2689 12025000
         BNH   @RF02689                                            2689 12026000
*     DO;                           /*                       @Y30LB25*/ 12027000
*       BASPREV=GROLSN;             /* PT TO OLD LAST        @Y30LB25   12028000
*                                      IN CHAIN              @Y30LB25*/ 12029000
         MVC   BASPREV(6,@15),GROLSN(@14)                          2691 12030000
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/ 12031000
         MVI   BASNEXTV+1(@15),C' '                                2692 12032000
         MVC   BASNEXTV+2(4,@15),BASNEXTV+1(@15)                   2692 12033000
         MVI   BASNEXTV(@15),C' '                                  2692 12034000
*       GROLSN=BASSERNO;            /* NEW LAST BVR          @Y30LB25*/ 12035000
         MVC   GROLSN(6,@14),BASSERNO(@15)                         2693 12036000
*       BASLAST=ON;                 /* LAST FLAG ON          @Y30LB25*/ 12037000
*       BASFIRST=OFF;               /* NOT 1ST IN CHAIN      @Y30LB25*/ 12038000
         OI    BASLAST(@15),B'00001000'                            2695 12039000
         NI    BASFIRST(@15),B'11101111'                           2695 12040000
*       BVOLKY=BASPREV;             /* OLD LAST BVR          @Y30LB25*/ 12041000
         MVC   BVOLKY(6),BASPREV(@15)                              2696 12042000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 12043000
         LA    @15,BKEY                                            2697 12044000
         L     @14,RPLVPTR                                         2697 12045000
         ST    @15,RPLVKEY(,@14)                                   2697 12046000
*       CALL READUPD1;              /* GET OLD LAST BVR      @Y30LB25*/ 12047000
         BAL   @14,READUPD1                                        2698 12048000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 12049000
*         THEN                      /* YES                   @Y30LB25*/ 12050000
         L     @01,RPLVPTR                                         2699 12051000
         LH    @15,RPLVRETC(,@01)                                  2699 12052000
         N     @15,@CF01129                                        2699 12053000
         LTR   @15,@15                                             2699 12054000
         BNZ   @RT02699                                            2699 12055000
*         RETURN;                   /*                       @Y30LB25*/ 12056000
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD LAST BVR BUF      @Y30LB25*/ 12057000
         LA    @15,BASEBUF1                                        2701 12058000
         ST    @15,BASEVPTR                                        2701 12059000
*       BASLAST=OFF;                /* LAST FLAG OFF         @Y30LB25*/ 12060000
         NI    BASLAST(@15),B'11110111'                            2702 12061000
*       BASNEXTV=GROLSN;            /* PT TO NEW LAST BVR    @Y30LB25*/ 12062000
         L     @14,GROUPPTR                                        2703 12063000
         MVC   BASNEXTV(6,@15),GROLSN(@14)                         2703 12064000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 12065000
         ST    SAVBASPT,BASEVPTR                                   2704 12066000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 12067000
         BAL   @14,WRITRECD                                        2705 12068000
*       RETURN;                     /*                       @Y30LB25*/ 12069000
         B     @EL00062                                            2706 12070000
*     END;                          /*                       @Y30LB25*/ 12071000
*                                                                  2707 12072000
*   /*****************************************************************/ 12073000
*   /*                                                               */ 12074000
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/ 12075000
*   /*                                                               */ 12076000
*   /*****************************************************************/ 12077000
*                                                                  2708 12078000
*   BVOLKY=GROFSN;                  /* 1ST IN CHAIN          @Y30LB25*/ 12079000
@RF02689 L     @01,GROUPPTR                                        2708 12080000
         MVC   BVOLKY(6),GROFSN(@01)                               2708 12081000
*   CALL PROCBVRI;                  /* CHAIN INTO CHAIN      @Y30LB25*/ 12082000
         BAL   @14,PROCBVRI                                        2709 12083000
*   RETURN;                         /*                       @Y30LB25*/ 12084000
         B     @EL00062                                            2710 12085000
*   END PROCGVRI;                   /*                       @Y30LB25*/ 12086000
         B     @EL00062                                            2711 12087000
*                                                                  2712 12088000
*   /*****************************************************************/ 12089000
*   /*                                                               */ 12090000
*   /* PROCEDURE NAME - PROCBVRI                             @Y30LB25*/ 12091000
*   /*                                                       @Y30LB25*/ 12092000
*   /* FUNCTION - CHAIN A BVR INTO A GROUP VOLUME            @Y30LB25*/ 12093000
*   /* RECORD (GVR) OR NON-GROUP VOLUME RECORD (NGVR).       @Y30LB25*/ 12094000
*   /*                                                       @Y30LB25*/ 12095000
*   /* INPUT -                                               @Y30LB25*/ 12096000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12097000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 12098000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 12099000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12100000
*   /*                                                       @Y30LB25*/ 12101000
*   /* OUTPUT -                                              @Y30LB25*/ 12102000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12103000
*   /* AN ERROR                                              @Y30LB25*/ 12104000
*   /*                                                               */ 12105000
*   /*****************************************************************/ 12106000
*                                                                  2712 12107000
*PROCBVRI:                          /*                       @Y30LB25*/ 12108000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12109000
*                                                                  2712 12110000
PROCBVRI ST    @14,@SA00063                                        2712 12111000
*   /*****************************************************************/ 12112000
*   /*                                                               */ 12113000
*   /* CHECK FOR CHAIN IN AS SECOND IN THE CHAIN             @Y30LB25*/ 12114000
*   /*                                                               */ 12115000
*   /*****************************************************************/ 12116000
*                                                                  2713 12117000
*   SAVSERNO=BASSERNO;              /* SAVE - 1ST BVR        @Y30LB25*/ 12118000
         L     @01,BASEVPTR                                        2713 12119000
         MVC   SAVSERNO(6),BASSERNO(@01)                           2713 12120000
*   BASEVPTR=ADDR(BASEBUF1);        /* MAP FOR BUF           @Y30LB25*/ 12121000
         LA    @15,BASEBUF1                                        2714 12122000
         ST    @15,BASEVPTR                                        2714 12123000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 12124000
         LA    @15,BKEY                                            2715 12125000
         L     @14,RPLVPTR                                         2715 12126000
         ST    @15,RPLVKEY(,@14)                                   2715 12127000
*   CALL READUPD1;                  /* READ 1ST BVR          @Y30LB25   12128000
*                                      IN CHAIN              @Y30LB25*/ 12129000
         BAL   @14,READUPD1                                        2716 12130000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 12131000
*     THEN                          /* YES                   @Y30LB25*/ 12132000
         L     @01,RPLVPTR                                         2717 12133000
         LH    @15,RPLVRETC(,@01)                                  2717 12134000
         N     @15,@CF01129                                        2717 12135000
         LTR   @15,@15                                             2717 12136000
         BNZ   @RT02717                                            2717 12137000
*     RETURN;                       /*                       @Y30LB25*/ 12138000
*   IF BASNEXTV>SAVSERNO            /* 2ND IN CHAIN?         @Y30LB25*/ 12139000
*     THEN                          /* YES                   @Y30LB25*/ 12140000
         L     @15,BASEVPTR                                        2719 12141000
         CLC   BASNEXTV(6,@15),SAVSERNO                            2719 12142000
         BNH   @RF02719                                            2719 12143000
*     DO;                           /*                       @Y30LB25*/ 12144000
*       SAVSERN1=BASSERNO;          /* SAVE SERNO OF         @Y30LB25   12145000
*                                      BVR READ              @Y30LB25*/ 12146000
         MVC   SAVSERN1(6),BASSERNO(@15)                           2721 12147000
*       CALL CHAININ;               /* CHAIN IN NEW BVR      @Y30LB25*/ 12148000
         BAL   @14,CHAININ                                         2722 12149000
*       RETURN;                     /*                       @Y30LB25*/ 12150000
@EL00063 DS    0H                                                  2723 12151000
@EF00063 DS    0H                                                  2723 12152000
@ER00063 L     @14,@SA00063                                        2723 12153000
         BR    @14                                                 2723 12154000
*     END;                          /*                       @Y30LB25*/ 12155000
*                                                                  2724 12156000
*   /*****************************************************************/ 12157000
*   /*                                                               */ 12158000
*   /* BVR TO BE CHAINED IN AFTER SECOND BVR IN THE CHAIN    @Y30LB25*/ 12159000
*   /*                                                               */ 12160000
*   /*****************************************************************/ 12161000
*                                                                  2725 12162000
*   DO WHILE BASNEXTV<SAVSERNO;     /* LOOP THRU CHAIN       @Y30LB25*/ 12163000
@RF02719 B     @DE02725                                            2725 12164000
@DL02725 DS    0H                                                  2726 12165000
*     BVOLKY=BASNEXTV;              /* SAVE KEY FOR          @Y30LB25   12166000
*                                      NEXT READ             @Y30LB25*/ 12167000
         L     @01,BASEVPTR                                        2726 12168000
         MVC   BVOLKY(6),BASNEXTV(@01)                             2726 12169000
*     RPLVKEY=ADDR(BKEY);           /* SET KEY ADDR          @Y30LB25*/ 12170000
         LA    @15,BKEY                                            2727 12171000
         L     @14,RPLVPTR                                         2727 12172000
         ST    @15,RPLVKEY(,@14)                                   2727 12173000
*     CALL READUPD1;                /* READ A BVR            @Y30LB25*/ 12174000
         BAL   @14,READUPD1                                        2728 12175000
*     IF RPLVRETC¬=FIXZERO          /* LOOP CONTROL          @Y30LB25*/ 12176000
*       THEN                        /* ERROR                 @Y30LB25*/ 12177000
         L     @01,RPLVPTR                                         2729 12178000
         LH    @15,RPLVRETC(,@01)                                  2729 12179000
         N     @15,@CF01129                                        2729 12180000
         LTR   @15,@15                                             2729 12181000
         BNZ   @RT02729                                            2729 12182000
*       RETURN;                     /*                       @Y30LB25*/ 12183000
*     SAVSERN1=BASSERNO;            /* SAVE SERNO OF BVR     @Y30LB25*/ 12184000
         L     @01,BASEVPTR                                        2731 12185000
         MVC   SAVSERN1(6),BASSERNO(@01)                           2731 12186000
*   END;                            /*                       @Y30LB25*/ 12187000
@DE02725 L     @01,BASEVPTR                                        2732 12188000
         CLC   BASNEXTV(6,@01),SAVSERNO                            2732 12189000
         BL    @DL02725                                            2732 12190000
*   CALL CHAININ;                   /* CHAIN IN NEW BVR      @Y30LB25*/ 12191000
         BAL   @14,CHAININ                                         2733 12192000
*   RETURN;                         /*                       @Y30LB25*/ 12193000
         B     @EL00063                                            2734 12194000
*   END PROCBVRI;                   /*                       @Y30LB25*/ 12195000
         B     @EL00063                                            2735 12196000
*                                                                  2736 12197000
*   /*****************************************************************/ 12198000
*   /*                                                               */ 12199000
*   /* PROCEDURE NAME - READUPD1                             @Y30LB25*/ 12200000
*   /*                                                       @Y30LB25*/ 12201000
*   /* FUNCTION -                                            @Y30LB25*/ 12202000
*   /* READ AN MSVC RECORD FOR UPDATE INTO BASEBUF1          @Y30LB25*/ 12203000
*   /*                                                       @Y30LB25*/ 12204000
*   /* INPUT -                                               @Y30LB25*/ 12205000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12206000
*   /* ADDRESS OF KEY TO READ IN RPLVKEY                     @Y30LB25*/ 12207000
*   /*                                                       @Y30LB25*/ 12208000
*   /* OUTPUT -                                              @Y30LB25*/ 12209000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12210000
*   /* AN ERROR                                              @Y30LB25*/ 12211000
*   /* MSVC RECORD                                           @Y30LB25*/ 12212000
*   /*                                                               */ 12213000
*   /*****************************************************************/ 12214000
*                                                                  2736 12215000
*READUPD1:                          /*                       @Y30LB25*/ 12216000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12217000
READUPD1 ST    @14,@SA00064                                        2736 12218000
*   RPLVBUF=ADDR(BASEBUF1);         /* ADDR OF BUF           @Y30LB25*/ 12219000
         L     @03,RPLVPTR                                         2737 12220000
         LA    @15,BASEBUF1                                        2737 12221000
         ST    @15,RPLVBUF(,@03)                                   2737 12222000
*   RPLVBLN=LENGTH(BASEBUF1);       /* BVR BUF LENGTH        @Y30LB25*/ 12223000
         MVC   RPLVBLN(4,@03),@CF01103                             2738 12224000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 12225000
         MVI   RPLVTYP(@03),X'00'                                  2739 12226000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 12227000
         OI    RPLVDIR(@03),B'01000000'                            2740 12228000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 12229000
         OI    RPLVUPD(@03),B'00000010'                            2741 12230000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 12231000
         NI    RPLVLOC(@03),B'01111111'                            2742 12232000
*   RESPECIFY                       /*                       @Y30LB25*/ 12233000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 12234000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 12235000
         LR    RG1,@03                                             2744 12236000
*   CALL ICBVIO00;                  /* READ BVR              @Y30LB25*/ 12237000
         L     @15,@CV00762                                        2745 12238000
         BALR  @14,@15                                             2745 12239000
*   RESPECIFY                       /*                       @Y30LB25*/ 12240000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 12241000
*   RETURN;                         /*                       @Y30LB25*/ 12242000
@EL00064 DS    0H                                                  2747 12243000
@EF00064 DS    0H                                                  2747 12244000
@ER00064 L     @14,@SA00064                                        2747 12245000
         BR    @14                                                 2747 12246000
*   END READUPD1;                   /*                       @Y30LB25*/ 12247000
*                                                                  2749 12248000
*   /*****************************************************************/ 12249000
*   /*                                                               */ 12250000
*   /* PROCEDURE NAME - WRITRECD                             @Y30LB25*/ 12251000
*   /*                                                       @Y30LB25*/ 12252000
*   /* FUNCTION - WRITE AN MSVC RECORD.                      @Y30LB25*/ 12253000
*   /*                                                       @Y30LB25*/ 12254000
*   /* INPUT -                                               @Y30LB25*/ 12255000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12256000
*   /* MSVC RECORD                                           @Y30LB25*/ 12257000
*   /*                                                       @Y30LB25*/ 12258000
*   /* OUTPUT -                                              @Y30LB25*/ 12259000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12260000
*   /* AN ERROR                                              @Y30LB25*/ 12261000
*   /*                                                               */ 12262000
*   /*****************************************************************/ 12263000
*                                                                  2749 12264000
*WRITRECD:                          /*                       @Y30LB25*/ 12265000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12266000
WRITRECD ST    @14,@SA00065                                        2749 12267000
*   RPLVTYP=RPLVPUT;                /* WRITE                 @Y30LB25*/ 12268000
         L     @03,RPLVPTR                                         2750 12269000
         MVI   RPLVTYP(@03),X'01'                                  2750 12270000
*   RPLVLOC=OFF;                    /* NO LOC                @Y30LB25*/ 12271000
         NI    RPLVLOC(@03),B'01111111'                            2751 12272000
*   RESPECIFY                       /*                       @Y30LB25*/ 12273000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 12274000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 12275000
         LR    RG1,@03                                             2753 12276000
*   CALL ICBVIO00;                  /* WRITE BVR             @Y30LB25*/ 12277000
         L     @15,@CV00762                                        2754 12278000
         BALR  @14,@15                                             2754 12279000
*   RESPECIFY                       /*                       @Y30LB25*/ 12280000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 12281000
*   RETURN;                         /*                       @Y30LB25*/ 12282000
@EL00065 DS    0H                                                  2756 12283000
@EF00065 DS    0H                                                  2756 12284000
@ER00065 L     @14,@SA00065                                        2756 12285000
         BR    @14                                                 2756 12286000
*   END WRITRECD;                   /*                       @Y30LB25*/ 12287000
*                                                                  2758 12288000
*   /*****************************************************************/ 12289000
*   /*                                                               */ 12290000
*   /* PROCEDURE NAME - CHAININ                              @Y30LB25*/ 12291000
*   /*                                                       @Y30LB25*/ 12292000
*   /* FUNCTION - CHAIN A BVR INTO TNE CHAIN OF BVRS OFF     @Y30LB25*/ 12293000
*   /* OF EITHER THE GROUP VOLUME RECORD (GVR) OR NON-GROUP  @Y30LB25*/ 12294000
*   /* VOLUME RECORD (NGVR).                                 @Y30LB25*/ 12295000
*   /*                                                       @Y30LB25*/ 12296000
*   /* INPUT -                                               @Y30LB25*/ 12297000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12298000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12299000
*   /*                                                       @Y30LB25*/ 12300000
*   /* OUTPUT -                                              @Y30LB25*/ 12301000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12302000
*   /* AN ERROR                                              @Y30LB25*/ 12303000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12304000
*   /*                                                               */ 12305000
*   /*****************************************************************/ 12306000
*                                                                  2758 12307000
*CHAININ:                           /*                       @Y30LB25*/ 12308000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12309000
CHAININ  ST    @14,@SA00066                                        2758 12310000
*   BVOLKY=BASNEXTV;                /* SET KEY FOR           @Y30LB25   12311000
*                                      NEXT READ             @Y30LB25*/ 12312000
         L     @15,BASEVPTR                                        2759 12313000
         MVC   BVOLKY(6),BASNEXTV(@15)                             2759 12314000
*   BASNEXTV=SAVSERNO;              /* PT TO NEW BVR         @Y30LB25*/ 12315000
         MVC   BASNEXTV(6,@15),SAVSERNO                            2760 12316000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 12317000
         BAL   @14,WRITRECD                                        2761 12318000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 12319000
*     THEN                          /* YES?                  @Y30LB25*/ 12320000
         L     @15,RPLVPTR                                         2762 12321000
         LH    @14,RPLVRETC(,@15)                                  2762 12322000
         N     @14,@CF01129                                        2762 12323000
         LTR   @14,@14                                             2762 12324000
         BNZ   @RT02762                                            2762 12325000
*     RETURN;                       /*                       @Y30LB25*/ 12326000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 12327000
         LA    @14,BKEY                                            2764 12328000
         ST    @14,RPLVKEY(,@15)                                   2764 12329000
*   CALL READUPD1;                  /* READ NEXT BVR IN      @Y30LB25   12330000
*                                      CHAIN                 @Y30LB25*/ 12331000
         BAL   @14,READUPD1                                        2765 12332000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 12333000
*     THEN                          /* YES?                  @Y30LB25*/ 12334000
         L     @01,RPLVPTR                                         2766 12335000
         LH    @15,RPLVRETC(,@01)                                  2766 12336000
         N     @15,@CF01129                                        2766 12337000
         LTR   @15,@15                                             2766 12338000
         BNZ   @RT02766                                            2766 12339000
*     RETURN;                       /*                       @Y30LB25*/ 12340000
*   BASPREV=SAVSERNO;               /* PT BACK TO NEW BVR    @Y30LB25*/ 12341000
         L     @01,BASEVPTR                                        2768 12342000
         MVC   BASPREV(6,@01),SAVSERNO                             2768 12343000
*   CALL WRITRECD;                  /* WTITE BVR             @Y30LB25*/ 12344000
         BAL   @14,WRITRECD                                        2769 12345000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 12346000
*     THEN                          /* YES?                  @Y30LB25*/ 12347000
         L     @01,RPLVPTR                                         2770 12348000
         LH    @15,RPLVRETC(,@01)                                  2770 12349000
         N     @15,@CF01129                                        2770 12350000
         LTR   @15,@15                                             2770 12351000
         BNZ   @RT02770                                            2770 12352000
*     RETURN;                       /*                       @Y30LB25*/ 12353000
*   BASEVPTR=SAVBASPT;              /* PT TO NEW BVR         @Y30LB25*/ 12354000
*                                                                  2772 12355000
         ST    SAVBASPT,BASEVPTR                                   2772 12356000
*   /*****************************************************************/ 12357000
*   /*                                                               */ 12358000
*   /* CHAIN IN NEW BVR                                      @Y30LB25*/ 12359000
*   /*                                                               */ 12360000
*   /*****************************************************************/ 12361000
*                                                                  2773 12362000
*   BASFIRST=OFF;                   /* NOT 1ST IN CHAIN      @Y30LB25*/ 12363000
*   BASLAST=OFF;                    /* NOT LAST IN CHAIN     @Y30LB25*/ 12364000
         L     @06,BASEVPTR                                        2774 12365000
         NI    BASFIRST(@06),B'11100111'                           2774 12366000
*   BASPREV=SAVSERN1;               /* CHAIN BACK            @Y30LB25*/ 12367000
         MVC   BASPREV(6,@06),SAVSERN1                             2775 12368000
*   BASNEXTV=BVOLKY;                /* CHAIN AHEAD           @Y30LB25*/ 12369000
         MVC   BASNEXTV(6,@06),BVOLKY                              2776 12370000
*   RETURN;                         /*                       @Y30LB25*/ 12371000
@EL00066 DS    0H                                                  2777 12372000
@EF00066 DS    0H                                                  2777 12373000
@ER00066 L     @14,@SA00066                                        2777 12374000
         BR    @14                                                 2777 12375000
*   END CHAININ;                    /*                       @Y30LB25*/ 12376000
         B     @EL00066                                            2778 12377000
*                                                                  2779 12378000
*   /*****************************************************************/ 12379000
*   /*                                                               */ 12380000
*   /* ENTRY NAME - ICBVUCHO                                 @Y30LB25*/ 12381000
*   /*                                                       @Y30LB25*/ 12382000
*   /* FUNCTION - CHAIN A BVR OUT OF EITHER A GROUP VOLUME   @Y30LB25*/ 12383000
*   /* RECORD (GVR) OR A NON-GROUP VOLUME RECORD (NGVR).     @Y30LB25*/ 12384000
*   /* FOR A NGVR THIS ROUTINE WILL GET, UPDATE, AND WRITE   @Y30LB25*/ 12385000
*   /* IT. THE CALLER MUST WRITE THE BASE VOLUME RECORD      @Y30LB25*/ 12386000
*   /* (BVR) WHICH WAS CHAINED OUT OF EITHER THE GVR OR      @Y30LB25*/ 12387000
*   /* NGVR. ALSO, IF THE BVR IS CHAINED IN THE GVR,         @Y30LB25*/ 12388000
*   /* THEN THE CALLER MUST SUPPLY AND THEN WRITE THE        @Y30LB25*/ 12389000
*   /* GVR. FINALLY, THE CALLER MUST FIRST UPDATE THE        @Y30LB25*/ 12390000
*   /* NUMBER OF GENERAL-USE, RESTRICTED, OR INACTIVE        @Y30LB25*/ 12391000
*   /* VOLUMES IN THE GVR.                                   @Y30LB25*/ 12392000
*   /*                                                       @Y30LB25*/ 12393000
*   /* INPUT -                                               @Y30LB25*/ 12394000
*   /* MSVC REQUEST PARAMETER LIST PTR IN RPLVPTR            @Y30LB25*/ 12395000
*   /* GROUP VOLUME RECORD PTR IN GROUPPTR (OPTIONAL)        @Y30LB25*/ 12396000
*   /* BASE VOLUME RECORD PTR IN BASEVPTR                    @Y30LB25*/ 12397000
*   /* FLAG IN PASSBYTE                                      @Y30LB25*/ 12398000
*   /* INDICATES GROUPED OR NON-GROUPED                      @Y30LB25*/ 12399000
*   /*                                                       @Y30LB25*/ 12400000
*   /* OUTPUT -                                              @Y30LB25*/ 12401000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12402000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 12403000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12404000
*   /* AN ERROR                                              @Y30LB25*/ 12405000
*   /*                                                               */ 12406000
*   /*****************************************************************/ 12407000
*                                                                  2779 12408000
*ICBVUCHO:                          /*                       @Y30LB25*/ 12409000
*   ENTRY(PTRGROUP,PTRBASEV,PTRRPLV,BYTEPASS);/*             @Y30LB25*/ 12410000
*                                                                  2779 12411000
@EP02779 MVC   @PC00001(16),0(@01)                                 2779 12412000
*   /*****************************************************************/ 12413000
*   /*                                                               */ 12414000
*   /* DECLARES FOR PASSED PARAMETERS                        @Y30LB25*/ 12415000
*   /* PTRGROUP, PTRBASEV, PTRRPLV, BYTEPASS                 @Y30LB25*/ 12416000
*   /* ARE DECLARED IN ICBVUCHI.                             @Y30LB25*/ 12417000
*   /*                                                               */ 12418000
*   /*****************************************************************/ 12419000
*                                                                  2780 12420000
*   DCL                                                            2780 12421000
*     SAVPREV CHAR(6);              /* SAVE PREV SERNO       @Y30LB25*/ 12422000
*   DCL                                                            2781 12423000
*     SAVNEXT CHAR(6);              /* SAVE NEXT SERNO       @Y30LB25*/ 12424000
*   GROUPPTR=PTRGROUP;              /* SET GROUP PTR         @Y30LB25*/ 12425000
         L     @06,@PC00001                                        2782 12426000
         L     @06,PTRGROUP(,@06)                                  2782 12427000
         ST    @06,GROUPPTR                                        2782 12428000
*   BASEVPTR=PTRBASEV;              /* SET BASE PTR          @Y30LB25*/ 12429000
         L     @06,@PC00001+4                                      2783 12430000
         L     @06,PTRBASEV(,@06)                                  2783 12431000
         ST    @06,BASEVPTR                                        2783 12432000
*   RPLVPTR=PTRRPLV;                /* SET RPLV PTR          @Y30LB25*/ 12433000
         L     @06,@PC00001+8                                      2784 12434000
         L     @06,PTRRPLV(,@06)                                   2784 12435000
         ST    @06,RPLVPTR                                         2784 12436000
*   PASSBYTE=BYTEPASS;              /* GVR OR NGVR FLAG      @Y30LB25*/ 12437000
         L     @06,@PC00001+12                                     2785 12438000
         MVC   PASSBYTE(2),BYTEPASS(@06)                           2785 12439000
*   DIDKY=FIXONE;                   /* DVR ID OF 1           @Y30LB25*/ 12440000
         MVI   DIDKY,X'01'                                         2786 12441000
*   CIDKY=FIXONE;                   /* CVR ID OF 1           @Y30LB25*/ 12442000
         MVI   CIDKY,X'01'                                         2787 12443000
*   CALL VUCHO;                     /* CHAIN OUT BVR         @Y30LB25*/ 12444000
         BAL   @14,VUCHO                                           2788 12445000
*   RETURN;                         /*                       @Y30LB25*/ 12446000
         B     @EL00001                                            2789 12447000
*                                                                  2790 12448000
*   /*****************************************************************/ 12449000
*   /*                                                               */ 12450000
*   /* PROCEDURE VUCHO IS CODED SO THAT COMMON ENTRY         @Y30LB25*/ 12451000
*   /* CODE IN ICBVUCHO CAN BE USED BY THIS MODULE           @Y30LB25*/ 12452000
*   /* AND BY OTHER MODULES. OTHER MODULES CALL              @Y30LB25*/ 12453000
*   /* ENTRY ICBVUCHO. THIS MODULE CALLS PROCEDURE           @Y30LB25*/ 12454000
*   /* VUCHO.                                                @Y30LB25*/ 12455000
*   /*                                                               */ 12456000
*   /*****************************************************************/ 12457000
*                                                                  2790 12458000
*VUCHO:                             /*                       @Y30LB25*/ 12459000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12460000
VUCHO    ST    @14,@SA00067                                        2790 12461000
*   SAVBASPT=BASEVPTR;              /* SAVE BUF PTR          @Y30LB25*/ 12462000
         L     SAVBASPT,BASEVPTR                                   2791 12463000
*   NGVRPTR=ADDR(NGVRBUF);          /* MAP NGVR BUF          @ZDR2054*/ 12464000
         LA    NGVRPTR,NGVRBUF                                     2792 12465000
*   IF GRPFLG=ON                    /* GVR?                  @Y30LB25*/ 12466000
*     THEN                          /* YES                   @Y30LB25*/ 12467000
         TM    GRPFLG,B'00010000'                                  2793 12468000
         BNO   @RF02793                                            2793 12469000
*     DO;                           /*                       @Y30LB25*/ 12470000
*       CALL PROCGVRO;              /* PROCESS GVR           @Y30LB25*/ 12471000
         BAL   @14,PROCGVRO                                        2795 12472000
*       BASEVPTR=SAVBASPT;          /* RESTORE BVR PTR       @Y30LB25*/ 12473000
         ST    SAVBASPT,BASEVPTR                                   2796 12474000
*       RETURN;                     /*                       @Y30LB25*/ 12475000
@EL00067 DS    0H                                                  2797 12476000
@EF00067 DS    0H                                                  2797 12477000
@ER00067 L     @14,@SA00067                                        2797 12478000
         BR    @14                                                 2797 12479000
*     END;                          /*                       @Y30LB25*/ 12480000
*                                                                  2798 12481000
*   /*****************************************************************/ 12482000
*   /*                                                               */ 12483000
*   /* READ FOR NON-GROUP VOLUME RECORD                      @Y30LB25*/ 12484000
*   /*                                                               */ 12485000
*   /*****************************************************************/ 12486000
*                                                                  2799 12487000
*   RPLVKEY=ADDR(NGKEY);            /* SET NGVR KEY          @Y30LB25*/ 12488000
@RF02793 LA    @03,NGKEY                                           2799 12489000
         L     @01,RPLVPTR                                         2799 12490000
         ST    @03,RPLVKEY(,@01)                                   2799 12491000
*   CALL READUPD1;                  /* READ NGVR             @Y30LB25*/ 12492000
         BAL   @14,READUPD1                                        2800 12493000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 12494000
*     THEN                          /* YES                   @Y30LB25*/ 12495000
         L     @03,RPLVPTR                                         2801 12496000
         LH    @15,RPLVRETC(,@03)                                  2801 12497000
         N     @15,@CF01129                                        2801 12498000
         LTR   @15,@15                                             2801 12499000
         BNZ   @RT02801                                            2801 12500000
*     RETURN;                       /*                       @Y30LB25*/ 12501000
*   RPLVBUF=ADDR(NGVRBUF);          /* BUF ADDR              @Y30LB25*/ 12502000
         LA    @15,NGVRBUF                                         2803 12503000
         ST    @15,RPLVBUF(,@03)                                   2803 12504000
*   NGVRBUF=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 12505000
*                                                                  2804 12506000
         MVC   NGVRBUF(224),BASEBUF1                               2804 12507000
*   /*****************************************************************/ 12508000
*   /*                                                               */ 12509000
*   /* BVR FIRST IN THE CHAIN                                @Y30LB25*/ 12510000
*   /*                                                               */ 12511000
*   /*****************************************************************/ 12512000
*                                                                  2805 12513000
*   IF BASSERNO=NGVFVOL             /* FIRST IN CHAIN?       @Y30LB25*/ 12514000
*     THEN                          /* YES                   @Y30LB25*/ 12515000
         L     @03,BASEVPTR                                        2805 12516000
         CLC   BASSERNO(6,@03),NGVFVOL(NGVRPTR)                    2805 12517000
         BNE   @RF02805                                            2805 12518000
*     DO;                           /*                       @Y30LB25*/ 12519000
*       NGVFVOL=BASNEXTV;           /* PT TO NEW 1ST BVR     @Y30LB25*/ 12520000
         MVC   NGVFVOL(6,NGVRPTR),BASNEXTV(@03)                    2807 12521000
*       NGVNOVOL=NGVNOVOL-FIXONE;   /* DECREM # VOLS         @Y30LB25*/ 12522000
*                                                                  2808 12523000
         LH    @03,NGVNOVOL(,NGVRPTR)                              2808 12524000
         BCTR  @03,0                                               2808 12525000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2808 12526000
*       /*************************************************************/ 12527000
*       /*                                                           */ 12528000
*       /* CHECK IF BVRS ARE IN THE CHAIN.                   @Y30LB25*/ 12529000
*       /*                                                           */ 12530000
*       /*************************************************************/ 12531000
*                                                                  2809 12532000
*       IF NGVNOVOL=FIXZERO         /* NONE IN CHAIN?        @Y30LB25*/ 12533000
*         THEN                      /* NO BVRS IN CHAIN      @Y30LB25*/ 12534000
         LTR   @03,@03                                             2809 12535000
         BNZ   @RF02809                                            2809 12536000
*         DO;                       /*                       @Y30LB25*/ 12537000
*           NGVLVOL=BLANK6;         /* NO LAST VOL           @Y30LB25*/ 12538000
         MVI   NGVLVOL+1(NGVRPTR),C' '                             2811 12539000
         MVC   NGVLVOL+2(4,NGVRPTR),NGVLVOL+1(NGVRPTR)             2811 12540000
         MVI   NGVLVOL(NGVRPTR),C' '                               2811 12541000
*           CALL WRITRECD;          /* WRITE NGVR            @Y30LB25*/ 12542000
         BAL   @14,WRITRECD                                        2812 12543000
*           RETURN;                 /*                       @Y30LB25*/ 12544000
         B     @EL00067                                            2813 12545000
*         END;                      /*                       @Y30LB25*/ 12546000
*                                                                  2814 12547000
*       /*************************************************************/ 12548000
*       /*                                                           */ 12549000
*       /* STILL BVRS LEFT IN THE CHAIN.                     @Y30LB25*/ 12550000
*       /*                                                           */ 12551000
*       /*************************************************************/ 12552000
*                                                                  2815 12553000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 12554000
@RF02809 BAL   @14,WRITRECD                                        2815 12555000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 12556000
*         THEN                      /* YES                   @Y30LB25*/ 12557000
         L     @15,RPLVPTR                                         2816 12558000
         LH    @14,RPLVRETC(,@15)                                  2816 12559000
         N     @14,@CF01129                                        2816 12560000
         LTR   @14,@14                                             2816 12561000
         BNZ   @RT02816                                            2816 12562000
*         RETURN;                   /*                       @Y30LB25*/ 12563000
*       BVOLKY=BASNEXTV;            /* KEY - NEW 1ST BVR     @Y30LB25*/ 12564000
         L     @01,BASEVPTR                                        2818 12565000
         MVC   BVOLKY(6),BASNEXTV(@01)                             2818 12566000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 12567000
         LA    @14,BKEY                                            2819 12568000
         ST    @14,RPLVKEY(,@15)                                   2819 12569000
*       CALL READUPD1;              /* GET NEW 1ST BVR       @Y30LB25*/ 12570000
         BAL   @14,READUPD1                                        2820 12571000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 12572000
*         THEN                      /* YES                   @Y30LB25*/ 12573000
         L     @01,RPLVPTR                                         2821 12574000
         LH    @15,RPLVRETC(,@01)                                  2821 12575000
         N     @15,@CF01129                                        2821 12576000
         LTR   @15,@15                                             2821 12577000
         BNZ   @RT02821                                            2821 12578000
*         RETURN;                   /*                       @Y30LB25*/ 12579000
*       BASEVPTR=ADDR(BASEBUF1);    /* NEW 1ST BVR BUF       @Y30LB25*/ 12580000
         LA    @15,BASEBUF1                                        2823 12581000
         ST    @15,BASEVPTR                                        2823 12582000
*       BASFIRST=ON;                /* 1ST IN CHAIN ON       @Y30LB25*/ 12583000
         OI    BASFIRST(@15),B'00010000'                           2824 12584000
*       BASPREV=BLANK6;             /* NULL PT BACK          @Y30LB25*/ 12585000
         MVI   BASPREV+1(@15),C' '                                 2825 12586000
         MVC   BASPREV+2(4,@15),BASPREV+1(@15)                     2825 12587000
         MVI   BASPREV(@15),C' '                                   2825 12588000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 12589000
         ST    SAVBASPT,BASEVPTR                                   2826 12590000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 12591000
         BAL   @14,WRITRECD                                        2827 12592000
*       RETURN;                     /*                       @Y30LB25*/ 12593000
         B     @EL00067                                            2828 12594000
*     END;                          /*                       @Y30LB25*/ 12595000
*                                                                  2829 12596000
*   /*****************************************************************/ 12597000
*   /*                                                               */ 12598000
*   /* BVR LAST IN THE CHAIN                                 @Y30LB25*/ 12599000
*   /*                                                               */ 12600000
*   /*****************************************************************/ 12601000
*                                                                  2830 12602000
*   IF BASSERNO=NGVLVOL             /* LAST IN CHAIN?        @Y30LB25*/ 12603000
*     THEN                          /* YES                   @Y30LB25*/ 12604000
@RF02805 L     @03,BASEVPTR                                        2830 12605000
         CLC   BASSERNO(6,@03),NGVLVOL(NGVRPTR)                    2830 12606000
         BNE   @RF02830                                            2830 12607000
*     DO;                           /*                       @Y30LB25*/ 12608000
*       NGVLVOL=BASPREV;            /* PT TO NEW LAST        @Y30LB25   12609000
*                                      IN CHAIN              @Y30LB25*/ 12610000
         MVC   NGVLVOL(6,NGVRPTR),BASPREV(@03)                     2832 12611000
*       NGVNOVOL=NGVNOVOL-FIXONE;   /* DECREM # VOLS         @Y30LB25*/ 12612000
*                                                                  2833 12613000
         LH    @03,NGVNOVOL(,NGVRPTR)                              2833 12614000
         BCTR  @03,0                                               2833 12615000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2833 12616000
*       /*************************************************************/ 12617000
*       /*                                                           */ 12618000
*       /* CHECK IF BVRS ARE IN THE CHAIN.                   @Y30LB25*/ 12619000
*       /*                                                           */ 12620000
*       /*************************************************************/ 12621000
*                                                                  2834 12622000
*       IF NGVNOVOL=FIXZERO         /* NONE IN CHAIN?        @Y30LB25*/ 12623000
*         THEN                      /* NO BVRS IN CHAIN      @Y30LB25*/ 12624000
         LTR   @03,@03                                             2834 12625000
         BNZ   @RF02834                                            2834 12626000
*         DO;                       /*                       @Y30LB25*/ 12627000
*           NGVFVOL=BLANK6;         /* NO FIRST VOL          @Y30LB25*/ 12628000
         MVI   NGVFVOL+1(NGVRPTR),C' '                             2836 12629000
         MVC   NGVFVOL+2(4,NGVRPTR),NGVFVOL+1(NGVRPTR)             2836 12630000
         MVI   NGVFVOL(NGVRPTR),C' '                               2836 12631000
*           CALL WRITRECD;          /* WRITE NGVR            @Y30LB25*/ 12632000
         BAL   @14,WRITRECD                                        2837 12633000
*           RETURN;                 /*                       @Y30LB25*/ 12634000
         B     @EL00067                                            2838 12635000
*         END;                      /*                       @Y30LB25*/ 12636000
*                                                                  2839 12637000
*       /*************************************************************/ 12638000
*       /*                                                           */ 12639000
*       /* STILL BVRS LEFT IN THE CHAIN.                     @Y30LB25*/ 12640000
*       /*                                                           */ 12641000
*       /*************************************************************/ 12642000
*                                                                  2840 12643000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 12644000
@RF02834 BAL   @14,WRITRECD                                        2840 12645000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 12646000
*         THEN                      /* YES                   @Y30LB25*/ 12647000
         L     @15,RPLVPTR                                         2841 12648000
         LH    @14,RPLVRETC(,@15)                                  2841 12649000
         N     @14,@CF01129                                        2841 12650000
         LTR   @14,@14                                             2841 12651000
         BNZ   @RT02841                                            2841 12652000
*         RETURN;                   /*                       @Y30LB25*/ 12653000
*       BVOLKY=BASPREV;             /* GET NEW LAST BVR      @Y30LB25*/ 12654000
         L     @01,BASEVPTR                                        2843 12655000
         MVC   BVOLKY(6),BASPREV(@01)                              2843 12656000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 12657000
         LA    @14,BKEY                                            2844 12658000
         ST    @14,RPLVKEY(,@15)                                   2844 12659000
*       CALL READUPD1;              /* READ NEW LAST BVR     @Y30LB25*/ 12660000
         BAL   @14,READUPD1                                        2845 12661000
*       IF RPLVRETC¬=FIXZERO        /* ERROR?                @Y30LB25*/ 12662000
*         THEN                      /* YES                   @Y30LB25*/ 12663000
         L     @01,RPLVPTR                                         2846 12664000
         LH    @15,RPLVRETC(,@01)                                  2846 12665000
         N     @15,@CF01129                                        2846 12666000
         LTR   @15,@15                                             2846 12667000
         BNZ   @RT02846                                            2846 12668000
*         RETURN;                   /*                       @Y30LB25*/ 12669000
*       BASEVPTR=ADDR(BASEBUF1);    /* NEW 1ST BVR BUF       @Y30LB25*/ 12670000
         LA    @15,BASEBUF1                                        2848 12671000
         ST    @15,BASEVPTR                                        2848 12672000
*       BASLAST=ON;                 /* LAST IN CHAIN ON      @Y30LB25*/ 12673000
         OI    BASLAST(@15),B'00001000'                            2849 12674000
*       BASNEXTV=BLANK6;            /* NULL PT AHEAD         @Y30LB25*/ 12675000
         MVI   BASNEXTV+1(@15),C' '                                2850 12676000
         MVC   BASNEXTV+2(4,@15),BASNEXTV+1(@15)                   2850 12677000
         MVI   BASNEXTV(@15),C' '                                  2850 12678000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 12679000
         ST    SAVBASPT,BASEVPTR                                   2851 12680000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 12681000
         BAL   @14,WRITRECD                                        2852 12682000
*       RETURN;                     /*                       @Y30LB25*/ 12683000
         B     @EL00067                                            2853 12684000
*     END;                          /*                       @Y30LB25*/ 12685000
*                                                                  2854 12686000
*   /*****************************************************************/ 12687000
*   /*                                                               */ 12688000
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/ 12689000
*   /*                                                               */ 12690000
*   /*****************************************************************/ 12691000
*                                                                  2855 12692000
*   NGVNOVOL=NGVNOVOL-FIXONE;       /* DECR # CHAIN VOLS     @Y30LB25*/ 12693000
@RF02830 LH    @03,NGVNOVOL(,NGVRPTR)                              2855 12694000
         BCTR  @03,0                                               2855 12695000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2855 12696000
*   CALL WRITRECD;                  /* WRITE NGVR            @Y30LB25*/ 12697000
         BAL   @14,WRITRECD                                        2856 12698000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 12699000
*     THEN                          /* YES                   @Y30LB25*/ 12700000
         L     @01,RPLVPTR                                         2857 12701000
         LH    @15,RPLVRETC(,@01)                                  2857 12702000
         N     @15,@CF01129                                        2857 12703000
         LTR   @15,@15                                             2857 12704000
         BNZ   @RT02857                                            2857 12705000
*     RETURN;                       /*                       @Y30LB25*/ 12706000
*   CALL PROCBVRO;                  /* CHAIN OUT OF CHAIN    @Y30LB25*/ 12707000
         BAL   @14,PROCBVRO                                        2859 12708000
*   BASEVPTR=SAVBASPT;              /* RESTORE BVR PTR       @Y30LB25*/ 12709000
         ST    SAVBASPT,BASEVPTR                                   2860 12710000
*   RETURN;                         /*                       @Y30LB25*/ 12711000
         B     @EL00067                                            2861 12712000
*   END VUCHO;                      /*                       @Y30LB25*/ 12713000
         B     @EL00067                                            2862 12714000
*                                                                  2863 12715000
*   /*****************************************************************/ 12716000
*   /*                                                               */ 12717000
*   /* PROCEDURE NAME - PROCGVRO                             @Y30LB25*/ 12718000
*   /*                                                       @Y30LB25*/ 12719000
*   /* FUNCTION - CHAIN A BVR OUT OF A GROUP VOLUME          @Y30LB25*/ 12720000
*   /* RECORD (GVR).                                         @Y30LB25*/ 12721000
*   /*                                                       @Y30LB25*/ 12722000
*   /* INPUT -                                               @Y30LB25*/ 12723000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12724000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 12725000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12726000
*   /*                                                       @Y30LB25*/ 12727000
*   /* OUTPUT -                                              @Y30LB25*/ 12728000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12729000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12730000
*   /* AN ERROR                                              @Y30LB25*/ 12731000
*   /*                                                               */ 12732000
*   /*****************************************************************/ 12733000
*                                                                  2863 12734000
*PROCGVRO:                          /*                       @Y30LB25*/ 12735000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12736000
*                                                                  2863 12737000
PROCGVRO ST    @14,@SA00068                                        2863 12738000
*   /*****************************************************************/ 12739000
*   /*                                                               */ 12740000
*   /* BVR FIRST IN THE CHAIN                                @Y30LB25*/ 12741000
*   /*                                                               */ 12742000
*   /*****************************************************************/ 12743000
*                                                                  2864 12744000
*   IF BASSERNO=GROFSN              /* 1ST IN CHAIN?         @Y30LB25*/ 12745000
*     THEN                          /* YES                   @Y30LB25*/ 12746000
*                                                                  2864 12747000
         L     @15,BASEVPTR                                        2864 12748000
         L     @14,GROUPPTR                                        2864 12749000
         CLC   BASSERNO(6,@15),GROFSN(@14)                         2864 12750000
         BNE   @RF02864                                            2864 12751000
*     /***************************************************************/ 12752000
*     /*                                                             */ 12753000
*     /* CHECK FOR NO BVRS IN THE CHAIN.                     @Y30LB25*/ 12754000
*     /*                                                             */ 12755000
*     /***************************************************************/ 12756000
*                                                                  2865 12757000
*     IF GRONGEN+GRONRSTD+GRONINAC>FIXZERO/* SET BY CALLER   @Y30LB25*/ 12758000
*       THEN                        /* BVR STILL IN CHAIN    @Y30LB25*/ 12759000
         LH    @03,GRONGEN(,@14)                                   2865 12760000
         AH    @03,GRONRSTD(,@14)                                  2865 12761000
         AH    @03,GRONINAC(,@14)                                  2865 12762000
         LTR   @03,@03                                             2865 12763000
         BNP   @RF02865                                            2865 12764000
*       DO;                         /*                       @Y30LB25*/ 12765000
*         GROFSN=BASNEXTV;          /* PT TO NEW 1ST BVR     @Y30LB25*/ 12766000
         MVC   GROFSN(6,@14),BASNEXTV(@15)                         2867 12767000
*         BVOLKY=BASNEXTV;          /* KEY OF NEW 1ST BVR    @Y30LB25*/ 12768000
         MVC   BVOLKY(6),BASNEXTV(@15)                             2868 12769000
*         RPLVKEY=ADDR(BKEY);       /* SET KEY ADDR          @Y30LB25*/ 12770000
         LA    @15,BKEY                                            2869 12771000
         L     @14,RPLVPTR                                         2869 12772000
         ST    @15,RPLVKEY(,@14)                                   2869 12773000
*         CALL READUPD1;            /* GET NEW 1ST BVR       @Y30LB25*/ 12774000
         BAL   @14,READUPD1                                        2870 12775000
*         IF RPLVRETC¬=FIXZERO      /* ERROR?                @Y30LB25*/ 12776000
*           THEN                    /* YES                   @Y30LB25*/ 12777000
         L     @01,RPLVPTR                                         2871 12778000
         LH    @15,RPLVRETC(,@01)                                  2871 12779000
         N     @15,@CF01129                                        2871 12780000
         LTR   @15,@15                                             2871 12781000
         BNZ   @RT02871                                            2871 12782000
*           RETURN;                 /*                       @Y30LB25*/ 12783000
*         BASEVPTR=ADDR(BASEBUF1);  /* NEW 1ST BVR BUF       @Y30LB25*/ 12784000
         LA    @15,BASEBUF1                                        2873 12785000
         ST    @15,BASEVPTR                                        2873 12786000
*         BASFIRST=ON;              /* 1ST FLAG ON           @Y30LB25*/ 12787000
         OI    BASFIRST(@15),B'00010000'                           2874 12788000
*         BASPREV=BLANK6;           /* NULL PREV PTR         @Y30LB25*/ 12789000
         MVI   BASPREV+1(@15),C' '                                 2875 12790000
         MVC   BASPREV+2(4,@15),BASPREV+1(@15)                     2875 12791000
         MVI   BASPREV(@15),C' '                                   2875 12792000
*         CALL WRITRECD;            /* WRITE BVR             @Y30LB25*/ 12793000
         BAL   @14,WRITRECD                                        2876 12794000
*         RETURN;                   /*                       @Y30LB25*/ 12795000
@EL00068 DS    0H                                                  2877 12796000
@EF00068 DS    0H                                                  2877 12797000
@ER00068 L     @14,@SA00068                                        2877 12798000
         BR    @14                                                 2877 12799000
*       END;                        /*                       @Y30LB25*/ 12800000
*     ELSE                          /* NO BVRS IN CHAIN      @Y30LB25*/ 12801000
*       DO;                         /*                       @Y30LB25*/ 12802000
@RF02865 DS    0H                                                  2880 12803000
*         GROFSN=BLANK6;            /* NO FIRST VOL          @Y30LB25*/ 12804000
         L     @15,GROUPPTR                                        2880 12805000
         MVI   GROFSN+1(@15),C' '                                  2880 12806000
         MVC   GROFSN+2(4,@15),GROFSN+1(@15)                       2880 12807000
         MVI   GROFSN(@15),C' '                                    2880 12808000
*         GROLSN=BLANK6;            /* NO LAST VOL           @Y30LB25*/ 12809000
         MVI   GROLSN+1(@15),C' '                                  2881 12810000
         MVC   GROLSN+2(4,@15),GROLSN+1(@15)                       2881 12811000
         MVI   GROLSN(@15),C' '                                    2881 12812000
*         RETURN;                   /*                       @Y30LB25*/ 12813000
         B     @EL00068                                            2882 12814000
*       END;                        /*                       @Y30LB25*/ 12815000
*                                                                  2883 12816000
*   /*****************************************************************/ 12817000
*   /*                                                               */ 12818000
*   /* BVR LAST IN THE CHAIN                                 @Y30LB25*/ 12819000
*   /*                                                               */ 12820000
*   /*****************************************************************/ 12821000
*                                                                  2884 12822000
*   IF BASSERNO=GROLSN              /* LAST IN CHAIN?        @Y30LB25*/ 12823000
*     THEN                          /* YES                   @Y30LB25*/ 12824000
@RF02864 L     @15,BASEVPTR                                        2884 12825000
         L     @14,GROUPPTR                                        2884 12826000
         CLC   BASSERNO(6,@15),GROLSN(@14)                         2884 12827000
         BNE   @RF02884                                            2884 12828000
*     IF GRONGEN+GRONRSTD+GRONINAC>FIXZERO/* SET BY CALLER   @Y30LB25*/ 12829000
*       THEN                        /* BVR STILL IN CHAIN    @Y30LB25*/ 12830000
         LH    @03,GRONGEN(,@14)                                   2885 12831000
         AH    @03,GRONRSTD(,@14)                                  2885 12832000
         AH    @03,GRONINAC(,@14)                                  2885 12833000
         LTR   @03,@03                                             2885 12834000
         BNP   @RF02885                                            2885 12835000
*       DO;                         /*                       @Y30LB25*/ 12836000
*         GROLSN=BASPREV;           /* PT TO NEW LAST        @Y30LB25   12837000
*                                      IN CHAIN              @Y30LB25*/ 12838000
         MVC   GROLSN(6,@14),BASPREV(@15)                          2887 12839000
*         BVOLKY=BASPREV;           /* NEW LAST BVR          @Y30LB25*/ 12840000
         MVC   BVOLKY(6),BASPREV(@15)                              2888 12841000
*         RPLVKEY=ADDR(BKEY);       /* SET KEY ADDR          @Y30LB25*/ 12842000
         LA    @15,BKEY                                            2889 12843000
         L     @14,RPLVPTR                                         2889 12844000
         ST    @15,RPLVKEY(,@14)                                   2889 12845000
*         CALL READUPD1;            /* GET NEW LAST BVR      @Y30LB25*/ 12846000
         BAL   @14,READUPD1                                        2890 12847000
*         IF RPLVRETC¬=FIXZERO      /* ERROR?                @Y30LB25*/ 12848000
*           THEN                    /* YES                   @Y30LB25*/ 12849000
         L     @01,RPLVPTR                                         2891 12850000
         LH    @15,RPLVRETC(,@01)                                  2891 12851000
         N     @15,@CF01129                                        2891 12852000
         LTR   @15,@15                                             2891 12853000
         BNZ   @RT02891                                            2891 12854000
*           RETURN;                 /*                       @Y30LB25*/ 12855000
*         BASEVPTR=ADDR(BASEBUF1);  /* NEW LAST BVR BUF      @Y30LB25*/ 12856000
         LA    @15,BASEBUF1                                        2893 12857000
         ST    @15,BASEVPTR                                        2893 12858000
*         BASLAST=ON;               /* LAST FLAG ON          @Y30LB25*/ 12859000
         OI    BASLAST(@15),B'00001000'                            2894 12860000
*         BASNEXTV=BLANK6;          /* NULL NEXT PTR         @Y30LB25*/ 12861000
         MVI   BASNEXTV+1(@15),C' '                                2895 12862000
         MVC   BASNEXTV+2(4,@15),BASNEXTV+1(@15)                   2895 12863000
         MVI   BASNEXTV(@15),C' '                                  2895 12864000
*         CALL WRITRECD;            /* WRITE BVR             @Y30LB25*/ 12865000
         BAL   @14,WRITRECD                                        2896 12866000
*         RETURN;                   /*                       @Y30LB25*/ 12867000
         B     @EL00068                                            2897 12868000
*       END;                        /*                       @Y30LB25*/ 12869000
*     ELSE                          /* NO BVRS IN CHAIN      @Y30LB25*/ 12870000
*       DO;                         /*                       @Y30LB25*/ 12871000
@RF02885 DS    0H                                                  2900 12872000
*         GROFSN=BLANK6;            /* NO FIRST VOL          @Y30LB25*/ 12873000
         L     @15,GROUPPTR                                        2900 12874000
         MVI   GROFSN+1(@15),C' '                                  2900 12875000
         MVC   GROFSN+2(4,@15),GROFSN+1(@15)                       2900 12876000
         MVI   GROFSN(@15),C' '                                    2900 12877000
*         GROLSN=BLANK6;            /* NO LAST VOL           @Y30LB25*/ 12878000
         MVI   GROLSN+1(@15),C' '                                  2901 12879000
         MVC   GROLSN+2(4,@15),GROLSN+1(@15)                       2901 12880000
         MVI   GROLSN(@15),C' '                                    2901 12881000
*         RETURN;                   /*                       @Y30LB25*/ 12882000
         B     @EL00068                                            2902 12883000
*       END;                        /*                       @Y30LB25*/ 12884000
*                                                                  2903 12885000
*   /*****************************************************************/ 12886000
*   /*                                                               */ 12887000
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/ 12888000
*   /*                                                               */ 12889000
*   /*****************************************************************/ 12890000
*                                                                  2904 12891000
*   CALL PROCBVRO;                  /* CHAIN OUT OF CHAIN    @Y30LB25*/ 12892000
@RF02884 BAL   @14,PROCBVRO                                        2904 12893000
*   RETURN;                         /*                       @Y30LB25*/ 12894000
         B     @EL00068                                            2905 12895000
*   END PROCGVRO;                   /*                       @Y30LB25*/ 12896000
         B     @EL00068                                            2906 12897000
*                                                                  2907 12898000
*   /*****************************************************************/ 12899000
*   /*                                                               */ 12900000
*   /* PROCEDURE NAME - PROCBVRO                             @Y30LB25*/ 12901000
*   /*                                                       @Y30LB25*/ 12902000
*   /* FUNCTION - CHAIN A BVR OUT OF A GROUP VOLUME          @Y30LB25*/ 12903000
*   /* RECORD (GVR) OR NON-GROUP VOLUME RECORD (NGVR).       @Y30LB25*/ 12904000
*   /*                                                       @Y30LB25*/ 12905000
*   /* INPUT -                                               @Y30LB25*/ 12906000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12907000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 12908000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 12909000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12910000
*   /*                                                       @Y30LB25*/ 12911000
*   /* OUTPUT -                                              @Y30LB25*/ 12912000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12913000
*   /* AN ERROR                                              @Y30LB25*/ 12914000
*   /*                                                               */ 12915000
*   /*****************************************************************/ 12916000
*                                                                  2907 12917000
*PROCBVRO:                          /*                       @Y30LB25*/ 12918000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12919000
PROCBVRO ST    @14,@SA00069                                        2907 12920000
*   SAVPREV=BASPREV;                /* SAVE PREV SERNO       @Y30LB25*/ 12921000
         L     @15,BASEVPTR                                        2908 12922000
         MVC   SAVPREV(6),BASPREV(@15)                             2908 12923000
*   SAVNEXT=BASNEXTV;               /* SAVE NEXT SERNO       @Y30LB25*/ 12924000
         MVC   SAVNEXT(6),BASNEXTV(@15)                            2909 12925000
*   BASEVPTR=ADDR(BASEBUF1);        /* NEW READ BUF          @Y30LB25*/ 12926000
*                                                                  2910 12927000
         LA    @15,BASEBUF1                                        2910 12928000
         ST    @15,BASEVPTR                                        2910 12929000
*   /*****************************************************************/ 12930000
*   /*                                                               */ 12931000
*   /* RECHAIN PREVIOUS BVR TO THE NEXT BVR                  @Y30LB25*/ 12932000
*   /*                                                               */ 12933000
*   /*****************************************************************/ 12934000
*                                                                  2911 12935000
*   BVOLKY=SAVPREV;                 /* SERNO OF PREV BVR     @Y30LB25*/ 12936000
         MVC   BVOLKY(6),SAVPREV                                   2911 12937000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 12938000
         LA    @15,BKEY                                            2912 12939000
         L     @14,RPLVPTR                                         2912 12940000
         ST    @15,RPLVKEY(,@14)                                   2912 12941000
*   CALL READUPD1;                  /* READ PREV BVR         @Y30LB25*/ 12942000
         BAL   @14,READUPD1                                        2913 12943000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 12944000
*     THEN                          /* YES                   @Y30LB25*/ 12945000
         L     @01,RPLVPTR                                         2914 12946000
         LH    @15,RPLVRETC(,@01)                                  2914 12947000
         N     @15,@CF01129                                        2914 12948000
         LTR   @15,@15                                             2914 12949000
         BNZ   @RT02914                                            2914 12950000
*     RETURN;                       /*                       @Y30LB25*/ 12951000
*   BASNEXTV=SAVNEXT;               /* PT TO NEW NEXT BVR    @Y30LB25*/ 12952000
         L     @01,BASEVPTR                                        2916 12953000
         MVC   BASNEXTV(6,@01),SAVNEXT                             2916 12954000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 12955000
         BAL   @14,WRITRECD                                        2917 12956000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 12957000
*     THEN                          /* YES                   @Y30LB25*/ 12958000
         L     @15,RPLVPTR                                         2918 12959000
         LH    @14,RPLVRETC(,@15)                                  2918 12960000
         N     @14,@CF01129                                        2918 12961000
         LTR   @14,@14                                             2918 12962000
         BNZ   @RT02918                                            2918 12963000
*     RETURN;                       /*                       @Y30LB25*/ 12964000
*   BVOLKY=SAVNEXT;                 /* SERNO NEXT BVR        @Y30LB25*/ 12965000
         MVC   BVOLKY(6),SAVNEXT                                   2920 12966000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 12967000
         LA    @14,BKEY                                            2921 12968000
         ST    @14,RPLVKEY(,@15)                                   2921 12969000
*   CALL READUPD1;                  /* READ PREV BVR         @Y30LB25*/ 12970000
         BAL   @14,READUPD1                                        2922 12971000
*   IF RPLVRETC¬=FIXZERO            /* ERROR?                @Y30LB25*/ 12972000
*     THEN                          /* YES                   @Y30LB25*/ 12973000
         L     @01,RPLVPTR                                         2923 12974000
         LH    @15,RPLVRETC(,@01)                                  2923 12975000
         N     @15,@CF01129                                        2923 12976000
         LTR   @15,@15                                             2923 12977000
         BNZ   @RT02923                                            2923 12978000
*     RETURN;                       /*                       @Y30LB25*/ 12979000
*   BASPREV=SAVPREV;                /* PT TO NEW PREV BVR    @Y30LB25*/ 12980000
         L     @01,BASEVPTR                                        2925 12981000
         MVC   BASPREV(6,@01),SAVPREV                              2925 12982000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 12983000
         BAL   @14,WRITRECD                                        2926 12984000
*   RETURN;                         /*                       @Y30LB25*/ 12985000
@EL00069 DS    0H                                                  2927 12986000
@EF00069 DS    0H                                                  2927 12987000
@ER00069 L     @14,@SA00069                                        2927 12988000
         BR    @14                                                 2927 12989000
*   END PROCBVRO;                   /*                       @Y30LB25*/ 12990000
         B     @EL00069                                            2928 12991000
*                                                                  2929 12992000
*   /*****************************************************************/ 12993000
*   /*                                                               */ 12994000
*   /* ENTRY NAME - ICBVUPGH                                 @Y30LB25*/ 12995000
*   /*                                                       @Y30LB25*/ 12996000
*   /* FUNCTION - UPDATE THE GROUP THRESHOLD, GROUP FREE     @Y30LB25*/ 12997000
*   /* SPACE, AND/OR GROUP FREE EXTENTS FOR ACTIVE, GROUPED, @Y30LB25*/ 12998000
*   /* GENERAL-USE VOLUMES. THE CALLER                       @Y30LB25*/ 12999000
*   /* MUST FIRST UPDATE THE COUNT OF GENERAL-USE VOLUMES    @Y30LB25*/ 13000000
*   /* IN THE GROUP                                          @Y30LB25*/ 13001000
*   /* VOLUME RECORD (GVR) BEFORE CALLING THIS ROUTINE.      @Y30LB25*/ 13002000
*   /* GROUP FREE SPACE AND GROUP FREE EXTENTS ARE           @Y30LB25*/ 13003000
*   /* INCREMENTED OR DECREMENTED DEPENDING ON HOW           @Y30LB25*/ 13004000
*   /* ADDSUBGR FLAG IN PASSBYTE IS SET.                     @Y30LB25*/ 13005000
*   /*                                                       @Y30LB25*/ 13006000
*   /* INPUT -                                               @Y30LB25*/ 13007000
*   /* MSVC REQUEST PARAMETER LIST PTR IN RPLVPTR            @Y30LB25*/ 13008000
*   /* GROUP VOLUME RECORD PTR IN GROUPPTR                   @Y30LB25*/ 13009000
*   /* BASE VOLUME RECORD PTR IN BASEVPTR                    @Y30LB25*/ 13010000
*   /* FLAG IN PASSBYTE                                      @Y30LB25*/ 13011000
*   /* INDICATES ADD OR SUBTRACT                             @Y30LB25*/ 13012000
*   /*                                                       @Y30LB25*/ 13013000
*   /* OUTPUT -                                              @Y30LB25*/ 13014000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 13015000
*   /*                                                               */ 13016000
*   /*****************************************************************/ 13017000
*                                                                  2929 13018000
*ICBVUPGH:                          /*                       @Y30LB25*/ 13019000
*   ENTRY(PTRGROUP,PTRBASEV,BYTEPASS);/*                     @Y30LB25*/ 13020000
*                                                                  2929 13021000
@EP02929 MVC   @PC00001(8),0(@01)                                  2929 13022000
         MVC   @PC00001+12(4),8(@01)                               2929 13023000
*   /*****************************************************************/ 13024000
*   /*                                                               */ 13025000
*   /* DECLARES FOR PASSED PARAMETERS                        @Y30LB25*/ 13026000
*   /* PTRGROUP, PTRBASEV, PTRRPLV, PASSBYTE                 @Y30LB25*/ 13027000
*   /* ARE DECLARED IN ICBVUCHI.                             @Y30LB25*/ 13028000
*   /*                                                               */ 13029000
*   /*****************************************************************/ 13030000
*                                                                  2930 13031000
*   DCL                                                            2930 13032000
*     FIX404 CONSTANT(404);         /* 404                   @Y30LB25*/ 13033000
*   DCL                                                            2931 13034000
*     FIX403 CONSTANT(403);         /* 403                   @Y30LB25*/ 13035000
*   DCL                                                            2932 13036000
*     FIX100 CONSTANT(100);         /* 100                   @Y30LB25*/ 13037000
*   GROUPPTR=PTRGROUP;              /* SET GROUP PTR         @Y30LB25*/ 13038000
         L     @06,@PC00001                                        2933 13039000
         L     @06,PTRGROUP(,@06)                                  2933 13040000
         ST    @06,GROUPPTR                                        2933 13041000
*   BASEVPTR=PTRBASEV;              /* SET BASE PTR          @Y30LB25*/ 13042000
         L     @06,@PC00001+4                                      2934 13043000
         L     @06,PTRBASEV(,@06)                                  2934 13044000
         ST    @06,BASEVPTR                                        2934 13045000
*   PASSBYTE=BYTEPASS;              /* ADD OR SUBT FLAG      @Y30LB25*/ 13046000
         L     @06,@PC00001+12                                     2935 13047000
         MVC   PASSBYTE(2),BYTEPASS(@06)                           2935 13048000
*   CALL VUPGH;                     /* PROCESS GVR           @Y30LB25*/ 13049000
         BAL   @14,VUPGH                                           2936 13050000
*   RETURN;                         /*                       @Y30LB25*/ 13051000
         B     @EL00001                                            2937 13052000
*                                                                  2938 13053000
*   /*****************************************************************/ 13054000
*   /*                                                               */ 13055000
*   /* PROCEDURE VUPGH IS CODED SO THAT COMMON ENTRY         @Y30LB25*/ 13056000
*   /* CODE IN ICBVUPGH CAN BE USED BY THIS MODULE           @Y30LB25*/ 13057000
*   /* AND BY OTHER MODULES. OTHER MODULES CALL              @Y30LB25*/ 13058000
*   /* ENTRY ICBVUPGH. THIS MODULE CALLS PROCEDURE           @Y30LB25*/ 13059000
*   /* VUPGH.                                                @Y30LB25*/ 13060000
*   /*                                                               */ 13061000
*   /*****************************************************************/ 13062000
*                                                                  2938 13063000
*VUPGH:                             /*                       @Y30LB25*/ 13064000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 13065000
*                                                                  2938 13066000
VUPGH    ST    @14,12(,@13)                                        2938 13067000
*   /*****************************************************************/ 13068000
*   /*                                                               */ 13069000
*   /* UPDATE THE GROUP THRESHOLD                            @Y30LB25*/ 13070000
*   /*                                                               */ 13071000
*   /*****************************************************************/ 13072000
*                                                                  2939 13073000
*   GROSTRSH=(GRONGEN*FIX404*GROPCENT)/FIX100;/*             @Y30LB25   13074000
*                                      SPACE THRESHOLD       @Y30LB25*/ 13075000
*                                                                  2939 13076000
         L     @06,GROUPPTR                                        2939 13077000
         LH    @01,GRONGEN(,@06)                                   2939 13078000
         MH    @01,@CH01095                                        2939 13079000
         SLR   @15,@15                                             2939 13080000
         IC    @15,GROPCENT(,@06)                                  2939 13081000
         MR    @00,@15                                             2939 13082000
         D     @00,@CF01099                                        2939 13083000
         ST    @01,GROSTRSH(,@06)                                  2939 13084000
*   /*****************************************************************/ 13085000
*   /*                                                               */ 13086000
*   /* UPDATE GROUP FREE SPACE AND FREE EXTENTS              @Y30LB25*/ 13087000
*   /*                                                               */ 13088000
*   /*****************************************************************/ 13089000
*                                                                  2940 13090000
*   IF ADDSUBGR=ON                  /* INCREMENT?            @Y30LB25*/ 13091000
*     THEN                          /* YES                   @Y30LB25*/ 13092000
         TM    ADDSUBGR,B'00001000'                                2940 13093000
         BNO   @RF02940                                            2940 13094000
*     DO;                           /*                       @Y30LB25*/ 13095000
*                                                                  2941 13096000
*       /*************************************************************/ 13097000
*       /*                                                           */ 13098000
*       /* CHECK IF BVR STILL CONTAINS NULL SPACE VALUES.    @Y30LB25*/ 13099000
*       /* IF SO, CHANGE THE VALUES TO REFLECT AN EMPTY      @Y30LB25*/ 13100000
*       /* VOLUME AND INDICATE IT IS DOWN LEVEL SPACE.       @Y30LB25*/ 13101000
*       /*                                                           */ 13102000
*       /*************************************************************/ 13103000
*                                                                  2942 13104000
*       IF BASFRESP=FIX2FS          /* NULL FREE SPACE?      @Y30LB25*/ 13105000
*         THEN                      /* YES                   @Y30LB25*/ 13106000
         L     @06,BASEVPTR                                        2942 13107000
         CLC   BASFRESP(2,@06),@CH00672                            2942 13108000
         BNE   @RF02942                                            2942 13109000
*         DO;                       /*                       @Y30LB25*/ 13110000
*           BASFRESP=FIX403;        /* SET FREE SPACE        @Y30LB25*/ 13111000
         LA    @15,403                                             2944 13112000
         STH   @15,BASFRESP(,@06)                                  2944 13113000
*           BASLEXT=FIX403;         /* LARGE FREE EXTENT     @Y30LB25*/ 13114000
         STH   @15,BASLEXT(,@06)                                   2945 13115000
*           BASFREXT=FIXONE;        /* # FREE EXTENTS        @Y30LB25*/ 13116000
         MVC   BASFREXT(4,@06),@CF00046                            2946 13117000
*           BASDLSF=ON;             /* DOWN LEVEL SPACE      @Y30LB25*/ 13118000
         OI    BASDLSF(@06),B'10000000'                            2947 13119000
*         END;                      /*                       @Y30LB25*/ 13120000
*       GROFRESP=GROFRESP+BASFRESP; /* NEW FREE SPACE        @Y30LB25*/ 13121000
@RF02942 L     @06,GROUPPTR                                        2949 13122000
         L     @15,BASEVPTR                                        2949 13123000
         LH    @14,BASFRESP(,@15)                                  2949 13124000
         N     @14,@CF01129                                        2949 13125000
         AL    @14,GROFRESP(,@06)                                  2949 13126000
         ST    @14,GROFRESP(,@06)                                  2949 13127000
*       GROFREXT=GROFREXT+BASFREXT; /* NEW FREE EXTENTS      @Y30LB25*/ 13128000
         L     @14,GROFREXT(,@06)                                  2950 13129000
         AL    @14,BASFREXT(,@15)                                  2950 13130000
         ST    @14,GROFREXT(,@06)                                  2950 13131000
*       GROMSG1=OFF;                /* MOUNT MSG             @Y30LB25*/ 13132000
         NI    GROMSG1(@06),B'11111101'                            2951 13133000
*       RETURN;                     /*                       @Y30LB25*/ 13134000
@EL00070 DS    0H                                                  2952 13135000
@EF00070 DS    0H                                                  2952 13136000
@ER00070 L     @14,12(,@13)                                        2952 13137000
         BR    @14                                                 2952 13138000
*     END;                          /*                       @Y30LB25*/ 13139000
*   ELSE                            /* DECREMENT             @Y30LB25*/ 13140000
*     DO;                           /*                       @Y30LB25*/ 13141000
@RF02940 DS    0H                                                  2955 13142000
*       GROFRESP=GROFRESP-BASFRESP; /* NEW FREE SPACE        @Y30LB25*/ 13143000
         L     @06,GROUPPTR                                        2955 13144000
         L     @15,BASEVPTR                                        2955 13145000
         L     @14,GROFRESP(,@06)                                  2955 13146000
         LH    @03,BASFRESP(,@15)                                  2955 13147000
         N     @03,@CF01129                                        2955 13148000
         SLR   @14,@03                                             2955 13149000
         ST    @14,GROFRESP(,@06)                                  2955 13150000
*       GROFREXT=GROFREXT-BASFREXT; /* NEW FREE EXTENTS      @Y30LB25*/ 13151000
         L     @14,GROFREXT(,@06)                                  2956 13152000
         SL    @14,BASFREXT(,@15)                                  2956 13153000
         ST    @14,GROFREXT(,@06)                                  2956 13154000
*       RETURN;                     /*                       @Y30LB25*/ 13155000
         B     @EL00070                                            2957 13156000
*     END;                          /*                       @Y30LB25*/ 13157000
*   END VUPGH;                      /*                       @Y30LB25*/ 13158000
*   END ICBVUT00                    /* THE END -- AT LAST    @Y30LB25*/ 13159000
*                                                                  2960 13160000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 13161000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 13162000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 13163000
*/*%INCLUDE SYSLIB  (IEZINDEX)                                       */ 13164000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 13165000
*/*%INCLUDE SYSLIB  (IEZNGVR )                                       */ 13166000
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */ 13167000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 13168000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 13169000
*/*%INCLUDE SYSLIB  (IEZDUPV )                                       */ 13170000
*/*%INCLUDE SYSLIB  (IEZMCRTE)                                       */ 13171000
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */ 13172000
*/*%INCLUDE SYSLIB  (IEZCOVCE)                                       */ 13173000
*                                                                  2960 13174000
*       ;                                                          2960 13175000
@DATA    DS    0H                                                       13176000
@CH00041 DC    H'4'                                                     13177000
@CH01095 DC    H'404'                                                   13178000
         DS    0F                                                       13179000
@AL00517 EQU   *                       LIST WITH   3 ARGUMENT(S)        13180000
@AL01570 DC    A(@CF00086)             LIST WITH   3 ARGUMENT(S)        13181000
         DC    A(RPLVPTR)                                               13182000
         DC    A(EXPRDT)                                                13183000
@AL00572 EQU   *                       LIST WITH   3 ARGUMENT(S)        13184000
@AL02320 DC    A(BCDVPTR)              LIST WITH   3 ARGUMENT(S)        13185000
         DC    A(RPLVPTR)                                               13186000
         DC    A(PASSBYTE)                                              13187000
@AL00640 EQU   *                       LIST WITH   4 ARGUMENT(S)        13188000
@AL00902 EQU   *                       LIST WITH   4 ARGUMENT(S)        13189000
@AL01059 EQU   *                       LIST WITH   4 ARGUMENT(S)        13190000
@AL01131 EQU   *                       LIST WITH   4 ARGUMENT(S)        13191000
@AL01189 EQU   *                       LIST WITH   4 ARGUMENT(S)        13192000
@AL01220 EQU   *                       LIST WITH   4 ARGUMENT(S)        13193000
@AL01241 EQU   *                       LIST WITH   4 ARGUMENT(S)        13194000
@AL01245 EQU   *                       LIST WITH   4 ARGUMENT(S)        13195000
@AL01266 EQU   *                       LIST WITH   4 ARGUMENT(S)        13196000
@AL02384 EQU   *                       LIST WITH   4 ARGUMENT(S)        13197000
@AL02548 DC    A(GROUPPTR)             LIST WITH   4 ARGUMENT(S)        13198000
         DC    A(BASEVPTR)                                              13199000
         DC    A(RPLVPTR)                                               13200000
         DC    A(PASSBYTE)                                              13201000
@AL00677 EQU   *                       LIST WITH   6 ARGUMENT(S)        13202000
@AL00691 DC    A(DUPVPTR)              LIST WITH   4 ARGUMENT(S)        13203000
         DC    A(BASEVPTR)                                              13204000
         DC    A(RPLVPTR)                                               13205000
         DC    A(PASSBYTE)                                              13206000
         DC    A(@CF00086)                                              13207000
         DC    A(@CF00086)                                              13208000
@AL00967 EQU   *                       LIST WITH   3 ARGUMENT(S)        13209000
@AL01712 EQU   *                       LIST WITH   3 ARGUMENT(S)        13210000
@AL01783 EQU   *                       LIST WITH   3 ARGUMENT(S)        13211000
@AL01831 EQU   *                       LIST WITH   3 ARGUMENT(S)        13212000
@AL01940 DC    A(COPYVPTR)             LIST WITH   3 ARGUMENT(S)        13213000
         DC    A(RPLVPTR)                                               13214000
         DC    A(PASSBYTE)                                              13215000
@AL01802 DC    A(@CF00086)             LIST WITH   3 ARGUMENT(S)        13216000
         DC    A(RPLVPRT)                                               13217000
         DC    A(EXPRDT)                                                13218000
         DS    0F                                                       13219000
@SA00001 DS    18F                                                      13220000
@PC00001 DS    4F                                                       13221000
@SA00002 DS    1F                                                       13222000
@SA00003 DS    1F                                                       13223000
@SA00016 DS    1F                                                       13224000
@SA00033 DS    1F                                                       13225000
@SA00031 DS    1F                                                       13226000
@SA00047 DS    1F                                                       13227000
@SA00049 DS    1F                                                       13228000
@SA00007 DS    1F                                                       13229000
@SA00019 DS    1F                                                       13230000
@SA00036 DS    1F                                                       13231000
@SA00032 DS    1F                                                       13232000
@SA00050 DS    1F                                                       13233000
@SA00059 DS    1F                                                       13234000
@SA00046 DS    1F                                                       13235000
@SA00060 DS    1F                                                       13236000
@SA00009 DS    1F                                                       13237000
@SA00045 DS    1F                                                       13238000
@SA00043 DS    1F                                                       13239000
@SA00012 DS    1F                                                       13240000
@SA00010 DS    1F                                                       13241000
@SA00013 DS    1F                                                       13242000
@SA00015 DS    1F                                                       13243000
@SA00067 DS    1F                                                       13244000
@SA00061 DS    1F                                                       13245000
@SA00017 DS    1F                                                       13246000
@SA00018 DS    1F                                                       13247000
@SA00020 DS    1F                                                       13248000
@SA00021 DS    1F                                                       13249000
@SA00058 DS    1F                                                       13250000
@SA00028 DS    1F                                                       13251000
@SA00022 DS    1F                                                       13252000
@SA00023 DS    1F                                                       13253000
@SA00027 DS    1F                                                       13254000
@SA00024 DS    1F                                                       13255000
@SA00026 DS    1F                                                       13256000
@SA00025 DS    1F                                                       13257000
@SA00037 DS    1F                                                       13258000
@SA00035 DS    1F                                                       13259000
@SA00041 DS    1F                                                       13260000
@SA00040 DS    1F                                                       13261000
@SA00038 DS    1F                                                       13262000
@SA00044 DS    1F                                                       13263000
@SA00048 DS    1F                                                       13264000
@SA00052 DS    1F                                                       13265000
@SA00055 DS    1F                                                       13266000
@SA00056 DS    1F                                                       13267000
@SA00053 DS    1F                                                       13268000
@SA00057 DS    1F                                                       13269000
@SA00054 DS    1F                                                       13270000
@SA00062 DS    1F                                                       13271000
@SA00063 DS    1F                                                       13272000
@SA00066 DS    1F                                                       13273000
@SA00068 DS    1F                                                       13274000
@SA00069 DS    1F                                                       13275000
@SA00039 DS    0F                                                       13276000
@SA00042 DS    0F                                                       13277000
@SA00064 DS    0F                                                       13278000
@SA00014 DS    0F                                                       13279000
@SA00065 DS    0F                                                       13280000
@SA00011 DS    0F                                                       13281000
@SA00034 DS    0F                                                       13282000
@SA00008 DS    0F                                                       13283000
@SA00006 DS    0F                                                       13284000
@SA00005 DS    0F                                                       13285000
@SA00004 DS    0F                                                       13286000
         DS    1F                                                       13287000
@AL00001 DS    6A                                                       13288000
         DS    0F                                                       13289000
@CF00086 DC    F'0'                                                     13290000
@CF00046 DC    F'1'                                                     13291000
@CH00046 EQU   @CF00046+2                                               13292000
@CF00044 DC    F'2'                                                     13293000
@CF00339 DC    F'36'                                                    13294000
@CF01105 DC    F'65'                                                    13295000
@CF01099 DC    F'100'                                                   13296000
@CF01104 DC    F'164'                                                   13297000
@CF01103 DC    F'224'                                                   13298000
@CF00668 DC    F'255'                                                   13299000
@CF00666 DC    F'256'                                                   13300000
@CF00677 DC    XL4'FFFFFFFF'                                            13301000
@CF01129 DC    XL4'0000FFFF'                                            13302000
@CF00672 DC    XL4'FFFF'                                                13303000
@CH00672 EQU   @CF00672+2                                               13304000
@CV00762 DC    V(ICBVIO00)                                              13305000
@CV00763 DC    V(ICBVRR00)                                              13306000
@CV00764 DC    V(ICBVJL00)                                              13307000
@CV00766 DC    V(ICBVUDBR)                                              13308000
@CV00767 DC    V(ICBVUEXT)                                              13309000
@CV00768 DC    V(ICBVUEXP)                                              13310000
@CV00769 DC    V(ICBVUBVR)                                              13311000
@CV00765 DC    V(ICBVOP00)                                              13312000
         DS    0D                                                       13313000
VVIPTR   DS    A                                                        13314000
RPLVPTR  DS    A                                                        13315000
INDEXPTR DS    A                                                        13316000
GROUPPTR DS    A                                                        13317000
BCDVPTR  DS    A                                                        13318000
BASEVPTR DS    A                                                        13319000
COPYVPTR DS    A                                                        13320000
DUPVPTR  DS    A                                                        13321000
MCRTEPTR DS    A                                                        13322000
COVCEPTR DS    A                                                        13323000
CVOLPTR  DS    A                                                        13324000
A        DS    F                                                        13325000
RPLVPRT  DS    F                                                        13326000
MCRLEN   DC    AL2(44)                                                  13327000
DEFLEN   DC    AL2(64)                                                  13328000
COVLEN   DC    AL2(43)                                                  13329000
@CC00692 DC    C'             '                                         13330000
@CC00689 EQU   @CC00692                                                 13331000
@CB00681 DC    X'00000000000000000000'                                  13332000
@CB00677 DC    X'FFFFFFFF'                                              13333000
@CB00701 DC    X'004C'                                                  13334000
@CB00703 DC    X'0203'                                                  13335000
@CB00705 DC    X'0204'                                                  13336000
@CB00707 DC    X'0205'                                                  13337000
@CB00709 DC    X'0206'                                                  13338000
@CB00711 DC    X'0208'                                                  13339000
@CB00713 DC    X'0209'                                                  13340000
@CB00717 DC    X'020E'                                                  13341000
@CB00719 DC    X'020F'                                                  13342000
@CB00721 DC    X'0210'                                                  13343000
@CB00723 DC    X'0213'                                                  13344000
@CB00725 DC    X'0214'                                                  13345000
@CB00727 DC    X'0217'                                                  13346000
@CB00729 DC    X'0227'                                                  13347000
@CB00731 DC    X'0228'                                                  13348000
@CB00733 DC    X'0235'                                                  13349000
@CB00735 DC    X'0236'                                                  13350000
@CB00737 DC    X'0237'                                                  13351000
@CB00739 DC    X'0238'                                                  13352000
GROUPBUF DS    CL224                                                    13353000
GRPBUF1  DS    CL224                                                    13354000
NGVRBUF  DS    CL224                                                    13355000
BASEBUF  DS    CL224                                                    13356000
COPYBUF  DS    CL224                                                    13357000
INDEXBUF DS    CL36                                                     13358000
DUPVBUF  DS    CL224                                                    13359000
         DS    CL1                                                      13360000
GKEY     DS    CL13                                                     13361000
         ORG   GKEY                                                     13362000
GKY      DC    CL3'G  '                                                 13363000
GROUPKY  DS    CL8                                                      13364000
GBLKKY   DC    CL1' '                                                   13365000
GIDKY    DC    XL1'00'                                                  13366000
         ORG   GKEY+13                                                  13367000
         DS    CL3                                                      13368000
BKEY     DS    CL13                                                     13369000
         ORG   BKEY                                                     13370000
BKY      DC    CL5'V    '                                               13371000
BVOLKY   DS    CL6                                                      13372000
BBLKKY   DC    CL1' '                                                   13373000
BIDKY    DC    XL1'00'                                                  13374000
         ORG   BKEY+13                                                  13375000
         DS    CL3                                                      13376000
DKEY     DS    CL13                                                     13377000
         ORG   DKEY                                                     13378000
DKY      DC    CL5'D    '                                               13379000
DVOLKY   DS    CL6                                                      13380000
DBLKKY   DC    CL1' '                                                   13381000
DIDKY    DS    FL1                                                      13382000
         ORG   DKEY+13                                                  13383000
         DS    CL3                                                      13384000
CKEY     DS    CL13                                                     13385000
         ORG   CKEY                                                     13386000
CKY      DC    CL5'V    '                                               13387000
CVOLKY   DS    CL6                                                      13388000
CBLKKY   DC    CL1' '                                                   13389000
CIDKY    DS    FL1                                                      13390000
         ORG   CKEY+13                                                  13391000
         DS    CL3                                                      13392000
IKEY     DS    CL13                                                     13393000
         ORG   IKEY                                                     13394000
IKY      DC    CL1'I'                                                   13395000
IVOLKY   DS    CL12                                                     13396000
         ORG   IKEY+13                                                  13397000
         DS    CL3                                                      13398000
NGKEY    DC    CL13'N   HEADER   '                                      13399000
         DS    CL3                                                      13400000
WORKAREA DS    CL23                                                     13401000
         ORG   WORKAREA                                                 13402000
REACODE  DS    CL2                                                      13403000
RETCODE  DS    CL2                                                      13404000
BCDKEY   DS    CL13                                                     13405000
EXPRDT   DS    CL4                                                      13406000
PASSBYTE DS    CL2                                                      13407000
         ORG   PASSBYTE                                                 13408000
GRPDV    DS    BL1                                                      13409000
FRSTDV   EQU   PASSBYTE+0                                               13410000
LASTDV   EQU   PASSBYTE+0                                               13411000
GRPFLG   EQU   PASSBYTE+0                                               13412000
ADDSUBGR EQU   PASSBYTE+0                                               13413000
CSNUMBER EQU   PASSBYTE+0                                               13414000
ADDSUBSL EQU   PASSBYTE+0                                               13415000
RPLVFLG  EQU   PASSBYTE+0                                               13416000
EXPSLOT  DS    BL1                                                      13417000
ADDSUB   EQU   PASSBYTE+1                                               13418000
@NM00054 EQU   PASSBYTE+1                                               13419000
         ORG   WORKAREA+23                                              13420000
MAXDATE  DC    X'0099365C'                                              13421000
NULLDATE DC    X'00000000'                                              13422000
         DS    CL1                                                      13423000
VU0PATCH DS    CL400                                                    13424000
         ORG   VU0PATCH                                                 13425000
@NM00055 DC    400X'00'                                                 13426000
         ORG   VU0PATCH+400                                             13427000
BASEBUF1 DS    CL224                                                    13428000
SAVSERNO DS    CL6                                                      13429000
SAVSERN1 DS    CL6                                                      13430000
SAVPREV  DS    CL6                                                      13431000
SAVNEXT  DS    CL6                                                      13432000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       13433000
@01      EQU   01                                                       13434000
@02      EQU   02                                                       13435000
@03      EQU   03                                                       13436000
@04      EQU   04                                                       13437000
@05      EQU   05                                                       13438000
@06      EQU   06                                                       13439000
@07      EQU   07                                                       13440000
@08      EQU   08                                                       13441000
@09      EQU   09                                                       13442000
@10      EQU   10                                                       13443000
@11      EQU   11                                                       13444000
@12      EQU   12                                                       13445000
@13      EQU   13                                                       13446000
@14      EQU   14                                                       13447000
@15      EQU   15                                                       13448000
SAVBASPT EQU   @06                                                      13449000
DEFVPTR  EQU   @04                                                      13450000
MCRTPTR  EQU   @06                                                      13451000
DEFVEPTR EQU   @05                                                      13452000
NGVRPTR  EQU   @02                                                      13453000
RG0      EQU   @00                                                      13454000
RG1      EQU   @01                                                      13455000
RG14     EQU   @14                                                      13456000
CVOLR1   EQU   @01                                                      13457000
DEFVR1   EQU   @01                                                      13458000
MCR1     EQU   @01                                                      13459000
RG10     EQU   @10                                                      13460000
RG11     EQU   @11                                                      13461000
RG12     EQU   @12                                                      13462000
RG13     EQU   @13                                                      13463000
RG15     EQU   @15                                                      13464000
RG2      EQU   @02                                                      13465000
RG3      EQU   @03                                                      13466000
RG4      EQU   @04                                                      13467000
RG5      EQU   @05                                                      13468000
RG6      EQU   @06                                                      13469000
RG7      EQU   @07                                                      13470000
RG8      EQU   @08                                                      13471000
RG9      EQU   @09                                                      13472000
VVICB    EQU   0                                                        13473000
VVIFLGA  EQU   VVICB+15                                                 13474000
VVIFLG0  EQU   VVIFLGA                                                  13475000
VVIFLG2  EQU   VVIFLGA                                                  13476000
RPLV     EQU   0                                                        13477000
RPLTCBPR EQU   RPLV+8                                                   13478000
RPLVVICB EQU   RPLV+12                                                  13479000
RPLFLAGA EQU   RPLV+28                                                  13480000
RPLFTIME EQU   RPLFLAGA                                                 13481000
RPLJRCVY EQU   RPLFLAGA                                                 13482000
RPLRCODE EQU   RPLV+32                                                  13483000
RPLVRETC EQU   RPLV+34                                                  13484000
RPLVDATE EQU   RPLV+38                                                  13485000
RPLVSAM  EQU   RPLV+56                                                  13486000
RPLVTYP  EQU   RPLVSAM+2                                                13487000
RPLVBUF  EQU   RPLVSAM+32                                               13488000
RPLVKEY  EQU   RPLVSAM+36                                               13489000
RPLVOPT  EQU   RPLVSAM+40                                               13490000
RPLVLOC  EQU   RPLVOPT                                                  13491000
RPLVDIR  EQU   RPLVOPT                                                  13492000
RPLVKGE  EQU   RPLVOPT                                                  13493000
RPLVUPD  EQU   RPLVOPT+1                                                13494000
RPLVRLN  EQU   RPLVSAM+48                                               13495000
RPLVBLN  EQU   RPLVSAM+52                                               13496000
RPLVUTIL EQU   RPLV+132                                                 13497000
INDEX    EQU   0                                                        13498000
INDNAME  EQU   INDEX                                                    13499000
INDTYPE  EQU   INDEX+13                                                 13500000
INDRECKY EQU   INDEX+15                                                 13501000
INDPREFX EQU   INDRECKY                                                 13502000
INDRECID EQU   INDRECKY+11                                              13503000
GROUP    EQU   0                                                        13504000
GRONAME  EQU   GROUP                                                    13505000
GROID    EQU   GRONAME+11                                               13506000
GROFLAGA EQU   GROUP+13                                                 13507000
GROTYPE  EQU   GROFLAGA                                                 13508000
GROBIND  EQU   GROFLAGA+2                                               13509000
GROEXCL  EQU   GROFLAGA+2                                               13510000
GRODAERA EQU   GROFLAGA+2                                               13511000
GRORONLY EQU   GROFLAGA+2                                               13512000
GRORETN  EQU   GROFLAGA+2                                               13513000
GROMSG1  EQU   GROFLAGA+2                                               13514000
GROFSN   EQU   GROUP+17                                                 13515000
GROLSN   EQU   GROUP+23                                                 13516000
GROPCENT EQU   GROUP+29                                                 13517000
GRONGEN  EQU   GROUP+30                                                 13518000
GRONRSTD EQU   GROUP+32                                                 13519000
GRONINAC EQU   GROUP+34                                                 13520000
GROSTRSH EQU   GROUP+40                                                 13521000
GROFRESP EQU   GROUP+44                                                 13522000
GROFREXT EQU   GROUP+48                                                 13523000
GROERRTS EQU   GROUP+56                                                 13524000
NGVR     EQU   0                                                        13525000
NGVRTYPE EQU   NGVR+13                                                  13526000
NGVFVOL  EQU   NGVR+17                                                  13527000
NGVLVOL  EQU   NGVR+23                                                  13528000
NGVNOVOL EQU   NGVR+30                                                  13529000
BCDV     EQU   0                                                        13530000
BCDNAME  EQU   BCDV                                                     13531000
BCDPREFX EQU   BCDNAME                                                  13532000
BCDSERNO EQU   BCDNAME+5                                                13533000
BCDID    EQU   BCDNAME+11                                               13534000
BCDFLAGA EQU   BCDV+14                                                  13535000
BCDTYPE  EQU   BCDFLAGA                                                 13536000
BCDBASE  EQU   BCDTYPE                                                  13537000
BCDCOPY  EQU   BCDTYPE                                                  13538000
BCDDUP   EQU   BCDTYPE                                                  13539000
BCDFLAGB EQU   BCDFLAGA+2                                               13540000
BCDRCVYF EQU   BCDV+20                                                  13541000
BCDSATIA EQU   BCDRCVYF                                                 13542000
BCDIVCRE EQU   BCDSATIA                                                 13543000
BCDIVCPY EQU   BCDSATIA                                                 13544000
BCDVSMIS EQU   BCDSATIA                                                 13545000
BCDMISCF EQU   BCDRCVYF+2                                               13546000
BCDCSN1  EQU   BCDV+24                                                  13547000
BCDLIB1  EQU   BCDV+36                                                  13548000
BCDLID1  EQU   BCDLIB1                                                  13549000
BCDCSN2  EQU   BCDV+37                                                  13550000
BCDLIB2  EQU   BCDV+49                                                  13551000
BCDLID2  EQU   BCDLIB2                                                  13552000
BASEV    EQU   0                                                        13553000
BASNAME  EQU   BASEV                                                    13554000
BASSERNO EQU   BASNAME+5                                                13555000
BASID    EQU   BASNAME+11                                               13556000
BASFLAGA EQU   BASEV+14                                                 13557000
BASTYPE  EQU   BASFLAGA                                                 13558000
BASBASVR EQU   BASTYPE                                                  13559000
BASDLSF  EQU   BASFLAGA+2                                               13560000
BASNOCPY EQU   BASFLAGA+2                                               13561000
BASGRPV  EQU   BASFLAGA+2                                               13562000
BASGENUS EQU   BASFLAGA+2                                               13563000
BASRSTD  EQU   BASFLAGA+2                                               13564000
BASINAC  EQU   BASFLAGA+2                                               13565000
BASBIND  EQU   BASFLAGA+2                                               13566000
BASEXCL  EQU   BASFLAGA+2                                               13567000
BASDAERA EQU   BASFLAGA+3                                               13568000
BASRONLY EQU   BASFLAGA+3                                               13569000
BASREASS EQU   BASFLAGA+3                                               13570000
BASFIRST EQU   BASFLAGA+3                                               13571000
BASLAST  EQU   BASFLAGA+3                                               13572000
BASRCVYF EQU   BASEV+20                                                 13573000
BASSATIA EQU   BASRCVYF                                                 13574000
BASMISCF EQU   BASRCVYF+2                                               13575000
BASHOLD  EQU   BASMISCF                                                 13576000
BASCSN1  EQU   BASEV+24                                                 13577000
BASLIB1  EQU   BASEV+36                                                 13578000
BASLID1  EQU   BASLIB1                                                  13579000
BASCSN2  EQU   BASEV+37                                                 13580000
BASLIB2  EQU   BASEV+49                                                 13581000
BASLID2  EQU   BASLIB2                                                  13582000
BASPREV  EQU   BASEV+50                                                 13583000
BASNEXTV EQU   BASEV+56                                                 13584000
BASNCOPY EQU   BASEV+62                                                 13585000
BASBKLMT EQU   BASEV+64                                                 13586000
BASFRESP EQU   BASEV+68                                                 13587000
BASLEXT  EQU   BASEV+70                                                 13588000
BASFREXT EQU   BASEV+72                                                 13589000
BASKLCPY EQU   BASEV+76                                                 13590000
BASCOPID EQU   BASKLCPY+11                                              13591000
BASCOPNO EQU   BASCOPID+1                                               13592000
BASDLMTD EQU   BASEV+92                                                 13593000
BASEXPDT EQU   BASEV+96                                                 13594000
BASDTREM EQU   BASEV+100                                                13595000
BASDESCR EQU   BASEV+104                                                13596000
BASOWNER EQU   BASEV+134                                                13597000
BASDEST  EQU   BASEV+144                                                13598000
BASRECOV EQU   BASEV+174                                                13599000
BASGROUP EQU   BASEV+180                                                13600000
COPYV    EQU   0                                                        13601000
COPNAME  EQU   COPYV                                                    13602000
COPV     EQU   COPNAME                                                  13603000
COPSERNO EQU   COPNAME+5                                                13604000
COPID    EQU   COPNAME+11                                               13605000
COPNO    EQU   COPID+1                                                  13606000
COPFLAGA EQU   COPYV+14                                                 13607000
COPTYPE  EQU   COPFLAGA                                                 13608000
COPCOPYV EQU   COPTYPE                                                  13609000
COPGROUP EQU   COPFLAGA+2                                               13610000
COPVSAM  EQU   COPFLAGA+2                                               13611000
COPGENUS EQU   COPFLAGA+2                                               13612000
COPRSTD  EQU   COPFLAGA+2                                               13613000
COPBKUP  EQU   COPFLAGA+2                                               13614000
COPBIND  EQU   COPFLAGA+2                                               13615000
COPEXCL  EQU   COPFLAGA+2                                               13616000
COPDAERA EQU   COPFLAGA+2                                               13617000
COPRONLY EQU   COPFLAGA+3                                               13618000
COPDLSPF EQU   COPFLAGA+3                                               13619000
COPRCVYF EQU   COPYV+20                                                 13620000
COPSATIA EQU   COPRCVYF                                                 13621000
COPMISCF EQU   COPRCVYF+2                                               13622000
COPHOLD  EQU   COPMISCF                                                 13623000
COPCSN1  EQU   COPYV+24                                                 13624000
COPLIB1  EQU   COPYV+36                                                 13625000
COPLID1  EQU   COPLIB1                                                  13626000
COPCSN2  EQU   COPYV+37                                                 13627000
COPLIB2  EQU   COPYV+49                                                 13628000
COPLID2  EQU   COPLIB2                                                  13629000
COPDATE  EQU   COPYV+50                                                 13630000
COPDTREM EQU   COPYV+54                                                 13631000
COPDESCR EQU   COPYV+58                                                 13632000
COPDEST  EQU   COPYV+88                                                 13633000
COPOWNER EQU   COPYV+118                                                13634000
COPFRESP EQU   COPYV+128                                                13635000
COPLEXT  EQU   COPYV+130                                                13636000
COPFREXT EQU   COPYV+132                                                13637000
DUPV     EQU   0                                                        13638000
DUPNAME  EQU   DUPV                                                     13639000
DUPD     EQU   DUPNAME                                                  13640000
DUPSERNO EQU   DUPNAME+5                                                13641000
DUPID    EQU   DUPNAME+11                                               13642000
DUPFLAGA EQU   DUPV+14                                                  13643000
DUPTYPE  EQU   DUPFLAGA                                                 13644000
DUPDUPLR EQU   DUPTYPE                                                  13645000
DUPRCVYF EQU   DUPV+20                                                  13646000
DUPCSN1  EQU   DUPV+24                                                  13647000
DUPLIB1  EQU   DUPV+36                                                  13648000
DUPLID1  EQU   DUPLIB1                                                  13649000
DUPCSN2  EQU   DUPV+37                                                  13650000
DUPLIB2  EQU   DUPV+49                                                  13651000
DUPLID2  EQU   DUPLIB2                                                  13652000
MCRTE    EQU   0                                                        13653000
MCRLOC   EQU   MCRTE+4                                                  13654000
MCRFLAGA EQU   MCRTE+34                                                 13655000
MCRSPLOC EQU   MCRFLAGA                                                 13656000
MCRFLAGB EQU   MCRTE+36                                                 13657000
MCRTYPE  EQU   MCRFLAGB+2                                               13658000
MCRREC   EQU   MCRTYPE                                                  13659000
DEFVE    EQU   0                                                        13660000
DEFGROUP EQU   DEFVE+4                                                  13661000
DEFDESCR EQU   DEFVE+12                                                 13662000
DEFTO    EQU   DEFVE+42                                                 13663000
DEFFOR   EQU   DEFVE+46                                                 13664000
DEFBKUPN EQU   DEFVE+48                                                 13665000
DEFLABEL EQU   DEFVE+49                                                 13666000
DEFFLAGA EQU   DEFVE+55                                                 13667000
DEFPFOR  EQU   DEFFLAGA                                                 13668000
DEFPGRO  EQU   DEFFLAGA                                                 13669000
DEFPDESC EQU   DEFFLAGA                                                 13670000
DEFPTO   EQU   DEFFLAGA                                                 13671000
DEFPBKUP EQU   DEFFLAGA                                                 13672000
DEFFLAGB EQU   DEFVE+56                                                 13673000
DEFSETFL EQU   DEFFLAGB                                                 13674000
DEFSRCVY EQU   DEFSETFL                                                 13675000
DEFCRCVY EQU   DEFSETFL                                                 13676000
DEFRECFL EQU   DEFFLAGB+1                                               13677000
DEFICOPY EQU   DEFRECFL                                                 13678000
DEFCREAT EQU   DEFRECFL                                                 13679000
DEFLAMIS EQU   DEFRECFL                                                 13680000
DEFTYPFL EQU   DEFFLAGB+2                                               13681000
DEFGENUS EQU   DEFTYPFL                                                 13682000
DEFRSTD  EQU   DEFTYPFL                                                 13683000
DEFDUP   EQU   DEFTYPFL                                                 13684000
DEFCOPY  EQU   DEFTYPFL                                                 13685000
DEFNULFL EQU   DEFFLAGB+3                                               13686000
DEFNGRP  EQU   DEFNULFL                                                 13687000
DEFNDESC EQU   DEFNULFL                                                 13688000
DEFNEXPD EQU   DEFNULFL                                                 13689000
COVCE    EQU   0                                                        13690000
COVDESCR EQU   COVCE+4                                                  13691000
COVFLAGA EQU   COVCE+34                                                 13692000
COVSPDES EQU   COVFLAGA                                                 13693000
COVFLAGB EQU   COVCE+35                                                 13694000
COVSETFL EQU   COVFLAGB                                                 13695000
COVSRCVY EQU   COVSETFL                                                 13696000
COVCRCVY EQU   COVSETFL                                                 13697000
COVRECFL EQU   COVFLAGB+1                                               13698000
COVICOPY EQU   COVRECFL                                                 13699000
COVCREAT EQU   COVRECFL                                                 13700000
COVLAMIS EQU   COVRECFL                                                 13701000
COVTYPE  EQU   COVFLAGB+2                                               13702000
COVSAM   EQU   COVTYPE                                                  13703000
COVREUSE EQU   COVTYPE                                                  13704000
LSTMCRT  EQU   0                                                        13705000
MCRTLEN  EQU   LSTMCRT                                                  13706000
MCRTOPCD EQU   LSTMCRT+4                                                13707000
MCRTFLG  EQU   LSTMCRT+6                                                13708000
MCRTTRAN EQU   MCRTFLG                                                  13709000
MCRTLIB  EQU   LSTMCRT+7                                                13710000
MCRTCSN  EQU   LSTMCRT+24                                               13711000
MCRTVEXT EQU   LSTMCRT+44                                               13712000
LSTDEFV  EQU   0                                                        13713000
DEFVLEN  EQU   LSTDEFV                                                  13714000
DEFVOPCD EQU   LSTDEFV+4                                                13715000
DEFVFLG  EQU   LSTDEFV+6                                                13716000
DEFVCR   EQU   DEFVFLG                                                  13717000
DEFVELM  EQU   DEFVFLG                                                  13718000
DEFVRNM  EQU   DEFVFLG                                                  13719000
DEFVREP  EQU   DEFVFLG                                                  13720000
DEFVELTR EQU   DEFVFLG                                                  13721000
DEFVRNTR EQU   DEFVFLG                                                  13722000
DEFVACT  EQU   DEFVFLG                                                  13723000
DEFVDACT EQU   DEFVFLG                                                  13724000
DEFVLIB  EQU   LSTDEFV+7                                                13725000
DEFVOLD  EQU   LSTDEFV+8                                                13726000
DEFVVFLG EQU   LSTDEFV+14                                               13727000
DEFVSEC  EQU   DEFVVFLG                                                 13728000
DEFVEXCL EQU   DEFVVFLG                                                 13729000
DEFVBIND EQU   DEFVVFLG                                                 13730000
DEFVWINH EQU   DEFVVFLG                                                 13731000
DEFVNVOL EQU   LSTDEFV+16                                               13732000
DEFVCSN1 EQU   LSTDEFV+24                                               13733000
DEFVDATA EQU   LSTDEFV+56                                               13734000
DEFOWNID EQU   DEFVDATA+29                                              13735000
DEFVVEXT EQU   LSTDEFV+128                                              13736000
LSTCVOL  EQU   0                                                        13737000
CVOLLEN  EQU   LSTCVOL                                                  13738000
CVOLOPCD EQU   LSTCVOL+4                                                13739000
CVOLFLG  EQU   LSTCVOL+6                                                13740000
CVODASCR EQU   CVOLFLG                                                  13741000
CVOCRCR  EQU   CVOLFLG                                                  13742000
CVOCRCRV EQU   CVOLFLG                                                  13743000
CVOLID   EQU   LSTCVOL+8                                                13744000
CVOLCSN  EQU   LSTCVOL+20                                               13745000
CVOLVEXT EQU   LSTCVOL+36                                               13746000
BUFFER   EQU   0                                                        13747000
PTRGROUP EQU   0                                                        13748000
PTRBASEV EQU   0                                                        13749000
PTRRPLV  EQU   0                                                        13750000
BYTEPASS EQU   0                                                        13751000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    13752000
CVOLRES2 EQU   LSTCVOL+34                                               13753000
CVOLRUA  EQU   LSTCVOL+32                                               13754000
CVOLECB  EQU   LSTCVOL+16                                               13755000
CVOLASID EQU   LSTCVOL+14                                               13756000
@NM00053 EQU   CVOLFLG                                                  13757000
CVOCRDAS EQU   CVOLFLG                                                  13758000
CVOLRES1 EQU   LSTCVOL+5                                                13759000
DEFTLAB  EQU   DEFVDATA+71                                              13760000
DEFR60   EQU   DEFVDATA+43                                              13761000
DEFR55   EQU   DEFVDATA+3                                               13762000
DEFACSEC EQU   DEFVDATA+2                                               13763000
DEFR50   EQU   DEFVDATA                                                 13764000
DEFVECB  EQU   LSTDEFV+52                                               13765000
DEFVASID EQU   LSTDEFV+50                                               13766000
@NM00052 EQU   LSTDEFV+48                                               13767000
DEFVCSN2 EQU   LSTDEFV+36                                               13768000
@NM00051 EQU   LSTDEFV+22                                               13769000
@NM00050 EQU   LSTDEFV+15                                               13770000
@NM00049 EQU   DEFVVFLG                                                 13771000
@NM00048 EQU   DEFVVFLG                                                 13772000
@NM00047 EQU   DEFVVFLG                                                 13773000
DEFVCECT EQU   DEFVVFLG                                                 13774000
DEFVLID  EQU   DEFVLIB                                                  13775000
@NM00046 EQU   DEFVLIB                                                  13776000
@NM00045 EQU   LSTDEFV+5                                                13777000
MCRTECB  EQU   LSTMCRT+40                                               13778000
MCRTASID EQU   LSTMCRT+38                                               13779000
MCRTRES4 EQU   LSTMCRT+36                                               13780000
MCRTRES3 EQU   LSTMCRT+16                                               13781000
MCRTRES2 EQU   LSTMCRT+8                                                13782000
MCRTLD   EQU   MCRTLIB                                                  13783000
@NM00044 EQU   MCRTLIB                                                  13784000
@NM00043 EQU   MCRTFLG                                                  13785000
MCRTSCT  EQU   MCRTFLG                                                  13786000
@NM00042 EQU   MCRTFLG                                                  13787000
MCRTRES1 EQU   LSTMCRT+5                                                13788000
@NM00041 EQU   COVCE+39                                                 13789000
@NM00040 EQU   COVFLAGB+3                                               13790000
@NM00039 EQU   COVTYPE                                                  13791000
@NM00038 EQU   COVRECFL                                                 13792000
@NM00037 EQU   COVSETFL                                                 13793000
@NM00036 EQU   COVFLAGA                                                 13794000
COVLNGTH EQU   COVCE                                                    13795000
@NM00035 EQU   DEFVE+60                                                 13796000
@NM00034 EQU   DEFNULFL                                                 13797000
@NM00033 EQU   DEFTYPFL                                                 13798000
@NM00032 EQU   DEFRECFL                                                 13799000
@NM00031 EQU   DEFSETFL                                                 13800000
@NM00030 EQU   DEFFLAGA                                                 13801000
DEFPVLAB EQU   DEFFLAGA                                                 13802000
DEFLNGTH EQU   DEFVE                                                    13803000
@NM00029 EQU   MCRTE+40                                                 13804000
@NM00028 EQU   MCRFLAGB+3                                               13805000
@NM00027 EQU   MCRTYPE                                                  13806000
@NM00026 EQU   MCRFLAGB+1                                               13807000
@NM00025 EQU   MCRFLAGB                                                 13808000
MCRBLNK1 EQU   MCRTE+35                                                 13809000
@NM00024 EQU   MCRFLAGA                                                 13810000
MCRLNGTH EQU   MCRTE                                                    13811000
@NM00023 EQU   DUPV+50                                                  13812000
DUP2BIT2 EQU   DUPLID2                                                  13813000
DUP2BIT1 EQU   DUPLID2                                                  13814000
DUPRES4  EQU   DUPLIB2                                                  13815000
DUP1BIT2 EQU   DUPLID1                                                  13816000
DUP1BIT1 EQU   DUPLID1                                                  13817000
DUPRES3  EQU   DUPLIB1                                                  13818000
DUPMISCF EQU   DUPRCVYF+2                                               13819000
DUPSATIA EQU   DUPRCVYF                                                 13820000
@NM00022 EQU   DUPV+18                                                  13821000
@NM00021 EQU   DUPFLAGA+2                                               13822000
DUPRES2  EQU   DUPTYPE                                                  13823000
DUPRES1  EQU   DUPTYPE                                                  13824000
DUPRES5  EQU   DUPV+13                                                  13825000
DUPNO    EQU   DUPID+1                                                  13826000
DUPBLANK EQU   DUPID                                                    13827000
@NM00020 EQU   COPYV+136                                                13828000
COP2BIT2 EQU   COPLID2                                                  13829000
COP2BIT1 EQU   COPLID2                                                  13830000
COPRES5  EQU   COPLIB2                                                  13831000
COP1BIT2 EQU   COPLID1                                                  13832000
COP1BIT1 EQU   COPLID1                                                  13833000
COPRES4  EQU   COPLIB1                                                  13834000
@NM00019 EQU   COPMISCF                                                 13835000
COPRES3  EQU   COPSATIA                                                 13836000
COPVSMIS EQU   COPSATIA                                                 13837000
COPIVCPY EQU   COPSATIA                                                 13838000
COPIVCRE EQU   COPSATIA                                                 13839000
@NM00018 EQU   COPYV+18                                                 13840000
@NM00017 EQU   COPFLAGA+3                                               13841000
COPRES2  EQU   COPTYPE                                                  13842000
COPRES1  EQU   COPTYPE                                                  13843000
COPRES6  EQU   COPYV+13                                                 13844000
COPBLANK EQU   COPID                                                    13845000
@NM00016 EQU   BASEV+188                                                13846000
BASRES6  EQU   BASEV+89                                                 13847000
BASCOPBK EQU   BASCOPID                                                 13848000
BASCOPSN EQU   BASKLCPY+5                                               13849000
BASCOPV  EQU   BASKLCPY                                                 13850000
@NM00015 EQU   BASEV+65                                                 13851000
BASNBKUP EQU   BASEV+63                                                 13852000
BAS2BIT2 EQU   BASLID2                                                  13853000
BAS2BIT1 EQU   BASLID2                                                  13854000
BASRES5  EQU   BASLIB2                                                  13855000
BAS1BIT2 EQU   BASLID1                                                  13856000
BAS1BIT1 EQU   BASLID1                                                  13857000
BASRES4  EQU   BASLIB1                                                  13858000
BASRES3  EQU   BASMISCF                                                 13859000
BASRES8  EQU   BASSATIA                                                 13860000
BASVSMIS EQU   BASSATIA                                                 13861000
BASIVCPY EQU   BASSATIA                                                 13862000
BASIVCRE EQU   BASSATIA                                                 13863000
BASCPUID EQU   BASEV+18                                                 13864000
@NM00014 EQU   BASFLAGA+3                                               13865000
BASRES2  EQU   BASTYPE                                                  13866000
BASRES1  EQU   BASTYPE                                                  13867000
BASRES7  EQU   BASEV+13                                                 13868000
BASZERO  EQU   BASID+1                                                  13869000
BASBLANK EQU   BASID                                                    13870000
BASEVKEY EQU   BASNAME                                                  13871000
BCD2BIT2 EQU   BCDLID2                                                  13872000
BCD2BIT1 EQU   BCDLID2                                                  13873000
BCDRES8  EQU   BCDLIB2                                                  13874000
BCD1BIT2 EQU   BCDLID1                                                  13875000
BCD1BIT1 EQU   BCDLID1                                                  13876000
BCDRE10  EQU   BCDLIB1                                                  13877000
BCDRES7A EQU   BCDMISCF                                                 13878000
BCDHOLD  EQU   BCDMISCF                                                 13879000
BCDRES7  EQU   BCDSATIA                                                 13880000
BCDCPUID EQU   BCDV+18                                                  13881000
BCDRES5  EQU   BCDFLAGB+1                                               13882000
BCDREASS EQU   BCDFLAGB+1                                               13883000
BCDRES4  EQU   BCDFLAGB                                                 13884000
BCDRES3  EQU   BCDTYPE                                                  13885000
BCDRES2  EQU   BCDTYPE                                                  13886000
BCDRES1  EQU   BCDTYPE                                                  13887000
BCDRES9  EQU   BCDV+13                                                  13888000
BCDINDEX EQU   BCDID+1                                                  13889000
BCDBLNK2 EQU   BCDID                                                    13890000
BCDBLNK1 EQU   BCDPREFX+1                                               13891000
BCDALPHA EQU   BCDPREFX                                                 13892000
@NM00013 EQU   NGVR+32                                                  13893000
@NM00012 EQU   NGVR+29                                                  13894000
@NM00011 EQU   NGVR+15                                                  13895000
NGVRES2  EQU   NGVRTYPE+1                                               13896000
NGVHDR   EQU   NGVRTYPE                                                 13897000
NGVRES1  EQU   NGVRTYPE                                                 13898000
NGVNAME  EQU   NGVR                                                     13899000
@NM00010 EQU   GROUP+136                                                13900000
GROADDR  EQU   GROUP+106                                                13901000
GROOWNER EQU   GROUP+96                                                 13902000
GRORESSP EQU   GROUP+95                                                 13903000
GROCONUS EQU   GROUP+94                                                 13904000
GRODESCR EQU   GROUP+64                                                 13905000
GROERRTM EQU   GROERRTS+4                                               13906000
GROERRDT EQU   GROERRTS                                                 13907000
GRORETPD EQU   GROUP+52                                                 13908000
GROSSPD  EQU   GROUP+38                                                 13909000
GROPSPD  EQU   GROUP+36                                                 13910000
@NM00009 EQU   GROFLAGA+2                                               13911000
GRORLSE  EQU   GROFLAGA+2                                               13912000
GRORES1  EQU   GROTYPE                                                  13913000
GROGVR   EQU   GROTYPE                                                  13914000
GROZERO  EQU   GROID+1                                                  13915000
GROBLANK EQU   GROID                                                    13916000
GROVVGRP EQU   GRONAME+3                                                13917000
GROG     EQU   GRONAME                                                  13918000
@NM00008 EQU   INDEX+28                                                 13919000
INDEXREC EQU   INDRECID+1                                               13920000
INDBLNK2 EQU   INDRECID                                                 13921000
INDVSRNO EQU   INDRECKY+5                                               13922000
INDBLNK1 EQU   INDPREFX+1                                               13923000
INDALPHA EQU   INDPREFX                                                 13924000
INDRES2  EQU   INDTYPE                                                  13925000
INDINDEX EQU   INDTYPE                                                  13926000
INDRES1  EQU   INDTYPE                                                  13927000
INDSERNO EQU   INDNAME+1                                                13928000
INDI     EQU   INDNAME                                                  13929000
@NM00007 EQU   RPLVSAM+44                                               13930000
@NM00006 EQU   RPLVOPT                                                  13931000
@NM00005 EQU   RPLVOPT                                                  13932000
RPLVNEXT EQU   RPLVOPT                                                  13933000
@NM00004 EQU   RPLVSAM+28                                               13934000
RPLVACB  EQU   RPLVSAM+24                                               13935000
@NM00003 EQU   RPLVSAM+3                                                13936000
@NM00002 EQU   RPLVSAM                                                  13937000
@NM00001 EQU   RPLV+42                                                  13938000
RPLRMSCC EQU   RPLV+36                                                  13939000
RPLVTLEN EQU   RPLV+30                                                  13940000
RPLVRES1 EQU   RPLFLAGA+1                                               13941000
RPLVJRNL EQU   RPLFLAGA                                                 13942000
RPLVVOP  EQU   RPLFLAGA                                                 13943000
RPLVVIN  EQU   RPLFLAGA                                                 13944000
RPLVCOMP EQU   RPLFLAGA                                                 13945000
RPLVPROG EQU   RPLFLAGA                                                 13946000
RPLVPOST EQU   RPLFLAGA                                                 13947000
RPLVRSV3 EQU   RPLV+24                                                  13948000
RPLVRSV2 EQU   RPLV+20                                                  13949000
RPLVRSV1 EQU   RPLV+16                                                  13950000
RPLASCBP EQU   RPLTCBPR                                                 13951000
RPLVECB  EQU   RPLV+4                                                   13952000
RPLVQPTR EQU   RPLV                                                     13953000
VVIUNUSD EQU   VVICB+116                                                13954000
VVINUSDC EQU   VVICB+112                                                13955000
VVITPFCH EQU   VVICB+108                                                13956000
VVIDVMEL EQU   VVICB+104                                                13957000
VVIVBSTF EQU   VVICB+100                                                13958000
VVISSOBA EQU   VVICB+96                                                 13959000
VVIVSCRA EQU   VVICB+92                                                 13960000
VVISTPTB EQU   VVICB+88                                                 13961000
VVIDVMTA EQU   VVICB+84                                                 13962000
VVIJUCB  EQU   VVICB+80                                                 13963000
VVIIUCB  EQU   VVICB+76                                                 13964000
VVIRES6  EQU   VVICB+72                                                 13965000
VVIRES5  EQU   VVICB+68                                                 13966000
VVIRES4  EQU   VVICB+64                                                 13967000
VVIUCB   EQU   VVICB+60                                                 13968000
VVIVJL   EQU   VVICB+56                                                 13969000
VVIVRR   EQU   VVICB+52                                                 13970000
VVIQLSPL EQU   VVICB+48                                                 13971000
VVIQRPL2 EQU   VVICB+44                                                 13972000
VVIQRPL1 EQU   VVICB+40                                                 13973000
VVIVTRK  EQU   VVICB+37                                                 13974000
VVIOPCD  EQU   VVICB+36                                                 13975000
VVIVQMP  EQU   VVICB+32                                                 13976000
VVIECB1  EQU   VVICB+28                                                 13977000
VVICATAD EQU   VVICB+24                                                 13978000
VVIDCBAD EQU   VVICB+20                                                 13979000
VVIACBAD EQU   VVICB+16                                                 13980000
VVIFLG7  EQU   VVIFLGA                                                  13981000
VVIFLG6  EQU   VVIFLGA                                                  13982000
VVIFLG5  EQU   VVIFLGA                                                  13983000
VVIFLG4  EQU   VVIFLGA                                                  13984000
VVIFLG3  EQU   VVIFLGA                                                  13985000
VVIFLG1  EQU   VVIFLGA                                                  13986000
VVIALCON EQU   VVICB+14                                                 13987000
VVICPUID EQU   VVICB+12                                                 13988000
VVIUCAT  EQU   VVICB+4                                                  13989000
VVICID   EQU   VVICB                                                    13990000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      13991000
@RF00191 EQU   @EL00002                                                 13992000
@RF00203 EQU   @EL00002                                                 13993000
@RF00211 EQU   @EL00002                                                 13994000
@RT00255 EQU   @EL00002                                                 13995000
@RT00261 EQU   @EL00002                                                 13996000
@RT00335 EQU   @EL00003                                                 13997000
@RT00377 EQU   @EL00007                                                 13998000
@RT00391 EQU   @EL00007                                                 13999000
@RT00405 EQU   @EL00008                                                 14000000
@RT00430 EQU   @EL00009                                                 14001000
@RT00461 EQU   @EL00011                                                 14002000
@RF00490 EQU   @EL00012                                                 14003000
@RF00513 EQU   @RC00506                                                 14004000
@RT00549 EQU   @EL00012                                                 14005000
@RT00551 EQU   @EL00012                                                 14006000
@RT00567 EQU   @EL00012                                                 14007000
@RT00578 EQU   @EL00012                                                 14008000
@RC00569 EQU   @EL00012                                                 14009000
@RT00591 EQU   @EL00013                                                 14010000
@RT00607 EQU   @EL00014                                                 14011000
@RT00620 EQU   @EL00015                                                 14012000
@RT00625 EQU   @EL00015                                                 14013000
@RT00630 EQU   @EL00015                                                 14014000
@RT00634 EQU   @EL00015                                                 14015000
@RT00641 EQU   @EL00015                                                 14016000
@RT00660 EQU   @EL00015                                                 14017000
@RF00666 EQU   @EL00015                                                 14018000
@RT00678 EQU   @EL00015                                                 14019000
@RT00682 EQU   @EL00015                                                 14020000
@RT00692 EQU   @EL00015                                                 14021000
@RT00709 EQU   @EL00016                                                 14022000
@RT00714 EQU   @EL00016                                                 14023000
@RT00736 EQU   @EL00016                                                 14024000
@RT00753 EQU   @EL00017                                                 14025000
@RF00744 EQU   @EL00017                                                 14026000
@RC00746 EQU   @EL00017                                                 14027000
@RT00780 EQU   @EL00018                                                 14028000
@RC00785 EQU   @RC00783                                                 14029000
@RC00812 EQU   @RC00810                                                 14030000
@RT00835 EQU   @EL00018                                                 14031000
@RF00773 EQU   @EL00018                                                 14032000
@RF00772 EQU   @EL00018                                                 14033000
@RF00834 EQU   @EL00018                                                 14034000
@RT00854 EQU   @EL00019                                                 14035000
@RT00861 EQU   @EL00019                                                 14036000
@RT00874 EQU   @EL00019                                                 14037000
@RT00882 EQU   @EL00019                                                 14038000
@RT00896 EQU   @EL00019                                                 14039000
@RT00903 EQU   @EL00019                                                 14040000
@RT00910 EQU   @EL00019                                                 14041000
@RT00926 EQU   @EL00020                                                 14042000
@RT00957 EQU   @EL00020                                                 14043000
@RT00961 EQU   @EL00020                                                 14044000
@RT00964 EQU   @EL00020                                                 14045000
@RT00968 EQU   @EL00020                                                 14046000
@RT00987 EQU   @EL00021                                                 14047000
@RT00993 EQU   @EL00021                                                 14048000
@RT00997 EQU   @EL00021                                                 14049000
@RT01005 EQU   @EL00021                                                 14050000
@RT01008 EQU   @EL00021                                                 14051000
@RT01020 EQU   @EL00021                                                 14052000
@RT01031 EQU   @EL00021                                                 14053000
@RT01045 EQU   @EL00022                                                 14054000
@RT01060 EQU   @EL00022                                                 14055000
@RT01067 EQU   @EL00022                                                 14056000
@RT01085 EQU   @EL00022                                                 14057000
@RT01095 EQU   @EL00023                                                 14058000
@RT01127 EQU   @EL00023                                                 14059000
@RT01132 EQU   @EL00023                                                 14060000
@RT01139 EQU   @EL00023                                                 14061000
@RT01143 EQU   @EL00023                                                 14062000
@RT01152 EQU   @EL00024                                                 14063000
@RT01165 EQU   @EL00025                                                 14064000
@RT01175 EQU   @EL00025                                                 14065000
@RT01183 EQU   @EL00025                                                 14066000
@RF01185 EQU   @EL00025                                                 14067000
@RT01197 EQU   @EL00026                                                 14068000
@RT01207 EQU   @EL00026                                                 14069000
@RT01214 EQU   @EL00026                                                 14070000
@RF01216 EQU   @EL00026                                                 14071000
@RT01230 EQU   @EL00027                                                 14072000
@RT01242 EQU   @EL00027                                                 14073000
@RT01246 EQU   @EL00027                                                 14074000
@RF01237 EQU   @RC01234                                                 14075000
@RT01267 EQU   @EL00027                                                 14076000
@RT01292 EQU   @EL00028                                                 14077000
@RT01298 EQU   @EL00028                                                 14078000
@RF01318 EQU   @EL00029                                                 14079000
@RF01324 EQU   @EL00029                                                 14080000
@RF01327 EQU   @EL00029                                                 14081000
@RF01343 EQU   @EL00030                                                 14082000
@RF01349 EQU   @EL00030                                                 14083000
@RF01363 EQU   @EL00031                                                 14084000
@RT01371 EQU   @EL00031                                                 14085000
@RT01375 EQU   @EL00031                                                 14086000
@RT01391 EQU   @EL00032                                                 14087000
@RT01410 EQU   @EL00032                                                 14088000
@RT01415 EQU   @EL00032                                                 14089000
@RF01431 EQU   @EL00033                                                 14090000
@RT01441 EQU   @EL00033                                                 14091000
@RT01455 EQU   @EL00033                                                 14092000
@RT01498 EQU   @EL00036                                                 14093000
@RT01510 EQU   @EL00036                                                 14094000
@RT01525 EQU   @EL00036                                                 14095000
@RT01531 EQU   @EL00036                                                 14096000
@RC01528 EQU   @EL00036                                                 14097000
@RT01540 EQU   @EL00037                                                 14098000
@RC01588 EQU   @EL00038                                                 14099000
@RT01619 EQU   @EL00039                                                 14100000
@RT01673 EQU   @EL00040                                                 14101000
@RT01679 EQU   @EL00040                                                 14102000
@RT01686 EQU   @EL00040                                                 14103000
@RT01698 EQU   @EL00041                                                 14104000
@RT01705 EQU   @EL00041                                                 14105000
@RT01709 EQU   @EL00041                                                 14106000
@RT01730 EQU   @EL00042                                                 14107000
@RT01747 EQU   @EL00043                                                 14108000
@RT01757 EQU   @EL00043                                                 14109000
@RT01767 EQU   @EL00043                                                 14110000
@RT01779 EQU   @EL00043                                                 14111000
@RT01784 EQU   @EL00043                                                 14112000
@RT01789 EQU   @EL00043                                                 14113000
@RT01793 EQU   @EL00043                                                 14114000
@RT01828 EQU   @EL00043                                                 14115000
@RT01832 EQU   @EL00043                                                 14116000
@RT01863 EQU   @EL00045                                                 14117000
@RT01871 EQU   @EL00045                                                 14118000
@RT01883 EQU   @EL00045                                                 14119000
@RT01905 EQU   @EL00046                                                 14120000
@RT01912 EQU   @EL00046                                                 14121000
@RT01931 EQU   @EL00046                                                 14122000
@RF01936 EQU   @EL00046                                                 14123000
@RF01953 EQU   @EL00047                                                 14124000
@RT01961 EQU   @EL00047                                                 14125000
@RT01977 EQU   @EL00047                                                 14126000
@RT01997 EQU   @EL00047                                                 14127000
@RT02000 EQU   @EL00047                                                 14128000
@RT02019 EQU   @EL00048                                                 14129000
@RT02023 EQU   @EL00048                                                 14130000
@RT02026 EQU   @EL00048                                                 14131000
@RT02038 EQU   @EL00049                                                 14132000
@RT02041 EQU   @EL00049                                                 14133000
@RT02048 EQU   @EL00049                                                 14134000
@RT02076 EQU   @EL00050                                                 14135000
@RT02086 EQU   @EL00050                                                 14136000
@RT02094 EQU   @EL00050                                                 14137000
@RT02103 EQU   @EL00050                                                 14138000
@RT02107 EQU   @EL00050                                                 14139000
@RT02118 EQU   @EL00050                                                 14140000
@RT02127 EQU   @EL00050                                                 14141000
@RT02134 EQU   @EL00050                                                 14142000
@RT02140 EQU   @EL00050                                                 14143000
@RT02231 EQU   @EL00050                                                 14144000
@RT02235 EQU   @EL00050                                                 14145000
@RT02240 EQU   @EL00050                                                 14146000
@RT02246 EQU   @EL00050                                                 14147000
@RC02262 EQU   @EL00051                                                 14148000
@RT02276 EQU   @EL00052                                                 14149000
@RT02279 EQU   @EL00052                                                 14150000
@RT02288 EQU   @EL00053                                                 14151000
@RT02296 EQU   @EL00053                                                 14152000
@RT02306 EQU   @EL00053                                                 14153000
@RT02311 EQU   @EL00053                                                 14154000
@RF02317 EQU   @EL00053                                                 14155000
@RT02328 EQU   @EL00054                                                 14156000
@RC02344 EQU   @EL00055                                                 14157000
@RT02363 EQU   @EL00056                                                 14158000
@RT02378 EQU   @EL00056                                                 14159000
@RF02358 EQU   @EL00056                                                 14160000
@RF02380 EQU   @EL00056                                                 14161000
@RT02413 EQU   @EL00057                                                 14162000
@RT02430 EQU   @EL00057                                                 14163000
@RT02440 EQU   @EL00058                                                 14164000
@RT02445 EQU   @EL00058                                                 14165000
@RT02449 EQU   @EL00058                                                 14166000
@RT02479 EQU   @EL00059                                                 14167000
@RT02495 EQU   @EL00059                                                 14168000
@RT02512 EQU   @EL00060                                                 14169000
@RT02520 EQU   @EL00060                                                 14170000
@RT02528 EQU   @EL00060                                                 14171000
@RT02542 EQU   @EL00060                                                 14172000
@RT02549 EQU   @EL00060                                                 14173000
@RT02556 EQU   @EL00060                                                 14174000
@RT02589 EQU   @EL00061                                                 14175000
@RT02614 EQU   @EL00061                                                 14176000
@RT02619 EQU   @EL00061                                                 14177000
@RT02637 EQU   @EL00061                                                 14178000
@RT02642 EQU   @EL00061                                                 14179000
@RT02653 EQU   @EL00061                                                 14180000
@RT02680 EQU   @EL00062                                                 14181000
@RT02699 EQU   @EL00062                                                 14182000
@RT02717 EQU   @EL00063                                                 14183000
@RT02729 EQU   @EL00063                                                 14184000
@RT02762 EQU   @EL00066                                                 14185000
@RT02766 EQU   @EL00066                                                 14186000
@RT02770 EQU   @EL00066                                                 14187000
@RT02801 EQU   @EL00067                                                 14188000
@RT02816 EQU   @EL00067                                                 14189000
@RT02821 EQU   @EL00067                                                 14190000
@RT02841 EQU   @EL00067                                                 14191000
@RT02846 EQU   @EL00067                                                 14192000
@RT02857 EQU   @EL00067                                                 14193000
@RT02871 EQU   @EL00068                                                 14194000
@RT02891 EQU   @EL00068                                                 14195000
@RT02914 EQU   @EL00069                                                 14196000
@RT02918 EQU   @EL00069                                                 14197000
@RT02923 EQU   @EL00069                                                 14198000
@RF00756 EQU   @RC00746                                                 14199000
@RC00787 EQU   @RC00785                                                 14200000
@RC00814 EQU   @RC00812                                                 14201000
@RC00789 EQU   @RC00787                                                 14202000
@ENDDATA EQU   *                                                        14203000
         END   ICBVUT00,(C'PLS1248',0701,78157)                         14204000
./  ADD  SSI=70620020,NAME=ICBVUT01
         TITLE 'ICBVUT01 UTILITY MODULE  JUNE 10, 1976                 *00001000
                        '                                               00002000
ICBVUT01 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'ICBVUT01  77.062'                                 0001 00009000
ICBVUDBR DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP03087-ICBVUDBR)                                   00013000
         ENTRY ICBVUDBR                                                 00014000
ICBVUEXT DS    0H                                                  0001 00015000
         USING *,@15                                               0001 00016000
         B     @PROLOG                                             0001 00017000
         DC    AL2(@EP03233-ICBVUEXT)                                   00018000
         ENTRY ICBVUEXT                                                 00019000
ICBVUEXP DS    0H                                                  0001 00020000
         USING *,@15                                               0001 00021000
         B     @PROLOG                                             0001 00022000
         DC    AL2(@EP03489-ICBVUEXP)                                   00023000
         ENTRY ICBVUEXP                                                 00024000
         DROP  @15                                                      00025000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00026000
         BALR  @12,0                                               0001 00027000
@PSTART  LA    @11,4095(,@12)                                      0001 00028000
         LA    @10,4095(,@11)                                      0001 00029000
         LA    @09,4095(,@10)                                      0001 00030000
         LA    @08,4095(,@09)                                      0001 00031000
         LA    @03,4095(,@08)                                      0001 00032000
         USING @PSTART,@12                                         0001 00033000
         USING @PSTART+4095,@11                                    0001 00034000
         USING @PSTART+8190,@10                                    0001 00035000
         USING @PSTART+12285,@09                                   0001 00036000
         USING @PSTART+16380,@08                                   0001 00037000
         USING @PSTART+20475,@03                                   0001 00038000
         ST    @13,@SA00001+4                                      0001 00039000
         LA    @14,@SA00001                                        0001 00040000
         ST    @14,8(,@13)                                         0001 00041000
         LR    @13,@14                                             0001 00042000
         AH    @15,4(,@15)                                         0001 00043000
         BR    @15                                                 0001 00044000
@EP00001 DS    0H                                                  0002 00045000
*   RPLVPTR=REG1;                   /* ADDR TO REQUEST BLK   @Y30LB26*/ 00046000
         ST    REG1,RPLVPTR                                        0159 00047000
*   RESPECIFY                                                      0160 00048000
*     REG1 UNRSTD;                  /* FREE REG1             @Y30LB26*/ 00049000
*   RVRPTR=ADDR(RPLVUTIL);          /* ADDR TO OP CD         @Y30LB26*/ 00050000
         L     @05,RPLVPTR                                         0161 00051000
         LA    @02,RPLVUTIL(,@05)                                  0161 00052000
         ST    @02,RVRPTR                                          0161 00053000
*                                                                  0162 00054000
*   /*****************************************************************/ 00055000
*   /*                                                               */ 00056000
*   /* SET UP ADDRESSABILITY TO MSVC CONTROL BLK             @Y30LB26*/ 00057000
*   /* AND CHECK TO SEE IF MSVC IS DISABLED                  @Y30LB26*/ 00058000
*   /*                                                               */ 00059000
*   /*****************************************************************/ 00060000
*                                                                  0162 00061000
*   VVIPTR=RPLVVICB;                /* ADDR TO VVICB         @Y30LB26*/ 00062000
         L     VVIPTR,RPLVVICB(,@05)                               0162 00063000
*   IF VVIFLG0=ON                   /* INVENTORY DISAB ?     @Y30LB26*/ 00064000
*     THEN                          /*                       @Y30LB26*/ 00065000
         TM    VVIFLG0(VVIPTR),B'10000000'                         0163 00066000
         BNO   @RF00163                                            0163 00067000
*     DO;                           /*                       @Y30LB26*/ 00068000
*       RPLVRETC=FOUR;              /* SET BAD RET CODE      @Y30LB26*/ 00069000
         MVC   RPLVRETC(2,@05),@CB00749                            0165 00070000
*       RPLRCODE=VVICDISA;          /* INDIC MSVC DISABLED   @Y30LB26*/ 00071000
         MVC   RPLRCODE(2,@05),@CB00785                            0166 00072000
*       RETURN;                     /*                       @Y30LB26*/ 00073000
@EL00001 L     @13,4(,@13)                                         0167 00074000
@EF00001 DS    0H                                                  0167 00075000
@ER00001 LM    @14,@12,12(@13)                                     0167 00076000
         BR    @14                                                 0167 00077000
*     END;                          /*                       @Y30LB26*/ 00078000
*                                                                  0169 00079000
*   /*****************************************************************/ 00080000
*   /*                                                               */ 00081000
*   /* CHECK TO SEE IF JOURNAL IS DISABLED                   @Y30LB26*/ 00082000
*   /*                                                               */ 00083000
*   /*****************************************************************/ 00084000
*                                                                  0169 00085000
*   IF VVIFLG2=ON&RPLJRCVY=OFF      /* JOURNAL DISABLED ?    @Y30LB26*/ 00086000
*     THEN                          /*                       @Y30LB26*/ 00087000
@RF00163 TM    VVIFLG2(VVIPTR),B'00100000'                         0169 00088000
         BNO   @RF00169                                            0169 00089000
         L     @05,RPLVPTR                                         0169 00090000
         TM    RPLJRCVY(@05),B'00000010'                           0169 00091000
         BNZ   @RF00169                                            0169 00092000
*     DO;                           /*                       @Y30LB26*/ 00093000
*                                                                  0170 00094000
*       /*************************************************************/ 00095000
*       /*                                                           */ 00096000
*       /* CHECK TO SEE IF READ ONLY ACCESS IS DESIRED       @Y30LB26*/ 00097000
*       /*                                                           */ 00098000
*       /*************************************************************/ 00099000
*                                                                  0171 00100000
*       IF RVROPCD¬=READREC         /* READ ONLY OPER ?      @Y30LB26*/ 00101000
*         THEN                      /*                       @Y30LB26*/ 00102000
*                                                                  0171 00103000
         L     @02,RVRPTR                                          0171 00104000
         CLI   RVROPCD(@02),X'87'                                  0171 00105000
         BE    @RF00171                                            0171 00106000
*         /***********************************************************/ 00107000
*         /*                                                         */ 00108000
*         /* IF NOT READ ONLY, HAULT PROCESSING AND          @Y30LB26*/ 00109000
*         /* SEND REASON CODE                                @Y30LB26*/ 00110000
*         /*                                                         */ 00111000
*         /***********************************************************/ 00112000
*                                                                  0172 00113000
*         DO;                       /*                       @Y30LB26*/ 00114000
*           RPLVRETC=FOUR;          /* SET BAD RET CODE      @Y30LB26*/ 00115000
         MVC   RPLVRETC(2,@05),@CB00749                            0173 00116000
*           RPLRCODE=JRNLDISA;      /* JOURNAL DISABLED      @Y30LB26*/ 00117000
         MVC   RPLRCODE(2,@05),@CB00787                            0174 00118000
*           RETURN;                 /*                       @Y30LB26*/ 00119000
         B     @EL00001                                            0175 00120000
*         END;                      /*                       @Y30LB26*/ 00121000
*     END;                          /*                       @Y30LB26*/ 00122000
@RF00171 DS    0H                                                  0178 00123000
*                                                                  0178 00124000
*   /*****************************************************************/ 00125000
*   /*                                                               */ 00126000
*   /* INITILIZE BIT SETTINGS BEFORE ENTRY                   @Y30LB26*/ 00127000
*   /*                                                               */ 00128000
*   /*****************************************************************/ 00129000
*                                                                  0178 00130000
*   INTERFLG=BIT8ZERO;              /* CLEAR INTER FLGS      @Y30LB26*/ 00131000
@RF00169 MVI   INTERFLG,X'00'                                      0178 00132000
*   PASSFLAG=BITZERO;               /* CLEAR EXTER ENT FLGS  @Y30LB26*/ 00133000
*                                                                  0179 00134000
         MVC   PASSFLAG(2),@CB00747                                0179 00135000
*   /*****************************************************************/ 00136000
*   /*                                                               */ 00137000
*   /* INITILIZE KEY IDS THAT COULD HAVE BEEN ALTERED        @Y30LB26*/ 00138000
*   /* IN A PREVIOUS EXECUTION OF THE PROGRAM                @Y30LB26*/ 00139000
*   /*                                                               */ 00140000
*   /*****************************************************************/ 00141000
*                                                                  0180 00142000
*   VBLKKY=BLANK;                   /* CLEAR KEY             @Y30LB26*/ 00143000
         MVI   VBLKKY,C' '                                         0180 00144000
*   VIDKY=FIXZERO;                  /* INIT ID FIELD         @Y30LB26*/ 00145000
         MVI   VIDKY,X'00'                                         0181 00146000
*   GBLKKY=BLANK;                   /* CLEAR GRP KEY         @Y30LB26*/ 00147000
         MVI   GBLKKY,C' '                                         0182 00148000
*   GIDKY=FIXZERO;                  /* INIT GRP ID FIELD     @Y30LB26*/ 00149000
         MVI   GIDKY,X'00'                                         0183 00150000
*   DBLKKY=BLANK;                   /* CLEAR DUP KEY         @Y30LB26*/ 00151000
         MVI   DBLKKY,C' '                                         0184 00152000
*   DIDKY=FIXZERO;                  /* INIT DUP ID FIELD     @Y30LB26*/ 00153000
         MVI   DIDKY,X'00'                                         0185 00154000
*                                                                  0186 00155000
*   /*****************************************************************/ 00156000
*   /*                                                               */ 00157000
*   /* TEST FOR REMOVE VOLUME RECORD OPERATION CODE          @Y30LB26*/ 00158000
*   /*                                                               */ 00159000
*   /*****************************************************************/ 00160000
*                                                                  0186 00161000
*   IF RVROPCD=REMOVOL              /* TEST OP CODE          @Y30LB26*/ 00162000
*     THEN                          /*                       @Y30LB26*/ 00163000
         L     @02,RVRPTR                                          0186 00164000
         CLI   RVROPCD(@02),X'81'                                  0186 00165000
         BNE   @RF00186                                            0186 00166000
*                                                                  0187 00167000
*     /***************************************************************/ 00168000
*     /*                                                             */ 00169000
*     /* CALL ROUTINE AND RETURN TO ICBVCR00                 @Y30LB26*/ 00170000
*     /*                                                             */ 00171000
*     /***************************************************************/ 00172000
*                                                                  0187 00173000
*     DO;                           /*                       @Y30LB26*/ 00174000
*       CALL REMOVEVR;              /* REMOVE VOLUME REC     @Y30LB26*/ 00175000
*                                                                  0188 00176000
         BAL   @14,REMOVEVR                                        0188 00177000
*       /*************************************************************/ 00178000
*       /*                                                           */ 00179000
*       /* CHECK RETURN CODE AND IF BAD SEE IF JOURNALED     @VS32198*/ 00180000
*       /* BEFORE. IF SO INDICATE THIS FACT.                 @VS32198*/ 00181000
*       /*                                                           */ 00182000
*       /*************************************************************/ 00183000
*                                                                  0189 00184000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @VS32198*/ 00185000
         L     @02,RPLVPTR                                         0189 00186000
         CLC   RPLVRETC(2,@02),@CB00747                            0189 00187000
         BE    @RF00189                                            0189 00188000
*         DO;                       /*                       @VS32198*/ 00189000
*           IF JRNLEDSW=ON THEN     /* JOURNALED BEFORE ?    @VS32198*/ 00190000
         TM    JRNLEDSW,B'00000001'                                0191 00191000
         BNO   @RF00191                                            0191 00192000
*             RPLVJRNL=ON;          /* INDIC JRNLED          @VS32198*/ 00193000
         OI    RPLVJRNL(@02),B'00000001'                           0192 00194000
*         END;                      /*                       @VS32198*/ 00195000
*       RETURN;                     /* RETURN TO CALLER      @Y30LB26*/ 00196000
         B     @EL00001                                            0194 00197000
*     END;                          /*                       @Y30LB26*/ 00198000
*                                                                  0196 00199000
*   /*****************************************************************/ 00200000
*   /*                                                               */ 00201000
*   /* TEST FOR CREATE GROUP RECORD OPERATION CODE           @Y30LB26*/ 00202000
*   /*                                                               */ 00203000
*   /*****************************************************************/ 00204000
*                                                                  0196 00205000
*   IF RVROPCD=CREGRP               /* TEST OP CODE          @Y30LB26*/ 00206000
*     THEN                          /*                       @Y30LB26*/ 00207000
@RF00186 L     @02,RVRPTR                                          0196 00208000
         CLI   RVROPCD(@02),X'82'                                  0196 00209000
         BNE   @RF00196                                            0196 00210000
*                                                                  0197 00211000
*     /***************************************************************/ 00212000
*     /*                                                             */ 00213000
*     /* CALL ROUTINE AND RETURN TO ICBVCR00                 @Y30LB26*/ 00214000
*     /*                                                             */ 00215000
*     /***************************************************************/ 00216000
*                                                                  0197 00217000
*     DO;                           /*                       @Y30LB26*/ 00218000
*       CALL CREATEG;               /* GO CREATE GROUP       @Y30LB26*/ 00219000
*                                                                  0198 00220000
         BAL   @14,CREATEG                                         0198 00221000
*       /*************************************************************/ 00222000
*       /*                                                           */ 00223000
*       /* CHECK RETURN CODE AND IF BAD SEE IF JOURNALED     @VS32198*/ 00224000
*       /* BEFORE. IF SO INDICATE THIS FACT.                 @VS32198*/ 00225000
*       /*                                                           */ 00226000
*       /*************************************************************/ 00227000
*                                                                  0199 00228000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @VS32198*/ 00229000
         L     @02,RPLVPTR                                         0199 00230000
         CLC   RPLVRETC(2,@02),@CB00747                            0199 00231000
         BE    @RF00199                                            0199 00232000
*         DO;                       /*                       @VS32198*/ 00233000
*           IF JRNLEDSW=ON THEN     /* JOURNALED BEFORE ?    @VS32198*/ 00234000
         TM    JRNLEDSW,B'00000001'                                0201 00235000
         BNO   @RF00201                                            0201 00236000
*             RPLVJRNL=ON;          /* INDIC JRNLED          @VS32198*/ 00237000
         OI    RPLVJRNL(@02),B'00000001'                           0202 00238000
*         END;                      /*                       @VS32198*/ 00239000
*       RETURN;                     /* RETURN TO ICBVCR00    #Y30LB26*/ 00240000
         B     @EL00001                                            0204 00241000
*     END;                          /*                       @Y30LB26*/ 00242000
*                                                                  0206 00243000
*   /*****************************************************************/ 00244000
*   /*                                                               */ 00245000
*   /* TEST FOR MODIFY GROUP RECORD OPERATION CODE           @Y30LB26*/ 00246000
*   /*                                                               */ 00247000
*   /*****************************************************************/ 00248000
*                                                                  0206 00249000
*   IF RVROPCD=MODGRP               /* TEST OP CODE          @Y30LB26*/ 00250000
*     THEN                          /*                       @Y30LB26*/ 00251000
@RF00196 L     @02,RVRPTR                                          0206 00252000
         CLI   RVROPCD(@02),X'83'                                  0206 00253000
         BNE   @RF00206                                            0206 00254000
*                                                                  0207 00255000
*     /***************************************************************/ 00256000
*     /*                                                             */ 00257000
*     /* CALL ROUTINE AND RETURN TO ICBVCR00                 @Y30LB26*/ 00258000
*     /*                                                             */ 00259000
*     /***************************************************************/ 00260000
*                                                                  0207 00261000
*     DO;                           /*                       @Y30LB26*/ 00262000
*       CALL MODIFYG;               /* GO MODIFY GP REC      @Y30LB26*/ 00263000
*                                                                  0208 00264000
         BAL   @14,MODIFYG                                         0208 00265000
*       /*************************************************************/ 00266000
*       /*                                                           */ 00267000
*       /* CHECK RETURN CODE AND IF BAD SEE IF JOURNALED     @VS32198*/ 00268000
*       /* BEFORE. IF SO INDICATE THIS FACT.                 @VS32198*/ 00269000
*       /*                                                           */ 00270000
*       /*************************************************************/ 00271000
*                                                                  0209 00272000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @VS32198*/ 00273000
         L     @02,RPLVPTR                                         0209 00274000
         CLC   RPLVRETC(2,@02),@CB00747                            0209 00275000
         BE    @RF00209                                            0209 00276000
*         DO;                       /*                       @VS32198*/ 00277000
*           IF JRNLEDSW=ON THEN     /* JOURNALED BEFORE ?    @VS32198*/ 00278000
         TM    JRNLEDSW,B'00000001'                                0211 00279000
         BNO   @RF00211                                            0211 00280000
*             RPLVJRNL=ON;          /* INDIC JRNLED          @VS32198*/ 00281000
         OI    RPLVJRNL(@02),B'00000001'                           0212 00282000
*         END;                      /*                       @VS32198*/ 00283000
*       RETURN;                     /*                       #Y30LB26*/ 00284000
         B     @EL00001                                            0214 00285000
*     END;                          /*                       @Y30LB26*/ 00286000
*                                                                  0216 00287000
*   /*****************************************************************/ 00288000
*   /*                                                               */ 00289000
*   /* TEST FOR SCRATCH GROUP OPERATION CODE                 @Y30LB26*/ 00290000
*   /*                                                               */ 00291000
*   /*****************************************************************/ 00292000
*                                                                  0216 00293000
*   IF RVROPCD=SCRGRP               /* TEST OP CODE          @Y30LB26*/ 00294000
*     THEN                          /*                       @Y30LB26*/ 00295000
@RF00206 L     @02,RVRPTR                                          0216 00296000
         CLI   RVROPCD(@02),X'84'                                  0216 00297000
         BNE   @RF00216                                            0216 00298000
*                                                                  0217 00299000
*     /***************************************************************/ 00300000
*     /*                                                             */ 00301000
*     /* SCRATCH RECORD AND RETURN TO ICBVCR00               @Y30LB26*/ 00302000
*     /*                                                             */ 00303000
*     /***************************************************************/ 00304000
*                                                                  0217 00305000
*     DO;                           /*                       @Y30LB26*/ 00306000
*       CALL SCRATCHG;              /* GO SCRATCH GROUP      @Y30LB26*/ 00307000
*                                                                  0218 00308000
         BAL   @14,SCRATCHG                                        0218 00309000
*       /*************************************************************/ 00310000
*       /*                                                           */ 00311000
*       /* CHECK RETURN CODE AND IF BAD SEE IF JOURNALED     @VS32198*/ 00312000
*       /* BEFORE. IF SO INDICATE THIS FACT.                 @VS32198*/ 00313000
*       /*                                                           */ 00314000
*       /*************************************************************/ 00315000
*                                                                  0219 00316000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @VS32198*/ 00317000
         L     @02,RPLVPTR                                         0219 00318000
         CLC   RPLVRETC(2,@02),@CB00747                            0219 00319000
         BE    @RF00219                                            0219 00320000
*         DO;                       /*                       @VS32198*/ 00321000
*           IF JRNLEDSW=ON THEN     /* JOURNALED BEFORE ?    @VS32198*/ 00322000
         TM    JRNLEDSW,B'00000001'                                0221 00323000
         BNO   @RF00221                                            0221 00324000
*             RPLVJRNL=ON;          /* INDIC JRNLED          @VS32198*/ 00325000
         OI    RPLVJRNL(@02),B'00000001'                           0222 00326000
*         END;                      /*                       @VS32198*/ 00327000
*       RETURN;                     /*                       #Y30LB26*/ 00328000
         B     @EL00001                                            0224 00329000
*     END;                          /*                       @Y30LB26*/ 00330000
*                                                                  0226 00331000
*   /*****************************************************************/ 00332000
*   /*                                                               */ 00333000
*   /* TEST FOR MODIFY BASE VOLUME OP CODE                   @Y30LB26*/ 00334000
*   /*                                                               */ 00335000
*   /*****************************************************************/ 00336000
*                                                                  0226 00337000
*   IF RVROPCD=MODVOL               /* TEST OP CODE          @Y30LB26*/ 00338000
*     THEN                          /*                       @Y30LB26*/ 00339000
@RF00216 L     @02,RVRPTR                                          0226 00340000
         CLI   RVROPCD(@02),X'85'                                  0226 00341000
         BNE   @RF00226                                            0226 00342000
*                                                                  0227 00343000
*     /***************************************************************/ 00344000
*     /*                                                             */ 00345000
*     /* MODIFY VOLUME RECORD AND RETURN TO ICBVCR00         @Y30LB26*/ 00346000
*     /*                                                             */ 00347000
*     /***************************************************************/ 00348000
*                                                                  0227 00349000
*     DO;                           /*                       @Y30LB26*/ 00350000
*       CALL MODIFYV;               /* GO MODIFY VOL REC     @Y30LB26*/ 00351000
*                                                                  0228 00352000
         BAL   @14,MODIFYV                                         0228 00353000
*       /*************************************************************/ 00354000
*       /*                                                           */ 00355000
*       /* CHECK RETURN CODE AND IF BAD SEE IF JOURNALED     @VS32198*/ 00356000
*       /* BEFORE. IF SO INDICATE THIS FACT.                 @VS32198*/ 00357000
*       /*                                                           */ 00358000
*       /*************************************************************/ 00359000
*                                                                  0229 00360000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @VS32198*/ 00361000
         L     @02,RPLVPTR                                         0229 00362000
         CLC   RPLVRETC(2,@02),@CB00747                            0229 00363000
         BE    @RF00229                                            0229 00364000
*         DO;                       /*                       @VS32198*/ 00365000
*           IF JRNLEDSW=ON THEN     /* JOURNALED BEFORE ?    @VS32198*/ 00366000
         TM    JRNLEDSW,B'00000001'                                0231 00367000
         BNO   @RF00231                                            0231 00368000
*             RPLVJRNL=ON;          /* INDIC JRNLED          @VS32198*/ 00369000
         OI    RPLVJRNL(@02),B'00000001'                           0232 00370000
*         END;                      /*                       @VS32198*/ 00371000
*       RETURN;                     /*                       #Y30LB26*/ 00372000
         B     @EL00001                                            0234 00373000
*     END;                          /*                       @Y30LB26*/ 00374000
*                                                                  0236 00375000
*   /*****************************************************************/ 00376000
*   /*                                                               */ 00377000
*   /* TEST FOR READ INVENTORY RECORDS OP CODE               @Y30LB26*/ 00378000
*   /*                                                               */ 00379000
*   /*****************************************************************/ 00380000
*                                                                  0236 00381000
*   IF RVROPCD=READREC              /* TEST OP CODE          @Y30LB26*/ 00382000
*     THEN                          /*                       @Y30LB26*/ 00383000
@RF00226 L     @02,RVRPTR                                          0236 00384000
         CLI   RVROPCD(@02),X'87'                                  0236 00385000
         BNE   @RF00236                                            0236 00386000
*                                                                  0237 00387000
*     /***************************************************************/ 00388000
*     /*                                                             */ 00389000
*     /* READ RECORD AND RETURN TO ICBVCR00                  @Y30LB26*/ 00390000
*     /*                                                             */ 00391000
*     /***************************************************************/ 00392000
*                                                                  0237 00393000
*     DO;                           /*                       @Y30LB26*/ 00394000
*       CALL READVVI;               /* GO READ RECORD        @Y30LB26*/ 00395000
         BAL   @14,READVVI                                         0238 00396000
*       RETURN;                     /*                       @Y30LB26*/ 00397000
         B     @EL00001                                            0239 00398000
*     END;                          /*                       @Y30LB26*/ 00399000
*                                                                  0241 00400000
*   /*****************************************************************/ 00401000
*   /*                                                               */ 00402000
*   /* NO VALID OPERATION CODE WAS FOUND. SET ERROR          @Y30LB26*/ 00403000
*   /* REASON AND RETURN CODES.                              @Y30LB26*/ 00404000
*   /*                                                               */ 00405000
*   /*****************************************************************/ 00406000
*                                                                  0241 00407000
*   RPLRCODE=BADOPCD;               /* INVALID OPERATION     @Y30LB26*/ 00408000
@RF00236 L     @02,RPLVPTR                                         0241 00409000
         MVC   RPLRCODE(2,@02),@CB00793                            0241 00410000
*   RPLVRETC=FOUR;                  /* SET BAD RET CODE      @Y30LB26*/ 00411000
         MVC   RPLVRETC(2,@02),@CB00749                            0242 00412000
*   RETURN;                         /* RETURN TO ICBVCR00    @Y30LB26*/ 00413000
         B     @EL00001                                            0243 00414000
*                                                                  0244 00415000
*/*  START OF SPECIFICATIONS ****                            @Y30LB26   00416000
*                                                                  0244 00417000
*    PROCEDURE NAME - CREATEG                                @Y30LB26   00418000
*                                                                  0244 00419000
*    FUNCTION - TO PLACE A GROUP RECORD IN THE USERCAT.MSVI DATA SET.   00420000
*    ANOTHER GROUP RECORD MUST NOT EXIST WITH THE SAME GROUP NAME. 0244 00421000
*    THERE MUST NOT BE ANY ILLEGAL CHARACTERS IN THE GROUP NAME. THIS   00422000
*    IS CHECKED.                                                   0244 00423000
*    THIS PROGRAM PUTS IN THE PRIMARY AND SECONDARY SPACE DEFAULTS,     00424000
*    THE NUMBER OF CONCURRENT USERS, AND RESERVED SPACE IN CYLINDERS.   00425000
*    ALSO IT OPTIONALLY PUTS IN OWNER, THRESHOLD, RETENTION PERIOD,     00426000
*    DESCRIPTION AND ADDRESS, PLUS ANY MOUNT ATTRIBUTES.  THE RPLV IS   00427000
*    JOURNALED AFTER THE FIRST SUCCESSFUL UPDATE OF INVENTORY      0244 00428000
*    DATA SET.                                                @G24LB37  00429000
*                                                                  0244 00430000
*                                                                  0244 00431000
*      INPUTS - REGISTER 1 CONTAINS THE ADDRESS OF THE RPLV.  IT   0244 00432000
*      HAS ALL THE INFORMATION REQUIRED TO CREATE A GROUP          0244 00433000
*      RECORD.                                                @Y30LB26  00434000
*                                                                  0244 00435000
*      '020A'X  GROUP ALREADY EXISTS.                         @Y30LB26  00436000
*      '0225'X  GROUP NAME IS INVALID.                        @Y30LB26  00437000
*      PLUS ANY RETURN CODES FROM I/O PROCESSOR AND JOURNALING PROGRAM. 00438000
*                                                             @Y30LB26  00439000
**** END OF SPECIFICATIONS **                                        */ 00440000
*                                                                  0244 00441000
*CREATEG:                                                          0244 00442000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 00443000
CREATEG  ST    @14,@SA00002                                        0244 00444000
*   DCL                                                            0245 00445000
*     TWOBLK CHAR(2) CONSTANT('  ');/* TEST CONSTANT         #Y30LB26*/ 00446000
*                                                                  0246 00447000
*   /*****************************************************************/ 00448000
*   /*                                                               */ 00449000
*   /* ADDRESS OF REQUEST BLOCK                              @Y30LB26*/ 00450000
*   /*                                                               */ 00451000
*   /*****************************************************************/ 00452000
*                                                                  0246 00453000
*   MGPPTR=ADDR(RPLVUTIL);          /* PTR TO REQUEST BLK    @Y30LB26*/ 00454000
         L     MGPPTR,RPLVPTR                                      0246 00455000
         LA    MGPPTR,RPLVUTIL(,MGPPTR)                            0246 00456000
*   STORGRP=STORGRP&&STORGRP;       /* ZERO GROUP REC BUFF   @Y30LB26*/ 00457000
*                                                                  0247 00458000
         XC    STORGRP(224),STORGRP                                0247 00459000
*   /*****************************************************************/ 00460000
*   /*                                                               */ 00461000
*   /* GO CHECK FOR VALID CHARACTERS IN GROUP NAME           @Y30LB26*/ 00462000
*   /*                                                               */ 00463000
*   /*****************************************************************/ 00464000
*                                                                  0248 00465000
*   CALL VALGPNAM;                  /* CK FOR VALID GP NM    @Y30LB26*/ 00466000
*                                                                  0248 00467000
         BAL   @14,VALGPNAM                                        0248 00468000
*   /*****************************************************************/ 00469000
*   /*                                                               */ 00470000
*   /* CHECK RETURN CODE FROM GROUP NAME ROUTINE             @Y30LB26*/ 00471000
*   /*                                                               */ 00472000
*   /*****************************************************************/ 00473000
*                                                                  0249 00474000
*   IF RPLVRETC¬=RCZERO             /* CK FOR GOOD RET CD    @Y30LB26*/ 00475000
*     THEN                                                         0249 00476000
         L     @07,RPLVPTR                                         0249 00477000
         CLC   RPLVRETC(2,@07),@CB00747                            0249 00478000
         BNE   @RT00249                                            0249 00479000
*     RETURN;                       /* INVAL GRP, RETURN     @Y30LB26*/ 00480000
*                                                                  0251 00481000
*   /*****************************************************************/ 00482000
*   /*                                                               */ 00483000
*   /* CALL RESERVE INVENTORY DATA SET.                      @Y30LB26*/ 00484000
*   /*                                                               */ 00485000
*   /*****************************************************************/ 00486000
*                                                                  0251 00487000
*   CALL RESERINV;                  /* GO RESERVE INVEN      @Y30LB26*/ 00488000
         BAL   @14,RESERINV                                        0251 00489000
*                                                                  0252 00490000
*   /*****************************************************************/ 00491000
*   /*                                                               */ 00492000
*   /* INITILIZE FIELDS IN GROUP VOLUME RECORD               @Y30LB26*/ 00493000
*   /*                                                               */ 00494000
*   /*****************************************************************/ 00495000
*                                                                  0252 00496000
*   GROUPPTR=ADDR(STORGRP);         /* ADDR TO REC BUFFER    @Y30LB26*/ 00497000
         LA    @07,STORGRP                                         0252 00498000
         ST    @07,GROUPPTR                                        0252 00499000
*   GROUPKY=MGPGROUP;               /* NAME GRP BE CREATED   @Y30LB26*/ 00500000
         MVC   GROUPKY(8),MGPGROUP(MGPPTR)                         0253 00501000
*   GRONAME=GKEY;                   /* PUT KEY GROUP REC     @Y30LB26*/ 00502000
         MVC   GRONAME(13,@07),GKEY                                0254 00503000
*   GROGVR=ON;                      /* INDICATE GROUP REC    @Y30LB26*/ 00504000
         OI    GROGVR(@07),B'10000000'                             0255 00505000
*   GROPSPD=MGPRI;                  /* PRI SPACE DEFAULT     @Y30LB26*/ 00506000
         LH    @02,MGPRI(,MGPPTR)                                  0256 00507000
         STH   @02,GROPSPD(,@07)                                   0256 00508000
*   GROSSPD=MGPSEC;                 /* SEC SPACE DEFAULT     @Y30LB26*/ 00509000
         LH    @02,MGPSEC(,MGPPTR)                                 0257 00510000
         STH   @02,GROSSPD(,@07)                                   0257 00511000
*                                                                  0258 00512000
*   /*****************************************************************/ 00513000
*   /*                                                               */ 00514000
*   /* OWNER SPECIFIED, FILL IN OWNER FIELD                  @Y30LB26*/ 00515000
*   /*                                                               */ 00516000
*   /*****************************************************************/ 00517000
*                                                                  0258 00518000
*   IF MGPFLOWN=ON                  /* CK OWNER SPECIFIED    @Y30LB26*/ 00519000
*     THEN                                                         0258 00520000
         TM    MGPFLOWN(MGPPTR),B'00010000'                        0258 00521000
         BNO   @RF00258                                            0258 00522000
*     GROOWNER=MGPOWNER;            /* SET OWNER             @Y30LB26*/ 00523000
         MVC   GROOWNER(10,@07),MGPOWNER(MGPPTR)                   0259 00524000
*   ELSE                            /*                       @Y30LB26*/ 00525000
*     GROOWNER=BLANK;               /* BLANK OWNER           @Y30LB26*/ 00526000
         B     @RC00258                                            0260 00527000
@RF00258 L     @07,GROUPPTR                                        0260 00528000
         MVI   GROOWNER+1(@07),C' '                                0260 00529000
         MVC   GROOWNER+2(8,@07),GROOWNER+1(@07)                   0260 00530000
         MVI   GROOWNER(@07),C' '                                  0260 00531000
*                                                                  0261 00532000
*   /*****************************************************************/ 00533000
*   /*                                                               */ 00534000
*   /* IF THRESHOLD PERCENT SPECIFIED, FILL IN               @Y30LB26*/ 00535000
*   /*                                                               */ 00536000
*   /*****************************************************************/ 00537000
*                                                                  0261 00538000
*   IF MGPFLTHO=ON                  /* THRESH PCENT SPEC ?   @Y30LB26*/ 00539000
*     THEN                                                         0261 00540000
@RC00258 TM    MGPFLTHO(MGPPTR),B'00000010'                        0261 00541000
         BNO   @RF00261                                            0261 00542000
*     GROPCENT=MGPTHOLD;            /* SET PERCENT           @Y30LB26*/ 00543000
         L     @07,GROUPPTR                                        0262 00544000
         MVC   GROPCENT(1,@07),MGPTHOLD(MGPPTR)                    0262 00545000
*                                                                  0263 00546000
*   /*****************************************************************/ 00547000
*   /*                                                               */ 00548000
*   /* CHECK RETENTION PERIOD SPECIFIED                      @Y30LB26*/ 00549000
*   /*                                                               */ 00550000
*   /*****************************************************************/ 00551000
*                                                                  0263 00552000
*   IF MGPFLRET=ON                  /* RETENTION SPEC ?      @Y30LB26*/ 00553000
*     THEN                          /*                       @Y30LB26*/ 00554000
*                                                                  0263 00555000
@RF00261 TM    MGPFLRET(MGPPTR),B'00000001'                        0263 00556000
         BNO   @RF00263                                            0263 00557000
*     /***************************************************************/ 00558000
*     /*                                                             */ 00559000
*     /* INDICATE SPECIFIED AND FILLIN PERIOD                @Y30LB26*/ 00560000
*     /*                                                             */ 00561000
*     /***************************************************************/ 00562000
*                                                                  0264 00563000
*     DO;                           /*                       @Y30LB26*/ 00564000
*       GRORETN=ON;                 /* INDICATE RETN SPEC    @Y30LB26*/ 00565000
         L     @07,GROUPPTR                                        0265 00566000
         OI    GRORETN(@07),B'00000100'                            0265 00567000
*       GRORETPD=MGPRETPD;          /* PUT IN RET PERIOD     @Y30LB26*/ 00568000
         LH    @02,MGPRETPD(,MGPPTR)                               0266 00569000
         ST    @02,GRORETPD(,@07)                                  0266 00570000
*     END;                          /*                       @Y30LB26*/ 00571000
*                                                                  0268 00572000
*   /*****************************************************************/ 00573000
*   /*                                                               */ 00574000
*   /* CHECK CONCURRENT USERS SPECIFIED, IF SO FILL IN       @G24LB37*/ 00575000
*   /*                                                               */ 00576000
*   /*****************************************************************/ 00577000
*                                                                  0268 00578000
*   IF MGPFLCON=ON                  /* CONCUR USERS SPEC ?   @G24LB37*/ 00579000
*     THEN                                                         0268 00580000
@RF00263 TM    MGPFLCON(MGPPTR),B'00000001'                        0268 00581000
         BNO   @RF00268                                            0268 00582000
*     GROCONUS=MGPCONUS;            /* SET CONCUR USERS      @G24LB37*/ 00583000
         L     @07,GROUPPTR                                        0269 00584000
         MVC   GROCONUS(1,@07),MGPCONUS(MGPPTR)                    0269 00585000
*                                                                  0270 00586000
*   /*****************************************************************/ 00587000
*   /*                                                               */ 00588000
*   /* CHECK RESERVED SPACE SPECIFIED, IF SO FILL IN         @G24LB37*/ 00589000
*   /*                                                               */ 00590000
*   /*****************************************************************/ 00591000
*                                                                  0270 00592000
*   IF MGPFLRES=ON                  /* RESERVED SP SPEC ?    @G24LB37*/ 00593000
*     THEN                                                         0270 00594000
@RF00268 TM    MGPFLRES(MGPPTR),B'10000000'                        0270 00595000
         BNO   @RF00270                                            0270 00596000
*     GRORESSP=MGPRESSP;            /* SET RESERVED SPACE    @G24LB37*/ 00597000
         L     @07,GROUPPTR                                        0271 00598000
         MVC   GRORESSP(1,@07),MGPRESSP(MGPPTR)                    0271 00599000
*                                                                  0272 00600000
*   /*****************************************************************/ 00601000
*   /*                                                               */ 00602000
*   /* DESCRIPTION SPECIFIED - FILL IN                       @Y30LB26*/ 00603000
*   /*                                                               */ 00604000
*   /*****************************************************************/ 00605000
*                                                                  0272 00606000
*   IF MGPFLDES=ON                  /* DESCRIPTION SPEC ?    @Y30LB26*/ 00607000
*     THEN                                                         0272 00608000
@RF00270 TM    MGPFLDES(MGPPTR),B'10000000'                        0272 00609000
         BNO   @RF00272                                            0272 00610000
*     GRODESCR=MGPDESCR;            /* PUT VALUE             @Y30LB26*/ 00611000
         L     @07,GROUPPTR                                        0273 00612000
         MVC   GRODESCR(30,@07),MGPDESCR(MGPPTR)                   0273 00613000
*   ELSE                            /*                       @Y30LB26*/ 00614000
*     GRODESCR=BLANK;               /* BLANK DESCRIPTION     @Y30LB26*/ 00615000
         B     @RC00272                                            0274 00616000
@RF00272 L     @07,GROUPPTR                                        0274 00617000
         MVI   GRODESCR+1(@07),C' '                                0274 00618000
         MVC   GRODESCR+2(28,@07),GRODESCR+1(@07)                  0274 00619000
         MVI   GRODESCR(@07),C' '                                  0274 00620000
*                                                                  0275 00621000
*   /*****************************************************************/ 00622000
*   /*                                                               */ 00623000
*   /* ADDRESS SPECIFIED - FILL IN                           @Y30LB26*/ 00624000
*   /*                                                               */ 00625000
*   /*****************************************************************/ 00626000
*                                                                  0275 00627000
*   IF MGPFLADD=ON                  /* ADDRESS SPEC ?        @Y30LB26*/ 00628000
*     THEN                                                         0275 00629000
@RC00272 TM    MGPFLADD(MGPPTR),B'01000000'                        0275 00630000
         BNO   @RF00275                                            0275 00631000
*     GROADDR=MGPADDR;              /* PUT VALUE             @Y30LB26*/ 00632000
         L     @07,GROUPPTR                                        0276 00633000
         MVC   GROADDR(30,@07),MGPADDR(MGPPTR)                     0276 00634000
*   ELSE                            /*                       @Y30LB26*/ 00635000
*     GROADDR=BLANK;                /* BLANK ADDRESS         @Y30LB26*/ 00636000
         B     @RC00275                                            0277 00637000
@RF00275 L     @07,GROUPPTR                                        0277 00638000
         MVI   GROADDR+1(@07),C' '                                 0277 00639000
         MVC   GROADDR+2(28,@07),GROADDR+1(@07)                    0277 00640000
         MVI   GROADDR(@07),C' '                                   0277 00641000
*                                                                  0278 00642000
*   /*****************************************************************/ 00643000
*   /*                                                               */ 00644000
*   /* SET RELEASE ATTRIBUTE                                 @Y30LB26*/ 00645000
*   /*                                                               */ 00646000
*   /*****************************************************************/ 00647000
*                                                                  0278 00648000
*   IF MGPRLSE=ON                   /* RELEASE ATTRIBUTE     @Y30LB26*/ 00649000
*     THEN                                                         0278 00650000
@RC00275 TM    MGPRLSE(MGPPTR),B'10000000'                         0278 00651000
         BNO   @RF00278                                            0278 00652000
*     GRORLSE=ON;                   /*                       @Y30LB26*/ 00653000
         L     @07,GROUPPTR                                        0279 00654000
         OI    GRORLSE(@07),B'00001000'                            0279 00655000
*                                                                  0280 00656000
*   /*****************************************************************/ 00657000
*   /*                                                               */ 00658000
*   /* SET BIND OPTION                                       @Y30LB26*/ 00659000
*   /*                                                               */ 00660000
*   /*****************************************************************/ 00661000
*                                                                  0280 00662000
*   IF MGPBIND=ON                   /* BIND OPTION           @Y30LB26*/ 00663000
*     THEN                                                         0280 00664000
@RF00278 TM    MGPBIND(MGPPTR),B'00100000'                         0280 00665000
         BNO   @RF00280                                            0280 00666000
*     GROBIND=ON;                   /*                       @Y30LB26*/ 00667000
         L     @07,GROUPPTR                                        0281 00668000
         OI    GROBIND(@07),B'10000000'                            0281 00669000
*                                                                  0282 00670000
*   /*****************************************************************/ 00671000
*   /*                                                               */ 00672000
*   /* SET EXCLUSIVE USE FLAG                                @Y30LB26*/ 00673000
*   /*                                                               */ 00674000
*   /*****************************************************************/ 00675000
*                                                                  0282 00676000
*   IF MGPEXCL=ON                   /* EXCLUSIVE USE ?       @Y30LB26*/ 00677000
*     THEN                                                         0282 00678000
@RF00280 TM    MGPEXCL(MGPPTR),B'00001000'                         0282 00679000
         BNO   @RF00282                                            0282 00680000
*     GROEXCL=ON;                   /*                       @Y30LB26*/ 00681000
         L     @07,GROUPPTR                                        0283 00682000
         OI    GROEXCL(@07),B'01000000'                            0283 00683000
*                                                                  0284 00684000
*   /*****************************************************************/ 00685000
*   /*                                                               */ 00686000
*   /* SET READ ONLY FLAG                                    @Y30LB26*/ 00687000
*   /*                                                               */ 00688000
*   /*****************************************************************/ 00689000
*                                                                  0284 00690000
*   IF MGPRONLY=ON                  /* READ ONLY ?           @Y30LB26*/ 00691000
*     THEN                                                         0284 00692000
@RF00282 TM    MGPRONLY(MGPPTR),B'00000010'                        0284 00693000
         BNO   @RF00284                                            0284 00694000
*     GRORONLY=ON;                  /*                       @Y30LB26*/ 00695000
         L     @07,GROUPPTR                                        0285 00696000
         OI    GRORONLY(@07),B'00010000'                           0285 00697000
*                                                                  0286 00698000
*   /*****************************************************************/ 00699000
*   /*                                                               */ 00700000
*   /* SET DASD ERASE FLAG                                   @Y30LB26*/ 00701000
*   /*                                                               */ 00702000
*   /*****************************************************************/ 00703000
*                                                                  0286 00704000
*   IF MGPDERAS=ON                  /* DASD ERASE ?          @Y30LB26*/ 00705000
*     THEN                                                         0286 00706000
@RF00284 TM    MGPDERAS(MGPPTR),B'10000000'                        0286 00707000
         BNO   @RF00286                                            0286 00708000
*     GRODAERA=ON;                  /*                       @Y30LB26*/ 00709000
         L     @02,GROUPPTR                                        0287 00710000
         OI    GRODAERA(@02),B'00100000'                           0287 00711000
*                                                                  0288 00712000
*   /*****************************************************************/ 00713000
*   /*                                                               */ 00714000
*   /* INITILIZE REMAINING FIELDS IN GROUP RECORD            @Y30LB26*/ 00715000
*   /*                                                               */ 00716000
*   /*****************************************************************/ 00717000
*                                                                  0288 00718000
*   GROERRTS=BLANK;                 /* BLANK ERROR TIME STP  @Y30LB26*/ 00719000
@RF00286 L     @02,GROUPPTR                                        0288 00720000
         MVI   GROERRTS+1(@02),C' '                                0288 00721000
         MVC   GROERRTS+2(6,@02),GROERRTS+1(@02)                   0288 00722000
         MVI   GROERRTS(@02),C' '                                  0288 00723000
*   GROFSN=BLANK;                   /* FIRST VOL REC         @Y30LB26*/ 00724000
         MVI   GROFSN+1(@02),C' '                                  0289 00725000
         MVC   GROFSN+2(4,@02),GROFSN+1(@02)                       0289 00726000
         MVI   GROFSN(@02),C' '                                    0289 00727000
*   GROLSN=BLANK;                   /* LAST VOL SER          @Y30LB26*/ 00728000
         MVI   GROLSN+1(@02),C' '                                  0290 00729000
         MVC   GROLSN+2(4,@02),GROLSN+1(@02)                       0290 00730000
         MVI   GROLSN(@02),C' '                                    0290 00731000
*                                                                  0291 00732000
*   /*****************************************************************/ 00733000
*   /*                                                               */ 00734000
*   /* SET UP AND WRITE GROUP RECORD                         @Y30LB26*/ 00735000
*   /*                                                               */ 00736000
*   /*****************************************************************/ 00737000
*                                                                  0291 00738000
*   RPLVBUF=GROUPPTR;               /* ADDR RECORD TO PUT    @Y30LB26*/ 00739000
         L     @15,RPLVPTR                                         0291 00740000
         ST    @02,RPLVBUF(,@15)                                   0291 00741000
*   RPLVRLN=LENGTH(GROUP);          /* LENGTH RECORD         @Y30LB26*/ 00742000
         MVC   RPLVRLN(4,@15),@CF01146                             0292 00743000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH BUFFER         @Y30LB26*/ 00744000
         MVC   RPLVBLN(4,@15),@CF01147                             0293 00745000
*   RPLVTYP=RPLVPUT;                /* PUT GROUP RECORD      @Y30LB26*/ 00746000
         MVI   RPLVTYP(@15),X'01'                                  0294 00747000
*   RESPECIFY                                                      0295 00748000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 00749000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 00750000
         LR    REG1,@15                                            0296 00751000
*   CALL ICBVIO00;                  /* WRITE RECORD          @Y30LB26*/ 00752000
         L     @15,@CV00671                                        0297 00753000
         BALR  @14,@15                                             0297 00754000
*   RESPECIFY                                                      0298 00755000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 00756000
*                                                                  0298 00757000
*   /*****************************************************************/ 00758000
*   /*                                                               */ 00759000
*   /* CHECK RETURN CODE FROM I/O PROCESSOR                  @Y30LB26*/ 00760000
*   /*                                                               */ 00761000
*   /*****************************************************************/ 00762000
*                                                                  0299 00763000
*   IF RPLVRETC¬=RCZERO             /* CK RETURN CODE        @Y30LB26*/ 00764000
*     THEN                          /*                       @Y30LB26*/ 00765000
         L     @02,RPLVPTR                                         0299 00766000
         CLC   RPLVRETC(2,@02),@CB00747                            0299 00767000
         BE    @RF00299                                            0299 00768000
*     DO;                           /*                       @Y30LB26*/ 00769000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 00770000
         BAL   @14,ERREXIT                                         0301 00771000
*       RETURN;                     /*                       @Y30LB26*/ 00772000
@EL00002 DS    0H                                                  0302 00773000
@EF00002 DS    0H                                                  0302 00774000
@ER00002 L     @14,@SA00002                                        0302 00775000
         BR    @14                                                 0302 00776000
*     END;                          /*                       @Y30LB26*/ 00777000
*                                                                  0304 00778000
*   /*****************************************************************/ 00779000
*   /*                                                               */ 00780000
*   /* SINCE WRITE OF GROUP RECORD SUCCESSFUL,               @Y30LB26*/ 00781000
*   /* GO JOURNAL REQUEST BLOCK                              @Y30LB26*/ 00782000
*   /*                                                               */ 00783000
*   /*****************************************************************/ 00784000
*                                                                  0304 00785000
*   CALL JOURNAL;                   /* JOURNAL REQUEST BLK   @Y30LB26*/ 00786000
@RF00299 BAL   @14,JOURNAL                                         0304 00787000
*   RETURN;                         /*                       @Y30LB26*/ 00788000
         B     @EL00002                                            0305 00789000
*   END CREATEG;                    /*                       @Y30LB26*/ 00790000
         B     @EL00002                                            0306 00791000
*                                                                  0307 00792000
*   /*****************************************************************/ 00793000
*   /*                                                               */ 00794000
*   /* THIS ROUTINE CHECKS TO SEE IF ALL CHARACTERS IN       @Y30LB26*/ 00795000
*   /* THE GROUP NAME ARE VALID                              @Y30LB26*/ 00796000
*   /*                                                               */ 00797000
*   /*****************************************************************/ 00798000
*                                                                  0307 00799000
*VALGPNAM:                                                         0307 00800000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 00801000
*                                                                  0307 00802000
VALGPNAM ST    @14,@SA00003                                        0307 00803000
*   /*****************************************************************/ 00804000
*   /*                                                               */ 00805000
*   /* TRANSLATE & TEST VVGRP TABLE                          @Y30LB26*/ 00806000
*   /*                                                               */ 00807000
*   /*****************************************************************/ 00808000
*                                                                  0308 00809000
*   DCL                                                            0308 00810000
*     1 TEST1 CHAR(256),            /*                       @Y30LB26*/ 00811000
*      2 TESTINIT(256) CHAR(1) INIT((64)'01'X,'00'X,/*       @Y30LB26*/ 00812000
*            (26)'01'X,'00'X,(31)'01'X,(2)'00'X,/*           @Y30LB26*/ 00813000
*            (68)'01'X,(9)'00'X,(7)'01'X,(9)'00'X,(8)'01'X,/*      0308 00814000
*                                                            @Y30LB26*/ 00815000
*            (8)'00'X,(6)'01'X,(10)'00'X,(6)'01'X);/*        @Y30LB26*/ 00816000
*                                                                  0309 00817000
*   /*****************************************************************/ 00818000
*   /*                                                               */ 00819000
*   /* CHECK TO SEE IF FIRST CHAR ID BLANK OR IF THERE ARE   @Y30LB26*/ 00820000
*   /* ANY IMBEDDED BLANKS                                   @Y30LB26*/ 00821000
*   /*                                                               */ 00822000
*   /*****************************************************************/ 00823000
*                                                                  0309 00824000
*   DO I=1 TO 8;                    /*                       @Y30LB26*/ 00825000
         LA    @07,1                                               0309 00826000
         STC   @07,I                                               0309 00827000
@DL00309 DS    0H                                                  0310 00828000
*     IF MGPGROUP(I)=BLANK THEN     /* TEST FOR BLANK        @Y30LB26*/ 00829000
         ALR   @07,MGPPTR                                          0310 00830000
         CLI   MGPGROUP-1(@07),C' '                                0310 00831000
         BNE   @RF00310                                            0310 00832000
*       DO;                         /*                       @Y30LB26*/ 00833000
*                                                                  0311 00834000
*         /***********************************************************/ 00835000
*         /*                                                         */ 00836000
*         /* FIRST CHARACTER CAN NOT BE BLANK                @Y30LB26*/ 00837000
*         /*                                                         */ 00838000
*         /***********************************************************/ 00839000
*                                                                  0312 00840000
*         IF I=ONE THEN             /* FIRST CHAR BLK ERROR  @Y30LB26*/ 00841000
         CLI   I,1                                                 0312 00842000
         BNE   @RF00312                                            0312 00843000
*           DO;                     /*                       @Y30LB26*/ 00844000
*             RPLVRETC=FOUR;        /* SET BAD RET CODE      @Y30LB26*/ 00845000
         L     @07,RPLVPTR                                         0314 00846000
         MVC   RPLVRETC(2,@07),@CB00749                            0314 00847000
*             RPLRCODE=INVALGP;     /* INVALID GRP NAME      @Y30LB26*/ 00848000
         MVC   RPLRCODE(2,@07),@CB00823                            0315 00849000
*             CALL ERREXIT;         /* SAVE RET CODES        @Y30LB26*/ 00850000
         BAL   @14,ERREXIT                                         0316 00851000
*             RETURN;               /*                       @Y30LB26*/ 00852000
@EL00003 DS    0H                                                  0317 00853000
@EF00003 DS    0H                                                  0317 00854000
@ER00003 L     @14,@SA00003                                        0317 00855000
         BR    @14                                                 0317 00856000
*           END;                    /*                       @Y30LB26*/ 00857000
*                                                                  0318 00858000
*         /***********************************************************/ 00859000
*         /*                                                         */ 00860000
*         /* IF NOT THE LAST CHARACTER IN GROUP NAME,        @Y30LB26*/ 00861000
*         /* CHECK FOR IMBEDDED BLANKS                       @Y30LB26*/ 00862000
*         /*                                                         */ 00863000
*         /***********************************************************/ 00864000
*                                                                  0319 00865000
*         IF I<8 THEN               /* INSURE NOT LAST CHAR  @Y30LB26*/ 00866000
@RF00312 CLI   I,8                                                 0319 00867000
         BNL   @RF00319                                            0319 00868000
*           DO;                     /*                       @Y30LB26*/ 00869000
*             IF MGPGROUP(I+1:8)¬=BLANK8(I+1:8) THEN/*       @Y30LB26*/ 00870000
         SLR   @07,@07                                             0321 00871000
         IC    @07,I                                               0321 00872000
         LA    @02,7                                               0321 00873000
         SLR   @02,@07                                             0321 00874000
         ST    @07,@TF00001                                        0321 00875000
         ALR   @07,MGPPTR                                          0321 00876000
         L     @01,@TF00001                                        0321 00877000
         LA    @15,BLANK8(@01)                                     0321 00878000
         EX    @02,@SC01176                                        0321 00879000
         BE    @RF00321                                            0321 00880000
*               DO;                 /*                       @Y30LB26*/ 00881000
*                 RPLVRETC=FOUR;    /* BAD RETURN CODE       @Y30LB26*/ 00882000
         L     @07,RPLVPTR                                         0323 00883000
         MVC   RPLVRETC(2,@07),@CB00749                            0323 00884000
*                 RPLRCODE=INVALGP; /* INVAL GRP NAME        @Y30LB26*/ 00885000
         MVC   RPLRCODE(2,@07),@CB00823                            0324 00886000
*                 CALL ERREXIT;     /* RLSE INVENTORY        @Y30LB26*/ 00887000
         BAL   @14,ERREXIT                                         0325 00888000
*                 RETURN;           /*                       @Y30LB26*/ 00889000
         B     @EL00003                                            0326 00890000
*               END;                /*                       @Y30LB26*/ 00891000
*           END;                    /*                       @Y30LB26*/ 00892000
@RF00321 DS    0H                                                  0329 00893000
*       END;                        /*                       @Y30LB26*/ 00894000
@RF00319 DS    0H                                                  0330 00895000
*   END;                            /*                       @Y30LB26*/ 00896000
@RF00310 LA    @07,1                                               0330 00897000
         SLR   @02,@02                                             0330 00898000
         IC    @02,I                                               0330 00899000
         ALR   @07,@02                                             0330 00900000
         STC   @07,I                                               0330 00901000
         C     @07,@CF00036                                        0330 00902000
         BNH   @DL00309                                            0330 00903000
*   RESPECIFY                                                      0331 00904000
*     REG2 RSTD;                    /* RESTRICT REG 15       @Y30LB26*/ 00905000
*                                                                  0331 00906000
*   /*****************************************************************/ 00907000
*   /*                                                               */ 00908000
*   /* ZERO REG 2 FOR TRT INSTRUCTION                        @Y30LB26*/ 00909000
*   /*                                                               */ 00910000
*   /*****************************************************************/ 00911000
*                                                                  0332 00912000
*   REG2=ZERO;                      /* ZERO REG 2            @Y30LB26*/ 00913000
*                                                                  0332 00914000
         SLR   REG2,REG2                                           0332 00915000
*   /*****************************************************************/ 00916000
*   /*                                                               */ 00917000
*   /* CHECK FOR INVALID SPECIAL CHARACTERS IN GROUP NAME    @Y30LB26*/ 00918000
*   /*                                                               */ 00919000
*   /*****************************************************************/ 00920000
*                                                                  0333 00921000
*   TRT(MGPGROUP,TEST1);            /* TEST FOR SPEC CHAR    @Y30LB26*/ 00922000
         TRT   MGPGROUP(8,MGPPTR),TEST1                            0333 00923000
*   IF REG2¬=ZERO THEN              /*                       @Y30LB26*/ 00924000
*                                                                  0334 00925000
         LTR   REG2,REG2                                           0334 00926000
         BZ    @RF00334                                            0334 00927000
*     /***************************************************************/ 00928000
*     /*                                                             */ 00929000
*     /* IF INVALID CHARACTERS, SET REASON CODE AND RETURN   @Y30LB26*/ 00930000
*     /*                                                             */ 00931000
*     /***************************************************************/ 00932000
*                                                                  0335 00933000
*     DO;                           /*                       @Y30LB26*/ 00934000
*       RPLVRETC=FOUR;              /* BAD RET CODE          @Y30LB26*/ 00935000
         L     @07,RPLVPTR                                         0336 00936000
         MVC   RPLVRETC(2,@07),@CB00749                            0336 00937000
*       RPLRCODE=INVALGP;           /* INVALID GROUP NAME    @Y30LB26*/ 00938000
         MVC   RPLRCODE(2,@07),@CB00823                            0337 00939000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 00940000
         BAL   @14,ERREXIT                                         0338 00941000
*       RETURN;                     /*                       @Y30LB26*/ 00942000
         B     @EL00003                                            0339 00943000
*     END;                          /*                       @Y30LB26*/ 00944000
*   ELSE                            /*                       @Y30LB26*/ 00945000
*                                                                  0341 00946000
*     /***************************************************************/ 00947000
*     /*                                                             */ 00948000
*     /* OTHERWISE SET GOOD REASON CODE AND RETURN           @Y30LB26*/ 00949000
*     /*                                                             */ 00950000
*     /***************************************************************/ 00951000
*                                                                  0341 00952000
*     DO;                           /*                       @Y30LB26*/ 00953000
@RF00334 DS    0H                                                  0342 00954000
*       RPLVRETC=RCZERO;            /* GOOD RET CODE         @Y30LB26*/ 00955000
         L     @07,RPLVPTR                                         0342 00956000
         MVC   RPLVRETC(2,@07),@CB00747                            0342 00957000
*       RPLRCODE=RCZERO;            /* ALL GOOD CHARACTERS   @Y30LB26*/ 00958000
         MVC   RPLRCODE(2,@07),@CB00747                            0343 00959000
*       RETURN;                     /*                       @Y30LB26*/ 00960000
         B     @EL00003                                            0344 00961000
*     END;                          /*                       @Y30LB26*/ 00962000
*   RESPECIFY                                                      0346 00963000
*     REG2 UNRSTD;                  /* FREE REG 15           @Y30LB26*/ 00964000
*   END VALGPNAM;                   /* END CREATE GRP ROUTIN @Y30LB26*/ 00965000
*                                                                  0348 00966000
*/*  START OF SPECIFICATIONS ****                                  0348 00967000
*                                                                  0348 00968000
*    PROCEDURE NAME - MODIFYG                                 @Y30LB26  00969000
*                                                                  0348 00970000
*    FUNCTION - THIS PROGRAM MODIFIES AN EXISTING GROUP RECORD.    0348 00971000
*    IT CAN CHANGE BOTH PRIMARY AND SECONDARY DEFAULT SPACE,       0348 00972000
*    CHANGE THE GROUP OWNER, UPDATE DESCRIPTION AND ADDRESS        0348 00973000
*    FIELD.  THIS PROCEDURE WILL, ALSO, MODIFY THE EXISTING        0348 00974000
*    NUMBER OF CONCURRENT ALLOCATIONS AND/OR THE AMOUNT OF         0348 00975000
*    RESERVED SPACE FOR A VOLUME WITHIN A GROUP, IF SPECIFIED.     0348 00976000
*    WHEN THE NUMBER OF CONCURRENT USERS IS CHANGED FROM           0348 00977000
*    ZERO TO A NONZERO VALUE FOR A GROUP OTHER THAN SYSGROUP,      0348 00978000
*    MODIFYG CONSIDERS THIS A CONVERSION FOR THAT GROUP FROM       0348 00979000
*    EARLIER VERSION OF MSS SUPPORT TO MSS RELEASE 3. IF THE       0348 00980000
*    GROUP THRESHOLD IS CHANGED, MODIFYG WILL RECALCULATE          0348 00981000
*    THE GROUP SPACE THRESHOLD BY MULTIPLING THE NUMBER OF         0348 00982000
*    GENERAL USE VOLUMES IN THE GROUP BY 404 AND THEN MULTIPLING   0348 00983000
*    THIS BY THE GROUP THRESHOLD PERCENT.   ALSO IF NULLIFY RETENTION   00984000
*    IS SPECIFIED, THE PROGRAM GOES THRU ALL THE BASE VOLUME RECORDS,   00985000
*    AND FOR THE GENERAL USE VOLUMES THE EXPIRATION DATE IS NULLIFIED.  00986000
*    THE MSS MOUNT ATTRIBUTES CAN BE CHANGED.  THE NULLIFY         0348 00987000
*    OPERATIONS OVER-RIDE ANY PARAMETER SPECIFICATION.             0348 00988000
*    THE PROGRAM NULLIFIES THE FIELDS SPECIFIED BY THE             0348 00989000
*    REQUEST BLOCK.  THE RPLV IS JOURNALED AFTER THE GROUP RECORD IS    00990000
*    SUCCESSFULLY WRITTEN.                                    @G24LB37  00991000
*                                                                  0348 00992000
*    FOR GROUP CONVERSION TO MSS RELEASE 3, MODIFYG READS          0348 00993000
*    ALL OF THE GROUP EXTENSION RECORDS FOR THAT GROUP,            0348 00994000
*    AND FOR EACH VOLUME SHOWN IN A GROUP EXTENSION RECORD,        0348 00995000
*    MOVES THE FREE SPACE FROM THE BASE VOLUME RECORD INTO         0348 00996000
*    THE GVSNE, AND TURNS OFF THE HOST NON-SHARE AND INVALID       0348 00997000
*    RUNNING COUNT FIELDS, UNLESS THE BASE VOLUME RECORD           0348 00998000
*    INDICATED THAT THE VOLUME IS MOUNTED TO SOME HOST OR          0348 00999000
*    THAT ITS SPACE IS DOWN LEVEL.                            @G24LB04  01000000
*                                                                  0348 01001000
*      INPUTS - REGISTER 1 CONTAINS THE ADDRESS OF THE RPLV.  THIS HAS  01002000
*      ALL THE INFORMATION NEEDED TO MODIFY THE GROUP RECORD. @Y30LB26  01003000
*                                                                  0348 01004000
*      OUTPUTS - REASON CODE AND RETURN CODE IN RPLV.         @Y30LB26  01005000
*                                                                  0348 01006000
*       '021B'X  I/O ERROR OCCURED BUT RPLV WAS JOURNALED.    @Y30LB26  01007000
*       ALSO ANY RETURN CODE PUT OUT BY THE I/O PROCESSOR OR THE   0348 01008000
*       JOURNALING PROGRAM.                                   @Y30LB26  01009000
**** END OF SPECIFICATIONS **                                        */ 01010000
*                                                                  0348 01011000
*MODIFYG:                                                          0348 01012000
*   PROC OPTIONS(SAVEAREA);         /*                       #Y30LB26*/ 01013000
MODIFYG  STM   @14,@12,12(@13)                                     0348 01014000
         ST    @13,@SA00004+4                                      0348 01015000
         LA    @14,@SA00004                                        0348 01016000
         ST    @14,8(,@13)                                         0348 01017000
         LR    @13,@14                                             0348 01018000
*                                                                  0349 01019000
*   /*****************************************************************/ 01020000
*   /*                                                               */ 01021000
*   /* CONSTANTS USED IN ARITHMETIC CALCULATIONS             #Y30LB26*/ 01022000
*   /*                                                               */ 01023000
*   /*****************************************************************/ 01024000
*                                                                  0349 01025000
*   DCL                                                            0349 01026000
*     CYLS FIXED(15) CONSTANT(404); /* CALC THRS CYLS        @Y30LB26*/ 01027000
*   DCL                                                            0350 01028000
*     HUNDRED FIXED(15) CONSTANT(100);/* DIVISOR             @Y30LB26*/ 01029000
*                                                                  0351 01030000
*   /*****************************************************************/ 01031000
*   /*                                                               */ 01032000
*   /* SET UP ADDRESSABILITY TO REQUEST BLOCK                @G24LB04*/ 01033000
*   /*                                                               */ 01034000
*   /*****************************************************************/ 01035000
*                                                                  0351 01036000
*   MGPPTR=ADDR(RPLVUTIL);          /* PTR TO REQUEST BLK    @Y30LB26*/ 01037000
         L     MGPPTR,RPLVPTR                                      0351 01038000
         LA    MGPPTR,RPLVUTIL(,MGPPTR)                            0351 01039000
*                                                                  0352 01040000
*   /*****************************************************************/ 01041000
*   /*                                                               */ 01042000
*   /* RESERVE INVENTORY                                     @Y30LB26*/ 01043000
*   /*                                                               */ 01044000
*   /*****************************************************************/ 01045000
*                                                                  0352 01046000
*   CALL RESERINV;                  /* GO RESERVE INVENTY    @Y30LB26*/ 01047000
         BAL   @14,RESERINV                                        0352 01048000
*                                                                  0353 01049000
*   /*****************************************************************/ 01050000
*   /*                                                               */ 01051000
*   /* READ GROUP RECORD                                     @Y30LB26*/ 01052000
*   /*                                                               */ 01053000
*   /*****************************************************************/ 01054000
*                                                                  0353 01055000
*   GROUPKY=MGPGROUP;               /* PUT GROUP NM IN KEY   @Y30LB26*/ 01056000
         MVC   GROUPKY(8),MGPGROUP(MGPPTR)                         0353 01057000
*   RPLVKEY=ADDR(GKEY);             /* SET VSAM RB TO REC    @Y30LB26*/ 01058000
         L     @07,RPLVPTR                                         0354 01059000
         LA    @02,GKEY                                            0354 01060000
         ST    @02,RPLVKEY(,@07)                                   0354 01061000
*   RPLVBUF=ADDR(STORGRP);          /* ADDR OF BUFFER        @Y30LB26*/ 01062000
         LA    @02,STORGRP                                         0355 01063000
         ST    @02,RPLVBUF(,@07)                                   0355 01064000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH BUFFER         @Y30LB26*/ 01065000
         MVC   RPLVBLN(4,@07),@CF01147                             0356 01066000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 01067000
         OI    RPLVDIR(@07),B'01000000'                            0357 01068000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB26*/ 01069000
         MVI   RPLVTYP(@07),X'00'                                  0358 01070000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       @Y30LB26*/ 01071000
         OI    RPLVUPD(@07),B'00000010'                            0359 01072000
*   RESPECIFY                                                      0360 01073000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 01074000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 01075000
         LR    REG1,@07                                            0361 01076000
*   CALL ICBVIO00;                  /* READ DIRECT FOR REC   @Y30LB26*/ 01077000
         L     @15,@CV00671                                        0362 01078000
         BALR  @14,@15                                             0362 01079000
*   RESPECIFY                                                      0363 01080000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 01081000
*                                                                  0363 01082000
*   /*****************************************************************/ 01083000
*   /*                                                               */ 01084000
*   /* CHECK FOR BAD RETURN CODE                             @Y30LB26*/ 01085000
*   /*                                                               */ 01086000
*   /*****************************************************************/ 01087000
*                                                                  0364 01088000
*   IF RPLVRETC¬=RCZERO             /* CK RETURN             @Y30LB26*/ 01089000
*     THEN                          /*                       @Y30LB26*/ 01090000
*                                                                  0364 01091000
         L     @07,RPLVPTR                                         0364 01092000
         CLC   RPLVRETC(2,@07),@CB00747                            0364 01093000
         BE    @RF00364                                            0364 01094000
*     /***************************************************************/ 01095000
*     /*                                                             */ 01096000
*     /* IF BAD, SAVE CODES AND RETURN                       @Y30LB26*/ 01097000
*     /*                                                             */ 01098000
*     /***************************************************************/ 01099000
*                                                                  0365 01100000
*     DO;                           /*                       @Y30LB26*/ 01101000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 01102000
         BAL   @14,ERREXIT                                         0366 01103000
*       RETURN;                     /*                       @Y30LB26*/ 01104000
@EL00004 L     @13,4(,@13)                                         0367 01105000
@EF00004 DS    0H                                                  0367 01106000
@ER00004 LM    @14,@12,12(@13)                                     0367 01107000
         BR    @14                                                 0367 01108000
*     END;                          /*                       @Y30LB26*/ 01109000
*                                                                  0369 01110000
*   /*****************************************************************/ 01111000
*   /*                                                               */ 01112000
*   /* SET PTR TO IT                                         @Y30LB26*/ 01113000
*   /*                                                               */ 01114000
*   /*****************************************************************/ 01115000
*                                                                  0369 01116000
*   GROUPPTR=ADDR(STORGRP);         /* ADDR WORKING COPY     @Y30LB26*/ 01117000
@RF00364 LA    @07,STORGRP                                         0369 01118000
         ST    @07,GROUPPTR                                        0369 01119000
*   REL3CONF=OFF;                   /* NOT CONVERTING TO     @G24LB04   01120000
*                                      R3 AS YET             @G24LB04*/ 01121000
*                                                                  0370 01122000
         NI    REL3CONF,B'11111101'                                0370 01123000
*   /*****************************************************************/ 01124000
*   /*                                                               */ 01125000
*   /* IF CONCURRENT USERS SPECIFIED, FILL IN AND            @G24LB04*/ 01126000
*   /* CHECK FOR CONVERSION TO MSS RELEASE 3                 @G24LB04*/ 01127000
*   /*                                                               */ 01128000
*   /*****************************************************************/ 01129000
*                                                                  0371 01130000
*   IF MGPFLCON=ON                  /*                       @G24LB04*/ 01131000
*     THEN                          /* CONCURRENT USERS IS   @G24LB04   01132000
*                                      SPECIFIED             @G24LB04*/ 01133000
         TM    MGPFLCON(MGPPTR),B'00000001'                        0371 01134000
         BNO   @RF00371                                            0371 01135000
*     DO;                           /*                       @G24LB04*/ 01136000
*       IF GROCONUS=FIXZERO&GROVVGRP¬=SYSGROUP/*             @G24LB04*/ 01137000
*           &MGPCONUS¬=BIT8ZERO     /* PREVIOUS VALUE ZERO?  @G24LB04*/ 01138000
*         THEN                      /* MUST CONVERT TO MSS   @G24LB04   01139000
*                                      RELEASE 3             @G24LB04*/ 01140000
         CLI   GROCONUS(@07),0                                     0373 01141000
         BNE   @RF00373                                            0373 01142000
         CLC   GROVVGRP(8,@07),SYSGROUP                            0373 01143000
         BE    @RF00373                                            0373 01144000
         CLI   MGPCONUS(MGPPTR),0                                  0373 01145000
         BE    @RF00373                                            0373 01146000
*         REL3CONF=ON;              /* FLAG TO DO LATER      @G24LB04*/ 01147000
         OI    REL3CONF,B'00000010'                                0374 01148000
*       GROCONUS=MGPCONUS;          /* NEW CONCUR USER DEF   @G24LB37*/ 01149000
@RF00373 L     @07,GROUPPTR                                        0375 01150000
         MVC   GROCONUS(1,@07),MGPCONUS(MGPPTR)                    0375 01151000
*     END;                          /*                       @G24LB04*/ 01152000
*                                                                  0377 01153000
*   /*****************************************************************/ 01154000
*   /*                                                               */ 01155000
*   /* IF OWNER SPECIFIED, MODIFY FIELD                      #Y30LB26*/ 01156000
*   /*                                                               */ 01157000
*   /*****************************************************************/ 01158000
*                                                                  0377 01159000
*   IF MGPFLOWN=ON                  /* CK OWNER SPEC ?       #Y30LB26*/ 01160000
*     THEN                                                         0377 01161000
@RF00371 TM    MGPFLOWN(MGPPTR),B'00010000'                        0377 01162000
         BNO   @RF00377                                            0377 01163000
*     GROOWNER=MGPOWNER;            /* MOVE IN NEW OWNER     @Y30LB26*/ 01164000
         L     @07,GROUPPTR                                        0378 01165000
         MVC   GROOWNER(10,@07),MGPOWNER(MGPPTR)                   0378 01166000
*                                                                  0379 01167000
*   /*****************************************************************/ 01168000
*   /*                                                               */ 01169000
*   /* IF PRIMARY SPACE CHANGED, CHANGE IT                   @Y30LB26*/ 01170000
*   /*                                                               */ 01171000
*   /*****************************************************************/ 01172000
*                                                                  0379 01173000
*   IF MGPFLPRI=ON                  /* CK PRIMARY SP SPEC    @Y30LB26*/ 01174000
*     THEN                                                         0379 01175000
@RF00377 TM    MGPFLPRI(MGPPTR),B'00001000'                        0379 01176000
         BNO   @RF00379                                            0379 01177000
*     GROPSPD=MGPRI;                /* NEW PRI SPACE DEF     @Y30LB26*/ 01178000
         LH    @07,MGPRI(,MGPPTR)                                  0380 01179000
         L     @02,GROUPPTR                                        0380 01180000
         STH   @07,GROPSPD(,@02)                                   0380 01181000
*                                                                  0381 01182000
*   /*****************************************************************/ 01183000
*   /*                                                               */ 01184000
*   /* IF RESERVED SPACE CHANGED, CHANGE IT                  @G24LB37*/ 01185000
*   /*                                                               */ 01186000
*   /*****************************************************************/ 01187000
*                                                                  0381 01188000
*   IF MGPFLRES=ON                  /* RESERVED SPACE        @G24LB04   01189000
*                                      SPECIFIED ?           @G24LB04*/ 01190000
*     THEN                          /*                       @G24LB04*/ 01191000
@RF00379 TM    MGPFLRES(MGPPTR),B'10000000'                        0381 01192000
         BNO   @RF00381                                            0381 01193000
*     GRORESSP=MGPRESSP;            /* PERCENT RESERVED      @G24LB37*/ 01194000
         L     @07,GROUPPTR                                        0382 01195000
         MVC   GRORESSP(1,@07),MGPRESSP(MGPPTR)                    0382 01196000
*   ELSE                                                           0383 01197000
*     IF REL3CONF=ON THEN           /* CONV TO R3 LEVEL?     @G24LB04*/ 01198000
         B     @RC00381                                            0383 01199000
@RF00381 TM    REL3CONF,B'00000010'                                0383 01200000
         BNO   @RF00383                                            0383 01201000
*       GRORESSP=DEFRESSP;          /* PROVIDE DEFAULT       @G24LB04*/ 01202000
         L     @07,GROUPPTR                                        0384 01203000
         MVI   GRORESSP(@07),X'28'                                 0384 01204000
*                                                                  0385 01205000
*   /*****************************************************************/ 01206000
*   /*                                                               */ 01207000
*   /* UPDATE SECONDARY SPACE DEFAULT IF REQUIRED            #Y30LB26*/ 01208000
*   /*                                                               */ 01209000
*   /*****************************************************************/ 01210000
*                                                                  0385 01211000
*   IF MGPFLSEC=ON                  /* CK SEC SPACE SPEC     @Y30LB26*/ 01212000
*     THEN                                                         0385 01213000
@RF00383 DS    0H                                                  0385 01214000
@RC00381 TM    MGPFLSEC(MGPPTR),B'00000100'                        0385 01215000
         BNO   @RF00385                                            0385 01216000
*     GROSSPD=MGPSEC;               /* NEW SEC SPACE         @Y30LB26*/ 01217000
         LH    @07,MGPSEC(,MGPPTR)                                 0386 01218000
         L     @02,GROUPPTR                                        0386 01219000
         STH   @07,GROSSPD(,@02)                                   0386 01220000
*                                                                  0387 01221000
*   /*****************************************************************/ 01222000
*   /*                                                               */ 01223000
*   /* CHECK THRESHOLD PERCENT SPECIFIED                     @Y30LB26*/ 01224000
*   /*                                                               */ 01225000
*   /*****************************************************************/ 01226000
*                                                                  0387 01227000
*   IF MGPFLTHO=ON                  /* THRESHOLD SPEC        @Y30LB26*/ 01228000
*     THEN                          /*                       @Y30LB26*/ 01229000
*                                                                  0387 01230000
@RF00385 TM    MGPFLTHO(MGPPTR),B'00000010'                        0387 01231000
         BNO   @RF00387                                            0387 01232000
*     /***************************************************************/ 01233000
*     /*                                                             */ 01234000
*     /* IF SPECIFIED, UPDATE AND CALCULATE THRESHOLD        @Y30LB26*/ 01235000
*     /* SPACE                                               @Y30LB26*/ 01236000
*     /*                                                             */ 01237000
*     /***************************************************************/ 01238000
*                                                                  0388 01239000
*     DO;                           /*                       @Y30LB26*/ 01240000
*       GROPCENT=MGPTHOLD;          /* NEW PRECENT           @Y30LB26*/ 01241000
         L     @07,GROUPPTR                                        0389 01242000
         SLR   @02,@02                                             0389 01243000
         IC    @02,MGPTHOLD(,MGPPTR)                               0389 01244000
         STC   @02,GROPCENT(,@07)                                  0389 01245000
*       GROSTRSH=(GRONGEN*CYLS*GROPCENT)/HUNDRED;/*          @Y30LB26*/ 01246000
         LH    @01,GRONGEN(,@07)                                   0390 01247000
         MH    @01,@CH00890                                        0390 01248000
         MR    @00,@02                                             0390 01249000
         D     @00,@CF00892                                        0390 01250000
         ST    @01,GROSTRSH(,@07)                                  0390 01251000
*     END;                          /*                       @Y30LB26*/ 01252000
*                                                                  0392 01253000
*   /*****************************************************************/ 01254000
*   /*                                                               */ 01255000
*   /* CHECK IF RETENTION PERIOD SPECIFIED                   @Y30LB26*/ 01256000
*   /*                                                               */ 01257000
*   /*****************************************************************/ 01258000
*                                                                  0392 01259000
*   IF MGPFLRET=ON                  /* CK RETENTION PRD      @Y30LB26*/ 01260000
*     THEN                          /*                       @Y30LB26*/ 01261000
*                                                                  0392 01262000
@RF00387 TM    MGPFLRET(MGPPTR),B'00000001'                        0392 01263000
         BNO   @RF00392                                            0392 01264000
*     /***************************************************************/ 01265000
*     /*                                                             */ 01266000
*     /* INDICATE RETN CHECKING AND UPDATE FIELD             @Y30LB26*/ 01267000
*     /*                                                             */ 01268000
*     /***************************************************************/ 01269000
*                                                                  0393 01270000
*     DO;                           /*                       @Y30LB26*/ 01271000
*       GRORETN=ON;                 /* INDICATE RETEN SPEC   @Y30LB26*/ 01272000
         L     @07,GROUPPTR                                        0394 01273000
         OI    GRORETN(@07),B'00000100'                            0394 01274000
*       GRORETPD=MGPRETPD;          /* NEW RETEN PERIOD      @Y30LB26*/ 01275000
         LH    @02,MGPRETPD(,MGPPTR)                               0395 01276000
         ST    @02,GRORETPD(,@07)                                  0395 01277000
*     END;                          /*                       @Y30LB26*/ 01278000
*                                                                  0397 01279000
*   /*****************************************************************/ 01280000
*   /*                                                               */ 01281000
*   /* IF DESCRIPTION UPDATED, FILL IN UPDATE                @Y30LB26*/ 01282000
*   /*                                                               */ 01283000
*   /*****************************************************************/ 01284000
*                                                                  0397 01285000
*   IF MGPFLDES=ON                  /* DESCRIPTION SPEC ?    @Y30LB26*/ 01286000
*     THEN                                                         0397 01287000
@RF00392 TM    MGPFLDES(MGPPTR),B'10000000'                        0397 01288000
         BNO   @RF00397                                            0397 01289000
*     GRODESCR=MGPDESCR;            /* UPDATE DESCRIPTION    @Y30LB26*/ 01290000
         L     @07,GROUPPTR                                        0398 01291000
         MVC   GRODESCR(30,@07),MGPDESCR(MGPPTR)                   0398 01292000
*                                                                  0399 01293000
*   /*****************************************************************/ 01294000
*   /*                                                               */ 01295000
*   /* NEW ADDRESS IF NEEDED                                 @Y30LB26*/ 01296000
*   /*                                                               */ 01297000
*   /*****************************************************************/ 01298000
*                                                                  0399 01299000
*   IF MGPFLADD=ON                  /* NEW ADDR SPEC ?       @Y30LB26*/ 01300000
*     THEN                                                         0399 01301000
@RF00397 TM    MGPFLADD(MGPPTR),B'01000000'                        0399 01302000
         BNO   @RF00399                                            0399 01303000
*     GROADDR=MGPADDR;              /* UPDATE ADDRESS        @Y30LB26*/ 01304000
         L     @07,GROUPPTR                                        0400 01305000
         MVC   GROADDR(30,@07),MGPADDR(MGPPTR)                     0400 01306000
*                                                                  0401 01307000
*   /*****************************************************************/ 01308000
*   /*                                                               */ 01309000
*   /* SET RELEASE FLAG ON                                   @Y30LB26*/ 01310000
*   /*                                                               */ 01311000
*   /*****************************************************************/ 01312000
*                                                                  0401 01313000
*   IF MGPRLSE=ON                   /* RELEASE SPEC ?        @Y30LB26*/ 01314000
*     THEN                                                         0401 01315000
@RF00399 TM    MGPRLSE(MGPPTR),B'10000000'                         0401 01316000
         BNO   @RF00401                                            0401 01317000
*     GRORLSE=ON;                   /* SET TO RELEASE        @Y30LB26*/ 01318000
         L     @07,GROUPPTR                                        0402 01319000
         OI    GRORLSE(@07),B'00001000'                            0402 01320000
*                                                                  0403 01321000
*   /*****************************************************************/ 01322000
*   /*                                                               */ 01323000
*   /* SET RELEASE FLAG OFF                                  @Y30LB26*/ 01324000
*   /*                                                               */ 01325000
*   /*****************************************************************/ 01326000
*                                                                  0403 01327000
*   IF MGPNRLSE=ON                  /* NO RELEASE SPEC ?     @Y30LB26*/ 01328000
*     THEN                                                         0403 01329000
@RF00401 TM    MGPNRLSE(MGPPTR),B'01000000'                        0403 01330000
         BNO   @RF00403                                            0403 01331000
*     GRORLSE=OFF;                  /* SET FOR NO RELEASE    @Y30LB26*/ 01332000
         L     @07,GROUPPTR                                        0404 01333000
         NI    GRORLSE(@07),B'11110111'                            0404 01334000
*                                                                  0405 01335000
*   /*****************************************************************/ 01336000
*   /*                                                               */ 01337000
*   /* SET BIND FLAG ON                                      @Y30LB26*/ 01338000
*   /*                                                               */ 01339000
*   /*****************************************************************/ 01340000
*                                                                  0405 01341000
*   IF MGPBIND=ON                   /* BIND SPEC ?           @Y30LB26*/ 01342000
*     THEN                                                         0405 01343000
@RF00403 TM    MGPBIND(MGPPTR),B'00100000'                         0405 01344000
         BNO   @RF00405                                            0405 01345000
*     GROBIND=ON;                   /* BIND IT               @Y30LB26*/ 01346000
         L     @07,GROUPPTR                                        0406 01347000
         OI    GROBIND(@07),B'10000000'                            0406 01348000
*                                                                  0407 01349000
*   /*****************************************************************/ 01350000
*   /*                                                               */ 01351000
*   /* SET BIND FLAG OFF                                     @Y30LB26*/ 01352000
*   /*                                                               */ 01353000
*   /*****************************************************************/ 01354000
*                                                                  0407 01355000
*   IF MGPNBIND=ON                  /* NO BIND ?             @Y30LB26*/ 01356000
*     THEN                                                         0407 01357000
@RF00405 TM    MGPNBIND(MGPPTR),B'00010000'                        0407 01358000
         BNO   @RF00407                                            0407 01359000
*     GROBIND=OFF;                  /* NO BIND IT            @Y30LB26*/ 01360000
         L     @07,GROUPPTR                                        0408 01361000
         NI    GROBIND(@07),B'01111111'                            0408 01362000
*                                                                  0409 01363000
*   /*****************************************************************/ 01364000
*   /*                                                               */ 01365000
*   /* SET EXCLUSIVE USE FLAG ON                             @Y30LB26*/ 01366000
*   /*                                                               */ 01367000
*   /*****************************************************************/ 01368000
*                                                                  0409 01369000
*   IF MGPEXCL=ON                   /* EXCLUSIVE ?           @Y30LB26*/ 01370000
*     THEN                                                         0409 01371000
@RF00407 TM    MGPEXCL(MGPPTR),B'00001000'                         0409 01372000
         BNO   @RF00409                                            0409 01373000
*     GROEXCL=ON;                   /* SET EXCLUSIVE USE     @Y30LB26*/ 01374000
         L     @07,GROUPPTR                                        0410 01375000
         OI    GROEXCL(@07),B'01000000'                            0410 01376000
*                                                                  0411 01377000
*   /*****************************************************************/ 01378000
*   /*                                                               */ 01379000
*   /* SET EXCLUSIVE USE FLAG OFF                            @Y30LB26*/ 01380000
*   /*                                                               */ 01381000
*   /*****************************************************************/ 01382000
*                                                                  0411 01383000
*   IF MGPSHARE=ON                  /* SHARE IT              @Y30LB26*/ 01384000
*     THEN                                                         0411 01385000
@RF00409 TM    MGPSHARE(MGPPTR),B'00000100'                        0411 01386000
         BNO   @RF00411                                            0411 01387000
*     GROEXCL=OFF;                  /* SHARED                @Y30LB26*/ 01388000
         L     @07,GROUPPTR                                        0412 01389000
         NI    GROEXCL(@07),B'10111111'                            0412 01390000
*                                                                  0413 01391000
*   /*****************************************************************/ 01392000
*   /*                                                               */ 01393000
*   /* SET READ ONLY FLAG ON                                 @Y30LB26*/ 01394000
*   /*                                                               */ 01395000
*   /*****************************************************************/ 01396000
*                                                                  0413 01397000
*   IF MGPRONLY=ON                  /* READ ONLY ?           @Y30LB26*/ 01398000
*     THEN                                                         0413 01399000
@RF00411 TM    MGPRONLY(MGPPTR),B'00000010'                        0413 01400000
         BNO   @RF00413                                            0413 01401000
*     GRORONLY=ON;                  /* IT IS READ ONLY       @Y30LB26*/ 01402000
         L     @07,GROUPPTR                                        0414 01403000
         OI    GRORONLY(@07),B'00010000'                           0414 01404000
*                                                                  0415 01405000
*   /*****************************************************************/ 01406000
*   /*                                                               */ 01407000
*   /* SET READ ONLY FLAG OFF                                @Y30LB26*/ 01408000
*   /*                                                               */ 01409000
*   /*****************************************************************/ 01410000
*                                                                  0415 01411000
*   IF MGPRW=ON                     /* READ - WRITE ?        @Y30LB26*/ 01412000
*     THEN                                                         0415 01413000
@RF00413 TM    MGPRW(MGPPTR),B'00000001'                           0415 01414000
         BNO   @RF00415                                            0415 01415000
*     GRORONLY=OFF;                 /* READ - WRITE BOTH     @Y30LB26*/ 01416000
         L     @07,GROUPPTR                                        0416 01417000
         NI    GRORONLY(@07),B'11101111'                           0416 01418000
*                                                                  0417 01419000
*   /*****************************************************************/ 01420000
*   /*                                                               */ 01421000
*   /* SET DASD ERASE FLAG ON                                @Y30LB26*/ 01422000
*   /*                                                               */ 01423000
*   /*****************************************************************/ 01424000
*                                                                  0417 01425000
*   IF MGPDERAS=ON                  /* DASD ERASE ?          @Y30LB26*/ 01426000
*     THEN                                                         0417 01427000
@RF00415 TM    MGPDERAS(MGPPTR),B'10000000'                        0417 01428000
         BNO   @RF00417                                            0417 01429000
*     GRODAERA=ON;                  /* ERASE IT              @Y30LB26*/ 01430000
         L     @07,GROUPPTR                                        0418 01431000
         OI    GRODAERA(@07),B'00100000'                           0418 01432000
*                                                                  0419 01433000
*   /*****************************************************************/ 01434000
*   /*                                                               */ 01435000
*   /* SET DASD ERASE FLAG OFF                               @Y30LB26*/ 01436000
*   /*                                                               */ 01437000
*   /*****************************************************************/ 01438000
*                                                                  0419 01439000
*   IF MGPNDERA=ON                  /* NO DASD ERASE ?       @Y30LB26*/ 01440000
*     THEN                                                         0419 01441000
@RF00417 TM    MGPNDERA(MGPPTR),B'01000000'                        0419 01442000
         BNO   @RF00419                                            0419 01443000
*     GRODAERA=OFF;                 /* DO NOT ERASE          @Y30LB26*/ 01444000
         L     @07,GROUPPTR                                        0420 01445000
         NI    GRODAERA(@07),B'11011111'                           0420 01446000
*                                                                  0421 01447000
*   /*****************************************************************/ 01448000
*   /*                                                               */ 01449000
*   /* CHECK IF NULLIFY THRESHOLD FLAG IS ON                 @Y30LB26*/ 01450000
*   /*                                                               */ 01451000
*   /*****************************************************************/ 01452000
*                                                                  0421 01453000
*   IF MGPNTHLD=ON                  /* NULLIFY THRESHOLD ?   @Y30LB26*/ 01454000
*     THEN                          /*                       @Y30LB26*/ 01455000
*                                                                  0421 01456000
@RF00419 TM    MGPNTHLD(MGPPTR),B'00100000'                        0421 01457000
         BNO   @RF00421                                            0421 01458000
*     /***************************************************************/ 01459000
*     /*                                                             */ 01460000
*     /* IF ON, ZERO PERCENT AND THRESHOLD CYLINDERS         @Y30LB26*/ 01461000
*     /*                                                             */ 01462000
*     /***************************************************************/ 01463000
*                                                                  0422 01464000
*     DO;                           /*                       @Y30LB26*/ 01465000
*       GROPCENT=ZERO;              /* NULLIFY PERCENT ?     @Y30LB26*/ 01466000
         L     @07,GROUPPTR                                        0423 01467000
         MVI   GROPCENT(@07),X'00'                                 0423 01468000
*       GROSTRSH=ZERO;              /* ZERO THRESHOLD CYL    @Y30LB26*/ 01469000
         SLR   @02,@02                                             0424 01470000
         ST    @02,GROSTRSH(,@07)                                  0424 01471000
*     END;                          /*                       @Y30LB26*/ 01472000
*                                                                  0426 01473000
*   /*****************************************************************/ 01474000
*   /*                                                               */ 01475000
*   /* NULLIFY OWNER FIELD IF ASKED FOR                      @Y30LB26*/ 01476000
*   /*                                                               */ 01477000
*   /*****************************************************************/ 01478000
*                                                                  0426 01479000
*   IF MGPNOWNR=ON                  /* NULLIFY OWNER ?       @Y30LB26*/ 01480000
*     THEN                                                         0426 01481000
@RF00421 TM    MGPNOWNR(MGPPTR),B'00010000'                        0426 01482000
         BNO   @RF00426                                            0426 01483000
*     GROOWNER=BLANK;               /* NULLIFY OWNER         @Y30LB26*/ 01484000
         L     @07,GROUPPTR                                        0427 01485000
         MVI   GROOWNER+1(@07),C' '                                0427 01486000
         MVC   GROOWNER+2(8,@07),GROOWNER+1(@07)                   0427 01487000
         MVI   GROOWNER(@07),C' '                                  0427 01488000
*                                                                  0428 01489000
*   /*****************************************************************/ 01490000
*   /*                                                               */ 01491000
*   /* CHECK IF NULLIFICATION RETENTION PERIOD REQUIRED      @Y30LB26*/ 01492000
*   /*                                                               */ 01493000
*   /*****************************************************************/ 01494000
*                                                                  0428 01495000
*   IF MGPNRETP=ON                  /* NULLIFY RET PRD ?     @Y30LB26*/ 01496000
*     THEN                          /*                       @Y30LB26*/ 01497000
*                                                                  0428 01498000
@RF00426 TM    MGPNRETP(MGPPTR),B'00001000'                        0428 01499000
         BNO   @RF00428                                            0428 01500000
*     /***************************************************************/ 01501000
*     /*                                                             */ 01502000
*     /* SET RET PERIOD CHECK FLAG OFF, ZERO RET PER         @Y30LB26*/ 01503000
*     /*                                                             */ 01504000
*     /***************************************************************/ 01505000
*                                                                  0429 01506000
*     DO;                           /*                       @Y30LB26*/ 01507000
*       GRORETN=OFF;                /* SET RET PERIOD FLG    @Y30LB26*/ 01508000
         L     @07,GROUPPTR                                        0430 01509000
         NI    GRORETN(@07),B'11111011'                            0430 01510000
*       GRORETPD=ZERO;              /* ZERO OUT RET          @Y30LB26*/ 01511000
         SLR   @02,@02                                             0431 01512000
         ST    @02,GRORETPD(,@07)                                  0431 01513000
*     END;                          /*                       @Y30LB26*/ 01514000
*                                                                  0433 01515000
*   /*****************************************************************/ 01516000
*   /*                                                               */ 01517000
*   /* BLANK DESCRIPTION IF NECESSARY                        @Y30LB26*/ 01518000
*   /*                                                               */ 01519000
*   /*****************************************************************/ 01520000
*                                                                  0433 01521000
*   IF MGPNDESC=ON                  /* NULLIFY DESCR ?       @Y30LB26*/ 01522000
*     THEN                                                         0433 01523000
@RF00428 TM    MGPNDESC(MGPPTR),B'00000100'                        0433 01524000
         BNO   @RF00433                                            0433 01525000
*     GRODESCR=BLANK;               /* BLANK OUT DESCR       @Y30LB26*/ 01526000
         L     @07,GROUPPTR                                        0434 01527000
         MVI   GRODESCR+1(@07),C' '                                0434 01528000
         MVC   GRODESCR+2(28,@07),GRODESCR+1(@07)                  0434 01529000
         MVI   GRODESCR(@07),C' '                                  0434 01530000
*                                                                  0435 01531000
*   /*****************************************************************/ 01532000
*   /*                                                               */ 01533000
*   /* BLANK ADDRESS                                         @Y30LB26*/ 01534000
*   /*                                                               */ 01535000
*   /*****************************************************************/ 01536000
*                                                                  0435 01537000
*   IF MGPNADDR=ON                  /* NULLIFY ADDRESS ?     @Y30LB26*/ 01538000
*     THEN                                                         0435 01539000
@RF00433 TM    MGPNADDR(MGPPTR),B'00000010'                        0435 01540000
         BNO   @RF00435                                            0435 01541000
*     GROADDR=BLANK;                /* BLANK ADDRESS         @Y30LB26*/ 01542000
         L     @07,GROUPPTR                                        0436 01543000
         MVI   GROADDR+1(@07),C' '                                 0436 01544000
         MVC   GROADDR+2(28,@07),GROADDR+1(@07)                    0436 01545000
         MVI   GROADDR(@07),C' '                                   0436 01546000
*                                                                  0437 01547000
*   /*****************************************************************/ 01548000
*   /*                                                               */ 01549000
*   /* WRITE GROUP RECORD JUST MODIFIED                      @Y30LB26*/ 01550000
*   /*                                                               */ 01551000
*   /*****************************************************************/ 01552000
*                                                                  0437 01553000
*   RPLVTYP=RPLVPUT;                /* PUT GROUP REC         @Y30LB26*/ 01554000
@RF00435 L     @07,RPLVPTR                                         0437 01555000
         MVI   RPLVTYP(@07),X'01'                                  0437 01556000
*   RESPECIFY                                                      0438 01557000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 01558000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 01559000
         LR    REG1,@07                                            0439 01560000
*   CALL ICBVIO00;                  /* WRITE RECORD          @Y30LB26*/ 01561000
         L     @15,@CV00671                                        0440 01562000
         BALR  @14,@15                                             0440 01563000
*   RESPECIFY                                                      0441 01564000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 01565000
*                                                                  0441 01566000
*   /*****************************************************************/ 01567000
*   /*                                                               */ 01568000
*   /* CHECK RETURN CODE FROM I/O PROCESSOR                  @Y30LB26*/ 01569000
*   /*                                                               */ 01570000
*   /*****************************************************************/ 01571000
*                                                                  0442 01572000
*   IF RPLVRETC¬=RCZERO             /* CK RETURN CODE        @Y30LB26*/ 01573000
*     THEN                          /*                       @Y30LB26*/ 01574000
*                                                                  0442 01575000
         L     @07,RPLVPTR                                         0442 01576000
         CLC   RPLVRETC(2,@07),@CB00747                            0442 01577000
         BE    @RF00442                                            0442 01578000
*     /***************************************************************/ 01579000
*     /*                                                             */ 01580000
*     /* IF BAD, SAVE CODES AND RETURN                       @Y30LB26*/ 01581000
*     /*                                                             */ 01582000
*     /***************************************************************/ 01583000
*                                                                  0443 01584000
*     DO;                           /*                       @Y30LB26*/ 01585000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Y30LB26*/ 01586000
         BAL   @14,ERREXIT                                         0444 01587000
*       RETURN;                     /* RETURN TO CALLER      @Y30LB26*/ 01588000
         B     @EL00004                                            0445 01589000
*     END;                          /*                       @Y30LB26*/ 01590000
*                                                                  0447 01591000
*   /*****************************************************************/ 01592000
*   /*                                                               */ 01593000
*   /* GO JOURNAL RPLV SINCE MODIFIED GROUP REC WRITTEN      @Y30LB26*/ 01594000
*   /*                                                               */ 01595000
*   /*****************************************************************/ 01596000
*                                                                  0447 01597000
*   CALL JOURNAL;                   /* JOURNAL RPLV          @Y30LB26*/ 01598000
@RF00442 BAL   @14,JOURNAL                                         0447 01599000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 01600000
         L     @07,RPLVPTR                                         0448 01601000
         CLC   RPLVRETC(2,@07),@CB00747                            0448 01602000
         BNE   @RT00448                                            0448 01603000
*     RETURN;                       /*                       @Y30LB26*/ 01604000
*                                                                  0450 01605000
*   /*****************************************************************/ 01606000
*   /*                                                               */ 01607000
*   /* CHECK TO SEE IF EXPIRATION DATE WAS NULLIFIED.        @Y30LB26*/ 01608000
*   /* IF SO, GO CLEAR EXPIRATION OUT OF ALL BASE RECS       @Y30LB26*/ 01609000
*   /* IN THAT GROUP........                                 @Y30LB26*/ 01610000
*   /*                                                               */ 01611000
*   /*****************************************************************/ 01612000
*                                                                  0450 01613000
*   IF MGPNRETP=ON THEN             /* NULLIFY RETENTION ?   @Y30LB26*/ 01614000
         TM    MGPNRETP(MGPPTR),B'00001000'                        0450 01615000
         BNO   @RF00450                                            0450 01616000
*     DO;                           /*                       @Y30LB26*/ 01617000
*       CALL NULBASRT;              /* GO NULL BASES         @Y30LB26*/ 01618000
         BAL   @14,NULBASRT                                        0452 01619000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @Y30LB26*/ 01620000
         L     @02,RPLVPTR                                         0453 01621000
         CLC   RPLVRETC(2,@02),@CB00747                            0453 01622000
         BNE   @RT00453                                            0453 01623000
*         RETURN;                   /*                       @Y30LB26*/ 01624000
*     END;                          /*                       @Y30LB26*/ 01625000
*                                                                  0456 01626000
*/* NEED TO CONVERT GROUP TO MSS RELEASE THREE ?             @G24LB04*/ 01627000
*                                                                  0456 01628000
*   IF REL3CONF=ON                  /*                       @G24LB04*/ 01629000
*     THEN                                                         0456 01630000
@RF00450 TM    REL3CONF,B'00000010'                                0456 01631000
         BNO   @RF00456                                            0456 01632000
*     DO;                           /* YES                   @G24LB04*/ 01633000
*       CALL REL3CONV;              /* EFFECTS CHANGES       @G24LB04*/ 01634000
         BAL   @14,REL3CONV                                        0458 01635000
*       REL3CONF=OFF;               /* TURN OFF SWITCH       @G24LB04*/ 01636000
         NI    REL3CONF,B'11111101'                                0459 01637000
*     END;                          /*                       @G24LB04*/ 01638000
*   RETURN;                         /* RETURN TO CALLER      @Y30LB26*/ 01639000
         B     @EL00004                                            0461 01640000
*   END MODIFYG;                    /*                       @Y30LB26*/ 01641000
         B     @EL00004                                            0462 01642000
*                                                                  0463 01643000
*   /*****************************************************************/ 01644000
*   /*                                                               */ 01645000
*   /* ROUTINE CHECKS TO SEE IF THERE ARE ANY VOLUMES        @Y30LB26*/ 01646000
*   /* THAT NEED TO HAVE THEIR EXPIRATION DATES NULLIFIED    @Y30LB26*/ 01647000
*   /* ANY ACTIVE OR INACTIVE GENERAL TYPE VOLUMES WILL      @Y30LB26*/ 01648000
*   /* HAVE THEIR EXPIRATION DATES NULLIFIED                 @Y30LB26*/ 01649000
*   /*                                                               */ 01650000
*   /*****************************************************************/ 01651000
*                                                                  0463 01652000
*NULBASRT:                                                         0463 01653000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 01654000
*                                                                  0463 01655000
NULBASRT ST    @14,@SA00005                                        0463 01656000
*   /*****************************************************************/ 01657000
*   /*                                                               */ 01658000
*   /* SEE IF ANY VOLUMES IN GROUP                           @Y301B26*/ 01659000
*   /*                                                               */ 01660000
*   /*****************************************************************/ 01661000
*                                                                  0464 01662000
*   IF GRONGEN=ZERO&GRONINAC=ZERO THEN/*                     @Y30LB26*/ 01663000
         SLR   @02,@02                                             0464 01664000
         L     @15,GROUPPTR                                        0464 01665000
         CH    @02,GRONGEN(,@15)                                   0464 01666000
         BNE   @RF00464                                            0464 01667000
         CH    @02,GRONINAC(,@15)                                  0464 01668000
         BE    @RT00464                                            0464 01669000
*     RETURN;                       /*                       @Y30LB26*/ 01670000
*   VOLKY=GROFSN;                   /* VOL NAME OF FIRST     @Y301B26*/ 01671000
*                                                                  0466 01672000
@RF00464 L     @02,GROUPPTR                                        0466 01673000
         MVC   VOLKY(6),GROFSN(@02)                                0466 01674000
*   /*****************************************************************/ 01675000
*   /*                                                               */ 01676000
*   /* START LOOPING THRU BASE RECORDS IN THIS GROUP         @Y30LB26*/ 01677000
*   /*                                                               */ 01678000
*   /*****************************************************************/ 01679000
*                                                                  0467 01680000
*   DO WHILE I=I;                   /* LOOP THRU BASE RECS   @Y30LB26*/ 01681000
         B     @DE00467                                            0467 01682000
@DL00467 DS    0H                                                  0468 01683000
*     RPLVKEY=ADDR(VKEY);           /* ADDR OF KEY           @Y30LB26*/ 01684000
         L     @02,RPLVPTR                                         0468 01685000
         LA    @15,VKEY                                            0468 01686000
         ST    @15,RPLVKEY(,@02)                                   0468 01687000
*     RPLVBUF=ADDR(STORBASE);       /* ADDR BUFFER           @Y30LB26*/ 01688000
         LA    @15,STORBASE                                        0469 01689000
         ST    @15,RPLVBUF(,@02)                                   0469 01690000
*     RPLVBLN=LENGTH(STORBASE);     /* LENGTH OF BUFFER      @Y30LB26*/ 01691000
         MVC   RPLVBLN(4,@02),@CF01147                             0470 01692000
*     RPLVKGE=OFF;                  /* SET KEY GTR OR EQU OFF      0471 01693000
*                                                            @ZA14732*/ 01694000
*     RPLVDIR=ON;                   /* READ DIRECT           @Y301B26*/ 01695000
         OI    RPLVDIR(@02),B'01000000'                            0472 01696000
         NI    RPLVKGE(@02),B'11111011'                            0472 01697000
*     RPLVTYP=RPLVREAD;             /* READ REC              @Y301B26*/ 01698000
         MVI   RPLVTYP(@02),X'00'                                  0473 01699000
*     RPLVUPD=ON;                   /* FOR UPDATE            @Y301B26*/ 01700000
         OI    RPLVUPD(@02),B'00000010'                            0474 01701000
*     RESPECIFY                                                    0475 01702000
*       REG1 RSTD;                  /* RESTRICT              @Y301B26*/ 01703000
*     REG1=RPLVPTR;                 /* ADDR RPLV             @Y301B26*/ 01704000
         LR    REG1,@02                                            0476 01705000
*     CALL ICBVIO00;                /* READ BASE             @Y301B26*/ 01706000
         L     @15,@CV00671                                        0477 01707000
         BALR  @14,@15                                             0477 01708000
*     RESPECIFY                                                    0478 01709000
*       REG1 UNRSTD;                /* FREE REG1             @Y301B26*/ 01710000
*                                                                  0478 01711000
*     /***************************************************************/ 01712000
*     /*                                                             */ 01713000
*     /* CHECK RETURN CODE FROM I/O PROCESSOR                @Y30LB26*/ 01714000
*     /*                                                             */ 01715000
*     /***************************************************************/ 01716000
*                                                                  0479 01717000
*     IF RPLVRETC¬=RCZERO THEN      /* CHECK RETURN          @Y301B26*/ 01718000
         L     @02,RPLVPTR                                         0479 01719000
         CLC   RPLVRETC(2,@02),@CB00747                            0479 01720000
         BE    @RF00479                                            0479 01721000
*       DO;                         /*                       @Y301B26*/ 01722000
*         CALL ERREXIT;             /* RELEASE INVENTORY     @Y301B26*/ 01723000
         BAL   @14,ERREXIT                                         0481 01724000
*         RETURN;                   /*                       @Y301B26*/ 01725000
@EL00005 DS    0H                                                  0482 01726000
@EF00005 DS    0H                                                  0482 01727000
@ER00005 L     @14,@SA00005                                        0482 01728000
         BR    @14                                                 0482 01729000
*       END;                        /*                       @Y301B26*/ 01730000
*     BASEVPTR=ADDR(STORBASE);      /* ADDR OF BASE REC      @Y301B26*/ 01731000
*                                                                  0484 01732000
@RF00479 LA    @02,STORBASE                                        0484 01733000
         ST    @02,BASEVPTR                                        0484 01734000
*     /***************************************************************/ 01735000
*     /*                                                             */ 01736000
*     /* IF BASE VOL IS GENERAL USE, NULLIFY THE             @Y30LB26*/ 01737000
*     /* EXPIRATION DATE AND WRITE RECORD                    @Y30LB26*/ 01738000
*     /*                                                             */ 01739000
*     /***************************************************************/ 01740000
*                                                                  0485 01741000
*     IF BASGENUS=ON THEN           /* GENERAL USE?          @Y301B26*/ 01742000
         TM    BASGENUS(@02),B'00010000'                           0485 01743000
         BNO   @RF00485                                            0485 01744000
*       DO;                         /*                       @Y301B26*/ 01745000
*         BASEXPDT=NULEXPDT;        /* NULLIFY EXPIRATION    @Y301B26*/ 01746000
         MVC   BASEXPDT(4,@02),NULEXPDT                            0487 01747000
*         RPLVTYP=RPLVPUT;          /* INDICATION            @Y301B26*/ 01748000
         L     @02,RPLVPTR                                         0488 01749000
         MVI   RPLVTYP(@02),X'01'                                  0488 01750000
*         RESPECIFY                                                0489 01751000
*           REG1 RSTD;              /* RESTRICT              @Y301B26*/ 01752000
*         REG1=RPLVPTR;             /* ADDR OF PRLV          @Y301B26*/ 01753000
         LR    REG1,@02                                            0490 01754000
*         CALL ICBVIO00;            /* WRITE BASE REC        @Y301B26*/ 01755000
         L     @15,@CV00671                                        0491 01756000
         BALR  @14,@15                                             0491 01757000
*         RESPECIFY                                                0492 01758000
*           REG1 UNRSTD;            /* FREE REG 1            @Y301B26*/ 01759000
*                                                                  0492 01760000
*         /***********************************************************/ 01761000
*         /*                                                         */ 01762000
*         /* CHECK RETURN FROM WRITING RECORD                @Y30LB26*/ 01763000
*         /*                                                         */ 01764000
*         /***********************************************************/ 01765000
*                                                                  0493 01766000
*         IF RPLVRETC¬=RCZERO THEN  /* CK RETURN             @Y301B26*/ 01767000
         L     @02,RPLVPTR                                         0493 01768000
         CLC   RPLVRETC(2,@02),@CB00747                            0493 01769000
         BE    @RF00493                                            0493 01770000
*           DO;                     /*                       @Y301B26*/ 01771000
*             CALL ERREXIT;         /* RELEASE INVENTORY     @Y301B26*/ 01772000
         BAL   @14,ERREXIT                                         0495 01773000
*             RETURN;               /*                       @Y301B26*/ 01774000
         B     @EL00005                                            0496 01775000
*           END;                    /*                       @Y301B26*/ 01776000
*                                                                  0497 01777000
*         /***********************************************************/ 01778000
*         /*                                                         */ 01779000
*         /* CALL SLOT ROUTINE TO CLEAR EXPIRATION           @Y30LB26*/ 01780000
*         /* DATES OUT OF EXTENSION SLOTS                    @Y30LB26*/ 01781000
*         /*                                                         */ 01782000
*         /***********************************************************/ 01783000
*                                                                  0498 01784000
*         SLOTEXP=ON;               /* INDICATE EXP ONLY     @Y30LB26*/ 01785000
@RF00493 OI    SLOTEXP,B'10000000'                                 0498 01786000
*         CALL VUEXT;               /* GO SLOT IT            @Y30LB26*/ 01787000
         BAL   @14,VUEXT                                           0499 01788000
*       END;                        /*                       @ZA14732*/ 01789000
*                                                                  0500 01790000
*     /***************************************************************/ 01791000
*     /*                                                             */ 01792000
*     /* CHECK TO SEE IF LAST BASE RECORD IN CHAIN           #Y30LB26*/ 01793000
*     /*                                                             */ 01794000
*     /***************************************************************/ 01795000
*                                                                  0501 01796000
*     IF BASLAST=ON THEN            /* LAST BASE IN CHAIN?   #Y301B26*/ 01797000
@RF00485 L     @02,BASEVPTR                                        0501 01798000
         TM    BASLAST(@02),B'00001000'                            0501 01799000
         BNO   @RF00501                                            0501 01800000
*       DO;                         /*                       #Y301B26*/ 01801000
*         RPLVRETC=RCZERO;          /* GOOD RETURN           #Y301B26*/ 01802000
         L     @02,RPLVPTR                                         0503 01803000
         MVC   RPLVRETC(2,@02),@CB00747                            0503 01804000
*         RPLRCODE=RCZERO;          /* GOOD REASON           #Y301B26*/ 01805000
         MVC   RPLRCODE(2,@02),@CB00747                            0504 01806000
*         RETURN;                   /*                       #Y301B26*/ 01807000
         B     @EL00005                                            0505 01808000
*       END;                        /*                       #Y301B26*/ 01809000
*     VOLKY=BASNEXTV;               /* VOLID OF NEXT BASE    #Y301B26*/ 01810000
@RF00501 L     @02,BASEVPTR                                        0507 01811000
         MVC   VOLKY(6),BASNEXTV(@02)                              0507 01812000
*   END;                            /*                       @Y301B26*/ 01813000
@DE00467 CLC   I(1),I                                              0508 01814000
         BE    @DL00467                                            0508 01815000
*   END NULBASRT;                   /*                       @Y301B26*/ 01816000
         B     @EL00005                                            0509 01817000
*REL3CONV:                                                         0510 01818000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB04*/ 01819000
REL3CONV ST    @14,@SA00006                                        0510 01820000
*/*CONVERSION TO MSS RELEASE THREE FROM                      @G24LB04*/ 01821000
*/*PRIOR MSS SUPPORT                                         @G24LB04*/ 01822000
*/* THIS PROCEDURE GOES THROUGH ALL OF THE GROUP EXTENSION   @G24LB04*/ 01823000
*/* RECORDS FOR THE GROUP BEING PROCESSED, AND UPDATES THEM. @G24LB04*/ 01824000
*/* FOR EACH VOLUME WHICH IS EITHER MOUNTED TO NO PROCESSOR  @G24LB04*/ 01825000
*/* AND WHICH DOES NOT CURRENTLY HAVE DOWN LEVEL SPACE,      @G24LB04*/ 01826000
*/* (1) THE PRESENT FREE SPACE VALUE FROM THE BASE VOLUME    @G24LB04*/ 01827000
*/* RECORD IS INSERTED INTO THE GROUP EXTENSION RECORD SLOT  @G24LB04*/ 01828000
*/* FOR THAT VOLUME. (2) THE FLAG SHOWING WHETHER THE        @G24LB04*/ 01829000
*/* RUNNING COUNT OF FREE SPACE IS VALID OR NOT IS SET TO    @G24LB04*/ 01830000
*/* SHOW VALID. FOR VOLUMES WHICH HAVE DOWN LEVEL SPACE,     @G24LB04*/ 01831000
*/* OR ARE MOUNTED TO ANY PROCESSOR, THE FLAG SHOWING        @G24LB04*/ 01832000
*/* RUNNING COUNT OF FREE SPACE IS SET TO SHOW INVALID.      @G24LB04*/ 01833000
*/* EACH GROUP EXTENSION RECORD IS WRITTEN AFTER IT HAS      @G24LB04*/ 01834000
*/* BEEN UPDATED.                                            @G24LB04*/ 01835000
*                                                                  0511 01836000
*   IF GRONGEN=ZERO                 /* ANY VOLUMES IN GROUP? @G24LB04*/ 01837000
*     THEN                                                         0511 01838000
         L     @02,GROUPPTR                                        0511 01839000
         LH    @15,GRONGEN(,@02)                                   0511 01840000
         LTR   @15,@15                                             0511 01841000
         BZ    @RT00511                                            0511 01842000
*     RETURN;                       /* NOTHING TO DO         @G24LB04*/ 01843000
*   GVSNEPTR=ADDR(STORGPEX);        /* ADDRESS BUFFER        @G24LB04*/ 01844000
         LA    GVSNEPTR,STORGPEX                                   0513 01845000
*   GROUPKY=GROVVGRP;               /* GROUP ID              @G24LB04*/ 01846000
         L     @15,GROUPPTR                                        0514 01847000
         MVC   GROUPKY(8),GROVVGRP(@15)                            0514 01848000
*   GIDKY=FIXZERO;                  /* ZERO KEY              @G24LB04*/ 01849000
         MVI   GIDKY,X'00'                                         0515 01850000
*   DO UNTIL GVSEX=OFF;             /* LOOP THRU GVSNES      @G24LB04*/ 01851000
@DL00516 DS    0H                                                  0517 01852000
*     GIDKY=GIDKY+FIXONE;           /* BEYOND FIRST GROUP    @G24LB04   01853000
*                                      RECORD                @G24LB04*/ 01854000
         LA    @15,1                                               0517 01855000
         SLR   @14,@14                                             0517 01856000
         IC    @14,GIDKY                                           0517 01857000
         ALR   @15,@14                                             0517 01858000
         STC   @15,GIDKY                                           0517 01859000
*     RPLVKEY=ADDR(GKEY);           /* KEY                   @G24LB04*/ 01860000
         L     @15,RPLVPTR                                         0518 01861000
         LA    @14,GKEY                                            0518 01862000
         ST    @14,RPLVKEY(,@15)                                   0518 01863000
*     RPLVBUF=ADDR(STORGPEX);       /* WHERE TO PUT GVSNE    @G24LB04*/ 01864000
         LA    @14,STORGPEX                                        0519 01865000
         ST    @14,RPLVBUF(,@15)                                   0519 01866000
*     RPLVLOC=OFF;                  /* NOT LOCATE MODE       @G24LB04*/ 01867000
         NI    RPLVLOC(@15),B'01111111'                            0520 01868000
*     RPLVBLN=LENGTH(STORGPEX);     /* BUFFER LENGTH         @G24LB04*/ 01869000
         MVC   RPLVBLN(4,@15),@CF01148                             0521 01870000
*     RPLVDIR=ON;                   /* READ DIRECT           @G24LB04*/ 01871000
         OI    RPLVDIR(@15),B'01000000'                            0522 01872000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           @G24LB04*/ 01873000
         MVI   RPLVTYP(@15),X'00'                                  0523 01874000
*     RPLVKGE=ON;                   /* READ > OR =           @G24LB04   01875000
*                                      (THIS GOES TO NEXT)   @G24LB04*/ 01876000
         OI    RPLVKGE(@15),B'00000100'                            0524 01877000
*     RPLVUPD=ON;                   /* FOR UPDATE            @G24LB04*/ 01878000
         OI    RPLVUPD(@15),B'00000010'                            0525 01879000
*     RESPECIFY                                                    0526 01880000
*       REG1 RSTD;                  /*                       @G24LB04*/ 01881000
*     REG1=RPLVPTR;                 /*                       @G24LB04*/ 01882000
         LR    REG1,@15                                            0527 01883000
*     CALL ICBVIO00;                /* READ EXTENSION RECORD @G24LB04*/ 01884000
         L     @15,@CV00671                                        0528 01885000
         BALR  @14,@15                                             0528 01886000
*     RESPECIFY                                                    0529 01887000
*       REG1 UNRSTD;                /*                       @G24LB04*/ 01888000
*     IF RPLVRETC¬=RCZERO           /*                       @G24LB04*/ 01889000
*       THEN                                                       0530 01890000
         L     @01,RPLVPTR                                         0530 01891000
         CLC   RPLVRETC(2,@01),@CB00747                            0530 01892000
         BE    @RF00530                                            0530 01893000
*       DO;                         /*                       @G24LB04*/ 01894000
*         CALL ERREXIT;             /*                       @G24LB04*/ 01895000
         BAL   @14,ERREXIT                                         0532 01896000
*         RETURN;                   /*                       @G24LB04*/ 01897000
@EL00006 DS    0H                                                  0533 01898000
@EF00006 DS    0H                                                  0533 01899000
@ER00006 L     @14,@SA00006                                        0533 01900000
         BR    @14                                                 0533 01901000
*       END;                        /*                       @G24LB04*/ 01902000
*     DO IS=1 TO GVSESIND-1;        /* PROCESS ALL SLOTS     @G24LB04   01903000
*                                      IN THIS GROUP         @G24LB04   01904000
*                                      EXTENSION RECORD      @G24LB04*/ 01905000
*                                                                  0535 01906000
@RF00530 LA    IS,1                                                0535 01907000
         B     @DE00535                                            0535 01908000
@DL00535 DS    0H                                                  0536 01909000
*       /*************************************************************/ 01910000
*       /*                                                           */ 01911000
*       /* READ BASE VOLUME RECORD FOR THIS VOLSER           @G24LB04*/ 01912000
*       /*                                                           */ 01913000
*       /*************************************************************/ 01914000
*                                                                  0536 01915000
*       VOLKY=GVSVOLID(IS);         /* VOLSER TO KEY         @G24LB04*/ 01916000
         LR    @05,IS                                              0536 01917000
         MH    @05,@CH01149                                        0536 01918000
         ALR   @05,GVSNEPTR                                        0536 01919000
         MVC   VOLKY(6),GVSVOLID-20(@05)                           0536 01920000
*       RPLVKEY=ADDR(VKEY);         /*                       @G24LB04*/ 01921000
         L     @05,RPLVPTR                                         0537 01922000
         LA    @15,VKEY                                            0537 01923000
         ST    @15,RPLVKEY(,@05)                                   0537 01924000
*       RPLVLOC=ON;                 /* LOCATE MODE           @G24LB04*/ 01925000
*       RPLVDIR=ON;                 /* DIRECT                @G24LB04*/ 01926000
         OI    RPLVLOC(@05),B'11000000'                            0539 01927000
*       RPLVUPD=OFF;                /* NOT UPDATING          @G24LB04*/ 01928000
         NI    RPLVUPD(@05),B'11111101'                            0540 01929000
*       RPLVTYP=RPLVREAD;           /* SPECIFY READ          @G24LB04*/ 01930000
         MVI   RPLVTYP(@05),X'00'                                  0541 01931000
*       RPLVKGE=OFF;                /* RESET                 @G24LB04*/ 01932000
         NI    RPLVKGE(@05),B'11111011'                            0542 01933000
*       RFY                                                        0543 01934000
*         REG1 RSTD;                /*                       @G24LB04*/ 01935000
*       REG1=RPLVPTR;               /*                       @G24LB04*/ 01936000
         LR    REG1,@05                                            0544 01937000
*       CALL ICBVIO00;              /* READ BASE VOLUME RECORD     0545 01938000
*                                                            @G24LB04*/ 01939000
         L     @15,@CV00671                                        0545 01940000
         BALR  @14,@15                                             0545 01941000
*       RFY                                                        0546 01942000
*         REG1 UNRSTD;              /*                       @G24LB04*/ 01943000
*       IF RPLVRETC¬=ZERO THEN      /* ERROR IN I/O?         @G24LB04*/ 01944000
         L     @05,RPLVPTR                                         0547 01945000
         LH    @05,RPLVRETC(,@05)                                  0547 01946000
         N     @05,@CF01186                                        0547 01947000
         LTR   @05,@05                                             0547 01948000
         BZ    @RF00547                                            0547 01949000
*         DO;                       /*                       @G24LB04*/ 01950000
*           CALL ERREXIT;           /*                       @G24LB04*/ 01951000
         BAL   @14,ERREXIT                                         0549 01952000
*           RETURN;                 /*                       @G24LB04*/ 01953000
         B     @EL00006                                            0550 01954000
*         END;                      /*                       @G24LB04*/ 01955000
*       BASEVPTR=RPLVBUF;           /*                       @G24LB04*/ 01956000
@RF00547 L     @05,RPLVPTR                                         0552 01957000
         L     @05,RPLVBUF(,@05)                                   0552 01958000
         ST    @05,BASEVPTR                                        0552 01959000
*       IF BASCPUID=BITZERO         /* VOL NOT MTD TO ANY CPU?     0553 01960000
*                                                            @G24LB04*/ 01961000
*           &BASDLSF=OFF            /* SPACE NOT DOWN LEVEL? @G24LB04*/ 01962000
*         THEN                                                     0553 01963000
         CLC   BASCPUID(2,@05),@CB00747                            0553 01964000
         BNE   @RF00553                                            0553 01965000
         TM    BASDLSF(@05),B'10000000'                            0553 01966000
         BNZ   @RF00553                                            0553 01967000
*         DO;                       /*                       @G24LB04*/ 01968000
*           GVSMTDSP(IS)=BASFRESP;  /* UPDATE FREE SPACE     @G24LB04*/ 01969000
         LR    @15,IS                                              0555 01970000
         MH    @15,@CH01149                                        0555 01971000
         LH    @05,BASFRESP(,@05)                                  0555 01972000
         N     @05,@CF01186                                        0555 01973000
         STH   @05,GVSMTDSP-20(@15,GVSNEPTR)                       0555 01974000
*           GVSRCFSI(IS)=OFF;       /* RUNNING COUNT IS OK   @G24LB04*/ 01975000
*           GVSMTNSH(IS)=OFF;       /* VOL NOT MTD NON-SHR   @G24LB04*/ 01976000
         ALR   @15,GVSNEPTR                                        0557 01977000
         NI    GVSRCFSI-20(@15),B'00111111'                        0557 01978000
*         END;                      /*                       @G24LB04*/ 01979000
*       ELSE                                                       0559 01980000
*         GVSRCFSI(IS)=ON;          /* RUNNING COUNT INVALID @G24LB04*/ 01981000
         B     @RC00553                                            0559 01982000
@RF00553 LR    @05,IS                                              0559 01983000
         MH    @05,@CH01149                                        0559 01984000
         ALR   @05,GVSNEPTR                                        0559 01985000
         OI    GVSRCFSI-20(@05),B'10000000'                        0559 01986000
*     END;                          /* PROCESSING FOR EACH   @G24LB04   01987000
*                                      SLOT                  @G24LB04*/ 01988000
*                                                                  0560 01989000
@RC00553 AL    IS,@CF00041                                         0560 01990000
@DE00535 LH    @05,GVSESIND(,GVSNEPTR)                             0560 01991000
         BCTR  @05,0                                               0560 01992000
         CR    IS,@05                                              0560 01993000
         BNH   @DL00535                                            0560 01994000
*     /***************************************************************/ 01995000
*     /*                                                             */ 01996000
*     /* MUST READ GVSNE RECORD ONCE MORE INTO A DUMMY       @G24LB04*/ 01997000
*     /* BUFFER BEFORE WRITING IT BECAUSE OTHER RECORDS      @G24LB04*/ 01998000
*     /* HAVE BEEN READ SINCE THIS ONE.                      @G24LB04*/ 01999000
*     /*                                                             */ 02000000
*     /***************************************************************/ 02001000
*                                                                  0561 02002000
*     RPLVKEY=ADDR(GVSNAME);        /* KEY                   @G24LB04*/ 02003000
         L     @15,RPLVPTR                                         0561 02004000
         ST    GVSNEPTR,RPLVKEY(,@15)                              0561 02005000
*     RPLVBUF=ADDR(DUMGVSNE);       /* NOT REFERENCED-DUMMY  @G24LB04*/ 02006000
         LA    @14,DUMGVSNE                                        0562 02007000
         ST    @14,RPLVBUF(,@15)                                   0562 02008000
*     RPLVLOC=OFF;                  /* NOT LOCATE MODE       @G24LB04*/ 02009000
         NI    RPLVLOC(@15),B'01111111'                            0563 02010000
*     RPLVBLN=LENGTH(DUMGVSNE);     /*                       @G24LB04*/ 02011000
         MVC   RPLVBLN(4,@15),@CF01148                             0564 02012000
*     RPLVDIR=ON;                   /* READ DIRECT           @G24LB04*/ 02013000
         OI    RPLVDIR(@15),B'01000000'                            0565 02014000
*     RPLVTYP=RPLVREAD;             /* READ                  @G24LB04*/ 02015000
         MVI   RPLVTYP(@15),X'00'                                  0566 02016000
*     RPLVKGE=OFF;                  /* USE THIS KEY          @G24LB04*/ 02017000
         NI    RPLVKGE(@15),B'11111011'                            0567 02018000
*     RPLVUPD=ON;                   /* READ FOR UPDATE       @G24LB04*/ 02019000
         OI    RPLVUPD(@15),B'00000010'                            0568 02020000
*     RFY                                                          0569 02021000
*       REG1 RSTD;                  /*                       @G24LB04*/ 02022000
*     REG1=RPLVPTR;                 /*                       @G24LB04*/ 02023000
         LR    REG1,@15                                            0570 02024000
*     CALL ICBVIO00;                /* READ GVSNE            @G24LB04*/ 02025000
         L     @15,@CV00671                                        0571 02026000
         BALR  @14,@15                                             0571 02027000
*     RFY                                                          0572 02028000
*       REG1 UNRSTD;                /*                       @G24LB04*/ 02029000
*     IF RPLVRETC¬=ZERO THEN        /* ERROR?                @G24LB04*/ 02030000
         L     @01,RPLVPTR                                         0573 02031000
         LH    @15,RPLVRETC(,@01)                                  0573 02032000
         N     @15,@CF01186                                        0573 02033000
         LTR   @15,@15                                             0573 02034000
         BZ    @RF00573                                            0573 02035000
*       DO;                         /*                       @G24LB04*/ 02036000
*         CALL ERREXIT;             /*                       @G24LB04*/ 02037000
         BAL   @14,ERREXIT                                         0575 02038000
*         RETURN;                   /*                       @G24LB04*/ 02039000
         B     @EL00006                                            0576 02040000
*       END;                        /*                       @G24LB04*/ 02041000
*                                                                  0577 02042000
*     /***************************************************************/ 02043000
*     /*                                                             */ 02044000
*     /* WRITE THE UPDATED GROUP EXTENSION RECORD            @G24LB04*/ 02045000
*     /*                                                             */ 02046000
*     /***************************************************************/ 02047000
*                                                                  0578 02048000
*     RPLVBUF=ADDR(STORGPEX);       /* WHERE RECORD IS       @G24LB04*/ 02049000
@RF00573 L     @15,RPLVPTR                                         0578 02050000
         LA    @14,STORGPEX                                        0578 02051000
         ST    @14,RPLVBUF(,@15)                                   0578 02052000
*     RPLVTYP=RPLVPUT;              /* WRITE                 @G24LB04*/ 02053000
         MVI   RPLVTYP(@15),X'01'                                  0579 02054000
*     RFY                                                          0580 02055000
*       REG1 RSTD;                  /*                       @G24LB04*/ 02056000
*     REG1=RPLVPTR;                 /*                       @G24LB04*/ 02057000
         LR    REG1,@15                                            0581 02058000
*     CALL ICBVIO00;                /*                       @G24LB04*/ 02059000
         L     @15,@CV00671                                        0582 02060000
         BALR  @14,@15                                             0582 02061000
*     RFY                                                          0583 02062000
*       REG1 UNRSTD;                /*                       @G24LB04*/ 02063000
*     IF RPLVRETC¬=RCZERO THEN      /* ERROR IN I/O          @G24LB04*/ 02064000
         L     @01,RPLVPTR                                         0584 02065000
         CLC   RPLVRETC(2,@01),@CB00747                            0584 02066000
         BE    @RF00584                                            0584 02067000
*       DO;                         /*                       @G24LB04*/ 02068000
*         CALL ERREXIT;             /*                       @G24LB04*/ 02069000
         BAL   @14,ERREXIT                                         0586 02070000
*         RETURN;                   /*                       @G24LB04*/ 02071000
         B     @EL00006                                            0587 02072000
*       END;                        /*                       @G24LB04*/ 02073000
*   END;                            /* END LOOP THROUGH GVSNES     0589 02074000
*                                                            @G24LB04*/ 02075000
@RF00584 DS    0H                                                  0589 02076000
@DE00516 TM    GVSEX(GVSNEPTR),B'10000000'                         0589 02077000
         BNZ   @DL00516                                            0589 02078000
*   END REL3CONV;                   /*                       @G24LB04*/ 02079000
         B     @EL00006                                            0590 02080000
*                                                                  0591 02081000
*/*  START OF SPECIFICATIONS ****                                  0591 02082000
*                                                                  0591 02083000
*    PROCEDURE NAME - SCRATCHG                                @Y30LB26  02084000
*                                                                  0591 02085000
*    FUNCTION - TO SCRATCH A GROUP RECORD FROM USERCAT.MSVI DATA SET.   02086000
*    BEFORE DOING THIS, THE NUMBER OF GENERAL USE VOLUMES IN THE GROUP, 02087000
*    THE NUMBER OF RESTRICTED USE VOLUMES AND THE NUMBER OF INACTIVE    02088000
*    VOLUMES MUST ALL BE ZERO.  THE PROGRAM WILL NOT ALLOW SYSGROUP TO  02089000
*    BE SCRATCHED.  THE RPLV IS JOURNALED AFTER THE GROUP RECORD IS     02090000
*    SUCCESSFULLY DELETED FROM THE MSVC INVENTORY DATA SET.   @Y30LB26  02091000
*                                                                  0591 02092000
*      INPUTS - REGISTER 1 CONTAINS THE ADDRESS OF THE RPLV WHICH  0591 02093000
*      CONTAINS THE REQUEST BLOCK.                            @Y30LB26  02094000
*                                                                  0591 02095000
*      OUTPUTS - REASON CODE AND RETURN CODE IN RPLV.         @Y30LB26  02096000
*                                                                  0591 02097000
*       '021C'X  TRIED TO SCRATCH A GROUP THAT STILL HAS      @Y30LB26  02098000
*       VOLUMES ASSIGNED TO IT.                               @Y30LB26  02099000
*       '0226'X  CAN NOT SCRATCH SYSGROUP.                    @Y30LB26  02100000
*       PLUS ANY REASON CODES FROM THE I/O PROCESSOR OR THE   @Y30LB26  02101000
*       JOURNAL PROGRAM.                                      @Y30LB26  02102000
**** END OF SPECIFICATIONS **                                        */ 02103000
*                                                                  0591 02104000
*SCRATCHG:                                                         0591 02105000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 02106000
SCRATCHG ST    @14,@SA00007                                        0591 02107000
*                                                                  0592 02108000
*   /*****************************************************************/ 02109000
*   /*                                                               */ 02110000
*   /* SET UP ADDRESS TO REQUEST BLOCK                       #Y30LB26*/ 02111000
*   /*                                                               */ 02112000
*   /*****************************************************************/ 02113000
*                                                                  0592 02114000
*   SGPPTR=ADDR(RPLVUTIL);          /* ADDR REQUEST BLK      #Y30LB26*/ 02115000
*                                                                  0592 02116000
         L     @02,RPLVPTR                                         0592 02117000
         LA    SGPPTR,RPLVUTIL(,@02)                               0592 02118000
*   /*****************************************************************/ 02119000
*   /*                                                               */ 02120000
*   /* BE SURE THAT NOT TRYING TO ERASE THE SYSGROUP         #Y30LB26*/ 02121000
*   /* GROUP, BECAUSE THIS IS NOT ALLOWED.                   #Y30LB26*/ 02122000
*   /*                                                               */ 02123000
*   /*****************************************************************/ 02124000
*                                                                  0593 02125000
*   IF SGPGROUP=SYSGROUP THEN       /* SYSGROUP ?            #Y30LB26*/ 02126000
         CLC   SGPGROUP(8,SGPPTR),SYSGROUP                         0593 02127000
         BNE   @RF00593                                            0593 02128000
*     DO;                           /*                       #Y30LB26*/ 02129000
*       RPLVRETC=FOUR;              /* BAD RET CODE          #Y30LB26*/ 02130000
         MVC   RPLVRETC(2,@02),@CB00749                            0595 02131000
*       RPLRCODE=NOSYSGRP;          /* INDICATE PROBLEM      #Y30LB26*/ 02132000
         MVC   RPLRCODE(2,@02),@CB00829                            0596 02133000
*       RETURN;                     /*                       #Y30LB26*/ 02134000
@EL00007 DS    0H                                                  0597 02135000
@EF00007 DS    0H                                                  0597 02136000
@ER00007 L     @14,@SA00007                                        0597 02137000
         BR    @14                                                 0597 02138000
*     END;                          /*                       #Y30LB26*/ 02139000
*                                                                  0598 02140000
*   /*****************************************************************/ 02141000
*   /*                                                               */ 02142000
*   /* RESERVE INVENTORY DATA SET                            #Y30LB26*/ 02143000
*   /*                                                               */ 02144000
*   /*****************************************************************/ 02145000
*                                                                  0599 02146000
*   CALL RESERINV;                  /* RESER INVEN           #Y30LB26*/ 02147000
@RF00593 BAL   @14,RESERINV                                        0599 02148000
*                                                                  0600 02149000
*   /*****************************************************************/ 02150000
*   /*                                                               */ 02151000
*   /* READ GROUP RECORD                                     @Y30LB26*/ 02152000
*   /*                                                               */ 02153000
*   /*****************************************************************/ 02154000
*                                                                  0600 02155000
*   GROUPKY=SGPGROUP;               /* GRP NAME IN KEY       @Y30LB26*/ 02156000
         MVC   GROUPKY(8),SGPGROUP(SGPPTR)                         0600 02157000
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY IN VSAM      @Y30LB26*/ 02158000
         L     @02,RPLVPTR                                         0601 02159000
         LA    @15,GKEY                                            0601 02160000
         ST    @15,RPLVKEY(,@02)                                   0601 02161000
*   RPLVBUF=ADDR(STORGRP);          /* BUFFER ADDRESS        @Y30LB26*/ 02162000
         LA    @15,STORGRP                                         0602 02163000
         ST    @15,RPLVBUF(,@02)                                   0602 02164000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH OF BUFFER      @Y30LB26*/ 02165000
         MVC   RPLVBLN(4,@02),@CF01147                             0603 02166000
*   RPLVDIR=ON;                     /* DIRECT READ           @Y30LB26*/ 02167000
         OI    RPLVDIR(@02),B'01000000'                            0604 02168000
*   RPLVTYP=RPLVREAD;               /* READ REC              @Y30LB26*/ 02169000
         MVI   RPLVTYP(@02),X'00'                                  0605 02170000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       @Y30LB26*/ 02171000
         OI    RPLVUPD(@02),B'00000010'                            0606 02172000
*   RESPECIFY                                                      0607 02173000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 02174000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 02175000
         LR    REG1,@02                                            0608 02176000
*   CALL ICBVIO00;                  /* READ GRP REC          @Y30LB26*/ 02177000
         L     @15,@CV00671                                        0609 02178000
         BALR  @14,@15                                             0609 02179000
*   RESPECIFY                                                      0610 02180000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 02181000
*                                                                  0611 02182000
*   /*****************************************************************/ 02183000
*   /*                                                               */ 02184000
*   /* CHECK RETURN CODES FROM I/O PROCESSOR                 @Y30LB26*/ 02185000
*   /*                                                               */ 02186000
*   /*****************************************************************/ 02187000
*                                                                  0611 02188000
*   IF RPLVRETC¬=RCZERO             /* CK RET CODE           @Y30LB26*/ 02189000
*     THEN                          /*                       @Y30LB26*/ 02190000
*                                                                  0611 02191000
         L     @02,RPLVPTR                                         0611 02192000
         CLC   RPLVRETC(2,@02),@CB00747                            0611 02193000
         BE    @RF00611                                            0611 02194000
*     /***************************************************************/ 02195000
*     /*                                                             */ 02196000
*     /* IF BAD, SAVE CODES AND RETURN TO CALLER             @Y30LB26*/ 02197000
*     /*                                                             */ 02198000
*     /***************************************************************/ 02199000
*                                                                  0612 02200000
*     DO;                           /*                       @Y30LB26*/ 02201000
*       CALL ERREXIT;               /* SAVE REASON CODES     @Y30LB26*/ 02202000
         BAL   @14,ERREXIT                                         0613 02203000
*       RETURN;                     /*                       @Y30LB26*/ 02204000
         B     @EL00007                                            0614 02205000
*     END;                          /*                       @Y30LB26*/ 02206000
*   GROUPPTR=ADDR(STORGRP);         /* ADDR GRP REC          @Y30LB26*/ 02207000
@RF00611 LA    @02,STORGRP                                         0616 02208000
         ST    @02,GROUPPTR                                        0616 02209000
*                                                                  0617 02210000
*   /*****************************************************************/ 02211000
*   /*                                                               */ 02212000
*   /* CHECK TO SEE IF ANY VOLUMES IN GROUP AT ALL           @Y30LB26*/ 02213000
*   /*                                                               */ 02214000
*   /*****************************************************************/ 02215000
*                                                                  0617 02216000
*   IF GRONGEN¬=ZERO|GRONRSTD¬=ZERO|GRONINAC¬=ZERO/*         @Y30LB26*/ 02217000
*     THEN                          /*                       @Y30LB26*/ 02218000
*                                                                  0617 02219000
         SLR   @15,@15                                             0617 02220000
         CH    @15,GRONGEN(,@02)                                   0617 02221000
         BNE   @RT00617                                            0617 02222000
         CH    @15,GRONRSTD(,@02)                                  0617 02223000
         BNE   @RT00617                                            0617 02224000
         CH    @15,GRONINAC(,@02)                                  0617 02225000
         BE    @RF00617                                            0617 02226000
@RT00617 DS    0H                                                  0618 02227000
*     /***************************************************************/ 02228000
*     /*                                                             */ 02229000
*     /* IF NOT EMPTY, SET REASON, RETURN CODES, RETN        @Y30LB26*/ 02230000
*     /*                                                             */ 02231000
*     /***************************************************************/ 02232000
*                                                                  0618 02233000
*     DO;                           /*                       @Y30LB26*/ 02234000
*       RPLVRETC=FOUR;              /* SET BAD RET CODE      @Y30LB26*/ 02235000
         L     @02,RPLVPTR                                         0619 02236000
         MVC   RPLVRETC(2,@02),@CB00749                            0619 02237000
*       RPLRCODE=NOEMPTY;           /* SET REASON CODE       @Y30LB26*/ 02238000
         MVC   RPLRCODE(2,@02),@CB00805                            0620 02239000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 02240000
         BAL   @14,ERREXIT                                         0621 02241000
*       RETURN;                     /*                       @Y30LB26*/ 02242000
         B     @EL00007                                            0622 02243000
*     END;                          /*                       @Y30LB26*/ 02244000
*                                                                  0624 02245000
*   /*****************************************************************/ 02246000
*   /*                                                               */ 02247000
*   /* DELETE GROUP RECORD                                   @Y30LB26*/ 02248000
*   /*                                                               */ 02249000
*   /*****************************************************************/ 02250000
*                                                                  0624 02251000
*   RPLVTYP=RPLVDEL;                /* DELETE GRP REC        @Y30LB26*/ 02252000
@RF00617 L     @02,RPLVPTR                                         0624 02253000
         MVI   RPLVTYP(@02),X'05'                                  0624 02254000
*   RESPECIFY                                                      0625 02255000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 02256000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 02257000
         LR    REG1,@02                                            0626 02258000
*   CALL ICBVIO00;                  /* DELETE GROUP REC      @Y30LB26*/ 02259000
         L     @15,@CV00671                                        0627 02260000
         BALR  @14,@15                                             0627 02261000
*   RESPECIFY                                                      0628 02262000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 02263000
*                                                                  0628 02264000
*   /*****************************************************************/ 02265000
*   /*                                                               */ 02266000
*   /* IF UNSUCCESSFUL, SAVE CODES AND RETURN TO CALLER      @Y30LB26*/ 02267000
*   /*                                                               */ 02268000
*   /*****************************************************************/ 02269000
*                                                                  0629 02270000
*   IF RPLVRETC¬=RCZERO             /* CK RETURN CODE        @Y30LB26*/ 02271000
*     THEN                          /*                       @Y30LB26*/ 02272000
         L     @02,RPLVPTR                                         0629 02273000
         CLC   RPLVRETC(2,@02),@CB00747                            0629 02274000
         BE    @RF00629                                            0629 02275000
*     DO;                           /*                       @Y30LB26*/ 02276000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 02277000
         BAL   @14,ERREXIT                                         0631 02278000
*       RETURN;                     /* RETURN TO CALLER      @Y30LB26*/ 02279000
         B     @EL00007                                            0632 02280000
*     END;                          /*                       @Y30LB26*/ 02281000
*                                                                  0633 02282000
*   /*****************************************************************/ 02283000
*   /*                                                               */ 02284000
*   /* GO JOURNAL RPLV SINCE GROUP REC WRITTEN               @Y30LB26*/ 02285000
*   /*                                                               */ 02286000
*   /*****************************************************************/ 02287000
*                                                                  0634 02288000
*   CALL JOURNAL;                   /* JOURNAL RPLV          @Y30LB26*/ 02289000
@RF00629 BAL   @14,JOURNAL                                         0634 02290000
*   RETURN;                         /*                       @Y30LB26*/ 02291000
         B     @EL00007                                            0635 02292000
*   END SCRATCHG;                   /* END SCRATCHG INT      @Y30LB26*/ 02293000
*                                                                  0637 02294000
*/*  START OF SPECIFICATIONS ****                                  0637 02295000
*                                                                  0637 02296000
*    PROCEDURE NAME - REMOVEVR                                @Y30LB26  02297000
*                                                                  0637 02298000
*    FUNCTION - TO REMOVE VOLUME RECORD FROM THE USERCAT.MSVI DATA SET. 02299000
*    THIS PROGRAM WILL REMOVE EITHER A COPY OR A BASE VOLUME RECORD.  A 02300000
*    BASE VOLUME RECORD IS NOT REMOVED IF THERE ARE ANY COPIES OF THE   02301000
*    VOLUME.  ALSO A VOLUME RECORD IS NOT REMOVED IF EITHER CARTRIDGE   02302000
*    IS IN THE MSF.  THIS IS DETERMINED ONCE BY THE UTILITY        0637 02303000
*    BEFORE THE PROGRAM IS CALLED AND THEN IS CHECKED              0637 02304000
*    AGAIN IN THE LIB ID FIELD OF THE VOLUME RECORD BY             0637 02305000
*    THIS PROGRAM. THE CARTRIDGE INDEX RECORDS ARE SCRATCHED       0637 02306000
*    IF THEY EXIST AND BELONG TO THE RIGHT VOLUME.  IF THE CARTRIDGES   02307000
*    HAVE SINCE BEEN ASSIGNED TO ANOTHER VOLUME, THE CARTRIDGE     0637 02308000
*    INDEX RECORDS ARE NOT SCRATCHED AND NO ERROR                  0637 02309000
*    CONDITION WILL OCCUR.  THE NEXT FUNCTION PREFORMED            0637 02310000
*    IS REMOVAL OF THE VOLUME RECORD.  IF THE VOLUME RECORD WAS A BASE  02311000
*    VOLUME RECORD A CHECK IS MADE TO SEE IF THERE IS A DUPLICATE  0637 02312000
*    VOLUME RECORD.  IF ANY EXIST, THE OLDEST DUPLICATE BECOMES THE NEW 02313000
*    BASE VOLUME RECORD WITH THE SAME KEY AS THE DELETED BASE VOLUME    02314000
*    RECORD.  THE RPLV IS JOURNALED AFTER THE FIRST SUCCESSFUL UPDATE   02315000
*    OF THE MSS VOLUME INVENTORY.                             @Y30LB26  02316000
*                                                                  0637 02317000
*      INPUT - REGISTER 1 HAS THE ADDRESS OF THE RPLV.  THE RPLV   0637 02318000
*      CONTAINS ALL INFORMATION NEEDED TO REMOVE THE PROPER RECORD FROM 02319000
*      USERCAT.MSVI DATA SET.                                 @Y30LB26  02320000
*                                                                  0637 02321000
*      OUTPUT - REASON CODE AND CONDITION CODE RETURNED IN THE RPLV.    02322000
*                                                             @Y30LB26  02323000
*                                                                  0637 02324000
*      '0219'X  COPY OR BASE WAS NOT SPECIFIED.               @Y30LB26  02325000
*      '0216'X  TRYING TO REMOVE BASE RECORD THAT HAS COPIES. @Y30LB26  02326000
*      '021A'X  CARTRIDGES ARE IN LIBRARY                     @Y30LB26  02327000
*      '021B'X  I/O ERROR OCCURED BUT RPLV WAS JOURNALED.     @Y30LB26  02328000
*       PLUS ANY RETURNS FROM  THE I/O PROCESSOR OR THE       @Y30LB26  02329000
*       JOURNAL PROGRAM.                                      @Y30LB26  02330000
**** END OF SPECIFICATIONS **                                        */ 02331000
*                                                                  0637 02332000
*REMOVEVR:                                                         0637 02333000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 02334000
REMOVEVR ST    @14,@SA00008                                        0637 02335000
*   DUPFNDFL=OFF;                   /* INIT DUP FND FLAG     @Y30LB26*/ 02336000
*   BACKUPFL=OFF;                   /* INIT BACKUP FLAG      @Y30LB26*/ 02337000
         NI    DUPFNDFL,B'11001111'                                0639 02338000
*                                                                  0640 02339000
*   /*****************************************************************/ 02340000
*   /*                                                               */ 02341000
*   /* RESERVE INVENTORY DATA SET                            @Y30LB26*/ 02342000
*   /*                                                               */ 02343000
*   /*****************************************************************/ 02344000
*                                                                  0640 02345000
*   CALL RESERINV;                  /* RESERVE INVENTORY     @Y30LB26*/ 02346000
*                                                                  0640 02347000
         BAL   @14,RESERINV                                        0640 02348000
*   /*****************************************************************/ 02349000
*   /*                                                               */ 02350000
*   /* SET UP ADDRESS TO REQUEST BLK                         @Y30LB26*/ 02351000
*   /*                                                               */ 02352000
*   /*****************************************************************/ 02353000
*                                                                  0641 02354000
*   RVRPTR=ADDR(RPLVUTIL);          /* ADDR REQUEST BLK      @Y30LB26*/ 02355000
         L     @02,RPLVPTR                                         0641 02356000
         LA    @02,RPLVUTIL(,@02)                                  0641 02357000
         ST    @02,RVRPTR                                          0641 02358000
*   VOLKY=RVRVOLID;                 /* VOL NAME BE REMOVED   @Y30LB26*/ 02359000
*                                                                  0642 02360000
         MVC   VOLKY(6),RVRVOLID(@02)                              0642 02361000
*   /*****************************************************************/ 02362000
*   /*                                                               */ 02363000
*   /* CHECK IF BASE VOLUME IS TO BE REMOVED                 @Y30LB26*/ 02364000
*   /*                                                               */ 02365000
*   /*****************************************************************/ 02366000
*                                                                  0643 02367000
*   IF RVRBASEV=ON                  /* REMOVE BASE ?         @Y30LB26*/ 02368000
*     THEN                          /*                       @Y30LB26*/ 02369000
*                                                                  0643 02370000
         TM    RVRBASEV(@02),B'10000000'                           0643 02371000
         BNO   @RF00643                                            0643 02372000
*     /***************************************************************/ 02373000
*     /*                                                             */ 02374000
*     /* CALL SUBROUTINE TO REMOVE BASE VOL RECORD           @Y30LB26*/ 02375000
*     /*                                                             */ 02376000
*     /***************************************************************/ 02377000
*                                                                  0644 02378000
*     DO;                           /*                       @Y30LB26*/ 02379000
*       CALL REMOVBAS;              /* GO REMOVE BASE VOL    @Y30LB26*/ 02380000
         BAL   @14,REMOVBAS                                        0645 02381000
*       RETURN;                     /*                       @Y30LB26*/ 02382000
@EL00008 DS    0H                                                  0646 02383000
@EF00008 DS    0H                                                  0646 02384000
@ER00008 L     @14,@SA00008                                        0646 02385000
         BR    @14                                                 0646 02386000
*     END;                          /*                       @Y30LB26*/ 02387000
*                                                                  0648 02388000
*   /*****************************************************************/ 02389000
*   /*                                                               */ 02390000
*   /* CHECK IF COPY VOLUME IS TO BE REMOVED                 @Y30LB26*/ 02391000
*   /*                                                               */ 02392000
*   /*****************************************************************/ 02393000
*                                                                  0648 02394000
*   IF RVRCOPYV=ON                  /* REMOVE COPY VOL ?     @Y30LB26*/ 02395000
*     THEN                          /*                       @Y30LB26*/ 02396000
*                                                                  0648 02397000
@RF00643 L     @02,RVRPTR                                          0648 02398000
         TM    RVRCOPYV(@02),B'01000000'                           0648 02399000
         BNO   @RF00648                                            0648 02400000
*     /***************************************************************/ 02401000
*     /*                                                             */ 02402000
*     /* CALL SUBROUTINE TO REMOVE COPY VOL RECORD           @Y30LB26*/ 02403000
*     /*                                                             */ 02404000
*     /***************************************************************/ 02405000
*                                                                  0649 02406000
*     DO;                           /*                       @Y30LB26*/ 02407000
*       CALL REMOVCPY;              /* GO REMOVE COPY REC    @Y30LB26*/ 02408000
         BAL   @14,REMOVCPY                                        0650 02409000
*       RETURN;                     /* RETURN TO CALLER      @Y30LB26*/ 02410000
         B     @EL00008                                            0651 02411000
*     END;                          /*                       @Y30LB26*/ 02412000
*   ELSE                            /*                       @Y30LB26*/ 02413000
*                                                                  0653 02414000
*     /***************************************************************/ 02415000
*     /*                                                             */ 02416000
*     /* IF NOT ONE OF THESE TWO AN ERROR EXISTS             @Y30LB26*/ 02417000
*     /* SET REASON AND RETURN CODES AND RETURN.             @Y30LB26*/ 02418000
*     /*                                                             */ 02419000
*     /***************************************************************/ 02420000
*                                                                  0653 02421000
*     DO;                           /*                       @Y30LB26*/ 02422000
@RF00648 DS    0H                                                  0654 02423000
*       RPLVRETC=FOUR;              /* SET BAD RETURN CODE   @Y30LB26*/ 02424000
         L     @02,RPLVPTR                                         0654 02425000
         MVC   RPLVRETC(2,@02),@CB00749                            0654 02426000
*       RPLRCODE=REQBLKER;          /* TYPE REC NOT SPEC     @Y30LB26*/ 02427000
         MVC   RPLRCODE(2,@02),@CB00797                            0655 02428000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 02429000
         BAL   @14,ERREXIT                                         0656 02430000
*       RETURN;                     /* RETURN TO MAIN PROC   @Y30LB26*/ 02431000
         B     @EL00008                                            0657 02432000
*     END;                          /*                       @Y30LB26*/ 02433000
*   END REMOVEVR;                   /*                       @Y30LB26*/ 02434000
*                                                                  0660 02435000
*   /*****************************************************************/ 02436000
*   /*                                                               */ 02437000
*   /* SUBROUTINE WHICH REMOVES A BASE VOLUME RECORD         @Y30LB26*/ 02438000
*   /* AND UPDATES ANY GROUP AND CARTRIDGE RECORDS           @Y30LB26*/ 02439000
*   /*                                                               */ 02440000
*   /*****************************************************************/ 02441000
*                                                                  0660 02442000
*REMOVBAS:                                                         0660 02443000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 02444000
*                                                                  0660 02445000
REMOVBAS ST    @14,@SA00009                                        0660 02446000
*   /*****************************************************************/ 02447000
*   /*                                                               */ 02448000
*   /* READ BASE VOLUME RECORD                               @Y30LB26*/ 02449000
*   /*                                                               */ 02450000
*   /*****************************************************************/ 02451000
*                                                                  0661 02452000
*   RPLVKEY=ADDR(VKEY);             /* GET ADDR OF KEY       @Y30LB26*/ 02453000
         L     @02,RPLVPTR                                         0661 02454000
         LA    @15,VKEY                                            0661 02455000
         ST    @15,RPLVKEY(,@02)                                   0661 02456000
*   RPLVBUF=ADDR(STORBASE);         /* ADDR OF BUFFER        @Y30LB26*/ 02457000
         LA    @15,STORBASE                                        0662 02458000
         ST    @15,RPLVBUF(,@02)                                   0662 02459000
*   RPLVBLN=LENGTH(STORBASE);       /* LENGTH BUFFER         @Y30LB26*/ 02460000
         MVC   RPLVBLN(4,@02),@CF01147                             0663 02461000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 02462000
         OI    RPLVDIR(@02),B'01000000'                            0664 02463000
*   RPLVTYP=RPLVREAD;               /* READ REC              @Y30LB26*/ 02464000
         MVI   RPLVTYP(@02),X'00'                                  0665 02465000
*   RESPECIFY                                                      0666 02466000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 02467000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 02468000
         LR    REG1,@02                                            0667 02469000
*   CALL ICBVIO00;                  /* READ BASE VOL REC     @Y30LB26*/ 02470000
         L     @15,@CV00671                                        0668 02471000
         BALR  @14,@15                                             0668 02472000
*   RESPECIFY                                                      0669 02473000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 02474000
*                                                                  0669 02475000
*   /*****************************************************************/ 02476000
*   /*                                                               */ 02477000
*   /* IF BAD RETURN CODE, SAVE REASON CODES AND RETURN      @Y30LB26*/ 02478000
*   /*                                                               */ 02479000
*   /*****************************************************************/ 02480000
*                                                                  0670 02481000
*   IF RPLVRETC¬=RCZERO             /* CK RETURN CODE        @Y30LB26*/ 02482000
*     THEN                          /*                       @Y30LB26*/ 02483000
         L     @02,RPLVPTR                                         0670 02484000
         CLC   RPLVRETC(2,@02),@CB00747                            0670 02485000
         BE    @RF00670                                            0670 02486000
*     DO;                           /*                       @Y30LB26*/ 02487000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Y30LB26*/ 02488000
         BAL   @14,ERREXIT                                         0672 02489000
*       RETURN;                     /*                       @Y30LB26*/ 02490000
@EL00009 DS    0H                                                  0673 02491000
@EF00009 DS    0H                                                  0673 02492000
@ER00009 L     @14,@SA00009                                        0673 02493000
         BR    @14                                                 0673 02494000
*     END;                          /*                       @Y30LB26*/ 02495000
*   BASEVPTR=ADDR(STORBASE);        /* GET ADDR BASE REC     @Y30LB26*/ 02496000
@RF00670 LA    @02,STORBASE                                        0675 02497000
         ST    @02,BASEVPTR                                        0675 02498000
*                                                                  0676 02499000
*   /*****************************************************************/ 02500000
*   /*                                                               */ 02501000
*   /* CHECK TO SEE IF BASE VOL HAS COPIES                   @Y30LB26*/ 02502000
*   /* AND NOT A PLACE HOLDER                                @ZDR2053*/ 02503000
*   /*                                                               */ 02504000
*   /*****************************************************************/ 02505000
*                                                                  0676 02506000
*   IF BASNCOPY¬=ZERO&BASHOLD=OFF   /* BASE HAVE COPIES &    @ZDR2053*/ 02507000
*     THEN                          /* NOT A PLACE HOLDER    @ZDR2053*/ 02508000
*                                                                  0676 02509000
         CLI   BASNCOPY(@02),0                                     0676 02510000
         BE    @RF00676                                            0676 02511000
         TM    BASHOLD(@02),B'10000000'                            0676 02512000
         BNZ   @RF00676                                            0676 02513000
*     /***************************************************************/ 02514000
*     /*                                                             */ 02515000
*     /* IF COPIES EXIST, SET REASON CODE AND RETURN         @Y30LB26*/ 02516000
*     /*                                                             */ 02517000
*     /***************************************************************/ 02518000
*                                                                  0677 02519000
*     DO;                           /*                       @Y30LB26*/ 02520000
*       RPLVRETC=FOUR;              /* SET BAD RETURN CODE   @Y30LB26*/ 02521000
         L     @02,RPLVPTR                                         0678 02522000
         MVC   RPLVRETC(2,@02),@CB00749                            0678 02523000
*       RPLRCODE=BASCPYER;          /* INDICATE COPIES       @Y30LB26*/ 02524000
         MVC   RPLRCODE(2,@02),@CB00795                            0679 02525000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Y30LB26*/ 02526000
         BAL   @14,ERREXIT                                         0680 02527000
*       RETURN;                     /*                       @Y30LB26*/ 02528000
         B     @EL00009                                            0681 02529000
*     END;                          /*                       @Y30LB26*/ 02530000
*   ELSE                            /*                       @Y30LB26*/ 02531000
*                                                                  0683 02532000
*     /***************************************************************/ 02533000
*     /*                                                             */ 02534000
*     /* GO REMOVE BASE VOLUME RECORD                        @Y30LB26*/ 02535000
*     /*                                                             */ 02536000
*     /***************************************************************/ 02537000
*                                                                  0683 02538000
*     DO;                           /*                       @Y30LB26*/ 02539000
@RF00676 DS    0H                                                  0684 02540000
*       CALL DELEVOL;               /* GO DELE VOL REC       @Y30LB26*/ 02541000
         BAL   @14,DELEVOL                                         0684 02542000
*                                                                  0685 02543000
*       /*************************************************************/ 02544000
*       /*                                                           */ 02545000
*       /* IF BAD RETURN CODE, INVENTORY IS ALREADY          @Y30LB26*/ 02546000
*       /* RELEASED, SO JUST RETURN.                         @Y30LB26*/ 02547000
*       /*                                                           */ 02548000
*       /*************************************************************/ 02549000
*                                                                  0685 02550000
*       IF RPLVRETC¬=RCZERO         /* RECORD DELETED OK ?   @Y30LB26*/ 02551000
*         THEN                                                     0685 02552000
         L     @02,RPLVPTR                                         0685 02553000
         CLC   RPLVRETC(2,@02),@CB00747                            0685 02554000
         BNE   @RT00685                                            0685 02555000
*         RETURN;                   /*                       @Y30LB26*/ 02556000
*     END;                          /*                       @Y30LB26*/ 02557000
*                                                                  0688 02558000
*   /*****************************************************************/ 02559000
*   /*                                                               */ 02560000
*   /* READ FOR A DUPLICATE OF VOLUME JUST ERASED            @Y30LB26*/ 02561000
*   /*                                                               */ 02562000
*   /*****************************************************************/ 02563000
*                                                                  0688 02564000
*   DVOLKY=RVRVOLID;                /* REMOVED VOL NAME      @Y30LB26*/ 02565000
         L     @01,RVRPTR                                          0688 02566000
         MVC   DVOLKY(6),RVRVOLID(@01)                             0688 02567000
*   RPLVKEY=ADDR(DKEY);             /* GET ADDR OF KEY       @Y30LB26*/ 02568000
         LA    @15,DKEY                                            0689 02569000
         ST    @15,RPLVKEY(,@02)                                   0689 02570000
*   RPLVBUF=ADDR(STORDUP);          /* ADDR OF BUFFER        @Y30LB26*/ 02571000
         LA    @15,STORDUP                                         0690 02572000
         ST    @15,RPLVBUF(,@02)                                   0690 02573000
*   RPLVBLN=LENGTH(STORDUP);        /* LENGTH OF BUFFER      @Y30LB26*/ 02574000
         MVC   RPLVBLN(4,@02),@CF01147                             0691 02575000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 02576000
         OI    RPLVDIR(@02),B'01000000'                            0692 02577000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 02578000
         MVI   RPLVTYP(@02),X'00'                                  0693 02579000
*   RPLVKGE=ON;                     /* READ FOR > OR =       @Y30LB26*/ 02580000
         OI    RPLVKGE(@02),B'00000100'                            0694 02581000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       @Y30LB26*/ 02582000
         OI    RPLVUPD(@02),B'00000010'                            0695 02583000
*   RESPECIFY                                                      0696 02584000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 02585000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 02586000
         LR    REG1,@02                                            0697 02587000
*   CALL ICBVIO00;                  /* READ FOR DUP REC      @Y30LB26*/ 02588000
         L     @15,@CV00671                                        0698 02589000
         BALR  @14,@15                                             0698 02590000
*   RESPECIFY                                                      0699 02591000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 02592000
*                                                                  0699 02593000
*   /*****************************************************************/ 02594000
*   /*                                                               */ 02595000
*   /* CK FOR BAD RETURN CODE                                @Y30LB26*/ 02596000
*   /*                                                               */ 02597000
*   /*****************************************************************/ 02598000
*                                                                  0700 02599000
*   IF RPLVRETC¬=RCZERO             /* CHECK RET CODE        @Y30LB26*/ 02600000
*     THEN                          /*                       @Y30LB26*/ 02601000
         L     @02,RPLVPTR                                         0700 02602000
         CLC   RPLVRETC(2,@02),@CB00747                            0700 02603000
         BE    @RF00700                                            0700 02604000
*     DO;                           /*                       @Y30LB26*/ 02605000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 02606000
         BAL   @14,ERREXIT                                         0702 02607000
*       RETURN;                     /*                       @Y30LB26*/ 02608000
         B     @EL00009                                            0703 02609000
*     END;                          /*                       @Y30LB26*/ 02610000
*   DUPVPTR=ADDR(STORDUP);          /* PTR TO DUP REC        @Y30LB26*/ 02611000
*                                                                  0705 02612000
@RF00700 LA    @02,STORDUP                                         0705 02613000
         ST    @02,DUPVPTR                                         0705 02614000
*   /*****************************************************************/ 02615000
*   /*                                                               */ 02616000
*   /* CHECK THAT IT IS A DUP AND FOR CORRECT VOL            @Y30LB26*/ 02617000
*   /*                                                               */ 02618000
*   /*****************************************************************/ 02619000
*                                                                  0706 02620000
*   IF DUPD=DKY&DUPSERNO=RVRVOLID   /* CK DUP, CORRECT VOL   @Y30LB26*/ 02621000
*     THEN                          /*                       @Y30LB26*/ 02622000
         CLC   DUPD(5,@02),DKY                                     0706 02623000
         BNE   @RF00706                                            0706 02624000
         L     @01,RVRPTR                                          0706 02625000
         CLC   DUPSERNO(6,@02),RVRVOLID(@01)                       0706 02626000
         BNE   @RF00706                                            0706 02627000
*     DO;                           /*                       @Y30LB26*/ 02628000
*                                                                  0707 02629000
*       /*************************************************************/ 02630000
*       /*                                                           */ 02631000
*       /* IF DUP FOUND, CHECK IF OLD BASE WAS GROUPED       @Y30LB26*/ 02632000
*       /* OR NOT A PLACE HOLDER                             @ZDR2053*/ 02633000
*       /*                                                           */ 02634000
*       /*************************************************************/ 02635000
*                                                                  0708 02636000
*       DUPFNDFL=ON;                /* DUPLICATE FOUND       @Y30LB26*/ 02637000
         OI    DUPFNDFL,B'00010000'                                0708 02638000
*       IF BASGRPV=OFF&BASHOLD=OFF THEN/* NOT GROUPED        @ZDR2053   02639000
*                                      OR A PLACE HOLDER     @ZDR2053*/ 02640000
         L     @02,BASEVPTR                                        0709 02641000
         TM    BASGRPV(@02),B'00100000'                            0709 02642000
         BNZ   @RF00709                                            0709 02643000
         TM    BASHOLD(@02),B'10000000'                            0709 02644000
         BNZ   @RF00709                                            0709 02645000
*         DO;                       /*                       @Y30LB26*/ 02646000
*                                                                  0710 02647000
*           /*********************************************************/ 02648000
*           /*                                                       */ 02649000
*           /* IF OLD RECORD NON-GROUPED, SET FLAG SO IT     @Y30LB26*/ 02650000
*           /* WONT BE CHAINED INTO NON-GROUPED AGAIN        @Y30LB26*/ 02651000
*           /*                                                       */ 02652000
*           /*********************************************************/ 02653000
*                                                                  0711 02654000
*           DUPBCHI=OFF;            /* DONT CHAIN IN NON-GRP @Y30LB26*/ 02655000
*                                                                  0711 02656000
         NI    DUPBCHI,B'01111111'                                 0711 02657000
*           /*********************************************************/ 02658000
*           /*                                                       */ 02659000
*           /* SET INFORMATION NEEDED TO MAKE NEW            @Y30LB26*/ 02660000
*           /* BASE RECORD FIT IN NON-GROUPED WITHOUT        @Y30LB26*/ 02661000
*           /* ACTUALLY BEING CHAIN IN                       @Y30LB26*/ 02662000
*           /*                                                       */ 02663000
*           /*********************************************************/ 02664000
*                                                                  0712 02665000
*           SAVEPREV=BASPREV;       /* SAVE PREV CHAIN       @Y30LB26*/ 02666000
         MVC   SAVEPREV(6),BASPREV(@02)                            0712 02667000
*           SAVENEXT=BASNEXTV;      /* SAVE NEXT CHAIN       @Y30LB26*/ 02668000
         MVC   SAVENEXT(6),BASNEXTV(@02)                           0713 02669000
*           IF BASFIRST=ON THEN     /* 1ST IN CHAIN          @Y30LB26*/ 02670000
         TM    BASFIRST(@02),B'00010000'                           0714 02671000
         BNO   @RF00714                                            0714 02672000
*             FCHNDBR=ON;           /* INDICATE FIRST        @Y30LB26*/ 02673000
         OI    FCHNDBR,B'01000000'                                 0715 02674000
*           IF BASLAST=ON THEN      /* LAST IN CHAIN         @Y30LB26*/ 02675000
@RF00714 L     @02,BASEVPTR                                        0716 02676000
         TM    BASLAST(@02),B'00001000'                            0716 02677000
         BNO   @RF00716                                            0716 02678000
*             LCHNDBR=ON;           /* INDICATE LAST         @Y30LB26*/ 02679000
         OI    LCHNDBR,B'00100000'                                 0717 02680000
*         END;                      /*                       @Y30LB26*/ 02681000
*                                                                  0718 02682000
*       /*************************************************************/ 02683000
*       /*                                                           */ 02684000
*       /* IF WAS GROUPED BEFORE, SET FLAG SO IT             @Y30LB26*/ 02685000
*       /* WILL BE CHAINED INTO NON-GROUPED                  @Y30LB26*/ 02686000
*       /*                                                           */ 02687000
*       /*************************************************************/ 02688000
*                                                                  0719 02689000
*       ELSE                        /*                       @Y30LB26*/ 02690000
*         DUPBCHI=ON;               /* CHIAN IN NON-GRP      @Y30LB26*/ 02691000
         B     @RC00709                                            0719 02692000
@RF00709 OI    DUPBCHI,B'10000000'                                 0719 02693000
*     END;                          /*                       @Y30LB26*/ 02694000
@RC00709 DS    0H                                                  0721 02695000
*                                                                  0721 02696000
*   /*****************************************************************/ 02697000
*   /*                                                               */ 02698000
*   /* CHECK FOR A PLACE HOLDER                              @ZDR2053*/ 02699000
*   /*                                                               */ 02700000
*   /*****************************************************************/ 02701000
*                                                                  0721 02702000
*   IF BASHOLD=OFF THEN                                            0721 02703000
@RF00706 L     @02,BASEVPTR                                        0721 02704000
         TM    BASHOLD(@02),B'10000000'                            0721 02705000
         BNZ   @RF00721                                            0721 02706000
*     DO;                           /*                       @ZDR2053*/ 02707000
*                                                                  0722 02708000
*       /*************************************************************/ 02709000
*       /*                                                           */ 02710000
*       /* IF GROUPED RECORD GO PROCESS BASE OUT OF GROUP    @Y30LB26*/ 02711000
*       /*                                                           */ 02712000
*       /*************************************************************/ 02713000
*                                                                  0723 02714000
*       IF BASGRPV=ON THEN          /* THIS GROUPED RECORD   @Y30LB26*/ 02715000
         TM    BASGRPV(@02),B'00100000'                            0723 02716000
         BNO   @RF00723                                            0723 02717000
*         DO;                       /*                       @Y30LB26*/ 02718000
*           CALL PROCGRP;           /* GO UPDATE GRP REC     @Y30LB26*/ 02719000
*                                                                  0725 02720000
         BAL   @14,PROCGRP                                         0725 02721000
*           /*********************************************************/ 02722000
*           /*                                                       */ 02723000
*           /* CHECK RETURN FROM PROCGRP ROUTINE             @Y30LB26*/ 02724000
*           /*                                                       */ 02725000
*           /*********************************************************/ 02726000
*                                                                  0726 02727000
*           IF RPLRCODE¬=RCZERO THEN/* CK RETURN             @Y30LB26*/ 02728000
         L     @02,RPLVPTR                                         0726 02729000
         CLC   RPLRCODE(2,@02),@CB00747                            0726 02730000
         BNE   @RT00726                                            0726 02731000
*             RETURN;               /*                       @Y30LB26*/ 02732000
*         END;                      /*                       @Y30LB26*/ 02733000
*       ELSE                        /*                       @Y30LB26*/ 02734000
*         DO;                       /*                       @Y30LB26*/ 02735000
*                                                                  0729 02736000
         B     @RC00723                                            0729 02737000
@RF00723 DS    0H                                                  0730 02738000
*           /*********************************************************/ 02739000
*           /*                                                       */ 02740000
*           /* IF DUP NOT FOUND, CHAIN OUT OF NON-GROUPED    @Y30LB26*/ 02741000
*           /*                                                       */ 02742000
*           /*********************************************************/ 02743000
*                                                                  0730 02744000
*           IF DUPFNDFL=OFF         /* SEE IF DUP FOUND      @Y30LB26*/ 02745000
*             THEN                  /*                       @Y30LB26*/ 02746000
         TM    DUPFNDFL,B'00010000'                                0730 02747000
         BNZ   @RF00730                                            0730 02748000
*             DO;                   /*                       @Y30LB26*/ 02749000
*               CHICHOGP=OFF;       /* INDICATE NON-GRPED    @Y30LB26*/ 02750000
         NI    CHICHOGP,B'11101111'                                0732 02751000
*               CALL ICBVUCHO(0,BASEVPTR,/*                  @Y30LB26*/ 02752000
*                   RPLVPTR,PASSFLAG);/* CHAIN OUT NON-GRP   @Y30LB26*/ 02753000
         L     @15,@CV00675                                        0733 02754000
         LA    @01,@AL00733                                        0733 02755000
         BALR  @14,@15                                             0733 02756000
*               IF RPLVRETC¬=RCZERO /* CK RET CODE           @Y30LB26*/ 02757000
*                 THEN              /*                       @Y30LB26*/ 02758000
         L     @02,RPLVPTR                                         0734 02759000
         CLC   RPLVRETC(2,@02),@CB00747                            0734 02760000
         BE    @RF00734                                            0734 02761000
*                 DO;               /*                       @Y30LB26*/ 02762000
*                   CALL ERREXIT;   /* SAVE RET CODES        @Y30LB26*/ 02763000
         BAL   @14,ERREXIT                                         0736 02764000
*                   RETURN;         /*                       @Y30LB26*/ 02765000
         B     @EL00009                                            0737 02766000
*                 END;              /*                       @Y30LB26*/ 02767000
*             END;                  /*                       @Y30LB26*/ 02768000
@RF00734 DS    0H                                                  0740 02769000
*         END;                      /*                       @Y30LB26*/ 02770000
@RF00730 DS    0H                                                  0741 02771000
*     END;                          /*                       @ZDR2053*/ 02772000
@RC00723 DS    0H                                                  0742 02773000
*                                                                  0742 02774000
*   /*****************************************************************/ 02775000
*   /*                                                               */ 02776000
*   /* IF DUPLICATE FOUND, CONVERT IT TO BASE                @Y30LB26*/ 02777000
*   /*                                                               */ 02778000
*   /*****************************************************************/ 02779000
*                                                                  0742 02780000
*   IF DUPFNDFL=ON THEN             /* DUP REC FOUND         @Y30LB26*/ 02781000
@RF00721 TM    DUPFNDFL,B'00010000'                                0742 02782000
         BNO   @RF00742                                            0742 02783000
*     DO;                           /*                       @Y30LB26*/ 02784000
*       CALL VUDBR;                 /* DUP TO BASE ROUTN     @Y30LB26*/ 02785000
*                                                                  0744 02786000
         BAL   @14,VUDBR                                           0744 02787000
*       /*************************************************************/ 02788000
*       /*                                                           */ 02789000
*       /* CK RETURN CODE                                    @Y30LB26*/ 02790000
*       /*                                                           */ 02791000
*       /*************************************************************/ 02792000
*                                                                  0745 02793000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RET CODE           @Y30LB26*/ 02794000
         L     @02,RPLVPTR                                         0745 02795000
         CLC   RPLVRETC(2,@02),@CB00747                            0745 02796000
         BE    @RF00745                                            0745 02797000
*         DO;                       /*                       @Y30LB26*/ 02798000
*           CALL ERREXIT;           /* SAVE RET CODES        @Y30LB26*/ 02799000
         BAL   @14,ERREXIT                                         0747 02800000
*           RETURN;                 /*                       @Y30LB26*/ 02801000
         B     @EL00009                                            0748 02802000
*         END;                      /*                       @Y30LB26*/ 02803000
*                                                                  0749 02804000
*       /*************************************************************/ 02805000
*       /*                                                           */ 02806000
*       /* SEE IF CHAINING INTO NON-GROUP CHAIN IS           @Y30LB26*/ 02807000
*       /* NECESSARY                                         @Y30LB26*/ 02808000
*       /*                                                           */ 02809000
*       /*************************************************************/ 02810000
*                                                                  0750 02811000
*       IF DUPBCHI=ON THEN          /* CHAIN IN NEW BASE     @Y30LB26*/ 02812000
@RF00745 TM    DUPBCHI,B'10000000'                                 0750 02813000
         BNO   @RF00750                                            0750 02814000
*         DO;                       /*                       @Y30LB26*/ 02815000
*           CHICHOGP=OFF;           /* INDICATE NON-GROUPED  @Y30LB26*/ 02816000
         NI    CHICHOGP,B'11101111'                                0752 02817000
*           CALL ICBVUCHI(0,BASEVPTR,RPLVPTR,/*              @Y30LB26*/ 02818000
*               PASSFLAG);          /*                       @Y30LB26*/ 02819000
         L     @15,@CV00674                                        0753 02820000
         LA    @01,@AL00753                                        0753 02821000
         BALR  @14,@15                                             0753 02822000
*           IF RPLVRETC¬=RCZERO THEN/*                       @Y30LB26*/ 02823000
         L     @02,RPLVPTR                                         0754 02824000
         CLC   RPLVRETC(2,@02),@CB00747                            0754 02825000
         BE    @RF00754                                            0754 02826000
*             DO;                   /*                       @Y30LB26*/ 02827000
*               CALL ERREXIT;       /*                       #Y30LB26*/ 02828000
         BAL   @14,ERREXIT                                         0756 02829000
*               RETURN;             /*                       #Y30LB26*/ 02830000
         B     @EL00009                                            0757 02831000
*             END;                  /*                       #Y30LB26*/ 02832000
*         END;                      /*                       #Y30LB26*/ 02833000
*                                                                  0759 02834000
@RF00754 DS    0H                                                  0760 02835000
*       /*************************************************************/ 02836000
*       /*                                                           */ 02837000
*       /* WRITE CREATED BASE VOLUME RECORD                  #Y30LB26*/ 02838000
*       /*                                                           */ 02839000
*       /*************************************************************/ 02840000
*                                                                  0760 02841000
*       RPLVBUF=ADDR(BASEREC);      /* BUFFER ADDRESS        #Y30LB26*/ 02842000
@RF00750 L     @02,RPLVPTR                                         0760 02843000
         LA    @15,BASEREC                                         0760 02844000
         ST    @15,RPLVBUF(,@02)                                   0760 02845000
*       RPLVRLN=LENGTH(BASEV);      /* LENGTH RECORD         #Y30LB26*/ 02846000
         LA    @15,224                                             0761 02847000
         ST    @15,RPLVRLN(,@02)                                   0761 02848000
*       RPLVBLN=LENGTH(BASEV);      /* LENGTH BUFFER         @Y30LB26*/ 02849000
         ST    @15,RPLVBLN(,@02)                                   0762 02850000
*       RPLVLOC=OFF;                /* NO LOCATE             @Y30LB26*/ 02851000
         NI    RPLVLOC(@02),B'01111111'                            0763 02852000
*       RPLVTYP=RPLVPUT;            /* WRITE RECORD          @Y30LB26*/ 02853000
         MVI   RPLVTYP(@02),X'01'                                  0764 02854000
*       RPLVUPD=OFF;                /* NO UPDATE             @Y30LB26*/ 02855000
         NI    RPLVUPD(@02),B'11111101'                            0765 02856000
*       RESPECIFY                                                  0766 02857000
*         REG1 RSTD;                /* RESTRICT              @Y30LB26*/ 02858000
*       REG1=RPLVPTR;               /* ADDR RPLV             @Y30LB26*/ 02859000
         LR    REG1,@02                                            0767 02860000
*       CALL ICBVIO00;              /* WRITE BASE VOL REC    @Y30LB26*/ 02861000
         L     @15,@CV00671                                        0768 02862000
         BALR  @14,@15                                             0768 02863000
*       RESPECIFY                                                  0769 02864000
*         REG1 UNRSTD;              /* FREE REG 1            @Y30LB26*/ 02865000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @Y30LB26*/ 02866000
         L     @02,RPLVPTR                                         0770 02867000
         CLC   RPLVRETC(2,@02),@CB00747                            0770 02868000
         BE    @RF00770                                            0770 02869000
*         DO;                       /*                       @Y30LB26*/ 02870000
*           CALL ERREXIT;           /* SAVE RET CODES        @Y30LB26*/ 02871000
         BAL   @14,ERREXIT                                         0772 02872000
*           RETURN;                 /*                       @Y30LB26*/ 02873000
         B     @EL00009                                            0773 02874000
*         END;                      /*                       @Y30LB26*/ 02875000
*     END;                          /*                       @Y30LB26*/ 02876000
*   RETURN;                         /*                       @Y30LB26*/ 02877000
         B     @EL00009                                            0776 02878000
*   END REMOVBAS;                   /* END BASE ROUTINE      @Y30LB26*/ 02879000
         B     @EL00009                                            0777 02880000
*                                                                  0778 02881000
*   /*****************************************************************/ 02882000
*   /*                                                               */ 02883000
*   /* THIS ROUTINE REMOVES THE VOLUME RECORD(BASE OR COPY)  @Y30LB26*/ 02884000
*   /* AND TAKES CARE OF THE INDEX RECORDS                   @Y30LB26*/ 02885000
*   /*                                                               */ 02886000
*   /*****************************************************************/ 02887000
*                                                                  0778 02888000
*DELEVOL:                                                          0778 02889000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 02890000
DELEVOL  ST    @14,@SA00010                                        0778 02891000
*                                                                  0779 02892000
*   /*****************************************************************/ 02893000
*   /*                                                               */ 02894000
*   /* CALL ROUTINE TO SEE IF CARTRIDGE INDEX RECORDS ARE    @Y30LB26*/ 02895000
*   /* IN LIBRARY AND IF THEY ARE AND BELONG TO              @Y30LB26*/ 02896000
*   /* THE RIGHT VOLUME, ERASE THEM......                    @Y30LB26*/ 02897000
*   /* NOT DONE FOR PLACE HOLDERS BECAUSE THEY HAVE NO       @ZDR2053*/ 02898000
*   /* CARTRIDGE INDEX RECORDS                               @ZDR2053*/ 02899000
*   /*                                                               */ 02900000
*   /*****************************************************************/ 02901000
*                                                                  0779 02902000
*   IF RVRBASEV=ON THEN                                            0779 02903000
         L     @02,RVRPTR                                          0779 02904000
         TM    RVRBASEV(@02),B'10000000'                           0779 02905000
         BNO   @RF00779                                            0779 02906000
*     BCDVPTR=BASEVPTR;             /* BASE RECORD           @ZA16139*/ 02907000
         L     BCDVPTR,BASEVPTR                                    0780 02908000
*   ELSE                            /*                       @ZA16139*/ 02909000
*     BCDVPTR=COPYVPTR;             /* COPY RECORD           @ZA16139*/ 02910000
         B     @RC00779                                            0781 02911000
@RF00779 L     BCDVPTR,COPYVPTR                                    0781 02912000
*   IF BCDHOLD=ON THEN              /*                       @ZA16139*/ 02913000
@RC00779 TM    BCDHOLD(BCDVPTR),B'10000000'                        0782 02914000
         BO    @RT00782                                            0782 02915000
*     ;                             /*                       @ZDR2053*/ 02916000
*   ELSE                                                           0784 02917000
*     DO;                           /*                       @ZDR2053*/ 02918000
*       CALL CHKCART;               /* SEE IF CART IN LIB    @Y30LB26*/ 02919000
         BAL   @14,CHKCART                                         0785 02920000
*       IF RPLVRETC¬=RCZERO THEN    /* CHK CART OK           @Y30LB26*/ 02921000
         L     @02,RPLVPTR                                         0786 02922000
         CLC   RPLVRETC(2,@02),@CB00747                            0786 02923000
         BNE   @RT00786                                            0786 02924000
*         RETURN;                   /*                       @Y30LB26*/ 02925000
*     END;                          /*                       @ZDR2053*/ 02926000
*                                                                  0789 02927000
*   /*****************************************************************/ 02928000
*   /*                                                               */ 02929000
*   /* READ BASE OR COPY RECORD TO BE DELETED                @Y30LB26*/ 02930000
*   /* FOR UPDATE SO IT CAN BE DELETED                       @Y30LB26*/ 02931000
*   /*                                                               */ 02932000
*   /*****************************************************************/ 02933000
*                                                                  0789 02934000
*   RPLVKEY=ADDR(VKEY);             /* ADDR KEY FOR VOL      @Y30LB26*/ 02935000
@RT00782 L     @02,RPLVPTR                                         0789 02936000
         LA    @15,VKEY                                            0789 02937000
         ST    @15,RPLVKEY(,@02)                                   0789 02938000
*   RPLVBUF=ADDR(STORBASE);         /* BUFFER ADDR           @Y30LB26*/ 02939000
         LA    @15,STORBASE                                        0790 02940000
         ST    @15,RPLVBUF(,@02)                                   0790 02941000
*   RPLVBLN=LENGTH(STORBASE);       /* BUFFER LENGTH         @Y30LB26*/ 02942000
         MVC   RPLVBLN(4,@02),@CF01147                             0791 02943000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 02944000
         OI    RPLVDIR(@02),B'01000000'                            0792 02945000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 02946000
         MVI   RPLVTYP(@02),X'00'                                  0793 02947000
*   RPLVUPD=ON;                     /* FOR UPDATE            @Y30LB26*/ 02948000
         OI    RPLVUPD(@02),B'00000010'                            0794 02949000
*   RESPECIFY                                                      0795 02950000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 02951000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 02952000
         LR    REG1,@02                                            0796 02953000
*   CALL ICBVIO00;                  /* READ VOL FOR UPDATE   @Y30LB26*/ 02954000
         L     @15,@CV00671                                        0797 02955000
         BALR  @14,@15                                             0797 02956000
*   RESPECIFY                                                      0798 02957000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 02958000
*                                                                  0798 02959000
*   /*****************************************************************/ 02960000
*   /*                                                               */ 02961000
*   /* CHECK RETURN FROM READING VOL RECORD                  @Y30LB26*/ 02962000
*   /*                                                               */ 02963000
*   /*****************************************************************/ 02964000
*                                                                  0799 02965000
*   IF RPLVRETC¬=RCZERO             /* CK RET CODES          @Y30LB26*/ 02966000
*     THEN                          /*                       @Y30LB26*/ 02967000
         L     @02,RPLVPTR                                         0799 02968000
         CLC   RPLVRETC(2,@02),@CB00747                            0799 02969000
         BE    @RF00799                                            0799 02970000
*     DO;                           /*                       @Y30LB26*/ 02971000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 02972000
         BAL   @14,ERREXIT                                         0801 02973000
*       RETURN;                     /*                       @Y30LB26*/ 02974000
@EL00010 DS    0H                                                  0802 02975000
@EF00010 DS    0H                                                  0802 02976000
@ER00010 L     @14,@SA00010                                        0802 02977000
         BR    @14                                                 0802 02978000
*     END;                          /*                       @Y30LB26*/ 02979000
*                                                                  0804 02980000
*   /*****************************************************************/ 02981000
*   /*                                                               */ 02982000
*   /* DELETE VOL RECORD (BASE OR COPY RECORD)               @Y30LB26*/ 02983000
*   /*                                                               */ 02984000
*   /*****************************************************************/ 02985000
*                                                                  0804 02986000
*   RPLVTYP=RPLVDEL;                /* DELETE RECORD         @Y30LB26*/ 02987000
@RF00799 L     @02,RPLVPTR                                         0804 02988000
         MVI   RPLVTYP(@02),X'05'                                  0804 02989000
*   RESPECIFY                                                      0805 02990000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 02991000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 02992000
         LR    REG1,@02                                            0806 02993000
*   CALL ICBVIO00;                  /* DELETE VOL REC        @Y30LB26*/ 02994000
         L     @15,@CV00671                                        0807 02995000
         BALR  @14,@15                                             0807 02996000
*   RESPECIFY                                                      0808 02997000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 02998000
*   IF RPLVRETC¬=RCZERO             /* DELETED OK ?          @Y30LB26*/ 02999000
*     THEN                          /*                       @Y30LB26*/ 03000000
         L     @02,RPLVPTR                                         0809 03001000
         CLC   RPLVRETC(2,@02),@CB00747                            0809 03002000
         BE    @RF00809                                            0809 03003000
*     DO;                           /*                       @Y30LB26*/ 03004000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 03005000
         BAL   @14,ERREXIT                                         0811 03006000
*       RETURN;                     /*                       @Y30LB26*/ 03007000
         B     @EL00010                                            0812 03008000
*     END;                          /*                       @Y30LB26*/ 03009000
*   ELSE                            /*                       @Y30LB26*/ 03010000
*     DO;                           /*                       @Y30LB26*/ 03011000
@RF00809 DS    0H                                                  0815 03012000
*       IF JRNLEDSW=OFF THEN        /* NOT JOURNALED?        @Y30LB26*/ 03013000
         TM    JRNLEDSW,B'00000001'                                0815 03014000
         BNZ   @RF00815                                            0815 03015000
*         DO;                       /*                       @Y30LB26*/ 03016000
*           CALL JOURNAL;           /* JOURNAL RPLV          @Y30LB26*/ 03017000
         BAL   @14,JOURNAL                                         0817 03018000
*           IF RPLVRETC¬=RCZERO THEN/* CK RETURN             @Y30LB26*/ 03019000
         L     @02,RPLVPTR                                         0818 03020000
         CLC   RPLVRETC(2,@02),@CB00747                            0818 03021000
         BNE   @RT00818                                            0818 03022000
*             RETURN;               /*                       @Y30LB26*/ 03023000
*         END;                      /*                       @Y30LB26*/ 03024000
*     END;                          /*                       @Y30LB26*/ 03025000
*   RETURN;                         /*                       @Y30LB26*/ 03026000
         B     @EL00010                                            0822 03027000
*   END DELEVOL;                    /* END DELETE VOL RTN    @Y30LB26*/ 03028000
         B     @EL00010                                            0823 03029000
*                                                                  0824 03030000
*   /*****************************************************************/ 03031000
*   /*                                                               */ 03032000
*   /* ROUTINE REMOVES BASE VOLUME RECORD FROM GROUP CHAIN   @Y30LB26*/ 03033000
*   /* AND UPDATES APPROPRIATE FIELDS IN THE GROUP RECORD    @Y30LB26*/ 03034000
*   /*                                                               */ 03035000
*   /*****************************************************************/ 03036000
*                                                                  0824 03037000
*PROCGRP:                                                          0824 03038000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 03039000
PROCGRP  ST    @14,@SA00011                                        0824 03040000
*                                                                  0825 03041000
*   /*****************************************************************/ 03042000
*   /*                                                               */ 03043000
*   /* READ GROUP RECORD                                     @Y30LB26*/ 03044000
*   /*                                                               */ 03045000
*   /*****************************************************************/ 03046000
*                                                                  0825 03047000
*   GROUPKY=BASGROUP;               /* GET GROUP IN KEY      @Y30LB26*/ 03048000
         L     @02,BASEVPTR                                        0825 03049000
         MVC   GROUPKY(8),BASGROUP(@02)                            0825 03050000
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @Y30LB26*/ 03051000
         L     @02,RPLVPTR                                         0826 03052000
         LA    @15,GKEY                                            0826 03053000
         ST    @15,RPLVKEY(,@02)                                   0826 03054000
*   RPLVBUF=ADDR(STORGRP);          /* ADDR OF BUFFER        @Y30LB26*/ 03055000
         LA    @15,STORGRP                                         0827 03056000
         ST    @15,RPLVBUF(,@02)                                   0827 03057000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH OF BUFFER      @Y30LB26*/ 03058000
         MVC   RPLVBLN(4,@02),@CF01147                             0828 03059000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 03060000
         OI    RPLVDIR(@02),B'01000000'                            0829 03061000
*   RPLVTYP=RPLVREAD;               /* READ REC              @Y30LB26*/ 03062000
         MVI   RPLVTYP(@02),X'00'                                  0830 03063000
*   RPLVUPD=ON;                     /* FOR UPDATE            @Y30LB26*/ 03064000
         OI    RPLVUPD(@02),B'00000010'                            0831 03065000
*   RPLVKGE=OFF;                    /* NOT FOR > OR =        @Y30LB26*/ 03066000
         NI    RPLVKGE(@02),B'11111011'                            0832 03067000
*   RESPECIFY                                                      0833 03068000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 03069000
*   REG1=RPLVPTR;                   /* GET ADDR OF RPLV      @Y30LB26*/ 03070000
         LR    REG1,@02                                            0834 03071000
*   CALL ICBVIO00;                  /* READ GROUP REC        @Y30LB26*/ 03072000
         L     @15,@CV00671                                        0835 03073000
         BALR  @14,@15                                             0835 03074000
*   RESPECIFY                                                      0836 03075000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 03076000
*                                                                  0836 03077000
*   /*****************************************************************/ 03078000
*   /*                                                               */ 03079000
*   /* CHECK RETURN CODE FROM I/O PROCESSOR                  @Y30LB26*/ 03080000
*   /*                                                               */ 03081000
*   /*****************************************************************/ 03082000
*                                                                  0837 03083000
*   IF RPLVRETC¬=RCZERO             /* GET RECORD ?          @Y30LB26*/ 03084000
*     THEN                          /*                       @Y30LB26*/ 03085000
         L     @02,RPLVPTR                                         0837 03086000
         CLC   RPLVRETC(2,@02),@CB00747                            0837 03087000
         BE    @RF00837                                            0837 03088000
*     DO;                           /*                       @Y30LB26*/ 03089000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 03090000
         BAL   @14,ERREXIT                                         0839 03091000
*       RETURN;                     /*                       @Y30LB26*/ 03092000
@EL00011 DS    0H                                                  0840 03093000
@EF00011 DS    0H                                                  0840 03094000
@ER00011 L     @14,@SA00011                                        0840 03095000
         BR    @14                                                 0840 03096000
*     END;                          /*                       @Y30LB26*/ 03097000
*                                                                  0842 03098000
*   /*****************************************************************/ 03099000
*   /*                                                               */ 03100000
*   /* SET UP ADDRESSABILITY TO GROUP RECORD                 @Y30LB26*/ 03101000
*   /*                                                               */ 03102000
*   /*****************************************************************/ 03103000
*                                                                  0842 03104000
*   GROUPPTR=ADDR(STORGRP);         /* PTR TO GROUP REC      @Y30LB26*/ 03105000
@RF00837 LA    @02,STORGRP                                         0842 03106000
         ST    @02,GROUPPTR                                        0842 03107000
*                                                                  0843 03108000
*   /*****************************************************************/ 03109000
*   /*                                                               */ 03110000
*   /* UPDATE GROUP INACTIVE VOLUMES COUNT                   @Y30LB26*/ 03111000
*   /*                                                               */ 03112000
*   /*****************************************************************/ 03113000
*                                                                  0843 03114000
*   GRONINAC=GRONINAC-ONE;          /* ONE LESS INACT VOL    @Y30LB26*/ 03115000
         LH    @15,GRONINAC(,@02)                                  0843 03116000
         BCTR  @15,0                                               0843 03117000
         STH   @15,GRONINAC(,@02)                                  0843 03118000
*                                                                  0844 03119000
*   /*****************************************************************/ 03120000
*   /*                                                               */ 03121000
*   /* GO CHAIN VOLUME OUT OF GROUP                          @Y30LB26*/ 03122000
*   /*                                                               */ 03123000
*   /*****************************************************************/ 03124000
*                                                                  0844 03125000
*   CHICHOGP=ON;                    /* INDICATE GROUPED      @Y30LB26*/ 03126000
         OI    CHICHOGP,B'00010000'                                0844 03127000
*   CALL ICBVUCHO(GROUPPTR,BASEVPTR,RPLVPTR,PASSFLAG);/*     @Y30LB26*/ 03128000
         L     @15,@CV00675                                        0845 03129000
         LA    @01,@AL00845                                        0845 03130000
         BALR  @14,@15                                             0845 03131000
*   IF RPLVRETC¬=RCZERO             /* CHAINED OK ?          @Y30LB26*/ 03132000
*     THEN                          /*                       @Y30LB26*/ 03133000
         L     @02,RPLVPTR                                         0846 03134000
         CLC   RPLVRETC(2,@02),@CB00747                            0846 03135000
         BE    @RF00846                                            0846 03136000
*     DO;                           /*                       @Y30LB26*/ 03137000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 03138000
         BAL   @14,ERREXIT                                         0848 03139000
*       RETURN;                     /*                       @Y30LB26*/ 03140000
         B     @EL00011                                            0849 03141000
*     END;                          /*                       @Y30LB26*/ 03142000
*                                                                  0851 03143000
*   /*****************************************************************/ 03144000
*   /*                                                               */ 03145000
*   /* READ GROUP RECORD TO DUMMY FOR UPDATE                 @Y30LB26*/ 03146000
*   /*                                                               */ 03147000
*   /*****************************************************************/ 03148000
*                                                                  0851 03149000
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @Y30LB26*/ 03150000
@RF00846 L     @02,RPLVPTR                                         0851 03151000
         LA    @15,GKEY                                            0851 03152000
         ST    @15,RPLVKEY(,@02)                                   0851 03153000
*   RPLVBUF=ADDR(DUMMYREC);         /* ADDR OF BUFFER        @Y30LB26*/ 03154000
         LA    @15,DUMMYREC                                        0852 03155000
         ST    @15,RPLVBUF(,@02)                                   0852 03156000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH OF BUFFER      @Y30LB26*/ 03157000
         MVC   RPLVBLN(4,@02),@CF01147                             0853 03158000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 03159000
         OI    RPLVDIR(@02),B'01000000'                            0854 03160000
*   RPLVTYP=RPLVREAD;               /* READ REC              @Y30LB26*/ 03161000
         MVI   RPLVTYP(@02),X'00'                                  0855 03162000
*   RPLVUPD=ON;                     /* FOR UPDATE            @Y30LB26*/ 03163000
         OI    RPLVUPD(@02),B'00000010'                            0856 03164000
*   RPLVKGE=OFF;                    /* NOT FOR > OR =        @Y30LB26*/ 03165000
         NI    RPLVKGE(@02),B'11111011'                            0857 03166000
*   RESPECIFY                                                      0858 03167000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 03168000
*   REG1=RPLVPTR;                   /* GET ADDR OF RPLV      @Y30LB26*/ 03169000
         LR    REG1,@02                                            0859 03170000
*   CALL ICBVIO00;                  /* READ GROUP REC        @Y30LB26*/ 03171000
         L     @15,@CV00671                                        0860 03172000
         BALR  @14,@15                                             0860 03173000
*   RESPECIFY                                                      0861 03174000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 03175000
*                                                                  0861 03176000
*   /*****************************************************************/ 03177000
*   /*                                                               */ 03178000
*   /* CHECK RETURN CODE FROM I/O PROCESSOR                  @Y30LB26*/ 03179000
*   /*                                                               */ 03180000
*   /*****************************************************************/ 03181000
*                                                                  0862 03182000
*   IF RPLVRETC¬=RCZERO             /* GET RECORD ?          @Y30LB26*/ 03183000
*     THEN                          /*                       @Y30LB26*/ 03184000
         L     @02,RPLVPTR                                         0862 03185000
         CLC   RPLVRETC(2,@02),@CB00747                            0862 03186000
         BE    @RF00862                                            0862 03187000
*     DO;                           /*                       @Y30LB26*/ 03188000
*       CALL ERREXIT;               /* SAVE RET CODES        #Y30LB26*/ 03189000
         BAL   @14,ERREXIT                                         0864 03190000
*       RETURN;                     /*                       #Y30LB26*/ 03191000
         B     @EL00011                                            0865 03192000
*     END;                          /*                       @Y30LB26*/ 03193000
*                                                                  0866 03194000
*   /*****************************************************************/ 03195000
*   /*                                                               */ 03196000
*   /* PUT OUT UPDATED GROUP RECORD                          @Y30LB26*/ 03197000
*   /*                                                               */ 03198000
*   /*****************************************************************/ 03199000
*                                                                  0867 03200000
*   RPLVBUF=ADDR(STORGRP);          /* BUFFER ADDR           @Y30LB26*/ 03201000
@RF00862 L     @02,RPLVPTR                                         0867 03202000
         LA    @15,STORGRP                                         0867 03203000
         ST    @15,RPLVBUF(,@02)                                   0867 03204000
*   RPLVTYP=RPLVPUT;                /* PUT GROUP REC         @Y30LB26*/ 03205000
         MVI   RPLVTYP(@02),X'01'                                  0868 03206000
*   RESPECIFY                                                      0869 03207000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 03208000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 03209000
         LR    REG1,@02                                            0870 03210000
*   CALL ICBVIO00;                  /* WRITE GROUP REC       @Y30LB26*/ 03211000
         L     @15,@CV00671                                        0871 03212000
         BALR  @14,@15                                             0871 03213000
*   RESPECIFY                                                      0872 03214000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 03215000
*                                                                  0872 03216000
*   /*****************************************************************/ 03217000
*   /*                                                               */ 03218000
*   /* CHECK OUT RETURN CODE                                 @VS32198*/ 03219000
*   /*                                                               */ 03220000
*   /*****************************************************************/ 03221000
*                                                                  0873 03222000
*   IF RPLVRETC¬=RCZERO             /* CK RET CODE           @Y30LB26*/ 03223000
*     THEN                          /*                       @Y30LB26*/ 03224000
         L     @02,RPLVPTR                                         0873 03225000
         CLC   RPLVRETC(2,@02),@CB00747                            0873 03226000
         BE    @RF00873                                            0873 03227000
*     DO;                           /*                       @Y30LB26*/ 03228000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 03229000
         BAL   @14,ERREXIT                                         0875 03230000
*       RETURN;                     /*                       @Y30LB26*/ 03231000
         B     @EL00011                                            0876 03232000
*     END;                          /*                       @Y30LB26*/ 03233000
*   RETURN;                         /*                       @Y30LB26*/ 03234000
         B     @EL00011                                            0878 03235000
*   END PROCGRP;                    /* END PROCESS GROUP     @Y30LB26*/ 03236000
         B     @EL00011                                            0879 03237000
*                                                                  0880 03238000
*   /*****************************************************************/ 03239000
*   /*                                                               */ 03240000
*   /* THIS ROUTINE IS CALLED IF A COPY RECORD IS            @Y30LB26*/ 03241000
*   /* TO BE REMOVED FROM THE INVENTORY                      @Y30LB26*/ 03242000
*   /*                                                               */ 03243000
*   /*****************************************************************/ 03244000
*                                                                  0880 03245000
*REMOVCPY:                                                         0880 03246000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 03247000
*                                                                  0880 03248000
REMOVCPY ST    @14,@SA00012                                        0880 03249000
*   /*****************************************************************/ 03250000
*   /*                                                               */ 03251000
*   /* READ COPY RECORD                                      @Y30LB26*/ 03252000
*   /*                                                               */ 03253000
*   /*****************************************************************/ 03254000
*                                                                  0881 03255000
*   VIDKY=RVRCPYID;                 /* COPY ID TO KEY        @Y30LB26*/ 03256000
         L     @02,RVRPTR                                          0881 03257000
         MVC   VIDKY(1),RVRCPYID(@02)                              0881 03258000
*   RPLVKEY=ADDR(VKEY);             /* KEY ADDR TO VSAM      @Y30LB26*/ 03259000
         L     @02,RPLVPTR                                         0882 03260000
         LA    @15,VKEY                                            0882 03261000
         ST    @15,RPLVKEY(,@02)                                   0882 03262000
*   RPLVBUF=ADDR(STORCPY);          /* ADDR BUFFER           @Y30LB26*/ 03263000
         LA    @15,STORCPY                                         0883 03264000
         ST    @15,RPLVBUF(,@02)                                   0883 03265000
*   RPLVBLN=LENGTH(STORCPY);        /* LENGTH BUFFER         @Y30LB26*/ 03266000
         MVC   RPLVBLN(4,@02),@CF01147                             0884 03267000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 03268000
         OI    RPLVDIR(@02),B'01000000'                            0885 03269000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 03270000
         MVI   RPLVTYP(@02),X'00'                                  0886 03271000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       @Y30LB26*/ 03272000
         OI    RPLVUPD(@02),B'00000010'                            0887 03273000
*   RESPECIFY                                                      0888 03274000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 03275000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 03276000
         LR    REG1,@02                                            0889 03277000
*   CALL ICBVIO00;                  /* READ COPY RECORD      @Y30LB26*/ 03278000
         L     @15,@CV00671                                        0890 03279000
         BALR  @14,@15                                             0890 03280000
*   RESPECIFY                                                      0891 03281000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 03282000
*                                                                  0891 03283000
*   /*****************************************************************/ 03284000
*   /*                                                               */ 03285000
*   /* CHECK RETURN CODE                                     @Y30LB26*/ 03286000
*   /*                                                               */ 03287000
*   /*****************************************************************/ 03288000
*                                                                  0892 03289000
*   IF RPLVRETC¬=RCZERO             /* CK RET CODE           @Y30LB26*/ 03290000
*     THEN                          /*                       @Y30LB26*/ 03291000
         L     @02,RPLVPTR                                         0892 03292000
         CLC   RPLVRETC(2,@02),@CB00747                            0892 03293000
         BE    @RF00892                                            0892 03294000
*     DO;                           /*                       @Y30LB26*/ 03295000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 03296000
         BAL   @14,ERREXIT                                         0894 03297000
*       RETURN;                     /*                       @Y30LB26*/ 03298000
@EL00012 DS    0H                                                  0895 03299000
@EF00012 DS    0H                                                  0895 03300000
@ER00012 L     @14,@SA00012                                        0895 03301000
         BR    @14                                                 0895 03302000
*     END;                          /*                       @Y30LB26*/ 03303000
*                                                                  0897 03304000
*   /*****************************************************************/ 03305000
*   /*                                                               */ 03306000
*   /* SET ADDRESSABILITY                                    @ZA16139*/ 03307000
*   /*                                                               */ 03308000
*   /*****************************************************************/ 03309000
*                                                                  0897 03310000
*   COPYVPTR=ADDR(STORCPY);         /* ADDR TO COPY REC      @ZA16139*/ 03311000
@RF00892 LA    @02,STORCPY                                         0897 03312000
         ST    @02,COPYVPTR                                        0897 03313000
*                                                                  0898 03314000
*   /*****************************************************************/ 03315000
*   /*                                                               */ 03316000
*   /* CHECK FOR A PLACE HOLDER                              @ZDR2053*/ 03317000
*   /*                                                               */ 03318000
*   /*****************************************************************/ 03319000
*                                                                  0898 03320000
*   IF COPHOLD=ON THEN                                             0898 03321000
         TM    COPHOLD(@02),B'10000000'                            0898 03322000
         BNO   @RF00898                                            0898 03323000
*     DO;                           /*                       @ZDR2053*/ 03324000
*       CALL DELEVOL;               /* DELETE BASE VOL       @ZDR2053*/ 03325000
         BAL   @14,DELEVOL                                         0900 03326000
*       RETURN;                     /*                       @ZDR2053*/ 03327000
         B     @EL00012                                            0901 03328000
*     END;                          /*                       @ZDR2053*/ 03329000
*                                                                  0903 03330000
*   /*****************************************************************/ 03331000
*   /*                                                               */ 03332000
*   /* CHECK IF BACKUP COPY                                  @ZA16139*/ 03333000
*   /*                                                               */ 03334000
*   /*****************************************************************/ 03335000
*                                                                  0903 03336000
*   IF COPBKUP=ON                   /* THIS A BACKUP COPY    @Y30LB26*/ 03337000
*     THEN                                                         0903 03338000
@RF00898 L     @02,COPYVPTR                                        0903 03339000
         TM    COPBKUP(@02),B'00001000'                            0903 03340000
         BNO   @RF00903                                            0903 03341000
*     BACKUPFL=ON;                  /* INDICA BACKUP COPY    @Y30LB26*/ 03342000
*                                                                  0904 03343000
         OI    BACKUPFL,B'00100000'                                0904 03344000
*   /*****************************************************************/ 03345000
*   /*                                                               */ 03346000
*   /* SAVE KEY TO COPY TO CK IF LAST COPY IN BASE REC       @Y30LB26*/ 03347000
*   /*                                                               */ 03348000
*   /*****************************************************************/ 03349000
*                                                                  0905 03350000
*   SAVEKEY=VKEY;                   /* SAVE COPY VOL KEY     @Y30LB26*/ 03351000
@RF00903 MVC   SAVEKEY(13),VKEY                                    0905 03352000
*                                                                  0906 03353000
*   /*****************************************************************/ 03354000
*   /*                                                               */ 03355000
*   /* GO DELETE COPY VOL RECORD                             @Y30LB26*/ 03356000
*   /*                                                               */ 03357000
*   /*****************************************************************/ 03358000
*                                                                  0906 03359000
*   CALL DELEVOL;                   /* GO DELETE VOL REC     @Y30LB26*/ 03360000
*                                                                  0906 03361000
         BAL   @14,DELEVOL                                         0906 03362000
*   /*****************************************************************/ 03363000
*   /*                                                               */ 03364000
*   /* JOURNALING AND REASON CODE TAKEN CARE OF,             @Y30LB26*/ 03365000
*   /* SO IF BAD RETURN CODE JUST RETURN                     @Y30LB26*/ 03366000
*   /*                                                               */ 03367000
*   /*****************************************************************/ 03368000
*                                                                  0907 03369000
*   IF RPLVRETC¬=RCZERO             /* CK RET CODE           @Y30LB26*/ 03370000
*     THEN                                                         0907 03371000
         L     @02,RPLVPTR                                         0907 03372000
         CLC   RPLVRETC(2,@02),@CB00747                            0907 03373000
         BNE   @RT00907                                            0907 03374000
*     RETURN;                       /* RETURN TO CALLER      @Y30LB26*/ 03375000
*                                                                  0909 03376000
*   /*****************************************************************/ 03377000
*   /*                                                               */ 03378000
*   /* READ BASE VOLUME RECORD TO UPDATE FIELDS              @Y30LB26*/ 03379000
*   /*                                                               */ 03380000
*   /*****************************************************************/ 03381000
*                                                                  0909 03382000
*   VIDKY=FIXZERO;                  /* ZERO VOL ID IN KEY    @Y30LB26*/ 03383000
         MVI   VIDKY,X'00'                                         0909 03384000
*   RPLVKEY=ADDR(VKEY);             /* GET ADDR OF KEY       @Y30LB26*/ 03385000
         LA    @15,VKEY                                            0910 03386000
         ST    @15,RPLVKEY(,@02)                                   0910 03387000
*   RPLVBUF=ADDR(STORBASE);         /* ADDR OF BUFFER        @Y30LB26*/ 03388000
         LA    @15,STORBASE                                        0911 03389000
         ST    @15,RPLVBUF(,@02)                                   0911 03390000
*   RPLVBLN=LENGTH(STORBASE);       /* LENGTH BUFFER         @Y30LB26*/ 03391000
         MVC   RPLVBLN(4,@02),@CF01147                             0912 03392000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 03393000
         OI    RPLVDIR(@02),B'01000000'                            0913 03394000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB26*/ 03395000
         MVI   RPLVTYP(@02),X'00'                                  0914 03396000
*   RPLVKGE=OFF;                    /* NO > OR = READ        @Y30LB26*/ 03397000
         NI    RPLVKGE(@02),B'11111011'                            0915 03398000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       @Y30LB26*/ 03399000
         OI    RPLVUPD(@02),B'00000010'                            0916 03400000
*   RESPECIFY                                                      0917 03401000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 03402000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 03403000
         LR    REG1,@02                                            0918 03404000
*   CALL ICBVIO00;                  /* READ BASE VOL REC     @Y30LB26*/ 03405000
         L     @15,@CV00671                                        0919 03406000
         BALR  @14,@15                                             0919 03407000
*   RESPECIFY                                                      0920 03408000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 03409000
*                                                                  0920 03410000
*   /*****************************************************************/ 03411000
*   /*                                                               */ 03412000
*   /* CHECK RETURN CODE FROM I/O PROCESSOR                  @Y30LB26*/ 03413000
*   /*                                                               */ 03414000
*   /*****************************************************************/ 03415000
*                                                                  0921 03416000
*   IF RPLVRETC¬=RCZERO             /* CK RET CODE           @Y30LB26*/ 03417000
*     THEN                          /*                       @Y30LB26*/ 03418000
         L     @02,RPLVPTR                                         0921 03419000
         CLC   RPLVRETC(2,@02),@CB00747                            0921 03420000
         BE    @RF00921                                            0921 03421000
*     DO;                           /*                       @Y30LB26*/ 03422000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 03423000
         BAL   @14,ERREXIT                                         0923 03424000
*       RETURN;                     /*                       @Y30LB26*/ 03425000
         B     @EL00012                                            0924 03426000
*     END;                          /*                       @Y30LB26*/ 03427000
*                                                                  0926 03428000
*   /*****************************************************************/ 03429000
*   /*                                                               */ 03430000
*   /* SET UP ADDRESSING AND UPDATE BASE VOL RECORD          @Y30LB26*/ 03431000
*   /*                                                               */ 03432000
*   /*****************************************************************/ 03433000
*                                                                  0926 03434000
*   BASEVPTR=ADDR(STORBASE);        /* ADDR BASE REC         @Y30LB26*/ 03435000
@RF00921 LA    @02,STORBASE                                        0926 03436000
         ST    @02,BASEVPTR                                        0926 03437000
*   BASNCOPY=BASNCOPY-ONE;          /* DECREASE COPIES ONE   @Y30LB26*/ 03438000
         SLR   @15,@15                                             0927 03439000
         IC    @15,BASNCOPY(,@02)                                  0927 03440000
         BCTR  @15,0                                               0927 03441000
         STC   @15,BASNCOPY(,@02)                                  0927 03442000
*   IF BASNCOPY=FIXZERO THEN        /* NO COPIES ZERO FLD    @Y30LB26*/ 03443000
         CLI   BASNCOPY(@02),0                                     0928 03444000
         BNE   @RF00928                                            0928 03445000
*     BASKLCPY=BLANK;               /* BLANK COPY ID         @Y30LB26*/ 03446000
         MVI   BASKLCPY+1(@02),C' '                                0929 03447000
         MVC   BASKLCPY+2(11,@02),BASKLCPY+1(@02)                  0929 03448000
         MVI   BASKLCPY(@02),C' '                                  0929 03449000
*   IF BACKUPFL=ON                  /* BACKUP COPY ?         @Y30LB26*/ 03450000
*     THEN                                                         0930 03451000
@RF00928 TM    BACKUPFL,B'00100000'                                0930 03452000
         BNO   @RF00930                                            0930 03453000
*     BASNBKUP=BASNBKUP-ONE;        /* DECRE BACKUPS ONE     @Y30LB26*/ 03454000
*                                                                  0931 03455000
         L     @02,BASEVPTR                                        0931 03456000
         SLR   @15,@15                                             0931 03457000
         IC    @15,BASNBKUP(,@02)                                  0931 03458000
         BCTR  @15,0                                               0931 03459000
         STC   @15,BASNBKUP(,@02)                                  0931 03460000
*   /*****************************************************************/ 03461000
*   /*                                                               */ 03462000
*   /* CHECK TO SEE IF COPY DELETED WAS LATEST COPY          @Y30LB26*/ 03463000
*   /* AND THAT THERE IS STILL A COPY FOR VOLUME             @Y30LB26*/ 03464000
*   /*                                                               */ 03465000
*   /*****************************************************************/ 03466000
*                                                                  0932 03467000
*   IF BASKLCPY=SAVEKEY&            /* CPY DELETED LATEST?   @Y30LB26*/ 03468000
*       BASNCOPY¬=FIXZERO THEN      /* ANY COPIES AT ALL ?   @Y30LB26*/ 03469000
@RF00930 L     @02,BASEVPTR                                        0932 03470000
         CLC   BASKLCPY(13,@02),SAVEKEY                            0932 03471000
         BNE   @RF00932                                            0932 03472000
         CLI   BASNCOPY(@02),0                                     0932 03473000
         BE    @RF00932                                            0932 03474000
*     DO;                           /*                       @Y30LB26*/ 03475000
*       CALL FINDLCPY;              /* FIND LATEST COPY      @Y30LB26*/ 03476000
         BAL   @14,FINDLCPY                                        0934 03477000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @Y30LB26*/ 03478000
         L     @02,RPLVPTR                                         0935 03479000
         CLC   RPLVRETC(2,@02),@CB00747                            0935 03480000
         BNE   @RT00935                                            0935 03481000
*         RETURN;                   /*                       @Y30LB26*/ 03482000
*                                                                  0936 03483000
*       /*************************************************************/ 03484000
*       /*                                                           */ 03485000
*       /* RESET I/O PROCESSOR TO WRITE BASE RECORD          @Y30LB26*/ 03486000
*       /*                                                           */ 03487000
*       /*************************************************************/ 03488000
*                                                                  0937 03489000
*       VOLKY=RVRVOLID;             /* RESET TO CORR VOLUME  @Y30LB26*/ 03490000
         L     @01,RVRPTR                                          0937 03491000
         MVC   VOLKY(6),RVRVOLID(@01)                              0937 03492000
*       VIDKY=FIXZERO;              /* ZERO VOL ID IN KEY    @Y30LB26*/ 03493000
         MVI   VIDKY,X'00'                                         0938 03494000
*       RPLVKEY=ADDR(VKEY);         /* GET ADDR OF KEY       @Y30LB26*/ 03495000
         LA    @15,VKEY                                            0939 03496000
         ST    @15,RPLVKEY(,@02)                                   0939 03497000
*       RPLVBUF=ADDR(DUMMYREC);     /* ADDR OF BUFFER        @Y30LB26*/ 03498000
         LA    @15,DUMMYREC                                        0940 03499000
         ST    @15,RPLVBUF(,@02)                                   0940 03500000
*       RPLVBLN=LENGTH(STORBASE);   /* LENGTH BUFFER         @Y30LB26*/ 03501000
         MVC   RPLVBLN(4,@02),@CF01147                             0941 03502000
*       RPLVLOC=OFF;                /* NOT LOCATE MODE       @Y30LB26*/ 03503000
*       RPLVDIR=ON;                 /* READ DIRECT           @Y30LB26*/ 03504000
*       RPLVNEXT=OFF;               /* DO NOT READ NEXT      @Y30LB26*/ 03505000
         OI    RPLVDIR(@02),B'01000000'                            0944 03506000
         NI    RPLVLOC(@02),B'01011111'                            0944 03507000
*       RPLVTYP=RPLVREAD;           /* READ                  @Y30LB26*/ 03508000
         MVI   RPLVTYP(@02),X'00'                                  0945 03509000
*       RPLVKGE=OFF;                /* NO > OR = READ        @Y30LB26*/ 03510000
         NI    RPLVKGE(@02),B'11111011'                            0946 03511000
*       RPLVUPD=ON;                 /* READ FOR UPDATE       @Y30LB26*/ 03512000
         OI    RPLVUPD(@02),B'00000010'                            0947 03513000
*       RESPECIFY                                                  0948 03514000
*         REG1 RSTD;                /* RESTRICT REG 1        @Y30LB26*/ 03515000
*       REG1=RPLVPTR;               /* ADDR OF RPLV          @Y30LB26*/ 03516000
         LR    REG1,@02                                            0949 03517000
*       CALL ICBVIO00;              /* READ BASE VOL REC     @Y30LB26*/ 03518000
         L     @15,@CV00671                                        0950 03519000
         BALR  @14,@15                                             0950 03520000
*       RESPECIFY                                                  0951 03521000
*         REG1 UNRSTD;              /* FREE REG 1            @Y30LB26*/ 03522000
*                                                                  0951 03523000
*       /*************************************************************/ 03524000
*       /*                                                           */ 03525000
*       /* CHECK RETURN CODE FROM I/O PROCESSOR              @Y30LB26*/ 03526000
*       /*                                                           */ 03527000
*       /*************************************************************/ 03528000
*                                                                  0952 03529000
*       IF RPLVRETC¬=RCZERO         /* CK RET CODE           @Y30LB26*/ 03530000
*         THEN                      /*                       @Y30LB26*/ 03531000
         L     @02,RPLVPTR                                         0952 03532000
         CLC   RPLVRETC(2,@02),@CB00747                            0952 03533000
         BE    @RF00952                                            0952 03534000
*         DO;                       /*                       @Y30LB26*/ 03535000
*           CALL ERREXIT;           /* SAVE RET CODES        @Y30LB26*/ 03536000
         BAL   @14,ERREXIT                                         0954 03537000
*           RETURN;                 /*                       @Y30LB26*/ 03538000
         B     @EL00012                                            0955 03539000
*         END;                      /*                       @Y30LB26*/ 03540000
*     END;                          /*                       @Y30LB26*/ 03541000
@RF00952 DS    0H                                                  0958 03542000
*                                                                  0958 03543000
*   /*****************************************************************/ 03544000
*   /*                                                               */ 03545000
*   /* WRITE UPDATED BASE VOLUME RECORD                      @Y30LB26*/ 03546000
*   /*                                                               */ 03547000
*   /*****************************************************************/ 03548000
*                                                                  0958 03549000
*   RPLVBUF=BASEVPTR;               /* ADDR REC TO WRITE     @Y30LB26*/ 03550000
@RF00932 L     @02,RPLVPTR                                         0958 03551000
         L     @15,BASEVPTR                                        0958 03552000
         ST    @15,RPLVBUF(,@02)                                   0958 03553000
*   RPLVTYP=RPLVPUT;                /* PUT BASE RECORD       @Y30LB26*/ 03554000
         MVI   RPLVTYP(@02),X'01'                                  0959 03555000
*   RESPECIFY                                                      0960 03556000
*     REG1 RSTD;                    /* REST REG 1            @Y30LB26*/ 03557000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 03558000
         LR    REG1,@02                                            0961 03559000
*   CALL ICBVIO00;                  /* WRITE BASE REC        @Y30LB26*/ 03560000
         L     @15,@CV00671                                        0962 03561000
         BALR  @14,@15                                             0962 03562000
*   RESPECIFY                                                      0963 03563000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 03564000
*   IF RPLVRETC¬=RCZERO             /* CK RET CODE           @Y30LB26*/ 03565000
*     THEN                          /*                       @Y30LB26*/ 03566000
         L     @02,RPLVPTR                                         0964 03567000
         CLC   RPLVRETC(2,@02),@CB00747                            0964 03568000
         BE    @RF00964                                            0964 03569000
*     DO;                           /*                       @Y30LB26*/ 03570000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 03571000
         BAL   @14,ERREXIT                                         0966 03572000
*       RETURN;                     /*                       @Y30LB26*/ 03573000
         B     @EL00012                                            0967 03574000
*     END;                          /*                       @Y30LB26*/ 03575000
*   ELSE                            /*                       @Y30LB26*/ 03576000
*     IF JRNLEDSW=OFF THEN          /* SEE IF JOURNALED      @Y30LB26*/ 03577000
@RF00964 TM    JRNLEDSW,B'00000001'                                0969 03578000
         BNZ   @RF00969                                            0969 03579000
*       CALL JOURNAL;               /* JOURNAL RPLV          @Y30LB26*/ 03580000
         BAL   @14,JOURNAL                                         0970 03581000
*   RETURN;                         /*                       @Y30LB26*/ 03582000
         B     @EL00012                                            0971 03583000
*   END REMOVCPY;                   /* END REMOVCPY PROC     @Y30LB26*/ 03584000
         B     @EL00012                                            0972 03585000
*                                                                  0973 03586000
*   /*****************************************************************/ 03587000
*   /*                                                               */ 03588000
*   /* PROCEDURE LOCATES THE LATEST COPY OF A BASE VOLUME    @Y30LB26*/ 03589000
*   /* RECORD WHEN THE PREVIOUS LATEST COPY HAS BEEN DELETED @Y30LB26*/ 03590000
*   /*                                                               */ 03591000
*   /*****************************************************************/ 03592000
*                                                                  0973 03593000
*FINDLCPY:                                                         0973 03594000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 03595000
FINDLCPY ST    @14,@SA00013                                        0973 03596000
*   VIDKY=FIXONE;                   /* PUT ID TO ONE         @Y30LB26*/ 03597000
         MVI   VIDKY,X'01'                                         0974 03598000
*   LOOPSW=OFF;                     /* INITILIZE LOOP SW     @Y30LB26*/ 03599000
*                                                                  0975 03600000
         NI    LOOPSW,B'01111111'                                  0975 03601000
*   /*****************************************************************/ 03602000
*   /*                                                               */ 03603000
*   /* START LOOPING THRU COPIES UNTIL RUN OUT               #Y30LB26*/ 03604000
*   /*                                                               */ 03605000
*   /*****************************************************************/ 03606000
*                                                                  0976 03607000
*   DO WHILE I=I;                   /* OUTSIDE LOOP          #Y30LB26*/ 03608000
         B     @DE00976                                            0976 03609000
@DL00976 DS    0H                                                  0977 03610000
*     RPLVKEY=ADDR(VKEY);           /* ADDR OF KEY           #Y30LB26*/ 03611000
         L     @02,RPLVPTR                                         0977 03612000
         LA    @15,VKEY                                            0977 03613000
         ST    @15,RPLVKEY(,@02)                                   0977 03614000
*     RPLVLOC=ON;                   /* LOCATE MODE           #Y30LB26*/ 03615000
*     RPLVDIR=ON;                   /* DIRECT READ           #Y30LB26*/ 03616000
         OI    RPLVLOC(@02),B'11000000'                            0979 03617000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           #Y30LB26*/ 03618000
         MVI   RPLVTYP(@02),X'00'                                  0980 03619000
*     RPLVUPD=OFF;                  /* NOT FOR UPDATE        #Y30LB26*/ 03620000
         NI    RPLVUPD(@02),B'11111101'                            0981 03621000
*     RPLVKGE=ON;                   /* READ > OR =           #Y30LB26*/ 03622000
         OI    RPLVKGE(@02),B'00000100'                            0982 03623000
*     RESPECIFY                                                    0983 03624000
*       REG1 RSTD;                  /* RESTRICI REG 1        #Y30LB26*/ 03625000
*     REG1=RPLVPTR;                 /* ADDR OF RPLV          #Y30LB26*/ 03626000
         LR    REG1,@02                                            0984 03627000
*     CALL ICBVIO00;                /* READ COPY RECORD      #Y30LB26*/ 03628000
         L     @15,@CV00671                                        0985 03629000
         BALR  @14,@15                                             0985 03630000
*     RESPECIFY                                                    0986 03631000
*       REG1 UNRSTD;                /* FREE REG 1            #Y30LB26*/ 03632000
*                                                                  0986 03633000
*     /***************************************************************/ 03634000
*     /*                                                             */ 03635000
*     /* CHECK RETURN CODE FROM I/O PROCESSOR                #Y30LB26*/ 03636000
*     /*                                                             */ 03637000
*     /***************************************************************/ 03638000
*                                                                  0987 03639000
*     IF RPLVRETC¬=RCZERO THEN      /* CK RETURN             @Y30LB26*/ 03640000
         L     @02,RPLVPTR                                         0987 03641000
         CLC   RPLVRETC(2,@02),@CB00747                            0987 03642000
         BE    @RF00987                                            0987 03643000
*       DO;                         /*                       #Y30LB26*/ 03644000
*         IF RPLRCODE=NORECRC THEN  /* RECORD NOT FOUND ?    @Y30LB26*/ 03645000
         CLC   RPLRCODE(2,@02),@CB00789                            0989 03646000
         BNE   @RF00989                                            0989 03647000
*           DO;                     /*                       @Y30LB26*/ 03648000
*             IF LOOPSW=ON THEN     /* FOUND COPY REC ?      @Y30LB26*/ 03649000
         TM    LOOPSW,B'10000000'                                  0991 03650000
         BNO   @RF00991                                            0991 03651000
*               DO;                 /*                       @Y30LB26*/ 03652000
*                 BASKLCPY=SAVEKEY; /* LATEST COPY IN BASE   @Y30LB26*/ 03653000
         L     @01,BASEVPTR                                        0993 03654000
         MVC   BASKLCPY(13,@01),SAVEKEY                            0993 03655000
*                 RPLVRETC=RCZERO;  /* GOOD RETURN           @Y30LB26*/ 03656000
         MVC   RPLVRETC(2,@02),@CB00747                            0994 03657000
*                 RPLRCODE=RCZERO;  /* GOOD REASON           @Y30LB26*/ 03658000
         MVC   RPLRCODE(2,@02),@CB00747                            0995 03659000
*                 RETURN;           /*                       @Y30LB26*/ 03660000
@EL00013 DS    0H                                                  0996 03661000
@EF00013 DS    0H                                                  0996 03662000
@ER00013 L     @14,@SA00013                                        0996 03663000
         BR    @14                                                 0996 03664000
*               END;                /*                       @Y30LB26*/ 03665000
*             ELSE                  /*                       @Y30LB26*/ 03666000
*               DO;                 /*                       @Y30LB26*/ 03667000
@RF00991 DS    0H                                                  0999 03668000
*                 CALL ERREXIT;     /* SAVE RET CODES        @Y30LB26*/ 03669000
         BAL   @14,ERREXIT                                         0999 03670000
*                 RETURN;           /*                       @Y30LB26*/ 03671000
         B     @EL00013                                            1000 03672000
*               END;                /*                       @Y30LB26*/ 03673000
*           END;                    /*                       @Y30LB26*/ 03674000
*         ELSE                      /*                       @Y30LB26*/ 03675000
*           DO;                     /*                       @Y30LB26*/ 03676000
@RF00989 DS    0H                                                  1004 03677000
*             CALL ERREXIT;         /* SAVE RET CODES        @Y30LB26*/ 03678000
         BAL   @14,ERREXIT                                         1004 03679000
*             RETURN;               /*                       @Y30LB26*/ 03680000
         B     @EL00013                                            1005 03681000
*           END;                    /*                       @Y30LB26*/ 03682000
*       END;                        /*                       #Y30LB26*/ 03683000
*     COPYVPTR=RPLVBUF;             /* ADDR RECORD READ      #Y30LB26*/ 03684000
*                                                                  1008 03685000
@RF00987 L     @02,RPLVPTR                                         1008 03686000
         L     @02,RPLVBUF(,@02)                                   1008 03687000
         ST    @02,COPYVPTR                                        1008 03688000
*     /***************************************************************/ 03689000
*     /*                                                             */ 03690000
*     /* CHECK TO BE SURE IT IS STILL A CORRECT VOLUME REC   #Y30LB26*/ 03691000
*     /*                                                             */ 03692000
*     /***************************************************************/ 03693000
*                                                                  1009 03694000
*     IF COPV=VKY&COPSERNO=VOLKY THEN/* STILL GOOD ?         #Y30LB26*/ 03695000
         CLC   COPV(5,@02),VKY                                     1009 03696000
         BNE   @RF01009                                            1009 03697000
         CLC   COPSERNO(6,@02),VOLKY                               1009 03698000
         BNE   @RF01009                                            1009 03699000
*       DO;                         /*                       #Y30LB26*/ 03700000
*         SAVEKEY=COPNAME;          /* SAVE CURRENT VOL KEY  #Y30LB26*/ 03701000
         MVC   SAVEKEY(13),COPNAME(@02)                            1011 03702000
*         VKEY=COPNAME;             /* BUILD KEY READ AGAIN  #Y30LB26*/ 03703000
         MVC   VKEY(13),COPNAME(@02)                               1012 03704000
*         VIDKY=VIDKY+FIXONE;       /* ADD ONE TO GET NEXT   #Y30LB26*/ 03705000
         LA    @02,1                                               1013 03706000
         SLR   @15,@15                                             1013 03707000
         IC    @15,VIDKY                                           1013 03708000
         ALR   @02,@15                                             1013 03709000
         STC   @02,VIDKY                                           1013 03710000
*         LOOPSW=ON;                /* INDICATE FOUND 1 COPY #Y30LB26*/ 03711000
         OI    LOOPSW,B'10000000'                                  1014 03712000
*       END;                        /*                       #Y30LB26*/ 03713000
*     ELSE                          /*                       #Y30LB26*/ 03714000
*       DO;                         /*                       #Y30LB26*/ 03715000
         B     @RC01009                                            1016 03716000
@RF01009 DS    0H                                                  1017 03717000
*         IF LOOPSW=ON THEN         /* SEE IF A COPY FOUND   #Y30LB26*/ 03718000
         TM    LOOPSW,B'10000000'                                  1017 03719000
         BNO   @RF01017                                            1017 03720000
*           DO;                     /*                       #Y30LB26*/ 03721000
*             BASKLCPY=SAVEKEY;     /* GET OLD KEY           #Y30LB26*/ 03722000
         L     @02,BASEVPTR                                        1019 03723000
         MVC   BASKLCPY(13,@02),SAVEKEY                            1019 03724000
*             RETURN;               /*                       #Y30LB26*/ 03725000
         B     @EL00013                                            1020 03726000
*           END;                    /*                       #Y30LB26*/ 03727000
*         ELSE                      /*                       #Y30LB26*/ 03728000
*           DO;                     /*                       #Y30LB26*/ 03729000
@RF01017 DS    0H                                                  1023 03730000
*             RPLVRETC=FOUR;        /* BAD RET CODE          #Y30LB26*/ 03731000
         L     @02,RPLVPTR                                         1023 03732000
         MVC   RPLVRETC(2,@02),@CB00749                            1023 03733000
*             RPLRCODE=NORECRC;     /* NO COPIES FOUND       @Y30LB26*/ 03734000
         MVC   RPLRCODE(2,@02),@CB00789                            1024 03735000
*             CALL ERREXIT;         /* SAVE RET CODES        #Y30LB26*/ 03736000
         BAL   @14,ERREXIT                                         1025 03737000
*             RETURN;               /*                       #Y30LB26*/ 03738000
         B     @EL00013                                            1026 03739000
*           END;                    /*                       #Y30LB26*/ 03740000
*       END;                        /*                       #Y30LB26*/ 03741000
*   END;                            /*                       #Y30LB26*/ 03742000
@RC01009 DS    0H                                                  1029 03743000
@DE00976 CLC   I(1),I                                              1029 03744000
         BE    @DL00976                                            1029 03745000
*   END FINDLCPY;                   /*                       #Y30LB26*/ 03746000
         B     @EL00013                                            1030 03747000
*                                                                  1031 03748000
*   /*****************************************************************/ 03749000
*   /*                                                               */ 03750000
*   /* ROUTINE CHECKS IF CARTRIDGE INDEX RECORDS ARE         #Y30LB26*/ 03751000
*   /* STILL IN THE LIBRARY                                  #Y30LB26*/ 03752000
*   /* AND IF THEY BELONG TO THE RIGHT VOLUME, IT            #Y30LB26*/ 03753000
*   /* DELETES THE INDEX RECORDS                             #Y30LB26*/ 03754000
*   /*                                                               */ 03755000
*   /*****************************************************************/ 03756000
*                                                                  1031 03757000
*CHKCART:                                                          1031 03758000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 03759000
*                                                                  1031 03760000
CHKCART  ST    @14,@SA00014                                        1031 03761000
*   /*****************************************************************/ 03762000
*   /*                                                               */ 03763000
*   /* SET UP ADDRESSING TO BASE OR COPY RECORD              #Y30LB26*/ 03764000
*   /*                                                               */ 03765000
*   /*****************************************************************/ 03766000
*                                                                  1032 03767000
*   IF RVRBASEV=ON                  /* BASE OR COPY          #Y30LB26*/ 03768000
*     THEN                                                         1032 03769000
         L     @02,RVRPTR                                          1032 03770000
         TM    RVRBASEV(@02),B'10000000'                           1032 03771000
         BNO   @RF01032                                            1032 03772000
*     BCDVPTR=BASEVPTR;             /* COMMON ADDR TO BASE   #Y30LB26*/ 03773000
         L     BCDVPTR,BASEVPTR                                    1033 03774000
*   ELSE                                                           1034 03775000
*     BCDVPTR=COPYVPTR;             /* COMMON ADDR TO COPY   #Y30LB26*/ 03776000
         B     @RC01032                                            1034 03777000
@RF01032 L     BCDVPTR,COPYVPTR                                    1034 03778000
*                                                                  1035 03779000
*   /*****************************************************************/ 03780000
*   /*                                                               */ 03781000
*   /* CHECK TO SEE IF CARTRIDGES ARE IN LIBRARY             #Y30LB26*/ 03782000
*   /*                                                               */ 03783000
*   /*****************************************************************/ 03784000
*                                                                  1035 03785000
*   IF BCDLIB1¬=LIBTEST|BCDLIB2¬=LIBTEST/* IN LIB            @Y30LB26*/ 03786000
*     THEN                          /*                       @Y30LB26*/ 03787000
*                                                                  1035 03788000
@RC01032 CLC   BCDLIB1(1,BCDVPTR),LIBTEST                          1035 03789000
         BNE   @RT01035                                            1035 03790000
         CLC   BCDLIB2(1,BCDVPTR),LIBTEST                          1035 03791000
         BE    @RF01035                                            1035 03792000
@RT01035 DS    0H                                                  1036 03793000
*     /***************************************************************/ 03794000
*     /*                                                             */ 03795000
*     /* IF THEY ARE, SET REASON CODE AND RETURN             @Y30LB26*/ 03796000
*     /*                                                             */ 03797000
*     /***************************************************************/ 03798000
*                                                                  1036 03799000
*     DO;                           /*                       @Y30LB26*/ 03800000
*       RPLVRETC=FOUR;              /* SET BAD RET CODE      @Y30LB26*/ 03801000
         L     @02,RPLVPTR                                         1037 03802000
         MVC   RPLVRETC(2,@02),@CB00749                            1037 03803000
*       RPLRCODE=INLIB;             /* REASON CODE           @Y30LB26*/ 03804000
         MVC   RPLRCODE(2,@02),@CB00799                            1038 03805000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 03806000
         BAL   @14,ERREXIT                                         1039 03807000
*       RETURN;                     /*                       @Y30LB26*/ 03808000
@EL00014 DS    0H                                                  1040 03809000
@EF00014 DS    0H                                                  1040 03810000
@ER00014 L     @14,@SA00014                                        1040 03811000
         BR    @14                                                 1040 03812000
*     END;                          /*                       @Y30LB26*/ 03813000
*                                                                  1042 03814000
*   /*****************************************************************/ 03815000
*   /*                                                               */ 03816000
*   /* READ FIRST CARTRIDGE INDEX RECORD                     @Y30LB26*/ 03817000
*   /*                                                               */ 03818000
*   /*****************************************************************/ 03819000
*                                                                  1042 03820000
*   CARTKY=BCDCSN1;                 /* CART SERIAL TO KEY    @Y30LB26*/ 03821000
@RF01035 MVC   CARTKY(12),BCDCSN1(BCDVPTR)                         1042 03822000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY TO VSAM   @Y30LB26*/ 03823000
         L     @04,RPLVPTR                                         1043 03824000
         LA    @02,IKEY                                            1043 03825000
         ST    @02,RPLVKEY(,@04)                                   1043 03826000
*   RPLVBUF=ADDR(STORINDX);         /* ADDR OF BUFFER        @Y30LB26*/ 03827000
         LA    @02,STORINDX                                        1044 03828000
         ST    @02,RPLVBUF(,@04)                                   1044 03829000
*   RPLVBLN=LENGTH(STORINDX);       /* LENGTH BUFFER         @Y30LB26*/ 03830000
         MVC   RPLVBLN(4,@04),@CF01147                             1045 03831000
*   RPLVDIR=ON;                     /* DIRECT READ           @Y30LB26*/ 03832000
         OI    RPLVDIR(@04),B'01000000'                            1046 03833000
*   RPLVTYP=RPLVREAD;               /* READ CART INDX        @Y30LB26*/ 03834000
         MVI   RPLVTYP(@04),X'00'                                  1047 03835000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       @Y30LB26*/ 03836000
         OI    RPLVUPD(@04),B'00000010'                            1048 03837000
*   RESPECIFY                                                      1049 03838000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 03839000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 03840000
         LR    REG1,@04                                            1050 03841000
*   CALL ICBVIO00;                  /* READ CART INDEX REC   @Y30LB26*/ 03842000
         L     @15,@CV00671                                        1051 03843000
         BALR  @14,@15                                             1051 03844000
*   RESPECIFY                                                      1052 03845000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 03846000
*                                                                  1052 03847000
*   /*****************************************************************/ 03848000
*   /*                                                               */ 03849000
*   /* CHECK TO SEE IF CART INDEX REC RETURNED SUCCESS       @Y30LB26*/ 03850000
*   /*                                                               */ 03851000
*   /*****************************************************************/ 03852000
*                                                                  1053 03853000
*   IF RPLVRETC=RCZERO              /* CK RET CODE           @Y30LB26*/ 03854000
*     THEN                          /*                       @Y30LB26*/ 03855000
         L     @04,RPLVPTR                                         1053 03856000
         CLC   RPLVRETC(2,@04),@CB00747                            1053 03857000
         BNE   @RF01053                                            1053 03858000
*     DO;                           /*                       @Y30LB26*/ 03859000
*       INDEXPTR=ADDR(STORINDX);    /* ADDR OF INDEX REC     @Y30LB26*/ 03860000
         LA    INDEXPTR,STORINDX                                   1055 03861000
*       IF INDRECKY=VKEY            /* CK BELONGS RIT VOL    @Y30LB26*/ 03862000
*         THEN                      /*                       @Y30LB26*/ 03863000
*                                                                  1056 03864000
         CLC   INDRECKY(13,INDEXPTR),VKEY                          1056 03865000
         BNE   @RF01056                                            1056 03866000
*         /***********************************************************/ 03867000
*         /*                                                         */ 03868000
*         /* CARTRIDGE BELONGS TO CORRECT VOL,               @Y30LB26*/ 03869000
*         /* SO DELETE CART INDEX RECORD                     @Y30LB26*/ 03870000
*         /*                                                         */ 03871000
*         /***********************************************************/ 03872000
*                                                                  1057 03873000
*         DO;                       /*                       @Y30LB26*/ 03874000
*           RPLVTYP=RPLVDEL;        /* DELETE CART INDX      @Y30LB26*/ 03875000
         MVI   RPLVTYP(@04),X'05'                                  1058 03876000
*           RESPECIFY                                              1059 03877000
*             REG1 RSTD;            /* RESTRICT REG 1        @Y30LB26*/ 03878000
*           REG1=RPLVPTR;           /* ADDR RPLV             @Y30LB26*/ 03879000
         LR    REG1,@04                                            1060 03880000
*           CALL ICBVIO00;          /* DELETE INDEX REC      @Y30LB26*/ 03881000
         L     @15,@CV00671                                        1061 03882000
         BALR  @14,@15                                             1061 03883000
*           RESPECIFY                                              1062 03884000
*             REG1 UNRSTD;          /* FREE REG 1            @Y30LB26*/ 03885000
*                                                                  1062 03886000
*           /*********************************************************/ 03887000
*           /*                                                       */ 03888000
*           /* SEE IF CART RECORD DELETED SUCCESSFULLY       @Y30LB26*/ 03889000
*           /*                                                       */ 03890000
*           /*********************************************************/ 03891000
*                                                                  1063 03892000
*           IF RPLVRETC¬=RCZERO     /* CK RET CODE           @Y30LB26*/ 03893000
*             THEN                  /*                       @Y30LB26*/ 03894000
         L     @04,RPLVPTR                                         1063 03895000
         CLC   RPLVRETC(2,@04),@CB00747                            1063 03896000
         BE    @RF01063                                            1063 03897000
*             DO;                   /*                       @Y30LB26*/ 03898000
*               CALL ERREXIT;       /* SAVE RET CODES        @Y30LB26*/ 03899000
         BAL   @14,ERREXIT                                         1065 03900000
*               RETURN;             /*                       @Y30LB26*/ 03901000
         B     @EL00014                                            1066 03902000
*             END;                  /*                       @Y30LB26*/ 03903000
*           ELSE                    /*                       @Y30LB26*/ 03904000
*             IF JRNLEDSW=OFF THEN  /* NOT JOURNLED ?        @Y30LB26*/ 03905000
@RF01063 TM    JRNLEDSW,B'00000001'                                1068 03906000
         BNZ   @RF01068                                            1068 03907000
*               DO;                 /*                       @Y30LB26*/ 03908000
*                 CALL JOURNAL;     /* JOURNAL RPLV          @Y30LB26*/ 03909000
         BAL   @14,JOURNAL                                         1070 03910000
*                 IF RPLVRETC¬=RCZERO THEN/* CK RETURN       @Y30LB26*/ 03911000
         L     @04,RPLVPTR                                         1071 03912000
         CLC   RPLVRETC(2,@04),@CB00747                            1071 03913000
         BNE   @RT01071                                            1071 03914000
*                   RETURN;         /*                       @Y30LB26*/ 03915000
*               END;                /*                       @Y30LB26*/ 03916000
*         END;                      /*                       @Y30LB26*/ 03917000
*     END;                          /*                       @Y30LB26*/ 03918000
*   ELSE                            /*                       @Y30LB26*/ 03919000
*                                                                  1076 03920000
*     /***************************************************************/ 03921000
*     /*                                                             */ 03922000
*     /* SEE IF ERROR OTHER THAN RECORD NOT FOUND            @Y30LB26*/ 03923000
*     /*                                                             */ 03924000
*     /***************************************************************/ 03925000
*                                                                  1076 03926000
*     IF RPLRCODE¬=NORECRC          /* CK IF REC FOUND       @Y30LB26*/ 03927000
*       THEN                        /*                       @Y30LB26*/ 03928000
         B     @RC01053                                            1076 03929000
@RF01053 L     @04,RPLVPTR                                         1076 03930000
         CLC   RPLRCODE(2,@04),@CB00789                            1076 03931000
         BE    @RF01076                                            1076 03932000
*       DO;                         /*                       @Y30LB26*/ 03933000
*         CALL ERREXIT;             /* SAVE RET CODES        @Y30LB26*/ 03934000
         BAL   @14,ERREXIT                                         1078 03935000
*         RETURN;                   /* RETURN TO CALLER      @Y30LB26*/ 03936000
         B     @EL00014                                            1079 03937000
*       END;                        /*                       @Y30LB26*/ 03938000
*                                                                  1081 03939000
*   /*****************************************************************/ 03940000
*   /*                                                               */ 03941000
*   /* START SAME THING WITH SECOND CART INDEX RECORD        @Y30LB26*/ 03942000
*   /*                                                               */ 03943000
*   /*****************************************************************/ 03944000
*                                                                  1081 03945000
*   CARTKY=BCDCSN2;                 /* INDEX KEY             @Y30LB26*/ 03946000
@RF01076 DS    0H                                                  1081 03947000
@RC01053 MVC   CARTKY(12),BCDCSN2(BCDVPTR)                         1081 03948000
*   RPLVKEY=ADDR(IKEY);             /* ADDR KEY TO VSAM      @Y30LB26*/ 03949000
         L     @02,RPLVPTR                                         1082 03950000
         LA    @15,IKEY                                            1082 03951000
         ST    @15,RPLVKEY(,@02)                                   1082 03952000
*   RPLVBUF=ADDR(STORINDX);         /* ADDR BUFFER           @Y30LB26*/ 03953000
         LA    @15,STORINDX                                        1083 03954000
         ST    @15,RPLVBUF(,@02)                                   1083 03955000
*   RPLVBLN=LENGTH(STORINDX);       /* LENGTH BUFFER         @Y30LB26*/ 03956000
         MVC   RPLVBLN(4,@02),@CF01147                             1084 03957000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 03958000
         OI    RPLVDIR(@02),B'01000000'                            1085 03959000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 03960000
         MVI   RPLVTYP(@02),X'00'                                  1086 03961000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       @Y30LB26*/ 03962000
         OI    RPLVUPD(@02),B'00000010'                            1087 03963000
*   RESPECIFY                                                      1088 03964000
*     REG1 RSTD;                    /* REST REG 1            @Y30LB26*/ 03965000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 03966000
         LR    REG1,@02                                            1089 03967000
*   CALL ICBVIO00;                  /* READ SECOND CART      @Y30LB26*/ 03968000
         L     @15,@CV00671                                        1090 03969000
         BALR  @14,@15                                             1090 03970000
*   RESPECIFY                                                      1091 03971000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 03972000
*                                                                  1091 03973000
*   /*****************************************************************/ 03974000
*   /*                                                               */ 03975000
*   /* CHECK TO SEE IF RECORD RETURNED SUCCESSFULLY          @Y30LB26*/ 03976000
*   /*                                                               */ 03977000
*   /*****************************************************************/ 03978000
*                                                                  1092 03979000
*   IF RPLVRETC=RCZERO              /* TEST RET CODE         @Y30LB26*/ 03980000
*     THEN                          /*                       @Y30LB26*/ 03981000
*                                                                  1092 03982000
         L     @02,RPLVPTR                                         1092 03983000
         CLC   RPLVRETC(2,@02),@CB00747                            1092 03984000
         BNE   @RF01092                                            1092 03985000
*     /***************************************************************/ 03986000
*     /*                                                             */ 03987000
*     /* SET ADDRESSING AND CK TO SEE IF CORRECT OWNER       @Y30LB26*/ 03988000
*     /*                                                             */ 03989000
*     /***************************************************************/ 03990000
*                                                                  1093 03991000
*     DO;                           /*                       @Y30LB26*/ 03992000
*       INDEXPTR=ADDR(STORINDX);    /* ADDR REC JUST READ    @Y30LB26*/ 03993000
         LA    INDEXPTR,STORINDX                                   1094 03994000
*       IF INDRECKY=VKEY            /* TEST IF RIT OWNER     @Y30LB26*/ 03995000
*         THEN                      /*                       @Y30LB26*/ 03996000
*                                                                  1095 03997000
         CLC   INDRECKY(13,INDEXPTR),VKEY                          1095 03998000
         BNE   @RF01095                                            1095 03999000
*         /***********************************************************/ 04000000
*         /*                                                         */ 04001000
*         /* IF BELONGS TO THE CORRECT VOLUME DELETE         @Y30LB26*/ 04002000
*         /* CARTRIDGE INDEX RECORD                          @Y30LB26*/ 04003000
*         /*                                                         */ 04004000
*         /***********************************************************/ 04005000
*                                                                  1096 04006000
*         DO;                       /*                       @Y30LB26*/ 04007000
*           RPLVTYP=RPLVDEL;        /* DELETE CART INDEX     @Y30LB26*/ 04008000
         MVI   RPLVTYP(@02),X'05'                                  1097 04009000
*           RESPECIFY                                              1098 04010000
*             REG1 RSTD;            /* REST REG 1            @Y30LB26*/ 04011000
*           REG1=RPLVPTR;           /* ADDR RPLV             @Y30LB26*/ 04012000
         LR    REG1,@02                                            1099 04013000
*           CALL ICBVIO00;          /* DELETE INDEX REC      @Y30LB26*/ 04014000
         L     @15,@CV00671                                        1100 04015000
         BALR  @14,@15                                             1100 04016000
*           RESPECIFY                                              1101 04017000
*             REG1 UNRSTD;          /* FREE REG 1            @Y30LB26*/ 04018000
*                                                                  1101 04019000
*           /*********************************************************/ 04020000
*           /*                                                       */ 04021000
*           /* CK TO SEE IF SUCCESSFULLY DELETED             @Y30LB26*/ 04022000
*           /*                                                       */ 04023000
*           /*********************************************************/ 04024000
*                                                                  1102 04025000
*           IF RPLVRETC¬=RCZERO     /* CK RET CODE           @Y30LB26*/ 04026000
*             THEN                  /*                       @Y30LB26*/ 04027000
         L     @02,RPLVPTR                                         1102 04028000
         CLC   RPLVRETC(2,@02),@CB00747                            1102 04029000
         BE    @RF01102                                            1102 04030000
*             DO;                   /*                       @Y30LB26*/ 04031000
*               CALL ERREXIT;       /* SAVE RET CODES        @Y30LB26*/ 04032000
         BAL   @14,ERREXIT                                         1104 04033000
*               RETURN;             /*                       @Y30LB26*/ 04034000
         B     @EL00014                                            1105 04035000
*             END;                  /*                       @Y30LB26*/ 04036000
*           ELSE                    /*                       @Y30LB26*/ 04037000
*                                                                  1107 04038000
*             /*******************************************************/ 04039000
*             /*                                                     */ 04040000
*             /* IF NOT JOURNLED BEFORE, JOURNAL IT          @Y30LB26*/ 04041000
*             /*                                                     */ 04042000
*             /*******************************************************/ 04043000
*                                                                  1107 04044000
*             DO;                   /*                       @Y30LB26*/ 04045000
@RF01102 DS    0H                                                  1108 04046000
*               IF JRNLEDSW=OFF THEN/* NOT JOURNLED ?        @Y30LB26*/ 04047000
         TM    JRNLEDSW,B'00000001'                                1108 04048000
         BNZ   @RF01108                                            1108 04049000
*                 DO;               /*                       @Y30LB26*/ 04050000
*                   CALL JOURNAL;   /* JOURNAL RPLV          @Y30LB26*/ 04051000
         BAL   @14,JOURNAL                                         1110 04052000
*                   IF RPLVRETC¬=RCZERO THEN/* CK RETURN     @Y30LB26*/ 04053000
         L     @02,RPLVPTR                                         1111 04054000
         CLC   RPLVRETC(2,@02),@CB00747                            1111 04055000
         BNE   @RT01111                                            1111 04056000
*                     RETURN;       /*                       @Y30LB26*/ 04057000
*                 END;              /*                       @Y30LB26*/ 04058000
*             END;                  /*                       @Y30LB26*/ 04059000
@RF01108 DS    0H                                                  1115 04060000
*         END;                      /*                       @Y30LB26*/ 04061000
*     END;                          /*                       @Y30LB26*/ 04062000
*   ELSE                            /*                       @Y30LB26*/ 04063000
*                                                                  1117 04064000
*     /***************************************************************/ 04065000
*     /*                                                             */ 04066000
*     /* CK TO SEE IF RETURN CODE OTHER THAN                 @Y30LB26*/ 04067000
*     /* RECORD NOT FOUND                                    @Y30LB26*/ 04068000
*     /*                                                             */ 04069000
*     /***************************************************************/ 04070000
*                                                                  1117 04071000
*     IF RPLRCODE¬=NORECRC          /* CK IF NO REC FOUND    @Y30LB26*/ 04072000
*       THEN                        /*                       @Y30LB26*/ 04073000
         B     @RC01092                                            1117 04074000
@RF01092 L     @02,RPLVPTR                                         1117 04075000
         CLC   RPLRCODE(2,@02),@CB00789                            1117 04076000
         BE    @RF01117                                            1117 04077000
*       DO;                         /*                       @Y30LB26*/ 04078000
*         CALL ERREXIT;             /* SAVE RET CODES        @Y30LB26*/ 04079000
         BAL   @14,ERREXIT                                         1119 04080000
*         RETURN;                   /*                       @Y30LB26*/ 04081000
         B     @EL00014                                            1120 04082000
*       END;                        /*                       @Y30LB26*/ 04083000
*                                                                  1122 04084000
*   /*****************************************************************/ 04085000
*   /*                                                               */ 04086000
*   /* EVERY THING IS ALRIGHT SO SET GOOD RETURN CODES       @Y30LB26*/ 04087000
*   /*                                                               */ 04088000
*   /*****************************************************************/ 04089000
*                                                                  1122 04090000
*   RPLVRETC=RCZERO;                /* GOOD RET CODE         @Y30LB26*/ 04091000
@RF01117 DS    0H                                                  1122 04092000
@RC01092 L     @02,RPLVPTR                                         1122 04093000
         MVC   RPLVRETC(2,@02),@CB00747                            1122 04094000
*   RPLRCODE=RCZERO;                /* ZERO REASON CODE      @Y30LB26*/ 04095000
         MVC   RPLRCODE(2,@02),@CB00747                            1123 04096000
*   RETURN;                         /*                       @Y30LB26*/ 04097000
         B     @EL00014                                            1124 04098000
*   END CHKCART;                    /* CHKCART INNER PROC    @Y30LB26*/ 04099000
         B     @EL00014                                            1125 04100000
*                                                                  1126 04101000
*/*  START OF SPECIFICATIONS ****                                  1126 04102000
*                                                                  1126 04103000
*    PROCEDURE NAME - READVVI                                 @Y30LB26  04104000
*                                                                  1126 04105000
*    FUNCTION - RETRIEVE RECORDS FROM THE USERCAT.MSVI DATA SET.  THIS  04106000
*    PROGRAM READS AND RETURNS CERTAIN MSVC RECORDS.  IT DOES NOT  1126 04107000
*    UPDATE ANY MSVC RECORDS.  IT WILL READ DIRECT, READ NEXT OR READ   04108000
*    CHAIN FOR BASE VOLUME RECORDS.  IT WILL ALSO READ THE FIRST BASE   04109000
*    VOLUME RECORD IN THE INVENTORY DATA SET AND THE FIRST BASE VOLUME  04110000
*    RECORD IN THE NON-GROUPED BASE CHAIN. WHEN READING NEXT OR READING 04111000
*    A CHAIN IT WILL CONTINUE TO READ UNTIL A RECORD IS FOUND THAT 1126 04112000
*    MEETS ALL THE TEST PARAMETERS, IF ANY WERE SPECIFIED.  WHEN A 1126 04113000
*    RECORD IS FOUND THAT MEETS ALL THE TEST REQUIREMENTS, IT RETURNS   04114000
*    TO THE CALLING PROGRAM WITH THE RECORD. THE TESTS MADE FOR    1126 04115000
*    THE BASE VOLUME RECORD INCLUDE EXPIRATION DATE, GENERAL OR    1126 04116000
*    RESTRICTED USE, ACTIVE OR INACTIVE.  FOR GROUP RECORDS, READ  1126 04117000
*    DIRECT AND READ NEXT IS VALID.  IT WILL ALSO READ THE FIRST GROUP  04118000
*    RECORD IN THE DATA SET.  THE ONLY CHECK PREFORMED IS THE      1126 04119000
*    GROUP THRESHOLD TEST.  WHEN READING NEXT, IT WILL CONTINUE READING 04120000
*    GROUP RECORDS UNTIL IT FINDS A RECORD WITH A GROUP THRESHOLD  1126 04121000
*    GREATER THAN OR EQUAL TO THE GROUP FREE SPACE.  IT THEN RETURNS    04122000
*    TO THE CALLING PROGRAM WITH THE RECORD.  IF ALL GROUP RECORDS 1126 04123000
*    ARE READ AND NONE WERE FOUND MEETING THE TEST REQUIREMENTS,   1126 04124000
*    A REASON AND CONDITION CODE IS RETURNED TO THE CALLING PROGRAM.    04125000
*    IF READING COPY RECORDS, A DATE AND SEQUENCE CHECK CAN BE     1126 04126000
*    SPECIFIED WHEN READING DIRECT.  A REQUEST CAN BE HANDLED FOR THE   04127000
*    LATEST BACKUP COPY, OLDEST BACKUP COPY OR LATEST COPY.  WHEN  1126 04128000
*    READING NEXT, A COPY ID MUST BE PROVIDED.                     1126 04129000
*    WHEN READING DUPLICATE VOLUME RECORDS, A READ DIRECT WILL GET THE  04130000
*    FIRST DUPLICATE VOLUME RECORD WITH THE GIVEN VOLID.  WHEN     1126 04131000
*    READING NEXT, IF NO VOLID IS GIVEN, THE DUPLICATE ID IS IGNORED    04132000
*    AND THE FIRST DUPLICATE VOLUME RECORD IS RETURNED.  IF A VOLID IS  04133000
*    SPECIFIED ON A READ NEXT, A DUPLICATE ID MUST BE GIVEN.  THE  1126 04134000
*    PROGRAM WILL RETURN THE DUPLICATE RECORD WITH THE NEXT HIGHER ID   04135000
*    FROM THE GIVEN ID.  THE PROGRAM WILL                          1126 04136000
*    CONTINUE READING DUPLICATE RECORDS UNTIL IT RUNS OUT UNLESS A BIT  04137000
*    IS SET IN THE REQUEST BLOCK TELLING THAT ONLY THE DUPLICATE   1126 04138000
*    RECORDS OF THE SPECIFIED VOLUME ARE TO BE RETURNED.           1126 04139000
*                                                                  1126 04140000
*    WHEN READING A CARTRIDGE INDEX RECORD, THE CARTRIDGE RECORD IS     04141000
*    READ AND THEN THE VOLUME RECORD OF THE VOLUME THAT OWNS THE   1126 04142000
*    CARTRIDGE IS READ AND RETURNED TO THE CALLER. IF THE CARTRIDGE     04143000
*    RECORD DOES NOT EXIST, A CONDITION AND REASON CODE IS RETURNED.    04144000
*    IF THE VOLUME RECORD DOES NOT EXIST, A CONDITION AND REASON CODE   04145000
*    IS RETURNED. ALSO FOR THIS ERROR CASE, THE CARTRIDGE INDEX RECORD  04146000
*    IS RETURNED IN THE SAME MANNER THAT THE VOLUME RECORD WOULD   1126 04147000
*    NORMALLY BE RETURNED.                                   @Z40LB66   04148000
*                                                                  1126 04149000
*    WHEN READING AN UNKNOWN RECORD, A CARTRIDGE SERIAL NUMBER MUST     04150000
*    BE SPECIFIED IN ORDER TO READ THE CARTRIDGE INDEX RECORD.  IF 1126 04151000
*    THE CARTRIDGE RECORD DOES NOT EXIST, A CONDITION AND REASON   1126 04152000
*    CODE IS RETURNED TO THE USER. IF A VOLUME ID IS SPECIFIED,    1126 04153000
*    A CHECK IS MADE TO SEE IF IT MATCHES THE ONE IN THE           1126 04154000
*    CARTRIDGE INDEX RECORD.  IF THEY DO MATCH, THE BASE, COPY OR  1126 04155000
*    DUPLICATE VOLUME RECORD THAT OWNS THE CARTRIDGE IS READ AND   1126 04156000
*    RETURNED TO THE CALLING PROGRAM.  IF THE VOLUME ID DOES NOT   1126 04157000
*    MATCH, A REASON AND CONDITION CODE ARE RETURNED. IF THE VOLUME     04158000
*    RECORD DOES NOT EXIST, THE CARTRIDGE RECORD AND A REASON AND  1126 04159000
*    CONDITION CODE ARE RETURNED.                            @Z40LB66   04160000
*                                                                  1126 04161000
*    TO READ A CPU ID RECORD, ONLY THE RVVCPURC FLAG NEEDS TO BE   1126 04162000
*    SPECIFIED.                                              @Z40LB66   04163000
*                                                                  1126 04164000
*   TO READ ONLY A COPY VOLUME PLACE HOLDER RECORD RVVCPLHD        1126 04165000
*   MUST BE SPECIFIED.  IT IS NOT VALID WITH LATEST OR OLDEST      1126 04166000
*   BACKUP OR WITH LATEST COPY.  TO READ ONLY A BASE VOLUME PLACE  1126 04167000
*   HOLDER RECORD RVVBPLHD MUST BE SPECIFIED.  IT IS NOT           1126 04168000
*   VALID WITH READ CHAIN.  WITH RVVCPLHD OR RVVBPLHD EITHER       1126 04169000
*   RVVRDR OR RVVRDNR MUST BE SPECIFIED.  RVVALL IS NOT VALID WITH 1126 04170000
*   READ CHAIN.  IF RVVALL IS SPECIFIED WITH RVVCPYRC, THEN ALL COPY    04171000
*   VOLUME RECORDS INCLUDING COPY PLACE HOLDERS WILL BE RETURNED.  1126 04172000
*   ALSO, IF RVVALL IS SPECIFIED WITH RVVBVRCD, THEN ALL BASE      1126 04173000
*   VOLUME AND BASE PLACE HOLDER RECORDS WILL BE RETURNED.    @ZDR2053  04174000
*                                                                  1126 04175000
*      INPUTS - REGISTER 1 CONTAINS THE ADDRESS OF THE RPLV.  THIS HAS  04176000
*      THE REQUEST BLOCK CONTAINING THE PARAMETERS NEEDED TO READ MSVI  04177000
*      RECORDS.                                               @Y30LB26  04178000
*                                                                  1126 04179000
*      OUTPUTS - REASON AND RETURN CODES, PLUS THE RETURNED        1126 04180000
*      RECORD, IF ONE WAS FOUND.  THE RPLV CONTAINS THE RECORD     1126 04181000
*      ADDRESS, PLUS THE RETURN AND REASON CODES.             @Y30LB26  04182000
*                                                                  1126 04183000
*     '021E'X  VALID TYPE OF READ WAS NOT SPECIFIED           @Y30LB26  04184000
*     '0220'X  READ UNKNOWN WITH NO CSN SPECIFIED             @Y30LB26  04185000
*     '0222'X  TYPE RECORD TO READ NOT SPECIFIED              @Y30LB26  04186000
*     '0223'X  RECORD(S) FOUND DID NOT MEET TESTS             @Y30LB26  04187000
*     '0208'X  REQUESTED RECORD COULD NOT BE FOUND            @Y30LB26  04188000
*     '0224'X  BREAK IN BASE VOLUME CHAIN (GRPED - NON-GRPED) @Y30LB26  04189000
*     '0229'X  TYPE OF COPY NOT SPECIFIED                     @Y30LB26  04190000
*     '021F'X  READ NEXT FOR DUP WITH NO DUP ID SPECIFIED     @Y30LB26  04191000
*     '021D'X  VOLID IN THE CARTRIDGE INDEX RECORD DID NOT    @Y30LB26  04192000
*      MATCH THE SPECIFIED VOLID                              @Y30LB26  04193000
*     '022A'X  UNABLE TO GET BUFFER SPACE TO RETURN RECORD    @Y30LB26  04194000
*     '0221'X  READ NEXT COPY WITH NO COPY ID SPECIFIED       @Y30LB26  04195000
*     '0230'X  USER PROVIDED BUFFER AREA TOO SHORT FOR        @Y30LB26  04196000
*      RECORD BEING RETURNED.                                 @Y30LB26  04197000
*     '023C'X VOLUME RECORD DOES NOT EXIST FOR CARTRIDGE      @Z40LB66  04198000
*      PLUS ANY REASON CODES FROM THE I/O PROCESSOR           @Y30LB26  04199000
**** END OF SPECIFICATIONS **                                        */ 04200000
*                                                                  1126 04201000
*READVVI:                           /*                       #Y30LB26*/ 04202000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 04203000
*                                                                  1126 04204000
READVVI  ST    @14,@SA00015                                        1126 04205000
*   /*****************************************************************/ 04206000
*   /*                                                               */ 04207000
*   /* SET UP ADDRESSING TO REQUEST BLOCK                    #Y30LB26*/ 04208000
*   /*                                                               */ 04209000
*   /*****************************************************************/ 04210000
*                                                                  1127 04211000
*   RVVIPTR=ADDR(RPLVUTIL);         /* ADDR OF REQUEST BLK   #Y30LB26*/ 04212000
*                                                                  1127 04213000
         L     RVVIPTR,RPLVPTR                                     1127 04214000
         LA    RVVIPTR,RPLVUTIL(,RVVIPTR)                          1127 04215000
*   /*****************************************************************/ 04216000
*   /*                                                               */ 04217000
*   /* INITILIZE LOOP INDICATOR                              #Y30LB26*/ 04218000
*   /*                                                               */ 04219000
*   /*****************************************************************/ 04220000
*                                                                  1128 04221000
*   LOOPSW=OFF;                     /* INIT LOOP SW          #Y30LB26*/ 04222000
*                                                                  1128 04223000
         NI    LOOPSW,B'01111111'                                  1128 04224000
*   /*****************************************************************/ 04225000
*   /*                                                               */ 04226000
*   /* CHECK IF TYPE READ IS FOR BASE                        #Y30LB26*/ 04227000
*   /* OR A PLACE HOLDER                                     @ZDR2053*/ 04228000
*   /*                                                               */ 04229000
*   /*****************************************************************/ 04230000
*                                                                  1129 04231000
*   IF RVVBVRCD=ON THEN             /* READ BASE?            #Y30LB26*/ 04232000
         TM    RVVBVRCD(RVVIPTR),B'10000000'                       1129 04233000
         BNO   @RF01129                                            1129 04234000
*     DO;                           /*                       @Y30LB26*/ 04235000
*                                                                  1130 04236000
*       /*************************************************************/ 04237000
*       /*                                                           */ 04238000
*       /* DETERMINE TYPE OF READ TO DO ON BASE REC          @Y30LB26*/ 04239000
*       /*                                                           */ 04240000
*       /*************************************************************/ 04241000
*                                                                  1131 04242000
*       IF RVVRDR=ON THEN           /* READ DIRECT?          @Y30LB26*/ 04243000
         TM    RVVRDR(RVVIPTR),B'10000000'                         1131 04244000
         BNO   @RF01131                                            1131 04245000
*         DO;                       /*                       @Y30LB26*/ 04246000
*           CALL BASEDIR;           /* READ BASE DIRECT      @Y30LB26*/ 04247000
         BAL   @14,BASEDIR                                         1133 04248000
*           RETURN;                 /*                       @Y30LB26*/ 04249000
@EL00015 DS    0H                                                  1134 04250000
@EF00015 DS    0H                                                  1134 04251000
@ER00015 L     @14,@SA00015                                        1134 04252000
         BR    @14                                                 1134 04253000
*         END;                      /*                       @Y30LB26*/ 04254000
*                                                                  1135 04255000
*       /*************************************************************/ 04256000
*       /*                                                           */ 04257000
*       /* READ NEXT                                         @Y30LB26*/ 04258000
*       /*                                                           */ 04259000
*       /*************************************************************/ 04260000
*                                                                  1136 04261000
*       IF RVVRDNR=ON THEN          /* READ NEXT?            @Y30LB26*/ 04262000
@RF01131 TM    RVVRDNR(RVVIPTR),B'01000000'                        1136 04263000
         BNO   @RF01136                                            1136 04264000
*         DO;                       /*                       @Y30LB26*/ 04265000
*           CALL BASENREC;          /* READ BASE NEXT        @Y30LB26*/ 04266000
         BAL   @14,BASENREC                                        1138 04267000
*           RETURN;                 /*                       @Y30LB26*/ 04268000
         B     @EL00015                                            1139 04269000
*         END;                      /*                       @Y30LB26*/ 04270000
*                                                                  1140 04271000
*       /*************************************************************/ 04272000
*       /*                                                           */ 04273000
*       /* READ CHAIN                                        @Y30LB26*/ 04274000
*       /*                                                           */ 04275000
*       /*************************************************************/ 04276000
*                                                                  1141 04277000
*       IF RVVRDCH=ON&RVVBPLHD=OFF&RVVALL=OFF THEN/*         @ZDR2053   04278000
*                                      BASE CHAIN?           @ZDR2053*/ 04279000
@RF01136 TM    RVVRDCH(RVVIPTR),B'00100000'                        1141 04280000
         BNO   @RF01141                                            1141 04281000
         TM    RVVBPLHD(RVVIPTR),B'00000001'                       1141 04282000
         BNZ   @RF01141                                            1141 04283000
         TM    RVVALL(RVVIPTR),B'00000001'                         1141 04284000
         BNZ   @RF01141                                            1141 04285000
*         DO;                       /*                       @Y30LB26*/ 04286000
*           CALL BASECHN;           /* READ CHAIN            @Y30LB26*/ 04287000
         BAL   @14,BASECHN                                         1143 04288000
*           RETURN;                 /*                       @Y30LB26*/ 04289000
         B     @EL00015                                            1144 04290000
*         END;                      /*                       @Y30LB26*/ 04291000
*                                                                  1146 04292000
*       /*************************************************************/ 04293000
*       /*                                                           */ 04294000
*       /* IF NOT READ DIRECT, NEXT OR CHAIN, SET ERROR CODE @Y30LB26*/ 04295000
*       /*                                                           */ 04296000
*       /*************************************************************/ 04297000
*                                                                  1146 04298000
*       RPLVRETC=FOUR;              /* SET BAD RC            @Y30LB26*/ 04299000
@RF01141 L     @02,RPLVPTR                                         1146 04300000
         MVC   RPLVRETC(2,@02),@CB00749                            1146 04301000
*       RPLRCODE=NOTYPRD;           /* TYPE READ NOT SPEC    @Y30LB26*/ 04302000
         MVC   RPLRCODE(2,@02),@CB00809                            1147 04303000
*       RETURN;                     /*                       @Y30LB26*/ 04304000
         B     @EL00015                                            1148 04305000
*     END;                          /*                       @Y30LB26*/ 04306000
*                                                                  1149 04307000
*   /*****************************************************************/ 04308000
*   /*                                                               */ 04309000
*   /* CHECK IF READ IS FOR GROUP RECORD                     @Y30LB26*/ 04310000
*   /*                                                               */ 04311000
*   /*****************************************************************/ 04312000
*                                                                  1150 04313000
*   IF RVVGRPRC=ON THEN             /* READ GROUP?           @Y30LB26*/ 04314000
@RF01129 TM    RVVGRPRC(RVVIPTR),B'01000000'                       1150 04315000
         BNO   @RF01150                                            1150 04316000
*     DO;                           /*                       @Y30LB26*/ 04317000
*                                                                  1151 04318000
*       /*************************************************************/ 04319000
*       /*                                                           */ 04320000
*       /* READ DIRECT GROUP RECORD                          @Y30LB26*/ 04321000
*       /*                                                           */ 04322000
*       /*************************************************************/ 04323000
*                                                                  1152 04324000
*       IF RVVRDR=ON THEN           /* READ DIRECT?          @Y30LB26*/ 04325000
         TM    RVVRDR(RVVIPTR),B'10000000'                         1152 04326000
         BNO   @RF01152                                            1152 04327000
*         DO;                       /*                       @Y30LB26*/ 04328000
*           CALL GRPDIR;            /* READ GROUP DIRECT     @Y30LB26*/ 04329000
         BAL   @14,GRPDIR                                          1154 04330000
*           RETURN;                 /*                       @Y30LB26*/ 04331000
         B     @EL00015                                            1155 04332000
*         END;                      /*                       @Y30LB26*/ 04333000
*                                                                  1156 04334000
*       /*************************************************************/ 04335000
*       /*                                                           */ 04336000
*       /* READ NEXT GROUP RECORD                            @Y30LB26*/ 04337000
*       /*                                                           */ 04338000
*       /*************************************************************/ 04339000
*                                                                  1157 04340000
*       IF RVVRDNR=ON THEN          /* READ NEXT?            @Y30LB26*/ 04341000
@RF01152 TM    RVVRDNR(RVVIPTR),B'01000000'                        1157 04342000
         BNO   @RF01157                                            1157 04343000
*         DO;                       /*                       @Y30LB26*/ 04344000
*           CALL GRPNREC;           /* READ GROUP NEXT       @Y30LB26*/ 04345000
         BAL   @14,GRPNREC                                         1159 04346000
*           RETURN;                 /*                       @Y30LB26*/ 04347000
         B     @EL00015                                            1160 04348000
*         END;                      /*                       @Y30LB26*/ 04349000
*       RPLVRETC=FOUR;              /* BAD RC                @Y30LB26*/ 04350000
@RF01157 L     @02,RPLVPTR                                         1162 04351000
         MVC   RPLVRETC(2,@02),@CB00749                            1162 04352000
*       RPLRCODE=NOTYPRD;           /* TYPE READ NOT SPEC    @Y30LB26*/ 04353000
         MVC   RPLRCODE(2,@02),@CB00809                            1163 04354000
*       RETURN;                     /*                       @Y30LB26*/ 04355000
         B     @EL00015                                            1164 04356000
*     END;                          /*                       @Y30LB26*/ 04357000
*                                                                  1166 04358000
*   /*****************************************************************/ 04359000
*   /*                                                               */ 04360000
*   /* READ COPY RECORD OR COPY PLACE HOLDER RECORD          @ZDR2053*/ 04361000
*   /*                                                               */ 04362000
*   /*****************************************************************/ 04363000
*                                                                  1166 04364000
*   IF RVVCPYRC=ON THEN             /* READ COPY?            @Y30LB26*/ 04365000
@RF01150 TM    RVVCPYRC(RVVIPTR),B'00100000'                       1166 04366000
         BNO   @RF01166                                            1166 04367000
*     DO;                           /*                       @Y30LB26*/ 04368000
*                                                                  1167 04369000
*       /*************************************************************/ 04370000
*       /*                                                           */ 04371000
*       /* READCOPY RECORD DIRECT                            @Y30LB26*/ 04372000
*       /*                                                           */ 04373000
*       /*************************************************************/ 04374000
*                                                                  1168 04375000
*       IF RVVRDR=ON THEN           /* READ DIRECT?          @Y30LB26*/ 04376000
         TM    RVVRDR(RVVIPTR),B'10000000'                         1168 04377000
         BNO   @RF01168                                            1168 04378000
*         DO;                       /*                       @Y30LB26*/ 04379000
*           CALL COPYDIR;           /* READ COPY DIRECT      @Y30LB26*/ 04380000
         BAL   @14,COPYDIR                                         1170 04381000
*           RETURN;                 /*                       @Y30LB26*/ 04382000
         B     @EL00015                                            1171 04383000
*         END;                      /*                       @Y30LB26*/ 04384000
*                                                                  1172 04385000
*       /*************************************************************/ 04386000
*       /*                                                           */ 04387000
*       /* READ NEXT COPY RECORD                             @Y30LB26*/ 04388000
*       /*                                                           */ 04389000
*       /*************************************************************/ 04390000
*                                                                  1173 04391000
*       IF RVVRDNR=ON THEN          /* READ NEXT COPY ?      @Y30LB26*/ 04392000
@RF01168 TM    RVVRDNR(RVVIPTR),B'01000000'                        1173 04393000
         BNO   @RF01173                                            1173 04394000
*         DO;                       /*                       @Y30LB26*/ 04395000
*           CALL COPYNREC;          /* READ NEXT COPY        @Y30LB26*/ 04396000
         BAL   @14,COPYNREC                                        1175 04397000
*           RETURN;                 /*                       @Y30LB26*/ 04398000
         B     @EL00015                                            1176 04399000
*         END;                      /*                       @Y30LB26*/ 04400000
*                                                                  1177 04401000
*       /*************************************************************/ 04402000
*       /*                                                           */ 04403000
*       /* MUST BE A READ DIRECT OR READ NEXT                @Y30LB26*/ 04404000
*       /*                                                           */ 04405000
*       /*************************************************************/ 04406000
*                                                                  1178 04407000
*       RPLVRETC=FOUR;              /* BAD RETURN CODE       @Y30LB26*/ 04408000
@RF01173 L     @02,RPLVPTR                                         1178 04409000
         MVC   RPLVRETC(2,@02),@CB00749                            1178 04410000
*       RPLRCODE=NOTYPRD;           /* NO READ OR NEXT       @Y30LB26*/ 04411000
         MVC   RPLRCODE(2,@02),@CB00809                            1179 04412000
*       RETURN;                     /*                       @Y30LB26*/ 04413000
         B     @EL00015                                            1180 04414000
*     END;                          /*                       @Y30LB26*/ 04415000
*                                                                  1182 04416000
*   /*****************************************************************/ 04417000
*   /*                                                               */ 04418000
*   /* READ DUPLICATE RECORD                                 @Y30LB26*/ 04419000
*   /*                                                               */ 04420000
*   /*****************************************************************/ 04421000
*                                                                  1182 04422000
*   IF RVVDUPRC=ON THEN             /* READ DUPLICATE?       @Y30LB26*/ 04423000
@RF01166 TM    RVVDUPRC(RVVIPTR),B'00010000'                       1182 04424000
         BNO   @RF01182                                            1182 04425000
*     DO;                           /*                       @Y30LB26*/ 04426000
*                                                                  1183 04427000
*       /*************************************************************/ 04428000
*       /*                                                           */ 04429000
*       /* READ DIRECT DUP RECORD                            @Y30LB26*/ 04430000
*       /*                                                           */ 04431000
*       /*************************************************************/ 04432000
*                                                                  1184 04433000
*       IF RVVRDR=ON THEN           /* READ DIRECT?          @Y30LB26*/ 04434000
         TM    RVVRDR(RVVIPTR),B'10000000'                         1184 04435000
         BNO   @RF01184                                            1184 04436000
*         DO;                       /*                       @Y30LB26*/ 04437000
*           CALL DUPDIR;            /* READ DUP DIRECT       @Y30LB26*/ 04438000
         BAL   @14,DUPDIR                                          1186 04439000
*           RETURN;                 /*                       @Y30LB26*/ 04440000
         B     @EL00015                                            1187 04441000
*         END;                      /*                       @Y30LB26*/ 04442000
*                                                                  1188 04443000
*       /*************************************************************/ 04444000
*       /*                                                           */ 04445000
*       /* REAR NEXT DUP RECORD                              @Y30LB26*/ 04446000
*       /*                                                           */ 04447000
*       /*************************************************************/ 04448000
*                                                                  1189 04449000
*       IF RVVRDNR=ON THEN          /* READ NEXT?            @Y30LB26*/ 04450000
@RF01184 TM    RVVRDNR(RVVIPTR),B'01000000'                        1189 04451000
         BNO   @RF01189                                            1189 04452000
*         DO;                       /*                       @Y30LB26*/ 04453000
*           CALL DUPNREC;           /* READ DUP NEXT         @Y30LB26*/ 04454000
         BAL   @14,DUPNREC                                         1191 04455000
*           RETURN;                 /*                       @Y30LB26*/ 04456000
         B     @EL00015                                            1192 04457000
*         END;                      /*                       @Y30LB26*/ 04458000
*                                                                  1193 04459000
*       /*************************************************************/ 04460000
*       /*                                                           */ 04461000
*       /* MUST BE READ DIRECT OR READ NEXT                  @Y30LB26*/ 04462000
*       /*                                                           */ 04463000
*       /*************************************************************/ 04464000
*                                                                  1194 04465000
*       RPLVRETC=FOUR;              /* BAD RC                @Y30LB26*/ 04466000
@RF01189 L     @02,RPLVPTR                                         1194 04467000
         MVC   RPLVRETC(2,@02),@CB00749                            1194 04468000
*       RPLRCODE=NOTYPRD;           /* TYPE READ NOT SPEC    @Y30LB26*/ 04469000
         MVC   RPLRCODE(2,@02),@CB00809                            1195 04470000
*       RETURN;                     /*                       @Y30LB26*/ 04471000
         B     @EL00015                                            1196 04472000
*     END;                          /*                       @Y30LB26*/ 04473000
*                                                                  1198 04474000
*   /*****************************************************************/ 04475000
*   /*                                                               */ 04476000
*   /* CHECK IF READ IS FOR CARTRIDGE INDEX RECORD           @Z40LB66*/ 04477000
*   /*                                                               */ 04478000
*   /*****************************************************************/ 04479000
*                                                                  1198 04480000
*   IF RVVCIRCD=ON THEN                                            1198 04481000
@RF01182 TM    RVVCIRCD(RVVIPTR),B'00000100'                       1198 04482000
         BNO   @RF01198                                            1198 04483000
*     DO;                           /*                       @Z40LB66*/ 04484000
*                                                                  1199 04485000
*       /*************************************************************/ 04486000
*       /*                                                           */ 04487000
*       /* CHECK FOR READ NEXT                               @Z40LB66*/ 04488000
*       /*                                                           */ 04489000
*       /*************************************************************/ 04490000
*                                                                  1200 04491000
*       IF RVVRDNR=ON THEN                                         1200 04492000
         TM    RVVRDNR(RVVIPTR),B'01000000'                        1200 04493000
         BNO   @RF01200                                            1200 04494000
*         DO;                       /*                       @Z40LB66*/ 04495000
*           CALL CARTNREC;          /*                       @Z40LB66*/ 04496000
         BAL   @14,CARTNREC                                        1202 04497000
*           RETURN;                 /*                       @Z40LB66*/ 04498000
         B     @EL00015                                            1203 04499000
*         END;                      /*                       @Z40LB66*/ 04500000
*                                                                  1204 04501000
*       /*************************************************************/ 04502000
*       /*                                                           */ 04503000
*       /* CHECK FOR READ DIRECT                             @Z40LB66*/ 04504000
*       /*                                                           */ 04505000
*       /*************************************************************/ 04506000
*                                                                  1205 04507000
*       IF RVVRDR=ON THEN                                          1205 04508000
@RF01200 TM    RVVRDR(RVVIPTR),B'10000000'                         1205 04509000
         BNO   @RF01205                                            1205 04510000
*         DO;                       /*                       @Z40LB66*/ 04511000
*           CALL CARTDIR;           /*                       @Z40LB66*/ 04512000
         BAL   @14,CARTDIR                                         1207 04513000
*           RETURN;                 /*                       @Z40LB66*/ 04514000
         B     @EL00015                                            1208 04515000
*         END;                      /*                       @Z40LB66*/ 04516000
*                                                                  1209 04517000
*       /*************************************************************/ 04518000
*       /*                                                           */ 04519000
*       /* MUST BE READ DIRECT OR READ NEXT                  @Z40LB66*/ 04520000
*       /*                                                           */ 04521000
*       /*************************************************************/ 04522000
*                                                                  1210 04523000
*       RPLVRETC=FOUR;              /* BAD RC                @Z40LB66*/ 04524000
@RF01205 L     @02,RPLVPTR                                         1210 04525000
         MVC   RPLVRETC(2,@02),@CB00749                            1210 04526000
*       RPLRCODE=NOTYPRD;           /* TYPE READ NOT SPEC    @Z40LB66*/ 04527000
         MVC   RPLRCODE(2,@02),@CB00809                            1211 04528000
*       RETURN;                     /*                       @Z40LB66*/ 04529000
         B     @EL00015                                            1212 04530000
*     END;                          /*                       @Z40LB66*/ 04531000
*                                                                  1214 04532000
*   /*****************************************************************/ 04533000
*   /*                                                               */ 04534000
*   /* READ UNKNOWN RECORD                                   @Y30LB26*/ 04535000
*   /*                                                               */ 04536000
*   /*****************************************************************/ 04537000
*                                                                  1214 04538000
*   IF RVVRUNKN=ON THEN             /* READ UNKNOWN?         @Y30LB26*/ 04539000
@RF01198 TM    RVVRUNKN(RVVIPTR),B'00001000'                       1214 04540000
         BNO   @RF01214                                            1214 04541000
*     DO;                           /*                       @Y30LB26*/ 04542000
*                                                                  1215 04543000
*       /*************************************************************/ 04544000
*       /*                                                           */ 04545000
*       /* CHECK TO SEE IF CART SERIAL SPEC                  @Y30LB26*/ 04546000
*       /*                                                           */ 04547000
*       /*************************************************************/ 04548000
*                                                                  1216 04549000
*       IF RVVSCSN=OFF THEN         /* CARTRIDGE SPECIFIED?  @Y30LB26*/ 04550000
         TM    RVVSCSN(RVVIPTR),B'00001000'                        1216 04551000
         BNZ   @RF01216                                            1216 04552000
*         DO;                       /*                       @Y30LB26*/ 04553000
*           RPLRCODE=NOCART;        /* NO CARTRIDGE GIVEN    @Y30LB26*/ 04554000
         L     @02,RPLVPTR                                         1218 04555000
         MVC   RPLRCODE(2,@02),@CB00813                            1218 04556000
*           RPLVRETC=FOUR;          /* BAD RC                @Y30LB26*/ 04557000
         MVC   RPLVRETC(2,@02),@CB00749                            1219 04558000
*           RETURN;                 /*                       @Y30LB26*/ 04559000
         B     @EL00015                                            1220 04560000
*         END;                      /*                       @Y30LB26*/ 04561000
*       ELSE                        /*                       @Y30LB26*/ 04562000
*                                                                  1222 04563000
*         /***********************************************************/ 04564000
*         /*                                                         */ 04565000
*         /* IF SERIAL SPEC, GO READ CART AND VOL RECS       @Y30LB26*/ 04566000
*         /*                                                         */ 04567000
*         /***********************************************************/ 04568000
*                                                                  1222 04569000
*         DO;                       /*                       @Y30LB26*/ 04570000
@RF01216 DS    0H                                                  1223 04571000
*           CALL CARTDIR;           /* READ CARTRIDGE        @Z40LB66*/ 04572000
         BAL   @14,CARTDIR                                         1223 04573000
*           RETURN;                 /*                       @Y30LB26*/ 04574000
         B     @EL00015                                            1224 04575000
*         END;                      /*                       @Y30LB26*/ 04576000
*     END;                          /*                       @Y30LB26*/ 04577000
*   IF RVVCPURC=ON THEN             /* READ CPU ID RECORD ?  @Z40LB66*/ 04578000
@RF01214 TM    RVVCPURC(RVVIPTR),B'00000010'                       1227 04579000
         BNO   @RF01227                                            1227 04580000
*     DO;                           /*                       @Z40LB66*/ 04581000
*       CALL READCPU;               /*                       @Z40LB66*/ 04582000
         BAL   @14,READCPU                                         1229 04583000
*       RETURN;                     /*                       @Z40LB66*/ 04584000
         B     @EL00015                                            1230 04585000
*     END;                          /*                       @Z40LB66*/ 04586000
*   ELSE                            /*                       @Y30LB26*/ 04587000
*                                                                  1232 04588000
*     /***************************************************************/ 04589000
*     /*                                                             */ 04590000
*     /* TYPE OF RECORD TO READ NOT SPECIFIED                @Y30LB26*/ 04591000
*     /*                                                             */ 04592000
*     /***************************************************************/ 04593000
*                                                                  1232 04594000
*     DO;                           /*                       @Y30LB26*/ 04595000
@RF01227 DS    0H                                                  1233 04596000
*       RPLVRETC=FOUR;              /* BAD RC                @Y30LB26*/ 04597000
         L     @02,RPLVPTR                                         1233 04598000
         MVC   RPLVRETC(2,@02),@CB00749                            1233 04599000
*       RPLRCODE=NORECTYP;          /* REC TYPE NOT GIVEN    @Y30LB26*/ 04600000
         MVC   RPLRCODE(2,@02),@CB00817                            1234 04601000
*       RETURN;                     /*                       @Y30LB26*/ 04602000
         B     @EL00015                                            1235 04603000
*     END;                          /*                       @Y30LB26*/ 04604000
*   END READVVI;                    /*                       @Y30LB26*/ 04605000
*                                                                  1238 04606000
*   /*****************************************************************/ 04607000
*   /*                                                               */ 04608000
*   /* THIS ROUTINE READS A CPU ID RECORD                    @Z40LB66*/ 04609000
*   /*                                                               */ 04610000
*   /*****************************************************************/ 04611000
*                                                                  1238 04612000
*READCPU:                           /*                       @Z40LB66*/ 04613000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB66*/ 04614000
*                                                                  1238 04615000
READCPU  ST    @14,@SA00016                                        1238 04616000
*   /*****************************************************************/ 04617000
*   /*                                                               */ 04618000
*   /* GO RESERVE INVENTORY DATA SET SHARED                  @Z40LB66*/ 04619000
*   /*                                                               */ 04620000
*   /*****************************************************************/ 04621000
*                                                                  1239 04622000
*   CALL RESSHARE;                  /* RESERVE INVENTORY SHR @Z40LB66*/ 04623000
*                                                                  1239 04624000
         BAL   @14,RESSHARE                                        1239 04625000
*   /*****************************************************************/ 04626000
*   /*                                                               */ 04627000
*   /* SET UP TO READ THE CPU ID RECORD                      @Z40LB66*/ 04628000
*   /*                                                               */ 04629000
*   /*****************************************************************/ 04630000
*                                                                  1240 04631000
*   RPLVKEY=ADDR(CKEY);             /* ADDR OF KEY           @Z40LB66*/ 04632000
         L     @04,RPLVPTR                                         1240 04633000
         LA    @02,CKEY                                            1240 04634000
         ST    @02,RPLVKEY(,@04)                                   1240 04635000
*   RPLVLOC=ON;                     /* LOCATE MODE           @Z40LB66*/ 04636000
*   RPLVDIR=ON;                     /* READ DIRECT           @Z40LB66*/ 04637000
         OI    RPLVLOC(@04),B'11000000'                            1242 04638000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Z40LB66*/ 04639000
         MVI   RPLVTYP(@04),X'00'                                  1243 04640000
*   RESPECIFY                                                      1244 04641000
*     REG1 RESTRICTED;              /* RESTRICT REG1         @Z40LB66*/ 04642000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Z40LB66*/ 04643000
         LR    REG1,@04                                            1245 04644000
*   CALL ICBVIO00;                  /* READ CPUID RECORD     @Z40LB66*/ 04645000
         L     @15,@CV00671                                        1246 04646000
         BALR  @14,@15                                             1246 04647000
*   RESPECIFY                                                      1247 04648000
*     REG1 UNRESTRICTED;            /* UNRESTRICT REG1       @Z40LB66*/ 04649000
*                                                                  1247 04650000
*   /*****************************************************************/ 04651000
*   /*                                                               */ 04652000
*   /* CHECK RETURN CODE FROM I/O PROCESSOR                  @Z40LB66*/ 04653000
*   /*                                                               */ 04654000
*   /*****************************************************************/ 04655000
*                                                                  1248 04656000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RC              @Z40LB66*/ 04657000
         L     @04,RPLVPTR                                         1248 04658000
         CLC   RPLVRETC(2,@04),@CB00747                            1248 04659000
         BE    @RF01248                                            1248 04660000
*     DO;                           /*                       @Z40LB66*/ 04661000
*       CALL ERREXIT;               /* SAVE REASON CODES     @Z40LB66*/ 04662000
         BAL   @14,ERREXIT                                         1250 04663000
*       RETURN;                     /*                       @Z40LB66*/ 04664000
@EL00016 DS    0H                                                  1251 04665000
@EF00016 DS    0H                                                  1251 04666000
@ER00016 L     @14,@SA00016                                        1251 04667000
         BR    @14                                                 1251 04668000
*     END;                          /*                       @Z40LB66*/ 04669000
*                                                                  1252 04670000
*   /*****************************************************************/ 04671000
*   /*                                                               */ 04672000
*   /* GET CORE IN SUBPOOL TO MOVE RECORD INTO               @Z40LB66*/ 04673000
*   /*                                                               */ 04674000
*   /*****************************************************************/ 04675000
*                                                                  1253 04676000
*   CALL GETBUF;                    /* GET BUFFER FOR REC    @Z40LB66*/ 04677000
@RF01248 BAL   @14,GETBUF                                          1253 04678000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Z40LB66*/ 04679000
         L     @04,RPLVPTR                                         1254 04680000
         CLC   RPLVRETC(2,@04),@CB00747                            1254 04681000
         BNE   @RT01254                                            1254 04682000
*     RETURN;                       /*                       @Z40LB66*/ 04683000
*   CPUIDPTR=RPLVBUF;               /* SET BASE TO RECORD    @Z40LB66*/ 04684000
         L     @02,RPLVPTR                                         1256 04685000
         L     CPUIDPTR,RPLVBUF(,@02)                              1256 04686000
*   BUFFER=CPUID;                   /* MOVE REC TO BUF       @Z40LB66*/ 04687000
         L     @01,RVVAREA(,RVVIPTR)                               1257 04688000
         MVI   BUFFER+151(@01),C' '                                1257 04689000
         MVC   BUFFER+152(104,@01),BUFFER+151(@01)                 1257 04690000
         MVC   BUFFER(151,@01),CPUID(CPUIDPTR)                     1257 04691000
*   RPLRCODE=RCZERO;                /* GOOD REASON CODE      @Z40LB66*/ 04692000
         MVC   RPLRCODE(2,@02),@CB00747                            1258 04693000
*   RPLVRETC=RCZERO;                /* GOOD RC               @Z40LB66*/ 04694000
         MVC   RPLVRETC(2,@02),@CB00747                            1259 04695000
*   RETURN;                         /*                       @Z40LB66*/ 04696000
         B     @EL00016                                            1260 04697000
*   END READCPU;                    /*                       @Z40LB66*/ 04698000
         B     @EL00016                                            1261 04699000
*                                                                  1262 04700000
*   /*****************************************************************/ 04701000
*   /*                                                               */ 04702000
*   /* THIS ROUTINE READS A BASE VOLUME RECORD DIRECTLY      @Y30LB26*/ 04703000
*   /* FROM KEY PASSED IN REQUEST BLOCK                      @Y30LB26*/ 04704000
*   /*                                                               */ 04705000
*   /*****************************************************************/ 04706000
*                                                                  1262 04707000
*BASEDIR:                           /*                       @Y30LB26*/ 04708000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 04709000
*                                                                  1262 04710000
BASEDIR  ST    @14,@SA00017                                        1262 04711000
*   /*****************************************************************/ 04712000
*   /*                                                               */ 04713000
*   /* GO RESERVE INVENTORY DATA SET SHARED                  @Y30LB26*/ 04714000
*   /*                                                               */ 04715000
*   /*****************************************************************/ 04716000
*                                                                  1263 04717000
*   CALL RESSHARE;                  /* RESERVE INVENTORY SHR @Y30LB26*/ 04718000
*                                                                  1263 04719000
         BAL   @14,RESSHARE                                        1263 04720000
*   /*****************************************************************/ 04721000
*   /*                                                               */ 04722000
*   /* SET UP TO READ BASE VOLUME RECORD                     @Y30LB26*/ 04723000
*   /*                                                               */ 04724000
*   /*****************************************************************/ 04725000
*                                                                  1264 04726000
*   VOLKY=RVVOLUME;                 /* VOL TO BE READ        @Y30LB26*/ 04727000
         MVC   VOLKY(6),RVVOLUME(RVVIPTR)                          1264 04728000
*   RPLVKEY=ADDR(VKEY);             /* ADDR OF KEY           @Y30LB26*/ 04729000
         L     @04,RPLVPTR                                         1265 04730000
         LA    @02,VKEY                                            1265 04731000
         ST    @02,RPLVKEY(,@04)                                   1265 04732000
*   RPLVLOC=ON;                     /* LOCATE MODE           @Y30LB26*/ 04733000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 04734000
         OI    RPLVLOC(@04),B'11000000'                            1267 04735000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 04736000
         MVI   RPLVTYP(@04),X'00'                                  1268 04737000
*   RESPECIFY                                                      1269 04738000
*     REG1 RESTRICTED;              /* RESTRICT REG1         @Y30LB26*/ 04739000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 04740000
         LR    REG1,@04                                            1270 04741000
*   CALL ICBVIO00;                  /* READ BASE RECORD      @Y30LB26*/ 04742000
         L     @15,@CV00671                                        1271 04743000
         BALR  @14,@15                                             1271 04744000
*   RESPECIFY                                                      1272 04745000
*     REG1 UNRESTRICTED;            /* UNRESTRICT REG1       @Y30LB26*/ 04746000
*                                                                  1272 04747000
*   /*****************************************************************/ 04748000
*   /*                                                               */ 04749000
*   /* CHECK RETURN CODE FROM I/O PROCESSOR                  @Y30LB26*/ 04750000
*   /*                                                               */ 04751000
*   /*****************************************************************/ 04752000
*                                                                  1273 04753000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RC              @Y30LB26*/ 04754000
         L     @04,RPLVPTR                                         1273 04755000
         CLC   RPLVRETC(2,@04),@CB00747                            1273 04756000
         BE    @RF01273                                            1273 04757000
*     DO;                           /*                       @Y30LB26*/ 04758000
*       CALL ERREXIT;               /* SAVE REASON CODES     @Y30LB26*/ 04759000
         BAL   @14,ERREXIT                                         1275 04760000
*       RETURN;                     /*                       @Y30LB26*/ 04761000
@EL00017 DS    0H                                                  1276 04762000
@EF00017 DS    0H                                                  1276 04763000
@ER00017 L     @14,@SA00017                                        1276 04764000
         BR    @14                                                 1276 04765000
*     END;                          /*                       @Y30LB26*/ 04766000
*                                                                  1277 04767000
*   /*****************************************************************/ 04768000
*   /*                                                               */ 04769000
*   /* SET UP ADDRESSING TO BASE VOL REC                     @Y30LB26*/ 04770000
*   /* AND MAKE ANY TEST CALLED FOR ON RECORD                @Y30LB26*/ 04771000
*   /*                                                               */ 04772000
*   /*****************************************************************/ 04773000
*                                                                  1278 04774000
*   BASEVPTR=RPLVBUF;               /* MAPPING ON RECORD     @Y30LB26*/ 04775000
@RF01273 L     @04,RPLVPTR                                         1278 04776000
         L     @04,RPLVBUF(,@04)                                   1278 04777000
         ST    @04,BASEVPTR                                        1278 04778000
*   CALL TEST;                      /* TEST RECORD           @Y30LB26*/ 04779000
         BAL   @14,TEST                                            1279 04780000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RC              @Y30LB26*/ 04781000
         L     @04,RPLVPTR                                         1280 04782000
         CLC   RPLVRETC(2,@04),@CB00747                            1280 04783000
         BE    @RF01280                                            1280 04784000
*     DO;                           /*                       @Y30LB26*/ 04785000
*       CALL ERREXIT;               /* SAVE CODES            @Y30LB26*/ 04786000
         BAL   @14,ERREXIT                                         1282 04787000
*       RETURN;                     /*                       @Y30LB26*/ 04788000
         B     @EL00017                                            1283 04789000
*     END;                          /*                       @Y30LB26*/ 04790000
*                                                                  1284 04791000
*   /*****************************************************************/ 04792000
*   /*                                                               */ 04793000
*   /* GET CORE IN SUBPOOL TO MOVE RECORD INTO               @Y30LB26*/ 04794000
*   /*                                                               */ 04795000
*   /*****************************************************************/ 04796000
*                                                                  1285 04797000
*   CALL GETBUF;                    /* GET BUFFER FOR REC    @Y30LB26*/ 04798000
@RF01280 BAL   @14,GETBUF                                          1285 04799000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 04800000
         L     @04,RPLVPTR                                         1286 04801000
         CLC   RPLVRETC(2,@04),@CB00747                            1286 04802000
         BNE   @RT01286                                            1286 04803000
*     RETURN;                       /*                       @Y30LB26*/ 04804000
*   BUFFER=BASEV;                   /* MOVE REC TO BUF       @Y30LB26*/ 04805000
         L     @02,RVVAREA(,RVVIPTR)                               1288 04806000
         MVI   BUFFER+224(@02),C' '                                1288 04807000
         MVC   BUFFER+225(31,@02),BUFFER+224(@02)                  1288 04808000
         L     @01,BASEVPTR                                        1288 04809000
         MVC   BUFFER(224,@02),BASEV(@01)                          1288 04810000
*   RPLRCODE=RCZERO;                /* GOOD REASON CODE      @Y30LB26*/ 04811000
         MVC   RPLRCODE(2,@04),@CB00747                            1289 04812000
*   RPLVRETC=RCZERO;                /* GOOD RC               @Y30LB26*/ 04813000
         MVC   RPLVRETC(2,@04),@CB00747                            1290 04814000
*   RETURN;                         /*                       @Y30LB26*/ 04815000
         B     @EL00017                                            1291 04816000
*   END BASEDIR;                    /*                       @Y30LB26*/ 04817000
         B     @EL00017                                            1292 04818000
*                                                                  1293 04819000
*   /*****************************************************************/ 04820000
*   /*                                                               */ 04821000
*   /* SUBROUTINE READS NEXT BASE VOLUME RECORD              @Y30LB26*/ 04822000
*   /*                                                               */ 04823000
*   /*****************************************************************/ 04824000
*                                                                  1293 04825000
*BASENREC:                          /*                       @Y30LB26*/ 04826000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 04827000
*                                                                  1293 04828000
BASENREC ST    @14,@SA00018                                        1293 04829000
*   /*****************************************************************/ 04830000
*   /*                                                               */ 04831000
*   /* GO RESERVE INVENTORY DATA SET SHARED                  @Y30LB26*/ 04832000
*   /*                                                               */ 04833000
*   /*****************************************************************/ 04834000
*                                                                  1294 04835000
*   CALL RESSHARE;                  /* RESERVE INVENTORY SHR @Y30LB26*/ 04836000
*                                                                  1294 04837000
         BAL   @14,RESSHARE                                        1294 04838000
*   /*****************************************************************/ 04839000
*   /*                                                               */ 04840000
*   /* DETERMINE IF READING FOR FIRST BASE VOLUME            @Y30LB26*/ 04841000
*   /* RECORD. IF SO SET VOL TO ZERO AND PROCESS             @Y30LB26*/ 04842000
*   /* LIKE A REGULAR READ NEXT                              @Y30LB26*/ 04843000
*   /*                                                               */ 04844000
*   /*****************************************************************/ 04845000
*                                                                  1295 04846000
*   IF RVVSVOL=OFF THEN             /* VOLUME NAME SPECIF    @Y30LB26*/ 04847000
         TM    RVVSVOL(RVVIPTR),B'00000001'                        1295 04848000
         BNZ   @RF01295                                            1295 04849000
*     VOLKY=ZEROCHAR;               /* SET VOL KEY ZERO      @Y30LB26*/ 04850000
         MVC   VOLKY(6),ZEROCHAR                                   1296 04851000
*   ELSE                            /*                       @Y30LB26*/ 04852000
*     VOLKY=RVVOLUME;               /* VOL TO READ           @Y30LB26*/ 04853000
*                                                                  1297 04854000
         B     @RC01295                                            1297 04855000
@RF01295 MVC   VOLKY(6),RVVOLUME(RVVIPTR)                          1297 04856000
*   /*****************************************************************/ 04857000
*   /*                                                               */ 04858000
*   /* START OUTSIDE READ NEXT LOOP                          @Y30LB26*/ 04859000
*   /*                                                               */ 04860000
*   /*****************************************************************/ 04861000
*                                                                  1298 04862000
*   DO WHILE I=I;                   /* BIG LOOP              @Y30LB26*/ 04863000
*                                                                  1298 04864000
@RC01295 B     @DE01298                                            1298 04865000
@DL01298 DS    0H                                                  1299 04866000
*     /***************************************************************/ 04867000
*     /*                                                             */ 04868000
*     /* SET KEY TO SKIP AROUND COPIES AND READ NEXT BASE    @Y30LB26*/ 04869000
*     /*                                                             */ 04870000
*     /***************************************************************/ 04871000
*                                                                  1299 04872000
*     ARITHBAS=VKEY(12:13);         /* MOVE EXIST KEY ID     @Y30LB26*/ 04873000
         MVC   ARITHBAS(2),VKEY+11                                 1299 04874000
*     BASEID=BASEID+256;            /* GET TO NEXT BASE      @Y30LB26*/ 04875000
         LA    @04,256                                             1300 04876000
         LH    @02,BASEID                                          1300 04877000
         N     @02,@CF01186                                        1300 04878000
         ALR   @04,@02                                             1300 04879000
         STH   @04,BASEID                                          1300 04880000
*     VKEY(12:13)=ARITHBAS;         /* RESULT BACK TO KEY    @Y30LB26*/ 04881000
         MVC   VKEY+11(2),ARITHBAS                                 1301 04882000
*     RPLVKEY=ADDR(VKEY);           /* ADDR OF KEY           @Y30LB26*/ 04883000
         L     @04,RPLVPTR                                         1302 04884000
         LA    @02,VKEY                                            1302 04885000
         ST    @02,RPLVKEY(,@04)                                   1302 04886000
*     RPLVLOC=ON;                   /* LOCATE MODE           @Y30LB26*/ 04887000
*     RPLVDIR=ON;                   /* READ DIRECT           @Y30LB26*/ 04888000
         OI    RPLVLOC(@04),B'11000000'                            1304 04889000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           @Y30LB26*/ 04890000
         MVI   RPLVTYP(@04),X'00'                                  1305 04891000
*     RPLVKGE=ON;                   /* READ >=               @Y30LB26*/ 04892000
         OI    RPLVKGE(@04),B'00000100'                            1306 04893000
*     RESPECIFY                                                    1307 04894000
*       REG1 RSTD;                  /* RESTRICT REG1         @Y30LB26*/ 04895000
*     REG1=RPLVPTR;                 /* ADDR RPLV             @Y30LB26*/ 04896000
         LR    REG1,@04                                            1308 04897000
*     CALL ICBVIO00;                /* READ NEXT BASE        @Y30LB26*/ 04898000
         L     @15,@CV00671                                        1309 04899000
         BALR  @14,@15                                             1309 04900000
*     RESPECIFY                                                    1310 04901000
*       REG1 UNRSTD;                /* UNRESTRICT REG1       @Y30LB26*/ 04902000
*                                                                  1310 04903000
*     /***************************************************************/ 04904000
*     /*                                                             */ 04905000
*     /* CHECK RETURN CODE                                   @Y30LB26*/ 04906000
*     /*                                                             */ 04907000
*     /***************************************************************/ 04908000
*                                                                  1311 04909000
*     IF RPLVRETC¬=RCZERO THEN      /* CHECK RC              @Y30LB26*/ 04910000
         L     @04,RPLVPTR                                         1311 04911000
         CLC   RPLVRETC(2,@04),@CB00747                            1311 04912000
         BE    @RF01311                                            1311 04913000
*       DO;                         /*                       @Y30LB26*/ 04914000
*                                                                  1312 04915000
*         /***********************************************************/ 04916000
*         /*                                                         */ 04917000
*         /* IF RECORDS READ BEFORE, THEN CHECK TYPE         @Y30LB26*/ 04918000
*         /* OF RETURN FROM I/O PROCESSOR                    @Y30LB26*/ 04919000
*         /*                                                         */ 04920000
*         /***********************************************************/ 04921000
*                                                                  1313 04922000
*         IF LOOPSW=ON THEN         /* SEE READ RECS BEFORE  @Y30LB26*/ 04923000
         TM    LOOPSW,B'10000000'                                  1313 04924000
         BNO   @RF01313                                            1313 04925000
*           DO;                     /*                       @Y30LB26*/ 04926000
*                                                                  1314 04927000
*             /*******************************************************/ 04928000
*             /*                                                     */ 04929000
*             /* IF RECORDS READ AND AT END OF DATA SET,     @Y30LB26*/ 04930000
*             /* THEN SET RETURN CODE TO TEST NOT MET        @Y30LB26*/ 04931000
*             /*                                                     */ 04932000
*             /*******************************************************/ 04933000
*                                                                  1315 04934000
*             IF RPLRCODE=NORECRC THEN/* END OF DATA ?       @Y30LB26*/ 04935000
         CLC   RPLRCODE(2,@04),@CB00789                            1315 04936000
         BNE   @RF01315                                            1315 04937000
*               DO;                 /*                       @Y30LB26*/ 04938000
*                 RPLRCODE=TNOTMET; /* INDIC TEST MADE       @Y30LB26*/ 04939000
         MVC   RPLRCODE(2,@04),@CB00819                            1317 04940000
*                 RPLVRETC=FOUR;    /* INSURE RC FOUR        @Y30LB26*/ 04941000
         MVC   RPLVRETC(2,@04),@CB00749                            1318 04942000
*                 CALL ERREXIT;     /* SAVE RET CODE         @Y30LB26*/ 04943000
         BAL   @14,ERREXIT                                         1319 04944000
*                 RETURN;           /*                       @Y30LB26*/ 04945000
@EL00018 DS    0H                                                  1320 04946000
@EF00018 DS    0H                                                  1320 04947000
@ER00018 L     @14,@SA00018                                        1320 04948000
         BR    @14                                                 1320 04949000
*               END;                /*                       @Y30LB26*/ 04950000
*                                                                  1321 04951000
*             /*******************************************************/ 04952000
*             /*                                                     */ 04953000
*             /* IF SOME OTHER RETURN CODE, THEN JUST        @Y30LB26*/ 04954000
*             /* RETURN WITH IT                              @Y30LB26*/ 04955000
*             /*                                                     */ 04956000
*             /*******************************************************/ 04957000
*                                                                  1322 04958000
*             ELSE                  /*                       #Y30LB26*/ 04959000
*               DO;                 /*                       #Y30LB26*/ 04960000
@RF01315 DS    0H                                                  1323 04961000
*                 CALL ERREXIT;     /* SAVE RET CODES        #Y30LB26*/ 04962000
         BAL   @14,ERREXIT                                         1323 04963000
*                 RETURN;           /*                       #Y30LB26*/ 04964000
         B     @EL00018                                            1324 04965000
*               END;                /*                       #Y30LB26*/ 04966000
*           END;                    /*                       #Y30LB26*/ 04967000
*                                                                  1326 04968000
*         /***********************************************************/ 04969000
*         /*                                                         */ 04970000
*         /* IF NO RECORDS WERE READ THEN JUST RETURN        @Y30LB26*/ 04971000
*         /* WITH ORIGINAL RETURN CODES FROM I/O PROC        @Y30LB26*/ 04972000
*         /*                                                         */ 04973000
*         /***********************************************************/ 04974000
*                                                                  1327 04975000
*         ELSE                      /*                       #Y30LB26*/ 04976000
*           DO;                     /*                       #Y30LB26*/ 04977000
@RF01313 DS    0H                                                  1328 04978000
*             CALL ERREXIT;         /*                       #Y30LB26*/ 04979000
         BAL   @14,ERREXIT                                         1328 04980000
*             RETURN;               /*                       #Y30LB26*/ 04981000
         B     @EL00018                                            1329 04982000
*           END;                    /*                       #Y30LB26*/ 04983000
*       END;                        /*                       #Y30LB26*/ 04984000
*                                                                  1331 04985000
*     /***************************************************************/ 04986000
*     /*                                                             */ 04987000
*     /* CHECK TO SEE IF STILL A BASE VOLUME RECORD          #Y30LB26*/ 04988000
*     /*                                                             */ 04989000
*     /***************************************************************/ 04990000
*                                                                  1332 04991000
*     BASEVPTR=RPLVBUF;             /* ADDR REC JUST READ    #Y30LB26*/ 04992000
@RF01311 L     @04,RPLVPTR                                         1332 04993000
         L     @04,RPLVBUF(,@04)                                   1332 04994000
         ST    @04,BASEVPTR                                        1332 04995000
*     IF BASEVKEY=VKY&              /*                       #Y30LB26*/ 04996000
*         BASZERO=FIXZERO THEN      /* BASE VOL?             @Y30LB26*/ 04997000
         CLC   BASEVKEY(5,@04),VKY                                 1333 04998000
         BNE   @RF01333                                            1333 04999000
         CLI   BASZERO(@04),0                                      1333 05000000
         BNE   @RF01333                                            1333 05001000
*       DO;                         /*                       @Y30LB26*/ 05002000
*                                                                  1334 05003000
*         /***********************************************************/ 05004000
*         /*                                                         */ 05005000
*         /* GO TEST RECORD SINCE IT IS A BASE VOLUME REC    @Y30LB26*/ 05006000
*         /*                                                         */ 05007000
*         /***********************************************************/ 05008000
*                                                                  1335 05009000
*         CALL TEST;                /* TEST BASE REC         @Y30LB26*/ 05010000
         BAL   @14,TEST                                            1335 05011000
*         IF RPLVRETC=RCZERO THEN   /* TEST MET?             @Y30LB26*/ 05012000
         L     @04,RPLVPTR                                         1336 05013000
         CLC   RPLVRETC(2,@04),@CB00747                            1336 05014000
         BNE   @RF01336                                            1336 05015000
*           DO;                     /*                       @Y30LB26*/ 05016000
*                                                                  1337 05017000
*             /*******************************************************/ 05018000
*             /*                                                     */ 05019000
*             /* IF PASSED TEST, GET BUFFER AND MOVE IN REC  @Y30LB26*/ 05020000
*             /*                                                     */ 05021000
*             /*******************************************************/ 05022000
*                                                                  1338 05023000
*             CALL GETBUF;          /* GET SUBPOOL BUFFER    @Y30LB26*/ 05024000
         BAL   @14,GETBUF                                          1338 05025000
*             IF RPLVRETC¬=RCZERO THEN/* CK RETURN           @Y30LB26*/ 05026000
         L     @04,RPLVPTR                                         1339 05027000
         CLC   RPLVRETC(2,@04),@CB00747                            1339 05028000
         BNE   @RT01339                                            1339 05029000
*               RETURN;             /*                       @Y30LB26*/ 05030000
*             BUFFER=BASEV;         /* MOVE REC TO BUFFER    @Y30LB26*/ 05031000
         L     @02,RVVAREA(,RVVIPTR)                               1341 05032000
         MVI   BUFFER+224(@02),C' '                                1341 05033000
         MVC   BUFFER+225(31,@02),BUFFER+224(@02)                  1341 05034000
         L     @01,BASEVPTR                                        1341 05035000
         MVC   BUFFER(224,@02),BASEV(@01)                          1341 05036000
*             RPLVRETC=RCZERO;      /* GOOD RC               @Y30LB26*/ 05037000
         MVC   RPLVRETC(2,@04),@CB00747                            1342 05038000
*             RPLRCODE=RCZERO;      /* GOOD REASON CODE      @Y30LB26*/ 05039000
         MVC   RPLRCODE(2,@04),@CB00747                            1343 05040000
*             RETURN;               /*                       @Y30LB26*/ 05041000
         B     @EL00018                                            1344 05042000
*           END;                    /*                       @Y30LB26*/ 05043000
*         ELSE                      /*                       @Y30LB26*/ 05044000
*                                                                  1346 05045000
*           /*********************************************************/ 05046000
*           /*                                                       */ 05047000
*           /* RESET KEY TO VOL JUST READ SO WHEN ADD        @Y30LB26*/ 05048000
*           /* 256 TO KEY IT IS SET TO READ NEXT BASE VOLUME @Y30LB26*/ 05049000
*           /* ALSO INDICATE LOOPING HAS OCCURED             @Y30LB26*/ 05050000
*           /*                                                       */ 05051000
*           /*********************************************************/ 05052000
*                                                                  1346 05053000
*           DO;                     /*                       @Y30LB26*/ 05054000
@RF01336 DS    0H                                                  1347 05055000
*             VKEY=BASNAME;         /* SET TO ADD 256        @Y30LB26*/ 05056000
         L     @04,BASEVPTR                                        1347 05057000
         MVC   VKEY(13),BASNAME(@04)                               1347 05058000
*             LOOPSW=ON;            /* INDICATE LOOPING      @Y30LB26*/ 05059000
         OI    LOOPSW,B'10000000'                                  1348 05060000
*           END;                    /*                       @Y30LB26*/ 05061000
*       END;                        /*                       @Y30LB26*/ 05062000
*     ELSE                          /*                       @Y30LB26*/ 05063000
*       DO;                         /*                       @Y30LB26*/ 05064000
*                                                                  1351 05065000
         B     @RC01333                                            1351 05066000
@RF01333 DS    0H                                                  1352 05067000
*         /***********************************************************/ 05068000
*         /*                                                         */ 05069000
*         /* IF THIS IS A COPY VOLUME OR COPY PLACE          @ZA13504*/ 05070000
*         /* HOLDER, THEN GET NEXT BASE VOLUME RECORD        @ZA13504*/ 05071000
*         /* FROM INVENTORY.                                 @ZA13504*/ 05072000
*         /*                                                         */ 05073000
*         /***********************************************************/ 05074000
*                                                                  1352 05075000
*         IF BASEVKEY=VKY THEN      /* IS THIS A BASE RECORD @ZA13504*/ 05076000
         L     @04,BASEVPTR                                        1352 05077000
         CLC   BASEVKEY(5,@04),VKY                                 1352 05078000
         BNE   @RF01352                                            1352 05079000
*           DO;                     /* YES                   @ZA13504*/ 05080000
*             VKEY=BASNAME;         /* SET TO AD 256 TO KEY  @ZA13504*/ 05081000
         MVC   VKEY(13),BASNAME(@04)                               1354 05082000
*             VIDKY=FIXZERO;        /* ZERO KEY              @ZA13504*/ 05083000
         MVI   VIDKY,X'00'                                         1355 05084000
*           END;                    /*                       @ZA13504*/ 05085000
*         ELSE                      /* NO, NOT BASE RECORD   @ZA13504*/ 05086000
*           DO;                     /*                       @ZA13504*/ 05087000
*                                                                  1357 05088000
         B     @RC01352                                            1357 05089000
@RF01352 DS    0H                                                  1358 05090000
*             /*******************************************************/ 05091000
*             /*                                                     */ 05092000
*             /* IF LOOPING HAS OCCURED, SET RETURN CODE     @Y30LB26*/ 05093000
*             /* INDICATING TEST NOT MET RATHER THAN         @Y30LB26*/ 05094000
*             /* RECORD NOT FOUND                            @Y30LB26*/ 05095000
*             /*                                                     */ 05096000
*             /*******************************************************/ 05097000
*                                                                  1358 05098000
*             IF LOOPSW=ON THEN     /* CHECK FOR LOOPING     @Y30LB26*/ 05099000
         TM    LOOPSW,B'10000000'                                  1358 05100000
         BNO   @RF01358                                            1358 05101000
*               DO;                 /*                       @Y30LB26*/ 05102000
*                 RPLVRETC=FOUR;    /* BAD RC                @Y30LB26*/ 05103000
         L     @02,RPLVPTR                                         1360 05104000
         MVC   RPLVRETC(2,@02),@CB00749                            1360 05105000
*                 RPLRCODE=TNOTMET; /* TEST NOT MET          @Y30LB26*/ 05106000
         MVC   RPLRCODE(2,@02),@CB00819                            1361 05107000
*                 CALL ERREXIT;     /* FREE INVENTORY        @Y30LB26*/ 05108000
         BAL   @14,ERREXIT                                         1362 05109000
*                 RETURN;           /*                       @Y30LB26*/ 05110000
         B     @EL00018                                            1363 05111000
*               END;                /*                       @Y30LB26*/ 05112000
*             ELSE                  /*                       @Y30LB26*/ 05113000
*                                                                  1365 05114000
*               /*****************************************************/ 05115000
*               /*                                                   */ 05116000
*               /* IF LOOPING HAS NOT OCCURED,SET RETURN CODE        */ 05117000
*               /*                                           @Y30LB26*/ 05118000
*               /* TO INDICATE RECORD WAS NOT FOUND          @Y30LB26*/ 05119000
*               /*                                                   */ 05120000
*               /*****************************************************/ 05121000
*                                                                  1365 05122000
*               DO;                 /*                       @Y30LB26*/ 05123000
@RF01358 DS    0H                                                  1366 05124000
*                 RPLVRETC=FOUR;    /* BAD RC                @Y30LB26*/ 05125000
         L     @02,RPLVPTR                                         1366 05126000
         MVC   RPLVRETC(2,@02),@CB00749                            1366 05127000
*                 RPLRCODE=NORECRC; /* RECORD NOT FOUND      @Y30LB26*/ 05128000
         MVC   RPLRCODE(2,@02),@CB00789                            1367 05129000
*                 CALL ERREXIT;     /* FREE INVENTORY        @Y30LB26*/ 05130000
         BAL   @14,ERREXIT                                         1368 05131000
*                 RETURN;           /*                       @Y30LB26*/ 05132000
         B     @EL00018                                            1369 05133000
*               END;                /*                       @Y30LB26*/ 05134000
*           END;                    /*                       @Y30LB26*/ 05135000
*       END;                        /*                       @XA15558*/ 05136000
@RC01352 DS    0H                                                  1373 05137000
*   END;                            /*                       @Y30LB26*/ 05138000
@RC01333 DS    0H                                                  1373 05139000
@DE01298 CLC   I(1),I                                              1373 05140000
         BE    @DL01298                                            1373 05141000
*   END BASENREC;                   /*                       @Y30LB26*/ 05142000
         B     @EL00018                                            1374 05143000
*                                                                  1375 05144000
*   /*****************************************************************/ 05145000
*   /*                                                               */ 05146000
*   /* THIS SUBROUTINE READS BASE VOLUME RECORDS IN          @Y30LB26*/ 05147000
*   /* A GIVEN GROUP                                         @Y30LB26*/ 05148000
*   /*                                                               */ 05149000
*   /*****************************************************************/ 05150000
*                                                                  1375 05151000
*BASECHN:                           /*                       @Y30LB26*/ 05152000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 05153000
*                                                                  1375 05154000
BASECHN  ST    @14,@SA00019                                        1375 05155000
*   /*****************************************************************/ 05156000
*   /*                                                               */ 05157000
*   /* GO RESERVE INVENTORY DATA SET SHARED                  @Y30LB26*/ 05158000
*   /*                                                               */ 05159000
*   /*****************************************************************/ 05160000
*                                                                  1376 05161000
*   CALL RESSHARE;                  /* RESERVE INVENTORY SHR @Y30LB26*/ 05162000
*                                                                  1376 05163000
         BAL   @14,RESSHARE                                        1376 05164000
*   /*****************************************************************/ 05165000
*   /*                                                               */ 05166000
*   /* IF VOL NOT SPECIFIED, THEN WANT FIRST                 @Y30LB26*/ 05167000
*   /* NON-GROUPED BASE VOLUME RECORD, SO                    @Y30LB26*/ 05168000
*   /* CALL SUBROUTINE TO GET IT                             @Y30LB26*/ 05169000
*   /*                                                               */ 05170000
*   /*****************************************************************/ 05171000
*                                                                  1377 05172000
*   IF RVVSVOL=OFF THEN             /* VOL NOT SPECIFIED ?   @Y30LB26*/ 05173000
         TM    RVVSVOL(RVVIPTR),B'00000001'                        1377 05174000
         BNZ   @RF01377                                            1377 05175000
*     DO;                           /*                       @Y30LB26*/ 05176000
*       CALL FSTNGBAS;              /* GO GET FIRST NON-GRP  @Y30LB26*/ 05177000
         BAL   @14,FSTNGBAS                                        1379 05178000
*       IF RPLVRETC=RCZERO THEN     /* GOOD RETURN           @Y30LB26*/ 05179000
         L     @04,RPLVPTR                                         1380 05180000
         CLC   RPLVRETC(2,@04),@CB00747                            1380 05181000
         BE    @RT01380                                            1380 05182000
*         RETURN;                   /*                       @Y30LB26*/ 05183000
*       ELSE                        /*                       @Y30LB26*/ 05184000
*         IF RPLRCODE¬=TNOTMET THEN /* CK FOR TEST NOT MET   @Y30LB26*/ 05185000
         CLC   RPLRCODE(2,@04),@CB00819                            1382 05186000
         BNE   @RT01382                                            1382 05187000
*           RETURN;                 /*                       @Y30LB26*/ 05188000
*         ELSE                      /* OTHER REASON          @ZM31062*/ 05189000
*           DO;                     /*                       @ZM31062*/ 05190000
*             IF BASLAST=ON THEN    /* LAST VOLUME           @ZM31062*/ 05191000
         L     @04,BASEVPTR                                        1385 05192000
         TM    BASLAST(@04),B'00001000'                            1385 05193000
         BNO   @RF01385                                            1385 05194000
*               DO;                 /*                       @ZM31062*/ 05195000
*                 CALL ERREXIT;     /* SAVE REASON CODES     @ZM31062*/ 05196000
         BAL   @14,ERREXIT                                         1387 05197000
*                 RETURN;           /* RETURN TO CALLER      @ZM31062*/ 05198000
@EL00019 DS    0H                                                  1388 05199000
@EF00019 DS    0H                                                  1388 05200000
@ER00019 L     @14,@SA00019                                        1388 05201000
         BR    @14                                                 1388 05202000
*               END;                /*                       @ZM31062*/ 05203000
*             ELSE                  /*                       @ZM31062*/ 05204000
*               VOLKY=BASNEXTV;     /* SET PTR FOR NEXT VOL  @ZM31062*/ 05205000
@RF01385 L     @04,BASEVPTR                                        1390 05206000
         MVC   VOLKY(6),BASNEXTV(@04)                              1390 05207000
*           END;                    /*                       @ZM31062*/ 05208000
*     END;                          /*                       @Y30LB26*/ 05209000
*                                                                  1392 05210000
*   /*****************************************************************/ 05211000
*   /*                                                               */ 05212000
*   /* PUT VOLUME NAME IN KEY AND START READ CHAIN LOOP      @Y30LB26*/ 05213000
*   /* SINCE VOLUMN NAME WAS SPECIFIED IN REQUEST BLOCK      @Y30LB26*/ 05214000
*   /*                                                               */ 05215000
*   /*****************************************************************/ 05216000
*                                                                  1393 05217000
*   ELSE                            /*                       @Y30LB26*/ 05218000
*     VOLKY=RVVOLUME;               /* VOL NAME TO READ      @Y30LB26*/ 05219000
*                                                                  1393 05220000
         B     @RC01377                                            1393 05221000
@RF01377 MVC   VOLKY(6),RVVOLUME(RVVIPTR)                          1393 05222000
*   /*****************************************************************/ 05223000
*   /*                                                               */ 05224000
*   /* START GOING THRU EITHER GROUPED OR NON-GROUPED        @Y30LB26*/ 05225000
*   /* CHAIN                                                 @Y30LB26*/ 05226000
*   /*                                                               */ 05227000
*   /*****************************************************************/ 05228000
*                                                                  1394 05229000
*   DO WHILE I=I;                   /* BIG LOOP              @Y30LB26*/ 05230000
@RC01377 B     @DE01394                                            1394 05231000
@DL01394 DS    0H                                                  1395 05232000
*     RPLVKEY=ADDR(VKEY);           /* ADDR OF KEY           @Y30LB26*/ 05233000
         L     @04,RPLVPTR                                         1395 05234000
         LA    @02,VKEY                                            1395 05235000
         ST    @02,RPLVKEY(,@04)                                   1395 05236000
*     RPLVLOC=ON;                   /* LOCATE MODE           @Y30LB26*/ 05237000
*     RPLVDIR=ON;                   /* READ DIRECT           @Y30LB26*/ 05238000
         OI    RPLVLOC(@04),B'11000000'                            1397 05239000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           @Y30LB26*/ 05240000
         MVI   RPLVTYP(@04),X'00'                                  1398 05241000
*     RESPECIFY                                                    1399 05242000
*       REG1 RSTD;                  /* RESTRICT REG1         @Y30LB26*/ 05243000
*     REG1=RPLVPTR;                 /* ADDR OF RPLV          @Y30LB26*/ 05244000
         LR    REG1,@04                                            1400 05245000
*     CALL ICBVIO00;                /* READ BASE REC         @Y30LB26*/ 05246000
         L     @15,@CV00671                                        1401 05247000
         BALR  @14,@15                                             1401 05248000
*     RESPECIFY                                                    1402 05249000
*       REG1 UNRSTD;                /* UNRESTRICT REG1       @Y30LB26*/ 05250000
*                                                                  1402 05251000
*     /***************************************************************/ 05252000
*     /*                                                             */ 05253000
*     /* CHECK ON RETURN CODE                                @Y30LB26*/ 05254000
*     /*                                                             */ 05255000
*     /***************************************************************/ 05256000
*                                                                  1403 05257000
*     IF RPLVRETC¬=RCZERO THEN      /* CHECK RC              @Y30LB26*/ 05258000
         L     @04,RPLVPTR                                         1403 05259000
         CLC   RPLVRETC(2,@04),@CB00747                            1403 05260000
         BE    @RF01403                                            1403 05261000
*       DO;                         /*                       @Y30LB26*/ 05262000
*         CALL ERREXIT;             /* SAVE REASON CODE      @Y30LB26*/ 05263000
         BAL   @14,ERREXIT                                         1405 05264000
*         RETURN;                   /*                       @Y30LB26*/ 05265000
         B     @EL00019                                            1406 05266000
*       END;                        /*                       @Y30LB26*/ 05267000
*                                                                  1407 05268000
*     /***************************************************************/ 05269000
*     /*                                                             */ 05270000
*     /* GET ADDRESS OF BASE RECORD, CHECK IF GROUPED CHAIN  @Y30LB26*/ 05271000
*     /*                                                             */ 05272000
*     /***************************************************************/ 05273000
*                                                                  1408 05274000
*     BASEVPTR=RPLVBUF;             /* ADDR OF RECORD        @Y30LB26*/ 05275000
@RF01403 L     @04,RPLVPTR                                         1408 05276000
         L     @02,RPLVBUF(,@04)                                   1408 05277000
         ST    @02,BASEVPTR                                        1408 05278000
*     IF RVVGPVOL=ON THEN           /* GROUPED VOL CHAIN?    @Y30LB26*/ 05279000
         TM    RVVGPVOL(RVVIPTR),B'10000000'                       1409 05280000
         BNO   @RF01409                                            1409 05281000
*       DO;                         /*                       @Y30LB26*/ 05282000
*                                                                  1410 05283000
*         /***********************************************************/ 05284000
*         /*                                                         */ 05285000
*         /* CHECK TO SEE IF GROUP MATCHES ONE GIVEN         @Y30LB26*/ 05286000
*         /* IN REQUEST BLOCK                                @Y30LB26*/ 05287000
*         /*                                                         */ 05288000
*         /***********************************************************/ 05289000
*                                                                  1411 05290000
*         IF BASGROUP¬=RVVGROUP THEN/* GROUPS MATCH?         @Y30LB26*/ 05291000
         CLC   BASGROUP(8,@02),RVVGROUP(RVVIPTR)                   1411 05292000
         BE    @RF01411                                            1411 05293000
*           DO;                     /*                       @Y30LB26*/ 05294000
*             RPLVRETC=FOUR;        /* BAD RC                @Y30LB26*/ 05295000
         MVC   RPLVRETC(2,@04),@CB00749                            1413 05296000
*             RPLRCODE=BADCHAIN;    /* BREAK IN CHAIN        @Y30LB26*/ 05297000
         MVC   RPLRCODE(2,@04),@CB00821                            1414 05298000
*             CALL ERREXIT;         /* SAVE REASON CODES     @Y30LB26*/ 05299000
         BAL   @14,ERREXIT                                         1415 05300000
*             RETURN;               /*                       @Y30LB26*/ 05301000
         B     @EL00019                                            1416 05302000
*           END;                    /*                       @Y30LB26*/ 05303000
*       END;                        /*                       @Y30LB26*/ 05304000
*     ELSE                          /*                       @Y30LB26*/ 05305000
*                                                                  1419 05306000
*       /*************************************************************/ 05307000
*       /*                                                           */ 05308000
*       /* CHECK IF NON-GROUPED VOLUME                       @Y30LB26*/ 05309000
*       /*                                                           */ 05310000
*       /*************************************************************/ 05311000
*                                                                  1419 05312000
*       IF RVVNGVOL=ON THEN         /* NONGROUPED VOLUME?    @Y30LB26*/ 05313000
         B     @RC01409                                            1419 05314000
@RF01409 TM    RVVNGVOL(RVVIPTR),B'01000000'                       1419 05315000
         BNO   @RF01419                                            1419 05316000
*         DO;                       /*                       @Y30LB26*/ 05317000
*                                                                  1420 05318000
*           /*********************************************************/ 05319000
*           /*                                                       */ 05320000
*           /* BE SURE BASE RECORD INDICATES NON-GROUPED     @Y30LB26*/ 05321000
*           /*                                                       */ 05322000
*           /*********************************************************/ 05323000
*                                                                  1421 05324000
*           IF BASGROUP¬=BLANK8 THEN/* CHECK NONGROUPED      @Y30LB26*/ 05325000
         L     @04,BASEVPTR                                        1421 05326000
         CLC   BASGROUP(8,@04),BLANK8                              1421 05327000
         BE    @RF01421                                            1421 05328000
*             DO;                   /*                       @Y30LB26*/ 05329000
*               RPLVRETC=FOUR;      /* BAD RC                @Y30LB26*/ 05330000
         L     @02,RPLVPTR                                         1423 05331000
         MVC   RPLVRETC(2,@02),@CB00749                            1423 05332000
*               RPLRCODE=BADCHAIN;  /* BROKEN CHAIN          @Y30LB26*/ 05333000
         MVC   RPLRCODE(2,@02),@CB00821                            1424 05334000
*               CALL ERREXIT;       /* SAVE REASON CODES     @Y30LB26*/ 05335000
         BAL   @14,ERREXIT                                         1425 05336000
*               RETURN;             /*                       @Y30LB26*/ 05337000
         B     @EL00019                                            1426 05338000
*             END;                  /*                       @Y30LB26*/ 05339000
*         END;                      /*                       @Y30LB26*/ 05340000
*                                                                  1428 05341000
@RF01421 DS    0H                                                  1429 05342000
*     /***************************************************************/ 05343000
*     /*                                                             */ 05344000
*     /* GO MAKE ANY TEST REQUIRED ON BASE RECORD            @Y30LB26*/ 05345000
*     /*                                                             */ 05346000
*     /***************************************************************/ 05347000
*                                                                  1429 05348000
*     CALL TEST;                    /* TEST RECORD           @Y30LB26*/ 05349000
@RF01419 DS    0H                                                  1429 05350000
@RC01409 BAL   @14,TEST                                            1429 05351000
*     IF RPLVRETC¬=RCZERO THEN      /* CHECK RC              @Y30LB26*/ 05352000
         L     @04,RPLVPTR                                         1430 05353000
         CLC   RPLVRETC(2,@04),@CB00747                            1430 05354000
         BE    @RF01430                                            1430 05355000
*       DO;                         /*                       @Y30LB26*/ 05356000
*                                                                  1431 05357000
*         /***********************************************************/ 05358000
*         /*                                                         */ 05359000
*         /* IF TEST NOT MET, INDICATE ATTEMPT MADE          @Y30LB26*/ 05360000
*         /*                                                         */ 05361000
*         /***********************************************************/ 05362000
*                                                                  1432 05363000
*         LOOPSW=ON;                /* INDICATE LOOPING      @Y30LB26*/ 05364000
*                                                                  1432 05365000
         OI    LOOPSW,B'10000000'                                  1432 05366000
*         /***********************************************************/ 05367000
*         /*                                                         */ 05368000
*         /* IF AT END OF CHAIN, SET REASON CODE FOR         @Y30LB26*/ 05369000
*         /* TEST NOT MET AND RETURN                         @Y30LB26*/ 05370000
*         /*                                                         */ 05371000
*         /***********************************************************/ 05372000
*                                                                  1433 05373000
*         IF BASLAST=ON THEN        /* LAST IN CHAIN?        @Y30LB26*/ 05374000
         L     @02,BASEVPTR                                        1433 05375000
         TM    BASLAST(@02),B'00001000'                            1433 05376000
         BNO   @RF01433                                            1433 05377000
*           DO;                     /*                       @Y30LB26*/ 05378000
*             RPLRCODE=TNOTMET;     /* TEST NOT MET          @Y30LB26*/ 05379000
         MVC   RPLRCODE(2,@04),@CB00819                            1435 05380000
*             RPLVRETC=FOUR;        /* BAD RC                @Y30LB26*/ 05381000
         MVC   RPLVRETC(2,@04),@CB00749                            1436 05382000
*             CALL ERREXIT;         /* SAVE REASON CODES     @Y30LB26*/ 05383000
         BAL   @14,ERREXIT                                         1437 05384000
*             RETURN;               /*                       @Y30LB26*/ 05385000
         B     @EL00019                                            1438 05386000
*           END;                    /*                       @Y30LB26*/ 05387000
*         ELSE                      /*                       @Y30LB26*/ 05388000
*                                                                  1440 05389000
*           /*********************************************************/ 05390000
*           /*                                                       */ 05391000
*           /* END OF CHAIN NOT REACHED, SO SET KEY          @Y30LB26*/ 05392000
*           /* TO GET NEXT BASE VOL REC                      @Y30LB26*/ 05393000
*           /*                                                       */ 05394000
*           /*********************************************************/ 05395000
*                                                                  1440 05396000
*           VOLKY=BASNEXTV;         /* SET READ NEXT IN CHN  @Y30LB26*/ 05397000
@RF01433 L     @04,BASEVPTR                                        1440 05398000
         MVC   VOLKY(6),BASNEXTV(@04)                              1440 05399000
*       END;                        /*                       @Y30LB26*/ 05400000
*     ELSE                          /*                       @Y30LB26*/ 05401000
*                                                                  1442 05402000
*       /*************************************************************/ 05403000
*       /*                                                           */ 05404000
*       /* IF TEST MET, GET BUFFER AND RETURN RECORD         @Y30LB26*/ 05405000
*       /*                                                           */ 05406000
*       /*************************************************************/ 05407000
*                                                                  1442 05408000
*       DO;                         /*                       @Y30LB26*/ 05409000
         B     @RC01430                                            1442 05410000
@RF01430 DS    0H                                                  1443 05411000
*         CALL GETBUF;              /* GET CORE              @Y30LB26*/ 05412000
         BAL   @14,GETBUF                                          1443 05413000
*         IF RPLVRETC¬=RCZERO THEN  /* CK RETURN             @Y30LB26*/ 05414000
         L     @04,RPLVPTR                                         1444 05415000
         CLC   RPLVRETC(2,@04),@CB00747                            1444 05416000
         BNE   @RT01444                                            1444 05417000
*           RETURN;                 /*                       @Y30LB26*/ 05418000
*         BUFFER=BASEV;             /* MOVE IN GOOD REC      @Y30LB26*/ 05419000
         L     @02,RVVAREA(,RVVIPTR)                               1446 05420000
         MVI   BUFFER+224(@02),C' '                                1446 05421000
         MVC   BUFFER+225(31,@02),BUFFER+224(@02)                  1446 05422000
         L     @01,BASEVPTR                                        1446 05423000
         MVC   BUFFER(224,@02),BASEV(@01)                          1446 05424000
*         RPLVRETC=RCZERO;          /* GOOD RC               @Y30LB26*/ 05425000
         MVC   RPLVRETC(2,@04),@CB00747                            1447 05426000
*         RPLRCODE=RCZERO;          /* GOOD REASON CODE      @Y30LB26*/ 05427000
         MVC   RPLRCODE(2,@04),@CB00747                            1448 05428000
*         RETURN;                   /*                       @Y30LB26*/ 05429000
         B     @EL00019                                            1449 05430000
*       END;                        /*                       @Y30LB26*/ 05431000
*   END;                            /*                       @Y30LB26*/ 05432000
@RC01430 DS    0H                                                  1451 05433000
@DE01394 CLC   I(1),I                                              1451 05434000
         BE    @DL01394                                            1451 05435000
*   END BASECHN;                    /*                       @Y30LB26*/ 05436000
         B     @EL00019                                            1452 05437000
*                                                                  1453 05438000
*   /*****************************************************************/ 05439000
*   /*                                                               */ 05440000
*   /* ROUTINE GETS THE FIRST BASE VOLUME RECORD IN          @Y30LB26*/ 05441000
*   /* THE NON-GROUPED CATAGORY                              @Y30LB26*/ 05442000
*   /*                                                               */ 05443000
*   /*****************************************************************/ 05444000
*                                                                  1453 05445000
*FSTNGBAS:                                                         1453 05446000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 05447000
*                                                                  1453 05448000
FSTNGBAS ST    @14,@SA00020                                        1453 05449000
*   /*****************************************************************/ 05450000
*   /*                                                               */ 05451000
*   /* SET UP TO READ THE NON-GROUPED VOL HEADER REC         @Y30LB26*/ 05452000
*   /*                                                               */ 05453000
*   /*****************************************************************/ 05454000
*                                                                  1454 05455000
*   RPLVKEY=ADDR(NGHEADER);         /* ADDR NON HEADER KEY   @Y30LB26*/ 05456000
         L     @04,RPLVPTR                                         1454 05457000
         LA    @02,NGHEADER                                        1454 05458000
         ST    @02,RPLVKEY(,@04)                                   1454 05459000
*   RPLVLOC=ON;                     /* LOCATE ONLY           @Y30LB26*/ 05460000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 05461000
         OI    RPLVLOC(@04),B'11000000'                            1456 05462000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 05463000
         MVI   RPLVTYP(@04),X'00'                                  1457 05464000
*   RPLVUPD=OFF;                    /* READ ONLY ACCESS      @Y30LB26*/ 05465000
         NI    RPLVUPD(@04),B'11111101'                            1458 05466000
*   RESPECIFY                                                      1459 05467000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 05468000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 05469000
         LR    REG1,@04                                            1460 05470000
*   CALL ICBVIO00;                  /* READ NON-GRP HEAD     @Y30LB26*/ 05471000
         L     @15,@CV00671                                        1461 05472000
         BALR  @14,@15                                             1461 05473000
*   RESPECIFY                                                      1462 05474000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 05475000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN CODE        @Y30LB26*/ 05476000
         L     @04,RPLVPTR                                         1463 05477000
         CLC   RPLVRETC(2,@04),@CB00747                            1463 05478000
         BE    @RF01463                                            1463 05479000
*     DO;                           /*                       @Y30LB26*/ 05480000
*       CALL ERREXIT;               /* RELEASE INVEN         @Y30LB26*/ 05481000
         BAL   @14,ERREXIT                                         1465 05482000
*       RETURN;                     /*                       @Y30LB26*/ 05483000
@EL00020 DS    0H                                                  1466 05484000
@EF00020 DS    0H                                                  1466 05485000
@ER00020 L     @14,@SA00020                                        1466 05486000
         BR    @14                                                 1466 05487000
*     END;                          /*                       @Y30LB26*/ 05488000
*                                                                  1467 05489000
*   /*****************************************************************/ 05490000
*   /*                                                               */ 05491000
*   /* GET ADDRESSING TO RECORD JUST READ                    @Y30LB26*/ 05492000
*   /*                                                               */ 05493000
*   /*****************************************************************/ 05494000
*                                                                  1468 05495000
*   NGVRPTR=RPLVBUF;                /* ADDR RECORD           @Y30LB26*/ 05496000
*                                                                  1468 05497000
@RF01463 L     @02,RPLVPTR                                         1468 05498000
         L     NGVRPTR,RPLVBUF(,@02)                               1468 05499000
*   /*****************************************************************/ 05500000
*   /*                                                               */ 05501000
*   /* BE SURE THERE IS AT LEAST ONE NON-GROUPED BASE        @Y30LB26*/ 05502000
*   /*                                                               */ 05503000
*   /*****************************************************************/ 05504000
*                                                                  1469 05505000
*   IF NGVNOVOL=ZERO THEN           /* ANY VOLUMES ?         @Y30LB26*/ 05506000
         LH    @15,NGVNOVOL(,NGVRPTR)                              1469 05507000
         LTR   @15,@15                                             1469 05508000
         BNZ   @RF01469                                            1469 05509000
*     DO;                           /*                       @Y30LB26*/ 05510000
*       RPLVRETC=FOUR;              /* BAD RET CODE          @Y30LB26*/ 05511000
         MVC   RPLVRETC(2,@02),@CB00749                            1471 05512000
*       RPLRCODE=NORECRC;           /* RECORD NOT FOUND      @Y30LB26*/ 05513000
         MVC   RPLRCODE(2,@02),@CB00789                            1472 05514000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 05515000
         BAL   @14,ERREXIT                                         1473 05516000
*       RETURN;                     /*                       @Y30LB26*/ 05517000
         B     @EL00020                                            1474 05518000
*     END;                          /*                       @Y30LB26*/ 05519000
*   VOLKY=NGVFVOL;                  /* VOL NAME TO KEY       @Y30LB26*/ 05520000
*                                                                  1476 05521000
@RF01469 MVC   VOLKY(6),NGVFVOL(NGVRPTR)                           1476 05522000
*   /*****************************************************************/ 05523000
*   /*                                                               */ 05524000
*   /* SET UP TO READ THE FIRST NON-GROUPED BASE VOLUME      @Y30LB26*/ 05525000
*   /*                                                               */ 05526000
*   /*****************************************************************/ 05527000
*                                                                  1477 05528000
*   RPLVKEY=ADDR(VKEY);             /* ADDR KEY              @Y30LB26*/ 05529000
         L     @04,RPLVPTR                                         1477 05530000
         LA    @02,VKEY                                            1477 05531000
         ST    @02,RPLVKEY(,@04)                                   1477 05532000
*   RPLVLOC=ON;                     /* NOT LOCATE            @Y30LB26*/ 05533000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 05534000
         OI    RPLVLOC(@04),B'11000000'                            1479 05535000
*   RPLVTYP=RPLVREAD;               /* READ BASE VOLUME      @Y30LB26*/ 05536000
         MVI   RPLVTYP(@04),X'00'                                  1480 05537000
*   RPLVUPD=OFF;                    /* NOT FOR UPDATE        @Y30LB26*/ 05538000
         NI    RPLVUPD(@04),B'11111101'                            1481 05539000
*   RESPECIFY                                                      1482 05540000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 05541000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 05542000
         LR    REG1,@04                                            1483 05543000
*   CALL ICBVIO00;                  /* READ BASE VOL REC     @Y30LB26*/ 05544000
         L     @15,@CV00671                                        1484 05545000
         BALR  @14,@15                                             1484 05546000
*   RESPECIFY                                                      1485 05547000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 05548000
*                                                                  1485 05549000
*   /*****************************************************************/ 05550000
*   /*                                                               */ 05551000
*   /* CHECK ON RETURN FROM I/O                              @Y30LB26*/ 05552000
*   /*                                                               */ 05553000
*   /*****************************************************************/ 05554000
*                                                                  1486 05555000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN CODE        @Y30LB26*/ 05556000
         L     @04,RPLVPTR                                         1486 05557000
         CLC   RPLVRETC(2,@04),@CB00747                            1486 05558000
         BE    @RF01486                                            1486 05559000
*     DO;                           /*                       @Y30LB26*/ 05560000
*       CALL ERREXIT;               /* RELEASE INVEN         @Y30LB26*/ 05561000
         BAL   @14,ERREXIT                                         1488 05562000
*       RETURN;                     /*                       @Y30LB26*/ 05563000
         B     @EL00020                                            1489 05564000
*     END;                          /*                       @Y30LB26*/ 05565000
*                                                                  1490 05566000
*   /*****************************************************************/ 05567000
*   /*                                                               */ 05568000
*   /* GET ADDR OF BASE RECORD AND CALL TEST TO SEE IF       @Y30LB26*/ 05569000
*   /* RECORD CAN MEET TESTS. IF IT CAN RETURN IT            @Y30LB26*/ 05570000
*   /*                                                               */ 05571000
*   /*****************************************************************/ 05572000
*                                                                  1491 05573000
*   BASEVPTR=RPLVBUF;               /* ADDR REC JUST READ    @Y30LB26*/ 05574000
@RF01486 L     @04,RPLVPTR                                         1491 05575000
         L     @04,RPLVBUF(,@04)                                   1491 05576000
         ST    @04,BASEVPTR                                        1491 05577000
*   CALL TEST;                      /* SEE IF BASE REC MEETS @Y30LB26*/ 05578000
         BAL   @14,TEST                                            1492 05579000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 05580000
*                                                                  1493 05581000
         L     @04,RPLVPTR                                         1493 05582000
         CLC   RPLVRETC(2,@04),@CB00747                            1493 05583000
         BNE   @RT01493                                            1493 05584000
*     /***************************************************************/ 05585000
*     /*                                                             */ 05586000
*     /* IF RECORD DID NOT MEET TEST,                        @Y30LB26*/ 05587000
*     /* RETURN TO BASE CHAIN PROCEDURE WHICH WILL CONTINUE  @Y30LB26*/ 05588000
*     /* UNTIL A RECORD IS FOUND THAT MEETS TEST             @Y30LB26*/ 05589000
*     /*                                                             */ 05590000
*     /***************************************************************/ 05591000
*                                                                  1494 05592000
*     RETURN;                       /* RETURN TO CALLER      @ZM31062*/ 05593000
*   ELSE                            /*                       #Y30LB26*/ 05594000
*                                                                  1495 05595000
*     /***************************************************************/ 05596000
*     /*                                                             */ 05597000
*     /* IF TEST MET, GET BUFFER AND RETURN RECORD           #Y30LB26*/ 05598000
*     /*                                                             */ 05599000
*     /***************************************************************/ 05600000
*                                                                  1495 05601000
*     DO;                           /*                       @Y30LB26*/ 05602000
*       CALL GETBUF;                /* GET CORE              #Y30LB26*/ 05603000
         BAL   @14,GETBUF                                          1496 05604000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN CODE        #Y30LB26*/ 05605000
         L     @04,RPLVPTR                                         1497 05606000
         CLC   RPLVRETC(2,@04),@CB00747                            1497 05607000
         BNE   @RT01497                                            1497 05608000
*         RETURN;                   /* RETURN TO CALLER      #Y30LB26*/ 05609000
*       BUFFER=BASEV;               /* MOVE IN GOOD REC      #Y30LB26*/ 05610000
         L     @02,RVVAREA(,RVVIPTR)                               1499 05611000
         MVI   BUFFER+224(@02),C' '                                1499 05612000
         MVC   BUFFER+225(31,@02),BUFFER+224(@02)                  1499 05613000
         L     @01,BASEVPTR                                        1499 05614000
         MVC   BUFFER(224,@02),BASEV(@01)                          1499 05615000
*       RPLVRETC=RCZERO;            /* GOOD RC               #Y30LB26*/ 05616000
         MVC   RPLVRETC(2,@04),@CB00747                            1500 05617000
*       RPLRCODE=RCZERO;            /* GOOD REASON CODE      #Y30LB26*/ 05618000
         MVC   RPLRCODE(2,@04),@CB00747                            1501 05619000
*     END;                          /*                       #Y30LB26*/ 05620000
*   RETURN;                         /*                       #Y30LB26*/ 05621000
         B     @EL00020                                            1503 05622000
*   END FSTNGBAS;                   /*                       #Y30LB26*/ 05623000
         B     @EL00020                                            1504 05624000
*                                                                  1505 05625000
*   /*****************************************************************/ 05626000
*   /*                                                               */ 05627000
*   /* ROUTINE READS DIRECT FOR GROUP RECORD                 #Y30LB26*/ 05628000
*   /*                                                               */ 05629000
*   /*****************************************************************/ 05630000
*                                                                  1505 05631000
*GRPDIR:                            /*                       #Y30LB26*/ 05632000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 05633000
*                                                                  1505 05634000
GRPDIR   ST    @14,@SA00021                                        1505 05635000
*   /*****************************************************************/ 05636000
*   /*                                                               */ 05637000
*   /* GO RESERVE INVENTORY DATA SET SHARED                  #Y30LB26*/ 05638000
*   /*                                                               */ 05639000
*   /*****************************************************************/ 05640000
*                                                                  1506 05641000
*   CALL RESSHARE;                  /* RESERVE INVENTORY SHR #Y30LB26*/ 05642000
*                                                                  1506 05643000
         BAL   @14,RESSHARE                                        1506 05644000
*   /*****************************************************************/ 05645000
*   /*                                                               */ 05646000
*   /* SET UP TO READ DIRECT GROUP RECORD                    #Y30LB26*/ 05647000
*   /*                                                               */ 05648000
*   /*****************************************************************/ 05649000
*                                                                  1507 05650000
*   GROUPKY=RVVGROUP;               /* GROUP NAME            #Y30LB26*/ 05651000
         MVC   GROUPKY(8),RVVGROUP(RVVIPTR)                        1507 05652000
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY              #Y30LB26*/ 05653000
         L     @04,RPLVPTR                                         1508 05654000
         LA    @02,GKEY                                            1508 05655000
         ST    @02,RPLVKEY(,@04)                                   1508 05656000
*   RPLVLOC=ON;                     /* LOCATE MODE           #Y30LB26*/ 05657000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 05658000
         OI    RPLVLOC(@04),B'11000000'                            1510 05659000
*   RPLVTYP=RPLVREAD;               /* DO A READ             @Y30LB26*/ 05660000
         MVI   RPLVTYP(@04),X'00'                                  1511 05661000
*   RESPECIFY                                                      1512 05662000
*     REG1 RSTD;                    /* RESTRICT REG1         @Y30LB26*/ 05663000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 05664000
         LR    REG1,@04                                            1513 05665000
*   CALL ICBVIO00;                  /* READ GROUP RECORD     @Y30LB26*/ 05666000
         L     @15,@CV00671                                        1514 05667000
         BALR  @14,@15                                             1514 05668000
*   RESPECIFY                                                      1515 05669000
*     REG1 UNRSTD;                  /* UNRESTRICT REG1       @Y30LB26*/ 05670000
*                                                                  1515 05671000
*   /*****************************************************************/ 05672000
*   /*                                                               */ 05673000
*   /* CHECK REASON CODE                                     @Y30LB26*/ 05674000
*   /*                                                               */ 05675000
*   /*****************************************************************/ 05676000
*                                                                  1516 05677000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RC              @Y30LB26*/ 05678000
         L     @04,RPLVPTR                                         1516 05679000
         CLC   RPLVRETC(2,@04),@CB00747                            1516 05680000
         BE    @RF01516                                            1516 05681000
*     DO;                           /*                       @Y30LB26*/ 05682000
*       CALL ERREXIT;               /* SAVE REASPM CPDES     @Y30LB26*/ 05683000
         BAL   @14,ERREXIT                                         1518 05684000
*       RETURN;                     /*                       @Y30LB26*/ 05685000
@EL00021 DS    0H                                                  1519 05686000
@EF00021 DS    0H                                                  1519 05687000
@ER00021 L     @14,@SA00021                                        1519 05688000
         BR    @14                                                 1519 05689000
*     END;                          /*                       @Y30LB26*/ 05690000
*                                                                  1520 05691000
*   /*****************************************************************/ 05692000
*   /*                                                               */ 05693000
*   /* IF NO ERROR, SET UP ADDRESSING                        @Y30LB26*/ 05694000
*   /*                                                               */ 05695000
*   /*****************************************************************/ 05696000
*                                                                  1521 05697000
*   GROUPPTR=RPLVBUF;               /* ADDR RECORD READ      @Y30LB26*/ 05698000
*                                                                  1521 05699000
@RF01516 L     @04,RPLVPTR                                         1521 05700000
         L     @04,RPLVBUF(,@04)                                   1521 05701000
         ST    @04,GROUPPTR                                        1521 05702000
*   /*****************************************************************/ 05703000
*   /*                                                               */ 05704000
*   /* IF THRESHOLD CHECKING IS REQUIRED, DO IT              @Y30LB26*/ 05705000
*   /*                                                               */ 05706000
*   /*****************************************************************/ 05707000
*                                                                  1522 05708000
*   IF RVVTHOLD=ON THEN             /* THRESHOLD CHECKING?   @Y30LB26*/ 05709000
         TM    RVVTHOLD(RVVIPTR),B'01000000'                       1522 05710000
         BNO   @RF01522                                            1522 05711000
*     DO;                           /*                       @Y30LB26*/ 05712000
*                                                                  1523 05713000
*       /*************************************************************/ 05714000
*       /*                                                           */ 05715000
*       /* IF THRESHOLD HAS BEEN PASSED, GET BUFFER          @Y30LB26*/ 05716000
*       /* AND RETURN RECORD                                 @Y30LB26*/ 05717000
*       /*                                                           */ 05718000
*       /*************************************************************/ 05719000
*                                                                  1524 05720000
*       IF GROFRESP<=GROSTRSH THEN  /* PAST THRESHOLD?       @Y30LB26*/ 05721000
         L     @02,GROFRESP(,@04)                                  1524 05722000
         C     @02,GROSTRSH(,@04)                                  1524 05723000
         BH    @RF01524                                            1524 05724000
*         DO;                       /*                       @Y30LB26*/ 05725000
*           CALL GETBUF;            /* GET CORE              @Y30LB26*/ 05726000
         BAL   @14,GETBUF                                          1526 05727000
*           IF RPLVRETC¬=RCZERO THEN/* CK RETURN             @Y30LB26*/ 05728000
         L     @04,RPLVPTR                                         1527 05729000
         CLC   RPLVRETC(2,@04),@CB00747                            1527 05730000
         BNE   @RT01527                                            1527 05731000
*             RETURN;               /*                       @Y30LB26*/ 05732000
*           BUFFER=GROUP;           /* MOVE IN RECORD        @Y30LB26*/ 05733000
         L     @02,RVVAREA(,RVVIPTR)                               1529 05734000
         MVI   BUFFER+164(@02),C' '                                1529 05735000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1529 05736000
         L     @01,GROUPPTR                                        1529 05737000
         MVC   BUFFER(164,@02),GROUP(@01)                          1529 05738000
*           RPLVRETC=RCZERO;        /* GOOD RC               @Y30LB26*/ 05739000
         MVC   RPLVRETC(2,@04),@CB00747                            1530 05740000
*           RPLRCODE=RCZERO;        /* GOOD REASON CODE      @Y30LB26*/ 05741000
         MVC   RPLRCODE(2,@04),@CB00747                            1531 05742000
*           RETURN;                 /*                       @Y30LB26*/ 05743000
         B     @EL00021                                            1532 05744000
*         END;                      /*                       @Y30LB26*/ 05745000
*       ELSE                        /*                       @Y30LB26*/ 05746000
*                                                                  1534 05747000
*         /***********************************************************/ 05748000
*         /*                                                         */ 05749000
*         /* TEST NOT MET SO GIVE BAD RET CODE AND RETURN    @Y30LB26*/ 05750000
*         /*                                                         */ 05751000
*         /***********************************************************/ 05752000
*                                                                  1534 05753000
*         DO;                       /*                       @Y30LB26*/ 05754000
@RF01524 DS    0H                                                  1535 05755000
*           RPLVRETC=FOUR;          /* BAD RC                @Y30LB26*/ 05756000
         L     @02,RPLVPTR                                         1535 05757000
         MVC   RPLVRETC(2,@02),@CB00749                            1535 05758000
*           RPLRCODE=TNOTMET;       /* TEST NOT MET          @Y30LB26*/ 05759000
         MVC   RPLRCODE(2,@02),@CB00819                            1536 05760000
*           CALL ERREXIT;           /* SAVE REASON CODES     @Y30LB26*/ 05761000
         BAL   @14,ERREXIT                                         1537 05762000
*           RETURN;                 /*                       @Y30LB26*/ 05763000
         B     @EL00021                                            1538 05764000
*         END;                      /*                       @Y30LB26*/ 05765000
*     END;                          /*                       @Y30LB26*/ 05766000
*                                                                  1540 05767000
*   /*****************************************************************/ 05768000
*   /*                                                               */ 05769000
*   /* TEST WAS NOT MADE, SO JUST RETURN RECORD              @Y30LB26*/ 05770000
*   /*                                                               */ 05771000
*   /*****************************************************************/ 05772000
*                                                                  1541 05773000
*   CALL GETBUF;                    /* GET CORE              @Y30LB26*/ 05774000
@RF01522 BAL   @14,GETBUF                                          1541 05775000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 05776000
         L     @04,RPLVPTR                                         1542 05777000
         CLC   RPLVRETC(2,@04),@CB00747                            1542 05778000
         BNE   @RT01542                                            1542 05779000
*     RETURN;                       /*                       @Y30LB26*/ 05780000
*   BUFFER=GROUP;                   /* MOVE IN RECORD        @Y30LB26*/ 05781000
         L     @02,RVVAREA(,RVVIPTR)                               1544 05782000
         MVI   BUFFER+164(@02),C' '                                1544 05783000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1544 05784000
         L     @01,GROUPPTR                                        1544 05785000
         MVC   BUFFER(164,@02),GROUP(@01)                          1544 05786000
*   RPLVRETC=RCZERO;                /* GOOD RC               @Y30LB26*/ 05787000
         MVC   RPLVRETC(2,@04),@CB00747                            1545 05788000
*   RPLRCODE=RCZERO;                /* GOOD REASON CODE      @Y30LB26*/ 05789000
         MVC   RPLRCODE(2,@04),@CB00747                            1546 05790000
*   RETURN;                         /*                       @Y30LB26*/ 05791000
         B     @EL00021                                            1547 05792000
*   END GRPDIR;                     /*                       @Y30LB26*/ 05793000
         B     @EL00021                                            1548 05794000
*                                                                  1549 05795000
*   /*****************************************************************/ 05796000
*   /*                                                               */ 05797000
*   /* PROCEDURE READS NEXT FOR GROUP RECORD                 @Y30LB26*/ 05798000
*   /*                                                               */ 05799000
*   /*****************************************************************/ 05800000
*                                                                  1549 05801000
*GRPNREC:                           /*                       @Y30LB26*/ 05802000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 05803000
*                                                                  1549 05804000
GRPNREC  ST    @14,@SA00022                                        1549 05805000
*   /*****************************************************************/ 05806000
*   /*                                                               */ 05807000
*   /* GO RESERVE INVENTORY DATA SET SHARED                  @Y30LB26*/ 05808000
*   /*                                                               */ 05809000
*   /*****************************************************************/ 05810000
*                                                                  1550 05811000
*   CALL RESSHARE;                  /* RESERVE INVENTORY SHR @Y30LB26*/ 05812000
*                                                                  1550 05813000
         BAL   @14,RESSHARE                                        1550 05814000
*   /*****************************************************************/ 05815000
*   /*                                                               */ 05816000
*   /* CHECK ON STATUS OF GROUP NAME. IF GIVEN USE IT        @Y30LB26*/ 05817000
*   /* OTHERWISE, READ FIRST GROUP RECORD                    @Y30LB26*/ 05818000
*   /*                                                               */ 05819000
*   /*****************************************************************/ 05820000
*                                                                  1551 05821000
*   IF RVVSGRP=OFF THEN             /* WAS GROUP NAME SPEC   @Y30LB26*/ 05822000
         TM    RVVSGRP(RVVIPTR),B'10000000'                        1551 05823000
         BNZ   @RF01551                                            1551 05824000
*     GROUPKY=ZEROCHAR;             /* SET READ FIRST GROUP  @Y30LB26*/ 05825000
         MVC   GROUPKY(8),ZEROCHAR                                 1552 05826000
*   ELSE                            /*                       @Y30LB26*/ 05827000
*     GROUPKY=RVVGROUP;             /* GROUP NAME            @Y30LB26*/ 05828000
         B     @RC01551                                            1553 05829000
@RF01551 MVC   GROUPKY(8),RVVGROUP(RVVIPTR)                        1553 05830000
*   DO WHILE I=I;                   /* BIG LOOP              @Y30LB26*/ 05831000
*                                                                  1554 05832000
@RC01551 B     @DE01554                                            1554 05833000
@DL01554 DS    0H                                                  1555 05834000
*     /***************************************************************/ 05835000
*     /*                                                             */ 05836000
*     /* SET UP TO READ NEXT GROUP RECORD                    @Y30LB26*/ 05837000
*     /*                                                             */ 05838000
*     /***************************************************************/ 05839000
*                                                                  1555 05840000
*     ARITHGRP=GKEY(12:13);         /* MOVE EXISTING ID      @Y30LB26*/ 05841000
         MVC   ARITHGRP(2),GKEY+11                                 1555 05842000
*     GRPID=GRPID+256;              /* ADD TO GET NEXT GRP   @Y30LB26*/ 05843000
         LA    @04,256                                             1556 05844000
         LH    @02,GRPID                                           1556 05845000
         N     @02,@CF01186                                        1556 05846000
         ALR   @04,@02                                             1556 05847000
         STH   @04,GRPID                                           1556 05848000
*     GKEY(12:13)=ARITHGRP;         /* PUT NEW VALUE BACK    @Y30LB26*/ 05849000
         MVC   GKEY+11(2),ARITHGRP                                 1557 05850000
*     RPLVKEY=ADDR(GKEY);           /* ADDR OF KEY           @Y30LB26*/ 05851000
         L     @04,RPLVPTR                                         1558 05852000
         LA    @02,GKEY                                            1558 05853000
         ST    @02,RPLVKEY(,@04)                                   1558 05854000
*     RPLVLOC=ON;                   /* LOCATE MODE           @Y30LB26*/ 05855000
*     RPLVDIR=ON;                   /* DIRECT READ           @Y30LB26*/ 05856000
         OI    RPLVLOC(@04),B'11000000'                            1560 05857000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           @Y30LB26*/ 05858000
         MVI   RPLVTYP(@04),X'00'                                  1561 05859000
*     RPLVKGE=ON;                   /* READ >=               @Y30LB26*/ 05860000
         OI    RPLVKGE(@04),B'00000100'                            1562 05861000
*     RESPECIFY                                                    1563 05862000
*       REG1 RSTD;                  /* RESTRICT REG1         @Y30LB26*/ 05863000
*     REG1=RPLVPTR;                 /* ADDR OF RPLV          @Y30LB26*/ 05864000
         LR    REG1,@04                                            1564 05865000
*     CALL ICBVIO00;                /* READ NEXT GROUP       @Y30LB26*/ 05866000
         L     @15,@CV00671                                        1565 05867000
         BALR  @14,@15                                             1565 05868000
*     RESPECIFY                                                    1566 05869000
*       REG1 UNRSTD;                /* UNRESTRICT REG1       @Y30LB26*/ 05870000
*                                                                  1566 05871000
*     /***************************************************************/ 05872000
*     /*                                                             */ 05873000
*     /* CHECK RETURN CODE FROM I/O PROCESSOR                @Y30LB26*/ 05874000
*     /*                                                             */ 05875000
*     /***************************************************************/ 05876000
*                                                                  1567 05877000
*     IF RPLVRETC¬=RCZERO THEN      /* CHECK RC              @Y30LB26*/ 05878000
         L     @04,RPLVPTR                                         1567 05879000
         CLC   RPLVRETC(2,@04),@CB00747                            1567 05880000
         BE    @RF01567                                            1567 05881000
*       DO;                         /*                       @Y30LB26*/ 05882000
*         CALL ERREXIT;             /* SAVE REASON CODES     @Y30LB26*/ 05883000
         BAL   @14,ERREXIT                                         1569 05884000
*         RETURN;                   /*                       @Y30LB26*/ 05885000
@EL00022 DS    0H                                                  1570 05886000
@EF00022 DS    0H                                                  1570 05887000
@ER00022 L     @14,@SA00022                                        1570 05888000
         BR    @14                                                 1570 05889000
*       END;                        /*                       @Y30LB26*/ 05890000
*                                                                  1571 05891000
*     /***************************************************************/ 05892000
*     /*                                                             */ 05893000
*     /* IF NO ERROR OCCURED, SET ADDRESSING TO RECORD       @Y30LB26*/ 05894000
*     /*                                                             */ 05895000
*     /***************************************************************/ 05896000
*                                                                  1572 05897000
*     GROUPPTR=RPLVBUF;             /* ADDR RECORD READ      @Y30LB26*/ 05898000
*                                                                  1572 05899000
@RF01567 L     @04,RPLVPTR                                         1572 05900000
         L     @04,RPLVBUF(,@04)                                   1572 05901000
         ST    @04,GROUPPTR                                        1572 05902000
*     /***************************************************************/ 05903000
*     /*                                                             */ 05904000
*     /* TEST TO SEE IF STILL A GROUP RECORD                 @Y30LB26*/ 05905000
*     /*                                                             */ 05906000
*     /***************************************************************/ 05907000
*                                                                  1573 05908000
*     IF GROG=GKY&                  /*                       @Y30LB26*/ 05909000
*         GROZERO=FIXZERO THEN      /* TEST IS GROUP REC     @Y30LB26*/ 05910000
*                                                                  1573 05911000
         CLC   GROG(3,@04),GKY                                     1573 05912000
         BNE   @RF01573                                            1573 05913000
         CLI   GROZERO(@04),0                                      1573 05914000
         BNE   @RF01573                                            1573 05915000
*       /*************************************************************/ 05916000
*       /*                                                           */ 05917000
*       /* IF THRESHOLD CHECKING CALLED FOR, DO IT           @Y30LB26*/ 05918000
*       /*                                                           */ 05919000
*       /*************************************************************/ 05920000
*                                                                  1574 05921000
*       DO;                         /*                       @Y30LB26*/ 05922000
*         IF RVVTHOLD=ON THEN       /* THRESHOLD CHECK?      @Y30LB26*/ 05923000
         TM    RVVTHOLD(RVVIPTR),B'01000000'                       1575 05924000
         BNO   @RF01575                                            1575 05925000
*           DO;                     /*                       @Y30LB26*/ 05926000
*             IF GROFRESP<=GROSTRSH THEN/* PAST THRESHOLD?   @Y30LB26*/ 05927000
*                                                                  1577 05928000
         L     @02,GROFRESP(,@04)                                  1577 05929000
         C     @02,GROSTRSH(,@04)                                  1577 05930000
         BH    @RF01577                                            1577 05931000
*               /*****************************************************/ 05932000
*               /*                                                   */ 05933000
*               /* IF GROUP PAST THRESHOLD, GET BUFFER       @Y30LB26*/ 05934000
*               /* AND RETURN RECORD                         @Y30LB26*/ 05935000
*               /*                                                   */ 05936000
*               /*****************************************************/ 05937000
*                                                                  1578 05938000
*               DO;                 /*                       @Y30LB26*/ 05939000
*                 CALL GETBUF;      /* GET BUFFER            @Y30LB26*/ 05940000
         BAL   @14,GETBUF                                          1579 05941000
*                 IF RPLVRETC¬=RCZERO THEN/* CK RETURN       @Y30LB26*/ 05942000
         L     @04,RPLVPTR                                         1580 05943000
         CLC   RPLVRETC(2,@04),@CB00747                            1580 05944000
         BNE   @RT01580                                            1580 05945000
*                   RETURN;         /*                       @Y30LB26*/ 05946000
*                 BUFFER=GROUP;     /* MOVE IN RECORD        @Y30LB26*/ 05947000
         L     @02,RVVAREA(,RVVIPTR)                               1582 05948000
         MVI   BUFFER+164(@02),C' '                                1582 05949000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1582 05950000
         L     @01,GROUPPTR                                        1582 05951000
         MVC   BUFFER(164,@02),GROUP(@01)                          1582 05952000
*                 RPLVRETC=RCZERO;  /* GOOD RC               @Y30LB26*/ 05953000
         MVC   RPLVRETC(2,@04),@CB00747                            1583 05954000
*                 RPLRCODE=RCZERO;  /* GOOD REASON CODE      @Y30LB26*/ 05955000
         MVC   RPLRCODE(2,@04),@CB00747                            1584 05956000
*                 RETURN;           /*                       @Y30LB26*/ 05957000
         B     @EL00022                                            1585 05958000
*               END;                /*                       @Y30LB26*/ 05959000
*             ELSE                  /*                       @Y30LB26*/ 05960000
*               DO;                 /*                       @Y30LB26*/ 05961000
@RF01577 DS    0H                                                  1588 05962000
*                 LOOPSW=ON;        /* INDICATE LOOPING      @Y30LB26*/ 05963000
         OI    LOOPSW,B'10000000'                                  1588 05964000
*                 GKEY=GRONAME;     /* SET KEY TO ADD 256    @Y30LB26*/ 05965000
         L     @04,GROUPPTR                                        1589 05966000
         MVC   GKEY(13),GRONAME(@04)                               1589 05967000
*               END;                /*                       @Y30LB26*/ 05968000
*           END;                    /*                       @Y30LB26*/ 05969000
*         ELSE                      /*                       @Y30LB26*/ 05970000
*                                                                  1592 05971000
*           /*********************************************************/ 05972000
*           /*                                                       */ 05973000
*           /* NO THRESHOLD CHECKING, SO JUST                @Y30LB26*/ 05974000
*           /* RETURN GROUP RECORD                           @Y30LB26*/ 05975000
*           /*                                                       */ 05976000
*           /*********************************************************/ 05977000
*                                                                  1592 05978000
*           DO;                     /*                       @Y30LB26*/ 05979000
         B     @RC01575                                            1592 05980000
@RF01575 DS    0H                                                  1593 05981000
*             CALL GETBUF;          /* GET BUFFER            @Y30LB26*/ 05982000
         BAL   @14,GETBUF                                          1593 05983000
*             IF RPLVRETC¬=RCZERO THEN/* CK RETURN           @Y30LB26*/ 05984000
         L     @04,RPLVPTR                                         1594 05985000
         CLC   RPLVRETC(2,@04),@CB00747                            1594 05986000
         BNE   @RT01594                                            1594 05987000
*               RETURN;             /*                       @Y30LB26*/ 05988000
*             BUFFER=GROUP;         /* MOVE IN RECORD        @Y30LB26*/ 05989000
         L     @02,RVVAREA(,RVVIPTR)                               1596 05990000
         MVI   BUFFER+164(@02),C' '                                1596 05991000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1596 05992000
         L     @01,GROUPPTR                                        1596 05993000
         MVC   BUFFER(164,@02),GROUP(@01)                          1596 05994000
*             RPLVRETC=RCZERO;      /* GOOD RETN CODE        @Y30LB26*/ 05995000
         MVC   RPLVRETC(2,@04),@CB00747                            1597 05996000
*             RPLRCODE=RCZERO;      /* GOOD REASON CODE      @Y30LB26*/ 05997000
         MVC   RPLRCODE(2,@04),@CB00747                            1598 05998000
*             RETURN;               /*                       @Y30LB26*/ 05999000
         B     @EL00022                                            1599 06000000
*           END;                    /*                       @Y30LB26*/ 06001000
*       END;                        /*                       @Y30LB26*/ 06002000
*     ELSE                          /*                       @Y30LB26*/ 06003000
*                                                                  1602 06004000
*       /*************************************************************/ 06005000
*       /*                                                           */ 06006000
*       /* NO LONGER A GROUP RECORD, SO CHECK TO SEE         @Y30LB26*/ 06007000
*       /* IF LOOPING HAS OCCURED                            @Y30LB26*/ 06008000
*       /*                                                           */ 06009000
*       /*************************************************************/ 06010000
*                                                                  1602 06011000
*       DO;                         /*                       @Y30LB26*/ 06012000
         B     @RC01573                                            1602 06013000
@RF01573 DS    0H                                                  1603 06014000
*         IF LOOPSW=ON THEN         /* CHECK LOOP CONTROL    @Y30LB26*/ 06015000
*                                                                  1603 06016000
         TM    LOOPSW,B'10000000'                                  1603 06017000
         BNO   @RF01603                                            1603 06018000
*           /*********************************************************/ 06019000
*           /*                                                       */ 06020000
*           /* IF LOOPING OCCURED, SET REASON CODE           @Y30LB26*/ 06021000
*           /* TO INDICATE TEST NOT MET                      @Y30LB26*/ 06022000
*           /*                                                       */ 06023000
*           /*********************************************************/ 06024000
*                                                                  1604 06025000
*           DO;                     /*                       @Y30LB26*/ 06026000
*             RPLRCODE=TNOTMET;     /* TEST NOT MEET         @Y30LB26*/ 06027000
         L     @02,RPLVPTR                                         1605 06028000
         MVC   RPLRCODE(2,@02),@CB00819                            1605 06029000
*             RPLVRETC=FOUR;        /* BAD RETURN CODE       @Y30LB26*/ 06030000
         MVC   RPLVRETC(2,@02),@CB00749                            1606 06031000
*             CALL ERREXIT;         /* SAVE REASON CODES     @Y30LB26*/ 06032000
         BAL   @14,ERREXIT                                         1607 06033000
*             RETURN;               /*                       @Y30LB26*/ 06034000
         B     @EL00022                                            1608 06035000
*           END;                    /*                       @Y30LB26*/ 06036000
*         ELSE                      /*                       @Y30LB26*/ 06037000
*                                                                  1610 06038000
*           /*********************************************************/ 06039000
*           /*                                                       */ 06040000
*           /* NO LOOPING OCCURED, SO SET REASON CODE        @Y30LB26*/ 06041000
*           /* INDICATING RECORD WAS NOT FOUND               @Y30LB26*/ 06042000
*           /*                                                       */ 06043000
*           /*********************************************************/ 06044000
*                                                                  1610 06045000
*           DO;                     /*                       @Y30LB26*/ 06046000
@RF01603 DS    0H                                                  1611 06047000
*             RPLVRETC=FOUR;        /* BAD RETURN CODE       @Y30LB26*/ 06048000
         L     @02,RPLVPTR                                         1611 06049000
         MVC   RPLVRETC(2,@02),@CB00749                            1611 06050000
*             RPLRCODE=NORECRC;     /* BAD REASON CODE       @Y30LB26*/ 06051000
         MVC   RPLRCODE(2,@02),@CB00789                            1612 06052000
*             CALL ERREXIT;         /* SAVE REASON CODES     @Y30LB26*/ 06053000
         BAL   @14,ERREXIT                                         1613 06054000
*             RETURN;               /*                       @Y30LB26*/ 06055000
         B     @EL00022                                            1614 06056000
*           END;                    /*                       @Y30LB26*/ 06057000
*       END;                        /*                       @Y30LB26*/ 06058000
*   END;                            /*                       @Y30LB26*/ 06059000
@RC01573 DS    0H                                                  1617 06060000
@DE01554 CLC   I(1),I                                              1617 06061000
         BE    @DL01554                                            1617 06062000
*   END GRPNREC;                    /*                       @Y30LB26*/ 06063000
         B     @EL00022                                            1618 06064000
*                                                                  1619 06065000
*   /*****************************************************************/ 06066000
*   /*                                                               */ 06067000
*   /* THIS PROCEDURE DETERMINES THE TYPE OF RECORD ASKED    @Y30LB26*/ 06068000
*   /* FOR ON A REQUEST TO READ A COPY DIRECT. THE TYPES     @Y30LB26*/ 06069000
*   /* OF RECORDS ASKED FOR ARE BY DATE AND SEQUENCE NUMBER  @Y30LB26*/ 06070000
*   /* LATEST COPY, LATEST BACKUP, OLDEST BACKUP             @Y30LB26*/ 06071000
*   /*                                                               */ 06072000
*   /*****************************************************************/ 06073000
*                                                                  1619 06074000
*COPYDIR:                                                          1619 06075000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 06076000
*                                                                  1619 06077000
COPYDIR  ST    @14,@SA00023                                        1619 06078000
*   /*****************************************************************/ 06079000
*   /*                                                               */ 06080000
*   /* IF DATE WAS SPECIFIED, GO FIND COPY WITH THAT DATE    @Y30LB26*/ 06081000
*   /*                                                               */ 06082000
*   /*****************************************************************/ 06083000
*                                                                  1620 06084000
*   IF RVVSDTE=ON THEN              /* DATE SPEC?            @Y30LB26*/ 06085000
         TM    RVVSDTE(RVVIPTR),B'00100000'                        1620 06086000
         BNO   @RF01620                                            1620 06087000
*     DO;                           /*                       @Y30LB26*/ 06088000
*       CALL CPYDATE;               /* GET CPY REC DATE      @Y30LB26*/ 06089000
         BAL   @14,CPYDATE                                         1622 06090000
*       RETURN;                     /*                       @Y30LB26*/ 06091000
@EL00023 DS    0H                                                  1623 06092000
@EF00023 DS    0H                                                  1623 06093000
@ER00023 L     @14,@SA00023                                        1623 06094000
         BR    @14                                                 1623 06095000
*     END;                          /*                       @Y30LB26*/ 06096000
*                                                                  1624 06097000
*   /*****************************************************************/ 06098000
*   /*                                                               */ 06099000
*   /* CHECK IF LATEST OR OLDEST BACKUP ARE WANTED           @Y30LB26*/ 06100000
*   /*                                                               */ 06101000
*   /*****************************************************************/ 06102000
*                                                                  1625 06103000
*   IF(RVVLBKUP=ON|RVVOBKUP=ON)&(RVVCPLHD=OFF&RVVALL=OFF)/*  @ZDR2053*/ 06104000
*     THEN                          /* WANT BACKUPS?         @ZDR2053*/ 06105000
@RF01620 TM    RVVLBKUP(RVVIPTR),B'11000000'                       1625 06106000
         BZ    @RF01625                                            1625 06107000
         TM    RVVCPLHD(RVVIPTR),B'00010000'                       1625 06108000
         BNZ   @RF01625                                            1625 06109000
         TM    RVVALL(RVVIPTR),B'00000001'                         1625 06110000
         BNZ   @RF01625                                            1625 06111000
*     DO;                           /*                       @Y30LB26*/ 06112000
*       CALL BACKUP;                /* GET BACKUP            @Y30LB26*/ 06113000
         BAL   @14,BACKUP                                          1627 06114000
*       RETURN;                     /*                       @Y30LB26*/ 06115000
         B     @EL00023                                            1628 06116000
*     END;                          /*                       @Y30LB26*/ 06117000
*                                                                  1629 06118000
*   /*****************************************************************/ 06119000
*   /*                                                               */ 06120000
*   /* IF LATEST COPY IS ASKED FOR, GO LOOK FOR IT           @Y30LB26*/ 06121000
*   /*                                                               */ 06122000
*   /*****************************************************************/ 06123000
*                                                                  1630 06124000
*   IF RVVLCOPY=ON&(RVVCPLHD=OFF&RVVALL=OFF)/* WANT COPY?    @ZDR2053*/ 06125000
*     THEN                          /*                       @ZDR2053*/ 06126000
@RF01625 TM    RVVLCOPY(RVVIPTR),B'00100000'                       1630 06127000
         BNO   @RF01630                                            1630 06128000
         TM    RVVCPLHD(RVVIPTR),B'00010000'                       1630 06129000
         BNZ   @RF01630                                            1630 06130000
         TM    RVVALL(RVVIPTR),B'00000001'                         1630 06131000
         BNZ   @RF01630                                            1630 06132000
*     DO;                           /*                       @Y30LB26*/ 06133000
*       CALL LATECPY;               /* GET LATEST COPY       @Y30LB26*/ 06134000
         BAL   @14,LATECPY                                         1632 06135000
*       RETURN;                     /*                       @Y30LB26*/ 06136000
         B     @EL00023                                            1633 06137000
*     END;                          /*                       @Y30LB26*/ 06138000
*   ELSE                            /*                       @Y30LB26*/ 06139000
*                                                                  1635 06140000
*     /***************************************************************/ 06141000
*     /*                                                             */ 06142000
*     /* IF NONE OF THESE, THEN NOT ENOUGH INFO GIVEN        @Y30LB26*/ 06143000
*     /*                                                             */ 06144000
*     /***************************************************************/ 06145000
*                                                                  1635 06146000
*     DO;                           /*                       @Y30LB26*/ 06147000
@RF01630 DS    0H                                                  1636 06148000
*       RPLRCODE=NOCPYTYP;          /* COPY NOT SPECIFIED    @Y30LB26*/ 06149000
         L     @02,RPLVPTR                                         1636 06150000
         MVC   RPLRCODE(2,@02),@CB00801                            1636 06151000
*       RPLVRETC=FOUR;              /* BAD RET CODE          @Y30LB26*/ 06152000
         MVC   RPLVRETC(2,@02),@CB00749                            1637 06153000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Y30LB26*/ 06154000
         BAL   @14,ERREXIT                                         1638 06155000
*       RETURN;                     /*                       @Y30LB26*/ 06156000
         B     @EL00023                                            1639 06157000
*     END;                          /*                       @Y30LB26*/ 06158000
*   END COPYDIR;                    /*                       @Y30LB26*/ 06159000
*                                                                  1642 06160000
*   /*****************************************************************/ 06161000
*   /*                                                               */ 06162000
*   /* THIS PROCEDURE LOCATES A COPY RECORD WITH THE         @Y30LB26*/ 06163000
*   /* SPECIFIED DATE AND ALSO A SPECIFIED SEQUENCE          @Y30LB26*/ 06164000
*   /* NUMBER IF ONE WAS GIVEN                               @Y30LB26*/ 06165000
*   /*                                                               */ 06166000
*   /*****************************************************************/ 06167000
*                                                                  1642 06168000
*CPYDATE:                                                          1642 06169000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 06170000
CPYDATE  ST    @14,@SA00024                                        1642 06171000
*   COUNT=ZERO;                     /* INIT COUNTER          @Y30LB26*/ 06172000
         SLR   COUNT,COUNT                                         1643 06173000
*   VOLKY=RVVOLUME;                 /* VOL NAME              @Y30LB26*/ 06174000
*                                                                  1644 06175000
         MVC   VOLKY(6),RVVOLUME(RVVIPTR)                          1644 06176000
*   /*****************************************************************/ 06177000
*   /*                                                               */ 06178000
*   /* GO RESERVE INVENTORY SHARED                           @Y30LB26*/ 06179000
*   /*                                                               */ 06180000
*   /*****************************************************************/ 06181000
*                                                                  1645 06182000
*   CALL RESSHARE;                  /*                       @Y30LB26*/ 06183000
*                                                                  1645 06184000
         BAL   @14,RESSHARE                                        1645 06185000
*   /*****************************************************************/ 06186000
*   /*                                                               */ 06187000
*   /* START LOOP LOOKING FOR SPECIFIED DATE AND SEQUENCE    @Y30LB26*/ 06188000
*   /*                                                               */ 06189000
*   /*****************************************************************/ 06190000
*                                                                  1646 06191000
*   DO WHILE I=I;                   /*                       @Y30LB26*/ 06192000
         B     @DE01646                                            1646 06193000
@DL01646 DS    0H                                                  1647 06194000
*     VIDKY=VIDKY+FIXONE;           /* INCREMENT COUNT       @Y30LB26*/ 06195000
         LA    @07,1                                               1647 06196000
         SLR   @04,@04                                             1647 06197000
         IC    @04,VIDKY                                           1647 06198000
         ALR   @07,@04                                             1647 06199000
         STC   @07,VIDKY                                           1647 06200000
*     RPLVKEY=ADDR(VKEY);           /* ADDR KEY              @Y30LB26*/ 06201000
         L     @07,RPLVPTR                                         1648 06202000
         LA    @04,VKEY                                            1648 06203000
         ST    @04,RPLVKEY(,@07)                                   1648 06204000
*     RPLVLOC=ON;                   /* LOCATE MODE           @Y30LB26*/ 06205000
*     RPLVDIR=ON;                   /* READ DIRECT           @Y30LB26*/ 06206000
         OI    RPLVLOC(@07),B'11000000'                            1650 06207000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           @Y30LB26*/ 06208000
         MVI   RPLVTYP(@07),X'00'                                  1651 06209000
*     RPLVKGE=ON;                   /* READ >OR=             @Y30LB26*/ 06210000
         OI    RPLVKGE(@07),B'00000100'                            1652 06211000
*     RESPECIFY                                                    1653 06212000
*       REG1 RSTD;                  /* RESTRICT              @Y30LB26*/ 06213000
*     REG1=RPLVPTR;                 /* ADDR RPLV             @Y30LB26*/ 06214000
         LR    REG1,@07                                            1654 06215000
*     CALL ICBVIO00;                /* READ                  @Y30LB26*/ 06216000
         L     @15,@CV00671                                        1655 06217000
         BALR  @14,@15                                             1655 06218000
*     RESPECIFY                                                    1656 06219000
*       REG1 UNRSTD;                /* FREE REG1             @Y30LB26*/ 06220000
*     IF RPLVRETC¬=RCZERO THEN      /* CK RETURN CODE        @Y30LB26*/ 06221000
         L     @07,RPLVPTR                                         1657 06222000
         CLC   RPLVRETC(2,@07),@CB00747                            1657 06223000
         BE    @RF01657                                            1657 06224000
*       DO;                         /*                       @Y30LB26*/ 06225000
*         CALL ERREXIT;             /* SAVE RETURN CODES     @Y30LB26*/ 06226000
         BAL   @14,ERREXIT                                         1659 06227000
*         RETURN;                   /*                       @Y30LB26*/ 06228000
@EL00024 DS    0H                                                  1660 06229000
@EF00024 DS    0H                                                  1660 06230000
@ER00024 L     @14,@SA00024                                        1660 06231000
         BR    @14                                                 1660 06232000
*       END;                        /*                       @Y30LB26*/ 06233000
*     COPYVPTR=RPLVBUF;             /* ADDR REC READ         @Y30LB26*/ 06234000
*                                                                  1662 06235000
@RF01657 L     @07,RPLVPTR                                         1662 06236000
         L     @07,RPLVBUF(,@07)                                   1662 06237000
         ST    @07,COPYVPTR                                        1662 06238000
*     /***************************************************************/ 06239000
*     /*                                                             */ 06240000
*     /* CHECK TO SEE IF THIS IS A COPY RECORD & CORRECT ONE @Y30LB26*/ 06241000
*     /*                                                             */ 06242000
*     /***************************************************************/ 06243000
*                                                                  1663 06244000
*     IF COPV=VKY&COPSERNO=VOLKY THEN/* A COPY RECORD        @Y30LB26*/ 06245000
         CLC   COPV(5,@07),VKY                                     1663 06246000
         BNE   @RF01663                                            1663 06247000
         CLC   COPSERNO(6,@07),VOLKY                               1663 06248000
         BNE   @RF01663                                            1663 06249000
*       DO;                         /*                       @Y30LB26*/ 06250000
*                                                                  1664 06251000
*         /***********************************************************/ 06252000
*         /*                                                         */ 06253000
*         /* IS THIS THE SPECIFIED DATE THE COPY WAS MADE    @Y30LB26*/ 06254000
*         /*                                                         */ 06255000
*         /***********************************************************/ 06256000
*                                                                  1665 06257000
*         IF COPDATE=RVVCDATE THEN  /* RITE DATE ?           @ZDR2053*/ 06258000
         CLC   COPDATE(4,@07),RVVCDATE(RVVIPTR)                    1665 06259000
         BNE   @RF01665                                            1665 06260000
*           DO;                     /*                       @Y30LB26*/ 06261000
*             COUNT=COUNT+ONE;      /* ADD ONE SEQ CNT       @Y30LB26*/ 06262000
*                                                                  1667 06263000
         AL    COUNT,@CF00041                                      1667 06264000
*             /*******************************************************/ 06265000
*             /*                                                     */ 06266000
*             /* CHECK TO SEE IF SEQUENCE WAS GIVEN          @Y30LB26*/ 06267000
*             /*                                                     */ 06268000
*             /*******************************************************/ 06269000
*                                                                  1668 06270000
*             IF RVVSSEQ=ON THEN    /* CHECK SEQUENCE        @Y30LB26*/ 06271000
         TM    RVVSSEQ(RVVIPTR),B'00010000'                        1668 06272000
         BNO   @RF01668                                            1668 06273000
*               DO;                 /*                       @Y30LB26*/ 06274000
*                                                                  1669 06275000
*                 /***************************************************/ 06276000
*                 /*                                                 */ 06277000
*                 /* IF SEQUENCE CHECKING, CHECK COUNT       @Y30LB26*/ 06278000
*                 /*                                                 */ 06279000
*                 /***************************************************/ 06280000
*                                                                  1670 06281000
*                 IF COUNT=RVVRDSEQ THEN/* CK COUNT          @Y30LB26*/ 06282000
         SLR   @04,@04                                             1670 06283000
         IC    @04,RVVRDSEQ(,RVVIPTR)                              1670 06284000
         CR    COUNT,@04                                           1670 06285000
         BNE   @RF01670                                            1670 06286000
*                   DO;             /*                       @ZDR2053*/ 06287000
*                                                                  1671 06288000
*                     /***********************************************/ 06289000
*                     /*                                             */ 06290000
*                     /* CHECK FOR CORRECT RECORD            @ZDR2053*/ 06291000
*                     /*                                             */ 06292000
*                     /***********************************************/ 06293000
*                                                                  1672 06294000
*                     IF RVVALL=ON|(COPHOLD=ON&RVVCPLHD=ON)|/*     1672 06295000
*                                                            @ZDR2053*/ 06296000
*                         (RVVCPLHD=OFF&COPHOLD=OFF)/*       @ZDR2053*/ 06297000
*                       THEN        /*                       @ZDR2053*/ 06298000
*                                                                  1672 06299000
         TM    RVVALL(RVVIPTR),B'00000001'                         1672 06300000
         BO    @RT01672                                            1672 06301000
         TM    COPHOLD(@07),B'10000000'                            1672 06302000
         BNO   @GL00023                                            1672 06303000
         TM    RVVCPLHD(RVVIPTR),B'00010000'                       1672 06304000
         BO    @RT01672                                            1672 06305000
@GL00023 TM    RVVCPLHD(RVVIPTR),B'00010000'                       1672 06306000
         BNZ   @RF01672                                            1672 06307000
         L     @07,COPYVPTR                                        1672 06308000
         TM    COPHOLD(@07),B'10000000'                            1672 06309000
         BNZ   @RF01672                                            1672 06310000
@RT01672 DS    0H                                                  1673 06311000
*                       /*********************************************/ 06312000
*                       /*                                           */ 06313000
*                       /* IF PROPER DATE, SEQUENCE, AND RECORD      */ 06314000
*                       /*                                   @ZDR2053*/ 06315000
*                       /* BUFFER AND RETURN RECORD          @Y30LB26*/ 06316000
*                       /*                                           */ 06317000
*                       /*********************************************/ 06318000
*                                                                  1673 06319000
*                       DO;         /*                       @Y30LB26*/ 06320000
*                         CALL GETBUF;/* GET SPACE           @Y30LB26*/ 06321000
         BAL   @14,GETBUF                                          1674 06322000
*                         IF RPLVRETC¬=RCZERO THEN/* CK RETURN     1675 06323000
*                                                            @Y30LB26*/ 06324000
         L     @04,RPLVPTR                                         1675 06325000
         CLC   RPLVRETC(2,@04),@CB00747                            1675 06326000
         BNE   @RT01675                                            1675 06327000
*                           RETURN; /*                       @Y30LB26*/ 06328000
*                         BUFFER=COPYV;/* REC TO BUFF        @Y30LB26*/ 06329000
         L     @02,RVVAREA(,RVVIPTR)                               1677 06330000
         MVI   BUFFER+164(@02),C' '                                1677 06331000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1677 06332000
         L     @01,COPYVPTR                                        1677 06333000
         MVC   BUFFER(164,@02),COPYV(@01)                          1677 06334000
*                         RPLVRETC=RCZERO;/* GOOD RET CODE   @Y30LB26*/ 06335000
         MVC   RPLVRETC(2,@04),@CB00747                            1678 06336000
*                         RPLRCODE=RCZERO;/* GOOD REASON CODE      1679 06337000
*                                                            @Y30LB26*/ 06338000
         MVC   RPLRCODE(2,@04),@CB00747                            1679 06339000
*                         RETURN;   /*                       @Y30LB26*/ 06340000
         B     @EL00024                                            1680 06341000
*                       END;        /*                       @Y30LB26*/ 06342000
*                     ELSE          /*                       @Y30LB26*/ 06343000
*                                                                  1682 06344000
*                       /*********************************************/ 06345000
*                       /*                                           */ 06346000
*                       /* SEQUENCE WAS SPECIFIED BUT NOT FOUND      */ 06347000
*                       /*                                   @Y30LB26*/ 06348000
*                       /* SO SET UP TO LOOP AND TRY AGAIN   @Y30LB26*/ 06349000
*                       /*                                           */ 06350000
*                       /*********************************************/ 06351000
*                                                                  1682 06352000
*                       VKEY=COPNAME;/* LAST KEY READ        @Y30LB26*/ 06353000
@RF01672 L     @07,COPYVPTR                                        1682 06354000
         MVC   VKEY(13),COPNAME(@07)                               1682 06355000
*                   END;            /*                       @Y30LB26*/ 06356000
*                 ELSE                                             1684 06357000
*                   VKEY=COPNAME;   /* LAST KEY READ         @ZDR2053*/ 06358000
         B     @RC01670                                            1684 06359000
@RF01670 L     @07,COPYVPTR                                        1684 06360000
         MVC   VKEY(13),COPNAME(@07)                               1684 06361000
*               END;                /*                       @ZDR2053*/ 06362000
*             ELSE                  /*                       @Y30LB26*/ 06363000
*                                                                  1686 06364000
*               /*****************************************************/ 06365000
*               /*                                                   */ 06366000
*               /* CHECK FOR CORRECT RECORD                  @ZDR2053*/ 06367000
*               /*                                                   */ 06368000
*               /*****************************************************/ 06369000
*                                                                  1686 06370000
*               IF RVVALL=ON|(COPHOLD=ON&RVVCPLHD=ON)|/*     @ZDR2053*/ 06371000
*                   (RVVCPLHD=OFF&COPHOLD=OFF)/*             @ZDR2053*/ 06372000
*                 THEN              /*                       @ZDR2053*/ 06373000
*                                                                  1686 06374000
         B     @RC01668                                            1686 06375000
@RF01668 TM    RVVALL(RVVIPTR),B'00000001'                         1686 06376000
         BO    @RT01686                                            1686 06377000
         L     @07,COPYVPTR                                        1686 06378000
         TM    COPHOLD(@07),B'10000000'                            1686 06379000
         BNO   @GL00027                                            1686 06380000
         TM    RVVCPLHD(RVVIPTR),B'00010000'                       1686 06381000
         BO    @RT01686                                            1686 06382000
@GL00027 TM    RVVCPLHD(RVVIPTR),B'00010000'                       1686 06383000
         BNZ   @RF01686                                            1686 06384000
         L     @07,COPYVPTR                                        1686 06385000
         TM    COPHOLD(@07),B'10000000'                            1686 06386000
         BNZ   @RF01686                                            1686 06387000
@RT01686 DS    0H                                                  1687 06388000
*                 /***************************************************/ 06389000
*                 /*                                                 */ 06390000
*                 /* SEQUENCE CHECKING WAS NOT ASKED FOR AND @ZDR2053*/ 06391000
*                 /* CORRECT DATE WAS LOCATED, SO RETURN RECORD      */ 06392000
*                 /*                                         @Y30LB26*/ 06393000
*                 /*                                                 */ 06394000
*                 /***************************************************/ 06395000
*                                                                  1687 06396000
*                 DO;               /*                       @Y30LB26*/ 06397000
*                   CALL GETBUF;    /* GET CORE              @Y30LB26*/ 06398000
         BAL   @14,GETBUF                                          1688 06399000
*                   IF RPLVRETC¬=RCZERO THEN/* CK RETURN     @Y30LB26*/ 06400000
         L     @04,RPLVPTR                                         1689 06401000
         CLC   RPLVRETC(2,@04),@CB00747                            1689 06402000
         BNE   @RT01689                                            1689 06403000
*                     RETURN;       /*                       @Y30LB26*/ 06404000
*                   BUFFER=COPYV;   /* REC TO BUFFER         @Y30LB26*/ 06405000
         L     @02,RVVAREA(,RVVIPTR)                               1691 06406000
         MVI   BUFFER+164(@02),C' '                                1691 06407000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1691 06408000
         L     @01,COPYVPTR                                        1691 06409000
         MVC   BUFFER(164,@02),COPYV(@01)                          1691 06410000
*                   RPLRCODE=RCZERO;/* GOOD RET CODE         @Y30LB26*/ 06411000
         MVC   RPLRCODE(2,@04),@CB00747                            1692 06412000
*                   RPLVRETC=RCZERO;/* GOOD REASON CODE      @Y30LB26*/ 06413000
         MVC   RPLVRETC(2,@04),@CB00747                            1693 06414000
*                   RETURN;         /*                       @Y30LB26*/ 06415000
         B     @EL00024                                            1694 06416000
*                 END;              /*                       @Y30LB26*/ 06417000
*               ELSE                                               1696 06418000
*                 VKEY=COPNAME;     /* LAST KEY READ         @ZDR2053*/ 06419000
@RF01686 L     @07,COPYVPTR                                        1696 06420000
         MVC   VKEY(13),COPNAME(@07)                               1696 06421000
*           END;                    /*                       @Y30LB26*/ 06422000
*         ELSE                      /*                       @Y30LB26*/ 06423000
*                                                                  1698 06424000
*           /*********************************************************/ 06425000
*           /*                                                       */ 06426000
*           /* HAVE NOT FOUND THE RIGHT DATE YET, SO         @Y30LB26*/ 06427000
*           /* SET UP TO LOOP AROUND AND TRY AGAIN           @Y30LB26*/ 06428000
*           /*                                                       */ 06429000
*           /*********************************************************/ 06430000
*                                                                  1698 06431000
*           VKEY=COPNAME;           /* KEY LAST READ         @Y30LB26*/ 06432000
         B     @RC01665                                            1698 06433000
@RF01665 L     @07,COPYVPTR                                        1698 06434000
         MVC   VKEY(13),COPNAME(@07)                               1698 06435000
*       END;                        /*                       @Y30LB26*/ 06436000
*     ELSE                          /*                       @Y30LB26*/ 06437000
*                                                                  1700 06438000
*       /*************************************************************/ 06439000
*       /*                                                           */ 06440000
*       /* IS NO LONGER A COPY RECORD, SO SET RECORD NOT     @Y30LB26*/ 06441000
*       /* FOUND REASON CODE AND RETURN                      @Y30LB26*/ 06442000
*       /*                                                           */ 06443000
*       /*************************************************************/ 06444000
*                                                                  1700 06445000
*       DO;                         /*                       @Y30LB26*/ 06446000
         B     @RC01663                                            1700 06447000
@RF01663 DS    0H                                                  1701 06448000
*         RPLVRETC=FOUR;            /* BAD RETURN CODE       @Y30LB26*/ 06449000
         L     @02,RPLVPTR                                         1701 06450000
         MVC   RPLVRETC(2,@02),@CB00749                            1701 06451000
*         RPLRCODE=NORECRC;         /* RECORD NOT FOUND      @Y30LB26*/ 06452000
         MVC   RPLRCODE(2,@02),@CB00789                            1702 06453000
*         CALL ERREXIT;             /* SAVE RET CODES        @Y30LB26*/ 06454000
         BAL   @14,ERREXIT                                         1703 06455000
*         RETURN;                   /*                       @Y30LB26*/ 06456000
         B     @EL00024                                            1704 06457000
*       END;                        /*                       @Y30LB26*/ 06458000
*   END;                            /*                       @Y30LB26*/ 06459000
@RC01663 DS    0H                                                  1706 06460000
@DE01646 CLC   I(1),I                                              1706 06461000
         BE    @DL01646                                            1706 06462000
*   END CPYDATE;                    /*                       @Y30LB26*/ 06463000
         B     @EL00024                                            1707 06464000
*                                                                  1708 06465000
*   /*****************************************************************/ 06466000
*   /*                                                               */ 06467000
*   /* ROUTINE DETERMINES IF LATEST OR OLDEST BACKUP         @Y30LB26*/ 06468000
*   /* WERE CALLED FOR                                       @Y30LB26*/ 06469000
*   /*                                                               */ 06470000
*   /*****************************************************************/ 06471000
*                                                                  1708 06472000
*BACKUP:                                                           1708 06473000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 06474000
BACKUP   ST    @14,@SA00025                                        1708 06475000
*   VOLKY=RVVOLUME;                 /* BUILD KEY             @Y30LB26*/ 06476000
*                                                                  1709 06477000
         MVC   VOLKY(6),RVVOLUME(RVVIPTR)                          1709 06478000
*   /*****************************************************************/ 06479000
*   /*                                                               */ 06480000
*   /* IF LATEST BACKUP WAS ASKED FOR, GO GET IT             @Y30LB26*/ 06481000
*   /*                                                               */ 06482000
*   /*****************************************************************/ 06483000
*                                                                  1710 06484000
*   IF RVVLBKUP=ON THEN             /* LAST BACKUP?          @Y30LB26*/ 06485000
         TM    RVVLBKUP(RVVIPTR),B'10000000'                       1710 06486000
         BNO   @RF01710                                            1710 06487000
*     DO;                           /*                       @Y30LB26*/ 06488000
*       CALL LATEBKUP;              /* GET LATEST BACKUP     @Y30LB26*/ 06489000
         BAL   @14,LATEBKUP                                        1712 06490000
*       RETURN;                     /*                       @Y30LB26*/ 06491000
@EL00025 DS    0H                                                  1713 06492000
@EF00025 DS    0H                                                  1713 06493000
@ER00025 L     @14,@SA00025                                        1713 06494000
         BR    @14                                                 1713 06495000
*     END;                          /*                       @Y30LB26*/ 06496000
*   ELSE                            /*                       @Y30LB26*/ 06497000
*                                                                  1715 06498000
*     /***************************************************************/ 06499000
*     /*                                                             */ 06500000
*     /* OLDEST BACKUP WAS ASKED FOR, SO GO GET IT           @Y30LB26*/ 06501000
*     /*                                                             */ 06502000
*     /***************************************************************/ 06503000
*                                                                  1715 06504000
*     DO;                           /*                       @Y30LB26*/ 06505000
@RF01710 DS    0H                                                  1716 06506000
*       CALL OLDBKUP;               /* GET LATEST BACKUP     @Y30LB26*/ 06507000
         BAL   @14,OLDBKUP                                         1716 06508000
*       RETURN;                     /*                       @Y30LB26*/ 06509000
         B     @EL00025                                            1717 06510000
*     END;                          /*                       @Y30LB26*/ 06511000
*   END BACKUP;                     /*                       @Y30LB26*/ 06512000
*                                                                  1720 06513000
*   /*****************************************************************/ 06514000
*   /*                                                               */ 06515000
*   /* ROUTINE RETRIEVES LATEST BACKUP COPY                  @Y30LB26*/ 06516000
*   /*                                                               */ 06517000
*   /*****************************************************************/ 06518000
*                                                                  1720 06519000
*LATEBKUP:                                                         1720 06520000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 06521000
*                                                                  1720 06522000
LATEBKUP ST    @14,@SA00026                                        1720 06523000
*   /*****************************************************************/ 06524000
*   /*                                                               */ 06525000
*   /* GO RESERVE INVENTORY DATA SET SHARED                  @Y30LB26*/ 06526000
*   /*                                                               */ 06527000
*   /*****************************************************************/ 06528000
*                                                                  1721 06529000
*   CALL RESSHARE;                  /*                       @Y30LB26*/ 06530000
*                                                                  1721 06531000
         BAL   @14,RESSHARE                                        1721 06532000
*   /*****************************************************************/ 06533000
*   /*                                                               */ 06534000
*   /* START LOOPING THRU LOOKING FOR LATEST BACKUP          @Y30LB26*/ 06535000
*   /*                                                               */ 06536000
*   /*****************************************************************/ 06537000
*                                                                  1722 06538000
*   DO WHILE I=I;                   /* LOOP                  @Y30LB26*/ 06539000
         B     @DE01722                                            1722 06540000
@DL01722 DS    0H                                                  1723 06541000
*     VIDKY=VIDKY+FIXONE;           /* UP KEY                @Y30LB26*/ 06542000
         LA    @04,1                                               1723 06543000
         SLR   @02,@02                                             1723 06544000
         IC    @02,VIDKY                                           1723 06545000
         ALR   @04,@02                                             1723 06546000
         STC   @04,VIDKY                                           1723 06547000
*     RPLVKEY=ADDR(VKEY);           /* ADDR OF KEY           @Y30LB26*/ 06548000
         L     @04,RPLVPTR                                         1724 06549000
         LA    @02,VKEY                                            1724 06550000
         ST    @02,RPLVKEY(,@04)                                   1724 06551000
*     RPLVLOC=ON;                   /* LOCATION MODE         @Y30LB26*/ 06552000
*     RPLVDIR=ON;                   /* READ DIRECT           @Y30LB26*/ 06553000
         OI    RPLVLOC(@04),B'11000000'                            1726 06554000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           @Y30LB26*/ 06555000
         MVI   RPLVTYP(@04),X'00'                                  1727 06556000
*     RPLVKGE=ON;                   /* READ > OR =           @Y30LB26*/ 06557000
         OI    RPLVKGE(@04),B'00000100'                            1728 06558000
*     RESPECIFY                                                    1729 06559000
*       REG1 RSTD;                  /* RESTRICT REG1         @Y30LB26*/ 06560000
*     REG1=RPLVPTR;                 /* ADDR OF RPLV          @Y30LB26*/ 06561000
         LR    REG1,@04                                            1730 06562000
*     CALL ICBVIO00;                /* READ COPY             @Y30LB26*/ 06563000
         L     @15,@CV00671                                        1731 06564000
         BALR  @14,@15                                             1731 06565000
*     RESPECIFY                                                    1732 06566000
*       REG1 UNRSTD;                /* FILE REG1             @Y30LB26*/ 06567000
*                                                                  1732 06568000
*     /***************************************************************/ 06569000
*     /*                                                             */ 06570000
*     /* CHECK RETURN FROM I/O PROCESSOR                     @Y30LB26*/ 06571000
*     /*                                                             */ 06572000
*     /***************************************************************/ 06573000
*                                                                  1733 06574000
*     IF RPLVRETC¬=RCZERO THEN      /* CHECK RETURN CODE     @Y30LB26*/ 06575000
         L     @04,RPLVPTR                                         1733 06576000
         CLC   RPLVRETC(2,@04),@CB00747                            1733 06577000
         BE    @RF01733                                            1733 06578000
*       DO;                         /*                       @Y30LB26*/ 06579000
*                                                                  1734 06580000
*         /***********************************************************/ 06581000
*         /*                                                         */ 06582000
*         /* IF RECORD NOT FOUND, SEE IF ALREADY FOUND       @Y30LB26*/ 06583000
*         /* GOOD BACKUP COPY                                @Y30LB26*/ 06584000
*         /*                                                         */ 06585000
*         /***********************************************************/ 06586000
*                                                                  1735 06587000
*         IF RPLRCODE=NORECRC THEN  /* RECORD NOT FND        @Y30LB26*/ 06588000
         CLC   RPLRCODE(2,@04),@CB00789                            1735 06589000
         BNE   @RF01735                                            1735 06590000
*           DO;                     /*                       @Y30LB26*/ 06591000
*             IF BKUPFND=ON THEN    /* FND GOOD REC YET ?    @Y30LB26*/ 06592000
*                                                                  1737 06593000
         TM    BKUPFND,B'01000000'                                 1737 06594000
         BNO   @RF01737                                            1737 06595000
*               /*****************************************************/ 06596000
*               /*                                                   */ 06597000
*               /* IF A GOOD ONE FOUND, READ IT              @Y30LB26*/ 06598000
*               /*                                                   */ 06599000
*               /*****************************************************/ 06600000
*                                                                  1738 06601000
*               DO;                 /*                       @Y30LB26*/ 06602000
*                 VKEY=SAVEKEY;     /* GET OLD KEY           @Y30LB26*/ 06603000
         MVC   VKEY(13),SAVEKEY                                    1739 06604000
*                 RPLVKEY=ADDR(VKEY);/* ADDR KEY             @Y30LB26*/ 06605000
         LA    @02,VKEY                                            1740 06606000
         ST    @02,RPLVKEY(,@04)                                   1740 06607000
*                 RPLVLOC=ON;       /* LOCATION MODE         @Y30LB26*/ 06608000
*                 RPLVDIR=ON;       /* READ DIRECT           @Y30LB26*/ 06609000
         OI    RPLVLOC(@04),B'11000000'                            1742 06610000
*                 RPLVTYP=RPLVREAD; /* READ RECORD           @Y30LB26*/ 06611000
         MVI   RPLVTYP(@04),X'00'                                  1743 06612000
*                 RPLVKGE=OFF;      /* READ > OR =           @Y30LB26*/ 06613000
         NI    RPLVKGE(@04),B'11111011'                            1744 06614000
*                 RESPECIFY                                        1745 06615000
*                   REG1 RSTD;      /* RESTRICT REG1         @Y30LB26*/ 06616000
*                 REG1=RPLVPTR;     /* ADDR RPLV             @Y30LB26*/ 06617000
         LR    REG1,@04                                            1746 06618000
*                 CALL ICBVIO00;    /* READ BACKUP           @Y30LB26*/ 06619000
         L     @15,@CV00671                                        1747 06620000
         BALR  @14,@15                                             1747 06621000
*                 RESPECIFY                                        1748 06622000
*                   REG1 UNRSTD;    /* FREE REG1             @Y30LB26*/ 06623000
*                                                                  1748 06624000
*                 /***************************************************/ 06625000
*                 /*                                                 */ 06626000
*                 /* CHECK RETURN CODE FROM I/O PROCESSOR    @Y30LB26*/ 06627000
*                 /*                                                 */ 06628000
*                 /***************************************************/ 06629000
*                                                                  1749 06630000
*                 IF RPLVRETC¬=RCZERO THEN/* CK RETURN CODE  @Y30LB26*/ 06631000
         L     @04,RPLVPTR                                         1749 06632000
         CLC   RPLVRETC(2,@04),@CB00747                            1749 06633000
         BE    @RF01749                                            1749 06634000
*                   DO;             /*                       @Y30LB26*/ 06635000
*                     CALL ERREXIT; /* SAVE RET CODES        @Y30LB26*/ 06636000
         BAL   @14,ERREXIT                                         1751 06637000
*                     RETURN;       /*                       @Y30LB26*/ 06638000
@EL00026 DS    0H                                                  1752 06639000
@EF00026 DS    0H                                                  1752 06640000
@ER00026 L     @14,@SA00026                                        1752 06641000
         BR    @14                                                 1752 06642000
*                   END;            /*                       @Y30LB26*/ 06643000
*                                                                  1753 06644000
*                 /***************************************************/ 06645000
*                 /*                                                 */ 06646000
*                 /* SET ADDRESS TO RECORD AND GET BUFFER    @Y30LB26*/ 06647000
*                 /* SPACE AND RETURN RECORD                 @Y30LB26*/ 06648000
*                 /*                                                 */ 06649000
*                 /***************************************************/ 06650000
*                                                                  1754 06651000
*                 COPYVPTR=RPLVBUF; /* ADDR OF RECORD        @Y30LB26*/ 06652000
@RF01749 L     @04,RPLVPTR                                         1754 06653000
         L     @04,RPLVBUF(,@04)                                   1754 06654000
         ST    @04,COPYVPTR                                        1754 06655000
*                 CALL GETBUF;      /* GET BUFFER SPACE      @Y30LB26*/ 06656000
         BAL   @14,GETBUF                                          1755 06657000
*                 IF RPLVRETC¬=RCZERO THEN/* CK RETURN       @Y30LB26*/ 06658000
         L     @04,RPLVPTR                                         1756 06659000
         CLC   RPLVRETC(2,@04),@CB00747                            1756 06660000
         BNE   @RT01756                                            1756 06661000
*                   RETURN;         /*                       @Y30LB26*/ 06662000
*                 BUFFER=COPYV;     /* MOVE IN RECORD        @Y30LB26*/ 06663000
         L     @02,RVVAREA(,RVVIPTR)                               1758 06664000
         MVI   BUFFER+164(@02),C' '                                1758 06665000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1758 06666000
         L     @01,COPYVPTR                                        1758 06667000
         MVC   BUFFER(164,@02),COPYV(@01)                          1758 06668000
*                 RPLVRETC=RCZERO;  /* GOOD RET CODE         @Y30LB26*/ 06669000
         MVC   RPLVRETC(2,@04),@CB00747                            1759 06670000
*                 RPLRCODE=RCZERO;  /* GOOD REASON CODE      @Y30LB26*/ 06671000
         MVC   RPLRCODE(2,@04),@CB00747                            1760 06672000
*                 RETURN;           /*                       @Y30LB26*/ 06673000
         B     @EL00026                                            1761 06674000
*               END;                /*                       @Y30LB26*/ 06675000
*                                                                  1762 06676000
*             /*******************************************************/ 06677000
*             /*                                                     */ 06678000
*             /* IF GOOD RECORD NOT FOUND, GO AHEAD AND      @Y30LB26*/ 06679000
*             /* RETURN NO RECORD RETURN CODE                @Y30LB26*/ 06680000
*             /*                                                     */ 06681000
*             /*******************************************************/ 06682000
*                                                                  1763 06683000
*             ELSE                  /*                       @Y30LB26*/ 06684000
*               DO;                 /*                       @Y30LB26*/ 06685000
@RF01737 DS    0H                                                  1764 06686000
*                 CALL ERREXIT;     /* SAVE RET CODES        @Y30LB26*/ 06687000
         BAL   @14,ERREXIT                                         1764 06688000
*                 RETURN;           /*                       @Y30LB26*/ 06689000
         B     @EL00026                                            1765 06690000
*               END;                /*                       @Y30LB26*/ 06691000
*           END;                    /*                       @Y30LB26*/ 06692000
*                                                                  1767 06693000
*         /***********************************************************/ 06694000
*         /*                                                         */ 06695000
*         /* IF RETURN FROM I/O IS NOT NO RECORD FOUND       @Y30LB26*/ 06696000
*         /* THEN GO AHEAD AND RETURN REASON CODE            @Y30LB26*/ 06697000
*         /*                                                         */ 06698000
*         /***********************************************************/ 06699000
*                                                                  1768 06700000
*         ELSE                      /*                       @Y30LB26*/ 06701000
*           DO;                     /*                       @Y30LB26*/ 06702000
@RF01735 DS    0H                                                  1769 06703000
*             CALL ERREXIT;         /* SAVE RET CODES        @Y30LB26*/ 06704000
         BAL   @14,ERREXIT                                         1769 06705000
*             RETURN;               /*                       @Y30LB26*/ 06706000
         B     @EL00026                                            1770 06707000
*           END;                    /*                       @Y30LB26*/ 06708000
*       END;                        /*                       #Y30LB26*/ 06709000
*     COPYVPTR=RPLVBUF;             /* ADDR RECORD           #Y30LB26*/ 06710000
*                                                                  1773 06711000
@RF01733 L     @04,RPLVPTR                                         1773 06712000
         L     @04,RPLVBUF(,@04)                                   1773 06713000
         ST    @04,COPYVPTR                                        1773 06714000
*     /***************************************************************/ 06715000
*     /*                                                             */ 06716000
*     /* CHECK TO SEE IF IT IS STILL A COPY RECORD           #Y30LB26*/ 06717000
*     /*                                                             */ 06718000
*     /***************************************************************/ 06719000
*                                                                  1774 06720000
*     IF COPV=VKY&COPSERNO=VOLKY THEN/* STILL COPY REC       #Y30LB26*/ 06721000
         CLC   COPV(5,@04),VKY                                     1774 06722000
         BNE   @RF01774                                            1774 06723000
         CLC   COPSERNO(6,@04),VOLKY                               1774 06724000
         BNE   @RF01774                                            1774 06725000
*       DO;                         /*                       @Y30LB26*/ 06726000
*                                                                  1775 06727000
*         /***********************************************************/ 06728000
*         /*                                                         */ 06729000
*         /* CHECK TO SEE IF IT IS A BACKUP COPY             @Y30LB26*/ 06730000
*         /*                                                         */ 06731000
*         /***********************************************************/ 06732000
*                                                                  1776 06733000
*         IF COPBKUP=ON&COPHOLD=OFF THEN/* BACKUP FOUND      @Y30LB26*/ 06734000
*                                                                  1776 06735000
         TM    COPBKUP(@04),B'00001000'                            1776 06736000
         BNO   @RF01776                                            1776 06737000
         TM    COPHOLD(@04),B'10000000'                            1776 06738000
         BNZ   @RF01776                                            1776 06739000
*           /*********************************************************/ 06740000
*           /*                                                       */ 06741000
*           /* IF BACKUP, SAVE KEY AND INDICATE A BACKUP FOUND       */ 06742000
*           /*                                               @Y30LB26*/ 06743000
*           /* AND SET KEY TO GO BACK AND TRY FOR A LATER    @Y30LB26*/ 06744000
*           /* BACKUP COPY                                   @Y30LB26*/ 06745000
*           /*                                                       */ 06746000
*           /*********************************************************/ 06747000
*                                                                  1777 06748000
*           DO;                     /*                       @Y30LB26*/ 06749000
*             SAVEKEY=COPNAME;      /*                       @Y30LB26*/ 06750000
         MVC   SAVEKEY(13),COPNAME(@04)                            1778 06751000
*             BKUPFND=ON;           /* BACKUP FOUND          @Y30LB26*/ 06752000
         OI    BKUPFND,B'01000000'                                 1779 06753000
*             VKEY=COPNAME;         /* LATEST KEY            @Y30LB26*/ 06754000
         MVC   VKEY(13),COPNAME(@04)                               1780 06755000
*           END;                    /*                       @Y30LB26*/ 06756000
*                                                                  1781 06757000
*         /***********************************************************/ 06758000
*         /*                                                         */ 06759000
*         /* THIS WAS NOT A BACKUP, SO SET KEY TO GO         @Y30LB26*/ 06760000
*         /* BACK AND TRY AGAIN                              @Y30LB26*/ 06761000
*         /*                                                         */ 06762000
*         /***********************************************************/ 06763000
*                                                                  1782 06764000
*         ELSE                      /*                       @Y30LB26*/ 06765000
*           VKEY=COPNAME;           /* UPDATE KEY            @Y30LB26*/ 06766000
         B     @RC01776                                            1782 06767000
@RF01776 L     @04,COPYVPTR                                        1782 06768000
         MVC   VKEY(13),COPNAME(@04)                               1782 06769000
*       END;                        /*                       @Y30LB26*/ 06770000
*                                                                  1783 06771000
*     /***************************************************************/ 06772000
*     /*                                                             */ 06773000
*     /* IT IS NO LONGER A COPY RECORD, SO IF A BACKUP       @Y30LB26*/ 06774000
*     /* WAS FOUND, GO BACK AND READ IT AND RETURN RECORD    @Y30LB26*/ 06775000
*     /*                                                             */ 06776000
*     /***************************************************************/ 06777000
*                                                                  1784 06778000
*     ELSE                          /*                       @Y30LB26*/ 06779000
*       DO;                         /*                       @Y30LB26*/ 06780000
         B     @RC01774                                            1784 06781000
@RF01774 DS    0H                                                  1785 06782000
*         IF BKUPFND=ON THEN        /* BACKUP FOUND          @Y30LB26*/ 06783000
         TM    BKUPFND,B'01000000'                                 1785 06784000
         BNO   @RF01785                                            1785 06785000
*           DO;                     /*                       @Y30LB26*/ 06786000
*             VKEY=SAVEKEY;         /* GET OLD KEY           @Y30LB26*/ 06787000
         MVC   VKEY(13),SAVEKEY                                    1787 06788000
*             RPLVKEY=ADDR(VKEY);   /* ADDR KEY              @Y30LB26*/ 06789000
         L     @04,RPLVPTR                                         1788 06790000
         LA    @02,VKEY                                            1788 06791000
         ST    @02,RPLVKEY(,@04)                                   1788 06792000
*             RPLVLOC=ON;           /* LOCATION MODE         @Y30LB26*/ 06793000
*             RPLVDIR=ON;           /* READ DIRECT           @Y30LB26*/ 06794000
         OI    RPLVLOC(@04),B'11000000'                            1790 06795000
*             RPLVTYP=RPLVREAD;     /* READ RECORD           @Y30LB26*/ 06796000
         MVI   RPLVTYP(@04),X'00'                                  1791 06797000
*             RPLVKGE=OFF;          /* READ > OR =           @Y30LB26*/ 06798000
         NI    RPLVKGE(@04),B'11111011'                            1792 06799000
*             RESPECIFY                                            1793 06800000
*               REG1 RSTD;          /* RESTRICT REG1         @Y30LB26*/ 06801000
*             REG1=RPLVPTR;         /* ADDR RPLV             @Y30LB26*/ 06802000
         LR    REG1,@04                                            1794 06803000
*             CALL ICBVIO00;        /* READ BACKUP           @Y30LB26*/ 06804000
         L     @15,@CV00671                                        1795 06805000
         BALR  @14,@15                                             1795 06806000
*             RESPECIFY                                            1796 06807000
*               REG1 UNRSTD;        /* FREE REG1             @Y30LB26*/ 06808000
*                                                                  1796 06809000
*             /*******************************************************/ 06810000
*             /*                                                     */ 06811000
*             /* CHECK RETURN CODE FROM I/O PROCESSOR        @Y30LB26*/ 06812000
*             /*                                                     */ 06813000
*             /*******************************************************/ 06814000
*                                                                  1797 06815000
*             IF RPLVRETC¬=RCZERO THEN/* CK RETURN CODE      @Y30LB26*/ 06816000
         L     @04,RPLVPTR                                         1797 06817000
         CLC   RPLVRETC(2,@04),@CB00747                            1797 06818000
         BE    @RF01797                                            1797 06819000
*               DO;                 /*                       @Y30LB26*/ 06820000
*                 CALL ERREXIT;     /* SAVE RET CODES        @Y30LB26*/ 06821000
         BAL   @14,ERREXIT                                         1799 06822000
*                 RETURN;           /*                       @Y30LB26*/ 06823000
         B     @EL00026                                            1800 06824000
*               END;                /*                       @Y30LB26*/ 06825000
*                                                                  1801 06826000
*             /*******************************************************/ 06827000
*             /*                                                     */ 06828000
*             /* SET ADDRESS TO RECORD AND GET BUFFER SPACE  @Y30LB26*/ 06829000
*             /* AND RETURN RECORD                           @Y30LB26*/ 06830000
*             /*                                                     */ 06831000
*             /*******************************************************/ 06832000
*                                                                  1802 06833000
*             COPYVPTR=RPLVBUF;     /* ADDR OF RECORD        @Y30LB26*/ 06834000
@RF01797 L     @04,RPLVPTR                                         1802 06835000
         L     @04,RPLVBUF(,@04)                                   1802 06836000
         ST    @04,COPYVPTR                                        1802 06837000
*             CALL GETBUF;          /* GET BUFFER SPACE      @Y30LB26*/ 06838000
         BAL   @14,GETBUF                                          1803 06839000
*             IF RPLVRETC¬=RCZERO THEN/* CK RETURN           @Y30LB26*/ 06840000
         L     @04,RPLVPTR                                         1804 06841000
         CLC   RPLVRETC(2,@04),@CB00747                            1804 06842000
         BNE   @RT01804                                            1804 06843000
*               RETURN;             /*                       @Y30LB26*/ 06844000
*             BUFFER=COPYV;         /* MOVE IN RECORD        @Y30LB26*/ 06845000
         L     @02,RVVAREA(,RVVIPTR)                               1806 06846000
         MVI   BUFFER+164(@02),C' '                                1806 06847000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1806 06848000
         L     @01,COPYVPTR                                        1806 06849000
         MVC   BUFFER(164,@02),COPYV(@01)                          1806 06850000
*             RPLVRETC=RCZERO;      /* GOOD RET CODE         @Y30LB26*/ 06851000
         MVC   RPLVRETC(2,@04),@CB00747                            1807 06852000
*             RPLRCODE=RCZERO;      /* GOOD REASON CODE      @Y30LB26*/ 06853000
         MVC   RPLRCODE(2,@04),@CB00747                            1808 06854000
*             RETURN;               /*                       @Y30LB26*/ 06855000
         B     @EL00026                                            1809 06856000
*           END;                    /*                       @Y30LB26*/ 06857000
*                                                                  1810 06858000
*         /***********************************************************/ 06859000
*         /*                                                         */ 06860000
*         /* NO BACKUP RECORD WAS FOUND, SO SET REASON       @Y30LB26*/ 06861000
*         /* CODE AND RETURN                                 @Y30LB26*/ 06862000
*         /*                                                         */ 06863000
*         /***********************************************************/ 06864000
*                                                                  1811 06865000
*         ELSE                      /*                       @Y30LB26*/ 06866000
*           DO;                     /*                       @Y30LB26*/ 06867000
@RF01785 DS    0H                                                  1812 06868000
*             RPLVRETC=FOUR;        /* BAD RET CODE          @Y30LB26*/ 06869000
         L     @02,RPLVPTR                                         1812 06870000
         MVC   RPLVRETC(2,@02),@CB00749                            1812 06871000
*             RPLRCODE=NORECRC;     /* RECORD NOT FOUND      @Y30LB26*/ 06872000
         MVC   RPLRCODE(2,@02),@CB00789                            1813 06873000
*             CALL ERREXIT;         /* SAVE RETURN CODES     @Y30LB26*/ 06874000
         BAL   @14,ERREXIT                                         1814 06875000
*             RETURN;               /*                       @Y30LB26*/ 06876000
         B     @EL00026                                            1815 06877000
*           END;                    /*                       @Y30LB26*/ 06878000
*       END;                        /*                       @Y30LB26*/ 06879000
*   END;                            /*                       @Y30LB26*/ 06880000
@RC01774 DS    0H                                                  1818 06881000
@DE01722 CLC   I(1),I                                              1818 06882000
         BE    @DL01722                                            1818 06883000
*   END LATEBKUP;                   /*                       @Y30LB26*/ 06884000
         B     @EL00026                                            1819 06885000
*                                                                  1820 06886000
*   /*****************************************************************/ 06887000
*   /*                                                               */ 06888000
*   /* THIS ROUTINE RETURNS THE OLDEST BACKUP COPY IF        @Y30LB26*/ 06889000
*   /* ONE EXISTS                                            @Y30LB26*/ 06890000
*   /*                                                               */ 06891000
*   /*****************************************************************/ 06892000
*                                                                  1820 06893000
*OLDBKUP:                                                          1820 06894000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 06895000
*                                                                  1820 06896000
OLDBKUP  ST    @14,@SA00027                                        1820 06897000
*   /*****************************************************************/ 06898000
*   /*                                                               */ 06899000
*   /* RESERVE INVENTORY SHARED                              @Y30LB26*/ 06900000
*   /*                                                               */ 06901000
*   /*****************************************************************/ 06902000
*                                                                  1821 06903000
*   CALL RESSHARE;                  /*                       @Y30LB26*/ 06904000
*                                                                  1821 06905000
         BAL   @14,RESSHARE                                        1821 06906000
*   /*****************************************************************/ 06907000
*   /*                                                               */ 06908000
*   /* START LOOP LOOKING FOR OLDEST BACKUP                  @Y30LB26*/ 06909000
*   /*                                                               */ 06910000
*   /*****************************************************************/ 06911000
*                                                                  1822 06912000
*   DO WHILE I=I;                   /* LOOP                  @Y30LB26*/ 06913000
         B     @DE01822                                            1822 06914000
@DL01822 DS    0H                                                  1823 06915000
*     VIDKY=VIDKY+FIXONE;           /* UPDATE COUNTER        @Y30LB26*/ 06916000
         LA    @04,1                                               1823 06917000
         SLR   @02,@02                                             1823 06918000
         IC    @02,VIDKY                                           1823 06919000
         ALR   @04,@02                                             1823 06920000
         STC   @04,VIDKY                                           1823 06921000
*     RPLVKEY=ADDR(VKEY);           /* ADDR KEY              @Y30LB26*/ 06922000
         L     @04,RPLVPTR                                         1824 06923000
         LA    @02,VKEY                                            1824 06924000
         ST    @02,RPLVKEY(,@04)                                   1824 06925000
*     RPLVLOC=ON;                   /* LOCATION MODE         @Y30LB26*/ 06926000
*     RPLVDIR=ON;                   /* READ DIRECT           @Y30LB26*/ 06927000
         OI    RPLVLOC(@04),B'11000000'                            1826 06928000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           @Y30LB26*/ 06929000
         MVI   RPLVTYP(@04),X'00'                                  1827 06930000
*     RPLVKGE=ON;                   /* FOR > OR =            @Y30LB26*/ 06931000
         OI    RPLVKGE(@04),B'00000100'                            1828 06932000
*     RESPECIFY                                                    1829 06933000
*       REG1 RSTD;                  /* RESTRICT REG1         @Y30LB26*/ 06934000
*     REG1=RPLVPTR;                 /* ADDR RPLV             @Y30LB26*/ 06935000
         LR    REG1,@04                                            1830 06936000
*     CALL ICBVIO00;                /* READ COPY RECORD      @Y30LB26*/ 06937000
         L     @15,@CV00671                                        1831 06938000
         BALR  @14,@15                                             1831 06939000
*     RESPECIFY                                                    1832 06940000
*       REG1 UNRSTD;                /* FREE REG1             @Y30LB26*/ 06941000
*     IF RPLVRETC¬=RCZERO THEN      /* CK RETURN CODE        @Y30LB26*/ 06942000
         L     @04,RPLVPTR                                         1833 06943000
         CLC   RPLVRETC(2,@04),@CB00747                            1833 06944000
         BE    @RF01833                                            1833 06945000
*       DO;                         /*                       @Y30LB26*/ 06946000
*         CALL ERREXIT;             /* SAVE RETURN CODES     @Y30LB26*/ 06947000
         BAL   @14,ERREXIT                                         1835 06948000
*         RETURN;                   /*                       @Y30LB26*/ 06949000
@EL00027 DS    0H                                                  1836 06950000
@EF00027 DS    0H                                                  1836 06951000
@ER00027 L     @14,@SA00027                                        1836 06952000
         BR    @14                                                 1836 06953000
*       END;                        /*                       @Y30LB26*/ 06954000
*                                                                  1837 06955000
*     /***************************************************************/ 06956000
*     /*                                                             */ 06957000
*     /* SET UP ADDRESSING TO RECORD JUST READ AND           @Y30LB26*/ 06958000
*     /* SEE IF IT IS STILL A COPY RECORD                    @Y30LB26*/ 06959000
*     /*                                                             */ 06960000
*     /***************************************************************/ 06961000
*                                                                  1838 06962000
*     COPYVPTR=RPLVBUF;             /* ADDR RECORD           @Y30LB26*/ 06963000
@RF01833 L     @04,RPLVPTR                                         1838 06964000
         L     @04,RPLVBUF(,@04)                                   1838 06965000
         ST    @04,COPYVPTR                                        1838 06966000
*     IF COPV=VKY&COPSERNO=VOLKY THEN/* STILL COPY REC?      @Y30LB26*/ 06967000
         CLC   COPV(5,@04),VKY                                     1839 06968000
         BNE   @RF01839                                            1839 06969000
         CLC   COPSERNO(6,@04),VOLKY                               1839 06970000
         BNE   @RF01839                                            1839 06971000
*       DO;                         /*                       @Y30LB26*/ 06972000
*                                                                  1840 06973000
*         /***********************************************************/ 06974000
*         /*                                                         */ 06975000
*         /* IF IT IS A COPY AND A BACKUP, GET BUFFER        @Y30LB26*/ 06976000
*         /* AND RETURN RECORD                               @Y30LB26*/ 06977000
*         /*                                                         */ 06978000
*         /***********************************************************/ 06979000
*                                                                  1841 06980000
*         IF COPBKUP=ON&COPHOLD=OFF THEN/* BACKUP COPY       @Y30LB26*/ 06981000
         TM    COPBKUP(@04),B'00001000'                            1841 06982000
         BNO   @RF01841                                            1841 06983000
         TM    COPHOLD(@04),B'10000000'                            1841 06984000
         BNZ   @RF01841                                            1841 06985000
*           DO;                     /*                       @Y30LB26*/ 06986000
*             CALL GETBUF;          /* GET CORE              @Y30LB26*/ 06987000
         BAL   @14,GETBUF                                          1843 06988000
*             IF RPLVRETC¬=RCZERO THEN/* CK RETURN           @Y30LB26*/ 06989000
         L     @04,RPLVPTR                                         1844 06990000
         CLC   RPLVRETC(2,@04),@CB00747                            1844 06991000
         BNE   @RT01844                                            1844 06992000
*               RETURN;             /*                       @Y30LB26*/ 06993000
*             BUFFER=COPYV;         /* MOVE IN RECORD        @Y30LB26*/ 06994000
         L     @02,RVVAREA(,RVVIPTR)                               1846 06995000
         MVI   BUFFER+164(@02),C' '                                1846 06996000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1846 06997000
         L     @01,COPYVPTR                                        1846 06998000
         MVC   BUFFER(164,@02),COPYV(@01)                          1846 06999000
*             RPLRCODE=RCZERO;      /* GOOD REASON CODE      @Y30LB26*/ 07000000
         MVC   RPLRCODE(2,@04),@CB00747                            1847 07001000
*             RPLVRETC=RCZERO;      /* GOOD RETURN CODE      @Y30LB26*/ 07002000
         MVC   RPLVRETC(2,@04),@CB00747                            1848 07003000
*             RETURN;               /*                       @Y30LB26*/ 07004000
         B     @EL00027                                            1849 07005000
*           END;                    /*                       @Y30LB26*/ 07006000
*                                                                  1850 07007000
*         /***********************************************************/ 07008000
*         /*                                                         */ 07009000
*         /* THIS IS NOT A BACKUP, SO SET UP KEY AND GO      @Y30LB26*/ 07010000
*         /* AND TRY ANOTHER COPY RECORD                     @Y30LB26*/ 07011000
*         /*                                                         */ 07012000
*         /***********************************************************/ 07013000
*                                                                  1851 07014000
*         ELSE                      /*                       @Y30LB26*/ 07015000
*           VKEY=COPNAME;           /* READY NEXT READ       @Y30LB26*/ 07016000
@RF01841 L     @04,COPYVPTR                                        1851 07017000
         MVC   VKEY(13),COPNAME(@04)                               1851 07018000
*       END;                        /*                       @Y30LB26*/ 07019000
*                                                                  1852 07020000
*     /***************************************************************/ 07021000
*     /*                                                             */ 07022000
*     /* NO LONGER COPY RECORDS AND A BACKUP WAS NOT FOUND,  @Y30LB26*/ 07023000
*     /* SO SET REASON CODE INDICATING RECORD WAS NOT        @Y30LB26*/ 07024000
*     /* FOUND AND RETURN                                    @Y30LB26*/ 07025000
*     /*                                                             */ 07026000
*     /***************************************************************/ 07027000
*                                                                  1853 07028000
*     ELSE                          /*                       @Y30LB26*/ 07029000
*       DO;                         /*                       @Y30LB26*/ 07030000
         B     @RC01839                                            1853 07031000
@RF01839 DS    0H                                                  1854 07032000
*         RPLRCODE=NORECRC;         /* NO DUPLICATE          @Y30LB26*/ 07033000
         L     @02,RPLVPTR                                         1854 07034000
         MVC   RPLRCODE(2,@02),@CB00789                            1854 07035000
*         RPLVRETC=FOUR;            /* BAD RETURN CODE       @Y30LB26*/ 07036000
         MVC   RPLVRETC(2,@02),@CB00749                            1855 07037000
*         CALL ERREXIT;             /* SAVE RET CODES        @Y30LB26*/ 07038000
         BAL   @14,ERREXIT                                         1856 07039000
*         RETURN;                   /*                       @Y30LB26*/ 07040000
         B     @EL00027                                            1857 07041000
*       END;                        /*                       @Y30LB26*/ 07042000
*   END;                            /*                       @Y30LB26*/ 07043000
@RC01839 DS    0H                                                  1859 07044000
@DE01822 CLC   I(1),I                                              1859 07045000
         BE    @DL01822                                            1859 07046000
*   END OLDBKUP;                    /*                       @Y30LB26*/ 07047000
         B     @EL00027                                            1860 07048000
*                                                                  1861 07049000
*   /*****************************************************************/ 07050000
*   /*                                                               */ 07051000
*   /* ROUTINE READS AND RETURNS THE LATEST COPY             @Y30LB26*/ 07052000
*   /*                                                               */ 07053000
*   /*****************************************************************/ 07054000
*                                                                  1861 07055000
*LATECPY:                                                          1861 07056000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 07057000
*                                                                  1861 07058000
LATECPY  ST    @14,@SA00028                                        1861 07059000
*   /*****************************************************************/ 07060000
*   /*                                                               */ 07061000
*   /* RESERVE INVENTORY SHARED                              @Y30LB26*/ 07062000
*   /*                                                               */ 07063000
*   /*****************************************************************/ 07064000
*                                                                  1862 07065000
*   CALL RESSHARE;                  /*                       @Y30LB26*/ 07066000
*                                                                  1862 07067000
         BAL   @14,RESSHARE                                        1862 07068000
*   /*****************************************************************/ 07069000
*   /*                                                               */ 07070000
*   /* READ BASE VOLUME RECORD TO GET KEY TO LATEST          @Y30LB26*/ 07071000
*   /* COPY OF VOLUME                                        @Y30LB26*/ 07072000
*   /*                                                               */ 07073000
*   /*****************************************************************/ 07074000
*                                                                  1863 07075000
*   VOLKY=RVVOLUME;                 /* BUILD KEY             @Y30LB26*/ 07076000
         MVC   VOLKY(6),RVVOLUME(RVVIPTR)                          1863 07077000
*   RPLVKEY=ADDR(VKEY);             /* ADDR KEY              @Y30LB26*/ 07078000
         L     @04,RPLVPTR                                         1864 07079000
         LA    @02,VKEY                                            1864 07080000
         ST    @02,RPLVKEY(,@04)                                   1864 07081000
*   RPLVLOC=ON;                     /* LOCATE MODE           @Y30LB26*/ 07082000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 07083000
         OI    RPLVLOC(@04),B'11000000'                            1866 07084000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 07085000
         MVI   RPLVTYP(@04),X'00'                                  1867 07086000
*   RESPECIFY                                                      1868 07087000
*     REG1 RSTD;                    /* RESTRICT REG1         @Y30LB26*/ 07088000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 07089000
         LR    REG1,@04                                            1869 07090000
*   CALL ICBVIO00;                  /* READ BASE REC         @Y30LB26*/ 07091000
         L     @15,@CV00671                                        1870 07092000
         BALR  @14,@15                                             1870 07093000
*   RESPECIFY                                                      1871 07094000
*     REG1 UNRSTD;                  /* FREE REG1             @Y30LB26*/ 07095000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN CODE        @Y30LB26*/ 07096000
         L     @04,RPLVPTR                                         1872 07097000
         CLC   RPLVRETC(2,@04),@CB00747                            1872 07098000
         BE    @RF01872                                            1872 07099000
*     DO;                           /*                       @Y30LB26*/ 07100000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 07101000
         BAL   @14,ERREXIT                                         1874 07102000
*       RETURN;                     /*                       @Y30LB26*/ 07103000
@EL00028 DS    0H                                                  1875 07104000
@EF00028 DS    0H                                                  1875 07105000
@ER00028 L     @14,@SA00028                                        1875 07106000
         BR    @14                                                 1875 07107000
*     END;                          /*                       @Y30LB26*/ 07108000
*                                                                  1876 07109000
*   /*****************************************************************/ 07110000
*   /*                                                               */ 07111000
*   /* SET UP ADDRESSING TO RECORD AND GET LATEST COPY KEY   @Y30LB26*/ 07112000
*   /*                                                               */ 07113000
*   /*****************************************************************/ 07114000
*                                                                  1877 07115000
*   BASEVPTR=RPLVBUF;               /* ADD REC JUST READ     @Y30LB26*/ 07116000
*                                                                  1877 07117000
@RF01872 L     @04,RPLVPTR                                         1877 07118000
         L     @02,RPLVBUF(,@04)                                   1877 07119000
         ST    @02,BASEVPTR                                        1877 07120000
*   /*****************************************************************/ 07121000
*   /*                                                               */ 07122000
*   /* CHECK TO SEE IF THERE REALLY IS A COPY THERE          @Y30LB26*/ 07123000
*   /*                                                               */ 07124000
*   /*****************************************************************/ 07125000
*                                                                  1878 07126000
*   IF BASNCOPY=ZERO THEN           /* NO COPIES ?           @Y30LB26*/ 07127000
         CLI   BASNCOPY(@02),0                                     1878 07128000
         BNE   @RF01878                                            1878 07129000
*     DO;                           /*                       @Y30LB26*/ 07130000
*       RPLVRETC=FOUR;              /* BAD RETURN CODE       @Y30LB26*/ 07131000
         MVC   RPLVRETC(2,@04),@CB00749                            1880 07132000
*       RPLRCODE=NORECRC;           /* RECORD DOES NOT EXIST @Y30LB26*/ 07133000
         MVC   RPLRCODE(2,@04),@CB00789                            1881 07134000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 07135000
         BAL   @14,ERREXIT                                         1882 07136000
*       RETURN;                     /* RETURN TO CALLER      @Y30LB26*/ 07137000
         B     @EL00028                                            1883 07138000
*     END;                          /*                       @Y30LB26*/ 07139000
*   ELSE                            /*                       @Y30LB26*/ 07140000
*     VKEY=BASKLCPY;                /* GET KEY LATEST CPY    @Y30LB26*/ 07141000
@RF01878 L     @04,BASEVPTR                                        1885 07142000
         MVC   VKEY(13),BASKLCPY(@04)                              1885 07143000
*   RPLVKEY=ADDR(VKEY);             /* ADDR KEY              #Y30LB26*/ 07144000
         L     @04,RPLVPTR                                         1886 07145000
         LA    @02,VKEY                                            1886 07146000
         ST    @02,RPLVKEY(,@04)                                   1886 07147000
*   RESPECIFY                                                      1887 07148000
*     REG1 RSTD;                    /* RESTRICT REG1         @Y30LB26*/ 07149000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 07150000
         LR    REG1,@04                                            1888 07151000
*   CALL ICBVIO00;                  /* READ LATEST COPY      @Y30LB26*/ 07152000
         L     @15,@CV00671                                        1889 07153000
         BALR  @14,@15                                             1889 07154000
*   RESPECIFY                                                      1890 07155000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 07156000
*                                                                  1890 07157000
*   /*****************************************************************/ 07158000
*   /*                                                               */ 07159000
*   /* CHECK RETURN CODE FROM I/O PROCESSOR                  @Y30LB26*/ 07160000
*   /*                                                               */ 07161000
*   /*****************************************************************/ 07162000
*                                                                  1891 07163000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN CODE        @Y30LB26*/ 07164000
         L     @04,RPLVPTR                                         1891 07165000
         CLC   RPLVRETC(2,@04),@CB00747                            1891 07166000
         BE    @RF01891                                            1891 07167000
*     DO;                           /*                       @Y30LB26*/ 07168000
*       CALL ERREXIT;               /* SAVE RETURN CODE      @Y30LB26*/ 07169000
         BAL   @14,ERREXIT                                         1893 07170000
*       RETURN;                     /*                       @Y30LB26*/ 07171000
         B     @EL00028                                            1894 07172000
*     END;                          /*                       @Y30LB26*/ 07173000
*                                                                  1895 07174000
*   /*****************************************************************/ 07175000
*   /*                                                               */ 07176000
*   /* SET UP ADDRESSING TO RECORD AND GET BUFFER            @Y30LB26*/ 07177000
*   /* PUT RECORD IN BUFFER AND RETURN                       @Y30LB26*/ 07178000
*   /*                                                               */ 07179000
*   /*****************************************************************/ 07180000
*                                                                  1896 07181000
*   COPYVPTR=RPLVBUF;               /* ADDR RECORD READ      @Y30LB26*/ 07182000
@RF01891 L     @04,RPLVPTR                                         1896 07183000
         L     @04,RPLVBUF(,@04)                                   1896 07184000
         ST    @04,COPYVPTR                                        1896 07185000
*   CALL GETBUF;                    /* GET CORE              @Y30LB26*/ 07186000
         BAL   @14,GETBUF                                          1897 07187000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 07188000
         L     @04,RPLVPTR                                         1898 07189000
         CLC   RPLVRETC(2,@04),@CB00747                            1898 07190000
         BNE   @RT01898                                            1898 07191000
*     RETURN;                       /*                       @Y30LB26*/ 07192000
*   BUFFER=COPYV;                   /* MOVE IN RECORD        @Y30LB26*/ 07193000
         L     @02,RVVAREA(,RVVIPTR)                               1900 07194000
         MVI   BUFFER+164(@02),C' '                                1900 07195000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1900 07196000
         L     @01,COPYVPTR                                        1900 07197000
         MVC   BUFFER(164,@02),COPYV(@01)                          1900 07198000
*   RPLVRETC=RCZERO;                /* GOOD RETURN           @Y30LB26*/ 07199000
         MVC   RPLVRETC(2,@04),@CB00747                            1901 07200000
*   RPLRCODE=RCZERO;                /* GOOD REASON CODE      @Y30LB26*/ 07201000
         MVC   RPLRCODE(2,@04),@CB00747                            1902 07202000
*   RETURN;                         /*                       @Y30LB26*/ 07203000
         B     @EL00028                                            1903 07204000
*   END LATECPY;                    /*                       @Y30LB26*/ 07205000
         B     @EL00028                                            1904 07206000
*                                                                  1905 07207000
*   /*****************************************************************/ 07208000
*   /*                                                               */ 07209000
*   /* THIS ROUTINE READS NEXT FOR A COPY RECORD             @Y30LB26*/ 07210000
*   /* A COPYID MUST BE SPECIFIED FOR THIS OPTION            @Y30LB26*/ 07211000
*   /*                                                               */ 07212000
*   /*****************************************************************/ 07213000
*                                                                  1905 07214000
*COPYNREC:                                                         1905 07215000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 07216000
*                                                                  1905 07217000
COPYNREC ST    @14,@SA00029                                        1905 07218000
*   /*****************************************************************/ 07219000
*   /*                                                               */ 07220000
*   /* INSURE THAT COPYID WAS GIVEN                          @Y30LB26*/ 07221000
*   /* IF NOT GIVEN, SET BAD REASON CODE AND RETURN          @Y30LB26*/ 07222000
*   /*                                                               */ 07223000
*   /*****************************************************************/ 07224000
*                                                                  1906 07225000
*   IF RVVSCPY=OFF THEN             /* COPYID SPECIFIED      @Y30LB26*/ 07226000
         TM    RVVSCPY(RVVIPTR),B'00000100'                        1906 07227000
         BNZ   @RF01906                                            1906 07228000
*     DO;                           /*                       @Y30LB26*/ 07229000
*       RPLVRETC=FOUR;              /* BAD RET CODE          @Y30LB26*/ 07230000
         L     @02,RPLVPTR                                         1908 07231000
         MVC   RPLVRETC(2,@02),@CB00749                            1908 07232000
*       RPLRCODE=NOCPYID;           /* MUST SPEC COPY ID     @Y30LB26*/ 07233000
         MVC   RPLRCODE(2,@02),@CB00815                            1909 07234000
*       RETURN;                     /*                       @Y30LB26*/ 07235000
@EL00029 DS    0H                                                  1910 07236000
@EF00029 DS    0H                                                  1910 07237000
@ER00029 L     @14,@SA00029                                        1910 07238000
         BR    @14                                                 1910 07239000
*     END;                          /*                       @Y30LB26*/ 07240000
*                                                                  1911 07241000
*   /*****************************************************************/ 07242000
*   /*                                                               */ 07243000
*   /* RESERVE INVENTORY DATA SET SHARED                     @Y30LB26*/ 07244000
*   /*                                                               */ 07245000
*   /*****************************************************************/ 07246000
*                                                                  1912 07247000
*   CALL RESSHARE;                  /*                       @Y30LB26*/ 07248000
*                                                                  1912 07249000
@RF01906 BAL   @14,RESSHARE                                        1912 07250000
*   /*****************************************************************/ 07251000
*   /*                                                               */ 07252000
*   /* PUT IN COPYID AND VOLUME NAME IN KEY TO READ          @Y30LB26*/ 07253000
*   /* GREATER THAN OR EQUAL                                 @Y30LB26*/ 07254000
*   /*                                                               */ 07255000
*   /*****************************************************************/ 07256000
*                                                                  1913 07257000
*   VIDKY=RVVCPYID;                 /* ID TO KEY             @Y30LB26*/ 07258000
         MVC   VIDKY(1),RVVCPYID(RVVIPTR)                          1913 07259000
*   VOLKY=RVVOLUME;                 /* VOLUME NAME           @Y30LB26*/ 07260000
*                                                                  1914 07261000
         MVC   VOLKY(6),RVVOLUME(RVVIPTR)                          1914 07262000
*   /*****************************************************************/ 07263000
*   /*                                                               */ 07264000
*   /* LOOP TO FIND THE CORRECT COPY VOLUME RECORD           @ZDR2053*/ 07265000
*   /*                                                               */ 07266000
*   /*****************************************************************/ 07267000
*                                                                  1915 07268000
*   DO WHILE I=I;                   /*                       @ZDR2053*/ 07269000
         B     @DE01915                                            1915 07270000
@DL01915 DS    0H                                                  1916 07271000
*     VIDKY=VIDKY+FIXONE;           /* INCREM ID FIELD       @Y30LB26*/ 07272000
         LA    @04,1                                               1916 07273000
         SLR   @02,@02                                             1916 07274000
         IC    @02,VIDKY                                           1916 07275000
         ALR   @04,@02                                             1916 07276000
         STC   @04,VIDKY                                           1916 07277000
*     RPLVKEY=ADDR(VKEY);           /* ADDR OF KEY           @Y30LB26*/ 07278000
         L     @04,RPLVPTR                                         1917 07279000
         LA    @02,VKEY                                            1917 07280000
         ST    @02,RPLVKEY(,@04)                                   1917 07281000
*     RPLVLOC=ON;                   /* LOCATE MODE           @Y30LB26*/ 07282000
*     RPLVDIR=ON;                   /* READ DIRECT           @Y30LB26*/ 07283000
         OI    RPLVLOC(@04),B'11000000'                            1919 07284000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           @Y30LB26*/ 07285000
         MVI   RPLVTYP(@04),X'00'                                  1920 07286000
*     RPLVKGE=ON;                   /* FOR > OR =            @Y30LB26*/ 07287000
         OI    RPLVKGE(@04),B'00000100'                            1921 07288000
*     RESPECIFY                                                    1922 07289000
*       REG1 RSTD;                  /* RESTRICT REG1         @Y30LB26*/ 07290000
*     REG1=RPLVPTR;                 /* ADDR RPLV             @Y30LB26*/ 07291000
         LR    REG1,@04                                            1923 07292000
*     CALL ICBVIO00;                /* READ COPY             @Y30LB26*/ 07293000
         L     @15,@CV00671                                        1924 07294000
         BALR  @14,@15                                             1924 07295000
*     RESPECIFY                                                    1925 07296000
*       REG1 UNRSTD;                /* FREE REG1             @Y30LB26*/ 07297000
*                                                                  1925 07298000
*     /***************************************************************/ 07299000
*     /*                                                             */ 07300000
*     /* CHECK RETURN CODE FROM I/O PROCESSOR                @Y30LB26*/ 07301000
*     /*                                                             */ 07302000
*     /***************************************************************/ 07303000
*                                                                  1926 07304000
*     IF RPLVRETC¬=RCZERO THEN      /* CK RETURN CODE        @Y30LB26*/ 07305000
         L     @04,RPLVPTR                                         1926 07306000
         CLC   RPLVRETC(2,@04),@CB00747                            1926 07307000
         BE    @RF01926                                            1926 07308000
*       DO;                         /*                       @Y30LB26*/ 07309000
*         CALL ERREXIT;             /* SAVE REASON CODE      @Y30LB26*/ 07310000
         BAL   @14,ERREXIT                                         1928 07311000
*         RETURN;                   /*                       @Y30LB26*/ 07312000
         B     @EL00029                                            1929 07313000
*       END;                        /*                       @Y30LB26*/ 07314000
*                                                                  1930 07315000
*     /***************************************************************/ 07316000
*     /*                                                             */ 07317000
*     /* GET ADDRESS OF RECORD JUST READ AND CHECK TO SEE IF @Y30LB26*/ 07318000
*     /* IT IS STILL A COPY RECORD OF CORRECT VOLUME         @Y30LB26*/ 07319000
*     /*                                                             */ 07320000
*     /***************************************************************/ 07321000
*                                                                  1931 07322000
*     COPYVPTR=RPLVBUF;             /* ADDR RECORD           @Y30LB26*/ 07323000
@RF01926 L     @04,RPLVPTR                                         1931 07324000
         L     @04,RPLVBUF(,@04)                                   1931 07325000
         ST    @04,COPYVPTR                                        1931 07326000
*     IF COPV=VKY&COPSERNO=VOLKY THEN/* STILL                @ZDR2053*/ 07327000
         CLC   COPV(5,@04),VKY                                     1932 07328000
         BNE   @RF01932                                            1932 07329000
         CLC   COPSERNO(6,@04),VOLKY                               1932 07330000
         BNE   @RF01932                                            1932 07331000
*       DO;                         /*                       @ZDR2053*/ 07332000
*                                                                  1933 07333000
*         /***********************************************************/ 07334000
*         /*                                                         */ 07335000
*         /* CHECK FOR THE CORRECT RECORD                    @ZDR2053*/ 07336000
*         /*                                                         */ 07337000
*         /***********************************************************/ 07338000
*                                                                  1934 07339000
*         IF RVVALL=ON|(COPHOLD=ON&RVVCPLHD=ON)|/*           @ZDR2053*/ 07340000
*             (RVVCPLHD=OFF&COPHOLD=OFF) THEN/*              @ZDR2053*/ 07341000
*                                                                  1934 07342000
         TM    RVVALL(RVVIPTR),B'00000001'                         1934 07343000
         BO    @RT01934                                            1934 07344000
         TM    COPHOLD(@04),B'10000000'                            1934 07345000
         BNO   @GL00036                                            1934 07346000
         TM    RVVCPLHD(RVVIPTR),B'00010000'                       1934 07347000
         BO    @RT01934                                            1934 07348000
@GL00036 TM    RVVCPLHD(RVVIPTR),B'00010000'                       1934 07349000
         BNZ   @RF01934                                            1934 07350000
         L     @04,COPYVPTR                                        1934 07351000
         TM    COPHOLD(@04),B'10000000'                            1934 07352000
         BNZ   @RF01934                                            1934 07353000
@RT01934 DS    0H                                                  1935 07354000
*           /*********************************************************/ 07355000
*           /*                                                       */ 07356000
*           /* IF STILL THE CORRECT COPY, GET BUFFER SPACE   @Y30LB26*/ 07357000
*           /* RETURN RECORD                                 @Y30LB26*/ 07358000
*           /*                                                       */ 07359000
*           /*********************************************************/ 07360000
*                                                                  1935 07361000
*           DO;                     /*                       @Y30LB26*/ 07362000
*             CALL GETBUF;          /* GET SPACE             @Y30LB26*/ 07363000
         BAL   @14,GETBUF                                          1936 07364000
*             IF RPLVRETC¬=RCZERO THEN/* CK RETURN           @Y30LB26*/ 07365000
         L     @04,RPLVPTR                                         1937 07366000
         CLC   RPLVRETC(2,@04),@CB00747                            1937 07367000
         BNE   @RT01937                                            1937 07368000
*               RETURN;             /*                       @Y30LB26*/ 07369000
*             BUFFER=COPYV;         /* MOVE IN RECORD        @Y30LB26*/ 07370000
         L     @02,RVVAREA(,RVVIPTR)                               1939 07371000
         MVI   BUFFER+164(@02),C' '                                1939 07372000
         MVC   BUFFER+165(91,@02),BUFFER+164(@02)                  1939 07373000
         L     @01,COPYVPTR                                        1939 07374000
         MVC   BUFFER(164,@02),COPYV(@01)                          1939 07375000
*             RPLVRETC=RCZERO;      /* GOOD RET CODE         @Y30LB26*/ 07376000
         MVC   RPLVRETC(2,@04),@CB00747                            1940 07377000
*             RPLRCODE=RCZERO;      /* GOOD REASON CODE      @Y30LB26*/ 07378000
         MVC   RPLRCODE(2,@04),@CB00747                            1941 07379000
*             RETURN;               /*                       @Y30LB26*/ 07380000
         B     @EL00029                                            1942 07381000
*           END;                    /*                       @Y30LB26*/ 07382000
*         ELSE                      /*                       @Y30LB26*/ 07383000
*                                                                  1944 07384000
*           /*********************************************************/ 07385000
*           /*                                                       */ 07386000
*           /* SET UP TO READ THE NEXT COPY VOLUME RECORD    @ZDR2053*/ 07387000
*           /*                                                       */ 07388000
*           /*********************************************************/ 07389000
*                                                                  1944 07390000
*           VKEY=COPNAME;           /*                       @ZDR2053*/ 07391000
@RF01934 L     @04,COPYVPTR                                        1944 07392000
         MVC   VKEY(13),COPNAME(@04)                               1944 07393000
*       END;                        /*                       @ZDR2053*/ 07394000
*                                                                  1945 07395000
*     /***************************************************************/ 07396000
*     /*                                                             */ 07397000
*     /* BAD RETURN CODE AND INDICATE NO RECORD FOUND        @Y30LB26*/ 07398000
*     /*                                                             */ 07399000
*     /***************************************************************/ 07400000
*                                                                  1946 07401000
*     ELSE                                                         1946 07402000
*       DO;                         /*                       @Y30LB26*/ 07403000
         B     @RC01932                                            1946 07404000
@RF01932 DS    0H                                                  1947 07405000
*         RPLVRETC=FOUR;            /* BAD RETURN            @Y30LB26*/ 07406000
         L     @02,RPLVPTR                                         1947 07407000
         MVC   RPLVRETC(2,@02),@CB00749                            1947 07408000
*         RPLRCODE=NORECRC;         /* NO NEXT COPY          @Y30LB26*/ 07409000
         MVC   RPLRCODE(2,@02),@CB00789                            1948 07410000
*         CALL ERREXIT;             /* SAVE REASON CODE      @Y30LB26*/ 07411000
         BAL   @14,ERREXIT                                         1949 07412000
*         RETURN;                   /*                       @Y30LB26*/ 07413000
         B     @EL00029                                            1950 07414000
*       END;                        /*                       @Y30LB26*/ 07415000
*   END;                            /*                       @ZDR2053*/ 07416000
@RC01932 DS    0H                                                  1952 07417000
@DE01915 CLC   I(1),I                                              1952 07418000
         BE    @DL01915                                            1952 07419000
*   END COPYNREC;                   /*                       @Y30LB26*/ 07420000
         B     @EL00029                                            1953 07421000
*                                                                  1954 07422000
*   /*****************************************************************/ 07423000
*   /*                                                               */ 07424000
*   /* ROUTINE READS FOR A DUPLICATE VOLUME RECORD. IF       @Y30LB26*/ 07425000
*   /* THE FIRST DUP RECORD IS DESIRED, A READ NEXT          @Y30LB26*/ 07426000
*   /* MUST BE SPECIFIED INSTEAD OF A READ DIRECT            @Y30LB26*/ 07427000
*   /*                                                               */ 07428000
*   /*****************************************************************/ 07429000
*                                                                  1954 07430000
*DUPDIR:                                                           1954 07431000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 07432000
*                                                                  1954 07433000
DUPDIR   ST    @14,@SA00030                                        1954 07434000
*   /*****************************************************************/ 07435000
*   /*                                                               */ 07436000
*   /* RESERVE INVENTORY DATA SET SHARED                     @Y30LB26*/ 07437000
*   /*                                                               */ 07438000
*   /*****************************************************************/ 07439000
*                                                                  1955 07440000
*   CALL RESSHARE;                  /*                       @Y30LB26*/ 07441000
*                                                                  1955 07442000
         BAL   @14,RESSHARE                                        1955 07443000
*   /*****************************************************************/ 07444000
*   /*                                                               */ 07445000
*   /* SET KEY ID TO ONE AND READ FOR GREATER                @Y30LB26*/ 07446000
*   /* THAN OR EQUAL                                         @Y30LB26*/ 07447000
*   /*                                                               */ 07448000
*   /*****************************************************************/ 07449000
*                                                                  1956 07450000
*   DVOLKY=RVVOLUME;                /* GET VOLUME            @Y30LB26*/ 07451000
         MVC   DVOLKY(6),RVVOLUME(RVVIPTR)                         1956 07452000
*   DIDKY=FIXONE;                   /* SET ID TO FIRST REG   @Y30LB26*/ 07453000
         MVI   DIDKY,X'01'                                         1957 07454000
*   RPLVKEY=ADDR(DKEY);             /* ADDR LEU              @Y30LB26*/ 07455000
         L     @04,RPLVPTR                                         1958 07456000
         LA    @02,DKEY                                            1958 07457000
         ST    @02,RPLVKEY(,@04)                                   1958 07458000
*   RPLVLOC=ON;                     /* LOCATION MODE         @Y30LB26*/ 07459000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 07460000
         OI    RPLVLOC(@04),B'11000000'                            1960 07461000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 07462000
         MVI   RPLVTYP(@04),X'00'                                  1961 07463000
*   RPLVKGE=ON;                     /* READ > OR =           @Y30LB26*/ 07464000
         OI    RPLVKGE(@04),B'00000100'                            1962 07465000
*   RESPECIFY                                                      1963 07466000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 07467000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 07468000
         LR    REG1,@04                                            1964 07469000
*   CALL ICBVIO00;                  /* READ FOR DUP          @Y30LB26*/ 07470000
         L     @15,@CV00671                                        1965 07471000
         BALR  @14,@15                                             1965 07472000
*   RESPECIFY                                                      1966 07473000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 07474000
*                                                                  1966 07475000
*   /*****************************************************************/ 07476000
*   /*                                                               */ 07477000
*   /* CHECK FOR BAD RETURN CODE FROM I/O PROCESSOR          @Y30LB26*/ 07478000
*   /*                                                               */ 07479000
*   /*****************************************************************/ 07480000
*                                                                  1967 07481000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN CODE        @Y30LB26*/ 07482000
         L     @04,RPLVPTR                                         1967 07483000
         CLC   RPLVRETC(2,@04),@CB00747                            1967 07484000
         BE    @RF01967                                            1967 07485000
*     DO;                           /*                       @Y30LB26*/ 07486000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Y30LB26*/ 07487000
         BAL   @14,ERREXIT                                         1969 07488000
*       RETURN;                     /*                       @Y30LB26*/ 07489000
@EL00030 DS    0H                                                  1970 07490000
@EF00030 DS    0H                                                  1970 07491000
@ER00030 L     @14,@SA00030                                        1970 07492000
         BR    @14                                                 1970 07493000
*     END;                          /*                       @Y30LB26*/ 07494000
*                                                                  1971 07495000
*   /*****************************************************************/ 07496000
*   /*                                                               */ 07497000
*   /* SET UP ADDRESSING TO DUP RECORD JUST READ             @Y30LB26*/ 07498000
*   /*                                                               */ 07499000
*   /*****************************************************************/ 07500000
*                                                                  1972 07501000
*   DUPVPTR=RPLVBUF;                /* ADDR RECORD           @Y30LB26*/ 07502000
*                                                                  1972 07503000
@RF01967 L     @04,RPLVPTR                                         1972 07504000
         L     @04,RPLVBUF(,@04)                                   1972 07505000
         ST    @04,DUPVPTR                                         1972 07506000
*   /*****************************************************************/ 07507000
*   /*                                                               */ 07508000
*   /* IF IT IS THE CORRECT DUPLICATE RECORD, GET A BUFFER   @Y30LB26*/ 07509000
*   /* AND RETURN RECORD                                     @Y30LB26*/ 07510000
*   /*                                                               */ 07511000
*   /*****************************************************************/ 07512000
*                                                                  1973 07513000
*   IF DUPD=DKY&DUPSERNO=DVOLKY THEN/*                       @Y30LB26*/ 07514000
         CLC   DUPD(5,@04),DKY                                     1973 07515000
         BNE   @RF01973                                            1973 07516000
         CLC   DUPSERNO(6,@04),DVOLKY                              1973 07517000
         BNE   @RF01973                                            1973 07518000
*     DO;                           /*                       @Y30LB26*/ 07519000
*       CALL GETBUF;                /* GET SPACE             @Y30LB26*/ 07520000
         BAL   @14,GETBUF                                          1975 07521000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @Y30LB26*/ 07522000
         L     @04,RPLVPTR                                         1976 07523000
         CLC   RPLVRETC(2,@04),@CB00747                            1976 07524000
         BNE   @RT01976                                            1976 07525000
*         RETURN;                   /* RETURN TO CALLER      @Y30LB26*/ 07526000
*       BUFFER=DUPV;                /* MOVE IN REC           @Y30LB26*/ 07527000
         L     @02,RVVAREA(,RVVIPTR)                               1978 07528000
         MVI   BUFFER+65(@02),C' '                                 1978 07529000
         MVC   BUFFER+66(190,@02),BUFFER+65(@02)                   1978 07530000
         L     @01,DUPVPTR                                         1978 07531000
         MVC   BUFFER(65,@02),DUPV(@01)                            1978 07532000
*       RPLVRETC=RCZERO;            /* GOOD RETURN CODE      @Y30LB26*/ 07533000
         MVC   RPLVRETC(2,@04),@CB00747                            1979 07534000
*       RPLRCODE=RCZERO;            /* GOOD REASON CODE      @Y30LB26*/ 07535000
         MVC   RPLRCODE(2,@04),@CB00747                            1980 07536000
*       RETURN;                     /*                       @Y30LB26*/ 07537000
         B     @EL00030                                            1981 07538000
*     END;                          /*                       @Y30LB26*/ 07539000
*   ELSE                            /*                       @Y30LB26*/ 07540000
*                                                                  1983 07541000
*     /***************************************************************/ 07542000
*     /*                                                             */ 07543000
*     /* IF NO LONGER A DUP RECORD OF THE CORRECT VOLUME     @Y30LB26*/ 07544000
*     /* SET BAD RETURN CODE AND INDICATE RECORD NOT FOUND   @Y30LB26*/ 07545000
*     /*                                                             */ 07546000
*     /***************************************************************/ 07547000
*                                                                  1983 07548000
*     DO;                           /*                       @Y30LB26*/ 07549000
@RF01973 DS    0H                                                  1984 07550000
*       RPLVRETC=FOUR;              /* BAD RC                @Y30LB26*/ 07551000
         L     @02,RPLVPTR                                         1984 07552000
         MVC   RPLVRETC(2,@02),@CB00749                            1984 07553000
*       RPLRCODE=NORECRC;           /* RECORD NOT FOUND      @Y30LB26*/ 07554000
         MVC   RPLRCODE(2,@02),@CB00789                            1985 07555000
*       CALL ERREXIT;               /*                       @Y30LB26*/ 07556000
         BAL   @14,ERREXIT                                         1986 07557000
*       RETURN;                     /*                       @Y30LB26*/ 07558000
         B     @EL00030                                            1987 07559000
*     END;                          /*                       @Y30LB26*/ 07560000
*   END DUPDIR;                     /*                       @Y30LB26*/ 07561000
         B     @EL00030                                            1989 07562000
*                                                                  1990 07563000
*   /*****************************************************************/ 07564000
*   /*                                                               */ 07565000
*   /* ROUTINE READ NEXT FOR DUPLICATE VOL RECORD            @Y30LB26*/ 07566000
*   /* IF NO VOLID IS GIVEN, IT WILL READ THE FIRST          @Y30LB26*/ 07567000
*   /* DUPLICATE RECORD IN THE DATA SET                      @Y30LB26*/ 07568000
*   /*                                                               */ 07569000
*   /*****************************************************************/ 07570000
*                                                                  1990 07571000
*DUPNREC:                                                          1990 07572000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 07573000
*                                                                  1990 07574000
DUPNREC  ST    @14,@SA00031                                        1990 07575000
*   /*****************************************************************/ 07576000
*   /*                                                               */ 07577000
*   /* RESERVE INVENTORY SHARED                              @Y30LB26*/ 07578000
*   /*                                                               */ 07579000
*   /*****************************************************************/ 07580000
*                                                                  1991 07581000
*   CALL RESSHARE;                  /*                       @Y30LB26*/ 07582000
         BAL   @14,RESSHARE                                        1991 07583000
*   IF RVVSVOL=OFF THEN             /* VOLID SPECIFIED       @Y30LB26*/ 07584000
         TM    RVVSVOL(RVVIPTR),B'00000001'                        1992 07585000
         BNZ   @RF01992                                            1992 07586000
*     DO;                           /*                       @Y30LB26*/ 07587000
*       DVOLKY=ZEROCHAR;            /* ZERO VOLID            @Y30LB26*/ 07588000
         MVC   DVOLKY(6),ZEROCHAR                                  1994 07589000
*       DIDKY=DIDKY+FIXONE;         /* SET ID FIELD          @Y30LB26*/ 07590000
         LA    @04,1                                               1995 07591000
         SLR   @02,@02                                             1995 07592000
         IC    @02,DIDKY                                           1995 07593000
         ALR   @04,@02                                             1995 07594000
         STC   @04,DIDKY                                           1995 07595000
*     END;                          /*                       @Y30LB26*/ 07596000
*   ELSE                            /*                       @Y30LB26*/ 07597000
*     DO;                           /*                       @Y30LB26*/ 07598000
         B     @RC01992                                            1997 07599000
@RF01992 DS    0H                                                  1998 07600000
*       IF RVVSDUP=OFF THEN         /* DUP ID NOT SPEC       @Y30LB26*/ 07601000
         TM    RVVSDUP(RVVIPTR),B'00000010'                        1998 07602000
         BNZ   @RF01998                                            1998 07603000
*         DO;                       /*                       @Y30LB26*/ 07604000
*           RPLVRETC=FOUR;          /* BAD RETURN CODE       @Y30LB26*/ 07605000
         L     @02,RPLVPTR                                         2000 07606000
         MVC   RPLVRETC(2,@02),@CB00749                            2000 07607000
*           RPLRCODE=NODUPID;       /* DUP ID NOT GIVEN      @Y30LB26*/ 07608000
         MVC   RPLRCODE(2,@02),@CB00811                            2001 07609000
*           CALL ERREXIT;           /* SAVE RET CODES        @Y30LB26*/ 07610000
         BAL   @14,ERREXIT                                         2002 07611000
*           RETURN;                 /*                       @Y30LB26*/ 07612000
@EL00031 DS    0H                                                  2003 07613000
@EF00031 DS    0H                                                  2003 07614000
@ER00031 L     @14,@SA00031                                        2003 07615000
         BR    @14                                                 2003 07616000
*         END;                      /*                       @Y30LB26*/ 07617000
*       DVOLKY=RVVOLUME;            /* GET VOLID             @Y30LB26*/ 07618000
@RF01998 MVC   DVOLKY(6),RVVOLUME(RVVIPTR)                         2005 07619000
*       DIDKY=RVVDUPID;             /* GET FIRST ID          @Y30LB26*/ 07620000
         SLR   @04,@04                                             2006 07621000
         IC    @04,RVVDUPID(,RVVIPTR)                              2006 07622000
         STC   @04,DIDKY                                           2006 07623000
*       DIDKY=DIDKY+FIXONE;         /* GET TO NEXT           @Y30LB26*/ 07624000
         AL    @04,@CF00041                                        2007 07625000
         STC   @04,DIDKY                                           2007 07626000
*     END;                          /*                       @Y30LB26*/ 07627000
*   RPLVKEY=ADDR(DKEY);             /* ADDR KEY              @Y30LB26*/ 07628000
@RC01992 L     @04,RPLVPTR                                         2009 07629000
         LA    @02,DKEY                                            2009 07630000
         ST    @02,RPLVKEY(,@04)                                   2009 07631000
*   RPLVLOC=ON;                     /* LOCATE MODE           @Y30LB26*/ 07632000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 07633000
         OI    RPLVLOC(@04),B'11000000'                            2011 07634000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 07635000
         MVI   RPLVTYP(@04),X'00'                                  2012 07636000
*   RPLVKGE=ON;                     /* READ > OR =           @Y30LB26*/ 07637000
         OI    RPLVKGE(@04),B'00000100'                            2013 07638000
*   RESPECIFY                                                      2014 07639000
*     REG1 RSTD;                    /* RESTRICT REG1         @Y30LB26*/ 07640000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 07641000
         LR    REG1,@04                                            2015 07642000
*   CALL ICBVIO00;                  /* READ DUP RECORD       @Y30LB26*/ 07643000
         L     @15,@CV00671                                        2016 07644000
         BALR  @14,@15                                             2016 07645000
*   RESPECIFY                                                      2017 07646000
*     REG1 UNRSTD;                  /* FREE REG1             @Y30LB26*/ 07647000
*                                                                  2017 07648000
*   /*****************************************************************/ 07649000
*   /*                                                               */ 07650000
*   /* CHECK RETURN CODE FROM I/O PROCESSOR                  @Y30LB26*/ 07651000
*   /*                                                               */ 07652000
*   /*****************************************************************/ 07653000
*                                                                  2018 07654000
*   IF RPLVRETC¬=RCZERO THEN        /*                       @Y30LB26*/ 07655000
         L     @04,RPLVPTR                                         2018 07656000
         CLC   RPLVRETC(2,@04),@CB00747                            2018 07657000
         BE    @RF02018                                            2018 07658000
*     DO;                           /*                       @Y30LB26*/ 07659000
*       CALL ERREXIT;               /*                       @Y30LB26*/ 07660000
         BAL   @14,ERREXIT                                         2020 07661000
*       RETURN;                     /*                       @Y30LB26*/ 07662000
         B     @EL00031                                            2021 07663000
*     END;                          /*                       @Y30LB26*/ 07664000
*                                                                  2022 07665000
*   /*****************************************************************/ 07666000
*   /*                                                               */ 07667000
*   /* SET UP ADDRESSING TO RECORD JUST READ                 @Y30LB26*/ 07668000
*   /*                                                               */ 07669000
*   /*****************************************************************/ 07670000
*                                                                  2023 07671000
*   DUPVPTR=RPLVBUF;                /* ADDR RECORD           @Y30LB26*/ 07672000
*                                                                  2023 07673000
@RF02018 L     @04,RPLVPTR                                         2023 07674000
         L     @04,RPLVBUF(,@04)                                   2023 07675000
         ST    @04,DUPVPTR                                         2023 07676000
*   /*****************************************************************/ 07677000
*   /*                                                               */ 07678000
*   /* SEE IF ONLY RECORD OF SPECIFIED VOLID IS              @Y30LB26*/ 07679000
*   /* TO BE RETURNED                                        @Y30LB26*/ 07680000
*   /*                                                               */ 07681000
*   /*****************************************************************/ 07682000
*                                                                  2024 07683000
*   IF RVVDVOL=ON THEN              /* READ ONLY SPEC VOL    @Y30LB26*/ 07684000
         TM    RVVDVOL(RVVIPTR),B'00000010'                        2024 07685000
         BNO   @RF02024                                            2024 07686000
*     DO;                           /*                       @Y30LB26*/ 07687000
*                                                                  2025 07688000
*       /*************************************************************/ 07689000
*       /*                                                           */ 07690000
*       /* CHECK TO SEE IF STILL DUP AND OF CORRECT VOLUME   @Y30LB26*/ 07691000
*       /*                                                           */ 07692000
*       /*************************************************************/ 07693000
*                                                                  2026 07694000
*       IF DUPD=DKY&DUPSERNO=DVOLKY THEN/* DUP RECORD        @Y30LB26*/ 07695000
         CLC   DUPD(5,@04),DKY                                     2026 07696000
         BNE   @RF02026                                            2026 07697000
         CLC   DUPSERNO(6,@04),DVOLKY                              2026 07698000
         BNE   @RF02026                                            2026 07699000
*         DO;                       /*                       @Y30LB26*/ 07700000
*                                                                  2027 07701000
*           /*********************************************************/ 07702000
*           /*                                                       */ 07703000
*           /* IF RECORD MEETS TEST, GET BUFFER              @Y30LB26*/ 07704000
*           /* AND RETURN RECORD                             @Y30LB26*/ 07705000
*           /*                                                       */ 07706000
*           /*********************************************************/ 07707000
*                                                                  2028 07708000
*           CALL GETBUF;            /* GET CORE              @Y30LB26*/ 07709000
         BAL   @14,GETBUF                                          2028 07710000
*           IF RPLVRETC¬=RCZERO THEN/* CK RETURN             @Y30LB26*/ 07711000
         L     @04,RPLVPTR                                         2029 07712000
         CLC   RPLVRETC(2,@04),@CB00747                            2029 07713000
         BNE   @RT02029                                            2029 07714000
*             RETURN;               /*                       @Y30LB26*/ 07715000
*           BUFFER=DUPV;            /* MOVE IN RECORD        @Y30LB26*/ 07716000
         L     @02,RVVAREA(,RVVIPTR)                               2031 07717000
         MVI   BUFFER+65(@02),C' '                                 2031 07718000
         MVC   BUFFER+66(190,@02),BUFFER+65(@02)                   2031 07719000
         L     @01,DUPVPTR                                         2031 07720000
         MVC   BUFFER(65,@02),DUPV(@01)                            2031 07721000
*           RPLVRETC=RCZERO;        /* GOOD RETURN CODE      @Y30LB26*/ 07722000
         MVC   RPLVRETC(2,@04),@CB00747                            2032 07723000
*           RPLRCODE=RCZERO;        /* GOOD REASON CODE      @Y30LB26*/ 07724000
         MVC   RPLRCODE(2,@04),@CB00747                            2033 07725000
*           RETURN;                 /*                       @Y30LB26*/ 07726000
         B     @EL00031                                            2034 07727000
*         END;                      /*                       @Y30LB26*/ 07728000
*       ELSE                        /*                       @Y30LB26*/ 07729000
*                                                                  2036 07730000
*         /***********************************************************/ 07731000
*         /*                                                         */ 07732000
*         /* IF NOT CORRECT RECORD, SET BAD RETURN CODE      @Y30LB26*/ 07733000
*         /* AND INDICATE RECORD NOT FOUND                   @Y30LB26*/ 07734000
*         /*                                                         */ 07735000
*         /***********************************************************/ 07736000
*                                                                  2036 07737000
*         DO;                       /*                       @Y30LB26*/ 07738000
@RF02026 DS    0H                                                  2037 07739000
*           RPLVRETC=FOUR;          /* BAD RC                @Y30LB26*/ 07740000
         L     @02,RPLVPTR                                         2037 07741000
         MVC   RPLVRETC(2,@02),@CB00749                            2037 07742000
*           RPLRCODE=NORECRC;       /* RECORD NOT FOUND      @Y30LB26*/ 07743000
         MVC   RPLRCODE(2,@02),@CB00789                            2038 07744000
*           CALL ERREXIT;           /* SAVE RETURN CODE      @Y30LB26*/ 07745000
         BAL   @14,ERREXIT                                         2039 07746000
*           RETURN;                 /*                       @Y30LB26*/ 07747000
         B     @EL00031                                            2040 07748000
*         END;                      /*                       @Y30LB26*/ 07749000
*     END;                          /*                       @Y30LB26*/ 07750000
*   ELSE                            /*                       @Y30LB26*/ 07751000
*                                                                  2043 07752000
*     /***************************************************************/ 07753000
*     /*                                                             */ 07754000
*     /* IF NOT READING FOR A SPECIFIC VOLUME                @Y30LB26*/ 07755000
*     /* JUST CHECK TO SEE IF IT IS A DUPLICATE              @Y30LB26*/ 07756000
*     /* RECORD AND IF IT IS, GET BUFFER SPACE               @Y30LB26*/ 07757000
*     /* AND RETURN RECORD                                   @Y30LB26*/ 07758000
*     /*                                                             */ 07759000
*     /***************************************************************/ 07760000
*                                                                  2043 07761000
*     DO;                           /*                       @Y30LB26*/ 07762000
@RF02024 DS    0H                                                  2044 07763000
*       IF DUPD=DKY THEN            /* IS DUP REC            @Y30LB26*/ 07764000
         L     @04,DUPVPTR                                         2044 07765000
         CLC   DUPD(5,@04),DKY                                     2044 07766000
         BNE   @RF02044                                            2044 07767000
*         DO;                       /*                       @Y30LB26*/ 07768000
*           CALL GETBUF;            /* GET CORE              @Y30LB26*/ 07769000
         BAL   @14,GETBUF                                          2046 07770000
*           IF RPLVRETC¬=RCZERO THEN/* CK RETURN             @Y30LB26*/ 07771000
         L     @04,RPLVPTR                                         2047 07772000
         CLC   RPLVRETC(2,@04),@CB00747                            2047 07773000
         BNE   @RT02047                                            2047 07774000
*             RETURN;               /*                       @Y30LB26*/ 07775000
*           BUFFER=DUPV;            /* MOVE IN RECORD        @Y30LB26*/ 07776000
         L     @02,RVVAREA(,RVVIPTR)                               2049 07777000
         MVI   BUFFER+65(@02),C' '                                 2049 07778000
         MVC   BUFFER+66(190,@02),BUFFER+65(@02)                   2049 07779000
         L     @01,DUPVPTR                                         2049 07780000
         MVC   BUFFER(65,@02),DUPV(@01)                            2049 07781000
*           RPLVRETC=RCZERO;        /* GOOD RETURN CODE      @Y30LB26*/ 07782000
         MVC   RPLVRETC(2,@04),@CB00747                            2050 07783000
*           RPLRCODE=RCZERO;        /* GOOD REASON CODE      @Y30LB26*/ 07784000
         MVC   RPLRCODE(2,@04),@CB00747                            2051 07785000
*           RETURN;                 /*                       @Y30LB26*/ 07786000
         B     @EL00031                                            2052 07787000
*         END;                      /*                       @Y30LB26*/ 07788000
*       ELSE                        /*                       @Y30LB26*/ 07789000
*                                                                  2054 07790000
*         /***********************************************************/ 07791000
*         /*                                                         */ 07792000
*         /* IF IT IS NOT EVEN A DUPLICATE RECORD            @Y30LB26*/ 07793000
*         /* SET BAD RETURN CODE AND INDICATE RECORD         @Y30LB26*/ 07794000
*         /* NOT FOUND                                       @Y30LB26*/ 07795000
*         /*                                                         */ 07796000
*         /***********************************************************/ 07797000
*                                                                  2054 07798000
*         DO;                       /*                       @Y30LB26*/ 07799000
@RF02044 DS    0H                                                  2055 07800000
*           RPLVRETC=FOUR;          /* BAD RC                @Y30LB26*/ 07801000
         L     @02,RPLVPTR                                         2055 07802000
         MVC   RPLVRETC(2,@02),@CB00749                            2055 07803000
*           RPLRCODE=NORECRC;       /* RECORD NOT FOUND      @Y30LB26*/ 07804000
         MVC   RPLRCODE(2,@02),@CB00789                            2056 07805000
*           CALL ERREXIT;           /* SAVE RETURN CODE      @Y30LB26*/ 07806000
         BAL   @14,ERREXIT                                         2057 07807000
*           RETURN;                 /*                       @Y30LB26*/ 07808000
         B     @EL00031                                            2058 07809000
*         END;                      /*                       @Y30LB26*/ 07810000
*     END;                          /*                       @Y30LB26*/ 07811000
*   END DUPNREC;                    /*                       @Y30LB26*/ 07812000
         B     @EL00031                                            2061 07813000
*                                                                  2062 07814000
*   /*****************************************************************/ 07815000
*   /*                                                               */ 07816000
*   /* ROUTINE READS A CARTRIDGE INDEX RECORD AND            @Y30LB26*/ 07817000
*   /* THEN READS THE VOLUME RECORD ASSOCIATED WITH          @Y30LB26*/ 07818000
*   /* IT THEN MAKES A CHECK TO SEE IF THE VOLUME RECORD     @Y30LB26*/ 07819000
*   /* ALSO INDICATES IT BELONGS TO THAT CARTRIDGE IF THAT   @Y30LB26*/ 07820000
*   /* CHECK IS ASKED FOR                                    @Y30LB26*/ 07821000
*   /*                                                               */ 07822000
*   /*****************************************************************/ 07823000
*                                                                  2062 07824000
*CARTDIR:                                                          2062 07825000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB66*/ 07826000
*                                                                  2062 07827000
CARTDIR  ST    @14,@SA00032                                        2062 07828000
*   /*****************************************************************/ 07829000
*   /*                                                               */ 07830000
*   /* RESERVE INVENTORY DATA SET SHARED                     @Y30LB26*/ 07831000
*   /*                                                               */ 07832000
*   /*****************************************************************/ 07833000
*                                                                  2063 07834000
*   CALL RESSHARE;                  /*                       @Y30LB26*/ 07835000
*                                                                  2063 07836000
         BAL   @14,RESSHARE                                        2063 07837000
*   /*****************************************************************/ 07838000
*   /*                                                               */ 07839000
*   /* SET UP KEY AND READ DIRECT FOR INDEX RECORD           @Y30LB26*/ 07840000
*   /*                                                               */ 07841000
*   /*****************************************************************/ 07842000
*                                                                  2064 07843000
*   CARTKY=RVVRDCSN;                /* GET CART INDEX        @Y30LB26*/ 07844000
         MVC   CARTKY(12),RVVRDCSN(RVVIPTR)                        2064 07845000
*   RPLVKEY=ADDR(IKEY);             /* ADDR KEY              @Y30LB26*/ 07846000
         L     @04,RPLVPTR                                         2065 07847000
         LA    @02,IKEY                                            2065 07848000
         ST    @02,RPLVKEY(,@04)                                   2065 07849000
*   RPLVLOC=ON;                     /* LOCATE MODE           @Y30LB26*/ 07850000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 07851000
         OI    RPLVLOC(@04),B'11000000'                            2067 07852000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 07853000
         MVI   RPLVTYP(@04),X'00'                                  2068 07854000
*   RESPECIFY                                                      2069 07855000
*     REG1 RSTD;                    /* RESTRICT REG1         @Y30LB26*/ 07856000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 07857000
         LR    REG1,@04                                            2070 07858000
*   CALL ICBVIO00;                  /* READ CART INDEX REC   @Y30LB26*/ 07859000
         L     @15,@CV00671                                        2071 07860000
         BALR  @14,@15                                             2071 07861000
*   RESPECIFY                                                      2072 07862000
*     REG1 UNRSTD;                  /* FREE REG1             @Y30LB26*/ 07863000
*   IF RPLVRETC¬=RCZERO THEN        /* CK REASON CODE        @Y30LB26*/ 07864000
         L     @04,RPLVPTR                                         2073 07865000
         CLC   RPLVRETC(2,@04),@CB00747                            2073 07866000
         BE    @RF02073                                            2073 07867000
*     DO;                           /*                       @Y30LB26*/ 07868000
*       CALL ERREXIT;               /* SAVE REASON CODES     @Y30LB26*/ 07869000
         BAL   @14,ERREXIT                                         2075 07870000
*       RETURN;                     /*                       @Y30LB26*/ 07871000
@EL00032 DS    0H                                                  2076 07872000
@EF00032 DS    0H                                                  2076 07873000
@ER00032 L     @14,@SA00032                                        2076 07874000
         BR    @14                                                 2076 07875000
*     END;                          /*                       @Y30LB26*/ 07876000
*                                                                  2077 07877000
*   /*****************************************************************/ 07878000
*   /*                                                               */ 07879000
*   /* SAVE CONTENTS OF RECORD JUST READ AND SEE IF          @Z40LB66*/ 07880000
*   /* A VOLID WAS SPECIFIED                                 @Y30LB26*/ 07881000
*   /*                                                               */ 07882000
*   /*****************************************************************/ 07883000
*                                                                  2078 07884000
*   INDEXPTR=RPLVBUF;               /* ADDR RECORD           @Z40LB66*/ 07885000
@RF02073 L     @04,RPLVPTR                                         2078 07886000
         L     INDEXPTR,RPLVBUF(,@04)                              2078 07887000
*   STORINDX=INDEX;                 /* SAVE RECORD           @Z40LB66*/ 07888000
         MVI   STORINDX+36,C' '                                    2079 07889000
         MVC   STORINDX+37(187),STORINDX+36                        2079 07890000
         MVC   STORINDX(36),INDEX(INDEXPTR)                        2079 07891000
*   INDEXPTR=ADDR(STORINDX);        /* RESET BASE            @Z40LB66*/ 07892000
         LA    INDEXPTR,STORINDX                                   2080 07893000
*   IF RVVSVOL=ON THEN              /* VOLUME SPECIFIED      @Y30LB26*/ 07894000
*                                                                  2081 07895000
         TM    RVVSVOL(RVVIPTR),B'00000001'                        2081 07896000
         BNO   @RF02081                                            2081 07897000
*     /***************************************************************/ 07898000
*     /*                                                             */ 07899000
*     /* COMPARE VOLID FROM INDEX RECORD WITH THE            @Z40LB66*/ 07900000
*     /* VOLID GIVEN IN REQUEST BLOCK                        @Z40LB66*/ 07901000
*     /*                                                             */ 07902000
*     /***************************************************************/ 07903000
*                                                                  2082 07904000
*     DO;                           /*                       @Y30LB26*/ 07905000
*       IF INDVSRNO=RVVOLUME THEN   /* VOLUME MATCH          @Z40LB66*/ 07906000
*                                                                  2083 07907000
         CLC   INDVSRNO(6,INDEXPTR),RVVOLUME(RVVIPTR)              2083 07908000
         BNE   @RF02083                                            2083 07909000
*         /***********************************************************/ 07910000
*         /*                                                         */ 07911000
*         /* IF EVERYTHING MATCHES, GO READ AND RETURN REC   @Y30LB26*/ 07912000
*         /*                                                         */ 07913000
*         /***********************************************************/ 07914000
*                                                                  2084 07915000
*         DO;                       /*                       @Y30LB26*/ 07916000
*           CALL READVOL;           /* READ VOLUME RECORD    @Y30LB26*/ 07917000
         BAL   @14,READVOL                                         2085 07918000
*           RETURN;                 /*                       @Y30LB26*/ 07919000
         B     @EL00032                                            2086 07920000
*         END;                      /*                       @Y30LB26*/ 07921000
*       ELSE                        /*                       @Y30LB26*/ 07922000
*                                                                  2088 07923000
*         /***********************************************************/ 07924000
*         /*                                                         */ 07925000
*         /* IF CHECK CALLED FOR BUT NO MATCH THEN SET BAD   @Y30LB26*/ 07926000
*         /* RET CODE AND INDICATE RECORD NOT FOUND          @Y30LB26*/ 07927000
*         /*                                                         */ 07928000
*         /***********************************************************/ 07929000
*                                                                  2088 07930000
*         DO;                       /*                       @Y30LB26*/ 07931000
@RF02083 DS    0H                                                  2089 07932000
*           RPLVRETC=FOUR;          /*                       @Y30LB26*/ 07933000
         L     @02,RPLVPTR                                         2089 07934000
         MVC   RPLVRETC(2,@02),@CB00749                            2089 07935000
*           RPLRCODE=NOMATCH;       /*                       @Y30LB26*/ 07936000
         MVC   RPLRCODE(2,@02),@CB00807                            2090 07937000
*           CALL ERREXIT;           /*                       @Y30LB26*/ 07938000
         BAL   @14,ERREXIT                                         2091 07939000
*           RETURN;                 /*                       @Y30LB26*/ 07940000
         B     @EL00032                                            2092 07941000
*         END;                      /*                       @Y30LB26*/ 07942000
*     END;                          /*                       @Y30LB26*/ 07943000
*   ELSE                            /*                       @Y30LB26*/ 07944000
*                                                                  2095 07945000
*     /***************************************************************/ 07946000
*     /*                                                             */ 07947000
*     /* IF NO TEST CALLED FOR JUST GO READ                  @Y30LB26*/ 07948000
*     /* RECORD AND RETURN IT                                @Y30LB26*/ 07949000
*     /*                                                             */ 07950000
*     /***************************************************************/ 07951000
*                                                                  2095 07952000
*     DO;                           /*                       @Y30LB26*/ 07953000
@RF02081 DS    0H                                                  2096 07954000
*       CALL READVOL;               /* READ VOLUME           @Y30LB26*/ 07955000
         BAL   @14,READVOL                                         2096 07956000
*       RETURN;                     /*                       @Y30LB26*/ 07957000
         B     @EL00032                                            2097 07958000
*     END;                          /*                       @Y30LB26*/ 07959000
*   END CARTDIR;                    /*                       @Z40LB66*/ 07960000
*                                                                  2100 07961000
*   /*****************************************************************/ 07962000
*   /*                                                               */ 07963000
*   /* THIS ROUTINE READS THE NEXT CARTRIDGE                 @Z40LB66*/ 07964000
*   /* INDEX RECORD AND ITS ASSOCIATED VOLUME RECORD         @Z40LB66*/ 07965000
*   /*                                                               */ 07966000
*   /*****************************************************************/ 07967000
*                                                                  2100 07968000
*CARTNREC:                                                         2100 07969000
*   PROC OPTIONS(SAVE(REG14));      /*                       @Z40LB66*/ 07970000
*                                                                  2100 07971000
CARTNREC ST    @14,@SA00033                                        2100 07972000
*   /*****************************************************************/ 07973000
*   /*                                                               */ 07974000
*   /* GO RESERVE INVENTORY DATA SET SHARED                  @Z40LB66*/ 07975000
*   /*                                                               */ 07976000
*   /*****************************************************************/ 07977000
*                                                                  2101 07978000
*   CALL RESSHARE;                  /*                       @Z40LB66*/ 07979000
*                                                                  2101 07980000
         BAL   @14,RESSHARE                                        2101 07981000
*   /*****************************************************************/ 07982000
*   /*                                                               */ 07983000
*   /* DETERMINE IF READING FOR FIRST CARTRIDGE INDEX        @Z40LB66*/ 07984000
*   /* RECORD. IF SO, SET CSN TO ZERO AND PROCESS LIKE       @Z40LB66*/ 07985000
*   /* A REGULAR READ NEXT                                   @Z40LB66*/ 07986000
*   /*                                                               */ 07987000
*   /*****************************************************************/ 07988000
*                                                                  2102 07989000
*   IF RVVSCSN=OFF THEN             /* CSN SPECIFIED ?       @Z40LB66*/ 07990000
         TM    RVVSCSN(RVVIPTR),B'00001000'                        2102 07991000
         BNZ   @RF02102                                            2102 07992000
*     CARTKY=ZEROCHAR;              /*                       @Z40LB66*/ 07993000
         MVC   CARTKY(12),ZEROCHAR                                 2103 07994000
*   ELSE                            /*                       @Z40LB66*/ 07995000
*     DO;                           /*                       @Z40LB66*/ 07996000
*                                                                  2104 07997000
         B     @RC02102                                            2104 07998000
@RF02102 DS    0H                                                  2105 07999000
*       /*************************************************************/ 08000000
*       /*                                                           */ 08001000
*       /* INCREMENT THE KEY BY ONE TO OBTAIN THE            @Z40LB66*/ 08002000
*       /* NEXT HIGHER KEY                                   @Z40LB66*/ 08003000
*       /*                                                           */ 08004000
*       /*************************************************************/ 08005000
*                                                                  2105 08006000
*       CARTKY=RVVRDCSN;            /* CSN TO READ BEYOND    @Z40LB66*/ 08007000
         MVC   CARTKY(12),RVVRDCSN(RVVIPTR)                        2105 08008000
*       ARITHCTG=CARTKY(12);        /* GET LAST DIGIT        @Z40LB66*/ 08009000
         MVC   ARITHCTG(1),CARTKY+11                               2106 08010000
*       CARTID=CARTID+1;            /* INCREMENT IT          @Z40LB66*/ 08011000
         LA    @04,1                                               2107 08012000
         SLR   @02,@02                                             2107 08013000
         IC    @02,CARTID                                          2107 08014000
         ALR   @04,@02                                             2107 08015000
         STC   @04,CARTID                                          2107 08016000
*       CARTKY(12)=ARITHCTG;        /* RESTORE TO KEY        @Z40LB66*/ 08017000
         MVC   CARTKY+11(1),ARITHCTG                               2108 08018000
*     END;                          /*                       @Z40LB66*/ 08019000
*                                                                  2109 08020000
*   /*****************************************************************/ 08021000
*   /*                                                               */ 08022000
*   /* SET UP TO READ CARTRIDGE RECORD                       @Z40LB66*/ 08023000
*   /*                                                               */ 08024000
*   /*****************************************************************/ 08025000
*                                                                  2110 08026000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           @Z40LB66*/ 08027000
@RC02102 L     @04,RPLVPTR                                         2110 08028000
         LA    @02,IKEY                                            2110 08029000
         ST    @02,RPLVKEY(,@04)                                   2110 08030000
*   RPLVLOC=ON;                     /* LOCATE MODE           @Z40LB66*/ 08031000
*   RPLVDIR=ON;                     /* READ DIRECT           @Z40LB66*/ 08032000
         OI    RPLVLOC(@04),B'11000000'                            2112 08033000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Z40LB66*/ 08034000
         MVI   RPLVTYP(@04),X'00'                                  2113 08035000
*   RPLVKGE=ON;                     /* READ >=               @Z40LB66*/ 08036000
         OI    RPLVKGE(@04),B'00000100'                            2114 08037000
*   RESPECIFY                                                      2115 08038000
*     REG1 RSTD;                    /*                       @Z40LB66*/ 08039000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Z40LB66*/ 08040000
         LR    REG1,@04                                            2116 08041000
*   CALL ICBVIO00;                  /* READ NEXT CARTRIDGE   @Z40LB66*/ 08042000
         L     @15,@CV00671                                        2117 08043000
         BALR  @14,@15                                             2117 08044000
*   RESPECIFY                                                      2118 08045000
*     REG1 UNRSTD;                  /*                       @Z40LB66*/ 08046000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN CODE     @Z40LB66*/ 08047000
         L     @04,RPLVPTR                                         2119 08048000
         CLC   RPLVRETC(2,@04),@CB00747                            2119 08049000
         BE    @RF02119                                            2119 08050000
*     DO;                           /*                       @Z40LB66*/ 08051000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Z40LB66*/ 08052000
         BAL   @14,ERREXIT                                         2121 08053000
*       RETURN;                     /*                       @Z40LB66*/ 08054000
@EL00033 DS    0H                                                  2122 08055000
@EF00033 DS    0H                                                  2122 08056000
@ER00033 L     @14,@SA00033                                        2122 08057000
         BR    @14                                                 2122 08058000
*     END;                          /*                       @Z40LB66*/ 08059000
*                                                                  2123 08060000
*   /*****************************************************************/ 08061000
*   /*                                                               */ 08062000
*   /* IF THIS IS NOT A CARTRIDGE RECORD, RETURN RECORD      @Z40LB66*/ 08063000
*   /* NOT FOUND INDICATION                                  @Z40LB66*/ 08064000
*   /*                                                               */ 08065000
*   /*****************************************************************/ 08066000
*                                                                  2124 08067000
*   INDEXPTR=RPLVBUF;               /* ADDR RECORD           @Z40LB66*/ 08068000
@RF02119 L     @04,RPLVPTR                                         2124 08069000
         L     INDEXPTR,RPLVBUF(,@04)                              2124 08070000
*   IF INDI¬=IKY THEN               /* TEST FOR CART REC     @Z40LB66*/ 08071000
         CLC   INDI(1,INDEXPTR),IKY                                2125 08072000
         BE    @RF02125                                            2125 08073000
*     DO;                           /*                       @Z40LB66*/ 08074000
*       RPLVRETC=FOUR;              /* SET RETURN CODE       @Z40LB66*/ 08075000
         MVC   RPLVRETC(2,@04),@CB00749                            2127 08076000
*       RPLRCODE=NORECRC;           /* RECORD NOT FOUND      @Z40LB66*/ 08077000
         MVC   RPLRCODE(2,@04),@CB00789                            2128 08078000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Z40LB66*/ 08079000
         BAL   @14,ERREXIT                                         2129 08080000
*       RETURN;                     /*                       @Z40LB66*/ 08081000
         B     @EL00033                                            2130 08082000
*     END;                          /*                       @Z40LB66*/ 08083000
*                                                                  2131 08084000
*   /*****************************************************************/ 08085000
*   /*                                                               */ 08086000
*   /* SAVE THE CONTENTS OF THE INDEX RECORD AND GO READ     @Z40LB66*/ 08087000
*   /* THE ASSOCIATED VOLUME RECORD AND RETURN IT            @Z40LB66*/ 08088000
*   /*                                                               */ 08089000
*   /*****************************************************************/ 08090000
*                                                                  2132 08091000
*   STORINDX=INDEX;                 /* SAVE RECORD           @Z40LB66*/ 08092000
@RF02125 MVI   STORINDX+36,C' '                                    2132 08093000
         MVC   STORINDX+37(187),STORINDX+36                        2132 08094000
         MVC   STORINDX(36),INDEX(INDEXPTR)                        2132 08095000
*   INDEXPTR=ADDR(STORINDX);        /* RESET BASE            @Z40LB66*/ 08096000
         LA    INDEXPTR,STORINDX                                   2133 08097000
*   RPLVKGE=OFF;                    /* RESET FLAG            @Z40LB66*/ 08098000
         L     @06,RPLVPTR                                         2134 08099000
         NI    RPLVKGE(@06),B'11111011'                            2134 08100000
*   CALL READVOL;                   /* READ VOLUME RECORD    @Z40LB66*/ 08101000
         BAL   @14,READVOL                                         2135 08102000
*   RETURN;                         /*                       @Z40LB66*/ 08103000
         B     @EL00033                                            2136 08104000
*   END CARTNREC;                   /*                       @Z40LB66*/ 08105000
*                                                                  2138 08106000
*   /*****************************************************************/ 08107000
*   /*                                                               */ 08108000
*   /* THIS ROUTINE READS A VOLUME RECORD AND GETS           @Y30LB26*/ 08109000
*   /* BUFFER SPACE FOR IT. THEN RETURNS THE RECORD          @Y30LB26*/ 08110000
*   /*                                                               */ 08111000
*   /*****************************************************************/ 08112000
*                                                                  2138 08113000
*READVOL:                                                          2138 08114000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 08115000
*                                                                  2138 08116000
READVOL  ST    @14,@SA00034                                        2138 08117000
*   /*****************************************************************/ 08118000
*   /*                                                               */ 08119000
*   /* SET UP TO READ WHATEVER RECORD KEY WAS IN THE         @Y30LB26*/ 08120000
*   /* CARTRIDGE INDEX RECORD                                @Y30LB26*/ 08121000
*   /*                                                               */ 08122000
*   /*****************************************************************/ 08123000
*                                                                  2139 08124000
*   RPLVKEY=ADDR(INDRECKY);         /* ADDR OF VOLUME KEY    @Z40LB66*/ 08125000
         L     @06,RPLVPTR                                         2139 08126000
         LA    @04,INDRECKY(,INDEXPTR)                             2139 08127000
         ST    @04,RPLVKEY(,@06)                                   2139 08128000
*   RPLVLOC=ON;                     /* LOCATE MODE           @Y30LB26*/ 08129000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 08130000
         OI    RPLVLOC(@06),B'11000000'                            2141 08131000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 08132000
         MVI   RPLVTYP(@06),X'00'                                  2142 08133000
*   RESPECIFY                                                      2143 08134000
*     REG1 RSTD;                    /* RESTRICT REG1         @Y30LB26*/ 08135000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 08136000
         LR    REG1,@06                                            2144 08137000
*   CALL ICBVIO00;                  /* READ VOL RECORD       @Y30LB26*/ 08138000
         L     @15,@CV00671                                        2145 08139000
         BALR  @14,@15                                             2145 08140000
*   RESPECIFY                                                      2146 08141000
*     REG1 UNRSTD;                  /* FREE REG1             @Y30LB26*/ 08142000
*                                                                  2146 08143000
*   /*****************************************************************/ 08144000
*   /*                                                               */ 08145000
*   /* CHECK TO SEE IF BAD RETURN CODE FROM I/O PROCESSOR    @Y30LB26*/ 08146000
*   /*                                                               */ 08147000
*   /*****************************************************************/ 08148000
*                                                                  2147 08149000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN CODE     @Y30LB26*/ 08150000
         L     @06,RPLVPTR                                         2147 08151000
         CLC   RPLVRETC(2,@06),@CB00747                            2147 08152000
         BE    @RF02147                                            2147 08153000
*     DO;                           /*                       @Y30LB26*/ 08154000
*       RPLVRETC=ZERO;              /* RESET RETURN CODE     @Z40LB66*/ 08155000
         SLR   @04,@04                                             2149 08156000
         STH   @04,RPLVRETC(,@06)                                  2149 08157000
*       CALL GETBUF;                /* GET BUFFER TO RETURN  @Z40LB66   08158000
*                                      CARTRIDGE RECORD      @Z40LB66*/ 08159000
         BAL   @14,GETBUF                                          2150 08160000
*       IF RPLVRETC¬=RCZERO THEN    /* IF NOT SUCCESSFUL,    @Z40LB66*/ 08161000
         L     @06,RPLVPTR                                         2151 08162000
         CLC   RPLVRETC(2,@06),@CB00747                            2151 08163000
         BNE   @RT02151                                            2151 08164000
*         RETURN;                   /* QUIT                  @Z40LB66*/ 08165000
*       BUFFER=INDEX;               /* MOVE CART. RECORD     @Z40LB66*/ 08166000
         L     @04,RVVAREA(,RVVIPTR)                               2153 08167000
         MVI   BUFFER+36(@04),C' '                                 2153 08168000
         MVC   BUFFER+37(219,@04),BUFFER+36(@04)                   2153 08169000
         MVC   BUFFER(36,@04),INDEX(INDEXPTR)                      2153 08170000
*       RPLVRETC=FOUR;              /* SET BAD RETURN CODE   @Z40LB66*/ 08171000
         MVC   RPLVRETC(2,@06),@CB00749                            2154 08172000
*       RPLRCODE=NOCTGVOL;          /* NO VOL FOR CART.      @Z40LB66*/ 08173000
         MVC   RPLRCODE(2,@06),@CB00841                            2155 08174000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 08175000
         BAL   @14,ERREXIT                                         2156 08176000
*       RETURN;                     /*                       @Y30LB26*/ 08177000
@EL00034 DS    0H                                                  2157 08178000
@EF00034 DS    0H                                                  2157 08179000
@ER00034 L     @14,@SA00034                                        2157 08180000
         BR    @14                                                 2157 08181000
*     END;                          /*                       @Y30LB26*/ 08182000
*                                                                  2158 08183000
*   /*****************************************************************/ 08184000
*   /*                                                               */ 08185000
*   /* SET UP ADDRESS TO RECORD JUST READ AND GET BUFFER     @Y30LB26*/ 08186000
*   /* SPACE TO RETURN RECORD                                @Y30LB26*/ 08187000
*   /*                                                               */ 08188000
*   /*****************************************************************/ 08189000
*                                                                  2159 08190000
*   BASEVPTR=RPLVBUF;               /* ADDR RECORD           @Y30LB26*/ 08191000
@RF02147 L     @04,RPLVPTR                                         2159 08192000
         L     @04,RPLVBUF(,@04)                                   2159 08193000
         ST    @04,BASEVPTR                                        2159 08194000
*   CALL GETBUF;                    /* GET CORE              @Y30LB26*/ 08195000
         BAL   @14,GETBUF                                          2160 08196000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 08197000
         L     @04,RPLVPTR                                         2161 08198000
         CLC   RPLVRETC(2,@04),@CB00747                            2161 08199000
         BNE   @RT02161                                            2161 08200000
*     RETURN;                       /*                       @Y30LB26*/ 08201000
*   BUFFER=BASEV;                   /* MOVE REC TO BUFFER    @Y30LB26*/ 08202000
         L     @02,RVVAREA(,RVVIPTR)                               2163 08203000
         MVI   BUFFER+224(@02),C' '                                2163 08204000
         MVC   BUFFER+225(31,@02),BUFFER+224(@02)                  2163 08205000
         L     @01,BASEVPTR                                        2163 08206000
         MVC   BUFFER(224,@02),BASEV(@01)                          2163 08207000
*   RPLVRETC=RCZERO;                /* GOOD RETURN CODE      @Y30LB26*/ 08208000
         MVC   RPLVRETC(2,@04),@CB00747                            2164 08209000
*   RPLRCODE=RCZERO;                /* GOOD REASON CODE      @Y30LB26*/ 08210000
         MVC   RPLRCODE(2,@04),@CB00747                            2165 08211000
*   RETURN;                         /*                       @Y30LB26*/ 08212000
         B     @EL00034                                            2166 08213000
*   END READVOL;                    /*                       @Y30LB26*/ 08214000
         B     @EL00034                                            2167 08215000
*                                                                  2168 08216000
*   /*****************************************************************/ 08217000
*   /*                                                               */ 08218000
*   /* ROUTINE RESERVES THE MSVC DATA SET SHARED FOR READING @Y30LB26*/ 08219000
*   /*                                                               */ 08220000
*   /*****************************************************************/ 08221000
*                                                                  2168 08222000
*RESSHARE:                                                         2168 08223000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 08224000
RESSHARE ST    @14,@SA00035                                        2168 08225000
*   RESPECIFY                                                      2169 08226000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 08227000
*   RESPECIFY                                                      2170 08228000
*     REG0 RSTD;                    /* RESTRICT              @Y30LB26*/ 08229000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 08230000
         L     REG1,RPLVPTR                                        2171 08231000
*   REG0=RESSHINV;                  /* INDICATE RES SHARE    @Y30LB26*/ 08232000
         LA    REG0,2                                              2172 08233000
*   CALL ICBVRR00;                  /* RESERVE IT            @Y30LB26*/ 08234000
         L     @15,@CV00673                                        2173 08235000
         BALR  @14,@15                                             2173 08236000
*   RESPECIFY                                                      2174 08237000
*     REG0 UNRSTD;                  /* FREE REG 0            @Y30LB26*/ 08238000
*   RESPECIFY                                                      2175 08239000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 08240000
*   RETURN;                         /*                       @Y30LB26*/ 08241000
@EL00035 DS    0H                                                  2176 08242000
@EF00035 DS    0H                                                  2176 08243000
@ER00035 L     @14,@SA00035                                        2176 08244000
         BR    @14                                                 2176 08245000
*   END RESSHARE;                   /* END PROCEDURE         @Y30LB26*/ 08246000
*                                                                  2178 08247000
*   /*****************************************************************/ 08248000
*   /*                                                               */ 08249000
*   /* ROUTINE GET BUFFER SPACE FROM SUB-POOL 241            @Y30LB26*/ 08250000
*   /* SO THAT THE MSVC RECORD CAN BE RETURNED               @Y30LB26*/ 08251000
*   /*                                                               */ 08252000
*   /*****************************************************************/ 08253000
*                                                                  2178 08254000
*GETBUF:                                                           2178 08255000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 08256000
GETBUF   ST    @14,@SA00036                                        2178 08257000
*   RVVARLN=256;                    /* LENGTH OF BUFFER      @Y30LB26*/ 08258000
*                                                                  2179 08259000
         MVC   RVVARLN(2,RVVIPTR),@CH00688                         2179 08260000
*   /*****************************************************************/ 08261000
*   /*                                                               */ 08262000
*   /* SEE IF USER PROVIDED BUFFER IS LONG ENOUGH            @Y30LB26*/ 08263000
*   /*                                                               */ 08264000
*   /*****************************************************************/ 08265000
*                                                                  2180 08266000
*   IF RVVBUFLN<RPLVRLN THEN        /* USER BUF LONG ENOU ?  @Y30LB26*/ 08267000
         L     @06,RPLVPTR                                         2180 08268000
         LH    @04,RVVBUFLN(,RVVIPTR)                              2180 08269000
         C     @04,RPLVRLN(,@06)                                   2180 08270000
         BNL   @RF02180                                            2180 08271000
*     DO;                           /*                       @Y30LB26*/ 08272000
*       RPLVRETC=FOUR;              /* BAD RET C             @Y30LB26*/ 08273000
         MVC   RPLVRETC(2,@06),@CB00749                            2182 08274000
*       RPLRCODE=BADUSRBF;          /* NOT LONG ENOUGH       @Y30LB26*/ 08275000
         MVC   RPLRCODE(2,@06),@CB00833                            2183 08276000
*       CALL ERREXIT;               /* SAVE RET C            @Y30LB26*/ 08277000
         BAL   @14,ERREXIT                                         2184 08278000
*       RETURN;                     /*                       @Y30LB26*/ 08279000
@EL00036 DS    0H                                                  2185 08280000
@EF00036 DS    0H                                                  2185 08281000
@ER00036 L     @14,@SA00036                                        2185 08282000
         BR    @14                                                 2185 08283000
*     END;                          /*                       @Y30LB26*/ 08284000
*   RESPECIFY                                                      2187 08285000
*    (REG2,                                                        2187 08286000
*     REG15) RSTD;                  /* RESTRICT REG 15-REG 2 @Y30LB26*/ 08287000
@RF02180 DS    0H                                                  2188 08288000
*   REG2=ADDR(RVVAREA);             /* ADDR OF BUFFER ADDR   @Y30LB26*/ 08289000
         LA    REG2,RVVAREA(,RVVIPTR)                              2188 08290000
*GETM1:                                                            2189 08291000
*   GEN(GETMAIN EC,LV=256,A=(REG2),SP=241);/* GET CORE       @Y30LB26*/ 08292000
*                                                                  2189 08293000
GETM1    GETMAIN EC,LV=256,A=(REG2),SP=241                              08294000
*   /*****************************************************************/ 08295000
*   /*                                                               */ 08296000
*   /* CHECK RETURN CODE FROM GETMAIN PROCESS                #Y30LB26*/ 08297000
*   /*                                                               */ 08298000
*   /*****************************************************************/ 08299000
*                                                                  2190 08300000
*   IF REG15¬=RCZERO THEN           /* CK RETURN             #Y30LB26*/ 08301000
         LTR   REG15,REG15                                         2190 08302000
         BZ    @RF02190                                            2190 08303000
*     DO;                           /*                       #Y30LB26*/ 08304000
*       RPLVRETC=FOUR;              /* BAD RETURN            #Y30LB26*/ 08305000
         L     @14,RPLVPTR                                         2192 08306000
         MVC   RPLVRETC(2,@14),@CB00749                            2192 08307000
*       RPLRCODE=NOBUFFER;          /* INDICATE NO BUF       #Y30LB26*/ 08308000
         MVC   RPLRCODE(2,@14),@CB00831                            2193 08309000
*       CALL ERREXIT;               /* SAVE RETURN CODES     #Y30LB26*/ 08310000
         BAL   @14,ERREXIT                                         2194 08311000
*     END;                          /*                       #Y30LB26*/ 08312000
*   RESPECIFY                                                      2196 08313000
*    (REG2,                                                        2196 08314000
*     REG15) UNRSTD;                /* FREE REG 15 - REG 2   @Y30LB26*/ 08315000
*   RETURN;                         /*                       #Y30LB26*/ 08316000
         B     @EL00036                                            2197 08317000
*   END GETBUF;                     /*                       #Y30LB26*/ 08318000
         B     @EL00036                                            2198 08319000
*                                                                  2199 08320000
*   /*****************************************************************/ 08321000
*   /*                                                               */ 08322000
*   /* SUBROUTINE MAKES A TEST ON BASE VOL RECORD TO SEE     @Y30LB26*/ 08323000
*   /* IF IT WILL EXPIR BEFORE A SPECIFIED NUMBER OF DAYS    @Y30LB26*/ 08324000
*   /* ALSO MAKES A TEST FOR GENERAL - RESTRICTED USE        @Y30LB26*/ 08325000
*   /* MAKES TEST FOR ACTIVE - INACTIVE VOLUME               @Y30LB26*/ 08326000
*   /* ALSO TESTS FOR A BASE VOLUME PLACE HOLDER             @ZDR2053*/ 08327000
*   /*                                                               */ 08328000
*   /*****************************************************************/ 08329000
*                                                                  2199 08330000
*TEST:                                                             2199 08331000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 08332000
TEST     ST    @14,@SA00037                                        2199 08333000
*   DCL                                                            2200 08334000
*     EXPIR CHAR(4);                /* ACTUAL EXPIR DATE     @Y30LB26*/ 08335000
*                                                                  2201 08336000
*   /*****************************************************************/ 08337000
*   /*                                                               */ 08338000
*   /* TEST FOR PLACEHOLDER FLAG BEING ON IN BASE VOLUME REC @Y30LB26*/ 08339000
*   /* IF IT IS ON THE RECORD IS NOT REALLY THERE, SO DONT   @Y30LB26*/ 08340000
*   /* RETURN IT, UNLESS REQUESTED.                          @ZDR2053*/ 08341000
*   /*                                                               */ 08342000
*   /*****************************************************************/ 08343000
*                                                                  2201 08344000
*   IF BASHOLD=ON THEN              /* HOLD RECORD ?         @Y30LB26*/ 08345000
         L     @04,BASEVPTR                                        2201 08346000
         TM    BASHOLD(@04),B'10000000'                            2201 08347000
         BNO   @RF02201                                            2201 08348000
*     DO;                           /*                       @Y30LB26*/ 08349000
*       IF RVVBPLHD=OFF&RVVALL=OFF THEN/* READ PLACE HOLD    @ZDR2053*/ 08350000
         TM    RVVBPLHD(RVVIPTR),B'00000001'                       2203 08351000
         BNZ   @RF02203                                            2203 08352000
         TM    RVVALL(RVVIPTR),B'00000001'                         2203 08353000
         BNZ   @RF02203                                            2203 08354000
*         DO;                       /*                       @ZDR2053*/ 08355000
*           RPLVRETC=FOUR;          /* SET BAD RETURN        #Y30LB26*/ 08356000
         L     @04,RPLVPTR                                         2205 08357000
         MVC   RPLVRETC(2,@04),@CB00749                            2205 08358000
*           RPLRCODE=TNOTMET;       /* TEST NOT MET          #Y30LB26*/ 08359000
         MVC   RPLRCODE(2,@04),@CB00819                            2206 08360000
*         END;                      /*                       @ZDR2053*/ 08361000
*       ELSE                        /* PLACE HOLDER          @ZDR2053*/ 08362000
*         DO;                       /*                       @ZDR2053*/ 08363000
         B     @RC02203                                            2208 08364000
@RF02203 DS    0H                                                  2209 08365000
*           RPLVRETC=RCZERO;        /*                       @ZDR2053*/ 08366000
         L     @04,RPLVPTR                                         2209 08367000
         MVC   RPLVRETC(2,@04),@CB00747                            2209 08368000
*           RPLRCODE=RCZERO;        /*                       @ZDR2053*/ 08369000
         MVC   RPLRCODE(2,@04),@CB00747                            2210 08370000
*         END;                      /*                       @ZDR2053*/ 08371000
*       RETURN;                     /*                       @ZDR2053*/ 08372000
@EL00037 DS    0H                                                  2212 08373000
@EF00037 DS    0H                                                  2212 08374000
@ER00037 L     @14,@SA00037                                        2212 08375000
         BR    @14                                                 2212 08376000
*     END;                          /*                       @ZDR2053*/ 08377000
*                                                                  2213 08378000
*   /*****************************************************************/ 08379000
*   /*                                                               */ 08380000
*   /* CHECK FOR READING ONLY PLACE HOLDER RECORDS           @ZDR2053*/ 08381000
*   /* IF MET, DO NOT RETURN THE BASE VOLUME RECORD          @ZDR2053*/ 08382000
*   /*                                                               */ 08383000
*   /*****************************************************************/ 08384000
*                                                                  2214 08385000
*   IF BASHOLD=OFF&RVVBPLHD=ON THEN                                2214 08386000
@RF02201 L     @04,BASEVPTR                                        2214 08387000
         TM    BASHOLD(@04),B'10000000'                            2214 08388000
         BNZ   @RF02214                                            2214 08389000
         TM    RVVBPLHD(RVVIPTR),B'00000001'                       2214 08390000
         BNO   @RF02214                                            2214 08391000
*     DO;                           /*                       @ZDR2053*/ 08392000
*       RPLVRETC=FOUR;              /* SET BAD RETURN        @ZDR2053*/ 08393000
         L     @04,RPLVPTR                                         2216 08394000
         MVC   RPLVRETC(2,@04),@CB00749                            2216 08395000
*       RPLRCODE=TNOTMET;           /* TEST NOT MET          @ZDR2053*/ 08396000
         MVC   RPLRCODE(2,@04),@CB00819                            2217 08397000
*       RETURN;                     /*                       @ZDR2053*/ 08398000
         B     @EL00037                                            2218 08399000
*     END;                          /*                       @ZDR2053*/ 08400000
*                                                                  2219 08401000
*   /*****************************************************************/ 08402000
*   /*                                                               */ 08403000
*   /* EXPIRATION DATE CHECK                                 @Y30LB26*/ 08404000
*   /*                                                               */ 08405000
*   /*****************************************************************/ 08406000
*                                                                  2220 08407000
*   IF RVVEXPDT=ON THEN             /* EXPIRATION DATE?      @Y30LB26*/ 08408000
*                                                                  2220 08409000
@RF02214 TM    RVVEXPDT(RVVIPTR),B'10000000'                       2220 08410000
         BNO   @RF02220                                            2220 08411000
*     /***************************************************************/ 08412000
*     /*                                                             */ 08413000
*     /* GO CALCULATE ACTUAL EXPIRATION DATE                 @Y30LB26*/ 08414000
*     /*                                                             */ 08415000
*     /***************************************************************/ 08416000
*                                                                  2221 08417000
*     DO;                           /*                       @Y30LB26*/ 08418000
*       FOREXP=RVVEXPIR;            /* GET EXPIRATION        @Y30LB26*/ 08419000
         LH    FOREXP,RVVEXPIR(,RVVIPTR)                           2222 08420000
*       CALL VUEXP;                 /* GET EXPIR DATE        @Y30LB26*/ 08421000
         BAL   @14,VUEXP                                           2223 08422000
*       EXPIR=RETDATE;              /* GET RETENTION         @Y30LB26*/ 08423000
*                                                                  2224 08424000
         MVC   EXPIR(4),RETDATE                                    2224 08425000
*       /*************************************************************/ 08426000
*       /*                                                           */ 08427000
*       /* IF VOLUME DOES NOT EXPIRE IN SPEC NO OF DAYS      @Y30LB26*/ 08428000
*       /* THEN TEST IS NOT MET                              @Y30LB26*/ 08429000
*       /*                                                           */ 08430000
*       /*************************************************************/ 08431000
*                                                                  2225 08432000
*       IF EXPIR<BASEXPDT THEN      /* DID NOT MEET TEST     @Y30LB26*/ 08433000
         L     @04,BASEVPTR                                        2225 08434000
         CLC   EXPIR(4),BASEXPDT(@04)                              2225 08435000
         BNL   @RF02225                                            2225 08436000
*         DO;                       /*                       @Y30LB26*/ 08437000
*           RPLVRETC=FOUR;          /* SET BAD RETURN CODE   @Y30LB26*/ 08438000
         L     @04,RPLVPTR                                         2227 08439000
         MVC   RPLVRETC(2,@04),@CB00749                            2227 08440000
*           RPLRCODE=TNOTMET;       /* SET REASON CODE       @Y30LB26*/ 08441000
         MVC   RPLRCODE(2,@04),@CB00819                            2228 08442000
*           RETURN;                 /* TO MAIN SUB           @Y30LB26*/ 08443000
         B     @EL00037                                            2229 08444000
*         END;                      /*                       @Y30LB26*/ 08445000
*     END;                          /*                       @Y30LB26*/ 08446000
*                                                                  2231 08447000
@RF02225 DS    0H                                                  2232 08448000
*   /*****************************************************************/ 08449000
*   /*                                                               */ 08450000
*   /* MAKE TEST FOR GENERAL USE                             @Y30LB26*/ 08451000
*   /*                                                               */ 08452000
*   /*****************************************************************/ 08453000
*                                                                  2232 08454000
*   IF RVVGSVOL=ON THEN             /* TEST FOR GEN USE?     @Y30LB26*/ 08455000
@RF02220 TM    RVVGSVOL(RVVIPTR),B'00100000'                       2232 08456000
         BNO   @RF02232                                            2232 08457000
*     DO;                           /*                       @Y30LB26*/ 08458000
*                                                                  2233 08459000
*       /*************************************************************/ 08460000
*       /*                                                           */ 08461000
*       /* IF NOT GENERAL USE, TEST NOT MET                  @Y30LB26*/ 08462000
*       /*                                                           */ 08463000
*       /*************************************************************/ 08464000
*                                                                  2234 08465000
*       IF BASGENUS=OFF THEN        /* TEST NOT MET          @Y30LB26*/ 08466000
         L     @04,BASEVPTR                                        2234 08467000
         TM    BASGENUS(@04),B'00010000'                           2234 08468000
         BNZ   @RF02234                                            2234 08469000
*         DO;                       /*                       @Y30LB26*/ 08470000
*           RPLVRETC=FOUR;          /* SET BAD RET CODE      @Y30LB26*/ 08471000
         L     @04,RPLVPTR                                         2236 08472000
         MVC   RPLVRETC(2,@04),@CB00749                            2236 08473000
*           RPLRCODE=TNOTMET;       /* INDIC NOT MET         @Y30LB26*/ 08474000
         MVC   RPLRCODE(2,@04),@CB00819                            2237 08475000
*           RETURN;                 /*                       @Y30LB26*/ 08476000
         B     @EL00037                                            2238 08477000
*         END;                      /*                       @Y30LB26*/ 08478000
*     END;                          /*                       @Y30LB26*/ 08479000
*   ELSE                            /*                       @Y30LB26*/ 08480000
*                                                                  2241 08481000
*     /***************************************************************/ 08482000
*     /*                                                             */ 08483000
*     /* TEST FOR RESTRICTED USE                             @Y30LB26*/ 08484000
*     /*                                                             */ 08485000
*     /***************************************************************/ 08486000
*                                                                  2241 08487000
*     IF RVVRSTD=ON THEN            /* TEST FOR RESTRICTED   @Y30LB26*/ 08488000
         B     @RC02232                                            2241 08489000
@RF02232 TM    RVVRSTD(RVVIPTR),B'00010000'                        2241 08490000
         BNO   @RF02241                                            2241 08491000
*       DO;                         /*                       @Y30LB26*/ 08492000
*                                                                  2242 08493000
*         /***********************************************************/ 08494000
*         /*                                                         */ 08495000
*         /* IF NOT RESTRICTED TEST NOT MET                  @Y30LB26*/ 08496000
*         /*                                                         */ 08497000
*         /***********************************************************/ 08498000
*                                                                  2243 08499000
*         IF BASRSTD=OFF THEN       /* TEST NOT MET          @Y30LB26*/ 08500000
         L     @04,BASEVPTR                                        2243 08501000
         TM    BASRSTD(@04),B'00001000'                            2243 08502000
         BNZ   @RF02243                                            2243 08503000
*           DO;                     /*                       @Y30LB26*/ 08504000
*             RPLVRETC=FOUR;        /* BAD RET CODE          @Y30LB26*/ 08505000
         L     @04,RPLVPTR                                         2245 08506000
         MVC   RPLVRETC(2,@04),@CB00749                            2245 08507000
*             RPLRCODE=TNOTMET;     /* TEST NOT MET          @Y30LB26*/ 08508000
         MVC   RPLRCODE(2,@04),@CB00819                            2246 08509000
*             RETURN;               /*                       @Y30LB26*/ 08510000
         B     @EL00037                                            2247 08511000
*           END;                    /*                       @Y30LB26*/ 08512000
*       END;                        /*                       @Y30LB26*/ 08513000
*                                                                  2249 08514000
@RF02243 DS    0H                                                  2250 08515000
*   /*****************************************************************/ 08516000
*   /*                                                               */ 08517000
*   /* MAKE TEST FOR INACTIVE VOLUME                         @Y30LB26*/ 08518000
*   /*                                                               */ 08519000
*   /*****************************************************************/ 08520000
*                                                                  2250 08521000
*   IF RVVINACT=ON THEN             /* CHECK FOR INACTIVE    @Y30LB26*/ 08522000
@RF02241 DS    0H                                                  2250 08523000
@RC02232 TM    RVVINACT(RVVIPTR),B'00001000'                       2250 08524000
         BNO   @RF02250                                            2250 08525000
*     DO;                           /*                       @Y30LB26*/ 08526000
*                                                                  2251 08527000
*       /*************************************************************/ 08528000
*       /*                                                           */ 08529000
*       /* IF NOT INACTIVE, TEST NOT MET                     @Y30LB26*/ 08530000
*       /*                                                           */ 08531000
*       /*************************************************************/ 08532000
*                                                                  2252 08533000
*       IF BASINAC=OFF THEN         /* TEST NOT MET          @Y30LB26*/ 08534000
         L     @04,BASEVPTR                                        2252 08535000
         TM    BASINAC(@04),B'00000100'                            2252 08536000
         BNZ   @RF02252                                            2252 08537000
*         DO;                       /*                       @Y30LB26*/ 08538000
*           RPLVRETC=FOUR;          /* BAD RETURN            @Y30LB26*/ 08539000
         L     @04,RPLVPTR                                         2254 08540000
         MVC   RPLVRETC(2,@04),@CB00749                            2254 08541000
*           RPLRCODE=TNOTMET;       /* TEST NOT MET          @Y30LB26*/ 08542000
         MVC   RPLRCODE(2,@04),@CB00819                            2255 08543000
*           RETURN;                 /*                       @Y30LB26*/ 08544000
         B     @EL00037                                            2256 08545000
*         END;                      /*                       @Y30LB26*/ 08546000
*     END;                          /*                       @Y30LB26*/ 08547000
*                                                                  2258 08548000
@RF02252 DS    0H                                                  2259 08549000
*   /*****************************************************************/ 08550000
*   /*                                                               */ 08551000
*   /* MAKE TEST FOR ACTIVE VOLUME                           @Y30LB26*/ 08552000
*   /*                                                               */ 08553000
*   /*****************************************************************/ 08554000
*                                                                  2259 08555000
*   IF RVVACTV=ON THEN              /* TEST ACTIVE           @Y30LB26*/ 08556000
@RF02250 TM    RVVACTV(RVVIPTR),B'00000100'                        2259 08557000
         BNO   @RF02259                                            2259 08558000
*     DO;                           /*                       @Y30LB26*/ 08559000
*       IF BASINAC=ON THEN          /* INACTIVE              @Y30LB26*/ 08560000
         L     @04,BASEVPTR                                        2261 08561000
         TM    BASINAC(@04),B'00000100'                            2261 08562000
         BNO   @RF02261                                            2261 08563000
*         DO;                       /*                       @Y30LB26*/ 08564000
*           RPLVRETC=FOUR;          /* BAD RET CODE          @Y30LB26*/ 08565000
         L     @04,RPLVPTR                                         2263 08566000
         MVC   RPLVRETC(2,@04),@CB00749                            2263 08567000
*           RPLRCODE=TNOTMET;       /* TEST NOT MET          @Y30LB26*/ 08568000
         MVC   RPLRCODE(2,@04),@CB00819                            2264 08569000
*           RETURN;                 /*                       @Y30LB26*/ 08570000
         B     @EL00037                                            2265 08571000
*         END;                      /*                       @Y30LB26*/ 08572000
*     END;                          /*                       @Y30LB26*/ 08573000
@RF02261 DS    0H                                                  2268 08574000
*   RPLVRETC=RCZERO;                /* INDIC ALL TEST MET    @Y30LB26*/ 08575000
@RF02259 L     @04,RPLVPTR                                         2268 08576000
         MVC   RPLVRETC(2,@04),@CB00747                            2268 08577000
*   RPLRCODE=RCZERO;                /* END                   @Y30LB26*/ 08578000
         MVC   RPLRCODE(2,@04),@CB00747                            2269 08579000
*   RETURN;                         /*                       @Y30LB26*/ 08580000
         B     @EL00037                                            2270 08581000
*   END TEST;                       /*                       @Y30LB26*/ 08582000
         B     @EL00037                                            2271 08583000
*                                                                  2272 08584000
*/*  START OF SPECIFICATIONS ****                                  2272 08585000
*                                                                  2272 08586000
*    PROCEDURE NAME - MODIFYV                                 @Y30LB26  08587000
*                                                                  2272 08588000
*    FUNCTION - TO MODIFY A BASE VOLUME RECORD IN THE USERCAT.MSVI DATA 08589000
*    SET.  IT WILL ALSO CHANGE A COPY RECORD TO A BACKUP AND/OR    2272 08590000
*    CLEAR THE INCOMPLETE COPY FLAG IN THE COPY RECORD IF          2272 08591000
*    THE USER SPECIFIES THE CARTRIDGE SERIAL NUMBER OF THE COPY TO BE   08592000
*    CHANGED.  THE PROGRAM CAN                                     2272 08593000
*    NOT CHANGE THE VOLUME ID OF A BASE VOLUME RECORD.  IT CAN TAKE A   08594000
*    VOLUME OUT OF A GROUP, IN WHICH CASE THE PROGRAM WILL TAKE IT OUT  08595000
*    OF THE GROUP CHAIN AND CHAIN IT INTO THE NON-GROUPED.         2272 08596000
*    IF THE VOLUME WAS 'GENERAL' USE IT WILL DECREASE THE          2272 08597000
*    GROUP FREE SPACE, THE NUMBER OF FREE EXTENTS AND TAKE THE     2272 08598000
*    ENTRY FOR THE VOLUME OUT OF THE VOLUME SERIAL NUMBER EXTENSION     08599000
*    RECORD.  IT WILL THEN RECALCULATE THE GROUP SPACE THRESHOLD IF     08600000
*    THRESHOLD CHECKING IS BEING DONE FOR THAT GROUP.  IF THE VOLUME IS 08601000
*    BEING CHANGED FROM 'RESTRICTED' TO 'GENERAL' USE, THE FREE SPACE   08602000
*    AND FREE EXTENTS ARE INCREASED AND A SLOT IN THE GROUPED VOLUME    08603000
*    SERIAL NUMBER EXTENT RECORD IS ADDED, BUT NO RECHAINING IS    2272 08604000
*    NECESSARY.  THE REVERSE IS DONE IF A VOLUME IS TAKEN FROM     2272 08605000
*    'GENERAL' TO 'RESTRICTED' USE WITHIN THE SAME GROUP.  WHEN A  2272 08606000
*    VOLUME GOES FROM NON-GROUPED TO GROUPED IT WILL BE TAKEN OUT OF    08607000
*    THE NON-GROUPED CHAIN AND PUT INTO THE GROUPED CHAIN.  IF IT IS    08608000
*    'GENERAL' USE, THE SPACE FIELDS IN THE GROUP RECORD WILL BE   2272 08609000
*    UPDATED AND A SLOT ADDED IN THE GROUPED VOLUME SERIAL NUMBER  2272 08610000
*    EXTENT RECORD.  IN ALL CASES THE COUNT IN THE GROUP RECORD IS 2272 08611000
*    UPDATED FOR 'GENERAL' OR 'RESTRICTED' USE OR THE NUMBER OF VOLUMES 08612000
*    COUNT IF NON-GROUPED.  THE BASE VOLUME RECORD IS UPDATED TO   2272 08613000
*    REFLECT ITS NEW STATUS.  THE EXPIRATION DATE IS NULLIFIED IF IT    08614000
*    WAS A GROUPED 'GENERAL' USE VOLUME CHANGING TO A NON-GROUPED OR    08615000
*    'RESTRICTED'. IF IT IS BECOMING A GROUPED, 'GENERAL' USE VOLUME,   08616000
*    THE EXPIRATION DATE IS ADDED OR CALCULATED IF SPECIFIED BY THE     08617000
*    USER. FOR ALL VOLUMES THE PROGRAM CAN MODIFY OR NULLIFY THE   2272 08618000
*    DESCRIPTION, MAXIMUM NUMBER OF BACKUPS, SET OR CLEAR THE VOLUME    08619000
*    LABEL MISMATCH FLAG AND CLEAR THE INCOMPLETE VOLUME CREATION FLAG. 08620000
*    THE RPLV IS JOURNALED AFTER THE FIRST SUCCESSFUL UPDATE OF THE     08621000
*    MSVC INVENTORY DATA SET.                                 @Y30LB26  08622000
*                                                                  2272 08623000
*      INPUTS - REGISTER 1 CONTAINS THE ADDRESS OF THE RPLV, WHICH 2272 08624000
*      CONTAINS THE REQUEST BLOCK TELLING WHAT OPTIONS ARE TO      2272 08625000
*      BE HANDLED.                                            @Y30LB26  08626000
*                                                                  2272 08627000
*      OUTPUTS - REASON CODE AND CONDITION CODE IN RPLV.      @Y30LB26  08628000
*                                                                  2272 08629000
*         '0228'X  INCOMPATABLE MSS MOUNTING ATTRIBUTES.      @Y30LB26  08630000
*         '0201'X  REQUEST TO MODIFY A COPY RECORD, BUT NO    @Y30LB26  08631000
*          CSN WAS GIVEN.                                     @Y30LB26  08632000
*         '021B'X  I/O ERROR OCCURED BUT THE RPLV WAS         @Y30LB26  08633000
*          JOURNALED.                                         @Y30LB26  08634000
*         '0227'X  TO OR FOR SPECIFIED FOR A BASE VOLUME      @Y30LB26  08635000
*          RECORD IN A GROUP WITH NO RETENTION CHECKING.      @Y30LB26  08636000
*         '0205'X  GROUP NAME SPECIFIED BY USER DOES NOT      @VS32198  08637000
*          EXIST IN LIBRARY.                                  @VS32198  08638000
*         ANY REASON CODES FROM THE I/O PROCESSOR OR THE      @Y30LB26  08639000
*          JOURNAL PROGRAM.                                   @Y30LB26  08640000
**** END OF SPECIFICATIONS **                                        */ 08641000
*                                                                  2272 08642000
*MODIFYV:                                                          2272 08643000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 08644000
*                                                                  2272 08645000
MODIFYV  ST    @14,@SA00038                                        2272 08646000
*   /*****************************************************************/ 08647000
*   /*                                                               */ 08648000
*   /* GO RESERVE THE INVENTORY DATA SET FOR UPDATE          #Y30LB26*/ 08649000
*   /*                                                               */ 08650000
*   /*****************************************************************/ 08651000
*                                                                  2273 08652000
*   CALL RESERINV;                  /* RESERVE INVENTORY     @Y30LB26*/ 08653000
*                                                                  2273 08654000
         BAL   @14,RESERINV                                        2273 08655000
*   /*****************************************************************/ 08656000
*   /*                                                               */ 08657000
*   /* SET ADDRESSABILITY TO REQUEST BLOCK                   @Y30LB26*/ 08658000
*   /*                                                               */ 08659000
*   /*****************************************************************/ 08660000
*                                                                  2274 08661000
*   MVRPTR=ADDR(RPLVUTIL);          /* ADDR OF REQ BLK       @Y30LB26*/ 08662000
*                                                                  2274 08663000
         L     @02,RPLVPTR                                         2274 08664000
         LA    @02,RPLVUTIL(,@02)                                  2274 08665000
         ST    @02,MVRPTR                                          2274 08666000
*   /*****************************************************************/ 08667000
*   /*                                                               */ 08668000
*   /* IF THE REQUEST IS TO CHANGE A COPY RECORD,            @Y30LB26*/ 08669000
*   /* BRANCH TO SUBROUTINE THAT DOES THIS                   @Y30LB26*/ 08670000
*   /*                                                               */ 08671000
*   /*****************************************************************/ 08672000
*                                                                  2275 08673000
*   IF MVRFLCSN=ON THEN             /* CHANGE COPY RECORD ?  @Y30LB26*/ 08674000
         TM    MVRFLCSN(@02),B'00000100'                           2275 08675000
         BNO   @RF02275                                            2275 08676000
*     DO;                           /*                       @Y30LB26*/ 08677000
*       CALL MODCOPY;               /* BRANCH TO DO IT       @Y30LB26*/ 08678000
         BAL   @14,MODCOPY                                         2277 08679000
*       RETURN;                     /* RETURN MAIN PROC      @Y30LB26*/ 08680000
@EL00038 DS    0H                                                  2278 08681000
@EF00038 DS    0H                                                  2278 08682000
@ER00038 L     @14,@SA00038                                        2278 08683000
         BR    @14                                                 2278 08684000
*     END;                          /*                       @Y30LB26*/ 08685000
*                                                                  2279 08686000
*   /*****************************************************************/ 08687000
*   /*                                                               */ 08688000
*   /* IF IT IS NOT A REQUEST TO CHANGE A COPY RECORD, THEN  @Y30LB26*/ 08689000
*   /* SET UP TO READ BASE VOLUME RECORD TO BE UPDATED       @Y30LB26*/ 08690000
*   /*                                                               */ 08691000
*   /*****************************************************************/ 08692000
*                                                                  2280 08693000
*   VOLKY=MVRBVOL;                  /* GET VOLUME NAME       @Y30LB26*/ 08694000
@RF02275 L     @02,MVRPTR                                          2280 08695000
         MVC   VOLKY(6),MVRBVOL(@02)                               2280 08696000
*   RPLVKEY=ADDR(VKEY);             /* ADDR OF KEY           @Y30LB26*/ 08697000
         L     @02,RPLVPTR                                         2281 08698000
         LA    @15,VKEY                                            2281 08699000
         ST    @15,RPLVKEY(,@02)                                   2281 08700000
*   RPLVBUF=ADDR(STORBASE);         /* ADDR OF BUFFER        @Y30LB26*/ 08701000
         LA    @15,STORBASE                                        2282 08702000
         ST    @15,RPLVBUF(,@02)                                   2282 08703000
*   RPLVBLN=LENGTH(STORBASE);       /* LENGTH OF BUFFER      @Y30LB26*/ 08704000
         MVC   RPLVBLN(4,@02),@CF01147                             2283 08705000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 08706000
         OI    RPLVDIR(@02),B'01000000'                            2284 08707000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 08708000
         MVI   RPLVTYP(@02),X'00'                                  2285 08709000
*   RESPECIFY                                                      2286 08710000
*     REG1 RSTD;                    /* RESTRICT              @Y30LB26*/ 08711000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 08712000
         LR    REG1,@02                                            2287 08713000
*   CALL ICBVIO00;                  /* READ BASE RECORD      @Y30LB26*/ 08714000
         L     @15,@CV00671                                        2288 08715000
         BALR  @14,@15                                             2288 08716000
*   RESPECIFY                                                      2289 08717000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 08718000
*                                                                  2289 08719000
*   /*****************************************************************/ 08720000
*   /*                                                               */ 08721000
*   /* CHECK RETURN CODE                                     @Y30LB26*/ 08722000
*   /*                                                               */ 08723000
*   /*****************************************************************/ 08724000
*                                                                  2290 08725000
*   IF RPLVRETC¬=RCZERO THEN        /* CH RET CODE           @Y30LB26*/ 08726000
         L     @02,RPLVPTR                                         2290 08727000
         CLC   RPLVRETC(2,@02),@CB00747                            2290 08728000
         BE    @RF02290                                            2290 08729000
*     DO;                           /*                       @Y30LB26*/ 08730000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 08731000
         BAL   @14,ERREXIT                                         2292 08732000
*       RETURN;                     /*                       @Y30LB26*/ 08733000
         B     @EL00038                                            2293 08734000
*     END;                          /*                       @Y30LB26*/ 08735000
*                                                                  2294 08736000
*   /*****************************************************************/ 08737000
*   /*                                                               */ 08738000
*   /* CKECK TO SEE IF USER SPECIFIED A GROUP NAME. IF SO    @VS32198*/ 08739000
*   /* READ FOR RECORD TO SEE IF IT IS IN THE INVENTORY.     @VS32198*/ 08740000
*   /*                                                               */ 08741000
*   /*****************************************************************/ 08742000
*                                                                  2295 08743000
*   IF MVRFLGRO=ON THEN             /* GROUP SPEC ?          @VS32198*/ 08744000
@RF02290 L     @02,MVRPTR                                          2295 08745000
         TM    MVRFLGRO(@02),B'01000000'                           2295 08746000
         BNO   @RF02295                                            2295 08747000
*     DO;                           /*                       @VS32198*/ 08748000
*       GROUPKY=MVRGROUP;           /* GROUP NAME IN KEY     @VS32198*/ 08749000
         MVC   GROUPKY(8),MVRGROUP(@02)                            2297 08750000
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @VS32198*/ 08751000
         L     @02,RPLVPTR                                         2298 08752000
         LA    @15,GKEY                                            2298 08753000
         ST    @15,RPLVKEY(,@02)                                   2298 08754000
*       RPLVLOC=ON;                 /* LOCATE MODE           @VS32198*/ 08755000
*       RPLVDIR=ON;                 /* READ DIRECT           @VS32198*/ 08756000
         OI    RPLVLOC(@02),B'11000000'                            2300 08757000
*       RPLVTYP=RPLVREAD;           /* READ RECORD           @VS32198*/ 08758000
         MVI   RPLVTYP(@02),X'00'                                  2301 08759000
*       RPLVUPD=OFF;                /* NOT FOR UPDATE        @VS32198*/ 08760000
         NI    RPLVUPD(@02),B'11111101'                            2302 08761000
*       RESPECIFY                                                  2303 08762000
*         REG1 RSTD;                /* RESRTICT REG 1        @VS32198*/ 08763000
*       REG1=RPLVPTR;               /* ADDR OF RPLV          @VS32198*/ 08764000
         LR    REG1,@02                                            2304 08765000
*       CALL ICBVIO00;              /* READ FOR GROUP REC    @VS32198*/ 08766000
         L     @15,@CV00671                                        2305 08767000
         BALR  @14,@15                                             2305 08768000
*       RPLVLOC=OFF;                /* RESET FOR SAFETY      @VS32198*/ 08769000
         L     @02,RPLVPTR                                         2306 08770000
         NI    RPLVLOC(@02),B'01111111'                            2306 08771000
*       RESPECIFY                                                  2307 08772000
*         REG1 UNRSTD;              /* FREE REG 1            @VS32198*/ 08773000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @VS32198*/ 08774000
         CLC   RPLVRETC(2,@02),@CB00747                            2308 08775000
         BE    @RF02308                                            2308 08776000
*         DO;                       /*                       @VS32198*/ 08777000
*           IF RPLRCODE=NORECRC THEN/* RECORD NOT FND ?      @VS32198*/ 08778000
         CLC   RPLRCODE(2,@02),@CB00789                            2310 08779000
         BNE   @RF02310                                            2310 08780000
*             RPLRCODE=BADGRP;      /* SET REASON CODE       @VS32198*/ 08781000
         MVC   RPLRCODE(2,@02),@CB00839                            2311 08782000
*           CALL ERREXIT;           /* RET SET UP            @VS32198*/ 08783000
@RF02310 BAL   @14,ERREXIT                                         2312 08784000
*           RETURN;                 /* RETURN ?????          @VS32198*/ 08785000
         B     @EL00038                                            2313 08786000
*         END;                      /*                       @VS32198*/ 08787000
*     END;                          /*                       @VS32198*/ 08788000
*                                                                  2315 08789000
@RF02308 DS    0H                                                  2316 08790000
*   /*****************************************************************/ 08791000
*   /*                                                               */ 08792000
*   /* CALL ROUTINE TO CHECK IF TO OR FOR EXPIRATION         #Y30LB26*/ 08793000
*   /* PARAMETERS WERE SPECIFIED FOR A VOLUME WHERE          #Y30LB26*/ 08794000
*   /* RETENTION DOES NOT APPLY                              @Y30LB26*/ 08795000
*   /*                                                               */ 08796000
*   /*****************************************************************/ 08797000
*                                                                  2316 08798000
*   BASEVPTR=ADDR(STORBASE);        /* SET ADDR TO BASE REC  @Y30LB26*/ 08799000
@RF02295 LA    @02,STORBASE                                        2316 08800000
         ST    @02,BASEVPTR                                        2316 08801000
*   CALL EXPCK;                     /* CK RETENTION          @Y30LB26*/ 08802000
         BAL   @14,EXPCK                                           2317 08803000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 08804000
         L     @02,RPLVPTR                                         2318 08805000
         CLC   RPLVRETC(2,@02),@CB00747                            2318 08806000
         BNE   @RT02318                                            2318 08807000
*     RETURN;                       /* RETURN CALLER         @Y30LB26*/ 08808000
*                                                                  2319 08809000
*   /*****************************************************************/ 08810000
*   /*                                                               */ 08811000
*   /* CHECK TO SEE IF GROUP WAS SPECIFIED                   @Y30LB26*/ 08812000
*   /*                                                               */ 08813000
*   /*****************************************************************/ 08814000
*                                                                  2320 08815000
*   IF MVRFLGRO=ON THEN             /* GOING GROUPED         @Y30LB26*/ 08816000
         L     @02,MVRPTR                                          2320 08817000
         TM    MVRFLGRO(@02),B'01000000'                           2320 08818000
         BNO   @RF02320                                            2320 08819000
*     DO;                           /*                       @Y30LB26*/ 08820000
*                                                                  2321 08821000
*       /*************************************************************/ 08822000
*       /*                                                           */ 08823000
*       /* CHECK TO SEE IF WAS NOT GROUPED BEFORE OR         @Y30LB26*/ 08824000
*       /* IF WAS GROUPED BEFORE, IF IT WAS THE SAME GROUP   @Y30LB26*/ 08825000
*       /*                                                           */ 08826000
*       /*************************************************************/ 08827000
*                                                                  2322 08828000
*       IF BASGRPV=OFF|MVRGROUP¬=BASGROUP THEN/* REALY CHAN  @Y30LB26*/ 08829000
         L     @15,BASEVPTR                                        2322 08830000
         TM    BASGRPV(@15),B'00100000'                            2322 08831000
         BZ    @RT02322                                            2322 08832000
         CLC   MVRGROUP(8,@02),BASGROUP(@15)                       2322 08833000
         BE    @RF02322                                            2322 08834000
@RT02322 DS    0H                                                  2323 08835000
*         DO;                       /*                       @Y30LB26*/ 08836000
*                                                                  2323 08837000
*           /*********************************************************/ 08838000
*           /*                                                       */ 08839000
*           /* CHECK TO SEE IF GOING TO BE A GENERAL         @Y30LB26*/ 08840000
*           /* USE VOLUME IN THE GROUP                       @Y30LB26*/ 08841000
*           /*                                                       */ 08842000
*           /*********************************************************/ 08843000
*                                                                  2324 08844000
*           IF MVRGEN=ON THEN       /* GOING GENERAL         @Y30LB26*/ 08845000
*                                                                  2324 08846000
         L     @02,MVRPTR                                          2324 08847000
         TM    MVRGEN(@02),B'10000000'                             2324 08848000
         BNO   @RF02324                                            2324 08849000
*             /*******************************************************/ 08850000
*             /*                                                     */ 08851000
*             /* READ RECORD OF GROUP BASE IS GOING INTO     @Y30LB26*/ 08852000
*             /*                                                     */ 08853000
*             /*******************************************************/ 08854000
*                                                                  2325 08855000
*             DO;                   /*                       @Y30LB26*/ 08856000
*               GROUPKY=MVRGROUP;   /* NEW GROUP NAME        @Y30LB26*/ 08857000
         MVC   GROUPKY(8),MVRGROUP(@02)                            2326 08858000
*               RPLVKEY=ADDR(GKEY); /* ADDR KEY TO READ      @Y30LB26*/ 08859000
         L     @02,RPLVPTR                                         2327 08860000
         LA    @15,GKEY                                            2327 08861000
         ST    @15,RPLVKEY(,@02)                                   2327 08862000
*               RPLVLOC=ON;         /* LOCATE MODE           @Y30LB26*/ 08863000
*               RPLVDIR=ON;         /* READ DIRECT           @Y30LB26*/ 08864000
         OI    RPLVLOC(@02),B'11000000'                            2329 08865000
*               RPLVTYP=RPLVREAD;   /* READ RECORD           @Y30LB26*/ 08866000
         MVI   RPLVTYP(@02),X'00'                                  2330 08867000
*               RESPECIFY                                          2331 08868000
*                 REG1 RSTD;        /* RESTRICT REG 1        @Y30LB26*/ 08869000
*               REG1=RPLVPTR;       /* ADDR RPLV             @Y30LB26*/ 08870000
         LR    REG1,@02                                            2332 08871000
*               CALL ICBVIO00;      /* READ NEW GROUP REC    @Y30LB26*/ 08872000
         L     @15,@CV00671                                        2333 08873000
         BALR  @14,@15                                             2333 08874000
*               RESPECIFY                                          2334 08875000
*                 REG1 UNRSTD;      /* FREE REG 1            @Y30LB26*/ 08876000
*               IF RPLVRETC¬=RCZERO THEN/* CK RETURN CODE    @Y30LB26*/ 08877000
         L     @02,RPLVPTR                                         2335 08878000
         CLC   RPLVRETC(2,@02),@CB00747                            2335 08879000
         BE    @RF02335                                            2335 08880000
*                 DO;               /*                       @Y30LB26*/ 08881000
*                   CALL ERREXIT;   /* FREE INVENTORY        @Y30LB26*/ 08882000
         BAL   @14,ERREXIT                                         2337 08883000
*                   RETURN;         /*                       @Y30LB26*/ 08884000
         B     @EL00038                                            2338 08885000
*                 END;              /*                       @Y30LB26*/ 08886000
*                                                                  2339 08887000
*               /*****************************************************/ 08888000
*               /*                                                   */ 08889000
*               /* SET TO ADDRESS RECORD JUST READ           @Y30LB26*/ 08890000
*               /*                                                   */ 08891000
*               /*****************************************************/ 08892000
*                                                                  2340 08893000
*               GROUPPTR=RPLVBUF;   /* ADDR RECORD JUST READ @Y30LB26*/ 08894000
*                                                                  2340 08895000
@RF02335 L     @02,RPLVPTR                                         2340 08896000
         L     @02,RPLVBUF(,@02)                                   2340 08897000
         ST    @02,GROUPPTR                                        2340 08898000
*               /*****************************************************/ 08899000
*               /*                                                   */ 08900000
*               /* CHECK MOUNTING ATTRIBUTES                 @Y30LB26*/ 08901000
*               /*                                                   */ 08902000
*               /*****************************************************/ 08903000
*                                                                  2341 08904000
*               IF BASBIND=OFF&GROBIND=OFF|/* BINDS MATCH?   @Y30LB26*/ 08905000
*                   BASBIND=ON&GROBIND=ON THEN/* BINDS MATCH?      2341 08906000
*                                                            @Y30LB26*/ 08907000
         L     @01,BASEVPTR                                        2341 08908000
         TM    BASBIND(@01),B'00000010'                            2341 08909000
         BNZ   @GL00045                                            2341 08910000
         TM    GROBIND(@02),B'10000000'                            2341 08911000
         BZ    @RT02341                                            2341 08912000
@GL00045 L     @02,BASEVPTR                                        2341 08913000
         TM    BASBIND(@02),B'00000010'                            2341 08914000
         BNO   @RF02341                                            2341 08915000
         L     @02,GROUPPTR                                        2341 08916000
         TM    GROBIND(@02),B'10000000'                            2341 08917000
         BNO   @RF02341                                            2341 08918000
@RT02341 DS    0H                                                  2342 08919000
*                 DO;               /*                       @Y30LB26*/ 08920000
*                   IF BASEXCL=OFF&GROEXCL=OFF|/* EXCL MATC  @Y30LB26*/ 08921000
*                       BASEXCL=ON&GROEXCL=ON THEN/* EXCL MAT      2343 08922000
*                                                            @Y30LB26*/ 08923000
         L     @02,BASEVPTR                                        2343 08924000
         TM    BASEXCL(@02),B'00000001'                            2343 08925000
         BNZ   @GL00048                                            2343 08926000
         L     @02,GROUPPTR                                        2343 08927000
         TM    GROEXCL(@02),B'01000000'                            2343 08928000
         BZ    @RT02343                                            2343 08929000
@GL00048 L     @02,BASEVPTR                                        2343 08930000
         TM    BASEXCL(@02),B'00000001'                            2343 08931000
         BNO   @RF02343                                            2343 08932000
         L     @02,GROUPPTR                                        2343 08933000
         TM    GROEXCL(@02),B'01000000'                            2343 08934000
         BNO   @RF02343                                            2343 08935000
@RT02343 DS    0H                                                  2344 08936000
*                     DO;           /*                       @Y30LB26*/ 08937000
*                       IF BASDAERA=OFF&GRODAERA=OFF|/* ERA  @Y30LB26*/ 08938000
*                           BASDAERA=ON&GRODAERA=ON THEN/* ERA     2345 08939000
*                                                            @Y30LB26*/ 08940000
         L     @02,BASEVPTR                                        2345 08941000
         TM    BASDAERA(@02),B'10000000'                           2345 08942000
         BNZ   @GL00051                                            2345 08943000
         L     @02,GROUPPTR                                        2345 08944000
         TM    GRODAERA(@02),B'00100000'                           2345 08945000
         BZ    @RT02345                                            2345 08946000
@GL00051 L     @02,BASEVPTR                                        2345 08947000
         TM    BASDAERA(@02),B'10000000'                           2345 08948000
         BNO   @RF02345                                            2345 08949000
         L     @02,GROUPPTR                                        2345 08950000
         TM    GRODAERA(@02),B'00100000'                           2345 08951000
         BNO   @RF02345                                            2345 08952000
@RT02345 DS    0H                                                  2346 08953000
*                         DO;       /*                       @Y30LB26*/ 08954000
*                           IF BASRONLY=OFF&GRORONLY=OFF|/*  @Y30LB26*/ 08955000
*                               BASRONLY=ON&GRORONLY=ON/*    @Y30LB26*/ 08956000
*                             THEN                                 2347 08957000
         L     @02,BASEVPTR                                        2347 08958000
         TM    BASRONLY(@02),B'01000000'                           2347 08959000
         BNZ   @GL00054                                            2347 08960000
         L     @02,GROUPPTR                                        2347 08961000
         TM    GRORONLY(@02),B'00010000'                           2347 08962000
         BZ    @RT02347                                            2347 08963000
@GL00054 L     @02,BASEVPTR                                        2347 08964000
         TM    BASRONLY(@02),B'01000000'                           2347 08965000
         BNO   @RF02347                                            2347 08966000
         L     @02,GROUPPTR                                        2347 08967000
         TM    GRORONLY(@02),B'00010000'                           2347 08968000
         BNO   @RF02347                                            2347 08969000
@RT02347 DS    0H                                                  2348 08970000
*                             I=I;  /* DUMMY INST            @Y30LB26*/ 08971000
         SLR   @02,@02                                             2348 08972000
         IC    @02,I                                               2348 08973000
         STC   @02,I                                               2348 08974000
*                           ELSE    /*                       @Y30LB26*/ 08975000
*                             DO;   /*                       @Y30LB26*/ 08976000
         B     @RC02347                                            2349 08977000
@RF02347 DS    0H                                                  2350 08978000
*                               RPLVRETC=FOUR;/* BAD RC      @Y30LB26*/ 08979000
         L     @02,RPLVPTR                                         2350 08980000
         MVC   RPLVRETC(2,@02),@CB00749                            2350 08981000
*                               RPLRCODE=INCOMSS1;/* INCOM   @Y30LB26*/ 08982000
         MVC   RPLRCODE(2,@02),@CB00827                            2351 08983000
*                               CALL ERREXIT;/* SAVE STUFF   @Y30LB26*/ 08984000
         BAL   @14,ERREXIT                                         2352 08985000
*                               RETURN;/*                    @Y30LB26*/ 08986000
         B     @EL00038                                            2353 08987000
*                             END;  /*                       @Y30LB26*/ 08988000
*                         END;      /*                       @Y30LB26*/ 08989000
*                       ELSE        /*                       @Y30LB26*/ 08990000
*                         DO;       /*                       @Y30LB26*/ 08991000
         B     @RC02345                                            2356 08992000
@RF02345 DS    0H                                                  2357 08993000
*                           RPLVRETC=FOUR;/* BAD RC          @Y30LB26*/ 08994000
         L     @02,RPLVPTR                                         2357 08995000
         MVC   RPLVRETC(2,@02),@CB00749                            2357 08996000
*                           RPLRCODE=INCOMSS1;/* INCOM SS    @Y30LB26*/ 08997000
         MVC   RPLRCODE(2,@02),@CB00827                            2358 08998000
*                           CALL ERREXIT;/* SAVE             @Y30LB26*/ 08999000
         BAL   @14,ERREXIT                                         2359 09000000
*                           RETURN; /*                       @Y30LB26*/ 09001000
         B     @EL00038                                            2360 09002000
*                         END;      /*                       @Y30LB26*/ 09003000
*                     END;          /*                       @Y30LB26*/ 09004000
*                   ELSE            /*                       @Y30LB26*/ 09005000
*                     DO;           /*                       @Y30LB26*/ 09006000
         B     @RC02343                                            2363 09007000
@RF02343 DS    0H                                                  2364 09008000
*                       RPLVRETC=FOUR;/* BAD RC              @Y30LB26*/ 09009000
         L     @02,RPLVPTR                                         2364 09010000
         MVC   RPLVRETC(2,@02),@CB00749                            2364 09011000
*                       RPLRCODE=INCOMSS1;/* INCOM           @Y30LB26*/ 09012000
         MVC   RPLRCODE(2,@02),@CB00827                            2365 09013000
*                       CALL ERREXIT;/* SAVE RET             @Y30LB26*/ 09014000
         BAL   @14,ERREXIT                                         2366 09015000
*                       RETURN;     /*                       @Y30LB26*/ 09016000
         B     @EL00038                                            2367 09017000
*                     END;          /*                       @Y30LB26*/ 09018000
*                 END;              /*                       @Y30LB26*/ 09019000
*               ELSE                /*                       @Y30LB26*/ 09020000
*                                                                  2370 09021000
*                 /***************************************************/ 09022000
*                 /*                                                 */ 09023000
*                 /* IF ATTRIBUTES DONT MATCH, EXIT ERROR    @Y30LB26*/ 09024000
*                 /*                                                 */ 09025000
*                 /***************************************************/ 09026000
*                                                                  2370 09027000
*                 DO;               /*                       @Y30LB26*/ 09028000
         B     @RC02341                                            2370 09029000
@RF02341 DS    0H                                                  2371 09030000
*                   RPLVRETC=FOUR;  /* SET BAD RC            @Y30LB26*/ 09031000
         L     @02,RPLVPTR                                         2371 09032000
         MVC   RPLVRETC(2,@02),@CB00749                            2371 09033000
*                   RPLRCODE=INCOMSS1;/* INCOMPAT SS1 ATT    @Y30LB26*/ 09034000
         MVC   RPLRCODE(2,@02),@CB00827                            2372 09035000
*                   CALL ERREXIT;   /* SAVE RET CODES        @Y30LB26*/ 09036000
         BAL   @14,ERREXIT                                         2373 09037000
*                   RETURN;         /*                       @Y30LB26*/ 09038000
         B     @EL00038                                            2374 09039000
*                 END;              /*                       @Y30LB26*/ 09040000
*             END;                  /*                       @Y30LB26*/ 09041000
*                                                                  2376 09042000
@RC02341 DS    0H                                                  2377 09043000
*           /*********************************************************/ 09044000
*           /*                                                       */ 09045000
*           /* SEE IF RECORD WAS IN GROUP BEFORE             @Y30LB26*/ 09046000
*           /*                                                       */ 09047000
*           /*********************************************************/ 09048000
*                                                                  2377 09049000
*           IF BASGRPV=ON THEN      /* VOLUME GROUPED        @Y30LB26*/ 09050000
*                                                                  2377 09051000
@RF02324 L     @02,BASEVPTR                                        2377 09052000
         TM    BASGRPV(@02),B'00100000'                            2377 09053000
         BNO   @RF02377                                            2377 09054000
*             /*******************************************************/ 09055000
*             /*                                                     */ 09056000
*             /* GO REMOVE RECORD FROM GROUP CHAIN           @Y30LB26*/ 09057000
*             /*                                                     */ 09058000
*             /*******************************************************/ 09059000
*                                                                  2378 09060000
*             DO;                   /*                       @Y30LB26*/ 09061000
*               CALL GROUPOUT;      /* GET REC OUT OF GROUP  @Y30LB26*/ 09062000
         BAL   @14,GROUPOUT                                        2379 09063000
*               IF RPLVRETC¬=RCZERO THEN/* CK RETURN CODE    @Y30LB26*/ 09064000
         L     @02,RPLVPTR                                         2380 09065000
         CLC   RPLVRETC(2,@02),@CB00747                            2380 09066000
         BNE   @RT02380                                            2380 09067000
*                 RETURN;           /*                       @Y30LB26*/ 09068000
*             END;                  /*                       @Y30LB26*/ 09069000
*           ELSE                    /*                       @Y30LB26*/ 09070000
*                                                                  2383 09071000
*             /*******************************************************/ 09072000
*             /*                                                     */ 09073000
*             /* GO TAKE RECORD OUT OF NON-GROUP             @Y30LB26*/ 09074000
*             /*                                                     */ 09075000
*             /*******************************************************/ 09076000
*                                                                  2383 09077000
*             DO;                   /*                       @Y30LB26*/ 09078000
         B     @RC02377                                            2383 09079000
@RF02377 DS    0H                                                  2384 09080000
*               CALL NGRPOUT;       /* GET REC OUT NON-GRP   @Y30LB26*/ 09081000
         BAL   @14,NGRPOUT                                         2384 09082000
*               IF RPLVRETC¬=RCZERO THEN/* CK RETURN         @Y30LB26*/ 09083000
         L     @02,RPLVPTR                                         2385 09084000
         CLC   RPLVRETC(2,@02),@CB00747                            2385 09085000
         BNE   @RT02385                                            2385 09086000
*                 RETURN;           /*                       @Y30LB26*/ 09087000
*             END;                  /*                       @Y30LB26*/ 09088000
*                                                                  2387 09089000
*           /*********************************************************/ 09090000
*           /*                                                       */ 09091000
*           /* GO PUT RECORD INTO GROUP                      @Y30LB26*/ 09092000
*           /*                                                       */ 09093000
*           /*********************************************************/ 09094000
*                                                                  2388 09095000
*           CALL GROUPIN;           /* PUT RECORD INTO GRP   @Y30LB26*/ 09096000
@RC02377 BAL   @14,GROUPIN                                         2388 09097000
*           IF RPLVRETC¬=RCZERO THEN/* WAS IT SUCCESSFUL     @Y30LB26*/ 09098000
         L     @02,RPLVPTR                                         2389 09099000
         CLC   RPLVRETC(2,@02),@CB00747                            2389 09100000
         BNE   @RT02389                                            2389 09101000
*             RETURN;               /*                       @Y30LB26*/ 09102000
*                                                                  2390 09103000
*           /*********************************************************/ 09104000
*           /*                                                       */ 09105000
*           /* GO UPDATE THE COMMON FIELDS IN THE BASE REC   @Y30LB26*/ 09106000
*           /*                                                       */ 09107000
*           /*********************************************************/ 09108000
*                                                                  2391 09109000
*           CALL COMMON;            /* UPD COM FIELD IN BASE @Y30LB26*/ 09110000
         BAL   @14,COMMON                                          2391 09111000
*           RETURN;                 /*                       @Y30LB26*/ 09112000
         B     @EL00038                                            2392 09113000
*         END;                      /*                       @Y30LB26*/ 09114000
*     END;                          /*                       @Y30LB26*/ 09115000
*                                                                  2394 09116000
@RF02322 DS    0H                                                  2395 09117000
*   /*****************************************************************/ 09118000
*   /*                                                               */ 09119000
*   /* CHECK FOR CHANGE TO NON-GROUPED                       @Y30LB26*/ 09120000
*   /*                                                               */ 09121000
*   /*****************************************************************/ 09122000
*                                                                  2395 09123000
*   IF MVRNGRP=ON&BASGRPV=ON THEN   /* GOING NON-GRP?        @Y30LB26*/ 09124000
@RF02320 L     @02,MVRPTR                                          2395 09125000
         TM    MVRNGRP(@02),B'00100000'                            2395 09126000
         BNO   @RF02395                                            2395 09127000
         L     @02,BASEVPTR                                        2395 09128000
         TM    BASGRPV(@02),B'00100000'                            2395 09129000
         BNO   @RF02395                                            2395 09130000
*     DO;                           /*                       @Y30LB26*/ 09131000
*                                                                  2396 09132000
*       /*************************************************************/ 09133000
*       /*                                                           */ 09134000
*       /* GO TAKE RECORD OUT OF GROUP THAT IT IS NOW IN     @Y30LB26*/ 09135000
*       /*                                                           */ 09136000
*       /*************************************************************/ 09137000
*                                                                  2397 09138000
*       CALL GROUPOUT;              /* GET IT OUT OF GRP     @Y30LB26*/ 09139000
         BAL   @14,GROUPOUT                                        2397 09140000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @Y30LB26*/ 09141000
         L     @02,RPLVPTR                                         2398 09142000
         CLC   RPLVRETC(2,@02),@CB00747                            2398 09143000
         BNE   @RT02398                                            2398 09144000
*         RETURN;                   /*                       @Y30LB26*/ 09145000
*                                                                  2399 09146000
*       /*************************************************************/ 09147000
*       /*                                                           */ 09148000
*       /* GO PUT RECORD IN NON-GROUP CATAGORY               @Y30LB26*/ 09149000
*       /*                                                           */ 09150000
*       /*************************************************************/ 09151000
*                                                                  2400 09152000
*       CALL NGROUPIN;              /* PUT IN NON-GRPED      @Y30LB26*/ 09153000
         BAL   @14,NGROUPIN                                        2400 09154000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN CODE        @Y30LB26*/ 09155000
         L     @02,RPLVPTR                                         2401 09156000
         CLC   RPLVRETC(2,@02),@CB00747                            2401 09157000
         BNE   @RT02401                                            2401 09158000
*         RETURN;                   /*                       @Y30LB26*/ 09159000
*                                                                  2402 09160000
*       /*************************************************************/ 09161000
*       /*                                                           */ 09162000
*       /* GO UPDATE COMMON FIELDS IN BASE REC               @Y30LB26*/ 09163000
*       /*                                                           */ 09164000
*       /*************************************************************/ 09165000
*                                                                  2403 09166000
*       CALL COMMON;                /* UPDATE COMMON FIELDS  @Y30LB26*/ 09167000
         BAL   @14,COMMON                                          2403 09168000
*       RETURN;                     /*                       @Y30LB26*/ 09169000
         B     @EL00038                                            2404 09170000
*     END;                          /*                       @Y30LB26*/ 09171000
*                                                                  2405 09172000
*   /*****************************************************************/ 09173000
*   /*                                                               */ 09174000
*   /* THIS A GROUPED VOLUME ?                               @Y30LB26*/ 09175000
*   /*                                                               */ 09176000
*   /*****************************************************************/ 09177000
*                                                                  2406 09178000
*   IF BASGRPV=ON THEN              /* THIS A GRPED VOL?     @Y30LB26*/ 09179000
@RF02395 L     @02,BASEVPTR                                        2406 09180000
         TM    BASGRPV(@02),B'00100000'                            2406 09181000
         BNO   @RF02406                                            2406 09182000
*     DO;                           /*                       @Y30LB26*/ 09183000
*                                                                  2407 09184000
*       /*************************************************************/ 09185000
*       /*                                                           */ 09186000
*       /* WANT TO CHANGE TO GENERAL USE ?                   @Y30LB26*/ 09187000
*       /*                                                           */ 09188000
*       /*************************************************************/ 09189000
*                                                                  2408 09190000
*       IF MVRGEN=ON THEN           /* WANT GENERAL USE?     @Y30LB26*/ 09191000
         L     @01,MVRPTR                                          2408 09192000
         TM    MVRGEN(@01),B'10000000'                             2408 09193000
         BNO   @RF02408                                            2408 09194000
*         DO;                       /*                       @Y30LB26*/ 09195000
*                                                                  2409 09196000
*           /*********************************************************/ 09197000
*           /*                                                       */ 09198000
*           /* WAS IT RESTRICTED BEFORE ?                    @Y30LB26*/ 09199000
*           /*                                                       */ 09200000
*           /*********************************************************/ 09201000
*                                                                  2410 09202000
*           IF BASRSTD=ON THEN      /* WAS RESTRICTED?       @Y30LB26*/ 09203000
*                                                                  2410 09204000
         TM    BASRSTD(@02),B'00001000'                            2410 09205000
         BNO   @RF02410                                            2410 09206000
*             /*******************************************************/ 09207000
*             /*                                                     */ 09208000
*             /* SINCE RESTRICTED BEFORE AND GOING GENERAL   @Y30LB26*/ 09209000
*             /* GO MAKE INTO A GENERAL VOLUME IN THE        @Y30LB26*/ 09210000
*             /* SAME GROUP                                  @Y30LB26*/ 09211000
*             /*                                                     */ 09212000
*             /*******************************************************/ 09213000
*                                                                  2411 09214000
*             DO;                   /*                       @Y30LB26*/ 09215000
*               CALL GENERAL;       /* GO FROM RESTRCTED-GEN @Y30LB26*/ 09216000
         BAL   @14,GENERAL                                         2412 09217000
*               IF RPLRCODE¬=RCZERO THEN/* RETURN CODE       @Y30LB26*/ 09218000
         L     @02,RPLVPTR                                         2413 09219000
         CLC   RPLRCODE(2,@02),@CB00747                            2413 09220000
         BNE   @RT02413                                            2413 09221000
*                 RETURN;           /*                       @Y30LB26*/ 09222000
*                                                                  2414 09223000
*               /*****************************************************/ 09224000
*               /*                                                   */ 09225000
*               /* GO FILL IN ANY COMMON FIELDS IN BASE VOL  @Y30LB26*/ 09226000
*               /*                                                   */ 09227000
*               /*****************************************************/ 09228000
*                                                                  2415 09229000
*               CALL COMMON;        /* UPDATE COMMON FIELDS  @Y30LB26*/ 09230000
         BAL   @14,COMMON                                          2415 09231000
*               RETURN;             /*                       @Y30LB26*/ 09232000
         B     @EL00038                                            2416 09233000
*             END;                  /*                       @Y30LB26*/ 09234000
*         END;                      /*                       @Y30LB26*/ 09235000
*                                                                  2418 09236000
@RF02410 DS    0H                                                  2419 09237000
*       /*************************************************************/ 09238000
*       /*                                                           */ 09239000
*       /* IS A CHANGE TO RESTRICTED USE BEING CALLED FOR ?  @Y30LB26*/ 09240000
*       /*                                                           */ 09241000
*       /*************************************************************/ 09242000
*                                                                  2419 09243000
*       IF MVRRSTD=ON THEN          /* WANT RESTRICTED USE?  @Y30LB26*/ 09244000
@RF02408 L     @02,MVRPTR                                          2419 09245000
         TM    MVRRSTD(@02),B'01000000'                            2419 09246000
         BNO   @RF02419                                            2419 09247000
*         DO;                       /*                       @Y30LB26*/ 09248000
*                                                                  2420 09249000
*           /*********************************************************/ 09250000
*           /*                                                       */ 09251000
*           /* WAS IT A GENERAL USE VOL BEFORE ?             @Y30LB26*/ 09252000
*           /*                                                       */ 09253000
*           /*********************************************************/ 09254000
*                                                                  2421 09255000
*           IF BASGENUS=ON THEN     /* WAS GENERAL BEFORE?   @Y30LB26*/ 09256000
*                                                                  2421 09257000
         L     @02,BASEVPTR                                        2421 09258000
         TM    BASGENUS(@02),B'00010000'                           2421 09259000
         BNO   @RF02421                                            2421 09260000
*             /*******************************************************/ 09261000
*             /*                                                     */ 09262000
*             /* SINCE WAS GENERAL USE BEFORE AND IS GOING   @Y30LB26*/ 09263000
*             /* RESTRICTED, GO MAKE RESTRICTED IN THE SAME  @Y30LB26*/ 09264000
*             /* GROUP THAT IT WAS IN                        @Y30LB26*/ 09265000
*             /*                                                     */ 09266000
*             /*******************************************************/ 09267000
*                                                                  2422 09268000
*             DO;                   /*                       @Y30LB26*/ 09269000
*               CALL RESTRICT;      /* PROCESS AS RESTRCTED  @Y30LB26*/ 09270000
         BAL   @14,RESTRICT                                        2423 09271000
*               IF RPLVRETC¬=RCZERO THEN/* CK RETURN CODE    @Y30LB26*/ 09272000
         L     @02,RPLVPTR                                         2424 09273000
         CLC   RPLVRETC(2,@02),@CB00747                            2424 09274000
         BNE   @RT02424                                            2424 09275000
*                 RETURN;           /*                       @Y30LB26*/ 09276000
*                                                                  2425 09277000
*               /*****************************************************/ 09278000
*               /*                                                   */ 09279000
*               /* FILL IN COMMON FIELDS IN BASE REC         @Y30LB26*/ 09280000
*               /*                                                   */ 09281000
*               /*****************************************************/ 09282000
*                                                                  2426 09283000
*               CALL COMMON;        /* FIELD IN COM FIELDS   @Y30LB26*/ 09284000
         BAL   @14,COMMON                                          2426 09285000
*               RETURN;             /*                       @Y30LB26*/ 09286000
         B     @EL00038                                            2427 09287000
*             END;                  /*                       @Y30LB26*/ 09288000
*         END;                      /*                       @Y30LB26*/ 09289000
@RF02421 DS    0H                                                  2430 09290000
*     END;                          /*                       @Y30LB26*/ 09291000
*                                                                  2430 09292000
@RF02419 DS    0H                                                  2431 09293000
*   /*****************************************************************/ 09294000
*   /*                                                               */ 09295000
*   /* IF VOLUME DID NOT CHANGE GROUPS OR CLASIFICATION,     @Y30LB26*/ 09296000
*   /* CALL COMMON TO CHANGE ANY OTHER FIELDS SPECIFIED      @Y30LB26*/ 09297000
*   /*                                                               */ 09298000
*   /*****************************************************************/ 09299000
*                                                                  2431 09300000
*   CALL COMMON;                    /* UPDATE REMAINING      @Y30LB26*/ 09301000
@RF02406 BAL   @14,COMMON                                          2431 09302000
*   RETURN;                         /*                       @Y30LB26*/ 09303000
         B     @EL00038                                            2432 09304000
*   END MODIFYV;                    /*                       @Y30LB26*/ 09305000
         B     @EL00038                                            2433 09306000
*                                                                  2434 09307000
*   /*****************************************************************/ 09308000
*   /*                                                               */ 09309000
*   /* THIS ROUTINE READS A CARTRIDGE INDEX RECORD AND GETS  @Y30LB26*/ 09310000
*   /* ITS OWNER KEY WHICH IS A COPY VOL RECORD AND          @Y30LB26*/ 09311000
*   /* CHANGES IT TO A BACKUP AND/OR CLEARS THE INCOMPLETE   @Y30LB26*/ 09312000
*   /* COPY FLAG. IF IT MADE A NEW BACKUP, IT THEN READS     @Y30LB26*/ 09313000
*   /* THE BASE VOLUME RECORD AND ADDS ONE TO THE NUMBER OF  @Y30LB26*/ 09314000
*   /* BACKUP COPIES.                                        @Y30LB26*/ 09315000
*   /*                                                               */ 09316000
*   /*****************************************************************/ 09317000
*                                                                  2434 09318000
*MODCOPY:                                                          2434 09319000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 09320000
MODCOPY  ST    @14,@SA00039                                        2434 09321000
*   IF MVRCICPY=OFF&MVRBKUP=OFF THEN/* VALID REQUEST ?       @Y30LB26*/ 09322000
         L     @02,MVRPTR                                          2435 09323000
         TM    MVRCICPY(@02),B'01000000'                           2435 09324000
         BNZ   @RF02435                                            2435 09325000
         TM    MVRBKUP(@02),B'00010000'                            2435 09326000
         BNZ   @RF02435                                            2435 09327000
*     DO;                           /*                       #Y30LB26*/ 09328000
*       RPLVRETC=FOUR;              /* BAD RET CODE          @Y30LB26*/ 09329000
         L     @02,RPLVPTR                                         2437 09330000
         MVC   RPLVRETC(2,@02),@CB00749                            2437 09331000
*       RPLRCODE=INVALCPY;          /* CSN MUST BE GIVEN     @Y30LB26*/ 09332000
         MVC   RPLRCODE(2,@02),@CB00803                            2438 09333000
*       CALL ERREXIT;               /* SAVE REASON CODES     @Y30LB26*/ 09334000
         BAL   @14,ERREXIT                                         2439 09335000
*       RETURN;                     /*                       @Y30LB26*/ 09336000
@EL00039 DS    0H                                                  2440 09337000
@EF00039 DS    0H                                                  2440 09338000
@ER00039 L     @14,@SA00039                                        2440 09339000
         BR    @14                                                 2440 09340000
*     END;                          /*                       @Y30LB26*/ 09341000
*                                                                  2441 09342000
*   /*****************************************************************/ 09343000
*   /*                                                               */ 09344000
*   /* GET CARTRIDGE INDEX NUMBER AND READ INDEX RECORD      @Y30LB26*/ 09345000
*   /*                                                               */ 09346000
*   /*****************************************************************/ 09347000
*                                                                  2442 09348000
*   CARTKY=MVRCSN;                  /* CART SERIAL NUMBER    #Y30LB26*/ 09349000
@RF02435 L     @02,MVRPTR                                          2442 09350000
         MVC   CARTKY(12),MVRCSN(@02)                              2442 09351000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           #Y30LB26*/ 09352000
         L     @02,RPLVPTR                                         2443 09353000
         LA    @15,IKEY                                            2443 09354000
         ST    @15,RPLVKEY(,@02)                                   2443 09355000
*   RPLVLOC=ON;                     /* LOCATE MODE           #Y30LB26*/ 09356000
*   RPLVDIR=ON;                     /* READ DIRECT           #Y30LB26*/ 09357000
         OI    RPLVLOC(@02),B'11000000'                            2445 09358000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @Y30LB26*/ 09359000
         MVI   RPLVTYP(@02),X'00'                                  2446 09360000
*   RESPECIFY                                                      2447 09361000
*     REG1 RSTD;                    /* RESPRICT REG 1        @Y30LB26*/ 09362000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 09363000
         LR    REG1,@02                                            2448 09364000
*   CALL ICBVIO00;                  /* READ INDEX REC        @Y30LB26*/ 09365000
         L     @15,@CV00671                                        2449 09366000
         BALR  @14,@15                                             2449 09367000
*   RESPECIFY                                                      2450 09368000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 09369000
*                                                                  2450 09370000
*   /*****************************************************************/ 09371000
*   /*                                                               */ 09372000
*   /* CHECK RETURN CODE FROM I/O                            @Y30LB26*/ 09373000
*   /*                                                               */ 09374000
*   /*****************************************************************/ 09375000
*                                                                  2451 09376000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 09377000
         L     @02,RPLVPTR                                         2451 09378000
         CLC   RPLVRETC(2,@02),@CB00747                            2451 09379000
         BE    @RF02451                                            2451 09380000
*     DO;                           /*                       @Y30LB26*/ 09381000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 09382000
         BAL   @14,ERREXIT                                         2453 09383000
*       RETURN;                     /*                       @Y30LB26*/ 09384000
         B     @EL00039                                            2454 09385000
*     END;                          /*                       @Y30LB26*/ 09386000
*                                                                  2455 09387000
*   /*****************************************************************/ 09388000
*   /*                                                               */ 09389000
*   /* GET ADDRESSING TO INDEX RECORD AND THEN GET ITS OWNER @Y30LB26*/ 09390000
*   /* KEY                                                   @Y30LB26*/ 09391000
*   /*                                                               */ 09392000
*   /*****************************************************************/ 09393000
*                                                                  2456 09394000
*   INDEXPTR=RPLVBUF;               /* ADDR OF RECORD        #Y30LB26*/ 09395000
*                                                                  2456 09396000
@RF02451 L     @02,RPLVPTR                                         2456 09397000
         L     INDEXPTR,RPLVBUF(,@02)                              2456 09398000
*   /*****************************************************************/ 09399000
*   /*                                                               */ 09400000
*   /* CHECK TO SEE IF RECORD OWNING THIS INDEX CART         @Y30LB26*/ 09401000
*   /* IS REALLY A COPY VOLUME RECORD                        @Y30LB26*/ 09402000
*   /*                                                               */ 09403000
*   /*****************************************************************/ 09404000
*                                                                  2457 09405000
*   IF INDPREFX¬=VKY|INDEXREC=BIT8ZERO THEN/* COPY REC ?     @Y30LB26*/ 09406000
         CLC   INDPREFX(5,INDEXPTR),VKY                            2457 09407000
         BNE   @RT02457                                            2457 09408000
         CLI   INDEXREC(INDEXPTR),X'00'                            2457 09409000
         BNE   @RF02457                                            2457 09410000
@RT02457 DS    0H                                                  2458 09411000
*     DO;                           /*                       @Y30LB26*/ 09412000
*       RPLVRETC=FOUR;              /* BAD RET CODE          @Y30LB26*/ 09413000
         L     @02,RPLVPTR                                         2459 09414000
         MVC   RPLVRETC(2,@02),@CB00749                            2459 09415000
*       RPLRCODE=INVALCPY;          /* INVALID CSN SPEC      @Y30LB26*/ 09416000
         MVC   RPLRCODE(2,@02),@CB00803                            2460 09417000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 09418000
         BAL   @14,ERREXIT                                         2461 09419000
*       RETURN;                     /*                       @Y30LB26*/ 09420000
         B     @EL00039                                            2462 09421000
*     END;                          /*                       @Y30LB26*/ 09422000
*   VKEY=INDRECKY;                  /* KEY COPY REC          #Y30LB26*/ 09423000
@RF02457 MVC   VKEY(13),INDRECKY(INDEXPTR)                         2464 09424000
*   RPLVKEY=ADDR(VKEY);             /* ADDR OF KEY           #Y30LB26*/ 09425000
         L     @02,RPLVPTR                                         2465 09426000
         LA    @15,VKEY                                            2465 09427000
         ST    @15,RPLVKEY(,@02)                                   2465 09428000
*   RPLVBUF=ADDR(STORCPY);          /* ADDR OF BUFFER        #Y30LB26*/ 09429000
         LA    @15,STORCPY                                         2466 09430000
         ST    @15,RPLVBUF(,@02)                                   2466 09431000
*   RPLVBLN=LENGTH(STORCPY);        /* LENGTH OF BUFFER      #Y30LB26*/ 09432000
         MVC   RPLVBLN(4,@02),@CF01147                             2467 09433000
*   RPLVLOC=OFF;                    /* NOT LOCATE            #Y30LB26*/ 09434000
         NI    RPLVLOC(@02),B'01111111'                            2468 09435000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           #Y30LB26*/ 09436000
         MVI   RPLVTYP(@02),X'00'                                  2469 09437000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       #Y30LB26*/ 09438000
         OI    RPLVUPD(@02),B'00000010'                            2470 09439000
*   RESPECIFY                                                      2471 09440000
*     REG1 RSTD;                    /* RESPRICT REG 1        #Y30LB26*/ 09441000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          #Y30LB26*/ 09442000
         LR    REG1,@02                                            2472 09443000
*   CALL ICBVIO00;                  /* READ INDEX REC        #Y30LB26*/ 09444000
         L     @15,@CV00671                                        2473 09445000
         BALR  @14,@15                                             2473 09446000
*   RESPECIFY                                                      2474 09447000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 09448000
*                                                                  2474 09449000
*   /*****************************************************************/ 09450000
*   /*                                                               */ 09451000
*   /* CHECK RETURN CODE FROM I/O                            @Y30LB26*/ 09452000
*   /*                                                               */ 09453000
*   /*****************************************************************/ 09454000
*                                                                  2475 09455000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 09456000
         L     @02,RPLVPTR                                         2475 09457000
         CLC   RPLVRETC(2,@02),@CB00747                            2475 09458000
         BE    @RF02475                                            2475 09459000
*     DO;                           /*                       @Y30LB26*/ 09460000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 09461000
         BAL   @14,ERREXIT                                         2477 09462000
*       RETURN;                     /*                       @Y30LB26*/ 09463000
         B     @EL00039                                            2478 09464000
*     END;                          /*                       @Y30LB26*/ 09465000
*                                                                  2479 09466000
*   /*****************************************************************/ 09467000
*   /*                                                               */ 09468000
*   /* GET ADDRESS OF COPY RECORD JUST READ AND MAKE IT      @Y30LB26*/ 09469000
*   /* A BACKUP AND/OR CLEAR INCOMPLETE COPY FLAG            @Y30LB26*/ 09470000
*   /*                                                               */ 09471000
*   /*****************************************************************/ 09472000
*                                                                  2480 09473000
*   COPYVPTR=ADDR(STORCPY);         /* ADDR COPY RECORD      #Y30LB26*/ 09474000
@RF02475 LA    @02,STORCPY                                         2480 09475000
         ST    @02,COPYVPTR                                        2480 09476000
*   IF MVRBKUP=ON THEN              /* WANT TO MAKE BACKUP ? @Y30LB26*/ 09477000
         L     @01,MVRPTR                                          2481 09478000
         TM    MVRBKUP(@01),B'00010000'                            2481 09479000
         BNO   @RF02481                                            2481 09480000
*     COPBKUP=ON;                   /* MAKE BACKUP           @Y30LB26*/ 09481000
         OI    COPBKUP(@02),B'00001000'                            2482 09482000
*   IF MVRCICPY=ON THEN             /* WANT CLEAR INCOM BKUP @Y30LB26*/ 09483000
@RF02481 L     @02,MVRPTR                                          2483 09484000
         TM    MVRCICPY(@02),B'01000000'                           2483 09485000
         BNO   @RF02483                                            2483 09486000
*     COPIVCPY=OFF;                 /* CLEAR INCOM COPY FLAG @Y30LB26*/ 09487000
*                                                                  2484 09488000
         L     @02,COPYVPTR                                        2484 09489000
         NI    COPIVCPY(@02),B'10111111'                           2484 09490000
*   /*****************************************************************/ 09491000
*   /*                                                               */ 09492000
*   /* WRITE COPY RECORD                                     #Y30LB26*/ 09493000
*   /*                                                               */ 09494000
*   /*****************************************************************/ 09495000
*                                                                  2485 09496000
*   RPLVTYP=RPLVPUT;                /* INDICATE A WRITE      #Y30LB26*/ 09497000
@RF02483 L     @02,RPLVPTR                                         2485 09498000
         MVI   RPLVTYP(@02),X'01'                                  2485 09499000
*   RESPECIFY                                                      2486 09500000
*     REG1 RSTD;                    /* RESPRICT REG 1        #Y30LB26*/ 09501000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          #Y30LB26*/ 09502000
         LR    REG1,@02                                            2487 09503000
*   CALL ICBVIO00;                  /* READ INDEX REC        #Y30LB26*/ 09504000
         L     @15,@CV00671                                        2488 09505000
         BALR  @14,@15                                             2488 09506000
*   RESPECIFY                                                      2489 09507000
*     REG1 UNRSTD;                  /* FREE REG 1            #Y30LB26*/ 09508000
*                                                                  2489 09509000
*   /*****************************************************************/ 09510000
*   /*                                                               */ 09511000
*   /* CHECK RETURN CODE FROM I/O                            #Y30LB26*/ 09512000
*   /*                                                               */ 09513000
*   /*****************************************************************/ 09514000
*                                                                  2490 09515000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             #Y30LB26*/ 09516000
         L     @02,RPLVPTR                                         2490 09517000
         CLC   RPLVRETC(2,@02),@CB00747                            2490 09518000
         BE    @RF02490                                            2490 09519000
*     DO;                           /*                       #Y30LB26*/ 09520000
*       CALL ERREXIT;               /* SAVE RET CODES        #Y30LB26*/ 09521000
         BAL   @14,ERREXIT                                         2492 09522000
*       RETURN;                     /*                       #Y30LB26*/ 09523000
         B     @EL00039                                            2493 09524000
*     END;                          /*                       #Y30LB26*/ 09525000
*                                                                  2494 09526000
*   /*****************************************************************/ 09527000
*   /*                                                               */ 09528000
*   /* IF IT WAS A SUCCESSFUL WRITE, THEN SEE IF JOURNALED   #Y30LB26*/ 09529000
*   /* BEFORE. IF IT WAS NOT, JOURNAL THE RPLV.              #Y30LB26*/ 09530000
*   /*                                                               */ 09531000
*   /*****************************************************************/ 09532000
*                                                                  2495 09533000
*   IF JRNLEDSW=OFF THEN            /* JOURNALED BEFORE      #Y30LB26*/ 09534000
@RF02490 TM    JRNLEDSW,B'00000001'                                2495 09535000
         BNZ   @RF02495                                            2495 09536000
*     DO;                           /*                       #Y30LB26*/ 09537000
*       CALL JOURNAL;               /*                       #Y30LB26*/ 09538000
         BAL   @14,JOURNAL                                         2497 09539000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             #Y30LB26*/ 09540000
         L     @02,RPLVPTR                                         2498 09541000
         CLC   RPLVRETC(2,@02),@CB00747                            2498 09542000
         BE    @RF02498                                            2498 09543000
*         DO;                       /*                       #Y30LB26*/ 09544000
*           CALL ERREXIT;           /* FREE INVENTORY        #Y30LB26*/ 09545000
         BAL   @14,ERREXIT                                         2500 09546000
*           RETURN;                 /*                       #Y30LB26*/ 09547000
         B     @EL00039                                            2501 09548000
*         END;                      /*                       #Y30LB26*/ 09549000
*     END;                          /*                       #Y30LB26*/ 09550000
*                                                                  2503 09551000
@RF02498 DS    0H                                                  2504 09552000
*   /*****************************************************************/ 09553000
*   /*                                                               */ 09554000
*   /* IF COPY WAS MADE INTO A BACKUP,                       @Y30LB26*/ 09555000
*   /* READ THE BASE VOLUME RECORD TO ADD ONE TO NUMBER      #Y30LB26*/ 09556000
*   /* OF BACKUP COPIES FOR THAT VOLUME                      #Y30LB26*/ 09557000
*   /*                                                               */ 09558000
*   /*****************************************************************/ 09559000
*                                                                  2504 09560000
*   IF MVRBKUP=ON THEN              /* WAS BACKUP REQUEST ?  @Y30LB26*/ 09561000
@RF02495 L     @02,MVRPTR                                          2504 09562000
         TM    MVRBKUP(@02),B'00010000'                            2504 09563000
         BNO   @RF02504                                            2504 09564000
*     DO;                           /*                       @Y30LB26*/ 09565000
*       VIDKY=FIXZERO;              /* SET ID TO ZERO        @Y30LB26*/ 09566000
         MVI   VIDKY,X'00'                                         2506 09567000
*       RPLVKEY=ADDR(VKEY);         /* ADDR OF KEY           @Y30LB26*/ 09568000
         L     @02,RPLVPTR                                         2507 09569000
         LA    @15,VKEY                                            2507 09570000
         ST    @15,RPLVKEY(,@02)                                   2507 09571000
*       RPLVBUF=ADDR(STORBASE);     /* ADDR OF BUFFER        @Y30LB26*/ 09572000
         LA    @15,STORBASE                                        2508 09573000
         ST    @15,RPLVBUF(,@02)                                   2508 09574000
*       RPLVBLN=LENGTH(STORBASE);   /* LENGTH BUFFER         @Y30LB26*/ 09575000
         MVC   RPLVBLN(4,@02),@CF01147                             2509 09576000
*       RPLVTYP=RPLVREAD;           /* READ RECORD           @Y30LB26*/ 09577000
         MVI   RPLVTYP(@02),X'00'                                  2510 09578000
*       RPLVUPD=ON;                 /* FOR UPDATE            @Y30LB26*/ 09579000
         OI    RPLVUPD(@02),B'00000010'                            2511 09580000
*       RESPECIFY                                                  2512 09581000
*         REG1 RSTD;                /* RESPRICT REG 1        @Y30LB26*/ 09582000
*       REG1=RPLVPTR;               /* ADDR OF RPLV          @Y30LB26*/ 09583000
         LR    REG1,@02                                            2513 09584000
*       CALL ICBVIO00;              /* READ INDEX REC        @Y30LB26*/ 09585000
         L     @15,@CV00671                                        2514 09586000
         BALR  @14,@15                                             2514 09587000
*       RESPECIFY                                                  2515 09588000
*         REG1 UNRSTD;              /* FREE REG 1            @Y30LB26*/ 09589000
*                                                                  2515 09590000
*       /*************************************************************/ 09591000
*       /*                                                           */ 09592000
*       /* CHECK RETURN CODE FROM I/O                        @Y30LB26*/ 09593000
*       /*                                                           */ 09594000
*       /*************************************************************/ 09595000
*                                                                  2516 09596000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @Y30LB26*/ 09597000
         L     @02,RPLVPTR                                         2516 09598000
         CLC   RPLVRETC(2,@02),@CB00747                            2516 09599000
         BE    @RF02516                                            2516 09600000
*         DO;                       /*                       @Y30LB26*/ 09601000
*           CALL ERREXIT;           /* SAVE RET CODES        @Y30LB26*/ 09602000
         BAL   @14,ERREXIT                                         2518 09603000
*           RETURN;                 /*                       @Y30LB26*/ 09604000
         B     @EL00039                                            2519 09605000
*         END;                      /*                       @Y30LB26*/ 09606000
*                                                                  2520 09607000
*       /*************************************************************/ 09608000
*       /*                                                           */ 09609000
*       /* GET ADDRESS OF BASE VOLUME RECORD AND ADD ONE     @Y30LB26*/ 09610000
*       /* TO NUMBER OF BACKUP COPIES                        @Y30LB26*/ 09611000
*       /*                                                           */ 09612000
*       /*************************************************************/ 09613000
*                                                                  2521 09614000
*       BASEVPTR=ADDR(STORBASE);    /* ADDR BASE RECORD      @Y30LB26*/ 09615000
@RF02516 LA    @02,STORBASE                                        2521 09616000
         ST    @02,BASEVPTR                                        2521 09617000
*       BASNBKUP=BASNBKUP+ONE;      /* ADD ONE BACKUP        @Y30LB26*/ 09618000
*                                                                  2522 09619000
         LA    @15,1                                               2522 09620000
         SLR   @14,@14                                             2522 09621000
         IC    @14,BASNBKUP(,@02)                                  2522 09622000
         ALR   @15,@14                                             2522 09623000
         STC   @15,BASNBKUP(,@02)                                  2522 09624000
*       /*************************************************************/ 09625000
*       /*                                                           */ 09626000
*       /* WRITE BASE VOLUME RECORD                          @Y30LB26*/ 09627000
*       /*                                                           */ 09628000
*       /*************************************************************/ 09629000
*                                                                  2523 09630000
*       RPLVTYP=RPLVPUT;            /* PUT RECORD            @Y30LB26*/ 09631000
         L     @02,RPLVPTR                                         2523 09632000
         MVI   RPLVTYP(@02),X'01'                                  2523 09633000
*       RESPECIFY                                                  2524 09634000
*         REG1 RSTD;                /* RESPRICT REG 1        @Y30LB26*/ 09635000
*       REG1=RPLVPTR;               /* ADDR OF RPLV          @Y30LB26*/ 09636000
         LR    REG1,@02                                            2525 09637000
*       CALL ICBVIO00;              /* READ INDEX REC        @Y30LB26*/ 09638000
         L     @15,@CV00671                                        2526 09639000
         BALR  @14,@15                                             2526 09640000
*       RESPECIFY                                                  2527 09641000
*         REG1 UNRSTD;              /* FREE REG 1            @Y30LB26*/ 09642000
*                                                                  2527 09643000
*       /*************************************************************/ 09644000
*       /*                                                           */ 09645000
*       /* CHECK RETURN CODE FROM I/O                        @Y30LB26*/ 09646000
*       /*                                                           */ 09647000
*       /*************************************************************/ 09648000
*                                                                  2528 09649000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @Y30LB26*/ 09650000
         L     @02,RPLVPTR                                         2528 09651000
         CLC   RPLVRETC(2,@02),@CB00747                            2528 09652000
         BE    @RF02528                                            2528 09653000
*         DO;                       /*                       @Y30LB26*/ 09654000
*           CALL ERREXIT;           /* SAVE RET CODES        @Y30LB26*/ 09655000
         BAL   @14,ERREXIT                                         2530 09656000
*           RETURN;                 /*                       @Y30LB26*/ 09657000
         B     @EL00039                                            2531 09658000
*         END;                      /*                       @Y30LB26*/ 09659000
*                                                                  2532 09660000
*       /*************************************************************/ 09661000
*       /*                                                           */ 09662000
*       /* IF WAS SUCCESSFUL WRITE, THEN SEE IF JOURNALED    @Y30LB26*/ 09663000
*       /* BEFORE. IF IT WASNOT, JOURNAL THE RPLV.           @Y30LB26*/ 09664000
*       /*                                                           */ 09665000
*       /*************************************************************/ 09666000
*                                                                  2533 09667000
*       IF JRNLEDSW=OFF THEN        /* JOURNALED BEFORE      @Y30LB26*/ 09668000
@RF02528 TM    JRNLEDSW,B'00000001'                                2533 09669000
         BNZ   @RF02533                                            2533 09670000
*         DO;                       /*                       @Y30LB26*/ 09671000
*           CALL JOURNAL;           /*                       @Y30LB26*/ 09672000
         BAL   @14,JOURNAL                                         2535 09673000
*           IF RPLVRETC¬=RCZERO THEN/* CK RETURN             @Y30LB26*/ 09674000
         L     @02,RPLVPTR                                         2536 09675000
         CLC   RPLVRETC(2,@02),@CB00747                            2536 09676000
         BE    @RF02536                                            2536 09677000
*             DO;                   /*                       @Y30LB26*/ 09678000
*               CALL ERREXIT;       /* FREE INVENTORY        @Y30LB26*/ 09679000
         BAL   @14,ERREXIT                                         2538 09680000
*               RETURN;             /*                       @Y30LB26*/ 09681000
         B     @EL00039                                            2539 09682000
*             END;                  /*                       @Y30LB26*/ 09683000
*         END;                      /*                       @Y30LB26*/ 09684000
*     END;                          /*                       @Y30LB26*/ 09685000
*   RETURN;                         /*                       #Y30LB26*/ 09686000
         B     @EL00039                                            2543 09687000
*   END MODCOPY;                    /*                       #Y30LB26*/ 09688000
         B     @EL00039                                            2544 09689000
*                                                                  2545 09690000
*   /*****************************************************************/ 09691000
*   /*                                                               */ 09692000
*   /* THIS ROUTINE TAKES A BASE VOLUME RECORD OUT OF        #Y30LB26*/ 09693000
*   /* THE GROUP IT IS IN AND GETS IT READY TO GO            #Y30LB26*/ 09694000
*   /* EITHER INTO ANOTHER GROUP OR BECOME NON-GROUPED       #Y30LB26*/ 09695000
*   /*                                                               */ 09696000
*   /*****************************************************************/ 09697000
*                                                                  2545 09698000
*GROUPOUT:                                                         2545 09699000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 09700000
*                                                                  2545 09701000
GROUPOUT ST    @14,@SA00040                                        2545 09702000
*   /*****************************************************************/ 09703000
*   /*                                                               */ 09704000
*   /* READ THE OLD GROUP RECORD SO CAN GET VOL OUT OF IT    #Y30LB26*/ 09705000
*   /*                                                               */ 09706000
*   /*****************************************************************/ 09707000
*                                                                  2546 09708000
*   GROUPKY=BASGROUP;               /* GROUP NAME            #Y30LB26*/ 09709000
         L     @02,BASEVPTR                                        2546 09710000
         MVC   GROUPKY(8),BASGROUP(@02)                            2546 09711000
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           #Y30LB26*/ 09712000
         L     @02,RPLVPTR                                         2547 09713000
         LA    @15,GKEY                                            2547 09714000
         ST    @15,RPLVKEY(,@02)                                   2547 09715000
*   RPLVBUF=ADDR(STORGRP);          /* ADDR BUFFER           #Y30LB26*/ 09716000
         LA    @15,STORGRP                                         2548 09717000
         ST    @15,RPLVBUF(,@02)                                   2548 09718000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH BUFFER         #Y30LB26*/ 09719000
         MVC   RPLVBLN(4,@02),@CF01147                             2549 09720000
*   RPLVLOC=OFF;                    /* NO LOCATE             #Y30LB26*/ 09721000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 09722000
         OI    RPLVDIR(@02),B'01000000'                            2551 09723000
         NI    RPLVLOC(@02),B'01111111'                            2551 09724000
*   RPLVTYP=RPLVREAD;               /* READ GROUP            @Y30LB26*/ 09725000
         MVI   RPLVTYP(@02),X'00'                                  2552 09726000
*   RESPECIFY                                                      2553 09727000
*     REG1 RSTD;                    /* RESTRICT 1            @Y30LB26*/ 09728000
*   REG1=RPLVPTR;                   /* ADDR PRLV             @Y30LB26*/ 09729000
         LR    REG1,@02                                            2554 09730000
*   CALL ICBVIO00;                  /* READ GROUP REC        @Y30LB26*/ 09731000
         L     @15,@CV00671                                        2555 09732000
         BALR  @14,@15                                             2555 09733000
*   RESPECIFY                                                      2556 09734000
*     REG1 UNRSTD;                  /* FREE                  @Y30LB26*/ 09735000
*                                                                  2556 09736000
*   /*****************************************************************/ 09737000
*   /*                                                               */ 09738000
*   /* RETURN CODE FROM I/O PROCESSOR                        @Y30LB26*/ 09739000
*   /*                                                               */ 09740000
*   /*****************************************************************/ 09741000
*                                                                  2557 09742000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 09743000
         L     @02,RPLVPTR                                         2557 09744000
         CLC   RPLVRETC(2,@02),@CB00747                            2557 09745000
         BE    @RF02557                                            2557 09746000
*     DO;                           /*                       @Y30LB26*/ 09747000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 09748000
         BAL   @14,ERREXIT                                         2559 09749000
*       RETURN;                     /*                       @Y30LB26*/ 09750000
@EL00040 DS    0H                                                  2560 09751000
@EF00040 DS    0H                                                  2560 09752000
@ER00040 L     @14,@SA00040                                        2560 09753000
         BR    @14                                                 2560 09754000
*     END;                          /*                       @Y30LB26*/ 09755000
*                                                                  2561 09756000
*   /*****************************************************************/ 09757000
*   /*                                                               */ 09758000
*   /* GET ADDRESS OF RECORD JUST READ                       @Y30LB26*/ 09759000
*   /*                                                               */ 09760000
*   /*****************************************************************/ 09761000
*                                                                  2562 09762000
*   GROUPPTR=ADDR(STORGRP);         /* ADDRESSING TO BUFFER  @Y30LB26*/ 09763000
*                                                                  2562 09764000
@RF02557 LA    @02,STORGRP                                         2562 09765000
         ST    @02,GROUPPTR                                        2562 09766000
*   /*****************************************************************/ 09767000
*   /*                                                               */ 09768000
*   /* IF GENERAL USE BEFORE, DECREASE COUNT BY ONE          @Y30LB26*/ 09769000
*   /* RESTRICTED, DECREASE RESTRICTED COUNT                 @Y30LB26*/ 09770000
*   /*                                                               */ 09771000
*   /*****************************************************************/ 09772000
*                                                                  2563 09773000
*   IF BASGENUS=ON THEN             /* GEN USE?              @Y30LB26*/ 09774000
         L     @01,BASEVPTR                                        2563 09775000
         TM    BASGENUS(@01),B'00010000'                           2563 09776000
         BNO   @RF02563                                            2563 09777000
*     GRONGEN=GRONGEN-ONE;          /* DECREASE COUNT        @Y30LB26*/ 09778000
         LH    @15,GRONGEN(,@02)                                   2564 09779000
         BCTR  @15,0                                               2564 09780000
         STH   @15,GRONGEN(,@02)                                   2564 09781000
*   ELSE                            /*                       @Y30LB26*/ 09782000
*     GRONRSTD=GRONRSTD-ONE;        /* DECREASE RSTED COUNT  @Y30LB26*/ 09783000
*                                                                  2565 09784000
         B     @RC02563                                            2565 09785000
@RF02563 L     @02,GROUPPTR                                        2565 09786000
         LH    @15,GRONRSTD(,@02)                                  2565 09787000
         BCTR  @15,0                                               2565 09788000
         STH   @15,GRONRSTD(,@02)                                  2565 09789000
*   /*****************************************************************/ 09790000
*   /*                                                               */ 09791000
*   /* IF BASE VOL IS A GENERAL USE TYPE, GO REMOVE ITS      #Y30LB26*/ 09792000
*   /* SLOT IN THE EXTENSION RECORD                          #Y30LB26*/ 09793000
*   /*                                                               */ 09794000
*   /*****************************************************************/ 09795000
*                                                                  2566 09796000
*   IF BASGENUS=ON THEN             /* GENERAL USE VOL       #Y30LB26*/ 09797000
@RC02563 L     @02,BASEVPTR                                        2566 09798000
         TM    BASGENUS(@02),B'00010000'                           2566 09799000
         BNO   @RF02566                                            2566 09800000
*     DO;                           /*                       @Y30LB26*/ 09801000
*       ADDSLEXT=OFF;               /* INDICATE REMOVE SLOT  @Y30LB26*/ 09802000
         NI    ADDSLEXT,B'11111101'                                2568 09803000
*       SLOTEXP=OFF;                /* NO EXPIRATION CHANGE  @Y30LB26*/ 09804000
         NI    SLOTEXP,B'01111111'                                 2569 09805000
*       CALL VUEXT;                 /* REMOVE SLOT IN EXTEN  @Y30LB26*/ 09806000
         BAL   @14,VUEXT                                           2570 09807000
*       IF RPLVRETC¬=RCZERO THEN    /*                       @Y30LB26*/ 09808000
         L     @02,RPLVPTR                                         2571 09809000
         CLC   RPLVRETC(2,@02),@CB00747                            2571 09810000
         BE    @RF02571                                            2571 09811000
*         DO;                       /*                       @Y30LB26*/ 09812000
*           CALL ERREXIT;           /* FREE INVENTORY        @Y30LB26*/ 09813000
         BAL   @14,ERREXIT                                         2573 09814000
*           RETURN;                 /*                       @Y30LB26*/ 09815000
         B     @EL00040                                            2574 09816000
*         END;                      /*                       @Y30LB26*/ 09817000
*                                                                  2575 09818000
*       /*************************************************************/ 09819000
*       /*                                                           */ 09820000
*       /* CALL PROGRAM TO UPDATE SPACE FIELDS IN THE        @Y30LB26*/ 09821000
*       /* GROUP RECORD                                      @Y30LB26*/ 09822000
*       /*                                                           */ 09823000
*       /*************************************************************/ 09824000
*                                                                  2576 09825000
*       ADDGRP=OFF;                 /* INDICATE REMOV SPACE  @Y30LB26*/ 09826000
@RF02571 NI    ADDGRP,B'11110111'                                  2576 09827000
*       CALL ICBVUPGH(GROUPPTR,BASEVPTR,PASSFLAG);/*         @Y30LB26*/ 09828000
         L     @15,@CV00676                                        2577 09829000
         LA    @01,@AL02577                                        2577 09830000
         BALR  @14,@15                                             2577 09831000
*       IF RPLVRETC¬=RCZERO THEN    /*                       @Y30LB26*/ 09832000
         L     @02,RPLVPTR                                         2578 09833000
         CLC   RPLVRETC(2,@02),@CB00747                            2578 09834000
         BE    @RF02578                                            2578 09835000
*         DO;                       /*                       @Y30LB26*/ 09836000
*           CALL ERREXIT;           /* FREE INVENTORY        @Y30LB26*/ 09837000
         BAL   @14,ERREXIT                                         2580 09838000
*           RETURN;                 /*                       @Y30LB26*/ 09839000
         B     @EL00040                                            2581 09840000
*         END;                      /*                       @Y30LB26*/ 09841000
*     END;                          /*                       #Y30LB26*/ 09842000
*                                                                  2583 09843000
@RF02578 DS    0H                                                  2584 09844000
*   /*****************************************************************/ 09845000
*   /*                                                               */ 09846000
*   /* GO GET BASE RECORD OUT OF GROUP CHAIN                 @Y30LB26*/ 09847000
*   /*                                                               */ 09848000
*   /*****************************************************************/ 09849000
*                                                                  2584 09850000
*   CHICHOGP=ON;                    /* INDICATE GROUPED      @Y30LB26*/ 09851000
@RF02566 OI    CHICHOGP,B'00010000'                                2584 09852000
*   CALL ICBVUCHO(GROUPPTR,BASEVPTR,RPLVPTR,PASSFLAG);/*     @Y30LB26*/ 09853000
         L     @15,@CV00675                                        2585 09854000
         LA    @01,@AL02585                                        2585 09855000
         BALR  @14,@15                                             2585 09856000
*   IF RPLVRETC¬=RCZERO THEN        /*                       @Y30LB26*/ 09857000
         L     @02,RPLVPTR                                         2586 09858000
         CLC   RPLVRETC(2,@02),@CB00747                            2586 09859000
         BE    @RF02586                                            2586 09860000
*     DO;                           /*                       @Y30LB26*/ 09861000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Y30LB26*/ 09862000
         BAL   @14,ERREXIT                                         2588 09863000
*       RETURN;                     /*                       @Y30LB26*/ 09864000
         B     @EL00040                                            2589 09865000
*     END;                          /*                       @Y30LB26*/ 09866000
*                                                                  2590 09867000
*   /*****************************************************************/ 09868000
*   /*                                                               */ 09869000
*   /* SET REQUIRED DEFAULTS FOR GROUPIN                     @ZA00673*/ 09870000
*   /* IF VOLUME IS NEITHER RESTRICTED OR GENERAL USE        @ZA00673*/ 09871000
*   /* DEFAULT IS GENERAL USE                                @ZA00673*/ 09872000
*   /* OTHERWISE SET REQUIRED DEFAULT TO VOLUME ATTRIBUTE    @ZA00673*/ 09873000
*   /*                                                               */ 09874000
*   /*****************************************************************/ 09875000
*                                                                  2591 09876000
*   IF MVRRSTD=OFF&MVRGEN=OFF THEN                                 2591 09877000
@RF02586 L     @02,MVRPTR                                          2591 09878000
         TM    MVRRSTD(@02),B'11000000'                            2591 09879000
         BNZ   @RF02591                                            2591 09880000
*     DO;                           /*                       @ZA00673*/ 09881000
*       IF BASRSTD=OFF&BASGENUS=OFF THEN                           2593 09882000
         L     @01,BASEVPTR                                        2593 09883000
         TM    BASRSTD(@01),B'00011000'                            2593 09884000
         BNZ   @RF02593                                            2593 09885000
*         MVRGEN=ON;                /*                       @ZA00673*/ 09886000
         OI    MVRGEN(@02),B'10000000'                             2594 09887000
*       IF BASRSTD=OFF&BASGENUS=ON THEN                            2595 09888000
@RF02593 L     @02,BASEVPTR                                        2595 09889000
         TM    BASGENUS(@02),B'00010000'                           2595 09890000
         BNO   @RF02595                                            2595 09891000
         TM    BASRSTD(@02),B'00001000'                            2595 09892000
         BNZ   @RF02595                                            2595 09893000
*         MVRGEN=ON;                /*                       @ZA00673*/ 09894000
         L     @02,MVRPTR                                          2596 09895000
         OI    MVRGEN(@02),B'10000000'                             2596 09896000
*       IF BASRSTD=ON&BASGENUS=OFF THEN                            2597 09897000
@RF02595 L     @02,BASEVPTR                                        2597 09898000
         TM    BASRSTD(@02),B'00001000'                            2597 09899000
         BNO   @RF02597                                            2597 09900000
         TM    BASGENUS(@02),B'00010000'                           2597 09901000
         BNZ   @RF02597                                            2597 09902000
*         MVRRSTD=ON;               /*                       @ZA00673*/ 09903000
         L     @02,MVRPTR                                          2598 09904000
         OI    MVRRSTD(@02),B'01000000'                            2598 09905000
*     END;                          /*                       @ZA00673*/ 09906000
*                                                                  2599 09907000
@RF02597 DS    0H                                                  2600 09908000
*   /*****************************************************************/ 09909000
*   /*                                                               */ 09910000
*   /* CLEAR OUT FIELDS IN THE BASE VOL RECORD THAT          #Y30LB26*/ 09911000
*   /* HAVE BAD INFORMATION IN THEM FROM PREV GROUP          #Y30LB26*/ 09912000
*   /*                                                               */ 09913000
*   /*****************************************************************/ 09914000
*                                                                  2600 09915000
*   BASGRPV=OFF;                    /* NON-GRPED             #Y30LB26*/ 09916000
@RF02591 DS    0H                                                  2601 09917000
*   BASGENUS=OFF;                   /* NOT GENERAL           #Y30LB26*/ 09918000
*   BASRSTD=OFF;                    /* NOT RESTRICTED        @Y30LB26*/ 09919000
         L     @02,BASEVPTR                                        2602 09920000
         NI    BASGRPV(@02),B'11000111'                            2602 09921000
*   BASGROUP=BLANK;                 /* BLANK OUT GROUP NAME  @Y30LB26*/ 09922000
         MVI   BASGROUP+1(@02),C' '                                2603 09923000
         MVC   BASGROUP+2(6,@02),BASGROUP+1(@02)                   2603 09924000
         MVI   BASGROUP(@02),C' '                                  2603 09925000
*   BASEXPDT=NULEXPDT;              /* CLEAR EXPIRATION      @Y30LB26*/ 09926000
*                                                                  2604 09927000
         MVC   BASEXPDT(4,@02),NULEXPDT                            2604 09928000
*   /*****************************************************************/ 09929000
*   /*                                                               */ 09930000
*   /* READ GROUP RECORD FOR UPDATE SO IT CAN BE WRITTEN     @Y30LB26*/ 09931000
*   /*                                                               */ 09932000
*   /*****************************************************************/ 09933000
*                                                                  2605 09934000
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @Y30LB26*/ 09935000
         L     @02,RPLVPTR                                         2605 09936000
         LA    @15,GKEY                                            2605 09937000
         ST    @15,RPLVKEY(,@02)                                   2605 09938000
*   RPLVBUF=ADDR(DUMMYREC);         /* ADDR DUMMY BUFFER     @Y30LB26*/ 09939000
         LA    @15,DUMMYREC                                        2606 09940000
         ST    @15,RPLVBUF(,@02)                                   2606 09941000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH OF BUFFER      @Y30LB26*/ 09942000
         MVC   RPLVBLN(4,@02),@CF01147                             2607 09943000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 09944000
         OI    RPLVDIR(@02),B'01000000'                            2608 09945000
*   RPLVTYP=RPLVREAD;               /* READ GROUP            @Y30LB26*/ 09946000
         MVI   RPLVTYP(@02),X'00'                                  2609 09947000
*   RPLVUPD=ON;                     /* FOR UPDATE            @Y30LB26*/ 09948000
         OI    RPLVUPD(@02),B'00000010'                            2610 09949000
*   RESPECIFY                                                      2611 09950000
*     REG1 RSTD;                    /* RESTRICT REG1         @Y30LB26*/ 09951000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 09952000
         LR    REG1,@02                                            2612 09953000
*   CALL ICBVIO00;                  /* RD GRP REC FOR UPDATE @Y30LB26*/ 09954000
         L     @15,@CV00671                                        2613 09955000
         BALR  @14,@15                                             2613 09956000
*   RESPECIFY                                                      2614 09957000
*     REG1 UNRSTD;                  /* RESTRICT REG1         @Y30LB26*/ 09958000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN CODE     @Y30LB26*/ 09959000
         L     @02,RPLVPTR                                         2615 09960000
         CLC   RPLVRETC(2,@02),@CB00747                            2615 09961000
         BE    @RF02615                                            2615 09962000
*     DO;                           /*                       @Y30LB26*/ 09963000
*       CALL ERREXIT;               /* SAVE CODES            @Y30LB26*/ 09964000
         BAL   @14,ERREXIT                                         2617 09965000
*       RETURN;                     /*                       @Y30LB26*/ 09966000
         B     @EL00040                                            2618 09967000
*     END;                          /*                       @Y30LB26*/ 09968000
*                                                                  2619 09969000
*   /*****************************************************************/ 09970000
*   /*                                                               */ 09971000
*   /* WRITE GROUP RECORD                                    @Y30LB26*/ 09972000
*   /*                                                               */ 09973000
*   /*****************************************************************/ 09974000
*                                                                  2620 09975000
*   RPLVBUF=ADDR(STORGRP);          /* ADDR RECORD TO PUT    @Y30LB26*/ 09976000
@RF02615 L     @02,RPLVPTR                                         2620 09977000
         LA    @15,STORGRP                                         2620 09978000
         ST    @15,RPLVBUF(,@02)                                   2620 09979000
*   RPLVTYP=RPLVPUT;                /* PUT GROUP             @Y30LB26*/ 09980000
         MVI   RPLVTYP(@02),X'01'                                  2621 09981000
*   RESPECIFY                                                      2622 09982000
*     REG1 RSTD;                    /* RESTRICT REG1         @Y30LB26*/ 09983000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 09984000
         LR    REG1,@02                                            2623 09985000
*   CALL ICBVIO00;                  /* RD GRP REC FOR UPDATE @Y30LB26*/ 09986000
         L     @15,@CV00671                                        2624 09987000
         BALR  @14,@15                                             2624 09988000
*   RESPECIFY                                                      2625 09989000
*     REG1 UNRSTD;                  /* RESTRICT REG1         @Y30LB26*/ 09990000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN CODE     @Y30LB26*/ 09991000
         L     @02,RPLVPTR                                         2626 09992000
         CLC   RPLVRETC(2,@02),@CB00747                            2626 09993000
         BE    @RF02626                                            2626 09994000
*     DO;                           /*                       @Y30LB26*/ 09995000
*       CALL ERREXIT;               /* SAVE CODES            @Y30LB26*/ 09996000
         BAL   @14,ERREXIT                                         2628 09997000
*       RETURN;                     /*                       @Y30LB26*/ 09998000
         B     @EL00040                                            2629 09999000
*     END;                          /*                       @Y30LB26*/ 10000000
*                                                                  2630 10001000
*   /*****************************************************************/ 10002000
*   /*                                                               */ 10003000
*   /* IF THE RPLV DATA SET HAS NEVER BEEN JOURNLED          @Y30LB26*/ 10004000
*   /* BEFORE, JOURNAL IT SINCE AN UPDATE HAS BEEN MADE      @Y30LB26*/ 10005000
*   /*                                                               */ 10006000
*   /*****************************************************************/ 10007000
*                                                                  2631 10008000
*   IF JRNLEDSW=OFF THEN            /* JOURNALED BEFORE?     @Y30LB26*/ 10009000
@RF02626 TM    JRNLEDSW,B'00000001'                                2631 10010000
         BNZ   @RF02631                                            2631 10011000
*     CALL JOURNAL;                 /* JOURNAL IT            @Y30LB26*/ 10012000
         BAL   @14,JOURNAL                                         2632 10013000
*   RETURN;                         /*                       @Y30LB26*/ 10014000
         B     @EL00040                                            2633 10015000
*   END GROUPOUT;                   /*                       @Y30LB26*/ 10016000
         B     @EL00040                                            2634 10017000
*                                                                  2635 10018000
*   /*****************************************************************/ 10019000
*   /*                                                               */ 10020000
*   /* THIS ROUTINE PUTS A BASE VOL REC INTO A GROUP         @Y30LB26*/ 10021000
*   /*                                                               */ 10022000
*   /*****************************************************************/ 10023000
*                                                                  2635 10024000
*GROUPIN:                                                          2635 10025000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 10026000
*                                                                  2635 10027000
GROUPIN  ST    @14,@SA00041                                        2635 10028000
*   /*****************************************************************/ 10029000
*   /*                                                               */ 10030000
*   /* READ THE NEW GROUP RECORD                             @Y30LB26*/ 10031000
*   /*                                                               */ 10032000
*   /*****************************************************************/ 10033000
*                                                                  2636 10034000
*   GROUPKY=MVRGROUP;               /* GROUP NAME TO KEY     @Y30LB26*/ 10035000
         L     @02,MVRPTR                                          2636 10036000
         MVC   GROUPKY(8),MVRGROUP(@02)                            2636 10037000
*   RPLVKEY=ADDR(GKEY);             /* ADDR IF KEY           @Y30LB26*/ 10038000
         L     @02,RPLVPTR                                         2637 10039000
         LA    @15,GKEY                                            2637 10040000
         ST    @15,RPLVKEY(,@02)                                   2637 10041000
*   RPLVBUF=ADDR(STORGRP);          /* ADDR BUFFER           @Y30LB26*/ 10042000
         LA    @15,STORGRP                                         2638 10043000
         ST    @15,RPLVBUF(,@02)                                   2638 10044000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH BUFFER         @Y30LB26*/ 10045000
         MVC   RPLVBLN(4,@02),@CF01147                             2639 10046000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB26*/ 10047000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 10048000
         OI    RPLVDIR(@02),B'01000000'                            2641 10049000
         NI    RPLVLOC(@02),B'01111111'                            2641 10050000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB26*/ 10051000
         MVI   RPLVTYP(@02),X'00'                                  2642 10052000
*   RESPECIFY                                                      2643 10053000
*     REG1 RSTD;                    /* RESTRICT              @Y30LB26*/ 10054000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 10055000
         LR    REG1,@02                                            2644 10056000
*   CALL ICBVIO00;                  /* READ GROUP RECORD     @Y30LB26*/ 10057000
         L     @15,@CV00671                                        2645 10058000
         BALR  @14,@15                                             2645 10059000
*   RESPECIFY                                                      2646 10060000
*     REG1 UNRSTD;                  /* FREE                  @Y30LB26*/ 10061000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 10062000
         L     @02,RPLVPTR                                         2647 10063000
         CLC   RPLVRETC(2,@02),@CB00747                            2647 10064000
         BE    @RF02647                                            2647 10065000
*     DO;                           /*                       @Y30LB26*/ 10066000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 10067000
         BAL   @14,ERREXIT                                         2649 10068000
*       RETURN;                     /*                       @Y30LB26*/ 10069000
@EL00041 DS    0H                                                  2650 10070000
@EF00041 DS    0H                                                  2650 10071000
@ER00041 L     @14,@SA00041                                        2650 10072000
         BR    @14                                                 2650 10073000
*     END;                          /*                       @Y30LB26*/ 10074000
*   GROUPPTR=ADDR(STORGRP);         /* ADDR TO RECORD        @Y30LB26*/ 10075000
*                                                                  2652 10076000
@RF02647 LA    @02,STORGRP                                         2652 10077000
         ST    @02,GROUPPTR                                        2652 10078000
*   /*****************************************************************/ 10079000
*   /*                                                               */ 10080000
*   /* IF RESTRICTED USE, ADD ONE TO COUNT IN GROUP          @Y30LB26*/ 10081000
*   /* RECORD AND INDICATE RESTRICTED IN BASE RECORD         @Y30LB26*/ 10082000
*   /*                                                               */ 10083000
*   /*****************************************************************/ 10084000
*                                                                  2653 10085000
*   IF MVRRSTD=ON THEN              /* RESTRICTED USE ?      @Y30LB26*/ 10086000
         L     @01,MVRPTR                                          2653 10087000
         TM    MVRRSTD(@01),B'01000000'                            2653 10088000
         BNO   @RF02653                                            2653 10089000
*     DO;                           /*                       @Y30LB26*/ 10090000
*       GRONRSTD=GRONRSTD+ONE;      /* ADD ONE RESTRICTED    @Y30LB26*/ 10091000
         LA    @15,1                                               2655 10092000
         AH    @15,GRONRSTD(,@02)                                  2655 10093000
         STH   @15,GRONRSTD(,@02)                                  2655 10094000
*       BASRSTD=ON;                 /* INDICATE RESTRICTED   @Y30LB26*/ 10095000
         L     @02,BASEVPTR                                        2656 10096000
         OI    BASRSTD(@02),B'00001000'                            2656 10097000
*     END;                          /*                       @Y30LB26*/ 10098000
*                                                                  2657 10099000
*   /*****************************************************************/ 10100000
*   /*                                                               */ 10101000
*   /* INDICATE GROUPED AND PUT GROUP NAME IN VOLUME         @Y30LB26*/ 10102000
*   /*                                                               */ 10103000
*   /*****************************************************************/ 10104000
*                                                                  2658 10105000
*   BASGRPV=ON;                     /* INDICATE GROUPED      @Y30LB26*/ 10106000
@RF02653 L     @02,BASEVPTR                                        2658 10107000
         OI    BASGRPV(@02),B'00100000'                            2658 10108000
*   BASGROUP=MVRGROUP;              /* GROUP NAME IN BASE    @Y30LB26*/ 10109000
*                                                                  2659 10110000
         L     @15,MVRPTR                                          2659 10111000
         MVC   BASGROUP(8,@02),MVRGROUP(@15)                       2659 10112000
*   /*****************************************************************/ 10113000
*   /*                                                               */ 10114000
*   /* CHECK IF VOLUME IS GOING TO BE GENERAL USE            #Y30LB26*/ 10115000
*   /*                                                               */ 10116000
*   /*****************************************************************/ 10117000
*                                                                  2660 10118000
*   IF MVRGEN=ON THEN               /* GENERAL USE?          #Y30LB26*/ 10119000
         TM    MVRGEN(@15),B'10000000'                             2660 10120000
         BNO   @RF02660                                            2660 10121000
*     DO;                           /*                       @Y30LB26*/ 10122000
*                                                                  2661 10123000
*       /*************************************************************/ 10124000
*       /*                                                           */ 10125000
*       /* ADD ONE TO NUMBER OF GENERAL USE IN GROUP.        @ZM31004*/ 10126000
*       /* INDICATE GENERAL USE IN BASE RECORD               @ZM31004*/ 10127000
*       /*                                                           */ 10128000
*       /*************************************************************/ 10129000
*                                                                  2662 10130000
*       GRONGEN=GRONGEN+ONE;        /* ADD ON TO GENERAL     @ZM31004*/ 10131000
         L     @15,GROUPPTR                                        2662 10132000
         LA    @14,1                                               2662 10133000
         AH    @14,GRONGEN(,@15)                                   2662 10134000
         STH   @14,GRONGEN(,@15)                                   2662 10135000
*       BASGENUS=ON;                /* INDICATE GENERAL      @ZM31004*/ 10136000
*                                                                  2663 10137000
         OI    BASGENUS(@02),B'00010000'                           2663 10138000
*       /*************************************************************/ 10139000
*       /*                                                           */ 10140000
*       /* SET FLAG INDICATING ADDING TO GROUP AND GO        @ZM31004*/ 10141000
*       /* PUT NEW SPACE VALUES IN GROUP RECORD              @ZM31004*/ 10142000
*       /*                                                           */ 10143000
*       /*************************************************************/ 10144000
*                                                                  2664 10145000
*       ADDGRP=ON;                  /* INDIC ADDING TO GRP   @ZM31004*/ 10146000
         OI    ADDGRP,B'00001000'                                  2664 10147000
*       CALL ICBVUPGH(GROUPPTR,BASEVPTR,PASSFLAG);/*         @ZM31004*/ 10148000
*                                                                  2665 10149000
         L     @15,@CV00676                                        2665 10150000
         LA    @01,@AL02665                                        2665 10151000
         BALR  @14,@15                                             2665 10152000
*       /*************************************************************/ 10153000
*       /*                                                           */ 10154000
*       /* CHECK RETURN FROM PROCESS GROUP HEADER            @ZM31004*/ 10155000
*       /*                                                           */ 10156000
*       /*************************************************************/ 10157000
*                                                                  2666 10158000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @ZM31004*/ 10159000
         L     @02,RPLVPTR                                         2666 10160000
         CLC   RPLVRETC(2,@02),@CB00747                            2666 10161000
         BE    @RF02666                                            2666 10162000
*         DO;                       /*                       @ZM31004*/ 10163000
*           CALL ERREXIT;           /* FREE INVENTORY        @ZM31004*/ 10164000
         BAL   @14,ERREXIT                                         2668 10165000
*           RETURN;                 /*                       @ZM31004*/ 10166000
         B     @EL00041                                            2669 10167000
*         END;                      /*                       @ZM31004*/ 10168000
*                                                                  2670 10169000
*       /*************************************************************/ 10170000
*       /*                                                           */ 10171000
*       /* GO PUT A SLOT IN EXTENSION RECORD FOR THIS        @ZM31004*/ 10172000
*       /* GROUPED GENERAL USE BASE VOLUME                   @ZM31004*/ 10173000
*       /*                                                           */ 10174000
*       /*************************************************************/ 10175000
*                                                                  2671 10176000
*       SLOTEXP=OFF;                /* NO EXPIRATION CHANGE  #Y30LB26*/ 10177000
@RF02666 NI    SLOTEXP,B'01111111'                                 2671 10178000
*       ADDSLEXT=ON;                /* INDICATE ADDING SLOT  #Y30LB26*/ 10179000
         OI    ADDSLEXT,B'00000010'                                2672 10180000
*       CALL VUEXT;                 /* PUT SLOT IN EXTEN     @Y30LB26*/ 10181000
         BAL   @14,VUEXT                                           2673 10182000
*       IF RPLVRETC¬=RCZERO THEN    /*                       @Y30LB26*/ 10183000
         L     @02,RPLVPTR                                         2674 10184000
         CLC   RPLVRETC(2,@02),@CB00747                            2674 10185000
         BE    @RF02674                                            2674 10186000
*         DO;                       /*                       @Y30LB26*/ 10187000
*           CALL ERREXIT;           /*                       @Y30LB26*/ 10188000
         BAL   @14,ERREXIT                                         2676 10189000
*           RETURN;                 /*                       @Y30LB26*/ 10190000
         B     @EL00041                                            2677 10191000
*         END;                      /*                       @Y30LB26*/ 10192000
*     END;                          /*                       @Y30LB26*/ 10193000
*                                                                  2679 10194000
@RF02674 DS    0H                                                  2680 10195000
*   /*****************************************************************/ 10196000
*   /*                                                               */ 10197000
*   /* CALL CHAIN IN ROUTINE TO CHAIN BASE RECORD INTO GROUP @Y30LB26*/ 10198000
*   /*                                                               */ 10199000
*   /*****************************************************************/ 10200000
*                                                                  2680 10201000
*   CHICHOGP=ON;                    /* INDICATE GROUPED      @Y30LB26*/ 10202000
@RF02660 OI    CHICHOGP,B'00010000'                                2680 10203000
*   CALL ICBVUCHI(GROUPPTR,BASEVPTR,RPLVPTR,PASSFLAG);/*     @Y30LB26*/ 10204000
*                                                                  2681 10205000
         L     @15,@CV00674                                        2681 10206000
         LA    @01,@AL02681                                        2681 10207000
         BALR  @14,@15                                             2681 10208000
*   /*****************************************************************/ 10209000
*   /*                                                               */ 10210000
*   /* CHECK RETURN                                          @Y30LB26*/ 10211000
*   /*                                                               */ 10212000
*   /*****************************************************************/ 10213000
*                                                                  2682 10214000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 10215000
         L     @02,RPLVPTR                                         2682 10216000
         CLC   RPLVRETC(2,@02),@CB00747                            2682 10217000
         BE    @RF02682                                            2682 10218000
*     DO;                           /*                       @Y30LB26*/ 10219000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 10220000
         BAL   @14,ERREXIT                                         2684 10221000
*       RETURN;                     /*                       @Y30LB26*/ 10222000
         B     @EL00041                                            2685 10223000
*     END;                          /*                       @Y30LB26*/ 10224000
*                                                                  2686 10225000
*   /*****************************************************************/ 10226000
*   /*                                                               */ 10227000
*   /* READ GROUP RECORD FOR UPDATE SO IT CAN BE WRITTEN     #Y30LB26*/ 10228000
*   /*                                                               */ 10229000
*   /*****************************************************************/ 10230000
*                                                                  2687 10231000
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY              @Y30LB26*/ 10232000
@RF02682 L     @02,RPLVPTR                                         2687 10233000
         LA    @15,GKEY                                            2687 10234000
         ST    @15,RPLVKEY(,@02)                                   2687 10235000
*   RPLVBUF=ADDR(DUMMYREC);         /* DUMMY BUFFER          @Y30LB26*/ 10236000
         LA    @15,DUMMYREC                                        2688 10237000
         ST    @15,RPLVBUF(,@02)                                   2688 10238000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH BUFFER         @Y30LB26*/ 10239000
         MVC   RPLVBLN(4,@02),@CF01147                             2689 10240000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB26*/ 10241000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 10242000
         OI    RPLVDIR(@02),B'01000000'                            2691 10243000
         NI    RPLVLOC(@02),B'01111111'                            2691 10244000
*   RPLVTYP=RPLVREAD;               /* READ REC              @Y30LB26*/ 10245000
         MVI   RPLVTYP(@02),X'00'                                  2692 10246000
*   RPLVKGE=OFF;                    /* NOT FOR > OR =        @Y30LB26*/ 10247000
         NI    RPLVKGE(@02),B'11111011'                            2693 10248000
*   RPLVUPD=ON;                     /* FOR UPDATE            @Y30LB26*/ 10249000
         OI    RPLVUPD(@02),B'00000010'                            2694 10250000
*   RESPECIFY                                                      2695 10251000
*     REG1 RSTD;                    /* RESTRICT              @Y30LB26*/ 10252000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 10253000
         LR    REG1,@02                                            2696 10254000
*   CALL ICBVIO00;                  /* READ GROUP UPDATE     @Y30LB26*/ 10255000
*                                                                  2697 10256000
         L     @15,@CV00671                                        2697 10257000
         BALR  @14,@15                                             2697 10258000
*   /*****************************************************************/ 10259000
*   /*                                                               */ 10260000
*   /* CHECK RETURN FROM DUMMY READ                          @Y30LB26*/ 10261000
*   /*                                                               */ 10262000
*   /*****************************************************************/ 10263000
*                                                                  2698 10264000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN CODE        @Y30LB26*/ 10265000
         L     @02,RPLVPTR                                         2698 10266000
         CLC   RPLVRETC(2,@02),@CB00747                            2698 10267000
         BE    @RF02698                                            2698 10268000
*     DO;                           /*                       @Y30LB26*/ 10269000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Y30LB26*/ 10270000
         BAL   @14,ERREXIT                                         2700 10271000
*       RETURN;                     /*                       @Y30LB26*/ 10272000
         B     @EL00041                                            2701 10273000
*     END;                          /*                       @Y30LB26*/ 10274000
*                                                                  2702 10275000
*   /*****************************************************************/ 10276000
*   /*                                                               */ 10277000
*   /* WRITE GROUP RECORD THAT IS ALL FIXED UP NOW           @Y30LB26*/ 10278000
*   /*                                                               */ 10279000
*   /*****************************************************************/ 10280000
*                                                                  2703 10281000
*   RPLVBUF=ADDR(STORGRP);          /* ADDR READ GROUP REC   @Y30LB26*/ 10282000
@RF02698 L     @02,RPLVPTR                                         2703 10283000
         LA    @00,STORGRP                                         2703 10284000
         ST    @00,RPLVBUF(,@02)                                   2703 10285000
*   RPLVTYP=RPLVPUT;                /* WRITE IT              @Y30LB26*/ 10286000
         MVI   RPLVTYP(@02),X'01'                                  2704 10287000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 10288000
         LR    REG1,@02                                            2705 10289000
*   CALL ICBVIO00;                  /* WRITE GROUP REC       @Y30LB26*/ 10290000
         L     @15,@CV00671                                        2706 10291000
         BALR  @14,@15                                             2706 10292000
*   RESPECIFY                                                      2707 10293000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 10294000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 10295000
         L     @02,RPLVPTR                                         2708 10296000
         CLC   RPLVRETC(2,@02),@CB00747                            2708 10297000
         BE    @RF02708                                            2708 10298000
*     DO;                           /*                       @Y30LB26*/ 10299000
*       CALL ERREXIT;               /* SAVE RETURN CODES     @Y30LB26*/ 10300000
         BAL   @14,ERREXIT                                         2710 10301000
*       RETURN;                     /*                       @Y30LB26*/ 10302000
         B     @EL00041                                            2711 10303000
*     END;                          /*                       @Y30LB26*/ 10304000
*                                                                  2712 10305000
*   /*****************************************************************/ 10306000
*   /*                                                               */ 10307000
*   /* CHECK TO SEE IF RPLV HAS ALREADY BEEN JOURNALED.      @Y30LB26*/ 10308000
*   /* IF IT HAS NOT, THEN GO JOURNAL IT                     @Y30LB26*/ 10309000
*   /*                                                               */ 10310000
*   /*****************************************************************/ 10311000
*                                                                  2713 10312000
*   IF JRNLEDSW=OFF THEN            /* JOURNALED BEFORE      @Y30LB26*/ 10313000
@RF02708 TM    JRNLEDSW,B'00000001'                                2713 10314000
         BNZ   @RF02713                                            2713 10315000
*     CALL JOURNAL;                 /* JOURNAL IT            @Y30LB26*/ 10316000
         BAL   @14,JOURNAL                                         2714 10317000
*   RETURN;                         /*                       @Y30LB26*/ 10318000
         B     @EL00041                                            2715 10319000
*   END GROUPIN;                    /*                       @Y30LB26*/ 10320000
         B     @EL00041                                            2716 10321000
*                                                                  2717 10322000
*   /*****************************************************************/ 10323000
*   /*                                                               */ 10324000
*   /* THIS ROUTINE TAKES A BASE VOLUME RECORD OUT OF        @Y30LB26*/ 10325000
*   /* THE NON-GROUPED CHAIN                                 @Y30LB26*/ 10326000
*   /*                                                               */ 10327000
*   /*****************************************************************/ 10328000
*                                                                  2717 10329000
*NGRPOUT:                                                          2717 10330000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 10331000
NGRPOUT  ST    @14,@SA00042                                        2717 10332000
*   CHICHOGP=OFF;                   /* INDICATE NON-GRPED    @Y30LB26*/ 10333000
*                                                                  2718 10334000
         NI    CHICHOGP,B'11101111'                                2718 10335000
*   /*****************************************************************/ 10336000
*   /*                                                               */ 10337000
*   /* GO CHAIN VOLUME OUT OF NON-GROUPED CHAIN              @Y30LB26*/ 10338000
*   /* AND CHECK RETURN CODE                                 @Y30LB26*/ 10339000
*   /*                                                               */ 10340000
*   /*****************************************************************/ 10341000
*                                                                  2719 10342000
*   CALL ICBVUCHO(0,BASEVPTR,RPLVPTR,PASSFLAG);/* CHN OUT    @Y30LB26*/ 10343000
         L     @15,@CV00675                                        2719 10344000
         LA    @01,@AL02719                                        2719 10345000
         BALR  @14,@15                                             2719 10346000
*   IF RPLVRETC¬=RCZERO THEN        /* RETURN CODE           @Y30LB26*/ 10347000
         L     @02,RPLVPTR                                         2720 10348000
         CLC   RPLVRETC(2,@02),@CB00747                            2720 10349000
         BE    @RF02720                                            2720 10350000
*     DO;                           /*                       @Y30LB26*/ 10351000
*       CALL ERREXIT;               /* SAVE RETURN CODE      @Y30LB26*/ 10352000
         BAL   @14,ERREXIT                                         2722 10353000
*       RETURN;                     /*                       @Y30LB26*/ 10354000
@EL00042 DS    0H                                                  2723 10355000
@EF00042 DS    0H                                                  2723 10356000
@ER00042 L     @14,@SA00042                                        2723 10357000
         BR    @14                                                 2723 10358000
*     END;                          /*                       @Y30LB26*/ 10359000
*   RETURN;                         /*                       @Y30LB26*/ 10360000
         B     @EL00042                                            2725 10361000
*   END NGRPOUT;                    /*                       @Y30LB26*/ 10362000
         B     @EL00042                                            2726 10363000
*                                                                  2727 10364000
*   /*****************************************************************/ 10365000
*   /*                                                               */ 10366000
*   /* THIS ROUTINE PUTS A BASE VOLUME RECORD INTO           @Y30LB26*/ 10367000
*   /* THE NON-GROUPED CHAIN                                 @Y30LB26*/ 10368000
*   /*                                                               */ 10369000
*   /*****************************************************************/ 10370000
*                                                                  2727 10371000
*NGROUPIN:                                                         2727 10372000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 10373000
NGROUPIN ST    @14,@SA00043                                        2727 10374000
*   CHICHOGP=OFF;                   /* INDICATE NON-GRPED    @Y30LB26*/ 10375000
*                                                                  2728 10376000
         NI    CHICHOGP,B'11101111'                                2728 10377000
*   /*****************************************************************/ 10378000
*   /*                                                               */ 10379000
*   /* GO CHAIN VOLUME INTO NON-GROUPED                      @Y30LB26*/ 10380000
*   /* AND CHECK RETURN CODE                                 @Y30LB26*/ 10381000
*   /*                                                               */ 10382000
*   /*****************************************************************/ 10383000
*                                                                  2729 10384000
*   CALL ICBVUCHI(0,BASEVPTR,RPLVPTR,PASSFLAG);/*            @Y30LB26*/ 10385000
         L     @15,@CV00674                                        2729 10386000
         LA    @01,@AL02729                                        2729 10387000
         BALR  @14,@15                                             2729 10388000
*   IF RPLVRETC¬=RCZERO THEN        /*                       @Y30LB26*/ 10389000
         L     @02,RPLVPTR                                         2730 10390000
         CLC   RPLVRETC(2,@02),@CB00747                            2730 10391000
         BE    @RF02730                                            2730 10392000
*     DO;                           /*                       @Y30LB26*/ 10393000
*       CALL ERREXIT;               /*                       @Y30LB26*/ 10394000
         BAL   @14,ERREXIT                                         2732 10395000
*       RETURN;                     /*                       @Y30LB26*/ 10396000
@EL00043 DS    0H                                                  2733 10397000
@EF00043 DS    0H                                                  2733 10398000
@ER00043 L     @14,@SA00043                                        2733 10399000
         BR    @14                                                 2733 10400000
*     END;                          /*                       @Y30LB26*/ 10401000
*                                                                  2734 10402000
*   /*****************************************************************/ 10403000
*   /*                                                               */ 10404000
*   /* UPDATE FIELDS IN THE BASE VOLUME RECORD THAT          @Y30LB26*/ 10405000
*   /* NEED TO BE UPDATED WHEN GOING NON-GROUPED CATAGORY    @Y30LB26*/ 10406000
*   /*                                                               */ 10407000
*   /*****************************************************************/ 10408000
*                                                                  2735 10409000
*   BASGRPV=OFF;                    /* CLEAR GROUP FLAG      @Y30LB26*/ 10410000
@RF02730 DS    0H                                                  2736 10411000
*   BASGENUS=OFF;                   /* CLEAR GENERAL USED    @Y30LB26*/ 10412000
*   BASRSTD=OFF;                    /* CLEAR RESTRICTED      @Y30LB26*/ 10413000
         L     @02,BASEVPTR                                        2737 10414000
         NI    BASGRPV(@02),B'11000111'                            2737 10415000
*   BASEXPDT=NULEXPDT;              /* CLEAR EXPIRATION      @Y30LB26*/ 10416000
         MVC   BASEXPDT(4,@02),NULEXPDT                            2738 10417000
*   BASGROUP=BLANK;                 /* BLANK GROUP NAME      @Y30LB26*/ 10418000
         MVI   BASGROUP+1(@02),C' '                                2739 10419000
         MVC   BASGROUP+2(6,@02),BASGROUP+1(@02)                   2739 10420000
         MVI   BASGROUP(@02),C' '                                  2739 10421000
*   RETURN;                         /*                       @Y30LB26*/ 10422000
         B     @EL00043                                            2740 10423000
*   END NGROUPIN;                   /*                       @Y30LB26*/ 10424000
*                                                                  2742 10425000
*   /*****************************************************************/ 10426000
*   /*                                                               */ 10427000
*   /* THIS ROUTINE IS CALLED WHEN A GROUPED VOLUME IS       @Y30LB26*/ 10428000
*   /* CURRENTLY GENERAL USE, BUT IS GOING RESTRICTED        @Y30LB26*/ 10429000
*   /* IN THE SAME GROUP                                     @Y30LB26*/ 10430000
*   /*                                                               */ 10431000
*   /*****************************************************************/ 10432000
*                                                                  2742 10433000
*RESTRICT:                          /*                       @Y30LB26*/ 10434000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 10435000
*                                                                  2742 10436000
RESTRICT ST    @14,@SA00044                                        2742 10437000
*   /*****************************************************************/ 10438000
*   /*                                                               */ 10439000
*   /* GET GROUP NAME AND SET UP TO READ GROUP RECORD        @Y30LB26*/ 10440000
*   /*                                                               */ 10441000
*   /*****************************************************************/ 10442000
*                                                                  2743 10443000
*   GROUPKY=BASGROUP;               /* GROUP NAME            @Y30LB26*/ 10444000
         L     @02,BASEVPTR                                        2743 10445000
         MVC   GROUPKY(8),BASGROUP(@02)                            2743 10446000
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY              @Y30LB26*/ 10447000
         L     @02,RPLVPTR                                         2744 10448000
         LA    @15,GKEY                                            2744 10449000
         ST    @15,RPLVKEY(,@02)                                   2744 10450000
*   RPLVBUF=ADDR(STORGRP);          /* ADDR BUFFER           @Y30LB26*/ 10451000
         LA    @15,STORGRP                                         2745 10452000
         ST    @15,RPLVBUF(,@02)                                   2745 10453000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH OF BUFFER      @Y30LB26*/ 10454000
         MVC   RPLVBLN(4,@02),@CF01147                             2746 10455000
*   RPLVLOC=OFF;                    /* NO LOCATE MODE        @Y30LB26*/ 10456000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 10457000
         OI    RPLVDIR(@02),B'01000000'                            2748 10458000
         NI    RPLVLOC(@02),B'01111111'                            2748 10459000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB26*/ 10460000
         MVI   RPLVTYP(@02),X'00'                                  2749 10461000
*   RPLVUPD=ON;                     /* FOR UPDATE            @Y30LB26*/ 10462000
         OI    RPLVUPD(@02),B'00000010'                            2750 10463000
*   RESPECIFY                                                      2751 10464000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 10465000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 10466000
         LR    REG1,@02                                            2752 10467000
*   CALL ICBVIO00;                  /* READ GROUP RECORD     @Y30LB26*/ 10468000
         L     @15,@CV00671                                        2753 10469000
         BALR  @14,@15                                             2753 10470000
*   RESPECIFY                                                      2754 10471000
*     REG1 UNRSTD;                  /* UNRESTRICT REG1       @Y30LB26*/ 10472000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN?         @Y30LB26*/ 10473000
         L     @02,RPLVPTR                                         2755 10474000
         CLC   RPLVRETC(2,@02),@CB00747                            2755 10475000
         BE    @RF02755                                            2755 10476000
*     DO;                           /*                       @Y30LB26*/ 10477000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 10478000
         BAL   @14,ERREXIT                                         2757 10479000
*       RETURN;                     /*                       @Y30LB26*/ 10480000
@EL00044 DS    0H                                                  2758 10481000
@EF00044 DS    0H                                                  2758 10482000
@ER00044 L     @14,@SA00044                                        2758 10483000
         BR    @14                                                 2758 10484000
*     END;                          /*                       @Y30LB26*/ 10485000
*                                                                  2759 10486000
*   /*****************************************************************/ 10487000
*   /*                                                               */ 10488000
*   /* UPDATE FIELDS IN THE GROUP RECORD THAT CHANGE         @Y30LB26*/ 10489000
*   /* WHEN ONE OF ITS VOLUMES GOES FROM GENERAL TO          @Y30LB26*/ 10490000
*   /* RESTRICTED                                            @Y30LB26*/ 10491000
*   /*                                                               */ 10492000
*   /*****************************************************************/ 10493000
*                                                                  2760 10494000
*   GROUPPTR=ADDR(STORGRP);         /* ADDR TO GROUP REC     @Y30LB26*/ 10495000
@RF02755 LA    @02,STORGRP                                         2760 10496000
         ST    @02,GROUPPTR                                        2760 10497000
*   GRONGEN=GRONGEN-ONE;            /* 1 LESS GENERAL USE    @Y30LB26*/ 10498000
         LH    @15,GRONGEN(,@02)                                   2761 10499000
         BCTR  @15,0                                               2761 10500000
         STH   @15,GRONGEN(,@02)                                   2761 10501000
*   GRONRSTD=GRONRSTD+ONE;          /* ONE MORE RESTRICTED   @Y30LB26*/ 10502000
         LA    @15,1                                               2762 10503000
         AH    @15,GRONRSTD(,@02)                                  2762 10504000
         STH   @15,GRONRSTD(,@02)                                  2762 10505000
*   ADDGRP=OFF;                     /* INDICATE TAKING OUT   @Y30LB26*/ 10506000
*                                                                  2763 10507000
         NI    ADDGRP,B'11110111'                                  2763 10508000
*   /*****************************************************************/ 10509000
*   /*                                                               */ 10510000
*   /* GO TAKE SOME SPACE OUT OF GROUPS GENERAL VOLUME       @Y30LB26*/ 10511000
*   /* TOTALS SINCE IT IS GOING RESTRICTED                   @Y30LB26*/ 10512000
*   /*                                                               */ 10513000
*   /*****************************************************************/ 10514000
*                                                                  2764 10515000
*   CALL ICBVUPGH(GROUPPTR,BASEVPTR,PASSFLAG);/*             @Y30LB26*/ 10516000
         L     @15,@CV00676                                        2764 10517000
         LA    @01,@AL02764                                        2764 10518000
         BALR  @14,@15                                             2764 10519000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN          @Y30LB26*/ 10520000
         L     @02,RPLVPTR                                         2765 10521000
         CLC   RPLVRETC(2,@02),@CB00747                            2765 10522000
         BE    @RF02765                                            2765 10523000
*     DO;                           /*                       @Y30LB26*/ 10524000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 10525000
         BAL   @14,ERREXIT                                         2767 10526000
*       RETURN;                     /*                       @Y30LB26*/ 10527000
         B     @EL00044                                            2768 10528000
*     END;                          /*                       @Y30LB26*/ 10529000
*                                                                  2769 10530000
*   /*****************************************************************/ 10531000
*   /*                                                               */ 10532000
*   /* UPDATE FIELDS IN THE BASE VOLUME RECORD THAT          @Y30LB26*/ 10533000
*   /* CHANGE WHEN GOING FRON GENERAL TO RESTRICTED          @Y30LB26*/ 10534000
*   /*                                                               */ 10535000
*   /*****************************************************************/ 10536000
*                                                                  2770 10537000
*   BASGENUS=OFF;                   /* NOT GENERAL USE       @Y30LB26*/ 10538000
@RF02765 DS    0H                                                  2771 10539000
*   BASRSTD=ON;                     /* RESTRICTED USE        @Y30LB26*/ 10540000
         L     @02,BASEVPTR                                        2771 10541000
         OI    BASRSTD(@02),B'00001000'                            2771 10542000
         NI    BASGENUS(@02),B'11101111'                           2771 10543000
*   BASEXPDT=NULEXPDT;              /* CLEAR EXPIRATION      @Y30LB26*/ 10544000
*                                                                  2772 10545000
         MVC   BASEXPDT(4,@02),NULEXPDT                            2772 10546000
*   /*****************************************************************/ 10547000
*   /*                                                               */ 10548000
*   /* WRITE THE GROUP RECORD JUST PREVIOUSLY READ           @Y30LB26*/ 10549000
*   /*                                                               */ 10550000
*   /*****************************************************************/ 10551000
*                                                                  2773 10552000
*   RPLVTYP=RPLVPUT;                /* PUT GROUP REC         @Y30LB26*/ 10553000
         L     @02,RPLVPTR                                         2773 10554000
         MVI   RPLVTYP(@02),X'01'                                  2773 10555000
*   RESPECIFY                                                      2774 10556000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 10557000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 10558000
         LR    REG1,@02                                            2775 10559000
*   CALL ICBVIO00;                  /* READ GROUP RECORD     @Y30LB26*/ 10560000
         L     @15,@CV00671                                        2776 10561000
         BALR  @14,@15                                             2776 10562000
*   RESPECIFY                                                      2777 10563000
*     REG1 UNRSTD;                  /* UNRESTRICT REG1       @Y30LB26*/ 10564000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN?         @Y30LB26*/ 10565000
         L     @02,RPLVPTR                                         2778 10566000
         CLC   RPLVRETC(2,@02),@CB00747                            2778 10567000
         BE    @RF02778                                            2778 10568000
*     DO;                           /*                       @Y30LB26*/ 10569000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 10570000
         BAL   @14,ERREXIT                                         2780 10571000
*       RETURN;                     /*                       @Y30LB26*/ 10572000
         B     @EL00044                                            2781 10573000
*     END;                          /*                       @Y30LB26*/ 10574000
*                                                                  2782 10575000
*   /*****************************************************************/ 10576000
*   /*                                                               */ 10577000
*   /* IF THE RPLV HAS NEVER BEEN JOURNALED BEFORE, DO IT    @Y30LB26*/ 10578000
*   /*                                                               */ 10579000
*   /*****************************************************************/ 10580000
*                                                                  2783 10581000
*   IF JRNLEDSW=OFF THEN            /* JOURNALED?            @Y30LB26*/ 10582000
@RF02778 TM    JRNLEDSW,B'00000001'                                2783 10583000
         BNZ   @RF02783                                            2783 10584000
*     CALL JOURNAL;                 /* JOURNAL IT            @Y30LB26*/ 10585000
*                                                                  2784 10586000
         BAL   @14,JOURNAL                                         2784 10587000
*   /*****************************************************************/ 10588000
*   /*                                                               */ 10589000
*   /* REMOVE SLOT FROM THE GROUP EXTENSION RECORD           @Y30LB26*/ 10590000
*   /*                                                               */ 10591000
*   /*****************************************************************/ 10592000
*                                                                  2785 10593000
*   ADDSLEXT=OFF;                   /* INDICATE REMOVING     @Y30LB26*/ 10594000
@RF02783 NI    ADDSLEXT,B'11111101'                                2785 10595000
*   SLOTEXP=OFF;                    /* NOT EXPIR CALL        @Y30LB26*/ 10596000
         NI    SLOTEXP,B'01111111'                                 2786 10597000
*   CALL VUEXT;                     /* GO REMOVE SLOT        @Y30LB26*/ 10598000
*                                                                  2787 10599000
         BAL   @14,VUEXT                                           2787 10600000
*   /*****************************************************************/ 10601000
*   /*                                                               */ 10602000
*   /* CHECK RETURN CODE                                     @Y30LB26*/ 10603000
*   /*                                                               */ 10604000
*   /*****************************************************************/ 10605000
*                                                                  2788 10606000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN?         @Y30LB26*/ 10607000
         L     @02,RPLVPTR                                         2788 10608000
         CLC   RPLVRETC(2,@02),@CB00747                            2788 10609000
         BE    @RF02788                                            2788 10610000
*     DO;                           /*                       @Y30LB26*/ 10611000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 10612000
         BAL   @14,ERREXIT                                         2790 10613000
*       RETURN;                     /*                       @Y30LB26*/ 10614000
         B     @EL00044                                            2791 10615000
*     END;                          /*                       @Y30LB26*/ 10616000
*   RETURN;                         /*                       @Y30LB26*/ 10617000
         B     @EL00044                                            2793 10618000
*   END RESTRICT;                   /*                       @Y30LB26*/ 10619000
         B     @EL00044                                            2794 10620000
*                                                                  2795 10621000
*   /*****************************************************************/ 10622000
*   /*                                                               */ 10623000
*   /* THIS ROUTINE IS CALLED WHEN A BASE VOLUME RECORD      @Y30LB26*/ 10624000
*   /* IS GOING FROM RESTRICTED TO GENERAL USE IN THE        @Y30LB26*/ 10625000
*   /* SAME GROUP                                            @Y30LB26*/ 10626000
*   /*                                                               */ 10627000
*   /*****************************************************************/ 10628000
*                                                                  2795 10629000
*GENERAL:                           /*                       @Y30LB26*/ 10630000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 10631000
*                                                                  2795 10632000
GENERAL  ST    @14,@SA00045                                        2795 10633000
*   /*****************************************************************/ 10634000
*   /*                                                               */ 10635000
*   /* GET GROUP NAME FROM BASE RECORD AND SET UP TO         @Y30LB26*/ 10636000
*   /* READ THE GROUP RECORD                                 @Y30LB26*/ 10637000
*   /*                                                               */ 10638000
*   /*****************************************************************/ 10639000
*                                                                  2796 10640000
*   GROUPKY=BASGROUP;               /* GET NEW GROUP NAME    @Y30LB26*/ 10641000
         L     @02,BASEVPTR                                        2796 10642000
         MVC   GROUPKY(8),BASGROUP(@02)                            2796 10643000
*   RPLVKEY=ADDR(GKEY);             /* ADDR GROUP KEY        @Y30LB26*/ 10644000
         L     @02,RPLVPTR                                         2797 10645000
         LA    @15,GKEY                                            2797 10646000
         ST    @15,RPLVKEY(,@02)                                   2797 10647000
*   RPLVBUF=ADDR(STORGRP);          /* BUFFER ADDRESS        @Y30LB26*/ 10648000
         LA    @15,STORGRP                                         2798 10649000
         ST    @15,RPLVBUF(,@02)                                   2798 10650000
*   RPLVBLN=LENGTH(STORGRP);        /* LENGTH OF BUFFER      @Y30LB26*/ 10651000
         MVC   RPLVBLN(4,@02),@CF01147                             2799 10652000
*   RPLVLOC=OFF;                    /* NO LOCATE MODE        @Y30LB26*/ 10653000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 10654000
         OI    RPLVDIR(@02),B'01000000'                            2801 10655000
         NI    RPLVLOC(@02),B'01111111'                            2801 10656000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB26*/ 10657000
         MVI   RPLVTYP(@02),X'00'                                  2802 10658000
*   RPLVUPD=ON;                     /* FOR UPDATE            @Y30LB26*/ 10659000
         OI    RPLVUPD(@02),B'00000010'                            2803 10660000
*   RESPECIFY                                                      2804 10661000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 10662000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 10663000
         LR    REG1,@02                                            2805 10664000
*   CALL ICBVIO00;                  /* READ GROUP RECORD     @Y30LB26*/ 10665000
         L     @15,@CV00671                                        2806 10666000
         BALR  @14,@15                                             2806 10667000
*   RESPECIFY                                                      2807 10668000
*     REG1 UNRSTD;                  /* UNRESTRICT REG1       @Y30LB26*/ 10669000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN?         @Y30LB26*/ 10670000
         L     @02,RPLVPTR                                         2808 10671000
         CLC   RPLVRETC(2,@02),@CB00747                            2808 10672000
         BE    @RF02808                                            2808 10673000
*     DO;                           /*                       @Y30LB26*/ 10674000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 10675000
         BAL   @14,ERREXIT                                         2810 10676000
*       RETURN;                     /*                       @Y30LB26*/ 10677000
@EL00045 DS    0H                                                  2811 10678000
@EF00045 DS    0H                                                  2811 10679000
@ER00045 L     @14,@SA00045                                        2811 10680000
         BR    @14                                                 2811 10681000
*     END;                          /*                       @Y30LB26*/ 10682000
*                                                                  2812 10683000
*   /*****************************************************************/ 10684000
*   /*                                                               */ 10685000
*   /* GET ADDRESS OF GROUP RECORD, UPDATE REQUIRED FIELDS   @Y30LB26*/ 10686000
*   /*                                                               */ 10687000
*   /*****************************************************************/ 10688000
*                                                                  2813 10689000
*   GROUPPTR=ADDR(STORGRP);         /* ADDRESSING TO GRP REC @Y30LB26*/ 10690000
*                                                                  2813 10691000
@RF02808 LA    @02,STORGRP                                         2813 10692000
         ST    @02,GROUPPTR                                        2813 10693000
*   /*****************************************************************/ 10694000
*   /*                                                               */ 10695000
*   /* CHECK MOUNTING ATTRIBUTES                             @Y30LB26*/ 10696000
*   /*                                                               */ 10697000
*   /*****************************************************************/ 10698000
*                                                                  2814 10699000
*   IF BASBIND=OFF&GROBIND=OFF|     /* BINDS MATCH?          @Y30LB26*/ 10700000
*       BASBIND=ON&GROBIND=ON THEN  /* BINDS MATCH?          @Y30LB26*/ 10701000
         L     @01,BASEVPTR                                        2814 10702000
         TM    BASBIND(@01),B'00000010'                            2814 10703000
         BNZ   @GL00060                                            2814 10704000
         TM    GROBIND(@02),B'10000000'                            2814 10705000
         BZ    @RT02814                                            2814 10706000
@GL00060 L     @02,BASEVPTR                                        2814 10707000
         TM    BASBIND(@02),B'00000010'                            2814 10708000
         BNO   @RF02814                                            2814 10709000
         L     @02,GROUPPTR                                        2814 10710000
         TM    GROBIND(@02),B'10000000'                            2814 10711000
         BNO   @RF02814                                            2814 10712000
@RT02814 DS    0H                                                  2815 10713000
*     DO;                           /*                       @Y30LB26*/ 10714000
*       IF BASEXCL=OFF&GROEXCL=OFF| /* EXCL MATC             @Y30LB26*/ 10715000
*           BASEXCL=ON&GROEXCL=ON THEN/* EXCL MAT            @Y30LB26*/ 10716000
         L     @02,BASEVPTR                                        2816 10717000
         TM    BASEXCL(@02),B'00000001'                            2816 10718000
         BNZ   @GL00063                                            2816 10719000
         L     @02,GROUPPTR                                        2816 10720000
         TM    GROEXCL(@02),B'01000000'                            2816 10721000
         BZ    @RT02816                                            2816 10722000
@GL00063 L     @02,BASEVPTR                                        2816 10723000
         TM    BASEXCL(@02),B'00000001'                            2816 10724000
         BNO   @RF02816                                            2816 10725000
         L     @02,GROUPPTR                                        2816 10726000
         TM    GROEXCL(@02),B'01000000'                            2816 10727000
         BNO   @RF02816                                            2816 10728000
@RT02816 DS    0H                                                  2817 10729000
*         DO;                       /*                       @Y30LB26*/ 10730000
*           IF BASDAERA=OFF&GRODAERA=OFF|/* ERA              @Y30LB26*/ 10731000
*               BASDAERA=ON&GRODAERA=ON THEN/* ERA           @Y30LB26*/ 10732000
         L     @02,BASEVPTR                                        2818 10733000
         TM    BASDAERA(@02),B'10000000'                           2818 10734000
         BNZ   @GL00066                                            2818 10735000
         L     @02,GROUPPTR                                        2818 10736000
         TM    GRODAERA(@02),B'00100000'                           2818 10737000
         BZ    @RT02818                                            2818 10738000
@GL00066 L     @02,BASEVPTR                                        2818 10739000
         TM    BASDAERA(@02),B'10000000'                           2818 10740000
         BNO   @RF02818                                            2818 10741000
         L     @02,GROUPPTR                                        2818 10742000
         TM    GRODAERA(@02),B'00100000'                           2818 10743000
         BNO   @RF02818                                            2818 10744000
@RT02818 DS    0H                                                  2819 10745000
*             DO;                   /*                       @Y30LB26*/ 10746000
*               IF BASRONLY=OFF&GRORONLY=OFF|/*              @Y30LB26*/ 10747000
*                   BASRONLY=ON&GRORONLY=ON/*                @Y30LB26*/ 10748000
*                 THEN                                             2820 10749000
         L     @02,BASEVPTR                                        2820 10750000
         TM    BASRONLY(@02),B'01000000'                           2820 10751000
         BNZ   @GL00069                                            2820 10752000
         L     @02,GROUPPTR                                        2820 10753000
         TM    GRORONLY(@02),B'00010000'                           2820 10754000
         BZ    @RT02820                                            2820 10755000
@GL00069 L     @02,BASEVPTR                                        2820 10756000
         TM    BASRONLY(@02),B'01000000'                           2820 10757000
         BNO   @RF02820                                            2820 10758000
         L     @02,GROUPPTR                                        2820 10759000
         TM    GRORONLY(@02),B'00010000'                           2820 10760000
         BNO   @RF02820                                            2820 10761000
@RT02820 DS    0H                                                  2821 10762000
*                 I=I;              /* DUMMY INST            @Y30LB26*/ 10763000
         SLR   @02,@02                                             2821 10764000
         IC    @02,I                                               2821 10765000
         STC   @02,I                                               2821 10766000
*               ELSE                /*                       @Y30LB26*/ 10767000
*                 DO;               /*                       @Y30LB26*/ 10768000
         B     @RC02820                                            2822 10769000
@RF02820 DS    0H                                                  2823 10770000
*                   RPLVRETC=FOUR;  /* BAD RC                @Y30LB26*/ 10771000
         L     @02,RPLVPTR                                         2823 10772000
         MVC   RPLVRETC(2,@02),@CB00749                            2823 10773000
*                   RPLRCODE=INCOMSS1;/* INCOM               @Y30LB26*/ 10774000
         MVC   RPLRCODE(2,@02),@CB00827                            2824 10775000
*                   CALL ERREXIT;   /* SAVE STUFF            @Y30LB26*/ 10776000
         BAL   @14,ERREXIT                                         2825 10777000
*                   RETURN;         /*                       @Y30LB26*/ 10778000
         B     @EL00045                                            2826 10779000
*                 END;              /*                       @Y30LB26*/ 10780000
*             END;                  /*                       @Y30LB26*/ 10781000
*           ELSE                    /*                       @Y30LB26*/ 10782000
*             DO;                   /*                       @Y30LB26*/ 10783000
         B     @RC02818                                            2829 10784000
@RF02818 DS    0H                                                  2830 10785000
*               RPLVRETC=FOUR;      /* BAD RC                @Y30LB26*/ 10786000
         L     @02,RPLVPTR                                         2830 10787000
         MVC   RPLVRETC(2,@02),@CB00749                            2830 10788000
*               RPLRCODE=INCOMSS1;  /* INCOM SS              @Y30LB26*/ 10789000
         MVC   RPLRCODE(2,@02),@CB00827                            2831 10790000
*               CALL ERREXIT;       /* SAVE                  @Y30LB26*/ 10791000
         BAL   @14,ERREXIT                                         2832 10792000
*               RETURN;             /*                       @Y30LB26*/ 10793000
         B     @EL00045                                            2833 10794000
*             END;                  /*                       @Y30LB26*/ 10795000
*         END;                      /*                       @Y30LB26*/ 10796000
*       ELSE                        /*                       @Y30LB26*/ 10797000
*         DO;                       /*                       @Y30LB26*/ 10798000
         B     @RC02816                                            2836 10799000
@RF02816 DS    0H                                                  2837 10800000
*           RPLVRETC=FOUR;          /* BAD RC                @Y30LB26*/ 10801000
         L     @02,RPLVPTR                                         2837 10802000
         MVC   RPLVRETC(2,@02),@CB00749                            2837 10803000
*           RPLRCODE=INCOMSS1;      /* INCOM                 @Y30LB26*/ 10804000
         MVC   RPLRCODE(2,@02),@CB00827                            2838 10805000
*           CALL ERREXIT;           /* SAVE RET              @Y30LB26*/ 10806000
         BAL   @14,ERREXIT                                         2839 10807000
*           RETURN;                 /*                       @Y30LB26*/ 10808000
         B     @EL00045                                            2840 10809000
*         END;                      /*                       @Y30LB26*/ 10810000
*     END;                          /*                       @Y30LB26*/ 10811000
*   ELSE                            /*                       @Y30LB26*/ 10812000
*                                                                  2843 10813000
*     /***************************************************************/ 10814000
*     /*                                                             */ 10815000
*     /* IF ATTRIBUTES DONT MATCH, EXIT ERROR                @Y30LB26*/ 10816000
*     /*                                                             */ 10817000
*     /***************************************************************/ 10818000
*                                                                  2843 10819000
*     DO;                           /*                       @Y30LB26*/ 10820000
         B     @RC02814                                            2843 10821000
@RF02814 DS    0H                                                  2844 10822000
*       RPLVRETC=FOUR;              /* SET BAD RC            @Y30LB26*/ 10823000
         L     @02,RPLVPTR                                         2844 10824000
         MVC   RPLVRETC(2,@02),@CB00749                            2844 10825000
*       RPLRCODE=INCOMSS1;          /* INCOMPAT SS1 ATT      @Y30LB26*/ 10826000
         MVC   RPLRCODE(2,@02),@CB00827                            2845 10827000
*       CALL ERREXIT;               /* SAVE RET CODES        @Y30LB26*/ 10828000
         BAL   @14,ERREXIT                                         2846 10829000
*       RETURN;                     /*                       @Y30LB26*/ 10830000
         B     @EL00045                                            2847 10831000
*     END;                          /*                       @Y30LB26*/ 10832000
*   GRONGEN=GRONGEN+ONE;            /* ONE MORE GENERAL USE  #Y30LB26*/ 10833000
@RC02814 L     @02,GROUPPTR                                        2849 10834000
         LA    @15,1                                               2849 10835000
         AH    @15,GRONGEN(,@02)                                   2849 10836000
         STH   @15,GRONGEN(,@02)                                   2849 10837000
*   GRONRSTD=GRONRSTD-ONE;          /* ONE LESS RESTRICTED   #Y30LB26*/ 10838000
*                                                                  2850 10839000
         LH    @15,GRONRSTD(,@02)                                  2850 10840000
         BCTR  @15,0                                               2850 10841000
         STH   @15,GRONRSTD(,@02)                                  2850 10842000
*   /*****************************************************************/ 10843000
*   /*                                                               */ 10844000
*   /* GO ADD SOME SPACE TO THE GROUP FIELDS SINCE IT IS     #Y30LB26*/ 10845000
*   /* GETTING A GENERAL TYPE VOLUME                         #Y30LB26*/ 10846000
*   /*                                                               */ 10847000
*   /*****************************************************************/ 10848000
*                                                                  2851 10849000
*   ADDGRP=ON;                      /* INDICATE ADDING GEN   @Y30LB26*/ 10850000
         OI    ADDGRP,B'00001000'                                  2851 10851000
*   CALL ICBVUPGH(GROUPPTR,BASEVPTR,PASSFLAG);/*             @Y30LB26*/ 10852000
         L     @15,@CV00676                                        2852 10853000
         LA    @01,@AL02852                                        2852 10854000
         BALR  @14,@15                                             2852 10855000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN          @Y30LB26*/ 10856000
         L     @02,RPLVPTR                                         2853 10857000
         CLC   RPLVRETC(2,@02),@CB00747                            2853 10858000
         BE    @RF02853                                            2853 10859000
*     DO;                           /*                       @Y30LB26*/ 10860000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 10861000
         BAL   @14,ERREXIT                                         2855 10862000
*       RETURN;                     /*                       @Y30LB26*/ 10863000
         B     @EL00045                                            2856 10864000
*     END;                          /*                       @Y30LB26*/ 10865000
*                                                                  2858 10866000
*   /*****************************************************************/ 10867000
*   /*                                                               */ 10868000
*   /* CHANGE INDICATORS IN BASE VOLUME TO GENERAL USE       @Y30LB26*/ 10869000
*   /*                                                               */ 10870000
*   /*****************************************************************/ 10871000
*                                                                  2858 10872000
*   BASGENUS=ON;                    /* GENERAL USE           @Y30LB26*/ 10873000
@RF02853 DS    0H                                                  2859 10874000
*   BASRSTD=OFF;                    /* NOT RESTRICTED USE    @Y30LB26*/ 10875000
*                                                                  2859 10876000
         L     @02,BASEVPTR                                        2859 10877000
         OI    BASGENUS(@02),B'00010000'                           2859 10878000
         NI    BASRSTD(@02),B'11110111'                            2859 10879000
*   /*****************************************************************/ 10880000
*   /*                                                               */ 10881000
*   /* WRITE GROUP RECORD                                    @Y30LB26*/ 10882000
*   /*                                                               */ 10883000
*   /*****************************************************************/ 10884000
*                                                                  2860 10885000
*   RPLVTYP=RPLVPUT;                /* PUT GROUP REC         @Y30LB26*/ 10886000
         L     @02,RPLVPTR                                         2860 10887000
         MVI   RPLVTYP(@02),X'01'                                  2860 10888000
*   RESPECIFY                                                      2861 10889000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 10890000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 10891000
         LR    REG1,@02                                            2862 10892000
*   CALL ICBVIO00;                  /* READ GROUP RECORD     @Y30LB26*/ 10893000
         L     @15,@CV00671                                        2863 10894000
         BALR  @14,@15                                             2863 10895000
*   RESPECIFY                                                      2864 10896000
*     REG1 UNRSTD;                  /* UNRESTRICT REG1       @Y30LB26*/ 10897000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN?         @Y30LB26*/ 10898000
         L     @02,RPLVPTR                                         2865 10899000
         CLC   RPLVRETC(2,@02),@CB00747                            2865 10900000
         BE    @RF02865                                            2865 10901000
*     DO;                           /*                       @Y30LB26*/ 10902000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 10903000
         BAL   @14,ERREXIT                                         2867 10904000
*       RETURN;                     /*                       @Y30LB26*/ 10905000
         B     @EL00045                                            2868 10906000
*     END;                          /*                       @Y30LB26*/ 10907000
*                                                                  2869 10908000
*   /*****************************************************************/ 10909000
*   /*                                                               */ 10910000
*   /* IF RPLV HAS NOT BEEN JOURNALED BEFORE, JOURNAL IT     @Y30LB26*/ 10911000
*   /*                                                               */ 10912000
*   /*****************************************************************/ 10913000
*                                                                  2870 10914000
*   IF JRNLEDSW=OFF THEN            /* JOURNALED?            @Y30LB26*/ 10915000
@RF02865 TM    JRNLEDSW,B'00000001'                                2870 10916000
         BNZ   @RF02870                                            2870 10917000
*     CALL JOURNAL;                 /* JOURNAL IT            @Y30LB26*/ 10918000
*                                                                  2871 10919000
         BAL   @14,JOURNAL                                         2871 10920000
*   /*****************************************************************/ 10921000
*   /*                                                               */ 10922000
*   /* ADD SLOT TO THE GROUP EXTENSION RECORD                @Y30LB26*/ 10923000
*   /*                                                               */ 10924000
*   /*****************************************************************/ 10925000
*                                                                  2872 10926000
*   ADDSLEXT=ON;                    /* INDICATE ADDING       @Y30LB26*/ 10927000
@RF02870 OI    ADDSLEXT,B'00000010'                                2872 10928000
*   SLOTEXP=OFF;                    /* NOT EXPIR CALL        @Y30LB26*/ 10929000
         NI    SLOTEXP,B'01111111'                                 2873 10930000
*   CALL VUEXT;                     /* GO ADD SLOT           @Y30LB26*/ 10931000
*                                                                  2874 10932000
         BAL   @14,VUEXT                                           2874 10933000
*   /*****************************************************************/ 10934000
*   /*                                                               */ 10935000
*   /* CHECK RETURN CODE                                     @Y30LB26*/ 10936000
*   /*                                                               */ 10937000
*   /*****************************************************************/ 10938000
*                                                                  2875 10939000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN?         @Y30LB26*/ 10940000
         L     @02,RPLVPTR                                         2875 10941000
         CLC   RPLVRETC(2,@02),@CB00747                            2875 10942000
         BE    @RF02875                                            2875 10943000
*     DO;                           /*                       @Y30LB26*/ 10944000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 10945000
         BAL   @14,ERREXIT                                         2877 10946000
*       RETURN;                     /*                       @Y30LB26*/ 10947000
         B     @EL00045                                            2878 10948000
*     END;                          /*                       @Y30LB26*/ 10949000
*   RETURN;                         /*                       #Y30LB26*/ 10950000
         B     @EL00045                                            2880 10951000
*   END GENERAL;                    /*                       @Y30LB26*/ 10952000
         B     @EL00045                                            2881 10953000
*                                                                  2882 10954000
*   /*****************************************************************/ 10955000
*   /*                                                               */ 10956000
*   /* THIS ROUTINE READS THE GROUP RECORD IF EITHER         @Y30LB26*/ 10957000
*   /* TO OR FOR EXPIRATION DATES WERE SPECIFIED AND         @Y30LB26*/ 10958000
*   /* IF THERE IS NO EXPIRATION CHECKING FOR THE GROUP      @Y30LB26*/ 10959000
*   /* IT RETURNS WITH AN REASON CODE                        @Y30LB26*/ 10960000
*   /*                                                               */ 10961000
*   /*****************************************************************/ 10962000
*                                                                  2882 10963000
*EXPCK:                                                            2882 10964000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 10965000
*                                                                  2882 10966000
EXPCK    ST    @14,@SA00046                                        2882 10967000
*   /*****************************************************************/ 10968000
*   /*                                                               */ 10969000
*   /* BE SURE THAT TO OR FOR WERE SPECIFIED                 @Y30LB26*/ 10970000
*   /*                                                               */ 10971000
*   /*****************************************************************/ 10972000
*                                                                  2883 10973000
*   IF MVRFLFOR=ON|MVRFLTO=ON THEN  /* CK TO AND FOR         @Y30LB26*/ 10974000
         L     @02,MVRPTR                                          2883 10975000
         TM    MVRFLFOR(@02),B'10001000'                           2883 10976000
         BZ    @RF02883                                            2883 10977000
*     DO;                           /*                       @Y30LB26*/ 10978000
*                                                                  2884 10979000
*       /*************************************************************/ 10980000
*       /*                                                           */ 10981000
*       /* SEE IF BASE RECORD IS GOING GROUPED GENERAL OR    @Y30LB26*/ 10982000
*       /* STAYING GROUPED GENERAL USE                       @Y30LB26*/ 10983000
*       /*                                                           */ 10984000
*       /*************************************************************/ 10985000
*                                                                  2885 10986000
*       IF((MVRFLGRO=ON|BASGRPV=ON)&MVRGEN=ON)|/* GO GEN GRP ?     2885 10987000
*                                                            @Y30LB26*/ 10988000
*           (BASGENUS=ON&MVRNGRP=OFF&MVRRSTD=OFF) THEN/* STAY GEN  2885 10989000
*                                                            @Y30LB26*/ 10990000
*                                                                  2885 10991000
         TM    MVRFLGRO(@02),B'01000000'                           2885 10992000
         BO    @GL00073                                            2885 10993000
         L     @02,BASEVPTR                                        2885 10994000
         TM    BASGRPV(@02),B'00100000'                            2885 10995000
         BNO   @GL00072                                            2885 10996000
@GL00073 L     @02,MVRPTR                                          2885 10997000
         TM    MVRGEN(@02),B'10000000'                             2885 10998000
         BO    @RT02885                                            2885 10999000
@GL00072 L     @02,BASEVPTR                                        2885 11000000
         TM    BASGENUS(@02),B'00010000'                           2885 11001000
         BNO   @RF02885                                            2885 11002000
         L     @02,MVRPTR                                          2885 11003000
         TM    MVRNGRP(@02),B'01100000'                            2885 11004000
         BNZ   @RF02885                                            2885 11005000
@RT02885 DS    0H                                                  2886 11006000
*         /***********************************************************/ 11007000
*         /*                                                         */ 11008000
*         /* GET GROUP NAME FROM CORRECT SORCE               @Y30LB26*/ 11009000
*         /*                                                         */ 11010000
*         /***********************************************************/ 11011000
*                                                                  2886 11012000
*         DO;                       /*                       @Y30LB26*/ 11013000
*           IF MVRFLGRO=ON THEN     /* GROUP SPECIFIED ?     @Y30LB26*/ 11014000
         L     @02,MVRPTR                                          2887 11015000
         TM    MVRFLGRO(@02),B'01000000'                           2887 11016000
         BNO   @RF02887                                            2887 11017000
*             GROUPKY=MVRGROUP;     /* GROUP FROM REQ BLK    @Y30LB26*/ 11018000
         MVC   GROUPKY(8),MVRGROUP(@02)                            2888 11019000
*           ELSE                    /*                       @Y30LB26*/ 11020000
*             GROUPKY=BASGROUP;     /* GROUP FROM BASE REC   @Y30LB26*/ 11021000
*                                                                  2889 11022000
         B     @RC02887                                            2889 11023000
@RF02887 L     @02,BASEVPTR                                        2889 11024000
         MVC   GROUPKY(8),BASGROUP(@02)                            2889 11025000
*           /*********************************************************/ 11026000
*           /*                                                       */ 11027000
*           /* SET UP REMAINING PARAMETERS AND READ GROUP RECORD     */ 11028000
*           /*                                               @Y30LB26*/ 11029000
*           /* TO SEE IF IT HAS RETENTION SPECIFIED FOR GROUP        */ 11030000
*           /*                                               @Y30LB26*/ 11031000
*           /*                                                       */ 11032000
*           /*********************************************************/ 11033000
*                                                                  2890 11034000
*           RPLVKEY=ADDR(GKEY);     /* ADDR OF KEY           @Y30LB26*/ 11035000
@RC02887 L     @02,RPLVPTR                                         2890 11036000
         LA    @15,GKEY                                            2890 11037000
         ST    @15,RPLVKEY(,@02)                                   2890 11038000
*           RPLVLOC=ON;             /* LOCATE MODE           @Y30LB26*/ 11039000
*           RPLVDIR=ON;             /* READ DIRECT           @Y30LB26*/ 11040000
         OI    RPLVLOC(@02),B'11000000'                            2892 11041000
*           RPLVTYP=RPLVREAD;       /* READ REC              @Y30LB26*/ 11042000
         MVI   RPLVTYP(@02),X'00'                                  2893 11043000
*           RPLVUPD=OFF;            /* NOT FOR UPDATE        @Y30LB26*/ 11044000
         NI    RPLVUPD(@02),B'11111101'                            2894 11045000
*           RESPECIFY                                              2895 11046000
*             REG1 RSTD;            /* RESTRICT REG 1        @Y30LB26*/ 11047000
*           REG1=RPLVPTR;           /* ADDR OF RPLV          @Y30LB26*/ 11048000
         LR    REG1,@02                                            2896 11049000
*           CALL ICBVIO00;          /* READ GROUP RECORD     @Y30LB26*/ 11050000
         L     @15,@CV00671                                        2897 11051000
         BALR  @14,@15                                             2897 11052000
*           RPLVLOC=OFF;            /* RESET LOCATE FLAG     @Y30LB26*/ 11053000
         L     @02,RPLVPTR                                         2898 11054000
         NI    RPLVLOC(@02),B'01111111'                            2898 11055000
*           RESPECIFY                                              2899 11056000
*             REG1 UNRSTD;          /* UNRESTRICT REG1       @Y30LB26*/ 11057000
*           IF RPLVRETC¬=RCZERO THEN/* CHECK RETURN?         @Y30LB26*/ 11058000
         CLC   RPLVRETC(2,@02),@CB00747                            2900 11059000
         BE    @RF02900                                            2900 11060000
*             DO;                   /*                       @Y30LB26*/ 11061000
*               CALL ERREXIT;       /* FREE INVENTORY        @Y30LB26*/ 11062000
         BAL   @14,ERREXIT                                         2902 11063000
*               RETURN;             /*                       @Y30LB26*/ 11064000
@EL00046 DS    0H                                                  2903 11065000
@EF00046 DS    0H                                                  2903 11066000
@ER00046 L     @14,@SA00046                                        2903 11067000
         BR    @14                                                 2903 11068000
*             END;                  /*                       @Y30LB26*/ 11069000
*                                                                  2904 11070000
*           /*********************************************************/ 11071000
*           /*                                                       */ 11072000
*           /* GET ADDRESS OF GROUP RECORD AND CHECK IF RETENTION    */ 11073000
*           /*                                               @Y30LB26*/ 11074000
*           /* CHECKING IN EFFECT                            @Y30LB26*/ 11075000
*           /*                                                       */ 11076000
*           /*********************************************************/ 11077000
*                                                                  2905 11078000
*           GROUPPTR=RPLVBUF;       /* ADDRESSING TO BUFFER  @Y30LB26*/ 11079000
@RF02900 L     @02,RPLVPTR                                         2905 11080000
         L     @15,RPLVBUF(,@02)                                   2905 11081000
         ST    @15,GROUPPTR                                        2905 11082000
*           IF GRORETN=OFF THEN     /* NO RET DATE?          @Y30LB26*/ 11083000
*                                                                  2906 11084000
         TM    GRORETN(@15),B'00000100'                            2906 11085000
         BNZ   @RF02906                                            2906 11086000
*             /*******************************************************/ 11087000
*             /*                                                     */ 11088000
*             /* IF RETENTION CHECKING NOT IN EFFECT, THEN FOULED UP */ 11089000
*             /*                                             @Y30LB26*/ 11090000
*             /*                                                     */ 11091000
*             /*******************************************************/ 11092000
*                                                                  2907 11093000
*             DO;                   /*                       @Y30LB26*/ 11094000
*               RPLVRETC=FOUR;      /* SET BAD RETURN        @Y30LB26*/ 11095000
         MVC   RPLVRETC(2,@02),@CB00749                            2908 11096000
*               RPLRCODE=NOEXPICK;  /* NO GROUP EXPIRATION   @Y30LB26*/ 11097000
         MVC   RPLRCODE(2,@02),@CB00825                            2909 11098000
*               CALL ERREXIT;       /* FREE INVENTORY        @Y30LB26*/ 11099000
         BAL   @14,ERREXIT                                         2910 11100000
*               RETURN;             /*                       @Y30LB26*/ 11101000
         B     @EL00046                                            2911 11102000
*             END;                  /*                       @Y30LB26*/ 11103000
*         END;                      /*                       @Y30LB26*/ 11104000
*                                                                  2913 11105000
*       /*************************************************************/ 11106000
*       /*                                                           */ 11107000
*       /* IF BASE VOLUME IS NOT BECOMMING A GROUPED GENERAL @Y30LB26*/ 11108000
*       /* USE, OR STAYING A GROUPED GENERAL USE, THEN TO    @Y30LB26*/ 11109000
*       /* OR FOR SHOULD NOT HAVE BEEN SPECIFIED             @Y30LB26*/ 11110000
*       /*                                                           */ 11111000
*       /*************************************************************/ 11112000
*                                                                  2914 11113000
*       ELSE                        /*                       @Y30LB26*/ 11114000
*         DO;                       /*                       @Y30LB26*/ 11115000
         B     @RC02885                                            2914 11116000
@RF02885 DS    0H                                                  2915 11117000
*           RPLVRETC=FOUR;          /* SET BAD RET CODE      @Y30LB26*/ 11118000
         L     @02,RPLVPTR                                         2915 11119000
         MVC   RPLVRETC(2,@02),@CB00749                            2915 11120000
*           RPLRCODE=NOEXPICK;      /* NO EXPIRATION CK      @Y30LB26*/ 11121000
         MVC   RPLRCODE(2,@02),@CB00825                            2916 11122000
*           CALL ERREXIT;           /* SAVE RET CODES        @Y30LB26*/ 11123000
         BAL   @14,ERREXIT                                         2917 11124000
*           RETURN;                 /*                       @Y30LB26*/ 11125000
         B     @EL00046                                            2918 11126000
*         END;                      /*                       @Y30LB26*/ 11127000
*     END;                          /*                       @Y30LB26*/ 11128000
*   END EXPCK;                      /*                       @Y30LB26*/ 11129000
         B     @EL00046                                            2921 11130000
*                                                                  2922 11131000
*   /*****************************************************************/ 11132000
*   /*                                                               */ 11133000
*   /* ROUTINE UPDATES THE REMAINING FIELDS IN THE BASE      @Y30LB26*/ 11134000
*   /* VOLUME RECORD THAT HAVE NOTHING TO DO WITH THE GROUP  @Y30LB26*/ 11135000
*   /*                                                               */ 11136000
*   /*****************************************************************/ 11137000
*                                                                  2922 11138000
*COMMON:                            /*                       @Y30LB26*/ 11139000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 11140000
*                                                                  2922 11141000
COMMON   ST    @14,@SA00047                                        2922 11142000
*   /*****************************************************************/ 11143000
*   /*                                                               */ 11144000
*   /* IF GENERAL USE VOLUME THEN HANDLE EXPIRATION          #Y30LB26*/ 11145000
*   /* CHANGES IF CALLED FOR                                 #Y30LB26*/ 11146000
*   /*                                                               */ 11147000
*   /*****************************************************************/ 11148000
*                                                                  2923 11149000
*   IF BASGRPV=ON&BASGENUS=ON&      /* GENERAL USE VOL?      @Y30LB26*/ 11150000
*       (MVRNEXPD=ON|MVRFLFOR=ON|MVRFLTO=ON) THEN/* CHNGN EXP      2923 11151000
*                                                            @Y30LB26*/ 11152000
         L     @02,BASEVPTR                                        2923 11153000
         TM    BASGRPV(@02),B'00110000'                            2923 11154000
         BNO   @RF02923                                            2923 11155000
         L     @02,MVRPTR                                          2923 11156000
         TM    MVRNEXPD(@02),B'00000100'                           2923 11157000
         BO    @RT02923                                            2923 11158000
         TM    MVRFLFOR(@02),B'10001000'                           2923 11159000
         BZ    @RF02923                                            2923 11160000
@RT02923 DS    0H                                                  2924 11161000
*     DO;                           /*                       @Y30LB26*/ 11162000
*                                                                  2924 11163000
*       /*************************************************************/ 11164000
*       /*                                                           */ 11165000
*       /* READ GROUP RECORD FOR SLOT ROUTINE WHICH          @Y30LB26*/ 11166000
*       /* NEEDS GROUP RECORD                                @Y30LB26*/ 11167000
*       /*                                                           */ 11168000
*       /*************************************************************/ 11169000
*                                                                  2925 11170000
*       GROUPKY=BASGROUP;           /* GET GROUP NAME        @Y30LB26*/ 11171000
         L     @02,BASEVPTR                                        2925 11172000
         MVC   GROUPKY(8),BASGROUP(@02)                            2925 11173000
*       RPLVKEY=ADDR(GKEY);         /* ADDR GROUP KEY        @Y30LB26*/ 11174000
         L     @02,RPLVPTR                                         2926 11175000
         LA    @15,GKEY                                            2926 11176000
         ST    @15,RPLVKEY(,@02)                                   2926 11177000
*       RPLVLOC=OFF;                /* LOCATE MODE           @ZA13484*/ 11178000
         NI    RPLVLOC(@02),B'01111111'                            2927 11179000
*       RPLVBLN=LENGTH(STORGRP);    /* SET LENGTH            @ZA13484*/ 11180000
         MVC   RPLVBLN(4,@02),@CF01147                             2928 11181000
*       RPLVBUF=ADDR(STORGRP);      /* SET BUF ADDR          @ZA13484*/ 11182000
         LA    @15,STORGRP                                         2929 11183000
         ST    @15,RPLVBUF(,@02)                                   2929 11184000
*       RPLVDIR=ON;                 /* READ DIRECT           @Y30LB26*/ 11185000
         OI    RPLVDIR(@02),B'01000000'                            2930 11186000
*       RPLVTYP=RPLVREAD;           /* READ GROUP REC        @Y30LB26*/ 11187000
         MVI   RPLVTYP(@02),X'00'                                  2931 11188000
*       RPLVUPD=OFF;                /* NO UPDATE             @Y30LB26*/ 11189000
         NI    RPLVUPD(@02),B'11111101'                            2932 11190000
*       RESPECIFY                                                  2933 11191000
*         REG1 RSTD;                /* RESTRICT REG 1        @Y30LB26*/ 11192000
*       REG1=RPLVPTR;               /* ADDR RPLV             @Y30LB26*/ 11193000
         LR    REG1,@02                                            2934 11194000
*       CALL ICBVIO00;              /* READ GROUP RECORD     @Y30LB26*/ 11195000
         L     @15,@CV00671                                        2935 11196000
         BALR  @14,@15                                             2935 11197000
*       RESPECIFY                                                  2936 11198000
*         REG1 UNRSTD;              /* FREE REG 1            @Y30LB26*/ 11199000
*                                                                  2936 11200000
*       /*************************************************************/ 11201000
*       /*                                                           */ 11202000
*       /* CHECK RETURN CODE                                 @Y30LB26*/ 11203000
*       /*                                                           */ 11204000
*       /*************************************************************/ 11205000
*                                                                  2937 11206000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @Y30LB26*/ 11207000
         L     @02,RPLVPTR                                         2937 11208000
         CLC   RPLVRETC(2,@02),@CB00747                            2937 11209000
         BE    @RF02937                                            2937 11210000
*         DO;                       /*                       @Y30LB26*/ 11211000
*           CALL ERREXIT;           /* SAVE RETURN CODES     @Y30LB26*/ 11212000
         BAL   @14,ERREXIT                                         2939 11213000
*           RETURN;                 /*                       @Y30LB26*/ 11214000
@EL00047 DS    0H                                                  2940 11215000
@EF00047 DS    0H                                                  2940 11216000
@ER00047 L     @14,@SA00047                                        2940 11217000
         BR    @14                                                 2940 11218000
*         END;                      /*                       @Y30LB26*/ 11219000
*                                                                  2941 11220000
*       /*************************************************************/ 11221000
*       /*                                                           */ 11222000
*       /* SET ADDR TO GROUP RECORD JUST READ                @Y30LB26*/ 11223000
*       /*                                                           */ 11224000
*       /*************************************************************/ 11225000
*                                                                  2942 11226000
*       GROUPPTR=ADDR(STORGRP);     /* ADDR GRP REC          @ZA13484*/ 11227000
*                                                                  2942 11228000
@RF02937 LA    @02,STORGRP                                         2942 11229000
         ST    @02,GROUPPTR                                        2942 11230000
*       /*************************************************************/ 11231000
*       /*                                                           */ 11232000
*       /* NULLIFY EXPIRATION DATE BASE RECORD               #Y30LB26*/ 11233000
*       /* CALL ROUTINE TO UPDATE SLOT IN EXTENSION RECORD   @ZA00687*/ 11234000
*       /* TO MATCH RETENTION DATE IN BASE VOLUME RECORD     @ZA00687*/ 11235000
*       /* IF REQUEST TO MODIFY GROUP NAME OR TO GENERAL-USE @ZA00687*/ 11236000
*       /* MODIFY RETENTION DATE, DO NOT DELETE AND RE-ADD.  @ZA00687*/ 11237000
*       /* ALREADY IN LAST GEOUP EXTENSION SLOT. IF MODIFV   @ZA00687*/ 11238000
*       /* FOR RETENTION DATE. REMOVE FROM CURRENT SLOT AND  @ZA00687*/ 11239000
*       /* ADD IN LAST EXTENSION SLOT                        @ZA00687*/ 11240000
*       /*                                                           */ 11241000
*       /*************************************************************/ 11242000
*                                                                  2943 11243000
*       IF MVRNEXPD=ON THEN         /* NULL EXPIRATION DATE? @ZA00687*/ 11244000
         L     @02,MVRPTR                                          2943 11245000
         TM    MVRNEXPD(@02),B'00000100'                           2943 11246000
         BNO   @RF02943                                            2943 11247000
*         DO;                       /*                       @XM40000*/ 11248000
*           BASEXPDT=NULEXPDT;      /* NULLIFY EXPIRATION    @ZA00687*/ 11249000
         L     @01,BASEVPTR                                        2945 11250000
         MVC   BASEXPDT(4,@01),NULEXPDT                            2945 11251000
*           IF MVRFLGRO=ON|MVRGEN=ON THEN                          2946 11252000
         TM    MVRFLGRO(@02),B'01000000'                           2946 11253000
         BO    @RT02946                                            2946 11254000
         TM    MVRGEN(@02),B'10000000'                             2946 11255000
         BO    @RT02946                                            2946 11256000
*             ;                     /*                       @ZA00687*/ 11257000
*           ELSE                                                   2948 11258000
*             DO;                   /*                       @ZA00687*/ 11259000
*               SLOTEXP=OFF;        /* INDICATE DELETE       @ZA00687*/ 11260000
         NI    SLOTEXP,B'01111111'                                 2949 11261000
*               ADDSLEXT=OFF;       /* INDICATE DELETE       @ZA00687*/ 11262000
         NI    ADDSLEXT,B'11111101'                                2950 11263000
*               CALL VUEXT;         /* GO UPDATE SLOT        @ZA00687*/ 11264000
         BAL   @14,VUEXT                                           2951 11265000
*               IF RPLVRETC¬=RCZERO THEN/* CK RETURN         @ZA00687*/ 11266000
         L     @02,RPLVPTR                                         2952 11267000
         CLC   RPLVRETC(2,@02),@CB00747                            2952 11268000
         BE    @RF02952                                            2952 11269000
*                 DO;               /*                       @ZA00687*/ 11270000
*                   CALL ERREXIT;   /* SAVE RET CODES        @ZA00687*/ 11271000
         BAL   @14,ERREXIT                                         2954 11272000
*                   RETURN;         /*                       @ZA00687*/ 11273000
         B     @EL00047                                            2955 11274000
*                 END;              /*                       @ZA00687*/ 11275000
*               ADDSLEXT=ON;        /* INDICATE ADD          @ZA00687*/ 11276000
@RF02952 OI    ADDSLEXT,B'00000010'                                2957 11277000
*               CALL VUEXT;         /* GO UPDATE SLOT        @ZA00687*/ 11278000
         BAL   @14,VUEXT                                           2958 11279000
*               IF RPLVRETC¬=RCZERO THEN/* CK RETURN         @ZA00687*/ 11280000
         L     @02,RPLVPTR                                         2959 11281000
         CLC   RPLVRETC(2,@02),@CB00747                            2959 11282000
         BE    @RF02959                                            2959 11283000
*                 DO;               /*                       @ZA00687*/ 11284000
*                   CALL ERREXIT;   /* SAVE RET CODES        @ZA00687*/ 11285000
         BAL   @14,ERREXIT                                         2961 11286000
*                   RETURN;         /*                       @ZA00687*/ 11287000
         B     @EL00047                                            2962 11288000
*                 END;              /*                       @ZA00687*/ 11289000
*             END;                  /*                       @ZA00687*/ 11290000
*         END;                      /*                       @XM40000*/ 11291000
*       ELSE                        /*                       #Y30LB26*/ 11292000
*                                                                  2966 11293000
*         /***********************************************************/ 11294000
*         /*                                                         */ 11295000
*         /* OTHERWISE CHECK IF TO OR FOR SPECIFIED          #Y30LB26*/ 11296000
*         /*                                                         */ 11297000
*         /***********************************************************/ 11298000
*                                                                  2966 11299000
*         DO;                       /*                       #Y30LB26*/ 11300000
*                                                                  2966 11301000
         B     @RC02943                                            2966 11302000
@RF02943 DS    0H                                                  2967 11303000
*           /*********************************************************/ 11304000
*           /*                                                       */ 11305000
*           /* IF FOR SPECIFIED, GO CALCULATE EXPIRATION     #Y30LB26*/ 11306000
*           /* DATE AND PUT IT IN BASE RECORD                #Y30LB26*/ 11307000
*           /*                                                       */ 11308000
*           /*********************************************************/ 11309000
*                                                                  2967 11310000
*           IF MVRFLFOR=ON THEN     /* FOR SPECIFIED?        #Y30LB26*/ 11311000
         L     @02,MVRPTR                                          2967 11312000
         TM    MVRFLFOR(@02),B'10000000'                           2967 11313000
         BNO   @RF02967                                            2967 11314000
*             DO;                   /*                       @Y30LB26*/ 11315000
*               FOREXP=MVRFOR;      /* SET FOR EXP DATE      @Y30LB26*/ 11316000
         LH    FOREXP,MVRFOR(,@02)                                 2969 11317000
*               CALL VUEXP;         /*                       @Y30LB26*/ 11318000
         BAL   @14,VUEXP                                           2970 11319000
*               BASEXPDT=RETDATE;   /* RET IN BASE REC       @Y30LB26*/ 11320000
         L     @02,BASEVPTR                                        2971 11321000
         MVC   BASEXPDT(4,@02),RETDATE                             2971 11322000
*             END;                  /*                       @Y30LB26*/ 11323000
*                                                                  2972 11324000
*           /*********************************************************/ 11325000
*           /*                                                       */ 11326000
*           /* IF TO WAS SPECIFIED, IF IT EXCEEDS MAXIMUM,   @Y30LB26*/ 11327000
*           /* PUT IN MAXIMUM DATE, OTHERWISE PUT IN TO DATE @Y30LB26*/ 11328000
*           /*                                                       */ 11329000
*           /*********************************************************/ 11330000
*                                                                  2973 11331000
*           IF MVRFLTO=ON THEN      /* TO SPECIFIED?         @Y30LB26*/ 11332000
@RF02967 L     @02,MVRPTR                                          2973 11333000
         TM    MVRFLTO(@02),B'00001000'                            2973 11334000
         BNO   @RF02973                                            2973 11335000
*             DO;                   /*                       @Y30LB26*/ 11336000
*               IF MVRTO>MAXDATE THEN/* CHECK DATE?          @Y30LB26*/ 11337000
         CLC   MVRTO(4,@02),MAXDATE                                2975 11338000
         BNH   @RF02975                                            2975 11339000
*                 BASEXPDT=MAXDATE; /* SET TO MAX DATE       @Y30LB26*/ 11340000
         L     @02,BASEVPTR                                        2976 11341000
         MVC   BASEXPDT(4,@02),MAXDATE                             2976 11342000
*               ELSE                /*                       @Y30LB26*/ 11343000
*                 BASEXPDT=MVRTO;   /* SET TO GIVEN DATE     @Y30LB26*/ 11344000
         B     @RC02975                                            2977 11345000
@RF02975 L     @02,BASEVPTR                                        2977 11346000
         L     @01,MVRPTR                                          2977 11347000
         MVC   BASEXPDT(4,@02),MVRTO(@01)                          2977 11348000
*             END;                  /*                       @Y30LB26*/ 11349000
@RC02975 DS    0H                                                  2979 11350000
*         END;                      /*                       @Y30LB26*/ 11351000
*                                                                  2979 11352000
@RF02973 DS    0H                                                  2980 11353000
*       /*************************************************************/ 11354000
*       /*                                                           */ 11355000
*       /* CALL ROUTINE TO UPDATE SLOT IN EXTENSION RECORD   @Y30LB26*/ 11356000
*       /* TO MATCH RETENTION DATE IN BASE VOLUME RECORD     @Y30LB26*/ 11357000
*       /*                                                           */ 11358000
*       /*************************************************************/ 11359000
*                                                                  2980 11360000
*       SLOTEXP=ON;                 /* INDICATE ONLY EXP     @ZA00687*/ 11361000
@RC02943 OI    SLOTEXP,B'10000000'                                 2980 11362000
*       CALL VUEXT;                 /* GO UPDATE SLOT        @ZA00687*/ 11363000
         BAL   @14,VUEXT                                           2981 11364000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             @ZA00687*/ 11365000
         L     @02,RPLVPTR                                         2982 11366000
         CLC   RPLVRETC(2,@02),@CB00747                            2982 11367000
         BE    @RF02982                                            2982 11368000
*         DO;                       /*                       @ZA00687*/ 11369000
*           CALL ERREXIT;           /* SAVE RET CODES        @ZA00687*/ 11370000
         BAL   @14,ERREXIT                                         2984 11371000
*           RETURN;                 /*                       @ZA00687*/ 11372000
         B     @EL00047                                            2985 11373000
*         END;                      /*                       @ZA00687*/ 11374000
*     END;                          /*                       #Y30LB26*/ 11375000
*                                                                  2987 11376000
@RF02982 DS    0H                                                  2988 11377000
*   /*****************************************************************/ 11378000
*   /*                                                               */ 11379000
*   /* IF NULLIFY DESCRIPTION CALLED FOR, NULLIFY IT         #Y30LB26*/ 11380000
*   /*                                                               */ 11381000
*   /*****************************************************************/ 11382000
*                                                                  2988 11383000
*   IF MVRNDESC=ON THEN             /* NULLIFY DEXCRIPTION?  #Y30LB26*/ 11384000
@RF02923 L     @02,MVRPTR                                          2988 11385000
         TM    MVRNDESC(@02),B'00001000'                           2988 11386000
         BNO   @RF02988                                            2988 11387000
*     BASDESCR=BLANK;               /* NULLIFT DESCRIP       #Y30LB26*/ 11388000
         L     @02,BASEVPTR                                        2989 11389000
         MVI   BASDESCR+1(@02),C' '                                2989 11390000
         MVC   BASDESCR+2(28,@02),BASDESCR+1(@02)                  2989 11391000
         MVI   BASDESCR(@02),C' '                                  2989 11392000
*   ELSE                            /*                       #Y30LB26*/ 11393000
*                                                                  2990 11394000
*     /***************************************************************/ 11395000
*     /*                                                             */ 11396000
*     /* OTHERWISE SEE IF NEW DESCRIPTION CALLED FOR         #Y30LB26*/ 11397000
*     /*                                                             */ 11398000
*     /***************************************************************/ 11399000
*                                                                  2990 11400000
*     IF MVRFLDES=ON THEN           /* DESCR SPEC?           #Y30LB26*/ 11401000
         B     @RC02988                                            2990 11402000
@RF02988 L     @02,MVRPTR                                          2990 11403000
         TM    MVRFLDES(@02),B'00010000'                           2990 11404000
         BNO   @RF02990                                            2990 11405000
*       BASDESCR=MVRDES;            /* MODIFY DESCRIPTION    @Y30LB26*/ 11406000
*                                                                  2991 11407000
         L     @01,BASEVPTR                                        2991 11408000
         MVC   BASDESCR(30,@01),MVRDES(@02)                        2991 11409000
*   /*****************************************************************/ 11410000
*   /*                                                               */ 11411000
*   /* IF NEW BACKUP NUMBER SPECIFIED, PUT IT IN             @Y30LB26*/ 11412000
*   /*                                                               */ 11413000
*   /*****************************************************************/ 11414000
*                                                                  2992 11415000
*   IF MVRFLBK=ON THEN              /* BACKUP SPEC?          @Y30LB26*/ 11416000
@RF02990 DS    0H                                                  2992 11417000
@RC02988 L     @02,MVRPTR                                          2992 11418000
         TM    MVRFLBK(@02),B'00000010'                            2992 11419000
         BNO   @RF02992                                            2992 11420000
*     BASBKLMT=MVRBKUPN;            /* SET MAX BACKUPS       @Y30LB26*/ 11421000
*                                                                  2993 11422000
         L     @01,BASEVPTR                                        2993 11423000
         MVC   BASBKLMT(1,@01),MVRBKUPN(@02)                       2993 11424000
*   /*****************************************************************/ 11425000
*   /*                                                               */ 11426000
*   /* SET MISMATCH FLAG                                     @Y30LB26*/ 11427000
*   /*                                                               */ 11428000
*   /*****************************************************************/ 11429000
*                                                                  2994 11430000
*   IF MVRSLMIS=ON THEN             /* MISMATCH SPECS        @Y30LB26*/ 11431000
@RF02992 L     @02,MVRPTR                                          2994 11432000
         TM    MVRSLMIS(@02),B'00000010'                           2994 11433000
         BNO   @RF02994                                            2994 11434000
*     BASVSMIS=ON;                  /* SET MISMATCH FLAG     @Y30LB26*/ 11435000
         L     @02,BASEVPTR                                        2995 11436000
         OI    BASVSMIS(@02),B'00100000'                           2995 11437000
*   ELSE                            /*                       @Y30LB26*/ 11438000
*                                                                  2996 11439000
*     /***************************************************************/ 11440000
*     /*                                                             */ 11441000
*     /* OTHERWISE MIGHT CLEAR MISMATCH FLAG                 @Y30LB26*/ 11442000
*     /*                                                             */ 11443000
*     /***************************************************************/ 11444000
*                                                                  2996 11445000
*     IF MVRCLMIS=ON THEN           /* CLEAR MISMATCH?       @Y30LB26*/ 11446000
         B     @RC02994                                            2996 11447000
@RF02994 L     @02,MVRPTR                                          2996 11448000
         TM    MVRCLMIS(@02),B'00000001'                           2996 11449000
         BNO   @RF02996                                            2996 11450000
*       BASVSMIS=OFF;               /* CLEAR MISMATCH FLAG   @Y30LB26*/ 11451000
*                                                                  2997 11452000
         L     @02,BASEVPTR                                        2997 11453000
         NI    BASVSMIS(@02),B'11011111'                           2997 11454000
*   /*****************************************************************/ 11455000
*   /*                                                               */ 11456000
*   /* SET NEW VALUE IN RECOVERY VOLUME LABEL AREA           @Y30LB26*/ 11457000
*   /* OF BASE VOLUME RECORD                                 @Y30LB26*/ 11458000
*   /*                                                               */ 11459000
*   /*****************************************************************/ 11460000
*                                                                  2998 11461000
*   IF MVRFLLAB=ON THEN             /* MVRLABEL SPECIFIED ?  @Y30LB26*/ 11462000
@RF02996 DS    0H                                                  2998 11463000
@RC02994 L     @02,MVRPTR                                          2998 11464000
         TM    MVRFLLAB(@02),B'00000001'                           2998 11465000
         BNO   @RF02998                                            2998 11466000
*     BASRECOV=MVRLABEL;            /* SET NEW LABEL         @Y30LB26*/ 11467000
*                                                                  2999 11468000
         L     @01,BASEVPTR                                        2999 11469000
         MVC   BASRECOV(6,@01),MVRLABEL(@02)                       2999 11470000
*   /*****************************************************************/ 11471000
*   /*                                                               */ 11472000
*   /* CLEAR INCOMPLETE VOLUME CREATION FLAG                 @Y30LB26*/ 11473000
*   /*                                                               */ 11474000
*   /*****************************************************************/ 11475000
*                                                                  3000 11476000
*   IF MVRCIVCF=ON THEN             /* CLEAR INCOMPLETE?     @Y30LB26*/ 11477000
@RF02998 L     @02,MVRPTR                                          3000 11478000
         TM    MVRCIVCF(@02),B'10000000'                           3000 11479000
         BNO   @RF03000                                            3000 11480000
*     BASIVCRE=OFF;                 /* CLEAR INCOM VOL FLAG  @Y30LB26*/ 11481000
*                                                                  3001 11482000
         L     @02,BASEVPTR                                        3001 11483000
         NI    BASIVCRE(@02),B'01111111'                           3001 11484000
*   /*****************************************************************/ 11485000
*   /*                                                               */ 11486000
*   /* CLEAR COPY VOLUME FLAG                                @Y30LB26*/ 11487000
*   /*                                                               */ 11488000
*   /*****************************************************************/ 11489000
*                                                                  3002 11490000
*   IF MVRCICPY=ON THEN             /* CLEAR COPY FLAG?      @Y30LB26*/ 11491000
@RF03000 L     @02,MVRPTR                                          3002 11492000
         TM    MVRCICPY(@02),B'01000000'                           3002 11493000
         BNO   @RF03002                                            3002 11494000
*     BASIVCPY=OFF;                 /* CLEAR COPY FLAG       @Y30LB26*/ 11495000
*                                                                  3003 11496000
         L     @02,BASEVPTR                                        3003 11497000
         NI    BASIVCPY(@02),B'10111111'                           3003 11498000
*   /*****************************************************************/ 11499000
*   /*                                                               */ 11500000
*   /* READ BASE VOLUME RECORD FOR UPDATE SO IT              @Y30LB26*/ 11501000
*   /* CAN BE WRITTEN                                        @Y30LB26*/ 11502000
*   /*                                                               */ 11503000
*   /*****************************************************************/ 11504000
*                                                                  3004 11505000
*   RPLVKEY=ADDR(VKEY);             /* ADDR OF KEY           @Y30LB26*/ 11506000
@RF03002 L     @02,RPLVPTR                                         3004 11507000
         LA    @15,VKEY                                            3004 11508000
         ST    @15,RPLVKEY(,@02)                                   3004 11509000
*   RPLVBUF=ADDR(DUMMYREC);         /* DUMMY FILL SPACE      @Y30LB26*/ 11510000
         LA    @15,DUMMYREC                                        3005 11511000
         ST    @15,RPLVBUF(,@02)                                   3005 11512000
*   RPLVBLN=LENGTH(BASEV);          /* LENGTH OF BUFFER      @Y30LB26*/ 11513000
         MVC   RPLVBLN(4,@02),@CF01147                             3006 11514000
*   RPLVLOC=OFF;                    /* NO LOCATE MODE        @Y30LB26*/ 11515000
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB26*/ 11516000
         OI    RPLVDIR(@02),B'01000000'                            3008 11517000
         NI    RPLVLOC(@02),B'01111111'                            3008 11518000
*   RPLVTYP=RPLVREAD;               /* READ REC              @Y30LB26*/ 11519000
         MVI   RPLVTYP(@02),X'00'                                  3009 11520000
*   RPLVUPD=ON;                     /* FOR UPDATE            @Y30LB26*/ 11521000
         OI    RPLVUPD(@02),B'00000010'                            3010 11522000
*   RESPECIFY                                                      3011 11523000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 11524000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 11525000
         LR    REG1,@02                                            3012 11526000
*   CALL ICBVIO00;                  /* READ BASE FOR UPDATE  @Y30LB26*/ 11527000
         L     @15,@CV00671                                        3013 11528000
         BALR  @14,@15                                             3013 11529000
*   RESPECIFY                                                      3014 11530000
*     REG1 UNRSTD;                  /* UNRESTRICT REG1       @Y30LB26*/ 11531000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN?         @Y30LB26*/ 11532000
         L     @02,RPLVPTR                                         3015 11533000
         CLC   RPLVRETC(2,@02),@CB00747                            3015 11534000
         BE    @RF03015                                            3015 11535000
*     DO;                           /*                       @Y30LB26*/ 11536000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 11537000
         BAL   @14,ERREXIT                                         3017 11538000
*       RETURN;                     /*                       @Y30LB26*/ 11539000
         B     @EL00047                                            3018 11540000
*     END;                          /*                       @Y30LB26*/ 11541000
*                                                                  3019 11542000
*   /*****************************************************************/ 11543000
*   /*                                                               */ 11544000
*   /* GET ADDRESS OF UPDATED BASE RECORD AND WRITE IT       @Y30LB26*/ 11545000
*   /*                                                               */ 11546000
*   /*****************************************************************/ 11547000
*                                                                  3020 11548000
*   RPLVBUF=ADDR(STORBASE);         /* ADDR UPDATED REC      @Y30LB26*/ 11549000
@RF03015 L     @02,RPLVPTR                                         3020 11550000
         LA    @15,STORBASE                                        3020 11551000
         ST    @15,RPLVBUF(,@02)                                   3020 11552000
*   RPLVTYP=RPLVPUT;                /* PUT OUT RECORD        @Y30LB26*/ 11553000
         MVI   RPLVTYP(@02),X'01'                                  3021 11554000
*   RESPECIFY                                                      3022 11555000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 11556000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 11557000
         LR    REG1,@02                                            3023 11558000
*   CALL ICBVIO00;                  /* WRITE BASE RECORD     @Y30LB26*/ 11559000
         L     @15,@CV00671                                        3024 11560000
         BALR  @14,@15                                             3024 11561000
*   RESPECIFY                                                      3025 11562000
*     REG1 UNRSTD;                  /* UNRESTRICT REG1       @Y30LB26*/ 11563000
*   IF RPLVRETC¬=RCZERO THEN        /* CHECK RETURN?         @Y30LB26*/ 11564000
         L     @02,RPLVPTR                                         3026 11565000
         CLC   RPLVRETC(2,@02),@CB00747                            3026 11566000
         BE    @RF03026                                            3026 11567000
*     DO;                           /*                       @Y30LB26*/ 11568000
*       CALL ERREXIT;               /* FREE INVENTORY        @Y30LB26*/ 11569000
         BAL   @14,ERREXIT                                         3028 11570000
*       RETURN;                     /*                       @Y30LB26*/ 11571000
         B     @EL00047                                            3029 11572000
*     END;                          /*                       @Y30LB26*/ 11573000
*                                                                  3030 11574000
*   /*****************************************************************/ 11575000
*   /*                                                               */ 11576000
*   /* IF NEVER JOURNALED BEFORE, JOURNAL THE RPLV           @Y30LB26*/ 11577000
*   /*                                                               */ 11578000
*   /*****************************************************************/ 11579000
*                                                                  3031 11580000
*   IF JRNLEDSW=OFF THEN            /* JOURNALED BEFORE?     @Y30LB26*/ 11581000
@RF03026 TM    JRNLEDSW,B'00000001'                                3031 11582000
         BNZ   @RF03031                                            3031 11583000
*     CALL JOURNAL;                 /* JOURNAL RPLV          @Y30LB26*/ 11584000
         BAL   @14,JOURNAL                                         3032 11585000
*   RETURN;                         /*                       @Y30LB26*/ 11586000
         B     @EL00047                                            3033 11587000
*   END COMMON;                     /*                       @Y30LB26*/ 11588000
         B     @EL00047                                            3034 11589000
*                                                                  3035 11590000
*   /*****************************************************************/ 11591000
*   /*                                                               */ 11592000
*   /* THIS ROUTINE JOURNALS THE RPLV AND IS CALLED          @Y30LB26*/ 11593000
*   /* AFTER THE FIRST SUCCESSFUL UPDATE OF THE INVENTORY    @Y30LB26*/ 11594000
*   /* DATA SET. IT SETS THE JRNLEDSW ON SO THAT IT WILL     @Y30LB26*/ 11595000
*   /* NOT BE CALLED AGAIN BY THE SAME FUNCTION              @Y30LB26*/ 11596000
*   /*                                                               */ 11597000
*   /*****************************************************************/ 11598000
*                                                                  3035 11599000
*JOURNAL:                                                          3035 11600000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 11601000
*                                                                  3035 11602000
JOURNAL  ST    @14,@SA00048                                        3035 11603000
*   /*****************************************************************/ 11604000
*   /*                                                               */ 11605000
*   /* RESERVE THE JOURNAL DATA SET                          @Y30LB26*/ 11606000
*   /*                                                               */ 11607000
*   /*****************************************************************/ 11608000
*                                                                  3036 11609000
*   RESPECIFY                                                      3036 11610000
*     REG1 RSTD;                    /* RESTRICT REG1         @Y30LB26*/ 11611000
*   RESPECIFY                                                      3037 11612000
*     REG0 RSTD;                    /* RESTRICT REG0         @Y30LB26*/ 11613000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 11614000
         L     REG1,RPLVPTR                                        3038 11615000
*   REG0=RESEXVJL;                  /* INDICATE JOURNAL      @Y30LB26*/ 11616000
         LA    REG0,17                                             3039 11617000
*   CALL ICBVRR00;                  /* RESERVE JOURNAL       @Y30LB26*/ 11618000
         L     @15,@CV00673                                        3040 11619000
         BALR  @14,@15                                             3040 11620000
*   RESPECIFY                                                      3041 11621000
*     REG0 UNRSTD;                  /* FREE REG0             @Y30LB26*/ 11622000
*   RESPECIFY                                                      3042 11623000
*     REG1 UNRSTD;                  /* FREE REG1             @Y30LB26*/ 11624000
*   EXITVJL=ON;                     /* INDI JOURNAL RESERVED @Y30LB26*/ 11625000
*                                                                  3043 11626000
         OI    EXITVJL,B'00000100'                                 3043 11627000
*   /*****************************************************************/ 11628000
*   /*                                                               */ 11629000
*   /* CALL ROUTINE TO JOURNAL THE RPLV                      @Y30LB26*/ 11630000
*   /*                                                               */ 11631000
*   /*****************************************************************/ 11632000
*                                                                  3044 11633000
*   RESPECIFY                                                      3044 11634000
*     REG1 RSTD;                    /* RESTRICT              @Y30LB26*/ 11635000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 11636000
         L     REG1,RPLVPTR                                        3045 11637000
*   CALL ICBVJL00;                  /* JOURNAL REQUEST BLK   @Y30LB26*/ 11638000
         L     @15,@CV00672                                        3046 11639000
         BALR  @14,@15                                             3046 11640000
*   RESPECIFY                                                      3047 11641000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 11642000
*                                                                  3047 11643000
*   /*****************************************************************/ 11644000
*   /*                                                               */ 11645000
*   /* MAKE IT APPEAR THAT JOURNALING WAS SUCCESSFUL         @Y30LB26*/ 11646000
*   /* EVEN IF IT WAS NOT                                    @Y30LB26*/ 11647000
*   /* SET SWITCH INDICATING IT HAS BEEN JOURNALED           @Y30LB26*/ 11648000
*   /*                                                               */ 11649000
*   /*****************************************************************/ 11650000
*                                                                  3048 11651000
*   RPLVRETC=RCZERO;                /* ZERO RETURN           @Y30LB26*/ 11652000
         L     @07,RPLVPTR                                         3048 11653000
         MVC   RPLVRETC(2,@07),@CB00747                            3048 11654000
*   RPLRCODE=RCZERO;                /* ZERO REASON CODE      @Y30LB26*/ 11655000
         MVC   RPLRCODE(2,@07),@CB00747                            3049 11656000
*   JRNLEDSW=ON;                    /* INDICATE JOURNALED    @Y30LB26*/ 11657000
*                                                                  3050 11658000
         OI    JRNLEDSW,B'00000001'                                3050 11659000
*   /*****************************************************************/ 11660000
*   /*                                                               */ 11661000
*   /* CALL ROUTINE TO RELEASE JOURNAL DATA SET              @Y30LB26*/ 11662000
*   /*                                                               */ 11663000
*   /*****************************************************************/ 11664000
*                                                                  3051 11665000
*   RESPECIFY                                                      3051 11666000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 11667000
*   RESPECIFY                                                      3052 11668000
*     REG0 RSTD;                    /* RESTRICT REG 0        @Y30LB26*/ 11669000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 11670000
         LR    REG1,@07                                            3053 11671000
*   REG0=DEQJRNL;                   /* INDICATE FREE JOURNAL @Y30LB26*/ 11672000
         LA    REG0,16                                             3054 11673000
*   CALL ICBVRR00;                  /* FREE IT               @Y30LB26*/ 11674000
         L     @15,@CV00673                                        3055 11675000
         BALR  @14,@15                                             3055 11676000
*   RESPECIFY                                                      3056 11677000
*     REG0 UNRSTD;                  /* FREE REG 0            @Y30LB26*/ 11678000
*   RESPECIFY                                                      3057 11679000
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/ 11680000
*   EXITVJL=OFF;                    /* INDI JOURNAL FREED    @Y30LB26*/ 11681000
         NI    EXITVJL,B'11111011'                                 3058 11682000
*   RETURN;                         /*                       @Y30LB26*/ 11683000
@EL00048 DS    0H                                                  3059 11684000
@EF00048 DS    0H                                                  3059 11685000
@ER00048 L     @14,@SA00048                                        3059 11686000
         BR    @14                                                 3059 11687000
*   END JOURNAL;                    /*                       @Y30LB26*/ 11688000
*                                                                  3061 11689000
*   /*****************************************************************/ 11690000
*   /*                                                               */ 11691000
*   /* ROUTINE RESERVES THE INVENTORY DATA SET FOR           @Y30LB26*/ 11692000
*   /* EXCLUSIVE USE                                         @Y30LB26*/ 11693000
*   /*                                                               */ 11694000
*   /*****************************************************************/ 11695000
*                                                                  3061 11696000
*RESERINV:                                                         3061 11697000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 11698000
RESERINV ST    @14,@SA00049                                        3061 11699000
*   RESPECIFY                                                      3062 11700000
*    (REG0,                                                        3062 11701000
*     REG1) RSTD;                   /* RESTRICT REGS         @Y30LB26*/ 11702000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 11703000
         L     REG1,RPLVPTR                                        3063 11704000
*   REG0=RESEXINV;                  /*                       @Y30LB26*/ 11705000
         LA    REG0,1                                              3064 11706000
*   CALL ICBVRR00;                  /*                       @Y30LB26*/ 11707000
         L     @15,@CV00673                                        3065 11708000
         BALR  @14,@15                                             3065 11709000
*   RESPECIFY                                                      3066 11710000
*    (REG0,                                                        3066 11711000
*     REG1) UNRSTD;                 /* FREE REGS             @Y30LB26*/ 11712000
*   EXITVVIC=ON;                    /*                       @Y30LB26*/ 11713000
         OI    EXITVVIC,B'00001000'                                3067 11714000
*   RETURN;                         /*                       @Y30LB26*/ 11715000
@EL00049 DS    0H                                                  3068 11716000
@EF00049 DS    0H                                                  3068 11717000
@ER00049 L     @14,@SA00049                                        3068 11718000
         BR    @14                                                 3068 11719000
*   END RESERINV;                   /*                       @Y30LB26*/ 11720000
*                                                                  3070 11721000
*   /*****************************************************************/ 11722000
*   /*                                                               */ 11723000
*   /* ROUTINE ENTERED WHEN AN ERROR OCCURES. FREES JOURNAL  @VS32198*/ 11724000
*   /* IF JOURNAL IS RESERVED AND SAVES REASON AND RETURN    @VS32198*/ 11725000
*   /* CODES BEFORE RELEASE AND THEN RESTORES THEM.          @VS32198*/ 11726000
*   /*                                                               */ 11727000
*   /*****************************************************************/ 11728000
*                                                                  3070 11729000
*ERREXIT:                                                          3070 11730000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 11731000
*                                                                  3070 11732000
ERREXIT  ST    @14,@SA00050                                        3070 11733000
*   /*****************************************************************/ 11734000
*   /*                                                               */ 11735000
*   /* SAVE CODES                                            @Y30LB26*/ 11736000
*   /*                                                               */ 11737000
*   /*****************************************************************/ 11738000
*                                                                  3071 11739000
*   REACODE=RPLRCODE;               /* SAVE REASON CODE      @Y30LB26*/ 11740000
         L     @04,RPLVPTR                                         3071 11741000
         MVC   REACODE(2),RPLRCODE(@04)                            3071 11742000
*   RETCODE=RPLVRETC;               /* SAVE RETURN CODE      @Y30LB26*/ 11743000
*                                                                  3072 11744000
         MVC   RETCODE(2),RPLVRETC(@04)                            3072 11745000
*   /*****************************************************************/ 11746000
*   /*                                                               */ 11747000
*   /* SEE IF JOURNAL DATA SET IS RESERVED                   @Y30LB26*/ 11748000
*   /*                                                               */ 11749000
*   /*****************************************************************/ 11750000
*                                                                  3073 11751000
*   IF EXITVJL=ON THEN              /* THEN JOR NOT RELEASED @Y30LB26*/ 11752000
*                                                                  3073 11753000
         TM    EXITVJL,B'00000100'                                 3073 11754000
         BNO   @RF03073                                            3073 11755000
*     /***************************************************************/ 11756000
*     /*                                                             */ 11757000
*     /* FREE JOURNAL DATA SET                               @Y30LB26*/ 11758000
*     /*                                                             */ 11759000
*     /***************************************************************/ 11760000
*                                                                  3074 11761000
*     DO;                           /* RELEASE IT            @Y30LB26*/ 11762000
*       RESPECIFY                                                  3075 11763000
*         REG1 RSTD;                /* RESTRICT              @Y30LB26*/ 11764000
*       RESPECIFY                                                  3076 11765000
*         REG0 RSTD;                /* RESTRICT              @Y30LB26*/ 11766000
*       REG1=RPLVPTR;               /* ADDR OF RPLV          @Y30LB26*/ 11767000
         LR    REG1,@04                                            3077 11768000
*       REG0=DEQJRNL;               /* SET REG0 TO FREE JRNL @Y30LB26*/ 11769000
         LA    REG0,16                                             3078 11770000
*       CALL ICBVRR00;              /* CALL RESERVE RELEASE  @Y30LB26*/ 11771000
         L     @15,@CV00673                                        3079 11772000
         BALR  @14,@15                                             3079 11773000
*       RESPECIFY                                                  3080 11774000
*         REG0 UNRSTD;              /* FREE                  @Y30LB26*/ 11775000
*       RESPECIFY                                                  3081 11776000
*         REG1 UNRSTD;              /* FREE                  @Y30LB26*/ 11777000
*                                                                  3081 11778000
*       /*************************************************************/ 11779000
*       /*                                                           */ 11780000
*       /* RESTORE REASON AND RETURN VALUES                  @Y30LB26*/ 11781000
*       /*                                                           */ 11782000
*       /*************************************************************/ 11783000
*                                                                  3082 11784000
*       RPLRCODE=REACODE;           /* AND RETURN CODES      @Y30LB26*/ 11785000
         L     @04,RPLVPTR                                         3082 11786000
         MVC   RPLRCODE(2,@04),REACODE                             3082 11787000
*       RPLVRETC=RETCODE;           /* OTHERWISE RETURN      @Y30LB26*/ 11788000
         MVC   RPLVRETC(2,@04),RETCODE                             3083 11789000
*     END;                          /*                       @Y30LB26*/ 11790000
*   RETURN;                         /* RETURN TO CALLER      @Y30LB26*/ 11791000
@EL00050 DS    0H                                                  3085 11792000
@EF00050 DS    0H                                                  3085 11793000
@ER00050 L     @14,@SA00050                                        3085 11794000
         BR    @14                                                 3085 11795000
*   END ERREXIT;                    /*                       @Y30LB26*/ 11796000
         B     @EL00050                                            3086 11797000
*                                                                  3087 11798000
*/*  START OF SPECIFICATIONS ****                                  3087 11799000
*                                                                  3087 11800000
*    PROCEDURE NAME - ICBVUDBR                                @Y30LB26  11801000
*                                                                  3087 11802000
*    FUNCTION - TAKES THE DUPLICATE VOLUME RECORD AND MAKES IT INTO A   11803000
*    NEW BASE VOLUME RECORD.  IT USES THE CSN'S AND LIBID'S        3087 11804000
*    FROM THE DUPLICATE VOLUME RECORD TO FILL IN CORRESPONDING     3087 11805000
*    FIELDS OF THE NEW BASE VOLUME RECORD.  IT ALSO READS THE CARTRIDGE 11806000
*    INDEX RECORDS AND UPDATES THE KEY OF THE VOLUME THE CARTRIDGE 3087 11807000
*    BELONGS TO.  IF THE ORIGINAL BASE VOLUME RECORD WAS GROUPED, THE   11808000
*    EXTERNAL PROCEDURE ICBVUCHI MUST BE CALLED AFTER THIS ROUTINE 3087 11809000
*    RETURNS CONTROL TO THE CALLER, TO CHAIN THE NEW BASE          3087 11810000
*    VOLUME RECORD INTO THE NON-GROUPED CHAIN.  THIS CHAIN-IN ROUTINE   11811000
*    ALSO INCREASES THE VOLUME COUNT BY ONE IN THE NON-GROUPED VOLUME   11812000
*    HEADER RECORD.  IF THE                                        3087 11813000
*    ORIGINAL BASE VOLUME RECORD WAS NON-GROUPED, THE ROUTINE KEEPS     11814000
*    THE PREVIOUS AND NEXT BASE VOLUME ID AND ALSO IF THE VOLUME WAS    11815000
*    FIRST OR LAST IN THE CHAIN, AND SETS THESE FIELDS AND BITS UP IN   11816000
*    THE NEW BASE VOLUME RECORD.  THIS IS TO KEEP FROM HAVING TO CHAIN  11817000
*    THE OLD VOLUME OUT OF THE NON-GROUPED CHAIN AND THEN CHAINING THE  11818000
*    NEW VOLUME BACK IN.  THE ROUTINE THEN DELETES THE DUPLICATE VOLUME 11819000
*    RECORD, WRITES THE NEW BASE VOLUME RECORD AND THE CARTRIDGE   3087 11820000
*    INDEX RECORDS.                                           @Y30LB26  11821000
*                                                                  3087 11822000
*      INPUT - A PARAMETER LIST CONTAINING THE ADDRESS OF THE DUPLICATE 11823000
*      RECORD, THE ADDRESS OF THE RPLV, FLAG BYTES, AND OPTIONALLY THE  11824000
*      VOLID OF PREVIOUS RECORD, AND THE VOLID OF THE NEXT RECORD. 3087 11825000
*      THE FLAG BYTE TELLS IF THE VOLID OF THE PREVIOUS AND        3087 11826000
*      AND THE VOLID OF THE NEXT RECORD IS SPECIFIED, AND IF THE   3087 11827000
*      OLD BASE WAS FIRST OR LAST IN CHAIN.                   @Y30LB26  11828000
*                                                                  3087 11829000
*      OUTPUT - ADDRESS OF CREATED BASE VOL REC RETURNED      @Y30LB26  11830000
*       IN PARM FIELD.                                        @Y30LB26  11831000
*      REASON AND CONDITION CODES RETURNED IN RPLV.           @Y30LB26  11832000
*      THE ONLY REASON CODES RETURNED BY THIS PROCEDURE WILL  @Y30LB26  11833000
*       BE THE I/O PROCESSOR AND THE JOURNAL REASON CODES.    @Y30LB26  11834000
**** END OF SPECIFICATIONS **                                        */ 11835000
*                                                                  3087 11836000
*ICBVUDBR:                                                         3087 11837000
*   ENTRY(DUPVDBR,BASEVDBR,RPLVDBR,FLAGDBR,/*                @Y30LB26*/ 11838000
*       SPREVDBR,SNEXTDBR);         /*                       @Y30LB26*/ 11839000
@EP03087 MVC   @PC00001(24),0(@01)                                 3087 11840000
*   DCL                                                            3088 11841000
*     DUPVDBR PTR(31);              /* PTR TO DUP REC        #Y30LB26*/ 11842000
*   DCL                                                            3089 11843000
*     BASEVDBR PTR(31);             /* RETURNED PTR BASE REC @Y30LB26*/ 11844000
*   DCL                                                            3090 11845000
*     RPLVDBR PTR(31);              /* PTR TO RPLV           #Y30LB26*/ 11846000
*   DCL                                                            3091 11847000
*     FLAGDBR BIT(16);              /* INDICATOR FLAGS       @Y30LB26*/ 11848000
*   DCL                                                            3092 11849000
*     SPREVDBR CHAR(6);             /* SAVE PREV VOLID       #Y30LB26*/ 11850000
*   DCL                                                            3093 11851000
*     SNEXTDBR CHAR(6);             /* SAVE NEXT VOLID       #Y30LB26*/ 11852000
*                                                                  3094 11853000
*   /*****************************************************************/ 11854000
*   /*                                                               */ 11855000
*   /* SET UP VALUES IN PROGRAM AS THEY WERE PASSED          #Y30LB26*/ 11856000
*   /*                                                               */ 11857000
*   /*****************************************************************/ 11858000
*                                                                  3094 11859000
*   DUPVPTR=DUPVDBR;                /* SET EQUAL TO PASSED   #Y30LB26*/ 11860000
         L     @02,@PC00001                                        3094 11861000
         L     @02,DUPVDBR(,@02)                                   3094 11862000
         ST    @02,DUPVPTR                                         3094 11863000
*   RPLVPTR=RPLVDBR;                /* ADDR OF RPLV          #Y30LB26*/ 11864000
         L     @02,@PC00001+8                                      3095 11865000
         L     @02,RPLVDBR(,@02)                                   3095 11866000
         ST    @02,RPLVPTR                                         3095 11867000
*   PASSFLAG=FLAGDBR;               /* INDICATOR FLAGS       #Y30LB26*/ 11868000
         L     @02,@PC00001+12                                     3096 11869000
         MVC   PASSFLAG(2),FLAGDBR(@02)                            3096 11870000
*   SAVEPREV=SPREVDBR;              /* SET PREV VOLID        #Y30LB26*/ 11871000
         L     @02,@PC00001+16                                     3097 11872000
         MVC   SAVEPREV(6),SPREVDBR(@02)                           3097 11873000
*   SAVENEXT=SNEXTDBR;              /* SET NEXT VOLID        #Y30LB26*/ 11874000
         L     @02,@PC00001+20                                     3098 11875000
         MVC   SAVENEXT(6),SNEXTDBR(@02)                           3098 11876000
*   CALL VUDBR;                     /* CALL INTERNAL PROC    @Y30LB26*/ 11877000
         BAL   @14,VUDBR                                           3099 11878000
*   BASEVDBR=BASEVPTR;              /* GET ADDR OF BASE REC  @Y30LB26*/ 11879000
         L     @02,@PC00001+4                                      3100 11880000
         L     @15,BASEVPTR                                        3100 11881000
         ST    @15,BASEVDBR(,@02)                                  3100 11882000
*   RETURN;                         /*                       @Y30LB26*/ 11883000
         B     @EL00001                                            3101 11884000
*                                                                  3102 11885000
*   /*****************************************************************/ 11886000
*   /*                                                               */ 11887000
*   /* PROCEDURE VUDBR IS CODED SO THAT CODE CONTAINED IN    @Y30LB26*/ 11888000
*   /* ENTRY ICBVUDBR CAN BE USED BY BOTH THIS MODULE AND BY @Y30LB26*/ 11889000
*   /* OTHER MODULES                                         @Y30LB26*/ 11890000
*   /*                                                               */ 11891000
*   /*****************************************************************/ 11892000
*                                                                  3102 11893000
*VUDBR:                                                            3102 11894000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 11895000
VUDBR    ST    @14,@SA00051                                        3102 11896000
*   BASEREC=BASEREC&&BASEREC;       /* ZERO BASE BUFFER      @Y30LB26*/ 11897000
         XC    BASEREC(224),BASEREC                                3103 11898000
*   BASEVPTR=ADDR(BASEREC);         /* ADDRESSING TO BASE    #Y30LB26*/ 11899000
         LA    @02,BASEREC                                         3104 11900000
         ST    @02,BASEVPTR                                        3104 11901000
*   VOLKY=DUPSERNO;                 /* MOVE VOLID TO KEY     #Y30LB26*/ 11902000
         L     @15,DUPVPTR                                         3105 11903000
         MVC   VOLKY(6),DUPSERNO(@15)                              3105 11904000
*   VBLKKY=BLANK;                   /* BLANK PART OF KEY     @Y30LB26*/ 11905000
         MVI   VBLKKY,C' '                                         3106 11906000
*   VIDKY=FIXZERO;                  /* MAKE SURE ID ZERO     #Y30LB26*/ 11907000
         MVI   VIDKY,X'00'                                         3107 11908000
*   BASNAME=VKEY;                   /* MOVE KEY TO RECORD    #Y30LB26*/ 11909000
         MVC   BASNAME(13,@02),VKEY                                3108 11910000
*   BASBASVR=ON;                    /* INDICATE BASE VOL     #Y301B26*/ 11911000
         OI    BASBASVR(@02),B'00100000'                           3109 11912000
*   BASINAC=ON;                     /* INACTIVE              @Y301B26*/ 11913000
         OI    BASINAC(@02),B'00000100'                            3110 11914000
*   BASCSN1=DUPCSN1;                /* GET FIRST CARTRIDGE   @Y30LB26*/ 11915000
         MVC   BASCSN1(12,@02),DUPCSN1(@15)                        3111 11916000
*   BASLIB1=DUPLIB1;                /* LIB ID FIRST CSN      @Y30LB26*/ 11917000
         MVC   BASLIB1(1,@02),DUPLIB1(@15)                         3112 11918000
*   BASCSN2=DUPCSN2;                /* GET SECOND CARTRIDGE  @Y30LB26*/ 11919000
         MVC   BASCSN2(12,@02),DUPCSN2(@15)                        3113 11920000
*   BASLIB2=DUPLIB2;                /* LIB ID SECOND CSN     @Y30LB26*/ 11921000
         MVC   BASLIB2(1,@02),DUPLIB2(@15)                         3114 11922000
*   BASBKLMT=ONE;                   /* SET BACKUP LIMIT      @Y30LB26*/ 11923000
         MVI   BASBKLMT(@02),X'01'                                 3115 11924000
*   BASFRESP=FIXF;                  /* ZERO FREE SPACE       @Y30LB26*/ 11925000
         L     @14,FIXF                                            3116 11926000
         STH   @14,BASFRESP(,@02)                                  3116 11927000
*   BASLEXT=FIXF;                   /* ZERO LARGEST EXTENT   @Y30LB26*/ 11928000
         STH   @14,BASLEXT(,@02)                                   3117 11929000
*   BASFREXT=FIXF;                  /* ZERO FREE EXTENTS     @Y30LB26*/ 11930000
         ST    @14,BASFREXT(,@02)                                  3118 11931000
*   BASDLSF=ON;                     /* INDIC SPACE DOWN LVEL @Y30LB26*/ 11932000
         OI    BASDLSF(@02),B'10000000'                            3119 11933000
*   BASPREV=BLANK;                  /* PREVIOUS VOL ID       @Y30LB26*/ 11934000
         MVI   BASPREV+1(@02),C' '                                 3120 11935000
         MVC   BASPREV+2(4,@02),BASPREV+1(@02)                     3120 11936000
         MVI   BASPREV(@02),C' '                                   3120 11937000
*   BASNEXTV=BLANK;                 /* NEXT VOL ID           @Y30LB26*/ 11938000
         MVI   BASNEXTV+1(@02),C' '                                3121 11939000
         MVC   BASNEXTV+2(4,@02),BASNEXTV+1(@02)                   3121 11940000
         MVI   BASNEXTV(@02),C' '                                  3121 11941000
*   BASKLCPY=BLANK;                 /* KEY LATEST COPY       @Y30LB26*/ 11942000
         MVI   BASKLCPY+1(@02),C' '                                3122 11943000
         MVC   BASKLCPY+2(11,@02),BASKLCPY+1(@02)                  3122 11944000
         MVI   BASKLCPY(@02),C' '                                  3122 11945000
*   BASEXPDT=NULEXPDT;              /* NULLIFY EXPIRATION    @Y30LB26*/ 11946000
         MVC   BASEXPDT(4,@02),NULEXPDT                            3123 11947000
*   BASDTREM=BLANK;                 /* DATE VOL REMOVED      @Y30LB26*/ 11948000
         MVI   BASDTREM+1(@02),C' '                                3124 11949000
         MVC   BASDTREM+2(2,@02),BASDTREM+1(@02)                   3124 11950000
         MVI   BASDTREM(@02),C' '                                  3124 11951000
*   BASDESCR=BLANK;                 /* DESCRIPTION           @Y30LB26*/ 11952000
         MVI   BASDESCR+1(@02),C' '                                3125 11953000
         MVC   BASDESCR+2(28,@02),BASDESCR+1(@02)                  3125 11954000
         MVI   BASDESCR(@02),C' '                                  3125 11955000
*   BASOWNER=BLANK;                 /* OWNER                 @Y30LB26*/ 11956000
         MVI   BASOWNER+1(@02),C' '                                3126 11957000
         MVC   BASOWNER+2(8,@02),BASOWNER+1(@02)                   3126 11958000
         MVI   BASOWNER(@02),C' '                                  3126 11959000
*   BASDEST=BLANK;                  /* DESTINATION AFTER EJT @Y30LB26*/ 11960000
         MVI   BASDEST+1(@02),C' '                                 3127 11961000
         MVC   BASDEST+2(28,@02),BASDEST+1(@02)                    3127 11962000
         MVI   BASDEST(@02),C' '                                   3127 11963000
*   BASRECOV=BLANK;                 /* RECOVERY SER NO       @Y30LB26*/ 11964000
         MVI   BASRECOV+1(@02),C' '                                3128 11965000
         MVC   BASRECOV+2(4,@02),BASRECOV+1(@02)                   3128 11966000
         MVI   BASRECOV(@02),C' '                                  3128 11967000
*   BASGROUP=BLANK;                 /* GROUP NAME            @Y30LB26*/ 11968000
         MVI   BASGROUP+1(@02),C' '                                3129 11969000
         MVC   BASGROUP+2(6,@02),BASGROUP+1(@02)                   3129 11970000
         MVI   BASGROUP(@02),C' '                                  3129 11971000
*                                                                  3130 11972000
*   /*****************************************************************/ 11973000
*   /*                                                               */ 11974000
*   /* GET AND UPDATE THE CARTRIDGE INDEX RECORDS ASSIGNED   #Y30LB26*/ 11975000
*   /* TO THE DUPLICATE RECORD                               #Y30LB26*/ 11976000
*   /*                                                               */ 11977000
*   /*****************************************************************/ 11978000
*                                                                  3130 11979000
*   CARTKY=DUPCSN1;                 /* GET CART SERIAL NO    #Y30LB26*/ 11980000
         MVC   CARTKY(12),DUPCSN1(@15)                             3130 11981000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           #Y30LB26*/ 11982000
         L     @02,RPLVPTR                                         3131 11983000
         LA    @15,IKEY                                            3131 11984000
         ST    @15,RPLVKEY(,@02)                                   3131 11985000
*   RPLVBUF=ADDR(STORINDX);         /* BUFFER ADDR           #Y30LB26*/ 11986000
         LA    @15,STORINDX                                        3132 11987000
         ST    @15,RPLVBUF(,@02)                                   3132 11988000
*   RPLVBLN=LENGTH(STORINDX);       /* LENGTH BUFFER         #Y30LB26*/ 11989000
         MVC   RPLVBLN(4,@02),@CF01147                             3133 11990000
*   RPLVLOC=OFF;                    /* NO LOCATE             #Y30LB26*/ 11991000
*   RPLVDIR=ON;                     /* READ DIRECT           #Y30LB26*/ 11992000
         OI    RPLVDIR(@02),B'01000000'                            3135 11993000
         NI    RPLVLOC(@02),B'01111111'                            3135 11994000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           #Y30LB26*/ 11995000
         MVI   RPLVTYP(@02),X'00'                                  3136 11996000
*   RPLVKGE=OFF;                    /* NOT > OR =            #Y30LB26*/ 11997000
         NI    RPLVKGE(@02),B'11111011'                            3137 11998000
*   RPLVUPD=ON;                     /* FOR UPDATE            #Y30LB26*/ 11999000
         OI    RPLVUPD(@02),B'00000010'                            3138 12000000
*   RESPECIFY                                                      3139 12001000
*     REG1 RSTD;                    /* RESTRICT              #Y30LB26*/ 12002000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          #Y30LB26*/ 12003000
         LR    REG1,@02                                            3140 12004000
*   CALL ICBVIO00;                  /* READ FIRST CART       #Y30LB26*/ 12005000
         L     @15,@CV00671                                        3141 12006000
         BALR  @14,@15                                             3141 12007000
*   RESPECIFY                                                      3142 12008000
*     REG1 UNRSTD;                  /* FREE                  #Y30LB26*/ 12009000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             #Y30LB26*/ 12010000
         L     @02,RPLVPTR                                         3143 12011000
         CLC   RPLVRETC(2,@02),@CB00747                            3143 12012000
         BE    @RF03143                                            3143 12013000
*     DO;                           /*                       #Y30LB26*/ 12014000
*       CALL ERREXIT;               /* SAVE RET              #Y30LB26*/ 12015000
         BAL   @14,ERREXIT                                         3145 12016000
*       RETURN;                     /*                       #Y30LB26*/ 12017000
@EL00051 DS    0H                                                  3146 12018000
@EF00051 DS    0H                                                  3146 12019000
@ER00051 L     @14,@SA00051                                        3146 12020000
         BR    @14                                                 3146 12021000
*     END;                          /*                       #Y30LB26*/ 12022000
*                                                                  3147 12023000
*   /*****************************************************************/ 12024000
*   /*                                                               */ 12025000
*   /* SET UP ADDRESSABILITY TO INDEX RECORD                 #Y30LB26*/ 12026000
*   /*                                                               */ 12027000
*   /*****************************************************************/ 12028000
*                                                                  3148 12029000
*   INDEXPTR=ADDR(STORINDX);        /*                       #Y30LB26*/ 12030000
@RF03143 LA    INDEXPTR,STORINDX                                   3148 12031000
*   INDRECKY=BASNAME;               /* PUT NEW OWNER IN      #Y30LB26*/ 12032000
*                                                                  3149 12033000
         L     @06,BASEVPTR                                        3149 12034000
         MVC   INDRECKY(13,INDEXPTR),BASNAME(@06)                  3149 12035000
*   /*****************************************************************/ 12036000
*   /*                                                               */ 12037000
*   /* WRITE UPDATED INDEX RECORD                            #Y30LB26*/ 12038000
*   /*                                                               */ 12039000
*   /*****************************************************************/ 12040000
*                                                                  3150 12041000
*   RPLVTYP=RPLVPUT;                /* INDICATE PUT          #Y30LB26*/ 12042000
         L     @02,RPLVPTR                                         3150 12043000
         MVI   RPLVTYP(@02),X'01'                                  3150 12044000
*   RESPECIFY                                                      3151 12045000
*     REG1 RSTD;                    /* RESTRICT REG 1        #Y30LB26*/ 12046000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          #Y30LB26*/ 12047000
         LR    REG1,@02                                            3152 12048000
*   CALL ICBVIO00;                  /* WRITE INDEX REC       #Y30LB26*/ 12049000
         L     @15,@CV00671                                        3153 12050000
         BALR  @14,@15                                             3153 12051000
*   RESPECIFY                                                      3154 12052000
*     REG1 UNRSTD;                  /* FREE                  #Y30LB26*/ 12053000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             #Y30LB26*/ 12054000
         L     @02,RPLVPTR                                         3155 12055000
         CLC   RPLVRETC(2,@02),@CB00747                            3155 12056000
         BE    @RF03155                                            3155 12057000
*     DO;                           /*                       #Y30LB26*/ 12058000
*       CALL ERREXIT;               /* SAVE RET CODES        #Y30LB26*/ 12059000
         BAL   @14,ERREXIT                                         3157 12060000
*       RETURN;                     /*                       #Y30LB26*/ 12061000
         B     @EL00051                                            3158 12062000
*     END;                          /*                       #Y30LB26*/ 12063000
*                                                                  3159 12064000
*   /*****************************************************************/ 12065000
*   /*                                                               */ 12066000
*   /* IF NOT JOURNALED BEFORE THEN GO JOURNAL THE RPLV      #Y30LB26*/ 12067000
*   /*                                                               */ 12068000
*   /*****************************************************************/ 12069000
*                                                                  3160 12070000
*   IF JRNLEDSW=OFF THEN            /* JOURNALED BEFORE ?    #Y30LB26*/ 12071000
@RF03155 TM    JRNLEDSW,B'00000001'                                3160 12072000
         BNZ   @RF03160                                            3160 12073000
*     DO;                           /*                       #Y30LB26*/ 12074000
*       CALL JOURNAL;               /* JOURNAL RPLV          #Y30LB26*/ 12075000
         BAL   @14,JOURNAL                                         3162 12076000
*       IF RPLVRETC¬=RCZERO THEN    /* CK RETURN             #Y30LB26*/ 12077000
         L     @02,RPLVPTR                                         3163 12078000
         CLC   RPLVRETC(2,@02),@CB00747                            3163 12079000
         BNE   @RT03163                                            3163 12080000
*         RETURN;                   /*                       #Y30LB26*/ 12081000
*     END;                          /*                       #Y30LB26*/ 12082000
*                                                                  3165 12083000
*   /*****************************************************************/ 12084000
*   /*                                                               */ 12085000
*   /* DO THE SAME THING WITH THE SECOND CARTRIDGE           #Y30LB26*/ 12086000
*   /*                                                               */ 12087000
*   /*****************************************************************/ 12088000
*                                                                  3166 12089000
*   CARTKY=DUPCSN2;                 /* GET CART SERIAL NO    #Y30LB26*/ 12090000
@RF03160 L     @02,DUPVPTR                                         3166 12091000
         MVC   CARTKY(12),DUPCSN2(@02)                             3166 12092000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           #Y30LB26*/ 12093000
         L     @02,RPLVPTR                                         3167 12094000
         LA    @15,IKEY                                            3167 12095000
         ST    @15,RPLVKEY(,@02)                                   3167 12096000
*   RPLVBUF=ADDR(STORINDX);         /* BUFFER ADDR           #Y30LB26*/ 12097000
         LA    @15,STORINDX                                        3168 12098000
         ST    @15,RPLVBUF(,@02)                                   3168 12099000
*   RPLVBLN=LENGTH(STORINDX);       /* LENGTH BUFFER         #Y30LB26*/ 12100000
         MVC   RPLVBLN(4,@02),@CF01147                             3169 12101000
*   RPLVDIR=ON;                     /* READ DIRECT           #Y30LB26*/ 12102000
         OI    RPLVDIR(@02),B'01000000'                            3170 12103000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           #Y30LB26*/ 12104000
         MVI   RPLVTYP(@02),X'00'                                  3171 12105000
*   RPLVUPD=ON;                     /* FOR UPDATE            #Y30LB26*/ 12106000
         OI    RPLVUPD(@02),B'00000010'                            3172 12107000
*   RESPECIFY                                                      3173 12108000
*     REG1 RSTD;                    /* RESTRICT              #Y30LB26*/ 12109000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          #Y30LB26*/ 12110000
         LR    REG1,@02                                            3174 12111000
*   CALL ICBVIO00;                  /* READ FIRST CART       #Y30LB26*/ 12112000
         L     @15,@CV00671                                        3175 12113000
         BALR  @14,@15                                             3175 12114000
*   RESPECIFY                                                      3176 12115000
*     REG1 UNRSTD;                  /* FREE                  #Y30LB26*/ 12116000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             #Y30LB26*/ 12117000
         L     @02,RPLVPTR                                         3177 12118000
         CLC   RPLVRETC(2,@02),@CB00747                            3177 12119000
         BE    @RF03177                                            3177 12120000
*     DO;                           /*                       #Y30LB26*/ 12121000
*       CALL ERREXIT;               /* SAVE RET              #Y30LB26*/ 12122000
         BAL   @14,ERREXIT                                         3179 12123000
*       RETURN;                     /*                       #Y30LB26*/ 12124000
         B     @EL00051                                            3180 12125000
*     END;                          /*                       #Y30LB26*/ 12126000
*                                                                  3181 12127000
*   /*****************************************************************/ 12128000
*   /*                                                               */ 12129000
*   /* SET UP ADDRESSABILITY TO INDEX RECORD                 @Y30LB26*/ 12130000
*   /*                                                               */ 12131000
*   /*****************************************************************/ 12132000
*                                                                  3182 12133000
*   INDEXPTR=ADDR(STORINDX);        /*                       @Y30LB26*/ 12134000
@RF03177 LA    INDEXPTR,STORINDX                                   3182 12135000
*   INDRECKY=BASNAME;               /* PUT NEW OWNER IN      @Y30LB26*/ 12136000
*                                                                  3183 12137000
         L     @06,BASEVPTR                                        3183 12138000
         MVC   INDRECKY(13,INDEXPTR),BASNAME(@06)                  3183 12139000
*   /*****************************************************************/ 12140000
*   /*                                                               */ 12141000
*   /* WRITE UPDATED INDEX RECORD                            @Y30LB26*/ 12142000
*   /*                                                               */ 12143000
*   /*****************************************************************/ 12144000
*                                                                  3184 12145000
*   RPLVTYP=RPLVPUT;                /* INDICATE PUT          @Y30LB26*/ 12146000
         L     @02,RPLVPTR                                         3184 12147000
         MVI   RPLVTYP(@02),X'01'                                  3184 12148000
*   RESPECIFY                                                      3185 12149000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y30LB26*/ 12150000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @Y30LB26*/ 12151000
         LR    REG1,@02                                            3186 12152000
*   CALL ICBVIO00;                  /* WRITE INDEX REC       @Y30LB26*/ 12153000
         L     @15,@CV00671                                        3187 12154000
         BALR  @14,@15                                             3187 12155000
*   RESPECIFY                                                      3188 12156000
*     REG1 UNRSTD;                  /* FREE                  @Y30LB26*/ 12157000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             #Y30LB26*/ 12158000
         L     @02,RPLVPTR                                         3189 12159000
         CLC   RPLVRETC(2,@02),@CB00747                            3189 12160000
         BE    @RF03189                                            3189 12161000
*     DO;                           /*                       #Y30LB26*/ 12162000
*       CALL ERREXIT;               /* SAVE RET CODES        #Y30LB26*/ 12163000
         BAL   @14,ERREXIT                                         3191 12164000
*       RETURN;                     /*                       #Y30LB26*/ 12165000
         B     @EL00051                                            3192 12166000
*     END;                          /*                       #Y30LB26*/ 12167000
*                                                                  3193 12168000
*   /*****************************************************************/ 12169000
*   /*                                                               */ 12170000
*   /* SCRATCH THE DUPLICATE RECORD THAT WAS CONVERTED INTO  #Y30LB26*/ 12171000
*   /* A BASE.                                               #Y30LB26*/ 12172000
*   /*                                                               */ 12173000
*   /*****************************************************************/ 12174000
*                                                                  3194 12175000
*   DKEY=DUPNAME;                   /* DUP KEY               #Y30LB26*/ 12176000
@RF03189 L     @02,DUPVPTR                                         3194 12177000
         MVC   DKEY(13),DUPNAME(@02)                               3194 12178000
*   RPLVKEY=ADDR(DKEY);             /* ADDR OF KEY           #Y30LB26*/ 12179000
         L     @02,RPLVPTR                                         3195 12180000
         LA    @15,DKEY                                            3195 12181000
         ST    @15,RPLVKEY(,@02)                                   3195 12182000
*   RPLVBUF=ADDR(DUMMYREC);         /* DUMMY BUFFER          #Y30LB26*/ 12183000
         LA    @15,DUMMYREC                                        3196 12184000
         ST    @15,RPLVBUF(,@02)                                   3196 12185000
*   RPLVBLN=LENGTH(DUMMYREC);       /* LENGTH BUFFER         #Y30LB26*/ 12186000
         MVC   RPLVBLN(4,@02),@CF01147                             3197 12187000
*   RPLVDIR=ON;                     /* READ DIRECT           #Y30LB26*/ 12188000
         OI    RPLVDIR(@02),B'01000000'                            3198 12189000
*   RPLVTYP=RPLVREAD;               /* DO A READ             #Y30LB26*/ 12190000
         MVI   RPLVTYP(@02),X'00'                                  3199 12191000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       #Y30LB26*/ 12192000
         OI    RPLVUPD(@02),B'00000010'                            3200 12193000
*   RESPECIFY                                                      3201 12194000
*     REG1 RSTD;                    /* RESTRICT              #Y30LB26*/ 12195000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          #Y30LB26*/ 12196000
         LR    REG1,@02                                            3202 12197000
*   CALL ICBVIO00;                  /* READ DUP RECORD       #Y30LB26*/ 12198000
         L     @15,@CV00671                                        3203 12199000
         BALR  @14,@15                                             3203 12200000
*   RESPECIFY                                                      3204 12201000
*     REG1 UNRSTD;                  /* FREE                  #Y30LB26*/ 12202000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             #Y30LB26*/ 12203000
         L     @02,RPLVPTR                                         3205 12204000
         CLC   RPLVRETC(2,@02),@CB00747                            3205 12205000
         BE    @RF03205                                            3205 12206000
*     DO;                           /*                       @Y30LB26*/ 12207000
*       CALL ERREXIT;               /* SAVE RET              @Y30LB26*/ 12208000
         BAL   @14,ERREXIT                                         3207 12209000
*       RETURN;                     /*                       @Y30LB26*/ 12210000
         B     @EL00051                                            3208 12211000
*     END;                          /*                       @Y30LB26*/ 12212000
*                                                                  3209 12213000
*   /*****************************************************************/ 12214000
*   /*                                                               */ 12215000
*   /* NOW DELETE DUP RECORD                                 @Y30LB26*/ 12216000
*   /*                                                               */ 12217000
*   /*****************************************************************/ 12218000
*                                                                  3210 12219000
*   RPLVTYP=RPLVDEL;                /* INDICATE DELETE       @Y30LB26*/ 12220000
@RF03205 L     @02,RPLVPTR                                         3210 12221000
         MVI   RPLVTYP(@02),X'05'                                  3210 12222000
*   RESPECIFY                                                      3211 12223000
*     REG1 RSTD;                    /* RESTRICT              @Y30LB26*/ 12224000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/ 12225000
         LR    REG1,@02                                            3212 12226000
*   CALL ICBVIO00;                  /* DELETE DUP RECORD     @Y30LB26*/ 12227000
         L     @15,@CV00671                                        3213 12228000
         BALR  @14,@15                                             3213 12229000
*   RESPECIFY                                                      3214 12230000
*     REG1 UNRSTD;                  /* FREE                  @Y30LB26*/ 12231000
*   IF RPLVRETC¬=RCZERO THEN        /* CK RETURN             @Y30LB26*/ 12232000
         L     @02,RPLVPTR                                         3215 12233000
         CLC   RPLVRETC(2,@02),@CB00747                            3215 12234000
         BE    @RF03215                                            3215 12235000
*     DO;                           /*                       @Y30LB26*/ 12236000
*       CALL ERREXIT;               /* SAVE RET              #Y30LB26*/ 12237000
         BAL   @14,ERREXIT                                         3217 12238000
*       RETURN;                     /*                       #Y30LB26*/ 12239000
         B     @EL00051                                            3218 12240000
*     END;                          /*                       #Y30LB26*/ 12241000
*                                                                  3219 12242000
*   /*****************************************************************/ 12243000
*   /*                                                               */ 12244000
*   /* IF NOT CHAINING INTO NON-GROUPED, SET REQUIRED        @Y30LB26*/ 12245000
*   /* VALUES IN BASE VOL RECORD                             @Y30LB26*/ 12246000
*   /*                                                               */ 12247000
*   /*****************************************************************/ 12248000
*                                                                  3220 12249000
*   IF DUPBCHI=OFF THEN             /* ALREADY NON-GROUPED   @Y30LB26*/ 12250000
@RF03215 TM    DUPBCHI,B'10000000'                                 3220 12251000
         BNZ   @RF03220                                            3220 12252000
*     DO;                           /*                       @Y30LB26*/ 12253000
*                                                                  3221 12254000
*       /*************************************************************/ 12255000
*       /*                                                           */ 12256000
*       /* CHECK AND SET FIRST AND LAST BITS ON              @Y30LB26*/ 12257000
*       /* IN NEW BASE VOL RECORD IF REQUIRED                @Y30LB26*/ 12258000
*       /*                                                           */ 12259000
*       /*************************************************************/ 12260000
*                                                                  3222 12261000
*       IF FCHNDBR=ON THEN          /* WAS OLD BASE 1ST?     @Y30LB26*/ 12262000
         TM    FCHNDBR,B'01000000'                                 3222 12263000
         BNO   @RF03222                                            3222 12264000
*         BASFIRST=ON;              /* INDICATE IT IS 1ST    @Y30LB26*/ 12265000
         L     @02,BASEVPTR                                        3223 12266000
         OI    BASFIRST(@02),B'00010000'                           3223 12267000
*       IF LCHNDBR=ON THEN          /* LAST IN CHAIN ?       @Y30LB26*/ 12268000
@RF03222 TM    LCHNDBR,B'00100000'                                 3224 12269000
         BNO   @RF03224                                            3224 12270000
*         BASLAST=ON;               /* INDICATE LAST         @Y30LB26*/ 12271000
*                                                                  3225 12272000
         L     @02,BASEVPTR                                        3225 12273000
         OI    BASLAST(@02),B'00001000'                            3225 12274000
*       /*************************************************************/ 12275000
*       /*                                                           */ 12276000
*       /* SET FORWARD AND BACKWARD CHAIN POINTERS           @Y30LB26*/ 12277000
*       /*                                                           */ 12278000
*       /*************************************************************/ 12279000
*                                                                  3226 12280000
*       BASPREV=SAVEPREV;           /* PUT IN PREV VOL       @Y30LB26*/ 12281000
@RF03224 L     @02,BASEVPTR                                        3226 12282000
         MVC   BASPREV(6,@02),SAVEPREV                             3226 12283000
*       BASNEXTV=SAVENEXT;          /* PUT IN NEXT VOL       @Y30LB26*/ 12284000
         MVC   BASNEXTV(6,@02),SAVENEXT                            3227 12285000
*     END;                          /*                       @Y30LB26*/ 12286000
*                                                                  3228 12287000
*   /*****************************************************************/ 12288000
*   /*                                                               */ 12289000
*   /* SET GOOD RETURN CODES                                 @Y30LB26*/ 12290000
*   /*                                                               */ 12291000
*   /*****************************************************************/ 12292000
*                                                                  3229 12293000
*   RPLVRETC=RCZERO;                /*                       @Y30LB26*/ 12294000
@RF03220 L     @02,RPLVPTR                                         3229 12295000
         MVC   RPLVRETC(2,@02),@CB00747                            3229 12296000
*   RPLRCODE=RCZERO;                /*                       @Y30LB26*/ 12297000
         MVC   RPLRCODE(2,@02),@CB00747                            3230 12298000
*   RETURN;                         /*                       @Y301B26*/ 12299000
         B     @EL00051                                            3231 12300000
*   END VUDBR;                      /*                       @Y30LB26*/ 12301000
         B     @EL00051                                            3232 12302000
*                                                                  3233 12303000
*/*  START OF SPECIFICATIONS ****                                  3233 12304000
*                                                                  3233 12305000
*    PROCEDURE NAME - ICBVUEXT                                @Y30LB26  12306000
*                                                                  3233 12307000
*    FUNCTION - READS A GROUPED VOLUME SERIAL NUMBER EXTENSION RECORD   12308000
*    AND EITHER ADDS OR DELETES A SLOT FOR A GIVEN BASE VOLUME RECORD.  12309000
*    IT WILL ALSO UPDATE THE RETENTION PERIOD IN AN EXISTING SLOT. 3233 12310000
*    WHEN ADDING A SLOT, THE NEW SLOT ALWAYS GOES AT THE END OF THE     12311000
*    FIRST EXTENSION RECORD THAT IS NOT FULL.                      3233 12312000
*    IT TAKES INFORMATION FROM THE                                 3233 12313000
*    BASE VOLUME RECORD AND PUTS IT IN THE SLOT OF THE EXTENSION   3233 12314000
*    RECORD.  IF NO SLOT IS AVAILABLE, IT LOOKS FOR THE NEXT EXTENSION  12315000
*    RECORD.  IF ONE DOES NOT EXIST, IT CREATES THE NEXT ONE.  WHEN     12316000
*    DELETING A SLOT, ALL SLOTS ARE READ UNTIL ONE MATCHING THE    3233 12317000
*    VOLUME CONCERNED IS FOUND.  THE REMAINING SLOTS ARE THEN SHIFTED   12318000
*    ONE POSITION OVERLAYING THE DELETED SLOT.  THEN THE SLOT COUNT IN  12319000
*    THE HEADER SECTION OF THE GROUP EXTENSION RECORD IS DECREASED BY   12320000
*    ONE.  WHEN THE SLOT COUNT IN THE EXTENSION RECORD IS ZERO, THE     12321000
*    EXTENSION RECORD IS SCRATCHED AND IF IT WAS THE LAST          3233 12322000
*    EXTENSION RECORD FOR THAT PARTICULAR GROUP, THE PREVIOUS EXTENSION 12323000
*    RECORD IS UPDATED TO SHOW THAT IT IS THE LAST EXTENSION RECORD FOR 12324000
*    THAT GROUP. THE RECORD IS THEN EITHER WRITTEN TO OR DELETED FROM   12325000
*    THE MSVC DATA SET, DEPENDING ON THE SITUATION.  IF THERE ARE NO    12326000
*    GENERAL USE VOLUMES IN THE GROUP, THERE WILL BE NO GROUP EXTENSION 12327000
*    RECORDS.                                                 @Y30LB26  12328000
*                                                                  3233 12329000
*    WHEN CREATING A SLOT, IF THE VOLUME IS EITHER (1) MARKED      3233 12330000
*    MOUNTED TO ANY HOST OR IF (2) THE DOWN LEVEL SPACE FLAG IS    3233 12331000
*    ON, THE RUNNING COUNT FREE SPACE INVALID FLAG IS TURNED ON.   3233 12332000
*    IF THE VOLUME IS NEITHER (1) OR (2) AS ABOVE, THE TOTAL       3233 12333000
*    FREE SPACE FROM THE BASE VOLUME RECORD IS PUT INTO THE        3233 12334000
*    RUNNING COUNT FIELD OF THE GROUP EXTENSION RECORD, AND        3233 12335000
*    THE RUNNING COUNT FREE SPACE INVALID FLAG IS LEFT OFF.        3233 12336000
*                                                             @G24LB04  12337000
*      INPUTS - A PARAMETER LIST CONTAINING THE ADDRESS OF THE GROUP    12338000
*      RECORD, THE ADDRESS OF THE BASE RECORD, THE ADDRESS OF THE RPLV  12339000
*      AND FLAG BYTES TELLING IF A SLOT IS TO BE INSERTED OR DELETED,   12340000
*      OR IF ONLY THE EXPIRATION DATE IS TO BE CHANGED.       @Y30LB26  12341000
*                                                                  3233 12342000
*      OUTPUT - REASON AND CONDITION CODES RETURNED IN RPLV.  THE  3233 12343000
*      REASON CODES RETURNED ARE:                             @Y30LB26  12344000
*                                                                  3233 12345000
*      '021B'X  ERROR OCCURED BUT RPLV WAS JOURNALED.         @Y30LB26  12346000
*      '0202'X  SLOT TO BE DELETED COULD NOT BE FOUND.        @Y30LB26  12347000
*      PLUS I/O PROCESSOR AND THE JOURNAL REASON CODES.       @Y30LB26  12348000
**** END OF SPECIFICATIONS **                                        */ 12349000
*                                                                  3233 12350000
*ICBVUEXT:                                                         3233 12351000
*   ENTRY(GRPEXT,BASEXT,RPLVEXT,FLAGEXT);/*                  #Y30LB26*/ 12352000
@EP03233 MVC   @PC00001+24(16),0(@01)                              3233 12353000
*   DCL                                                            3234 12354000
*     GRPEXT PTR(31);               /* POINTER TO GROUP REC  #Y30LB26*/ 12355000
*   DCL                                                            3235 12356000
*     BASEXT PTR(31);               /* POINTER TO BASE REC   #Y30LB26*/ 12357000
*   DCL                                                            3236 12358000
*     RPLVEXT PTR(31);              /* POINTER TO RPLV       #Y30LB26*/ 12359000
*   DCL                                                            3237 12360000
*     FLAGEXT BIT(16);              /* FLAG BYTE             @Y30LB26*/ 12361000
*                                                                  3238 12362000
*   /*****************************************************************/ 12363000
*   /*                                                               */ 12364000
*   /* SET UP PARAMETERS PASSED TO THIS ROUTINE              @Y30LB26*/ 12365000
*   /*                                                               */ 12366000
*   /*****************************************************************/ 12367000
*                                                                  3238 12368000
*   GROUPPTR=GRPEXT;                /* SET GROUP ADDRESS     @Y30LB26*/ 12369000
         L     @02,@PC00001+24                                     3238 12370000
         L     @02,GRPEXT(,@02)                                    3238 12371000
         ST    @02,GROUPPTR                                        3238 12372000
*   BASEVPTR=BASEXT;                /* ADDRESS BASE REC      @Y30LB26*/ 12373000
         L     @02,@PC00001+28                                     3239 12374000
         L     @02,BASEXT(,@02)                                    3239 12375000
         ST    @02,BASEVPTR                                        3239 12376000
*   RPLVPTR=RPLVEXT;                /* ADDR OF RPLV          @Y30LB26*/ 12377000
         L     @02,@PC00001+32                                     3240 12378000
         L     @02,RPLVEXT(,@02)                                   3240 12379000
         ST    @02,RPLVPTR                                         3240 12380000
*   PASSFLAG=FLAGEXT;               /* FLAG BYTE             @Y30LB26*/ 12381000
*                                                                  3241 12382000
         L     @02,@PC00001+36                                     3241 12383000
         MVC   PASSFLAG(2),FLAGEXT(@02)                            3241 12384000
*   /*****************************************************************/ 12385000
*   /*                                                               */ 12386000
*   /* CALL INTERNAL PROCEDURE TO GET EXTENSION RECORD       @Y30LB26*/ 12387000
*   /* PROCESSED                                             @Y30LB26*/ 12388000
*   /*                                                               */ 12389000
*   /*****************************************************************/ 12390000
*                                                                  3242 12391000
*   CALL VUEXT;                     /* CALL INTERNAL PROC    @Y30LB26*/ 12392000
         BAL   @14,VUEXT                                           3242 12393000
*   RETURN;                         /*                       @Y30LB26*/ 12394000
         B     @EL00001                                            3243 12395000
*                                                                  3244 12396000
*   /*****************************************************************/ 12397000
*   /*                                                               */ 12398000
*   /* PROCEDURE VUEXT IS CODED SO THAT CODE CONTAINED IN    @Y30LB26*/ 12399000
*   /* ENTRY ICBVUEXT CAN BE USED BY BOTH THIS MODULE AND BY @Y30LB26*/ 12400000
*   /* OTHER MODULES                                         @Y30LB26*/ 12401000
*   /*                                                               */ 12402000
*   /*****************************************************************/ 12403000
*                                                                  3244 12404000
*VUEXT:                                                            3244 12405000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 12406000
VUEXT    ST    @14,@SA00052                                        3244 12407000
*   DCL                                                            3245 12408000
*     TWO FIXED(8) CONSTANT(2);     /* TWO                   @Y30LB26*/ 12409000
*   GBLKKY=BLANK;                   /* SET KEY ID            @Y30LB26*/ 12410000
         MVI   GBLKKY,C' '                                         3246 12411000
*   GIDKY=FIXZERO;                  /* INIT KEY ID           @Y30LB26*/ 12412000
         MVI   GIDKY,X'00'                                         3247 12413000
*   LOOPSW=OFF;                     /* OFF BEFORE BEGIN LOOP @Y30LB26*/ 12414000
*                                                                  3248 12415000
         NI    LOOPSW,B'01111111'                                  3248 12416000
*   /*****************************************************************/ 12417000
*   /*                                                               */ 12418000
*   /* SEE IF ADDING, DELETING SLOT OR UPDATING EXPIRATION   @Y30LB26*/ 12419000
*   /* DATE. IF DELETING SLOT OR CHANGING EXPIRATION DATE,   @Y30LB26*/ 12420000
*   /* GO TO SEPERATE SUBROUTINE                             @Y30LB26*/ 12421000
*   /*                                                               */ 12422000
*   /*****************************************************************/ 12423000
*                                                                  3249 12424000
*   IF ADDSLEXT=OFF|SLOTEXP=ON THEN /* DELETE SLOT?          @Y30LB26*/ 12425000
         TM    ADDSLEXT,B'00000010'                                3249 12426000
         BZ    @RT03249                                            3249 12427000
         TM    SLOTEXP,B'10000000'                                 3249 12428000
         BNO   @RF03249                                            3249 12429000
@RT03249 DS    0H                                                  3250 12430000
*     DO;                           /*                       @Y30LB26*/ 12431000
*       CALL DELETESL;              /* GO DELETE SLOT        @Y30LB26*/ 12432000
         BAL   @14,DELETESL                                        3251 12433000
*       GIDKY=FIXZERO;              /* RESET KEY PROPERLY    @Y30LB26*/ 12434000
         MVI   GIDKY,X'00'                                         3252 12435000
*       RETURN;                     /*                       @Y30LB26*/ 12436000
@EL00052 DS    0H                                                  3253 12437000
@EF00052 DS    0H                                                  3253 12438000
@ER00052 L     @14,@SA00052                                        3253 12439000
         BR    @14                                                 3253 12440000
*     END;                          /*                       @Y30LB26*/ 12441000
*                                                                  3254 12442000
*   /*****************************************************************/ 12443000
*   /*                                                               */ 12444000
*   /* BUILD KEY TO READ EXTENSION RECORD                    @Y30LB26*/ 12445000
*   /*                                                               */ 12446000
*   /*****************************************************************/ 12447000
*                                                                  3255 12448000
*   GROUPKY=GROVVGRP;               /* GROUP                 @Y30LB26*/ 12449000
@RF03249 L     @02,GROUPPTR                                        3255 12450000
         MVC   GROUPKY(8),GROVVGRP(@02)                            3255 12451000
*   GIDKY=GIDKY+FIXONE;             /* ADD TO KEY            @Y30LB26*/ 12452000
*                                                                  3256 12453000
         LA    @02,1                                               3256 12454000
         SLR   @15,@15                                             3256 12455000
         IC    @15,GIDKY                                           3256 12456000
         ALR   @02,@15                                             3256 12457000
         STC   @02,GIDKY                                           3256 12458000
*   /*****************************************************************/ 12459000
*   /*                                                               */ 12460000
*   /* READ FOR GREATER OR EQUAL TO GET FIRST EXTENSION      @Y30LB26*/ 12461000
*   /* KEEP LOOPING UNTIL AN EXTENSION RECORD IS FOUND       @Y30LB26*/ 12462000
*   /* THAT IS NOT FULL, OR UNTIL ALL EXTENSION RECORDS      @Y30LB26*/ 12463000
*   /* ARE READ                                              @Y30LB26*/ 12464000
*   /*                                                               */ 12465000
*   /*****************************************************************/ 12466000
*                                                                  3257 12467000
*   DO WHILE I=I;                   /* FIND EXTEN NOT FULL   @Y30LB26*/ 12468000
         B     @DE03257                                            3257 12469000
@DL03257 DS    0H                                                  3258 12470000
*     RPLVKEY=ADDR(GKEY);           /* ADDR GROUP EXT KEY    @Y30LB26*/ 12471000
         L     @02,RPLVPTR                                         3258 12472000
         LA    @15,GKEY                                            3258 12473000
         ST    @15,RPLVKEY(,@02)                                   3258 12474000
*     RPLVBUF=ADDR(STORGPEX);       /* ADDR GROUP EXT BUF    @Y30LB26*/ 12475000
         LA    @15,STORGPEX                                        3259 12476000
         ST    @15,RPLVBUF(,@02)                                   3259 12477000
*     RPLVBLN=LENGTH(STORGPEX);     /* LENGTH OF BUFFER      @Y30LB26*/ 12478000
         MVC   RPLVBLN(4,@02),@CF01148                             3260 12479000
*     RPLVLOC=OFF;                  /* NOT LOCATE            @Y30LB26*/ 12480000
*     RPLVDIR=ON;                   /* READ DIRECT           @Y30LB26*/ 12481000
         OI    RPLVDIR(@02),B'01000000'                            3262 12482000
         NI    RPLVLOC(@02),B'01111111'                            3262 12483000
*     RPLVTYP=RPLVREAD;             /* READ RECORD           @Y30LB26*/ 12484000
         MVI   RPLVTYP(@02),X'00'                                  3263 12485000
*     RPLVKGE=ON;                   /* READ GRTR THAN OR =   @Y30LB26*/ 12486000
         OI    RPLVKGE(@02),B'00000100'                            3264 12487000
*     RPLVUPD=ON;                   /* FOR UPDATE            @Y30LB26*/ 12488000
         OI    RPLVUPD(@02),B'00000010'                            3265 12489000
*     RESPECIFY                                                    3266 12490000
*       REG1 RSTD;                  /* RESTRICT REG 1        @Y30LB26*/ 12491000
*     REG1=RPLVPTR;                 /* ADDR OF RPLV          @Y30LB26*/ 12492000
         LR    REG1,@02                                            3267 12493000
*     CALL ICBVIO00;                /* READ EXTENSION RECORD @Y30LB26*/ 12494000
         L     @15,@CV00671                                        3268 12495000
         BALR  @14,@15                                             3268 12496000
*     RESPECIFY                                                    3269 12497000
*       REG1 UNRSTD;                /* FREE REG 1            @Y30LB26*/ 12498000
*     IF RPLVRETC¬=RCZERO&RPLRCODE¬=NORECRC THEN/* CK RET    @Y30LB26*/ 12499000
         L     @02,RPLVPTR                                         3270 12500000
         CLC   RPLVRETC(2,@02),@CB00747                            3270 12501000
         BE    @RF03270                                            3270 12502000
         CLC   RPLRCODE(2,@02),@CB00789                            3270 12503000
         BNE   @RT03270                                            3270 12504000
*       RETURN;                     /*                       @VS32198*/ 12505000
*     GVSNEPTR=ADDR(STORGPEX);      /* ADDRESSING TO RECORD  @Y30LB26*/ 12506000
*                                                                  3272 12507000
@RF03270 LA    GVSNEPTR,STORGPEX                                   3272 12508000
*     /***************************************************************/ 12509000
*     /*                                                             */ 12510000
*     /* IF NOT PROPER GROUP THEN MUST BE NO EXTENSION RECORDS       */ 12511000
*     /*                                                     @Y30LB26*/ 12512000
*     /*                                                             */ 12513000
*     /***************************************************************/ 12514000
*                                                                  3273 12515000
*     IF GVSVVGRP¬=GROUPKY|RPLRCODE=NORECRC THEN/* RT EXT ?  @Y30LB26*/ 12516000
*                                                                  3273 12517000
         CLC   GVSVVGRP(8,GVSNEPTR),GROUPKY                        3273 12518000
         BNE   @RT03273                                            3273 12519000
         L     @01,RPLVPTR                                         3273 12520000
         CLC   RPLRCODE(2,@01),@CB00789                            3273 12521000
         BNE   @RF03273                                            3273 12522000
@RT03273 DS    0H                                                  3274 12523000
*       /*************************************************************/ 12524000
*       /*                                                           */ 12525000
*       /* SHOULD BE NO EXTENSION RECORDS SO GO              @Y30LB26*/ 12526000
*       /* CREATE A NEW ONE                                  @Y30LB26*/ 12527000
*       /*                                                           */ 12528000
*       /*************************************************************/ 12529000
*                                                                  3274 12530000
*       DO;                         /*                       @Y30LB26*/ 12531000
*         IF LOOPSW=ON THEN         /* FOUND RECORD BEFORE   @Y30LB26*/ 12532000
         TM    LOOPSW,B'10000000'                                  3275 12533000
         BNO   @RF03275                                            3275 12534000
*           DO;                     /*                       @Y30LB26*/ 12535000
*             GKEY=GVSNAME;         /* LATEST KEY            @Y30LB26*/ 12536000
         MVC   GKEY(13),GVSNAME(GVSNEPTR)                          3277 12537000
*             GIDKY=GIDKY+FIXONE;   /* ADD ONE               @Y30LB26*/ 12538000
         LA    @02,1                                               3278 12539000
         SLR   @15,@15                                             3278 12540000
         IC    @15,GIDKY                                           3278 12541000
         ALR   @02,@15                                             3278 12542000
         STC   @02,GIDKY                                           3278 12543000
*           END;                    /*                       @Y30LB26*/ 12544000
*         ELSE                      /*                       @Y30LB26*/ 12545000
*           GIDKY=FIXONE;           /* SET FOR NEXT          @Y30LB26*/ 12546000
         B     @RC03275                                            3280 12547000
@RF03275 MVI   GIDKY,X'01'                                         3280 12548000
*         CALL NEWREC;              /* GO DO NEW REC         @Y30LB26*/ 12549000
@RC03275 BAL   @14,NEWREC                                          3281 12550000
*         GIDKY=FIXZERO;            /* RESET KEY CORRECT ID  @Y30LB26*/ 12551000
         MVI   GIDKY,X'00'                                         3282 12552000
*         RETURN;                   /*                       @Y30LB26*/ 12553000
         B     @EL00052                                            3283 12554000
*       END;                        /*                       @Y30LB26*/ 12555000
*     ELSE                          /*                       @Y30LB26*/ 12556000
*                                                                  3285 12557000
*       /*************************************************************/ 12558000
*       /*                                                           */ 12559000
*       /* CHECK TO SEE IF THERE ARE SLOTS LEFT IN RECORD    @Y30LB26*/ 12560000
*       /*                                                           */ 12561000
*       /*************************************************************/ 12562000
*                                                                  3285 12563000
*       DO;                         /*                       @Y30LB26*/ 12564000
@RF03273 DS    0H                                                  3286 12565000
*         LOOPSW=ON;                /* INDICATE REC FOUND    @Y30LB26*/ 12566000
         OI    LOOPSW,B'10000000'                                  3286 12567000
*         IF GVSESIND>=GVSNSLOT+ONE THEN/* RECORD FULL?      @Y30LB26*/ 12568000
*                                                                  3287 12569000
         LH    @15,GVSESIND(,GVSNEPTR)                             3287 12570000
         C     @15,@CF01150                                        3287 12571000
         BL    @RF03287                                            3287 12572000
*           /*********************************************************/ 12573000
*           /*                                                       */ 12574000
*           /* IF THERE ARE NO SLOTS LEFT IN RECORD,         @Y30LB26*/ 12575000
*           /* SEE IF THIS RECORD IS THE LAST ONE. IF        @Y30LB26*/ 12576000
*           /* IT IS, INDICATE THAT ITS NOT AND GO CREATE    @Y30LB26*/ 12577000
*           /* ANOTHER EXTENSION RECORD                      @Y30LB26*/ 12578000
*           /*                                                       */ 12579000
*           /*********************************************************/ 12580000
*                                                                  3288 12581000
*           DO;                     /*                       @Y30LB26*/ 12582000
*             IF GVSEX=OFF THEN     /* LAST EXTENSION?       @Y30LB26*/ 12583000
         TM    GVSEX(GVSNEPTR),B'10000000'                         3289 12584000
         BNZ   @RF03289                                            3289 12585000
*               DO;                 /*                       @Y30LB26*/ 12586000
*                 GVSEX=ON;         /* INDICATE NOT LAST     @Y30LB26*/ 12587000
*                                                                  3291 12588000
         OI    GVSEX(GVSNEPTR),B'10000000'                         3291 12589000
*                 /***************************************************/ 12590000
*                 /*                                                 */ 12591000
*                 /* WRITE EXTENSION RECORD THAT WAS LAST    @Y30LB26*/ 12592000
*                 /*                                                 */ 12593000
*                 /***************************************************/ 12594000
*                                                                  3292 12595000
*                 RPLVTYP=RPLVPUT;  /* PUT FULL EXTEN        @Y30LB26*/ 12596000
         L     @15,RPLVPTR                                         3292 12597000
         MVI   RPLVTYP(@15),X'01'                                  3292 12598000
*                 RESPECIFY                                        3293 12599000
*                   REG1 RSTD;      /* RESTRICT REG 1        @Y30LB26*/ 12600000
*                 REG1=RPLVPTR;     /* ADDR RPLV             @Y30LB26*/ 12601000
         LR    REG1,@15                                            3294 12602000
*                 CALL ICBVIO00;    /* WRITE UPDATED EXT REC @Y30LB26*/ 12603000
         L     @15,@CV00671                                        3295 12604000
         BALR  @14,@15                                             3295 12605000
*                 RESPECIFY                                        3296 12606000
*                   REG1 UNRSTD;    /* FREE REG 1            @Y30LB26*/ 12607000
*                 IF RPLVRETC¬=RCZERO THEN/* CHK RETURN      @Y30LB26*/ 12608000
         L     @01,RPLVPTR                                         3297 12609000
         CLC   RPLVRETC(2,@01),@CB00747                            3297 12610000
         BNE   @RT03297                                            3297 12611000
*                   RETURN;         /*                       @Y30LB26*/ 12612000
*                                                                  3298 12613000
*                 /***************************************************/ 12614000
*                 /*                                                 */ 12615000
*                 /* IF NOT JOURNALED BEFORE, JOURNAL IT NOW @Y30LB26*/ 12616000
*                 /*                                                 */ 12617000
*                 /***************************************************/ 12618000
*                                                                  3299 12619000
*                 IF JRNLEDSW=OFF THEN/* JOURNALED BEFORE?   @Y30LB26*/ 12620000
         TM    JRNLEDSW,B'00000001'                                3299 12621000
         BNZ   @RF03299                                            3299 12622000
*                   DO;             /*                       @Y30LB26*/ 12623000
*                     CALL JOURNAL; /* JOURNAL RPLV          @Y30LB26*/ 12624000
         BAL   @14,JOURNAL                                         3301 12625000
*                     IF RPLVRETC¬=RCZERO THEN/*             @Y30LB26*/ 12626000
         L     @01,RPLVPTR                                         3302 12627000
         CLC   RPLVRETC(2,@01),@CB00747                            3302 12628000
         BNE   @RT03302                                            3302 12629000
*                       RETURN;     /*                       @Y30LB26*/ 12630000
*                   END;            /*                       @Y30LB26*/ 12631000
*                                                                  3304 12632000
*                 /***************************************************/ 12633000
*                 /*                                                 */ 12634000
*                 /* SET UP KEY TO GO BUILD NEW EXTENSION    @Y30LB26*/ 12635000
*                 /* RECORD                                  @Y30LB26*/ 12636000
*                 /*                                                 */ 12637000
*                 /***************************************************/ 12638000
*                                                                  3305 12639000
*                 GKEY=GVSNAME;     /* GROUP NAME TO KEY     @Y30LB26*/ 12640000
@RF03299 MVC   GKEY(13),GVSNAME(GVSNEPTR)                          3305 12641000
*                 GIDKY=GIDKY+FIXONE;/* ADD GET NEXT REC     @Y30LB26*/ 12642000
         LA    @02,1                                               3306 12643000
         SLR   @15,@15                                             3306 12644000
         IC    @15,GIDKY                                           3306 12645000
         ALR   @02,@15                                             3306 12646000
         STC   @02,GIDKY                                           3306 12647000
*                 CALL NEWREC;      /* GO BUILD NEW RECORD   @Y30LB26*/ 12648000
         BAL   @14,NEWREC                                          3307 12649000
*                 GIDKY=FIXZERO;    /* RESET KEY CORRECT ID  @Y30LB26*/ 12650000
         MVI   GIDKY,X'00'                                         3308 12651000
*                 RETURN;           /*                       @Y30LB26*/ 12652000
         B     @EL00052                                            3309 12653000
*               END;                /*                       @Y30LB26*/ 12654000
*                                                                  3310 12655000
*             /*******************************************************/ 12656000
*             /*                                                     */ 12657000
*             /* EXTENSION RECORD WAS FULL, BUT IT WAS       @Y30LB26*/ 12658000
*             /* NOT THE LAST ONE, SO SET UP KEY TO READ     @Y30LB26*/ 12659000
*             /* NEXT EXTENSION AND LOOP BACK                @Y30LB26*/ 12660000
*             /*                                                     */ 12661000
*             /*******************************************************/ 12662000
*                                                                  3311 12663000
*             ELSE                  /* NOT LAST EXTENISON    @Y30LB26*/ 12664000
*               DO;                 /*                       @Y30LB26*/ 12665000
@RF03289 DS    0H                                                  3312 12666000
*                 GKEY=GVSNAME;     /* SET UP KEY FOR NEXT   @Y30LB26*/ 12667000
         MVC   GKEY(13),GVSNAME(GVSNEPTR)                          3312 12668000
*                 GIDKY=GIDKY+FIXONE;/* AND LOOP BACK        @Y30LB26*/ 12669000
         LA    @02,1                                               3313 12670000
         SLR   @15,@15                                             3313 12671000
         IC    @15,GIDKY                                           3313 12672000
         ALR   @02,@15                                             3313 12673000
         STC   @02,GIDKY                                           3313 12674000
*               END;                /*                       @Y30LB26*/ 12675000
*           END;                    /*                       @Y30LB26*/ 12676000
*                                                                  3315 12677000
*         /***********************************************************/ 12678000
*         /*                                                         */ 12679000
*         /* SINCE EXTENSION RECORD IS NOT FULL, GO          @Y30LB26*/ 12680000
*         /* BUILD A NEW SLOT IN THIS EXTENSION              @Y30LB26*/ 12681000
*         /*                                                         */ 12682000
*         /***********************************************************/ 12683000
*                                                                  3316 12684000
*         ELSE                      /* RECORD NOT FULL       @Y30LB26*/ 12685000
*           DO;                     /* SO PUT IN NEW SLOT    @Y30LB26*/ 12686000
         B     @RC03287                                            3316 12687000
@RF03287 DS    0H                                                  3317 12688000
*             CALL NEWSLOT;         /* GO MAKE A NEW SLOT    @Y30LB26*/ 12689000
*                                                                  3317 12690000
         BAL   @14,NEWSLOT                                         3317 12691000
*             /*******************************************************/ 12692000
*             /*                                                     */ 12693000
*             /* WRITE UPDATED EXTENSION RECORD              @Y30LB26*/ 12694000
*             /*                                                     */ 12695000
*             /*******************************************************/ 12696000
*                                                                  3318 12697000
*             RPLVTYP=RPLVPUT;      /* PUT EXTENSION REC     @Y30LB26*/ 12698000
         L     @02,RPLVPTR                                         3318 12699000
         MVI   RPLVTYP(@02),X'01'                                  3318 12700000
*             RESPECIFY                                            3319 12701000
*               REG1 RSTD;          /* RESTRICT REG 1        @Y30LB26*/ 12702000
*             REG1=RPLVPTR;         /* ADDR RPLV             @Y30LB26*/ 12703000
         LR    REG1,@02                                            3320 12704000
*             CALL ICBVIO00;        /* WRITE EXTENSION REC   @Y30LB26*/ 12705000
         L     @15,@CV00671                                        3321 12706000
         BALR  @14,@15                                             3321 12707000
*             RESPECIFY                                            3322 12708000
*               REG1 UNRSTD;        /* FREE REG 1            @Y30LB26*/ 12709000
*             IF RPLVRETC¬=RCZERO THEN/*                     @Y30LB26*/ 12710000
         L     @02,RPLVPTR                                         3323 12711000
         CLC   RPLVRETC(2,@02),@CB00747                            3323 12712000
         BNE   @RT03323                                            3323 12713000
*               RETURN;             /*                       @Y30LB26*/ 12714000
*                                                                  3324 12715000
*             /*******************************************************/ 12716000
*             /*                                                     */ 12717000
*             /* IF RPLV NEVER JOURNALED BEFORE, JOURNAL IT  @Y30LB26*/ 12718000
*             /*                                                     */ 12719000
*             /*******************************************************/ 12720000
*                                                                  3325 12721000
*             IF JRNLEDSW=OFF THEN  /* JOURNALED BEFORE      @Y30LB26*/ 12722000
         TM    JRNLEDSW,B'00000001'                                3325 12723000
         BNZ   @RF03325                                            3325 12724000
*               DO;                 /*                       @Y30LB26*/ 12725000
*                 CALL JOURNAL;     /* JOURNALED RPLV        @Y30LB26*/ 12726000
         BAL   @14,JOURNAL                                         3327 12727000
*                 IF RPLVRETC¬=RCZERO THEN/*                 @Y30LB26*/ 12728000
         L     @02,RPLVPTR                                         3328 12729000
         CLC   RPLVRETC(2,@02),@CB00747                            3328 12730000
         BNE   @RT03328                                            3328 12731000
*                   RETURN;         /*                       @Y30LB26*/ 12732000
*               END;                /*                       @Y30LB26*/ 12733000
*                                                                  3330 12734000
*             /*******************************************************/ 12735000
*             /*                                                     */ 12736000
*             /* RECORD WAS UPDATED OR CREATED SUCCESSFULLY  @Y30LB26*/ 12737000
*             /*                                                     */ 12738000
*             /*******************************************************/ 12739000
*                                                                  3331 12740000
*             RPLVRETC=RCZERO;      /* GOOD RC               @Y30LB26*/ 12741000
@RF03325 L     @02,RPLVPTR                                         3331 12742000
         MVC   RPLVRETC(2,@02),@CB00747                            3331 12743000
*             RPLRCODE=RCZERO;      /* GOOD REASON           @Y30LB26*/ 12744000
         MVC   RPLRCODE(2,@02),@CB00747                            3332 12745000
*             GIDKY=FIXZERO;        /* REST TO CORRECT ID    @Y30LB26*/ 12746000
         MVI   GIDKY,X'00'                                         3333 12747000
*             RETURN;               /*                       @Y30LB26*/ 12748000
         B     @EL00052                                            3334 12749000
*           END;                    /*                       @Y30LB26*/ 12750000
*       END;                        /*                       @Y30LB26*/ 12751000
@RC03287 DS    0H                                                  3337 12752000
*   END;                            /* END WHILE LOOP        @Y30LB26*/ 12753000
@DE03257 CLC   I(1),I                                              3337 12754000
         BE    @DL03257                                            3337 12755000
*   END VUEXT;                      /*                       @Y30LB26*/ 12756000
         B     @EL00052                                            3338 12757000
*                                                                  3339 12758000
*   /*****************************************************************/ 12759000
*   /*                                                               */ 12760000
*   /* THIS ROUTINE IS CALLED WHEN THERE ARE NO EXTENSION    @Y30LB26*/ 12761000
*   /* RECORDS FOR A PARTICULAR GROUP OR ALL THE EXISTING    @Y30LB26*/ 12762000
*   /* EXTENSION RECORDS ARE FULL. IT CREATES NEW EXTENSION  @Y30LB26*/ 12763000
*   /*                                                               */ 12764000
*   /*****************************************************************/ 12765000
*                                                                  3339 12766000
*NEWREC:                                                           3339 12767000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 12768000
*                                                                  3339 12769000
NEWREC   ST    @14,@SA00053                                        3339 12770000
*   /*****************************************************************/ 12771000
*   /*                                                               */ 12772000
*   /* BUILD ENOUGH OF THE EXTENSION RECORD TO CALL THE      @Y30LB26*/ 12773000
*   /* NEW SLOT ROUTINE TO FILL IN SLOT                      @Y30LB26*/ 12774000
*   /*                                                               */ 12775000
*   /*****************************************************************/ 12776000
*                                                                  3340 12777000
*   GVSNEPTR=ADDR(STORGPEX);        /* ADDR EXTEN BUFFER     @Y30LB26*/ 12778000
         LA    GVSNEPTR,STORGPEX                                   3340 12779000
*   GVSHDR=GVSHDR&&GVSHDR;          /* ZERO HEADER SECTION   @Y30LB26*/ 12780000
         XC    GVSHDR(28,GVSNEPTR),GVSHDR(GVSNEPTR)                3341 12781000
*   GVSNAME=GKEY;                   /* FILL IN KEY SECTION   @Y30LB26*/ 12782000
         MVC   GVSNAME(13,GVSNEPTR),GKEY                           3342 12783000
*   GVSGVSEX=ON;                    /* INDICATE EXT REC      @Y30LB26*/ 12784000
         OI    GVSGVSEX(GVSNEPTR),B'01000000'                      3343 12785000
*   GVSESIND=ONE;                   /* FIRST SLOT AVAILABLE  @Y30LB26*/ 12786000
*                                                                  3344 12787000
         MVC   GVSESIND(2,GVSNEPTR),@CH00041                       3344 12788000
*   /*****************************************************************/ 12789000
*   /*                                                               */ 12790000
*   /* GO BUILD NEW SLOT FOR NEW EXTENSION RECORD            @Y30LB26*/ 12791000
*   /*                                                               */ 12792000
*   /*****************************************************************/ 12793000
*                                                                  3345 12794000
*   CALL NEWSLOT;                   /* GO BUILD NEW SLOT     @Y30LB26*/ 12795000
*                                                                  3345 12796000
         BAL   @14,NEWSLOT                                         3345 12797000
*   /*****************************************************************/ 12798000
*   /*                                                               */ 12799000
*   /* WRITE NEW EXTENSION RECORD                            @Y30LB26*/ 12800000
*   /*                                                               */ 12801000
*   /*****************************************************************/ 12802000
*                                                                  3346 12803000
*   RPLVBUF=ADDR(STORGPEX);         /* ADDR OF BUFFER        @Y30LB26*/ 12804000
         L     @02,RPLVPTR                                         3346 12805000
         LA    @15,STORGPEX                                        3346 12806000
         ST    @15,RPLVBUF(,@02)                                   3346 12807000
*   RPLVRLN=LENGTH(GVSNE);          /* RECORD LENGTH         @Y30LB26*/ 12808000
         LA    @15,988                                             3347 12809000
         ST    @15,RPLVRLN(,@02)                                   3347 12810000
*   RPLVBLN=LENGTH(STORGPEX);       /* LENGTH BUFFER         @Y30LB26*/ 12811000
         ST    @15,RPLVBLN(,@02)                                   3348 12812000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB26*/ 12813000
         NI    RPLVLOC(@02),B'01111111'                            3349 12814000
*   RPLVTYP=RPLVPUT;                /* PUT NEW EXT RECORD    @Y30LB26*/ 12815000
         MVI   RPLVTYP(@02),X'01'                                  3350 12816000
*   RPLVUPD=OFF;                    /* NOT UPDATE            @Y30LB26*/ 12817000
         NI    RPLVUPD(@02),B'11111101'                            3351 12818000
*   RESPECIFY                                                      3352 12819000
*     REG1 RSTD;                    /* RESTRICT REG 1        @Y301B26*/ 12820000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y301B26*/ 12821000
         LR    REG1,@02                                            3353 12822000
*   CALL ICBVIO00;                  /* WRITE EXT RECORD      @Y301B26*/ 12823000
         L     @15,@CV00671                                        3354 12824000
         BALR  @14,@15                                             3354 12825000
*   RESPECIFY                                                      3355 12826000
*     REG1 UNRSTD;                  /* FREE REG1             @Y301B26*/ 12827000
*   IF RPLVRETC¬=RCZERO THEN        /*                       @Y30LB26*/ 12828000
         L     @02,RPLVPTR                                         3356 12829000
         CLC   RPLVRETC(2,@02),@CB00747                            3356 12830000
         BNE   @RT03356                                            3356 12831000
*     RETURN;                       /*                       @Y30LB26*/ 12832000
*                                                                  3357 12833000
*   /*****************************************************************/ 12834000
*   /*                                                               */ 12835000
*   /* IF NEVER JOURNALED BEFORE, JOURNAL IT                 @Y30LB26*/ 12836000
*   /*                                                               */ 12837000
*   /*****************************************************************/ 12838000
*                                                                  3358 12839000
*   IF JRNLEDSW=OFF THEN            /* JOURNALED BEFORE?     @Y301B26*/ 12840000
         TM    JRNLEDSW,B'00000001'                                3358 12841000
         BNZ   @RF03358                                            3358 12842000
*     CALL JOURNAL;                 /* JOURNAL RPLV          @Y30LB26*/ 12843000
         BAL   @14,JOURNAL                                         3359 12844000
*   RETURN;                         /*                       @Y301B26*/ 12845000
@EL00053 DS    0H                                                  3360 12846000
@EF00053 DS    0H                                                  3360 12847000
@ER00053 L     @14,@SA00053                                        3360 12848000
         BR    @14                                                 3360 12849000
*   END NEWREC;                     /*                       @Y301B26*/ 12850000
         B     @EL00053                                            3361 12851000
*                                                                  3362 12852000
*   /*****************************************************************/ 12853000
*   /*                                                               */ 12854000
*   /* THIS ROUTINE IS CALLED TO BUILD A NEW SLOT IN         @Y30LB26*/ 12855000
*   /* AN EXISTING EXTENSION RECORD. IT TAKES INFORMATION    @Y30LB26*/ 12856000
*   /* FROM THE BASE VOLUME RECORD TO FILL IN THE SLOT       @Y30LB26*/ 12857000
*   /*                                                               */ 12858000
*   /*****************************************************************/ 12859000
*                                                                  3362 12860000
*NEWSLOT:                                                          3362 12861000
*   PROC(NOSAVE);                   /*                       @Y301B26*/ 12862000
NEWSLOT  STM   @14,@12,12(@13)                                     3362 12863000
         MVC   @PC00054(4),0(@01)                                  3362 12864000
*   GVSSLOTS(GVSESIND)=             /* ZERO ENTIRE SLOT      @Y30LB26*/ 12865000
*       GVSSLOTS(GVSESIND)&&GVSSLOTS(GVSESIND);/*            @Y30LB26*/ 12866000
         LH    @15,GVSESIND(,GVSNEPTR)                             3363 12867000
         MH    @15,@CH01149                                        3363 12868000
         ST    @15,@TF00001                                        3363 12869000
         ALR   @15,GVSNEPTR                                        3363 12870000
         XC    GVSSLOTS-20(20,@15),GVSSLOTS-20(@15)                3363 12871000
*   GVSVOLID(GVSESIND)=BASSERNO;    /* VOLUME SERIAL NO.     @Y301B26*/ 12872000
         LR    @01,GVSNEPTR                                        3364 12873000
         AL    @01,@TF00001                                        3364 12874000
         L     @15,BASEVPTR                                        3364 12875000
         MVC   GVSVOLID-20(6,@01),BASSERNO(@15)                    3364 12876000
*   GVSCPUBM(GVSESIND)=BASCPUID;    /* PUT IN CPU ASSOC MAP  @Y30LB26*/ 12877000
         LR    @01,GVSNEPTR                                        3365 12878000
         AL    @01,@TF00001                                        3365 12879000
         MVC   GVSCPUBM-20(2,@01),BASCPUID(@15)                    3365 12880000
*   GVSFRESP(GVSESIND)=BASFRESP;    /* FREE CYLINDERS        @Y301B26*/ 12881000
         LH    @14,BASFRESP(,@15)                                  3366 12882000
         N     @14,@CF01186                                        3366 12883000
         L     @01,@TF00001                                        3366 12884000
         STH   @14,GVSFRESP-20(@01,GVSNEPTR)                       3366 12885000
*   GVSLEXT(GVSESIND)=BASLEXT;      /* LARGEST FREE EXTENT   @Y301B26*/ 12886000
         LH    @14,BASLEXT(,@15)                                   3367 12887000
         N     @14,@CF01186                                        3367 12888000
         L     @01,@TF00001                                        3367 12889000
         STH   @14,GVSLEXT-20(@01,GVSNEPTR)                        3367 12890000
*   GVSEXPDT(GVSESIND)=BASEXPDT;    /* EXPIRATION DATE       @Y301B26*/ 12891000
         LR    @01,GVSNEPTR                                        3368 12892000
         AL    @01,@TF00001                                        3368 12893000
         MVC   GVSEXPDT-20(4,@01),BASEXPDT(@15)                    3368 12894000
*   IF BASCPUID¬=BITZERO|BASDLSF=ON /* IS VOL NOT MOUNTED OR @G24LB04   12895000
*                                      DOWN LEVEL FREE SPACE?      3369 12896000
*                                                            @G24LB04*/ 12897000
*     THEN                                                         3369 12898000
         CLC   BASCPUID(2,@15),@CB00747                            3369 12899000
         BNE   @RT03369                                            3369 12900000
         TM    BASDLSF(@15),B'10000000'                            3369 12901000
         BNO   @RF03369                                            3369 12902000
@RT03369 DS    0H                                                  3370 12903000
*     GVSRCFSI(GVSESIND)=ON;        /* TURN ON RUNNING COUNT @G24LB04   12904000
*                                      FREE SPACE INVALID    @G24LB04*/ 12905000
         LH    @15,GVSESIND(,GVSNEPTR)                             3370 12906000
         MH    @15,@CH01149                                        3370 12907000
         ALR   @15,GVSNEPTR                                        3370 12908000
         OI    GVSRCFSI-20(@15),B'10000000'                        3370 12909000
*   ELSE                            /*                       @G24LB04*/ 12910000
*     GVSMTDSP(GVSESIND)=BASFRESP;  /* PUT IN TOTAL FREE     @G24LB04   12911000
*                                      SPACE                 @G24LB04*/ 12912000
         B     @RC03369                                            3371 12913000
@RF03369 LH    @15,GVSESIND(,GVSNEPTR)                             3371 12914000
         MH    @15,@CH01149                                        3371 12915000
         L     @01,BASEVPTR                                        3371 12916000
         LH    @14,BASFRESP(,@01)                                  3371 12917000
         N     @14,@CF01186                                        3371 12918000
         STH   @14,GVSMTDSP-20(@15,GVSNEPTR)                       3371 12919000
*   GVSESIND=GVSESIND+ONE;          /* ADD FOR NEXT SLOT     #Y301B26*/ 12920000
@RC03369 LA    @15,1                                               3372 12921000
         AH    @15,GVSESIND(,GVSNEPTR)                             3372 12922000
         STH   @15,GVSESIND(,GVSNEPTR)                             3372 12923000
*   RETURN;                         /*                       #Y301B26*/ 12924000
@EL00054 DS    0H                                                  3373 12925000
@EF00054 DS    0H                                                  3373 12926000
@ER00054 LM    @14,@12,12(@13)                                     3373 12927000
         BR    @14                                                 3373 12928000
*   END NEWSLOT;                    /*                       @Y301B26*/ 12929000
*                                                                  3375 12930000
*   /*****************************************************************/ 12931000
*   /*                                                               */ 12932000
*   /* THIS ROUTINE IS CALLED TO REMOVE A SLOT FROM A        @Y30LB26*/ 12933000
*   /* GROUP EXTENSION RECORD. IT WILL ALSO UPDATE THE       @Y30LB26*/ 12934000
*   /* EXPIRATION DATE IN AN EXISTING SLOT.                  @Y30LB26*/ 12935000
*   /* IF THE SLOT REMOVED IS THE                            @Y30LB26*/ 12936000
*   /* LAST SLOT IN RECORD, THE RECORD IS DELETED.           @Y30LB26*/ 12937000
*   /* IF DELETED RECORD WAS THE LAST EXTENSION RECORD       @Y30LB26*/ 12938000
*   /* AND THERE WAS A PREVIOUS EXTENSION, THE PREVIOUS      @Y30LB26*/ 12939000
*   /* ONE IS READ AND A FLAG INDICATING IT IS THE LAST      @Y30LB26*/ 12940000
*   /* IS TURNED ON.                                         @Y30LB26*/ 12941000
*   /*                                                               */ 12942000
*   /*****************************************************************/ 12943000
*                                                                  3375 12944000
*DELETESL:                                                         3375 12945000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 12946000
*                                                                  3375 12947000
DELETESL ST    @14,@SA00055                                        3375 12948000
*   /*****************************************************************/ 12949000
*   /*                                                               */ 12950000
*   /* SET GROUP NAME IN KEY AND INIT LOOP SWITCH            @Y30LB26*/ 12951000
*   /*                                                               */ 12952000
*   /*****************************************************************/ 12953000
*                                                                  3376 12954000
*   GROUPKY=GROVVGRP;               /* GROUP NAME            @Y301B26*/ 12955000
         L     @02,GROUPPTR                                        3376 12956000
         MVC   GROUPKY(8),GROVVGRP(@02)                            3376 12957000
*   LOOPSW=OFF;                     /* INIT LOOP SWITCH      @Y301B26*/ 12958000
*                                                                  3377 12959000
         NI    LOOPSW,B'01111111'                                  3377 12960000
*   /*****************************************************************/ 12961000
*   /*                                                               */ 12962000
*   /* LOOP USED TO GO THRU EXTENSION RECORDS UNTIL RIGHT    @Y30LB26*/ 12963000
*   /* SLOT IS LOCATED                                       @Y30LB26*/ 12964000
*   /*                                                               */ 12965000
*   /*****************************************************************/ 12966000
*                                                                  3378 12967000
*   DO WHILE I=I;                   /* OUTSIDE WHILE         @Y301B26*/ 12968000
         B     @DE03378                                            3378 12969000
@DL03378 DS    0H                                                  3379 12970000
*     GIDKY=GIDKY+FIXONE;           /* GET PAST GROUP        @Y301B26*/ 12971000
         LA    @02,1                                               3379 12972000
         SLR   @15,@15                                             3379 12973000
         IC    @15,GIDKY                                           3379 12974000
         ALR   @02,@15                                             3379 12975000
         STC   @02,GIDKY                                           3379 12976000
*     RPLVKEY=ADDR(GKEY);           /* ADDR KEY              @Y301B26*/ 12977000
         L     @02,RPLVPTR                                         3380 12978000
         LA    @15,GKEY                                            3380 12979000
         ST    @15,RPLVKEY(,@02)                                   3380 12980000
*     RPLVBUF=ADDR(STORGPEX);       /* ADDR BUFFER           @Y301B26*/ 12981000
         LA    @15,STORGPEX                                        3381 12982000
         ST    @15,RPLVBUF(,@02)                                   3381 12983000
*     RPLVBLN=LENGTH(STORGPEX);     /* LENGTH OF BUFFER      @Y301B26*/ 12984000
         MVC   RPLVBLN(4,@02),@CF01148                             3382 12985000
*     RPLVLOC=OFF;                  /* NO LOCATE             @Y301B26*/ 12986000
*     RPLVDIR=ON;                   /* READ DIRECT           @Y301B26*/ 12987000
         OI    RPLVDIR(@02),B'01000000'                            3384 12988000
         NI    RPLVLOC(@02),B'01111111'                            3384 12989000
*     RPLVTYP=RPLVREAD;             /* READ EXT REC          @Y301B26*/ 12990000
         MVI   RPLVTYP(@02),X'00'                                  3385 12991000
*     RPLVKGE=ON;                   /* READ GT OR =          @Y301B26*/ 12992000
         OI    RPLVKGE(@02),B'00000100'                            3386 12993000
*     RPLVUPD=ON;                   /* FOR UPDATE            @Y301B26*/ 12994000
         OI    RPLVUPD(@02),B'00000010'                            3387 12995000
*     RESPECIFY                                                    3388 12996000
*       REG1 RSTD;                  /* RESTRICT REG1         @Y301B26*/ 12997000
*     REG1=RPLVPTR;                 /* ADDR RPLV             @Y301B26*/ 12998000
         LR    REG1,@02                                            3389 12999000
*     CALL ICBVIO00;                /* READ EXTENSION REC    @Y301B26*/ 13000000
         L     @15,@CV00671                                        3390 13001000
         BALR  @14,@15                                             3390 13002000
*     RESPECIFY                                                    3391 13003000
*       REG1 UNRSTD;                /* FREE REG 1            @Y301B26*/ 13004000
*     IF RPLVRETC¬=RCZERO THEN      /* CH RETURN             @Y301B26*/ 13005000
         L     @02,RPLVPTR                                         3392 13006000
         CLC   RPLVRETC(2,@02),@CB00747                            3392 13007000
         BNE   @RT03392                                            3392 13008000
*       RETURN;                     /*                       @Y301B26*/ 13009000
*                                                                  3393 13010000
*     /***************************************************************/ 13011000
*     /*                                                             */ 13012000
*     /* GET ADDRESS OF RECORD JUST READ AND CHECK TO SEE    @Y30LB26*/ 13013000
*     /* IF IT IS AN EXTENSION RECORD FOR THE CORRECT GROUP  @Y30LB26*/ 13014000
*     /*                                                             */ 13015000
*     /***************************************************************/ 13016000
*                                                                  3394 13017000
*     GVSNEPTR=ADDR(STORGPEX);      /* ADDR OF RECORD READ   @Y301B26*/ 13018000
         LA    GVSNEPTR,STORGPEX                                   3394 13019000
*     IF GVSVVGRP¬=GROUPKY|GVSGVSEX=OFF THEN/* STILL RT EXT  @Y30LB26*/ 13020000
*                                                                  3395 13021000
         CLC   GVSVVGRP(8,GVSNEPTR),GROUPKY                        3395 13022000
         BNE   @RT03395                                            3395 13023000
         TM    GVSGVSEX(GVSNEPTR),B'01000000'                      3395 13024000
         BNZ   @RF03395                                            3395 13025000
@RT03395 DS    0H                                                  3396 13026000
*       /*************************************************************/ 13027000
*       /*                                                           */ 13028000
*       /* SINCE THERE ARE NO MORE EXTENSIONS FOR THIS       @Y30LB26*/ 13029000
*       /* GROUP, SET REASON CODE INDICATING THAT SLOT       @Y30LB26*/ 13030000
*       /* WAS NOT FOUND                                     @Y30LB26*/ 13031000
*       /*                                                           */ 13032000
*       /*************************************************************/ 13033000
*                                                                  3396 13034000
*       DO;                         /*                       @Y301B26*/ 13035000
*         RPLVRETC=FOUR;            /* BAD RETURN            @Y301B26*/ 13036000
         L     @02,RPLVPTR                                         3397 13037000
         MVC   RPLVRETC(2,@02),@CB00749                            3397 13038000
*         RPLRCODE=NOSLTFND;        /* NO SLOT FOUND         @Y30LB26*/ 13039000
         MVC   RPLRCODE(2,@02),@CB00835                            3398 13040000
*         RETURN;                   /*                       @Y301B26*/ 13041000
@EL00055 DS    0H                                                  3399 13042000
@EF00055 DS    0H                                                  3399 13043000
@ER00055 L     @14,@SA00055                                        3399 13044000
         BR    @14                                                 3399 13045000
*       END;                        /*                       @Y301B26*/ 13046000
*                                                                  3400 13047000
*     /***************************************************************/ 13048000
*     /*                                                             */ 13049000
*     /* LOOK FOR SLOT IN EXTENSION RECORD                   @Y30LB26*/ 13050000
*     /*                                                             */ 13051000
*     /***************************************************************/ 13052000
*                                                                  3401 13053000
*     DO J=1 TO GVSESIND-1;         /* INSIDE WHILE          @Y30LB26*/ 13054000
@RF03395 LA    @15,1                                               3401 13055000
         B     @DE03401                                            3401 13056000
@DL03401 DS    0H                                                  3402 13057000
*       IF GVSVOLID(J)=BASSERNO THEN/* RIGHT SLOT?           @Y301B26*/ 13058000
         MH    @15,@CH01149                                        3402 13059000
         L     @14,BASEVPTR                                        3402 13060000
         ST    @15,@TF00001                                        3402 13061000
         ALR   @15,GVSNEPTR                                        3402 13062000
         CLC   GVSVOLID-20(6,@15),BASSERNO(@14)                    3402 13063000
         BNE   @RF03402                                            3402 13064000
*         DO;                       /*                       @Y301B26*/ 13065000
*                                                                  3403 13066000
*           /*********************************************************/ 13067000
*           /*                                                       */ 13068000
*           /* CHECK TO SEE IF UPDATING THE RETENTION PERIOD @Y30LB26*/ 13069000
*           /* IS ALL THAT IS REQUIRED                       @Y30LB26*/ 13070000
*           /*                                                       */ 13071000
*           /*********************************************************/ 13072000
*                                                                  3404 13073000
*           IF SLOTEXP=ON THEN      /* RETENTION ?           @Y30LB26*/ 13074000
         TM    SLOTEXP,B'10000000'                                 3404 13075000
         BNO   @RF03404                                            3404 13076000
*             DO;                   /*                       @Y30LB26*/ 13077000
*               GVSEXPDT(J)=BASEXPDT;/* UPDATE RET           @Y30LB26*/ 13078000
*                                                                  3406 13079000
         LR    @01,GVSNEPTR                                        3406 13080000
         AL    @01,@TF00001                                        3406 13081000
         MVC   GVSEXPDT-20(4,@01),BASEXPDT(@14)                    3406 13082000
*               /*****************************************************/ 13083000
*               /*                                                   */ 13084000
*               /* WRITE UPDATED EXTENSION RECORD            @Y30LB26*/ 13085000
*               /*                                                   */ 13086000
*               /*****************************************************/ 13087000
*                                                                  3407 13088000
*               RPLVTYP=RPLVPUT;    /* WRITE RECORD          @Y30LB26*/ 13089000
         L     @02,RPLVPTR                                         3407 13090000
         MVI   RPLVTYP(@02),X'01'                                  3407 13091000
*               RESPECIFY                                          3408 13092000
*                 REG1 RSTD;        /* RESTRICT REG 1        @Y30LB26*/ 13093000
*               REG1=RPLVPTR;       /* ADDR RPLV             @Y30LB26*/ 13094000
         LR    REG1,@02                                            3409 13095000
*               CALL ICBVIO00;      /* WRITE EXTENSION REC   @Y30LB26*/ 13096000
         L     @15,@CV00671                                        3410 13097000
         BALR  @14,@15                                             3410 13098000
*               RESPECIFY                                          3411 13099000
*                 REG1 UNRSTD;      /* FREE                  @Y30LB26*/ 13100000
*               IF RPLVRETC¬=RCZERO THEN/* CHECK RETURN      @Y30LB26*/ 13101000
         L     @02,RPLVPTR                                         3412 13102000
         CLC   RPLVRETC(2,@02),@CB00747                            3412 13103000
         BNE   @RT03412                                            3412 13104000
*                 RETURN;           /*                       @Y30LB26*/ 13105000
*                                                                  3413 13106000
*               /*****************************************************/ 13107000
*               /*                                                   */ 13108000
*               /* IF RPLV HAS NOT BEEN JOURNALED YET,       @Y30LB26*/ 13109000
*               /* JOURNAL IT                                @Y30LB26*/ 13110000
*               /*                                                   */ 13111000
*               /*****************************************************/ 13112000
*                                                                  3414 13113000
*               IF JRNLEDSW=OFF THEN/* IF NOT JOURNALED      @Y30LB26*/ 13114000
         TM    JRNLEDSW,B'00000001'                                3414 13115000
         BNZ   @RF03414                                            3414 13116000
*                 CALL JOURNAL;     /* JOURNAL THE RPLV      @Y30LB26*/ 13117000
         BAL   @14,JOURNAL                                         3415 13118000
*               RETURN;             /*                       @Y30LB26*/ 13119000
         B     @EL00055                                            3416 13120000
*             END;                  /*                       @Y30LB26*/ 13121000
*                                                                  3417 13122000
*           /*********************************************************/ 13123000
*           /*                                                       */ 13124000
*           /* SINCE FOUND SLOT, SEE IF IT IS THE ONLY       @Y30LB26*/ 13125000
*           /* SLOT IN THAT EXTENSION RECORD                 @Y30LB26*/ 13126000
*           /*                                                       */ 13127000
*           /*********************************************************/ 13128000
*                                                                  3418 13129000
*           IF GVSESIND>TWO THEN    /*                       @Y30LB26*/ 13130000
*                                                                  3418 13131000
@RF03404 LH    @15,GVSESIND(,GVSNEPTR)                             3418 13132000
         C     @15,@CF00058                                        3418 13133000
         BNH   @RF03418                                            3418 13134000
*             /*******************************************************/ 13135000
*             /*                                                     */ 13136000
*             /* IF MORE THAN ONE SLOT IN RECORD, SHIFT      @Y30LB26*/ 13137000
*             /* LEFT OVER DELETED SLOT                      @Y30LB26*/ 13138000
*             /*                                                     */ 13139000
*             /*******************************************************/ 13140000
*                                                                  3419 13141000
*             DO;                   /*                       @Y301B26*/ 13142000
*               RESPECIFY                                          3420 13143000
*                (REG4,                                            3420 13144000
*                 REG5,                                            3420 13145000
*                 REG6,                                            3420 13146000
*                 REG7) RSTD;       /* RSTR                  @Y30LB26*/ 13147000
*               REG4=ADDR(GVSVOLID(J));/* ADDR SLOT REMOVED  @Y301B26*/ 13148000
         LA    @14,20                                              3421 13149000
         SLR   @01,@01                                             3421 13150000
         IC    @01,J                                               3421 13151000
         MR    @00,@14                                             3421 13152000
         LA    REG4,GVSVOLID-20(@01,GVSNEPTR)                      3421 13153000
*               REG6=ADDR(GVSVOLID(J+1));/* ADDR NEXT SLOT   @Y301B26*/ 13154000
         LA    @01,GVSVOLID(@01,GVSNEPTR)                          3422 13155000
         LR    REG6,@01                                            3422 13156000
*               REG5=ADDR(GVSVOLID(GVSESIND))-/*             @Y30LB26*/ 13157000
*                   ADDR(GVSVOLID(J+1));/* GET LENGTH FOR MOVE     3423 13158000
*                                                            @Y30LB26*/ 13159000
         MR    @14,@14                                             3423 13160000
         LA    REG5,GVSVOLID-20(@15,GVSNEPTR)                      3423 13161000
         SLR   REG5,@01                                            3423 13162000
*               REG7=REG5;          /* LENGTH OF MOVE        @Y301B26*/ 13163000
         LR    REG7,REG5                                           3424 13164000
*               GEN(MVCL REG4,REG6);/* SHIFT ONE SLOT TO LEFT      3425 13165000
*                                                            @Y301B26*/ 13166000
         MVCL REG4,REG6                                                 13167000
*               RESPECIFY                                          3426 13168000
*                (REG4,                                            3426 13169000
*                 REG5,                                            3426 13170000
*                 REG6,                                            3426 13171000
*                 REG7) UNRSTD;     /* FREE                  @Y30LB26*/ 13172000
*                                                                  3426 13173000
*               /*****************************************************/ 13174000
*               /*                                                   */ 13175000
*               /* INDICATE ONE MORE SLOT IS AVAILABLE       @Y30LB26*/ 13176000
*               /* IN RECORD                                 @Y30LB26*/ 13177000
*               /*                                                   */ 13178000
*               /*****************************************************/ 13179000
*                                                                  3427 13180000
*               GVSESIND=GVSESIND-ONE;/* DECREASE SLOT COUNT @Y301B26*/ 13181000
*                                                                  3427 13182000
         LH    @15,GVSESIND(,GVSNEPTR)                             3427 13183000
         BCTR  @15,0                                               3427 13184000
         STH   @15,GVSESIND(,GVSNEPTR)                             3427 13185000
*               /*****************************************************/ 13186000
*               /*                                                   */ 13187000
*               /* WRITE UPDATED EXTENSION RECORD            @Y30LB26*/ 13188000
*               /*                                                   */ 13189000
*               /*****************************************************/ 13190000
*                                                                  3428 13191000
*               RPLVTYP=RPLVPUT;    /* WRITE RECORD          @Y301B26*/ 13192000
         L     @02,RPLVPTR                                         3428 13193000
         MVI   RPLVTYP(@02),X'01'                                  3428 13194000
*               RESPECIFY                                          3429 13195000
*                 REG1 RSTD;        /* RESTRICT REG 1        @Y301B26*/ 13196000
*               REG1=RPLVPTR;       /* ADDR RPLV             @Y301B26*/ 13197000
         LR    REG1,@02                                            3430 13198000
*               CALL ICBVIO00;      /* WRITE EXTENSION REC   @Y301B26*/ 13199000
         L     @15,@CV00671                                        3431 13200000
         BALR  @14,@15                                             3431 13201000
*               RESPECIFY                                          3432 13202000
*                 REG1 UNRSTD;      /* FREE                  @Y301B26*/ 13203000
*               IF RPLVRETC¬=RCZERO THEN/* CHECK RETURN      @Y301B26*/ 13204000
         L     @02,RPLVPTR                                         3433 13205000
         CLC   RPLVRETC(2,@02),@CB00747                            3433 13206000
         BNE   @RT03433                                            3433 13207000
*                 RETURN;           /*                       @Y301B26*/ 13208000
*                                                                  3434 13209000
*               /*****************************************************/ 13210000
*               /*                                                   */ 13211000
*               /* IF RPLV HAS NOT BEEN JOURNALED YET,       @Y30LB26*/ 13212000
*               /* JOURNAL IT                                @Y30LB26*/ 13213000
*               /*                                                   */ 13214000
*               /*****************************************************/ 13215000
*                                                                  3435 13216000
*               IF JRNLEDSW=OFF THEN/* IF NOT JOURNALED      @Y301B26*/ 13217000
         TM    JRNLEDSW,B'00000001'                                3435 13218000
         BNZ   @RF03435                                            3435 13219000
*                 CALL JOURNAL;     /* JOURNAL THE RPLV      @Y30LB26*/ 13220000
         BAL   @14,JOURNAL                                         3436 13221000
*               RETURN;             /*                       @Y30LB26*/ 13222000
         B     @EL00055                                            3437 13223000
*             END;                  /*                       @Y301B26*/ 13224000
*                                                                  3438 13225000
*           /*********************************************************/ 13226000
*           /*                                                       */ 13227000
*           /* SINCE THE EXTENSION RECORD HAS ONLY ONE       @Y30LB26*/ 13228000
*           /* SLOT IN IT AND IT IS TO BE REMOVED, JUST      @Y30LB26*/ 13229000
*           /* DELETE ENTIRE RECORD                          @Y30LB26*/ 13230000
*           /*                                                       */ 13231000
*           /*********************************************************/ 13232000
*                                                                  3439 13233000
*           ELSE                    /* LAST SLOT IN RECORD   @Y301B26*/ 13234000
*             DO;                   /* SO DELETE IT          @Y301B26*/ 13235000
@RF03418 DS    0H                                                  3440 13236000
*               RPLVTYP=RPLVDEL;    /* INDICATE DELETE       @Y301B26*/ 13237000
         L     @15,RPLVPTR                                         3440 13238000
         MVI   RPLVTYP(@15),X'05'                                  3440 13239000
*               RESPECIFY                                          3441 13240000
*                 REG1 RSTD;        /* RESTRICT REG 1        @Y301B26*/ 13241000
*               REG1=RPLVPTR;       /* ADDR RPLV             @Y301B26*/ 13242000
         LR    REG1,@15                                            3442 13243000
*               CALL ICBVIO00;      /* DELETE EXTENSION      @Y301B26*/ 13244000
         L     @15,@CV00671                                        3443 13245000
         BALR  @14,@15                                             3443 13246000
*               RESPECIFY                                          3444 13247000
*                 REG1 UNRSTD;      /* FREE REG 1            @Y301B26*/ 13248000
*               IF RPLVRETC¬=RCZERO THEN/*                   @Y30LB26*/ 13249000
         L     @01,RPLVPTR                                         3445 13250000
         CLC   RPLVRETC(2,@01),@CB00747                            3445 13251000
         BNE   @RT03445                                            3445 13252000
*                 RETURN;           /*                       @Y301B26*/ 13253000
*                                                                  3446 13254000
*               /*****************************************************/ 13255000
*               /*                                                   */ 13256000
*               /* IF NOT PREVIOUSLY JOURNALED, JOURNAL      @Y30LB26*/ 13257000
*               /* THE RPLV                                  @Y30LB26*/ 13258000
*               /*                                                   */ 13259000
*               /*****************************************************/ 13260000
*                                                                  3447 13261000
*               IF JRNLEDSW=OFF THEN/* IF NOT JOURNALED      @Y301B26*/ 13262000
         TM    JRNLEDSW,B'00000001'                                3447 13263000
         BNZ   @RF03447                                            3447 13264000
*                 DO;               /*                       @Y301B26*/ 13265000
*                   CALL JOURNAL;   /* JOURNAL RPLV          @Y301B26*/ 13266000
         BAL   @14,JOURNAL                                         3449 13267000
*                   IF RPLVRETC¬=RCZERO THEN/*               @Y30LB26*/ 13268000
         L     @01,RPLVPTR                                         3450 13269000
         CLC   RPLVRETC(2,@01),@CB00747                            3450 13270000
         BNE   @RT03450                                            3450 13271000
*                     RETURN;       /*                       @Y301B26*/ 13272000
*                 END;              /*                       @Y301B26*/ 13273000
*                                                                  3452 13274000
*               /*****************************************************/ 13275000
*               /*                                                   */ 13276000
*               /* CHECK TO SEE IF DELETED RECORD WAS        @Y30LB26*/ 13277000
*               /* THE LAST EXTENSION RECORD. IF IT WAS      @Y30LB26*/ 13278000
*               /* READ THE PREVIOUS EXTENSION RECORD        @Y30LB26*/ 13279000
*               /*                                                   */ 13280000
*               /*****************************************************/ 13281000
*                                                                  3453 13282000
*               IF GVSEX=OFF&LOOPSW=ON THEN/* LAST EXT REC   @Y301B26*/ 13283000
@RF03447 TM    GVSEX(GVSNEPTR),B'10000000'                         3453 13284000
         BNZ   @RF03453                                            3453 13285000
         TM    LOOPSW,B'10000000'                                  3453 13286000
         BNO   @RF03453                                            3453 13287000
*                 DO;               /* WITH PREV EXTENSIONS  @Y301B26*/ 13288000
*                   RPLVKEY=ADDR(SAVEKEY);/* GET KEY PREV EXT      3455 13289000
*                                                            @Y301B26*/ 13290000
         L     @02,RPLVPTR                                         3455 13291000
         LA    @15,SAVEKEY                                         3455 13292000
         ST    @15,RPLVKEY(,@02)                                   3455 13293000
*                   RPLVBUF=ADDR(STORGPEX);/* ADDR OF BUFFER @Y301B26*/ 13294000
         LA    @15,STORGPEX                                        3456 13295000
         ST    @15,RPLVBUF(,@02)                                   3456 13296000
*                   RPLVBLN=LENGTH(STORGPEX);/* LENGTH BUFFER      3457 13297000
*                                                            @Y301B26*/ 13298000
         MVC   RPLVBLN(4,@02),@CF01148                             3457 13299000
*                   RPLVLOC=OFF;    /*                       @Y301B26*/ 13300000
*                   RPLVDIR=ON;     /* READ DIRECT           @Y301B26*/ 13301000
         OI    RPLVDIR(@02),B'01000000'                            3459 13302000
         NI    RPLVLOC(@02),B'01111111'                            3459 13303000
*                   RPLVTYP=RPLVREAD;/* READ REC             @Y301B26*/ 13304000
         MVI   RPLVTYP(@02),X'00'                                  3460 13305000
*                   RPLVKGE=OFF;    /* NO GT OR =            @Y301B26*/ 13306000
         NI    RPLVKGE(@02),B'11111011'                            3461 13307000
*                   RPLVUPD=ON;     /* FOR UPDATE            @Y301B26*/ 13308000
         OI    RPLVUPD(@02),B'00000010'                            3462 13309000
*                   RESPECIFY                                      3463 13310000
*                     REG1 RSTD;    /* RESTRICT              @Y301B26*/ 13311000
*                   REG1=RPLVPTR;   /* ADDR RPLV             @Y301B26*/ 13312000
         LR    REG1,@02                                            3464 13313000
*                   CALL ICBVIO00;  /* READ PREVIOUS EXTEN   @Y301B26*/ 13314000
         L     @15,@CV00671                                        3465 13315000
         BALR  @14,@15                                             3465 13316000
*                   RESPECIFY                                      3466 13317000
*                     REG1 UNRSTD;  /* FREE REG 1            @Y301B26*/ 13318000
*                   IF RPLVRETC¬=RCZERO THEN/*               @Y30LB26*/ 13319000
         L     @02,RPLVPTR                                         3467 13320000
         CLC   RPLVRETC(2,@02),@CB00747                            3467 13321000
         BNE   @RT03467                                            3467 13322000
*                     RETURN;       /*                       @Y301B26*/ 13323000
*                   GVSNEPTR=ADDR(STORGPEX);/* ADDR REC READ @Y30LB26*/ 13324000
*                                                                  3469 13325000
         LA    GVSNEPTR,STORGPEX                                   3469 13326000
*                   /*************************************************/ 13327000
*                   /*                                               */ 13328000
*                   /* SET FLAG INDICATING THAT THIS IS NOW  @Y30LB26*/ 13329000
*                   /* THE LAST EXTENSION RECORD             @Y30LB26*/ 13330000
*                   /*                                               */ 13331000
*                   /*************************************************/ 13332000
*                                                                  3470 13333000
*                   GVSEX=OFF;      /* INDICATE LAST EXT REC @Y301B26*/ 13334000
*                                                                  3470 13335000
         NI    GVSEX(GVSNEPTR),B'01111111'                         3470 13336000
*                   /*************************************************/ 13337000
*                   /*                                               */ 13338000
*                   /* WRITE EXTENSION RECORD                @Y30LB26*/ 13339000
*                   /*                                               */ 13340000
*                   /*************************************************/ 13341000
*                                                                  3471 13342000
*                   RPLVTYP=RPLVPUT;/* PUT RECORD            @Y301B26*/ 13343000
         L     @02,RPLVPTR                                         3471 13344000
         MVI   RPLVTYP(@02),X'01'                                  3471 13345000
*                   RESPECIFY                                      3472 13346000
*                     REG1 RSTD;    /* RESTRICT              @Y301B26*/ 13347000
*                   REG1=RPLVPTR;   /*                       @Y30LB26*/ 13348000
         LR    REG1,@02                                            3473 13349000
*                   CALL ICBVIO00;  /* WRITE EXTENSION REC   @Y30LB26*/ 13350000
         L     @15,@CV00671                                        3474 13351000
         BALR  @14,@15                                             3474 13352000
*                   RESPECIFY                                      3475 13353000
*                     REG1 UNRSTD;  /*                       @Y30LB26*/ 13354000
*                   IF RPLVRETC¬=RCZERO THEN/*               @Y30LB26*/ 13355000
         L     @02,RPLVPTR                                         3476 13356000
         CLC   RPLVRETC(2,@02),@CB00747                            3476 13357000
         BNE   @RT03476                                            3476 13358000
*                     RETURN;       /*                       @Y301B26*/ 13359000
*                 END;              /*                       @Y301B26*/ 13360000
*               RETURN;             /*                       @Y30LB26*/ 13361000
         B     @EL00055                                            3479 13362000
*             END;                  /*                       @Y301B26*/ 13363000
*         END;                      /*                       @Y301B26*/ 13364000
*     END;                          /* END INSIDE WHILE      @Y301B26*/ 13365000
*                                                                  3482 13366000
@RF03402 LA    @15,1                                               3482 13367000
         SLR   @14,@14                                             3482 13368000
         IC    @14,J                                               3482 13369000
         ALR   @15,@14                                             3482 13370000
@DE03401 STC   @15,J                                               3482 13371000
         LH    @14,GVSESIND(,GVSNEPTR)                             3482 13372000
         BCTR  @14,0                                               3482 13373000
         CR    @15,@14                                             3482 13374000
         BNH   @DL03401                                            3482 13375000
*     /***************************************************************/ 13376000
*     /*                                                             */ 13377000
*     /* INDICATE AT LEAST ONE EXTENSION RECORD WAS FOUND    @Y30LB26*/ 13378000
*     /* SO THAT IF THE LAST ONE IS DELETED, A PREVIOUS      @Y30LB26*/ 13379000
*     /* READ CAN BE DONE                                    @Y30LB26*/ 13380000
*     /*                                                             */ 13381000
*     /***************************************************************/ 13382000
*                                                                  3483 13383000
*     LOOPSW=ON;                    /* INDIC FND AT LEAST 1  @Y30LB26*/ 13384000
         OI    LOOPSW,B'10000000'                                  3483 13385000
*     SAVEKEY=GVSNAME;              /* SAVE OLD KEY          @Y301B26*/ 13386000
         MVC   SAVEKEY(13),GVSNAME(GVSNEPTR)                       3484 13387000
*     GKEY=GVSNAME;                 /* SET UP KEY FOR NEXT   @Y30LB26*/ 13388000
         MVC   GKEY(13),GVSNAME(GVSNEPTR)                          3485 13389000
*   END;                            /* OUTSIDE WHILE LOOP    @Y30LB26*/ 13390000
@DE03378 CLC   I(1),I                                              3486 13391000
         BE    @DL03378                                            3486 13392000
*   RETURN;                         /*                       @Y301B26*/ 13393000
         B     @EL00055                                            3487 13394000
*   END DELETESL;                   /*                       @Y301B26*/ 13395000
         B     @EL00055                                            3488 13396000
*                                                                  3489 13397000
*/*  START OF SPECIFICATIONS ****                                  3489 13398000
*                                                                  3489 13399000
*    PROCEDURE NAME - ICBVUEXP                                @Y30LB26  13400000
*                                                                  3489 13401000
*    FUNCTION - THE ROUTINE USES A FORMULA THAT DOES TAKE INTO ACCOUNT  13402000
*    LEAP YEAR WHEN CALCULATING THE JULIAN DATE.                   3489 13403000
*    IF A FOR DAYS OF 9999 IS PASSED TO THE ROUTINE, IT WILL       3489 13404000
*    RETURN AN EXPIRATION DATE OF 99365.  ALSO IF THE DAYS PASSED  3489 13405000
*    CALCULATES OUT TO A VALUE OVER 99365, THEN 99365 IS RETURNED. 3489 13406000
*                                                             @Y30LB26  13407000
*                                                                  3489 13408000
*      INPUT - A PARAMETER LIST WHICH CONTAINS THE NUMBER OF DAYS AHEAD 13409000
*      TO MAKE THE EXPIRATION DATE AND A SPACE FOR THE EXPIRATION DATE  13410000
*      TO BE RETURNED IN.                                     @Y30LB26  13411000
*                                                                  3489 13412000
*      OUTPUT - EXPIRATION DATE RETURNED IN THE PARAMETER LIST.    3489 13413000
*      THERE ARE NO REASON OR RETURN CODES FROM THIS PROGRAM. @Y30LB26  13414000
*                                                                  3489 13415000
**** END OF SPECIFICATIONS **                                        */ 13416000
*                                                                  3489 13417000
*ICBVUEXP:                                                         3489 13418000
*   ENTRY(FOR,EXPDATE);             /*                       @Y30LB26*/ 13419000
@EP03489 MVC   @PC00001+40(8),0(@01)                               3489 13420000
*   DCL                                                            3490 13421000
*     FOR FIXED(15);                /* NO DAYS TO EXPIRATION @Y30LB26*/ 13422000
*   DCL                                                            3491 13423000
*     EXPDATE CHAR(4);              /* RTNTN DATE PACKED DEC @Y30LB26*/ 13424000
*                                                                  3491 13425000
*   /*****************************************************************/ 13426000
*   /*                                                               */ 13427000
*   /* SET UP VALUE IN PROGRAM AS IT WAS PASSED              @Y30LB26*/ 13428000
*   /*                                                               */ 13429000
*   /*****************************************************************/ 13430000
*                                                                  3492 13431000
*   FOREXP=FOR;                     /* DAYS TO EXPIRATION    @Y30LB26*/ 13432000
*                                                                  3492 13433000
         L     @02,@PC00001+40                                     3492 13434000
         LH    FOREXP,FOR(,@02)                                    3492 13435000
*   /*****************************************************************/ 13436000
*   /*                                                               */ 13437000
*   /* CALL INTERNAL PROCEDURE AND SET VALUE TO BE PASSED    @Y30LB26*/ 13438000
*   /*                                                               */ 13439000
*   /*****************************************************************/ 13440000
*                                                                  3493 13441000
*   CALL VUEXP;                     /* CALL INTER PROC       @Y30LB26*/ 13442000
         BAL   @14,VUEXP                                           3493 13443000
*   EXPDATE=RETDATE;                /* EXPIRATION DATE       @Y30LB26*/ 13444000
         L     @02,@PC00001+44                                     3494 13445000
         MVC   EXPDATE(4,@02),RETDATE                              3494 13446000
*   RETURN;                         /*                       @Y30LB26*/ 13447000
         B     @EL00001                                            3495 13448000
*                                                                  3496 13449000
*   /*****************************************************************/ 13450000
*   /*                                                               */ 13451000
*   /* PROCEDURE VUEXP IS CODED SO THAT CODE CONTAINED       @Y30LB26*/ 13452000
*   /* IN ENTRY ICBVUEXP CAN BE USED BY BOTH THIS MODULE     @Y30LB26*/ 13453000
*   /* AND BY OTHER MODULES                                  @Y30LB26*/ 13454000
*   /*                                                               */ 13455000
*   /*****************************************************************/ 13456000
*                                                                  3496 13457000
*VUEXP:                                                            3496 13458000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2053*/ 13459000
VUEXP    ST    @14,@SA00056                                        3496 13460000
*   DCL                                                            3497 13461000
*     NRMYR FIXED(15) CONSTANT(365);/* NO DAYS YEAR          @Y30LB26*/ 13462000
*   DCL                                                            3498 13463000
*     LEAPYR FIXED(15) CONSTANT(366);/* NO DAYS LEAP YEAR    @G24LB26*/ 13464000
*   DCL                                                            3499 13465000
*     THOU FIXED(31) INIT(1000);    /* 1000                  @Y30LB26*/ 13466000
*   DCL                                                            3500 13467000
*     DBLWORD CHAR(8) BDY(DWORD);   /* TWO WORDS             @Y30LB26*/ 13468000
*   DCL                                                            3501 13469000
*     1 DATE,                                                      3501 13470000
*      2 DAY FIXED(15),             /* NO DAYS               @ZA13484*/ 13471000
*      2 YEAR FIXED(15);            /* YEAR                  @ZA13484*/ 13472000
*   RESPECIFY                                                      3502 13473000
*    (REG0,                                                        3502 13474000
*     REG1) RSTD;                   /* RESTRICT              @Y30LB26*/ 13475000
*   MAXDATE='0099365C'X;            /* SET MAX DATE          @Y30LB26*/ 13476000
*                                                                  3503 13477000
         MVC   MAXDATE(4),@CB00765                                 3503 13478000
*   /*****************************************************************/ 13479000
*   /*                                                               */ 13480000
*   /* CHECK FOR RECOVERY REQUEST AND IF SO USE THE          @ZA13484*/ 13481000
*   /* DATE THE RPLV WAS CREATED.                            @ZA13484*/ 13482000
*   /*                                                               */ 13483000
*   /*****************************************************************/ 13484000
*                                                                  3504 13485000
*   IF RPLJRCVY=ON&RPLVDATE¬=NULLDATE THEN/* RECOVERY?       @ZA13484*/ 13486000
         L     @07,RPLVPTR                                         3504 13487000
         TM    RPLJRCVY(@07),B'00000010'                           3504 13488000
         BNO   @RF03504                                            3504 13489000
         CLC   RPLVDATE(4,@07),NULLDATE                            3504 13490000
         BE    @RF03504                                            3504 13491000
*     DATE=RPLVDATE;                /* RPLV DATE             @ZA13484*/ 13492000
         MVC   DATE(4),RPLVDATE(@07)                               3505 13493000
*   ELSE                                                           3506 13494000
*     DO;                           /*                       @ZA13484*/ 13495000
*                                                                  3506 13496000
         B     @RC03504                                            3506 13497000
@RF03504 DS    0H                                                  3507 13498000
*       /*************************************************************/ 13499000
*       /*                                                           */ 13500000
*       /* GET THE CURRENT DATE BY ISSUING THE TIME MACRO    @Y30LB26*/ 13501000
*       /* THEN CONVERT IT TO BINARY AND SEPERATE THE DAYS   @Y30LB26*/ 13502000
*       /* AND YEARS                                         @Y30LB26*/ 13503000
*       /*                                                           */ 13504000
*       /*************************************************************/ 13505000
*                                                                  3507 13506000
*       GENERATE;                                                  3507 13507000
*                                                          /*@Y30LB26*/ 13508000
         TIME DEC                   GET CURRENT DATE           @Y30LB26 13509000
         SR REG0,REG0               CLEAR REG0                 @Y30LB26 13510000
         ST REG0,DBLWORD            CLEAR 1ST HALF DBL         @Y30LB26 13511000
         ST REG1,DBLWORD+4          DATE TO SECOND HALF        @Y30LB26 13512000
         CVB REG1,DBLWORD           CONVERT TO BINARY          @Y30LB26 13513000
         D REG0,THOU                SEPERATE DAY & YEAR        @Y30LB26 13514000
         STH REG0,DAY               GET DAYS                   @Y30LB26 13515000
         STH REG1,YEAR              GET YEAR                   @Y30LB26 13516000
*     END;                          /*                       @ZA13484*/ 13517000
*                                                                  3508 13518000
*   /*****************************************************************/ 13519000
*   /*                                                               */ 13520000
*   /* ADD THE FOR DAYS TO THE CURRENT DAYS                  @Y30LB26*/ 13521000
*   /*                                                               */ 13522000
*   /*****************************************************************/ 13523000
*                                                                  3509 13524000
*   DAY=DAY+FOREXP;                 /* ADD FOR DAYS          @Y30LB26*/ 13525000
@RC03504 LR    @07,FOREXP                                          3509 13526000
         AH    @07,DAY                                             3509 13527000
         STH   @07,DAY                                             3509 13528000
*   I=ZERO;                         /* INIT LOOP SWITCH      @Y30LB26*/ 13529000
         MVI   I,X'00'                                             3510 13530000
*   DO WHILE I=ZERO;                /* OUTSIDE LOOP          @Y30LB26*/ 13531000
*                                                                  3511 13532000
         B     @DE03511                                            3511 13533000
@DL03511 DS    0H                                                  3512 13534000
*     /***************************************************************/ 13535000
*     /*                                                             */ 13536000
*     /* DIVIDE BY FOUR AND CHECK THE REMAINDER TO SEE IF    @Y30LB26*/ 13537000
*     /* IT IS A LEAP YEAR                                   @Y30LB26*/ 13538000
*     /*                                                             */ 13539000
*     /***************************************************************/ 13540000
*                                                                  3512 13541000
*     IF YEAR//4=ZERO THEN          /* LEAP YEAR?            @Y30LB26*/ 13542000
         LH    @04,YEAR                                            3512 13543000
         LR    @06,@04                                             3512 13544000
         SRDA  @06,32                                              3512 13545000
         D     @06,@CF00045                                        3512 13546000
         LTR   @06,@06                                             3512 13547000
         BNZ   @RF03512                                            3512 13548000
*       DO;                         /*                       @Y30LB26*/ 13549000
*                                                                  3513 13550000
*         /***********************************************************/ 13551000
*         /*                                                         */ 13552000
*         /* IF LEAP YEAR, SEE IF MORE THAN 366 DAYS         @G24LB26*/ 13553000
*         /*                                                         */ 13554000
*         /***********************************************************/ 13555000
*                                                                  3514 13556000
*         IF DAY>LEAPYR THEN        /* ENOUGH MAKE A YR?     @ZA13056*/ 13557000
*                                                                  3514 13558000
         LH    @02,DAY                                             3514 13559000
         LA    @15,366                                             3514 13560000
         CR    @02,@15                                             3514 13561000
         BNH   @RF03514                                            3514 13562000
*           /*********************************************************/ 13563000
*           /*                                                       */ 13564000
*           /* SUBTRACT 366 FROM DAYS AND ADD ONE YEAR,      @G24LB26*/ 13565000
*           /* GO BACK TO START OF LOOP                      @Y30LB26*/ 13566000
*           /*                                                       */ 13567000
*           /*********************************************************/ 13568000
*                                                                  3515 13569000
*           DO;                     /*                       @Y30LB26*/ 13570000
*             DAY=DAY-LEAPYR;       /* SUBTRACT 366          @G24LB26*/ 13571000
         SLR   @02,@15                                             3516 13572000
         STH   @02,DAY                                             3516 13573000
*             YEAR=YEAR+1;          /* ADD YEAR              @Y30LB26*/ 13574000
         AL    @04,@CF00041                                        3517 13575000
         STH   @04,YEAR                                            3517 13576000
*           END;                    /*                       @Y30LB26*/ 13577000
*                                                                  3518 13578000
*         /***********************************************************/ 13579000
*         /*                                                         */ 13580000
*         /* OTHERWISE DROP OUT OF LOOP                      @Y30LB26*/ 13581000
*         /*                                                         */ 13582000
*         /***********************************************************/ 13583000
*                                                                  3519 13584000
*         ELSE                      /*                       @Y30LB26*/ 13585000
*           I=1;                    /* GET OUT LOOP          @Y30LB26*/ 13586000
         B     @RC03514                                            3519 13587000
@RF03514 MVI   I,X'01'                                             3519 13588000
*       END;                        /*                       @Y30LB26*/ 13589000
*                                                                  3520 13590000
*     /***************************************************************/ 13591000
*     /*                                                             */ 13592000
*     /* IF IT IS NOT A LEAP YEAR, SEE IF THERE ARE 365 DAYS @Y30LB26*/ 13593000
*     /*                                                             */ 13594000
*     /***************************************************************/ 13595000
*                                                                  3521 13596000
*     ELSE                          /*                       @Y30LB26*/ 13597000
*       IF DAY>NRMYR THEN           /* ENOUGH FOR YEAR       @ZA13056*/ 13598000
*                                                                  3521 13599000
         B     @RC03512                                            3521 13600000
@RF03512 LH    @04,DAY                                             3521 13601000
         LA    @02,365                                             3521 13602000
         CR    @04,@02                                             3521 13603000
         BNH   @RF03521                                            3521 13604000
*         /***********************************************************/ 13605000
*         /*                                                         */ 13606000
*         /* IF MORE THAN 365, SUBTRACT 365, ADD ONE         @Y30LB26*/ 13607000
*         /* YEAR AND GO BACK TO START OF LOOP               @Y30LB26*/ 13608000
*         /*                                                         */ 13609000
*         /***********************************************************/ 13610000
*                                                                  3522 13611000
*         DO;                       /*                       @Y30LB26*/ 13612000
*           DAY=DAY-NRMYR;          /* SUBTRACT 365          @Y30LB26*/ 13613000
         SLR   @04,@02                                             3523 13614000
         STH   @04,DAY                                             3523 13615000
*           YEAR=YEAR+1;            /* ADD TO YEAR           @Y30LB26*/ 13616000
         LA    @04,1                                               3524 13617000
         AH    @04,YEAR                                            3524 13618000
         STH   @04,YEAR                                            3524 13619000
*         END;                      /*                       @Y30LB26*/ 13620000
*                                                                  3525 13621000
*     /***************************************************************/ 13622000
*     /*                                                             */ 13623000
*     /* IF NOT 365 DAYS, DROP OUT OF LOOP                   @Y30LB26*/ 13624000
*     /*                                                             */ 13625000
*     /***************************************************************/ 13626000
*                                                                  3526 13627000
*       ELSE                        /*                       @Y30LB26*/ 13628000
*         I=1;                      /* GET OUT OF LOOP       @Y30LB26*/ 13629000
         B     @RC03521                                            3526 13630000
@RF03521 MVI   I,X'01'                                             3526 13631000
*   END;                            /* END WHILE LOOP        @Y30LB26*/ 13632000
*                                                                  3527 13633000
@RC03521 DS    0H                                                  3527 13634000
@RC03512 DS    0H                                                  3527 13635000
@DE03511 CLI   I,0                                                 3527 13636000
         BE    @DL03511                                            3527 13637000
*   /*****************************************************************/ 13638000
*   /*                                                               */ 13639000
*   /* MULT YEARS BY 1000 AND ADD DAYS TO GET YEARS AND      @Y30LB26*/ 13640000
*   /* DAYS BACK TOGATHER AGAIN. THEN CONVERT TO DECIMAL     @Y30LB26*/ 13641000
*   /*                                                               */ 13642000
*   /*****************************************************************/ 13643000
*                                                                  3528 13644000
*   REG1=YEAR*THOU;                 /* MULT                  @Y30LB26*/ 13645000
         L     REG1,THOU                                           3528 13646000
         MH    REG1,YEAR                                           3528 13647000
*   REG1=REG1+DAY;                  /* GET WHOLE DATE        @Y30LB26*/ 13648000
         AH    REG1,DAY                                            3529 13649000
*   GEN(CVD REG1,DBLWORD);          /* CONVERT TO DEC        @Y30LB26*/ 13650000
*                                                                  3530 13651000
         CVD REG1,DBLWORD                                               13652000
*   /*****************************************************************/ 13653000
*   /*                                                               */ 13654000
*   /* MOVE NEW DATE INTO RETURN PARAMETER                   @Y30LB26*/ 13655000
*   /*                                                               */ 13656000
*   /*****************************************************************/ 13657000
*                                                                  3531 13658000
*   RETDATE=DBLWORD(5:8);           /* GET DATE              @Y30LB26*/ 13659000
         MVC   RETDATE(4),DBLWORD+4                                3531 13660000
*   RESPECIFY                                                      3532 13661000
*    (REG0,                                                        3532 13662000
*     REG1) UNRSTD;                 /* FREE REGS             @Y30LB26*/ 13663000
*                                                                  3532 13664000
*   /*****************************************************************/ 13665000
*   /*                                                               */ 13666000
*   /* IF CALCULATED DATE IS OVER THE MAX ALLOWED DATE,      @Y30LB26*/ 13667000
*   /* THEN PUT IN THE MAXIMUM DATE                          @Y30LB26*/ 13668000
*   /*                                                               */ 13669000
*   /*****************************************************************/ 13670000
*                                                                  3533 13671000
*   IF RETDATE>MAXDATE THEN         /* SEE IF TOO BIG        @Y30LB26*/ 13672000
         CLC   RETDATE(4),MAXDATE                                  3533 13673000
         BNH   @RF03533                                            3533 13674000
*     RETDATE=MAXDATE;              /* SET MAX DATE          @Y30LB26*/ 13675000
         MVC   RETDATE(4),MAXDATE                                  3534 13676000
*   RETURN;                         /*                       @Y30LB26*/ 13677000
@EL00056 DS    0H                                                  3535 13678000
@EF00056 DS    0H                                                  3535 13679000
@ER00056 L     @14,@SA00056                                        3535 13680000
         BR    @14                                                 3535 13681000
*   END VUEXP;                      /*                       @Y30LB26*/ 13682000
         B     @EL00056                                            3536 13683000
*   END ICBVUT01                    /*                       @Y30LB26*/ 13684000
*                                                                  3537 13685000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 13686000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 13687000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 13688000
*/*%INCLUDE SYSLIB  (IEZNGVR )                                       */ 13689000
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */ 13690000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 13691000
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */ 13692000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 13693000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 13694000
*/*%INCLUDE SYSLIB  (IEZDUPV )                                       */ 13695000
*/*%INCLUDE SYSLIB  (IEZINDEX)                                       */ 13696000
*/*%INCLUDE SYSLIB  (IEZCPUID)                                       */ 13697000
*/*%INCLUDE SYSLIB  (IEZRVR  )                                       */ 13698000
*/*%INCLUDE SYSLIB  (IEZMGP  )                                       */ 13699000
*/*%INCLUDE SYSLIB  (IEZSGP  )                                       */ 13700000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 13701000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */ 13702000
*                                                                  3537 13703000
*       ;                                                          3537 13704000
         B     @EL00001                                            3537 13705000
@DATA    DS    0H                                                       13706000
@CH01149 DC    H'20'                                                    13707000
@CH00688 DC    H'256'                                                   13708000
@CH00890 DC    H'404'                                                   13709000
@SC01176 CLC   MGPGROUP(0,@07),0(@15)                                   13710000
         DS    0F                                                       13711000
@AL00733 EQU   *                       LIST WITH   4 ARGUMENT(S)        13712000
@AL00753 EQU   *                       LIST WITH   4 ARGUMENT(S)        13713000
@AL02719 EQU   *                       LIST WITH   4 ARGUMENT(S)        13714000
@AL02729 DC    A(@CF00039)             LIST WITH   4 ARGUMENT(S)        13715000
         DC    A(BASEVPTR)                                              13716000
         DC    A(RPLVPTR)                                               13717000
         DC    A(PASSFLAG)                                              13718000
@AL00845 EQU   *                       LIST WITH   4 ARGUMENT(S)        13719000
@AL02585 EQU   *                       LIST WITH   4 ARGUMENT(S)        13720000
@AL02681 DC    A(GROUPPTR)             LIST WITH   4 ARGUMENT(S)        13721000
         DC    A(BASEVPTR)                                              13722000
         DC    A(RPLVPTR)                                               13723000
         DC    A(PASSFLAG)                                              13724000
@AL02577 EQU   *                       LIST WITH   3 ARGUMENT(S)        13725000
@AL02665 EQU   *                       LIST WITH   3 ARGUMENT(S)        13726000
@AL02764 EQU   *                       LIST WITH   3 ARGUMENT(S)        13727000
@AL02852 DC    A(GROUPPTR)             LIST WITH   3 ARGUMENT(S)        13728000
         DC    A(BASEVPTR)                                              13729000
         DC    A(PASSFLAG)                                              13730000
         DS    0F                                                       13731000
@SA00001 DS    18F                                                      13732000
@PC00001 DS    12F                                                      13733000
@SA00008 DS    1F                                                       13734000
@SA00002 DS    1F                                                       13735000
@SA00004 DS    18F                                                      13736000
@SA00007 DS    1F                                                       13737000
@SA00038 DS    1F                                                       13738000
@SA00015 DS    1F                                                       13739000
@SA00003 DS    1F                                                       13740000
@SA00005 DS    1F                                                       13741000
@SA00006 DS    1F                                                       13742000
@SA00052 DS    1F                                                       13743000
@SA00009 DS    1F                                                       13744000
@SA00012 DS    1F                                                       13745000
@SA00010 DS    1F                                                       13746000
@SA00011 DS    1F                                                       13747000
@SA00051 DS    1F                                                       13748000
@SA00014 DS    1F                                                       13749000
@SA00013 DS    1F                                                       13750000
@SA00017 DS    1F                                                       13751000
@SA00018 DS    1F                                                       13752000
@SA00019 DS    1F                                                       13753000
@SA00021 DS    1F                                                       13754000
@SA00022 DS    1F                                                       13755000
@SA00023 DS    1F                                                       13756000
@SA00029 DS    1F                                                       13757000
@SA00030 DS    1F                                                       13758000
@SA00031 DS    1F                                                       13759000
@SA00033 DS    1F                                                       13760000
@SA00032 DS    1F                                                       13761000
@SA00016 DS    1F                                                       13762000
@SA00036 DS    1F                                                       13763000
@SA00037 DS    1F                                                       13764000
@SA00020 DS    1F                                                       13765000
@SA00024 DS    1F                                                       13766000
@SA00025 DS    1F                                                       13767000
@SA00028 DS    1F                                                       13768000
@SA00026 DS    1F                                                       13769000
@SA00027 DS    1F                                                       13770000
@SA00034 DS    1F                                                       13771000
@SA00056 DS    1F                                                       13772000
@SA00039 DS    1F                                                       13773000
@SA00046 DS    1F                                                       13774000
@SA00040 DS    1F                                                       13775000
@SA00042 DS    1F                                                       13776000
@SA00041 DS    1F                                                       13777000
@SA00047 DS    1F                                                       13778000
@SA00043 DS    1F                                                       13779000
@SA00045 DS    1F                                                       13780000
@SA00044 DS    1F                                                       13781000
@SA00055 DS    1F                                                       13782000
@SA00053 DS    1F                                                       13783000
@PC00054 DS    1F                                                       13784000
@SA00035 DS    0F                                                       13785000
@SA00048 DS    0F                                                       13786000
@SA00050 DS    0F                                                       13787000
@SA00049 DS    0F                                                       13788000
         DS    1F                                                       13789000
@TF00001 DS    F                                                        13790000
         DS    0F                                                       13791000
@CF00039 DC    F'0'                                                     13792000
@CF00041 DC    F'1'                                                     13793000
@CH00041 EQU   @CF00041+2                                               13794000
@CF00058 DC    F'2'                                                     13795000
@CF00045 DC    F'4'                                                     13796000
@CF00036 DC    F'8'                                                     13797000
@CF01150 DC    F'49'                                                    13798000
@CF00892 DC    F'100'                                                   13799000
@CF01146 DC    F'164'                                                   13800000
@CF01147 DC    F'224'                                                   13801000
@CF01148 DC    F'988'                                                   13802000
@CF01186 DC    XL4'0000FFFF'                                            13803000
@CV00671 DC    V(ICBVIO00)                                              13804000
@CV00672 DC    V(ICBVJL00)                                              13805000
@CV00673 DC    V(ICBVRR00)                                              13806000
@CV00674 DC    V(ICBVUCHI)                                              13807000
@CV00675 DC    V(ICBVUCHO)                                              13808000
@CV00676 DC    V(ICBVUPGH)                                              13809000
         DS    0D                                                       13810000
RPLVPTR  DS    A                                                        13811000
GROUPPTR DS    A                                                        13812000
BASEVPTR DS    A                                                        13813000
COPYVPTR DS    A                                                        13814000
DUPVPTR  DS    A                                                        13815000
RVRPTR   DS    A                                                        13816000
MVRPTR   DS    A                                                        13817000
FIXF     DC    XL4'FFFFFFFF'                                            13818000
THOU     DC    F'1000'                                                  13819000
RVRLEN   DC    AL2(24)                                                  13820000
MGPLEN   DC    AL2(104)                                                 13821000
SGPLEN   DC    AL2(20)                                                  13822000
RVVLEN   DC    AL2(68)                                                  13823000
MVRLEN   DC    AL2(88)                                                  13824000
LIBTEST  DC    XL1'FF'                                                  13825000
I        DS    FL1                                                      13826000
J        DS    FL1                                                      13827000
@CB00765 DC    X'0099365C'                                              13828000
@CB00747 DC    X'0000'                                                  13829000
@CB00749 DC    X'0004'                                                  13830000
@CB00785 DC    X'0213'                                                  13831000
@CB00787 DC    X'0214'                                                  13832000
@CB00789 DC    X'0208'                                                  13833000
@CB00793 DC    X'0217'                                                  13834000
@CB00795 DC    X'0218'                                                  13835000
@CB00797 DC    X'0219'                                                  13836000
@CB00799 DC    X'021A'                                                  13837000
@CB00801 DC    X'0229'                                                  13838000
@CB00803 DC    X'0201'                                                  13839000
@CB00805 DC    X'021C'                                                  13840000
@CB00807 DC    X'021D'                                                  13841000
@CB00809 DC    X'021E'                                                  13842000
@CB00811 DC    X'021F'                                                  13843000
@CB00813 DC    X'0220'                                                  13844000
@CB00815 DC    X'0221'                                                  13845000
@CB00817 DC    X'0222'                                                  13846000
@CB00819 DC    X'0223'                                                  13847000
@CB00821 DC    X'0224'                                                  13848000
@CB00823 DC    X'0225'                                                  13849000
@CB00825 DC    X'0227'                                                  13850000
@CB00827 DC    X'0228'                                                  13851000
@CB00829 DC    X'0226'                                                  13852000
@CB00831 DC    X'022A'                                                  13853000
@CB00833 DC    X'0230'                                                  13854000
@CB00835 DC    X'0202'                                                  13855000
@CB00839 DC    X'0205'                                                  13856000
@CB00841 DC    X'023C'                                                  13857000
REACODE  DS    CL2                                                      13858000
RETCODE  DS    CL2                                                      13859000
STORBASE DS    CL224                                                    13860000
STORGRP  DS    CL224                                                    13861000
STORDUP  DS    CL224                                                    13862000
STORINDX DS    CL224                                                    13863000
STORCPY  DS    CL224                                                    13864000
DUMMYREC DS    CL224                                                    13865000
DUMGVSNE DS    CL988                                                    13866000
BASEREC  DS    CL224                                                    13867000
STORGPEX DS    CL988                                                    13868000
SAVEKEY  DS    CL13                                                     13869000
GKEY     DS    CL13                                                     13870000
         ORG   GKEY                                                     13871000
GKY      DC    CL3'G  '                                                 13872000
GROUPKY  DS    CL8                                                      13873000
GBLKKY   DC    CL1' '                                                   13874000
GIDKY    DC    XL1'00'                                                  13875000
         ORG   GKEY+13                                                  13876000
VKEY     DS    CL13                                                     13877000
         ORG   VKEY                                                     13878000
VKY      DC    CL5'V    '                                               13879000
VOLKY    DS    CL6                                                      13880000
VBLKKY   DC    CL1' '                                                   13881000
VIDKY    DC    XL1'00'                                                  13882000
         ORG   VKEY+13                                                  13883000
DKEY     DS    CL13                                                     13884000
         ORG   DKEY                                                     13885000
DKY      DC    CL5'D    '                                               13886000
DVOLKY   DS    CL6                                                      13887000
DBLKKY   DC    CL1' '                                                   13888000
DIDKY    DC    XL1'00'                                                  13889000
         ORG   DKEY+13                                                  13890000
IKEY     DS    CL13                                                     13891000
         ORG   IKEY                                                     13892000
IKY      DC    CL1'I'                                                   13893000
CARTKY   DS    CL12                                                     13894000
         ORG   IKEY+13                                                  13895000
NGHEADER DC    CL13'N   HEADER   '                                      13896000
CKEY     DC    CL13'C  CPU ID    '                                      13897000
PASSFLAG DS    BL2                                                      13898000
         ORG   PASSFLAG                                                 13899000
DUPBCHI  DS    BL1                                                      13900000
FCHNDBR  EQU   PASSFLAG+0                                               13901000
LCHNDBR  EQU   PASSFLAG+0                                               13902000
CHICHOGP EQU   PASSFLAG+0                                               13903000
ADDGRP   EQU   PASSFLAG+0                                               13904000
RESV     EQU   PASSFLAG+0                                               13905000
ADDSLEXT EQU   PASSFLAG+0                                               13906000
JRNLEDSW EQU   PASSFLAG+0                                               13907000
SLOTEXP  DS    BL1                                                      13908000
         ORG   PASSFLAG+2                                               13909000
INTERFLG DS    BL1                                                      13910000
         ORG   INTERFLG                                                 13911000
LOOPSW   DS    BL1                                                      13912000
BKUPFND  EQU   INTERFLG+0                                               13913000
BACKUPFL EQU   INTERFLG+0                                               13914000
DUPFNDFL EQU   INTERFLG+0                                               13915000
EXITVVIC EQU   INTERFLG+0                                               13916000
EXITVJL  EQU   INTERFLG+0                                               13917000
REL3CONF EQU   INTERFLG+0                                               13918000
         ORG   INTERFLG+1                                               13919000
SAVEPREV DS    CL6                                                      13920000
SAVENEXT DS    CL6                                                      13921000
RETDATE  DS    CL4                                                      13922000
NULEXPDT DC    X'FFFFFFFF'                                              13923000
NULLDATE DC    X'00000000'                                              13924000
MAXDATE  DC    X'0099365C'                                              13925000
BLANK8   DC    CL8'        '                                            13926000
ZEROCHAR DC    X'000000000000000000000000'                              13927000
SYSGROUP DC    CL8'SYSGROUP'                                            13928000
         DS    CL1                                                      13929000
ARITHBAS DS    CL2                                                      13930000
         ORG   ARITHBAS                                                 13931000
BASEID   DS    FL2                                                      13932000
         ORG   ARITHBAS+2                                               13933000
ARITHGRP DS    CL2                                                      13934000
         ORG   ARITHGRP                                                 13935000
GRPID    DS    FL2                                                      13936000
         ORG   ARITHGRP+2                                               13937000
ARITHCTG DS    CL1                                                      13938000
         ORG   ARITHCTG                                                 13939000
CARTID   DS    FL1                                                      13940000
         ORG   ARITHCTG+1                                               13941000
UT1PATCH DS    CL200                                                    13942000
         ORG   UT1PATCH                                                 13943000
@NM00051 DC    200X'00'                                                 13944000
         ORG   UT1PATCH+200                                             13945000
TEST1    DS    CL256                                                    13946000
         ORG   TEST1                                                    13947000
TESTINIT DC    64X'01'                                                  13948000
         DC    X'00'                                                    13949000
         DC    26X'01'                                                  13950000
         DC    X'00'                                                    13951000
         DC    31X'01'                                                  13952000
         DC    2X'00'                                                   13953000
         DC    68X'01'                                                  13954000
         DC    9X'00'                                                   13955000
         DC    7X'01'                                                   13956000
         DC    9X'00'                                                   13957000
         DC    8X'01'                                                   13958000
         DC    8X'00'                                                   13959000
         DC    6X'01'                                                   13960000
         DC    10X'00'                                                  13961000
         DC    6X'01'                                                   13962000
         ORG   TEST1+256                                                13963000
EXPIR    DS    CL4                                                      13964000
         DS    CL5                                                      13965000
DBLWORD  DS    CL8                                                      13966000
DATE     DS    CL4                                                      13967000
         ORG   DATE                                                     13968000
DAY      DS    FL2                                                      13969000
YEAR     DS    FL2                                                      13970000
         ORG   DATE+4                                                   13971000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       13972000
@01      EQU   01                                                       13973000
@02      EQU   02                                                       13974000
@03      EQU   03                                                       13975000
@04      EQU   04                                                       13976000
@05      EQU   05                                                       13977000
@06      EQU   06                                                       13978000
@07      EQU   07                                                       13979000
@08      EQU   08                                                       13980000
@09      EQU   09                                                       13981000
@10      EQU   10                                                       13982000
@11      EQU   11                                                       13983000
@12      EQU   12                                                       13984000
@13      EQU   13                                                       13985000
@14      EQU   14                                                       13986000
@15      EQU   15                                                       13987000
IS       EQU   @04                                                      13988000
COUNT    EQU   @06                                                      13989000
FOREXP   EQU   @06                                                      13990000
RVVIPTR  EQU   @05                                                      13991000
SGPPTR   EQU   @05                                                      13992000
MGPPTR   EQU   @06                                                      13993000
CPUIDPTR EQU   @04                                                      13994000
INDEXPTR EQU   @07                                                      13995000
GVSNEPTR EQU   @02                                                      13996000
BCDVPTR  EQU   @05                                                      13997000
NGVRPTR  EQU   @04                                                      13998000
VVIPTR   EQU   @04                                                      13999000
REG0     EQU   @00                                                      14000000
REG1     EQU   @01                                                      14001000
REG2     EQU   @02                                                      14002000
REG4     EQU   @04                                                      14003000
REG5     EQU   @05                                                      14004000
REG6     EQU   @06                                                      14005000
REG7     EQU   @07                                                      14006000
REG14    EQU   @14                                                      14007000
REG15    EQU   @15                                                      14008000
RPLV     EQU   0                                                        14009000
RPLTCBPR EQU   RPLV+8                                                   14010000
RPLVVICB EQU   RPLV+12                                                  14011000
RPLFLAGA EQU   RPLV+28                                                  14012000
RPLJRCVY EQU   RPLFLAGA                                                 14013000
RPLVJRNL EQU   RPLFLAGA                                                 14014000
RPLRCODE EQU   RPLV+32                                                  14015000
RPLVRETC EQU   RPLV+34                                                  14016000
RPLVDATE EQU   RPLV+38                                                  14017000
RPLVSAM  EQU   RPLV+56                                                  14018000
RPLVTYP  EQU   RPLVSAM+2                                                14019000
RPLVBUF  EQU   RPLVSAM+32                                               14020000
RPLVKEY  EQU   RPLVSAM+36                                               14021000
RPLVOPT  EQU   RPLVSAM+40                                               14022000
RPLVLOC  EQU   RPLVOPT                                                  14023000
RPLVDIR  EQU   RPLVOPT                                                  14024000
RPLVNEXT EQU   RPLVOPT                                                  14025000
RPLVKGE  EQU   RPLVOPT                                                  14026000
RPLVUPD  EQU   RPLVOPT+1                                                14027000
RPLVRLN  EQU   RPLVSAM+48                                               14028000
RPLVBLN  EQU   RPLVSAM+52                                               14029000
RPLVUTIL EQU   RPLV+132                                                 14030000
VVICB    EQU   0                                                        14031000
VVIFLGA  EQU   VVICB+15                                                 14032000
VVIFLG0  EQU   VVIFLGA                                                  14033000
VVIFLG2  EQU   VVIFLGA                                                  14034000
NGVR     EQU   0                                                        14035000
NGVRTYPE EQU   NGVR+13                                                  14036000
NGVFVOL  EQU   NGVR+17                                                  14037000
NGVNOVOL EQU   NGVR+30                                                  14038000
BCDV     EQU   0                                                        14039000
BCDNAME  EQU   BCDV                                                     14040000
BCDPREFX EQU   BCDNAME                                                  14041000
BCDID    EQU   BCDNAME+11                                               14042000
BCDFLAGA EQU   BCDV+14                                                  14043000
BCDTYPE  EQU   BCDFLAGA                                                 14044000
BCDFLAGB EQU   BCDFLAGA+2                                               14045000
BCDRCVYF EQU   BCDV+20                                                  14046000
BCDSATIA EQU   BCDRCVYF                                                 14047000
BCDMISCF EQU   BCDRCVYF+2                                               14048000
BCDHOLD  EQU   BCDMISCF                                                 14049000
BCDCSN1  EQU   BCDV+24                                                  14050000
BCDLIB1  EQU   BCDV+36                                                  14051000
BCDLID1  EQU   BCDLIB1                                                  14052000
BCDCSN2  EQU   BCDV+37                                                  14053000
BCDLIB2  EQU   BCDV+49                                                  14054000
BCDLID2  EQU   BCDLIB2                                                  14055000
GROUP    EQU   0                                                        14056000
GRONAME  EQU   GROUP                                                    14057000
GROG     EQU   GRONAME                                                  14058000
GROVVGRP EQU   GRONAME+3                                                14059000
GROID    EQU   GRONAME+11                                               14060000
GROZERO  EQU   GROID+1                                                  14061000
GROFLAGA EQU   GROUP+13                                                 14062000
GROTYPE  EQU   GROFLAGA                                                 14063000
GROGVR   EQU   GROTYPE                                                  14064000
GROBIND  EQU   GROFLAGA+2                                               14065000
GROEXCL  EQU   GROFLAGA+2                                               14066000
GRODAERA EQU   GROFLAGA+2                                               14067000
GRORONLY EQU   GROFLAGA+2                                               14068000
GRORLSE  EQU   GROFLAGA+2                                               14069000
GRORETN  EQU   GROFLAGA+2                                               14070000
GROFSN   EQU   GROUP+17                                                 14071000
GROLSN   EQU   GROUP+23                                                 14072000
GROPCENT EQU   GROUP+29                                                 14073000
GRONGEN  EQU   GROUP+30                                                 14074000
GRONRSTD EQU   GROUP+32                                                 14075000
GRONINAC EQU   GROUP+34                                                 14076000
GROPSPD  EQU   GROUP+36                                                 14077000
GROSSPD  EQU   GROUP+38                                                 14078000
GROSTRSH EQU   GROUP+40                                                 14079000
GROFRESP EQU   GROUP+44                                                 14080000
GRORETPD EQU   GROUP+52                                                 14081000
GROERRTS EQU   GROUP+56                                                 14082000
GRODESCR EQU   GROUP+64                                                 14083000
GROCONUS EQU   GROUP+94                                                 14084000
GRORESSP EQU   GROUP+95                                                 14085000
GROOWNER EQU   GROUP+96                                                 14086000
GROADDR  EQU   GROUP+106                                                14087000
GVSNE    EQU   0                                                        14088000
GVSHDR   EQU   GVSNE                                                    14089000
GVSNAME  EQU   GVSHDR                                                   14090000
GVSVVGRP EQU   GVSNAME+3                                                14091000
GVSID    EQU   GVSNAME+11                                               14092000
GVSFLAGA EQU   GVSHDR+13                                                14093000
GVSTYPE  EQU   GVSFLAGA                                                 14094000
GVSGVSEX EQU   GVSTYPE                                                  14095000
GVSEX    EQU   GVSFLAGA+2                                               14096000
GVSESIND EQU   GVSHDR+18                                                14097000
GVSSLOTS EQU   GVSNE+28                                                 14098000
GVSVOLID EQU   GVSSLOTS                                                 14099000
GVSVOLFL EQU   GVSSLOTS+6                                               14100000
GVSCPUBM EQU   GVSVOLFL                                                 14101000
GVSRCFSI EQU   GVSVOLFL+2                                               14102000
GVSMTNSH EQU   GVSVOLFL+2                                               14103000
GVSFRESP EQU   GVSSLOTS+10                                              14104000
GVSLEXT  EQU   GVSSLOTS+12                                              14105000
GVSEXPDT EQU   GVSSLOTS+14                                              14106000
GVSMTDSP EQU   GVSSLOTS+18                                              14107000
BASEV    EQU   0                                                        14108000
BASNAME  EQU   BASEV                                                    14109000
BASEVKEY EQU   BASNAME                                                  14110000
BASSERNO EQU   BASNAME+5                                                14111000
BASID    EQU   BASNAME+11                                               14112000
BASZERO  EQU   BASID+1                                                  14113000
BASFLAGA EQU   BASEV+14                                                 14114000
BASTYPE  EQU   BASFLAGA                                                 14115000
BASBASVR EQU   BASTYPE                                                  14116000
BASDLSF  EQU   BASFLAGA+2                                               14117000
BASGRPV  EQU   BASFLAGA+2                                               14118000
BASGENUS EQU   BASFLAGA+2                                               14119000
BASRSTD  EQU   BASFLAGA+2                                               14120000
BASINAC  EQU   BASFLAGA+2                                               14121000
BASBIND  EQU   BASFLAGA+2                                               14122000
BASEXCL  EQU   BASFLAGA+2                                               14123000
BASDAERA EQU   BASFLAGA+3                                               14124000
BASRONLY EQU   BASFLAGA+3                                               14125000
BASFIRST EQU   BASFLAGA+3                                               14126000
BASLAST  EQU   BASFLAGA+3                                               14127000
BASCPUID EQU   BASEV+18                                                 14128000
BASRCVYF EQU   BASEV+20                                                 14129000
BASSATIA EQU   BASRCVYF                                                 14130000
BASIVCRE EQU   BASSATIA                                                 14131000
BASIVCPY EQU   BASSATIA                                                 14132000
BASVSMIS EQU   BASSATIA                                                 14133000
BASMISCF EQU   BASRCVYF+2                                               14134000
BASHOLD  EQU   BASMISCF                                                 14135000
BASCSN1  EQU   BASEV+24                                                 14136000
BASLIB1  EQU   BASEV+36                                                 14137000
BASLID1  EQU   BASLIB1                                                  14138000
BASCSN2  EQU   BASEV+37                                                 14139000
BASLIB2  EQU   BASEV+49                                                 14140000
BASLID2  EQU   BASLIB2                                                  14141000
BASPREV  EQU   BASEV+50                                                 14142000
BASNEXTV EQU   BASEV+56                                                 14143000
BASNCOPY EQU   BASEV+62                                                 14144000
BASNBKUP EQU   BASEV+63                                                 14145000
BASBKLMT EQU   BASEV+64                                                 14146000
BASFRESP EQU   BASEV+68                                                 14147000
BASLEXT  EQU   BASEV+70                                                 14148000
BASFREXT EQU   BASEV+72                                                 14149000
BASKLCPY EQU   BASEV+76                                                 14150000
BASCOPID EQU   BASKLCPY+11                                              14151000
BASEXPDT EQU   BASEV+96                                                 14152000
BASDTREM EQU   BASEV+100                                                14153000
BASDESCR EQU   BASEV+104                                                14154000
BASOWNER EQU   BASEV+134                                                14155000
BASDEST  EQU   BASEV+144                                                14156000
BASRECOV EQU   BASEV+174                                                14157000
BASGROUP EQU   BASEV+180                                                14158000
COPYV    EQU   0                                                        14159000
COPNAME  EQU   COPYV                                                    14160000
COPV     EQU   COPNAME                                                  14161000
COPSERNO EQU   COPNAME+5                                                14162000
COPID    EQU   COPNAME+11                                               14163000
COPFLAGA EQU   COPYV+14                                                 14164000
COPTYPE  EQU   COPFLAGA                                                 14165000
COPBKUP  EQU   COPFLAGA+2                                               14166000
COPRCVYF EQU   COPYV+20                                                 14167000
COPSATIA EQU   COPRCVYF                                                 14168000
COPIVCPY EQU   COPSATIA                                                 14169000
COPMISCF EQU   COPRCVYF+2                                               14170000
COPHOLD  EQU   COPMISCF                                                 14171000
COPLIB1  EQU   COPYV+36                                                 14172000
COPLID1  EQU   COPLIB1                                                  14173000
COPLIB2  EQU   COPYV+49                                                 14174000
COPLID2  EQU   COPLIB2                                                  14175000
COPDATE  EQU   COPYV+50                                                 14176000
DUPV     EQU   0                                                        14177000
DUPNAME  EQU   DUPV                                                     14178000
DUPD     EQU   DUPNAME                                                  14179000
DUPSERNO EQU   DUPNAME+5                                                14180000
DUPID    EQU   DUPNAME+11                                               14181000
DUPFLAGA EQU   DUPV+14                                                  14182000
DUPTYPE  EQU   DUPFLAGA                                                 14183000
DUPRCVYF EQU   DUPV+20                                                  14184000
DUPCSN1  EQU   DUPV+24                                                  14185000
DUPLIB1  EQU   DUPV+36                                                  14186000
DUPLID1  EQU   DUPLIB1                                                  14187000
DUPCSN2  EQU   DUPV+37                                                  14188000
DUPLIB2  EQU   DUPV+49                                                  14189000
DUPLID2  EQU   DUPLIB2                                                  14190000
INDEX    EQU   0                                                        14191000
INDNAME  EQU   INDEX                                                    14192000
INDI     EQU   INDNAME                                                  14193000
INDTYPE  EQU   INDEX+13                                                 14194000
INDRECKY EQU   INDEX+15                                                 14195000
INDPREFX EQU   INDRECKY                                                 14196000
INDVSRNO EQU   INDRECKY+5                                               14197000
INDRECID EQU   INDRECKY+11                                              14198000
INDEXREC EQU   INDRECID+1                                               14199000
CPUID    EQU   0                                                        14200000
CPUTYPE  EQU   CPUID+18                                                 14201000
CPUMAP   EQU   CPUID+20                                                 14202000
RVR      EQU   0                                                        14203000
RVRCODE  EQU   RVR+4                                                    14204000
RVROPCD  EQU   RVRCODE                                                  14205000
RVRVOLID EQU   RVR+8                                                    14206000
RVRCPYID EQU   RVR+15                                                   14207000
RVRFLAGA EQU   RVR+16                                                   14208000
RVRBASEV EQU   RVRFLAGA                                                 14209000
RVRCOPYV EQU   RVRFLAGA                                                 14210000
MGP      EQU   0                                                        14211000
MGPCODE  EQU   MGP+4                                                    14212000
MGPGROUP EQU   MGP+8                                                    14213000
MGPOWNER EQU   MGP+16                                                   14214000
MGPRI    EQU   MGP+26                                                   14215000
MGPSEC   EQU   MGP+28                                                   14216000
MGPRETPD EQU   MGP+30                                                   14217000
MGPTHOLD EQU   MGP+32                                                   14218000
MGPCONUS EQU   MGP+33                                                   14219000
MGPRESSP EQU   MGP+34                                                   14220000
MGPDESCR EQU   MGP+36                                                   14221000
MGPADDR  EQU   MGP+66                                                   14222000
MGPFLAGA EQU   MGP+96                                                   14223000
MGPRLSE  EQU   MGPFLAGA                                                 14224000
MGPNRLSE EQU   MGPFLAGA                                                 14225000
MGPBIND  EQU   MGPFLAGA                                                 14226000
MGPNBIND EQU   MGPFLAGA                                                 14227000
MGPEXCL  EQU   MGPFLAGA                                                 14228000
MGPSHARE EQU   MGPFLAGA                                                 14229000
MGPRONLY EQU   MGPFLAGA                                                 14230000
MGPRW    EQU   MGPFLAGA                                                 14231000
MGPDERAS EQU   MGPFLAGA+1                                               14232000
MGPNDERA EQU   MGPFLAGA+1                                               14233000
MGPFLOWN EQU   MGPFLAGA+1                                               14234000
MGPFLPRI EQU   MGPFLAGA+1                                               14235000
MGPFLSEC EQU   MGPFLAGA+1                                               14236000
MGPFLTHO EQU   MGPFLAGA+1                                               14237000
MGPFLRET EQU   MGPFLAGA+1                                               14238000
MGPFLDES EQU   MGPFLAGA+2                                               14239000
MGPFLADD EQU   MGPFLAGA+2                                               14240000
MGPNTHLD EQU   MGPFLAGA+2                                               14241000
MGPNOWNR EQU   MGPFLAGA+2                                               14242000
MGPNRETP EQU   MGPFLAGA+2                                               14243000
MGPNDESC EQU   MGPFLAGA+2                                               14244000
MGPNADDR EQU   MGPFLAGA+2                                               14245000
MGPFLCON EQU   MGPFLAGA+2                                               14246000
MGPFLRES EQU   MGPFLAGA+3                                               14247000
SGP      EQU   0                                                        14248000
SGPCODE  EQU   SGP+4                                                    14249000
SGPGROUP EQU   SGP+8                                                    14250000
RVVI     EQU   0                                                        14251000
RVVOPCOD EQU   RVVI+4                                                   14252000
RVVOLUME EQU   RVVI+8                                                   14253000
RVVGROUP EQU   RVVI+14                                                  14254000
RVVARLN  EQU   RVVI+22                                                  14255000
RVVAREA  EQU   RVVI+24                                                  14256000
RVVBUFLN EQU   RVVI+30                                                  14257000
RVVEXPIR EQU   RVVI+36                                                  14258000
RVVCDATE EQU   RVVI+38                                                  14259000
RVVRDSEQ EQU   RVVI+43                                                  14260000
RVVRDCSN EQU   RVVI+44                                                  14261000
RVVCPYID EQU   RVVI+56                                                  14262000
RVVDUPID EQU   RVVI+57                                                  14263000
RVVFLAGA EQU   RVVI+58                                                  14264000
RVVRMODE EQU   RVVFLAGA                                                 14265000
RVVRDR   EQU   RVVRMODE                                                 14266000
RVVRDNR  EQU   RVVRMODE                                                 14267000
RVVRDCH  EQU   RVVRMODE                                                 14268000
RVVCHAIN EQU   RVVFLAGA+1                                               14269000
RVVGPVOL EQU   RVVCHAIN                                                 14270000
RVVNGVOL EQU   RVVCHAIN                                                 14271000
RVVRDRCD EQU   RVVFLAGA+2                                               14272000
RVVBVRCD EQU   RVVRDRCD                                                 14273000
RVVGRPRC EQU   RVVRDRCD                                                 14274000
RVVCPYRC EQU   RVVRDRCD                                                 14275000
RVVDUPRC EQU   RVVRDRCD                                                 14276000
RVVRUNKN EQU   RVVRDRCD                                                 14277000
RVVCIRCD EQU   RVVRDRCD                                                 14278000
RVVCPURC EQU   RVVRDRCD                                                 14279000
RVVALL   EQU   RVVRDRCD                                                 14280000
RVVRTEST EQU   RVVFLAGA+3                                               14281000
RVVEXPDT EQU   RVVRTEST                                                 14282000
RVVTHOLD EQU   RVVRTEST                                                 14283000
RVVGSVOL EQU   RVVRTEST                                                 14284000
RVVRSTD  EQU   RVVRTEST                                                 14285000
RVVINACT EQU   RVVRTEST                                                 14286000
RVVACTV  EQU   RVVRTEST                                                 14287000
RVVDVOL  EQU   RVVRTEST                                                 14288000
RVVBPLHD EQU   RVVRTEST                                                 14289000
RVVCPYTP EQU   RVVFLAGA+4                                               14290000
RVVLBKUP EQU   RVVCPYTP                                                 14291000
RVVOBKUP EQU   RVVCPYTP                                                 14292000
RVVLCOPY EQU   RVVCPYTP                                                 14293000
RVVCPLHD EQU   RVVCPYTP                                                 14294000
RVVSPEC  EQU   RVVFLAGA+5                                               14295000
RVVSGRP  EQU   RVVSPEC                                                  14296000
RVVSDTE  EQU   RVVSPEC                                                  14297000
RVVSSEQ  EQU   RVVSPEC                                                  14298000
RVVSCSN  EQU   RVVSPEC                                                  14299000
RVVSCPY  EQU   RVVSPEC                                                  14300000
RVVSDUP  EQU   RVVSPEC                                                  14301000
RVVSVOL  EQU   RVVSPEC                                                  14302000
MVR      EQU   0                                                        14303000
MVRCODE  EQU   MVR+4                                                    14304000
MVRFLAGA EQU   MVR+8                                                    14305000
MVRFLFOR EQU   MVRFLAGA                                                 14306000
MVRFLGRO EQU   MVRFLAGA                                                 14307000
MVRFLDES EQU   MVRFLAGA                                                 14308000
MVRFLTO  EQU   MVRFLAGA                                                 14309000
MVRFLCSN EQU   MVRFLAGA                                                 14310000
MVRFLBK  EQU   MVRFLAGA                                                 14311000
MVRFLLAB EQU   MVRFLAGA                                                 14312000
MVRGEN   EQU   MVRFLAGA+1                                               14313000
MVRRSTD  EQU   MVRFLAGA+1                                               14314000
MVRNGRP  EQU   MVRFLAGA+1                                               14315000
MVRBKUP  EQU   MVRFLAGA+1                                               14316000
MVRNDESC EQU   MVRFLAGA+1                                               14317000
MVRNEXPD EQU   MVRFLAGA+1                                               14318000
MVRSLMIS EQU   MVRFLAGA+1                                               14319000
MVRCLMIS EQU   MVRFLAGA+1                                               14320000
MVRCIVCF EQU   MVRFLAGA+2                                               14321000
MVRCICPY EQU   MVRFLAGA+2                                               14322000
MVRBVOL  EQU   MVR+12                                                   14323000
MVRFOR   EQU   MVR+18                                                   14324000
MVRGROUP EQU   MVR+20                                                   14325000
MVRDES   EQU   MVR+28                                                   14326000
MVRTO    EQU   MVR+58                                                   14327000
MVRCSN   EQU   MVR+62                                                   14328000
MVRBKUPN EQU   MVR+74                                                   14329000
MVRLABEL EQU   MVR+76                                                   14330000
BUFFER   EQU   0                                                        14331000
DUPVDBR  EQU   0                                                        14332000
BASEVDBR EQU   0                                                        14333000
RPLVDBR  EQU   0                                                        14334000
FLAGDBR  EQU   0                                                        14335000
SPREVDBR EQU   0                                                        14336000
SNEXTDBR EQU   0                                                        14337000
GRPEXT   EQU   0                                                        14338000
BASEXT   EQU   0                                                        14339000
RPLVEXT  EQU   0                                                        14340000
FLAGEXT  EQU   0                                                        14341000
NOSAVE   EQU   0                                                        14342000
FOR      EQU   0                                                        14343000
EXPDATE  EQU   0                                                        14344000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    14345000
@NM00050 EQU   MVR+82                                                   14346000
MVRBLNK1 EQU   MVR+75                                                   14347000
@NM00049 EQU   MVRFLAGA+2                                               14348000
MVRFLBAS EQU   MVRFLAGA                                                 14349000
@NM00048 EQU   MVRCODE+1                                                14350000
MVROPCD  EQU   MVRCODE                                                  14351000
MVRLNGTH EQU   MVR                                                      14352000
@NM00047 EQU   RVVI+64                                                  14353000
RVVSEXP  EQU   RVVSPEC                                                  14354000
@NM00046 EQU   RVVCPYTP                                                 14355000
@NM00045 EQU   RVVCHAIN                                                 14356000
@NM00044 EQU   RVVRMODE                                                 14357000
RVVBLNK1 EQU   RVVI+42                                                  14358000
RVVRTBUF EQU   RVVI+32                                                  14359000
@NM00043 EQU   RVVI+28                                                  14360000
@NM00042 EQU   RVVOPCOD+1                                               14361000
RVVCODE  EQU   RVVOPCOD                                                 14362000
RVVLNGTH EQU   RVVI                                                     14363000
@NM00041 EQU   SGP+16                                                   14364000
@NM00040 EQU   SGPCODE+1                                                14365000
SGPOPCD  EQU   SGPCODE                                                  14366000
SGPLNGTH EQU   SGP                                                      14367000
@NM00039 EQU   MGP+100                                                  14368000
@NM00038 EQU   MGPFLAGA+3                                               14369000
MGPFLGRO EQU   MGPFLAGA+1                                               14370000
@NM00037 EQU   MGP+35                                                   14371000
@NM00036 EQU   MGPCODE+1                                                14372000
MGPOPCD  EQU   MGPCODE                                                  14373000
MGPLNGTH EQU   MGP                                                      14374000
@NM00035 EQU   RVR+20                                                   14375000
@NM00034 EQU   RVRFLAGA                                                 14376000
RVRBLNK1 EQU   RVR+14                                                   14377000
@NM00033 EQU   RVRCODE+1                                                14378000
RVRLNGTH EQU   RVR                                                      14379000
@NM00032 EQU   CPUID+150                                                14380000
CPUPURGE EQU   CPUID+148                                                14381000
CPUMASK  EQU   CPUMAP+6                                                 14382000
@NM00031 EQU   CPUMAP+5                                                 14383000
CPUIDREC EQU   CPUMAP                                                   14384000
CPURES2  EQU   CPUTYPE                                                  14385000
CPUASSOC EQU   CPUTYPE                                                  14386000
CPURES1  EQU   CPUTYPE                                                  14387000
CPUDNEXT EQU   CPUID+16                                                 14388000
CPUINEXT EQU   CPUID+14                                                 14389000
@NM00030 EQU   CPUID+13                                                 14390000
CPUNAME  EQU   CPUID                                                    14391000
@NM00029 EQU   INDEX+28                                                 14392000
INDBLNK2 EQU   INDRECID                                                 14393000
INDBLNK1 EQU   INDPREFX+1                                               14394000
INDALPHA EQU   INDPREFX                                                 14395000
INDRES2  EQU   INDTYPE                                                  14396000
INDINDEX EQU   INDTYPE                                                  14397000
INDRES1  EQU   INDTYPE                                                  14398000
INDSERNO EQU   INDNAME+1                                                14399000
@NM00028 EQU   DUPV+50                                                  14400000
DUP2BIT2 EQU   DUPLID2                                                  14401000
DUP2BIT1 EQU   DUPLID2                                                  14402000
DUPRES4  EQU   DUPLIB2                                                  14403000
DUP1BIT2 EQU   DUPLID1                                                  14404000
DUP1BIT1 EQU   DUPLID1                                                  14405000
DUPRES3  EQU   DUPLIB1                                                  14406000
DUPMISCF EQU   DUPRCVYF+2                                               14407000
DUPSATIA EQU   DUPRCVYF                                                 14408000
@NM00027 EQU   DUPV+18                                                  14409000
@NM00026 EQU   DUPFLAGA+2                                               14410000
DUPRES2  EQU   DUPTYPE                                                  14411000
DUPDUPLR EQU   DUPTYPE                                                  14412000
DUPRES1  EQU   DUPTYPE                                                  14413000
DUPRES5  EQU   DUPV+13                                                  14414000
DUPNO    EQU   DUPID+1                                                  14415000
DUPBLANK EQU   DUPID                                                    14416000
@NM00025 EQU   COPYV+136                                                14417000
COPFREXT EQU   COPYV+132                                                14418000
COPLEXT  EQU   COPYV+130                                                14419000
COPFRESP EQU   COPYV+128                                                14420000
COPOWNER EQU   COPYV+118                                                14421000
COPDEST  EQU   COPYV+88                                                 14422000
COPDESCR EQU   COPYV+58                                                 14423000
COPDTREM EQU   COPYV+54                                                 14424000
COP2BIT2 EQU   COPLID2                                                  14425000
COP2BIT1 EQU   COPLID2                                                  14426000
COPRES5  EQU   COPLIB2                                                  14427000
COPCSN2  EQU   COPYV+37                                                 14428000
COP1BIT2 EQU   COPLID1                                                  14429000
COP1BIT1 EQU   COPLID1                                                  14430000
COPRES4  EQU   COPLIB1                                                  14431000
COPCSN1  EQU   COPYV+24                                                 14432000
@NM00024 EQU   COPMISCF                                                 14433000
COPRES3  EQU   COPSATIA                                                 14434000
COPVSMIS EQU   COPSATIA                                                 14435000
COPIVCRE EQU   COPSATIA                                                 14436000
@NM00023 EQU   COPYV+18                                                 14437000
@NM00022 EQU   COPFLAGA+3                                               14438000
COPDLSPF EQU   COPFLAGA+3                                               14439000
COPRONLY EQU   COPFLAGA+3                                               14440000
COPDAERA EQU   COPFLAGA+2                                               14441000
COPEXCL  EQU   COPFLAGA+2                                               14442000
COPBIND  EQU   COPFLAGA+2                                               14443000
COPRSTD  EQU   COPFLAGA+2                                               14444000
COPGENUS EQU   COPFLAGA+2                                               14445000
COPVSAM  EQU   COPFLAGA+2                                               14446000
COPGROUP EQU   COPFLAGA+2                                               14447000
COPRES2  EQU   COPTYPE                                                  14448000
COPCOPYV EQU   COPTYPE                                                  14449000
COPRES1  EQU   COPTYPE                                                  14450000
COPRES6  EQU   COPYV+13                                                 14451000
COPNO    EQU   COPID+1                                                  14452000
COPBLANK EQU   COPID                                                    14453000
@NM00021 EQU   BASEV+192                                                14454000
BASXPDT2 EQU   BASEV+188                                                14455000
BASDLMTD EQU   BASEV+92                                                 14456000
BASRES6  EQU   BASEV+89                                                 14457000
BASCOPNO EQU   BASCOPID+1                                               14458000
BASCOPBK EQU   BASCOPID                                                 14459000
BASCOPSN EQU   BASKLCPY+5                                               14460000
BASCOPV  EQU   BASKLCPY                                                 14461000
@NM00020 EQU   BASEV+65                                                 14462000
BAS2BIT2 EQU   BASLID2                                                  14463000
BAS2BIT1 EQU   BASLID2                                                  14464000
BASRES5  EQU   BASLIB2                                                  14465000
BAS1BIT2 EQU   BASLID1                                                  14466000
BAS1BIT1 EQU   BASLID1                                                  14467000
BASRES4  EQU   BASLIB1                                                  14468000
BASRES3  EQU   BASMISCF                                                 14469000
BASRES8  EQU   BASSATIA                                                 14470000
@NM00019 EQU   BASFLAGA+3                                               14471000
BASREASS EQU   BASFLAGA+3                                               14472000
BASNOCPY EQU   BASFLAGA+2                                               14473000
BASRES2  EQU   BASTYPE                                                  14474000
BASRES1  EQU   BASTYPE                                                  14475000
BASRES7  EQU   BASEV+13                                                 14476000
BASBLANK EQU   BASID                                                    14477000
@NM00018 EQU   GVSVOLFL+2                                               14478000
@NM00017 EQU   GVSHDR+20                                                14479000
@NM00016 EQU   GVSHDR+17                                                14480000
@NM00015 EQU   GVSFLAGA+2                                               14481000
@NM00014 EQU   GVSTYPE                                                  14482000
@NM00013 EQU   GVSTYPE                                                  14483000
GVSNO    EQU   GVSID+1                                                  14484000
GVSRES1  EQU   GVSID                                                    14485000
GVSG     EQU   GVSNAME                                                  14486000
@NM00012 EQU   GROUP+136                                                14487000
GROERRTM EQU   GROERRTS+4                                               14488000
GROERRDT EQU   GROERRTS                                                 14489000
GROFREXT EQU   GROUP+48                                                 14490000
@NM00011 EQU   GROFLAGA+2                                               14491000
GROMSG1  EQU   GROFLAGA+2                                               14492000
GRORES1  EQU   GROTYPE                                                  14493000
GROBLANK EQU   GROID                                                    14494000
BCD2BIT2 EQU   BCDLID2                                                  14495000
BCD2BIT1 EQU   BCDLID2                                                  14496000
BCDRES8  EQU   BCDLIB2                                                  14497000
BCD1BIT2 EQU   BCDLID1                                                  14498000
BCD1BIT1 EQU   BCDLID1                                                  14499000
BCDRE10  EQU   BCDLIB1                                                  14500000
BCDRES7A EQU   BCDMISCF                                                 14501000
BCDRES7  EQU   BCDSATIA                                                 14502000
BCDVSMIS EQU   BCDSATIA                                                 14503000
BCDIVCPY EQU   BCDSATIA                                                 14504000
BCDIVCRE EQU   BCDSATIA                                                 14505000
BCDCPUID EQU   BCDV+18                                                  14506000
BCDRES5  EQU   BCDFLAGB+1                                               14507000
BCDREASS EQU   BCDFLAGB+1                                               14508000
BCDRES4  EQU   BCDFLAGB                                                 14509000
BCDRES3  EQU   BCDTYPE                                                  14510000
BCDDUP   EQU   BCDTYPE                                                  14511000
BCDRES2  EQU   BCDTYPE                                                  14512000
BCDCOPY  EQU   BCDTYPE                                                  14513000
BCDBASE  EQU   BCDTYPE                                                  14514000
BCDRES1  EQU   BCDTYPE                                                  14515000
BCDRES9  EQU   BCDV+13                                                  14516000
BCDINDEX EQU   BCDID+1                                                  14517000
BCDBLNK2 EQU   BCDID                                                    14518000
BCDSERNO EQU   BCDNAME+5                                                14519000
BCDBLNK1 EQU   BCDPREFX+1                                               14520000
BCDALPHA EQU   BCDPREFX                                                 14521000
@NM00010 EQU   NGVR+32                                                  14522000
@NM00009 EQU   NGVR+29                                                  14523000
NGVLVOL  EQU   NGVR+23                                                  14524000
@NM00008 EQU   NGVR+15                                                  14525000
NGVRES2  EQU   NGVRTYPE+1                                               14526000
NGVHDR   EQU   NGVRTYPE                                                 14527000
NGVRES1  EQU   NGVRTYPE                                                 14528000
NGVNAME  EQU   NGVR                                                     14529000
VVIUNUSD EQU   VVICB+116                                                14530000
VVINUSDC EQU   VVICB+112                                                14531000
VVITPFCH EQU   VVICB+108                                                14532000
VVIDVMEL EQU   VVICB+104                                                14533000
VVIVBSTF EQU   VVICB+100                                                14534000
VVISSOBA EQU   VVICB+96                                                 14535000
VVIVSCRA EQU   VVICB+92                                                 14536000
VVISTPTB EQU   VVICB+88                                                 14537000
VVIDVMTA EQU   VVICB+84                                                 14538000
VVIJUCB  EQU   VVICB+80                                                 14539000
VVIIUCB  EQU   VVICB+76                                                 14540000
VVIRES6  EQU   VVICB+72                                                 14541000
VVIRES5  EQU   VVICB+68                                                 14542000
VVIRES4  EQU   VVICB+64                                                 14543000
VVIUCB   EQU   VVICB+60                                                 14544000
VVIVJL   EQU   VVICB+56                                                 14545000
VVIVRR   EQU   VVICB+52                                                 14546000
VVIQLSPL EQU   VVICB+48                                                 14547000
VVIQRPL2 EQU   VVICB+44                                                 14548000
VVIQRPL1 EQU   VVICB+40                                                 14549000
VVIRES3  EQU   VVICB+36                                                 14550000
VVIVQMP  EQU   VVICB+32                                                 14551000
VVIECB1  EQU   VVICB+28                                                 14552000
VVICATAD EQU   VVICB+24                                                 14553000
VVIDCBAD EQU   VVICB+20                                                 14554000
VVIACBAD EQU   VVICB+16                                                 14555000
VVIFLG7  EQU   VVIFLGA                                                  14556000
VVIFLG6  EQU   VVIFLGA                                                  14557000
VVIFLG5  EQU   VVIFLGA                                                  14558000
VVIFLG4  EQU   VVIFLGA                                                  14559000
VVIFLG3  EQU   VVIFLGA                                                  14560000
VVIFLG1  EQU   VVIFLGA                                                  14561000
VVIALCON EQU   VVICB+14                                                 14562000
VVICPUID EQU   VVICB+12                                                 14563000
VVIUCAT  EQU   VVICB+4                                                  14564000
VVICID   EQU   VVICB                                                    14565000
@NM00007 EQU   RPLVSAM+44                                               14566000
@NM00006 EQU   RPLVOPT                                                  14567000
@NM00005 EQU   RPLVOPT                                                  14568000
@NM00004 EQU   RPLVSAM+28                                               14569000
RPLVACB  EQU   RPLVSAM+24                                               14570000
@NM00003 EQU   RPLVSAM+3                                                14571000
@NM00002 EQU   RPLVSAM                                                  14572000
@NM00001 EQU   RPLV+42                                                  14573000
RPLRMSCC EQU   RPLV+36                                                  14574000
RPLVTLEN EQU   RPLV+30                                                  14575000
RPLVRES1 EQU   RPLFLAGA+1                                               14576000
RPLVVOP  EQU   RPLFLAGA                                                 14577000
RPLVVIN  EQU   RPLFLAGA                                                 14578000
RPLVCOMP EQU   RPLFLAGA                                                 14579000
RPLVPROG EQU   RPLFLAGA                                                 14580000
RPLVPOST EQU   RPLFLAGA                                                 14581000
RPLFTIME EQU   RPLFLAGA                                                 14582000
RPLVRSV3 EQU   RPLV+24                                                  14583000
RPLVRSV2 EQU   RPLV+20                                                  14584000
RPLVRSV1 EQU   RPLV+16                                                  14585000
RPLASCBP EQU   RPLTCBPR                                                 14586000
RPLVECB  EQU   RPLV+4                                                   14587000
RPLVQPTR EQU   RPLV                                                     14588000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      14589000
@RF00189 EQU   @EL00001                                                 14590000
@RF00191 EQU   @EL00001                                                 14591000
@RF00199 EQU   @EL00001                                                 14592000
@RF00201 EQU   @EL00001                                                 14593000
@RF00209 EQU   @EL00001                                                 14594000
@RF00211 EQU   @EL00001                                                 14595000
@RF00219 EQU   @EL00001                                                 14596000
@RF00221 EQU   @EL00001                                                 14597000
@RF00229 EQU   @EL00001                                                 14598000
@RF00231 EQU   @EL00001                                                 14599000
@RT00249 EQU   @EL00002                                                 14600000
@RT00448 EQU   @EL00004                                                 14601000
@RT00453 EQU   @EL00004                                                 14602000
@RF00456 EQU   @EL00004                                                 14603000
@RT00464 EQU   @EL00005                                                 14604000
@RT00511 EQU   @EL00006                                                 14605000
@RT00685 EQU   @EL00009                                                 14606000
@RF00716 EQU   @RC00709                                                 14607000
@RT00726 EQU   @EL00009                                                 14608000
@RF00742 EQU   @EL00009                                                 14609000
@RF00770 EQU   @EL00009                                                 14610000
@RT00786 EQU   @EL00010                                                 14611000
@RT00818 EQU   @EL00010                                                 14612000
@RF00815 EQU   @EL00010                                                 14613000
@RF00873 EQU   @EL00011                                                 14614000
@RT00907 EQU   @EL00012                                                 14615000
@RT00935 EQU   @EL00012                                                 14616000
@RF00969 EQU   @EL00012                                                 14617000
@RT01071 EQU   @EL00014                                                 14618000
@RF01056 EQU   @RC01053                                                 14619000
@RF01068 EQU   @RC01053                                                 14620000
@RT01111 EQU   @EL00014                                                 14621000
@RF01095 EQU   @RC01092                                                 14622000
@RT01254 EQU   @EL00016                                                 14623000
@RT01286 EQU   @EL00017                                                 14624000
@RT01339 EQU   @EL00018                                                 14625000
@RT01380 EQU   @EL00019                                                 14626000
@RT01382 EQU   @EL00019                                                 14627000
@RF01411 EQU   @RC01409                                                 14628000
@RT01444 EQU   @EL00019                                                 14629000
@RT01493 EQU   @EL00020                                                 14630000
@RT01497 EQU   @EL00020                                                 14631000
@RT01527 EQU   @EL00021                                                 14632000
@RT01542 EQU   @EL00021                                                 14633000
@RT01580 EQU   @EL00022                                                 14634000
@RT01594 EQU   @EL00022                                                 14635000
@RC01575 EQU   @RC01573                                                 14636000
@RT01675 EQU   @EL00024                                                 14637000
@RT01689 EQU   @EL00024                                                 14638000
@RC01665 EQU   @RC01663                                                 14639000
@RT01756 EQU   @EL00026                                                 14640000
@RC01776 EQU   @RC01774                                                 14641000
@RT01804 EQU   @EL00026                                                 14642000
@RT01844 EQU   @EL00027                                                 14643000
@RT01898 EQU   @EL00028                                                 14644000
@RT01937 EQU   @EL00029                                                 14645000
@RT01976 EQU   @EL00030                                                 14646000
@RT02029 EQU   @EL00031                                                 14647000
@RT02047 EQU   @EL00031                                                 14648000
@RT02151 EQU   @EL00034                                                 14649000
@RT02161 EQU   @EL00034                                                 14650000
@RF02190 EQU   @EL00036                                                 14651000
@RC02203 EQU   @EL00037                                                 14652000
@RF02234 EQU   @RC02232                                                 14653000
@RT02318 EQU   @EL00038                                                 14654000
@RC02343 EQU   @RC02341                                                 14655000
@RT02380 EQU   @EL00038                                                 14656000
@RT02385 EQU   @EL00038                                                 14657000
@RT02389 EQU   @EL00038                                                 14658000
@RT02398 EQU   @EL00038                                                 14659000
@RT02401 EQU   @EL00038                                                 14660000
@RT02413 EQU   @EL00038                                                 14661000
@RT02424 EQU   @EL00038                                                 14662000
@RF02504 EQU   @EL00039                                                 14663000
@RF02533 EQU   @EL00039                                                 14664000
@RF02536 EQU   @EL00039                                                 14665000
@RF02631 EQU   @EL00040                                                 14666000
@RF02713 EQU   @EL00041                                                 14667000
@RF02720 EQU   @EL00042                                                 14668000
@RF02788 EQU   @EL00044                                                 14669000
@RC02816 EQU   @RC02814                                                 14670000
@RF02875 EQU   @EL00045                                                 14671000
@RF02883 EQU   @EL00046                                                 14672000
@RC02885 EQU   @EL00046                                                 14673000
@RT02946 EQU   @RC02943                                                 14674000
@RF02959 EQU   @RC02943                                                 14675000
@RF03031 EQU   @EL00047                                                 14676000
@RF03073 EQU   @EL00050                                                 14677000
@RT03163 EQU   @EL00051                                                 14678000
@RT03270 EQU   @EL00052                                                 14679000
@RT03297 EQU   @EL00052                                                 14680000
@RT03302 EQU   @EL00052                                                 14681000
@RT03323 EQU   @EL00052                                                 14682000
@RT03328 EQU   @EL00052                                                 14683000
@RT03356 EQU   @EL00053                                                 14684000
@RF03358 EQU   @EL00053                                                 14685000
@RT03392 EQU   @EL00055                                                 14686000
@RT03412 EQU   @EL00055                                                 14687000
@RF03414 EQU   @EL00055                                                 14688000
@RT03433 EQU   @EL00055                                                 14689000
@RF03435 EQU   @EL00055                                                 14690000
@RT03445 EQU   @EL00055                                                 14691000
@RT03450 EQU   @EL00055                                                 14692000
@RT03467 EQU   @EL00055                                                 14693000
@RT03476 EQU   @EL00055                                                 14694000
@RF03453 EQU   @EL00055                                                 14695000
@RC03514 EQU   @RC03512                                                 14696000
@RF03533 EQU   @EL00056                                                 14697000
@RC01668 EQU   @RC01665                                                 14698000
@RC02345 EQU   @RC02343                                                 14699000
@RC02818 EQU   @RC02816                                                 14700000
@RF02906 EQU   @RC02885                                                 14701000
@RC01670 EQU   @RC01668                                                 14702000
@RC02347 EQU   @RC02345                                                 14703000
@RC02820 EQU   @RC02818                                                 14704000
@ENDDATA EQU   *                                                        14705000
         END   ICBVUT01,(C'PLS0930',0603,77062)                         14706000
./  ADD  SSI=62800273,NAME=ICBVUT03
         TITLE 'ICBVUT03 - NULLIFYC SERVICE AID (JULY 1, 1975) MVS     *00001000
                        '                                               00002000
ICBVUT03 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVUT03  76.280'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*   RPLVPTR=RG1;                    /* SET RPLV ADDR         @Z40LB25*/ 00018000
         LR    RPLVPTR,RG1                                         0091 00019000
*   RESPECIFY                                                      0092 00020000
*     RG1 UNRSTD;                   /* FREE REG1             @Z40LB25*/ 00021000
*   VVIPTR=RPLVVICB;                /* ADDR TO MSVCB         @Z40LB25*/ 00022000
         L     VVIPTR,RPLVVICB(,RPLVPTR)                           0093 00023000
*   GROUPPTR=ADDR(GROUPBUF);        /* ADDR GRP BUF          @Z40LB25*/ 00024000
         LA    GROUPPTR,GROUPBUF                                   0094 00025000
*   NGVRPTR=ADDR(NGVRBUF);          /* ADDR NON-GRP BUF      @Z40LB25*/ 00026000
         LA    NGVRPTR,NGVRBUF                                     0095 00027000
*   COPYVPTR=ADDR(COPYBUF);         /* ADDR CVR BUF          @Z40LB25*/ 00028000
         LA    COPYVPTR,COPYBUF                                    0096 00029000
*   BASEVPTR=ADDR(BASEBUF);         /* ADDR BVR BUF          @Z40LB25*/ 00030000
         LA    BASEVPTR,BASEBUF                                    0097 00031000
*   INDEXPTR=ADDR(INDEXBUF);        /* ADDR CIR BUF          @Z40LB25*/ 00032000
         LA    INDEXPTR,INDEXBUF                                   0098 00033000
*   DUPVPTR=ADDR(DUPVBUF);          /* ADDR DUP BUF          @Z40LB25*/ 00034000
         LA    DUPVPTR,DUPVBUF                                     0099 00035000
*   PTRRPLV=RPLVPTR;                /* RPLV PTR PARM         @Z40LB25*/ 00036000
         ST    RPLVPTR,PTRRPLV                                     0100 00037000
*   PTRGROUP=GROUPPTR;              /* GHR PTR PARM          @Z40LB25*/ 00038000
         ST    GROUPPTR,PTRGROUP                                   0101 00039000
*   PTRNGVR=NGVRPTR;                /* NGHR PTR PARM         @Z40LB25*/ 00040000
         LR    PTRNGVR,NGVRPTR                                     0102 00041000
*   PTRCOPYV=COPYVPTR;              /* CVR PTR PARM          @Z40LB25*/ 00042000
         ST    COPYVPTR,PTRCOPYV                                   0103 00043000
*   PTRBASEV=BASEVPTR;              /* BVR PTR PARM          @Z40LB25*/ 00044000
         ST    BASEVPTR,PTRBASEV                                   0104 00045000
*   PTRDUPV=DUPVPTR;                /* DVR PTR PARM          @Z40LB25*/ 00046000
         ST    DUPVPTR,PTRDUPV                                     0105 00047000
*   NULCPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBNULLC      @Z40LB25*/ 00048000
         LA    NULCPTR,RPLVUTIL(,RPLVPTR)                          0106 00049000
*   WORKAREA=WORKAREA&&WORKAREA;    /* ZERO WORK AREA        @Z40LB25*/ 00050000
         XC    WORKAREA(19),WORKAREA                               0107 00051000
*   CIDKY=IDONE;                    /* CVR ID TO 1           @Z40LB25*/ 00052000
         MVI   CIDKY,X'01'                                         0108 00053000
*   DIDKY=IDONE;                    /* DVR ID TO 1           @Z40LB25*/ 00054000
*                                                                  0109 00055000
         MVI   DIDKY,X'01'                                         0109 00056000
*   /*****************************************************************/ 00057000
*   /*                                                               */ 00058000
*   /* CHECK FOR AN MSC ERROR.                               @Z40LB25*/ 00059000
*   /*                                                               */ 00060000
*   /*****************************************************************/ 00061000
*                                                                  0110 00062000
*   IF RPLRCODE¬=OKZERO             /* CONTINUE?             @Z40LB25*/ 00063000
*     THEN                          /* NO                    @Z40LB25*/ 00064000
         LH    @15,RPLRCODE(,RPLVPTR)                              0110 00065000
         N     @15,@CF00613                                        0110 00066000
         LTR   @15,@15                                             0110 00067000
         BZ    @RF00110                                            0110 00068000
*     DO;                           /*                       @Z40LB25*/ 00069000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Z40LB25*/ 00070000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0112 00071000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Z40LB25*/ 00072000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0113 00073000
*       RETURN;                     /*                       @Z40LB25*/ 00074000
@EL00001 L     @13,4(,@13)                                         0114 00075000
@EF00001 DS    0H                                                  0114 00076000
@ER00001 LM    @14,@12,12(@13)                                     0114 00077000
         BR    @14                                                 0114 00078000
*     END;                          /*                       @Z40LB25*/ 00079000
*                                                                  0115 00080000
*   /*****************************************************************/ 00081000
*   /*                                                               */ 00082000
*   /* CHECK FOR THE MSVC BEING DISABLED.                    @Z40LB25*/ 00083000
*   /*                                                               */ 00084000
*   /*****************************************************************/ 00085000
*                                                                  0116 00086000
*   IF VVIFLG0=ON                   /* MSVC DISABLED?        @Z40LB25*/ 00087000
*     THEN                          /* YES                   @Z40LB25*/ 00088000
@RF00110 TM    VVIFLG0(VVIPTR),B'10000000'                         0116 00089000
         BNO   @RF00116                                            0116 00090000
*     DO;                           /*                       @Z40LB25*/ 00091000
*       RPLVRETC=RETNCD4;           /* 4 ERROR RETN CODE     @Z40LB25*/ 00092000
         MVC   RPLVRETC(2,RPLVPTR),@CH00036                        0118 00093000
*       RPLRCODE=DISABLED;          /* 213 REASON CODE       @Z40LB25*/ 00094000
         MVC   RPLRCODE(2,RPLVPTR),@CB00527                        0119 00095000
*       RETURN;                     /*                       @Z40LB25*/ 00096000
         B     @EL00001                                            0120 00097000
*     END;                          /*                       @Z40LB25*/ 00098000
*                                                                  0121 00099000
*   /*****************************************************************/ 00100000
*   /*                                                               */ 00101000
*   /* JOURNAL THE RPLV AND RESERVE THE INVENTORY.           @Z40LB25*/ 00102000
*   /*                                                               */ 00103000
*   /*****************************************************************/ 00104000
*                                                                  0122 00105000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Z40LB25   00106000
*                                      RESERVE .MSVI         @Z40LB25*/ 00107000
*                                                                  0122 00108000
@RF00116 BAL   @14,HOUSKEEP                                        0122 00109000
*   /*****************************************************************/ 00110000
*   /*                                                               */ 00111000
*   /* GET THE MSVI RECORD - NONE IS OK.                     @Z40LB25*/ 00112000
*   /*                                                               */ 00113000
*   /*****************************************************************/ 00114000
*                                                                  0123 00115000
*   IF NULVOL=ON                    /* ACTIVE?               @Z40LB25*/ 00116000
*     THEN                          /* YES                   @Z40LB25*/ 00117000
*                                                                  0123 00118000
         TM    NULVOL(NULCPTR),B'10000000'                         0123 00119000
         BNO   @RF00123                                            0123 00120000
*     /***************************************************************/ 00121000
*     /*                                                             */ 00122000
*     /* GET THE BVR - ACTIVE.                               @Z40LB25*/ 00123000
*     /*                                                             */ 00124000
*     /***************************************************************/ 00125000
*                                                                  0124 00126000
*     DO;                           /*                       @Z40LB25*/ 00127000
*       BVOLKY=NULVOLID;            /* SET VOLID             @Z40LB25*/ 00128000
         MVC   BVOLKY(6),NULVOLID(NULCPTR)                         0125 00129000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Z40LB25*/ 00130000
         LA    @09,BKEY                                            0126 00131000
         ST    @09,RPLVKEY(,RPLVPTR)                               0126 00132000
*       CALL READUPD1;              /* READ BVR              @Z40LB25*/ 00133000
         BAL   @14,READUPD1                                        0127 00134000
*       IF RPLVRETC¬=OKZERO         /* ERROR?                @Z40LB25*/ 00135000
*         THEN                      /* YES                   @Z40LB25*/ 00136000
         LH    @09,RPLVRETC(,RPLVPTR)                              0128 00137000
         N     @09,@CF00613                                        0128 00138000
         LTR   @09,@09                                             0128 00139000
         BZ    @RF00128                                            0128 00140000
*         DO;                       /* CK ERROR              @Z40LB25*/ 00141000
*                                                                  0129 00142000
*           /*********************************************************/ 00143000
*           /*                                                       */ 00144000
*           /* NO RECORD FOUND IS OK.                        @Z40LB25*/ 00145000
*           /*                                                       */ 00146000
*           /*********************************************************/ 00147000
*                                                                  0130 00148000
*           IF RPLRCODE=NORECFND    /* NO RECD FND?          @Z40LB25*/ 00149000
*             THEN                  /* YES                   @Z40LB25*/ 00150000
         CLC   RPLRCODE(2,RPLVPTR),@CB00523                        0130 00151000
         BNE   @RF00130                                            0130 00152000
*             DO;                   /* OK                    @Z40LB25*/ 00153000
*               RPLRCODE=RPLRCODE&&RPLRCODE;/*               @Z40LB25   00154000
*                                      ZERO RESN CODE        @Z40LB25*/ 00155000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0132 00156000
*               RPLVRETC=RPLVRETC&&RPLVRETC;/*               @Z40LB25   00157000
*                                      ZERO RETN CODE        @Z40LB25*/ 00158000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0133 00159000
*             END;                  /*                       @Z40LB25*/ 00160000
*           RETURN;                 /*                       @Z40LB25*/ 00161000
         B     @EL00001                                            0135 00162000
*         END;                      /*                       @Z40LB25*/ 00163000
*       BASEBUF=TEMPBUF;            /* USE CORRECT BUF       @Z40LB25*/ 00164000
@RF00128 MVC   BASEBUF(224),TEMPBUF                                0137 00165000
*     END;                          /*                       @Z40LB25*/ 00166000
*   ELSE                            /* INACTIVE              @Z40LB25*/ 00167000
*                                                                  0139 00168000
*     /***************************************************************/ 00169000
*     /*                                                             */ 00170000
*     /* GET THE BVR OR CVR OR DVR - INACTIVE.               @Z40LB25*/ 00171000
*     /*                                                             */ 00172000
*     /***************************************************************/ 00173000
*                                                                  0139 00174000
*     DO;                           /*                       @Z40LB25*/ 00175000
         B     @RC00123                                            0139 00176000
@RF00123 DS    0H                                                  0140 00177000
*       IVOLKY=NULCSN;              /* SET CSN               @Z40LB25*/ 00178000
         MVC   IVOLKY(12),NULCSN(NULCPTR)                          0140 00179000
*       CALL GETRECUD;              /* GET RECORD            @Z40LB25*/ 00180000
         BAL   @14,GETRECUD                                        0141 00181000
*       IF RPLVRETC¬=OKZERO         /* ERROR?                @Z40LB25*/ 00182000
*         THEN                      /* YES                   @Z40LB25*/ 00183000
         LH    @09,RPLVRETC(,RPLVPTR)                              0142 00184000
         N     @09,@CF00613                                        0142 00185000
         LTR   @09,@09                                             0142 00186000
         BZ    @RF00142                                            0142 00187000
*         DO;                       /* CK ERROR              @Z40LB25*/ 00188000
*                                                                  0143 00189000
*           /*********************************************************/ 00190000
*           /*                                                       */ 00191000
*           /* NO RECORD FOUND IS OK.                        @Z40LB25*/ 00192000
*           /*                                                       */ 00193000
*           /*********************************************************/ 00194000
*                                                                  0144 00195000
*           IF RPLRCODE=NORECFND    /* NO RECD FND?          @Z40LB25*/ 00196000
*             THEN                  /* YES                   @Z40LB25*/ 00197000
         CLC   RPLRCODE(2,RPLVPTR),@CB00523                        0144 00198000
         BNE   @RF00144                                            0144 00199000
*             DO;                   /* OK                    @Z40LB25*/ 00200000
*               RPLRCODE=RPLRCODE&&RPLRCODE;/*               @Z40LB25   00201000
*                                      ZERO RESN CODE        @Z40LB25*/ 00202000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0146 00203000
*               RPLVRETC=RPLVRETC&&RPLVRETC;/*               @Z40LB25   00204000
*                                      ZERO RETN CODE        @Z40LB25*/ 00205000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0147 00206000
*             END;                  /*                       @Z40LB25*/ 00207000
*           RETURN;                 /*                       @Z40LB25*/ 00208000
         B     @EL00001                                            0149 00209000
*         END;                      /*                       @Z40LB25*/ 00210000
*     END;                          /*                       @Z40LB25*/ 00211000
@RF00142 DS    0H                                                  0152 00212000
*   BCDVPTR=BASEVPTR;               /* SET COMMON MAP        @Z40LB25   00213000
*                                      NEED FOR DELTCIRS     @Z40LB25*/ 00214000
*                                                                  0152 00215000
@RC00123 LR    BCDVPTR,BASEVPTR                                    0152 00216000
*   /*****************************************************************/ 00217000
*   /*                                                               */ 00218000
*   /* CHECK FOR AN ACTIVE BVR WITH NO COPIES.               @Z40LB25*/ 00219000
*   /*                                                               */ 00220000
*   /*****************************************************************/ 00221000
*                                                                  0153 00222000
*   IF BASINAC=OFF&BCDBASE=ON&BASNCOPY=ZEROCOPY/*            @Z40LB25*/ 00223000
*     THEN                          /*                       @Z40LB25*/ 00224000
         TM    BASINAC(BASEVPTR),B'00000100'                       0153 00225000
         BNZ   @RF00153                                            0153 00226000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0153 00227000
         BNO   @RF00153                                            0153 00228000
         CLI   BASNCOPY(BASEVPTR),0                                0153 00229000
         BNE   @RF00153                                            0153 00230000
*     DO;                           /*                       @Z40LB25*/ 00231000
*       CALL ELMACTV;               /* ELIM ACT VOL          @Z40LB25*/ 00232000
         BAL   @14,ELMACTV                                         0155 00233000
*       RETURN;                     /*                       @Z40LB25*/ 00234000
         B     @EL00001                                            0156 00235000
*     END;                          /*                       @Z40LB25*/ 00236000
*                                                                  0157 00237000
*   /*****************************************************************/ 00238000
*   /*                                                               */ 00239000
*   /* CHECK FOR AN INACTIVE BVR WITH NO COPIES OR           @Z40LB25*/ 00240000
*   /* A CVR OR A DVR.                                       @Z40LB25*/ 00241000
*   /*                                                               */ 00242000
*   /*****************************************************************/ 00243000
*                                                                  0158 00244000
*   IF(BASINAC=ON&BCDBASE=ON&BASNCOPY=ZEROCOPY)|BCDDUP=ON|BCDCOPY=ON    00245000
*     THEN                          /*                       @Z40LB25*/ 00246000
@RF00153 TM    BASINAC(BASEVPTR),B'00000100'                       0158 00247000
         BNO   @GL00003                                            0158 00248000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0158 00249000
         BNO   @GL00003                                            0158 00250000
         CLI   BASNCOPY(BASEVPTR),0                                0158 00251000
         BE    @RT00158                                            0158 00252000
@GL00003 TM    BCDDUP(BCDVPTR),B'00010100'                         0158 00253000
         BZ    @RF00158                                            0158 00254000
@RT00158 DS    0H                                                  0159 00255000
*     DO;                           /*                       @Z40LB25*/ 00256000
*       CALL ELINACV;               /* ELIM INACT VOL        @Z40LB25*/ 00257000
         BAL   @14,ELINACV                                         0160 00258000
*       RETURN;                     /*                       @Z40LB25*/ 00259000
         B     @EL00001                                            0161 00260000
*     END;                          /*                       @Z40LB25*/ 00261000
*                                                                  0162 00262000
*   /*****************************************************************/ 00263000
*   /*                                                               */ 00264000
*   /* THE BVR HAS CVR(S). IF THE BVR                        @Z40LB25*/ 00265000
*   /* WERE TO BE DELETED, THEN CVR(S) WILL                  @Z40LB25*/ 00266000
*   /* EXIST WHICH HAS NO BVR - A DESIGN VIOLATION.          @Z40LB25*/ 00267000
*   /* IF THE BVR IS ACTIVE, IT MUST BE MADE                 @Z40LB25*/ 00268000
*   /* INACTIVE. SET THE REASSIGNED FLAG IN                  @Z40LB25*/ 00269000
*   /* BVR ON AND WRITE THE BVR. ALSO, DELETE                @Z40LB25*/ 00270000
*   /* BVR'S CIRS.                                           @Z40LB25*/ 00271000
*   /*                                                               */ 00272000
*   /*****************************************************************/ 00273000
*                                                                  0163 00274000
*   CALL REASNBVR;                  /* CSNS REASSIGNED       @Z40LB25*/ 00275000
@RF00158 BAL   @14,REASNBVR                                        0163 00276000
*   RETURN;                         /*                       @Z40LB25*/ 00277000
         B     @EL00001                                            0164 00278000
*                                                                  0165 00279000
*   /*****************************************************************/ 00280000
*   /*                                                               */ 00281000
*   /* PROCEDURE NAME - ELMACTV                              @Z40LB25*/ 00282000
*   /*                                                       @Z40LB25*/ 00283000
*   /* FUNCTION -                                            @Z40LB25*/ 00284000
*   /* PROCESS THE ELIMINATION OF AN ACTIVE VOLUME.          @Z40LB25*/ 00285000
*   /* DELETE THE BVR AND ITS CIRS. IF THE BVR               @Z40LB25*/ 00286000
*   /* WAS GROUPED, ITS GROUP HEADER IS UPDATED.             @Z40LB25*/ 00287000
*   /* IF IT WAS GROUPED GENERAL-USE, ITS GROUP              @Z40LB25*/ 00288000
*   /* VOLUME SERIAL EXTENSION RECORD IS UPDATED.            @Z40LB25*/ 00289000
*   /* IF THE DELETED BVR HAS A DVR, THIS DVR IS             @Z40LB25*/ 00290000
*   /* MADE INTO A BVR TO REPLACE THE DELETED BVR.           @Z40LB25*/ 00291000
*   /*                                                       @Z40LB25*/ 00292000
*   /* INPUT -                                               @Z40LB25*/ 00293000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00294000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00295000
*   /*                                                       @Z40LB25*/ 00296000
*   /* OUTPUT -                                              @Z40LB25*/ 00297000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00298000
*   /* AN ERROR                                              @Z40LB25*/ 00299000
*   /*                                                               */ 00300000
*   /*****************************************************************/ 00301000
*                                                                  0165 00302000
*ELMACTV:                           /*                       @Z40LB25*/ 00303000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00304000
*                                                                  0165 00305000
ELMACTV  ST    @14,@SA00002                                        0165 00306000
*   /*****************************************************************/ 00307000
*   /*                                                               */ 00308000
*   /* DELETE THE BVR IN TEMPBUF                             @Z40LB25*/ 00309000
*   /*                                                               */ 00310000
*   /*****************************************************************/ 00311000
*                                                                  0166 00312000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Z40LB25*/ 00313000
         MVI   RPLVTYP(RPLVPTR),X'05'                              0166 00314000
*   RESPECIFY                                                      0167 00315000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 00316000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 00317000
         LR    RG1,RPLVPTR                                         0168 00318000
*   CALL ICBVIO00;                  /* DELETE BVR OR CVR     @Z40LB25*/ 00319000
         L     @15,@CV00537                                        0169 00320000
         BALR  @14,@15                                             0169 00321000
*   RESPECIFY                                                      0170 00322000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 00323000
*   IF RPLVRETC¬=OKZERO             /* ERROR?                @Z40LB25*/ 00324000
*     THEN                          /* YES                   @Z40LB25*/ 00325000
         LH    @09,RPLVRETC(,RPLVPTR)                              0171 00326000
         N     @09,@CF00613                                        0171 00327000
         LTR   @09,@09                                             0171 00328000
         BNZ   @RT00171                                            0171 00329000
*     RETURN;                       /*                       @Z40LB25*/ 00330000
*                                                                  0172 00331000
*   /*****************************************************************/ 00332000
*   /*                                                               */ 00333000
*   /* DELETE THE CIRS.                                      @Z40LB25*/ 00334000
*   /*                                                               */ 00335000
*   /*****************************************************************/ 00336000
*                                                                  0173 00337000
*   CALL DELTCIRS;                  /* DELT CIRS             @Z40LB25*/ 00338000
*                                                                  0173 00339000
         BAL   @14,DELTCIRS                                        0173 00340000
*   /*****************************************************************/ 00341000
*   /*                                                               */ 00342000
*   /* CHECK IF GHR NEEDS PROCESSING.                        @Z40LB25*/ 00343000
*   /*                                                               */ 00344000
*   /*****************************************************************/ 00345000
*                                                                  0174 00346000
*   IF BASGRPV=ON                   /* BVR GROUPED?          @Z40LB25*/ 00347000
*     THEN                          /* YES                   @Z40LB25*/ 00348000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0174 00349000
         BNO   @RF00174                                            0174 00350000
*     DO;                           /*                       @Z40LB25*/ 00351000
*                                                                  0175 00352000
*       /*************************************************************/ 00353000
*       /*                                                           */ 00354000
*       /* DECREMENT EITHER THE NUMBER OF GENERAL-USE        @Z40LB25*/ 00355000
*       /* OR THE NUMBER OF RESTRICTED VOLUMES KEPT IN       @Z40LB25*/ 00356000
*       /* THE GROUP HEADER RECORD. DECREMENT SPACE          @Z40LB25*/ 00357000
*       /* COUNT IN THE GROUP RECORD.                        @Z40LB25*/ 00358000
*       /*                                                           */ 00359000
*       /*************************************************************/ 00360000
*                                                                  0176 00361000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Z40LB25*/ 00362000
         MVC   GROUPKY(8),BASGROUP(BASEVPTR)                       0176 00363000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY ADDR          @Z40LB25*/ 00364000
         LA    @09,GKEY                                            0177 00365000
         ST    @09,RPLVKEY(,RPLVPTR)                               0177 00366000
*       CALL READUPD1;              /* READ GHR              @Z40LB25*/ 00367000
         BAL   @14,READUPD1                                        0178 00368000
*       IF RPLVRETC¬=OKZERO         /* ERROR?                @Z40LB25*/ 00369000
*         THEN                      /* YES                   @Z40LB25*/ 00370000
         LH    @09,RPLVRETC(,RPLVPTR)                              0179 00371000
         N     @09,@CF00613                                        0179 00372000
         LTR   @09,@09                                             0179 00373000
         BNZ   @RT00179                                            0179 00374000
*         RETURN;                   /*                       @Z40LB25*/ 00375000
*                                                                  0180 00376000
*       /*************************************************************/ 00377000
*       /*                                                           */ 00378000
*       /* DECREMENT TYPE OF VOLUME COUNT.                   @Z40LB25*/ 00379000
*       /*                                                           */ 00380000
*       /*************************************************************/ 00381000
*                                                                  0181 00382000
*       GROUPBUF=TEMPBUF;           /* USE CORRECT BUF       @Z40LB25*/ 00383000
         MVC   GROUPBUF(164),TEMPBUF                               0181 00384000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Z40LB25*/ 00385000
*         THEN                      /* YES                   @Z40LB25*/ 00386000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0182 00387000
         BNO   @RF00182                                            0182 00388000
*         DO;                       /*                       @Z40LB25*/ 00389000
*           GRONGEN=GRONGEN-DECONE; /* DEC # GEN-USE         @Z40LB25*/ 00390000
*                                                                  0184 00391000
         LH    @09,GRONGEN(,GROUPPTR)                              0184 00392000
         BCTR  @09,0                                               0184 00393000
         STH   @09,GRONGEN(,GROUPPTR)                              0184 00394000
*           /*********************************************************/ 00395000
*           /*                                                       */ 00396000
*           /* UPDATE THE GHR.                               @Z40LB25*/ 00397000
*           /*                                                       */ 00398000
*           /*********************************************************/ 00399000
*                                                                  0185 00400000
*           ADDSUBGR=OFF;           /* BVR DELETED           @Z40LB25*/ 00401000
         NI    ADDSUBGR,B'11110111'                                0185 00402000
*           CALL ICBVUPGH(PTRGROUP,PTRBASEV,PASSBYTE);/*     @Z40LB25   00403000
*                                      UPDATE GHR            @Z40LB25*/ 00404000
         L     @15,@CV00545                                        0186 00405000
         LA    @01,@AL00186                                        0186 00406000
         BALR  @14,@15                                             0186 00407000
*         END;                      /*                       @Z40LB25*/ 00408000
*       ELSE                        /* RESTRICTED            @Z40LB25*/ 00409000
*         IF BASRSTD=ON             /* RESTRICTED?           @Z40LB25*/ 00410000
*           THEN                    /* YES                   @Z40LB25*/ 00411000
         B     @RC00182                                            0188 00412000
@RF00182 TM    BASRSTD(BASEVPTR),B'00001000'                       0188 00413000
         BNO   @RF00188                                            0188 00414000
*           GRONRSTD=GRONRSTD-DECONE;/*                      @Z40LB25   00415000
*                                      DEC # RESTD VOLS      @Z40LB25*/ 00416000
         LH    @09,GRONRSTD(,GROUPPTR)                             0189 00417000
         BCTR  @09,0                                               0189 00418000
         STH   @09,GRONRSTD(,GROUPPTR)                             0189 00419000
*     END;                          /*                       @Z40LB25*/ 00420000
*                                                                  0190 00421000
@RF00188 DS    0H                                                  0190 00422000
@RC00182 DS    0H                                                  0191 00423000
*   /*****************************************************************/ 00424000
*   /*                                                               */ 00425000
*   /* PROCESS THE OTHER MSVI RECORDS ASSOCIATED             @Z40LB25*/ 00426000
*   /* WITH THIS BVR.                                        @Z40LB25*/ 00427000
*   /*                                                               */ 00428000
*   /*****************************************************************/ 00429000
*                                                                  0191 00430000
*   CALL PROCBVR;                   /* PROCESS BVR           @Z40LB25*/ 00431000
@RF00174 BAL   @14,PROCBVR                                         0191 00432000
*   RETURN;                         /*                       @Z40LB25*/ 00433000
@EL00002 DS    0H                                                  0192 00434000
@EF00002 DS    0H                                                  0192 00435000
@ER00002 L     @14,@SA00002                                        0192 00436000
         BR    @14                                                 0192 00437000
*   END ELMACTV;                    /*                       @Z40LB25*/ 00438000
         B     @EL00002                                            0193 00439000
*                                                                  0194 00440000
*   /*****************************************************************/ 00441000
*   /*                                                               */ 00442000
*   /* PROCEDURE NAME - ELINACV                              @Z40LB25*/ 00443000
*   /*                                                       @Z40LB25*/ 00444000
*   /* FUNCTION -                                            @Z40LB25*/ 00445000
*   /* PROCESS THE ELIMINATION OF AN INACTIVE VOLUME.        @Z40LB25*/ 00446000
*   /* DELETE THE BVR OR CVR OR DVR AND ITS CIRS.            @Z40LB25*/ 00447000
*   /* FOR A DELETED GROUPED BVR, UPDATE ITS GROUPED         @Z40LB25*/ 00448000
*   /* HEADER RECORD. FOR A DELETE NON-GROUPED BVR,          @Z40LB25*/ 00449000
*   /* UPDATE ITS NON-GROUPED HEADER RECORD. IF THE          @Z40LB25*/ 00450000
*   /* DELETED BVR HAS A DVR, MAKE THE DVR INTO A BVR        @Z40LB25*/ 00451000
*   /* FOR THE DELETED BVR. FOR A DELETED CVR, ITS           @Z40LB25*/ 00452000
*   /* BVR MUST BE UPDATED.                                  @Z40LB25*/ 00453000
*   /*                                                       @Z40LB25*/ 00454000
*   /* INPUT -                                               @Z40LB25*/ 00455000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00456000
*   /* BASE OR COPY OR DUPLICATE VOLUME RECORD               @Z40LB25*/ 00457000
*   /*                                                       @Z40LB25*/ 00458000
*   /* OUTPUT -                                              @Z40LB25*/ 00459000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00460000
*   /* AN ERROR                                              @Z40LB25*/ 00461000
*   /*                                                               */ 00462000
*   /*****************************************************************/ 00463000
*                                                                  0194 00464000
*ELINACV:                           /*                       @Z40LB25*/ 00465000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00466000
*                                                                  0194 00467000
ELINACV  ST    @14,@SA00003                                        0194 00468000
*   /*****************************************************************/ 00469000
*   /*                                                               */ 00470000
*   /* DELETE THE CVR OR BVR OR DVR IN TEMPBUF.              @Z40LB25*/ 00471000
*   /*                                                               */ 00472000
*   /*****************************************************************/ 00473000
*                                                                  0195 00474000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Z40LB25*/ 00475000
         MVI   RPLVTYP(RPLVPTR),X'05'                              0195 00476000
*   RESPECIFY                                                      0196 00477000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 00478000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 00479000
         LR    RG1,RPLVPTR                                         0197 00480000
*   CALL ICBVIO00;                  /* DELETE BVR OR CVR     @Z40LB25*/ 00481000
         L     @15,@CV00537                                        0198 00482000
         BALR  @14,@15                                             0198 00483000
*   RESPECIFY                                                      0199 00484000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 00485000
*   IF RPLVRETC¬=OKZERO             /* ERROR?                @Z40LB25*/ 00486000
*     THEN                          /* YES                   @Z40LB25*/ 00487000
         LH    @09,RPLVRETC(,RPLVPTR)                              0200 00488000
         N     @09,@CF00613                                        0200 00489000
         LTR   @09,@09                                             0200 00490000
         BNZ   @RT00200                                            0200 00491000
*     RETURN;                       /*                       @Z40LB25*/ 00492000
*                                                                  0201 00493000
*   /*****************************************************************/ 00494000
*   /*                                                               */ 00495000
*   /* DELETE THEIR CIRS.                                    @Z40LB25*/ 00496000
*   /*                                                               */ 00497000
*   /*****************************************************************/ 00498000
*                                                                  0202 00499000
*   CALL DELTCIRS;                  /* DELT CIRS             @Z40LB25*/ 00500000
*                                                                  0202 00501000
         BAL   @14,DELTCIRS                                        0202 00502000
*   /*****************************************************************/ 00503000
*   /*                                                               */ 00504000
*   /* CHECK FOR A DVR.                                      @Z40LB25*/ 00505000
*   /*                                                               */ 00506000
*   /*****************************************************************/ 00507000
*                                                                  0203 00508000
*   IF BCDDUP=ON                    /* DVR?                  @Z40LB25*/ 00509000
*     THEN                          /* YES                   @Z40LB25*/ 00510000
         TM    BCDDUP(BCDVPTR),B'00000100'                         0203 00511000
         BO    @RT00203                                            0203 00512000
*     RETURN;                       /*                       @Z40LB25*/ 00513000
*                                                                  0204 00514000
*   /*****************************************************************/ 00515000
*   /*                                                               */ 00516000
*   /* CKECK FOR A BASE VOLUME RECORD.                       @Z40LB25*/ 00517000
*   /* UPDATE ITS GHR OR NGHR.                               @Z40LB25*/ 00518000
*   /*                                                               */ 00519000
*   /*****************************************************************/ 00520000
*                                                                  0205 00521000
*   IF BCDBASE=ON                   /* BVR?                  @Z40LB25*/ 00522000
*     THEN                          /* YES                   @Z40LB25*/ 00523000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0205 00524000
         BNO   @RF00205                                            0205 00525000
*     DO;                           /*                       @Z40LB25*/ 00526000
*       IF BASGRPV=ON               /* GROUPED BVR?          @Z40LB25*/ 00527000
*         THEN                      /* YES                   @Z40LB25*/ 00528000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0207 00529000
         BNO   @RF00207                                            0207 00530000
*         DO;                       /*                       @Z40LB25*/ 00531000
*           GROUPKY=BASGROUP;       /* SET GROUP NAME        @Z40LB25*/ 00532000
         MVC   GROUPKY(8),BASGROUP(BASEVPTR)                       0209 00533000
*           RPLVKEY=ADDR(GKEY);     /* SET KEY ADDR          @Z40LB25*/ 00534000
         LA    @09,GKEY                                            0210 00535000
         ST    @09,RPLVKEY(,RPLVPTR)                               0210 00536000
*           CALL READUPD1;          /* READ GHR              @Z40LB25*/ 00537000
         BAL   @14,READUPD1                                        0211 00538000
*           IF RPLVRETC¬=OKZERO     /* ERROR?                @Z40LB25*/ 00539000
*             THEN                  /* YES                   @Z40LB25*/ 00540000
         LH    @09,RPLVRETC(,RPLVPTR)                              0212 00541000
         N     @09,@CF00613                                        0212 00542000
         LTR   @09,@09                                             0212 00543000
         BNZ   @RT00212                                            0212 00544000
*             RETURN;               /*                       @Z40LB25*/ 00545000
*           GROUPBUF=TEMPBUF;       /* USE CORRECT BUF       @Z40LB25*/ 00546000
         MVC   GROUPBUF(164),TEMPBUF                               0214 00547000
*           GRONINAC=GRONINAC-DECONE;/* DECREM INAC VOLS     @Z40LB25*/ 00548000
         LH    @09,GRONINAC(,GROUPPTR)                             0215 00549000
         BCTR  @09,0                                               0215 00550000
         STH   @09,GRONINAC(,GROUPPTR)                             0215 00551000
*         END;                      /*                       @Z40LB25*/ 00552000
*                                                                  0216 00553000
*       /*************************************************************/ 00554000
*       /*                                                           */ 00555000
*       /* PROCESS THE OTHER MSVI RECORDS ASSOCIATED         @Z40LB25*/ 00556000
*       /* WITH THIS BVR.                                    @Z40LB25*/ 00557000
*       /*                                                           */ 00558000
*       /*************************************************************/ 00559000
*                                                                  0217 00560000
*       CALL PROCBVR;               /* PROCESS THE BVR       @Z40LB25*/ 00561000
@RF00207 BAL   @14,PROCBVR                                         0217 00562000
*     END;                          /*                       @Z40LB25*/ 00563000
*                                                                  0218 00564000
*   /*****************************************************************/ 00565000
*   /*                                                               */ 00566000
*   /* CHECK FOR A DELETED COPY VOLUME RECORD                @Z40LB25*/ 00567000
*   /* IF PRESENT, THEN UPDATE THE CVR'S BVR TO REFLECT      @Z40LB25*/ 00568000
*   /* THE DELETION OF THE CVR.                              @Z40LB25*/ 00569000
*   /*                                                               */ 00570000
*   /*****************************************************************/ 00571000
*                                                                  0219 00572000
*   IF BCDCOPY=ON                   /* CVR?                  @Z40LB25*/ 00573000
*     THEN                          /* YES                   @Z40LB25*/ 00574000
@RF00205 TM    BCDCOPY(BCDVPTR),B'00010000'                        0219 00575000
         BNO   @RF00219                                            0219 00576000
*     DO;                           /*                       @Z40LB25*/ 00577000
*       COPYBUF=BASEBUF;            /* CVR TO CVR BUF        @Z40LB25*/ 00578000
         MVC   COPYBUF(164),BASEBUF                                0221 00579000
*       ADDSUB=OFF;                 /* DELETED CVR           @Z40LB25*/ 00580000
         NI    ADDSUB,B'10111111'                                  0222 00581000
*       CALL ICBVUBVR(PTRCOPYV,PTRRPLV,PASSBYTE);/*          @Z40LB25   00582000
*                                      UPDATE CVR'S BVR      @Z40LB25*/ 00583000
         L     @15,@CV00542                                        0223 00584000
         LA    @01,@AL00223                                        0223 00585000
         BALR  @14,@15                                             0223 00586000
*     END;                          /*                       @Z40LB25*/ 00587000
*   RETURN;                         /*                       @Z40LB25*/ 00588000
@EL00003 DS    0H                                                  0225 00589000
@EF00003 DS    0H                                                  0225 00590000
@ER00003 L     @14,@SA00003                                        0225 00591000
         BR    @14                                                 0225 00592000
*   END ELINACV;                    /*                       @Z40LB25*/ 00593000
         B     @EL00003                                            0226 00594000
*                                                                  0227 00595000
*   /*****************************************************************/ 00596000
*   /*                                                               */ 00597000
*   /* PROCEDURE NAME - REASNBVR                             @Z40LB25*/ 00598000
*   /*                                                       @Z40LB25*/ 00599000
*   /* FUNCTION -                                            @Z40LB25*/ 00600000
*   /* A BVR HAS CVR(S), THEREFORE IT CAN NOT BE DELETED.    @Z40LB25*/ 00601000
*   /* ITS CARTRIDGES WILL BE REASSIGNED, THEREFORE ITS      @Z40LB25*/ 00602000
*   /* CIRS MUST BE DELETED. THE BVR WILL BE KEPT, BUT       @Z40LB25*/ 00603000
*   /* IT WILL INDICATE CARTRIDGES ARE REASSIGNED AND        @Z40LB25*/ 00604000
*   /* BE INACTIVE.                                          @Z40LB25*/ 00605000
*   /*                                                       @Z40LB25*/ 00606000
*   /* INPUT -                                               @Z40LB25*/ 00607000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00608000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00609000
*   /*                                                       @Z40LB25*/ 00610000
*   /* OUTPUT -                                              @Z40LB25*/ 00611000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00612000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00613000
*   /* AN ERROR                                              @Z40LB25*/ 00614000
*   /*                                                               */ 00615000
*   /*****************************************************************/ 00616000
*                                                                  0227 00617000
*REASNBVR:                          /*                       @Z40LB25*/ 00618000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00619000
*                                                                  0227 00620000
REASNBVR ST    @14,@SA00004                                        0227 00621000
*   /*****************************************************************/ 00622000
*   /*                                                               */ 00623000
*   /* THE BVR MUST BE INACTIVE TO HAVE ITS CARTRIDGES       @Z40LB25*/ 00624000
*   /* REASSIGNED.                                           @Z40LB25*/ 00625000
*   /*                                                               */ 00626000
*   /*****************************************************************/ 00627000
*                                                                  0228 00628000
*   IF BASINAC=OFF                  /* ACTIVE?               @Z40LB25*/ 00629000
*     THEN                          /* YES                   @Z40LB25*/ 00630000
         TM    BASINAC(BASEVPTR),B'00000100'                       0228 00631000
         BNZ   @RF00228                                            0228 00632000
*     DO;                           /*                       @Z40LB25*/ 00633000
*       CALL DEACTV;                /* DACT VOL              @Z40LB25*/ 00634000
         BAL   @14,DEACTV                                          0230 00635000
*       IF RPLRCODE=IOERROR         /* I/O ERROR?            @Z40LB25*/ 00636000
*         THEN                      /* YES                   @Z40LB25*/ 00637000
         CLC   RPLRCODE(2,RPLVPTR),@CB00525                        0231 00638000
         BE    @RT00231                                            0231 00639000
*         RETURN;                   /*                       @Z40LB25*/ 00640000
*                                                                  0232 00641000
*       /*************************************************************/ 00642000
*       /*                                                           */ 00643000
*       /* SAVE THE RETURN/REASON IN CASE THE                @Z40LB25*/ 00644000
*       /* GHR OR GHSNER COULD NOT BE FOUND.                 @Z40LB25*/ 00645000
*       /*                                                           */ 00646000
*       /*************************************************************/ 00647000
*                                                                  0233 00648000
*       RETCODE=RPLVRETC;           /* SAVE RETN CODE        @Z40LB25*/ 00649000
         MVC   RETCODE(2),RPLVRETC(RPLVPTR)                        0233 00650000
*       REACODE=RPLRCODE;           /* SAVE RESN CODE        @Z40LB25*/ 00651000
*                                                                  0234 00652000
         MVC   REACODE(2),RPLRCODE(RPLVPTR)                        0234 00653000
*       /*************************************************************/ 00654000
*       /*                                                           */ 00655000
*       /* REESTABLISH BVR RPL.                              @Z40LB25*/ 00656000
*       /*                                                           */ 00657000
*       /*************************************************************/ 00658000
*                                                                  0235 00659000
*       BVOLKY=BASSERNO;            /* RESET VOLID           @Z40LB25*/ 00660000
         MVC   BVOLKY(6),BASSERNO(BASEVPTR)                        0235 00661000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Z40LB25*/ 00662000
         LA    @03,BKEY                                            0236 00663000
         ST    @03,RPLVKEY(,RPLVPTR)                               0236 00664000
*       CALL READUPD1;              /* READ BVR              @Z40LB25*/ 00665000
         BAL   @14,READUPD1                                        0237 00666000
*       IF RPLVRETC¬=OKZERO         /* ERROR?                @Z40LB25*/ 00667000
*         THEN                      /* YES                   @Z40LB25*/ 00668000
         LH    @03,RPLVRETC(,RPLVPTR)                              0238 00669000
         N     @03,@CF00613                                        0238 00670000
         LTR   @03,@03                                             0238 00671000
         BNZ   @RT00238                                            0238 00672000
*         RETURN;                   /*                       @Z40LB25*/ 00673000
*     END;                          /*                       @Z40LB25*/ 00674000
*                                                                  0240 00675000
*   /*****************************************************************/ 00676000
*   /*                                                               */ 00677000
*   /* INDICATE THE CARTRIDGES ARE REASSIGNED AND            @Z40LB25*/ 00678000
*   /* NOT IN THE LIBRARY.                                   @Z40LB25*/ 00679000
*   /*                                                               */ 00680000
*   /*****************************************************************/ 00681000
*                                                                  0241 00682000
*   BASREASS=ON;                    /* REASSIGNED            @Z40LB25*/ 00683000
@RF00228 OI    BASREASS(BASEVPTR),B'00100000'                      0241 00684000
*   BASLIB1=NULLIB1F;               /* NULL LIB ID 1         @Z40LB25*/ 00685000
         MVI   BASLIB1(BASEVPTR),X'FF'                             0242 00686000
*   BASLIB2=NULLIB1F;               /* NULL LIB ID 2         @Z40LB25*/ 00687000
*                                                                  0243 00688000
         MVI   BASLIB2(BASEVPTR),X'FF'                             0243 00689000
*   /*****************************************************************/ 00690000
*   /*                                                               */ 00691000
*   /* WRITE THE BVR.                                        @Z40LB25*/ 00692000
*   /*                                                               */ 00693000
*   /*****************************************************************/ 00694000
*                                                                  0244 00695000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Z40LB25*/ 00696000
         LA    @05,BASEBUF                                         0244 00697000
         ST    @05,RPLVBUF(,RPLVPTR)                               0244 00698000
*   CALL WRITRECD;                  /* WRITE BVR             @Z40LB25*/ 00699000
         BAL   @14,WRITRECD                                        0245 00700000
*   IF RPLVRETC¬=OKZERO             /* ERROR?                @Z40LB25*/ 00701000
*     THEN                          /* YES                   @Z40LB25*/ 00702000
         LH    @05,RPLVRETC(,RPLVPTR)                              0246 00703000
         N     @05,@CF00613                                        0246 00704000
         LTR   @05,@05                                             0246 00705000
         BNZ   @RT00246                                            0246 00706000
*     RETURN;                       /*                       @Z40LB25*/ 00707000
*                                                                  0247 00708000
*   /*****************************************************************/ 00709000
*   /*                                                               */ 00710000
*   /* DELETE THE CIRS FOR THE BVR.                          @Z40LB25*/ 00711000
*   /* ZERO RETURN/REASON CODES ARE RETURNED.                @Z40LB25*/ 00712000
*   /*                                                               */ 00713000
*   /*****************************************************************/ 00714000
*                                                                  0248 00715000
*   CALL DELTCIRS;                  /* DELETE CIRS           @Z40LB25*/ 00716000
*                                                                  0248 00717000
         BAL   @14,DELTCIRS                                        0248 00718000
*   /*****************************************************************/ 00719000
*   /*                                                               */ 00720000
*   /* RESTORE RETURN/REASON CODES IN CASE DEACTV            @Z40LB25*/ 00721000
*   /* WAS CALLED. DEACTV NOT CALLED - RETCODE AND           @Z40LB25*/ 00722000
*   /* REACODE ARE ZEROED IN WORKAREA.                       @Z40LB25*/ 00723000
*   /*                                                               */ 00724000
*   /*****************************************************************/ 00725000
*                                                                  0249 00726000
*   RPLVRETC=RETCODE;               /* RESET RETN CODE       @Z40LB25*/ 00727000
         MVC   RPLVRETC(2,RPLVPTR),RETCODE                         0249 00728000
*   RPLRCODE=REACODE;               /* RESET RESN CODE       @Z40LB25*/ 00729000
         MVC   RPLRCODE(2,RPLVPTR),REACODE                         0250 00730000
*   RETURN;                         /*                       @Z40LB25*/ 00731000
@EL00004 DS    0H                                                  0251 00732000
@EF00004 DS    0H                                                  0251 00733000
@ER00004 L     @14,@SA00004                                        0251 00734000
         BR    @14                                                 0251 00735000
*   END REASNBVR;                   /*                       @Z40LB25*/ 00736000
         B     @EL00004                                            0252 00737000
*                                                                  0253 00738000
*   /*****************************************************************/ 00739000
*   /*                                                               */ 00740000
*   /* PROCEDURE NAME - DEACTV                               @Z40LB25*/ 00741000
*   /*                                                       @Z40LB25*/ 00742000
*   /* FUNCTION -                                            @Z40LB25*/ 00743000
*   /* PROCESS THE DEACTIVATION OF AN ACTIVE VOLUME.         @Z40LB25*/ 00744000
*   /* IF THE BVR IS GROUPED, UPDATE ITS GROUP HEADER        @Z40LB25*/ 00745000
*   /* RECORD. IF THE BVR IS GROUPED GENERAL-USE, UPDATE     @Z40LB25*/ 00746000
*   /* ITS GROUP VOLUME SERIAL EXTENSION RECORD.             @Z40LB25*/ 00747000
*   /*                                                       @Z40LB25*/ 00748000
*   /* INPUT -                                               @Z40LB25*/ 00749000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00750000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00751000
*   /*                                                       @Z40LB25*/ 00752000
*   /* OUTPUT -                                              @Z40LB25*/ 00753000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00754000
*   /* AN ERROR                                              @Z40LB25*/ 00755000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00756000
*   /*                                                               */ 00757000
*   /*****************************************************************/ 00758000
*                                                                  0253 00759000
*DEACTV:                            /*                       @Z40LB25*/ 00760000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00761000
*                                                                  0253 00762000
DEACTV   ST    @14,@SA00005                                        0253 00763000
*   /*****************************************************************/ 00764000
*   /*                                                               */ 00765000
*   /* MAKE BVR REFLECT INACTIVE VOLUME.                     @Z40LB25*/ 00766000
*   /*                                                               */ 00767000
*   /*****************************************************************/ 00768000
*                                                                  0254 00769000
*   BASINAC=ON;                     /* MAKE INACTIVE         @Z40LB25*/ 00770000
         OI    BASINAC(BASEVPTR),B'00000100'                       0254 00771000
*   BASEXPDT=NULEXP4F;              /* NULL EXPIR DATE       @Z40LB25*/ 00772000
*                                                                  0255 00773000
         MVC   BASEXPDT(4,BASEVPTR),@CB00521                       0255 00774000
*   /*****************************************************************/ 00775000
*   /*                                                               */ 00776000
*   /* CHECK IF VOLUME IS GROUPED.                           @Z40LB25*/ 00777000
*   /*                                                               */ 00778000
*   /*****************************************************************/ 00779000
*                                                                  0256 00780000
*   IF BASGRPV=ON                   /* GROUPED?              @Z40LB25*/ 00781000
*     THEN                          /* YES                   @Z40LB25*/ 00782000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0256 00783000
         BNO   @RF00256                                            0256 00784000
*     DO;                           /*                       @Z40LB25*/ 00785000
*                                                                  0257 00786000
*       /*************************************************************/ 00787000
*       /*                                                           */ 00788000
*       /* GET AND UPDATE THE GROUP HEADER RECORD.           @Z40LB25*/ 00789000
*       /*                                                           */ 00790000
*       /*************************************************************/ 00791000
*                                                                  0258 00792000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Z40LB25*/ 00793000
         MVC   GROUPKY(8),BASGROUP(BASEVPTR)                       0258 00794000
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @Z40LB25*/ 00795000
         LA    @07,GKEY                                            0259 00796000
         ST    @07,RPLVKEY(,RPLVPTR)                               0259 00797000
*       CALL READUPD1;              /* READ GHR              @Z40LB25*/ 00798000
         BAL   @14,READUPD1                                        0260 00799000
*       IF RPLVRETC¬=OKZERO         /* ERROR?                @Z40LB25*/ 00800000
*         THEN                      /* YES                   @Z40LB25*/ 00801000
         LH    @07,RPLVRETC(,RPLVPTR)                              0261 00802000
         N     @07,@CF00613                                        0261 00803000
         LTR   @07,@07                                             0261 00804000
         BNZ   @RT00261                                            0261 00805000
*         RETURN;                   /*                       @Z40LB25*/ 00806000
*       GROUPBUF=TEMPBUF;           /* USE CORRECT BUFF      @Z40LB25*/ 00807000
         MVC   GROUPBUF(164),TEMPBUF                               0263 00808000
*       GRONINAC=GRONINAC+INCONE;   /* INCR # INACT VOLS     @Z40LB25*/ 00809000
         LA    @07,1                                               0264 00810000
         AH    @07,GRONINAC(,GROUPPTR)                             0264 00811000
         STH   @07,GRONINAC(,GROUPPTR)                             0264 00812000
*       IF BASRSTD=ON               /* RESTRICTED?           @Z40LB25*/ 00813000
*         THEN                      /* YES                   @Z40LB25*/ 00814000
         TM    BASRSTD(BASEVPTR),B'00001000'                       0265 00815000
         BNO   @RF00265                                            0265 00816000
*         GRONRSTD=GRONRSTD-DECONE; /*                       @Z40LB25   00817000
*                                      DECR # RSTD VOLS      @Z40LB25*/ 00818000
         LH    @07,GRONRSTD(,GROUPPTR)                             0266 00819000
         BCTR  @07,0                                               0266 00820000
         STH   @07,GRONRSTD(,GROUPPTR)                             0266 00821000
*       ELSE                        /* CK GEN-USE            @Z40LB25*/ 00822000
*         IF BASGENUS=ON            /* GENERAL-USE?          @Z40LB25*/ 00823000
*           THEN                    /* YES                   @Z40LB25*/ 00824000
         B     @RC00265                                            0267 00825000
@RF00265 TM    BASGENUS(BASEVPTR),B'00010000'                      0267 00826000
         BNO   @RF00267                                            0267 00827000
*           DO;                     /*                       @Z40LB25*/ 00828000
*             GRONGEN=GRONGEN-DECONE;/*                      @Z40LB25   00829000
*                                      DECR # G-USE VOLS     @Z40LB25*/ 00830000
*                                                                  0269 00831000
         LH    @07,GRONGEN(,GROUPPTR)                              0269 00832000
         BCTR  @07,0                                               0269 00833000
         STH   @07,GRONGEN(,GROUPPTR)                              0269 00834000
*             /*******************************************************/ 00835000
*             /*                                                     */ 00836000
*             /* PROCESS GROUP HEADER RECORD.                @Z40LB25*/ 00837000
*             /*                                                     */ 00838000
*             /*******************************************************/ 00839000
*                                                                  0270 00840000
*             ADDSUBGR=OFF;         /* SUBTRACT              @Z40LB25*/ 00841000
         NI    ADDSUBGR,B'11110111'                                0270 00842000
*             CALL ICBVUPGH(PTRGROUP,PTRBASEV,PASSBYTE);/*   @Z40LB25   00843000
*                                      UPDATE THE GHR        @Z40LB25*/ 00844000
         L     @15,@CV00545                                        0271 00845000
         LA    @01,@AL00271                                        0271 00846000
         BALR  @14,@15                                             0271 00847000
*           END;                    /*                       @Z40LB25*/ 00848000
*                                                                  0272 00849000
*       /*************************************************************/ 00850000
*       /*                                                           */ 00851000
*       /* WRITE THE GHR.                                    @Z40LB25*/ 00852000
*       /*                                                           */ 00853000
*       /*************************************************************/ 00854000
*                                                                  0273 00855000
*       RPLVBUF=ADDR(GROUPBUF);     /* GHR BUF ADDR          @Z40LB25*/ 00856000
@RF00267 DS    0H                                                  0273 00857000
@RC00265 LA    @03,GROUPBUF                                        0273 00858000
         ST    @03,RPLVBUF(,RPLVPTR)                               0273 00859000
*       CALL WRITRECD;              /* WRITE GHR             @Z40LB25*/ 00860000
         BAL   @14,WRITRECD                                        0274 00861000
*       IF RPLVRETC¬=OKZERO         /* ERROR?                @Z40LB25*/ 00862000
*         THEN                      /* YES                   @Z40LB25*/ 00863000
         LH    @03,RPLVRETC(,RPLVPTR)                              0275 00864000
         N     @03,@CF00613                                        0275 00865000
         LTR   @03,@03                                             0275 00866000
         BNZ   @RT00275                                            0275 00867000
*         RETURN;                   /*                       @Z40LB25*/ 00868000
*                                                                  0276 00869000
*       /*************************************************************/ 00870000
*       /*                                                           */ 00871000
*       /* CHECK FOR GENERAL-USE.                            @Z40LB25*/ 00872000
*       /*                                                           */ 00873000
*       /*************************************************************/ 00874000
*                                                                  0277 00875000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Z40LB25*/ 00876000
*         THEN                      /* YES                   @Z40LB25*/ 00877000
*                                                                  0277 00878000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0277 00879000
         BNO   @RF00277                                            0277 00880000
*         /***********************************************************/ 00881000
*         /*                                                         */ 00882000
*         /* DELETE A GROUP VOLUME SERIAL NUMBER             @Z40LB25*/ 00883000
*         /* EXTENSION SLOT.                                 @Z40LB25*/ 00884000
*         /*                                                         */ 00885000
*         /***********************************************************/ 00886000
*                                                                  0278 00887000
*         DO;                       /*                       @Z40LB25*/ 00888000
*           EXPSLOT=OFF;            /* NO EXPIR DATE         @Z40LB25*/ 00889000
         NI    EXPSLOT,B'01111111'                                 0279 00890000
*           ADDSUBSL=OFF;           /* DELETE                @Z40LB25*/ 00891000
         NI    ADDSUBSL,B'11111101'                                0280 00892000
*           CALL ICBVUEXT(PTRGROUP,PTRBASEV,PTRRPLV,PASSBYTE);/*   0281 00893000
*                                                            @Z40LB25   00894000
*                                      DELETE A SLOT         @Z40LB25*/ 00895000
         L     @15,@CV00541                                        0281 00896000
         LA    @01,@AL00281                                        0281 00897000
         BALR  @14,@15                                             0281 00898000
*         END;                      /*                       @Z40LB25*/ 00899000
*     END;                          /*                       @Z40LB25*/ 00900000
*   RETURN;                         /*                       @Z40LB25*/ 00901000
@EL00005 DS    0H                                                  0284 00902000
@EF00005 DS    0H                                                  0284 00903000
@ER00005 L     @14,@SA00005                                        0284 00904000
         BR    @14                                                 0284 00905000
*   END DEACTV;                     /*                       @Z40LB25*/ 00906000
         B     @EL00005                                            0285 00907000
*                                                                  0286 00908000
*   /*****************************************************************/ 00909000
*   /*                                                               */ 00910000
*   /* PROCEDURE NAME - DELTCIRS                             @Z40LB25*/ 00911000
*   /*                                                       @Z40LB25*/ 00912000
*   /* FUNCTION -                                            @Z40LB25*/ 00913000
*   /* ELIMINATE TWO CARTRIDGE INDEX RECORDS (CIR).          @Z40LB25*/ 00914000
*   /*                                                       @Z40LB25*/ 00915000
*   /* INPUT -                                               @Z40LB25*/ 00916000
*   /* BASE OR COPY OR DUPLICATE VOLUME RECORD               @Z40LB25*/ 00917000
*   /* POINTED TO BY BCDVPTR                                 @Z40LB25*/ 00918000
*   /*                                                       @Z40LB25*/ 00919000
*   /* OUTPUT -                                              @Z40LB25*/ 00920000
*   /* NONE                                                  @Z40LB25*/ 00921000
*   /*                                                               */ 00922000
*   /*****************************************************************/ 00923000
*                                                                  0286 00924000
*DELTCIRS:                          /*                       @Z40LB25*/ 00925000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00926000
*                                                                  0286 00927000
DELTCIRS ST    @14,@SA00006                                        0286 00928000
*   /*****************************************************************/ 00929000
*   /*                                                               */ 00930000
*   /* DELETE THE CIR FOR CSN1.                              @Z40LB25*/ 00931000
*   /*                                                               */ 00932000
*   /*****************************************************************/ 00933000
*                                                                  0287 00934000
*   IVOLKY=BCDCSN1;                 /* SET CSN1 IN CIR       @Z40LB25*/ 00935000
         MVC   IVOLKY(12),BCDCSN1(BCDVPTR)                         0287 00936000
*   RPLVKEY=ADDR(IKEY);             /* SET CIR KEY ADDR      @Z40LB25*/ 00937000
         LA    @09,IKEY                                            0288 00938000
         ST    @09,RPLVKEY(,RPLVPTR)                               0288 00939000
*   RPLVBUF=ADDR(INDEXBUF);         /* SET BUF ADDR          @Z40LB25*/ 00940000
         LA    @09,INDEXBUF                                        0289 00941000
         ST    @09,RPLVBUF(,RPLVPTR)                               0289 00942000
*   RPLVBLN=LENGTH(INDEXBUF);       /* SET BUFF LENGTH       @Z40LB25*/ 00943000
         MVC   RPLVBLN(4,RPLVPTR),@CF00607                         0290 00944000
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Z40LB25*/ 00945000
         BAL   @14,DELTRECD                                        0291 00946000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Z40LB25*/ 00947000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0292 00948000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Z40LB25*/ 00949000
*                                                                  0293 00950000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0293 00951000
*   /*****************************************************************/ 00952000
*   /*                                                               */ 00953000
*   /* DELETE THE CIR FOR CSN2.                              @Z40LB25*/ 00954000
*   /*                                                               */ 00955000
*   /*****************************************************************/ 00956000
*                                                                  0294 00957000
*   IVOLKY=BCDCSN2;                 /* SET CSN2 IN CIR       @Z40LB25*/ 00958000
         MVC   IVOLKY(12),BCDCSN2(BCDVPTR)                         0294 00959000
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Z40LB25*/ 00960000
         BAL   @14,DELTRECD                                        0295 00961000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Z40LB25*/ 00962000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0296 00963000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Z40LB25*/ 00964000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0297 00965000
*   END DELTCIRS;                   /*                       @Z40LB25*/ 00966000
@EL00006 DS    0H                                                  0298 00967000
@EF00006 DS    0H                                                  0298 00968000
@ER00006 L     @14,@SA00006                                        0298 00969000
         BR    @14                                                 0298 00970000
*                                                                  0299 00971000
*   /*****************************************************************/ 00972000
*   /*                                                               */ 00973000
*   /* PROCEDURE NAME - HOUSKEEP                             @Z40LB25*/ 00974000
*   /*                                                       @Z40LB25*/ 00975000
*   /* FUNCTION-                                             @Z40LB25*/ 00976000
*   /* JOURNALS THE RPLV AND RESERVES .MSVI FOR PROCESSING   @Z40LB25*/ 00977000
*   /* AFTER THE MSC IS DONE.                                @Z40LB25*/ 00978000
*   /*                                                       @Z40LB25*/ 00979000
*   /* RESERVE/RELEASE RETURNS ZERO REASON/RETURN CODES.     @Z40LB25*/ 00980000
*   /* RPLV WILL BE JOURNALLED, BECAUSE CHECK FOR DISABLED   @Z40LB25*/ 00981000
*   /* WAS MADE BEFORE CALL TO THE MSC. THEREFORE,           @Z40LB25*/ 00982000
*   /* THIS INCOMPLETELY PROCESSED FUNCTION WILL BE ALLOWED  @Z40LB25*/ 00983000
*   /* TO COMPLETE EVEN IF THE JOURNAL HAS BEEN DISABLED     @Z40LB25*/ 00984000
*   /* SINCE THE LAST CHECK. THE JOURNAL ALWAYS HAS          @Z40LB25*/ 00985000
*   /* SPACE RESERVED FOR SUCH A SITUATION.                  @Z40LB25*/ 00986000
*   /* INPUT -                                               @Z40LB25*/ 00987000
*   /*                                                       @Z40LB25*/ 00988000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00989000
*   /*                                                       @Z40LB25*/ 00990000
*   /* OUTPUT -                                              @Z40LB25*/ 00991000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00992000
*   /* AN ERROR                                              @Z40LB25*/ 00993000
*   /*                                                               */ 00994000
*   /*****************************************************************/ 00995000
*                                                                  0299 00996000
*HOUSKEEP:                          /*                       @Z40LB25*/ 00997000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00998000
HOUSKEEP ST    @14,@SA00007                                        0299 00999000
*   RESPECIFY                       /*                       @Z40LB25*/ 01000000
*     RG0 RSTD;                     /* RESTRICT REG 0        @Z40LB25*/ 01001000
*   RESPECIFY                       /*                       @Z40LB25*/ 01002000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01003000
*                                                                  0301 01004000
*   /*****************************************************************/ 01005000
*   /*                                                               */ 01006000
*   /* RESERVE THE JOURNAL.                                  @Z40LB25*/ 01007000
*   /*                                                               */ 01008000
*   /*****************************************************************/ 01009000
*                                                                  0302 01010000
*   RG0=RESEXVJL;                   /* RESERVE JRNL FLAG     @Z40LB25*/ 01011000
         LA    RG0,17                                              0302 01012000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01013000
         LR    RG1,RPLVPTR                                         0303 01014000
*   CALL ICBVRR00;                  /* RESERVE JOURNNAL      @Z40LB25*/ 01015000
*                                                                  0304 01016000
         L     @15,@CV00538                                        0304 01017000
         BALR  @14,@15                                             0304 01018000
*   /*****************************************************************/ 01019000
*   /*                                                               */ 01020000
*   /* JOURNAL THE RPLV.                                     @Z40LB25*/ 01021000
*   /*                                                               */ 01022000
*   /*****************************************************************/ 01023000
*                                                                  0305 01024000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01025000
         LR    RG1,RPLVPTR                                         0305 01026000
*   CALL ICBVJL00;                  /* JRNL THE RPLV         @Z40LB25*/ 01027000
*                                                                  0306 01028000
         L     @15,@CV00539                                        0306 01029000
         BALR  @14,@15                                             0306 01030000
*   /*****************************************************************/ 01031000
*   /*                                                               */ 01032000
*   /* RELEASE THE JOURNAL.                                  @Z40LB25*/ 01033000
*   /*                                                               */ 01034000
*   /*****************************************************************/ 01035000
*                                                                  0307 01036000
*   RG0=DEQJRNL;                    /* RELEASE JRNL FLAG     @Z40LB25*/ 01037000
         LA    RG0,16                                              0307 01038000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01039000
         LR    RG1,RPLVPTR                                         0308 01040000
*   CALL ICBVRR00;                  /* RELEASE JOURNAL       @Z40LB25*/ 01041000
         L     @15,@CV00538                                        0309 01042000
         BALR  @14,@15                                             0309 01043000
*   RPLVFLG=ON;                     /* RPLV IS JRNLED        @Z40LB25*/ 01044000
*                                                                  0310 01045000
         OI    RPLVFLG,B'00000001'                                 0310 01046000
*   /*****************************************************************/ 01047000
*   /*                                                               */ 01048000
*   /* RESERVE .MSVI.                                        @Z40LB25*/ 01049000
*   /*                                                               */ 01050000
*   /*****************************************************************/ 01051000
*                                                                  0311 01052000
*   RG0=RESEXINV;                   /* RESERVE .MSVI FLAG    @Z40LB25*/ 01053000
         LA    RG0,1                                               0311 01054000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01055000
         LR    RG1,RPLVPTR                                         0312 01056000
*   CALL ICBVRR00;                  /* RESERVE .MSVI         @Z40LB25*/ 01057000
         L     @15,@CV00538                                        0313 01058000
         BALR  @14,@15                                             0313 01059000
*   RESPECIFY                       /*                       @Z40LB25*/ 01060000
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Z40LB25*/ 01061000
*   RESPECIFY                       /*                       @Z40LB25*/ 01062000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01063000
*   RETURN;                         /*                       @Z40LB25*/ 01064000
@EL00007 DS    0H                                                  0316 01065000
@EF00007 DS    0H                                                  0316 01066000
@ER00007 L     @14,@SA00007                                        0316 01067000
         BR    @14                                                 0316 01068000
*   END HOUSKEEP;                   /*                       @Z40LB25*/ 01069000
*                                                                  0318 01070000
*   /*****************************************************************/ 01071000
*   /*                                                               */ 01072000
*   /* PROCEDURE NAME - GETRECUD                             @Z40LB25*/ 01073000
*   /*                                                       @Z40LB25*/ 01074000
*   /* FUNCTION - READ A CIR IN THE LOCATE MODE USING        @Z40LB25*/ 01075000
*   /* THE INPUT CSN, GET THE MSVI RECORD FOR UPDATE         @Z40LB25*/ 01076000
*   /* FROM ITS KEY IN THE CIR.                              @Z40LB25*/ 01077000
*   /*                                                       @Z40LB25*/ 01078000
*   /* INPUT -                                               @Z40LB25*/ 01079000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01080000
*   /* IKEY - CIR KEY                                        @Z40LB25*/ 01081000
*   /*                                                       @Z40LB25*/ 01082000
*   /* OUTPUT -                                              @Z40LB25*/ 01083000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 01084000
*   /* AN ERROR                                              @Z40LB25*/ 01085000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Z40LB25*/ 01086000
*   /*                                                               */ 01087000
*   /*****************************************************************/ 01088000
*                                                                  0318 01089000
*GETRECUD:                          /*                       @Z40LB25*/ 01090000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01091000
GETRECUD ST    @14,@SA00008                                        0318 01092000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           @Z40LB25*/ 01093000
         LA    @09,IKEY                                            0319 01094000
         ST    @09,RPLVKEY(,RPLVPTR)                               0319 01095000
*   RPLVTYP=RPLVREAD;               /* READ                  @Z40LB25*/ 01096000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0320 01097000
*   RPLVDIR=ON;                     /* DIRECT                @Z40LB25*/ 01098000
*   RPLVLOC=ON;                     /* LOCATE                @Z40LB25*/ 01099000
         OI    RPLVDIR(RPLVPTR),B'11000000'                        0322 01100000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Z40LB25*/ 01101000
         NI    RPLVUPD(RPLVPTR),B'11111101'                        0323 01102000
*   RESPECIFY                       /*                       @Z40LB25*/ 01103000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01104000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01105000
         LR    RG1,RPLVPTR                                         0325 01106000
*   CALL ICBVIO00;                  /* READ CIR              @Z40LB25*/ 01107000
         L     @15,@CV00537                                        0326 01108000
         BALR  @14,@15                                             0326 01109000
*   IF RPLVRETC¬=OKZERO             /* ERROR                 @Z40LB25*/ 01110000
*     THEN                          /* YES                   @Z40LB25*/ 01111000
         LH    @09,RPLVRETC(,RPLVPTR)                              0327 01112000
         N     @09,@CF00613                                        0327 01113000
         LTR   @09,@09                                             0327 01114000
         BNZ   @RT00327                                            0327 01115000
*     RETURN;                       /*                       @Z40LB25*/ 01116000
*   INDEXPTR=RPLVBUF;               /* SET MAPPING           @Z40LB25*/ 01117000
         L     INDEXPTR,RPLVBUF(,RPLVPTR)                          0329 01118000
*   BCDKEY=INDRECKY;                /* SET KEY               @Z40LB25*/ 01119000
         MVC   BCDKEY(13),INDRECKY(INDEXPTR)                       0330 01120000
*   RPLVKEY=ADDR(BCDKEY);           /* SET KEY ADDR          @Z40LB25*/ 01121000
         LA    @09,BCDKEY                                          0331 01122000
         ST    @09,RPLVKEY(,RPLVPTR)                               0331 01123000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01124000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0332 01125000
*   RPLVUPD=ON;                     /* UPDATE                @Z40LB25*/ 01126000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0333 01127000
*   RPLVBUF=ADDR(BASEBUF);          /* BUF ADDR              @Z40LB25*/ 01128000
         LA    @09,BASEBUF                                         0334 01129000
         ST    @09,RPLVBUF(,RPLVPTR)                               0334 01130000
*   RPLVBLN=LENGTH(BASEBUF);        /* BUFF LENGTH           @Z40LB25*/ 01131000
         MVC   RPLVBLN(4,RPLVPTR),@CF00608                         0335 01132000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01133000
         LR    RG1,RPLVPTR                                         0336 01134000
*   CALL ICBVIO00;                  /* READ RECORD           @Z40LB25*/ 01135000
         L     @15,@CV00537                                        0337 01136000
         BALR  @14,@15                                             0337 01137000
*   RESPECIFY                       /*                       @Z40LB25*/ 01138000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01139000
*   RETURN;                         /*                       @Z40LB25*/ 01140000
@EL00008 DS    0H                                                  0339 01141000
@EF00008 DS    0H                                                  0339 01142000
@ER00008 L     @14,@SA00008                                        0339 01143000
         BR    @14                                                 0339 01144000
*   END GETRECUD;                   /*                       @Z40LB25*/ 01145000
         B     @EL00008                                            0340 01146000
*                                                                  0341 01147000
*   /*****************************************************************/ 01148000
*   /*                                                               */ 01149000
*   /* PROCEDURE NAME - DELTRECD                             @Z40LB25*/ 01150000
*   /*                                                       @Z40LB25*/ 01151000
*   /* FUNCTION - READ AND DELETE AN MSVI RECORD.            @Z40LB25*/ 01152000
*   /*                                                       @Z40LB25*/ 01153000
*   /* INPUT -                                               @Z40LB25*/ 01154000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01155000
*   /* KEY OF RECORD IN RPLVKEY                              @Z40LB25*/ 01156000
*   /* ADDRESS OF RECORD BUFFER IN RPLVBUF                   @Z40LB25*/ 01157000
*   /* LENGTH OF BUFFER IN RPLVBLN                           @Z40LB25*/ 01158000
*   /*                                                       @Z40LB25*/ 01159000
*   /* OUTPUT -                                              @Z40LB25*/ 01160000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 01161000
*   /* AN ERROR                                              @Z40LB25*/ 01162000
*   /*                                                               */ 01163000
*   /*****************************************************************/ 01164000
*                                                                  0341 01165000
*DELTRECD:                          /*                       @Z40LB25*/ 01166000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01167000
DELTRECD ST    @14,@SA00009                                        0341 01168000
*   RPLVTYP=RPLVREAD;               /* READ                  @Z40LB25*/ 01169000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0342 01170000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01171000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0343 01172000
*   RPLVUPD=ON;                     /* UPDATE                @Z40LB25*/ 01173000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0344 01174000
*   RPLVDIR=ON;                     /* DIRECT                @Z40LB25*/ 01175000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0345 01176000
*   RESPECIFY                       /*                       @Z40LB25*/ 01177000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01178000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01179000
         LR    RG1,RPLVPTR                                         0347 01180000
*   CALL ICBVIO00;                  /* READ MSVI RECORD      @Z40LB25*/ 01181000
         L     @15,@CV00537                                        0348 01182000
         BALR  @14,@15                                             0348 01183000
*   IF RPLVRETC¬=OKZERO             /* ERROR?                @Z40LB25*/ 01184000
*     THEN                          /* YES                   @Z40LB25*/ 01185000
         LH    @09,RPLVRETC(,RPLVPTR)                              0349 01186000
         N     @09,@CF00613                                        0349 01187000
         LTR   @09,@09                                             0349 01188000
         BNZ   @RT00349                                            0349 01189000
*     RETURN;                       /*                       @Z40LB25*/ 01190000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Z40LB25*/ 01191000
         MVI   RPLVTYP(RPLVPTR),X'05'                              0351 01192000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01193000
         LR    RG1,RPLVPTR                                         0352 01194000
*   CALL ICBVIO00;                  /* DELETE MSVI RECORD    @Z40LB25*/ 01195000
         L     @15,@CV00537                                        0353 01196000
         BALR  @14,@15                                             0353 01197000
*   RESPECIFY                       /*                       @Z40LB25*/ 01198000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01199000
*   RETURN;                         /*                       @Z40LB25*/ 01200000
@EL00009 DS    0H                                                  0355 01201000
@EF00009 DS    0H                                                  0355 01202000
@ER00009 L     @14,@SA00009                                        0355 01203000
         BR    @14                                                 0355 01204000
*   END DELTRECD;                   /*                       @Z40LB25*/ 01205000
         B     @EL00009                                            0356 01206000
*                                                                  0357 01207000
*   /*****************************************************************/ 01208000
*   /*                                                               */ 01209000
*   /* PROCEDURE NAME - READUPD1                             @Z40LB25*/ 01210000
*   /*                                                       @Z40LB25*/ 01211000
*   /* FUNCTION -                                            @Z40LB25*/ 01212000
*   /* READ AN MSVI RECORD FOR UPDATE INTO BASEBUF1          @Z40LB25*/ 01213000
*   /*                                                       @Z40LB25*/ 01214000
*   /* INPUT -                                               @Z40LB25*/ 01215000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01216000
*   /* ADDRESS OF KEY TO READ IN RPLVKEY                     @Z40LB25*/ 01217000
*   /*                                                       @Z40LB25*/ 01218000
*   /* OUTPUT -                                              @Z40LB25*/ 01219000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 01220000
*   /* AN ERROR                                              @Z40LB25*/ 01221000
*   /* MSVI RECORD                                           @Z40LB25*/ 01222000
*   /*                                                               */ 01223000
*   /*****************************************************************/ 01224000
*                                                                  0357 01225000
*READUPD1:                          /*                       @Z40LB25*/ 01226000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01227000
READUPD1 ST    @14,@SA00010                                        0357 01228000
*   RPLVBUF=ADDR(TEMPBUF);          /* ADDR OF BUF           @Z40LB25*/ 01229000
         LA    @09,TEMPBUF                                         0358 01230000
         ST    @09,RPLVBUF(,RPLVPTR)                               0358 01231000
*   RPLVBLN=LENGTH(TEMPBUF);        /* BVR BUF LENGTH        @Z40LB25*/ 01232000
         MVC   RPLVBLN(4,RPLVPTR),@CF00608                         0359 01233000
*   RPLVTYP=RPLVREAD;               /* READ                  @Z40LB25*/ 01234000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0360 01235000
*   RPLVDIR=ON;                     /* DIRECT                @Z40LB25*/ 01236000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0361 01237000
*   RPLVUPD=ON;                     /* UPDATE                @Z40LB25*/ 01238000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0362 01239000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01240000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0363 01241000
*   RESPECIFY                       /*                       @Z40LB25*/ 01242000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01243000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01244000
         LR    RG1,RPLVPTR                                         0365 01245000
*   CALL ICBVIO00;                  /* READ BVR              @Z40LB25*/ 01246000
         L     @15,@CV00537                                        0366 01247000
         BALR  @14,@15                                             0366 01248000
*   RESPECIFY                       /*                       @Z40LB25*/ 01249000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01250000
*   RETURN;                         /*                       @Z40LB25*/ 01251000
@EL00010 DS    0H                                                  0368 01252000
@EF00010 DS    0H                                                  0368 01253000
@ER00010 L     @14,@SA00010                                        0368 01254000
         BR    @14                                                 0368 01255000
*   END READUPD1;                   /*                       @Z40LB25*/ 01256000
*                                                                  0370 01257000
*   /*****************************************************************/ 01258000
*   /*                                                               */ 01259000
*   /* PROCEDURE NAME - WRITRECD                             @Z40LB25*/ 01260000
*   /*                                                       @Z40LB25*/ 01261000
*   /* FUNCTION - WRITE AN MSVI RECORD.                      @Z40LB25*/ 01262000
*   /*                                                       @Z40LB25*/ 01263000
*   /* INPUT -                                               @Z40LB25*/ 01264000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01265000
*   /* MSVI RECORD                                           @Z40LB25*/ 01266000
*   /*                                                       @Z40LB25*/ 01267000
*   /* OUTPUT -                                              @Z40LB25*/ 01268000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 01269000
*   /* AN ERROR                                              @Z40LB25*/ 01270000
*   /*                                                               */ 01271000
*   /*****************************************************************/ 01272000
*                                                                  0370 01273000
*WRITRECD:                          /*                       @Z40LB25*/ 01274000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01275000
WRITRECD ST    @14,@SA00011                                        0370 01276000
*   RPLVTYP=RPLVPUT;                /* WRITE                 @Z40LB25*/ 01277000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0371 01278000
*   RPLVLOC=OFF;                    /* NO LOC                @Z40LB25*/ 01279000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0372 01280000
*   RESPECIFY                       /*                       @Z40LB25*/ 01281000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01282000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01283000
         LR    RG1,RPLVPTR                                         0374 01284000
*   CALL ICBVIO00;                  /* WRITE BVR             @Z40LB25*/ 01285000
         L     @15,@CV00537                                        0375 01286000
         BALR  @14,@15                                             0375 01287000
*   RESPECIFY                       /*                       @Z40LB25*/ 01288000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01289000
*   RETURN;                         /*                       @Z40LB25*/ 01290000
@EL00011 DS    0H                                                  0377 01291000
@EF00011 DS    0H                                                  0377 01292000
@ER00011 L     @14,@SA00011                                        0377 01293000
         BR    @14                                                 0377 01294000
*   END WRITRECD;                   /*                       @Z40LB25*/ 01295000
*                                                                  0379 01296000
*   /*****************************************************************/ 01297000
*   /*                                                               */ 01298000
*   /* PROCEDURE NAME - PROCBVR                              @Z40LB25*/ 01299000
*   /*                                                       @Z40LB25*/ 01300000
*   /* FUNCTION - THE INPUT BVR HAS ALREADY BEEN DELETED.    @Z40LB25*/ 01301000
*   /* IF THE BVR IS GROUPED, GET THE GHR, UPDATE IT, CHAIN  @Z40LB25*/ 01302000
*   /* THE BVR OUT OF THE GHR, AND WRITE THE GHR.            @Z40LB25*/ 01303000
*   /* IF THE BVR WAS GROUPED, ACTIVE AND GENERAL-USE        @Z40LB25*/ 01304000
*   /* DELETE ITS GROUP VOLUME SERIAL NUMBER EXTENSION       @Z40LB25*/ 01305000
*   /* SLOT. LOCATE A DVR FOR THE BVR, IF ANY, AND MAKE      @Z40LB25*/ 01306000
*   /* IT THE BVR. IF NO DVR IS FOUND, THEN DELETE THE       @Z40LB25*/ 01307000
*   /* BVR FROM THE NGHR CHAIN OF BVRS, IF THE BVR           @Z40LB25*/ 01308000
*   /* IS NON-GROUPED.                                       @Z40LB25*/ 01309000
*   /*                                                       @Z40LB25*/ 01310000
*   /* INPUT -                                               @Z40LB25*/ 01311000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01312000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 01313000
*   /*                                                       @Z40LB25*/ 01314000
*   /* OUTPUT -                                              @Z40LB25*/ 01315000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01316000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 01317000
*   /* GROUP HEADER RECORD                                   @Z40LB25*/ 01318000
*   /* NON-GROUP HEADER RECORD                               @Z40LB25*/ 01319000
*   /*                                                               */ 01320000
*   /*****************************************************************/ 01321000
*                                                                  0379 01322000
*PROCBVR:                           /*                       @Z40LB25*/ 01323000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01324000
*                                                                  0379 01325000
PROCBVR  ST    @14,@SA00012                                        0379 01326000
*   /*****************************************************************/ 01327000
*   /*                                                               */ 01328000
*   /* CHECK FOR A GROUPED BVR.                              @Z40LB25*/ 01329000
*   /*                                                               */ 01330000
*   /*****************************************************************/ 01331000
*                                                                  0380 01332000
*   IF BASGRPV=ON                   /* GROUPED?              @Z40LB25*/ 01333000
*     THEN                          /* YES                   @Z40LB25*/ 01334000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0380 01335000
         BNO   @RF00380                                            0380 01336000
*     DO;                           /*                       @Z40LB25*/ 01337000
*                                                                  0381 01338000
*       /*************************************************************/ 01339000
*       /*                                                           */ 01340000
*       /* UPDATE THE GROUP HEADER RECORD.                   @Z40LB25*/ 01341000
*       /* THE CALLING ROUTINE HAS READ THE GHR FOR UPDATE.  @Z40LB25*/ 01342000
*       /* CHAIN THE BVR OUT OF THE GHR.                     @Z40LB25*/ 01343000
*       /*                                                           */ 01344000
*       /*************************************************************/ 01345000
*                                                                  0382 01346000
*       GRPFLG=ON;                  /* SET GROUP FLAG        @Z40LB25*/ 01347000
         OI    GRPFLG,B'00010000'                                  0382 01348000
*       CALL ICBVUCHO(PTRGROUP,PTRBASEV,PTRRPLV,PASSBYTE);/* @Z40LB25   01349000
*                                      CHAIN BVR OUT GHR     @Z40LB25*/ 01350000
         L     @15,@CV00543                                        0383 01351000
         LA    @01,@AL00383                                        0383 01352000
         BALR  @14,@15                                             0383 01353000
*       IF RPLVRETC¬=OKZERO         /* CHECK RETURN CODE     @Z40LB25*/ 01354000
*         THEN                      /* ERROR                 @Z40LB25*/ 01355000
         LH    @09,RPLVRETC(,RPLVPTR)                              0384 01356000
         N     @09,@CF00613                                        0384 01357000
         LTR   @09,@09                                             0384 01358000
         BNZ   @RT00384                                            0384 01359000
*         RETURN;                   /*                       @Z40LB25*/ 01360000
*                                                                  0385 01361000
*       /*************************************************************/ 01362000
*       /*                                                           */ 01363000
*       /* REESTABLISH RPLV FOR WRITING THE GHR              @Z40LB25*/ 01364000
*       /*                                                           */ 01365000
*       /*************************************************************/ 01366000
*                                                                  0386 01367000
*       GROUPKY=BASGROUP;           /* SET THE KEY           @Z40LB25*/ 01368000
         MVC   GROUPKY(8),BASGROUP(BASEVPTR)                       0386 01369000
*       RPLVKEY=ADDR(GKEY);         /* PTR TO KEY            @Z40LB25*/ 01370000
         LA    @09,GKEY                                            0387 01371000
         ST    @09,RPLVKEY(,RPLVPTR)                               0387 01372000
*       CALL READUPD1;              /* GET GHR               @Z40LB25*/ 01373000
         BAL   @14,READUPD1                                        0388 01374000
*       IF RPLVRETC¬=OKZERO         /* CHECK RETURN CODE     @Z40LB25*/ 01375000
*         THEN                      /* ERROR                 @Z40LB25*/ 01376000
         LH    @09,RPLVRETC(,RPLVPTR)                              0389 01377000
         N     @09,@CF00613                                        0389 01378000
         LTR   @09,@09                                             0389 01379000
         BNZ   @RT00389                                            0389 01380000
*         RETURN;                   /*                       @Z40LB25*/ 01381000
*                                                                  0390 01382000
*       /*************************************************************/ 01383000
*       /*                                                           */ 01384000
*       /* WRITE THE GHR.                                    @Z40LB25*/ 01385000
*       /*                                                           */ 01386000
*       /*************************************************************/ 01387000
*                                                                  0391 01388000
*       RPLVBUF=ADDR(GROUPBUF);     /* PTR TO GHR            @Z40LB25*/ 01389000
         LA    @09,GROUPBUF                                        0391 01390000
         ST    @09,RPLVBUF(,RPLVPTR)                               0391 01391000
*       CALL WRITRECD;              /* WRITE GHR             @Z40LB25*/ 01392000
         BAL   @14,WRITRECD                                        0392 01393000
*       IF RPLVRETC¬=OKZERO         /* CHECK RETURN CODE     @Z40LB25*/ 01394000
*         THEN                      /* ERROR                 @Z40LB25*/ 01395000
         LH    @09,RPLVRETC(,RPLVPTR)                              0393 01396000
         N     @09,@CF00613                                        0393 01397000
         LTR   @09,@09                                             0393 01398000
         BNZ   @RT00393                                            0393 01399000
*         RETURN;                   /*                       @Z40LB25*/ 01400000
*                                                                  0394 01401000
*       /*************************************************************/ 01402000
*       /*                                                           */ 01403000
*       /* CHECK FOR ACTIVE GENERAL-USE TO DELETE            @Z40LB25*/ 01404000
*       /* ITS GHSNER SLOT.                                  @Z40LB25*/ 01405000
*       /*                                                           */ 01406000
*       /*************************************************************/ 01407000
*                                                                  0395 01408000
*       IF BASINAC=OFF&BASGENUS=ON  /* ACT & GEN-USE?        @Z40LB25*/ 01409000
*         THEN                      /* YES                   @Z40LB25*/ 01410000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0395 01411000
         BNO   @RF00395                                            0395 01412000
         TM    BASINAC(BASEVPTR),B'00000100'                       0395 01413000
         BNZ   @RF00395                                            0395 01414000
*         DO;                       /*                       @Z40LB25*/ 01415000
*           ADDSUBSL=OFF;           /* DELETE SLOT           @Z40LB25*/ 01416000
         NI    ADDSUBSL,B'11111101'                                0397 01417000
*           EXPSLOT=OFF;            /* NO UPDT EXPIR DATE    @Z40LB25*/ 01418000
         NI    EXPSLOT,B'01111111'                                 0398 01419000
*           CALL ICBVUEXT(PTRGROUP,PTRBASEV,PTRRPLV,PASSBYTE);/*   0399 01420000
*                                      DELETE GHSNER SLOT    @Z40LB25*/ 01421000
         L     @15,@CV00541                                        0399 01422000
         LA    @01,@AL00399                                        0399 01423000
         BALR  @14,@15                                             0399 01424000
*           IF RPLVRETC¬=OKZERO     /* ERROR?                @Z40LB25*/ 01425000
*             THEN                  /* YES                   @Z40LB25*/ 01426000
         LH    @09,RPLVRETC(,RPLVPTR)                              0400 01427000
         N     @09,@CF00613                                        0400 01428000
         LTR   @09,@09                                             0400 01429000
         BNZ   @RT00400                                            0400 01430000
*             RETURN;               /*                       @Z40LB25*/ 01431000
*         END;                      /*                       @Z40LB25*/ 01432000
*     END;                          /*                       @Z40LB25*/ 01433000
*                                                                  0403 01434000
@RF00395 DS    0H                                                  0404 01435000
*   /*****************************************************************/ 01436000
*   /*                                                               */ 01437000
*   /* CHECK FOR A DUP VOLUME RECORD FOR THE DELETED         @Z40LB25*/ 01438000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 01439000
*   /*                                                               */ 01440000
*   /*****************************************************************/ 01441000
*                                                                  0404 01442000
*   DVOLKY=BASSERNO;                /* SET VOLID IN KEY      @Z40LB25*/ 01443000
@RF00380 MVC   DVOLKY(6),BASSERNO(BASEVPTR)                        0404 01444000
*   DIDKY=IDONE;                    /* SET KEY               @Z40LB25*/ 01445000
         MVI   DIDKY,X'01'                                         0405 01446000
*   RPLVKEY=ADDR(DKEY);             /* ADDR OF KEY           @Z40LB25*/ 01447000
         LA    @09,DKEY                                            0406 01448000
         ST    @09,RPLVKEY(,RPLVPTR)                               0406 01449000
*   RPLVTYP=RPLVREAD;               /* READ OPTION ON        @Z40LB25*/ 01450000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0407 01451000
*   RPLVDIR=ON;                     /* DIRECT                @Z40LB25*/ 01452000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01453000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0409 01454000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0409 01455000
*   RPLVUPD=ON;                     /* SET UPDATE            @Z40LB25*/ 01456000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0410 01457000
*   RPLVKGE=ON;                     /* READ KEY = OR >       @Z40LB25*/ 01458000
         OI    RPLVKGE(RPLVPTR),B'00000100'                        0411 01459000
*   RPLVBUF=DUPVPTR;                /* BUFFER PTR            @Z40LB25*/ 01460000
         ST    DUPVPTR,RPLVBUF(,RPLVPTR)                           0412 01461000
*   RPLVBLN=LENGTH(DUPVBUF);        /* BUFFER LENGTH         @Z40LB25*/ 01462000
         MVC   RPLVBLN(4,RPLVPTR),@CF00608                         0413 01463000
*   RESPECIFY                                                      0414 01464000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01465000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01466000
         LR    RG1,RPLVPTR                                         0415 01467000
*   CALL ICBVIO00;                  /* READ FOR DVR          @Z40LB25*/ 01468000
         L     @15,@CV00537                                        0416 01469000
         BALR  @14,@15                                             0416 01470000
*   RESPECIFY                                                      0417 01471000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01472000
*   RPLVKGE=OFF;                    /* NO > OR =             @Z40LB25*/ 01473000
         NI    RPLVKGE(RPLVPTR),B'11111011'                        0418 01474000
*   IF RPLRCODE=IOERROR             /* CHECK REASON CODE     @Z40LB25*/ 01475000
*     THEN                          /* YES                   @Z40LB25*/ 01476000
         CLC   RPLRCODE(2,RPLVPTR),@CB00525                        0419 01477000
         BE    @RT00419                                            0419 01478000
*     RETURN;                       /*                       @Z40LB25*/ 01479000
*   IF DKY¬=DUPD|DVOLKY¬=DUPSERNO   /* DVR FOUND?            @Z40LB25*/ 01480000
*     THEN                          /* NO                    @Z40LB25*/ 01481000
         CLC   DKY(5),DUPD(DUPVPTR)                                0421 01482000
         BNE   @RT00421                                            0421 01483000
         CLC   DVOLKY(6),DUPSERNO(DUPVPTR)                         0421 01484000
         BE    @RF00421                                            0421 01485000
@RT00421 DS    0H                                                  0422 01486000
*     DO;                           /*                       @Z40LB25*/ 01487000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETURN CODE      @Z40LB25*/ 01488000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0423 01489000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASON CODE      @Z40LB25*/ 01490000
*                                                                  0424 01491000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0424 01492000
*       /*************************************************************/ 01493000
*       /*                                                           */ 01494000
*       /* NO DVR WAS FOUND.                                 @Z40LB25*/ 01495000
*       /*                                                           */ 01496000
*       /*************************************************************/ 01497000
*                                                                  0425 01498000
*       IF BASGRPV=OFF              /* BVR NOT GRPD?         @Z40LB25*/ 01499000
*         THEN                      /* YES                   @Z40LB25*/ 01500000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0425 01501000
         BNZ   @RF00425                                            0425 01502000
*         DO;                       /*                       @Z40LB25*/ 01503000
*                                                                  0426 01504000
*           /*********************************************************/ 01505000
*           /*                                                       */ 01506000
*           /* CHAIN THE BVR OUT OF THE NGHR.                @Z40LB25*/ 01507000
*           /* CHECK FOR NON-GROUPED.                        @Z40LB25*/ 01508000
*           /*                                                       */ 01509000
*           /*********************************************************/ 01510000
*                                                                  0427 01511000
*           GRPFLG=OFF;             /* NON-GROUPED           @Z40LB25*/ 01512000
         NI    GRPFLG,B'11101111'                                  0427 01513000
*           CALL ICBVUCHO(ZEROCORE,PTRBASEV,PTRRPLV,PASSBYTE);/*   0428 01514000
*                                                            @Z40LB25   01515000
*                                      CHAIN BVR OUT NGHR    @Z40LB25*/ 01516000
         L     @15,@CV00543                                        0428 01517000
         LA    @01,@AL00428                                        0428 01518000
         BALR  @14,@15                                             0428 01519000
*         END;                      /*                       @Z40LB25*/ 01520000
*       RETURN;                     /*                       @Z40LB25*/ 01521000
@EL00012 DS    0H                                                  0430 01522000
@EF00012 DS    0H                                                  0430 01523000
@ER00012 L     @14,@SA00012                                        0430 01524000
         BR    @14                                                 0430 01525000
*     END;                          /*                       @Z40LB25*/ 01526000
*                                                                  0431 01527000
*   /*****************************************************************/ 01528000
*   /*                                                               */ 01529000
*   /* DVR WAS FOUND.                                        @Z40LB25*/ 01530000
*   /*                                                               */ 01531000
*   /*****************************************************************/ 01532000
*                                                                  0432 01533000
*   ELSE                            /* DVR WAS FOUND         @Z40LB25*/ 01534000
*     DO;                           /*                       @Z40LB25*/ 01535000
*                                                                  0432 01536000
@RF00421 DS    0H                                                  0433 01537000
*       /*************************************************************/ 01538000
*       /*                                                           */ 01539000
*       /* CHECK FOR A GROUPED BVR.                          @Z40LB25*/ 01540000
*       /*                                                           */ 01541000
*       /*************************************************************/ 01542000
*                                                                  0433 01543000
*       IF BASGRPV=ON               /* BVR GROUPED?          @Z40LB25*/ 01544000
*         THEN                      /* YES                   @Z40LB25*/ 01545000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0433 01546000
         BNO   @RF00433                                            0433 01547000
*         DO;                       /*                       @Z40LB25*/ 01548000
*                                                                  0434 01549000
*           /*********************************************************/ 01550000
*           /*                                                       */ 01551000
*           /* MAKE A DVR INTO A BASE.                       @Z40LB25*/ 01552000
*           /* ICBVUDBR RETURNS THE POINTER TO THE           @Z40LB25*/ 01553000
*           /* BVR IT CREATED IN PTRBASEV.                   @Z40LB25*/ 01554000
*           /*                                                       */ 01555000
*           /*********************************************************/ 01556000
*                                                                  0435 01557000
*           GRPDV=ON;               /* GROUPED FLAG ON       @Z40LB25*/ 01558000
         OI    GRPDV,B'10000000'                                   0435 01559000
*           CALL ICBVUDBR(PTRDUPV,PTRBASEV,PTRRPLV,PASSBYTE,/*     0436 01560000
*                                                            @Z40LB25*/ 01561000
*               ZEROCORE,ZEROCORE); /*                       @Z40LB25   01562000
*                                      MAKE DVR A BVR        @Z40LB25*/ 01563000
         L     @15,@CV00540                                        0436 01564000
         LA    @01,@AL00436                                        0436 01565000
         BALR  @14,@15                                             0436 01566000
*           IF RPLVRETC¬=OKZERO     /* CHECK RETURN CODE     @Z40LB25*/ 01567000
*             THEN                  /* ERROR                 @Z40LB25*/ 01568000
         LH    @05,RPLVRETC(,RPLVPTR)                              0437 01569000
         N     @05,@CF00613                                        0437 01570000
         LTR   @05,@05                                             0437 01571000
         BNZ   @RT00437                                            0437 01572000
*             RETURN;               /*                       @Z40LB25*/ 01573000
*                                                                  0438 01574000
*           /*********************************************************/ 01575000
*           /*                                                       */ 01576000
*           /* CHAIN THE BVR INTO THE NGHR.                  @Z40LB25*/ 01577000
*           /*                                                       */ 01578000
*           /*********************************************************/ 01579000
*                                                                  0439 01580000
*           GRPFLG=OFF;             /* NON-GROUPED           @Z40LB25*/ 01581000
         NI    GRPFLG,B'11101111'                                  0439 01582000
*           CALL ICBVUCHI(ZEROCORE,PTRBASEV,PTRRPLV,PASSBYTE);/*   0440 01583000
*                                                            @Z40LB25   01584000
*                                      CHAIN BVR IN NGHR     @Z40LB25*/ 01585000
         L     @15,@CV00544                                        0440 01586000
         LA    @01,@AL00440                                        0440 01587000
         BALR  @14,@15                                             0440 01588000
*           IF RPLVRETC¬=OKZERO     /* CHECK RETURN CODE     @Z40LB25*/ 01589000
*             THEN                  /* ERROR                 @Z40LB25*/ 01590000
         LH    @05,RPLVRETC(,RPLVPTR)                              0441 01591000
         N     @05,@CF00613                                        0441 01592000
         LTR   @05,@05                                             0441 01593000
         BNZ   @RT00441                                            0441 01594000
*             RETURN;               /*                       @Z40LB25*/ 01595000
*         END;                      /*                       @Z40LB25*/ 01596000
*       ELSE                        /* NOT GROUPED           @Z40LB25*/ 01597000
*                                                                  0444 01598000
*         /***********************************************************/ 01599000
*         /*                                                         */ 01600000
*         /* MAKE THE DVR INTO A BVR.                        @Z40LB25*/ 01601000
*         /*                                                         */ 01602000
*         /***********************************************************/ 01603000
*                                                                  0444 01604000
*         DO;                       /*                       @Z40LB25*/ 01605000
         B     @RC00433                                            0444 01606000
@RF00433 DS    0H                                                  0445 01607000
*           GRPDV=OFF;              /* GROUPED FLAG OFF      @Z40LB25*/ 01608000
         NI    GRPDV,B'01111111'                                   0445 01609000
*           IF BASFIRST=ON          /* 1ST BVR IN CHAIN?     @Z40LB25*/ 01610000
*             THEN                  /* YES                   @Z40LB25*/ 01611000
         TM    BASFIRST(BASEVPTR),B'00010000'                      0446 01612000
         BNO   @RF00446                                            0446 01613000
*             FRSTDV=ON;            /* SET 1ST FLG ON        @Z40LB25*/ 01614000
         OI    FRSTDV,B'01000000'                                  0447 01615000
*           IF BASLAST=ON           /* LAST BVR IN CHAIN?    @Z40LB25*/ 01616000
*             THEN                  /* YES                   @Z40LB25*/ 01617000
@RF00446 TM    BASLAST(BASEVPTR),B'00001000'                       0448 01618000
         BNO   @RF00448                                            0448 01619000
*             LASTDV=ON;            /* SET LAST FLG ON       @Z40LB25*/ 01620000
         OI    LASTDV,B'00100000'                                  0449 01621000
*           CALL ICBVUDBR(PTRDUPV,PTRBASEV,PTRRPLV,PASSBYTE,/*     0450 01622000
*                                                            @Z40LB25*/ 01623000
*               BASPREV,BASNEXTV);  /*                       @Z40LB25   01624000
*                                      MAKE DVR A BVR        @Z40LB25*/ 01625000
@RF00448 MVC   @AL00001(16),@AL00450                               0450 01626000
         LA    @03,BASPREV(,BASEVPTR)                              0450 01627000
         ST    @03,@AL00001+16                                     0450 01628000
         LA    @03,BASNEXTV(,BASEVPTR)                             0450 01629000
         ST    @03,@AL00001+20                                     0450 01630000
         L     @15,@CV00540                                        0450 01631000
         LA    @01,@AL00001                                        0450 01632000
         BALR  @14,@15                                             0450 01633000
*           IF RPLVRETC¬=OKZERO     /* CHECK RETURN CODE     @Z40LB25*/ 01634000
*             THEN                  /* ERROR                 @Z40LB25*/ 01635000
         LH    @05,RPLVRETC(,RPLVPTR)                              0451 01636000
         N     @05,@CF00613                                        0451 01637000
         LTR   @05,@05                                             0451 01638000
         BNZ   @RT00451                                            0451 01639000
*             RETURN;               /*                       @Z40LB25*/ 01640000
*         END;                      /*                       @Z40LB25*/ 01641000
*     END;                          /*                       @Z40LB25*/ 01642000
*                                                                  0454 01643000
@RC00433 DS    0H                                                  0455 01644000
*   /*****************************************************************/ 01645000
*   /*                                                               */ 01646000
*   /* WRITE THE NEW BVR.                                    @Z40LB25*/ 01647000
*   /*                                                               */ 01648000
*   /*****************************************************************/ 01649000
*                                                                  0455 01650000
*   RPLVTYP=RPLVPUT;                /* WRITE BVR             @Z40LB25*/ 01651000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0455 01652000
*   RPLVBUF=PTRBASEV;               /* PTR TO NEW BVR        @Z40LB25*/ 01653000
         L     @05,PTRBASEV                                        0456 01654000
         ST    @05,RPLVBUF(,RPLVPTR)                               0456 01655000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Z40LB25*/ 01656000
         NI    RPLVUPD(RPLVPTR),B'11111101'                        0457 01657000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01658000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0458 01659000
*   RPLVBLN=LENGTH(BASEBUF);        /* SET BUF LENGTH        @Z40LB25*/ 01660000
         LA    @05,224                                             0459 01661000
         ST    @05,RPLVBLN(,RPLVPTR)                               0459 01662000
*   RPLVRLN=LENGTH(BASEBUF);        /* SET BVR LENGTH        @Z40LB25*/ 01663000
         ST    @05,RPLVRLN(,RPLVPTR)                               0460 01664000
*   CALL WRITRECD;                  /* WRITE BVR             @Z40LB25*/ 01665000
         BAL   @14,WRITRECD                                        0461 01666000
*   RETURN;                         /*                       @Z40LB25*/ 01667000
         B     @EL00012                                            0462 01668000
*   END PROCBVR;                    /*                       @Z40LB25*/ 01669000
         B     @EL00012                                            0463 01670000
*   END ICBVUT03                    /* THE END               @Z40LB25*/ 01671000
*                                                                  0464 01672000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01673000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 01674000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 01675000
*/*%INCLUDE SYSLIB  (IEZINDEX)                                       */ 01676000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 01677000
*/*%INCLUDE SYSLIB  (IEZNGVR )                                       */ 01678000
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */ 01679000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 01680000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 01681000
*/*%INCLUDE SYSLIB  (IEZDUPV )                                       */ 01682000
*                                                                  0464 01683000
*       ;                                                          0464 01684000
@DATA    DS    0H                                                       01685000
@CH00036 DC    H'4'                                                     01686000
         DS    0F                                                       01687000
@AL00186 EQU   *                       LIST WITH   3 ARGUMENT(S)        01688000
@AL00271 DC    A(PTRGROUP)             LIST WITH   3 ARGUMENT(S)        01689000
         DC    A(PTRBASEV)                                              01690000
         DC    A(PASSBYTE)                                              01691000
@AL00223 DC    A(PTRCOPYV)             LIST WITH   3 ARGUMENT(S)        01692000
         DC    A(PTRRPLV)                                               01693000
         DC    A(PASSBYTE)                                              01694000
@AL00281 EQU   *                       LIST WITH   4 ARGUMENT(S)        01695000
@AL00383 EQU   *                       LIST WITH   4 ARGUMENT(S)        01696000
@AL00399 DC    A(PTRGROUP)             LIST WITH   4 ARGUMENT(S)        01697000
         DC    A(PTRBASEV)                                              01698000
         DC    A(PTRRPLV)                                               01699000
         DC    A(PASSBYTE)                                              01700000
@AL00428 EQU   *                       LIST WITH   4 ARGUMENT(S)        01701000
@AL00440 DC    A(@CF00080)             LIST WITH   4 ARGUMENT(S)        01702000
         DC    A(PTRBASEV)                                              01703000
         DC    A(PTRRPLV)                                               01704000
         DC    A(PASSBYTE)                                              01705000
@AL00436 EQU   *                       LIST WITH   6 ARGUMENT(S)        01706000
@AL00450 DC    A(PTRDUPV)              LIST WITH   4 ARGUMENT(S)        01707000
         DC    A(PTRBASEV)                                              01708000
         DC    A(PTRRPLV)                                               01709000
         DC    A(PASSBYTE)                                              01710000
         DC    A(@CF00080)                                              01711000
         DC    A(@CF00080)                                              01712000
         DS    0F                                                       01713000
@SA00001 DS    18F                                                      01714000
@SA00002 DS    1F                                                       01715000
@SA00003 DS    1F                                                       01716000
@SA00004 DS    1F                                                       01717000
@SA00006 DS    1F                                                       01718000
@SA00012 DS    1F                                                       01719000
@SA00005 DS    1F                                                       01720000
@SA00009 DS    0F                                                       01721000
@SA00011 DS    0F                                                       01722000
@SA00008 DS    0F                                                       01723000
@SA00010 DS    0F                                                       01724000
@SA00007 DS    0F                                                       01725000
         DS    1F                                                       01726000
@AL00001 DS    6A                                                       01727000
         DS    0F                                                       01728000
@CF00080 DC    F'0'                                                     01729000
@CF00607 DC    F'36'                                                    01730000
@CF00608 DC    F'224'                                                   01731000
@CF00613 DC    XL4'0000FFFF'                                            01732000
@CV00537 DC    V(ICBVIO00)                                              01733000
@CV00538 DC    V(ICBVRR00)                                              01734000
@CV00539 DC    V(ICBVJL00)                                              01735000
@CV00540 DC    V(ICBVUDBR)                                              01736000
@CV00541 DC    V(ICBVUEXT)                                              01737000
@CV00542 DC    V(ICBVUBVR)                                              01738000
@CV00543 DC    V(ICBVUCHO)                                              01739000
@CV00544 DC    V(ICBVUCHI)                                              01740000
@CV00545 DC    V(ICBVUPGH)                                              01741000
         DS    0D                                                       01742000
PTRRPLV  DS    A                                                        01743000
PTRGROUP DS    A                                                        01744000
PTRBASEV DS    A                                                        01745000
PTRCOPYV DS    A                                                        01746000
PTRDUPV  DS    A                                                        01747000
@CB00521 DC    X'FFFFFFFF'                                              01748000
@CB00523 DC    X'0208'                                                  01749000
@CB00525 DC    X'0209'                                                  01750000
@CB00527 DC    X'0213'                                                  01751000
GROUPBUF DS    CL164                                                    01752000
TEMPBUF  DS    CL224                                                    01753000
NGVRBUF  DS    CL40                                                     01754000
BASEBUF  DS    CL224                                                    01755000
COPYBUF  DS    CL164                                                    01756000
INDEXBUF DS    CL36                                                     01757000
DUPVBUF  DS    CL224                                                    01758000
         DS    CL2                                                      01759000
GKEY     DS    CL13                                                     01760000
         ORG   GKEY                                                     01761000
GKY      DC    CL3'G  '                                                 01762000
GROUPKY  DS    CL8                                                      01763000
GBLKKY   DC    CL1' '                                                   01764000
GIDKY    DC    XL1'00'                                                  01765000
         ORG   GKEY+13                                                  01766000
         DS    CL3                                                      01767000
BKEY     DS    CL13                                                     01768000
         ORG   BKEY                                                     01769000
BKY      DC    CL5'V    '                                               01770000
BVOLKY   DS    CL6                                                      01771000
BBLKKY   DC    CL1' '                                                   01772000
BIDKY    DC    XL1'00'                                                  01773000
         ORG   BKEY+13                                                  01774000
         DS    CL3                                                      01775000
DKEY     DS    CL13                                                     01776000
         ORG   DKEY                                                     01777000
DKY      DC    CL5'D    '                                               01778000
DVOLKY   DS    CL6                                                      01779000
DBLKKY   DC    CL1' '                                                   01780000
DIDKY    DS    FL1                                                      01781000
         ORG   DKEY+13                                                  01782000
         DS    CL3                                                      01783000
CKEY     DS    CL13                                                     01784000
         ORG   CKEY                                                     01785000
CKY      DC    CL5'V    '                                               01786000
CVOLKY   DS    CL6                                                      01787000
CBLKKY   DC    CL1' '                                                   01788000
CIDKY    DS    FL1                                                      01789000
         ORG   CKEY+13                                                  01790000
         DS    CL3                                                      01791000
IKEY     DS    CL13                                                     01792000
         ORG   IKEY                                                     01793000
IKY      DC    CL1'I'                                                   01794000
IVOLKY   DS    CL12                                                     01795000
         ORG   IKEY+13                                                  01796000
         DS    CL3                                                      01797000
NGKEY    DC    CL13'N   HEADER   '                                      01798000
         DS    CL3                                                      01799000
WORKAREA DS    CL19                                                     01800000
         ORG   WORKAREA                                                 01801000
REACODE  DS    CL2                                                      01802000
RETCODE  DS    CL2                                                      01803000
BCDKEY   DS    CL13                                                     01804000
PASSBYTE DS    CL2                                                      01805000
         ORG   PASSBYTE                                                 01806000
GRPDV    DS    BL1                                                      01807000
FRSTDV   EQU   PASSBYTE+0                                               01808000
LASTDV   EQU   PASSBYTE+0                                               01809000
GRPFLG   EQU   PASSBYTE+0                                               01810000
ADDSUBGR EQU   PASSBYTE+0                                               01811000
CSNUMBER EQU   PASSBYTE+0                                               01812000
ADDSUBSL EQU   PASSBYTE+0                                               01813000
RPLVFLG  EQU   PASSBYTE+0                                               01814000
EXPSLOT  DS    BL1                                                      01815000
ADDSUB   EQU   PASSBYTE+1                                               01816000
@NM00026 EQU   PASSBYTE+1                                               01817000
         ORG   WORKAREA+19                                              01818000
         DS    CL1                                                      01819000
VU3PATCH DS    CL200                                                    01820000
         ORG   VU3PATCH                                                 01821000
@NM00027 DC    200X'00'                                                 01822000
         ORG   VU3PATCH+200                                             01823000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01824000
@01      EQU   01                                                       01825000
@02      EQU   02                                                       01826000
@03      EQU   03                                                       01827000
@04      EQU   04                                                       01828000
@05      EQU   05                                                       01829000
@06      EQU   06                                                       01830000
@07      EQU   07                                                       01831000
@08      EQU   08                                                       01832000
@09      EQU   09                                                       01833000
@10      EQU   10                                                       01834000
@11      EQU   11                                                       01835000
@12      EQU   12                                                       01836000
@13      EQU   13                                                       01837000
@14      EQU   14                                                       01838000
@15      EQU   15                                                       01839000
PTRNGVR  EQU   @02                                                      01840000
NULCPTR  EQU   @07                                                      01841000
DUPVPTR  EQU   @08                                                      01842000
COPYVPTR EQU   @07                                                      01843000
BASEVPTR EQU   @05                                                      01844000
BCDVPTR  EQU   @02                                                      01845000
NGVRPTR  EQU   @10                                                      01846000
GROUPPTR EQU   @06                                                      01847000
INDEXPTR EQU   @02                                                      01848000
RPLVPTR  EQU   @04                                                      01849000
VVIPTR   EQU   @09                                                      01850000
RG0      EQU   @00                                                      01851000
RG1      EQU   @01                                                      01852000
RG14     EQU   @14                                                      01853000
NULBR1   EQU   @01                                                      01854000
RG10     EQU   @10                                                      01855000
RG11     EQU   @11                                                      01856000
RG12     EQU   @12                                                      01857000
RG13     EQU   @13                                                      01858000
RG15     EQU   @15                                                      01859000
RG2      EQU   @02                                                      01860000
RG3      EQU   @03                                                      01861000
RG4      EQU   @04                                                      01862000
RG5      EQU   @05                                                      01863000
RG6      EQU   @06                                                      01864000
RG7      EQU   @07                                                      01865000
RG8      EQU   @08                                                      01866000
RG9      EQU   @09                                                      01867000
VVICB    EQU   0                                                        01868000
VVIFLGA  EQU   VVICB+15                                                 01869000
VVIFLG0  EQU   VVIFLGA                                                  01870000
RPLV     EQU   0                                                        01871000
RPLTCBPR EQU   RPLV+8                                                   01872000
RPLVVICB EQU   RPLV+12                                                  01873000
RPLFLAGA EQU   RPLV+28                                                  01874000
RPLRCODE EQU   RPLV+32                                                  01875000
RPLVRETC EQU   RPLV+34                                                  01876000
RPLVSAM  EQU   RPLV+56                                                  01877000
RPLVTYP  EQU   RPLVSAM+2                                                01878000
RPLVBUF  EQU   RPLVSAM+32                                               01879000
RPLVKEY  EQU   RPLVSAM+36                                               01880000
RPLVOPT  EQU   RPLVSAM+40                                               01881000
RPLVLOC  EQU   RPLVOPT                                                  01882000
RPLVDIR  EQU   RPLVOPT                                                  01883000
RPLVKGE  EQU   RPLVOPT                                                  01884000
RPLVUPD  EQU   RPLVOPT+1                                                01885000
RPLVRLN  EQU   RPLVSAM+48                                               01886000
RPLVBLN  EQU   RPLVSAM+52                                               01887000
RPLVUTIL EQU   RPLV+132                                                 01888000
INDEX    EQU   0                                                        01889000
INDNAME  EQU   INDEX                                                    01890000
INDTYPE  EQU   INDEX+13                                                 01891000
INDRECKY EQU   INDEX+15                                                 01892000
INDPREFX EQU   INDRECKY                                                 01893000
INDRECID EQU   INDRECKY+11                                              01894000
GROUP    EQU   0                                                        01895000
GRONAME  EQU   GROUP                                                    01896000
GROID    EQU   GRONAME+11                                               01897000
GROFLAGA EQU   GROUP+13                                                 01898000
GROTYPE  EQU   GROFLAGA                                                 01899000
GRONGEN  EQU   GROUP+30                                                 01900000
GRONRSTD EQU   GROUP+32                                                 01901000
GRONINAC EQU   GROUP+34                                                 01902000
GROERRTS EQU   GROUP+56                                                 01903000
NGVR     EQU   0                                                        01904000
NGVNAME  EQU   NGVR                                                     01905000
NGVRTYPE EQU   NGVR+13                                                  01906000
BCDV     EQU   0                                                        01907000
BCDNAME  EQU   BCDV                                                     01908000
BCDPREFX EQU   BCDNAME                                                  01909000
BCDID    EQU   BCDNAME+11                                               01910000
BCDFLAGA EQU   BCDV+14                                                  01911000
BCDTYPE  EQU   BCDFLAGA                                                 01912000
BCDBASE  EQU   BCDTYPE                                                  01913000
BCDCOPY  EQU   BCDTYPE                                                  01914000
BCDDUP   EQU   BCDTYPE                                                  01915000
BCDFLAGB EQU   BCDFLAGA+2                                               01916000
BCDRCVYF EQU   BCDV+20                                                  01917000
BCDSATIA EQU   BCDRCVYF                                                 01918000
BCDMISCF EQU   BCDRCVYF+2                                               01919000
BCDCSN1  EQU   BCDV+24                                                  01920000
BCDLIB1  EQU   BCDV+36                                                  01921000
BCDLID1  EQU   BCDLIB1                                                  01922000
BCDCSN2  EQU   BCDV+37                                                  01923000
BCDLIB2  EQU   BCDV+49                                                  01924000
BCDLID2  EQU   BCDLIB2                                                  01925000
BASEV    EQU   0                                                        01926000
BASNAME  EQU   BASEV                                                    01927000
BASSERNO EQU   BASNAME+5                                                01928000
BASID    EQU   BASNAME+11                                               01929000
BASFLAGA EQU   BASEV+14                                                 01930000
BASTYPE  EQU   BASFLAGA                                                 01931000
BASGRPV  EQU   BASFLAGA+2                                               01932000
BASGENUS EQU   BASFLAGA+2                                               01933000
BASRSTD  EQU   BASFLAGA+2                                               01934000
BASINAC  EQU   BASFLAGA+2                                               01935000
BASREASS EQU   BASFLAGA+3                                               01936000
BASFIRST EQU   BASFLAGA+3                                               01937000
BASLAST  EQU   BASFLAGA+3                                               01938000
BASRCVYF EQU   BASEV+20                                                 01939000
BASSATIA EQU   BASRCVYF                                                 01940000
BASMISCF EQU   BASRCVYF+2                                               01941000
BASLIB1  EQU   BASEV+36                                                 01942000
BASLID1  EQU   BASLIB1                                                  01943000
BASLIB2  EQU   BASEV+49                                                 01944000
BASLID2  EQU   BASLIB2                                                  01945000
BASPREV  EQU   BASEV+50                                                 01946000
BASNEXTV EQU   BASEV+56                                                 01947000
BASNCOPY EQU   BASEV+62                                                 01948000
BASKLCPY EQU   BASEV+76                                                 01949000
BASCOPID EQU   BASKLCPY+11                                              01950000
BASEXPDT EQU   BASEV+96                                                 01951000
BASGROUP EQU   BASEV+180                                                01952000
COPYV    EQU   0                                                        01953000
COPNAME  EQU   COPYV                                                    01954000
COPID    EQU   COPNAME+11                                               01955000
COPFLAGA EQU   COPYV+14                                                 01956000
COPTYPE  EQU   COPFLAGA                                                 01957000
COPRCVYF EQU   COPYV+20                                                 01958000
COPSATIA EQU   COPRCVYF                                                 01959000
COPMISCF EQU   COPRCVYF+2                                               01960000
COPLIB1  EQU   COPYV+36                                                 01961000
COPLID1  EQU   COPLIB1                                                  01962000
COPLIB2  EQU   COPYV+49                                                 01963000
COPLID2  EQU   COPLIB2                                                  01964000
DUPV     EQU   0                                                        01965000
DUPNAME  EQU   DUPV                                                     01966000
DUPD     EQU   DUPNAME                                                  01967000
DUPSERNO EQU   DUPNAME+5                                                01968000
DUPID    EQU   DUPNAME+11                                               01969000
DUPFLAGA EQU   DUPV+14                                                  01970000
DUPTYPE  EQU   DUPFLAGA                                                 01971000
DUPRCVYF EQU   DUPV+20                                                  01972000
DUPLIB1  EQU   DUPV+36                                                  01973000
DUPLID1  EQU   DUPLIB1                                                  01974000
DUPLIB2  EQU   DUPV+49                                                  01975000
DUPLID2  EQU   DUPLIB2                                                  01976000
LSTNULLC EQU   0                                                        01977000
NULFLAGA EQU   LSTNULLC+6                                               01978000
NULVOL   EQU   NULFLAGA                                                 01979000
NULVOLID EQU   LSTNULLC+8                                               01980000
NULCSN   EQU   LSTNULLC+20                                              01981000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01982000
NULRES2  EQU   LSTNULLC+32                                              01983000
NULECB   EQU   LSTNULLC+16                                              01984000
NULASID  EQU   LSTNULLC+14                                              01985000
@NM00025 EQU   NULFLAGA                                                 01986000
NULCART2 EQU   NULFLAGA                                                 01987000
NULCART1 EQU   NULFLAGA                                                 01988000
@NM00024 EQU   NULFLAGA                                                 01989000
NULSCRC  EQU   NULFLAGA                                                 01990000
NULTRAN  EQU   NULFLAGA                                                 01991000
NULRES1  EQU   LSTNULLC+5                                               01992000
NULORDER EQU   LSTNULLC+4                                               01993000
NULENGTH EQU   LSTNULLC                                                 01994000
@NM00023 EQU   DUPV+50                                                  01995000
DUP2BIT2 EQU   DUPLID2                                                  01996000
DUP2BIT1 EQU   DUPLID2                                                  01997000
DUPRES4  EQU   DUPLIB2                                                  01998000
DUPCSN2  EQU   DUPV+37                                                  01999000
DUP1BIT2 EQU   DUPLID1                                                  02000000
DUP1BIT1 EQU   DUPLID1                                                  02001000
DUPRES3  EQU   DUPLIB1                                                  02002000
DUPCSN1  EQU   DUPV+24                                                  02003000
DUPMISCF EQU   DUPRCVYF+2                                               02004000
DUPSATIA EQU   DUPRCVYF                                                 02005000
@NM00022 EQU   DUPV+18                                                  02006000
@NM00021 EQU   DUPFLAGA+2                                               02007000
DUPRES2  EQU   DUPTYPE                                                  02008000
DUPDUPLR EQU   DUPTYPE                                                  02009000
DUPRES1  EQU   DUPTYPE                                                  02010000
DUPRES5  EQU   DUPV+13                                                  02011000
DUPNO    EQU   DUPID+1                                                  02012000
DUPBLANK EQU   DUPID                                                    02013000
@NM00020 EQU   COPYV+136                                                02014000
COPFREXT EQU   COPYV+132                                                02015000
COPLEXT  EQU   COPYV+130                                                02016000
COPFRESP EQU   COPYV+128                                                02017000
COPOWNER EQU   COPYV+118                                                02018000
COPDEST  EQU   COPYV+88                                                 02019000
COPDESCR EQU   COPYV+58                                                 02020000
COPDTREM EQU   COPYV+54                                                 02021000
COPDATE  EQU   COPYV+50                                                 02022000
COP2BIT2 EQU   COPLID2                                                  02023000
COP2BIT1 EQU   COPLID2                                                  02024000
COPRES5  EQU   COPLIB2                                                  02025000
COPCSN2  EQU   COPYV+37                                                 02026000
COP1BIT2 EQU   COPLID1                                                  02027000
COP1BIT1 EQU   COPLID1                                                  02028000
COPRES4  EQU   COPLIB1                                                  02029000
COPCSN1  EQU   COPYV+24                                                 02030000
@NM00019 EQU   COPMISCF                                                 02031000
COPHOLD  EQU   COPMISCF                                                 02032000
COPRES3  EQU   COPSATIA                                                 02033000
COPVSMIS EQU   COPSATIA                                                 02034000
COPIVCPY EQU   COPSATIA                                                 02035000
COPIVCRE EQU   COPSATIA                                                 02036000
@NM00018 EQU   COPYV+18                                                 02037000
@NM00017 EQU   COPFLAGA+3                                               02038000
COPDLSPF EQU   COPFLAGA+3                                               02039000
COPRONLY EQU   COPFLAGA+3                                               02040000
COPDAERA EQU   COPFLAGA+2                                               02041000
COPEXCL  EQU   COPFLAGA+2                                               02042000
COPBIND  EQU   COPFLAGA+2                                               02043000
COPBKUP  EQU   COPFLAGA+2                                               02044000
COPRSTD  EQU   COPFLAGA+2                                               02045000
COPGENUS EQU   COPFLAGA+2                                               02046000
COPVSAM  EQU   COPFLAGA+2                                               02047000
COPGROUP EQU   COPFLAGA+2                                               02048000
COPRES2  EQU   COPTYPE                                                  02049000
COPCOPYV EQU   COPTYPE                                                  02050000
COPRES1  EQU   COPTYPE                                                  02051000
COPRES6  EQU   COPYV+13                                                 02052000
COPNO    EQU   COPID+1                                                  02053000
COPBLANK EQU   COPID                                                    02054000
COPSERNO EQU   COPNAME+5                                                02055000
COPV     EQU   COPNAME                                                  02056000
@NM00016 EQU   BASEV+192                                                02057000
BASXPDT2 EQU   BASEV+188                                                02058000
BASRECOV EQU   BASEV+174                                                02059000
BASDEST  EQU   BASEV+144                                                02060000
BASOWNER EQU   BASEV+134                                                02061000
BASDESCR EQU   BASEV+104                                                02062000
BASDTREM EQU   BASEV+100                                                02063000
BASDLMTD EQU   BASEV+92                                                 02064000
BASRES6  EQU   BASEV+89                                                 02065000
BASCOPNO EQU   BASCOPID+1                                               02066000
BASCOPBK EQU   BASCOPID                                                 02067000
BASCOPSN EQU   BASKLCPY+5                                               02068000
BASCOPV  EQU   BASKLCPY                                                 02069000
BASFREXT EQU   BASEV+72                                                 02070000
BASLEXT  EQU   BASEV+70                                                 02071000
BASFRESP EQU   BASEV+68                                                 02072000
@NM00015 EQU   BASEV+65                                                 02073000
BASBKLMT EQU   BASEV+64                                                 02074000
BASNBKUP EQU   BASEV+63                                                 02075000
BAS2BIT2 EQU   BASLID2                                                  02076000
BAS2BIT1 EQU   BASLID2                                                  02077000
BASRES5  EQU   BASLIB2                                                  02078000
BASCSN2  EQU   BASEV+37                                                 02079000
BAS1BIT2 EQU   BASLID1                                                  02080000
BAS1BIT1 EQU   BASLID1                                                  02081000
BASRES4  EQU   BASLIB1                                                  02082000
BASCSN1  EQU   BASEV+24                                                 02083000
BASRES3  EQU   BASMISCF                                                 02084000
BASHOLD  EQU   BASMISCF                                                 02085000
BASRES8  EQU   BASSATIA                                                 02086000
BASVSMIS EQU   BASSATIA                                                 02087000
BASIVCPY EQU   BASSATIA                                                 02088000
BASIVCRE EQU   BASSATIA                                                 02089000
BASCPUID EQU   BASEV+18                                                 02090000
@NM00014 EQU   BASFLAGA+3                                               02091000
BASRONLY EQU   BASFLAGA+3                                               02092000
BASDAERA EQU   BASFLAGA+3                                               02093000
BASEXCL  EQU   BASFLAGA+2                                               02094000
BASBIND  EQU   BASFLAGA+2                                               02095000
BASNOCPY EQU   BASFLAGA+2                                               02096000
BASDLSF  EQU   BASFLAGA+2                                               02097000
BASRES2  EQU   BASTYPE                                                  02098000
BASBASVR EQU   BASTYPE                                                  02099000
BASRES1  EQU   BASTYPE                                                  02100000
BASRES7  EQU   BASEV+13                                                 02101000
BASZERO  EQU   BASID+1                                                  02102000
BASBLANK EQU   BASID                                                    02103000
BASEVKEY EQU   BASNAME                                                  02104000
BCD2BIT2 EQU   BCDLID2                                                  02105000
BCD2BIT1 EQU   BCDLID2                                                  02106000
BCDRES8  EQU   BCDLIB2                                                  02107000
BCD1BIT2 EQU   BCDLID1                                                  02108000
BCD1BIT1 EQU   BCDLID1                                                  02109000
BCDRE10  EQU   BCDLIB1                                                  02110000
BCDRES7A EQU   BCDMISCF                                                 02111000
BCDHOLD  EQU   BCDMISCF                                                 02112000
BCDRES7  EQU   BCDSATIA                                                 02113000
BCDVSMIS EQU   BCDSATIA                                                 02114000
BCDIVCPY EQU   BCDSATIA                                                 02115000
BCDIVCRE EQU   BCDSATIA                                                 02116000
BCDCPUID EQU   BCDV+18                                                  02117000
BCDRES5  EQU   BCDFLAGB+1                                               02118000
BCDREASS EQU   BCDFLAGB+1                                               02119000
BCDRES4  EQU   BCDFLAGB                                                 02120000
BCDRES3  EQU   BCDTYPE                                                  02121000
BCDRES2  EQU   BCDTYPE                                                  02122000
BCDRES1  EQU   BCDTYPE                                                  02123000
BCDRES9  EQU   BCDV+13                                                  02124000
BCDINDEX EQU   BCDID+1                                                  02125000
BCDBLNK2 EQU   BCDID                                                    02126000
BCDSERNO EQU   BCDNAME+5                                                02127000
BCDBLNK1 EQU   BCDPREFX+1                                               02128000
BCDALPHA EQU   BCDPREFX                                                 02129000
@NM00013 EQU   NGVR+32                                                  02130000
NGVNOVOL EQU   NGVR+30                                                  02131000
@NM00012 EQU   NGVR+29                                                  02132000
NGVLVOL  EQU   NGVR+23                                                  02133000
NGVFVOL  EQU   NGVR+17                                                  02134000
@NM00011 EQU   NGVR+15                                                  02135000
NGVRES2  EQU   NGVRTYPE+1                                               02136000
NGVHDR   EQU   NGVRTYPE                                                 02137000
NGVRES1  EQU   NGVRTYPE                                                 02138000
@NM00010 EQU   GROUP+136                                                02139000
GROADDR  EQU   GROUP+106                                                02140000
GROOWNER EQU   GROUP+96                                                 02141000
GRORESSP EQU   GROUP+95                                                 02142000
GROCONUS EQU   GROUP+94                                                 02143000
GRODESCR EQU   GROUP+64                                                 02144000
GROERRTM EQU   GROERRTS+4                                               02145000
GROERRDT EQU   GROERRTS                                                 02146000
GRORETPD EQU   GROUP+52                                                 02147000
GROFREXT EQU   GROUP+48                                                 02148000
GROFRESP EQU   GROUP+44                                                 02149000
GROSTRSH EQU   GROUP+40                                                 02150000
GROSSPD  EQU   GROUP+38                                                 02151000
GROPSPD  EQU   GROUP+36                                                 02152000
GROPCENT EQU   GROUP+29                                                 02153000
GROLSN   EQU   GROUP+23                                                 02154000
GROFSN   EQU   GROUP+17                                                 02155000
@NM00009 EQU   GROFLAGA+2                                               02156000
GROMSG1  EQU   GROFLAGA+2                                               02157000
GRORETN  EQU   GROFLAGA+2                                               02158000
GRORLSE  EQU   GROFLAGA+2                                               02159000
GRORONLY EQU   GROFLAGA+2                                               02160000
GRODAERA EQU   GROFLAGA+2                                               02161000
GROEXCL  EQU   GROFLAGA+2                                               02162000
GROBIND  EQU   GROFLAGA+2                                               02163000
GRORES1  EQU   GROTYPE                                                  02164000
GROGVR   EQU   GROTYPE                                                  02165000
GROZERO  EQU   GROID+1                                                  02166000
GROBLANK EQU   GROID                                                    02167000
GROVVGRP EQU   GRONAME+3                                                02168000
GROG     EQU   GRONAME                                                  02169000
@NM00008 EQU   INDEX+28                                                 02170000
INDEXREC EQU   INDRECID+1                                               02171000
INDBLNK2 EQU   INDRECID                                                 02172000
INDVSRNO EQU   INDRECKY+5                                               02173000
INDBLNK1 EQU   INDPREFX+1                                               02174000
INDALPHA EQU   INDPREFX                                                 02175000
INDRES2  EQU   INDTYPE                                                  02176000
INDINDEX EQU   INDTYPE                                                  02177000
INDRES1  EQU   INDTYPE                                                  02178000
INDSERNO EQU   INDNAME+1                                                02179000
INDI     EQU   INDNAME                                                  02180000
@NM00007 EQU   RPLVSAM+44                                               02181000
@NM00006 EQU   RPLVOPT                                                  02182000
@NM00005 EQU   RPLVOPT                                                  02183000
RPLVNEXT EQU   RPLVOPT                                                  02184000
@NM00004 EQU   RPLVSAM+28                                               02185000
RPLVACB  EQU   RPLVSAM+24                                               02186000
@NM00003 EQU   RPLVSAM+3                                                02187000
@NM00002 EQU   RPLVSAM                                                  02188000
@NM00001 EQU   RPLV+38                                                  02189000
RPLRMSCC EQU   RPLV+36                                                  02190000
RPLVTLEN EQU   RPLV+30                                                  02191000
RPLVRES1 EQU   RPLFLAGA+1                                               02192000
RPLVJRNL EQU   RPLFLAGA                                                 02193000
RPLJRCVY EQU   RPLFLAGA                                                 02194000
RPLVVOP  EQU   RPLFLAGA                                                 02195000
RPLVVIN  EQU   RPLFLAGA                                                 02196000
RPLVCOMP EQU   RPLFLAGA                                                 02197000
RPLVPROG EQU   RPLFLAGA                                                 02198000
RPLVPOST EQU   RPLFLAGA                                                 02199000
RPLFTIME EQU   RPLFLAGA                                                 02200000
RPLVRSV3 EQU   RPLV+24                                                  02201000
RPLVRSV2 EQU   RPLV+20                                                  02202000
RPLVRSV1 EQU   RPLV+16                                                  02203000
RPLASCBP EQU   RPLTCBPR                                                 02204000
RPLVECB  EQU   RPLV+4                                                   02205000
RPLVQPTR EQU   RPLV                                                     02206000
VVIUNUSD EQU   VVICB+116                                                02207000
VVINUSDC EQU   VVICB+112                                                02208000
VVITPFCH EQU   VVICB+108                                                02209000
VVIDVMEL EQU   VVICB+104                                                02210000
VVIVBSTF EQU   VVICB+100                                                02211000
VVISSOBA EQU   VVICB+96                                                 02212000
VVIVSCRA EQU   VVICB+92                                                 02213000
VVISTPTB EQU   VVICB+88                                                 02214000
VVIDVMTA EQU   VVICB+84                                                 02215000
VVIJUCB  EQU   VVICB+80                                                 02216000
VVIIUCB  EQU   VVICB+76                                                 02217000
VVIRES6  EQU   VVICB+72                                                 02218000
VVIRES5  EQU   VVICB+68                                                 02219000
VVIRES4  EQU   VVICB+64                                                 02220000
VVIUCB   EQU   VVICB+60                                                 02221000
VVIVJL   EQU   VVICB+56                                                 02222000
VVIVRR   EQU   VVICB+52                                                 02223000
VVIQLSPL EQU   VVICB+48                                                 02224000
VVIQRPL2 EQU   VVICB+44                                                 02225000
VVIQRPL1 EQU   VVICB+40                                                 02226000
VVIRES3  EQU   VVICB+36                                                 02227000
VVIVQMP  EQU   VVICB+32                                                 02228000
VVIECB1  EQU   VVICB+28                                                 02229000
VVICATAD EQU   VVICB+24                                                 02230000
VVIDCBAD EQU   VVICB+20                                                 02231000
VVIACBAD EQU   VVICB+16                                                 02232000
VVIFLG7  EQU   VVIFLGA                                                  02233000
VVIFLG6  EQU   VVIFLGA                                                  02234000
VVIFLG5  EQU   VVIFLGA                                                  02235000
VVIFLG4  EQU   VVIFLGA                                                  02236000
VVIFLG3  EQU   VVIFLGA                                                  02237000
VVIFLG2  EQU   VVIFLGA                                                  02238000
VVIFLG1  EQU   VVIFLGA                                                  02239000
VVIALCON EQU   VVICB+14                                                 02240000
VVICPUID EQU   VVICB+12                                                 02241000
VVIUCAT  EQU   VVICB+4                                                  02242000
VVICID   EQU   VVICB                                                    02243000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02244000
@RF00130 EQU   @EL00001                                                 02245000
@RF00144 EQU   @EL00001                                                 02246000
@RT00171 EQU   @EL00002                                                 02247000
@RT00179 EQU   @EL00002                                                 02248000
@RT00200 EQU   @EL00003                                                 02249000
@RT00203 EQU   @EL00003                                                 02250000
@RT00212 EQU   @EL00003                                                 02251000
@RF00219 EQU   @EL00003                                                 02252000
@RT00231 EQU   @EL00004                                                 02253000
@RT00238 EQU   @EL00004                                                 02254000
@RT00246 EQU   @EL00004                                                 02255000
@RT00261 EQU   @EL00005                                                 02256000
@RT00275 EQU   @EL00005                                                 02257000
@RF00256 EQU   @EL00005                                                 02258000
@RF00277 EQU   @EL00005                                                 02259000
@RT00327 EQU   @EL00008                                                 02260000
@RT00349 EQU   @EL00009                                                 02261000
@RT00384 EQU   @EL00012                                                 02262000
@RT00389 EQU   @EL00012                                                 02263000
@RT00393 EQU   @EL00012                                                 02264000
@RT00400 EQU   @EL00012                                                 02265000
@RT00419 EQU   @EL00012                                                 02266000
@RF00425 EQU   @EL00012                                                 02267000
@RT00437 EQU   @EL00012                                                 02268000
@RT00441 EQU   @EL00012                                                 02269000
@RT00451 EQU   @EL00012                                                 02270000
@ENDDATA EQU   *                                                        02271000
         END   ICBVUT03,(C'PLS2137',0603,76280)                         02272000
./  ADD  SSI=53290132,NAME=MSSCVXIT
         TITLE 'IEECVXIT - DUMMY EXIT ROUTINE.'                         06000002
IEECVXIT CSECT                                                          12000002
*MODULE CREATED FOR MCS - REL 18                                        16000002
**********************************************************************  20000002
*  THIS ROUTINE, WHICH IS USED IN MCS, WILL BE REPLACED BY A USER    *  30000002
*  EXIT ROUTINE, IF ONE IS WRITTEN.                                  *  40000002
**********************************************************************  50000002
XE       EQU   14                                                       60000002
         BR    XE                  RETURN.                              70000002
         END                                                            80000002
./  ADD  SSI=73530148,NAME=SGICB405
         MACRO                                                          00050000
         SGICB405                                                       00100000
.* /* START OF SPECIFICATIONS ****                            @G24LB04  00150000
.*                                                            @G24LB04  00200000
.*01  MODULE-NAME = SGICB405                                  @G24LB04  00250000
.*                                                            @G24LB04  00300000
.*01  DESCRIPTIVE-NAME = MSVC/MSSC MVS SYSGEN LPALIB LINKEDIT @ZA27588  00350000
.*                       MACRO                                @G24LB04  00400000
.*                                                            @G24LB04  00450000
.*01  STATUS = MVS                                            @G24LB04  00500000
.*                                                            @G24LB04  00550000
.*01  FUNCTION = SGICB405 LINK EDITS                          @ZA27588  00600000
.*               ICBVSC00 AND IGC0112F INTO THE               @ZA27588  00650000
.*               TARGET SYS1.LPALIB FROM THE SYSGEN           @G24LB04  00700000
.*               DISTRIBUTION LIBRARY SYS1.AOSD0.             @G24LB04  00750000
.*                                                            @G24LB04  00800000
.*                                                            @G24LB04  00850000
.*01  OPERATION = VIA THE ASSEMBLER PUNCH COMMAND, LINKAGE    @G24LB04  00900000
.*                EDITOR INCLUDE STATEMENTS ARE GENERATED FOR @G24LB04  00950000
.*                THE MODULES.                                @G24LB04  01000000
.*                                                            @G24LB04  01050000
.*01  MODULE-TYPE = MACRO                                     @G24LB04  01100000
.*02    PROCESSOR = ASSEMBLER XF                              @G24LB04  01150000
.*02    MACRO-SIZE = 20 STATEMENTS                            @ZA27588  01200000
.*                                                            @G24LB04  01250000
.*01  OUTPUT = LINKAGE EDITOR JCL AND CONTROL STATEMENTS      @G24LB04  01300000
.*                                                            @G24LB04  01350000
.*01  INNER-MACRO = SGGBLPAK - DEFINE SYSTEM GLOBALS          @G24LB04  01400000
.*                  SGLEDPK1 - GENERATE LINKEDIT JCL          @G24LB04  01450000
.*                  SGLEDPK2 - GENERATE LINKEDIT SYSIN JCL    @G24LB04  01500000
.*                                                            @G24LB04  01550000
.*01  MESSAGES = NONE                                         @G24LB04  01600000
.*                                                            @G24LB04  01650000
.*01  CHANGE-ACTIVITY =                                       @G24LB04  01700000
.*     CHANGE 01 10/25/77 ADD IGC0012F AND IGC0112F           @ZA27588  01750000
.*                                                            @G24LB04  01950000
.**** END OF SPECIFICATIONS ***/                              @G24LB04  02000000
         COPY  SGGBLPAK                DEFINE SYSTEM GLOBAL VARIABLES   02050000
&SGCTRLC(6)    SETC ''                 SYSLMOD MEMBER          @G24LB04 02100000
&SGCTRLC(7)    SETC '&SGCTRLC(20)'     SYSLMOD VOLUME          @G24LB04 02150000
&SGCTRLC(8)    SETC '&SGCTRLC(19)'     SYSLMOD UNIT            @G24LB04 02200000
&SGCTRLC(9)    SETC 'LPALIB'           SYSLMOD DSNAME          @G24LB04 02250000
&SGCTRLC(10)   SETC ',RENT'                                    @G24LB04 02300000
&SGCTRLC(11)   SETC ',REFR'                                    @G24LB04 02350000
         COPY  SGLEDPK1               GENERATE LINK EDIT STEP  @G24LB04 02400000
 PUNCH '//AOSD0 DD DSNAME=SYS1.AOSD0,VOLUME=(,RETAIN),DISP=SHR'         02450000
         COPY  SGLEDPK2               LINK EDIT SYSIN STAGE    @G24LB04 02500000
 PUNCH ' INCLUDE AOSD0(ICBVSC00,ICBVTP01,ICBVUP01)'            @G24LB04 02550000
 PUNCH ' ENTRY ICBVSC00'                                       @G24LB04 02800000
 PUNCH ' NAME ICBVSC00(R)'                                     @G24LB04 02850000
 PUNCH ' INCLUDE AOSD0(IGC0012F,IGC0112F)'                     @ZA27588 02900000
 PUNCH ' ENTRY IGC0012F'                                       @ZA27588 02950000
 PUNCH ' NAME IGC0012F(R)'                                     @ZA27588 03000000
 PUNCH '/*'                                                    @G24LB04 03600000
         MEND                                                  @G24LB04 03650000
