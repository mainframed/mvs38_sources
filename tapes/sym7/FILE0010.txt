./  ADD  SSI=70890124,NAME=ICGTRDST
         TITLE '***** ICGTRDST MSS TRACE SDG AND RWU DISTRIBUTION REPOR*00001000
               RT ****  '                                               00002000
ICGTRDST CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGTRDST  77.089'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         USING @PSTART,@12                                         0001 00014000
         USING @PSTART+4095,@11                                    0001 00015000
         USING @PSTART+8190,@10                                    0001 00016000
         L     @00,@SIZDATD                                        0001 00017000
         GETMAIN  R,LV=(0)                                              00018000
         LR    @09,@01                                             0001 00019000
         USING @DATD,@09                                           0001 00020000
         ST    @13,@SA00001+4                                      0001 00021000
         LM    @00,@01,20(@13)                                     0001 00022000
         ST    @09,8(,@13)                                         0001 00023000
         LR    @13,@09                                             0001 00024000
         L     R1,0(R1)                                                 00025000
*   PARMPTR=R1;                     /* SAVE PARMS LOCATION   @Y30LB40*/ 00026000
         LR    PARMPTR,R1                                          0097 00027000
*   RFY                                                            0098 00028000
*     R1 UNRSTD;                    /*                       @Y30LB40*/ 00029000
*   RFY                                                            0099 00030000
*    (R0,                                                          0099 00031000
*     R1) RSTD;                     /*                       @Y30LB40*/ 00032000
*   R0=LENGTH(DSARRAY);             /*                       @ZA16140*/ 00033000
         L     R0,@CF00997                                         0100 00034000
*   GEN(GETMAIN  R,LV=(0));         /* GETMAIN FOR ARRAYS    @Y30LB40*/ 00035000
         GETMAIN  R,LV=(0)                                              00036000
*   ARRAYLOC=R1;                    /*                       @Y30LB40*/ 00037000
         LR    ARRAYLOC,R1                                         0102 00038000
*   RFY                                                            0103 00039000
*    (R0,                                                          0103 00040000
*     R1) UNRSTD;                   /*                       @Y30LB40*/ 00041000
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/ 00042000
         SLR   @15,@15                                             0104 00043000
         ST    @15,RCDCOUNT                                        0104 00044000
*   RETURNCD=0;                     /*                       @Y30LB40*/ 00045000
         STH   @15,RETURNCD                                        0105 00046000
*   TIMESL=600;                     /*                       @Y30LB40*/ 00047000
         MVC   TIMESL(4),@CF00865                                  0106 00048000
*   HOUR=0;                         /*                       @Y30LB40*/ 00049000
         ST    @15,HOUR                                            0107 00050000
*   MINUTE=0;                       /*                       @Y30LB40*/ 00051000
         ST    @15,MINUTE                                          0108 00052000
*   SECOND=0;                       /*                       @Y30LB40*/ 00053000
         ST    @15,SECOND                                          0109 00054000
*   SELECTSW='0'B;                  /*                       @Y30LB40*/ 00055000
         NI    SELECTSW,B'01111111'                                0110 00056000
*   LINECNT=56;                     /*                       @Y30LB40*/ 00057000
         LA    LINECNT,56                                          0111 00058000
*   OPENCLOS=0;                     /*                       @Y30LB40*/ 00059000
         ST    @15,OPENCLOS                                        0112 00060000
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/ 00061000
         MVI   OPCLB1,B'10000000'                                  0113 00062000
*   PAGECNT=0;                      /*                       @Y30LB40*/ 00063000
         ST    @15,PAGECNT                                         0114 00064000
*   EOFSW='0'B;                     /*                       @Y30LB40*/ 00065000
         NI    EOFSW,B'01111111'                                   0115 00066000
*   HLDSYR=0;                       /*                       @Y30LB40*/ 00067000
         MVI   HLDSYR,X'00'                                        0116 00068000
*   HLDSDAY=1;                      /*                       @Y30LB40*/ 00069000
         LA    @14,1                                               0117 00070000
         STH   @14,HLDSDAY                                         0117 00071000
*   HLDSTIME=0;                     /*                       @Y30LB40*/ 00072000
         ST    @15,HLDSTIME                                        0118 00073000
*   HLDEYR=99;                      /*                       @Y30LB40*/ 00074000
         MVI   HLDEYR,X'63'                                        0119 00075000
*   HLDEDAY=365;                    /*                       @Y30LB40*/ 00076000
         MVC   HLDEDAY(2),@CH00870                                 0120 00077000
*   HLDETIME=86399;                 /*                       @Y30LB40*/ 00078000
         MVC   HLDETIME(4),@CF00871                                0121 00079000
*   PARMSW='D';                     /*                       @Y30LB40*/ 00080000
         MVI   PARMSW,C'D'                                         0122 00081000
*   FIRSTSW='1'B;                   /*                       @Y30LB40*/ 00082000
         OI    FIRSTSW,B'10000000'                                 0123 00083000
*   PARMERR='0'B;                   /*                       @Y30LB40*/ 00084000
         NI    PARMERR,B'01111111'                                 0124 00085000
*   DATEINSW='0'B;                  /*                       @Y30LB40*/ 00086000
         NI    DATEINSW,B'01111111'                                0125 00087000
*   SPACE1=' ';                     /*                       @Y30LB40*/ 00088000
         MVI   SPACE1+1,C' '                                       0126 00089000
         MVC   SPACE1+2(119),SPACE1+1                              0126 00090000
         MVI   SPACE1,C' '                                         0126 00091000
*   DO J=1 TO 28;                   /*                       @ZA16140*/ 00092000
         ST    @14,J                                               0127 00093000
@DL00127 DS    0H                                                  0128 00094000
*     DO K=1 TO 2;                  /*                       @ZA16140*/ 00095000
         LA    @15,1                                               0128 00096000
         ST    @15,K                                               0128 00097000
@DL00128 DS    0H                                                  0129 00098000
*       DO L=1 TO 11;               /*                       @ZA16140*/ 00099000
         LA    @15,1                                               0129 00100000
         ST    @15,L                                               0129 00101000
@DL00129 DS    0H                                                  0130 00102000
*         CALL CALCDSA(J,K,L);      /*                       @ZA16140*/ 00103000
         LA    @15,J                                               0130 00104000
         ST    @15,@AL00001                                        0130 00105000
         LA    @15,K                                               0130 00106000
         ST    @15,@AL00001+4                                      0130 00107000
         LA    @15,L                                               0130 00108000
         ST    @15,@AL00001+8                                      0130 00109000
         LA    @01,@AL00001                                        0130 00110000
         BAL   @14,CALCDSA                                         0130 00111000
*         DSB1=0;                   /*                       @ZA16140*/ 00112000
         SLR   @15,@15                                             0131 00113000
         L     @14,ARRAYPTR                                        0131 00114000
         ST    @15,DSB1(,@14)                                      0131 00115000
*         DSB2=0;                   /*                       @ZA16140*/ 00116000
         ST    @15,DSB2(,@14)                                      0132 00117000
*         DSB3=0;                   /*                       @ZA16140*/ 00118000
         ST    @15,DSB3(,@14)                                      0133 00119000
*         DSB4=0;                   /*                       @ZA16140*/ 00120000
         ST    @15,DSB4(,@14)                                      0134 00121000
*         DSB5=0;                   /*                       @ZA16140*/ 00122000
         ST    @15,DSB5(,@14)                                      0135 00123000
*         DSB6=0;                   /*                       @ZA16140*/ 00124000
         ST    @15,DSB6(,@14)                                      0136 00125000
*         DSB7=0;                   /*                       @ZA16140*/ 00126000
         ST    @15,DSB7(,@14)                                      0137 00127000
*         DSB8=0;                   /*                       @ZA16140*/ 00128000
         ST    @15,DSB8(,@14)                                      0138 00129000
*         DSB9=0;                   /*                       @ZA16140*/ 00130000
         ST    @15,DSB9(,@14)                                      0139 00131000
*         DSB10=0;                  /*                       @ZA16140*/ 00132000
         ST    @15,DSB10(,@14)                                     0140 00133000
*         DSB11=0;                  /*                       @ZA16140*/ 00134000
         ST    @15,DSB11(,@14)                                     0141 00135000
*       END;                        /*                       @Y30LB40*/ 00136000
         LA    @15,1                                               0142 00137000
         AL    @15,L                                               0142 00138000
         ST    @15,L                                               0142 00139000
         C     @15,@CF00033                                        0142 00140000
         BNH   @DL00129                                            0142 00141000
*     END;                          /*                       @Y30LB40*/ 00142000
         LA    @15,1                                               0143 00143000
         AL    @15,K                                               0143 00144000
         ST    @15,K                                               0143 00145000
         C     @15,@CF00051                                        0143 00146000
         BNH   @DL00128                                            0143 00147000
*   END;                            /*                       @Y30LB40*/ 00148000
         LA    @14,1                                               0144 00149000
         AL    @14,J                                               0144 00150000
         ST    @14,J                                               0144 00151000
         C     @14,@CF00615                                        0144 00152000
         BNH   @DL00127                                            0144 00153000
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/ 00154000
         MVC   PRNTDCB(PDCBL),PPATDCB                                   00155000
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/ 00156000
         MVC   INDCB(IDCBL),IPATDCB                                     00157000
*   RFY                                                            0147 00158000
*    (R0,                                                          0147 00159000
*     R1,                                                          0147 00160000
*     R14,                                                         0147 00161000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00162000
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */ 00163000
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)                       00164000
*   RFY                                                            0149 00165000
*    (R0,                                                          0149 00166000
*     R1,                                                          0149 00167000
*     R14,                                                         0149 00168000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00169000
*   IF(PRNTDCB(49:49)&'00010000'B)¬='00010000'B THEN               0150 00170000
         MVC   @TS00001(1),PRNTDCB+48                              0150 00171000
         NI    @TS00001,B'00010000'                                0150 00172000
         CLI   @TS00001,B'00010000'                                0150 00173000
         BE    @RF00150                                            0150 00174000
*     DO;                           /* OPEN BAD,EXIT WITH RC=4     0151 00175000
*                                                            @Y30LB40*/ 00176000
*       RETURN CODE(4);             /*                       @Y30LB40*/ 00177000
         L     @13,4(,@13)                                         0152 00178000
         L     @00,@SIZDATD                                        0152 00179000
         LR    @01,@09                                             0152 00180000
         FREEMAIN R,LV=(0),A=(1)                                        00181000
         LA    @15,4                                               0152 00182000
         L     @14,12(,@13)                                        0152 00183000
         LM    @00,@12,20(@13)                                     0152 00184000
         BR    @14                                                 0152 00185000
*     END;                          /*                       @Y30LB40*/ 00186000
*   RFY                                                            0154 00187000
*    (R0,                                                          0154 00188000
*     R1,                                                          0154 00189000
*     R14,                                                         0154 00190000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00191000
@RF00150 DS    0H                                                  0155 00192000
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */ 00193000
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)                          00194000
*   RFY                                                            0156 00195000
*    (R0,                                                          0156 00196000
*     R1,                                                          0156 00197000
*     R14,                                                         0156 00198000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00199000
*   IF(INDCB(49:49)&'00010000'B)¬='00010000'B THEN                 0157 00200000
         MVC   @TS00001(1),INDCB+48                                0157 00201000
         NI    @TS00001,B'00010000'                                0157 00202000
         CLI   @TS00001,B'00010000'                                0157 00203000
         BE    @RF00157                                            0157 00204000
*     DO;                           /* OPEN BAD              @Y30LB40*/ 00205000
*       DSLINE=TRINMSG;             /*                       @Y30LB40*/ 00206000
         MVI   DSLINE+31,C' '                                      0159 00207000
         MVC   DSLINE+32(89),DSLINE+31                             0159 00208000
         MVC   DSLINE(31),TRINMSG                                  0159 00209000
*       RFY                                                        0160 00210000
*        (R0,                                                      0160 00211000
*         R1,                                                      0160 00212000
*         R14,                                                     0160 00213000
*         R15) RSTD;                /*                       @Y30LB40*/ 00214000
*       GEN(PUT   PRNTDCB,DSLINE);  /* PRINT ERROR MESSAGE   @Y30LB40*/ 00215000
         PUT   PRNTDCB,DSLINE                                           00216000
*       RFY                                                        0162 00217000
*        (R0,                                                      0162 00218000
*         R1,                                                      0162 00219000
*         R14,                                                     0162 00220000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00221000
*       RETURNCD=8;                 /* EXIT WITH RC=8        @Y30LB40*/ 00222000
         MVC   RETURNCD(2),@CH00069                                0163 00223000
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/ 00224000
         B     CLOSEFIL                                            0164 00225000
*     END;                          /*                       @Y30LB40*/ 00226000
*   IF PARMLEN=0 THEN                                              0166 00227000
@RF00157 LH    @15,PARMLEN(,PARMPTR)                               0166 00228000
         LTR   @15,@15                                             0166 00229000
         BZ    @RT00166                                            0166 00230000
*     GO TO PARMEND;                /* IF NO PARMS,BYPASS PROCESS    */ 00231000
*   IF PARMLEN>31                   /*                       @OZ05079*/ 00232000
*     THEN                                                         0168 00233000
         C     @15,@CF00067                                        0168 00234000
         BNH   @RF00168                                            0168 00235000
*     DO;                           /* IF PARMS TOO LONG,EXIT WITH 0169 00236000
*                                      ERROR SWITCH ON       @Y30LB40*/ 00237000
*       PARMERR='1'B;               /*                       @Y30LB40*/ 00238000
         OI    PARMERR,B'10000000'                                 0170 00239000
*       GO TO PARMEND;              /*                       @Y30LB40*/ 00240000
         B     PARMEND                                             0171 00241000
*     END;                          /*                       @Y30LB40*/ 00242000
*   PARMHOLD(1:1)=',';              /*                       @Y30LB40*/ 00243000
@RF00168 MVI   PARMHOLD,C','                                       0173 00244000
*   MVC(PARMHOLD(2:31),PARMHOLD);   /* SET PARMHOLD TO ALL         0174 00245000
*                                      COMMAS,,,,,,,                 */ 00246000
         MVC   PARMHOLD+1(30),PARMHOLD                             0174 00247000
*   SS=1;                           /* SET SUBSTRING POINTER TO 1  0175 00248000
*                                                            @Y30LB40*/ 00249000
         LA    SS,1                                                0175 00250000
*   PARMHOLD(1:PARMLEN)=PARMS;      /* MOVE PARMS TO PARMHOLD      0176 00251000
*                                                            @Y30LB40*/ 00252000
         LH    @15,PARMLEN(,PARMPTR)                               0176 00253000
         BCTR  @15,0                                               0176 00254000
         EX    @15,@SM01014                                        0176 00255000
*   IF PARMHOLD(1:1)=','            /* WAS REPORT SELECTOR ENTERED 0177 00256000
*                                                            @Y30LB40*/ 00257000
*     THEN                                                         0177 00258000
         CLI   PARMHOLD,C','                                       0177 00259000
         BNE   @RF00177                                            0177 00260000
*     SS=2;                         /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00261000
         LA    SS,2                                                0178 00262000
*   ELSE                                                           0179 00263000
*     DO;                           /* YES,CHECK FOR D OR R  @Y30LB40*/ 00264000
         B     @RC00177                                            0179 00265000
@RF00177 DS    0H                                                  0180 00266000
*       IF PARMHOLD(1:1)='D'|PARMHOLD(1:1)='R' THEN                0180 00267000
         CLI   PARMHOLD,C'D'                                       0180 00268000
         BE    @RT00180                                            0180 00269000
         CLI   PARMHOLD,C'R'                                       0180 00270000
         BNE   @RF00180                                            0180 00271000
@RT00180 DS    0H                                                  0181 00272000
*         DO;                       /*                       @Y30LB40*/ 00273000
*           PARMSW=PARMHOLD(1:1);   /* VALID SELECTOR,SAVE IT        */ 00274000
         MVC   PARMSW(1),PARMHOLD                                  0182 00275000
*           SS=3;                   /*                       @Y30LB40*/ 00276000
         LA    SS,3                                                0183 00277000
*         END;                      /*                       @Y30LB40*/ 00278000
*       ELSE                                                       0185 00279000
*         DO;                       /*                       @Y30LB40*/ 00280000
         B     @RC00180                                            0185 00281000
@RF00180 DS    0H                                                  0186 00282000
*           PARMERR='1'B;           /* ERROR,BAD SELECTOR    @Y30LB40*/ 00283000
         OI    PARMERR,B'10000000'                                 0186 00284000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00285000
         B     PARMEND                                             0187 00286000
*         END;                      /*                       @Y30LB40*/ 00287000
*     END;                          /*                       @Y30LB40*/ 00288000
@RC00180 DS    0H                                                  0190 00289000
*   IF PARMHOLD(SS:SS)=','          /* WAS TIME SLICE ENTERED      0190 00290000
*                                                            @Y30LB40*/ 00291000
*     THEN                                                         0190 00292000
@RC00177 LA    @07,PARMHOLD-1(SS)                                  0190 00293000
         CLI   0(@07),C','                                         0190 00294000
         BNE   @RF00190                                            0190 00295000
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00296000
         AL    SS,@CF00044                                         0191 00297000
*   ELSE                                                           0192 00298000
*     DO;                           /* YES                   @Y30LB40*/ 00299000
         B     @RC00190                                            0192 00300000
@RF00190 DS    0H                                                  0193 00301000
*       DO J=SS TO(SS+2);           /* CHECK FOR NON NUMERICS      0193 00302000
*                                                            @Y30LB40*/ 00303000
         LR    @07,SS                                              0193 00304000
         B     @DE00193                                            0193 00305000
@DL00193 DS    0H                                                  0194 00306000
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0194 00307000
         LA    @03,PARMHOLD-1(@07)                                 0194 00308000
         CLI   0(@03),C'0'                                         0194 00309000
         BL    @RF00194                                            0194 00310000
         LA    @03,PARMHOLD-1(@07)                                 0194 00311000
         CLI   0(@03),C'9'                                         0194 00312000
         BNH   @RT00194                                            0194 00313000
*           ;                       /*                       @Y30LB40*/ 00314000
*         ELSE                                                     0196 00315000
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0196 00316000
*                                                            @Y30LB40*/ 00317000
@RF00194 OI    PARMERR,B'10000000'                                 0196 00318000
*       END;                        /*                       @Y30LB40*/ 00319000
@RT00194 LA    @07,1                                               0197 00320000
         AL    @07,J                                               0197 00321000
@DE00193 ST    @07,J                                               0197 00322000
         LA    @03,2                                               0197 00323000
         ALR   @03,SS                                              0197 00324000
         CR    @07,@03                                             0197 00325000
         BNH   @DL00193                                            0197 00326000
*       IF PARMERR='1'B THEN                                       0198 00327000
         TM    PARMERR,B'10000000'                                 0198 00328000
         BO    @RT00198                                            0198 00329000
*         GO TO PARMEND;            /*                       @Y30LB40*/ 00330000
*       IF PARMHOLD(SS:SS+2)='000' THEN                            0200 00331000
         LA    @07,PARMHOLD-1(SS)                                  0200 00332000
         CLC   0(3,@07),@CC00881                                   0200 00333000
         BNE   @RF00200                                            0200 00334000
*         DO;                       /* ERROR,TIME SLICE CANNOT BE  0201 00335000
*                                      ZERO                          */ 00336000
*           PARMERR='1'B;           /*                       @Y30LB40*/ 00337000
         OI    PARMERR,B'10000000'                                 0202 00338000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00339000
         B     PARMEND                                             0203 00340000
*         END;                      /*                       @Y30LB40*/ 00341000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+2));/* TIME SLICE OK,CONVERT IT */ 00342000
@RF00200 LA    @07,PARMHOLD-1(SS)                                  0205 00343000
         PACK  DOUBLEWD(8),0(3,@07)                                0205 00344000
*       CVB(TIMESL,DOUBLEWD);       /*                       @Y30LB40*/ 00345000
         CVB   @07,DOUBLEWD                                        0206 00346000
         ST    @07,TIMESL                                          0206 00347000
*       TIMESL=TIMESL*60;           /*                       @Y30LB40*/ 00348000
         MH    @07,@CH00335                                        0207 00349000
         ST    @07,TIMESL                                          0207 00350000
*       SS=SS+4;                    /* BUMP TO NEXT VALUE    @Y30LB40*/ 00351000
         AL    SS,@CF00104                                         0208 00352000
*     END;                          /*                       @Y30LB40*/ 00353000
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/ 00354000
*     THEN                                                         0210 00355000
@RC00190 LA    @07,PARMHOLD-1(SS)                                  0210 00356000
         CLI   0(@07),C','                                         0210 00357000
         BNE   @RF00210                                            0210 00358000
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00359000
         AL    SS,@CF00044                                         0211 00360000
*   ELSE                                                           0212 00361000
*     DO;                           /* YES,CHECK FOR NON NUMERICS  0212 00362000
*                                                            @Y30LB40*/ 00363000
         B     @RC00210                                            0212 00364000
@RF00210 DS    0H                                                  0213 00365000
*       DO J=SS TO(SS+9);           /*                       @Y30LB40*/ 00366000
         LR    @07,SS                                              0213 00367000
         B     @DE00213                                            0213 00368000
@DL00213 DS    0H                                                  0214 00369000
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0214 00370000
         LA    @03,PARMHOLD-1(@07)                                 0214 00371000
         CLI   0(@03),C'0'                                         0214 00372000
         BL    @RF00214                                            0214 00373000
         LA    @03,PARMHOLD-1(@07)                                 0214 00374000
         CLI   0(@03),C'9'                                         0214 00375000
         BNH   @RT00214                                            0214 00376000
*           ;                       /*                       @Y30LB40*/ 00377000
*         ELSE                                                     0216 00378000
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0216 00379000
*                                                            @Y30LB40*/ 00380000
@RF00214 OI    PARMERR,B'10000000'                                 0216 00381000
*       END;                        /*                       @Y30LB40*/ 00382000
@RT00214 LA    @07,1                                               0217 00383000
         AL    @07,J                                               0217 00384000
@DE00213 ST    @07,J                                               0217 00385000
         LA    @03,9                                               0217 00386000
         ALR   @03,SS                                              0217 00387000
         CR    @07,@03                                             0217 00388000
         BNH   @DL00213                                            0217 00389000
*       IF PARMERR='1'B THEN                                       0218 00390000
         TM    PARMERR,B'10000000'                                 0218 00391000
         BO    @RT00218                                            0218 00392000
*         GO TO PARMEND;            /*                       @Y30LB40*/ 00393000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT DATES    @Y30LB40*/ 00394000
         LA    @07,PARMHOLD-1(SS)                                  0220 00395000
         PACK  DOUBLEWD(8),0(2,@07)                                0220 00396000
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/ 00397000
         CVB   @07,DOUBLEWD                                        0221 00398000
         STC   @07,HLDSYR                                          0221 00399000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/ 00400000
         LA    @07,PARMHOLD+1(SS)                                  0222 00401000
         PACK  DOUBLEWD(8),0(3,@07)                                0222 00402000
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00403000
         CVB   @07,DOUBLEWD                                        0223 00404000
         STH   @07,HLDSDAY                                         0223 00405000
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/ 00406000
         LA    @03,PARMHOLD+4(SS)                                  0224 00407000
         PACK  DOUBLEWD(8),0(2,@03)                                0224 00408000
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/ 00409000
         CVB   @03,DOUBLEWD                                        0225 00410000
         STC   @03,HLDEYR                                          0225 00411000
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/ 00412000
         LA    @03,PARMHOLD+6(SS)                                  0226 00413000
         PACK  DOUBLEWD(8),0(3,@03)                                0226 00414000
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00415000
         CVB   @03,DOUBLEWD                                        0227 00416000
         STH   @03,HLDEDAY                                         0227 00417000
*       IF HLDSDAY>0&HLDSDAY<366    /* CHECK FOR VALID DAYS          */ 00418000
*         THEN                                                     0228 00419000
         LTR   @07,@07                                             0228 00420000
         BNP   @RF00228                                            0228 00421000
         C     @07,@CF00884                                        0228 00422000
         BL    @RT00228                                            0228 00423000
*         ;                         /*                       @Y30LB40*/ 00424000
*       ELSE                                                       0230 00425000
*         DO;                       /*                       @Y30LB40*/ 00426000
@RF00228 DS    0H                                                  0231 00427000
*           IF HLDSDAY=366 THEN                                    0231 00428000
         CLC   HLDSDAY(2),@CH00884                                 0231 00429000
         BNE   @RF00231                                            0231 00430000
*             DO;                   /* CHECK FOR LEAP YEAR   @Y30LB40*/ 00431000
*               IF(CKSTIME(1:1)&'00000011'B)¬='00000000'B THEN     0233 00432000
         MVC   @TS00001(1),CKSTIME                                 0233 00433000
         NI    @TS00001,B'00000011'                                0233 00434000
         CLI   @TS00001,B'00000000'                                0233 00435000
         BE    @RF00233                                            0233 00436000
*                 PARMERR='1'B;     /* ERROR,BAD DAY         @Y30LB40*/ 00437000
         OI    PARMERR,B'10000000'                                 0234 00438000
*             END;                  /*                       @Y30LB40*/ 00439000
*           ELSE                                                   0236 00440000
*             PARMERR='1'B;         /* ERROR,BAD DAY         @Y30LB40*/ 00441000
         B     @RC00231                                            0236 00442000
@RF00231 OI    PARMERR,B'10000000'                                 0236 00443000
*         END;                      /*                       @Y30LB40*/ 00444000
@RC00231 DS    0H                                                  0238 00445000
*       IF HLDEDAY>0&HLDEDAY<366    /* CHECK FOR VALID DAYS          */ 00446000
*         THEN                                                     0238 00447000
@RT00228 LH    @07,HLDEDAY                                         0238 00448000
         LTR   @07,@07                                             0238 00449000
         BNP   @RF00238                                            0238 00450000
         C     @07,@CF00884                                        0238 00451000
         BL    @RT00238                                            0238 00452000
*         ;                         /*                       @Y30LB40*/ 00453000
*       ELSE                                                       0240 00454000
*         DO;                       /*                       @Y30LB40*/ 00455000
@RF00238 DS    0H                                                  0241 00456000
*           IF HLDEDAY=366 THEN                                    0241 00457000
         CLC   HLDEDAY(2),@CH00884                                 0241 00458000
         BNE   @RF00241                                            0241 00459000
*             DO;                   /* CHECK FOR LEAP YEAR   @Y30LB40*/ 00460000
*               IF(CKETIME(1:1)&'00000011'B)¬='00000000'B THEN     0243 00461000
         MVC   @TS00001(1),CKETIME                                 0243 00462000
         NI    @TS00001,B'00000011'                                0243 00463000
         CLI   @TS00001,B'00000000'                                0243 00464000
         BE    @RF00243                                            0243 00465000
*                 PARMERR='1'B;     /* ERROR,BAD DAY         @Y30LB40*/ 00466000
         OI    PARMERR,B'10000000'                                 0244 00467000
*             END;                  /*                       @Y30LB40*/ 00468000
*           ELSE                                                   0246 00469000
*             PARMERR='1'B;         /* ERROR,BAD DAY         @Y30LB40*/ 00470000
         B     @RC00241                                            0246 00471000
@RF00241 OI    PARMERR,B'10000000'                                 0246 00472000
*         END;                      /*                       @Y30LB40*/ 00473000
@RC00241 DS    0H                                                  0248 00474000
*       IF HLDSYR<=HLDEYR           /* CHECK YEARS AND DAYS IN     0248 00475000
*                                      COMBINATION                   */ 00476000
*         THEN                                                     0248 00477000
@RT00238 CLC   HLDSYR(1),HLDEYR                                    0248 00478000
         BNH   @RT00248                                            0248 00479000
*         ;                         /*                       @Y30LB40*/ 00480000
*       ELSE                                                       0250 00481000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00482000
         OI    PARMERR,B'10000000'                                 0250 00483000
*       IF HLDSDAY<=HLDEDAY THEN                                   0251 00484000
@RT00248 LH    @07,HLDSDAY                                         0251 00485000
         CH    @07,HLDEDAY                                         0251 00486000
         BNH   @RT00251                                            0251 00487000
*         ;                         /*                       @Y30LB40*/ 00488000
*       ELSE                                                       0253 00489000
*         DO;                       /*                       @Y30LB40*/ 00490000
*           IF HLDSYR=HLDEYR THEN                                  0254 00491000
         CLC   HLDSYR(1),HLDEYR                                    0254 00492000
         BNE   @RF00254                                            0254 00493000
*             PARMERR='1'B;         /*                       @Y30LB40*/ 00494000
         OI    PARMERR,B'10000000'                                 0255 00495000
*         END;                      /*                       @Y30LB40*/ 00496000
@RF00254 DS    0H                                                  0257 00497000
*       IF PARMERR='1'B THEN                                       0257 00498000
@RT00251 TM    PARMERR,B'10000000'                                 0257 00499000
         BO    @RT00257                                            0257 00500000
*         GO TO PARMEND;            /*                       @Y30LB40*/ 00501000
*       DATEINSW='1'B;              /* DATES OK, SET INDICATOR     0259 00502000
*                                                            @Y30LB40*/ 00503000
         OI    DATEINSW,B'10000000'                                0259 00504000
*       SS=SS+11;                   /* BUMP TO NEXT VALUE    @Y30LB40*/ 00505000
         AL    SS,@CF00033                                         0260 00506000
*     END;                          /*                       @Y30LB40*/ 00507000
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/ 00508000
*     THEN                                                         0262 00509000
@RC00210 LA    @07,PARMHOLD-1(SS)                                  0262 00510000
         CLI   0(@07),C','                                         0262 00511000
         BNE   @RF00262                                            0262 00512000
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00513000
         AL    SS,@CF00044                                         0263 00514000
*   ELSE                                                           0264 00515000
*     DO;                           /*                       @Y30LB40*/ 00516000
         B     @RC00262                                            0264 00517000
@RF00262 DS    0H                                                  0265 00518000
*       DO J=SS TO(SS+7);           /* YES,CHECK FOR NON NUMERICS  0265 00519000
*                                                            @Y30LB40*/ 00520000
         LR    @07,SS                                              0265 00521000
         B     @DE00265                                            0265 00522000
@DL00265 DS    0H                                                  0266 00523000
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0266 00524000
         LA    @03,PARMHOLD-1(@07)                                 0266 00525000
         CLI   0(@03),C'0'                                         0266 00526000
         BL    @RF00266                                            0266 00527000
         LA    @03,PARMHOLD-1(@07)                                 0266 00528000
         CLI   0(@03),C'9'                                         0266 00529000
         BNH   @RT00266                                            0266 00530000
*           ;                       /*                       @Y30LB40*/ 00531000
*         ELSE                                                     0268 00532000
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0268 00533000
*                                                            @Y30LB40*/ 00534000
@RF00266 OI    PARMERR,B'10000000'                                 0268 00535000
*       END;                        /*                       @Y30LB40*/ 00536000
@RT00266 LA    @07,1                                               0269 00537000
         AL    @07,J                                               0269 00538000
@DE00265 ST    @07,J                                               0269 00539000
         LA    @03,7                                               0269 00540000
         ALR   @03,SS                                              0269 00541000
         CR    @07,@03                                             0269 00542000
         BNH   @DL00265                                            0269 00543000
*       IF PARMERR='1'B THEN                                       0270 00544000
         TM    PARMERR,B'10000000'                                 0270 00545000
         BO    @RT00270                                            0270 00546000
*         GO TO PARMEND;            /*                       @Y30LB40*/ 00547000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/ 00548000
         LA    @07,PARMHOLD-1(SS)                                  0272 00549000
         PACK  DOUBLEWD(8),0(2,@07)                                0272 00550000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00551000
         CVB   TIMEWORK,DOUBLEWD                                   0273 00552000
*       IF TIMEWORK>23 THEN                                        0274 00553000
         C     TIMEWORK,@CF00887                                   0274 00554000
         BNH   @RF00274                                            0274 00555000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00556000
         OI    PARMERR,B'10000000'                                 0275 00557000
*       ELSE                                                       0276 00558000
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00559000
         B     @RC00274                                            0276 00560000
@RF00274 LR    @07,TIMEWORK                                        0276 00561000
         MH    @07,@CH00888                                        0276 00562000
         ST    @07,HLDSTIME                                        0276 00563000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/ 00564000
@RC00274 LA    @07,PARMHOLD+1(SS)                                  0277 00565000
         PACK  DOUBLEWD(8),0(2,@07)                                0277 00566000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00567000
         CVB   TIMEWORK,DOUBLEWD                                   0278 00568000
*       IF TIMEWORK>59 THEN                                        0279 00569000
         C     TIMEWORK,@CF00889                                   0279 00570000
         BNH   @RF00279                                            0279 00571000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00572000
         OI    PARMERR,B'10000000'                                 0280 00573000
*       ELSE                                                       0281 00574000
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/ 00575000
         B     @RC00279                                            0281 00576000
@RF00279 LR    @07,TIMEWORK                                        0281 00577000
         MH    @07,@CH00335                                        0281 00578000
         AL    @07,HLDSTIME                                        0281 00579000
         ST    @07,HLDSTIME                                        0281 00580000
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/ 00581000
@RC00279 LA    @07,PARMHOLD+3(SS)                                  0282 00582000
         PACK  DOUBLEWD(8),0(2,@07)                                0282 00583000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00584000
         CVB   TIMEWORK,DOUBLEWD                                   0283 00585000
*       IF TIMEWORK>23 THEN                                        0284 00586000
         C     TIMEWORK,@CF00887                                   0284 00587000
         BNH   @RF00284                                            0284 00588000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00589000
         OI    PARMERR,B'10000000'                                 0285 00590000
*       ELSE                                                       0286 00591000
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00592000
         B     @RC00284                                            0286 00593000
@RF00284 LR    @07,TIMEWORK                                        0286 00594000
         MH    @07,@CH00888                                        0286 00595000
         ST    @07,HLDETIME                                        0286 00596000
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/ 00597000
@RC00284 LA    @07,PARMHOLD+5(SS)                                  0287 00598000
         PACK  DOUBLEWD(8),0(2,@07)                                0287 00599000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00600000
         CVB   TIMEWORK,DOUBLEWD                                   0288 00601000
*       IF TIMEWORK>59 THEN                                        0289 00602000
         C     TIMEWORK,@CF00889                                   0289 00603000
         BNH   @RF00289                                            0289 00604000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00605000
         OI    PARMERR,B'10000000'                                 0290 00606000
*       ELSE                                                       0291 00607000
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/ 00608000
         B     @RC00289                                            0291 00609000
@RF00289 LR    @07,TIMEWORK                                        0291 00610000
         MH    @07,@CH00335                                        0291 00611000
         AL    @07,HLDETIME                                        0291 00612000
         AL    @07,@CF00889                                        0291 00613000
         ST    @07,HLDETIME                                        0291 00614000
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY/* CHECK DATES AND           */ 00615000
*         THEN                                                     0292 00616000
@RC00289 CLC   HLDSYR(1),HLDEYR                                    0292 00617000
         BNE   @RF00292                                            0292 00618000
         CLC   HLDSDAY(2),HLDEDAY                                  0292 00619000
         BNE   @RF00292                                            0292 00620000
*         IF HLDSTIME>HLDETIME      /* TIMES IN COMBINATION          */ 00621000
*           THEN                                                   0293 00622000
         L     @07,HLDSTIME                                        0293 00623000
         C     @07,HLDETIME                                        0293 00624000
         BNH   @RF00293                                            0293 00625000
*           PARMERR='1'B;           /*                       @Y30LB40*/ 00626000
         OI    PARMERR,B'10000000'                                 0294 00627000
*       IF PARMERR='0'B&DATEINSW='0'B THEN                         0295 00628000
@RF00293 DS    0H                                                  0295 00629000
@RF00292 TM    PARMERR,B'10000000'                                 0295 00630000
         BNZ   @RF00295                                            0295 00631000
         TM    DATEINSW,B'10000000'                                0295 00632000
         BNZ   @RF00295                                            0295 00633000
*         PARMERR='1'B;             /* ERROR,DATES NOT ENTERED     0296 00634000
*                                                            @Y30LB40*/ 00635000
         OI    PARMERR,B'10000000'                                 0296 00636000
*       SS=SS+9;                    /* BUMP TO NEXT VALUE    @Y30LB40*/ 00637000
@RF00295 AL    SS,@CF00035                                         0297 00638000
*     END;                          /*                       @Y30LB40*/ 00639000
*   IF PARMERR='1'B THEN                                           0299 00640000
@RC00262 TM    PARMERR,B'10000000'                                 0299 00641000
         BO    @RT00299                                            0299 00642000
*     GO TO PARMEND;                /*                       @Y30LB40*/ 00643000
*   IF PARMHOLD(SS:SS)=','          /* WERE SDG OR LU ENTERED      0301 00644000
*                                                            @ZA16140*/ 00645000
*     THEN                                                         0301 00646000
         LA    @07,PARMHOLD-1(SS)                                  0301 00647000
         CLI   0(@07),C','                                         0301 00648000
         BE    @RT00301                                            0301 00649000
*     ;                             /* NO,FINISH PROCESS     @Y30LB40*/ 00650000
*   ELSE                                                           0303 00651000
*     DO;                           /* YES                   @Y30LB40*/ 00652000
*       SELECTSW='1'B;              /* INDICATE SPECIFIC SELECTION 0304 00653000
*                                                            @Y30LB40*/ 00654000
         OI    SELECTSW,B'10000000'                                0304 00655000
*       IF PARMSW='D' THEN                                         0305 00656000
         CLI   PARMSW,C'D'                                         0305 00657000
         BNE   @RF00305                                            0305 00658000
*         DO;                       /* CHECK FOR VALID SDG NUMBER  0306 00659000
*                                                            @ZA16140*/ 00660000
*           IF((PARMHOLD(SS:SS+2)='SDG')&(PARMHOLD(SS+3:SS+3)>='0')&(   00661000
*               PARMHOLD(SS+3:SS+3)<='2')&(PARMHOLD(SS+4:SS+4)>='0')&(  00662000
*               PARMHOLD(SS+4:SS+4)<='9')&(PARMHOLD(SS+3:SS+4)<='27'))  00663000
*             THEN                                                 0307 00664000
         LA    @07,PARMHOLD-1(SS)                                  0307 00665000
         CLC   0(3,@07),@CC00890                                   0307 00666000
         BNE   @RF00307                                            0307 00667000
         LA    @07,PARMHOLD+2(SS)                                  0307 00668000
         CLI   0(@07),C'0'                                         0307 00669000
         BL    @RF00307                                            0307 00670000
         LA    @07,PARMHOLD+2(SS)                                  0307 00671000
         CLI   0(@07),C'2'                                         0307 00672000
         BH    @RF00307                                            0307 00673000
         LA    @07,PARMHOLD+3(SS)                                  0307 00674000
         CLI   0(@07),C'0'                                         0307 00675000
         BL    @RF00307                                            0307 00676000
         LA    @07,PARMHOLD+3(SS)                                  0307 00677000
         CLI   0(@07),C'9'                                         0307 00678000
         BH    @RF00307                                            0307 00679000
         LA    @07,PARMHOLD+2(SS)                                  0307 00680000
         CLC   0(2,@07),@CC00891                                   0307 00681000
         BH    @RF00307                                            0307 00682000
*             DO;                   /*                       @ZA16140*/ 00683000
*               PACK(DOUBLEWD,PARMHOLD(SS+3:SS+4));/*        @ZA16140*/ 00684000
         LA    @07,PARMHOLD+2(SS)                                  0309 00685000
         PACK  DOUBLEWD(8),0(2,@07)                                0309 00686000
*               CVB(SELSDG,DOUBLEWD);/*                      @ZA16140*/ 00687000
         CVB   @07,DOUBLEWD                                        0310 00688000
         STC   @07,SELSDG                                          0310 00689000
*             END;                  /*                       @ZA16140*/ 00690000
*           ELSE                                                   0312 00691000
*             DO;                   /*                       @ZA16140*/ 00692000
         B     @RC00307                                            0312 00693000
@RF00307 DS    0H                                                  0313 00694000
*               PARMERR='1'B;       /*                       @ZA16140*/ 00695000
         OI    PARMERR,B'10000000'                                 0313 00696000
*               GO TO PARMEND;      /*                       @ZA16140*/ 00697000
         B     PARMEND                                             0314 00698000
*             END;                  /*                       @ZA16140*/ 00699000
*         END;                      /*                       @Y30LB40*/ 00700000
*       ELSE                                                       0317 00701000
*         DO;                       /* CHECK FOR VALID LIBRARY AND 0317 00702000
*                                      RWU                   @Y30LB40*/ 00703000
         B     @RC00305                                            0317 00704000
@RF00305 DS    0H                                                  0318 00705000
*           IF PARMHOLD(SS:SS)¬='2' /* 1ST DIGIT ALWAYS 2    @OZ05079*/ 00706000
*             THEN                                                 0318 00707000
         LA    @07,PARMHOLD-1(SS)                                  0318 00708000
         CLI   0(@07),C'2'                                         0318 00709000
         BE    @RF00318                                            0318 00710000
*             DO;                   /*                       @Y30LB40*/ 00711000
*               PARMERR='1'B;       /* ERROR,INVALID LIBRARY @Y30LB40*/ 00712000
         OI    PARMERR,B'10000000'                                 0320 00713000
*               GO TO PARMEND;      /*                       @Y30LB40*/ 00714000
         B     PARMEND                                             0321 00715000
*             END;                  /*                       @Y30LB40*/ 00716000
*           IF PARMHOLD(SS+1:SS+1)='0'/* MSF = 0             @OZ05079*/ 00717000
*               |PARMHOLD(SS+1:SS+1)='1'/* MSF = 1           @OZ05079*/ 00718000
*             THEN                                                 0323 00719000
@RF00318 LA    @07,PARMHOLD(SS)                                    0323 00720000
         CLI   0(@07),C'0'                                         0323 00721000
         BE    @RT00323                                            0323 00722000
         LA    @07,PARMHOLD(SS)                                    0323 00723000
         CLI   0(@07),C'1'                                         0323 00724000
         BNE   @RF00323                                            0323 00725000
@RT00323 DS    0H                                                  0324 00726000
*             DO;                   /*                       @Y30LB40*/ 00727000
*               PACK(DOUBLEWD,PARMHOLD(SS+1:SS+1));/* MSF OK @OZ05079*/ 00728000
         LA    @07,PARMHOLD(SS)                                    0325 00729000
         PACK  DOUBLEWD(8),0(1,@07)                                0325 00730000
*               CVB(LIB,DOUBLEWD);  /*                       @OZ05079*/ 00731000
         CVB   @07,DOUBLEWD                                        0326 00732000
         STC   @07,LIB                                             0326 00733000
*             END;                  /*                       @Y30LB40*/ 00734000
*           ELSE                                                   0328 00735000
*             DO;                   /*                       @Y30LB40*/ 00736000
         B     @RC00323                                            0328 00737000
@RF00323 DS    0H                                                  0329 00738000
*               PARMERR='1'B;       /* ERROR,INVALID RWU     @Y30LB40*/ 00739000
         OI    PARMERR,B'10000000'                                 0329 00740000
*               GO TO PARMEND;      /*                       @Y30LB40*/ 00741000
         B     PARMEND                                             0330 00742000
*             END;                  /*                       @Y30LB40*/ 00743000
*           IF PARMHOLD(SS+2:SS+2)>='0'/* RANGE OKAY         @OZ05079*/ 00744000
*               &PARMHOLD(SS+2:SS+2)<='7'/*                  @OZ05079*/ 00745000
*             THEN                                                 0332 00746000
@RC00323 LA    @07,PARMHOLD+1(SS)                                  0332 00747000
         CLI   0(@07),C'0'                                         0332 00748000
         BL    @RF00332                                            0332 00749000
         LA    @07,PARMHOLD+1(SS)                                  0332 00750000
         CLI   0(@07),C'7'                                         0332 00751000
         BH    @RF00332                                            0332 00752000
*             DO;                   /*                       @Y30LB40*/ 00753000
*               PACK(DOUBLEWD,PARMHOLD(SS+2:SS+2));/* DRD OKAY     0334 00754000
*                                                            @OZ05079*/ 00755000
         LA    @07,PARMHOLD+1(SS)                                  0334 00756000
         PACK  DOUBLEWD(8),0(1,@07)                                0334 00757000
*               CVB(U,DOUBLEWD);    /*                       @Y30LB40*/ 00758000
         CVB   @07,DOUBLEWD                                        0335 00759000
         STC   @07,U                                               0335 00760000
*             END;                  /*                       @Y30LB40*/ 00761000
*           ELSE                                                   0337 00762000
*             DO;                   /*                       @Y30LB40*/ 00763000
         B     @RC00332                                            0337 00764000
@RF00332 DS    0H                                                  0338 00765000
*               PARMERR='1'B;       /* ERROR,INVALID RWU     @Y30LB40*/ 00766000
         OI    PARMERR,B'10000000'                                 0338 00767000
*               GO TO PARMEND;      /*                       @Y30LB40*/ 00768000
         B     PARMEND                                             0339 00769000
*             END;                  /*                       @Y30LB40*/ 00770000
*         END;                      /*                       @Y30LB40*/ 00771000
@RC00332 DS    0H                                                  0342 00772000
*     END;                          /*                       @Y30LB40*/ 00773000
@RC00305 DS    0H                                                  0343 00774000
*PARMEND:                                                          0343 00775000
*   IF PARMERR='1'B THEN                                           0343 00776000
@RT00301 DS    0H                                                  0343 00777000
PARMEND  TM    PARMERR,B'10000000'                                 0343 00778000
         BNO   @RF00343                                            0343 00779000
*     DO;                           /* IF ERRORS FOUND       @Y30LB40*/ 00780000
*       DSLINE=PARMMSG;             /*                       @Y30LB40*/ 00781000
         MVI   DSLINE+28,C' '                                      0345 00782000
         MVC   DSLINE+29(92),DSLINE+28                             0345 00783000
         MVC   DSLINE(28),PARMMSG                                  0345 00784000
*       RFY                                                        0346 00785000
*        (R0,                                                      0346 00786000
*         R1,                                                      0346 00787000
*         R14,                                                     0346 00788000
*         R15) RSTD;                /*                       @Y30LB40*/ 00789000
*       GEN(PUT   PRNTDCB,DSLINE);  /* PRINT ERROR MESSAGE   @Y30LB40*/ 00790000
         PUT   PRNTDCB,DSLINE                                           00791000
*       RFY                                                        0348 00792000
*        (R0,                                                      0348 00793000
*         R1,                                                      0348 00794000
*         R14,                                                     0348 00795000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00796000
*       RETURNCD=8;                 /* EXIT WITH RC=8        @Y30LB40*/ 00797000
         MVC   RETURNCD(2),@CH00069                                0349 00798000
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/ 00799000
         B     CLOSEFIL                                            0350 00800000
*     END;                          /*                       @Y30LB40*/ 00801000
*   RFY                                                            0352 00802000
*    (R0,                                                          0352 00803000
*     R1,                                                          0352 00804000
*     R14,                                                         0352 00805000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00806000
@RF00343 DS    0H                                                  0353 00807000
*   GEN(TIME);                      /* GET AND CONVERT TODAYS DATE 0353 00808000
*                                                            @Y30LB40*/ 00809000
         TIME                                                           00810000
*   GEN(ST    R1,DOUBLEWD);         /*                       @Y30LB40*/ 00811000
         ST    R1,DOUBLEWD                                              00812000
*   RFY                                                            0355 00813000
*    (R0,                                                          0355 00814000
*     R1,                                                          0355 00815000
*     R14,                                                         0355 00816000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00817000
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @Y30LB40*/ 00818000
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0356 00819000
*   TSBEG=CKSTIME;                  /*                       @OZ11673*/ 00820000
         MVC   TSBEG(7),CKSTIME                                    0357 00821000
*   TSEND=CKSTIME;                  /*                       @OZ11673*/ 00822000
         MVC   TSEND(7),CKSTIME                                    0358 00823000
*   TSETIME=TSETIME+TIMESL;         /*                       @OZ11673*/ 00824000
         L     @07,TSETIME                                         0359 00825000
         AL    @07,TIMESL                                          0359 00826000
         ST    @07,TSETIME                                         0359 00827000
*                                                                  0360 00828000
*/********************************************************************/ 00829000
*/* BEGIN PROCESSING THE FILE                                @Y30LB40*/ 00830000
*/********************************************************************/ 00831000
*                                                                  0360 00832000
*RDTRACE:                                                          0360 00833000
*   RFY                                                            0360 00834000
*    (R0,                                                          0360 00835000
*     R1,                                                          0360 00836000
*     R14,                                                         0360 00837000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00838000
RDTRACE  DS    0H                                                  0361 00839000
*   GEN(GET   INDCB,RCDIN);         /* READ AN INPUT RECORD  @Y30LB40*/ 00840000
         GET   INDCB,RCDIN                                              00841000
*   RFY                                                            0362 00842000
*    (R0,                                                          0362 00843000
*     R1,                                                          0362 00844000
*     R14,                                                         0362 00845000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00846000
*   IF CKTIME<CKSTIME|CKTIME>CKETIME THEN                          0363 00847000
         CLC   CKTIME(7),CKSTIME                                   0363 00848000
         BL    @RT00363                                            0363 00849000
         CLC   CKTIME(7),CKETIME                                   0363 00850000
         BH    @RT00363                                            0363 00851000
*     GO TO RDTRACE;                /* IF NOT IN DATE AND TIME     0364 00852000
*                                      RANGE,READ NEXT               */ 00853000
*   IF SELECTSW='1'B                /* WAS SPECIFIC SELECTION ENTERED   00854000
*                                                            @Y30LB40*/ 00855000
*     THEN                                                         0365 00856000
         TM    SELECTSW,B'10000000'                                0365 00857000
         BNO   @RF00365                                            0365 00858000
*     IF PARMSW='D'                 /* YES                   @Y30LB40*/ 00859000
*       THEN                                                       0366 00860000
         CLI   PARMSW,C'D'                                         0366 00861000
         BNE   @RF00366                                            0366 00862000
*       DO;                         /*                       @Y30LB40*/ 00863000
*         IF SDGINBIN¬=SELSDG THEN                                 0368 00864000
         CLC   SDGINBIN(1),SELSDG                                  0368 00865000
         BNE   @RT00368                                            0368 00866000
*           GO TO RDTRACE;          /* NOT RIGHT ONE,READ NEXT RECORD*/ 00867000
*       END;                        /*                       @Y30LB40*/ 00868000
*     ELSE                                                         0371 00869000
*       DO;                         /*                       @Y30LB40*/ 00870000
         B     @RC00366                                            0371 00871000
@RF00366 DS    0H                                                  0372 00872000
*         IF LIB¬=LIBRARY|U¬=READWRIT THEN                         0372 00873000
         CLC   LIB(1),LIBRARY                                      0372 00874000
         BNE   @RT00372                                            0372 00875000
         CLC   U(1),READWRIT                                       0372 00876000
         BNE   @RT00372                                            0372 00877000
*           GO TO RDTRACE;          /* NOT RIGHT ONE,READ NEXT RECORD*/ 00878000
*       END;                        /*                       @Y30LB40*/ 00879000
*   IF(DSTGD+STGD)¬>0 THEN                                         0375 00880000
@RC00366 DS    0H                                                  0375 00881000
@RF00365 L     @07,DSTGD                                           0375 00882000
         AL    @07,STGD                                            0375 00883000
         LTR   @07,@07                                             0375 00884000
         BNP   @RT00375                                            0375 00885000
*     GO TO RDTRACE;                /* BYPASS ZERO RCDS              */ 00886000
*   IF FIRSTSW='1'B                 /* TEST IF FIRST RECORD  @Y30LB40*/ 00887000
*     THEN                                                         0377 00888000
         TM    FIRSTSW,B'10000000'                                 0377 00889000
         BNO   @RF00377                                            0377 00890000
*     DO;                           /*                       @Y30LB40*/ 00891000
*       FIRSTSW='0'B;               /* TURN OFF 1ST RECORD SWITCH    */ 00892000
         NI    FIRSTSW,B'01111111'                                 0379 00893000
*       CKSEQ=CKTIME;               /* SETUP TIMESLICE START AND END    00894000
*                                                            @Y30LB40*/ 00895000
         MVC   CKSEQ(7),CKTIME                                     0380 00896000
*       CALL GETSLICE;              /*                       @OZ11673*/ 00897000
         BAL   @14,GETSLICE                                        0381 00898000
*     END;                          /*                       @Y30LB40*/ 00899000
*   IF CKTIME<CKSEQ                 /* CHECK INPUT SEQUENCE  @Y30LB40*/ 00900000
*     THEN                                                         0383 00901000
@RF00377 CLC   CKTIME(7),CKSEQ                                     0383 00902000
         BNL   @RF00383                                            0383 00903000
*     DO;                           /* OUT OF SEQUENCE       @Y30LB40*/ 00904000
*       DSLINE=SEQMSG;              /*                       @Y30LB40*/ 00905000
         MVI   DSLINE+43,C' '                                      0385 00906000
         MVC   DSLINE+44(77),DSLINE+43                             0385 00907000
         MVC   DSLINE(43),SEQMSG                                   0385 00908000
*       RFY                                                        0386 00909000
*        (R0,                                                      0386 00910000
*         R1,                                                      0386 00911000
*         R14,                                                     0386 00912000
*         R15) RSTD;                /*                       @Y30LB40*/ 00913000
*       GEN(PUT   PRNTDCB,DSLINE);  /* PRINT ERROR MESSAGE   @Y30LB40*/ 00914000
         PUT   PRNTDCB,DSLINE                                           00915000
*       RFY                                                        0388 00916000
*        (R0,                                                      0388 00917000
*         R1,                                                      0388 00918000
*         R14,                                                     0388 00919000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00920000
*       RETURNCD=8;                 /* EXIT WITH RC=8        @Y30LB40*/ 00921000
         MVC   RETURNCD(2),@CH00069                                0389 00922000
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/ 00923000
         B     CLOSEFIL                                            0390 00924000
*     END;                          /*                       @Y30LB40*/ 00925000
*   CKSEQ=CKTIME;                   /* UPDATE SEQUENCE CHECK @Y30LB40*/ 00926000
@RF00383 MVC   CKSEQ(7),CKTIME                                     0392 00927000
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT SELECTED INPUT RECORDS     00928000
*                                                            @Y30LB40*/ 00929000
         LA    @07,1                                               0393 00930000
         AL    @07,RCDCOUNT                                        0393 00931000
         ST    @07,RCDCOUNT                                        0393 00932000
*   IF PARMSW='R' THEN                                             0394 00933000
         CLI   PARMSW,C'R'                                         0394 00934000
         BE    @RT00394                                            0394 00935000
*     GO TO ROUTINE2;               /* READ/WRITE UNIT REPORT        */ 00936000
*CHECKTIM:                          /* CHECK IF IN THE PROPER TIME 0396 00937000
*                                      SLICE                         */ 00938000
*   IF CKTIME>TSEND THEN                                           0396 00939000
CHECKTIM CLC   CKTIME(7),TSEND                                     0396 00940000
         BH    @RT00396                                            0396 00941000
*     GO TO DSCTLBRK;               /* NEW TIME SLICE        @Y30LB40*/ 00942000
*DSACCUM:                           /* ROUTINE TO ACCUMULATE       0398 00943000
*                                      NECESSARY TOTALS              */ 00944000
*   K=SDGINBIN+1;                   /*                       @ZA16140*/ 00945000
DSACCUM  LA    @07,1                                               0398 00946000
         SLR   @15,@15                                             0398 00947000
         IC    @15,SDGINBIN                                        0398 00948000
         ALR   @15,@07                                             0398 00949000
         ST    @15,K                                               0398 00950000
*   M=((LOADTIME/4)/3)+1;           /* BUILD CLASS INTERVAL FOR LOAD    00951000
*                                      TIME                          */ 00952000
         L     @00,LOADTIME                                        0399 00953000
         SRDA  @00,32                                              0399 00954000
         D     @00,@CF00032                                        0399 00955000
         ALR   @01,@07                                             0399 00956000
         ST    @01,M                                               0399 00957000
*   IF M>10 THEN                                                   0400 00958000
         LA    @07,10                                              0400 00959000
         CR    @01,@07                                             0400 00960000
         BNH   @RF00400                                            0400 00961000
*     M=10;                         /* SET TO MAX            @Y30LB40*/ 00962000
         ST    @07,M                                               0401 00963000
*   DO L=1 TO 2;                    /* DETAIL AND JOB TOTALS @Y30LB40*/ 00964000
@RF00400 LA    @07,1                                               0402 00965000
         ST    @07,L                                               0402 00966000
@DL00402 DS    0H                                                  0403 00967000
*     CALL CALCDSA(K,L,11);         /* GET ARRAY ENTRY       @ZA16140*/ 00968000
         LA    @07,K                                               0403 00969000
         ST    @07,@AL00001                                        0403 00970000
         LA    @07,L                                               0403 00971000
         ST    @07,@AL00001+4                                      0403 00972000
         LA    @07,@CF00033                                        0403 00973000
         ST    @07,@AL00001+8                                      0403 00974000
         LA    @01,@AL00001                                        0403 00975000
         BAL   @14,CALCDSA                                         0403 00976000
*     DSB1=DSB1+LOADNUM;            /* SUM CARTRIDGE LOADS   @Y30LB40*/ 00977000
         L     @07,ARRAYPTR                                        0404 00978000
         SLR   @15,@15                                             0404 00979000
         IC    @15,LOADNUM                                         0404 00980000
         AL    @15,DSB1(,@07)                                      0404 00981000
         ST    @15,DSB1(,@07)                                      0404 00982000
*     DSB2=DSB2+LOADTIME;           /* SUM LOAD TIME         @Y30LB40*/ 00983000
         L     @15,DSB2(,@07)                                      0405 00984000
         AL    @15,LOADTIME                                        0405 00985000
         ST    @15,DSB2(,@07)                                      0405 00986000
*     DSB3=DSB3+STGD;               /* SUM CYLS STAGED       @Y30LB40*/ 00987000
         L     @15,STGD                                            0406 00988000
         L     @14,DSB3(,@07)                                      0406 00989000
         ALR   @14,@15                                             0406 00990000
         ST    @14,DSB3(,@07)                                      0406 00991000
*     DSB6=DSB6+DSTGD;              /* SUM CYLS DESTAGED     @Y30LB40*/ 00992000
         L     @14,DSTGD                                           0407 00993000
         L     @05,DSB6(,@07)                                      0407 00994000
         ALR   @05,@14                                             0407 00995000
         ST    @05,DSB6(,@07)                                      0407 00996000
*     DSB9=DSB9+(STGD+DSTGD);       /* TOT STGNG             @Y30LB40*/ 00997000
         ALR   @14,@15                                             0408 00998000
         AL    @14,DSB9(,@07)                                      0408 00999000
         ST    @14,DSB9(,@07)                                      0408 01000000
*     DSB10=DSB10+(DEVSGTM+DEVDSTM);/* SUM DEV TIME          @Y30LB40*/ 01001000
         L     @14,DEVSGTM                                         0409 01002000
         LR    @05,@14                                             0409 01003000
         AL    @05,DEVDSTM                                         0409 01004000
         AL    @05,DSB10(,@07)                                     0409 01005000
         ST    @05,DSB10(,@07)                                     0409 01006000
*     DSB11=DSB11+(SYSSGTM+SYSDSTM);/* SUM SYS TIME          @Y30LB40*/ 01007000
         L     @05,SYSSGTM                                         0410 01008000
         LR    @04,@05                                             0410 01009000
         AL    @04,SYSDSTM                                         0410 01010000
         AL    @04,DSB11(,@07)                                     0410 01011000
         ST    @04,DSB11(,@07)                                     0410 01012000
*     IF STGDNUM¬=0                 /* WERE THERE CYLINDERS STAGED 0411 01013000
*                                                            @Y30LB40*/ 01014000
*       THEN                                                       0411 01015000
         CLI   STGDNUM,0                                           0411 01016000
         BE    @RF00411                                            0411 01017000
*       DO;                         /* YES                   @Y30LB40*/ 01018000
*         DSB4=DSB4+DEVSGTM;        /* DEV STAGE TIME        @Y30LB40*/ 01019000
         L     @04,DSB4(,@07)                                      0413 01020000
         ALR   @04,@14                                             0413 01021000
         ST    @04,DSB4(,@07)                                      0413 01022000
*         DSB5=DSB5+SYSSGTM;        /* SYS STAGE TIME        @Y30LB40*/ 01023000
         AL    @05,DSB5(,@07)                                      0414 01024000
         ST    @05,DSB5(,@07)                                      0414 01025000
*         IF DEVSGTM=0 THEN                                        0415 01026000
         LTR   @14,@14                                             0415 01027000
         BNZ   @RF00415                                            0415 01028000
*           N=(STGD*4)+1;           /*                       @Y30LB40*/ 01029000
         SLA   @15,2                                               0416 01030000
         AL    @15,@CF00044                                        0416 01031000
         ST    @15,N                                               0416 01032000
*         ELSE                                                     0417 01033000
*           N=((STGD*4)/DEVSGTM)+1; /*                       @Y30LB40*/ 01034000
         B     @RC00415                                            0417 01035000
@RF00415 L     @01,STGD                                            0417 01036000
         M     @00,@CF00104                                        0417 01037000
         D     @00,DEVSGTM                                         0417 01038000
         AL    @01,@CF00044                                        0417 01039000
         ST    @01,N                                               0417 01040000
*         IF N>10 THEN                                             0418 01041000
@RC00415 LA    @07,10                                              0418 01042000
         C     @07,N                                               0418 01043000
         BNL   @RF00418                                            0418 01044000
*           N=10;                   /*                       @Y30LB40*/ 01045000
         ST    @07,N                                               0419 01046000
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/ 01047000
@RF00418 LA    @07,K                                               0420 01048000
         ST    @07,@AL00001                                        0420 01049000
         LA    @07,L                                               0420 01050000
         ST    @07,@AL00001+4                                      0420 01051000
         LA    @07,N                                               0420 01052000
         ST    @07,@AL00001+8                                      0420 01053000
         LA    @01,@AL00001                                        0420 01054000
         BAL   @14,CALCDSA                                         0420 01055000
*         DSB3=DSB3+STGDNUM;        /*                       @Y30LB40*/ 01056000
         L     @07,ARRAYPTR                                        0421 01057000
         SLR   @15,@15                                             0421 01058000
         IC    @15,STGDNUM                                         0421 01059000
         AL    @15,DSB3(,@07)                                      0421 01060000
         ST    @15,DSB3(,@07)                                      0421 01061000
*         IF SYSSGTM=0 THEN                                        0422 01062000
         L     @07,SYSSGTM                                         0422 01063000
         LTR   @07,@07                                             0422 01064000
         BNZ   @RF00422                                            0422 01065000
*           N=(STGD*4)+1;           /*                       @Y30LB40*/ 01066000
         L     @07,STGD                                            0423 01067000
         SLA   @07,2                                               0423 01068000
         AL    @07,@CF00044                                        0423 01069000
         ST    @07,N                                               0423 01070000
*         ELSE                                                     0424 01071000
*           N=((STGD*4)/SYSSGTM)+1; /*                       @Y30LB40*/ 01072000
         B     @RC00422                                            0424 01073000
@RF00422 L     @01,STGD                                            0424 01074000
         M     @00,@CF00104                                        0424 01075000
         D     @00,SYSSGTM                                         0424 01076000
         AL    @01,@CF00044                                        0424 01077000
         ST    @01,N                                               0424 01078000
*         IF N>10 THEN                                             0425 01079000
@RC00422 LA    @07,10                                              0425 01080000
         C     @07,N                                               0425 01081000
         BNL   @RF00425                                            0425 01082000
*           N=10;                   /*                       @Y30LB40*/ 01083000
         ST    @07,N                                               0426 01084000
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/ 01085000
@RF00425 LA    @07,K                                               0427 01086000
         ST    @07,@AL00001                                        0427 01087000
         LA    @07,L                                               0427 01088000
         ST    @07,@AL00001+4                                      0427 01089000
         LA    @07,N                                               0427 01090000
         ST    @07,@AL00001+8                                      0427 01091000
         LA    @01,@AL00001                                        0427 01092000
         BAL   @14,CALCDSA                                         0427 01093000
*         DSB5=DSB5+STGDNUM;        /* COUNT FOR SYSTEM      @Y30LB40*/ 01094000
         L     @07,ARRAYPTR                                        0428 01095000
         SLR   @15,@15                                             0428 01096000
         IC    @15,STGDNUM                                         0428 01097000
         AL    @15,DSB5(,@07)                                      0428 01098000
         ST    @15,DSB5(,@07)                                      0428 01099000
*       END;                        /*                       @Y30LB40*/ 01100000
*     IF DSTGDNUM¬=0                /* WERE CYLINDERS DESTAGED     0430 01101000
*                                                            @Y30LB40*/ 01102000
*       THEN                                                       0430 01103000
@RF00411 CLI   DSTGDNUM,0                                          0430 01104000
         BE    @RF00430                                            0430 01105000
*       DO;                         /* YES                   @Y30LB40*/ 01106000
*         CALL CALCDSA(K,L,11);     /* GET ARRAY ADDRESS     @ZA16140*/ 01107000
         LA    @07,K                                               0432 01108000
         ST    @07,@AL00001                                        0432 01109000
         LA    @07,L                                               0432 01110000
         ST    @07,@AL00001+4                                      0432 01111000
         LA    @07,@CF00033                                        0432 01112000
         ST    @07,@AL00001+8                                      0432 01113000
         LA    @01,@AL00001                                        0432 01114000
         BAL   @14,CALCDSA                                         0432 01115000
*         DSB7=DSB7+DEVDSTM;        /* DEV DESTAGE TIME      @Y30LB40*/ 01116000
         L     @07,ARRAYPTR                                        0433 01117000
         L     @15,DEVDSTM                                         0433 01118000
         L     @14,DSB7(,@07)                                      0433 01119000
         ALR   @14,@15                                             0433 01120000
         ST    @14,DSB7(,@07)                                      0433 01121000
*         DSB8=DSB8+SYSDSTM;        /* SYS DESTAGE TIME      @Y30LB40*/ 01122000
         L     @14,DSB8(,@07)                                      0434 01123000
         AL    @14,SYSDSTM                                         0434 01124000
         ST    @14,DSB8(,@07)                                      0434 01125000
*         IF DEVDSTM=0 THEN                                        0435 01126000
         LTR   @15,@15                                             0435 01127000
         BNZ   @RF00435                                            0435 01128000
*           N=(DSTGD*4)+1;          /*                       @Y30LB40*/ 01129000
         L     @07,DSTGD                                           0436 01130000
         SLA   @07,2                                               0436 01131000
         AL    @07,@CF00044                                        0436 01132000
         ST    @07,N                                               0436 01133000
*         ELSE                                                     0437 01134000
*           N=((DSTGD*4)/DEVDSTM)+1;/*                       @Y30LB40*/ 01135000
         B     @RC00435                                            0437 01136000
@RF00435 L     @01,DSTGD                                           0437 01137000
         M     @00,@CF00104                                        0437 01138000
         D     @00,DEVDSTM                                         0437 01139000
         AL    @01,@CF00044                                        0437 01140000
         ST    @01,N                                               0437 01141000
*         IF N>10 THEN                                             0438 01142000
@RC00435 LA    @07,10                                              0438 01143000
         C     @07,N                                               0438 01144000
         BNL   @RF00438                                            0438 01145000
*           N=10;                   /*                       @Y30LB40*/ 01146000
         ST    @07,N                                               0439 01147000
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/ 01148000
@RF00438 LA    @07,K                                               0440 01149000
         ST    @07,@AL00001                                        0440 01150000
         LA    @07,L                                               0440 01151000
         ST    @07,@AL00001+4                                      0440 01152000
         LA    @07,N                                               0440 01153000
         ST    @07,@AL00001+8                                      0440 01154000
         LA    @01,@AL00001                                        0440 01155000
         BAL   @14,CALCDSA                                         0440 01156000
*         DSB6=DSB6+DSTGDNUM;       /*                       @Y30LB40*/ 01157000
         L     @07,ARRAYPTR                                        0441 01158000
         SLR   @15,@15                                             0441 01159000
         IC    @15,DSTGDNUM                                        0441 01160000
         AL    @15,DSB6(,@07)                                      0441 01161000
         ST    @15,DSB6(,@07)                                      0441 01162000
*         IF SYSDSTM=0 THEN                                        0442 01163000
         L     @07,SYSDSTM                                         0442 01164000
         LTR   @07,@07                                             0442 01165000
         BNZ   @RF00442                                            0442 01166000
*           N=(DSTGD*4)+1;          /*                       @Y30LB40*/ 01167000
         L     @07,DSTGD                                           0443 01168000
         SLA   @07,2                                               0443 01169000
         AL    @07,@CF00044                                        0443 01170000
         ST    @07,N                                               0443 01171000
*         ELSE                                                     0444 01172000
*           N=((DSTGD*4)/SYSDSTM)+1;/*                       @Y30LB40*/ 01173000
         B     @RC00442                                            0444 01174000
@RF00442 L     @01,DSTGD                                           0444 01175000
         M     @00,@CF00104                                        0444 01176000
         D     @00,SYSDSTM                                         0444 01177000
         AL    @01,@CF00044                                        0444 01178000
         ST    @01,N                                               0444 01179000
*         IF N>10 THEN                                             0445 01180000
@RC00442 LA    @07,10                                              0445 01181000
         C     @07,N                                               0445 01182000
         BNL   @RF00445                                            0445 01183000
*           N=10;                   /*                       @Y30LB40*/ 01184000
         ST    @07,N                                               0446 01185000
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/ 01186000
@RF00445 LA    @07,K                                               0447 01187000
         ST    @07,@AL00001                                        0447 01188000
         LA    @07,L                                               0447 01189000
         ST    @07,@AL00001+4                                      0447 01190000
         LA    @07,N                                               0447 01191000
         ST    @07,@AL00001+8                                      0447 01192000
         LA    @01,@AL00001                                        0447 01193000
         BAL   @14,CALCDSA                                         0447 01194000
*         DSB8=DSB8+DSTGDNUM;       /* COUNT FOR SYSTEM      @Y30LB40*/ 01195000
         L     @07,ARRAYPTR                                        0448 01196000
         SLR   @15,@15                                             0448 01197000
         IC    @15,DSTGDNUM                                        0448 01198000
         AL    @15,DSB8(,@07)                                      0448 01199000
         ST    @15,DSB8(,@07)                                      0448 01200000
*       END;                        /*                       @Y30LB40*/ 01201000
*     CALL CALCDSA(K,L,M);          /* GET ARRAY ADDRESS     @ZA16140*/ 01202000
@RF00430 LA    @07,K                                               0450 01203000
         ST    @07,@AL00001                                        0450 01204000
         LA    @07,L                                               0450 01205000
         ST    @07,@AL00001+4                                      0450 01206000
         LA    @07,M                                               0450 01207000
         ST    @07,@AL00001+8                                      0450 01208000
         LA    @01,@AL00001                                        0450 01209000
         BAL   @14,CALCDSA                                         0450 01210000
*     IF LOADNUM=0 THEN                                            0451 01211000
         CLI   LOADNUM,0                                           0451 01212000
         BE    @RT00451                                            0451 01213000
*       ;                           /*                       @Y30LB40*/ 01214000
*     ELSE                                                         0453 01215000
*       DSB2=DSB2+1;                /* COUNT FOR LOAD TIME   @Y30LB40*/ 01216000
         L     @07,ARRAYPTR                                        0453 01217000
         LA    @15,1                                               0453 01218000
         AL    @15,DSB2(,@07)                                      0453 01219000
         ST    @15,DSB2(,@07)                                      0453 01220000
*     IF MININUM=0 THEN                                            0454 01221000
@RT00451 CLI   MININUM,0                                           0454 01222000
         BE    @RT00454                                            0454 01223000
*       ;                           /*                       @Y30LB40*/ 01224000
*     ELSE                                                         0456 01225000
*       DO;                         /*                       @Y30LB40*/ 01226000
*         N=(PAGES/MININUM)+1;      /*                       @Y30LB40*/ 01227000
         SLR   @01,@01                                             0457 01228000
         IC    @01,PAGES                                           0457 01229000
         SLR   @00,@00                                             0457 01230000
         SLR   @07,@07                                             0457 01231000
         IC    @07,MININUM                                         0457 01232000
         DR    @00,@07                                             0457 01233000
         AL    @01,@CF00044                                        0457 01234000
         ST    @01,N                                               0457 01235000
*         IF N>10 THEN                                             0458 01236000
         LA    @07,10                                              0458 01237000
         CR    @01,@07                                             0458 01238000
         BNH   @RF00458                                            0458 01239000
*           N=10;                   /*                       @Y30LB40*/ 01240000
         ST    @07,N                                               0459 01241000
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/ 01242000
@RF00458 LA    @07,K                                               0460 01243000
         ST    @07,@AL00001                                        0460 01244000
         LA    @07,L                                               0460 01245000
         ST    @07,@AL00001+4                                      0460 01246000
         LA    @07,N                                               0460 01247000
         ST    @07,@AL00001+8                                      0460 01248000
         LA    @01,@AL00001                                        0460 01249000
         BAL   @14,CALCDSA                                         0460 01250000
*         DSB9=DSB9+1;              /* PAGES PER MINI        @Y30LB40*/ 01251000
         L     @07,ARRAYPTR                                        0461 01252000
         LA    @15,1                                               0461 01253000
         AL    @15,DSB9(,@07)                                      0461 01254000
         ST    @15,DSB9(,@07)                                      0461 01255000
*       END;                        /*                       @Y30LB40*/ 01256000
*     N=((STGD+DSTGD)/PAGES)+1;     /*                       @Y30LB40*/ 01257000
@RT00454 L     @00,STGD                                            0463 01258000
         AL    @00,DSTGD                                           0463 01259000
         SRDA  @00,32                                              0463 01260000
         SLR   @07,@07                                             0463 01261000
         IC    @07,PAGES                                           0463 01262000
         DR    @00,@07                                             0463 01263000
         AL    @01,@CF00044                                        0463 01264000
         ST    @01,N                                               0463 01265000
*     IF N>10 THEN                                                 0464 01266000
         LA    @07,10                                              0464 01267000
         CR    @01,@07                                             0464 01268000
         BNH   @RF00464                                            0464 01269000
*       N=10;                       /*                       @Y30LB40*/ 01270000
         ST    @07,N                                               0465 01271000
*     CALL CALCDSA(K,L,N);          /* GET ARRAY ADDRESS     @ZA16140*/ 01272000
@RF00464 LA    @07,K                                               0466 01273000
         ST    @07,@AL00001                                        0466 01274000
         LA    @07,L                                               0466 01275000
         ST    @07,@AL00001+4                                      0466 01276000
         LA    @07,N                                               0466 01277000
         ST    @07,@AL00001+8                                      0466 01278000
         LA    @01,@AL00001                                        0466 01279000
         BAL   @14,CALCDSA                                         0466 01280000
*     DSB10=DSB10+1;                /* COUNT CYLS PER PAGE   @Y30LB40*/ 01281000
         L     @07,ARRAYPTR                                        0467 01282000
         LA    @15,1                                               0467 01283000
         AL    @15,DSB10(,@07)                                     0467 01284000
         ST    @15,DSB10(,@07)                                     0467 01285000
*   END;                            /*                       @Y30LB40*/ 01286000
         LA    @07,1                                               0468 01287000
         AL    @07,L                                               0468 01288000
         ST    @07,L                                               0468 01289000
         C     @07,@CF00051                                        0468 01290000
         BNH   @DL00402                                            0468 01291000
*   GO TO RDTRACE;                  /* GO READ NEXT RECORD   @Y30LB40*/ 01292000
         B     RDTRACE                                             0469 01293000
*/********************************************************************/ 01294000
*                                                                  0470 01295000
*                                                                  0470 01296000
*/********************************************************************/ 01297000
*/* PRINT SDG TIME SLICE TOTALS                              @ZA16140*/ 01298000
*/********************************************************************/ 01299000
*                                                                  0470 01300000
*DSCTLBRK:                          /* DATA STAGER TIME SLICE CTL  0470 01301000
*                                      BREAK                         */ 01302000
*   L=1;                            /* DETAIL ONLY           @Y30LB40*/ 01303000
DSCTLBRK MVC   L(4),@CF00044                                       0470 01304000
*PROCDSBK:                                                         0471 01305000
*   DO K=1 TO 28;                   /* PROCESS SDGS 0 - 27   @ZA16140*/ 01306000
PROCDSBK LA    @07,1                                               0471 01307000
         ST    @07,K                                               0471 01308000
@DL00471 DS    0H                                                  0472 01309000
*     DSLINE=' ';                   /*                       @Y30LB40*/ 01310000
         MVI   DSLINE+1,C' '                                       0472 01311000
         MVC   DSLINE+2(119),DSLINE+1                              0472 01312000
         MVI   DSLINE,C' '                                         0472 01313000
*     CALCFLD=K-1;                  /* GET SDG NUMBER        @ZA16140*/ 01314000
         BCTR  @07,0                                               0473 01315000
         ST    @07,CALCFLD                                         0473 01316000
*     CALL EDITFIX(ADDR(CALCFLD),4,'N');/* EDIT SDG          @ZA16140*/ 01317000
         MVC   @AL00001+4(8),@AL00474                              0474 01318000
         LA    @07,CALCFLD                                         0474 01319000
         ST    @07,@AFTEMPS                                        0474 01320000
         LA    @07,@AFTEMPS                                        0474 01321000
         ST    @07,@AL00001                                        0474 01322000
         LA    @01,@AL00001                                        0474 01323000
         BAL   @14,EDITFIX                                         0474 01324000
*     SDGFLD=FIXOUT(12:13);         /*                       @ZA16140*/ 01325000
         MVC   SDGFLD(2),FIXOUT+11                                 0475 01326000
*     IF L=2&EOFSW='1'B             /* ARE REPORT TOTALS WANTED      */ 01327000
*       THEN                                                       0476 01328000
         CLC   L(4),@CF00051                                       0476 01329000
         BNE   @RF00476                                            0476 01330000
         TM    EOFSW,B'10000000'                                   0476 01331000
         BNO   @RF00476                                            0476 01332000
*       DO;                         /* YES,SET TOTALS CONSTANT INFO  */ 01333000
*         DSFLD2='DISTR.';          /*                       @Y30LB40*/ 01334000
         MVC   DSFLD2(6),@CC00908                                  0478 01335000
*         DSFLD2A='SUMMARY ';       /*                       @Y30LB40*/ 01336000
         MVC   DSFLD2A(8),@CC00909                                 0479 01337000
*       END;                        /*                       @Y30LB40*/ 01338000
*     ELSE                                                         0481 01339000
*       DO;                         /* TIME SLICE TOTALS,SET CONSTANT   01340000
*                                      INFO                          */ 01341000
         B     @RC00476                                            0481 01342000
@RF00476 DS    0H                                                  0482 01343000
*         DSFLD2='  /   ';          /*                       @Y30LB40*/ 01344000
         MVC   DSFLD2(6),@CC00910                                  0482 01345000
*         CALL EDITFIX(ADDR(TSSYR),1,'N');/*                 @Y30LB40*/ 01346000
         MVC   @AL00001+4(8),@AL00483                              0483 01347000
         LA    @07,TSSYR                                           0483 01348000
         ST    @07,@AFTEMPS                                        0483 01349000
         LA    @07,@AFTEMPS                                        0483 01350000
         ST    @07,@AL00001                                        0483 01351000
         LA    @01,@AL00001                                        0483 01352000
         BAL   @14,EDITFIX                                         0483 01353000
*         DSFLD2(1:2)=FIXOUT(12:13);/*                       @Y30LB40*/ 01354000
         MVC   DSFLD2(2),FIXOUT+11                                 0484 01355000
*         CALL EDITFIX(ADDR(TSSDAY),2,'N');/*                @Y30LB40*/ 01356000
         MVC   @AL00001+4(8),@AL00485                              0485 01357000
         LA    @07,TSSDAY                                          0485 01358000
         ST    @07,@AFTEMPS                                        0485 01359000
         LA    @07,@AFTEMPS                                        0485 01360000
         ST    @07,@AL00001                                        0485 01361000
         LA    @01,@AL00001                                        0485 01362000
         BAL   @14,EDITFIX                                         0485 01363000
*         DSFLD2(4:6)=FIXOUT(11:13);/*                       @Y30LB40*/ 01364000
         MVC   DSFLD2+3(3),FIXOUT+10                               0486 01365000
*         HOUR=TSSTIME/3600;        /*                       @Y30LB40*/ 01366000
         L     @07,TSSTIME                                         0487 01367000
         LA    @15,3600                                            0487 01368000
         LR    @00,@07                                             0487 01369000
         SRDA  @00,32                                              0487 01370000
         DR    @00,@15                                             0487 01371000
         ST    @01,HOUR                                            0487 01372000
*         MINUTE=(TSSTIME-(HOUR*3600))/60;/*                 @Y30LB40*/ 01373000
         LA    @14,60                                              0488 01374000
         MR    @00,@15                                             0488 01375000
         LR    @02,@07                                             0488 01376000
         SLR   @02,@01                                             0488 01377000
         SRDA  @02,32                                              0488 01378000
         DR    @02,@14                                             0488 01379000
         ST    @03,MINUTE                                          0488 01380000
*         SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));                0489 01381000
         MR    @02,@14                                             0489 01382000
         ALR   @01,@03                                             0489 01383000
         SLR   @07,@01                                             0489 01384000
         ST    @07,SECOND                                          0489 01385000
*         DSFLD2A='  :  :  ';       /*                       @Y30LB40*/ 01386000
         MVC   DSFLD2A(8),@CC00911                                 0490 01387000
*         CALL EDITFIX(ADDR(HOUR),4,'S');/*                  @Y30LB40*/ 01388000
         MVC   @AL00001+4(8),@AL00491                              0491 01389000
         LA    @07,HOUR                                            0491 01390000
         ST    @07,@AFTEMPS                                        0491 01391000
         LA    @07,@AFTEMPS                                        0491 01392000
         ST    @07,@AL00001                                        0491 01393000
         LA    @01,@AL00001                                        0491 01394000
         BAL   @14,EDITFIX                                         0491 01395000
*         DSFLD2A(1:2)=FIXOUT(12:13);/*                      @Y30LB40*/ 01396000
         MVC   DSFLD2A(2),FIXOUT+11                                0492 01397000
*         CALL EDITFIX(ADDR(MINUTE),4,'N');/*                @Y30LB40*/ 01398000
         MVC   @AL00001+4(8),@AL00493                              0493 01399000
         LA    @07,MINUTE                                          0493 01400000
         ST    @07,@AFTEMPS                                        0493 01401000
         LA    @07,@AFTEMPS                                        0493 01402000
         ST    @07,@AL00001                                        0493 01403000
         LA    @01,@AL00001                                        0493 01404000
         BAL   @14,EDITFIX                                         0493 01405000
*         DSFLD2A(4:5)=FIXOUT(12:13);/*                      @Y30LB40*/ 01406000
         MVC   DSFLD2A+3(2),FIXOUT+11                              0494 01407000
*         CALL EDITFIX(ADDR(SECOND),4,'N');/*                @Y30LB40*/ 01408000
         MVC   @AL00001+4(8),@AL00495                              0495 01409000
         LA    @07,SECOND                                          0495 01410000
         ST    @07,@AFTEMPS                                        0495 01411000
         LA    @07,@AFTEMPS                                        0495 01412000
         ST    @07,@AL00001                                        0495 01413000
         LA    @01,@AL00001                                        0495 01414000
         BAL   @14,EDITFIX                                         0495 01415000
*         DSFLD2A(7:8)=FIXOUT(12:13);/*                      @Y30LB40*/ 01416000
         MVC   DSFLD2A+6(2),FIXOUT+11                              0496 01417000
*       END;                        /*                       @Y30LB40*/ 01418000
*     CALL CALCDSA(K,L,11);         /* GET ARRAY ADDRESS     @ZA16140*/ 01419000
@RC00476 LA    @07,K                                               0498 01420000
         ST    @07,@AL00001                                        0498 01421000
         LA    @07,L                                               0498 01422000
         ST    @07,@AL00001+4                                      0498 01423000
         LA    @07,@CF00033                                        0498 01424000
         ST    @07,@AL00001+8                                      0498 01425000
         LA    @01,@AL00001                                        0498 01426000
         BAL   @14,CALCDSA                                         0498 01427000
*     IF DSB9¬=0 THEN                                              0499 01428000
         L     @07,ARRAYPTR                                        0499 01429000
         L     @07,DSB9(,@07)                                      0499 01430000
         LTR   @07,@07                                             0499 01431000
         BZ    @RF00499                                            0499 01432000
*       DO M=1 TO 10;               /* CLASSES 1-10          @Y30LB40*/ 01433000
         LA    @07,1                                               0500 01434000
         ST    @07,M                                               0500 01435000
@DL00500 DS    0H                                                  0501 01436000
*         IF LINECNT>43 THEN                                       0501 01437000
         C     LINECNT,@CF00712                                    0501 01438000
         BNH   @RF00501                                            0501 01439000
*           DO;                     /* SKIP TO A NEW PAGE    @Y30LB40*/ 01440000
*             LINECNT=2;            /* RESET THE LINE COUNTER      0503 01441000
*                                                            @Y30LB40*/ 01442000
         LA    LINECNT,2                                           0503 01443000
*             PAGECNT=PAGECNT+1;    /* UP PAGE COUNTER BY 1          */ 01444000
         LA    @07,1                                               0504 01445000
         AL    @07,PAGECNT                                         0504 01446000
         ST    @07,PAGECNT                                         0504 01447000
*             HEADHOLD=HDNG1;       /*                       @Y30LB40*/ 01448000
         MVC   HEADHOLD(121),HDNG1                                 0505 01449000
*             CALL EDITFIX(ADDR(PAGECNT),4,'S');/*           @Y30LB40*/ 01450000
         MVC   @AL00001+4(8),@AL00506                              0506 01451000
         LA    @07,PAGECNT                                         0506 01452000
         ST    @07,@AFTEMPS                                        0506 01453000
         LA    @07,@AFTEMPS                                        0506 01454000
         ST    @07,@AL00001                                        0506 01455000
         LA    @01,@AL00001                                        0506 01456000
         BAL   @14,EDITFIX                                         0506 01457000
*             HEADHOLD(118:121)=FIXOUT(10:13);/*             @Y30LB40*/ 01458000
         MVC   HEADHOLD+117(4),FIXOUT+9                            0507 01459000
*             HEADHOLD(107:111)=TODAY;/*                     @Y30LB40*/ 01460000
         MVC   HEADHOLD+106(5),TODAY                               0508 01461000
*             RFY                                                  0509 01462000
*              (R0,                                                0509 01463000
*               R1,                                                0509 01464000
*               R14,                                               0509 01465000
*               R15) RSTD;          /*                       @Y30LB40*/ 01466000
*             GEN(PUT   PRNTDCB,HEADHOLD);/*                 @Y30LB40*/ 01467000
         PUT   PRNTDCB,HEADHOLD                                         01468000
*             RFY                                                  0511 01469000
*              (R0,                                                0511 01470000
*               R1,                                                0511 01471000
*               R14,                                               0511 01472000
*               R15) UNRSTD;        /*                       @Y30LB40*/ 01473000
*           END;                    /*                       @Y30LB40*/ 01474000
*         IF M=1 THEN                                              0513 01475000
@RF00501 CLC   M(4),@CF00044                                       0513 01476000
         BNE   @RF00513                                            0513 01477000
*           DO;                     /* 1ST TIME THROUGH, PRINT     0514 01478000
*                                      HEADINGS                      */ 01479000
*             RFY                                                  0515 01480000
*              (R0,                                                0515 01481000
*               R1,                                                0515 01482000
*               R14,                                               0515 01483000
*               R15) RSTD;          /*                       @Y30LB40*/ 01484000
*             GEN(PUT   PRNTDCB,HDNG2);/*                    @Y30LB40*/ 01485000
         PUT   PRNTDCB,HDNG2                                            01486000
*             GEN(PUT   PRNTDCB,HDNG3);/*                    @Y30LB40*/ 01487000
         PUT   PRNTDCB,HDNG3                                            01488000
*             GEN(PUT   PRNTDCB,HDNG4);/*                    @Y30LB40*/ 01489000
         PUT   PRNTDCB,HDNG4                                            01490000
*             GEN(PUT   PRNTDCB,SPACE1);/*                   @Y30LB40*/ 01491000
         PUT   PRNTDCB,SPACE1                                           01492000
*             RFY                                                  0520 01493000
*              (R0,                                                0520 01494000
*               R1,                                                0520 01495000
*               R14,                                               0520 01496000
*               R15) UNRSTD;        /*                       @Y30LB40*/ 01497000
*             LINECNT=LINECNT+5;    /*                       @Y30LB40*/ 01498000
         AL    LINECNT,@CF00372                                    0521 01499000
*           END;                    /*                       @Y30LB40*/ 01500000
*         CALL SETLINE(M);          /* SET INTERVALS IN PRINT LINE   */ 01501000
@RF00513 LA    @07,M                                               0523 01502000
         ST    @07,@AL00001                                        0523 01503000
         LA    @01,@AL00001                                        0523 01504000
         BAL   @14,SETLINE                                         0523 01505000
*         CALL CALCDSA(K,L,M);      /* GET ARRAY ADDRESS     @ZA16140*/ 01506000
         LA    @07,K                                               0524 01507000
         ST    @07,@AL00001                                        0524 01508000
         LA    @07,L                                               0524 01509000
         ST    @07,@AL00001+4                                      0524 01510000
         LA    @07,M                                               0524 01511000
         ST    @07,@AL00001+8                                      0524 01512000
         LA    @01,@AL00001                                        0524 01513000
         BAL   @14,CALCDSA                                         0524 01514000
*         CALL EDITFIX(ADDR(DSB2),4,'S');/*                  @Y30LB40*/ 01515000
         MVC   @AL00001+4(8),@AL00525                              0525 01516000
         L     @07,ARRAYPTR                                        0525 01517000
         LA    @07,DSB2(,@07)                                      0525 01518000
         ST    @07,@AFTEMPS                                        0525 01519000
         LA    @07,@AFTEMPS                                        0525 01520000
         ST    @07,@AL00001                                        0525 01521000
         LA    @01,@AL00001                                        0525 01522000
         BAL   @14,EDITFIX                                         0525 01523000
*         DSFLD10=FIXOUT(9:13);     /* LOAD TIME COUNT       @Y30LB40*/ 01524000
         MVC   DSFLD10(5),FIXOUT+8                                 0526 01525000
*         CALL EDITFIX(ADDR(DSB3),4,'S');/*                  @Y30LB40*/ 01526000
         MVC   @AL00001+4(8),@AL00527                              0527 01527000
         L     @07,ARRAYPTR                                        0527 01528000
         LA    @07,DSB3(,@07)                                      0527 01529000
         ST    @07,@AFTEMPS                                        0527 01530000
         LA    @07,@AFTEMPS                                        0527 01531000
         ST    @07,@AL00001                                        0527 01532000
         LA    @01,@AL00001                                        0527 01533000
         BAL   @14,EDITFIX                                         0527 01534000
*         DSFLD12=FIXOUT(8:13);     /* DEV STG RATE          @Y30LB40*/ 01535000
         MVC   DSFLD12(6),FIXOUT+7                                 0528 01536000
*         CALL EDITFIX(ADDR(DSB5),4,'S');/*                  @Y30LB40*/ 01537000
         MVC   @AL00001+4(8),@AL00529                              0529 01538000
         L     @07,ARRAYPTR                                        0529 01539000
         LA    @07,DSB5(,@07)                                      0529 01540000
         ST    @07,@AFTEMPS                                        0529 01541000
         LA    @07,@AFTEMPS                                        0529 01542000
         ST    @07,@AL00001                                        0529 01543000
         LA    @01,@AL00001                                        0529 01544000
         BAL   @14,EDITFIX                                         0529 01545000
*         DSFLD14=FIXOUT(8:13);     /* SYS STG RATE          @Y30LB40*/ 01546000
         MVC   DSFLD14(6),FIXOUT+7                                 0530 01547000
*         CALL EDITFIX(ADDR(DSB6),4,'S');/*                  @Y30LB40*/ 01548000
         MVC   @AL00001+4(8),@AL00531                              0531 01549000
         L     @07,ARRAYPTR                                        0531 01550000
         LA    @07,DSB6(,@07)                                      0531 01551000
         ST    @07,@AFTEMPS                                        0531 01552000
         LA    @07,@AFTEMPS                                        0531 01553000
         ST    @07,@AL00001                                        0531 01554000
         LA    @01,@AL00001                                        0531 01555000
         BAL   @14,EDITFIX                                         0531 01556000
*         DSFLD16=FIXOUT(8:13);     /* DEV DSTG RATE         @Y30LB40*/ 01557000
         MVC   DSFLD16(6),FIXOUT+7                                 0532 01558000
*         CALL EDITFIX(ADDR(DSB8),4,'S');/*                  @Y30LB40*/ 01559000
         MVC   @AL00001+4(8),@AL00533                              0533 01560000
         L     @07,ARRAYPTR                                        0533 01561000
         LA    @07,DSB8(,@07)                                      0533 01562000
         ST    @07,@AFTEMPS                                        0533 01563000
         LA    @07,@AFTEMPS                                        0533 01564000
         ST    @07,@AL00001                                        0533 01565000
         LA    @01,@AL00001                                        0533 01566000
         BAL   @14,EDITFIX                                         0533 01567000
*         DSFLD18=FIXOUT(8:13);     /* SYS DSTG RATE         @Y30LB40*/ 01568000
         MVC   DSFLD18(6),FIXOUT+7                                 0534 01569000
*         CALL EDITFIX(ADDR(DSB9),4,'S');/*                  @Y30LB40*/ 01570000
         MVC   @AL00001+4(8),@AL00535                              0535 01571000
         L     @07,ARRAYPTR                                        0535 01572000
         LA    @07,DSB9(,@07)                                      0535 01573000
         ST    @07,@AFTEMPS                                        0535 01574000
         LA    @07,@AFTEMPS                                        0535 01575000
         ST    @07,@AL00001                                        0535 01576000
         LA    @01,@AL00001                                        0535 01577000
         BAL   @14,EDITFIX                                         0535 01578000
*         DSFLD20=FIXOUT(8:13);     /* PAGES PER MINI        @Y30LB40*/ 01579000
         MVC   DSFLD20(6),FIXOUT+7                                 0536 01580000
*         CALL EDITFIX(ADDR(DSB10),4,'S');/*                 @Y30LB40*/ 01581000
         MVC   @AL00001+4(8),@AL00537                              0537 01582000
         L     @07,ARRAYPTR                                        0537 01583000
         LA    @07,DSB10(,@07)                                     0537 01584000
         ST    @07,@AFTEMPS                                        0537 01585000
         LA    @07,@AFTEMPS                                        0537 01586000
         ST    @07,@AL00001                                        0537 01587000
         LA    @01,@AL00001                                        0537 01588000
         BAL   @14,EDITFIX                                         0537 01589000
*         DSFLD22=FIXOUT(8:13);     /* CYLS PER PAGE         @Y30LB40*/ 01590000
         MVC   DSFLD22(6),FIXOUT+7                                 0538 01591000
*         DSB2=0;                   /* CLEAR BUCKETS         @Y30LB40*/ 01592000
         SLR   @07,@07                                             0539 01593000
         L     @15,ARRAYPTR                                        0539 01594000
         ST    @07,DSB2(,@15)                                      0539 01595000
*         DSB3=0;                   /*                       @Y30LB40*/ 01596000
         ST    @07,DSB3(,@15)                                      0540 01597000
*         DSB5=0;                   /*                       @Y30LB40*/ 01598000
         ST    @07,DSB5(,@15)                                      0541 01599000
*         DSB6=0;                   /*                       @Y30LB40*/ 01600000
         ST    @07,DSB6(,@15)                                      0542 01601000
*         DSB8=0;                   /*                       @Y30LB40*/ 01602000
         ST    @07,DSB8(,@15)                                      0543 01603000
*         DSB9=0;                   /*                       @Y30LB40*/ 01604000
         ST    @07,DSB9(,@15)                                      0544 01605000
*         DSB10=0;                  /*                       @Y30LB40*/ 01606000
         ST    @07,DSB10(,@15)                                     0545 01607000
*         RFY                                                      0546 01608000
*          (R0,                                                    0546 01609000
*           R1,                                                    0546 01610000
*           R14,                                                   0546 01611000
*           R15) RSTD;              /*                       @Y30LB40*/ 01612000
*         GEN(PUT   PRNTDCB,DSLINE);/* PRINT LINE            @Y30LB40*/ 01613000
         PUT   PRNTDCB,DSLINE                                           01614000
*         RFY                                                      0548 01615000
*          (R0,                                                    0548 01616000
*           R1,                                                    0548 01617000
*           R14,                                                   0548 01618000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 01619000
*         LINECNT=LINECNT+1;        /* BUMP LINE COUNT       @Y30LB40*/ 01620000
         AL    LINECNT,@CF00044                                    0549 01621000
*         DSFLD2=' ';               /* CLEAR CONSTANT INFO   @Y30LB40*/ 01622000
         MVI   DSFLD2+1,C' '                                       0550 01623000
         MVC   DSFLD2+2(4),DSFLD2+1                                0550 01624000
         MVI   DSFLD2,C' '                                         0550 01625000
*         DSFLD2A=' ';              /*                       @Y30LB40*/ 01626000
         MVI   DSFLD2A+1,C' '                                      0551 01627000
         MVC   DSFLD2A+2(6),DSFLD2A+1                              0551 01628000
         MVI   DSFLD2A,C' '                                        0551 01629000
*         SDGFLD=' ';               /*                       @ZA16140*/ 01630000
         MVI   SDGFLD+1,C' '                                       0552 01631000
         MVI   SDGFLD,C' '                                         0552 01632000
*         IF M=10 THEN                                             0553 01633000
         CLC   M(4),@CF00034                                       0553 01634000
         BNE   @RF00553                                            0553 01635000
*           DO;                     /* LAST TIME THROUGH THE LOOP    */ 01636000
*             RFY                                                  0555 01637000
*              (R0,                                                0555 01638000
*               R1,                                                0555 01639000
*               R14,                                               0555 01640000
*               R15) RSTD;          /*                       @Y30LB40*/ 01641000
*             GEN(PUT   PRNTDCB,HDNG5);/* PRINT TIME SLICE TOTALS    */ 01642000
         PUT   PRNTDCB,HDNG5                                            01643000
*             GEN(PUT   PRNTDCB,HDNG6);/*                    @Y30LB40*/ 01644000
         PUT   PRNTDCB,HDNG6                                            01645000
*             GEN(PUT   PRNTDCB,SPACE1);/*                   @Y30LB40*/ 01646000
         PUT   PRNTDCB,SPACE1                                           01647000
*             RFY                                                  0559 01648000
*              (R0,                                                0559 01649000
*               R1,                                                0559 01650000
*               R14,                                               0559 01651000
*               R15) UNRSTD;        /*                       @Y30LB40*/ 01652000
*             LINECNT=LINECNT+4;    /* ADD 4 TO LINE COUNTER         */ 01653000
         AL    LINECNT,@CF00104                                    0560 01654000
*             DSTLINE=' ';          /*                       @Y30LB40*/ 01655000
         MVI   DSTLINE+1,C' '                                      0561 01656000
         MVC   DSTLINE+2(119),DSTLINE+1                            0561 01657000
         MVI   DSTLINE,C' '                                        0561 01658000
*             CALL CALCDSA(K,L,11); /* GET ARRAY ADDRESS     @ZA16140*/ 01659000
         LA    @07,K                                               0562 01660000
         ST    @07,@AL00001                                        0562 01661000
         LA    @07,L                                               0562 01662000
         ST    @07,@AL00001+4                                      0562 01663000
         LA    @07,@CF00033                                        0562 01664000
         ST    @07,@AL00001+8                                      0562 01665000
         LA    @01,@AL00001                                        0562 01666000
         BAL   @14,CALCDSA                                         0562 01667000
*             CALL EDITFIX(ADDR(DSB1),4,'S');/*              @Y30LB40*/ 01668000
         MVC   @AL00001+4(8),@AL00563                              0563 01669000
         LA    @07,ARRAYPTR                                        0563 01670000
         ST    @07,@AL00001                                        0563 01671000
         LA    @01,@AL00001                                        0563 01672000
         BAL   @14,EDITFIX                                         0563 01673000
*             DSTFLD2=FIXOUT(8:13); /* TOTAL CARTRIDGES              */ 01674000
         MVC   DSTFLD2(6),FIXOUT+7                                 0564 01675000
*             CALCFLD=DSB2/4;       /*                       @Y30LB40*/ 01676000
         L     @07,ARRAYPTR                                        0565 01677000
         L     @00,DSB2(,@07)                                      0565 01678000
         SRDA  @00,32                                              0565 01679000
         D     @00,@CF00104                                        0565 01680000
         ST    @01,CALCFLD                                         0565 01681000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01682000
         MVC   @AL00001+4(8),@AL00566                              0566 01683000
         LA    @07,CALCFLD                                         0566 01684000
         ST    @07,@AFTEMPS                                        0566 01685000
         LA    @07,@AFTEMPS                                        0566 01686000
         ST    @07,@AL00001                                        0566 01687000
         LA    @01,@AL00001                                        0566 01688000
         BAL   @14,EDITFIX                                         0566 01689000
*             DSTFLD4=FIXOUT(8:13); /* TOTAL LOAD TIME               */ 01690000
         MVC   DSTFLD4(6),FIXOUT+7                                 0567 01691000
*             CALL EDITFIX(ADDR(DSB3),4,'S');/*              @Y30LB40*/ 01692000
         MVC   @AL00001+4(8),@AL00568                              0568 01693000
         L     @07,ARRAYPTR                                        0568 01694000
         LA    @07,DSB3(,@07)                                      0568 01695000
         ST    @07,@AFTEMPS                                        0568 01696000
         LA    @07,@AFTEMPS                                        0568 01697000
         ST    @07,@AL00001                                        0568 01698000
         LA    @01,@AL00001                                        0568 01699000
         BAL   @14,EDITFIX                                         0568 01700000
*             DSTFLD6=FIXOUT(8:13); /* TOTAL CYLS STAGED             */ 01701000
         MVC   DSTFLD6(6),FIXOUT+7                                 0569 01702000
*             CALCFLD=DSB4/4;       /*                       @Y30LB40*/ 01703000
         L     @07,ARRAYPTR                                        0570 01704000
         L     @00,DSB4(,@07)                                      0570 01705000
         SRDA  @00,32                                              0570 01706000
         D     @00,@CF00104                                        0570 01707000
         ST    @01,CALCFLD                                         0570 01708000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01709000
         MVC   @AL00001+4(8),@AL00571                              0571 01710000
         LA    @07,CALCFLD                                         0571 01711000
         ST    @07,@AFTEMPS                                        0571 01712000
         LA    @07,@AFTEMPS                                        0571 01713000
         ST    @07,@AL00001                                        0571 01714000
         LA    @01,@AL00001                                        0571 01715000
         BAL   @14,EDITFIX                                         0571 01716000
*             DSTFLD8=FIXOUT(8:13); /* TOT DEV STG TIME              */ 01717000
         MVC   DSTFLD8(6),FIXOUT+7                                 0572 01718000
*             CALCFLD=DSB5/4;       /*                       @Y30LB40*/ 01719000
         L     @07,ARRAYPTR                                        0573 01720000
         L     @00,DSB5(,@07)                                      0573 01721000
         SRDA  @00,32                                              0573 01722000
         D     @00,@CF00104                                        0573 01723000
         ST    @01,CALCFLD                                         0573 01724000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01725000
         MVC   @AL00001+4(8),@AL00574                              0574 01726000
         LA    @07,CALCFLD                                         0574 01727000
         ST    @07,@AFTEMPS                                        0574 01728000
         LA    @07,@AFTEMPS                                        0574 01729000
         ST    @07,@AL00001                                        0574 01730000
         LA    @01,@AL00001                                        0574 01731000
         BAL   @14,EDITFIX                                         0574 01732000
*             DSTFLD10=FIXOUT(8:13);/* TOT SYS STG TIME              */ 01733000
         MVC   DSTFLD10(6),FIXOUT+7                                0575 01734000
*             CALL EDITFIX(ADDR(DSB6),4,'S');/*              @Y30LB40*/ 01735000
         MVC   @AL00001+4(8),@AL00576                              0576 01736000
         L     @07,ARRAYPTR                                        0576 01737000
         LA    @07,DSB6(,@07)                                      0576 01738000
         ST    @07,@AFTEMPS                                        0576 01739000
         LA    @07,@AFTEMPS                                        0576 01740000
         ST    @07,@AL00001                                        0576 01741000
         LA    @01,@AL00001                                        0576 01742000
         BAL   @14,EDITFIX                                         0576 01743000
*             DSTFLD12=FIXOUT(8:13);/* TOT CYLS DESTAGED             */ 01744000
         MVC   DSTFLD12(6),FIXOUT+7                                0577 01745000
*             CALCFLD=DSB7/4;       /*                       @Y30LB40*/ 01746000
         L     @07,ARRAYPTR                                        0578 01747000
         L     @00,DSB7(,@07)                                      0578 01748000
         SRDA  @00,32                                              0578 01749000
         D     @00,@CF00104                                        0578 01750000
         ST    @01,CALCFLD                                         0578 01751000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01752000
         MVC   @AL00001+4(8),@AL00579                              0579 01753000
         LA    @07,CALCFLD                                         0579 01754000
         ST    @07,@AFTEMPS                                        0579 01755000
         LA    @07,@AFTEMPS                                        0579 01756000
         ST    @07,@AL00001                                        0579 01757000
         LA    @01,@AL00001                                        0579 01758000
         BAL   @14,EDITFIX                                         0579 01759000
*             DSTFLD14=FIXOUT(8:13);/* TOT DEV DSTG TIME             */ 01760000
         MVC   DSTFLD14(6),FIXOUT+7                                0580 01761000
*             CALCFLD=DSB8/4;       /*                       @Y30LB40*/ 01762000
         L     @07,ARRAYPTR                                        0581 01763000
         L     @00,DSB8(,@07)                                      0581 01764000
         SRDA  @00,32                                              0581 01765000
         D     @00,@CF00104                                        0581 01766000
         ST    @01,CALCFLD                                         0581 01767000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01768000
         MVC   @AL00001+4(8),@AL00582                              0582 01769000
         LA    @07,CALCFLD                                         0582 01770000
         ST    @07,@AFTEMPS                                        0582 01771000
         LA    @07,@AFTEMPS                                        0582 01772000
         ST    @07,@AL00001                                        0582 01773000
         LA    @01,@AL00001                                        0582 01774000
         BAL   @14,EDITFIX                                         0582 01775000
*             DSTFLD16=FIXOUT(8:13);/* TOT SYS DSTG TIME             */ 01776000
         MVC   DSTFLD16(6),FIXOUT+7                                0583 01777000
*             CALL EDITFIX(ADDR(DSB9),4,'S');/*              @Y30LB40*/ 01778000
         MVC   @AL00001+4(8),@AL00584                              0584 01779000
         L     @07,ARRAYPTR                                        0584 01780000
         LA    @07,DSB9(,@07)                                      0584 01781000
         ST    @07,@AFTEMPS                                        0584 01782000
         LA    @07,@AFTEMPS                                        0584 01783000
         ST    @07,@AL00001                                        0584 01784000
         LA    @01,@AL00001                                        0584 01785000
         BAL   @14,EDITFIX                                         0584 01786000
*             DSTFLD18=FIXOUT(8:13);/* TOT CYLS TRANSFRD             */ 01787000
         MVC   DSTFLD18(6),FIXOUT+7                                0585 01788000
*             CALCFLD=DSB10/4;      /*                       @Y30LB40*/ 01789000
         L     @07,ARRAYPTR                                        0586 01790000
         L     @00,DSB10(,@07)                                     0586 01791000
         SRDA  @00,32                                              0586 01792000
         D     @00,@CF00104                                        0586 01793000
         ST    @01,CALCFLD                                         0586 01794000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01795000
         MVC   @AL00001+4(8),@AL00587                              0587 01796000
         LA    @07,CALCFLD                                         0587 01797000
         ST    @07,@AFTEMPS                                        0587 01798000
         LA    @07,@AFTEMPS                                        0587 01799000
         ST    @07,@AL00001                                        0587 01800000
         LA    @01,@AL00001                                        0587 01801000
         BAL   @14,EDITFIX                                         0587 01802000
*             DSTFLD20=FIXOUT(8:13);/* TOT DEVICE TIME               */ 01803000
         MVC   DSTFLD20(6),FIXOUT+7                                0588 01804000
*             CALCFLD=DSB11/4;      /*                       @Y30LB40*/ 01805000
         L     @07,ARRAYPTR                                        0589 01806000
         L     @00,DSB11(,@07)                                     0589 01807000
         SRDA  @00,32                                              0589 01808000
         D     @00,@CF00104                                        0589 01809000
         ST    @01,CALCFLD                                         0589 01810000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01811000
         MVC   @AL00001+4(8),@AL00590                              0590 01812000
         LA    @07,CALCFLD                                         0590 01813000
         ST    @07,@AFTEMPS                                        0590 01814000
         LA    @07,@AFTEMPS                                        0590 01815000
         ST    @07,@AL00001                                        0590 01816000
         LA    @01,@AL00001                                        0590 01817000
         BAL   @14,EDITFIX                                         0590 01818000
*             DSTFLD22=FIXOUT(8:13);/* TOT SYSTEM TIME               */ 01819000
         MVC   DSTFLD22(6),FIXOUT+7                                0591 01820000
*             IF DSB10=0 THEN                                      0592 01821000
         L     @07,ARRAYPTR                                        0592 01822000
         L     @15,DSB10(,@07)                                     0592 01823000
         LTR   @15,@15                                             0592 01824000
         BNZ   @RF00592                                            0592 01825000
*               DSB10=1;            /*                       @Y30LB40*/ 01826000
         MVC   DSB10(4,@07),@CF00044                               0593 01827000
*             CALCFLD=((DSB9*4)/DSB10);/*                    @Y30LB40*/ 01828000
@RF00592 L     @07,ARRAYPTR                                        0594 01829000
         L     @15,DSB9(,@07)                                      0594 01830000
         SLA   @15,2                                               0594 01831000
         LR    @00,@15                                             0594 01832000
         SRDA  @00,32                                              0594 01833000
         D     @00,DSB10(,@07)                                     0594 01834000
         ST    @01,CALCFLD                                         0594 01835000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01836000
         MVC   @AL00001+4(8),@AL00595                              0595 01837000
         LA    @07,CALCFLD                                         0595 01838000
         ST    @07,@AFTEMPS                                        0595 01839000
         LA    @07,@AFTEMPS                                        0595 01840000
         ST    @07,@AL00001                                        0595 01841000
         LA    @01,@AL00001                                        0595 01842000
         BAL   @14,EDITFIX                                         0595 01843000
*             DSTFLD24=FIXOUT(8:13);/* DEVICE RATE           @Y30LB40*/ 01844000
         MVC   DSTFLD24(6),FIXOUT+7                                0596 01845000
*             IF DSB11=0 THEN                                      0597 01846000
         L     @07,ARRAYPTR                                        0597 01847000
         L     @15,DSB11(,@07)                                     0597 01848000
         LTR   @15,@15                                             0597 01849000
         BNZ   @RF00597                                            0597 01850000
*               DSB11=1;            /*                       @Y30LB40*/ 01851000
         MVC   DSB11(4,@07),@CF00044                               0598 01852000
*             CALCFLD=((DSB9*4)/DSB11);/*                    @Y30LB40*/ 01853000
@RF00597 L     @07,ARRAYPTR                                        0599 01854000
         L     @15,DSB9(,@07)                                      0599 01855000
         SLA   @15,2                                               0599 01856000
         LR    @00,@15                                             0599 01857000
         SRDA  @00,32                                              0599 01858000
         D     @00,DSB11(,@07)                                     0599 01859000
         ST    @01,CALCFLD                                         0599 01860000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01861000
         MVC   @AL00001+4(8),@AL00600                              0600 01862000
         LA    @07,CALCFLD                                         0600 01863000
         ST    @07,@AFTEMPS                                        0600 01864000
         LA    @07,@AFTEMPS                                        0600 01865000
         ST    @07,@AL00001                                        0600 01866000
         LA    @01,@AL00001                                        0600 01867000
         BAL   @14,EDITFIX                                         0600 01868000
*             DSTFLD26=FIXOUT(8:13);/* SYSTEM RATE           @Y30LB40*/ 01869000
         MVC   DSTFLD26(6),FIXOUT+7                                0601 01870000
*             RFY                                                  0602 01871000
*              (R0,                                                0602 01872000
*               R1,                                                0602 01873000
*               R14,                                               0602 01874000
*               R15) RSTD;          /*                       @Y30LB40*/ 01875000
*             GEN(PUT   PRNTDCB,DSTLINE);/* PRINT TOTAL LINE         */ 01876000
         PUT   PRNTDCB,DSTLINE                                          01877000
*             GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE       @Y30LB40*/ 01878000
         PUT   PRNTDCB,SPACE1                                           01879000
*             RFY                                                  0605 01880000
*              (R0,                                                0605 01881000
*               R1,                                                0605 01882000
*               R14,                                               0605 01883000
*               R15) UNRSTD;        /*                       @Y30LB40*/ 01884000
*             LINECNT=LINECNT+2;    /* BUMP LINE COUNT       @Y30LB40*/ 01885000
         AL    LINECNT,@CF00051                                    0606 01886000
*             DSB1=0;               /* CLEAR BUCKETS         @Y30LB40*/ 01887000
         SLR   @07,@07                                             0607 01888000
         L     @15,ARRAYPTR                                        0607 01889000
         ST    @07,DSB1(,@15)                                      0607 01890000
*             DSB2=0;               /*                       @Y30LB40*/ 01891000
         ST    @07,DSB2(,@15)                                      0608 01892000
*             DSB3=0;               /*                       @Y30LB40*/ 01893000
         ST    @07,DSB3(,@15)                                      0609 01894000
*             DSB4=0;               /*                       @Y30LB40*/ 01895000
         ST    @07,DSB4(,@15)                                      0610 01896000
*             DSB5=0;               /*                       @Y30LB40*/ 01897000
         ST    @07,DSB5(,@15)                                      0611 01898000
*             DSB6=0;               /*                       @Y30LB40*/ 01899000
         ST    @07,DSB6(,@15)                                      0612 01900000
*             DSB7=0;               /*                       @Y30LB40*/ 01901000
         ST    @07,DSB7(,@15)                                      0613 01902000
*             DSB8=0;               /*                       @Y30LB40*/ 01903000
         ST    @07,DSB8(,@15)                                      0614 01904000
*             DSB9=0;               /*                       @Y30LB40*/ 01905000
         ST    @07,DSB9(,@15)                                      0615 01906000
*             DSB10=0;              /*                       @Y30LB40*/ 01907000
         ST    @07,DSB10(,@15)                                     0616 01908000
*             DSB11=0;              /*                       @Y30LB40*/ 01909000
         ST    @07,DSB11(,@15)                                     0617 01910000
*           END;                    /*                       @Y30LB40*/ 01911000
*       END;                        /*                       @Y30LB40*/ 01912000
@RF00553 LA    @07,1                                               0619 01913000
         AL    @07,M                                               0619 01914000
         ST    @07,M                                               0619 01915000
         C     @07,@CF00034                                        0619 01916000
         BNH   @DL00500                                            0619 01917000
*   END;                            /*                       @Y30LB40*/ 01918000
@RF00499 LA    @07,1                                               0620 01919000
         AL    @07,K                                               0620 01920000
         ST    @07,K                                               0620 01921000
         C     @07,@CF00615                                        0620 01922000
         BNH   @DL00471                                            0620 01923000
*   IF EOFSW='1'B THEN                                             0621 01924000
         TM    EOFSW,B'10000000'                                   0621 01925000
         BNO   @RF00621                                            0621 01926000
*     DO;                           /* END OF JOB YET        @Y30LB40*/ 01927000
*       IF L=2 THEN                                                0623 01928000
         LA    @07,2                                               0623 01929000
         C     @07,L                                               0623 01930000
         BE    @RT00623                                            0623 01931000
*         GO TO EOJ;                /* REPORT TOTALS WRITTEN,GETOUT  */ 01932000
*       ELSE                                                       0625 01933000
*         DO;                       /* FORCE TOTAL LINES OUT @Y30LB40*/ 01934000
*           L=2;                    /* INDICATE REPORT TOTALS      0626 01935000
*                                                            @Y30LB40*/ 01936000
         ST    @07,L                                               0626 01937000
*           LINECNT=56;             /* FORCE TO A NEW PAGE   @Y30LB40*/ 01938000
         LA    LINECNT,56                                          0627 01939000
*           GO TO PROCDSBK;         /* GO PRINT TOTALS       @Y30LB40*/ 01940000
         B     PROCDSBK                                            0628 01941000
*         END;                      /*                       @Y30LB40*/ 01942000
*     END;                          /*                       @Y30LB40*/ 01943000
*   CALL GETSLICE;                  /* SET UP NEXT TIME SLICE      0631 01944000
*                                      INTERVAL              @OZ11673*/ 01945000
@RF00621 BAL   @14,GETSLICE                                        0631 01946000
*   GO TO CHECKTIM;                 /*                       @Y30LB40*/ 01947000
         B     CHECKTIM                                            0632 01948000
*/********************************************************************/ 01949000
*                                                                  0633 01950000
*                                                                  0633 01951000
*/********************************************************************/ 01952000
*/* ROUTINE TO BUILD READ/WRITE REPORT                       @Y30LB40*/ 01953000
*/********************************************************************/ 01954000
*                                                                  0633 01955000
*ROUTINE2:                          /* CHECK IF IN PROPER TIME SLICE */ 01956000
*   IF CKTIME>TSEND THEN                                           0633 01957000
ROUTINE2 CLC   CKTIME(7),TSEND                                     0633 01958000
         BH    @RT00633                                            0633 01959000
*     GO TO RWCTLBRK;               /* NEW TIME SLICE        @Y30LB40*/ 01960000
*RWACCUM:                           /* ACCUMULATE NECESSARY RW TOTALS*/ 01961000
*   J=LIBRARY+1;                    /* LIBRARY 0 THRU 1      @ZA16140*/ 01962000
RWACCUM  LA    @07,1                                               0635 01963000
         SLR   @15,@15                                             0635 01964000
         IC    @15,LIBRARY                                         0635 01965000
         ALR   @15,@07                                             0635 01966000
         ST    @15,J                                               0635 01967000
*   K=READWRIT+1;                   /* READ WRITE UNIT       @Y30LB40*/ 01968000
         SLR   @15,@15                                             0636 01969000
         IC    @15,READWRIT                                        0636 01970000
         ALR   @07,@15                                             0636 01971000
         ST    @07,K                                               0636 01972000
*   IF K>8 THEN                                                    0637 01973000
         LA    @15,8                                               0637 01974000
         CR    @07,@15                                             0637 01975000
         BNH   @RF00637                                            0637 01976000
*     K=8;                          /* IF GREATER THEN 8 SET TO MAX  */ 01977000
         ST    @15,K                                               0638 01978000
*   M=((LOADTIME/4)/3)+1;           /* BUILD CLASS INTERVAL FOR LOAD    01979000
*                                      TIME                          */ 01980000
@RF00637 L     @00,LOADTIME                                        0639 01981000
         SRDA  @00,32                                              0639 01982000
         D     @00,@CF00032                                        0639 01983000
         AL    @01,@CF00044                                        0639 01984000
         ST    @01,M                                               0639 01985000
*   IF M>10 THEN                                                   0640 01986000
         LA    @07,10                                              0640 01987000
         CR    @01,@07                                             0640 01988000
         BNH   @RF00640                                            0640 01989000
*     M=10;                         /* SET TO MAX            @Y30LB40*/ 01990000
         ST    @07,M                                               0641 01991000
*   DO L=1 TO 2;                    /* DETAIL AND JOB TOTALS @Y30LB40*/ 01992000
@RF00640 LA    @07,1                                               0642 01993000
         ST    @07,L                                               0642 01994000
@DL00642 DS    0H                                                  0643 01995000
*     CALL CALCRWA(J,K,L,11);       /* GET ARRAY ADDRESS     @Y30LB40*/ 01996000
         LA    @07,J                                               0643 01997000
         ST    @07,@AL00001                                        0643 01998000
         LA    @07,K                                               0643 01999000
         ST    @07,@AL00001+4                                      0643 02000000
         LA    @07,L                                               0643 02001000
         ST    @07,@AL00001+8                                      0643 02002000
         LA    @07,@CF00033                                        0643 02003000
         ST    @07,@AL00001+12                                     0643 02004000
         LA    @01,@AL00001                                        0643 02005000
         BAL   @14,CALCRWA                                         0643 02006000
*     RWB1=RWB1+LOADNUM;            /* SUM CARTRIDGE LOADS   @Y30LB40*/ 02007000
         L     @07,ARRAYPTR                                        0644 02008000
         SLR   @15,@15                                             0644 02009000
         IC    @15,LOADNUM                                         0644 02010000
         AL    @15,RWB1(,@07)                                      0644 02011000
         ST    @15,RWB1(,@07)                                      0644 02012000
*     CALL CALCRWA(J,K,L,M);        /* GET ARRAY ADDRESS     @Y30LB40*/ 02013000
         LA    @07,J                                               0645 02014000
         ST    @07,@AL00001                                        0645 02015000
         LA    @07,K                                               0645 02016000
         ST    @07,@AL00001+4                                      0645 02017000
         LA    @07,L                                               0645 02018000
         ST    @07,@AL00001+8                                      0645 02019000
         LA    @07,M                                               0645 02020000
         ST    @07,@AL00001+12                                     0645 02021000
         LA    @01,@AL00001                                        0645 02022000
         BAL   @14,CALCRWA                                         0645 02023000
*     IF LOADNUM=0 THEN                                            0646 02024000
         CLI   LOADNUM,0                                           0646 02025000
         BE    @RT00646                                            0646 02026000
*       ;                           /*                       @Y30LB40*/ 02027000
*     ELSE                                                         0648 02028000
*       RWB2=RWB2+1;                /* COUNT FOR LOAD TIME   @Y30LB40*/ 02029000
         L     @07,ARRAYPTR                                        0648 02030000
         LA    @15,1                                               0648 02031000
         AL    @15,RWB2(,@07)                                      0648 02032000
         ST    @15,RWB2(,@07)                                      0648 02033000
*     CALL CALCRWA(J,K,L,11);       /* GET ARRAY ADDRESS     @Y30LB40*/ 02034000
@RT00646 LA    @07,J                                               0649 02035000
         ST    @07,@AL00001                                        0649 02036000
         LA    @07,K                                               0649 02037000
         ST    @07,@AL00001+4                                      0649 02038000
         LA    @07,L                                               0649 02039000
         ST    @07,@AL00001+8                                      0649 02040000
         LA    @07,@CF00033                                        0649 02041000
         ST    @07,@AL00001+12                                     0649 02042000
         LA    @01,@AL00001                                        0649 02043000
         BAL   @14,CALCRWA                                         0649 02044000
*     RWB2=RWB2+LOADTIME;           /* SUM LOAD TIME         @Y30LB40*/ 02045000
         L     @07,ARRAYPTR                                        0650 02046000
         L     @15,RWB2(,@07)                                      0650 02047000
         AL    @15,LOADTIME                                        0650 02048000
         ST    @15,RWB2(,@07)                                      0650 02049000
*     IF STGDNUM¬=0 THEN                                           0651 02050000
         CLI   STGDNUM,0                                           0651 02051000
         BE    @RF00651                                            0651 02052000
*       DO;                         /* SUM STAGING FIELDS    @Y30LB40*/ 02053000
*         CALL CALCRWA(J,K,L,11);   /* GET ARRAY ADDRESS     @Y30LB40*/ 02054000
         LA    @07,J                                               0653 02055000
         ST    @07,@AL00001                                        0653 02056000
         LA    @07,K                                               0653 02057000
         ST    @07,@AL00001+4                                      0653 02058000
         LA    @07,L                                               0653 02059000
         ST    @07,@AL00001+8                                      0653 02060000
         LA    @07,@CF00033                                        0653 02061000
         ST    @07,@AL00001+12                                     0653 02062000
         LA    @01,@AL00001                                        0653 02063000
         BAL   @14,CALCRWA                                         0653 02064000
*         RWB3=RWB3+STGD;           /* SUM TOT CYLS          @Y30LB40*/ 02065000
         L     @07,ARRAYPTR                                        0654 02066000
         L     @15,STGD                                            0654 02067000
         L     @14,RWB3(,@07)                                      0654 02068000
         ALR   @14,@15                                             0654 02069000
         ST    @14,RWB3(,@07)                                      0654 02070000
*         RWB4=RWB4+DEVSGTM;        /* DEV STG TIME          @Y30LB40*/ 02071000
         L     @14,DEVSGTM                                         0655 02072000
         L     @05,RWB4(,@07)                                      0655 02073000
         ALR   @05,@14                                             0655 02074000
         ST    @05,RWB4(,@07)                                      0655 02075000
*         IF DEVSGTM=0 THEN                                        0656 02076000
         LTR   @14,@14                                             0656 02077000
         BNZ   @RF00656                                            0656 02078000
*           N=(STGD*4)+1;           /*                       @Y30LB40*/ 02079000
         SLA   @15,2                                               0657 02080000
         AL    @15,@CF00044                                        0657 02081000
         ST    @15,N                                               0657 02082000
*         ELSE                                                     0658 02083000
*           N=((STGD*4)/DEVSGTM)+1; /*                       @Y30LB40*/ 02084000
         B     @RC00656                                            0658 02085000
@RF00656 L     @01,STGD                                            0658 02086000
         M     @00,@CF00104                                        0658 02087000
         D     @00,DEVSGTM                                         0658 02088000
         AL    @01,@CF00044                                        0658 02089000
         ST    @01,N                                               0658 02090000
*         IF N>10 THEN                                             0659 02091000
@RC00656 LA    @07,10                                              0659 02092000
         C     @07,N                                               0659 02093000
         BNL   @RF00659                                            0659 02094000
*           N=10;                   /* SET TO MAX            @Y30LB40*/ 02095000
         ST    @07,N                                               0660 02096000
*         CALL CALCRWA(J,K,L,N);    /* GET ARRAY ADDRESS     @Y30LB40*/ 02097000
@RF00659 LA    @07,J                                               0661 02098000
         ST    @07,@AL00001                                        0661 02099000
         LA    @07,K                                               0661 02100000
         ST    @07,@AL00001+4                                      0661 02101000
         LA    @07,L                                               0661 02102000
         ST    @07,@AL00001+8                                      0661 02103000
         LA    @07,N                                               0661 02104000
         ST    @07,@AL00001+12                                     0661 02105000
         LA    @01,@AL00001                                        0661 02106000
         BAL   @14,CALCRWA                                         0661 02107000
*         RWB7=RWB7+STGDNUM;        /* DEVICE STG RATE       @Y30LB40*/ 02108000
         L     @07,ARRAYPTR                                        0662 02109000
         SLR   @15,@15                                             0662 02110000
         IC    @15,STGDNUM                                         0662 02111000
         AL    @15,RWB7(,@07)                                      0662 02112000
         ST    @15,RWB7(,@07)                                      0662 02113000
*       END;                        /*                       @Y30LB40*/ 02114000
*     IF DSTGDNUM¬=0 THEN                                          0664 02115000
@RF00651 CLI   DSTGDNUM,0                                          0664 02116000
         BE    @RF00664                                            0664 02117000
*       DO;                         /* SUM DESTAGING FIELDS  @Y30LB40*/ 02118000
*         CALL CALCRWA(J,K,L,11);   /* GET ARRAY ADDRESS     @Y30LB40*/ 02119000
         LA    @07,J                                               0666 02120000
         ST    @07,@AL00001                                        0666 02121000
         LA    @07,K                                               0666 02122000
         ST    @07,@AL00001+4                                      0666 02123000
         LA    @07,L                                               0666 02124000
         ST    @07,@AL00001+8                                      0666 02125000
         LA    @07,@CF00033                                        0666 02126000
         ST    @07,@AL00001+12                                     0666 02127000
         LA    @01,@AL00001                                        0666 02128000
         BAL   @14,CALCRWA                                         0666 02129000
*         RWB5=RWB5+DSTGD;          /* SUM TOT CYLS          @Y30LB40*/ 02130000
         L     @07,ARRAYPTR                                        0667 02131000
         L     @15,DSTGD                                           0667 02132000
         L     @14,RWB5(,@07)                                      0667 02133000
         ALR   @14,@15                                             0667 02134000
         ST    @14,RWB5(,@07)                                      0667 02135000
*         RWB6=RWB6+DEVDSTM;        /* DEV DSTG TME          @Y30LB40*/ 02136000
         L     @14,DEVDSTM                                         0668 02137000
         L     @05,RWB6(,@07)                                      0668 02138000
         ALR   @05,@14                                             0668 02139000
         ST    @05,RWB6(,@07)                                      0668 02140000
*         IF DEVDSTM=0 THEN                                        0669 02141000
         LTR   @14,@14                                             0669 02142000
         BNZ   @RF00669                                            0669 02143000
*           N=(DSTGD*4)+1;          /*                       @Y30LB40*/ 02144000
         SLA   @15,2                                               0670 02145000
         AL    @15,@CF00044                                        0670 02146000
         ST    @15,N                                               0670 02147000
*         ELSE                                                     0671 02148000
*           N=((DSTGD*4)/DEVDSTM)+1;/*                       @Y30LB40*/ 02149000
         B     @RC00669                                            0671 02150000
@RF00669 L     @01,DSTGD                                           0671 02151000
         M     @00,@CF00104                                        0671 02152000
         D     @00,DEVDSTM                                         0671 02153000
         AL    @01,@CF00044                                        0671 02154000
         ST    @01,N                                               0671 02155000
*         IF N>10 THEN                                             0672 02156000
@RC00669 LA    @07,10                                              0672 02157000
         C     @07,N                                               0672 02158000
         BNL   @RF00672                                            0672 02159000
*           N=10;                   /* SET TO MAX            @Y30LB40*/ 02160000
         ST    @07,N                                               0673 02161000
*         CALL CALCRWA(J,K,L,N);    /* GET ARRAY ADDRESS     @Y30LB40*/ 02162000
@RF00672 LA    @07,J                                               0674 02163000
         ST    @07,@AL00001                                        0674 02164000
         LA    @07,K                                               0674 02165000
         ST    @07,@AL00001+4                                      0674 02166000
         LA    @07,L                                               0674 02167000
         ST    @07,@AL00001+8                                      0674 02168000
         LA    @07,N                                               0674 02169000
         ST    @07,@AL00001+12                                     0674 02170000
         LA    @01,@AL00001                                        0674 02171000
         BAL   @14,CALCRWA                                         0674 02172000
*         RWB8=RWB8+DSTGDNUM;       /* DSTG RATE             @Y30LB40*/ 02173000
         L     @07,ARRAYPTR                                        0675 02174000
         SLR   @15,@15                                             0675 02175000
         IC    @15,DSTGDNUM                                        0675 02176000
         AL    @15,RWB8(,@07)                                      0675 02177000
         ST    @15,RWB8(,@07)                                      0675 02178000
*       END;                        /*                       @Y30LB40*/ 02179000
*     N=((BUSYTIME/4)/6)+1;         /*                       @Y30LB40*/ 02180000
@RF00664 L     @00,BUSYTIME                                        0677 02181000
         SRDA  @00,32                                              0677 02182000
         D     @00,@CF00071                                        0677 02183000
         AL    @01,@CF00044                                        0677 02184000
         ST    @01,N                                               0677 02185000
*     IF N>10 THEN                                                 0678 02186000
         LA    @07,10                                              0678 02187000
         CR    @01,@07                                             0678 02188000
         BNH   @RF00678                                            0678 02189000
*       N=10;                       /*                       @Y30LB40*/ 02190000
         ST    @07,N                                               0679 02191000
*     CALL CALCRWA(J,K,L,N);        /* GET ARRAY ADDRESS     @Y30LB40*/ 02192000
@RF00678 LA    @07,J                                               0680 02193000
         ST    @07,@AL00001                                        0680 02194000
         LA    @07,K                                               0680 02195000
         ST    @07,@AL00001+4                                      0680 02196000
         LA    @07,L                                               0680 02197000
         ST    @07,@AL00001+8                                      0680 02198000
         LA    @07,N                                               0680 02199000
         ST    @07,@AL00001+12                                     0680 02200000
         LA    @01,@AL00001                                        0680 02201000
         BAL   @14,CALCRWA                                         0680 02202000
*     RWB9=RWB9+1;                  /*                       @Y30LB40*/ 02203000
         L     @07,ARRAYPTR                                        0681 02204000
         LA    @15,1                                               0681 02205000
         AL    @15,RWB9(,@07)                                      0681 02206000
         ST    @15,RWB9(,@07)                                      0681 02207000
*   END;                            /*                       @Y30LB40*/ 02208000
         LA    @07,1                                               0682 02209000
         AL    @07,L                                               0682 02210000
         ST    @07,L                                               0682 02211000
         C     @07,@CF00051                                        0682 02212000
         BNH   @DL00642                                            0682 02213000
*   GO TO RDTRACE;                  /* GO READ NEXT RECORD   @Y30LB40*/ 02214000
         B     RDTRACE                                             0683 02215000
*/********************************************************************/ 02216000
*                                                                  0684 02217000
*                                                                  0684 02218000
*/********************************************************************/ 02219000
*/* PRINT RW TIME SLICE TOTALS                               @Y30LB40*/ 02220000
*/********************************************************************/ 02221000
*                                                                  0684 02222000
*RWCTLBRK:                          /* READ WRITE TIME SLICE CTL   0684 02223000
*                                      BREAK                         */ 02224000
*   L=1;                            /* DETAIL ONLY           @Y30LB40*/ 02225000
RWCTLBRK MVC   L(4),@CF00044                                       0684 02226000
*PROCRWBK:                                                         0685 02227000
*   RWLINE=' ';                     /*                       @Y30LB40*/ 02228000
PROCRWBK MVI   RWLINE+1,C' '                                       0685 02229000
         MVC   RWLINE+2(119),RWLINE+1                              0685 02230000
         MVI   RWLINE,C' '                                         0685 02231000
*   DO J=1 TO 2;                    /* PROCESS LIBRARIES 0 THRU 1    */ 02232000
         LA    @07,1                                               0686 02233000
         ST    @07,J                                               0686 02234000
@DL00686 DS    0H                                                  0687 02235000
*     DO K=1 TO 8;                  /* PROCESS RWU 0 THRU 7  @Y30LB40*/ 02236000
         LA    @07,1                                               0687 02237000
         ST    @07,K                                               0687 02238000
@DL00687 DS    0H                                                  0688 02239000
*       RWLINE=' ';                 /*                       @Y30LB40*/ 02240000
         MVI   RWLINE+1,C' '                                       0688 02241000
         MVC   RWLINE+2(119),RWLINE+1                              0688 02242000
         MVI   RWLINE,C' '                                         0688 02243000
*       RWFLD4=SSIDEQ(J);           /* LIBRARY               @OZ05079*/ 02244000
         L     @15,J                                               0689 02245000
         LA    @14,SSIDEQ-1(@15)                                   0689 02246000
         MVC   RWFLD4(1),0(@14)                                    0689 02247000
*       CHAR2='2';                  /* 1ST DIGIT ALWAYS 2    @OZ05079*/ 02248000
         MVI   CHAR2,C'2'                                          0690 02249000
*       DRDMSFID=SSIDEQ(J);         /* 2ND CHAR = MSF        @OZ05079*/ 02250000
         LA    @14,SSIDEQ-1(@15)                                   0691 02251000
         MVC   DRDMSFID(1),0(@14)                                  0691 02252000
*       RWFLD6=SSIDEQ(K);           /* PHYSICAL DRD          @OZ05079*/ 02253000
         LA    @01,SSIDEQ-1(@07)                                   0692 02254000
         MVC   RWFLD6(1),0(@01)                                    0692 02255000
*       IF L=2&EOFSW='1'B THEN                                     0693 02256000
         CLC   L(4),@CF00051                                       0693 02257000
         BNE   @RF00693                                            0693 02258000
         TM    EOFSW,B'10000000'                                   0693 02259000
         BNO   @RF00693                                            0693 02260000
*         DO;                       /*                       @Y30LB40*/ 02261000
*           RWFLD2='DISTR.';        /*                       @Y30LB40*/ 02262000
         MVC   RWFLD2(6),@CC00908                                  0695 02263000
*           RWFLD2A='SUMMARY ';     /*                       @Y30LB40*/ 02264000
         MVC   RWFLD2A(8),@CC00909                                 0696 02265000
*         END;                      /*                       @Y30LB40*/ 02266000
*       ELSE                                                       0698 02267000
*         DO;                       /*                       @Y30LB40*/ 02268000
         B     @RC00693                                            0698 02269000
@RF00693 DS    0H                                                  0699 02270000
*           RWFLD2='  /   ';        /*                       @Y30LB40*/ 02271000
         MVC   RWFLD2(6),@CC00910                                  0699 02272000
*           CALL EDITFIX(ADDR(TSSYR),1,'N');/*               @Y30LB40*/ 02273000
         MVC   @AL00001+4(8),@AL00700                              0700 02274000
         LA    @07,TSSYR                                           0700 02275000
         ST    @07,@AFTEMPS                                        0700 02276000
         LA    @07,@AFTEMPS                                        0700 02277000
         ST    @07,@AL00001                                        0700 02278000
         LA    @01,@AL00001                                        0700 02279000
         BAL   @14,EDITFIX                                         0700 02280000
*           RWFLD2(1:2)=FIXOUT(12:13);/*                     @Y30LB40*/ 02281000
         MVC   RWFLD2(2),FIXOUT+11                                 0701 02282000
*           CALL EDITFIX(ADDR(TSSDAY),2,'N');/*              @Y30LB40*/ 02283000
         MVC   @AL00001+4(8),@AL00702                              0702 02284000
         LA    @07,TSSDAY                                          0702 02285000
         ST    @07,@AFTEMPS                                        0702 02286000
         LA    @07,@AFTEMPS                                        0702 02287000
         ST    @07,@AL00001                                        0702 02288000
         LA    @01,@AL00001                                        0702 02289000
         BAL   @14,EDITFIX                                         0702 02290000
*           RWFLD2(4:6)=FIXOUT(11:13);/*                     @Y30LB40*/ 02291000
         MVC   RWFLD2+3(3),FIXOUT+10                               0703 02292000
*           HOUR=TSSTIME/3600;      /*                       @Y30LB40*/ 02293000
         L     @07,TSSTIME                                         0704 02294000
         LA    @15,3600                                            0704 02295000
         LR    @00,@07                                             0704 02296000
         SRDA  @00,32                                              0704 02297000
         DR    @00,@15                                             0704 02298000
         ST    @01,HOUR                                            0704 02299000
*           MINUTE=(TSSTIME-(HOUR*3600))/60;/*               @Y30LB40*/ 02300000
         LA    @14,60                                              0705 02301000
         MR    @00,@15                                             0705 02302000
         LR    @02,@07                                             0705 02303000
         SLR   @02,@01                                             0705 02304000
         SRDA  @02,32                                              0705 02305000
         DR    @02,@14                                             0705 02306000
         ST    @03,MINUTE                                          0705 02307000
*           SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));              0706 02308000
         MR    @02,@14                                             0706 02309000
         ALR   @01,@03                                             0706 02310000
         SLR   @07,@01                                             0706 02311000
         ST    @07,SECOND                                          0706 02312000
*           RWFLD2A='  :  :  ';     /*                       @Y30LB40*/ 02313000
         MVC   RWFLD2A(8),@CC00911                                 0707 02314000
*           CALL EDITFIX(ADDR(HOUR),4,'S');/*                @Y30LB40*/ 02315000
         MVC   @AL00001+4(8),@AL00708                              0708 02316000
         LA    @07,HOUR                                            0708 02317000
         ST    @07,@AFTEMPS                                        0708 02318000
         LA    @07,@AFTEMPS                                        0708 02319000
         ST    @07,@AL00001                                        0708 02320000
         LA    @01,@AL00001                                        0708 02321000
         BAL   @14,EDITFIX                                         0708 02322000
*           RWFLD2A(1:2)=FIXOUT(12:13);/*                    @Y30LB40*/ 02323000
         MVC   RWFLD2A(2),FIXOUT+11                                0709 02324000
*           CALL EDITFIX(ADDR(MINUTE),4,'N');/*              @Y30LB40*/ 02325000
         MVC   @AL00001+4(8),@AL00710                              0710 02326000
         LA    @07,MINUTE                                          0710 02327000
         ST    @07,@AFTEMPS                                        0710 02328000
         LA    @07,@AFTEMPS                                        0710 02329000
         ST    @07,@AL00001                                        0710 02330000
         LA    @01,@AL00001                                        0710 02331000
         BAL   @14,EDITFIX                                         0710 02332000
*           RWFLD2A(4:5)=FIXOUT(12:13);/*                    @Y30LB40*/ 02333000
         MVC   RWFLD2A+3(2),FIXOUT+11                              0711 02334000
*           CALL EDITFIX(ADDR(SECOND),4,'N');/*              @Y30LB40*/ 02335000
         MVC   @AL00001+4(8),@AL00712                              0712 02336000
         LA    @07,SECOND                                          0712 02337000
         ST    @07,@AFTEMPS                                        0712 02338000
         LA    @07,@AFTEMPS                                        0712 02339000
         ST    @07,@AL00001                                        0712 02340000
         LA    @01,@AL00001                                        0712 02341000
         BAL   @14,EDITFIX                                         0712 02342000
*           RWFLD2A(7:8)=FIXOUT(12:13);/*                    @Y30LB40*/ 02343000
         MVC   RWFLD2A+6(2),FIXOUT+11                              0713 02344000
*         END;                      /*                       @Y30LB40*/ 02345000
*       CALL CALCRWA(J,K,L,11);     /* GET ARRAY ADDRESS     @Y30LB40*/ 02346000
@RC00693 LA    @07,J                                               0715 02347000
         ST    @07,@AL00001                                        0715 02348000
         LA    @07,K                                               0715 02349000
         ST    @07,@AL00001+4                                      0715 02350000
         LA    @07,L                                               0715 02351000
         ST    @07,@AL00001+8                                      0715 02352000
         LA    @07,@CF00033                                        0715 02353000
         ST    @07,@AL00001+12                                     0715 02354000
         LA    @01,@AL00001                                        0715 02355000
         BAL   @14,CALCRWA                                         0715 02356000
*       IF RWB3+RWB5¬=0 THEN                                       0716 02357000
         L     @07,ARRAYPTR                                        0716 02358000
         L     @15,RWB3(,@07)                                      0716 02359000
         AL    @15,RWB5(,@07)                                      0716 02360000
         LTR   @15,@15                                             0716 02361000
         BZ    @RF00716                                            0716 02362000
*         DO M=1 TO 10;             /*                       @Y30LB40*/ 02363000
         LA    @07,1                                               0717 02364000
         ST    @07,M                                               0717 02365000
@DL00717 DS    0H                                                  0718 02366000
*           IF LINECNT>43 THEN                                     0718 02367000
         C     LINECNT,@CF00712                                    0718 02368000
         BNH   @RF00718                                            0718 02369000
*             DO;                   /* SKIP TO A NEW PAGE    @Y30LB40*/ 02370000
*               LINECNT=2;          /* RESET LINE COUNTER    @Y30LB40*/ 02371000
         LA    LINECNT,2                                           0720 02372000
*               PAGECNT=PAGECNT+1;  /* UP PAGE COUNTER       @Y30LB40*/ 02373000
         LA    @07,1                                               0721 02374000
         AL    @07,PAGECNT                                         0721 02375000
         ST    @07,PAGECNT                                         0721 02376000
*               HEADHOLD=HDNGA;     /*                       @Y30LB40*/ 02377000
         MVC   HEADHOLD(121),HDNGA                                 0722 02378000
*               CALL EDITFIX(ADDR(PAGECNT),4,'S');/*         @Y30LB40*/ 02379000
         MVC   @AL00001+4(8),@AL00723                              0723 02380000
         LA    @07,PAGECNT                                         0723 02381000
         ST    @07,@AFTEMPS                                        0723 02382000
         LA    @07,@AFTEMPS                                        0723 02383000
         ST    @07,@AL00001                                        0723 02384000
         LA    @01,@AL00001                                        0723 02385000
         BAL   @14,EDITFIX                                         0723 02386000
*               HEADHOLD(118:121)=FIXOUT(10:13);/*           @Y30LB40*/ 02387000
         MVC   HEADHOLD+117(4),FIXOUT+9                            0724 02388000
*               HEADHOLD(107:111)=TODAY;/*                   @Y30LB40*/ 02389000
         MVC   HEADHOLD+106(5),TODAY                               0725 02390000
*               RFY                                                0726 02391000
*                (R0,                                              0726 02392000
*                 R1,                                              0726 02393000
*                 R14,                                             0726 02394000
*                 R15) RSTD;        /*                       @Y30LB40*/ 02395000
*               GEN(PUT   PRNTDCB,HEADHOLD);/*               @Y30LB40*/ 02396000
         PUT   PRNTDCB,HEADHOLD                                         02397000
*               RFY                                                0728 02398000
*                (R0,                                              0728 02399000
*                 R1,                                              0728 02400000
*                 R14,                                             0728 02401000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 02402000
*             END;                  /*                       @Y30LB40*/ 02403000
*           IF M=1 THEN                                            0730 02404000
@RF00718 CLC   M(4),@CF00044                                       0730 02405000
         BNE   @RF00730                                            0730 02406000
*             DO;                   /* 1ST TIME THROUGH, PRINT     0731 02407000
*                                      HEADINGS                      */ 02408000
*               RFY                                                0732 02409000
*                (R0,                                              0732 02410000
*                 R1,                                              0732 02411000
*                 R14,                                             0732 02412000
*                 R15) RSTD;        /*                       @Y30LB40*/ 02413000
*               GEN(PUT   PRNTDCB,HDNGB);/*                  @Y30LB40*/ 02414000
         PUT   PRNTDCB,HDNGB                                            02415000
*               GEN(PUT   PRNTDCB,HDNGC);/*                  @Y30LB40*/ 02416000
         PUT   PRNTDCB,HDNGC                                            02417000
*               GEN(PUT   PRNTDCB,HDNGD);/*                  @Y30LB40*/ 02418000
         PUT   PRNTDCB,HDNGD                                            02419000
*               GEN(PUT   PRNTDCB,SPACE1);/*                 @Y30LB40*/ 02420000
         PUT   PRNTDCB,SPACE1                                           02421000
*               RFY                                                0737 02422000
*                (R0,                                              0737 02423000
*                 R1,                                              0737 02424000
*                 R14,                                             0737 02425000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 02426000
*               LINECNT=LINECNT+5;  /*                       @Y30LB40*/ 02427000
         AL    LINECNT,@CF00372                                    0738 02428000
*             END;                  /*                       @Y30LB40*/ 02429000
*           CALL SETLINE(M);        /* SET INTERVALS IN PRINT LINE   */ 02430000
@RF00730 LA    @07,M                                               0740 02431000
         ST    @07,@AL00001                                        0740 02432000
         LA    @01,@AL00001                                        0740 02433000
         BAL   @14,SETLINE                                         0740 02434000
*           CALL CALCRWA(J,K,L,M);  /* GET ARRAY ADDRESS     @Y30LB40*/ 02435000
         LA    @07,J                                               0741 02436000
         ST    @07,@AL00001                                        0741 02437000
         LA    @07,K                                               0741 02438000
         ST    @07,@AL00001+4                                      0741 02439000
         LA    @07,L                                               0741 02440000
         ST    @07,@AL00001+8                                      0741 02441000
         LA    @07,M                                               0741 02442000
         ST    @07,@AL00001+12                                     0741 02443000
         LA    @01,@AL00001                                        0741 02444000
         BAL   @14,CALCRWA                                         0741 02445000
*           CALL EDITFIX(ADDR(RWB2),4,'S');/*                @Y30LB40*/ 02446000
         MVC   @AL00001+4(8),@AL00742                              0742 02447000
         L     @07,ARRAYPTR                                        0742 02448000
         LA    @07,RWB2(,@07)                                      0742 02449000
         ST    @07,@AFTEMPS                                        0742 02450000
         LA    @07,@AFTEMPS                                        0742 02451000
         ST    @07,@AL00001                                        0742 02452000
         LA    @01,@AL00001                                        0742 02453000
         BAL   @14,EDITFIX                                         0742 02454000
*           RWFLD10=FIXOUT(9:13);   /* LOAD TIME             @Y30LB40*/ 02455000
         MVC   RWFLD10(5),FIXOUT+8                                 0743 02456000
*           CALL EDITFIX(ADDR(RWB7),4,'S');/*                @Y30LB40*/ 02457000
         MVC   @AL00001+4(8),@AL00744                              0744 02458000
         L     @07,ARRAYPTR                                        0744 02459000
         LA    @07,RWB7(,@07)                                      0744 02460000
         ST    @07,@AFTEMPS                                        0744 02461000
         LA    @07,@AFTEMPS                                        0744 02462000
         ST    @07,@AL00001                                        0744 02463000
         LA    @01,@AL00001                                        0744 02464000
         BAL   @14,EDITFIX                                         0744 02465000
*           RWFLD20=FIXOUT(7:13);   /* TOTAL STG RATE        @Y30LB40*/ 02466000
         MVC   RWFLD20(7),FIXOUT+6                                 0745 02467000
*           CALL EDITFIX(ADDR(RWB8),4,'S');/*                @Y30LB40*/ 02468000
         MVC   @AL00001+4(8),@AL00746                              0746 02469000
         L     @07,ARRAYPTR                                        0746 02470000
         LA    @07,RWB8(,@07)                                      0746 02471000
         ST    @07,@AFTEMPS                                        0746 02472000
         LA    @07,@AFTEMPS                                        0746 02473000
         ST    @07,@AL00001                                        0746 02474000
         LA    @01,@AL00001                                        0746 02475000
         BAL   @14,EDITFIX                                         0746 02476000
*           RWFLD22=FIXOUT(7:13);   /* TOTAL DSTG RATE       @Y30LB40*/ 02477000
         MVC   RWFLD22(7),FIXOUT+6                                 0747 02478000
*           CALL EDITFIX(ADDR(RWB9),4,'S');/*                @Y30LB40*/ 02479000
         MVC   @AL00001+4(8),@AL00748                              0748 02480000
         L     @07,ARRAYPTR                                        0748 02481000
         LA    @07,RWB9(,@07)                                      0748 02482000
         ST    @07,@AFTEMPS                                        0748 02483000
         LA    @07,@AFTEMPS                                        0748 02484000
         ST    @07,@AL00001                                        0748 02485000
         LA    @01,@AL00001                                        0748 02486000
         BAL   @14,EDITFIX                                         0748 02487000
*           RWFLD24=FIXOUT(8:13);   /* RWU BUSY TIME         @Y30LB40*/ 02488000
         MVC   RWFLD24(6),FIXOUT+7                                 0749 02489000
*           RFY                                                    0750 02490000
*            (R0,                                                  0750 02491000
*             R1,                                                  0750 02492000
*             R14,                                                 0750 02493000
*             R15) RSTD;            /*                       @Y30LB40*/ 02494000
*           GEN(PUT   PRNTDCB,RWLINE);/* PRINT CLASS LINE    @Y30LB40*/ 02495000
         PUT   PRNTDCB,RWLINE                                           02496000
*           RFY                                                    0752 02497000
*            (R0,                                                  0752 02498000
*             R1,                                                  0752 02499000
*             R14,                                                 0752 02500000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 02501000
*           LINECNT=LINECNT+1;      /* BUMP LINE COUNT       @Y30LB40*/ 02502000
         AL    LINECNT,@CF00044                                    0753 02503000
*           RWFLD2=' ';             /* CLEAR CONSTANT INFO   @Y30LB40*/ 02504000
         MVI   RWFLD2+1,C' '                                       0754 02505000
         MVC   RWFLD2+2(4),RWFLD2+1                                0754 02506000
         MVI   RWFLD2,C' '                                         0754 02507000
*           RWFLD2A=' ';            /*                       @Y30LB40*/ 02508000
         MVI   RWFLD2A+1,C' '                                      0755 02509000
         MVC   RWFLD2A+2(6),RWFLD2A+1                              0755 02510000
         MVI   RWFLD2A,C' '                                        0755 02511000
*           RWFLD4=' ';             /*                       @Y30LB40*/ 02512000
         MVI   RWFLD4,C' '                                         0756 02513000
*           DRDSSID='   ';          /*                       @OZ05079*/ 02514000
         MVC   DRDSSID(3),@CC00926                                 0757 02515000
*           RWB2=0;                 /* CLEAR BUCKETS         @Y30LB40*/ 02516000
         SLR   @07,@07                                             0758 02517000
         L     @15,ARRAYPTR                                        0758 02518000
         ST    @07,RWB2(,@15)                                      0758 02519000
*           RWB7=0;                 /* CLEAR BUCKETS         @Y30LB40*/ 02520000
         ST    @07,RWB7(,@15)                                      0759 02521000
*           RWB8=0;                 /* CLEAR BUCKETS         @Y30LB40*/ 02522000
         ST    @07,RWB8(,@15)                                      0760 02523000
*           RWB9=0;                 /* CLEAR BUCKETS         @Y30LB40*/ 02524000
         ST    @07,RWB9(,@15)                                      0761 02525000
*           IF M=10 THEN                                           0762 02526000
         CLC   M(4),@CF00034                                       0762 02527000
         BNE   @RF00762                                            0762 02528000
*             DO;                   /* LAST TIME THROUGH THE LOOP    */ 02529000
*               RFY                                                0764 02530000
*                (R0,                                              0764 02531000
*                 R1,                                              0764 02532000
*                 R14,                                             0764 02533000
*                 R15) RSTD;        /*                       @Y30LB40*/ 02534000
*               GEN(PUT   PRNTDCB,HDNGE);/* PRINT TIME SLICE TOTALS  */ 02535000
         PUT   PRNTDCB,HDNGE                                            02536000
*               GEN(PUT   PRNTDCB,HDNGF);/*                  @Y30LB40*/ 02537000
         PUT   PRNTDCB,HDNGF                                            02538000
*               GEN(PUT   PRNTDCB,SPACE1);/*                 @Y30LB40*/ 02539000
         PUT   PRNTDCB,SPACE1                                           02540000
*               RFY                                                0768 02541000
*                (R0,                                              0768 02542000
*                 R1,                                              0768 02543000
*                 R14,                                             0768 02544000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 02545000
*               LINECNT=LINECNT+4;  /* ADD 4 TO LINE COUNTER         */ 02546000
         AL    LINECNT,@CF00104                                    0769 02547000
*               RWTLINE=' ';        /*                       @Y30LB40*/ 02548000
         MVI   RWTLINE+1,C' '                                      0770 02549000
         MVC   RWTLINE+2(119),RWTLINE+1                            0770 02550000
         MVI   RWTLINE,C' '                                        0770 02551000
*               CALL CALCRWA(J,K,L,11);/* GET ARRAY ADDRESS          */ 02552000
         LA    @07,J                                               0771 02553000
         ST    @07,@AL00001                                        0771 02554000
         LA    @07,K                                               0771 02555000
         ST    @07,@AL00001+4                                      0771 02556000
         LA    @07,L                                               0771 02557000
         ST    @07,@AL00001+8                                      0771 02558000
         LA    @07,@CF00033                                        0771 02559000
         ST    @07,@AL00001+12                                     0771 02560000
         LA    @01,@AL00001                                        0771 02561000
         BAL   @14,CALCRWA                                         0771 02562000
*               CALL EDITFIX(ADDR(RWB1),4,'S');/*            @Y30LB40*/ 02563000
         MVC   @AL00001+4(8),@AL00772                              0772 02564000
         LA    @07,ARRAYPTR                                        0772 02565000
         ST    @07,@AL00001                                        0772 02566000
         LA    @01,@AL00001                                        0772 02567000
         BAL   @14,EDITFIX                                         0772 02568000
*               RWTFLD2=FIXOUT(8:13);/* TOTAL CARTRIDGES             */ 02569000
         MVC   RWTFLD2(6),FIXOUT+7                                 0773 02570000
*               CALCFLD=RWB2/4;     /*                       @Y30LB40*/ 02571000
         L     @07,ARRAYPTR                                        0774 02572000
         L     @00,RWB2(,@07)                                      0774 02573000
         SRDA  @00,32                                              0774 02574000
         D     @00,@CF00104                                        0774 02575000
         ST    @01,CALCFLD                                         0774 02576000
*               CALL EDITFIX(ADDR(CALCFLD),4,'S');/*         @Y30LB40*/ 02577000
         MVC   @AL00001+4(8),@AL00775                              0775 02578000
         LA    @07,CALCFLD                                         0775 02579000
         ST    @07,@AFTEMPS                                        0775 02580000
         LA    @07,@AFTEMPS                                        0775 02581000
         ST    @07,@AL00001                                        0775 02582000
         LA    @01,@AL00001                                        0775 02583000
         BAL   @14,EDITFIX                                         0775 02584000
*               RWTFLD4=FIXOUT(8:13);/* LOAD TIME            @Y30LB40*/ 02585000
         MVC   RWTFLD4(6),FIXOUT+7                                 0776 02586000
*               CALL EDITFIX(ADDR(RWB3),4,'S');/*            @Y30LB40*/ 02587000
         MVC   @AL00001+4(8),@AL00777                              0777 02588000
         L     @07,ARRAYPTR                                        0777 02589000
         LA    @07,RWB3(,@07)                                      0777 02590000
         ST    @07,@AFTEMPS                                        0777 02591000
         LA    @07,@AFTEMPS                                        0777 02592000
         ST    @07,@AL00001                                        0777 02593000
         LA    @01,@AL00001                                        0777 02594000
         BAL   @14,EDITFIX                                         0777 02595000
*               RWTFLD6=FIXOUT(7:13);/* TOT CYLS STG         @Y30LB40*/ 02596000
         MVC   RWTFLD6(7),FIXOUT+6                                 0778 02597000
*               CALCFLD=RWB4/4;     /*                       @Y30LB40*/ 02598000
         L     @07,ARRAYPTR                                        0779 02599000
         L     @00,RWB4(,@07)                                      0779 02600000
         SRDA  @00,32                                              0779 02601000
         D     @00,@CF00104                                        0779 02602000
         ST    @01,CALCFLD                                         0779 02603000
*               CALL EDITFIX(ADDR(CALCFLD),4,'S');/*         @Y30LB40*/ 02604000
         MVC   @AL00001+4(8),@AL00780                              0780 02605000
         LA    @07,CALCFLD                                         0780 02606000
         ST    @07,@AFTEMPS                                        0780 02607000
         LA    @07,@AFTEMPS                                        0780 02608000
         ST    @07,@AL00001                                        0780 02609000
         LA    @01,@AL00001                                        0780 02610000
         BAL   @14,EDITFIX                                         0780 02611000
*               RWTFLD8=FIXOUT(8:13);/* TOT DEV STG TIME             */ 02612000
         MVC   RWTFLD8(6),FIXOUT+7                                 0781 02613000
*               CALL EDITFIX(ADDR(RWB5),4,'S');/*            @Y30LB40*/ 02614000
         MVC   @AL00001+4(8),@AL00782                              0782 02615000
         L     @07,ARRAYPTR                                        0782 02616000
         LA    @07,RWB5(,@07)                                      0782 02617000
         ST    @07,@AFTEMPS                                        0782 02618000
         LA    @07,@AFTEMPS                                        0782 02619000
         ST    @07,@AL00001                                        0782 02620000
         LA    @01,@AL00001                                        0782 02621000
         BAL   @14,EDITFIX                                         0782 02622000
*               RWTFLD10=FIXOUT(7:13);/* TOT CYLS DSTG       @Y30LB40*/ 02623000
         MVC   RWTFLD10(7),FIXOUT+6                                0783 02624000
*               CALCFLD=RWB6/4;     /*                       @Y30LB40*/ 02625000
         L     @07,ARRAYPTR                                        0784 02626000
         L     @00,RWB6(,@07)                                      0784 02627000
         SRDA  @00,32                                              0784 02628000
         D     @00,@CF00104                                        0784 02629000
         ST    @01,CALCFLD                                         0784 02630000
*               CALL EDITFIX(ADDR(CALCFLD),4,'S');/*         @Y30LB40*/ 02631000
         MVC   @AL00001+4(8),@AL00785                              0785 02632000
         LA    @07,CALCFLD                                         0785 02633000
         ST    @07,@AFTEMPS                                        0785 02634000
         LA    @07,@AFTEMPS                                        0785 02635000
         ST    @07,@AL00001                                        0785 02636000
         LA    @01,@AL00001                                        0785 02637000
         BAL   @14,EDITFIX                                         0785 02638000
*               RWTFLD12=FIXOUT(8:13);/* TOT DEV DSTG TIME           */ 02639000
         MVC   RWTFLD12(6),FIXOUT+7                                0786 02640000
*               IF RWB1=0 THEN                                     0787 02641000
         L     @07,ARRAYPTR                                        0787 02642000
         L     @15,RWB1(,@07)                                      0787 02643000
         LTR   @15,@15                                             0787 02644000
         BNZ   @RF00787                                            0787 02645000
*                 RWB1=1;           /*                       @Y30LB40*/ 02646000
         MVC   RWB1(4,@07),@CF00044                                0788 02647000
*               CALCFLD=((RWB2/4)/RWB1);/*                   @Y30LB40*/ 02648000
@RF00787 L     @07,ARRAYPTR                                        0789 02649000
         L     @00,RWB2(,@07)                                      0789 02650000
         SRDA  @00,32                                              0789 02651000
         D     @00,@CF00104                                        0789 02652000
         LR    @02,@01                                             0789 02653000
         SRDA  @02,32                                              0789 02654000
         D     @02,RWB1(,@07)                                      0789 02655000
         ST    @03,CALCFLD                                         0789 02656000
*               CALL EDITFIX(ADDR(CALCFLD),4,'S');/*         @Y30LB40*/ 02657000
         MVC   @AL00001+4(8),@AL00790                              0790 02658000
         LA    @07,CALCFLD                                         0790 02659000
         ST    @07,@AFTEMPS                                        0790 02660000
         LA    @07,@AFTEMPS                                        0790 02661000
         ST    @07,@AL00001                                        0790 02662000
         LA    @01,@AL00001                                        0790 02663000
         BAL   @14,EDITFIX                                         0790 02664000
*               RWTFLD14=FIXOUT(8:13);/* CARTRIDGE RATE      @Y30LB40*/ 02665000
         MVC   RWTFLD14(6),FIXOUT+7                                0791 02666000
*               RFY                                                0792 02667000
*                (R0,                                              0792 02668000
*                 R1,                                              0792 02669000
*                 R14,                                             0792 02670000
*                 R15) RSTD;        /*                       @Y30LB40*/ 02671000
*               GEN(PUT   PRNTDCB,RWTLINE);/* PRINT TOTAL LINE       */ 02672000
         PUT   PRNTDCB,RWTLINE                                          02673000
*               GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE     @Y30LB40*/ 02674000
         PUT   PRNTDCB,SPACE1                                           02675000
*               RFY                                                0795 02676000
*                (R0,                                              0795 02677000
*                 R1,                                              0795 02678000
*                 R14,                                             0795 02679000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 02680000
*               LINECNT=LINECNT+2;  /* BUMP LINE COUNT               */ 02681000
         AL    LINECNT,@CF00051                                    0796 02682000
*               RWB1=0;             /* CLEAR BUCKETS         @Y30LB40*/ 02683000
         SLR   @07,@07                                             0797 02684000
         L     @15,ARRAYPTR                                        0797 02685000
         ST    @07,RWB1(,@15)                                      0797 02686000
*               RWB2=0;             /* CLEAR BUCKETS         @Y30LB40*/ 02687000
         ST    @07,RWB2(,@15)                                      0798 02688000
*               RWB3=0;             /* CLEAR BUCKETS         @Y30LB40*/ 02689000
         ST    @07,RWB3(,@15)                                      0799 02690000
*               RWB4=0;             /* CLEAR BUCKETS         @Y30LB40*/ 02691000
         ST    @07,RWB4(,@15)                                      0800 02692000
*               RWB5=0;             /* CLEAR BUCKETS         @Y30LB40*/ 02693000
         ST    @07,RWB5(,@15)                                      0801 02694000
*               RWB6=0;             /* CLEAR BUCKETS         @Y30LB40*/ 02695000
         ST    @07,RWB6(,@15)                                      0802 02696000
*             END;                  /*                       @Y30LB40*/ 02697000
*         END;                      /*                       @Y30LB40*/ 02698000
@RF00762 LA    @07,1                                               0804 02699000
         AL    @07,M                                               0804 02700000
         ST    @07,M                                               0804 02701000
         C     @07,@CF00034                                        0804 02702000
         BNH   @DL00717                                            0804 02703000
*     END;                          /*                       @Y30LB40*/ 02704000
@RF00716 LA    @07,1                                               0805 02705000
         AL    @07,K                                               0805 02706000
         ST    @07,K                                               0805 02707000
         C     @07,@CF00069                                        0805 02708000
         BNH   @DL00687                                            0805 02709000
*   END;                            /*                       @Y30LB40*/ 02710000
         LA    @07,1                                               0806 02711000
         AL    @07,J                                               0806 02712000
         ST    @07,J                                               0806 02713000
         C     @07,@CF00051                                        0806 02714000
         BNH   @DL00686                                            0806 02715000
*   IF EOFSW='1'B THEN                                             0807 02716000
         TM    EOFSW,B'10000000'                                   0807 02717000
         BNO   @RF00807                                            0807 02718000
*     DO;                           /* END OF JOB YET        @Y30LB40*/ 02719000
*       IF L=2 THEN                                                0809 02720000
         LA    @07,2                                               0809 02721000
         C     @07,L                                               0809 02722000
         BE    @RT00809                                            0809 02723000
*         GO TO EOJ;                /* IF REPORT TOTALS            0810 02724000
*                                      WRITTEN,GETOUT                */ 02725000
*       ELSE                                                       0811 02726000
*         L=2;                      /* SETUP FOR REPORT TOTALS     0811 02727000
*                                                            @Y30LB40*/ 02728000
         ST    @07,L                                               0811 02729000
*       LINECNT=56;                 /* FORCE NEW PAGE        @Y30LB40*/ 02730000
         LA    LINECNT,56                                          0812 02731000
*       GO TO PROCRWBK;             /* GO WRITE TOTALS       @Y30LB40*/ 02732000
         B     PROCRWBK                                            0813 02733000
*     END;                          /*                       @Y30LB40*/ 02734000
*   CALL GETSLICE;                  /* SETUP NEW TIME SLICE INTERVAL    02735000
*                                                            @OZ11673*/ 02736000
@RF00807 BAL   @14,GETSLICE                                        0815 02737000
*   GO TO ROUTINE2;                 /*                       @Y30LB40*/ 02738000
         B     ROUTINE2                                            0816 02739000
*/********************************************************************/ 02740000
*                                                                  0817 02741000
*                                                                  0817 02742000
*/********************************************************************/ 02743000
*                                                                  0817 02744000
*EOF:                               /* END OF FILE REACHED   @Y30LB40*/ 02745000
*   EOFSW='1'B;                     /* INDICATE END OF FILE  @Y30LB40*/ 02746000
EOF      OI    EOFSW,B'10000000'                                   0817 02747000
*   IF PARMSW='D' THEN                                             0818 02748000
         CLI   PARMSW,C'D'                                         0818 02749000
         BE    @RT00818                                            0818 02750000
*     GO TO DSCTLBRK;               /* GO FORCE SDG TOTALS   @ZA16140*/ 02751000
*   ELSE                                                           0820 02752000
*     GO TO RWCTLBRK;               /* GO FORCE RW TOTALS    @Y30LB40*/ 02753000
         B     RWCTLBRK                                            0820 02754000
*                                                                  0821 02755000
*/********************************************************************/ 02756000
*/* END OF JOB, CLOSE FILES, PROCESSING COMPLETE.            @Y30LB40*/ 02757000
*/********************************************************************/ 02758000
*                                                                  0821 02759000
*EOJ:                               /* REPORTS COMPLETE PRINT PARMS     02760000
*                                      VALUES LINE           @Y30LB40*/ 02761000
*   DSLINE=RCDTOTAL;                /*                       @Y30LB40*/ 02762000
EOJ      MVC   DSLINE(121),RCDTOTAL                                0821 02763000
*   DSLINE(16:16)=PARMSW;           /*                       @Y30LB40*/ 02764000
         MVC   DSLINE+15(1),PARMSW                                 0822 02765000
*   TIMESL=TIMESL/60;               /*                       @Y30LB40*/ 02766000
         L     @00,TIMESL                                          0823 02767000
         SRDA  @00,32                                              0823 02768000
         D     @00,@CF00335                                        0823 02769000
         ST    @01,TIMESL                                          0823 02770000
*   CALL EDITFIX(ADDR(TIMESL),4,'S');/*                      @Y30LB40*/ 02771000
         MVC   @AL00001+4(8),@AL00824                              0824 02772000
         LA    @07,TIMESL                                          0824 02773000
         ST    @07,@AFTEMPS                                        0824 02774000
         LA    @07,@AFTEMPS                                        0824 02775000
         ST    @07,@AL00001                                        0824 02776000
         LA    @01,@AL00001                                        0824 02777000
         BAL   @14,EDITFIX                                         0824 02778000
*   DSLINE(29:31)=FIXOUT(11:13);    /*                       @Y30LB40*/ 02779000
         MVC   DSLINE+28(3),FIXOUT+10                              0825 02780000
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/ 02781000
         MVC   @AL00001+4(8),@AL00826                              0826 02782000
         LA    @07,HLDSYR                                          0826 02783000
         ST    @07,@AFTEMPS                                        0826 02784000
         LA    @07,@AFTEMPS                                        0826 02785000
         ST    @07,@AL00001                                        0826 02786000
         LA    @01,@AL00001                                        0826 02787000
         BAL   @14,EDITFIX                                         0826 02788000
*   DSLINE(42:43)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02789000
         MVC   DSLINE+41(2),FIXOUT+11                              0827 02790000
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/ 02791000
         MVC   @AL00001+4(8),@AL00828                              0828 02792000
         LA    @07,HLDSDAY                                         0828 02793000
         ST    @07,@AFTEMPS                                        0828 02794000
         LA    @07,@AFTEMPS                                        0828 02795000
         ST    @07,@AL00001                                        0828 02796000
         LA    @01,@AL00001                                        0828 02797000
         BAL   @14,EDITFIX                                         0828 02798000
*   DSLINE(44:46)=FIXOUT(11:13);    /*                       @Y30LB40*/ 02799000
         MVC   DSLINE+43(3),FIXOUT+10                              0829 02800000
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/ 02801000
         MVC   @AL00001+4(8),@AL00830                              0830 02802000
         LA    @07,HLDEYR                                          0830 02803000
         ST    @07,@AFTEMPS                                        0830 02804000
         LA    @07,@AFTEMPS                                        0830 02805000
         ST    @07,@AL00001                                        0830 02806000
         LA    @01,@AL00001                                        0830 02807000
         BAL   @14,EDITFIX                                         0830 02808000
*   DSLINE(48:49)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02809000
         MVC   DSLINE+47(2),FIXOUT+11                              0831 02810000
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/ 02811000
         MVC   @AL00001+4(8),@AL00832                              0832 02812000
         LA    @07,HLDEDAY                                         0832 02813000
         ST    @07,@AFTEMPS                                        0832 02814000
         LA    @07,@AFTEMPS                                        0832 02815000
         ST    @07,@AL00001                                        0832 02816000
         LA    @01,@AL00001                                        0832 02817000
         BAL   @14,EDITFIX                                         0832 02818000
*   DSLINE(50:52)=FIXOUT(11:13);    /*                       @Y30LB40*/ 02819000
         MVC   DSLINE+49(3),FIXOUT+10                              0833 02820000
*   HOUR=HLDSTIME/3600;             /*                       @Y30LB40*/ 02821000
         L     @07,HLDSTIME                                        0834 02822000
         LA    @15,3600                                            0834 02823000
         LR    @00,@07                                             0834 02824000
         SRDA  @00,32                                              0834 02825000
         DR    @00,@15                                             0834 02826000
         ST    @01,HOUR                                            0834 02827000
*   MINUTE=(HLDSTIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 02828000
         MR    @00,@15                                             0835 02829000
         LR    @02,@07                                             0835 02830000
         SLR   @02,@01                                             0835 02831000
         SRDA  @02,32                                              0835 02832000
         D     @02,@CF00335                                        0835 02833000
         ST    @03,MINUTE                                          0835 02834000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 02835000
         MVC   @AL00001+4(8),@AL00836                              0836 02836000
         LA    @07,HOUR                                            0836 02837000
         ST    @07,@AFTEMPS                                        0836 02838000
         LA    @07,@AFTEMPS                                        0836 02839000
         ST    @07,@AL00001                                        0836 02840000
         LA    @01,@AL00001                                        0836 02841000
         BAL   @14,EDITFIX                                         0836 02842000
*   DSLINE(63:64)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02843000
         MVC   DSLINE+62(2),FIXOUT+11                              0837 02844000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 02845000
         MVC   @AL00001+4(8),@AL00838                              0838 02846000
         LA    @07,MINUTE                                          0838 02847000
         ST    @07,@AFTEMPS                                        0838 02848000
         LA    @07,@AFTEMPS                                        0838 02849000
         ST    @07,@AL00001                                        0838 02850000
         LA    @01,@AL00001                                        0838 02851000
         BAL   @14,EDITFIX                                         0838 02852000
*   DSLINE(65:66)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02853000
         MVC   DSLINE+64(2),FIXOUT+11                              0839 02854000
*   HOUR=HLDETIME/3600;             /*                       @Y30LB40*/ 02855000
         L     @07,HLDETIME                                        0840 02856000
         LA    @15,3600                                            0840 02857000
         LR    @00,@07                                             0840 02858000
         SRDA  @00,32                                              0840 02859000
         DR    @00,@15                                             0840 02860000
         ST    @01,HOUR                                            0840 02861000
*   MINUTE=(HLDETIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 02862000
         MR    @00,@15                                             0841 02863000
         LR    @02,@07                                             0841 02864000
         SLR   @02,@01                                             0841 02865000
         SRDA  @02,32                                              0841 02866000
         D     @02,@CF00335                                        0841 02867000
         ST    @03,MINUTE                                          0841 02868000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 02869000
         MVC   @AL00001+4(8),@AL00842                              0842 02870000
         LA    @07,HOUR                                            0842 02871000
         ST    @07,@AFTEMPS                                        0842 02872000
         LA    @07,@AFTEMPS                                        0842 02873000
         ST    @07,@AL00001                                        0842 02874000
         LA    @01,@AL00001                                        0842 02875000
         BAL   @14,EDITFIX                                         0842 02876000
*   DSLINE(68:69)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02877000
         MVC   DSLINE+67(2),FIXOUT+11                              0843 02878000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 02879000
         MVC   @AL00001+4(8),@AL00844                              0844 02880000
         LA    @07,MINUTE                                          0844 02881000
         ST    @07,@AFTEMPS                                        0844 02882000
         LA    @07,@AFTEMPS                                        0844 02883000
         ST    @07,@AL00001                                        0844 02884000
         LA    @01,@AL00001                                        0844 02885000
         BAL   @14,EDITFIX                                         0844 02886000
*   DSLINE(70:71)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02887000
         MVC   DSLINE+69(2),FIXOUT+11                              0845 02888000
*   IF SELECTSW='1'B THEN                                          0846 02889000
         TM    SELECTSW,B'10000000'                                0846 02890000
         BNO   @RF00846                                            0846 02891000
*     IF PARMSW='D' THEN                                           0847 02892000
         CLI   PARMSW,C'D'                                         0847 02893000
         BNE   @RF00847                                            0847 02894000
*       DO;                         /*                       @Y30LB40*/ 02895000
*         DSLINE(73:80)='SDGXX   '; /*                       @ZA16140*/ 02896000
         MVC   DSLINE+72(8),@CC00943                               0849 02897000
*         CALL EDITFIX(ADDR(SELSDG),1,'N');/*                @ZA16140*/ 02898000
         MVC   @AL00001+4(8),@AL00850                              0850 02899000
         LA    @07,SELSDG                                          0850 02900000
         ST    @07,@AFTEMPS                                        0850 02901000
         LA    @07,@AFTEMPS                                        0850 02902000
         ST    @07,@AL00001                                        0850 02903000
         LA    @01,@AL00001                                        0850 02904000
         BAL   @14,EDITFIX                                         0850 02905000
*         DSLINE(76:77)=FIXOUT(12:13);/*                     @ZA16140*/ 02906000
         MVC   DSLINE+75(2),FIXOUT+11                              0851 02907000
*       END;                        /*                       @Y30LB40*/ 02908000
*     ELSE                                                         0853 02909000
*       DO;                         /*                       @Y30LB40*/ 02910000
         B     @RC00847                                            0853 02911000
@RF00847 DS    0H                                                  0854 02912000
*         DSLINE(78:78)='2';        /*                       @OZ05079*/ 02913000
         MVI   DSLINE+77,C'2'                                      0854 02914000
*         DSLINE(79:79)=SSIDEQ(LIB+1);/*                     @OZ05079*/ 02915000
         SLR   @07,@07                                             0855 02916000
         IC    @07,LIB                                             0855 02917000
         LA    @01,SSIDEQ(@07)                                     0855 02918000
         MVC   DSLINE+78(1),0(@01)                                 0855 02919000
*         DSLINE(80:80)=SSIDEQ(U+1);/*                       @OZ05079*/ 02920000
         SLR   @07,@07                                             0856 02921000
         IC    @07,U                                               0856 02922000
         LA    @01,SSIDEQ(@07)                                     0856 02923000
         MVC   DSLINE+79(1),0(@01)                                 0856 02924000
*       END;                        /*                       @Y30LB40*/ 02925000
*   ELSE                                                           0858 02926000
*     DSLINE(73:80)='        ';     /*                       @OZ05079*/ 02927000
         B     @RC00846                                            0858 02928000
@RF00846 MVC   DSLINE+72(8),@CC00948                               0858 02929000
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/ 02930000
@RC00846 MVC   @AL00001+4(8),@AL00859                              0859 02931000
         LA    @07,RCDCOUNT                                        0859 02932000
         ST    @07,@AFTEMPS                                        0859 02933000
         LA    @07,@AFTEMPS                                        0859 02934000
         ST    @07,@AL00001                                        0859 02935000
         LA    @01,@AL00001                                        0859 02936000
         BAL   @14,EDITFIX                                         0859 02937000
*   DSLINE(108:113)=FIXOUT(8:13);   /*                       @Y30LB40*/ 02938000
         MVC   DSLINE+107(6),FIXOUT+7                              0860 02939000
*   RFY                                                            0861 02940000
*    (R0,                                                          0861 02941000
*     R1,                                                          0861 02942000
*     R14,                                                         0861 02943000
*     R15) RSTD;                    /*                       @Y30LB40*/ 02944000
*   GEN(PUT   PRNTDCB,DSLINE);      /*                       @Y30LB40*/ 02945000
         PUT   PRNTDCB,DSLINE                                           02946000
*   RFY                                                            0863 02947000
*    (R0,                                                          0863 02948000
*     R1,                                                          0863 02949000
*     R14,                                                         0863 02950000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 02951000
*CLOSEFIL:                                                         0864 02952000
*   RFY                                                            0864 02953000
*    (R0,                                                          0864 02954000
*     R1,                                                          0864 02955000
*     R14,                                                         0864 02956000
*     R15) RSTD;                    /*                       @Y30LB40*/ 02957000
CLOSEFIL DS    0H                                                  0865 02958000
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/ 02959000
         CLOSE INDCB,MF=(E,OPENCLOS)                                    02960000
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/ 02961000
         CLOSE PRNTDCB,MF=(E,OPENCLOS)                                  02962000
*   RFY                                                            0867 02963000
*    (R0,                                                          0867 02964000
*     R1,                                                          0867 02965000
*     R14,                                                         0867 02966000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 02967000
*   RFY                                                            0868 02968000
*    (R0,                                                          0868 02969000
*     R1) RSTD;                     /*                       @Y30LB40*/ 02970000
*   R0=LENGTH(DSARRAY);             /*                       @ZA16140*/ 02971000
         L     R0,@CF00997                                         0869 02972000
*   R1=ARRAYLOC;                    /*                       @Y30LB40*/ 02973000
         LR    R1,ARRAYLOC                                         0870 02974000
*   GEN(FREEMAIN R,LV=(0),A=(1));   /* FREEMAIN ARRAYS       @Y30LB40*/ 02975000
         FREEMAIN R,LV=(0),A=(1)                                        02976000
*   RFY                                                            0872 02977000
*    (R0,                                                          0872 02978000
*     R1) UNRSTD;                   /*                       @Y30LB40*/ 02979000
*   RETURN CODE(RETURNCD);          /* TERMINATE WITH RETURN CODE  0873 02980000
*                                                            @Y30LB40*/ 02981000
         LH    @07,RETURNCD                                        0873 02982000
         L     @13,4(,@13)                                         0873 02983000
         L     @00,@SIZDATD                                        0873 02984000
         LR    @01,@09                                             0873 02985000
         FREEMAIN R,LV=(0),A=(1)                                        02986000
         LR    @15,@07                                             0873 02987000
         L     @14,12(,@13)                                        0873 02988000
         LM    @00,@12,20(@13)                                     0873 02989000
         BR    @14                                                 0873 02990000
*                                                                  0874 02991000
*/********************************************************** @OZ11673*/ 02992000
*/*                                                          @OZ11673*/ 02993000
*/* PROCEDURE NAME - GETSLICE                                @OZ11673*/ 02994000
*/*                                                          @OZ11673*/ 02995000
*/* FUNCTION - BUMP THE TIMESLICE COMPARE VALUE UNTIL THE    @OZ11673*/ 02996000
*/*            CURRENT TIME IN THE DETAIL RECORD FALLS       @OZ11673*/ 02997000
*/*            WITHIN THE TIMESLICE RANGE.                   @OZ11673*/ 02998000
*/*                                                          @OZ11673*/ 02999000
*/********************************************************** @OZ11673*/ 03000000
*                                                                  0874 03001000
*GETSLICE:                                                         0874 03002000
*   PROCEDURE;                      /*                       @OZ11673*/ 03003000
GETSLICE STM   @14,@12,12(@13)                                     0874 03004000
*   DO WHILE(CKTIME>TSEND);         /* SETUP NEXT TIME SLICE INTERVAL*/ 03005000
         B     @DE00875                                            0875 03006000
@DL00875 DS    0H                                                  0876 03007000
*     TSBEG=TSEND;                  /*                       @Y30LB40*/ 03008000
         MVC   TSBEG(7),TSEND                                      0876 03009000
*     TSETIME=TSETIME+TIMESL;       /*                       @Y30LB40*/ 03010000
         L     @07,TSETIME                                         0877 03011000
         AL    @07,TIMESL                                          0877 03012000
         ST    @07,TSETIME                                         0877 03013000
*     IF TSETIME>86399 THEN                                        0878 03014000
         C     @07,@CF00871                                        0878 03015000
         BNH   @RF00878                                            0878 03016000
*       DO;                         /*                       @Y30LB40*/ 03017000
*         TSETIME=TSETIME-86400;    /*                       @Y30LB40*/ 03018000
         SL    @07,@CF00955                                        0880 03019000
         ST    @07,TSETIME                                         0880 03020000
*         TSEDAY=TSEDAY+1;          /*                       @Y30LB40*/ 03021000
         LA    @07,1                                               0881 03022000
         LH    @15,TSEDAY                                          0881 03023000
         ALR   @15,@07                                             0881 03024000
         STH   @15,TSEDAY                                          0881 03025000
*         IF TSEDAY>365 THEN                                       0882 03026000
         C     @15,@CF00870                                        0882 03027000
         BNH   @RF00882                                            0882 03028000
*           DO;                     /*                       @Y30LB40*/ 03029000
*             IF(TSEND(1:1)&'00000011'B)='00000000'B THEN          0884 03030000
         MVC   @TS00001(1),TSEND                                   0884 03031000
         NI    @TS00001,B'00000011'                                0884 03032000
         CLI   @TS00001,B'00000000'                                0884 03033000
         BNE   @RF00884                                            0884 03034000
*               IF TSEDAY>366 THEN                                 0885 03035000
         LA    @14,366                                             0885 03036000
         CR    @15,@14                                             0885 03037000
         BNH   @RF00885                                            0885 03038000
*                 DO;               /*                       @Y30LB40*/ 03039000
*                   TSEDAY=TSEDAY-366;/*                     @Y30LB40*/ 03040000
         SLR   @15,@14                                             0887 03041000
         STH   @15,TSEDAY                                          0887 03042000
*                   TSEYR=TSEYR+1;  /*                       @Y30LB40*/ 03043000
         SLR   @15,@15                                             0888 03044000
         IC    @15,TSEYR                                           0888 03045000
         ALR   @07,@15                                             0888 03046000
         STC   @07,TSEYR                                           0888 03047000
*                 END;              /*                       @Y30LB40*/ 03048000
*               ELSE                                               0890 03049000
*                 ;                 /*                       @Y30LB40*/ 03050000
@RF00885 DS    0H                                                  0891 03051000
*             ELSE                                                 0891 03052000
*               DO;                 /*                       @Y30LB40*/ 03053000
         B     @RC00884                                            0891 03054000
@RF00884 DS    0H                                                  0892 03055000
*                 TSEDAY=TSEDAY-365;/*                       @Y30LB40*/ 03056000
         LH    @07,TSEDAY                                          0892 03057000
         SL    @07,@CF00870                                        0892 03058000
         STH   @07,TSEDAY                                          0892 03059000
*                 TSEYR=TSEYR+1;    /*                       @Y30LB40*/ 03060000
         LA    @07,1                                               0893 03061000
         SLR   @15,@15                                             0893 03062000
         IC    @15,TSEYR                                           0893 03063000
         ALR   @07,@15                                             0893 03064000
         STC   @07,TSEYR                                           0893 03065000
*               END;                /*                       @Y30LB40*/ 03066000
*           END;                    /*                       @Y30LB40*/ 03067000
@RC00884 DS    0H                                                  0896 03068000
*       END;                        /*                       @Y30LB40*/ 03069000
@RF00882 DS    0H                                                  0897 03070000
*   END;                            /*                       @Y30LB40*/ 03071000
@RF00878 DS    0H                                                  0897 03072000
@DE00875 CLC   CKTIME(7),TSEND                                     0897 03073000
         BH    @DL00875                                            0897 03074000
*   END GETSLICE;                   /*                       @OZ11673*/ 03075000
@EL00002 DS    0H                                                  0898 03076000
@EF00002 DS    0H                                                  0898 03077000
@ER00002 LM    @14,@12,12(@13)                                     0898 03078000
         BR    @14                                                 0898 03079000
*                                                                  0899 03080000
*/********************************************************************/ 03081000
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */ 03082000
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */ 03083000
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/ 03084000
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1,2, OR 4*/ 03085000
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/ 03086000
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/ 03087000
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/ 03088000
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/ 03089000
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */ 03090000
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/ 03091000
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */ 03092000
*/* LONG.                                                    @Y30LB40*/ 03093000
*/********************************************************************/ 03094000
*                                                                  0899 03095000
*EDITFIX:                                                          0899 03096000
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/ 03097000
EDITFIX  STM   @14,@12,@SA00003                                    0899 03098000
         MVC   @PC00003(12),0(@01)                                 0899 03099000
*   DCL                                                            0900 03100000
*     FIXADDR PTR(31);              /*                       @Y30LB40*/ 03101000
*   DCL                                                            0901 03102000
*     FIXLEN PTR(31);               /*                       @Y30LB40*/ 03103000
*   DCL                                                            0902 03104000
*     FIXOPT CHAR(1);               /*                       @Y30LB40*/ 03105000
*   RFY                                                            0903 03106000
*    (R2,                                                          0903 03107000
*     R3) RSTD;                     /*                       @Y30LB40*/ 03108000
*   R2=FIXADDR;                     /*                       @Y30LB40*/ 03109000
         L     @07,@PC00003                                        0904 03110000
         L     R2,FIXADDR(,@07)                                    0904 03111000
*   R3=0;                           /*                       @Y30LB40*/ 03112000
         SLR   R3,R3                                               0905 03113000
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE   03114000
*                                                            @Y30LB40*/ 03115000
*     THEN                                                         0906 03116000
         L     @07,@PC00003+4                                      0906 03117000
         CLC   FIXLEN(4,@07),@CF00044                              0906 03118000
         BNE   @RF00906                                            0906 03119000
*     DO;                           /*                       @Y30LB40*/ 03120000
*       GEN(IC    R3,0(R2));        /*                       @Y30LB40*/ 03121000
         IC    R3,0(R2)                                                 03122000
*     END;                          /*                       @Y30LB40*/ 03123000
*   ELSE                                                           0910 03124000
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   0910 03125000
*                                      BYTES                 @Y30LB40*/ 03126000
*       THEN                                                       0910 03127000
         B     @RC00906                                            0910 03128000
@RF00906 L     @07,@PC00003+4                                      0910 03129000
         CLC   FIXLEN(4,@07),@CF00051                              0910 03130000
         BNE   @RF00910                                            0910 03131000
*       DO;                         /*                       @Y30LB40*/ 03132000
*         GEN(LH    R3,0(R2));      /*                       @Y30LB40*/ 03133000
         LH    R3,0(R2)                                                 03134000
*       END;                        /*                       @Y30LB40*/ 03135000
*     ELSE                                                         0914 03136000
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/ 03137000
         B     @RC00910                                            0914 03138000
@RF00910 DS    0H                                                  0915 03139000
*         GEN(L     R3,0(R2));      /*                       @Y30LB40*/ 03140000
         L     R3,0(R2)                                                 03141000
*       END;                        /*                       @Y30LB40*/ 03142000
*   GEN;                                                           0917 03143000
@RC00910 DS    0H                                                  0917 03144000
@RC00906 DS    0H                                                  0917 03145000
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/  03146000
  CVD   R3,DOUBLEWD                                                     03147000
  OI    DOUBLEWD+7,X'0F'                                                03148000
  UNPK  FIXOUT(13),DOUBLEWD+2(6)                                        03149000
*   IF FIXOPT='N' THEN                                             0918 03150000
         L     @07,@PC00003+8                                      0918 03151000
         CLI   FIXOPT(@07),C'N'                                    0918 03152000
         BE    @RT00918                                            0918 03153000
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */ 03154000
*   IF FIXOPT='S' THEN                                             0920 03155000
         CLI   FIXOPT(@07),C'S'                                    0920 03156000
         BE    @RT00920                                            0920 03157000
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       0921 03158000
*                                      INSERTION                     */ 03159000
*   GEN;                                                           0922 03160000
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/  03161000
  MVC   FIXOUT(1),FIXOUT+3                                              03162000
  MVI   FIXOUT+1,C','                                                   03163000
  MVC   FIXOUT+2(3),FIXOUT+4                                            03164000
  MVI   FIXOUT+5,C','                                                   03165000
  MVC   FIXOUT+6(3),FIXOUT+7                                            03166000
  MVI   FIXOUT+9,C','                                                   03167000
*EF4:                               /* ZERO AND COMMA SUPPRESS     0923 03168000
*                                                            @Y30LB40*/ 03169000
*   GEN;                                                           0923 03170000
EF4      DS    0H                                                  0923 03171000
*                                                         /*@Y30LB40*/  03172000
         LA    R2,FIXOUT                                                03173000
         LA    R3,12                                                    03174000
EF5      EQU   *                                                        03175000
         CLI   0(R2),C','                                               03176000
         BE    EF6                                                      03177000
         CLI   0(R2),C'0'                                               03178000
         BNE   EFEND                                                    03179000
EF6      EQU   *                                                        03180000
         MVI   0(R2),C' '                                               03181000
         LA    R2,1(R2)                                                 03182000
         BCT   R3,EF5                                                   03183000
*EFEND:                                                            0924 03184000
*   RFY                                                            0924 03185000
*    (R2,                                                          0924 03186000
*     R3) UNRSTD;                   /*                       @Y30LB40*/ 03187000
*   END EDITFIX;                    /*                       @Y30LB40*/ 03188000
@EL00003 DS    0H                                                  0925 03189000
@EF00003 DS    0H                                                  0925 03190000
@ER00003 LM    @14,@12,@SA00003                                    0925 03191000
         BR    @14                                                 0925 03192000
*                                                                  0926 03193000
*/********************************************************************/ 03194000
*/* ROUTINE TO CALCULATE ADDRESS INTO SDG ARRAY              @ZA16140*/ 03195000
*/********************************************************************/ 03196000
*                                                                  0926 03197000
*CALCDSA:                                                          0926 03198000
*   PROC(DSS1,DSS2,DSS3) OPTIONS(SAVE);/*                    @ZA16140*/ 03199000
CALCDSA  STM   @14,@12,12(@13)                                     0926 03200000
         MVC   @PC00004(12),0(@01)                                 0926 03201000
*   DCL                                                            0927 03202000
*    (DSS1,                                                        0927 03203000
*     DSS2,                                                        0927 03204000
*     DSS3) PTR(31);                /* THREE DIMENTIONS      @ZA16140*/ 03205000
*   ARRAYPTR=ARRAYLOC+((DSS1-1)*(LENGTH(DSARRAY)/DIM(DSENTS,1)))+((DSS2 03206000
*       -1)*(LENGTH(DSARRAY)/(DIM(DSENTS,1)*DIM(DSENTS,2))))+((DSS3-1)* 03207000
*       (LENGTH(DSARRAY)/(DIM(DSENTS,1)*DIM(DSENTS,2)*DIM(DSENTS,3)))); 03208000
         L     @07,@PC00004                                        0928 03209000
         L     @07,DSS1(,@07)                                      0928 03210000
         BCTR  @07,0                                               0928 03211000
         MH    @07,@CH01005                                        0928 03212000
         ALR   @07,ARRAYLOC                                        0928 03213000
         L     @15,@PC00004+4                                      0928 03214000
         L     @15,DSS2(,@15)                                      0928 03215000
         BCTR  @15,0                                               0928 03216000
         MH    @15,@CH01006                                        0928 03217000
         ALR   @07,@15                                             0928 03218000
         L     @15,@PC00004+8                                      0928 03219000
         L     @15,DSS3(,@15)                                      0928 03220000
         BCTR  @15,0                                               0928 03221000
         MH    @15,@CH00837                                        0928 03222000
         ALR   @07,@15                                             0928 03223000
         ST    @07,ARRAYPTR                                        0928 03224000
*                                   /*                       @ZA16140*/ 03225000
*   END CALCDSA;                    /*                       @Y30LB40*/ 03226000
@EL00004 DS    0H                                                  0929 03227000
@EF00004 DS    0H                                                  0929 03228000
@ER00004 LM    @14,@12,12(@13)                                     0929 03229000
         BR    @14                                                 0929 03230000
*                                                                  0930 03231000
*/********************************************************************/ 03232000
*/* ROUTINE TO CALCULATE ADDRESS INTO READ WRITE UNIT ARRAY  @Y30LB40*/ 03233000
*/********************************************************************/ 03234000
*                                                                  0930 03235000
*CALCRWA:                                                          0930 03236000
*   PROC(RWS1,RWS2,RWS3,RWS4) OPTIONS(SAVE);/*               @Y30LB40*/ 03237000
CALCRWA  STM   @14,@12,12(@13)                                     0930 03238000
         MVC   @PC00005(16),0(@01)                                 0930 03239000
*   DCL                                                            0931 03240000
*    (RWS1,                                                        0931 03241000
*     RWS2,                                                        0931 03242000
*     RWS3,                                                        0931 03243000
*     RWS4) PTR(31);                /* FOUR DIMENTIONS       @Y30LB40*/ 03244000
*   ARRAYPTR=ARRAYLOC+((RWS1-1)*(LENGTH(RWARRAY)/DIM(RWENTS,1)))+((RWS2 03245000
*       -1)*(LENGTH(RWARRAY)/(DIM(RWENTS,1)*DIM(RWENTS,2))))+((RWS3-1)* 03246000
*       (LENGTH(RWARRAY)/(DIM(RWENTS,1)*DIM(RWENTS,2)*DIM(RWENTS,3))))+ 03247000
*       ((RWS4-1)*(LENGTH(RWARRAY)/(DIM(RWENTS,1)*DIM(RWENTS,2)*DIM(    03248000
*       RWENTS,3)*DIM(RWENTS,4)))); /*                       @Y30LB40*/ 03249000
         L     @07,@PC00005                                        0932 03250000
         L     @07,RWS1(,@07)                                      0932 03251000
         BCTR  @07,0                                               0932 03252000
         MH    @07,@CH01009                                        0932 03253000
         ALR   @07,ARRAYLOC                                        0932 03254000
         L     @15,@PC00005+4                                      0932 03255000
         L     @15,RWS2(,@15)                                      0932 03256000
         BCTR  @15,0                                               0932 03257000
         MH    @15,@CH01010                                        0932 03258000
         ALR   @07,@15                                             0932 03259000
         L     @15,@PC00005+8                                      0932 03260000
         L     @15,RWS3(,@15)                                      0932 03261000
         BCTR  @15,0                                               0932 03262000
         MH    @15,@CH01011                                        0932 03263000
         ALR   @07,@15                                             0932 03264000
         L     @15,@PC00005+12                                     0932 03265000
         L     @15,RWS4(,@15)                                      0932 03266000
         BCTR  @15,0                                               0932 03267000
         MH    @15,@CH00499                                        0932 03268000
         ALR   @07,@15                                             0932 03269000
         ST    @07,ARRAYPTR                                        0932 03270000
*   END CALCRWA;                    /*                       @Y30LB40*/ 03271000
@EL00005 DS    0H                                                  0933 03272000
@EF00005 DS    0H                                                  0933 03273000
@ER00005 LM    @14,@12,12(@13)                                     0933 03274000
         BR    @14                                                 0933 03275000
*                                                                  0934 03276000
*/********************************************************************/ 03277000
*/* ROUTINE TO SET UP CLASS INTERVALS IN PRINT LINES         @Y30LB40*/ 03278000
*/********************************************************************/ 03279000
*                                                                  0934 03280000
*SETLINE:                                                          0934 03281000
*   PROC(SLN) OPTIONS(SAVE);        /*                       @Y30LB40*/ 03282000
SETLINE  STM   @14,@12,12(@13)                                     0934 03283000
         MVC   @PC00006(4),0(@01)                                  0934 03284000
*   DCL                                                            0935 03285000
*     SLN FIXED BINARY(31);         /* PRINT LINE NUMBER OF A DISTR.    03286000
*                                      1-10                          */ 03287000
*   IF PARMSW='D' THEN                                             0936 03288000
         CLI   PARMSW,C'D'                                         0936 03289000
         BNE   @RF00936                                            0936 03290000
*     DO;                           /* SETUP DATA STAGER           0937 03291000
*                                      DISTRIBUTIONS         @Y30LB40*/ 03292000
*       DSFLD8=SEC3ARRY(SLN);       /*                       @Y30LB40*/ 03293000
         L     @07,@PC00006                                        0938 03294000
         L     @07,SLN(,@07)                                       0938 03295000
         LR    @15,@07                                             0938 03296000
         MH    @15,@CH00372                                        0938 03297000
         LA    @14,SEC3ARRY-5(@15)                                 0938 03298000
         MVC   DSFLD8(5),0(@14)                                    0938 03299000
*       DSFLD11=SEC1ARRY(SLN);      /*                       @Y30LB40*/ 03300000
         LA    @01,SEC1ARRY-1(@07)                                 0939 03301000
         MVC   DSFLD11(1),0(@01)                                   0939 03302000
*       DSFLD19=SEC1ARRY(SLN);      /*                       @Y30LB40*/ 03303000
         LA    @01,SEC1ARRY-1(@07)                                 0940 03304000
         MVC   DSFLD19(1),0(@01)                                   0940 03305000
*     END;                          /*                       @Y30LB40*/ 03306000
*   ELSE                                                           0942 03307000
*     DO;                           /* SETUP READ WRITE UNIT       0942 03308000
*                                      DISTRIBUTIONS         @Y30LB40*/ 03309000
         B     @RC00936                                            0942 03310000
@RF00936 DS    0H                                                  0943 03311000
*       RWFLD8=SEC3ARRY(SLN);       /*                       @Y30LB40*/ 03312000
         L     @07,@PC00006                                        0943 03313000
         L     @07,SLN(,@07)                                       0943 03314000
         LR    @15,@07                                             0943 03315000
         MH    @15,@CH00372                                        0943 03316000
         LA    @14,SEC3ARRY-5(@15)                                 0943 03317000
         MVC   RWFLD8(5),0(@14)                                    0943 03318000
*       RWFLD11=SEC1ARRY(SLN);      /*                       @Y30LB40*/ 03319000
         LA    @01,SEC1ARRY-1(@07)                                 0944 03320000
         MVC   RWFLD11(1),0(@01)                                   0944 03321000
*       RWFLD23=SEC6ARRY(SLN);      /*                       @Y30LB40*/ 03322000
         LA    @07,SEC6ARRY-5(@15)                                 0945 03323000
         MVC   RWFLD23(5),0(@07)                                   0945 03324000
*     END;                          /*                       @Y30LB40*/ 03325000
*   END SETLINE;                    /*                       @Y30LB40*/ 03326000
@EL00006 DS    0H                                                  0947 03327000
@EF00006 DS    0H                                                  0947 03328000
@ER00006 LM    @14,@12,12(@13)                                     0947 03329000
         BR    @14                                                 0947 03330000
*                                                                  0948 03331000
*/********************************************************** @OZ05124*/ 03332000
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/ 03333000
*/********************************************************** @OZ05124*/ 03334000
*                                                                  0948 03335000
*READERR:                                                          0948 03336000
*   ;                               /*                       @OZ05124*/ 03337000
READERR  DS    0H                                                  0949 03338000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/ 03339000
         SYNADAF ACSMETH=QSAM                                           03340000
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/ 03341000
         MVC   PRNTLINE+30(79),49(R1)                                   03342000
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/ 03343000
         MVC   PRNTLINE(30),ICGTR904                               0951 03344000
*   SAVE14=R14;                     /*                       @OZ09522*/ 03345000
         LR    SAVE14,R14                                          0952 03346000
*   RFY                                                            0953 03347000
*    (R0,                                                          0953 03348000
*     R1,                                                          0953 03349000
*     R14,                                                         0953 03350000
*     R15) RSTD;                    /*                       @OZ05124*/ 03351000
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/ 03352000
         PUT PRNTDCB,PRNTLINE                                           03353000
*   RFY                                                            0955 03354000
*    (R0,                                                          0955 03355000
*     R1,                                                          0955 03356000
*     R14,                                                         0955 03357000
*     R15) UNRSTD;                  /*                       @OZ05124*/ 03358000
*   R14=SAVE14;                     /*                       @OZ09522*/ 03359000
         LR    R14,SAVE14                                          0956 03360000
*   GEN(SYNADRLS);                  /*                       @OZ05124*/ 03361000
         SYNADRLS                                                       03362000
*   RETURNCD=4;                     /*                       @OZ05124*/ 03363000
         MVC   RETURNCD(2),@CH00104                                0958 03364000
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/ 03365000
         BR    R14                                                      03366000
*   END ICGTRDST                    /*                       @Y30LB40*/ 03367000
*                                                                  0960 03368000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03369000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 03370000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 03371000
*                                                                  0960 03372000
*       ;                                                          0960 03373000
@EL00001 L     @13,4(,@13)                                         0960 03374000
@EF00001 L     @00,@SIZDATD                                        0960 03375000
         LR    @01,@09                                             0960 03376000
         FREEMAIN R,LV=(0),A=(1)                                        03377000
@ER00001 LM    @14,@12,12(@13)                                     0960 03378000
         BR    @14                                                 0960 03379000
@DATA    DS    0H                                                       03380000
@CH00499 DC    H'36'                                                    03381000
@CH00837 DC    H'44'                                                    03382000
@CH01011 DC    H'396'                                                   03383000
@CH01006 DC    H'484'                                                   03384000
@CH01010 DC    H'792'                                                   03385000
@CH01005 DC    H'968'                                                   03386000
@CH00888 DC    H'3600'                                                  03387000
@CH01009 DC    H'6336'                                                  03388000
@SM01014 MVC   PARMHOLD(0),PARMS(PARMPTR)                               03389000
         DS    0F                                                       03390000
@AL00474 EQU   *                       LIST WITH   2 ARGUMENT(S)        03391000
@AL00493 EQU   *                       LIST WITH   2 ARGUMENT(S)        03392000
@AL00495 EQU   *                       LIST WITH   2 ARGUMENT(S)        03393000
@AL00710 EQU   *                       LIST WITH   2 ARGUMENT(S)        03394000
@AL00712 EQU   *                       LIST WITH   2 ARGUMENT(S)        03395000
@AL00836 EQU   *                       LIST WITH   2 ARGUMENT(S)        03396000
@AL00838 EQU   *                       LIST WITH   2 ARGUMENT(S)        03397000
@AL00842 EQU   *                       LIST WITH   2 ARGUMENT(S)        03398000
@AL00844 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        03399000
         DC    A(@CC00907)                                              03400000
@AL00483 EQU   *                       LIST WITH   2 ARGUMENT(S)        03401000
@AL00700 EQU   *                       LIST WITH   2 ARGUMENT(S)        03402000
@AL00826 EQU   *                       LIST WITH   2 ARGUMENT(S)        03403000
@AL00830 EQU   *                       LIST WITH   2 ARGUMENT(S)        03404000
@AL00850 DC    A(@CF00044)             LIST WITH   2 ARGUMENT(S)        03405000
         DC    A(@CC00907)                                              03406000
@AL00485 EQU   *                       LIST WITH   2 ARGUMENT(S)        03407000
@AL00702 EQU   *                       LIST WITH   2 ARGUMENT(S)        03408000
@AL00828 EQU   *                       LIST WITH   2 ARGUMENT(S)        03409000
@AL00832 DC    A(@CF00051)             LIST WITH   2 ARGUMENT(S)        03410000
         DC    A(@CC00907)                                              03411000
@AL00491 EQU   *                       LIST WITH   2 ARGUMENT(S)        03412000
@AL00506 EQU   *                       LIST WITH   2 ARGUMENT(S)        03413000
@AL00525 EQU   *                       LIST WITH   2 ARGUMENT(S)        03414000
@AL00527 EQU   *                       LIST WITH   2 ARGUMENT(S)        03415000
@AL00529 EQU   *                       LIST WITH   2 ARGUMENT(S)        03416000
@AL00531 EQU   *                       LIST WITH   2 ARGUMENT(S)        03417000
@AL00533 EQU   *                       LIST WITH   2 ARGUMENT(S)        03418000
@AL00535 EQU   *                       LIST WITH   2 ARGUMENT(S)        03419000
@AL00537 EQU   *                       LIST WITH   2 ARGUMENT(S)        03420000
@AL00563 EQU   *                       LIST WITH   2 ARGUMENT(S)        03421000
@AL00566 EQU   *                       LIST WITH   2 ARGUMENT(S)        03422000
@AL00568 EQU   *                       LIST WITH   2 ARGUMENT(S)        03423000
@AL00571 EQU   *                       LIST WITH   2 ARGUMENT(S)        03424000
@AL00574 EQU   *                       LIST WITH   2 ARGUMENT(S)        03425000
@AL00576 EQU   *                       LIST WITH   2 ARGUMENT(S)        03426000
@AL00579 EQU   *                       LIST WITH   2 ARGUMENT(S)        03427000
@AL00582 EQU   *                       LIST WITH   2 ARGUMENT(S)        03428000
@AL00584 EQU   *                       LIST WITH   2 ARGUMENT(S)        03429000
@AL00587 EQU   *                       LIST WITH   2 ARGUMENT(S)        03430000
@AL00590 EQU   *                       LIST WITH   2 ARGUMENT(S)        03431000
@AL00595 EQU   *                       LIST WITH   2 ARGUMENT(S)        03432000
@AL00600 EQU   *                       LIST WITH   2 ARGUMENT(S)        03433000
@AL00708 EQU   *                       LIST WITH   2 ARGUMENT(S)        03434000
@AL00723 EQU   *                       LIST WITH   2 ARGUMENT(S)        03435000
@AL00742 EQU   *                       LIST WITH   2 ARGUMENT(S)        03436000
@AL00744 EQU   *                       LIST WITH   2 ARGUMENT(S)        03437000
@AL00746 EQU   *                       LIST WITH   2 ARGUMENT(S)        03438000
@AL00748 EQU   *                       LIST WITH   2 ARGUMENT(S)        03439000
@AL00772 EQU   *                       LIST WITH   2 ARGUMENT(S)        03440000
@AL00775 EQU   *                       LIST WITH   2 ARGUMENT(S)        03441000
@AL00777 EQU   *                       LIST WITH   2 ARGUMENT(S)        03442000
@AL00780 EQU   *                       LIST WITH   2 ARGUMENT(S)        03443000
@AL00782 EQU   *                       LIST WITH   2 ARGUMENT(S)        03444000
@AL00785 EQU   *                       LIST WITH   2 ARGUMENT(S)        03445000
@AL00790 EQU   *                       LIST WITH   2 ARGUMENT(S)        03446000
@AL00824 EQU   *                       LIST WITH   2 ARGUMENT(S)        03447000
@AL00859 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        03448000
         DC    A(@CC00912)                                              03449000
@DATD    DSECT                                                          03450000
         DS    0F                                                       03451000
@SA00001 DS    18F                                                      03452000
@PC00004 DS    3F                                                       03453000
@SA00003 DS    15F                                                      03454000
@PC00003 DS    3F                                                       03455000
@PC00006 DS    1F                                                       03456000
@PC00005 DS    4F                                                       03457000
@AL00001 DS    4A                                                       03458000
@AFTEMPS DS    1F                                                       03459000
ICGTRDST CSECT                                                          03460000
         DS    0F                                                       03461000
@CF00044 DC    F'1'                                                     03462000
@CF00051 DC    F'2'                                                     03463000
@CF00104 DC    F'4'                                                     03464000
@CH00104 EQU   @CF00104+2                                               03465000
@CF00372 DC    F'5'                                                     03466000
@CH00372 EQU   @CF00372+2                                               03467000
@CF00069 DC    F'8'                                                     03468000
@CH00069 EQU   @CF00069+2                                               03469000
@CF00035 DC    F'9'                                                     03470000
@CF00034 DC    F'10'                                                    03471000
@CF00033 DC    F'11'                                                    03472000
@CF00032 DC    F'12'                                                    03473000
@CF00887 DC    F'23'                                                    03474000
@CF00071 DC    F'24'                                                    03475000
@CF00615 DC    F'28'                                                    03476000
@CF00067 DC    F'31'                                                    03477000
@CF00712 DC    F'43'                                                    03478000
@CF00889 DC    F'59'                                                    03479000
@CF00335 DC    F'60'                                                    03480000
@CH00335 EQU   @CF00335+2                                               03481000
@CF00870 DC    F'365'                                                   03482000
@CH00870 EQU   @CF00870+2                                               03483000
@CF00884 DC    F'366'                                                   03484000
@CH00884 EQU   @CF00884+2                                               03485000
@CF00865 DC    F'600'                                                   03486000
@CF00997 DC    F'27104'                                                 03487000
@CF00871 DC    F'86399'                                                 03488000
@CF00955 DC    F'86400'                                                 03489000
@DATD    DSECT                                                          03490000
         DS    0D                                                       03491000
DCBPTR   DS    A                                                        03492000
ARRAYPTR DS    A                                                        03493000
RCDCOUNT DS    F                                                        03494000
PAGECNT  DS    F                                                        03495000
TIMESL   DS    F                                                        03496000
OPENCLOS DS    FL4                                                      03497000
         ORG   OPENCLOS                                                 03498000
OPCLB1   DS    BL1                                                      03499000
OPCLB234 DS    CL3                                                      03500000
         ORG   OPENCLOS+4                                               03501000
HOUR     DS    F                                                        03502000
MINUTE   DS    F                                                        03503000
SECOND   DS    F                                                        03504000
CALCFLD  DS    F                                                        03505000
J        DS    F                                                        03506000
K        DS    F                                                        03507000
L        DS    F                                                        03508000
M        DS    F                                                        03509000
N        DS    F                                                        03510000
RETURNCD DS    H                                                        03511000
SAINDEX  DS    H                                                        03512000
SELSDG   DS    FL1                                                      03513000
LIB      DS    FL1                                                      03514000
U        DS    FL1                                                      03515000
@TS00001 DS    CL1                                                      03516000
RCDIN    DS    CL72                                                     03517000
         ORG   RCDIN                                                    03518000
STGD     DS    FL4                                                      03519000
CFAULT   DS    FL4                                                      03520000
SYSSGTM  DS    FL4                                                      03521000
DEVSGTM  DS    FL4                                                      03522000
DSTGD    DS    FL4                                                      03523000
SALLOC   DS    FL4                                                      03524000
SYSDSTM  DS    FL4                                                      03525000
DEVDSTM  DS    FL4                                                      03526000
BUSYTIME DS    FL4                                                      03527000
LOADTIME DS    FL4                                                      03528000
LOADNUM  DS    FL1                                                      03529000
CKTIME   DS    CL7                                                      03530000
         ORG   CKTIME                                                   03531000
SVEYEAR  DS    FL1                                                      03532000
SVEJUL   DS    FL2                                                      03533000
SVETIME  DS    FL4                                                      03534000
         ORG   RCDIN+48                                                 03535000
PAGES    DS    FL1                                                      03536000
MININUM  DS    FL1                                                      03537000
HITNUM   DS    FL1                                                      03538000
STGDNUM  DS    FL1                                                      03539000
DSTGDNUM DS    FL1                                                      03540000
VTOCSTG  DS    FL1                                                      03541000
VTOCDSTG DS    FL1                                                      03542000
LIBRARY  DS    FL1                                                      03543000
DSPORT   DS    FL1                                                      03544000
DSCU     DS    FL1                                                      03545000
Z        DS    FL1                                                      03546000
Y        DS    FL1                                                      03547000
X        DS    FL1                                                      03548000
CARTPAIR DS    FL1                                                      03549000
READWRIT DS    FL1                                                      03550000
VOLID    DS    CL6                                                      03551000
CHARDRC  DS    CL1                                                      03552000
SDGINBIN DS    FL1                                                      03553000
@NM00030 DS    CL1                                                      03554000
         ORG   RCDIN+72                                                 03555000
DSLINE   DS    CL121                                                    03556000
         ORG   DSLINE                                                   03557000
DSFLD1   DS    CL1                                                      03558000
DSFLD2   DS    CL6                                                      03559000
@NM00031 DS    CL1                                                      03560000
DSFLD2A  DS    CL8                                                      03561000
@NM00032 DS    CL2                                                      03562000
SDGID    DS    CL3                                                      03563000
         ORG   SDGID                                                    03564000
@NM00033 DS    CL1                                                      03565000
SDGFLD   DS    CL2                                                      03566000
         ORG   DSLINE+21                                                03567000
@NM00034 DS    CL5                                                      03568000
DSFLD8   DS    CL5                                                      03569000
@NM00035 DS    CL1                                                      03570000
DSFLD10  DS    CL5                                                      03571000
@NM00036 DS    CL10                                                     03572000
DSFLD11  DS    CL1                                                      03573000
@NM00037 DS    CL4                                                      03574000
DSFLD12  DS    CL6                                                      03575000
@NM00038 DS    CL1                                                      03576000
DSFLD14  DS    CL6                                                      03577000
@NM00039 DS    CL3                                                      03578000
DSFLD16  DS    CL6                                                      03579000
@NM00040 DS    CL1                                                      03580000
DSFLD18  DS    CL6                                                      03581000
@NM00041 DS    CL11                                                     03582000
DSFLD19  DS    CL1                                                      03583000
@NM00042 DS    CL3                                                      03584000
DSFLD20  DS    CL6                                                      03585000
@NM00043 DS    CL4                                                      03586000
DSFLD22  DS    CL6                                                      03587000
@NM00044 DS    CL9                                                      03588000
         ORG   DSLINE+121                                               03589000
SPACE1   DS    CL121                                                    03590000
HEADHOLD DS    CL121                                                    03591000
PRNTLINE DS    CL121                                                    03592000
PRNTDCB  DS    CL100                                                    03593000
INDCB    DS    CL100                                                    03594000
DOUBLEWD DS    CL8                                                      03595000
STARTTIM DS    CL16                                                     03596000
         ORG   STARTTIM                                                 03597000
@NM00130 DS    CL1                                                      03598000
CKSTIME  DS    CL7                                                      03599000
         ORG   CKSTIME                                                  03600000
HLDSYR   DS    FL1                                                      03601000
HLDSDAY  DS    FL2                                                      03602000
HLDSTIME DS    FL4                                                      03603000
         ORG   STARTTIM+8                                               03604000
@NM00131 DS    CL1                                                      03605000
CKETIME  DS    CL7                                                      03606000
         ORG   CKETIME                                                  03607000
HLDEYR   DS    FL1                                                      03608000
HLDEDAY  DS    FL2                                                      03609000
HLDETIME DS    FL4                                                      03610000
         ORG   STARTTIM+16                                              03611000
TSTIMES  DS    CL16                                                     03612000
         ORG   TSTIMES                                                  03613000
@NM00132 DS    CL1                                                      03614000
TSBEG    DS    CL7                                                      03615000
         ORG   TSBEG                                                    03616000
TSSYR    DS    FL1                                                      03617000
TSSDAY   DS    FL2                                                      03618000
TSSTIME  DS    FL4                                                      03619000
         ORG   TSTIMES+8                                                03620000
@NM00133 DS    CL1                                                      03621000
TSEND    DS    CL7                                                      03622000
         ORG   TSEND                                                    03623000
TSEYR    DS    FL1                                                      03624000
TSEDAY   DS    FL2                                                      03625000
TSETIME  DS    FL4                                                      03626000
         ORG   TSTIMES+16                                               03627000
CKSEQ    DS    CL7                                                      03628000
PARMSW   DS    CL1                                                      03629000
PARMHOLD DS    CL31                                                     03630000
TODAY    DS    CL5                                                      03631000
FIXOUT   DS    CL13                                                     03632000
SELECTSW DS    BL1                                                      03633000
DATEINSW DS    BL1                                                      03634000
PARMERR  DS    BL1                                                      03635000
FIRSTSW  DS    BL1                                                      03636000
EOFSW    DS    BL1                                                      03637000
ICGTRDST CSECT                                                          03638000
         DS    0F                                                       03639000
@SIZDATD DC    AL1(0)                                                   03640000
         DC    AL3(@ENDDATD-@DATD)                                      03641000
         DS    0D                                                       03642000
@CC00909 DC    C'SUMMARY '                                              03643000
@CC00911 DC    C'  :  :  '                                              03644000
@CC00943 DC    C'SDGXX   '                                              03645000
@CC00948 DC    C'        '                                              03646000
@CC00908 DC    C'DISTR.'                                                03647000
@CC00910 DC    C'  /   '                                                03648000
@CC00881 DC    C'000'                                                   03649000
@CC00890 EQU   @CC00943                                                 03650000
@CC00926 EQU   @CC00948                                                 03651000
@CC00891 DC    C'27'                                                    03652000
@CC00907 DC    C'N'                                                     03653000
@CC00912 EQU   @CC00909                                                 03654000
HDNG1    DS    CL121                                                    03655000
         ORG   HDNG1                                                    03656000
@NM00078 DC    CL34'1ICGTRDST'                                          03657000
@NM00079 DC    CL30'MSS TRACE STAGING DRIVE GROUP '                     03658000
@NM00080 DC    CL37'DISTRIBUTION'                                       03659000
@NM00081 DC    CL20'DATE YYDDD  PAGEXXXX'                               03660000
         ORG   HDNG1+121                                                03661000
HDNG2    DS    CL121                                                    03662000
         ORG   HDNG2                                                    03663000
@NM00082 DC    CL1'0'                                                   03664000
@NM00083 DC    CL40'                        --LOAD TIMES--  '           03665000
@NM00084 DC    CL40'   --------STAGE AND DESTAGE RATES------'           03666000
@NM00085 DC    CL40'---     ---PAGE AND CYL AVERAGES---     '           03667000
         ORG   HDNG2+121                                                03668000
HDNG3    DS    CL121                                                    03669000
         ORG   HDNG3                                                    03670000
@NM00086 DC    CL1' '                                                   03671000
@NM00087 DC    CL40'                                        '           03672000
@NM00088 DC    CL40'     CYLS/  DEVICE SYSTEM   DEVICE SYSTE'           03673000
@NM00089 DC    CL40'M               PAGES      CYLS         '           03674000
         ORG   HDNG3+121                                                03675000
HDNG4    DS    CL121                                                    03676000
         ORG   HDNG4                                                    03677000
@NM00090 DC    CL1' '                                                   03678000
@NM00091 DC    CL40' DATE    TIME     SDG     SECS COUNT    '           03679000
@NM00092 DC    CL40'     SEC    STAGE  STAGE    DSTAGE DSTAG'           03680000
@NM00093 DC    CL40'E         NUM  PER REQ   PER PAGE       '           03681000
         ORG   HDNG4+121                                                03682000
HDNG5    DS    CL121                                                    03683000
         ORG   HDNG5                                                    03684000
@NM00094 DC    CL1'0'                                                   03685000
@NM00095 DC    CL40'*TOTALS*         LOAD    CYLS   DEV-STG '           03686000
@NM00096 DC    CL40' SYS-STG    CYLS   DEV-DSTG  SYS-DSTG  C'           03687000
@NM00097 DC    CL40'YLS    DEVICE   SYSTEM   DEVICE   SYSTEM'           03688000
         ORG   HDNG5+121                                                03689000
HDNG6    DS    CL121                                                    03690000
         ORG   HDNG6                                                    03691000
@NM00098 DC    CL1' '                                                   03692000
@NM00099 DC    CL40'      CARTGS     TIME   STAGED    TIME  '           03693000
@NM00100 DC    CL40'   TIME   DESTAGED   TIME      TIME   TR'           03694000
@NM00101 DC    CL40'ANSF    TIME     TIME     RATE     RATE '           03695000
         ORG   HDNG6+121                                                03696000
HDNGA    DS    CL121                                                    03697000
         ORG   HDNGA                                                    03698000
@NM00102 DC    CL33'1ICGTRDST'                                          03699000
@NM00103 DC    CL28'MSS TRACE DATA RECORDING DEV'                       03700000
@NM00104 DC    CL40'ICE DISTRIBUTION'                                   03701000
@NM00105 DC    CL20'DATE YYDDD  PAGEXXXX'                               03702000
         ORG   HDNGA+121                                                03703000
HDNGB    DS    CL121                                                    03704000
         ORG   HDNGB                                                    03705000
@NM00106 DC    CL1'0'                                                   03706000
@NM00107 DC    CL40'                          --LOAD TIMES--'           03707000
@NM00108 DC    CL40'   -------DATA RATES--------   ---DRD BU'           03708000
@NM00109 DC    CL40'SY----                                  '           03709000
         ORG   HDNGB+121                                                03710000
HDNGC    DS    CL121                                                    03711000
         ORG   HDNGC                                                    03712000
@NM00110 DC    CL1' '                                                   03713000
@NM00111 DC    CL40'                                        '           03714000
@NM00112 DC    CL40'     CYLS/  TOTAL  TOTAL                '           03715000
@NM00113 DC    CL40'                                        '           03716000
         ORG   HDNGC+121                                                03717000
HDNGD    DS    CL121                                                    03718000
         ORG   HDNGD                                                    03719000
@NM00114 DC    CL1' '                                                   03720000
@NM00115 DC    CL40' DATE    TIME   MSF DRD     SECS COUNT  '           03721000
@NM00116 DC    CL40'     SEC    STAGE  DESTAGE       SECS  C'           03722000
@NM00117 DC    CL40'OUNT                                    '           03723000
         ORG   HDNGD+121                                                03724000
HDNGE    DS    CL121                                                    03725000
         ORG   HDNGE                                                    03726000
@NM00118 DC    CL1'0'                                                   03727000
@NM00119 DC    CL40'*TOTALS*            LOAD    CYLS   DEV-S'           03728000
@NM00120 DC    CL40'TG    CYLS    DEV-DSTG  CARTG           '           03729000
@NM00121 DC    CL40'                                        '           03730000
         ORG   HDNGE+121                                                03731000
HDNGF    DS    CL121                                                    03732000
         ORG   HDNGF                                                    03733000
@NM00122 DC    CL1' '                                                   03734000
@NM00123 DC    CL40'         CARTGS     TIME   STAGED    TIM'           03735000
@NM00124 DC    CL40'E   DESTAGED    TIME    RATE            '           03736000
@NM00125 DC    CL40'                                        '           03737000
         ORG   HDNGF+121                                                03738000
RCDTOTAL DS    CL121                                                    03739000
         ORG   RCDTOTAL                                                 03740000
@NM00126 DC    CL1'1'                                                   03741000
@NM00127 DC    CL40'PARM OPTION - X  T-SLICE - XXX  DATES - '           03742000
@NM00128 DC    CL40'YYDDD-YYDDD  TIMES - HHMM-HHMM SSID-XXX '           03743000
@NM00129 DC    CL40' INPUT RECORDS SELECTED - XXXXXX        '           03744000
         ORG   RCDTOTAL+121                                             03745000
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'                       03746000
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'                    03747000
SEQMSG   DC    CL43'1ICG903I INPUT FILE TRACEIN OUT OF SEQUENCE'        03748000
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '                     03749000
         DS    CL1                                                      03750000
FIXAREA  DS    CL200                                                    03751000
         ORG   FIXAREA                                                  03752000
@NM00134 DC    200CL1'Z'                                                03753000
         ORG   FIXAREA+200                                              03754000
SEC1ARRY DC    CL1'0'                                                   03755000
         DC    CL1'1'                                                   03756000
         DC    CL1'2'                                                   03757000
         DC    CL1'3'                                                   03758000
         DC    CL1'4'                                                   03759000
         DC    CL1'5'                                                   03760000
         DC    CL1'6'                                                   03761000
         DC    CL1'7'                                                   03762000
         DC    CL1'8'                                                   03763000
         DC    CL1'9'                                                   03764000
SEC3ARRY DC    CL5' 0- 2'                                               03765000
         DC    CL5' 3- 5'                                               03766000
         DC    CL5' 6- 8'                                               03767000
         DC    CL5' 9-11'                                               03768000
         DC    CL5'12-14'                                               03769000
         DC    CL5'15-17'                                               03770000
         DC    CL5'18-20'                                               03771000
         DC    CL5'21-23'                                               03772000
         DC    CL5'24-26'                                               03773000
         DC    CL5'27   '                                               03774000
SEC6ARRY DC    CL5' 0- 5'                                               03775000
         DC    CL5' 6-11'                                               03776000
         DC    CL5'12-17'                                               03777000
         DC    CL5'18-23'                                               03778000
         DC    CL5'24-29'                                               03779000
         DC    CL5'30-35'                                               03780000
         DC    CL5'36-41'                                               03781000
         DC    CL5'42-47'                                               03782000
         DC    CL5'48-53'                                               03783000
         DC    CL5'54   '                                               03784000
SSIDEQ   DC    CL1'0'                                                   03785000
         DC    CL1'1'                                                   03786000
         DC    CL1'2'                                                   03787000
         DC    CL1'3'                                                   03788000
         DC    CL1'4'                                                   03789000
         DC    CL1'5'                                                   03790000
         DC    CL1'6'                                                   03791000
         DC    CL1'7'                                                   03792000
         DC    CL1'8'                                                   03793000
         DC    CL1'9'                                                   03794000
         DC    CL1'A'                                                   03795000
         DC    CL1'B'                                                   03796000
         DC    CL1'C'                                                   03797000
         DC    CL1'D'                                                   03798000
         DC    CL1'E'                                                   03799000
         DC    CL1'F'                                                   03800000
ICGTRDST CSECT                                                          03801000
*                                                         /*@Y30LB40*/  03802000
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=72,    **03803000
               EODAD=EOF,EROPT=SKP,SYNAD=READERR                        03804000
IDCBL    EQU   *-IPATDCB                                                03805000
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121    03806000
PDCBL    EQU   *-PPATDCB                                                03807000
@DATD    DSECT                                                          03808000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03809000
@ENDDATD EQU   *                                                        03810000
ICGTRDST CSECT                                                          03811000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03812000
@01      EQU   01                                                       03813000
@02      EQU   02                                                       03814000
@03      EQU   03                                                       03815000
@04      EQU   04                                                       03816000
@05      EQU   05                                                       03817000
@06      EQU   06                                                       03818000
@07      EQU   07                                                       03819000
@08      EQU   08                                                       03820000
@09      EQU   09                                                       03821000
@10      EQU   10                                                       03822000
@11      EQU   11                                                       03823000
@12      EQU   12                                                       03824000
@13      EQU   13                                                       03825000
@14      EQU   14                                                       03826000
@15      EQU   15                                                       03827000
SS       EQU   @02                                                      03828000
LINECNT  EQU   @06                                                      03829000
PARMPTR  EQU   @07                                                      03830000
TIMEWORK EQU   @03                                                      03831000
SAVE14   EQU   @07                                                      03832000
R0       EQU   @00                                                      03833000
R1       EQU   @01                                                      03834000
R2       EQU   @02                                                      03835000
R3       EQU   @03                                                      03836000
ARRAYLOC EQU   @08                                                      03837000
R14      EQU   @14                                                      03838000
R15      EQU   @15                                                      03839000
IHADCB   EQU   0                                                        03840000
IHADCS05 EQU   0                                                        03841000
DCBMODE  EQU   IHADCS05                                                 03842000
DCBSTACK EQU   DCBMODE                                                  03843000
DCBFUNC  EQU   IHADCS05+3                                               03844000
IHADCS11 EQU   0                                                        03845000
DCBRELB  EQU   IHADCS11                                                 03846000
DCBREL   EQU   DCBRELB+1                                                03847000
DCBBUFCB EQU   IHADCS11+4                                               03848000
DCBDSORG EQU   IHADCS11+10                                              03849000
DCBDSRG1 EQU   DCBDSORG                                                 03850000
DCBDSRG2 EQU   DCBDSORG+1                                               03851000
DCBIOBAD EQU   IHADCS11+12                                              03852000
DCBODEB  EQU   DCBIOBAD                                                 03853000
DCBLNP   EQU   DCBODEB                                                  03854000
DCBQSLM  EQU   DCBLNP                                                   03855000
DCBIOBAA EQU   DCBODEB+1                                                03856000
IHADCS50 EQU   0                                                        03857000
DCBSVCXL EQU   IHADCS50                                                 03858000
DCBEODAD EQU   IHADCS50+4                                               03859000
DCBBFALN EQU   DCBEODAD                                                 03860000
DCBHIARC EQU   DCBBFALN                                                 03861000
DCBBFTEK EQU   DCBHIARC                                                 03862000
DCBBFT   EQU   DCBBFTEK                                                 03863000
DCBEXLST EQU   IHADCS50+8                                               03864000
DCBRECFM EQU   DCBEXLST                                                 03865000
DCBRECLA EQU   DCBRECFM                                                 03866000
IHADCS24 EQU   0                                                        03867000
DCBOFLGS EQU   IHADCS24+8                                               03868000
DCBOFLWR EQU   DCBOFLGS                                                 03869000
DCBIFLG  EQU   IHADCS24+9                                               03870000
DCBMACR  EQU   IHADCS24+10                                              03871000
DCBMACR1 EQU   DCBMACR                                                  03872000
DCBMRFE  EQU   DCBMACR1                                                 03873000
DCBMRGET EQU   DCBMRFE                                                  03874000
DCBMRAPG EQU   DCBMACR1                                                 03875000
DCBMRRD  EQU   DCBMRAPG                                                 03876000
DCBMRCI  EQU   DCBMACR1                                                 03877000
DCBMRMVG EQU   DCBMRCI                                                  03878000
DCBMRLCG EQU   DCBMACR1                                                 03879000
DCBMRABC EQU   DCBMACR1                                                 03880000
DCBMRPT1 EQU   DCBMRABC                                                 03881000
DCBMRSBG EQU   DCBMRPT1                                                 03882000
DCBMRCRL EQU   DCBMACR1                                                 03883000
DCBMRCHK EQU   DCBMRCRL                                                 03884000
DCBMRRDX EQU   DCBMRCHK                                                 03885000
DCBMRDMG EQU   DCBMACR1                                                 03886000
DCBMACR2 EQU   DCBMACR+1                                                03887000
DCBMRPUT EQU   DCBMACR2                                                 03888000
DCBMRWRT EQU   DCBMACR2                                                 03889000
DCBMRMVP EQU   DCBMACR2                                                 03890000
DCBMR5WD EQU   DCBMACR2                                                 03891000
DCBMRLDM EQU   DCBMR5WD                                                 03892000
DCBMRLCP EQU   DCBMRLDM                                                 03893000
DCBMR4WD EQU   DCBMACR2                                                 03894000
DCBMRPT2 EQU   DCBMR4WD                                                 03895000
DCBMRTMD EQU   DCBMRPT2                                                 03896000
DCBMR3WD EQU   DCBMACR2                                                 03897000
DCBMRCTL EQU   DCBMR3WD                                                 03898000
DCBMRSTK EQU   DCBMRCTL                                                 03899000
DCBMR1WD EQU   DCBMACR2                                                 03900000
DCBMRSWA EQU   DCBMR1WD                                                 03901000
DCBMRDMD EQU   DCBMRSWA                                                 03902000
IHADCS25 EQU   0                                                        03903000
DCBMACRF EQU   IHADCS25+2                                               03904000
DCBMACF1 EQU   DCBMACRF                                                 03905000
DCBMFFE  EQU   DCBMACF1                                                 03906000
DCBMFGET EQU   DCBMFFE                                                  03907000
DCBMFAPG EQU   DCBMACF1                                                 03908000
DCBMFRD  EQU   DCBMFAPG                                                 03909000
DCBMFCI  EQU   DCBMACF1                                                 03910000
DCBMFMVG EQU   DCBMFCI                                                  03911000
DCBMFLCG EQU   DCBMACF1                                                 03912000
DCBMFABC EQU   DCBMACF1                                                 03913000
DCBMFPT1 EQU   DCBMFABC                                                 03914000
DCBMFSBG EQU   DCBMFPT1                                                 03915000
DCBMFCRL EQU   DCBMACF1                                                 03916000
DCBMFCHK EQU   DCBMFCRL                                                 03917000
DCBMFDMG EQU   DCBMACF1                                                 03918000
DCBMACF2 EQU   DCBMACRF+1                                               03919000
DCBMFPUT EQU   DCBMACF2                                                 03920000
DCBMFWRT EQU   DCBMACF2                                                 03921000
DCBMFMVP EQU   DCBMACF2                                                 03922000
DCBMF5WD EQU   DCBMACF2                                                 03923000
DCBMFLDM EQU   DCBMF5WD                                                 03924000
DCBMFLCP EQU   DCBMFLDM                                                 03925000
DCBMF4WD EQU   DCBMACF2                                                 03926000
DCBMFPT2 EQU   DCBMF4WD                                                 03927000
DCBMFTMD EQU   DCBMFPT2                                                 03928000
DCBMF3WD EQU   DCBMACF2                                                 03929000
DCBMFCTL EQU   DCBMF3WD                                                 03930000
DCBMFSTK EQU   DCBMFCTL                                                 03931000
DCBMF1WD EQU   DCBMACF2                                                 03932000
DCBMFSWA EQU   DCBMF1WD                                                 03933000
DCBMFDMD EQU   DCBMFSWA                                                 03934000
DCBDEBAD EQU   IHADCS25+4                                               03935000
DCBIFLGS EQU   DCBDEBAD                                                 03936000
IHADCS26 EQU   0                                                        03937000
DCBWRITE EQU   IHADCS26                                                 03938000
DCBREAD  EQU   DCBWRITE                                                 03939000
DCBWRITA EQU   DCBREAD+1                                                03940000
IHADCS27 EQU   0                                                        03941000
DCBGET   EQU   IHADCS27                                                 03942000
DCBPUT   EQU   DCBGET                                                   03943000
DCBGETA  EQU   DCBPUT+1                                                 03944000
IHADCS36 EQU   0                                                        03945000
DCBGERR  EQU   IHADCS36                                                 03946000
DCBPERR  EQU   DCBGERR                                                  03947000
DCBCHECK EQU   DCBPERR                                                  03948000
DCBOPTCD EQU   DCBCHECK                                                 03949000
DCBOPTH  EQU   DCBOPTCD                                                 03950000
DCBOPTO  EQU   DCBOPTH                                                  03951000
DCBOPTZ  EQU   DCBOPTCD                                                 03952000
DCBGERRA EQU   DCBCHECK+1                                               03953000
DCBPERRA EQU   DCBGERRA                                                 03954000
DCBSYNAD EQU   IHADCS36+4                                               03955000
DCBCIND1 EQU   IHADCS36+8                                               03956000
DCBCIND2 EQU   IHADCS36+9                                               03957000
DCBIOBA  EQU   IHADCS36+16                                              03958000
DCBCICB  EQU   DCBIOBA                                                  03959000
IHADCS52 EQU   0                                                        03960000
DCBDIRCT EQU   IHADCS52                                                 03961000
DCBQSWS  EQU   DCBDIRCT                                                 03962000
DCBUSASI EQU   DCBQSWS                                                  03963000
DCBQADFS EQU   DCBUSASI                                                 03964000
DCBBUFOF EQU   DCBDIRCT+1                                               03965000
IHADCS37 EQU   0                                                        03966000
DCBFLAG1 EQU   IHADCS37                                                 03967000
IHADCS38 EQU   0                                                        03968000
DCBEOBR  EQU   IHADCS38                                                 03969000
DCBPOINT EQU   IHADCS38+12                                              03970000
DCBCNTRL EQU   DCBPOINT                                                 03971000
IHADCS40 EQU   0                                                        03972000
DCBEOBAD EQU   IHADCS40                                                 03973000
DCBCCCW  EQU   IHADCS40+4                                               03974000
DCBRECAD EQU   DCBCCCW                                                  03975000
DCBRECBT EQU   DCBRECAD                                                 03976000
DCBRCREL EQU   DCBRECBT                                                 03977000
@NM00026 EQU   IHADCS40+12                                              03978000
DCBEROPT EQU   @NM00026                                                 03979000
PARMVALS EQU   0                                                        03980000
PARMLEN  EQU   PARMVALS                                                 03981000
PARMS    EQU   PARMVALS+2                                               03982000
RWARRAY  EQU   0                                                        03983000
RWENTS   EQU   RWARRAY                                                  03984000
RWA      EQU   0                                                        03985000
RWB1     EQU   RWA                                                      03986000
RWB2     EQU   RWA+4                                                    03987000
RWB3     EQU   RWA+8                                                    03988000
RWB4     EQU   RWA+12                                                   03989000
RWB5     EQU   RWA+16                                                   03990000
RWB6     EQU   RWA+20                                                   03991000
RWB7     EQU   RWA+24                                                   03992000
RWB8     EQU   RWA+28                                                   03993000
RWB9     EQU   RWA+32                                                   03994000
DSARRAY  EQU   0                                                        03995000
DSENTS   EQU   DSARRAY                                                  03996000
DSA      EQU   0                                                        03997000
DSB1     EQU   DSA                                                      03998000
DSB2     EQU   DSA+4                                                    03999000
DSB3     EQU   DSA+8                                                    04000000
DSB4     EQU   DSA+12                                                   04001000
DSB5     EQU   DSA+16                                                   04002000
DSB6     EQU   DSA+20                                                   04003000
DSB7     EQU   DSA+24                                                   04004000
DSB8     EQU   DSA+28                                                   04005000
DSB9     EQU   DSA+32                                                   04006000
DSB10    EQU   DSA+36                                                   04007000
DSB11    EQU   DSA+40                                                   04008000
FIXADDR  EQU   0                                                        04009000
FIXLEN   EQU   0                                                        04010000
FIXOPT   EQU   0                                                        04011000
DSS1     EQU   0                                                        04012000
DSS2     EQU   0                                                        04013000
DSS3     EQU   0                                                        04014000
RWS1     EQU   0                                                        04015000
RWS2     EQU   0                                                        04016000
RWS3     EQU   0                                                        04017000
RWS4     EQU   0                                                        04018000
SLN      EQU   0                                                        04019000
DSTLINE  EQU   DSLINE                                                   04020000
DSTFLD2  EQU   DSTLINE+6                                                04021000
DSTFLD4  EQU   DSTLINE+16                                               04022000
DSTFLD6  EQU   DSTLINE+24                                               04023000
DSTFLD8  EQU   DSTLINE+33                                               04024000
DSTFLD10 EQU   DSTLINE+42                                               04025000
DSTFLD12 EQU   DSTLINE+51                                               04026000
DSTFLD14 EQU   DSTLINE+60                                               04027000
DSTFLD16 EQU   DSTLINE+70                                               04028000
DSTFLD18 EQU   DSTLINE+78                                               04029000
DSTFLD20 EQU   DSTLINE+87                                               04030000
DSTFLD22 EQU   DSTLINE+96                                               04031000
DSTFLD24 EQU   DSTLINE+105                                              04032000
DSTFLD26 EQU   DSTLINE+114                                              04033000
RWLINE   EQU   DSLINE                                                   04034000
RWFLD2   EQU   RWLINE+1                                                 04035000
RWFLD2A  EQU   RWLINE+8                                                 04036000
RWFLD4   EQU   RWLINE+18                                                04037000
DRDSSID  EQU   RWLINE+21                                                04038000
CHAR2    EQU   DRDSSID                                                  04039000
DRDMSFID EQU   DRDSSID+1                                                04040000
RWFLD6   EQU   DRDSSID+2                                                04041000
RWFLD8   EQU   RWLINE+28                                                04042000
RWFLD10  EQU   RWLINE+34                                                04043000
RWFLD11  EQU   RWLINE+47                                                04044000
RWFLD20  EQU   RWLINE+50                                                04045000
RWFLD22  EQU   RWLINE+59                                                04046000
RWFLD23  EQU   RWLINE+73                                                04047000
RWFLD24  EQU   RWLINE+79                                                04048000
RWTLINE  EQU   DSLINE                                                   04049000
RWTFLD2  EQU   RWTLINE+9                                                04050000
RWTFLD4  EQU   RWTLINE+18                                               04051000
RWTFLD6  EQU   RWTLINE+26                                               04052000
RWTFLD8  EQU   RWTLINE+36                                               04053000
RWTFLD10 EQU   RWTLINE+45                                               04054000
RWTFLD12 EQU   RWTLINE+55                                               04055000
RWTFLD14 EQU   RWTLINE+63                                               04056000
*                                      START UNREFERENCED COMPONENTS    04057000
@NM00077 EQU   RWTLINE+69                                               04058000
@NM00076 EQU   RWTLINE+61                                               04059000
@NM00075 EQU   RWTLINE+52                                               04060000
@NM00074 EQU   RWTLINE+42                                               04061000
@NM00073 EQU   RWTLINE+33                                               04062000
@NM00072 EQU   RWTLINE+24                                               04063000
@NM00071 EQU   RWTLINE+15                                               04064000
@NM00070 EQU   RWTLINE+1                                                04065000
RWTFLD0  EQU   RWTLINE                                                  04066000
@NM00069 EQU   RWLINE+85                                                04067000
@NM00068 EQU   RWLINE+78                                                04068000
@NM00067 EQU   RWLINE+66                                                04069000
@NM00066 EQU   RWLINE+57                                                04070000
@NM00065 EQU   RWLINE+48                                                04071000
@NM00064 EQU   RWLINE+39                                                04072000
@NM00063 EQU   RWLINE+33                                                04073000
@NM00062 EQU   RWLINE+24                                                04074000
@NM00061 EQU   RWLINE+19                                                04075000
@NM00060 EQU   RWLINE+16                                                04076000
@NM00059 EQU   RWLINE+7                                                 04077000
RWFLD1   EQU   RWLINE                                                   04078000
@NM00058 EQU   DSTLINE+120                                              04079000
@NM00057 EQU   DSTLINE+111                                              04080000
@NM00056 EQU   DSTLINE+102                                              04081000
@NM00055 EQU   DSTLINE+93                                               04082000
@NM00054 EQU   DSTLINE+84                                               04083000
@NM00053 EQU   DSTLINE+76                                               04084000
@NM00052 EQU   DSTLINE+66                                               04085000
@NM00051 EQU   DSTLINE+57                                               04086000
@NM00050 EQU   DSTLINE+48                                               04087000
@NM00049 EQU   DSTLINE+39                                               04088000
@NM00048 EQU   DSTLINE+30                                               04089000
@NM00047 EQU   DSTLINE+22                                               04090000
@NM00046 EQU   DSTLINE+12                                               04091000
@NM00045 EQU   DSTLINE+1                                                04092000
DSTFLD1  EQU   DSTLINE                                                  04093000
DCBEOB   EQU   IHADCS40+20                                              04094000
DCBPRECL EQU   IHADCS40+18                                              04095000
@NM00029 EQU   IHADCS40+16                                              04096000
@NM00028 EQU   @NM00026+1                                               04097000
@NM00027 EQU   DCBEROPT                                                 04098000
DCBERABE EQU   DCBEROPT                                                 04099000
DCBERSKP EQU   DCBEROPT                                                 04100000
DCBERACC EQU   DCBEROPT                                                 04101000
@NM00025 EQU   IHADCS40+10                                              04102000
@NM00024 EQU   IHADCS40+9                                               04103000
@NM00023 EQU   IHADCS40+8                                               04104000
DCBRECA  EQU   DCBRECAD+1                                               04105000
@NM00022 EQU   DCBRECBT                                                 04106000
DCBRCFGT EQU   DCBRCREL                                                 04107000
DCBRCTRU EQU   DCBRCREL                                                 04108000
DCBLCCW  EQU   DCBEOBAD                                                 04109000
DCBNOTE  EQU   DCBCNTRL                                                 04110000
DCBLRECL EQU   IHADCS38+10                                              04111000
@NM00021 EQU   IHADCS38+8                                               04112000
DCBEOBW  EQU   IHADCS38+4                                               04113000
DCBEOBRA EQU   DCBEOBR+1                                                04114000
DCBNCP   EQU   DCBEOBR                                                  04115000
@NM00020 EQU   DCBFLAG1                                                 04116000
DCBSTFLS EQU   DCBFLAG1                                                 04117000
DCBSTQCK EQU   DCBFLAG1                                                 04118000
DCBDIRCQ EQU   DCBBUFOF                                                 04119000
DCBQSTRU EQU   DCBUSASI                                                 04120000
@NM00019 EQU   DCBUSASI                                                 04121000
DCBQADF3 EQU   DCBQADFS                                                 04122000
DCBQADF2 EQU   DCBQADFS                                                 04123000
DCBQADF1 EQU   DCBQADFS                                                 04124000
DCBBLBP  EQU   DCBUSASI                                                 04125000
@NM00018 EQU   DCBUSASI                                                 04126000
DCBCICBA EQU   DCBCICB+1                                                04127000
@NM00017 EQU   DCBCICB                                                  04128000
DCBOFFSW EQU   IHADCS36+15                                              04129000
DCBOFFSR EQU   IHADCS36+14                                              04130000
DCBWCPL  EQU   IHADCS36+13                                              04131000
DCBWCPO  EQU   IHADCS36+12                                              04132000
DCBBLKSI EQU   IHADCS36+10                                              04133000
DCBCNQSM EQU   DCBCIND2                                                 04134000
DCBCNFEO EQU   DCBCIND2                                                 04135000
DCBCNCHS EQU   DCBCIND2                                                 04136000
DCBCNBFP EQU   DCBCIND2                                                 04137000
DCBCNIOE EQU   DCBCIND2                                                 04138000
DCBCNCLO EQU   DCBCIND2                                                 04139000
DCBCNWRO EQU   DCBCIND2                                                 04140000
DCBCNSTO EQU   DCBCIND2                                                 04141000
DCBCNEXB EQU   DCBCIND1                                                 04142000
@NM00016 EQU   DCBCIND1                                                 04143000
DCBCNBRM EQU   DCBCIND1                                                 04144000
@NM00015 EQU   DCBCIND1                                                 04145000
DCBCNEVA EQU   DCBCIND1                                                 04146000
DCBCNEVB EQU   DCBCIND1                                                 04147000
DCBCNSRD EQU   DCBCIND1                                                 04148000
DCBCNTOV EQU   DCBCIND1                                                 04149000
DCBSYNA  EQU   DCBSYNAD+1                                               04150000
DCBIOBL  EQU   DCBSYNAD                                                 04151000
DCBCHCKA EQU   DCBPERRA                                                 04152000
@NM00014 EQU   DCBOPTCD                                                 04153000
DCBOPTT  EQU   DCBOPTCD                                                 04154000
DCBSRCHD EQU   DCBOPTZ                                                  04155000
DCBOPTQ  EQU   DCBOPTCD                                                 04156000
DCBBCKPT EQU   DCBOPTO                                                  04157000
DCBOPTC  EQU   DCBOPTCD                                                 04158000
DCBOPTU  EQU   DCBOPTCD                                                 04159000
DCBOPTW  EQU   DCBOPTCD                                                 04160000
DCBPUTA  EQU   DCBGETA                                                  04161000
@NM00013 EQU   DCBPUT                                                   04162000
DCBREADA EQU   DCBWRITA                                                 04163000
@NM00012 EQU   DCBREAD                                                  04164000
DCBDEBA  EQU   DCBDEBAD+1                                               04165000
@NM00011 EQU   DCBIFLGS                                                 04166000
DCBIFIOE EQU   DCBIFLGS                                                 04167000
DCBIFPCT EQU   DCBIFLGS                                                 04168000
DCBIFEC  EQU   DCBIFLGS                                                 04169000
DCBMFSTI EQU   DCBMFDMD                                                 04170000
DCBMFAWR EQU   DCBMFSTK                                                 04171000
DCBMFUIP EQU   DCBMFTMD                                                 04172000
DCBMFIDW EQU   DCBMFLCP                                                 04173000
DCBMFWRK EQU   DCBMFMVP                                                 04174000
DCBMFRDQ EQU   DCBMFWRT                                                 04175000
DCBMFGTQ EQU   DCBMFPUT                                                 04176000
DCBMFSTL EQU   DCBMACF2                                                 04177000
DCBMFCK  EQU   DCBMFDMG                                                 04178000
DCBMFRDX EQU   DCBMFCHK                                                 04179000
DCBMFDBF EQU   DCBMFSBG                                                 04180000
DCBMFRDI EQU   DCBMFLCG                                                 04181000
DCBMFRDK EQU   DCBMFMVG                                                 04182000
DCBMFWRQ EQU   DCBMFRD                                                  04183000
DCBMFPTQ EQU   DCBMFGET                                                 04184000
DCBMFECP EQU   DCBMACF1                                                 04185000
DCBTIOT  EQU   IHADCS25                                                 04186000
DCBMRSTI EQU   DCBMRDMD                                                 04187000
DCBMRAWR EQU   DCBMRSTK                                                 04188000
DCBMRUIP EQU   DCBMRTMD                                                 04189000
DCBMRIDW EQU   DCBMRLCP                                                 04190000
DCBMRWRK EQU   DCBMRMVP                                                 04191000
DCBMRRDQ EQU   DCBMRWRT                                                 04192000
DCBMRGTQ EQU   DCBMRPUT                                                 04193000
DCBMRSTL EQU   DCBMACR2                                                 04194000
DCBMRCK  EQU   DCBMRDMG                                                 04195000
DCBPGFXA EQU   DCBMRRDX                                                 04196000
DCBMRDBF EQU   DCBMRSBG                                                 04197000
DCBMRRDI EQU   DCBMRLCG                                                 04198000
DCBMRRDK EQU   DCBMRMVG                                                 04199000
DCBMRWRQ EQU   DCBMRRD                                                  04200000
DCBMRPTQ EQU   DCBMRGET                                                 04201000
DCBMRECP EQU   DCBMACR1                                                 04202000
@NM00010 EQU   DCBIFLG                                                  04203000
DCBIBIOE EQU   DCBIFLG                                                  04204000
DCBIBPCT EQU   DCBIFLG                                                  04205000
DCBIBEC  EQU   DCBIFLG                                                  04206000
DCBOFIOF EQU   DCBOFLGS                                                 04207000
DCBOFUEX EQU   DCBOFLGS                                                 04208000
DCBOFTM  EQU   DCBOFLGS                                                 04209000
DCBOFPPC EQU   DCBOFLGS                                                 04210000
DCBOFOPN EQU   DCBOFLGS                                                 04211000
DCBOFEOV EQU   DCBOFLGS                                                 04212000
DCBOFLRB EQU   DCBOFLGS                                                 04213000
DCBOFIOD EQU   DCBOFLWR                                                 04214000
DCBDDNAM EQU   IHADCS24                                                 04215000
DCBEXLSA EQU   DCBEXLST+1                                               04216000
DCBRECKL EQU   DCBRECFM                                                 04217000
DCBRECCC EQU   DCBRECFM                                                 04218000
DCBRECSB EQU   DCBRECFM                                                 04219000
DCBRECBR EQU   DCBRECFM                                                 04220000
DCBRECTO EQU   DCBRECLA                                                 04221000
DCBRECL  EQU   DCBRECLA                                                 04222000
DCBEODA  EQU   DCBEODAD+1                                               04223000
DCBBFA   EQU   DCBBFTEK                                                 04224000
DCBH0    EQU   DCBBFTEK                                                 04225000
DCBBFTKD EQU   DCBBFTEK                                                 04226000
DCBBFTE  EQU   DCBBFT                                                   04227000
DCBBFTKR EQU   DCBBFT                                                   04228000
DCBBFTS  EQU   DCBBFT                                                   04229000
DCBH1    EQU   DCBBFTEK                                                 04230000
DCBSVCXA EQU   DCBSVCXL+1                                               04231000
@NM00009 EQU   DCBSVCXL                                                 04232000
DCBODEBA EQU   DCBIOBAA                                                 04233000
@NM00008 EQU   DCBQSLM                                                  04234000
DCBUPDBT EQU   DCBQSLM                                                  04235000
DCBUPDCM EQU   DCBQSLM                                                  04236000
DCB1DVDS EQU   DCBQSLM                                                  04237000
@NM00007 EQU   DCBDSRG2                                                 04238000
DCBDSGTR EQU   DCBDSRG2                                                 04239000
DCBACBM  EQU   DCBDSRG2                                                 04240000
@NM00006 EQU   DCBDSRG2                                                 04241000
DCBDSGTQ EQU   DCBDSRG2                                                 04242000
DCBDSGTX EQU   DCBDSRG2                                                 04243000
DCBDSGGS EQU   DCBDSRG2                                                 04244000
DCBDSGU  EQU   DCBDSRG1                                                 04245000
DCBDSGPO EQU   DCBDSRG1                                                 04246000
DCBDSGMQ EQU   DCBDSRG1                                                 04247000
DCBDSGCQ EQU   DCBDSRG1                                                 04248000
DCBDSGCX EQU   DCBDSRG1                                                 04249000
DCBDSGDA EQU   DCBDSRG1                                                 04250000
DCBDSGPS EQU   DCBDSRG1                                                 04251000
DCBDSGIS EQU   DCBDSRG1                                                 04252000
DCBBUFL  EQU   IHADCS11+8                                               04253000
DCBBUFCA EQU   DCBBUFCB+1                                               04254000
DCBBUFNO EQU   DCBBUFCB                                                 04255000
DCBDEVT  EQU   DCBREL                                                   04256000
DCBKEYLE EQU   DCBRELB                                                  04257000
@NM00005 EQU   DCBFUNC                                                  04258000
DCBFNCBT EQU   DCBFUNC                                                  04259000
DCBFNCBX EQU   DCBFUNC                                                  04260000
DCBFNCBD EQU   DCBFUNC                                                  04261000
DCBFNCBW EQU   DCBFUNC                                                  04262000
DCBFNCBP EQU   DCBFUNC                                                  04263000
DCBFNCBR EQU   DCBFUNC                                                  04264000
DCBFNCBI EQU   DCBFUNC                                                  04265000
@NM00004 EQU   IHADCS05+2                                               04266000
@NM00003 EQU   IHADCS05+1                                               04267000
DCBSTCK1 EQU   DCBSTACK                                                 04268000
DCBSTCK2 EQU   DCBSTACK                                                 04269000
@NM00002 EQU   DCBSTACK                                                 04270000
DCBMODER EQU   DCBSTACK                                                 04271000
DCBMODEO EQU   DCBSTACK                                                 04272000
DCBMODEE EQU   DCBSTACK                                                 04273000
DCBMODEC EQU   DCBSTACK                                                 04274000
@NM00001 EQU   IHADCB                                                   04275000
*                                      END UNREFERENCED COMPONENTS      04276000
@RT00166 EQU   PARMEND                                                  04277000
@RT00198 EQU   PARMEND                                                  04278000
@RT00218 EQU   PARMEND                                                  04279000
@RF00233 EQU   @RC00231                                                 04280000
@RF00243 EQU   @RC00241                                                 04281000
@RT00257 EQU   PARMEND                                                  04282000
@RT00270 EQU   PARMEND                                                  04283000
@RT00299 EQU   PARMEND                                                  04284000
@RC00307 EQU   @RC00305                                                 04285000
@RT00363 EQU   RDTRACE                                                  04286000
@RT00368 EQU   RDTRACE                                                  04287000
@RT00372 EQU   RDTRACE                                                  04288000
@RT00375 EQU   RDTRACE                                                  04289000
@RT00394 EQU   ROUTINE2                                                 04290000
@RT00396 EQU   DSCTLBRK                                                 04291000
@RT00623 EQU   EOJ                                                      04292000
@RT00633 EQU   RWCTLBRK                                                 04293000
@RT00809 EQU   EOJ                                                      04294000
@RT00818 EQU   DSCTLBRK                                                 04295000
@RF00818 EQU   RWCTLBRK                                                 04296000
@RC00847 EQU   @RC00846                                                 04297000
@RT00920 EQU   EF4                                                      04298000
EFEND    EQU   @EL00003                                                 04299000
@RC00936 EQU   @EL00006                                                 04300000
@RT00918 EQU   EFEND                                                    04301000
@ENDDATA EQU   *                                                        04302000
         END   ICGTRDST,(C'PLS1209',0603,77089)                         04303000
./  ADD  SSI=73540137,NAME=ICGTRINT
         TITLE '***** ICGTRINT - MSS TRACE DATA INTERPRET AND REFORMAT *00001000
                *****   '                                               00002000
ICGTRINT CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGTRINT  77.354'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         LA    @09,4095(,@10)                                      0001 00014000
         USING @PSTART,@12                                         0001 00015000
         USING @PSTART+4095,@11                                    0001 00016000
         USING @PSTART+8190,@10                                    0001 00017000
         USING @PSTART+12285,@09                                   0001 00018000
         L     @00,@SIZDATD                                        0001 00019000
         GETMAIN  R,LV=(0)                                              00020000
         LR    @08,@01                                             0001 00021000
         USING @DATD,@08                                           0001 00022000
         ST    @13,@SA00001+4                                      0001 00023000
         LM    @00,@01,20(@13)                                     0001 00024000
         ST    @08,8(,@13)                                         0001 00025000
         LR    @13,@08                                             0001 00026000
         L     R1,0(R1)                                                 00027000
*   PARMPTR=R1;                     /* SAVE PARMS ADDRESS    @Y30LB40*/ 00028000
         LR    PARMPTR,R1                                          0156 00029000
*   RFY                                                            0157 00030000
*     R1 UNRSTD;                    /*                       @Y30LB40*/ 00031000
*   CALL INIT;                      /* INITIALIZE VALUES     @OZ05079*/ 00032000
         BAL   @14,INIT                                            0158 00033000
*   CALL OPENFILE;                  /* OPEN SYSPRINT, TRACEIN      0159 00034000
*                                                            @OZ05079*/ 00035000
         BAL   @14,OPENFILE                                        0159 00036000
*   IF RETURNCD=4                   /* SYSPRINT NOT OPEN     @OZ05079*/ 00037000
*     THEN                          /*                       @OZ05079*/ 00038000
         CLC   RETURNCD(2),@CH00104                                0160 00039000
         BNE   @RF00160                                            0160 00040000
*     RETURN CODE(4);               /* RETURN, NO MESSAGE    @OZ05079*/ 00041000
         L     @13,4(,@13)                                         0161 00042000
         L     @00,@SIZDATD                                        0161 00043000
         LR    @01,@08                                             0161 00044000
         FREEMAIN R,LV=(0),A=(1)                                        00045000
         LA    @15,4                                               0161 00046000
         L     @14,12(,@13)                                        0161 00047000
         LM    @00,@12,20(@13)                                     0161 00048000
         BR    @14                                                 0161 00049000
*   ELSE                            /*                       @OZ05079*/ 00050000
*     IF RETURNCD=8                 /* TRACEIN NOT OPENED    @OZ05079*/ 00051000
*       THEN                        /*                       @OZ05079*/ 00052000
@RF00160 CLC   RETURNCD(2),@CH00036                                0162 00053000
         BE    @RT00162                                            0162 00054000
*       GO TO CLOSEFIL;             /* CLOSE SYSPRINT        @OZ05079*/ 00055000
*   IF PARMLEN¬=0                   /* CHECK IF ANY PARMS    @OZ05079*/ 00056000
*     THEN                          /*                       @OZ05079*/ 00057000
         LH    @06,PARMLEN(,PARMPTR)                               0164 00058000
         LTR   @06,@06                                             0164 00059000
         BZ    @RF00164                                            0164 00060000
*     CALL GETPARMS;                /* IF ANY, GET THEM      @OZ05079*/ 00061000
         BAL   @14,GETPARMS                                        0165 00062000
*   IF RETURNCD=8                   /* INVALID PARMS FOUND   @OZ05079*/ 00063000
*     THEN                          /*                       @OZ05079*/ 00064000
@RF00164 CLC   RETURNCD(2),@CH00036                                0166 00065000
         BE    @RT00166                                            0166 00066000
*     GO TO CLOSEFIL;               /* CLOSE OPEN FILES      @OZ05079*/ 00067000
*   ELSE                            /*                       @OZ05079*/ 00068000
*     IF PARMSW='R'|PARMSW='B'      /* REFORMAT WANTED       @OZ05079*/ 00069000
*       THEN                        /*                       @OZ05079*/ 00070000
         CLI   PARMSW,C'R'                                         0168 00071000
         BE    @RT00168                                            0168 00072000
         CLI   PARMSW,C'B'                                         0168 00073000
         BNE   @RF00168                                            0168 00074000
@RT00168 DS    0H                                                  0169 00075000
*       CALL OPENOUT;               /* OPEN TRACEOUT FILE    @OZ05079*/ 00076000
         BAL   @14,OPENOUT                                         0169 00077000
*   IF RETURNCD=8                   /* TRACEOUT OPEN FAIL    @OZ05079*/ 00078000
*     THEN                          /*                       @OZ05079*/ 00079000
@RF00168 CLC   RETURNCD(2),@CH00036                                0170 00080000
         BE    @RT00170                                            0170 00081000
*     GO TO CLOSEFIL;               /* CLOSE OPEN FILES      @OZ05079*/ 00082000
*   ELSE                                                           0172 00083000
*     ;                             /*                       @OZ05079*/ 00084000
*   RFY                                                            0173 00085000
*    (R0,                                                          0173 00086000
*     R1) RSTD;                     /* GET AND CONVERT TODAYS DATE 0173 00087000
*                                                            @Y30LB40*/ 00088000
*   GEN(TIME);                      /*                       @Y30LB40*/ 00089000
         TIME                                                           00090000
*   GEN(ST    R1,DOUBLEWD);         /*                       @Y30LB40*/ 00091000
         ST    R1,DOUBLEWD                                              00092000
*   RFY                                                            0176 00093000
*    (R0,                                                          0176 00094000
*     R1) UNRSTD;                   /*                       @Y30LB40*/ 00095000
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @Y30LB40*/ 00096000
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0177 00097000
*                                                                  0178 00098000
*/********************************************************** @OZ05079*/ 00099000
*/*                                                          @OZ05079*/ 00100000
*/* PROCEDURE NAME - RDTRACE (SUBSECTION OF MAINLINE)        @OZ05079*/ 00101000
*/*                                                          @OZ05079*/ 00102000
*/* FUNCTION - READ A RECORD FROM TRACEIN, AND DETERMINE     @OZ05079*/ 00103000
*/*            WHAT PROCESSING (IF ANY) IS TO BE PERFORMED.  @OZ05079*/ 00104000
*/*            CONTINUE READING RECORDS UNTIL END-OF-FILE    @OZ05079*/ 00105000
*/*            IS ENCOUNTERED, AT WHICH POINT BRANCH (VIA    @OZ05079*/ 00106000
*/*            IOS LOGIC) TO ROUTINE 'EOJ'.                  @OZ05079*/ 00107000
*/*                                                          @OZ05079*/ 00108000
*/********************************************************** @OZ05079*/ 00109000
*                                                                  0178 00110000
*RDTRACE:                           /* READ A RECORD AND COUNT IT  0178 00111000
*                                                            @Y30LB40*/ 00112000
*   RFY                                                            0178 00113000
*    (R0,                                                          0178 00114000
*     R1,                                                          0178 00115000
*     R14,                                                         0178 00116000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00117000
RDTRACE  DS    0H                                                  0179 00118000
*   GEN(GET   INDCB,RECIN);         /*                       @Y30LB40*/ 00119000
         GET   INDCB,RECIN                                              00120000
*   RFY                                                            0180 00121000
*    (R0,                                                          0180 00122000
*     R1,                                                          0180 00123000
*     R14,                                                         0180 00124000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00125000
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT INPUT RECORDS   @Y30LB40*/ 00126000
         LA    @06,1                                               0181 00127000
         AL    @06,RCDCOUNT                                        0181 00128000
         ST    @06,RCDCOUNT                                        0181 00129000
*   IF TID¬=XID&                    /* CHECK TO SEE IF THE   @OZ11006*/ 00130000
*       TID¬=YID|                   /*                       @OZ11006*/ 00131000
*       CYL<LCYL|                   /* RECORD IS A VALID RECORD    0182 00132000
*                                                            @YM31057*/ 00133000
*       HEAD<LHD|                   /* BY CHECKING THE TABLE ID    0182 00134000
*                                                            @YM31057*/ 00135000
*       RECORD<LRD|                 /* AND THE CHR RANGE     @YM31057*/ 00136000
*       CYL>HCYL|                   /*                       @YM31057*/ 00137000
*       HEAD>HHD|                   /*                       @YM31057*/ 00138000
*       RECORD>HRD                  /*                       @YM31057*/ 00139000
*     THEN                          /*                       @YM31057*/ 00140000
         CLI   TID,192                                             0182 00141000
         BE    @GL00006                                            0182 00142000
         CLI   TID,128                                             0182 00143000
         BNE   @RT00182                                            0182 00144000
@GL00006 CLI   CYL,32                                              0182 00145000
         BL    @RT00182                                            0182 00146000
         CLI   RECORD,1                                            0182 00147000
         BL    @RT00182                                            0182 00148000
         CLI   CYL,39                                              0182 00149000
         BH    @RT00182                                            0182 00150000
         CLI   HEAD,18                                             0182 00151000
         BH    @RT00182                                            0182 00152000
         CLI   RECORD,32                                           0182 00153000
         BH    @RT00182                                            0182 00154000
*     GO TO RDTRACE;                /* GO TO NEXT ROUTINE    @YM31057*/ 00155000
*   IF LIBRID='11111111'B           /* IF TRAILER RECORD     @OZ05079*/ 00156000
*       &PARMSW¬='R'                /* NOT REFORMAT ONLY     @OZ05079*/ 00157000
*     THEN                          /*                       @OZ05079*/ 00158000
         CLI   LIBRID,B'11111111'                                  0184 00159000
         BNE   @RF00184                                            0184 00160000
         CLI   PARMSW,C'R'                                         0184 00161000
         BE    @RF00184                                            0184 00162000
*     DO;                           /*                       @OZ05079*/ 00163000
*       CALL BLOCK;                 /* PRINT FILE TRAILER    @OZ05079*/ 00164000
         BAL   @14,BLOCK                                           0186 00165000
*       GO TO RDTRACE;              /* READ ANOTHER RECORD   @OZ05079*/ 00166000
         B     RDTRACE                                             0187 00167000
*     END;                          /*                       @OZ05079*/ 00168000
*   IF LIBRID='10000000'B           /* HEADER RECORD         @Y30LB40*/ 00169000
*     THEN                                                         0189 00170000
@RF00184 CLI   LIBRID,B'10000000'                                  0189 00171000
         BNE   @RF00189                                            0189 00172000
*     DO;                           /*                       @Y30LB40*/ 00173000
*       CALL PROCREC6;              /* PROCESS FILE HEADER   @OZ05079*/ 00174000
         BAL   @14,PROCREC6                                        0191 00175000
*       GO TO RDTRACE;              /* READ ANOTHER RECORD   @OZ05079*/ 00176000
         B     RDTRACE                                             0192 00177000
*     END;                          /*                       @OZ05079*/ 00178000
*   ELSE                                                           0194 00179000
*     ;                             /*                       @OZ05079*/ 00180000
@RF00189 DS    0H                                                  0195 00181000
*   IF IMLCNT<IMLSAVE               /* CHECK FOR MATCHING IML COUNT     00182000
*                                                            @ZA25867*/ 00183000
*     THEN                          /*                       @ZA25867*/ 00184000
         CLC   IMLCNT(2),IMLSAVE                                   0195 00185000
         BNL   @RF00195                                            0195 00186000
*     DO;                           /*                       @ZA25867*/ 00187000
*       IMLFLAG=FLAGONE;            /*                       @ZA25867*/ 00188000
         MVC   IMLFLAG(1),FLAGONE                                  0197 00189000
*       GO TO RDTRACE;              /* SKIP RECORD IF NO MATCH     0198 00190000
*                                                            @ZA25867*/ 00191000
         B     RDTRACE                                             0198 00192000
*     END;                          /*                       @ZA25867*/ 00193000
*/*  ******************************************************* @ZA13497*/ 00194000
*/*   IF SELECT SPECIFIC VOLID OR SDG SPECIFIED, CHECK       @ZA13497*/ 00195000
*/*   FOR MATCH TO SELECTED ITEM.  IF NO MATCH, READ         @ZA13497*/ 00196000
*/*   NEXT RECORD.                                           @ZA13497*/ 00197000
*/*  ******************************************************* @ZA13497*/ 00198000
*                                                                  0200 00199000
*   RSPINDGP(1)='0'B;               /*                       @ZA13497*/ 00200000
@RF00195 DS    0H                                                  0201 00201000
*   RSPINDGP(2)='0'B;               /*                       @ZA13497*/ 00202000
*   RSPINDGP(3)='0'B;               /*                       @ZA13497*/ 00203000
         NI    RSPINDGP,B'00011111'                                0202 00204000
*   IF SDGSELSW='1'B                /*                       @ZA13497*/ 00205000
*     THEN                          /*                       @ZA13497*/ 00206000
         TM    SDGSELSW,B'10000000'                                0203 00207000
         BNO   @RF00203                                            0203 00208000
*     IF HOLDSDG¬=RSPINDGP          /*                       @ZA13497*/ 00209000
*       THEN                        /*                       @ZA13497*/ 00210000
         CLC   HOLDSDG(1),RSPINDGP                                 0204 00211000
         BNE   @RT00204                                            0204 00212000
*       GO TO RDTRACE;              /*                       @ZA13497*/ 00213000
*   IF VOLSELSW='1'B                /*                       @ZA13497*/ 00214000
*       &HOLDVOL(1:1+LENVOLID)¬=VOLID/*                      @ZA13497*/ 00215000
*     THEN                          /*                       @ZA13497*/ 00216000
@RF00203 TM    VOLSELSW,B'10000000'                                0206 00217000
         BNO   @RF00206                                            0206 00218000
         LH    @06,LENVOLID                                        0206 00219000
         EX    @06,@SC01278                                        0206 00220000
         BNE   @RT00206                                            0206 00221000
*     GO TO RDTRACE;                /*                       @ZA13497*/ 00222000
*   IF MINIPTR='00000000'B          /* IF CURRENT MINIPTR 0 BYPASS 0208 00223000
*                                      RECORD                        */ 00224000
*     THEN                                                         0208 00225000
@RF00206 CLI   MINIPTR,B'00000000'                                 0208 00226000
         BE    @RT00208                                            0208 00227000
*     GO TO RDTRACE;                /*                       @Y30LB40*/ 00228000
*   IF PARMSW='I'                   /* INTERPRET ONLY        @Y30LB40*/ 00229000
*     THEN                          /*                       @OZ05079*/ 00230000
         CLI   PARMSW,C'I'                                         0210 00231000
         BNE   @RF00210                                            0210 00232000
*     DO;                           /*                       @OZ05079*/ 00233000
*       CALL BLOCK;                 /* PRINT                 @OZ05079*/ 00234000
         BAL   @14,BLOCK                                           0212 00235000
*       GO TO RDTRACE;              /* READ ANOTHER RECORD   @OZ05079*/ 00236000
         B     RDTRACE                                             0213 00237000
*     END;                          /*                       @OZ05079*/ 00238000
*   ELSE                            /*                       @OZ05079*/ 00239000
*     DO;                           /*                       @OZ05079*/ 00240000
@RF00210 DS    0H                                                  0216 00241000
*       CALL REFORMAT;              /* BUILD OUTPUT RECORD   @OZ05079*/ 00242000
         BAL   @14,REFORMAT                                        0216 00243000
*       IF PARMSW='B'               /* IF INTERPRET ALSO     @OZ05079*/ 00244000
*         THEN                      /*                       @OZ05079*/ 00245000
         CLI   PARMSW,C'B'                                         0217 00246000
         BNE   @RF00217                                            0217 00247000
*         CALL BLOCK;               /* PRINT                 @OZ05079*/ 00248000
         BAL   @14,BLOCK                                           0218 00249000
*       GO TO RDTRACE;              /* READ ANOTHER RECORD   @OZ05079*/ 00250000
         B     RDTRACE                                             0219 00251000
*     END;                                                         0220 00252000
*                                                                  0221 00253000
*/********************************************************************  00254000
*                                                                    */ 00255000
*/* END OF JOB PROCESSING ROUTINE                            @Y30LB40*/ 00256000
*/********************************************************************  00257000
*                                                                    */ 00258000
*                                                                  0221 00259000
*EOJ:                                                              0221 00260000
*   CALL NEWPAGE;                   /*                       @Y30LB40*/ 00261000
EOJ      BAL   @14,NEWPAGE                                         0221 00262000
*   BLKLINE=DTLHDR;                 /*                       @Y30LB40*/ 00263000
         MVC   BLKLINE(121),DTLHDR                                 0222 00264000
*   OPT=PARMSW;                     /* PRINT OUT PARM OPTION & RCD 0223 00265000
*                                      COUNT                         */ 00266000
         MVC   OPT(1),PARMSW                                       0223 00267000
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/ 00268000
         MVC   @AL00001+4(8),@AL00224                              0224 00269000
         LA    @06,HLDSYR                                          0224 00270000
         ST    @06,@AFTEMPS+20                                     0224 00271000
         LA    @06,@AFTEMPS+20                                     0224 00272000
         ST    @06,@AL00001                                        0224 00273000
         LA    @01,@AL00001                                        0224 00274000
         BAL   @14,EDITFIX                                         0224 00275000
*   UDATE1(1:2)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00276000
         MVC   UDATE1(2),FIXOUT+11                                 0225 00277000
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/ 00278000
         MVC   @AL00001+4(8),@AL00226                              0226 00279000
         LA    @06,HLDSDAY                                         0226 00280000
         ST    @06,@AFTEMPS+20                                     0226 00281000
         LA    @06,@AFTEMPS+20                                     0226 00282000
         ST    @06,@AL00001                                        0226 00283000
         LA    @01,@AL00001                                        0226 00284000
         BAL   @14,EDITFIX                                         0226 00285000
*   UDATE1(3:5)=FIXOUT(11:13);      /*                       @Y30LB40*/ 00286000
         MVC   UDATE1+2(3),FIXOUT+10                               0227 00287000
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/ 00288000
         MVC   @AL00001+4(8),@AL00228                              0228 00289000
         LA    @06,HLDEYR                                          0228 00290000
         ST    @06,@AFTEMPS+20                                     0228 00291000
         LA    @06,@AFTEMPS+20                                     0228 00292000
         ST    @06,@AL00001                                        0228 00293000
         LA    @01,@AL00001                                        0228 00294000
         BAL   @14,EDITFIX                                         0228 00295000
*   UDATE2(1:2)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00296000
         MVC   UDATE2(2),FIXOUT+11                                 0229 00297000
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/ 00298000
         MVC   @AL00001+4(8),@AL00230                              0230 00299000
         LA    @06,HLDEDAY                                         0230 00300000
         ST    @06,@AFTEMPS+20                                     0230 00301000
         LA    @06,@AFTEMPS+20                                     0230 00302000
         ST    @06,@AL00001                                        0230 00303000
         LA    @01,@AL00001                                        0230 00304000
         BAL   @14,EDITFIX                                         0230 00305000
*   UDATE2(3:5)=FIXOUT(11:13);      /*                       @Y30LB40*/ 00306000
         MVC   UDATE2+2(3),FIXOUT+10                               0231 00307000
*   DAYS=HLDSTIME;                  /*                       @Y30LB40*/ 00308000
         L     @06,HLDSTIME                                        0232 00309000
         ST    @06,DAYS                                            0232 00310000
*   CALL CONVERTM;                  /*                       @Y30LB40*/ 00311000
         BAL   @14,CONVERTM                                        0233 00312000
*   CALL EDITFIX(ADDR(HOUR),2,'N'); /*                       @Y30LB40*/ 00313000
         MVC   @AL00001+4(8),@AL00234                              0234 00314000
         LA    @06,HOUR                                            0234 00315000
         ST    @06,@AFTEMPS+20                                     0234 00316000
         LA    @06,@AFTEMPS+20                                     0234 00317000
         ST    @06,@AL00001                                        0234 00318000
         LA    @01,@AL00001                                        0234 00319000
         BAL   @14,EDITFIX                                         0234 00320000
*   UTIME1(1:2)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00321000
         MVC   UTIME1(2),FIXOUT+11                                 0235 00322000
*   CALL EDITFIX(ADDR(MINUTE),2,'N');/*                      @Y30LB40*/ 00323000
         MVC   @AL00001+4(8),@AL00236                              0236 00324000
         LA    @06,MINUTE                                          0236 00325000
         ST    @06,@AFTEMPS+20                                     0236 00326000
         LA    @06,@AFTEMPS+20                                     0236 00327000
         ST    @06,@AL00001                                        0236 00328000
         LA    @01,@AL00001                                        0236 00329000
         BAL   @14,EDITFIX                                         0236 00330000
*   UTIME1(3:4)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00331000
         MVC   UTIME1+2(2),FIXOUT+11                               0237 00332000
*   DAYS=HLDETIME;                  /*                       @Y30LB40*/ 00333000
         L     @06,HLDETIME                                        0238 00334000
         ST    @06,DAYS                                            0238 00335000
*   CALL CONVERTM;                  /*                       @Y30LB40*/ 00336000
         BAL   @14,CONVERTM                                        0239 00337000
*   CALL EDITFIX(ADDR(HOUR),2,'N'); /*                       @Y30LB40*/ 00338000
         MVC   @AL00001+4(8),@AL00240                              0240 00339000
         LA    @06,HOUR                                            0240 00340000
         ST    @06,@AFTEMPS+20                                     0240 00341000
         LA    @06,@AFTEMPS+20                                     0240 00342000
         ST    @06,@AL00001                                        0240 00343000
         LA    @01,@AL00001                                        0240 00344000
         BAL   @14,EDITFIX                                         0240 00345000
*   UTIME2(1:2)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00346000
         MVC   UTIME2(2),FIXOUT+11                                 0241 00347000
*   CALL EDITFIX(ADDR(MINUTE),2,'N');/*                      @Y30LB40*/ 00348000
         MVC   @AL00001+4(8),@AL00242                              0242 00349000
         LA    @06,MINUTE                                          0242 00350000
         ST    @06,@AFTEMPS+20                                     0242 00351000
         LA    @06,@AFTEMPS+20                                     0242 00352000
         ST    @06,@AL00001                                        0242 00353000
         LA    @01,@AL00001                                        0242 00354000
         BAL   @14,EDITFIX                                         0242 00355000
*   UTIME2(3:4)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00356000
         MVC   UTIME2+2(2),FIXOUT+11                               0243 00357000
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/ 00358000
         MVC   @AL00001+4(8),@AL00244                              0244 00359000
         LA    @06,RCDCOUNT                                        0244 00360000
         ST    @06,@AFTEMPS+20                                     0244 00361000
         LA    @06,@AFTEMPS+20                                     0244 00362000
         ST    @06,@AL00001                                        0244 00363000
         LA    @01,@AL00001                                        0244 00364000
         BAL   @14,EDITFIX                                         0244 00365000
*   INCNT=FIXOUT(8:13);             /*                       @Y30LB40*/ 00366000
         MVC   INCNT(6),FIXOUT+7                                   0245 00367000
*   CALL EDITFIX(ADDR(OUTCOUNT),4,'S');/*                    @Y30LB40*/ 00368000
         MVC   @AL00001+4(8),@AL00246                              0246 00369000
         LA    @06,OUTCOUNT                                        0246 00370000
         ST    @06,@AFTEMPS+20                                     0246 00371000
         LA    @06,@AFTEMPS+20                                     0246 00372000
         ST    @06,@AL00001                                        0246 00373000
         LA    @01,@AL00001                                        0246 00374000
         BAL   @14,EDITFIX                                         0246 00375000
*   OUTCNT=FIXOUT(8:13);            /*                       @Y30LB40*/ 00376000
         MVC   OUTCNT(6),FIXOUT+7                                  0247 00377000
*   IF SDGSELSW='1'B                /*                       @ZA13497*/ 00378000
*     THEN                          /*                       @ZA13497*/ 00379000
         TM    SDGSELSW,B'10000000'                                0248 00380000
         BNO   @RF00248                                            0248 00381000
*     SELECTID=SDGSAVE;             /*                       @ZA13497*/ 00382000
         MVC   SELECTID(6),SDGSAVE                                 0249 00383000
*   ELSE                            /*                       @ZA13497*/ 00384000
*     IF VOLSELSW='1'B              /*                       @ZA13497*/ 00385000
*       THEN                        /*                       @ZA13497*/ 00386000
         B     @RC00248                                            0250 00387000
@RF00248 TM    VOLSELSW,B'10000000'                                0250 00388000
         BNO   @RF00250                                            0250 00389000
*       DO;                         /*                       @ZA13497*/ 00390000
*         SELECTID='******';        /*                       @ZA13497*/ 00391000
         MVC   SELECTID(6),@CC01086                                0252 00392000
*         SELECTID(1:1+LENVOLID)=HOLDVOL;/*                  @ZA13497*/ 00393000
         LH    @06,LENVOLID                                        0253 00394000
         EX    @06,@SM01280                                        0253 00395000
*       END;                        /*                       @ZA13497*/ 00396000
*     ELSE                          /*                       @ZA13497*/ 00397000
*       SELECTID='NONE  ';          /*                       @ZA13497*/ 00398000
         B     @RC00250                                            0255 00399000
@RF00250 MVC   SELECTID(6),@CC01087                                0255 00400000
*   RFY                                                            0256 00401000
*    (R0,                                                          0256 00402000
*     R1,                                                          0256 00403000
*     R14,                                                         0256 00404000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00405000
@RC00250 DS    0H                                                  0256 00406000
@RC00248 DS    0H                                                  0257 00407000
*   GEN(PUT   PRNTDCB,DTLCOUNT);    /*                       @Y30LB40*/ 00408000
         PUT   PRNTDCB,DTLCOUNT                                         00409000
*   GEN(PUT   PRNTDCB,DATEHDR2);    /*                       @Y30LB40*/ 00410000
         PUT   PRNTDCB,DATEHDR2                                         00411000
*   RFY                                                            0259 00412000
*    (R0,                                                          0259 00413000
*     R1,                                                          0259 00414000
*     R14,                                                         0259 00415000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00416000
*   LINECNT=LINECNT+5;              /*                       @Y30LB40*/ 00417000
         AL    LINECNT,@CF00376                                    0260 00418000
*   DO I=1 TO 750;                  /* LOOP THROUGH ARRAY    @OZ11013*/ 00419000
         LA    I,1                                                 0261 00420000
@DL00261 DS    0H                                                  0262 00421000
*     IF DATECNT(I)¬=0              /* PRINT NON 0 BUCKETS   @OZ09557*/ 00422000
*       THEN                                                       0262 00423000
         LR    @15,I                                               0262 00424000
         SLA   @15,4                                               0262 00425000
         L     @14,DATECNT-16(@15)                                 0262 00426000
         LTR   @14,@14                                             0262 00427000
         BZ    @RF00262                                            0262 00428000
*       DO;                         /*                       @Y30LB40*/ 00429000
*         DATELINE=' ';             /*                       @Y30LB40*/ 00430000
         MVI   DATELINE+1,C' '                                     0264 00431000
         MVC   DATELINE+2(119),DATELINE+1                          0264 00432000
         MVI   DATELINE,C' '                                       0264 00433000
*         CALL EDITFIX(ADDR(DATECNT(I)),4,'S');/*            @OZ09557*/ 00434000
         MVC   @AL00001+4(8),@AL00265                              0265 00435000
         LA    @15,DATECNT-16(@15)                                 0265 00436000
         ST    @15,@AFTEMPS+20                                     0265 00437000
         LA    @15,@AFTEMPS+20                                     0265 00438000
         ST    @15,@AL00001                                        0265 00439000
         LA    @01,@AL00001                                        0265 00440000
         BAL   @14,EDITFIX                                         0265 00441000
*         DLF18=FIXOUT(8:13);       /*                       @Y30LB40*/ 00442000
         MVC   DLF18(6),FIXOUT+7                                   0266 00443000
*         CALL EDITFIX(ADDR(STOREJUL(I)),2,'N');/*           @OZ09557*/ 00444000
         MVC   @AL00001+4(8),@AL00267                              0267 00445000
         LR    @15,I                                               0267 00446000
         SLA   @15,4                                               0267 00447000
         LA    @15,STOREJUL-16(@15)                                0267 00448000
         ST    @15,@AFTEMPS+20                                     0267 00449000
         LA    @15,@AFTEMPS+20                                     0267 00450000
         ST    @15,@AL00001                                        0267 00451000
         LA    @01,@AL00001                                        0267 00452000
         BAL   @14,EDITFIX                                         0267 00453000
*         DLF10A=FIXOUT(11:13);     /*                       @Y30LB40*/ 00454000
         MVC   DLF10A(3),FIXOUT+10                                 0268 00455000
*         CALL EDITFIX(ADDR(STOREYR(I)),2,'N');/*            @OZ09557*/ 00456000
         MVC   @AL00001+4(8),@AL00269                              0269 00457000
         LR    @15,I                                               0269 00458000
         SLA   @15,4                                               0269 00459000
         LA    @15,STOREYR-16(@15)                                 0269 00460000
         ST    @15,@AFTEMPS+20                                     0269 00461000
         LA    @15,@AFTEMPS+20                                     0269 00462000
         ST    @15,@AL00001                                        0269 00463000
         LA    @01,@AL00001                                        0269 00464000
         BAL   @14,EDITFIX                                         0269 00465000
*         DLF10=FIXOUT(12:13);      /*                       @Y30LB40*/ 00466000
         MVC   DLF10(2),FIXOUT+11                                  0270 00467000
*         DAYS=STORETIM(I);         /*                       @OZ09557*/ 00468000
         LR    @15,I                                               0271 00469000
         SLA   @15,4                                               0271 00470000
         L     @15,STORETIM-16(@15)                                0271 00471000
         ST    @15,DAYS                                            0271 00472000
*         CALL CONVERTM;            /*                       @Y30LB40*/ 00473000
         BAL   @14,CONVERTM                                        0272 00474000
*         CALL EDITFIX(ADDR(HOUR),2,'N');/*                  @Y30LB40*/ 00475000
         MVC   @AL00001+4(8),@AL00273                              0273 00476000
         LA    @15,HOUR                                            0273 00477000
         ST    @15,@AFTEMPS+20                                     0273 00478000
         LA    @15,@AFTEMPS+20                                     0273 00479000
         ST    @15,@AL00001                                        0273 00480000
         LA    @01,@AL00001                                        0273 00481000
         BAL   @14,EDITFIX                                         0273 00482000
*         DLF12=FIXOUT(12:13);      /*                       @Y30LB40*/ 00483000
         MVC   DLF12(2),FIXOUT+11                                  0274 00484000
*         CALL EDITFIX(ADDR(MINUTE),2,'N');/*                @Y30LB40*/ 00485000
         MVC   @AL00001+4(8),@AL00275                              0275 00486000
         LA    @15,MINUTE                                          0275 00487000
         ST    @15,@AFTEMPS+20                                     0275 00488000
         LA    @15,@AFTEMPS+20                                     0275 00489000
         ST    @15,@AL00001                                        0275 00490000
         LA    @01,@AL00001                                        0275 00491000
         BAL   @14,EDITFIX                                         0275 00492000
*         DLF14=FIXOUT(12:13);      /*                       @Y30LB40*/ 00493000
         MVC   DLF14(2),FIXOUT+11                                  0276 00494000
*         CALL EDITFIX(ADDR(SECOND),2,'N');/*                @Y30LB40*/ 00495000
         MVC   @AL00001+4(8),@AL00277                              0277 00496000
         LA    @15,SECOND                                          0277 00497000
         ST    @15,@AFTEMPS+20                                     0277 00498000
         LA    @15,@AFTEMPS+20                                     0277 00499000
         ST    @15,@AL00001                                        0277 00500000
         LA    @01,@AL00001                                        0277 00501000
         BAL   @14,EDITFIX                                         0277 00502000
*         DLF16=FIXOUT(12:13);      /*                       @Y30LB40*/ 00503000
         MVC   DLF16(2),FIXOUT+11                                  0278 00504000
*         DAYS=STOREDSM(I)/86400;   /* CALCULATE MSC DAY     @OZ09557*/ 00505000
         LR    @15,I                                               0279 00506000
         SLA   @15,4                                               0279 00507000
         L     @00,STOREDSM-16(@15)                                0279 00508000
         SRDA  @00,32                                              0279 00509000
         D     @00,@CF01088                                        0279 00510000
         ST    @01,DAYS                                            0279 00511000
*         CALL EDITFIX(ADDR(DAYS),4,'S');/*                  @Y30LB40*/ 00512000
         MVC   @AL00001+4(8),@AL00280                              0280 00513000
         LA    @15,DAYS                                            0280 00514000
         ST    @15,@AFTEMPS+20                                     0280 00515000
         LA    @15,@AFTEMPS+20                                     0280 00516000
         ST    @15,@AL00001                                        0280 00517000
         LA    @01,@AL00001                                        0280 00518000
         BAL   @14,EDITFIX                                         0280 00519000
*         DLF2=FIXOUT(12:13);       /*                       @Y30LB40*/ 00520000
         MVC   DLF2(2),FIXOUT+11                                   0281 00521000
*         DAYS=STOREDSM(I)-(DAYS*86400);/* SET UP TIME       @OZ09557*/ 00522000
         LR    @15,I                                               0282 00523000
         SLA   @15,4                                               0282 00524000
         L     @01,DAYS                                            0282 00525000
         M     @00,@CF01088                                        0282 00526000
         LCR   @01,@01                                             0282 00527000
         AL    @01,STOREDSM-16(@15)                                0282 00528000
         ST    @01,DAYS                                            0282 00529000
*         CALL CONVERTM;            /*                       @Y30LB40*/ 00530000
         BAL   @14,CONVERTM                                        0283 00531000
*         CALL EDITFIX(ADDR(HOUR),2,'N');/*                  @Y30LB40*/ 00532000
         MVC   @AL00001+4(8),@AL00284                              0284 00533000
         LA    @15,HOUR                                            0284 00534000
         ST    @15,@AFTEMPS+20                                     0284 00535000
         LA    @15,@AFTEMPS+20                                     0284 00536000
         ST    @15,@AL00001                                        0284 00537000
         LA    @01,@AL00001                                        0284 00538000
         BAL   @14,EDITFIX                                         0284 00539000
*         DLF4=FIXOUT(12:13);       /*                       @Y30LB40*/ 00540000
         MVC   DLF4(2),FIXOUT+11                                   0285 00541000
*         CALL EDITFIX(ADDR(MINUTE),2,'N');/*                @Y30LB40*/ 00542000
         MVC   @AL00001+4(8),@AL00286                              0286 00543000
         LA    @15,MINUTE                                          0286 00544000
         ST    @15,@AFTEMPS+20                                     0286 00545000
         LA    @15,@AFTEMPS+20                                     0286 00546000
         ST    @15,@AL00001                                        0286 00547000
         LA    @01,@AL00001                                        0286 00548000
         BAL   @14,EDITFIX                                         0286 00549000
*         DLF6=FIXOUT(12:13);       /*                       @Y30LB40*/ 00550000
         MVC   DLF6(2),FIXOUT+11                                   0287 00551000
*         CALL EDITFIX(ADDR(SECOND),2,'N');/*                @Y30LB40*/ 00552000
         MVC   @AL00001+4(8),@AL00288                              0288 00553000
         LA    @15,SECOND                                          0288 00554000
         ST    @15,@AFTEMPS+20                                     0288 00555000
         LA    @15,@AFTEMPS+20                                     0288 00556000
         ST    @15,@AL00001                                        0288 00557000
         LA    @01,@AL00001                                        0288 00558000
         BAL   @14,EDITFIX                                         0288 00559000
*         DLF8=FIXOUT(12:13);       /*                       @Y30LB40*/ 00560000
         MVC   DLF8(2),FIXOUT+11                                   0289 00561000
*         RFY                                                      0290 00562000
*          (R0,                                                    0290 00563000
*           R1,                                                    0290 00564000
*           R14,                                                   0290 00565000
*           R15) RSTD;              /*                       @Y30LB40*/ 00566000
*         GEN(PUT   PRNTDCB,DATELINE);/*                     @Y30LB40*/ 00567000
         PUT   PRNTDCB,DATELINE                                         00568000
*         GEN(PUT   PRNTDCB,ICGTR906);/*                     @ZA25867*/ 00569000
         PUT   PRNTDCB,ICGTR906                                         00570000
*         RFY                                                      0293 00571000
*          (R0,                                                    0293 00572000
*           R1,                                                    0293 00573000
*           R14,                                                   0293 00574000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 00575000
*         LINECNT=LINECNT+1;        /*                       @Y30LB40*/ 00576000
         AL    LINECNT,@CF00045                                    0294 00577000
*         IF LINECNT>55 THEN                                       0295 00578000
         C     LINECNT,@CF01089                                    0295 00579000
         BNH   @RF00295                                            0295 00580000
*           CALL NEWPAGE;           /*                       @Y30LB40*/ 00581000
         BAL   @14,NEWPAGE                                         0296 00582000
*       END;                        /*                       @Y30LB40*/ 00583000
@RF00295 DS    0H                                                  0298 00584000
*   END;                            /*                       @Y30LB40*/ 00585000
@RF00262 AL    I,@CF00045                                          0298 00586000
         C     I,@CF01035                                          0298 00587000
         BNH   @DL00261                                            0298 00588000
*CLOSEFIL:                                                         0299 00589000
*   IF PARMSW='R'|PARMSW='B' THEN                                  0299 00590000
CLOSEFIL CLI   PARMSW,C'R'                                         0299 00591000
         BE    @RT00299                                            0299 00592000
         CLI   PARMSW,C'B'                                         0299 00593000
         BNE   @RF00299                                            0299 00594000
@RT00299 DS    0H                                                  0300 00595000
*     IF PARMERR='0'B               /* WAS OUTPUT DCB OPENED         */ 00596000
*       THEN                                                       0300 00597000
         TM    PARMERR,B'10000000'                                 0300 00598000
         BNZ   @RF00300                                            0300 00599000
*       DO;                         /* YES                   @Y30LB40*/ 00600000
*         RFY                                                      0302 00601000
*          (R0,                                                    0302 00602000
*           R1,                                                    0302 00603000
*           R14,                                                   0302 00604000
*           R15) RSTD;              /*                       @Y30LB40*/ 00605000
*         GEN(CLOSE OUTDCB,MF=(E,OPENCLOS));/* CLOSE OUTPUT DCB      */ 00606000
         CLOSE OUTDCB,MF=(E,OPENCLOS)                                   00607000
*         RFY                                                      0304 00608000
*          (R0,                                                    0304 00609000
*           R1,                                                    0304 00610000
*           R14,                                                   0304 00611000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 00612000
*       END;                        /*                       @Y30LB40*/ 00613000
*   RFY                                                            0306 00614000
*    (R0,                                                          0306 00615000
*     R1,                                                          0306 00616000
*     R14,                                                         0306 00617000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00618000
@RF00300 DS    0H                                                  0306 00619000
@RF00299 DS    0H                                                  0307 00620000
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/ 00621000
         CLOSE INDCB,MF=(E,OPENCLOS)                                    00622000
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/ 00623000
         CLOSE PRNTDCB,MF=(E,OPENCLOS)                                  00624000
*   RFY                                                            0309 00625000
*    (R0,                                                          0309 00626000
*     R1,                                                          0309 00627000
*     R14,                                                         0309 00628000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00629000
*   RETURN CODE(RETURNCD);          /* GO TO STEP TERMINATOR @Y30LB40*/ 00630000
         LH    @07,RETURNCD                                        0310 00631000
         L     @13,4(,@13)                                         0310 00632000
         L     @00,@SIZDATD                                        0310 00633000
         LR    @01,@08                                             0310 00634000
         FREEMAIN R,LV=(0),A=(1)                                        00635000
         LR    @15,@07                                             0310 00636000
         L     @14,12(,@13)                                        0310 00637000
         LM    @00,@12,20(@13)                                     0310 00638000
         BR    @14                                                 0310 00639000
*                                                                  0311 00640000
*/********************************************************** @OZ05079*/ 00641000
*/*                                                          @OZ05079*/ 00642000
*/* PROCEDURE NAME - INIT                                    @OZ05079*/ 00643000
*/*                                                          @OZ05079*/ 00644000
*/* FUNCTION - INITIALIZE LOCAL VARIABLES                    @OZ05079*/ 00645000
*/*                                                          @OZ05079*/ 00646000
*/********************************************************** @OZ05079*/ 00647000
*                                                                  0311 00648000
*INIT:                                                             0311 00649000
*   PROCEDURE;                      /*                       @OZ05079*/ 00650000
INIT     STM   @14,@06,12(@13)                                     0311 00651000
         STM   @08,@12,52(@13)                                     0311 00652000
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/ 00653000
         SLR   @06,@06                                             0312 00654000
         ST    @06,RCDCOUNT                                        0312 00655000
*   OUTCOUNT=0;                     /*                       @Y30LB40*/ 00656000
         ST    @06,OUTCOUNT                                        0313 00657000
*   DAYS=0;                         /*                       @Y30LB40*/ 00658000
         ST    @06,DAYS                                            0314 00659000
*   RETURNCD=0;                     /*                       @Y30LB40*/ 00660000
         STH   @06,RETURNCD                                        0315 00661000
*   M=0;                            /*                       @Y30LB40*/ 00662000
         STH   @06,M                                               0316 00663000
*   N=0;                            /*                       @OZ11013*/ 00664000
         STH   @06,N                                               0317 00665000
*   HOUR=0;                         /*                       @Y30LB40*/ 00666000
         STH   @06,HOUR                                            0318 00667000
*   MINUTE=0;                       /*                       @Y30LB40*/ 00668000
         STH   @06,MINUTE                                          0319 00669000
*   SECOND=0;                       /*                       @Y30LB40*/ 00670000
         STH   @06,SECOND                                          0320 00671000
*   LINECNT=56;                     /*                       @Y30LB40*/ 00672000
         LA    LINECNT,56                                          0321 00673000
*   OPENCLOS=0;                     /*                       @Y30LB40*/ 00674000
         ST    @06,OPENCLOS                                        0322 00675000
*   LENVOLID=0;                     /*                       @ZA13497*/ 00676000
         STH   @06,LENVOLID                                        0323 00677000
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/ 00678000
         MVI   OPCLB1,B'10000000'                                  0324 00679000
*   PAGECNT=0;                      /*                       @Y30LB40*/ 00680000
         STH   @06,PAGECNT                                         0325 00681000
*   CONVERT=0;                      /*                       @Y30LB40*/ 00682000
         STH   @06,CONVERT                                         0326 00683000
*   HLDSYR=0;                       /*                       @Y30LB40*/ 00684000
         MVI   HLDSYR,X'00'                                        0327 00685000
*   HLDSDAY=1;                      /*                       @Y30LB40*/ 00686000
         LA    @15,1                                               0328 00687000
         STH   @15,HLDSDAY                                         0328 00688000
*   HLDSTIME=0;                     /*                       @Y30LB40*/ 00689000
         ST    @06,HLDSTIME                                        0329 00690000
*   HLDEYR=99;                      /*                       @Y30LB40*/ 00691000
         MVI   HLDEYR,X'63'                                        0330 00692000
*   HLDEDAY=365;                    /*                       @Y30LB40*/ 00693000
         MVC   HLDEDAY(2),@CH01095                                 0331 00694000
*   HLDETIME=86399;                 /*                       @Y30LB40*/ 00695000
         MVC   HLDETIME(4),@CF01096                                0332 00696000
*   PARMSW='R';                     /*                       @Y30LB40*/ 00697000
         MVI   PARMSW,C'R'                                         0333 00698000
*   FRSTSW='1'B;                    /*                       @Y30LB40*/ 00699000
         OI    FRSTSW,B'10000000'                                  0334 00700000
*   MINI1SW='1'B;                   /*                       @Y30LB40*/ 00701000
         OI    MINI1SW,B'10000000'                                 0335 00702000
*   SDGSELSW='0'B;                  /*                       @ZA13497*/ 00703000
         NI    SDGSELSW,B'01111111'                                0336 00704000
*   VOLSELSW='0'B;                  /*                       @ZA13497*/ 00705000
         NI    VOLSELSW,B'01111111'                                0337 00706000
*   PARMERR='0'B;                   /*                       @Y30LB40*/ 00707000
         NI    PARMERR,B'01111111'                                 0338 00708000
*   DATEINSW='0'B;                  /*                       @Y30LB40*/ 00709000
         NI    DATEINSW,B'01111111'                                0339 00710000
*   HOSTYEAR=0;                     /*                       @OZ09557*/ 00711000
         STH   @06,HOSTYEAR                                        0340 00712000
*   HOSTJUL=0;                      /*                       @OZ09557*/ 00713000
         STH   @06,HOSTJUL                                         0341 00714000
*   HOSTTME=0;                      /*                       @OZ09557*/ 00715000
         ST    @06,HOSTTME                                         0342 00716000
*   HDRTME=0;                       /*                       @OZ09557*/ 00717000
         ST    @06,HDRTME                                          0343 00718000
*   INCNT1=0;                       /*                       @ZA17158*/ 00719000
         STH   @06,INCNT1                                          0344 00720000
*   IMLSAVE=FOXES;                  /*                       @ZA16141*/ 00721000
         MVC   IMLSAVE(2),FOXES                                    0345 00722000
*   IMLFLAG=0;                      /*                       @ZA25867*/ 00723000
         MVI   IMLFLAG,X'00'                                       0346 00724000
*   DO I=1 TO 750;                  /*                       @OZ09557*/ 00725000
         LR    I,@15                                               0347 00726000
@DL00347 DS    0H                                                  0348 00727000
*     STOREYR(I)=0;                 /*                       @OZ09557*/ 00728000
         SLR   @15,@15                                             0348 00729000
         LR    @14,I                                               0348 00730000
         SLA   @14,4                                               0348 00731000
         STH   @15,STOREYR-16(@14)                                 0348 00732000
*     STOREJUL(I)=0;                /*                       @OZ09557*/ 00733000
         STH   @15,STOREJUL-16(@14)                                0349 00734000
*     STORETIM(I)=0;                /*                       @OZ09557*/ 00735000
         ST    @15,STORETIM-16(@14)                                0350 00736000
*     STOREDSM(I)=0;                /*                       @OZ09557*/ 00737000
         ST    @15,STOREDSM-16(@14)                                0351 00738000
*     DATECNT(I)=0;                 /*                       @OZ09557*/ 00739000
         ST    @15,DATECNT-16(@14)                                 0352 00740000
*   END;                            /*                       @Y30LB40*/ 00741000
         AL    I,@CF00045                                          0353 00742000
         C     I,@CF01035                                          0353 00743000
         BNH   @DL00347                                            0353 00744000
*   END INIT;                       /*                       @OZ05079*/ 00745000
@EL00002 DS    0H                                                  0354 00746000
@EF00002 DS    0H                                                  0354 00747000
@ER00002 LM    @14,@06,12(@13)                                     0354 00748000
         LM    @08,@12,52(@13)                                     0354 00749000
         BR    @14                                                 0354 00750000
*                                                                  0355 00751000
*/********************************************************** @OZ05079*/ 00752000
*/*                                                          @OZ05079*/ 00753000
*/* PROCEDURE NAME - OPENFILE                                @OZ05079*/ 00754000
*/*                                                          @OZ05079*/ 00755000
*/* FUNCTION - SET UP DCBS FOR SYSPRINT, TRACEIN, AND        @OZ05079*/ 00756000
*/*            TRACEOUT.  IF SYSPRINT CANNOT BE OPENED,      @OZ05079*/ 00757000
*/*            SET A RETURN CODE OF 4 AND RETURN TO THE      @OZ05079*/ 00758000
*/*            MAINLINE.  IF TRACEIN CANNOT BE OPENED,       @OZ05079*/ 00759000
*/*            WRITE MSG 'ICG901I OPEN ERROR FOR TRACEIN',   @OZ05079*/ 00760000
*/*            SET A RETURN CODE OF 8 AND RETURN TO THE      @OZ05079*/ 00761000
*/*            MAINLINE.                                     @OZ05079*/ 00762000
*/*                                                          @OZ05079*/ 00763000
*/********************************************************** @OZ05079*/ 00764000
*                                                                  0355 00765000
*OPENFILE:                                                         0355 00766000
*   PROCEDURE;                      /*                       @OZ05079*/ 00767000
OPENFILE STM   @14,@12,@SA00003                                    0355 00768000
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/ 00769000
         MVC   PRNTDCB(PDCBL),PPATDCB                                   00770000
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/ 00771000
         MVC   INDCB(IDCBL),IPATDCB                                     00772000
*   GEN(MVC   OUTDCB(ODCBL),OPATDCB);/* SETUP OUTPUT DCB     @Y30LB40*/ 00773000
         MVC   OUTDCB(ODCBL),OPATDCB                                    00774000
*   RFY                                                            0359 00775000
*    (R0,                                                          0359 00776000
*     R1,                                                          0359 00777000
*     R14,                                                         0359 00778000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00779000
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */ 00780000
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)                       00781000
*   RFY                                                            0361 00782000
*    (R0,                                                          0361 00783000
*     R1,                                                          0361 00784000
*     R14,                                                         0361 00785000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00786000
*   IF(PRNTDCB(49:49)&'00010000'B)¬='00010000'B/* WAS OPEN OK        */ 00787000
*     THEN                                                         0362 00788000
         MVC   @TS00001(1),PRNTDCB+48                              0362 00789000
         NI    @TS00001,B'00010000'                                0362 00790000
         CLI   @TS00001,B'00010000'                                0362 00791000
         BE    @RF00362                                            0362 00792000
*     DO;                           /* NO,EXIT WITH                  */ 00793000
*       RETURNCD=4;                 /* RC=4                  @OZ05079*/ 00794000
         MVC   RETURNCD(2),@CH00104                                0364 00795000
*       RETURN;                     /* RETURN TO MAINLINE    @OZ05079*/ 00796000
@EL00003 DS    0H                                                  0365 00797000
@EF00003 DS    0H                                                  0365 00798000
@ER00003 LM    @14,@12,@SA00003                                    0365 00799000
         BR    @14                                                 0365 00800000
*     END;                          /*                       @Y30LB40*/ 00801000
*   RFY                                                            0367 00802000
*    (R0,                                                          0367 00803000
*     R1,                                                          0367 00804000
*     R14,                                                         0367 00805000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00806000
@RF00362 DS    0H                                                  0368 00807000
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */ 00808000
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)                          00809000
*   RFY                                                            0369 00810000
*    (R0,                                                          0369 00811000
*     R1,                                                          0369 00812000
*     R14,                                                         0369 00813000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00814000
*   IF(INDCB(49:49)&'00010000'B)¬='00010000'B/* WAS OPEN OK          */ 00815000
*     THEN                                                         0370 00816000
         MVC   @TS00001(1),INDCB+48                                0370 00817000
         NI    @TS00001,B'00010000'                                0370 00818000
         CLI   @TS00001,B'00010000'                                0370 00819000
         BE    @RF00370                                            0370 00820000
*     DO;                           /* NO                    @Y30LB40*/ 00821000
*       BLKLINE=TRINMSG;            /* PRINT ERROR MSG               */ 00822000
         MVI   BLKLINE+31,C' '                                     0372 00823000
         MVC   BLKLINE+32(89),BLKLINE+31                           0372 00824000
         MVC   BLKLINE(31),TRINMSG                                 0372 00825000
*       RFY                                                        0373 00826000
*        (R0,                                                      0373 00827000
*         R1,                                                      0373 00828000
*         R14,                                                     0373 00829000
*         R15) RSTD;                /*                       @Y30LB40*/ 00830000
*       GEN(PUT   PRNTDCB,BLKLINE); /*                       @Y30LB40*/ 00831000
         PUT   PRNTDCB,BLKLINE                                          00832000
*       RFY                                                        0375 00833000
*        (R0,                                                      0375 00834000
*         R1,                                                      0375 00835000
*         R14,                                                     0375 00836000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00837000
*       RETURNCD=8;                 /* EXIT WITH RC=8                */ 00838000
         MVC   RETURNCD(2),@CH00036                                0376 00839000
*     END;                          /*                       @Y30LB40*/ 00840000
*   END OPENFILE;                   /*                       @OZ05079*/ 00841000
         B     @EL00003                                            0378 00842000
*                                                                  0379 00843000
*/********************************************************** @OZ05079*/ 00844000
*/*                                                          @OZ05079*/ 00845000
*/* PROCEDURE NAME - GETPARMS                                @OZ05079*/ 00846000
*/*                                                          @OZ05079*/ 00847000
*/* FUNCTION - SCAN THE PARAMETERS PASSED IN THE PARM FIELD  @OZ05079*/ 00848000
*/*            OF THE EXEC STATEMENT FOR VALID PARAMETERS.   @OZ05079*/ 00849000
*/*            IF AN INVALID PARAMETER IS FOUND, WRITE MSG   @OZ05079*/ 00850000
*/*            'ICG900I INVALID PARM VALUES, SET A RETURN    @OZ05079*/ 00851000
*/*            CODE OF 8, AND RETURN TO THE MAINLINE.  IF    @OZ05079*/ 00852000
*/*            PARAMETERS ARE GOOD, RETURN TO MAINLINE WITH  @OZ05079*/ 00853000
*/*            RETURN CODE OF ZERO.                          @OZ05079*/ 00854000
*/*                                                          @OZ05079*/ 00855000
*/********************************************************** @OZ05079*/ 00856000
*                                                                  0379 00857000
*GETPARMS:                                                         0379 00858000
*   PROCEDURE;                      /*                       @OZ05079*/ 00859000
GETPARMS STM   @14,@12,@SA00004                                    0379 00860000
*   IF PARMLEN>28                   /* TOO MANY PARMS        @ZA13497*/ 00861000
*     THEN                                                         0380 00862000
         LH    @02,PARMLEN(,PARMPTR)                               0380 00863000
         C     @02,@CF00869                                        0380 00864000
         BNH   @RF00380                                            0380 00865000
*     DO;                           /* YES                   @Y30LB40*/ 00866000
*       PARMERR='1'B;               /* SET ERROR SWITCH AND GET OUT  */ 00867000
         OI    PARMERR,B'10000000'                                 0382 00868000
*       GO TO PARMEND;              /*                       @Y30LB40*/ 00869000
         B     PARMEND                                             0383 00870000
*     END;                          /*                       @Y30LB40*/ 00871000
*   PARMHOLD(1:1)=',';              /* SET PARM HOLD TO COMMAS     0385 00872000
*                                                            @Y30LB40*/ 00873000
@RF00380 MVI   PARMHOLD,C','                                       0385 00874000
*   MVC(PARMHOLD(2:29),PARMHOLD);   /*                       @ZA13497*/ 00875000
         MVC   PARMHOLD+1(28),PARMHOLD                             0386 00876000
*   SS=1;                           /* SET SUBSTRING VALUE TO 1    0387 00877000
*                                                            @Y30LB40*/ 00878000
         LA    SS,1                                                0387 00879000
*   PARMHOLD(1:PARMLEN)=PARMS;      /*                       @Y30LB40*/ 00880000
         LH    @02,PARMLEN(,PARMPTR)                               0388 00881000
         BCTR  @02,0                                               0388 00882000
         EX    @02,@SM01283                                        0388 00883000
*   IF PARMHOLD(1:1)=','            /* IS OPTION ENTERED     @Y30LB40*/ 00884000
*     THEN                                                         0389 00885000
         CLI   PARMHOLD,C','                                       0389 00886000
         BNE   @RF00389                                            0389 00887000
*     SS=2;                         /* NO, BUMP POINTER      @Y30LB40*/ 00888000
         LA    SS,2                                                0390 00889000
*   ELSE                                                           0391 00890000
*     DO;                           /* YES, CHECK VALUE      @Y30LB40*/ 00891000
         B     @RC00389                                            0391 00892000
@RF00389 DS    0H                                                  0392 00893000
*       IF PARMHOLD(1:1)='I'|PARMHOLD(1:1)='R'|PARMHOLD(1:1)='B'/* 0392 00894000
*                                      WAS IS I R OR D       @Y30LB40*/ 00895000
*         THEN                                                     0392 00896000
         CLI   PARMHOLD,C'I'                                       0392 00897000
         BE    @RT00392                                            0392 00898000
         CLI   PARMHOLD,C'R'                                       0392 00899000
         BE    @RT00392                                            0392 00900000
         CLI   PARMHOLD,C'B'                                       0392 00901000
         BNE   @RF00392                                            0392 00902000
@RT00392 DS    0H                                                  0393 00903000
*         DO;                       /* YES SAVE IT           @Y30LB40*/ 00904000
*           PARMSW=PARMHOLD(1:1);   /*                       @Y30LB40*/ 00905000
         MVC   PARMSW(1),PARMHOLD                                  0394 00906000
*           SS=3;                   /* SET POINTER TO NEXT VALUE   0395 00907000
*                                                            @Y30LB40*/ 00908000
         LA    SS,3                                                0395 00909000
*         END;                      /*                       @Y30LB40*/ 00910000
*       ELSE                                                       0397 00911000
*         DO;                       /* WAS NOT I R OR D      @Y30LB40*/ 00912000
         B     @RC00392                                            0397 00913000
@RF00392 DS    0H                                                  0398 00914000
*           PARMERR='1'B;           /* SET ERROR SWITCH AND GET OUT  */ 00915000
         OI    PARMERR,B'10000000'                                 0398 00916000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00917000
         B     PARMEND                                             0399 00918000
*         END;                      /*                       @Y30LB40*/ 00919000
*     END;                          /*                       @Y30LB40*/ 00920000
@RC00392 DS    0H                                                  0402 00921000
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/ 00922000
*     THEN                                                         0402 00923000
@RC00389 LA    @03,PARMHOLD-1(SS)                                  0402 00924000
         CLI   0(@03),C','                                         0402 00925000
         BNE   @RF00402                                            0402 00926000
*     SS=SS+1;                      /* NO,BUMP POINTER       @Y30LB40*/ 00927000
         AL    SS,@CF00045                                         0403 00928000
*   ELSE                                                           0404 00929000
*     DO;                           /* YES,VALIDATE AND CONVERT THEM    00930000
*                                                            @Y30LB40*/ 00931000
         B     @RC00402                                            0404 00932000
@RF00402 DS    0H                                                  0405 00933000
*       DO I=SS TO(SS+9);           /* CHECK FOR NUMBERS 0 THRU 9  0405 00934000
*                                                            @Y30LB40*/ 00935000
         LR    I,SS                                                0405 00936000
         B     @DE00405                                            0405 00937000
@DL00405 DS    0H                                                  0406 00938000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0406 00939000
         LA    @07,PARMHOLD-1(I)                                   0406 00940000
         CLI   0(@07),C'0'                                         0406 00941000
         BL    @RF00406                                            0406 00942000
         LA    @07,PARMHOLD-1(I)                                   0406 00943000
         CLI   0(@07),C'9'                                         0406 00944000
         BNH   @RT00406                                            0406 00945000
*           ;                       /*                       @Y30LB40*/ 00946000
*         ELSE                                                     0408 00947000
*           PARMERR='1'B;           /* NON NUMERIC FOUND     @Y30LB40*/ 00948000
@RF00406 OI    PARMERR,B'10000000'                                 0408 00949000
*       END;                        /*                       @Y30LB40*/ 00950000
@RT00406 AL    I,@CF00045                                          0409 00951000
@DE00405 LA    @07,9                                               0409 00952000
         ALR   @07,SS                                              0409 00953000
         CR    I,@07                                               0409 00954000
         BNH   @DL00405                                            0409 00955000
*       IF PARMERR='1'B THEN                                       0410 00956000
         TM    PARMERR,B'10000000'                                 0410 00957000
         BO    @RT00410                                            0410 00958000
*         GO TO PARMEND;            /* IF ERROR FOUND GET OUT        */ 00959000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* NO ERROR,CONVERT DATES   */ 00960000
         LA    @03,PARMHOLD-1(SS)                                  0412 00961000
         PACK  DOUBLEWD(8),0(2,@03)                                0412 00962000
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/ 00963000
         CVB   @03,DOUBLEWD                                        0413 00964000
         STC   @03,HLDSYR                                          0413 00965000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/ 00966000
         LA    @03,PARMHOLD+1(SS)                                  0414 00967000
         PACK  DOUBLEWD(8),0(3,@03)                                0414 00968000
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00969000
         CVB   @03,DOUBLEWD                                        0415 00970000
         STH   @03,HLDSDAY                                         0415 00971000
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/ 00972000
         LA    @01,PARMHOLD+4(SS)                                  0416 00973000
         PACK  DOUBLEWD(8),0(2,@01)                                0416 00974000
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/ 00975000
         CVB   @15,DOUBLEWD                                        0417 00976000
         STC   @15,HLDEYR                                          0417 00977000
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/ 00978000
         LA    @01,PARMHOLD+6(SS)                                  0418 00979000
         PACK  DOUBLEWD(8),0(3,@01)                                0418 00980000
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00981000
         CVB   @15,DOUBLEWD                                        0419 00982000
         STH   @15,HLDEDAY                                         0419 00983000
*       IF HLDSDAY>0&HLDSDAY<366    /* IS DATE FROM 001 THRU 365     */ 00984000
*         THEN                                                     0420 00985000
         LTR   @03,@03                                             0420 00986000
         BNP   @RF00420                                            0420 00987000
         C     @03,@CF01110                                        0420 00988000
         BL    @RT00420                                            0420 00989000
*         ;                         /* YES DONT CHECK FOR LEAP YEAR  */ 00990000
*       ELSE                                                       0422 00991000
*         DO;                       /*                       @Y30LB40*/ 00992000
@RF00420 DS    0H                                                  0423 00993000
*           IF HLDSDAY=366          /* IS DAY 366            @Y30LB40*/ 00994000
*             THEN                                                 0423 00995000
         CLC   HLDSDAY(2),@CH01110                                 0423 00996000
         BNE   @RF00423                                            0423 00997000
*             DO;                   /* YES, CHECK FOR LEAP YEAR      */ 00998000
*               IF(CKSTIME(1:1)&'00000011'B)¬='00000000'B THEN     0425 00999000
         MVC   @TS00001(1),CKSTIME                                 0425 01000000
         NI    @TS00001,B'00000011'                                0425 01001000
         CLI   @TS00001,B'00000000'                                0425 01002000
         BE    @RF00425                                            0425 01003000
*                 PARMERR='1'B;     /* ERROR, NOT LEAP YEAR          */ 01004000
         OI    PARMERR,B'10000000'                                 0426 01005000
*             END;                  /*                       @Y30LB40*/ 01006000
*           ELSE                                                   0428 01007000
*             PARMERR='1'B;         /* ERROR, DAY=000 OR >366        */ 01008000
         B     @RC00423                                            0428 01009000
@RF00423 OI    PARMERR,B'10000000'                                 0428 01010000
*         END;                      /*                       @Y30LB40*/ 01011000
@RC00423 DS    0H                                                  0430 01012000
*       IF HLDEDAY>0&HLDEDAY<366    /* SAME CHECKS AS FOR START DATE */ 01013000
*         THEN                                                     0430 01014000
@RT00420 LH    @03,HLDEDAY                                         0430 01015000
         LTR   @03,@03                                             0430 01016000
         BNP   @RF00430                                            0430 01017000
         C     @03,@CF01110                                        0430 01018000
         BL    @RT00430                                            0430 01019000
*         ;                         /*                       @Y30LB40*/ 01020000
*       ELSE                                                       0432 01021000
*         DO;                       /*                       @Y30LB40*/ 01022000
@RF00430 DS    0H                                                  0433 01023000
*           IF HLDEDAY=366 THEN                                    0433 01024000
         CLC   HLDEDAY(2),@CH01110                                 0433 01025000
         BNE   @RF00433                                            0433 01026000
*             DO;                   /*                       @Y30LB40*/ 01027000
*               IF(CKETIME(1:1)&'00000011'B)¬='00000000'B THEN     0435 01028000
         MVC   @TS00001(1),CKETIME                                 0435 01029000
         NI    @TS00001,B'00000011'                                0435 01030000
         CLI   @TS00001,B'00000000'                                0435 01031000
         BE    @RF00435                                            0435 01032000
*                 PARMERR='1'B;     /*                       @Y30LB40*/ 01033000
         OI    PARMERR,B'10000000'                                 0436 01034000
*             END;                  /*                       @Y30LB40*/ 01035000
*           ELSE                                                   0438 01036000
*             PARMERR='1'B;         /*                       @Y30LB40*/ 01037000
         B     @RC00433                                            0438 01038000
@RF00433 OI    PARMERR,B'10000000'                                 0438 01039000
*         END;                      /*                       @Y30LB40*/ 01040000
@RC00433 DS    0H                                                  0440 01041000
*       IF HLDSYR<=HLDEYR           /* IS START YEAR <= END YEAR   0440 01042000
*                                                            @Y30LB40*/ 01043000
*         THEN                                                     0440 01044000
@RT00430 CLC   HLDSYR(1),HLDEYR                                    0440 01045000
         BNH   @RT00440                                            0440 01046000
*         ;                         /* YES,OK                @Y30LB40*/ 01047000
*       ELSE                                                       0442 01048000
*         PARMERR='1'B;             /* NO,ERROR AND GETOUT   @Y30LB40*/ 01049000
         OI    PARMERR,B'10000000'                                 0442 01050000
*       IF HLDSDAY<=HLDEDAY         /* IS START DAY <= END DAY     0443 01051000
*                                                            @Y30LB40*/ 01052000
*         THEN                                                     0443 01053000
@RT00440 LH    @03,HLDSDAY                                         0443 01054000
         CH    @03,HLDEDAY                                         0443 01055000
         BNH   @RT00443                                            0443 01056000
*         ;                         /* YES,OK                @Y30LB40*/ 01057000
*       ELSE                                                       0445 01058000
*         DO;                       /* NO, CHECK FOR DIFFERENT YEARS */ 01059000
*           IF HLDSYR=HLDEYR THEN                                  0446 01060000
         CLC   HLDSYR(1),HLDEYR                                    0446 01061000
         BNE   @RF00446                                            0446 01062000
*             PARMERR='1'B;         /* ERROR                 @Y30LB40*/ 01063000
         OI    PARMERR,B'10000000'                                 0447 01064000
*         END;                      /*                       @Y30LB40*/ 01065000
@RF00446 DS    0H                                                  0449 01066000
*       IF PARMERR='1'B THEN                                       0449 01067000
@RT00443 TM    PARMERR,B'10000000'                                 0449 01068000
         BO    @RT00449                                            0449 01069000
*         GO TO PARMEND;            /* IF ERRORS FOUND GETOUT        */ 01070000
*       DATEINSW='1'B;              /* INDICATE VALID DATES ENTERED     01071000
*                                                            @Y30LB40*/ 01072000
         OI    DATEINSW,B'10000000'                                0451 01073000
*       SS=SS+11;                   /* BUMP POINTER TO NEXT VALUE  0452 01074000
*                                                            @Y30LB40*/ 01075000
         AL    SS,@CF00033                                         0452 01076000
*     END;                          /*                       @Y30LB40*/ 01077000
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/ 01078000
*     THEN                          /*                       @ZA13497*/ 01079000
@RC00402 LA    @03,PARMHOLD-1(SS)                                  0454 01080000
         CLI   0(@03),C','                                         0454 01081000
         BNE   @RF00454                                            0454 01082000
*     SS=SS+1;                      /*                       @ZA13497*/ 01083000
         AL    SS,@CF00045                                         0455 01084000
*   ELSE                                                           0456 01085000
*     DO;                           /* YES,CHECK FOR NUMERICS      0456 01086000
*                                                            @Y30LB40*/ 01087000
         B     @RC00454                                            0456 01088000
@RF00454 DS    0H                                                  0457 01089000
*       DO I=SS TO(SS+7);           /*                       @Y30LB40*/ 01090000
         LR    I,SS                                                0457 01091000
         B     @DE00457                                            0457 01092000
@DL00457 DS    0H                                                  0458 01093000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0458 01094000
         LA    @07,PARMHOLD-1(I)                                   0458 01095000
         CLI   0(@07),C'0'                                         0458 01096000
         BL    @RF00458                                            0458 01097000
         LA    @07,PARMHOLD-1(I)                                   0458 01098000
         CLI   0(@07),C'9'                                         0458 01099000
         BNH   @RT00458                                            0458 01100000
*           ;                       /*                       @Y30LB40*/ 01101000
*         ELSE                                                     0460 01102000
*           PARMERR='1'B;           /* ERROR,NONNUMERIC FOUND      0460 01103000
*                                                            @Y30LB40*/ 01104000
@RF00458 OI    PARMERR,B'10000000'                                 0460 01105000
*       END;                        /*                       @Y30LB40*/ 01106000
@RT00458 AL    I,@CF00045                                          0461 01107000
@DE00457 LA    @07,7                                               0461 01108000
         ALR   @07,SS                                              0461 01109000
         CR    I,@07                                               0461 01110000
         BNH   @DL00457                                            0461 01111000
*       IF PARMERR='1'B THEN                                       0462 01112000
         TM    PARMERR,B'10000000'                                 0462 01113000
         BO    @RT00462                                            0462 01114000
*         GO TO PARMEND;            /* IF ERROR FOUND GETOUT         */ 01115000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/ 01116000
         LA    @01,PARMHOLD-1(SS)                                  0464 01117000
         PACK  DOUBLEWD(8),0(2,@01)                                0464 01118000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 01119000
         CVB   TIMEWORK,DOUBLEWD                                   0465 01120000
*       IF TIMEWORK>23 THEN                                        0466 01121000
         C     TIMEWORK,@CF01111                                   0466 01122000
         BNH   @RF00466                                            0466 01123000
*         PARMERR='1'B;             /* HOUR > 23 = ERROR             */ 01124000
         OI    PARMERR,B'10000000'                                 0467 01125000
*       ELSE                                                       0468 01126000
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 01127000
         B     @RC00466                                            0468 01128000
@RF00466 LR    @15,TIMEWORK                                        0468 01129000
         MH    @15,@CH01112                                        0468 01130000
         ST    @15,HLDSTIME                                        0468 01131000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/ 01132000
@RC00466 LA    @01,PARMHOLD+1(SS)                                  0469 01133000
         PACK  DOUBLEWD(8),0(2,@01)                                0469 01134000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 01135000
         CVB   TIMEWORK,DOUBLEWD                                   0470 01136000
*       IF TIMEWORK>59 THEN                                        0471 01137000
         C     TIMEWORK,@CF01113                                   0471 01138000
         BNH   @RF00471                                            0471 01139000
*         PARMERR='1'B;             /* MINUTE > 59 = ERROR           */ 01140000
         OI    PARMERR,B'10000000'                                 0472 01141000
*       ELSE                                                       0473 01142000
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/ 01143000
         B     @RC00471                                            0473 01144000
@RF00471 LR    @15,TIMEWORK                                        0473 01145000
         MH    @15,@CH00339                                        0473 01146000
         AL    @15,HLDSTIME                                        0473 01147000
         ST    @15,HLDSTIME                                        0473 01148000
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/ 01149000
@RC00471 LA    @01,PARMHOLD+3(SS)                                  0474 01150000
         PACK  DOUBLEWD(8),0(2,@01)                                0474 01151000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 01152000
         CVB   TIMEWORK,DOUBLEWD                                   0475 01153000
*       IF TIMEWORK>23 THEN                                        0476 01154000
         C     TIMEWORK,@CF01111                                   0476 01155000
         BNH   @RF00476                                            0476 01156000
*         PARMERR='1'B;             /* HOUR > 23 = ERROR             */ 01157000
         OI    PARMERR,B'10000000'                                 0477 01158000
*       ELSE                                                       0478 01159000
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 01160000
         B     @RC00476                                            0478 01161000
@RF00476 LR    @15,TIMEWORK                                        0478 01162000
         MH    @15,@CH01112                                        0478 01163000
         ST    @15,HLDETIME                                        0478 01164000
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/ 01165000
@RC00476 LA    @01,PARMHOLD+5(SS)                                  0479 01166000
         PACK  DOUBLEWD(8),0(2,@01)                                0479 01167000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 01168000
         CVB   TIMEWORK,DOUBLEWD                                   0480 01169000
*       IF TIMEWORK>59 THEN                                        0481 01170000
         C     TIMEWORK,@CF01113                                   0481 01171000
         BNH   @RF00481                                            0481 01172000
*         PARMERR='1'B;             /* MINUTE > 59 = ERROR           */ 01173000
         OI    PARMERR,B'10000000'                                 0482 01174000
*       ELSE                                                       0483 01175000
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/ 01176000
         B     @RC00481                                            0483 01177000
@RF00481 LR    @15,TIMEWORK                                        0483 01178000
         MH    @15,@CH00339                                        0483 01179000
         AL    @15,HLDETIME                                        0483 01180000
         AL    @15,@CF01113                                        0483 01181000
         ST    @15,HLDETIME                                        0483 01182000
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY/* CHECK TIMES       @Y30LB40*/ 01183000
*         THEN                                                     0484 01184000
@RC00481 CLC   HLDSYR(1),HLDEYR                                    0484 01185000
         BNE   @RF00484                                            0484 01186000
         CLC   HLDSDAY(2),HLDEDAY                                  0484 01187000
         BNE   @RF00484                                            0484 01188000
*         IF HLDSTIME>HLDETIME THEN                                0485 01189000
         L     @03,HLDSTIME                                        0485 01190000
         C     @03,HLDETIME                                        0485 01191000
         BNH   @RF00485                                            0485 01192000
*           PARMERR='1'B;           /*                       @Y30LB40*/ 01193000
         OI    PARMERR,B'10000000'                                 0486 01194000
*       IF PARMERR='0'B&DATEINSW='0'B/* IF DATE NOT ENTERED          */ 01195000
*         THEN                                                     0487 01196000
@RF00485 DS    0H                                                  0487 01197000
@RF00484 TM    PARMERR,B'10000000'                                 0487 01198000
         BNZ   @RF00487                                            0487 01199000
         TM    DATEINSW,B'10000000'                                0487 01200000
         BNZ   @RF00487                                            0487 01201000
*         PARMERR='1'B;             /* ERROR                 @Y30LB40*/ 01202000
         OI    PARMERR,B'10000000'                                 0488 01203000
*       SS=SS+9;                    /*                       @ZA13497*/ 01204000
@RF00487 AL    SS,@CF00035                                         0489 01205000
*     END;                          /*                       @Y30LB40*/ 01206000
*   IF PARMHOLD(SS:SS)¬=','         /*                       @ZA13497*/ 01207000
*     THEN                          /*                       @ZA13497*/ 01208000
@RC00454 LA    @03,PARMHOLD-1(SS)                                  0491 01209000
         CLI   0(@03),C','                                         0491 01210000
         BE    @RF00491                                            0491 01211000
*     CALL SELECT;                  /*                       @ZA13497*/ 01212000
         BAL   @14,SELECT                                          0492 01213000
*PARMEND:                                                          0493 01214000
*   IF PARMERR='1'B                 /* WERE THERE ANY ERRORS @Y30LB40*/ 01215000
*     THEN                                                         0493 01216000
@RF00491 DS    0H                                                  0493 01217000
PARMEND  TM    PARMERR,B'10000000'                                 0493 01218000
         BNO   @RF00493                                            0493 01219000
*     DO;                           /* YES                   @Y30LB40*/ 01220000
*       BLKLINE=PARMMSG;            /* PRINT ERROR MESSAGE   @Y30LB40*/ 01221000
         MVI   BLKLINE+28,C' '                                     0495 01222000
         MVC   BLKLINE+29(92),BLKLINE+28                           0495 01223000
         MVC   BLKLINE(28),PARMMSG                                 0495 01224000
*       RFY                                                        0496 01225000
*        (R0,                                                      0496 01226000
*         R1,                                                      0496 01227000
*         R14,                                                     0496 01228000
*         R15) RSTD;                /*                       @Y30LB40*/ 01229000
*       GEN(PUT   PRNTDCB,BLKLINE); /*                       @Y30LB40*/ 01230000
         PUT   PRNTDCB,BLKLINE                                          01231000
*       RFY                                                        0498 01232000
*        (R0,                                                      0498 01233000
*         R1,                                                      0498 01234000
*         R14,                                                     0498 01235000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01236000
*       RETURNCD=8;                 /* SET RETURN CODE = 8   @Y30LB40*/ 01237000
         MVC   RETURNCD(2),@CH00036                                0499 01238000
*     END;                          /*                       @Y30LB40*/ 01239000
*   END GETPARMS;                   /*                       @OZ05079*/ 01240000
@EL00004 DS    0H                                                  0501 01241000
@EF00004 DS    0H                                                  0501 01242000
@ER00004 LM    @14,@12,@SA00004                                    0501 01243000
         BR    @14                                                 0501 01244000
*                                                                  0502 01245000
*/********************************************************** @ZA13497*/ 01246000
*/*                                                          @ZA13497*/ 01247000
*/* PROCEDURE NAME - SELECT                                  @ZA13497*/ 01248000
*/*                                                          @ZA13497*/ 01249000
*/* FUNCTION - CHECK FOR EITHER A VOLID OR A STAGING DRIVE   @ZA13497*/ 01250000
*/*            GROUP SELECT PARAMETER.  IF THE SELECT        @ZA13497*/ 01251000
*/*            PARAMETER IS FOR A STAGING DRIVE GROUP, THE   @ZA13497*/ 01252000
*/*            VALUE IS 'SDGXX', WHERE 'XX' IS A DECIMAL     @ZA13497*/ 01253000
*/*            NUMBER IN THE RANGE 00-27.  IF THE VALUE IS   @ZA13497*/ 01254000
*/*            NOT 'SDGXX', IT IS ASSUMED TO BE A 1 TO 6     @ZA13497*/ 01255000
*/*            CHARACTER VOLID.                              @ZA13497*/ 01256000
*/*                                                          @ZA13497*/ 01257000
*/********************************************************** @ZA13497*/ 01258000
*                                                                  0502 01259000
*SELECT:                                                           0502 01260000
*   PROCEDURE;                      /*                       @ZA13497*/ 01261000
SELECT   STM   @14,@12,12(@13)                                     0502 01262000
*   IF PARMHOLD(SS:SS+2)='SDG'      /*                       @ZA13497*/ 01263000
*       &PARMHOLD(SS+5:SS+5)=','    /*                       @ZA13497*/ 01264000
*     THEN                          /*                       @ZA13497*/ 01265000
         LA    @03,PARMHOLD-1(SS)                                  0503 01266000
         CLC   0(3,@03),@CC01119                                   0503 01267000
         BNE   @RF00503                                            0503 01268000
         LA    @03,PARMHOLD+4(SS)                                  0503 01269000
         CLI   0(@03),C','                                         0503 01270000
         BNE   @RF00503                                            0503 01271000
*     DO;                           /*                       @ZA13497*/ 01272000
*                                                                  0504 01273000
*       /*************************************************************/ 01274000
*       /*                                                           */ 01275000
*       /* *****************************************         @ZA13497*/ 01276000
*       /* COMPARE THE FOURTH AND FIFTH CHARACTERS           @ZA13497*/ 01277000
*       /* FOR VALUES IN THE RANGE 00-27 DECIMAL.            @ZA13497*/ 01278000
*       /* IF MATCH, INDEX VALUE MINUS 1 IS THE              @ZA13497*/ 01279000
*       /* BINARY EQUIVALENT -- SAVE IT AND RETURN.          @ZA13497*/ 01280000
*       /* *****************************************         @ZA13497*/ 01281000
*       /*                                                           */ 01282000
*       /*************************************************************/ 01283000
*                                                                  0505 01284000
*       SDGSAVE=PARMHOLD(SS:SS+4);  /*                       @ZA13497*/ 01285000
         MVI   SDGSAVE+5,C' '                                      0505 01286000
         LA    @03,PARMHOLD-1(SS)                                  0505 01287000
         MVC   SDGSAVE(5),0(@03)                                   0505 01288000
*       DO SDGINDEX=1 TO 28;        /*                       @ZA13497*/ 01289000
         LA    SDGINDEX,1                                          0506 01290000
@DL00506 DS    0H                                                  0507 01291000
*         IF PARMHOLD(SS+3:SS+4)=   /*                       @ZA13497*/ 01292000
*             SDGLOKUP(SDGINDEX)    /*                       @ZA13497*/ 01293000
*           THEN                    /*                       @ZA13497*/ 01294000
         LR    @15,SDGINDEX                                        0507 01295000
         ALR   @15,@15                                             0507 01296000
         LA    @01,PARMHOLD+2(SS)                                  0507 01297000
         LA    @14,SDGLOKUP-2(@15)                                 0507 01298000
         CLC   0(2,@01),0(@14)                                     0507 01299000
         BNE   @RF00507                                            0507 01300000
*           DO;                     /*                       @ZA13497*/ 01301000
*             HOLDSDG=SDGINDEX-1;   /*                       @ZA13497*/ 01302000
         LR    @02,SDGINDEX                                        0509 01303000
         BCTR  @02,0                                               0509 01304000
         STC   @02,HOLDSDG                                         0509 01305000
*             SDGSELSW='1'B;        /*                       @ZA13497*/ 01306000
         OI    SDGSELSW,B'10000000'                                0510 01307000
*             RETURN;               /*                       @ZA13497*/ 01308000
@EL00005 DS    0H                                                  0511 01309000
@EF00005 DS    0H                                                  0511 01310000
@ER00005 LM    @14,@12,12(@13)                                     0511 01311000
         BR    @14                                                 0511 01312000
*           END;                    /*                       @ZA13497*/ 01313000
*       END;                        /*                       @ZA13497*/ 01314000
@RF00507 AL    SDGINDEX,@CF00045                                   0513 01315000
         C     SDGINDEX,@CF00869                                   0513 01316000
         BNH   @DL00506                                            0513 01317000
*     END;                          /*                       @ZA13497*/ 01318000
*   VOLSELSW='1'B;                  /*                       @ZA13497*/ 01319000
@RF00503 OI    VOLSELSW,B'10000000'                                0515 01320000
*   HOLDVOL='      ';               /*                       @ZA13497*/ 01321000
         MVC   HOLDVOL(6),@CC01120                                 0516 01322000
*   DO SDGINDEX=0 TO 5;             /*                       @ZA13497*/ 01323000
         SLR   SDGINDEX,SDGINDEX                                   0517 01324000
@DL00517 DS    0H                                                  0518 01325000
*     IF PARMHOLD(SS+SDGINDEX:SS+SDGINDEX)¬=','/*            @ZA13497*/ 01326000
*       THEN                        /*                       @ZA13497*/ 01327000
         LR    @15,SS                                              0518 01328000
         ALR   @15,SDGINDEX                                        0518 01329000
         LA    @14,PARMHOLD-1(@15)                                 0518 01330000
         CLI   0(@14),C','                                         0518 01331000
         BE    @RF00518                                            0518 01332000
*       DO;                         /*                       @ZA13497*/ 01333000
*         HOLDVOL(1+SDGINDEX:1+SDGINDEX)=/*                  @ZA13497*/ 01334000
*             PARMHOLD(SS+SDGINDEX:SS+SDGINDEX);/*           @ZA13497*/ 01335000
         LA    @01,HOLDVOL(SDGINDEX)                               0520 01336000
         LA    @14,PARMHOLD-1(@15)                                 0520 01337000
         MVC   0(1,@01),0(@14)                                     0520 01338000
*         LENVOLID=SDGINDEX;        /*                       @ZA13497*/ 01339000
         STH   SDGINDEX,LENVOLID                                   0521 01340000
*       END;                        /*                       @ZA13497*/ 01341000
*   END;                            /*                       @ZA13497*/ 01342000
@RF00518 AL    SDGINDEX,@CF00045                                   0523 01343000
         C     SDGINDEX,@CF00376                                   0523 01344000
         BNH   @DL00517                                            0523 01345000
*   END SELECT;                     /*                       @ZA13497*/ 01346000
         B     @EL00005                                            0524 01347000
*                                                                  0525 01348000
*/********************************************************** @OZ05079*/ 01349000
*/*                                                          @OZ05079*/ 01350000
*/* PROCEDURE NAME - OPENOUT                                 @OZ05079*/ 01351000
*/*                                                          @OZ05079*/ 01352000
*/* FUNCTION - IF THE REFORMAT OPTION WAS SPECIFIED (OR      @OZ05079*/ 01353000
*/*            DEFAULTED), OPEN THE TRACEOUT DATA SET.  IF   @OZ05079*/ 01354000
*/*            ERROR DURING OPEN, WRITE MESSAGE 'ICG902      @OZ05079*/ 01355000
*/*            ERROR FOR TRACEOUT', SET A RETURN CODE OF 8,  @OZ05079*/ 01356000
*/*            AND RETURN TO MAINLINE.                       @OZ05079*/ 01357000
*/*                                                          @OZ05079*/ 01358000
*/********************************************************** @OZ05079*/ 01359000
*                                                                  0525 01360000
*OPENOUT:                                                          0525 01361000
*   PROCEDURE;                      /*                       @OZ05079*/ 01362000
OPENOUT  STM   @14,@12,@SA00006                                    0525 01363000
*   RFY                                                            0526 01364000
*    (R0,                                                          0526 01365000
*     R1,                                                          0526 01366000
*     R14,                                                         0526 01367000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01368000
*   GEN(OPEN  (OUTDCB,(OUTPUT)),MF=(E,OPENCLOS));/*          @Y30LB40*/ 01369000
         OPEN  (OUTDCB,(OUTPUT)),MF=(E,OPENCLOS)                        01370000
*   RFY                                                            0528 01371000
*    (R0,                                                          0528 01372000
*     R1,                                                          0528 01373000
*     R14,                                                         0528 01374000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01375000
*   IF(OUTDCB(49:49)&'00010000'B)¬='00010000'B THEN                0529 01376000
         MVC   @TS00001(1),OUTDCB+48                               0529 01377000
         NI    @TS00001,B'00010000'                                0529 01378000
         CLI   @TS00001,B'00010000'                                0529 01379000
         BE    @RF00529                                            0529 01380000
*     DO;                           /* IF OPEN NOT OK        @Y30LB40*/ 01381000
*       BLKLINE=TROUTMSG;           /* PRINT ERROR MESSAGE   @Y30LB40*/ 01382000
         MVI   BLKLINE+32,C' '                                     0531 01383000
         MVC   BLKLINE+33(88),BLKLINE+32                           0531 01384000
         MVC   BLKLINE(32),TROUTMSG                                0531 01385000
*       RFY                                                        0532 01386000
*        (R0,                                                      0532 01387000
*         R1,                                                      0532 01388000
*         R14,                                                     0532 01389000
*         R15) RSTD;                /*                       @Y30LB40*/ 01390000
*       GEN(PUT   PRNTDCB,BLKLINE); /*                       @Y30LB40*/ 01391000
         PUT   PRNTDCB,BLKLINE                                          01392000
*       RFY                                                        0534 01393000
*        (R0,                                                      0534 01394000
*         R1,                                                      0534 01395000
*         R14,                                                     0534 01396000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01397000
*       RETURNCD=8;                 /* SET RETURN CODE=8     @Y30LB40*/ 01398000
         MVC   RETURNCD(2),@CH00036                                0535 01399000
*     END;                          /*                       @Y30LB40*/ 01400000
*   END OPENOUT;                    /*                       @OZ05079*/ 01401000
@EL00006 DS    0H                                                  0537 01402000
@EF00006 DS    0H                                                  0537 01403000
@ER00006 LM    @14,@12,@SA00006                                    0537 01404000
         BR    @14                                                 0537 01405000
*                                                                  0538 01406000
*/********************************************************** @OZ05079*/ 01407000
*/*                                                          @OZ05079*/ 01408000
*/* PROCEDURE NAME: PROCREC6                                 @OZ05079*/ 01409000
*/*                                                          @OZ05079*/ 01410000
*/* FUNCTION - PROCESS VERIFICATION RECORD 6, THE FIRST      @OZ05079*/ 01411000
*/*            RECORD OF THE TRACE FILE TO DETERMINE THE     @OZ05079*/ 01412000
*/*            CONFIGURATION, THAT IS, WHICH SUBSYSTEM UNITS @OZ05079*/ 01413000
*/*            ARE VALID (V), ONLINE (O), AND READY (R).     @OZ05079*/ 01414000
*/*                                                          @OZ05079*/ 01415000
*/********************************************************** @OZ05079*/ 01416000
*                                                                  0538 01417000
*PROCREC6:                                                         0538 01418000
*   PROCEDURE;                      /*                       @OZ05079*/ 01419000
PROCREC6 STM   @14,@06,@SA00007                                    0538 01420000
         STM   @08,@12,@SA00007+36                                 0538 01421000
*   IMLSAVE=IMLCNT;                 /* SAVE IML COUNT OF HEADER    0539 01422000
*                                                            @ZA16141*/ 01423000
         MVC   IMLSAVE(2),IMLCNT                                   0539 01424000
*   M=M+N+1;                        /* BUMP ARRAY COUNTER    @OZ11013*/ 01425000
         LH    @15,M                                               0540 01426000
         AH    @15,N                                               0540 01427000
         AL    @15,@CF00045                                        0540 01428000
         STH   @15,M                                               0540 01429000
*   N=0;                            /* RESET SAME DAY CHECKER      0541 01430000
*                                                            @OZ09557*/ 01431000
         SLR   @14,@14                                             0541 01432000
         STH   @14,N                                               0541 01433000
*   IF M>750                        /* MAX COUNTERS = 750    @OZ09557*/ 01434000
*     THEN                          /*                       @OZ09557*/ 01435000
         LA    @14,750                                             0542 01436000
         CR    @15,@14                                             0542 01437000
         BNH   @RF00542                                            0542 01438000
*     M=750;                        /* DO NOT EXCEED         @OZ09557*/ 01439000
         STH   @14,M                                               0543 01440000
*   CALL GENCONFG;                  /* DRC/DRD TRANSLATE     @OZ05079*/ 01441000
@RF00542 BAL   @14,GENCONFG                                        0544 01442000
*   FRSTSW='0'B;                    /* 1ST HEADER SWITCH OFF @OZ09557*/ 01443000
         NI    FRSTSW,B'01111111'                                  0545 01444000
*   DATEWORK=HOSTDATE;              /*                       @Y30LB40*/ 01445000
         MVC   DATEWORK(4),HOSTDATE                                0546 01446000
*   CVB(HOSTJUL,DATEWORK(3:4));     /* HOST DATE TO BINARY   @OZ09557*/ 01447000
         XC    @TS00001(8),@TS00001                                0547 01448000
         MVC   @TS00001+6(2),DATEWORK+2                            0547 01449000
         CVB   @06,@TS00001                                        0547 01450000
         STH   @06,HOSTJUL                                         0547 01451000
*   MVO(DATEWORK,DATEWORK(1:2));    /*                       @Y30LB40*/ 01452000
         MVO   DATEWORK(4),DATEWORK(2)                             0548 01453000
*   CVB(HOSTYEAR,DATEWORK(3:4));    /*                       @OZ09557*/ 01454000
         XC    @TS00001(8),@TS00001                                0549 01455000
         MVC   @TS00001+6(2),DATEWORK+2                            0549 01456000
         CVB   @06,@TS00001                                        0549 01457000
         STH   @06,HOSTYEAR                                        0549 01458000
*   HOSTTIME=HOSTTIME/100;          /* HOST TIME TO SECONDS  @OZ09557*/ 01459000
         L     @00,HOSTTIME                                        0550 01460000
         SRDA  @00,32                                              0550 01461000
         D     @00,@CF01050                                        0550 01462000
         ST    @01,HOSTTIME                                        0550 01463000
*   HOSTTME=HOSTTIME;               /*                       @OZ09557*/ 01464000
         ST    @01,HOSTTME                                         0551 01465000
*   SRL(DSMTIME,8);                 /* CONVERT DSM TIME TO SECONDS 0552 01466000
*                                                            @Y30LB40*/ 01467000
         L     @06,DSMTIME                                         0552 01468000
         SRL   @06,8                                               0552 01469000
         ST    @06,DSMTIME                                         0552 01470000
*   DSMTIME=DSMTIME/4;              /*                       @Y30LB40*/ 01471000
         L     @06,DSMTIME                                         0553 01472000
         SRL   @06,2                                               0553 01473000
         ST    @06,DSMTIME                                         0553 01474000
*   HDRTME=DSMTIME;                 /*                       @OZ09557*/ 01475000
         ST    @06,HDRTME                                          0554 01476000
*   CALL NEWPAGE;                   /* FORCE NEW PAGE        @Y30LB40*/ 01477000
         BAL   @14,NEWPAGE                                         0555 01478000
*   BLKLINE=HDLINE;                 /*                       @Y30LB40*/ 01479000
         MVC   BLKLINE(121),HDLINE                                 0556 01480000
*   UNPK(BLKLINE(29:33),HOSTDATE(2:4));/*                    @Y30LB40*/ 01481000
         UNPK  BLKLINE+28(5),HOSTDATE+1(3)                         0557 01482000
*   CALL EDITFIX(ADDR(HOSTTIME),4,'S');/*                    @Y30LB40*/ 01483000
         MVC   @AL00001+4(8),@AL00558                              0558 01484000
         LA    @06,HOSTTIME                                        0558 01485000
         ST    @06,@AFTEMPS                                        0558 01486000
         LA    @06,@AFTEMPS                                        0558 01487000
         ST    @06,@AL00001                                        0558 01488000
         LA    @01,@AL00001                                        0558 01489000
         BAL   @14,EDITFIX                                         0558 01490000
*   BLKLINE(54:58)=FIXOUT(9:13);    /* PRINT HOST TIME       @Y30LB40*/ 01491000
         MVC   BLKLINE+53(5),FIXOUT+8                              0559 01492000
*   CALL EDITFIX(ADDR(DSMTIME),4,'S');/*                     @Y30LB40*/ 01493000
         MVC   @AL00001+4(8),@AL00560                              0560 01494000
         LA    @06,DSMTIME                                         0560 01495000
         ST    @06,@AFTEMPS                                        0560 01496000
         LA    @06,@AFTEMPS                                        0560 01497000
         ST    @06,@AL00001                                        0560 01498000
         LA    @01,@AL00001                                        0560 01499000
         BAL   @14,EDITFIX                                         0560 01500000
*   BLKLINE(83:90)=FIXOUT(6:13);    /* PRINT DSM TIME        @Y30LB40*/ 01501000
         MVC   BLKLINE+82(8),FIXOUT+5                              0561 01502000
*   RFY                                                            0562 01503000
*    (R0,                                                          0562 01504000
*     R1,                                                          0562 01505000
*     R14,                                                         0562 01506000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01507000
*   GEN(PUT   PRNTDCB,BLKLINE);     /* PRINT TRACE HEADER    @Y30LB40*/ 01508000
         PUT   PRNTDCB,BLKLINE                                          01509000
*   RFY                                                            0564 01510000
*    (R0,                                                          0564 01511000
*     R1,                                                          0564 01512000
*     R14,                                                         0564 01513000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01514000
*   LINECNT=LINECNT+2;              /*                       @Y30LB40*/ 01515000
         AL    LINECNT,@CF00052                                    0565 01516000
*   BLKLINE='0';                    /* CLEAR PRINT LINE      @Y30LB40*/ 01517000
         MVI   BLKLINE+1,C' '                                      0566 01518000
         MVC   BLKLINE+2(119),BLKLINE+1                            0566 01519000
         MVI   BLKLINE,C'0'                                        0566 01520000
*   LINECNT=LINECNT+1;              /* BUMP LINECOUNTER      @Y30LB40*/ 01521000
         LA    @15,1                                               0567 01522000
         ALR   LINECNT,@15                                         0567 01523000
*                                                                  0568 01524000
*/********************************************************** @OZ05079*/ 01525000
*/*                                                          @OZ05079*/ 01526000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 01527000
*/*                                                          @OZ05079*/ 01528000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 01529000
*/*            STATUS OF DATA RECORDING DEVICES.             @OZ05079*/ 01530000
*/*                                                          @OZ05079*/ 01531000
*/********************************************************** @OZ05079*/ 01532000
*                                                                  0568 01533000
*   I=51;                           /* SET SUBSTRING POINTER         */ 01534000
         LA    I,51                                                0568 01535000
*   BLKLINE(17:42)='DATA RECORDING DEVICES';/* SET PRINT CONSTANT    */ 01536000
         MVI   BLKLINE+38,C' '                                     0569 01537000
         MVC   BLKLINE+39(3),BLKLINE+38                            0569 01538000
         MVC   BLKLINE+16(22),@CC01136                             0569 01539000
*   FOUNDSW='0'B;                   /* INIT 1 VALID FOUND INDICATOR  */ 01540000
         NI    FOUNDSW,B'01111111'                                 0570 01541000
*   DO J=1 TO 4;                    /* LOOP THROUGH 4 LIBRARIES      */ 01542000
         STH   @15,J                                               0571 01543000
@DL00571 DS    0H                                                  0572 01544000
*     STATMASK='10000000'B;         /* SET TEST MASK         @Y30LB40*/ 01545000
         MVI   STATMASK,B'10000000'                                0572 01546000
*     DO K=1 TO 8;                  /* LOOP THROUGH 8 READ WRITES    */ 01547000
         LA    @15,1                                               0573 01548000
         STH   @15,K                                               0573 01549000
@DL00573 DS    0H                                                  0574 01550000
*       IF(VRW(J)&STATMASK)=STATMASK/* IS RW VALID           @Y30LB40*/ 01551000
*         THEN                                                     0574 01552000
         LH    @15,J                                               0574 01553000
         LA    @14,VRW-1(@15)                                      0574 01554000
         MVC   @TS00001(1),0(@14)                                  0574 01555000
         NC    @TS00001(1),STATMASK                                0574 01556000
         CLC   @TS00001(1),STATMASK                                0574 01557000
         BNE   @RF00574                                            0574 01558000
*         DO;                       /* YES                   @Y30LB40*/ 01559000
*           FOUNDSW='1'B;           /* INDICATE VALID FOUND          */ 01560000
         OI    FOUNDSW,B'10000000'                                 0576 01561000
*           BLKLINE(I:I+4)='200-V'; /* SET SSID FORMAT       @Y30LB40*/ 01562000
         LA    @01,BLKLINE-1(I)                                    0577 01563000
         MVC   0(5,@01),@CC01138                                   0577 01564000
*           WORK1=J-1;              /* GET LIBRARY NUMBER    @Y30LB40*/ 01565000
         BCTR  @15,0                                               0578 01566000
         STC   @15,WORK1                                           0578 01567000
*           CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT       @Y30LB40*/ 01568000
         MVC   @AL00001+4(8),@AL00579                              0579 01569000
         LA    @15,WORK1                                           0579 01570000
         ST    @15,@AFTEMPS                                        0579 01571000
         LA    @15,@AFTEMPS                                        0579 01572000
         ST    @15,@AL00001                                        0579 01573000
         LA    @01,@AL00001                                        0579 01574000
         BAL   @14,EDITFIX                                         0579 01575000
*           BLKLINE(I+1:I+1)=FIXOUT(13:13);/* PRINT IT       @Y30LB40*/ 01576000
         LA    @01,BLKLINE(I)                                      0580 01577000
         MVC   0(1,@01),FIXOUT+12                                  0580 01578000
*           WORK1=K-1;              /* GET READ WRITE NUMBER         */ 01579000
         LH    @15,K                                               0581 01580000
         BCTR  @15,0                                               0581 01581000
         STC   @15,WORK1                                           0581 01582000
*           CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT       @Y30LB40*/ 01583000
         MVC   @AL00001+4(8),@AL00582                              0582 01584000
         LA    @15,WORK1                                           0582 01585000
         ST    @15,@AFTEMPS                                        0582 01586000
         LA    @15,@AFTEMPS                                        0582 01587000
         ST    @15,@AL00001                                        0582 01588000
         LA    @01,@AL00001                                        0582 01589000
         BAL   @14,EDITFIX                                         0582 01590000
*           BLKLINE(I+2:I+2)=FIXOUT(13:13);/* PRINT IT       @Y30LB40*/ 01591000
         LA    @01,BLKLINE+1(I)                                    0583 01592000
         MVC   0(1,@01),FIXOUT+12                                  0583 01593000
*           IF(ORW(J)&STATMASK)=STATMASK/* IS RW ONLINE              */ 01594000
*             THEN                                                 0584 01595000
         LH    @01,J                                               0584 01596000
         LA    @15,ORW-1(@01)                                      0584 01597000
         MVC   @TS00001(1),0(@15)                                  0584 01598000
         NC    @TS00001(1),STATMASK                                0584 01599000
         CLC   @TS00001(1),STATMASK                                0584 01600000
         BNE   @RF00584                                            0584 01601000
*             BLKLINE(I+5:I+5)='O'; /* YES,INDICATE IT               */ 01602000
         LA    @01,BLKLINE+4(I)                                    0585 01603000
         MVI   0(@01),C'O'                                         0585 01604000
*           IF(RRW(J)&STATMASK)=STATMASK/* IS RW READY               */ 01605000
*             THEN                                                 0586 01606000
@RF00584 LH    @01,J                                               0586 01607000
         LA    @15,RRW-1(@01)                                      0586 01608000
         MVC   @TS00001(1),0(@15)                                  0586 01609000
         NC    @TS00001(1),STATMASK                                0586 01610000
         CLC   @TS00001(1),STATMASK                                0586 01611000
         BNE   @RF00586                                            0586 01612000
*             BLKLINE(I+6:I+6)='R'; /* YES,INDICATE IT               */ 01613000
         LA    @01,BLKLINE+5(I)                                    0587 01614000
         MVI   0(@01),C'R'                                         0587 01615000
*           I=I+8;                  /* BUMP LINE POINTER     @Y30LB40*/ 01616000
@RF00586 AL    I,@CF00036                                          0588 01617000
*           IF I>121                /* IS LINE FULL          @Y30LB40*/ 01618000
*             THEN                                                 0589 01619000
         C     I,@CF00528                                          0589 01620000
         BNH   @RF00589                                            0589 01621000
*             DO;                   /* YES,PRINT IT          @Y30LB40*/ 01622000
*               RFY                                                0591 01623000
*                (R0,                                              0591 01624000
*                 R1,                                              0591 01625000
*                 R14,                                             0591 01626000
*                 R15) RSTD;        /*                       @Y30LB40*/ 01627000
*               GEN(PUT   PRNTDCB,BLKLINE);/*                @Y30LB40*/ 01628000
         PUT   PRNTDCB,BLKLINE                                          01629000
*               RFY                                                0593 01630000
*                (R0,                                              0593 01631000
*                 R1,                                              0593 01632000
*                 R14,                                             0593 01633000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 01634000
*               LINECNT=LINECNT+1;  /* BUMP LINE COUNTER             */ 01635000
         AL    LINECNT,@CF00045                                    0594 01636000
*               BLKLINE=' ';        /* CLEAR PRINT LINE      @Y30LB40*/ 01637000
         MVI   BLKLINE+1,C' '                                      0595 01638000
         MVC   BLKLINE+2(119),BLKLINE+1                            0595 01639000
         MVI   BLKLINE,C' '                                        0595 01640000
*               I=51;               /* RESET SUBSTRING POINTER       */ 01641000
         LA    I,51                                                0596 01642000
*             END;                  /*                       @Y30LB40*/ 01643000
*         END;                      /*                       @Y30LB40*/ 01644000
@RF00589 DS    0H                                                  0599 01645000
*       SRL(STATMASK,1);            /* SHIFT MASK 1 BIT      @Y30LB40*/ 01646000
@RF00574 SLR   @15,@15                                             0599 01647000
         IC    @15,STATMASK                                        0599 01648000
         SRL   @15,1                                               0599 01649000
         STC   @15,STATMASK                                        0599 01650000
*     END;                          /*                       @Y30LB40*/ 01651000
         LA    @15,1                                               0600 01652000
         AH    @15,K                                               0600 01653000
         STH   @15,K                                               0600 01654000
         C     @15,@CF00036                                        0600 01655000
         BNH   @DL00573                                            0600 01656000
*   END;                            /*                       @Y30LB40*/ 01657000
         LA    @15,1                                               0601 01658000
         AH    @15,J                                               0601 01659000
         STH   @15,J                                               0601 01660000
         C     @15,@CF00104                                        0601 01661000
         BNH   @DL00571                                            0601 01662000
*   CALL HEADPRNT;                  /* PRINT LAST LINE       @OZ05079*/ 01663000
         BAL   @14,HEADPRNT                                        0602 01664000
*                                                                  0603 01665000
*/********************************************************** @OZ05079*/ 01666000
*/*                                                          @OZ05079*/ 01667000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 01668000
*/*                                                          @OZ05079*/ 01669000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 01670000
*/*            STATUS OF STAGING ADAPTERS.                   @OZ05079*/ 01671000
*/*                                                          @OZ05079*/ 01672000
*/********************************************************** @OZ05079*/ 01673000
*                                                                  0603 01674000
*   BLKLINE(17:42)='STAGING ADAPTERS';/* SET PRINT CONSTANT          */ 01675000
         MVI   BLKLINE+32,C' '                                     0603 01676000
         MVC   BLKLINE+33(9),BLKLINE+32                            0603 01677000
         MVC   BLKLINE+16(16),@CC01141                             0603 01678000
*   FOUNDSW='0'B;                   /* INIT 1 VALID FOUND INDICATOR  */ 01679000
         NI    FOUNDSW,B'01111111'                                 0604 01680000
*   DO J=1 TO 2;                    /* LOOP THROUGH 2 GROUPS OF 8  0605 01681000
*                                      DATA STAGERS                  */ 01682000
         LA    @15,1                                               0605 01683000
         STH   @15,J                                               0605 01684000
@DL00605 DS    0H                                                  0606 01685000
*     STATMASK='10000000'B;         /* SET TEST MASK         @Y30LB40*/ 01686000
         MVI   STATMASK,B'10000000'                                0606 01687000
*     DO K=1 TO 8;                  /* LOOP THROUGH 8 DATA STAGERS   */ 01688000
         LA    @15,1                                               0607 01689000
         STH   @15,K                                               0607 01690000
@DL00607 DS    0H                                                  0608 01691000
*       IF(VDS(J)&STATMASK)=STATMASK/* IS DS VALID           @Y30LB40*/ 01692000
*         THEN                                                     0608 01693000
         LH    @14,J                                               0608 01694000
         LA    @01,VDS-1(@14)                                      0608 01695000
         MVC   @TS00001(1),0(@01)                                  0608 01696000
         NC    @TS00001(1),STATMASK                                0608 01697000
         CLC   @TS00001(1),STATMASK                                0608 01698000
         BNE   @RF00608                                            0608 01699000
*         DO;                       /* YES                   @Y30LB40*/ 01700000
*           FOUNDSW='1'B;           /* INDICATE VALID FOUND          */ 01701000
         OI    FOUNDSW,B'10000000'                                 0610 01702000
*           BLKLINE(I:I+4)='800-V'; /* SET SSID FORMAT       @Y30LB40*/ 01703000
         LA    @01,BLKLINE-1(I)                                    0611 01704000
         MVC   0(5,@01),@CC01143                                   0611 01705000
*           WORK1=((J-1)*8)+(K-1);  /* GET DS NUMBER         @Y30LB40*/ 01706000
         BCTR  @14,0                                               0612 01707000
         SLA   @14,3                                               0612 01708000
         BCTR  @15,0                                               0612 01709000
         ALR   @14,@15                                             0612 01710000
         STC   @14,WORK1                                           0612 01711000
*           CALL EDITHEX(ADDR(WORK1),1);/* EDIT IT           @Y30LB40*/ 01712000
         LA    @15,WORK1                                           0613 01713000
         ST    @15,@AFTEMPS                                        0613 01714000
         LA    @15,@AFTEMPS                                        0613 01715000
         ST    @15,@AL00001                                        0613 01716000
         LA    @15,@CF00045                                        0613 01717000
         ST    @15,@AL00001+4                                      0613 01718000
         LA    @01,@AL00001                                        0613 01719000
         BAL   @14,EDITHEX                                         0613 01720000
*           BLKLINE(I+1:I+1)=HEXOUT(2:2);/* PRINT IT         @Y30LB40*/ 01721000
         LA    @01,BLKLINE(I)                                      0614 01722000
         MVC   0(1,@01),HEXOUT+1                                   0614 01723000
*           IF(ODS(J)&STATMASK)=STATMASK/* IS DS ONLINE              */ 01724000
*             THEN                                                 0615 01725000
         LH    @01,J                                               0615 01726000
         LA    @15,ODS-1(@01)                                      0615 01727000
         MVC   @TS00001(1),0(@15)                                  0615 01728000
         NC    @TS00001(1),STATMASK                                0615 01729000
         CLC   @TS00001(1),STATMASK                                0615 01730000
         BNE   @RF00615                                            0615 01731000
*             BLKLINE(I+5:I+5)='O'; /* YES,INDICATE IT               */ 01732000
         LA    @01,BLKLINE+4(I)                                    0616 01733000
         MVI   0(@01),C'O'                                         0616 01734000
*           IF(RDS(J)&STATMASK)=STATMASK/* IS DS READY               */ 01735000
*             THEN                                                 0617 01736000
@RF00615 LH    @01,J                                               0617 01737000
         LA    @15,RDS-1(@01)                                      0617 01738000
         MVC   @TS00001(1),0(@15)                                  0617 01739000
         NC    @TS00001(1),STATMASK                                0617 01740000
         CLC   @TS00001(1),STATMASK                                0617 01741000
         BNE   @RF00617                                            0617 01742000
*             BLKLINE(I+6:I+6)='R'; /* YES,INDICATE IT               */ 01743000
         LA    @01,BLKLINE+5(I)                                    0618 01744000
         MVI   0(@01),C'R'                                         0618 01745000
*           I=I+8;                  /* BUMP LINE POINTER     @Y30LB40*/ 01746000
@RF00617 AL    I,@CF00036                                          0619 01747000
*           IF I>121                /* IS LINE FULL          @Y30LB40*/ 01748000
*             THEN                                                 0620 01749000
         C     I,@CF00528                                          0620 01750000
         BNH   @RF00620                                            0620 01751000
*             DO;                   /* YES,PRINT IT          @Y30LB40*/ 01752000
*               RFY                                                0622 01753000
*                (R0,                                              0622 01754000
*                 R1,                                              0622 01755000
*                 R14,                                             0622 01756000
*                 R15) RSTD;        /*                       @Y30LB40*/ 01757000
*               GEN(PUT   PRNTDCB,BLKLINE);/*                @Y30LB40*/ 01758000
         PUT   PRNTDCB,BLKLINE                                          01759000
*               RFY                                                0624 01760000
*                (R0,                                              0624 01761000
*                 R1,                                              0624 01762000
*                 R14,                                             0624 01763000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 01764000
*               LINECNT=LINECNT+1;  /* BUMP LINE COUNTER             */ 01765000
         AL    LINECNT,@CF00045                                    0625 01766000
*               BLKLINE=' ';        /* CLEAR PRINT LINE      @Y30LB40*/ 01767000
         MVI   BLKLINE+1,C' '                                      0626 01768000
         MVC   BLKLINE+2(119),BLKLINE+1                            0626 01769000
         MVI   BLKLINE,C' '                                        0626 01770000
*               I=51;               /* RESET SUBSTRING POINTER       */ 01771000
         LA    I,51                                                0627 01772000
*             END;                  /*                       @Y30LB40*/ 01773000
*         END;                      /*                       @Y30LB40*/ 01774000
@RF00620 DS    0H                                                  0630 01775000
*       SRL(STATMASK,1);            /* SHIFT MASK 1 BIT      @Y30LB40*/ 01776000
@RF00608 SLR   @15,@15                                             0630 01777000
         IC    @15,STATMASK                                        0630 01778000
         SRL   @15,1                                               0630 01779000
         STC   @15,STATMASK                                        0630 01780000
*     END;                          /*                       @Y30LB40*/ 01781000
         LA    @15,1                                               0631 01782000
         AH    @15,K                                               0631 01783000
         STH   @15,K                                               0631 01784000
         C     @15,@CF00036                                        0631 01785000
         BNH   @DL00607                                            0631 01786000
*   END;                            /*                       @Y30LB40*/ 01787000
         LA    @15,1                                               0632 01788000
         AH    @15,J                                               0632 01789000
         STH   @15,J                                               0632 01790000
         C     @15,@CF00052                                        0632 01791000
         BNH   @DL00605                                            0632 01792000
*   CALL HEADPRNT;                  /* PRINT LAST LINE       @OZ05079*/ 01793000
         BAL   @14,HEADPRNT                                        0633 01794000
*                                                                  0634 01795000
*/********************************************************** @OZ05079*/ 01796000
*/*                                                          @OZ05079*/ 01797000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 01798000
*/*                                                          @OZ05079*/ 01799000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 01800000
*/*            STATUS OF DATA RECORDING CONTROLLERS.         @OZ05079*/ 01801000
*/*                                                          @OZ05079*/ 01802000
*/********************************************************** @OZ05079*/ 01803000
*                                                                  0634 01804000
*   BLKLINE(17:42)='DATA RECORDING CONTROLLERS';/* SET CONSTANT      */ 01805000
         MVC   BLKLINE+16(26),@CC01145                             0634 01806000
*   FOUNDSW='0'B;                   /* INIT 1 VALID FOUND INDICATOR  */ 01807000
         NI    FOUNDSW,B'01111111'                                 0635 01808000
*   DO J=1 TO 2;                    /* LOOP THROUGH 2 GROUPS OF 8  0636 01809000
*                                      CONTROLLERS                   */ 01810000
         LA    @15,1                                               0636 01811000
         STH   @15,J                                               0636 01812000
@DL00636 DS    0H                                                  0637 01813000
*     STATMASK='10000000'B;         /* SET TEST MASK         @Y30LB40*/ 01814000
         MVI   STATMASK,B'10000000'                                0637 01815000
*     DO K=1 TO 8;                  /* LOOP THROUGH 2 GROUPS OF 4  0638 01816000
*                                      CONTROLLERS                   */ 01817000
         LA    @15,1                                               0638 01818000
         STH   @15,K                                               0638 01819000
@DL00638 DS    0H                                                  0639 01820000
*       IF(VRWC(J)&STATMASK)=STATMASK/* IS CONTROLLER VALID          */ 01821000
*         THEN                                                     0639 01822000
         LH    @14,J                                               0639 01823000
         LA    @01,VRWC-1(@14)                                     0639 01824000
         MVC   @TS00001(1),0(@01)                                  0639 01825000
         NC    @TS00001(1),STATMASK                                0639 01826000
         CLC   @TS00001(1),STATMASK                                0639 01827000
         BNE   @RF00639                                            0639 01828000
*         DO;                       /* YES                   @Y30LB40*/ 01829000
*           FOUNDSW='1'B;           /* INDICATE VALID FOUND          */ 01830000
         OI    FOUNDSW,B'10000000'                                 0641 01831000
*           BLKLINE(I:I+4)='400-V'; /* SET SSID FORMAT       @Y30LB40*/ 01832000
         LA    @01,BLKLINE-1(I)                                    0642 01833000
         MVC   0(5,@01),@CC01148                                   0642 01834000
*           IF J=1                  /* IS THIS FIRST GROUP OF 8      */ 01835000
*             THEN                                                 0643 01836000
         C     @14,@CF00045                                        0643 01837000
         BNE   @RF00643                                            0643 01838000
*             IF K>4                /* YES,IS THIS FIRST GROUP OF 4  */ 01839000
*               THEN                                               0644 01840000
         C     @15,@CF00104                                        0644 01841000
         BNH   @RF00644                                            0644 01842000
*               WORK1=1;            /* NO,SET LIBRARY 1      @Y30LB40*/ 01843000
         MVI   WORK1,X'01'                                         0645 01844000
*             ELSE                                                 0646 01845000
*               WORK1=0;            /* YES,SET LIBRARY 0     @Y30LB40*/ 01846000
         B     @RC00644                                            0646 01847000
@RF00644 MVI   WORK1,X'00'                                         0646 01848000
*           ELSE                                                   0647 01849000
*             IF K>4                /* NO,IS THIS FIRST GROUP OF 4   */ 01850000
*               THEN                                               0647 01851000
         B     @RC00643                                            0647 01852000
@RF00643 LH    @15,K                                               0647 01853000
         C     @15,@CF00104                                        0647 01854000
         BNH   @RF00647                                            0647 01855000
*               WORK1=3;            /* NO,SET LIBRARY 3      @Y30LB40*/ 01856000
         MVI   WORK1,X'03'                                         0648 01857000
*             ELSE                                                 0649 01858000
*               WORK1=2;            /* YES,SET LIBRARY 2     @Y30LB40*/ 01859000
         B     @RC00647                                            0649 01860000
@RF00647 MVI   WORK1,X'02'                                         0649 01861000
*           CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT       @Y30LB40*/ 01862000
@RC00647 DS    0H                                                  0650 01863000
@RC00643 MVC   @AL00001+4(8),@AL00650                              0650 01864000
         LA    @15,WORK1                                           0650 01865000
         ST    @15,@AFTEMPS                                        0650 01866000
         LA    @15,@AFTEMPS                                        0650 01867000
         ST    @15,@AL00001                                        0650 01868000
         LA    @01,@AL00001                                        0650 01869000
         BAL   @14,EDITFIX                                         0650 01870000
*           BLKLINE(I+1:I+1)=FIXOUT(13:13);/* PRINT IT       @Y30LB40*/ 01871000
         LA    @01,BLKLINE(I)                                      0651 01872000
         MVC   0(1,@01),FIXOUT+12                                  0651 01873000
*           IF K>4                  /* IS THIS SECOND GROUP OF 4     */ 01874000
*             THEN                                                 0652 01875000
         LH    @15,K                                               0652 01876000
         C     @15,@CF00104                                        0652 01877000
         BNH   @RF00652                                            0652 01878000
*             WORK1=K-5;            /* YES,SET CONTRL NO.    @Y30LB40*/ 01879000
         SL    @15,@CF00376                                        0653 01880000
         STC   @15,WORK1                                           0653 01881000
*           ELSE                                                   0654 01882000
*             WORK1=K-1;            /* NO,SET CONTRL NO.     @Y30LB40*/ 01883000
         B     @RC00652                                            0654 01884000
@RF00652 LH    @15,K                                               0654 01885000
         BCTR  @15,0                                               0654 01886000
         STC   @15,WORK1                                           0654 01887000
*           CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT       @Y30LB40*/ 01888000
@RC00652 MVC   @AL00001+4(8),@AL00655                              0655 01889000
         LA    @15,WORK1                                           0655 01890000
         ST    @15,@AFTEMPS                                        0655 01891000
         LA    @15,@AFTEMPS                                        0655 01892000
         ST    @15,@AL00001                                        0655 01893000
         LA    @01,@AL00001                                        0655 01894000
         BAL   @14,EDITFIX                                         0655 01895000
*           BLKLINE(I+2:I+2)=FIXOUT(13:13);/* PRINT IT       @Y30LB40*/ 01896000
         LA    @01,BLKLINE+1(I)                                    0656 01897000
         MVC   0(1,@01),FIXOUT+12                                  0656 01898000
*           IF(ORWC(J)&STATMASK)=STATMASK/* IS CONTRL ONLINE         */ 01899000
*             THEN                                                 0657 01900000
         LH    @01,J                                               0657 01901000
         LA    @15,ORWC-1(@01)                                     0657 01902000
         MVC   @TS00001(1),0(@15)                                  0657 01903000
         NC    @TS00001(1),STATMASK                                0657 01904000
         CLC   @TS00001(1),STATMASK                                0657 01905000
         BNE   @RF00657                                            0657 01906000
*             BLKLINE(I+5:I+5)='O'; /* YES,INDICATE IT               */ 01907000
         LA    @01,BLKLINE+4(I)                                    0658 01908000
         MVI   0(@01),C'O'                                         0658 01909000
*           IF(RRWC(J)&STATMASK)=STATMASK/* IS CONTRL READY          */ 01910000
*             THEN                                                 0659 01911000
@RF00657 LH    @01,J                                               0659 01912000
         LA    @15,RRWC-1(@01)                                     0659 01913000
         MVC   @TS00001(1),0(@15)                                  0659 01914000
         NC    @TS00001(1),STATMASK                                0659 01915000
         CLC   @TS00001(1),STATMASK                                0659 01916000
         BNE   @RF00659                                            0659 01917000
*             BLKLINE(I+6:I+6)='R'; /* YES,INDICATE IT               */ 01918000
         LA    @01,BLKLINE+5(I)                                    0660 01919000
         MVI   0(@01),C'R'                                         0660 01920000
*           I=I+8;                  /* BUMP LINE POINTER     @Y30LB40*/ 01921000
@RF00659 AL    I,@CF00036                                          0661 01922000
*           IF I>121                /* IS LINE FULL          @Y30LB40*/ 01923000
*             THEN                                                 0662 01924000
         C     I,@CF00528                                          0662 01925000
         BNH   @RF00662                                            0662 01926000
*             DO;                   /* YES,PRINT IT          @Y30LB40*/ 01927000
*               RFY                                                0664 01928000
*                (R0,                                              0664 01929000
*                 R1,                                              0664 01930000
*                 R14,                                             0664 01931000
*                 R15) RSTD;        /*                       @Y30LB40*/ 01932000
*               GEN(PUT   PRNTDCB,BLKLINE);/*                @Y30LB40*/ 01933000
         PUT   PRNTDCB,BLKLINE                                          01934000
*               RFY                                                0666 01935000
*                (R0,                                              0666 01936000
*                 R1,                                              0666 01937000
*                 R14,                                             0666 01938000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 01939000
*               LINECNT=LINECNT+1;  /* BUMP LINE COUNTER             */ 01940000
         AL    LINECNT,@CF00045                                    0667 01941000
*               BLKLINE=' ';        /* CLEAR PRINT LINE      @Y30LB40*/ 01942000
         MVI   BLKLINE+1,C' '                                      0668 01943000
         MVC   BLKLINE+2(119),BLKLINE+1                            0668 01944000
         MVI   BLKLINE,C' '                                        0668 01945000
*               I=51;               /* RESET SUBSTRING POINTER       */ 01946000
         LA    I,51                                                0669 01947000
*             END;                  /*                       @Y30LB40*/ 01948000
*         END;                      /*                       @Y30LB40*/ 01949000
@RF00662 DS    0H                                                  0672 01950000
*       SRL(STATMASK,1);            /* SHIFT MASK 1 BIT      @Y30LB40*/ 01951000
@RF00639 SLR   @15,@15                                             0672 01952000
         IC    @15,STATMASK                                        0672 01953000
         SRL   @15,1                                               0672 01954000
         STC   @15,STATMASK                                        0672 01955000
*     END;                          /*                       @Y30LB40*/ 01956000
         LA    @15,1                                               0673 01957000
         AH    @15,K                                               0673 01958000
         STH   @15,K                                               0673 01959000
         C     @15,@CF00036                                        0673 01960000
         BNH   @DL00638                                            0673 01961000
*   END;                            /*                       @Y30LB40*/ 01962000
         LA    @15,1                                               0674 01963000
         AH    @15,J                                               0674 01964000
         STH   @15,J                                               0674 01965000
         C     @15,@CF00052                                        0674 01966000
         BNH   @DL00636                                            0674 01967000
*   CALL HEADPRNT;                  /* PRINT LAST LINE       @OZ05079*/ 01968000
         BAL   @14,HEADPRNT                                        0675 01969000
*                                                                  0676 01970000
*/********************************************************** @OZ05079*/ 01971000
*/*                                                          @OZ05079*/ 01972000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 01973000
*/*                                                          @OZ05079*/ 01974000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 01975000
*/*            STATUS OF STAGING DRIVES WITHIN STAGING       @OZ05079*/ 01976000
*/*            DRIVE GROUPS.                                 @OZ05079*/ 01977000
*/*                                                          @OZ05079*/ 01978000
*/********************************************************** @OZ05079*/ 01979000
*                                                                  0676 01980000
*   DO J=1 TO 30;                   /* LOOP THROUGH 30 RSGS          */ 01981000
         LA    @06,1                                               0676 01982000
         STH   @06,J                                               0676 01983000
@DL00676 DS    0H                                                  0677 01984000
*     IF VRSG(J)='00000000'B        /* IS SPINDLE GROUP VALID        */ 01985000
*       THEN                                                       0677 01986000
         LA    @01,VRSG-1(@06)                                     0677 01987000
         CLI   0(@01),B'00000000'                                  0677 01988000
         BE    @RT00677                                            0677 01989000
*       ;                           /* NO,SKIP TO NEXT       @Y30LB40*/ 01990000
*     ELSE                                                         0679 01991000
*       DO;                         /* YES,PROCESS IT        @Y30LB40*/ 01992000
*         FOUNDSW='1'B;             /* INDICATE VALID FOUND          */ 01993000
         OI    FOUNDSW,B'10000000'                                 0680 01994000
*         I=51;                     /* SET SUBSTRING POINTER         */ 01995000
         LA    I,51                                                0681 01996000
*         BLKLINE(17:42)='STAGING DRIVE GROUP XX';/* SET CONSTANT    */ 01997000
         MVI   BLKLINE+38,C' '                                     0682 01998000
         MVC   BLKLINE+39(3),BLKLINE+38                            0682 01999000
         MVC   BLKLINE+16(22),@CC01149                             0682 02000000
*         WORK1=J-1;                /* GET RSG NUMBER        @Y30LB40*/ 02001000
         LH    @15,J                                               0683 02002000
         BCTR  @15,0                                               0683 02003000
         STC   @15,WORK1                                           0683 02004000
*         CALL EDITHEX(ADDR(WORK1),1);/* EDIT IT             @Y30LB40*/ 02005000
         LA    @15,WORK1                                           0684 02006000
         ST    @15,@AFTEMPS                                        0684 02007000
         LA    @15,@AFTEMPS                                        0684 02008000
         ST    @15,@AL00001                                        0684 02009000
         LA    @15,@CF00045                                        0684 02010000
         ST    @15,@AL00001+4                                      0684 02011000
         LA    @01,@AL00001                                        0684 02012000
         BAL   @14,EDITHEX                                         0684 02013000
*         BLKLINE(37:38)=HEXOUT(1:2);/* PRINT IT             @Y30LB40*/ 02014000
         MVC   BLKLINE+36(2),HEXOUT                                0685 02015000
*         STATMASK='10000000'B;     /* SET TEST MASK         @Y30LB40*/ 02016000
         MVI   STATMASK,B'10000000'                                0686 02017000
*         DO K=1 TO 8;              /* LOOP THROUGH 8 SPINDLES       */ 02018000
         LA    @15,1                                               0687 02019000
         STH   @15,K                                               0687 02020000
@DL00687 DS    0H                                                  0688 02021000
*           IF(VRSG(J)&STATMASK)=STATMASK/* IS SPINDLE VALID         */ 02022000
*             THEN                                                 0688 02023000
         LH    @14,J                                               0688 02024000
         LA    @01,VRSG-1(@14)                                     0688 02025000
         MVC   @TS00001(1),0(@01)                                  0688 02026000
         NC    @TS00001(1),STATMASK                                0688 02027000
         CLC   @TS00001(1),STATMASK                                0688 02028000
         BNE   @RF00688                                            0688 02029000
*             DO;                   /* YES                   @Y30LB40*/ 02030000
*               BLKLINE(I:I+4)='000-V';/* SET SSID FORMAT            */ 02031000
         LA    @01,BLKLINE-1(I)                                    0690 02032000
         MVC   0(5,@01),@CC01153                                   0690 02033000
*               WORK1=((J-1)*8)+(K-1);/* GET SPINDLE NUMBER          */ 02034000
         BCTR  @14,0                                               0691 02035000
         SLA   @14,3                                               0691 02036000
         BCTR  @15,0                                               0691 02037000
         ALR   @14,@15                                             0691 02038000
         STC   @14,WORK1                                           0691 02039000
*               CALL EDITHEX(ADDR(WORK1),1);/* EDIT IT       @Y30LB40*/ 02040000
         LA    @15,WORK1                                           0692 02041000
         ST    @15,@AFTEMPS                                        0692 02042000
         LA    @15,@AFTEMPS                                        0692 02043000
         ST    @15,@AL00001                                        0692 02044000
         LA    @15,@CF00045                                        0692 02045000
         ST    @15,@AL00001+4                                      0692 02046000
         LA    @01,@AL00001                                        0692 02047000
         BAL   @14,EDITHEX                                         0692 02048000
*               BLKLINE(I+1:I+2)=HEXOUT(1:2);/* PRINT IT             */ 02049000
         LA    @01,BLKLINE(I)                                      0693 02050000
         MVC   0(2,@01),HEXOUT                                     0693 02051000
*               IF(ORSG(J)&STATMASK)=STATMASK/* IS IT ONLINE         */ 02052000
*                 THEN                                             0694 02053000
         LH    @01,J                                               0694 02054000
         LA    @15,ORSG-1(@01)                                     0694 02055000
         MVC   @TS00001(1),0(@15)                                  0694 02056000
         NC    @TS00001(1),STATMASK                                0694 02057000
         CLC   @TS00001(1),STATMASK                                0694 02058000
         BNE   @RF00694                                            0694 02059000
*                 BLKLINE(I+5:I+5)='O';/* YES,INDICATE IT            */ 02060000
         LA    @01,BLKLINE+4(I)                                    0695 02061000
         MVI   0(@01),C'O'                                         0695 02062000
*               IF(RRSG(J)&STATMASK)=STATMASK/* IS IT READY          */ 02063000
*                 THEN                                             0696 02064000
@RF00694 LH    @01,J                                               0696 02065000
         LA    @15,RRSG-1(@01)                                     0696 02066000
         MVC   @TS00001(1),0(@15)                                  0696 02067000
         NC    @TS00001(1),STATMASK                                0696 02068000
         CLC   @TS00001(1),STATMASK                                0696 02069000
         BNE   @RF00696                                            0696 02070000
*                 BLKLINE(I+6:I+6)='R';/* YES,INDICATE IT            */ 02071000
         LA    @01,BLKLINE+5(I)                                    0697 02072000
         MVI   0(@01),C'R'                                         0697 02073000
*               I=I+8;              /* BUMP LINE POINTER             */ 02074000
@RF00696 AL    I,@CF00036                                          0698 02075000
*             END;                  /*                       @Y30LB40*/ 02076000
*           SRL(STATMASK,1);        /* SHIFT MASK 1 BIT      @Y30LB40*/ 02077000
@RF00688 SLR   @15,@15                                             0700 02078000
         IC    @15,STATMASK                                        0700 02079000
         SRL   @15,1                                               0700 02080000
         STC   @15,STATMASK                                        0700 02081000
*         END;                      /*                       @Y30LB40*/ 02082000
         LA    @15,1                                               0701 02083000
         AH    @15,K                                               0701 02084000
         STH   @15,K                                               0701 02085000
         C     @15,@CF00036                                        0701 02086000
         BNH   @DL00687                                            0701 02087000
*         RFY                                                      0702 02088000
*          (R0,                                                    0702 02089000
*           R1,                                                    0702 02090000
*           R14,                                                   0702 02091000
*           R15) RSTD;              /*                       @Y30LB40*/ 02092000
*         GEN(PUT   PRNTDCB,BLKLINE);/* PRINT LINE           @Y30LB40*/ 02093000
         PUT   PRNTDCB,BLKLINE                                          02094000
*         RFY                                                      0704 02095000
*          (R0,                                                    0704 02096000
*           R1,                                                    0704 02097000
*           R14,                                                   0704 02098000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 02099000
*         LINECNT=LINECNT+1;        /* BUMP LINE COUNTER     @Y30LB40*/ 02100000
         AL    LINECNT,@CF00045                                    0705 02101000
*         BLKLINE=' ';              /* CLEAR PRINT LINE      @Y30LB40*/ 02102000
         MVI   BLKLINE+1,C' '                                      0706 02103000
         MVC   BLKLINE+2(119),BLKLINE+1                            0706 02104000
         MVI   BLKLINE,C' '                                        0706 02105000
*       END;                        /*                       @Y30LB40*/ 02106000
*   END;                            /*                       @Y30LB40*/ 02107000
@RT00677 LA    @06,1                                               0708 02108000
         AH    @06,J                                               0708 02109000
         STH   @06,J                                               0708 02110000
         C     @06,@CF00447                                        0708 02111000
         BNH   @DL00676                                            0708 02112000
*   IF FOUNDSW='0'B                 /* WERE ANY VALID GROUPS FOUND   */ 02113000
*     THEN                                                         0709 02114000
         TM    FOUNDSW,B'10000000'                                 0709 02115000
         BNZ   @RF00709                                            0709 02116000
*     DO;                           /* NO                    @Y30LB40*/ 02117000
*       BLKLINE(17:42)='STAGING DRIVE GROUPS';/* SET CONSTANT        */ 02118000
         MVI   BLKLINE+36,C' '                                     0711 02119000
         MVC   BLKLINE+37(5),BLKLINE+36                            0711 02120000
         MVC   BLKLINE+16(20),@CC01154                             0711 02121000
*       BLKLINE(51:54)='NONE';      /* INDICATE NONE FOUND   @Y30LB40*/ 02122000
         MVC   BLKLINE+50(4),@CC01156                              0712 02123000
*       RFY                                                        0713 02124000
*        (R0,                                                      0713 02125000
*         R1,                                                      0713 02126000
*         R14,                                                     0713 02127000
*         R15) RSTD;                /*                       @Y30LB40*/ 02128000
*       GEN(PUT   PRNTDCB,BLKLINE); /* PRINT MESSAGE         @Y30LB40*/ 02129000
         PUT   PRNTDCB,BLKLINE                                          02130000
*       RFY                                                        0715 02131000
*        (R0,                                                      0715 02132000
*         R1,                                                      0715 02133000
*         R14,                                                     0715 02134000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 02135000
*       LINECNT=LINECNT+1;          /* BUMP LINE COUNT       @Y30LB40*/ 02136000
         AL    LINECNT,@CF00045                                    0716 02137000
*     END;                          /*                       @Y30LB40*/ 02138000
*   BLKLINE='0';                    /* CLEAR PRINT LINE      @Y30LB40*/ 02139000
@RF00709 MVI   BLKLINE+1,C' '                                      0718 02140000
         MVC   BLKLINE+2(119),BLKLINE+1                            0718 02141000
         MVI   BLKLINE,C'0'                                        0718 02142000
*   LINECNT=LINECNT+2;              /* BUMP LINE COUNTER     @Y30LB40*/ 02143000
         AL    LINECNT,@CF00052                                    0719 02144000
*                                                                  0720 02145000
*/********************************************************** @OZ05079*/ 02146000
*/*                                                          @OZ05079*/ 02147000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 02148000
*/*                                                          @OZ05079*/ 02149000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 02150000
*/*            STATUS OF THE ACCESSOR CONTROLS WITHIN EACH   @OZ05079*/ 02151000
*/*            MASS STORAGE FACILITY.                        @OZ05079*/ 02152000
*/*                                                          @OZ05079*/ 02153000
*/********************************************************** @OZ05079*/ 02154000
*                                                                  0720 02155000
*   I=51;                           /* SET SUBSTRING POINTER         */ 02156000
         LA    I,51                                                0720 02157000
*   BLKLINE(17:36)='ACCESSOR CONTROLS';/* SET CONSTANT       @OZ05079*/ 02158000
         MVI   BLKLINE+33,C' '                                     0721 02159000
         MVC   BLKLINE+34(2),BLKLINE+33                            0721 02160000
         MVC   BLKLINE+16(17),@CC01158                             0721 02161000
*   IF VL='00000000'B               /* ANY LIBRARIES VALID   @Y30LB40*/ 02162000
*     THEN                                                         0722 02163000
         CLI   VL,B'00000000'                                      0722 02164000
         BNE   @RF00722                                            0722 02165000
*     DO;                           /* NO                    @Y30LB40*/ 02166000
*       BLKLINE(51:54)='NONE';      /* INDICATE NONE FOUND   @Y30LB40*/ 02167000
         MVC   BLKLINE+50(4),@CC01156                              0724 02168000
*       RFY                                                        0725 02169000
*        (R0,                                                      0725 02170000
*         R1,                                                      0725 02171000
*         R14,                                                     0725 02172000
*         R15) RSTD;                /*                       @Y30LB40*/ 02173000
*       GEN(PUT   PRNTDCB,BLKLINE); /* PRINT LINE            @Y30LB40*/ 02174000
         PUT   PRNTDCB,BLKLINE                                          02175000
*       RFY                                                        0727 02176000
*        (R0,                                                      0727 02177000
*         R1,                                                      0727 02178000
*         R14,                                                     0727 02179000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 02180000
*     END;                          /*                       @Y30LB40*/ 02181000
*   ELSE                                                           0729 02182000
*     DO;                           /* AT LEAST ONE LIBRARY VALID    */ 02183000
         B     @RC00722                                            0729 02184000
@RF00722 DS    0H                                                  0730 02185000
*       DO J=1 TO 4;                /* LOOP THROUGH 4 LIBRARIES      */ 02186000
         LA    @15,1                                               0730 02187000
         STH   @15,J                                               0730 02188000
@DL00730 DS    0H                                                  0731 02189000
*         WORK1=J-1;                /* CALC LIB NUMBER       @Y30LB40*/ 02190000
         BCTR  @15,0                                               0731 02191000
         STC   @15,WORK1                                           0731 02192000
*         CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT         @Y30LB40*/ 02193000
         MVC   @AL00001+4(8),@AL00732                              0732 02194000
         LA    @15,WORK1                                           0732 02195000
         ST    @15,@AFTEMPS                                        0732 02196000
         LA    @15,@AFTEMPS                                        0732 02197000
         ST    @15,@AL00001                                        0732 02198000
         LA    @01,@AL00001                                        0732 02199000
         BAL   @14,EDITFIX                                         0732 02200000
*         IF(VL&'01000000'B)='01000000'B/* IS UC1 VALID              */ 02201000
*           THEN                                                   0733 02202000
         MVC   @TS00001(1),VL                                      0733 02203000
         NI    @TS00001,B'01000000'                                0733 02204000
         CLI   @TS00001,B'01000000'                                0733 02205000
         BNE   @RF00733                                            0733 02206000
*           DO;                     /* YES                   @Y30LB40*/ 02207000
*             BLKLINE(I:I+4)='101-V';/* SET SSID PATTERN             */ 02208000
         LA    @01,BLKLINE-1(I)                                    0735 02209000
         MVC   0(5,@01),@CC01161                                   0735 02210000
*             BLKLINE(I+1:I+1)=FIXOUT(13:13);/* PUT IN LIB           */ 02211000
         LA    @01,BLKLINE(I)                                      0736 02212000
         MVC   0(1,@01),FIXOUT+12                                  0736 02213000
*             IF(OL&'01000000'B)='01000000'B/* IS UC1 ONLINE         */ 02214000
*               THEN                                               0737 02215000
         MVC   @TS00001(1),OL                                      0737 02216000
         NI    @TS00001,B'01000000'                                0737 02217000
         CLI   @TS00001,B'01000000'                                0737 02218000
         BNE   @RF00737                                            0737 02219000
*               BLKLINE(I+5:I+5)='O';/* YES,INDICATE IT              */ 02220000
         LA    @01,BLKLINE+4(I)                                    0738 02221000
         MVI   0(@01),C'O'                                         0738 02222000
*             IF(RL&'01000000'B)='01000000'B/* IS UC1 READY          */ 02223000
*               THEN                                               0739 02224000
@RF00737 MVC   @TS00001(1),RL                                      0739 02225000
         NI    @TS00001,B'01000000'                                0739 02226000
         CLI   @TS00001,B'01000000'                                0739 02227000
         BNE   @RF00739                                            0739 02228000
*               BLKLINE(I+6:I+6)='R';/* YES,INDICATE IT              */ 02229000
         LA    @01,BLKLINE+5(I)                                    0740 02230000
         MVI   0(@01),C'R'                                         0740 02231000
*             I=I+8;                /* BUMP LINE POINTER     @Y30LB40*/ 02232000
@RF00739 AL    I,@CF00036                                          0741 02233000
*           END;                    /*                       @Y30LB40*/ 02234000
*         IF(VL&'10000000'B)='10000000'B/* IS UC2 VALID              */ 02235000
*           THEN                                                   0743 02236000
@RF00733 MVC   @TS00001(1),VL                                      0743 02237000
         NI    @TS00001,B'10000000'                                0743 02238000
         CLI   @TS00001,B'10000000'                                0743 02239000
         BNE   @RF00743                                            0743 02240000
*           DO;                     /* YES                   @Y30LB40*/ 02241000
*             BLKLINE(I:I+4)='102-V';/* SET SSID PATTERN             */ 02242000
         LA    @01,BLKLINE-1(I)                                    0745 02243000
         MVC   0(5,@01),@CC01162                                   0745 02244000
*             BLKLINE(I+1:I+1)=FIXOUT(13:13);/* PUT IN LIB           */ 02245000
         LA    @01,BLKLINE(I)                                      0746 02246000
         MVC   0(1,@01),FIXOUT+12                                  0746 02247000
*             IF(OL&'10000000'B)='10000000'B/* IS UC2 ONLINE         */ 02248000
*               THEN                                               0747 02249000
         MVC   @TS00001(1),OL                                      0747 02250000
         NI    @TS00001,B'10000000'                                0747 02251000
         CLI   @TS00001,B'10000000'                                0747 02252000
         BNE   @RF00747                                            0747 02253000
*               BLKLINE(I+5:I+5)='O';/* YES,INDICATE IT              */ 02254000
         LA    @01,BLKLINE+4(I)                                    0748 02255000
         MVI   0(@01),C'O'                                         0748 02256000
*             IF(RL&'10000000'B)='10000000'B/* IS UC2 READY          */ 02257000
*               THEN                                               0749 02258000
@RF00747 MVC   @TS00001(1),RL                                      0749 02259000
         NI    @TS00001,B'10000000'                                0749 02260000
         CLI   @TS00001,B'10000000'                                0749 02261000
         BNE   @RF00749                                            0749 02262000
*               BLKLINE(I+6:I+6)='R';/* YES,INDICATE IT              */ 02263000
         LA    @01,BLKLINE+5(I)                                    0750 02264000
         MVI   0(@01),C'R'                                         0750 02265000
*             I=I+8;                /* BUMP LINE POINTER     @Y30LB40*/ 02266000
@RF00749 AL    I,@CF00036                                          0751 02267000
*           END;                    /*                       @Y30LB40*/ 02268000
*         SLL(VL,2);                /* SHIFT VL 2 BITS       @Y30LB40*/ 02269000
@RF00743 SLR   @15,@15                                             0753 02270000
         IC    @15,VL                                              0753 02271000
         SLL   @15,2                                               0753 02272000
         STC   @15,VL                                              0753 02273000
*         SLL(OL,2);                /* SHIFT OL 2 BITS       @Y30LB40*/ 02274000
         SLR   @15,@15                                             0754 02275000
         IC    @15,OL                                              0754 02276000
         SLL   @15,2                                               0754 02277000
         STC   @15,OL                                              0754 02278000
*         SLL(RL,2);                /* SHIFT RL 2 BITS       @Y30LB40*/ 02279000
         SLR   @15,@15                                             0755 02280000
         IC    @15,RL                                              0755 02281000
         SLL   @15,2                                               0755 02282000
         STC   @15,RL                                              0755 02283000
*       END;                        /*                       @Y30LB40*/ 02284000
         LA    @15,1                                               0756 02285000
         AH    @15,J                                               0756 02286000
         STH   @15,J                                               0756 02287000
         C     @15,@CF00104                                        0756 02288000
         BNH   @DL00730                                            0756 02289000
*       RFY                                                        0757 02290000
*        (R0,                                                      0757 02291000
*         R1,                                                      0757 02292000
*         R14,                                                     0757 02293000
*         R15) RSTD;                /*                       @Y30LB40*/ 02294000
*       GEN(PUT   PRNTDCB,BLKLINE); /* PRINT LINE            @Y30LB40*/ 02295000
         PUT   PRNTDCB,BLKLINE                                          02296000
*       RFY                                                        0759 02297000
*        (R0,                                                      0759 02298000
*         R1,                                                      0759 02299000
*         R14,                                                     0759 02300000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 02301000
*     END;                          /*                       @Y30LB40*/ 02302000
*   END PROCREC6;                   /*                       @OZ05079*/ 02303000
@EL00007 DS    0H                                                  0761 02304000
@EF00007 DS    0H                                                  0761 02305000
@ER00007 LM    @14,@06,@SA00007                                    0761 02306000
         LM    @08,@12,@SA00007+36                                 0761 02307000
         BR    @14                                                 0761 02308000
*                                                                  0762 02309000
*/********************************************************** @OZ05079*/ 02310000
*/*                                                          @OZ05079*/ 02311000
*/* PROCEDURE NAME - HEADPRNT                                @OZ05079*/ 02312000
*/*                                                          @OZ05079*/ 02313000
*/* FUNCTION - PRINT THE LAST (OR ONLY) LINE FOR EACH        @OZ05079*/ 02314000
*/*            SUBSYSTEM DEVICE TYPE.  IF NO DEVICES WERE    @OZ05079*/ 02315000
*/*            FOUND TO BE VALID, PRINT 'NONE'.              @OZ05079*/ 02316000
*/*                                                          @OZ05079*/ 02317000
*/********************************************************** @OZ05079*/ 02318000
*                                                                  0762 02319000
*HEADPRNT:                                                         0762 02320000
*   PROCEDURE;                      /*                       @OZ05079*/ 02321000
HEADPRNT STM   @14,@05,@SA00008                                    0762 02322000
         STM   @08,@12,@SA00008+32                                 0762 02323000
*   IF I=51                         /* IS POINTER AT START OF LINE   */ 02324000
*     THEN                                                         0763 02325000
         C     I,@CF00484                                          0763 02326000
         BNE   @RF00763                                            0763 02327000
*     IF FOUNDSW='0'B               /* YES,WERE ANY VALIDS FOUND     */ 02328000
*       THEN                                                       0764 02329000
         TM    FOUNDSW,B'10000000'                                 0764 02330000
         BNZ   @RF00764                                            0764 02331000
*       DO;                         /* NO VALIDS FOUND       @Y30LB40*/ 02332000
*         BLKLINE(51:54)='NONE';    /* INDICATE NONE FOUND   @Y30LB40*/ 02333000
         MVC   BLKLINE+50(4),@CC01156                              0766 02334000
*         RFY                                                      0767 02335000
*          (R0,                                                    0767 02336000
*           R1,                                                    0767 02337000
*           R14,                                                   0767 02338000
*           R15) RSTD;              /*                       @Y30LB40*/ 02339000
*         GEN(PUT   PRNTDCB,BLKLINE);/* PRINT LINE           @Y30LB40*/ 02340000
         PUT   PRNTDCB,BLKLINE                                          02341000
*         RFY                                                      0769 02342000
*          (R0,                                                    0769 02343000
*           R1,                                                    0769 02344000
*           R14,                                                   0769 02345000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 02346000
*         LINECNT=LINECNT+1;        /* BUMP LINE COUNTER     @Y30LB40*/ 02347000
         AL    LINECNT,@CF00045                                    0770 02348000
*       END;                        /*                       @Y30LB40*/ 02349000
*     ELSE                                                         0772 02350000
*       ;                           /* VALIDS FOUND,LINE ALREADY   0772 02351000
*                                      WRITTEN               @Y30LB40*/ 02352000
@RF00764 DS    0H                                                  0773 02353000
*   ELSE                                                           0773 02354000
*     DO;                           /* POINTER NOT 51        @Y30LB40*/ 02355000
         B     @RC00763                                            0773 02356000
@RF00763 DS    0H                                                  0774 02357000
*       RFY                                                        0774 02358000
*        (R0,                                                      0774 02359000
*         R1,                                                      0774 02360000
*         R14,                                                     0774 02361000
*         R15) RSTD;                /*                       @Y30LB40*/ 02362000
*       GEN(PUT   PRNTDCB,BLKLINE); /* PRINT LINE            @Y30LB40*/ 02363000
         PUT   PRNTDCB,BLKLINE                                          02364000
*       RFY                                                        0776 02365000
*        (R0,                                                      0776 02366000
*         R1,                                                      0776 02367000
*         R14,                                                     0776 02368000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 02369000
*       LINECNT=LINECNT+1;          /* BUMP LINE COUNTER     @Y30LB40*/ 02370000
         AL    LINECNT,@CF00045                                    0777 02371000
*     END;                          /*                       @Y30LB40*/ 02372000
*   BLKLINE='0';                    /* CLEAR PRINT LINE      @Y30LB40*/ 02373000
@RC00763 MVI   BLKLINE+1,C' '                                      0779 02374000
         MVC   BLKLINE+2(119),BLKLINE+1                            0779 02375000
         MVI   BLKLINE,C'0'                                        0779 02376000
*   LINECNT=LINECNT+1;              /* BUMP LINE COUNTER     @Y30LB40*/ 02377000
         AL    LINECNT,@CF00045                                    0780 02378000
*   I=51;                           /* SET SUBSTRING POINTER         */ 02379000
         LA    I,51                                                0781 02380000
*   END HEADPRNT;                   /*                       @OZ05079*/ 02381000
@EL00008 DS    0H                                                  0782 02382000
@EF00008 DS    0H                                                  0782 02383000
@ER00008 LM    @14,@05,@SA00008                                    0782 02384000
         LM    @08,@12,@SA00008+32                                 0782 02385000
         BR    @14                                                 0782 02386000
*                                                                  0783 02387000
*/********************************************************** @OZ05079*/ 02388000
*/*                                                          @OZ05079*/ 02389000
*/* PROCEDURE NAME - REFORMAT                                @OZ05079*/ 02390000
*/*                                                          @OZ05079*/ 02391000
*/* FUNCTION - BUILD REFORMATTED EXTRACT RECORD              @OZ05079*/ 02392000
*/*                                                          @OZ05079*/ 02393000
*/********************************************************** @OZ05079*/ 02394000
*                                                                  0783 02395000
*REFORMAT:                                                         0783 02396000
*   PROCEDURE;                      /*                       @OZ05079*/ 02397000
REFORMAT STM   @14,@12,@SA00009                                    0783 02398000
*   RCDOUT=RCDOUT&&RCDOUT;          /* INIT OUTPUT RECORD TO ZEROS 0784 02399000
*                                                            @Y30LB40*/ 02400000
         XC    RCDOUT(72),RCDOUT                                   0784 02401000
*   PTR2=ADDR(FIRSTMIN);            /* SET POINTER TO 1ST MINI HDR   */ 02402000
         LA    @15,FIRSTMIN                                        0785 02403000
         ST    @15,PTR2                                            0785 02404000
*   LSTMINAD=ADDR(FIRSTMIN)-ADDR(BLOCKFLG);/* INITIALIZE     @YM31015   02405000
*                                      LAST ADDRESS          @YM31015*/ 02406000
         LA    LSTMINAD,32                                         0786 02407000
*   MINI1SW='1'B;                   /* SET FIRST MINI SWITCH @Y30LB40*/ 02408000
         OI    MINI1SW,B'10000000'                                 0787 02409000
*   HIT5TIME=0;                     /* CLEAR HIGH T5 TIME HOLD AREA     02410000
*                                                            @Y30LB40*/ 02411000
         SLR   HIT5TIME,HIT5TIME                                   0788 02412000
*MINILOOP:                          /* LOOP THROUGH THE MINI HDRS    */ 02413000
*   IF FLAG(2:2)='1'B               /* IS THIS A NON DATA MINI HEADER   02414000
*                                                            @Y30LB40*/ 02415000
*       |T4TIME=0&T5TIME=0          /* IS THIS A NULL MINI   @OZ05079*/ 02416000
*     THEN                                                         0789 02417000
MINILOOP L     @15,PTR2                                            0789 02418000
         TM    FLAG(@15),B'01000000'                               0789 02419000
         BO    @RT00789                                            0789 02420000
         LH    @14,T4TIME(,@15)                                    0789 02421000
         N     @14,@CF01285                                        0789 02422000
         LTR   @14,@14                                             0789 02423000
         BNZ   @RF00789                                            0789 02424000
         LH    @15,T5TIME(,@15)                                    0789 02425000
         N     @15,@CF01285                                        0789 02426000
         LTR   @15,@15                                             0789 02427000
         BNZ   @RF00789                                            0789 02428000
@RT00789 DS    0H                                                  0790 02429000
*     DO;                           /* YES                   @Y30LB40*/ 02430000
*       IF NXTMINAD¬=0              /* IS IT THE LAST MINI   @Y30LB40*/ 02431000
*         THEN                                                     0791 02432000
         L     @15,PTR2                                            0791 02433000
         CLI   NXTMINAD(@15),0                                     0791 02434000
         BE    @RF00791                                            0791 02435000
*         DO;                       /* NO, NOT LAST          @Y30LB40*/ 02436000
*           IF NXTMINAD<=LSTMINAD   /* SET NEXT POINTER      @YM31015*/ 02437000
*             THEN                                                 0793 02438000
         SLR   @14,@14                                             0793 02439000
         IC    @14,NXTMINAD(,@15)                                  0793 02440000
         CR    @14,LSTMINAD                                        0793 02441000
         BNH   @RT00793                                            0793 02442000
*             RETURN;               /* READ ANOTHER RECORD   @OZ05079*/ 02443000
*           LSTMINAD=NXTMINAD;      /* SET LAST POINTER      @YM31015*/ 02444000
         LR    LSTMINAD,@14                                        0795 02445000
*           PTR2=ADDR(RECIN)+NXTMINAD+8;/* SET               @YM31015   02446000
*                                      POINTER               @YM31015*/ 02447000
         LA    @15,RECIN                                           0796 02448000
         ALR   @15,@14                                             0796 02449000
         AL    @15,@CF00036                                        0796 02450000
         ST    @15,PTR2                                            0796 02451000
*           GO TO MINILOOP;         /* PTR OK GO PROCESS NEXT MINI 0797 02452000
*                                                            @Y30LB40*/ 02453000
         B     MINILOOP                                            0797 02454000
*         END;                      /*                       @Y30LB40*/ 02455000
*       ELSE                                                       0799 02456000
*         GO TO CKREC;              /* LAST MINI FINISH PROCESS    0799 02457000
*                                                            @Y30LB40*/ 02458000
*     END;                          /*                       @Y30LB40*/ 02459000
*   IF MINI1SW='1'B                 /* IS THIS THE FIRST DATA MINI 0801 02460000
*                                                            @Y30LB40*/ 02461000
*     THEN                          /* YES,START REFORMATTING WITH 0801 02462000
*                                      FIXED DATA                    */ 02463000
@RF00789 TM    MINI1SW,B'10000000'                                 0801 02464000
         BNO   @RF00801                                            0801 02465000
*     CALL DOCOMMON;                /* INFO FROM BLOCK HDR   @OZ05079*/ 02466000
         BAL   @14,DOCOMMON                                        0802 02467000
*   ELSE                                                           0803 02468000
*     ;                             /*                       @OZ05079*/ 02469000
@RF00801 DS    0H                                                  0804 02470000
*   CALL DOMINIS;                   /* ALWAYS GET MINI       @OZ05079*/ 02471000
         BAL   @14,DOMINIS                                         0804 02472000
*CKREC:                                                            0805 02473000
*   IF NXTMINAD=0                   /* IS THIS LAST MINI HEADER    0805 02474000
*                                                            @Y30LB40*/ 02475000
*     THEN                                                         0805 02476000
CKREC    L     @01,PTR2                                            0805 02477000
         CLI   NXTMINAD(@01),0                                     0805 02478000
         BNE   @RF00805                                            0805 02479000
*     DO;                           /* CHECK FOR VALID OUTPUT RECORD    02480000
*                                                            @Y30LB40*/ 02481000
*       IF CKTIME<CKSTIME|CKTIME>CKETIME|(STGD+DSTGD)=0|PAGES=0 THEN    02482000
         CLC   CKTIME(7),CKSTIME                                   0807 02483000
         BL    @RT00807                                            0807 02484000
         CLC   CKTIME(7),CKETIME                                   0807 02485000
         BH    @RT00807                                            0807 02486000
         SLR   @06,@06                                             0807 02487000
         L     @15,STGD                                            0807 02488000
         AL    @15,DSTGD                                           0807 02489000
         CR    @15,@06                                             0807 02490000
         BE    @RT00807                                            0807 02491000
         CLI   PAGES,0                                             0807 02492000
         BE    @RT00807                                            0807 02493000
*         RETURN;                   /* RECORD NOT VALID,SKIP IT    0808 02494000
*                                                            @Y30LB40*/ 02495000
*       ELSE                                                       0809 02496000
*         DO;                       /* RECORD VALID          @Y30LB40*/ 02497000
*           IF HOLDT2TM=0&HOLDT3TM=0 THEN                          0810 02498000
         C     @06,HOLDT2TM                                        0810 02499000
         BNE   @RF00810                                            0810 02500000
         C     @06,HOLDT3TM                                        0810 02501000
         BNE   @RF00810                                            0810 02502000
*             BUSYTIME=DEVSGTM+DEVDSTM;/* CALC BUSY TIME             */ 02503000
         L     @15,DEVSGTM                                         0811 02504000
         AL    @15,DEVDSTM                                         0811 02505000
         ST    @15,BUSYTIME                                        0811 02506000
*           ELSE                                                   0812 02507000
*             BUSYTIME=HIT5TIME-HOLDT2TM;/* CALC BUSY TIME           */ 02508000
         B     @RC00810                                            0812 02509000
@RF00810 LR    @06,HIT5TIME                                        0812 02510000
         SL    @06,HOLDT2TM                                        0812 02511000
         ST    @06,BUSYTIME                                        0812 02512000
*           RFY                                                    0813 02513000
*            (R0,                                                  0813 02514000
*             R1,                                                  0813 02515000
*             R14,                                                 0813 02516000
*             R15) RSTD;            /*                       @Y30LB40*/ 02517000
@RC00810 DS    0H                                                  0814 02518000
*           GEN(PUT   OUTDCB,RCDOUT);/* WRITE RECORD AND COUNT IT    */ 02519000
         PUT   OUTDCB,RCDOUT                                            02520000
*           RFY                                                    0815 02521000
*            (R0,                                                  0815 02522000
*             R1,                                                  0815 02523000
*             R14,                                                 0815 02524000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 02525000
*           OUTCOUNT=OUTCOUNT+1;    /*                       @Y30LB40*/ 02526000
         LA    @15,1                                               0816 02527000
         AL    @15,OUTCOUNT                                        0816 02528000
         ST    @15,OUTCOUNT                                        0816 02529000
*           RETURN;                 /*                       @OZ05079*/ 02530000
@EL00009 DS    0H                                                  0817 02531000
@EF00009 DS    0H                                                  0817 02532000
@ER00009 LM    @14,@12,@SA00009                                    0817 02533000
         BR    @14                                                 0817 02534000
*         END;                      /*                       @Y30LB40*/ 02535000
*     END;                          /*                       @Y30LB40*/ 02536000
*   IF NXTMINAD<=LSTMINAD           /* SET NEXT ADDRESS      @YM31015*/ 02537000
*     THEN                                                         0820 02538000
@RF00805 L     @01,PTR2                                            0820 02539000
         SLR   @15,@15                                             0820 02540000
         IC    @15,NXTMINAD(,@01)                                  0820 02541000
         CR    @15,LSTMINAD                                        0820 02542000
         BNH   @RT00820                                            0820 02543000
*     RETURN;                       /* GO TO NEXT ROUTINE    @OZ05079*/ 02544000
*   LSTMINAD=NXTMINAD;              /* SET LAST ADDRESS      @YM31015*/ 02545000
         LR    LSTMINAD,@15                                        0822 02546000
*   PTR2=ADDR(RECIN)+NXTMINAD+8;    /* SET POINTER           @YM31015*/ 02547000
         LA    @14,RECIN                                           0823 02548000
         ALR   @14,@15                                             0823 02549000
         AL    @14,@CF00036                                        0823 02550000
         ST    @14,PTR2                                            0823 02551000
*   GO TO MINILOOP;                 /* PTR OK, GO PROCESS NEXT MINI     02552000
*                                                            @Y30LB40*/ 02553000
         B     MINILOOP                                            0824 02554000
*   END REFORMAT;                   /*                       @OZ05079*/ 02555000
         B     @EL00009                                            0825 02556000
*                                                                  0826 02557000
*/********************************************************** @OZ05079*/ 02558000
*/*                                                          @OZ05079*/ 02559000
*/* PROCEDURE NAME - DOCOMMON                                @OZ05079*/ 02560000
*/*                                                          @OZ05079*/ 02561000
*/* FUNCTION - PICK UP FROM THE BLOCK HEADER PORTION OF THE  @OZ05079*/ 02562000
*/*            RECORD BEING PROCESSED THE INFORMATION COMMON @OZ05079*/ 02563000
*/*            TO ALL MINI-HEADERS IN THE RECORD.  THE       @OZ05079*/ 02564000
*/*            COMMON INFORMATION IS                         @OZ05079*/ 02565000
*/*            - TIMES T1, T2, AND T3                        @OZ05079*/ 02566000
*/*            - VOLID AND CO-ORDINATES OF CARTRIDGE         @OZ05079*/ 02567000
*/*            - DRD, DRC, AND STAGING ADAPTER               @OZ05079*/ 02568000
*/*            THIS INFORMATION IS CARRIED FORWARD INTO      @OZ05079*/ 02569000
*/*            THE REFORMATTED RECORD.                       @OZ05079*/ 02570000
*/*                                                          @OZ05079*/ 02571000
*/********************************************************** @OZ05079*/ 02572000
*                                                                  0826 02573000
*DOCOMMON:                                                         0826 02574000
*   PROCEDURE;                      /*                       @OZ05079*/ 02575000
DOCOMMON STM   @14,@12,@SA00010                                    0826 02576000
*   MINI1SW='0'B;                   /* RESET SWITCH          @Y30LB40*/ 02577000
         NI    MINI1SW,B'01111111'                                 0827 02578000
*   CALL SDTABLE;                   /* CONVERT TIMES AND SAVE DATES     02579000
*                                                            @Y30LB40*/ 02580000
         BAL   @14,SDTABLE                                         0828 02581000
*   HOLDT1TM=T1TIME;                /* GET MIDDLE TWO BYTES OF T1  0829 02582000
*                                      TIME                  @Y30LB40*/ 02583000
         L     @01,PTR2                                            0829 02584000
         L     HOLDT1TM,T1TIME(,@01)                               0829 02585000
*   SLL(HOLDT1TM,8);                /*                       @Y30LB40*/ 02586000
         SLL   HOLDT1TM,8                                          0830 02587000
*   SRL(HOLDT1TM,16);               /*                       @Y30LB40*/ 02588000
         SRL   HOLDT1TM,16                                         0831 02589000
*   HOLDT2TM=T2TIME;                /* EXPAND T2 TIME TO FULLWORD  0832 02590000
*                                                            @Y30LB40*/ 02591000
         LH    @03,T2TIME                                          0832 02592000
         N     @03,@CF01285                                        0832 02593000
         ST    @03,HOLDT2TM                                        0832 02594000
*   HOLDT3TM=T3TIME;                /* EXPAND T3 TIME TO FULLWORD  0833 02595000
*                                                            @Y30LB40*/ 02596000
         LH    @15,T3TIME                                          0833 02597000
         N     @15,@CF01285                                        0833 02598000
         ST    @15,HOLDT3TM                                        0833 02599000
*   IF HOLDT2TM=0&HOLDT3TM=0        /* IF T2 AND T3 ZERO     @Y30LB40*/ 02600000
*     THEN                                                         0834 02601000
         SLR   @14,@14                                             0834 02602000
         CR    @03,@14                                             0834 02603000
         BNE   @RF00834                                            0834 02604000
         CR    @15,@14                                             0834 02605000
         BE    @RT00834                                            0834 02606000
*     ;                             /* NO LOAD,SKIP ROLLOVER CHECK 0835 02607000
*                                                            @Y30LB40*/ 02608000
*   ELSE                                                           0836 02609000
*     DO;                           /*                       @Y30LB40*/ 02610000
@RF00834 DS    0H                                                  0837 02611000
*       IF HOLDT1TM>HOLDT2TM        /* IS THERE A ROLLOVER   @Y30LB40*/ 02612000
*         THEN                                                     0837 02613000
         L     @03,HOLDT2TM                                        0837 02614000
         CR    HOLDT1TM,@03                                        0837 02615000
         BNH   @RF00837                                            0837 02616000
*         DO;                       /* YES,BUMP T2 AND T3    @Y30LB40*/ 02617000
*           HOLDT2TM=HOLDT2TM+ROLLOVER;/*                    @Y30LB40*/ 02618000
         L     @02,ROLLOVER                                        0839 02619000
         ALR   @03,@02                                             0839 02620000
         ST    @03,HOLDT2TM                                        0839 02621000
*           HOLDT3TM=HOLDT3TM+ROLLOVER;/*                    @Y30LB40*/ 02622000
         AL    @02,HOLDT3TM                                        0840 02623000
         ST    @02,HOLDT3TM                                        0840 02624000
*         END;                      /*                       @Y30LB40*/ 02625000
*       IF HOLDT2TM>HOLDT3TM        /* IS THERE A ROLLOVER   @Y30LB40*/ 02626000
*         THEN                                                     0842 02627000
@RF00837 L     @15,HOLDT3TM                                        0842 02628000
         C     @15,HOLDT2TM                                        0842 02629000
         BNL   @RF00842                                            0842 02630000
*         HOLDT3TM=HOLDT3TM+ROLLOVER;/* YES,BUMP T3                  */ 02631000
         AL    @15,ROLLOVER                                        0843 02632000
         ST    @15,HOLDT3TM                                        0843 02633000
*       LOADTIME=LOADTIME+(HOLDT3TM-HOLDT2TM);/* CALC LOADTIME       */ 02634000
@RF00842 L     @15,HOLDT3TM                                        0844 02635000
         SL    @15,HOLDT2TM                                        0844 02636000
         AL    @15,LOADTIME                                        0844 02637000
         ST    @15,LOADTIME                                        0844 02638000
*       LOADNUM=LOADNUM+1;          /* INCREMENT NUMBER OF LOADS     */ 02639000
         IC    @01,LOADNUM                                         0845 02640000
         LA    @01,1(,@01)                                         0845 02641000
         STC   @01,LOADNUM                                         0845 02642000
*     END;                          /*                       @Y30LB40*/ 02643000
*   RCOVOLID=VOLID;                 /* PICK UP VOLID         @Y30LB40*/ 02644000
@RT00834 MVC   RCOVOLID(6),VOLID                                   0847 02645000
*   CALL TRDRCDRD;                  /* DRC/LOGICAL DRD TRANS @OZ05079*/ 02646000
         BAL   @14,TRDRCDRD                                        0848 02647000
*   READWRIT=DRDPRINT;              /* PHYSICAL DRD IN BINARY      0849 02648000
*                                                            @OZ05079*/ 02649000
         IC    @15,DRDPRINT                                        0849 02650000
         STC   @15,READWRIT                                        0849 02651000
*   CHARDRC=DRCPRINT;               /* DRC IN EBCDIC         @OZ05079*/ 02652000
         MVC   CHARDRC(1),DRCPRINT                                 0850 02653000
*   IF PAIRNUM='1'B THEN                                           0851 02654000
         TM    PAIRNUM,B'00001000'                                 0851 02655000
         BNO   @RF00851                                            0851 02656000
*     CARTPAIR(8:8)='1'B;           /* PICKUP CART PAIR              */ 02657000
         OI    CARTPAIR,B'00000001'                                0852 02658000
*   IF L(1:1)='1'B THEN                                            0853 02659000
@RF00851 TM    L,B'10000000'                                       0853 02660000
         BNO   @RF00853                                            0853 02661000
*     LIBRARY(7:7)='1'B;            /* PICKUP LIBRARY                */ 02662000
         OI    LIBRARY,B'00000010'                                 0854 02663000
*   IF L(2:2)='1'B THEN                                            0855 02664000
@RF00853 TM    L,B'01000000'                                       0855 02665000
         BNO   @RF00855                                            0855 02666000
*     LIBRARY(8:8)='1'B;            /*                       @Y30LB40*/ 02667000
         OI    LIBRARY,B'00000001'                                 0856 02668000
*   IF Z='1'B THEN                                                 0857 02669000
@RF00855 TM    Z,B'00100000'                                       0857 02670000
         BNO   @RF00857                                            0857 02671000
*     RCOZ(8:8)='1'B;               /* PICKUP Z COORD                */ 02672000
         OI    RCOZ,B'00000001'                                    0858 02673000
*   IF Y(1:1)='1'B THEN                                            0859 02674000
@RF00857 TM    Y,B'00010000'                                       0859 02675000
         BNO   @RF00859                                            0859 02676000
*     RCOY(4:4)='1'B;               /* PICKUP Y COORD                */ 02677000
         OI    RCOY,B'00010000'                                    0860 02678000
*   IF Y(2:2)='1'B THEN                                            0861 02679000
@RF00859 TM    Y,B'00001000'                                       0861 02680000
         BNO   @RF00861                                            0861 02681000
*     RCOY(5:5)='1'B;               /*                       @Y30LB40*/ 02682000
         OI    RCOY,B'00001000'                                    0862 02683000
*   IF Y(3:3)='1'B THEN                                            0863 02684000
@RF00861 TM    Y,B'00000100'                                       0863 02685000
         BNO   @RF00863                                            0863 02686000
*     RCOY(6:6)='1'B;               /*                       @Y30LB40*/ 02687000
         OI    RCOY,B'00000100'                                    0864 02688000
*   IF Y(4:4)='1'B THEN                                            0865 02689000
@RF00863 TM    Y,B'00000010'                                       0865 02690000
         BNO   @RF00865                                            0865 02691000
*     RCOY(7:7)='1'B;               /*                       @Y30LB40*/ 02692000
         OI    RCOY,B'00000010'                                    0866 02693000
*   IF Y(5:5)='1'B THEN                                            0867 02694000
@RF00865 TM    Y,B'00000001'                                       0867 02695000
         BNO   @RF00867                                            0867 02696000
*     RCOY(8:8)='1'B;               /*                       @Y30LB40*/ 02697000
         OI    RCOY,B'00000001'                                    0868 02698000
*   RCOX=X;                         /* PICKUP X COORD                */ 02699000
@RF00867 MVC   RCOX(1),X                                           0869 02700000
*   IF DS2VALID='1'B&DS2IOS='1'B    /* WAS DS2 USED          @Y30LB40*/ 02701000
*     THEN                                                         0870 02702000
         TM    DS2VALID,B'00010100'                                0870 02703000
         BNO   @RF00870                                            0870 02704000
*     DO;                           /* YES,PICKUP DS2 ADDRESS        */ 02705000
*       IF DS2PORT='1'B THEN                                       0872 02706000
         TM    DS2PORT,B'00001000'                                 0872 02707000
         BNO   @RF00872                                            0872 02708000
*         DSPORT(8:8)='1'B;         /*                       @Y30LB40*/ 02709000
         OI    DSPORT,B'00000001'                                  0873 02710000
*       IF DS2CU(1:1)='1'B THEN                                    0874 02711000
@RF00872 TM    DS2CU,B'00000100'                                   0874 02712000
         BNO   @RF00874                                            0874 02713000
*         DSCU(6:6)='1'B;           /*                       @Y30LB40*/ 02714000
         OI    DSCU,B'00000100'                                    0875 02715000
*       IF DS2CU(2:2)='1'B THEN                                    0876 02716000
@RF00874 TM    DS2CU,B'00000010'                                   0876 02717000
         BNO   @RF00876                                            0876 02718000
*         DSCU(7:7)='1'B;           /*                       @Y30LB40*/ 02719000
         OI    DSCU,B'00000010'                                    0877 02720000
*       IF DS2CU(3:3)='1'B THEN                                    0878 02721000
@RF00876 TM    DS2CU,B'00000001'                                   0878 02722000
         BNO   @RF00878                                            0878 02723000
*         DSCU(8:8)='1'B;           /*                       @Y30LB40*/ 02724000
         OI    DSCU,B'00000001'                                    0879 02725000
*     END;                          /*                       @Y30LB40*/ 02726000
*   ELSE                                                           0881 02727000
*     DO;                           /* PICK UP DS1 ADDRESS           */ 02728000
         B     @RC00870                                            0881 02729000
@RF00870 DS    0H                                                  0882 02730000
*       IF DS1PORT='1'B THEN                                       0882 02731000
         TM    DS1PORT,B'00001000'                                 0882 02732000
         BNO   @RF00882                                            0882 02733000
*         DSPORT(8:8)='1'B;         /*                       @Y30LB40*/ 02734000
         OI    DSPORT,B'00000001'                                  0883 02735000
*       IF DS1CU(1:1)='1'B THEN                                    0884 02736000
@RF00882 TM    DS1CU,B'00000100'                                   0884 02737000
         BNO   @RF00884                                            0884 02738000
*         DSCU(6:6)='1'B;           /*                       @Y30LB40*/ 02739000
         OI    DSCU,B'00000100'                                    0885 02740000
*       IF DS1CU(2:2)='1'B THEN                                    0886 02741000
@RF00884 TM    DS1CU,B'00000010'                                   0886 02742000
         BNO   @RF00886                                            0886 02743000
*         DSCU(7:7)='1'B;           /*                       @Y30LB40*/ 02744000
         OI    DSCU,B'00000010'                                    0887 02745000
*       IF DS1CU(3:3)='1'B THEN                                    0888 02746000
@RF00886 TM    DS1CU,B'00000001'                                   0888 02747000
         BNO   @RF00888                                            0888 02748000
*         DSCU(8:8)='1'B;           /*                       @Y30LB40*/ 02749000
         OI    DSCU,B'00000001'                                    0889 02750000
*     END;                          /*                       @Y30LB40*/ 02751000
@RF00888 DS    0H                                                  0891 02752000
*   SDGINBIN=RSPINDGP;              /* SDG NUMBER            @ZA13479*/ 02753000
@RC00870 MVC   SDGINBIN(1),RSPINDGP                                0891 02754000
*   END DOCOMMON;                   /*                       @OZ05079*/ 02755000
@EL00010 DS    0H                                                  0892 02756000
@EF00010 DS    0H                                                  0892 02757000
@ER00010 LM    @14,@12,@SA00010                                    0892 02758000
         BR    @14                                                 0892 02759000
*                                                                  0893 02760000
*/********************************************************** @OZ05079*/ 02761000
*/*                                                          @OZ05079*/ 02762000
*/* PROCEDURE NAME - DOMINIS                                 @OZ05079*/ 02763000
*/*                                                          @OZ05079*/ 02764000
*/* FUNCTION - THIS PROCEDURE PROCESSES ALL STAGE AND        @OZ05079*/ 02765000
*/*            DESTAGE MINI-HEADERS.  IN THIS PROCEDURE      @OZ05079*/ 02766000
*/*            T4 TIME AND T5 TIME ARE DEVELOPED, AND A      @OZ05079*/ 02767000
*/*            COUNT OF THE STAGING AND DESTAGING            @OZ05079*/ 02768000
*/*            STATISTICS IS MADE.                           @OZ05079*/ 02769000
*/*                                                          @OZ05079*/ 02770000
*/********************************************************** @OZ05079*/ 02771000
*                                                                  0893 02772000
*DOMINIS:                                                          0893 02773000
*   PROCEDURE;                      /*                       @OZ05079*/ 02774000
DOMINIS  STM   @14,@06,12(@13)                                     0893 02775000
         STM   @08,@12,52(@13)                                     0893 02776000
*   HOLDT1TM=T1TIME;                /* GET MIDDLE TWO BYTES OF T1  0894 02777000
*                                      TIME                  @Y30LB40*/ 02778000
         L     @06,PTR2                                            0894 02779000
         L     HOLDT1TM,T1TIME(,@06)                               0894 02780000
*   SLL(HOLDT1TM,8);                /*                       @Y30LB40*/ 02781000
         SLL   HOLDT1TM,8                                          0895 02782000
*   SRL(HOLDT1TM,16);               /*                       @Y30LB40*/ 02783000
         SRL   HOLDT1TM,16                                         0896 02784000
*   HOLDT4TM=T4TIME;                /* EXPAND T4 TO FULLWORD @Y30LB40*/ 02785000
         LH    HOLDT4TM,T4TIME(,@06)                               0897 02786000
         N     HOLDT4TM,@CF01285                                   0897 02787000
*   HOLDT5TM=T5TIME;                /* EXPAND T5 TO FULLWORD @Y30LB40*/ 02788000
         LH    HOLDT5TM,T5TIME(,@06)                               0898 02789000
         N     HOLDT5TM,@CF01285                                   0898 02790000
*   IF HOLDT1TM>HOLDT4TM            /* IS THERE A ROLLOVER   @Y30LB40*/ 02791000
*     THEN                                                         0899 02792000
         CR    HOLDT1TM,HOLDT4TM                                   0899 02793000
         BNH   @RF00899                                            0899 02794000
*     DO;                           /* YES                   @Y30LB40*/ 02795000
*       HOLDT4TM=HOLDT4TM+ROLLOVER; /* BUMP T4               @Y30LB40*/ 02796000
         L     @06,ROLLOVER                                        0901 02797000
         ALR   HOLDT4TM,@06                                        0901 02798000
*       HOLDT5TM=HOLDT5TM+ROLLOVER; /* BUMP T5               @Y30LB40*/ 02799000
         ALR   HOLDT5TM,@06                                        0902 02800000
*     END;                          /*                       @Y30LB40*/ 02801000
*   IF HOLDT4TM>HOLDT5TM            /* IS THERE A ROLLOVER   @Y30LB40*/ 02802000
*     THEN                                                         0904 02803000
@RF00899 CR    HOLDT4TM,HOLDT5TM                                   0904 02804000
         BNH   @RF00904                                            0904 02805000
*     HOLDT5TM=HOLDT5TM+ROLLOVER;   /* YES,BUMP T5           @Y30LB40*/ 02806000
         AL    HOLDT5TM,ROLLOVER                                   0905 02807000
*   IF HOLDT5TM>HIT5TIME            /* SAVE HIGHEST T5 IN BLOCK    0906 02808000
*                                                            @Y30LB40*/ 02809000
*     THEN                                                         0906 02810000
@RF00904 CR    HOLDT5TM,HIT5TIME                                   0906 02811000
         BNH   @RF00906                                            0906 02812000
*     HIT5TIME=HOLDT5TM;            /*                       @Y30LB40*/ 02813000
         LR    HIT5TIME,HOLDT5TM                                   0907 02814000
*   FLD2=COUNT;                     /*                       @Y30LB40*/ 02815000
@RF00906 L     @01,PTR2                                            0908 02816000
         MVC   FLD2(1),COUNT(@01)                                  0908 02817000
*   PAGES=PAGES+CONVERT;            /* PICKUP NUMBER OF PAGES      0909 02818000
*                                                            @Y30LB40*/ 02819000
         LH    @15,CONVERT                                         0909 02820000
         SLR   @14,@14                                             0909 02821000
         IC    @14,PAGES                                           0909 02822000
         ALR   @14,@15                                             0909 02823000
         STC   @14,PAGES                                           0909 02824000
*   K=0;                            /*                       @Y30LB40*/ 02825000
         SLR   @14,@14                                             0910 02826000
         STH   @14,K                                               0910 02827000
*   J=CONVERT;                      /*                       @Y30LB40*/ 02828000
         STH   @15,J                                               0911 02829000
*   HOLDCYLS=0;                     /* CLEAR CYLINDER ACCUMULATOR  0912 02830000
*                                                            @Y30LB40*/ 02831000
         SLR   HOLDCYLS,HOLDCYLS                                   0912 02832000
*   HOLDVTOC=0;                     /* CLEAR VTOC STAGING ACCUMULATOR   02833000
*                                                            @Y30LB40*/ 02834000
         SLR   HOLDVTOC,HOLDVTOC                                   0913 02835000
*   DO WHILE(K¬=J);                 /* LOOP THROUGH ALL PAGE LISTS 0914 02836000
*                                                            @Y30LB40*/ 02837000
         B     @DE00914                                            0914 02838000
@DL00914 DS    0H                                                  0915 02839000
*     K=K+1;                        /*                       @Y30LB40*/ 02840000
         LA    @15,1                                               0915 02841000
         LH    @14,K                                               0915 02842000
         ALR   @14,@15                                             0915 02843000
         STH   @14,K                                               0915 02844000
*     CONVERT=0;                    /*                       @Y30LB40*/ 02845000
         SLR   @01,@01                                             0916 02846000
         STH   @01,CONVERT                                         0916 02847000
*     DECODCYL=CYLIND(K);           /*                       @Y30LB40*/ 02848000
         L     @01,PTR2                                            0917 02849000
         SLA   @14,2                                               0917 02850000
         ST    @14,@TF00001                                        0917 02851000
         ALR   @14,@01                                             0917 02852000
         MVC   DECODCYL(1),CYLIND-4(@14)                           0917 02853000
*     IF DECODCYL(1:1)='1'B&VIRTPAGE(K)='00000000'B THEN           0918 02854000
         TM    DECODCYL,B'10000000'                                0918 02855000
         BNO   @RF00918                                            0918 02856000
         AL    @01,@TF00001                                        0918 02857000
         CLI   VIRTPAGE-4(@01),B'00000000'                         0918 02858000
         BNE   @RF00918                                            0918 02859000
*       HOLDVTOC=HOLDVTOC+1;        /* IF VTOC STAGING ACCUMULATE  0919 02860000
*                                                            @Y30LB40*/ 02861000
*                                                                  0919 02862000
         ALR   HOLDVTOC,@15                                        0919 02863000
*     /***************************************************************/ 02864000
*     /*                                                             */ 02865000
*     /* COUNT CYLINDERS STAGED OR DESTAGED                  @Y30LB40*/ 02866000
*     /*                                                             */ 02867000
*     /***************************************************************/ 02868000
*                                                                  0920 02869000
*     IF DECODCYL(1:1)='1'B THEN                                   0920 02870000
@RF00918 TM    DECODCYL,B'10000000'                                0920 02871000
         BNO   @RF00920                                            0920 02872000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02873000
         LH    @01,CONVERT                                         0921 02874000
         LA    @01,1(,@01)                                         0921 02875000
         STH   @01,CONVERT                                         0921 02876000
*     IF DECODCYL(2:2)='1'B THEN                                   0922 02877000
@RF00920 TM    DECODCYL,B'01000000'                                0922 02878000
         BNO   @RF00922                                            0922 02879000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02880000
         LH    @01,CONVERT                                         0923 02881000
         LA    @01,1(,@01)                                         0923 02882000
         STH   @01,CONVERT                                         0923 02883000
*     IF DECODCYL(3:3)='1'B THEN                                   0924 02884000
@RF00922 TM    DECODCYL,B'00100000'                                0924 02885000
         BNO   @RF00924                                            0924 02886000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02887000
         LH    @01,CONVERT                                         0925 02888000
         LA    @01,1(,@01)                                         0925 02889000
         STH   @01,CONVERT                                         0925 02890000
*     IF DECODCYL(4:4)='1'B THEN                                   0926 02891000
@RF00924 TM    DECODCYL,B'00010000'                                0926 02892000
         BNO   @RF00926                                            0926 02893000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02894000
         LH    @01,CONVERT                                         0927 02895000
         LA    @01,1(,@01)                                         0927 02896000
         STH   @01,CONVERT                                         0927 02897000
*     IF DECODCYL(5:5)='1'B THEN                                   0928 02898000
@RF00926 TM    DECODCYL,B'00001000'                                0928 02899000
         BNO   @RF00928                                            0928 02900000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02901000
         LH    @01,CONVERT                                         0929 02902000
         LA    @01,1(,@01)                                         0929 02903000
         STH   @01,CONVERT                                         0929 02904000
*     IF DECODCYL(6:6)='1'B THEN                                   0930 02905000
@RF00928 TM    DECODCYL,B'00000100'                                0930 02906000
         BNO   @RF00930                                            0930 02907000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02908000
         LH    @01,CONVERT                                         0931 02909000
         LA    @01,1(,@01)                                         0931 02910000
         STH   @01,CONVERT                                         0931 02911000
*     IF DECODCYL(7:7)='1'B THEN                                   0932 02912000
@RF00930 TM    DECODCYL,B'00000010'                                0932 02913000
         BNO   @RF00932                                            0932 02914000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02915000
         LH    @01,CONVERT                                         0933 02916000
         LA    @01,1(,@01)                                         0933 02917000
         STH   @01,CONVERT                                         0933 02918000
*     IF DECODCYL(8:8)='1'B THEN                                   0934 02919000
@RF00932 TM    DECODCYL,B'00000001'                                0934 02920000
         BNO   @RF00934                                            0934 02921000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02922000
         LH    @01,CONVERT                                         0935 02923000
         LA    @01,1(,@01)                                         0935 02924000
         STH   @01,CONVERT                                         0935 02925000
*     HOLDCYLS=HOLDCYLS+CONVERT;    /*                       @Y30LB40*/ 02926000
@RF00934 AH    HOLDCYLS,CONVERT                                    0936 02927000
*   END;                            /*                       @Y30LB40*/ 02928000
@DE00914 CLC   K(2),J                                              0937 02929000
         BNE   @DL00914                                            0937 02930000
*   IF PLSTDEST='00'B               /* WAS THIS A STAGE OPERATION  0938 02931000
*                                                            @Y30LB40*/ 02932000
*     THEN                                                         0938 02933000
         L     @15,PTR2                                            0938 02934000
         TM    PLSTDEST(@15),B'11000000'                           0938 02935000
         BNZ   @RF00938                                            0938 02936000
*     DO;                           /* YES                   @Y30LB40*/ 02937000
*       STGD=STGD+HOLDCYLS;         /* ACCUM STAGED CYLINDERS      0940 02938000
*                                                            @Y30LB40*/ 02939000
         LR    @14,HOLDCYLS                                        0940 02940000
         AL    @14,STGD                                            0940 02941000
         ST    @14,STGD                                            0940 02942000
*       VTOCSTG=VTOCSTG+HOLDVTOC;   /* ACCUM VTOC STAGES     @Y30LB40*/ 02943000
         SLR   @14,@14                                             0941 02944000
         IC    @14,VTOCSTG                                         0941 02945000
         ALR   @14,HOLDVTOC                                        0941 02946000
         STC   @14,VTOCSTG                                         0941 02947000
*       STGDNUM=STGDNUM+1;          /* ACCUM NUMBER OF STAGES      0942 02948000
*                                                            @Y30LB40*/ 02949000
*                                                                  0942 02950000
         IC    @06,STGDNUM                                         0942 02951000
         LA    @06,1(,@06)                                         0942 02952000
         STC   @06,STGDNUM                                         0942 02953000
*       /*************************************************************/ 02954000
*       /*                                                           */ 02955000
*       /* IF STAGING CAUSED CYLINDER FAULT ACCUM CFAULT     @Y30LB40*/ 02956000
*       /*                                                           */ 02957000
*       /*************************************************************/ 02958000
*                                                                  0943 02959000
*       IF FUNCID='00110000'B|PLNOTU(1:1)='1'B THEN                0943 02960000
         CLI   FUNCID(@15),B'00110000'                             0943 02961000
         BE    @RT00943                                            0943 02962000
         TM    PLNOTU(@15),B'00100000'                             0943 02963000
         BNO   @RF00943                                            0943 02964000
@RT00943 DS    0H                                                  0944 02965000
*         CFAULT=CFAULT+HOLDCYLS;   /*                       @Y30LB40*/ 02966000
         LR    @06,HOLDCYLS                                        0944 02967000
         AL    @06,CFAULT                                          0944 02968000
         ST    @06,CFAULT                                          0944 02969000
*       SYSSGTM=SYSSGTM+(HOLDT5TM-HOLDT1TM);/* CALC SYSTEM TIME      */ 02970000
@RF00943 LR    @06,HOLDT5TM                                        0945 02971000
         SLR   @06,HOLDT1TM                                        0945 02972000
         AL    @06,SYSSGTM                                         0945 02973000
         ST    @06,SYSSGTM                                         0945 02974000
*       DEVSGTM=DEVSGTM+(HOLDT5TM-HOLDT4TM);/* CALC DEVICE TIME      */ 02975000
         LR    @06,HOLDT5TM                                        0946 02976000
         SLR   @06,HOLDT4TM                                        0946 02977000
         AL    @06,DEVSGTM                                         0946 02978000
         ST    @06,DEVSGTM                                         0946 02979000
*     END;                          /*                       @Y30LB40*/ 02980000
*   ELSE                                                           0948 02981000
*     IF PLSTDEST='10'B             /* WAS THIS A DESTAGE OPERATION  */ 02982000
*       THEN                                                       0948 02983000
         B     @RC00938                                            0948 02984000
@RF00938 L     @15,PTR2                                            0948 02985000
         TM    PLSTDEST(@15),B'10000000'                           0948 02986000
         BNO   @RF00948                                            0948 02987000
         TM    PLSTDEST(@15),B'01000000'                           0948 02988000
         BNZ   @RF00948                                            0948 02989000
*       DO;                         /* YES                   @Y30LB40*/ 02990000
*         DSTGD=DSTGD+HOLDCYLS;     /* ACCUM DESTAGES CYLINDERS      */ 02991000
         LR    @14,HOLDCYLS                                        0950 02992000
         AL    @14,DSTGD                                           0950 02993000
         ST    @14,DSTGD                                           0950 02994000
*         VTOCDSTG=VTOCDSTG+HOLDVTOC;/* ACCUM VTOC DESTAGINGS        */ 02995000
         SLR   @14,@14                                             0951 02996000
         IC    @14,VTOCDSTG                                        0951 02997000
         ALR   @14,HOLDVTOC                                        0951 02998000
         STC   @14,VTOCDSTG                                        0951 02999000
*         DSTGDNUM=DSTGDNUM+1;      /* ACCUM NUMBER OF DESTAGES    0952 03000000
*                                                            @Y30LB40*/ 03001000
         IC    @06,DSTGDNUM                                        0952 03002000
         LA    @06,1(,@06)                                         0952 03003000
         STC   @06,DSTGDNUM                                        0952 03004000
*         IF FUNCID='00001000'B|    /* MOUNT OR ACQUIRE OR LRU     0953 03005000
*                                                            @ZA28570*/ 03006000
*             FUNCID='00000010'B|FUNCID='00110000'B THEN           0953 03007000
         CLI   FUNCID(@15),B'00001000'                             0953 03008000
         BE    @RT00953                                            0953 03009000
         CLI   FUNCID(@15),B'00000010'                             0953 03010000
         BE    @RT00953                                            0953 03011000
         CLI   FUNCID(@15),B'00110000'                             0953 03012000
         BNE   @RF00953                                            0953 03013000
@RT00953 DS    0H                                                  0954 03014000
*           SALLOC=SALLOC+HOLDCYLS; /* SPACE ALLOC CAUSED            */ 03015000
         LR    @06,HOLDCYLS                                        0954 03016000
         AL    @06,SALLOC                                          0954 03017000
         ST    @06,SALLOC                                          0954 03018000
*         SYSDSTM=SYSDSTM+(HOLDT5TM-HOLDT1TM);/* CALC SYSTEM TIME    */ 03019000
@RF00953 LR    @06,HOLDT5TM                                        0955 03020000
         SLR   @06,HOLDT1TM                                        0955 03021000
         AL    @06,SYSDSTM                                         0955 03022000
         ST    @06,SYSDSTM                                         0955 03023000
*         DEVDSTM=DEVDSTM+(HOLDT5TM-HOLDT4TM);/* CALC DEVICE TIME    */ 03024000
         LR    @06,HOLDT5TM                                        0956 03025000
         SLR   @06,HOLDT4TM                                        0956 03026000
         AL    @06,DEVDSTM                                         0956 03027000
         ST    @06,DEVDSTM                                         0956 03028000
*       END;                        /*                       @Y30LB40*/ 03029000
*   MININUM=MININUM+1;              /* COUNT NUMBER OF MINI HEADERS  */ 03030000
@RF00948 DS    0H                                                  0958 03031000
@RC00938 IC    @06,MININUM                                         0958 03032000
         LA    @06,1(,@06)                                         0958 03033000
         STC   @06,MININUM                                         0958 03034000
*   IF HOLDT2TM=0&HOLDT3TM=0        /* WAS THERE A CARTRIDGE LOAD    */ 03035000
*     THEN                                                         0959 03036000
         SLR   @06,@06                                             0959 03037000
         C     @06,HOLDT2TM                                        0959 03038000
         BNE   @RF00959                                            0959 03039000
         C     @06,HOLDT3TM                                        0959 03040000
         BE    @RT00959                                            0959 03041000
*     ;                             /* NO                    @Y30LB40*/ 03042000
*   ELSE                                                           0961 03043000
*     DO;                           /* YES                   @Y30LB40*/ 03044000
@RF00959 DS    0H                                                  0962 03045000
*       IF HOLDT1TM>HOLDT2TM        /* WAS CARTRIDGE ALREADY LOADED  */ 03046000
*         THEN                                                     0962 03047000
         C     HOLDT1TM,HOLDT2TM                                   0962 03048000
         BNH   @RF00962                                            0962 03049000
*         HITNUM=HITNUM+1;          /* YES,COUNT NUMBER OF PRELOADS  */ 03050000
         IC    @06,HITNUM                                          0963 03051000
         LA    @06,1(,@06)                                         0963 03052000
         STC   @06,HITNUM                                          0963 03053000
*     END;                          /*                       @Y30LB40*/ 03054000
*   END DOMINIS;                    /*                       @OZ05079*/ 03055000
@EL00011 DS    0H                                                  0965 03056000
@EF00011 DS    0H                                                  0965 03057000
@ER00011 LM    @14,@06,12(@13)                                     0965 03058000
         LM    @08,@12,52(@13)                                     0965 03059000
         BR    @14                                                 0965 03060000
*                                                                  0966 03061000
*/********************************************************** @OZ05079*/ 03062000
*/*                                                          @OZ05079*/ 03063000
*/* PROCEDURE NAME - BLKHDR                                  @OZ09557*/ 03064000
*/*                                                          @OZ05079*/ 03065000
*/* FUNCTION - PRINT TRACE BLOCK HEADERS WHEN VALID STAGE    @OZ09557*/ 03066000
*/*            OR DETSAGE DATA AND 'INTERPRET' OR 'BOTH'     @OZ09557*/ 03067000
*/*            WAS SPECIFIED AS THE PARM OPTION.             @OZ05079*/ 03068000
*/*                                                          @OZ05079*/ 03069000
*/********************************************************** @OZ05079*/ 03070000
*                                                                  0966 03071000
*BLKHDR:                                                           0966 03072000
*   PROCEDURE;                      /*                       @OZ09557*/ 03073000
BLKHDR   STM   @14,@06,@SA00012                                    0966 03074000
         STM   @08,@12,@SA00012+36                                 0966 03075000
*   MINI1SW='0'B;                   /* RESET 1ST TIME        @OZ11670*/ 03076000
         NI    MINI1SW,B'01111111'                                 0967 03077000
*   IF LINECNT>52                   /* FORCE PAGE BREAK IF NECESSARY    03078000
*                                                            @Y30LB40*/ 03079000
*     THEN                                                         0968 03080000
         C     LINECNT,@CF00040                                    0968 03081000
         BNH   @RF00968                                            0968 03082000
*     CALL NEWPAGE;                 /*                       @Y30LB40*/ 03083000
         BAL   @14,NEWPAGE                                         0969 03084000
*   RFY                                                            0970 03085000
*    (R0,                                                          0970 03086000
*     R1,                                                          0970 03087000
*     R14,                                                         0970 03088000
*     R15) RSTD;                    /*                       @Y30LB40*/ 03089000
@RF00968 DS    0H                                                  0971 03090000
*   GEN(PUT   PRNTDCB,HDNG2);       /* PRINT BLOCK HEADER HEADLINES     03091000
*                                                            @Y30LB40*/ 03092000
         PUT   PRNTDCB,HDNG2                                            03093000
*   GEN(PUT   PRNTDCB,HDNG3);       /*                       @Y30LB40*/ 03094000
         PUT   PRNTDCB,HDNG3                                            03095000
*   RFY                                                            0973 03096000
*    (R0,                                                          0973 03097000
*     R1,                                                          0973 03098000
*     R14,                                                         0973 03099000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 03100000
*   LINECNT=LINECNT+3;              /*                       @Y30LB40*/ 03101000
         AL    LINECNT,@CF00117                                    0974 03102000
*   BLKLINE=' ';                    /* SET BLOCK LINE TO BLANKS    0975 03103000
*                                                            @Y30LB40*/ 03104000
         MVI   BLKLINE+1,C' '                                      0975 03105000
         MVC   BLKLINE+2(119),BLKLINE+1                            0975 03106000
         MVI   BLKLINE,C' '                                        0975 03107000
*   CALL EDITBIT(ADDR(BLKOFLG));    /*                       @Y30LB40*/ 03108000
         LA    @06,BLKOFLG                                         0976 03109000
         ST    @06,@AFTEMPS+4                                      0976 03110000
         LA    @06,@AFTEMPS+4                                      0976 03111000
         ST    @06,@AL00001                                        0976 03112000
         LA    @01,@AL00001                                        0976 03113000
         BAL   @14,EDITBIT                                         0976 03114000
*   BLKFLAG=BITOUT;                 /* PRINT BLOCK FLAG      @Y30LB40*/ 03115000
         MVC   BLKFLAG(8),BITOUT                                   0977 03116000
*   CALL EDITHEX(ADDR(MINIPTR),1);  /*                       @YD00173*/ 03117000
         LA    @06,MINIPTR                                         0978 03118000
         ST    @06,@AFTEMPS+4                                      0978 03119000
         LA    @06,@AFTEMPS+4                                      0978 03120000
         ST    @06,@AL00001                                        0978 03121000
         LA    @06,@CF00045                                        0978 03122000
         ST    @06,@AL00001+4                                      0978 03123000
         LA    @01,@AL00001                                        0978 03124000
         BAL   @14,EDITHEX                                         0978 03125000
*   BLKMINPT=HEXOUT(1:2);           /* PRINT CURRENT MINI PTR      0979 03126000
*                                                            @YD00173*/ 03127000
         MVC   BLKMINPT(2),HEXOUT                                  0979 03128000
*   CALL EDITHEX(ADDR(LIBRID),1);   /*                       @YD00173*/ 03129000
         LA    @06,LIBRID                                          0980 03130000
         ST    @06,@AFTEMPS+4                                      0980 03131000
         LA    @06,@AFTEMPS+4                                      0980 03132000
         ST    @06,@AL00001                                        0980 03133000
         LA    @06,@CF00045                                        0980 03134000
         ST    @06,@AL00001+4                                      0980 03135000
         LA    @01,@AL00001                                        0980 03136000
         BAL   @14,EDITHEX                                         0980 03137000
*   BLKLIBID=HEXOUT(1:2);           /* PRINT LIBRARY ID      @YD00173*/ 03138000
         MVC   BLKLIBID(2),HEXOUT                                  0981 03139000
*   CALL EDITHEX(ADDR(RSPINDGP),1); /*                       @YD00173*/ 03140000
*                                                                  0982 03141000
         LA    @06,RSPINDGP                                        0982 03142000
         ST    @06,@AFTEMPS+4                                      0982 03143000
         LA    @06,@AFTEMPS+4                                      0982 03144000
         ST    @06,@AL00001                                        0982 03145000
         LA    @06,@CF00045                                        0982 03146000
         ST    @06,@AL00001+4                                      0982 03147000
         LA    @01,@AL00001                                        0982 03148000
         BAL   @14,EDITHEX                                         0982 03149000
*   /*****************************************************************/ 03150000
*   /*                                                               */ 03151000
*   /* *************************************************     @OZ08841*/ 03152000
*   /* SAVE STAGING DRIVE GROUP TO BUILD DASD SSID IN        @OZ08841*/ 03153000
*   /* PAGE LIST                                             @OZ08841*/ 03154000
*   /* *************************************************     @OZ08841*/ 03155000
*   /*                                                               */ 03156000
*   /*****************************************************************/ 03157000
*                                                                  0983 03158000
*   SAVESDG='00'X;                  /* ZERO SAVE AREA        @OZ08841*/ 03159000
         MVI   SAVESDG,X'00'                                       0983 03160000
*   IF RSPINDGP(4)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03161000
*     THEN                          /*                       @OZ08841*/ 03162000
         TM    RSPINDGP,B'00010000'                                0984 03163000
         BNO   @RF00984                                            0984 03164000
*     SAVESDG(1)='1'B;              /*                       @OZ08841*/ 03165000
         OI    SAVESDG,B'10000000'                                 0985 03166000
*   IF RSPINDGP(5)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03167000
*     THEN                          /*                       @OZ08841*/ 03168000
@RF00984 TM    RSPINDGP,B'00001000'                                0986 03169000
         BNO   @RF00986                                            0986 03170000
*     SAVESDG(2)='1'B;              /*                       @OZ08841*/ 03171000
         OI    SAVESDG,B'01000000'                                 0987 03172000
*   IF RSPINDGP(6)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03173000
*     THEN                          /*                       @OZ08841*/ 03174000
@RF00986 TM    RSPINDGP,B'00000100'                                0988 03175000
         BNO   @RF00988                                            0988 03176000
*     SAVESDG(3)='1'B;              /*                       @OZ08841*/ 03177000
         OI    SAVESDG,B'00100000'                                 0989 03178000
*   IF RSPINDGP(7)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03179000
*     THEN                          /*                       @OZ08841*/ 03180000
@RF00988 TM    RSPINDGP,B'00000010'                                0990 03181000
         BNO   @RF00990                                            0990 03182000
*     SAVESDG(4)='1'B;              /*                       @OZ08841*/ 03183000
         OI    SAVESDG,B'00010000'                                 0991 03184000
*   IF RSPINDGP(8)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03185000
*     THEN                          /*                       @OZ08841*/ 03186000
@RF00990 TM    RSPINDGP,B'00000001'                                0992 03187000
         BNO   @RF00992                                            0992 03188000
*     SAVESDG(5)='1'B;              /*                       @OZ08841*/ 03189000
         OI    SAVESDG,B'00001000'                                 0993 03190000
*   BLKRSPPT=HEXOUT(1:2);           /* PRINT REAL SPINDLE GROUP    0994 03191000
*                                                            @YD00173*/ 03192000
*                                                                  0994 03193000
@RF00992 MVC   BLKRSPPT(2),HEXOUT                                  0994 03194000
*   /*****************************************************************/ 03195000
*   /*                                                               */ 03196000
*   /* BUILD SSID OF STAGING ADAPTER 1 AND STAGING           @OZ05079*/ 03197000
*   /* ADAPTER 2 (IF PRESENT)                                @OZ05079*/ 03198000
*   /*                                                               */ 03199000
*   /*****************************************************************/ 03200000
*                                                                  0995 03201000
*   CHAR8SA1='8';                   /* FIRST DIGIT ALWAYS 8  @OZ05079*/ 03202000
         MVI   CHAR8SA1,C'8'                                       0995 03203000
*   SAWORK='00'X;                   /* CLEAR WORK AREA       @OZ05079*/ 03204000
         MVI   SAWORK,X'00'                                        0996 03205000
*   SAWORK=DS1ADDR;                 /* FOUR LOW-ORDER BITS OF SA   0997 03206000
*                                                            @OZ05079*/ 03207000
         MVC   SAWORK(1),DS1ADDR                                   0997 03208000
*   SAWORK(1:1)='0'B;               /*                       @OZ05079*/ 03209000
*   SAWORK(2:2)='0'B;               /*                       @OZ05079*/ 03210000
*   SAWORK(3:3)='0'B;               /*                       @OZ05079*/ 03211000
*   SAWORK(4:4)='0'B;               /*                       @OZ05079*/ 03212000
         NI    SAWORK,B'00001111'                                  1001 03213000
*   SA1ID=SALOOKUP(SAWORK+1);       /* TRANSLATE SECOND DIGIT      1002 03214000
*                                                            @OZ05079*/ 03215000
         SLR   @06,@06                                             1002 03216000
         IC    @06,SAWORK                                          1002 03217000
         LA    @01,SALOOKUP(@06)                                   1002 03218000
         MVC   SA1ID(1),0(@01)                                     1002 03219000
*   CHAR0SA1='0';                   /* THIRD DIGIT ALWAYS 0  @OZ05079*/ 03220000
         MVI   CHAR0SA1,C'0'                                       1003 03221000
*   IF DS2VALID='1'B                /* CHECK SECOND SA VALID @OZ05079*/ 03222000
*     THEN                          /*                       @OZ05079*/ 03223000
         TM    DS2VALID,B'00010000'                                1004 03224000
         BNO   @RF01004                                            1004 03225000
*     DO;                           /*                       @OZ05079*/ 03226000
*       CHAR8SA2='8';               /* FIRST DIGIT ALWAYS 8  @OZ05079*/ 03227000
         MVI   CHAR8SA2,C'8'                                       1006 03228000
*       SAWORK='00'X;               /* CLEAR WORK AREA       @OZ05079*/ 03229000
         MVI   SAWORK,X'00'                                        1007 03230000
*       SAWORK=DS2ADDR;             /* FOUR LOW-ORDER BITS   @OZ05079*/ 03231000
         MVC   SAWORK(1),DS2ADDR                                   1008 03232000
*       SAWORK(1:1)='0'B;           /*                       @OZ05079*/ 03233000
*       SAWORK(2:2)='0'B;           /*                       @OZ05079*/ 03234000
*       SAWORK(3:3)='0'B;           /*                       @OZ05079*/ 03235000
*       SAWORK(4:4)='0'B;           /*                       @OZ05079*/ 03236000
         NI    SAWORK,B'00001111'                                  1012 03237000
*       SA2ID=SALOOKUP(SAWORK+1);   /* TRANSLATE 2ND DIGIT   @OZ05079*/ 03238000
         SLR   @06,@06                                             1013 03239000
         IC    @06,SAWORK                                          1013 03240000
         LA    @01,SALOOKUP(@06)                                   1013 03241000
         MVC   SA2ID(1),0(@01)                                     1013 03242000
*       CHAR0SA2='0';               /* THIRD DIGIT ALWAYS 0  @OZ05079*/ 03243000
         MVI   CHAR0SA2,C'0'                                       1014 03244000
*     END;                          /*                       @OZ05079*/ 03245000
*   ELSE                            /*                       @OZ05079*/ 03246000
*     SA2SSID='***';                /* NO SECOND SA          @OZ05079*/ 03247000
         B     @RC01004                                            1016 03248000
@RF01004 MVC   SA2SSID(3),@CC01192                                 1016 03249000
*   CALL EDITHEX(ADDR(VVADDR1),1);  /*                       @YD00173*/ 03250000
@RC01004 LA    @06,VVADDR1                                         1017 03251000
         ST    @06,@AFTEMPS+4                                      1017 03252000
         LA    @06,@AFTEMPS+4                                      1017 03253000
         ST    @06,@AL00001                                        1017 03254000
         LA    @06,@CF00045                                        1017 03255000
         ST    @06,@AL00001+4                                      1017 03256000
         LA    @01,@AL00001                                        1017 03257000
         BAL   @14,EDITHEX                                         1017 03258000
*   BLKVV1=HEXOUT(1:2);             /* PRINT VVA1            @YD00173*/ 03259000
         MVC   BLKVV1(2),HEXOUT                                    1018 03260000
*   CALL EDITHEX(ADDR(VVADDR2),1);  /*                       @YD00173*/ 03261000
         LA    @06,VVADDR2                                         1019 03262000
         ST    @06,@AFTEMPS+4                                      1019 03263000
         LA    @06,@AFTEMPS+4                                      1019 03264000
         ST    @06,@AL00001                                        1019 03265000
         LA    @06,@CF00045                                        1019 03266000
         ST    @06,@AL00001+4                                      1019 03267000
         LA    @01,@AL00001                                        1019 03268000
         BAL   @14,EDITHEX                                         1019 03269000
*   BLKVV2=HEXOUT(1:2);             /* PRINT VVA2            @YD00173*/ 03270000
         MVC   BLKVV2(2),HEXOUT                                    1020 03271000
*   CALL EDITHEX(ADDR(QCBENTS),6);  /*                       @Y30LB40*/ 03272000
         LA    @06,QCBENTS                                         1021 03273000
         ST    @06,@AFTEMPS+4                                      1021 03274000
         LA    @06,@AFTEMPS+4                                      1021 03275000
         ST    @06,@AL00001                                        1021 03276000
         LA    @06,@CF00344                                        1021 03277000
         ST    @06,@AL00001+4                                      1021 03278000
         LA    @01,@AL00001                                        1021 03279000
         BAL   @14,EDITHEX                                         1021 03280000
*   BLKQCB=HEXOUT(1:12);            /* PRINT QCB ENTRIES     @Y30LB40*/ 03281000
         MVC   BLKQCB(12),HEXOUT                                   1022 03282000
*   BLKVOLID=VOLID;                 /* PRINT VOLUME IDENTIFICATION 1023 03283000
*                                                            @Y30LB40*/ 03284000
         MVC   BLKVOLID(6),VOLID                                   1023 03285000
*   IF T2TIME=0                     /*                       @ZA13498*/ 03286000
*       &T3TIME=0                   /*                       @ZA13498*/ 03287000
*     THEN                          /*                       @ZA13498*/ 03288000
         LH    @06,T2TIME                                          1024 03289000
         N     @06,@CF01285                                        1024 03290000
         LTR   @06,@06                                             1024 03291000
         BNZ   @RF01024                                            1024 03292000
         LH    @06,T3TIME                                          1024 03293000
         N     @06,@CF01285                                        1024 03294000
         LTR   @06,@06                                             1024 03295000
         BNZ   @RF01024                                            1024 03296000
*     DO;                           /*                       @ZA13498*/ 03297000
*       T2SECOND(2:2)='0';          /*                       @ZA13498*/ 03298000
         MVI   T2SECOND+1,C'0'                                     1026 03299000
*       T3SECOND(2:2)='0';          /*                       @ZA13498*/ 03300000
         MVI   T3SECOND+1,C'0'                                     1027 03301000
*     END;                          /*                       @ZA13498*/ 03302000
*   ELSE                            /*                       @ZA13498*/ 03303000
*     DO;                           /*                       @ZA13498*/ 03304000
         B     @RC01024                                            1029 03305000
@RF01024 DS    0H                                                  1030 03306000
*       HOLDTXTM=T2TIME;            /*                       @ZA13498*/ 03307000
         LH    HOLDTXTM,T2TIME                                     1030 03308000
         N     HOLDTXTM,@CF01285                                   1030 03309000
*       CALL TIME2345;              /*                       @ZA13498*/ 03310000
         BAL   @14,TIME2345                                        1031 03311000
*       CALL EDITFIX(ADDR(HOUR),2,'S');/*                    @ZA13498*/ 03312000
         MVC   @AL00001+4(8),@AL01032                              1032 03313000
         LA    @06,HOUR                                            1032 03314000
         ST    @06,@AFTEMPS+4                                      1032 03315000
         LA    @06,@AFTEMPS+4                                      1032 03316000
         ST    @06,@AL00001                                        1032 03317000
         LA    @01,@AL00001                                        1032 03318000
         BAL   @14,EDITFIX                                         1032 03319000
*       T2HOUR=FIXOUT(12:13);       /*                       @ZA13498*/ 03320000
         MVC   T2HOUR(2),FIXOUT+11                                 1033 03321000
*       T2SEP1=':';                 /*                       @ZA13498*/ 03322000
         MVI   T2SEP1,C':'                                         1034 03323000
*       CALL EDITFIX(ADDR(MINUTE),2,'N');/*                  @ZA13498*/ 03324000
         MVC   @AL00001+4(8),@AL01035                              1035 03325000
         LA    @06,MINUTE                                          1035 03326000
         ST    @06,@AFTEMPS+4                                      1035 03327000
         LA    @06,@AFTEMPS+4                                      1035 03328000
         ST    @06,@AL00001                                        1035 03329000
         LA    @01,@AL00001                                        1035 03330000
         BAL   @14,EDITFIX                                         1035 03331000
*       T2MINUTE=FIXOUT(12:13);     /*                       @ZA13498*/ 03332000
         MVC   T2MINUTE(2),FIXOUT+11                               1036 03333000
*       T2SEP2=':';                 /*                       @ZA13498*/ 03334000
         MVI   T2SEP2,C':'                                         1037 03335000
*       CALL EDITFIX(ADDR(SECOND),2,'N');/*                  @ZA13498*/ 03336000
         MVC   @AL00001+4(8),@AL01038                              1038 03337000
         LA    @06,SECOND                                          1038 03338000
         ST    @06,@AFTEMPS+4                                      1038 03339000
         LA    @06,@AFTEMPS+4                                      1038 03340000
         ST    @06,@AL00001                                        1038 03341000
         LA    @01,@AL00001                                        1038 03342000
         BAL   @14,EDITFIX                                         1038 03343000
*       T2SECOND=FIXOUT(12:13);     /*                       @ZA13498*/ 03344000
         MVC   T2SECOND(2),FIXOUT+11                               1039 03345000
*       HOLDTXTM=T3TIME;            /*                       @ZA13498*/ 03346000
         LH    HOLDTXTM,T3TIME                                     1040 03347000
         N     HOLDTXTM,@CF01285                                   1040 03348000
*       CALL TIME2345;              /*                       @ZA13498*/ 03349000
         BAL   @14,TIME2345                                        1041 03350000
*       CALL EDITFIX(ADDR(HOUR),2,'S');/*                    @ZA13498*/ 03351000
         MVC   @AL00001+4(8),@AL01042                              1042 03352000
         LA    @06,HOUR                                            1042 03353000
         ST    @06,@AFTEMPS+4                                      1042 03354000
         LA    @06,@AFTEMPS+4                                      1042 03355000
         ST    @06,@AL00001                                        1042 03356000
         LA    @01,@AL00001                                        1042 03357000
         BAL   @14,EDITFIX                                         1042 03358000
*       T3HOUR=FIXOUT(12:13);       /*                       @ZA13498*/ 03359000
         MVC   T3HOUR(2),FIXOUT+11                                 1043 03360000
*       T3SEP1=':';                 /*                       @ZA13498*/ 03361000
         MVI   T3SEP1,C':'                                         1044 03362000
*       CALL EDITFIX(ADDR(MINUTE),2,'N');/*                  @ZA13498*/ 03363000
         MVC   @AL00001+4(8),@AL01045                              1045 03364000
         LA    @06,MINUTE                                          1045 03365000
         ST    @06,@AFTEMPS+4                                      1045 03366000
         LA    @06,@AFTEMPS+4                                      1045 03367000
         ST    @06,@AL00001                                        1045 03368000
         LA    @01,@AL00001                                        1045 03369000
         BAL   @14,EDITFIX                                         1045 03370000
*       T3MINUTE=FIXOUT(12:13);     /*                       @ZA13498*/ 03371000
         MVC   T3MINUTE(2),FIXOUT+11                               1046 03372000
*       T3SEP2=':';                 /*                       @ZA13498*/ 03373000
         MVI   T3SEP2,C':'                                         1047 03374000
*       CALL EDITFIX(ADDR(SECOND),2,'N');/*                  @ZA13498*/ 03375000
         MVC   @AL00001+4(8),@AL01048                              1048 03376000
         LA    @06,SECOND                                          1048 03377000
         ST    @06,@AFTEMPS+4                                      1048 03378000
         LA    @06,@AFTEMPS+4                                      1048 03379000
         ST    @06,@AL00001                                        1048 03380000
         LA    @01,@AL00001                                        1048 03381000
         BAL   @14,EDITFIX                                         1048 03382000
*       T3SECOND=FIXOUT(12:13);     /*                       @ZA13498*/ 03383000
         MVC   T3SECOND(2),FIXOUT+11                               1049 03384000
*     END;                          /*                       @ZA13498*/ 03385000
*   CALL EDITHEX(ADDR(QCBADDR),1);  /*                       @YD00173*/ 03386000
@RC01024 LA    @06,QCBADDR                                         1051 03387000
         ST    @06,@AFTEMPS+4                                      1051 03388000
         LA    @06,@AFTEMPS+4                                      1051 03389000
         ST    @06,@AL00001                                        1051 03390000
         LA    @06,@CF00045                                        1051 03391000
         ST    @06,@AL00001+4                                      1051 03392000
         LA    @01,@AL00001                                        1051 03393000
         BAL   @14,EDITHEX                                         1051 03394000
*   BLKQCBPT=HEXOUT(1:2);           /* PRINT QCB PTR         @YD00173*/ 03395000
*                                                                  1052 03396000
         MVC   BLKQCBPT(2),HEXOUT                                  1052 03397000
*   /*****************************************************************/ 03398000
*   /*                                                               */ 03399000
*   /* PRINT SSIDS OF BOTH DRC AND DRD                       @OZ05079*/ 03400000
*   /*                                                               */ 03401000
*   /*****************************************************************/ 03402000
*                                                                  1053 03403000
*   IF PARMSW='I'                   /* IF INTERPRET ONLY     @OZ05079*/ 03404000
*     THEN                          /*                       @OZ05079*/ 03405000
         CLI   PARMSW,C'I'                                         1053 03406000
         BNE   @RF01053                                            1053 03407000
*     CALL TRDRCDRD;                /* NEED TRANSLATE HERE   @OZ05079*/ 03408000
         BAL   @14,TRDRCDRD                                        1054 03409000
*   ELSE                                                           1055 03410000
*     ;                             /*                       @OZ05079*/ 03411000
@RF01053 DS    0H                                                  1056 03412000
*   CHAR4='4';                      /* FIRST CHAR ALWAYS 4   @OZ05079*/ 03413000
         MVI   CHAR4,C'4'                                          1056 03414000
*   MSFDRC=LIBRID;                  /* MSFID IN BINARY       @OZ05079*/ 03415000
         MVC   MSFDRC(1),LIBRID                                    1057 03416000
*   MSFDRC=MSFDRC|FOXZERO;          /* CONCATENATE SIGN      @OZ05079*/ 03417000
         OI    MSFDRC,B'11110000'                                  1058 03418000
*   PRINTDRC=DRCPRINT;              /* ALREADY EBCDIC        @OZ05079*/ 03419000
         MVC   PRINTDRC(1),DRCPRINT                                1059 03420000
*   CHAR2='2';                      /* FIRST CHAR ALWAYS 2   @OZ05079*/ 03421000
         MVI   CHAR2,C'2'                                          1060 03422000
*   MSFDRD=MSFDRC;                  /* MUST BE SAME MSF      @OZ05079*/ 03423000
         MVC   MSFDRD(1),MSFDRC                                    1061 03424000
*   PRINTDRD=DRDPRINT;              /* PHYSICAL DRD IN BINARY      1062 03425000
*                                                            @OZ05079*/ 03426000
         MVC   PRINTDRD(1),DRDPRINT                                1062 03427000
*   PRINTDRD=PRINTDRD|FOXZERO;      /* CONCATENATE SIGN      @OZ05079*/ 03428000
         OI    PRINTDRD,B'11110000'                                1063 03429000
*   FLD2='00000000'B;               /*                       @Y30LB40*/ 03430000
         MVI   FLD2,B'00000000'                                    1064 03431000
*   IF L(1:1)='1'B THEN                                            1065 03432000
         TM    L,B'10000000'                                       1065 03433000
         BNO   @RF01065                                            1065 03434000
*     FLD2(7:7)='1'B;               /*                       @Y30LB40*/ 03435000
         OI    FLD2,B'00000010'                                    1066 03436000
*   IF L(2:2)='1'B THEN                                            1067 03437000
@RF01065 TM    L,B'01000000'                                       1067 03438000
         BNO   @RF01067                                            1067 03439000
*     FLD2(8:8)='1'B;               /*                       @Y30LB40*/ 03440000
         OI    FLD2,B'00000001'                                    1068 03441000
*   CALL EDITFIX(ADDR(FLD2),1,'N'); /* PRINT L COORDINATE    @Y30LB40*/ 03442000
@RF01067 MVC   @AL00001+4(8),@AL01069                              1069 03443000
         LA    @06,FLD2                                            1069 03444000
         ST    @06,@AFTEMPS+4                                      1069 03445000
         LA    @06,@AFTEMPS+4                                      1069 03446000
         ST    @06,@AL00001                                        1069 03447000
         LA    @01,@AL00001                                        1069 03448000
         BAL   @14,EDITFIX                                         1069 03449000
*   BLKL=FIXOUT(13:13);             /*                       @Y30LB40*/ 03450000
         MVC   BLKL(1),FIXOUT+12                                   1070 03451000
*   IF Z='1'B THEN                                                 1071 03452000
         TM    Z,B'00100000'                                       1071 03453000
         BNO   @RF01071                                            1071 03454000
*     BLKZ='1';                     /*                       @Y30LB40*/ 03455000
         MVI   BLKZ,C'1'                                           1072 03456000
*   ELSE                                                           1073 03457000
*     BLKZ='0';                     /* PRINT Z COORDINATE    @Y30LB40*/ 03458000
         B     @RC01071                                            1073 03459000
@RF01071 MVI   BLKZ,C'0'                                           1073 03460000
*   FLD2='00000000'B;               /*                       @Y30LB40*/ 03461000
@RC01071 MVI   FLD2,B'00000000'                                    1074 03462000
*   IF Y(1:1)='1'B THEN                                            1075 03463000
         TM    Y,B'00010000'                                       1075 03464000
         BNO   @RF01075                                            1075 03465000
*     FLD2(4:4)='1'B;               /*                       @Y30LB40*/ 03466000
         OI    FLD2,B'00010000'                                    1076 03467000
*   IF Y(2:2)='1'B THEN                                            1077 03468000
@RF01075 TM    Y,B'00001000'                                       1077 03469000
         BNO   @RF01077                                            1077 03470000
*     FLD2(5:5)='1'B;               /*                       @Y30LB40*/ 03471000
         OI    FLD2,B'00001000'                                    1078 03472000
*   IF Y(3:3)='1'B THEN                                            1079 03473000
@RF01077 TM    Y,B'00000100'                                       1079 03474000
         BNO   @RF01079                                            1079 03475000
*     FLD2(6:6)='1'B;               /*                       @Y30LB40*/ 03476000
         OI    FLD2,B'00000100'                                    1080 03477000
*   IF Y(4:4)='1'B THEN                                            1081 03478000
@RF01079 TM    Y,B'00000010'                                       1081 03479000
         BNO   @RF01081                                            1081 03480000
*     FLD2(7:7)='1'B;               /*                       @Y30LB40*/ 03481000
         OI    FLD2,B'00000010'                                    1082 03482000
*   IF Y(5:5)='1'B THEN                                            1083 03483000
@RF01081 TM    Y,B'00000001'                                       1083 03484000
         BNO   @RF01083                                            1083 03485000
*     FLD2(8:8)='1'B;               /*                       @Y30LB40*/ 03486000
         OI    FLD2,B'00000001'                                    1084 03487000
*   CALL EDITFIX(ADDR(FLD2),1,'S'); /* PRINT Y COORDINATE    @Y30LB40*/ 03488000
@RF01083 MVC   @AL00001+4(8),@AL01085                              1085 03489000
         LA    @06,FLD2                                            1085 03490000
         ST    @06,@AFTEMPS+4                                      1085 03491000
         LA    @06,@AFTEMPS+4                                      1085 03492000
         ST    @06,@AL00001                                        1085 03493000
         LA    @01,@AL00001                                        1085 03494000
         BAL   @14,EDITFIX                                         1085 03495000
*   BLKY=FIXOUT(12:13);             /*                       @Y30LB40*/ 03496000
         MVC   BLKY(2),FIXOUT+11                                   1086 03497000
*   CALL EDITFIX(ADDR(X),1,'S');    /* PRINT X COORDINATE    @Y30LB40*/ 03498000
         MVC   @AL00001+4(8),@AL01087                              1087 03499000
         LA    @06,X                                               1087 03500000
         ST    @06,@AFTEMPS+4                                      1087 03501000
         LA    @06,@AFTEMPS+4                                      1087 03502000
         ST    @06,@AL00001                                        1087 03503000
         LA    @01,@AL00001                                        1087 03504000
         BAL   @14,EDITFIX                                         1087 03505000
*   BLKX=FIXOUT(11:13);             /*                       @Y30LB40*/ 03506000
         MVC   BLKX(3),FIXOUT+10                                   1088 03507000
*   RFY                                                            1089 03508000
*    (R0,                                                          1089 03509000
*     R1,                                                          1089 03510000
*     R14,                                                         1089 03511000
*     R15) RSTD;                    /*                       @Y30LB40*/ 03512000
*   GEN(PUT   PRNTDCB,BLKLINE);     /* PRINT BLOCK LINE      @Y30LB40*/ 03513000
         PUT   PRNTDCB,BLKLINE                                          03514000
*   RFY                                                            1091 03515000
*    (R0,                                                          1091 03516000
*     R1,                                                          1091 03517000
*     R14,                                                         1091 03518000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 03519000
*   LINECNT=LINECNT+1;              /*                       @Y30LB40*/ 03520000
         AL    LINECNT,@CF00045                                    1092 03521000
*   END BLKHDR;                     /*                       @OZ09557*/ 03522000
@EL00012 DS    0H                                                  1093 03523000
@EF00012 DS    0H                                                  1093 03524000
@ER00012 LM    @14,@06,@SA00012                                    1093 03525000
         LM    @08,@12,@SA00012+36                                 1093 03526000
         BR    @14                                                 1093 03527000
*                                                                  1094 03528000
*/********************************************************** @OZ05079*/ 03529000
*/*                                                          @OZ05079*/ 03530000
*/* PROCEDURE NAME - BLOCK                                   @OZ05079*/ 03531000
*/*                                                          @OZ05079*/ 03532000
*/* FUNCTION - PRINT TRACE BLOCK HEADERS, MINI HEADERS, AND  @OZ05079*/ 03533000
*/*            PAGE LISTS WHEN EITHER 'INTERPRET' OR 'BOTH'  @OZ05079*/ 03534000
*/*            WAS SPECIFIED AS THE PARM OPTION.             @OZ05079*/ 03535000
*/*                                                          @OZ05079*/ 03536000
*/********************************************************** @OZ05079*/ 03537000
*                                                                  1094 03538000
*BLOCK:                                                            1094 03539000
*   PROCEDURE;                                                     1094 03540000
BLOCK    STM   @14,@06,@SA00013                                    1094 03541000
         STM   @08,@12,@SA00013+36                                 1094 03542000
*   IF LINECNT>52                   /* FORCE PAGE BREAK IF NECESSARY    03543000
*                                                            @Y30LB40*/ 03544000
*     THEN                                                         1095 03545000
         C     LINECNT,@CF00040                                    1095 03546000
         BNH   @RF01095                                            1095 03547000
*     CALL NEWPAGE;                 /*                       @Y30LB40*/ 03548000
         BAL   @14,NEWPAGE                                         1096 03549000
*   IF LIBRID='11111111'B           /* TRAILER RECORD        @Y30LB40*/ 03550000
*     THEN                                                         1097 03551000
@RF01095 CLI   LIBRID,B'11111111'                                  1097 03552000
         BNE   @RF01097                                            1097 03553000
*     DO;                           /*                       @Y30LB40*/ 03554000
*       RFY                                                        1099 03555000
*        (R0,                                                      1099 03556000
*         R1,                                                      1099 03557000
*         R14,                                                     1099 03558000
*         R15) RSTD;                /*                       @Y30LB40*/ 03559000
*       GEN(PUT   PRNTDCB,TRLINE);  /* PRINT TRAILER         @Y30LB40*/ 03560000
         PUT   PRNTDCB,TRLINE                                           03561000
*       RFY                                                        1101 03562000
*        (R0,                                                      1101 03563000
*         R1,                                                      1101 03564000
*         R14,                                                     1101 03565000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 03566000
*       LINECNT=LINECNT+2;          /*                       @Y30LB40*/ 03567000
         AL    LINECNT,@CF00052                                    1102 03568000
*       RETURN;                     /* GO GET NEXT RECORD    @OZ05079*/ 03569000
@EL00013 DS    0H                                                  1103 03570000
@EF00013 DS    0H                                                  1103 03571000
@ER00013 LM    @14,@06,@SA00013                                    1103 03572000
         LM    @08,@12,@SA00013+36                                 1103 03573000
         BR    @14                                                 1103 03574000
*     END;                          /*                       @Y30LB40*/ 03575000
*/*  PRINT MINI HEADERS                                      @Y30LB40*/ 03576000
*                                                                  1105 03577000
*   PTR2=ADDR(FIRSTMIN);            /* SET POINTER TO 1ST MINI HEADER*/ 03578000
@RF01097 LA    @15,FIRSTMIN                                        1105 03579000
         ST    @15,PTR2                                            1105 03580000
*   LSTMINAD=ADDR(FIRSTMIN)-ADDR(BLOCKFLG);/* INITIALIZE     @YM31015   03581000
*                                      LAST ADDRESS          @YM31015*/ 03582000
         LA    LSTMINAD,32                                         1106 03583000
*   MINI1SW='1'B;                   /* SET FIRST MINI HEADER SWITCH     03584000
*                                                            @Y30LB40*/ 03585000
         OI    MINI1SW,B'10000000'                                 1107 03586000
*   STDESTSW='1'B;                  /* SET FIRST STAGE/DESTAGE MINI     03587000
*                                                            @ZA13498*/ 03588000
         OI    STDESTSW,B'10000000'                                1108 03589000
*MINI:                                                             1109 03590000
*   IF FLAG(2:2)='1'B               /* IS THIS A NON DATA MINI HEADER   03591000
*                                                            @Y30LB40*/ 03592000
*       |T4TIME=0&T5TIME=0          /* IS THIS A NULL MINI   @OZ05079*/ 03593000
*     THEN                                                         1109 03594000
MINI     L     @15,PTR2                                            1109 03595000
         TM    FLAG(@15),B'01000000'                               1109 03596000
         BO    @RT01109                                            1109 03597000
         LH    @14,T4TIME(,@15)                                    1109 03598000
         N     @14,@CF01285                                        1109 03599000
         LTR   @14,@14                                             1109 03600000
         BNZ   @RF01109                                            1109 03601000
         LH    @15,T5TIME(,@15)                                    1109 03602000
         N     @15,@CF01285                                        1109 03603000
         LTR   @15,@15                                             1109 03604000
         BNZ   @RF01109                                            1109 03605000
@RT01109 DS    0H                                                  1110 03606000
*     DO;                           /* YES                   @Y30LB40*/ 03607000
*       IF NXTMINAD=0               /* LAST MINI             @OZ05079*/ 03608000
*           |NXTMINAD<=LSTMINAD     /* CHECK LAST MINI HEADER      1111 03609000
*                                                            @OZ05079*/ 03610000
*         THEN                                                     1111 03611000
         L     @15,PTR2                                            1111 03612000
         CLI   NXTMINAD(@15),0                                     1111 03613000
         BE    @RT01111                                            1111 03614000
         SLR   @14,@14                                             1111 03615000
         IC    @14,NXTMINAD(,@15)                                  1111 03616000
         CR    @14,LSTMINAD                                        1111 03617000
         BNH   @RT01111                                            1111 03618000
*         RETURN;                   /* GO TO NEXT ROUTINE    @OZ05079*/ 03619000
*       LSTMINAD=NXTMINAD;          /* SET LAST MINI HEADER  @YM31015*/ 03620000
         LR    LSTMINAD,@14                                        1113 03621000
*       PTR2=ADDR(RECIN)+NXTMINAD+8;/* SET POINTER           @YM31015*/ 03622000
         LA    @15,RECIN                                           1114 03623000
         ALR   @15,@14                                             1114 03624000
         AL    @15,@CF00036                                        1114 03625000
         ST    @15,PTR2                                            1114 03626000
*       GO TO MINI;                 /* GO TO NEXT ROUTINE    @YM31015*/ 03627000
         B     MINI                                                1115 03628000
*     END;                          /*                       @Y30LB40*/ 03629000
*   MINILINE=' ';                   /* BLANK OUT MINI LINE   @OZ09557*/ 03630000
@RF01109 MVI   MINILINE+1,C' '                                     1117 03631000
         MVC   MINILINE+2(119),MINILINE+1                          1117 03632000
         MVI   MINILINE,C' '                                       1117 03633000
*   IF MINI1SW='1'B                 /* TEST IF FIRST MINI    @Y30LB40*/ 03634000
*     THEN                                                         1118 03635000
         TM    MINI1SW,B'10000000'                                 1118 03636000
         BNO   @RF01118                                            1118 03637000
*     DO;                           /* YES,FIRST MINI        @Y30LB40   03638000
*                                      IF TIME NOT YET CONTERTED THEN*/ 03639000
*       IF PARMSW='I' THEN                                         1120 03640000
         CLI   PARMSW,C'I'                                         1120 03641000
         BNE   @RF01120                                            1120 03642000
*         CALL SDTABLE;             /* GO SAVE AND CONVERTS TIME     */ 03643000
         BAL   @14,SDTABLE                                         1121 03644000
*       MINICDAT='  /   ';          /* SETUP DATE PRINT PATTERN      */ 03645000
@RF01120 MVC   MINICDAT(6),@CC01200                                1122 03646000
*       MINICTIM='  :  :  ';        /* SETUP TIME PRINT PATTERN      */ 03647000
         MVC   MINICTIM(8),@CC01201                                1123 03648000
*       CALL EDITFIX(ADDR(SVEYEAR),1,'N');/*                 @Y30LB40*/ 03649000
         MVC   @AL00001+4(8),@AL01124                              1124 03650000
         LA    @15,SVEYEAR                                         1124 03651000
         ST    @15,@AFTEMPS+8                                      1124 03652000
         LA    @15,@AFTEMPS+8                                      1124 03653000
         ST    @15,@AL00001                                        1124 03654000
         LA    @01,@AL00001                                        1124 03655000
         BAL   @14,EDITFIX                                         1124 03656000
*       MINICDAT(1:2)=FIXOUT(12:13);/* PRINT CONVERTED YEAR          */ 03657000
         MVC   MINICDAT(2),FIXOUT+11                               1125 03658000
*       CALL EDITFIX(ADDR(SVEJUL),2,'N');/*                  @Y30LB40*/ 03659000
         MVC   @AL00001+4(8),@AL01126                              1126 03660000
         LA    @15,SVEJUL                                          1126 03661000
         ST    @15,@AFTEMPS+8                                      1126 03662000
         LA    @15,@AFTEMPS+8                                      1126 03663000
         ST    @15,@AL00001                                        1126 03664000
         LA    @01,@AL00001                                        1126 03665000
         BAL   @14,EDITFIX                                         1126 03666000
*       MINICDAT(4:6)=FIXOUT(11:13);/* PRINT CONVERTED DAY           */ 03667000
         MVC   MINICDAT+3(3),FIXOUT+10                             1127 03668000
*       DAYS=SVETME;                /*                       @Y30LB40*/ 03669000
         L     @15,SVETME                                          1128 03670000
         ST    @15,DAYS                                            1128 03671000
*       CALL CONVERTM;              /* CONVERT TIME TO HOURS,MINUTES    03672000
*                                      AND SECONDS                   */ 03673000
         BAL   @14,CONVERTM                                        1129 03674000
*       CALL EDITFIX(ADDR(HOUR),2,'S');/*                    @Y30LB40*/ 03675000
         MVC   @AL00001+4(8),@AL01130                              1130 03676000
         LA    @15,HOUR                                            1130 03677000
         ST    @15,@AFTEMPS+8                                      1130 03678000
         LA    @15,@AFTEMPS+8                                      1130 03679000
         ST    @15,@AL00001                                        1130 03680000
         LA    @01,@AL00001                                        1130 03681000
         BAL   @14,EDITFIX                                         1130 03682000
*       MINICTIM(1:2)=FIXOUT(12:13);/* PRINT HOURS           @Y30LB40*/ 03683000
         MVC   MINICTIM(2),FIXOUT+11                               1131 03684000
*       CALL EDITFIX(ADDR(MINUTE),2,'N');/*                  @Y30LB40*/ 03685000
         MVC   @AL00001+4(8),@AL01132                              1132 03686000
         LA    @15,MINUTE                                          1132 03687000
         ST    @15,@AFTEMPS+8                                      1132 03688000
         LA    @15,@AFTEMPS+8                                      1132 03689000
         ST    @15,@AL00001                                        1132 03690000
         LA    @01,@AL00001                                        1132 03691000
         BAL   @14,EDITFIX                                         1132 03692000
*       MINICTIM(4:5)=FIXOUT(12:13);/* PRINT MINUTES         @Y30LB40*/ 03693000
         MVC   MINICTIM+3(2),FIXOUT+11                             1133 03694000
*       CALL EDITFIX(ADDR(SECOND),2,'N');/*                  @Y30LB40*/ 03695000
         MVC   @AL00001+4(8),@AL01134                              1134 03696000
         LA    @15,SECOND                                          1134 03697000
         ST    @15,@AFTEMPS+8                                      1134 03698000
         LA    @15,@AFTEMPS+8                                      1134 03699000
         ST    @15,@AL00001                                        1134 03700000
         LA    @01,@AL00001                                        1134 03701000
         BAL   @14,EDITFIX                                         1134 03702000
*       MINICTIM(7:8)=FIXOUT(12:13);/* PRINT SECONDS         @Y30LB40*/ 03703000
         MVC   MINICTIM+6(2),FIXOUT+11                             1135 03704000
*     END;                          /*                       @Y30LB40*/ 03705000
*                                                                  1136 03706000
*   /*****************************************************************/ 03707000
*   /*                                                               */ 03708000
*   /* ***********************************************       @OZ09557*/ 03709000
*   /* CHECK THE TIME IN THE FIRST STAGE OR DESTAGE          @OZ09557*/ 03710000
*   /* MINI AGAINST THE TIME RANGE SPECIFIED IN THE          @OZ09557*/ 03711000
*   /* PARM FIELD OF THE EXECUTE STATEMENT. IF               @OZ09557*/ 03712000
*   /* WITHIN THE SPECIFIED RANGE, PRINT THE BLOCK           @OZ09557*/ 03713000
*   /* HEADER AND PROCESS THE APPROPRIATE MINI               @OZ09557*/ 03714000
*   /* HEADERS. IF NOT WITHIN THE SPECIFIED RANGE,           @OZ09557*/ 03715000
*   /* RETURN TO THE MAINLINE WITHOUT PROCESSING             @OZ09557*/ 03716000
*   /* EITHER THE HEADER OR THE MINIS.                       @OZ09557*/ 03717000
*   /* ***********************************************       @OZ09557*/ 03718000
*   /*                                                               */ 03719000
*   /*****************************************************************/ 03720000
*                                                                  1137 03721000
*   IF CKTIME<CKSTIME               /*                       @OZ09557*/ 03722000
*       |CKTIME>CKETIME             /*                       @OZ09557*/ 03723000
*     THEN                          /*                       @OZ09557*/ 03724000
@RF01118 CLC   CKTIME(7),CKSTIME                                   1137 03725000
         BL    @RT01137                                            1137 03726000
         CLC   CKTIME(7),CKETIME                                   1137 03727000
         BH    @RT01137                                            1137 03728000
*     RETURN;                       /*                       @OZ09557*/ 03729000
*   IF MINI1SW='1'B                 /* HEADER NOT WRITTEN    @OZ11670*/ 03730000
*     THEN                          /*                       @OZ11670*/ 03731000
         TM    MINI1SW,B'10000000'                                 1139 03732000
         BNO   @RF01139                                            1139 03733000
*     CALL BLKHDR;                  /* PRINT BLOCK HEADER    @OZ11670*/ 03734000
*                                                                  1140 03735000
         BAL   @14,BLKHDR                                          1140 03736000
*   /*****************************************************************/ 03737000
*   /*                                                               */ 03738000
*   /* ***********************************************       @ZA13498*/ 03739000
*   /* CONVERT T1 TIME (BUT NOT DATE) FOR SECOND OR          @ZA13498*/ 03740000
*   /* SUBSEQUENT STAGE/DESTAGE MINIS FOR THE SAME           @ZA13498*/ 03741000
*   /* BLOCK HEADER.                                         @ZA13498*/ 03742000
*   /* ***********************************************       @ZA13498*/ 03743000
*   /*                                                               */ 03744000
*   /*****************************************************************/ 03745000
*                                                                  1141 03746000
*   IF STDESTSW='0'B                /*                       @ZA13498*/ 03747000
*     THEN                          /*                       @ZA13498*/ 03748000
@RF01139 TM    STDESTSW,B'10000000'                                1141 03749000
         BNZ   @RF01141                                            1141 03750000
*     DO;                           /*                       @ZA13498*/ 03751000
*       MINICTIM='  :  :  ';        /*                       @ZA13498*/ 03752000
         MVC   MINICTIM(8),@CC01201                                1143 03753000
*       HOLDTXTM=T1TIME;            /*                       @ZA13498*/ 03754000
         L     @01,PTR2                                            1144 03755000
         L     HOLDTXTM,T1TIME(,@01)                               1144 03756000
*       SLL(HOLDTXTM,8);            /*                       @ZA13498*/ 03757000
         SLL   HOLDTXTM,8                                          1145 03758000
*       SRL(HOLDTXTM,16);           /*                       @ZA13498*/ 03759000
         SRL   HOLDTXTM,16                                         1146 03760000
*       CALL TIME2345;              /*                       @ZA13498*/ 03761000
         BAL   @14,TIME2345                                        1147 03762000
*       CALL EDITFIX(ADDR(HOUR),2,'S');/*                    @ZA13498*/ 03763000
         MVC   @AL00001+4(8),@AL01148                              1148 03764000
         LA    @15,HOUR                                            1148 03765000
         ST    @15,@AFTEMPS+8                                      1148 03766000
         LA    @15,@AFTEMPS+8                                      1148 03767000
         ST    @15,@AL00001                                        1148 03768000
         LA    @01,@AL00001                                        1148 03769000
         BAL   @14,EDITFIX                                         1148 03770000
*       MINICTIM(1:2)=FIXOUT(12:13);/*                       @ZA13498*/ 03771000
         MVC   MINICTIM(2),FIXOUT+11                               1149 03772000
*       CALL EDITFIX(ADDR(MINUTE),2,'N');/*                  @ZA13498*/ 03773000
         MVC   @AL00001+4(8),@AL01150                              1150 03774000
         LA    @15,MINUTE                                          1150 03775000
         ST    @15,@AFTEMPS+8                                      1150 03776000
         LA    @15,@AFTEMPS+8                                      1150 03777000
         ST    @15,@AL00001                                        1150 03778000
         LA    @01,@AL00001                                        1150 03779000
         BAL   @14,EDITFIX                                         1150 03780000
*       MINICTIM(4:5)=FIXOUT(12:13);/*                       @ZA13498*/ 03781000
         MVC   MINICTIM+3(2),FIXOUT+11                             1151 03782000
*       CALL EDITFIX(ADDR(SECOND),2,'N');/*                  @ZA13498*/ 03783000
         MVC   @AL00001+4(8),@AL01152                              1152 03784000
         LA    @15,SECOND                                          1152 03785000
         ST    @15,@AFTEMPS+8                                      1152 03786000
         LA    @15,@AFTEMPS+8                                      1152 03787000
         ST    @15,@AL00001                                        1152 03788000
         LA    @01,@AL00001                                        1152 03789000
         BAL   @14,EDITFIX                                         1152 03790000
*       MINICTIM(7:8)=FIXOUT(12:13);/*                       @ZA13498*/ 03791000
         MVC   MINICTIM+6(2),FIXOUT+11                             1153 03792000
*     END;                          /*                       @ZA13498*/ 03793000
*   STDESTSW='0'B;                  /*                       @ZA13498*/ 03794000
@RF01141 NI    STDESTSW,B'01111111'                                1155 03795000
*   IF LINECNT>52                   /* NEW PAGE HEADING NEEDED     1156 03796000
*                                                            @Y30LB40*/ 03797000
*     THEN                                                         1156 03798000
         C     LINECNT,@CF00040                                    1156 03799000
         BNH   @RF01156                                            1156 03800000
*     CALL NEWPAGE;                 /*                       @Y30LB40*/ 03801000
         BAL   @14,NEWPAGE                                         1157 03802000
*   HOLDHDG4=HDNG4;                 /*                       @CCCCCCC*/ 03803000
@RF01156 MVC   HOLDHDG4(121),HDNG4                                 1158 03804000
*   IF FLAG(1:2)='00'B              /*                       @CCCCCCC*/ 03805000
*     THEN                          /*                       @CCCCCCC*/ 03806000
         L     @01,PTR2                                            1159 03807000
         TM    FLAG(@01),B'11000000'                               1159 03808000
         BNZ   @RF01159                                            1159 03809000
*     HOLDDEST='DESTGE';            /*                       @CCCCCCC*/ 03810000
         MVC   HOLDDEST(6),@CC01202                                1160 03811000
*   RFY                                                            1161 03812000
*    (R0,                                                          1161 03813000
*     R1,                                                          1161 03814000
*     R14,                                                         1161 03815000
*     R15) RSTD;                    /*                       @Y30LB40*/ 03816000
@RF01159 DS    0H                                                  1162 03817000
*   GEN(PUT   PRNTDCB,HOLDHDG4);    /* MINI HEADER HEADLINES 1     1162 03818000
*                                                            @CCCCCCC*/ 03819000
         PUT   PRNTDCB,HOLDHDG4                                         03820000
*   GEN(PUT   PRNTDCB,HDNG5);       /*                       @Y30LB40*/ 03821000
         PUT   PRNTDCB,HDNG5                                            03822000
*   RFY                                                            1164 03823000
*    (R0,                                                          1164 03824000
*     R1,                                                          1164 03825000
*     R14,                                                         1164 03826000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 03827000
*   LINECNT=LINECNT+3;              /*                       @Y30LB40*/ 03828000
         AL    LINECNT,@CF00117                                    1165 03829000
*   CALL EDITBIT(ADDR(SEQUENCE));   /* BUILD SEQUENCE FIELD  @Y30LB40*/ 03830000
         LA    @15,PTR2                                            1166 03831000
         ST    @15,@AL00001                                        1166 03832000
         LA    @01,@AL00001                                        1166 03833000
         BAL   @14,EDITBIT                                         1166 03834000
*   MINISEQ=BITOUT;                 /*                       @Y30LB40*/ 03835000
         MVC   MINISEQ(8),BITOUT                                   1167 03836000
*   CALL EDITBIT(ADDR(FLAG));       /* BUILD MINI FLAG FIELD @Y30LB40*/ 03837000
         L     @01,PTR2                                            1168 03838000
         LA    @15,FLAG(,@01)                                      1168 03839000
         ST    @15,@AFTEMPS+8                                      1168 03840000
         LA    @15,@AFTEMPS+8                                      1168 03841000
         ST    @15,@AL00001                                        1168 03842000
         LA    @01,@AL00001                                        1168 03843000
         BAL   @14,EDITBIT                                         1168 03844000
*   MINIFLAG=BITOUT;                /*                       @Y30LB40*/ 03845000
         MVC   MINIFLAG(8),BITOUT                                  1169 03846000
*   CALL EDITHEX(ADDR(NXTMINAD),1); /*                       @YD00173*/ 03847000
         L     @01,PTR2                                            1170 03848000
         LA    @15,NXTMINAD(,@01)                                  1170 03849000
         ST    @15,@AFTEMPS+8                                      1170 03850000
         LA    @15,@AFTEMPS+8                                      1170 03851000
         ST    @15,@AL00001                                        1170 03852000
         LA    @15,@CF00045                                        1170 03853000
         ST    @15,@AL00001+4                                      1170 03854000
         LA    @01,@AL00001                                        1170 03855000
         BAL   @14,EDITHEX                                         1170 03856000
*   MINIADDR=HEXOUT(1:2);           /* PRINT NEXT MINI ADDRESS     1171 03857000
*                                                            @YD00173*/ 03858000
         MVC   MINIADDR(2),HEXOUT                                  1171 03859000
*   RCDTME=T1TIME;                  /*                       @Y30LB40*/ 03860000
         L     @01,PTR2                                            1172 03861000
         L     @15,T1TIME(,@01)                                    1172 03862000
         ST    @15,RCDTME                                          1172 03863000
*   SRL(RCDTME,8);                  /* GET HIGH ORDER THREE BYTES OF    03864000
*                                      T1                    @Y30LB40*/ 03865000
         SRL   @15,8                                               1173 03866000
         ST    @15,RCDTME                                          1173 03867000
*   CALL EDITFIX(ADDR(RCDTME),4,'S');/* EDIT T1 TIME         @Y30LB40*/ 03868000
         MVC   @AL00001+4(8),@AL01174                              1174 03869000
         LA    @15,RCDTME                                          1174 03870000
         ST    @15,@AFTEMPS+8                                      1174 03871000
         LA    @15,@AFTEMPS+8                                      1174 03872000
         ST    @15,@AL00001                                        1174 03873000
         LA    @01,@AL00001                                        1174 03874000
         BAL   @14,EDITFIX                                         1174 03875000
*   MINIT1A=FIXOUT(6:13);           /*                       @Y30LB40*/ 03876000
         MVC   MINIT1A(8),FIXOUT+5                                 1175 03877000
*   RCDTME=T1TIME;                  /*                       @Y30LB40*/ 03878000
         L     @01,PTR2                                            1176 03879000
         L     @15,T1TIME(,@01)                                    1176 03880000
         ST    @15,RCDTME                                          1176 03881000
*   SLL(RCDTME,24);                 /* GET LOW ORDER BYTE OF T1    1177 03882000
*                                                            @Y30LB40*/ 03883000
         SLL   @15,24                                              1177 03884000
         ST    @15,RCDTME                                          1177 03885000
*   SRL(RCDTME,24);                 /*                       @Y30LB40*/ 03886000
         L     @15,RCDTME                                          1178 03887000
         SRL   @15,24                                              1178 03888000
         ST    @15,RCDTME                                          1178 03889000
*   CALL EDITFIX(ADDR(RCDTME),4,'N');/*                      @Y30LB40*/ 03890000
         MVC   @AL00001+4(8),@AL01179                              1179 03891000
         LA    @15,RCDTME                                          1179 03892000
         ST    @15,@AFTEMPS+8                                      1179 03893000
         LA    @15,@AFTEMPS+8                                      1179 03894000
         ST    @15,@AL00001                                        1179 03895000
         LA    @01,@AL00001                                        1179 03896000
         BAL   @14,EDITFIX                                         1179 03897000
*   MINIT1C=FIXOUT(11:13);          /* PRINT T1              @Y30LB40*/ 03898000
         MVC   MINIT1C(3),FIXOUT+10                                1180 03899000
*   MINIT1B='-';                    /*                       @Y30LB40*/ 03900000
         MVI   MINIT1B,C'-'                                        1181 03901000
*   HOLDTXTM=T4TIME;                /*                       @ZA13498*/ 03902000
         L     @01,PTR2                                            1182 03903000
         LH    HOLDTXTM,T4TIME(,@01)                               1182 03904000
         N     HOLDTXTM,@CF01285                                   1182 03905000
*   CALL TIME2345;                  /*                       @ZA13498*/ 03906000
         BAL   @14,TIME2345                                        1183 03907000
*   CALL EDITFIX(ADDR(HOUR),2,'S'); /*                       @ZA13498*/ 03908000
         MVC   @AL00001+4(8),@AL01184                              1184 03909000
         LA    @15,HOUR                                            1184 03910000
         ST    @15,@AFTEMPS+8                                      1184 03911000
         LA    @15,@AFTEMPS+8                                      1184 03912000
         ST    @15,@AL00001                                        1184 03913000
         LA    @01,@AL00001                                        1184 03914000
         BAL   @14,EDITFIX                                         1184 03915000
*   T4HOUR=FIXOUT(12:13);           /*                       @ZA13498*/ 03916000
         MVC   T4HOUR(2),FIXOUT+11                                 1185 03917000
*   T4SEP1=':';                     /*                       @ZA13498*/ 03918000
         MVI   T4SEP1,C':'                                         1186 03919000
*   CALL EDITFIX(ADDR(MINUTE),2,'N');/*                      @ZA13498*/ 03920000
         MVC   @AL00001+4(8),@AL01187                              1187 03921000
         LA    @15,MINUTE                                          1187 03922000
         ST    @15,@AFTEMPS+8                                      1187 03923000
         LA    @15,@AFTEMPS+8                                      1187 03924000
         ST    @15,@AL00001                                        1187 03925000
         LA    @01,@AL00001                                        1187 03926000
         BAL   @14,EDITFIX                                         1187 03927000
*   T4MINUTE=FIXOUT(12:13);         /*                       @ZA13498*/ 03928000
         MVC   T4MINUTE(2),FIXOUT+11                               1188 03929000
*   T4SEP2=':';                     /*                       @ZA13498*/ 03930000
         MVI   T4SEP2,C':'                                         1189 03931000
*   CALL EDITFIX(ADDR(SECOND),2,'N');/*                      @ZA13498*/ 03932000
         MVC   @AL00001+4(8),@AL01190                              1190 03933000
         LA    @15,SECOND                                          1190 03934000
         ST    @15,@AFTEMPS+8                                      1190 03935000
         LA    @15,@AFTEMPS+8                                      1190 03936000
         ST    @15,@AL00001                                        1190 03937000
         LA    @01,@AL00001                                        1190 03938000
         BAL   @14,EDITFIX                                         1190 03939000
*   T4SECOND=FIXOUT(12:13);         /*                       @ZA13498*/ 03940000
         MVC   T4SECOND(2),FIXOUT+11                               1191 03941000
*   HOLDTXTM=T5TIME;                /*                       @ZA13498*/ 03942000
         L     @01,PTR2                                            1192 03943000
         LH    HOLDTXTM,T5TIME(,@01)                               1192 03944000
         N     HOLDTXTM,@CF01285                                   1192 03945000
*   CALL TIME2345;                  /*                       @ZA13498*/ 03946000
         BAL   @14,TIME2345                                        1193 03947000
*   CALL EDITFIX(ADDR(HOUR),2,'S'); /*                       @ZA13498*/ 03948000
         MVC   @AL00001+4(8),@AL01194                              1194 03949000
         LA    @15,HOUR                                            1194 03950000
         ST    @15,@AFTEMPS+8                                      1194 03951000
         LA    @15,@AFTEMPS+8                                      1194 03952000
         ST    @15,@AL00001                                        1194 03953000
         LA    @01,@AL00001                                        1194 03954000
         BAL   @14,EDITFIX                                         1194 03955000
*   T5HOUR=FIXOUT(12:13);           /*                       @ZA13498*/ 03956000
         MVC   T5HOUR(2),FIXOUT+11                                 1195 03957000
*   T5SEP1=':';                     /*                       @ZA13498*/ 03958000
         MVI   T5SEP1,C':'                                         1196 03959000
*   CALL EDITFIX(ADDR(MINUTE),2,'N');/*                      @ZA13498*/ 03960000
         MVC   @AL00001+4(8),@AL01197                              1197 03961000
         LA    @15,MINUTE                                          1197 03962000
         ST    @15,@AFTEMPS+8                                      1197 03963000
         LA    @15,@AFTEMPS+8                                      1197 03964000
         ST    @15,@AL00001                                        1197 03965000
         LA    @01,@AL00001                                        1197 03966000
         BAL   @14,EDITFIX                                         1197 03967000
*   T5MINUTE=FIXOUT(12:13);         /*                       @ZA13498*/ 03968000
         MVC   T5MINUTE(2),FIXOUT+11                               1198 03969000
*   T5SEP2=':';                     /*                       @ZA13498*/ 03970000
         MVI   T5SEP2,C':'                                         1199 03971000
*   CALL EDITFIX(ADDR(SECOND),2,'N');/*                      @ZA13498*/ 03972000
         MVC   @AL00001+4(8),@AL01200                              1200 03973000
         LA    @15,SECOND                                          1200 03974000
         ST    @15,@AFTEMPS+8                                      1200 03975000
         LA    @15,@AFTEMPS+8                                      1200 03976000
         ST    @15,@AL00001                                        1200 03977000
         LA    @01,@AL00001                                        1200 03978000
         BAL   @14,EDITFIX                                         1200 03979000
*   T5SECOND=FIXOUT(12:13);         /*                       @ZA13498*/ 03980000
         MVC   T5SECOND(2),FIXOUT+11                               1201 03981000
*   CALL EDITHEX(ADDR(FUNCID),1);   /*                       @Y30LB40*/ 03982000
         L     @01,PTR2                                            1202 03983000
         LA    @15,FUNCID(,@01)                                    1202 03984000
         ST    @15,@AFTEMPS+8                                      1202 03985000
         LA    @15,@AFTEMPS+8                                      1202 03986000
         ST    @15,@AL00001                                        1202 03987000
         LA    @15,@CF00045                                        1202 03988000
         ST    @15,@AL00001+4                                      1202 03989000
         LA    @01,@AL00001                                        1202 03990000
         BAL   @14,EDITHEX                                         1202 03991000
*   MINIFUNC=HEXOUT(1:2);           /* PRINT COMMAND CODE    @Y30LB40*/ 03992000
         MVC   MINIFUNC(2),HEXOUT                                  1203 03993000
*   CALL EDITHEX(ADDR(CPUID),1);    /*                       @Y30LB40*/ 03994000
         L     @01,PTR2                                            1204 03995000
         LA    @15,CPUID(,@01)                                     1204 03996000
         ST    @15,@AFTEMPS+8                                      1204 03997000
         LA    @15,@AFTEMPS+8                                      1204 03998000
         ST    @15,@AL00001                                        1204 03999000
         LA    @15,@CF00045                                        1204 04000000
         ST    @15,@AL00001+4                                      1204 04001000
         LA    @01,@AL00001                                        1204 04002000
         BAL   @14,EDITHEX                                         1204 04003000
*   MINICPU=HEXOUT(1:2);            /* PRINT HOST CPU ID     @Y30LB40*/ 04004000
         MVC   MINICPU(2),HEXOUT                                   1205 04005000
*   CALL EDITBIT(ADDR(PLFLAG));     /*                       @Y30LB40*/ 04006000
         L     @01,PTR2                                            1206 04007000
         LA    @15,PLFLAG(,@01)                                    1206 04008000
         ST    @15,@AFTEMPS+8                                      1206 04009000
         LA    @15,@AFTEMPS+8                                      1206 04010000
         ST    @15,@AL00001                                        1206 04011000
         LA    @01,@AL00001                                        1206 04012000
         BAL   @14,EDITBIT                                         1206 04013000
*   MINIPGFL=BITOUT;                /* PRINT PAGE LIST FLAG  @Y30LB40*/ 04014000
         MVC   MINIPGFL(8),BITOUT                                  1207 04015000
*   CALL EDITHEX(ADDR(VUA),1);      /*                       @Y30LB40*/ 04016000
         L     @01,PTR2                                            1208 04017000
         LA    @15,VUA(,@01)                                       1208 04018000
         ST    @15,@AFTEMPS+8                                      1208 04019000
         LA    @15,@AFTEMPS+8                                      1208 04020000
         ST    @15,@AL00001                                        1208 04021000
         LA    @15,@CF00045                                        1208 04022000
         ST    @15,@AL00001+4                                      1208 04023000
         LA    @01,@AL00001                                        1208 04024000
         BAL   @14,EDITHEX                                         1208 04025000
*   MINIVUA=HEXOUT(1:2);            /* PRINT VIRTUAL UNIT ADDRESS  1209 04026000
*                                                            @Y30LB40*/ 04027000
         MVC   MINIVUA(2),HEXOUT                                   1209 04028000
*   CALL EDITHEX(ADDR(VVA),1);      /*                       @Y30LB40*/ 04029000
         L     @01,PTR2                                            1210 04030000
         LA    @15,VVA(,@01)                                       1210 04031000
         ST    @15,@AFTEMPS+8                                      1210 04032000
         LA    @15,@AFTEMPS+8                                      1210 04033000
         ST    @15,@AL00001                                        1210 04034000
         LA    @15,@CF00045                                        1210 04035000
         ST    @15,@AL00001+4                                      1210 04036000
         LA    @01,@AL00001                                        1210 04037000
         BAL   @14,EDITHEX                                         1210 04038000
*   MINIVVA=HEXOUT(1:2);            /* PRINT VIRTUAL VOLUME ADDRESS     04039000
*                                                            @Y30LB40*/ 04040000
         MVC   MINIVVA(2),HEXOUT                                   1211 04041000
*   CALL EDITFIX(ADDR(COUNT),1,'S');/*                       @Y30LB40*/ 04042000
         MVC   @AL00001+4(8),@AL01212                              1212 04043000
         L     @01,PTR2                                            1212 04044000
         LA    @15,COUNT(,@01)                                     1212 04045000
         ST    @15,@AFTEMPS+8                                      1212 04046000
         LA    @15,@AFTEMPS+8                                      1212 04047000
         ST    @15,@AL00001                                        1212 04048000
         LA    @01,@AL00001                                        1212 04049000
         BAL   @14,EDITFIX                                         1212 04050000
*   MINICNT=FIXOUT(11:13);          /* PRINT PAGE COUNT      @Y30LB40*/ 04051000
         MVC   MINICNT(3),FIXOUT+10                                1213 04052000
*   CONVERT=0;                      /*                       @Y30LB40*/ 04053000
         SLR   @15,@15                                             1214 04054000
         STH   @15,CONVERT                                         1214 04055000
*   FLD2=COUNT;                     /*                       @Y30LB40*/ 04056000
         L     @01,PTR2                                            1215 04057000
         MVC   FLD2(1),COUNT(@01)                                  1215 04058000
*   J=CONVERT;                      /* SAVE PAGE LIST COUNT  @Y30LB40*/ 04059000
         LH    @14,CONVERT                                         1216 04060000
         STH   @14,J                                               1216 04061000
*   K=0;                            /*                       @Y30LB40*/ 04062000
         STH   @15,K                                               1217 04063000
*   RFY                                                            1218 04064000
*    (R0,                                                          1218 04065000
*     R1,                                                          1218 04066000
*     R14,                                                         1218 04067000
*     R15) RSTD;                    /*                       @Y30LB40*/ 04068000
*   GEN(PUT   PRNTDCB,PRNTLINE);    /* PRINT MINI HEADER LINE      1219 04069000
*                                                            @OZ09557*/ 04070000
         PUT   PRNTDCB,PRNTLINE                                         04071000
*   RFY                                                            1220 04072000
*    (R0,                                                          1220 04073000
*     R1,                                                          1220 04074000
*     R14,                                                         1220 04075000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 04076000
*   PRNTLINE=' ';                   /*                       @OZ09557*/ 04077000
         MVI   PRNTLINE+1,C' '                                     1221 04078000
         MVC   PRNTLINE+2(119),PRNTLINE+1                          1221 04079000
         MVI   PRNTLINE,C' '                                       1221 04080000
*   LINECNT=LINECNT+1;              /*                       @Y30LB40*/ 04081000
         AL    LINECNT,@CF00045                                    1222 04082000
*   IF J¬=0                         /* IF ANY PAGE LIST      @OZ05079*/ 04083000
*     THEN                          /*                       @OZ05079*/ 04084000
         LH    @15,J                                               1223 04085000
         LTR   @15,@15                                             1223 04086000
         BZ    @RF01223                                            1223 04087000
*     CALL PAGE;                    /* PRINT PAGE LISTS      @OZ05079*/ 04088000
         BAL   @14,PAGE                                            1224 04089000
*   IF NXTMINAD=0                   /* LAST MINI             @OZ05079*/ 04090000
*       |NXTMINAD<=LSTMINAD         /* CHECK LAST MINI HEADER      1225 04091000
*                                                            @YM31015*/ 04092000
*     THEN                                                         1225 04093000
@RF01223 L     @15,PTR2                                            1225 04094000
         CLI   NXTMINAD(@15),0                                     1225 04095000
         BE    @RT01225                                            1225 04096000
         SLR   @14,@14                                             1225 04097000
         IC    @14,NXTMINAD(,@15)                                  1225 04098000
         CR    @14,LSTMINAD                                        1225 04099000
         BNH   @RT01225                                            1225 04100000
*     RETURN;                       /* GO TO NEXT ROUTINE    @OZ05079*/ 04101000
*   LSTMINAD=NXTMINAD;              /* SET LAST MINI HEADER  @YM31015*/ 04102000
         LR    LSTMINAD,@14                                        1227 04103000
*   PTR2=ADDR(RECIN)+NXTMINAD+8;    /* SET POINTER           @YM31015*/ 04104000
         LA    @15,RECIN                                           1228 04105000
         ALR   @15,@14                                             1228 04106000
         AL    @15,@CF00036                                        1228 04107000
         ST    @15,PTR2                                            1228 04108000
*   GO TO MINI;                     /* PTR OK, GO GET NEXT MINI    1229 04109000
*                                                            @Y30LB40*/ 04110000
         B     MINI                                                1229 04111000
*   END BLOCK;                      /*                       @OZ05079*/ 04112000
         B     @EL00013                                            1230 04113000
*                                                                  1231 04114000
*/********************************************************** @OZ05079*/ 04115000
*/*                                                          @OZ05079*/ 04116000
*/* PROCEDURE NAME - PAGE                                    @OZ05079*/ 04117000
*/*                                                          @OZ05079*/ 04118000
*/* FUNCTION - PRINT PAGE LIST                               @OZ05079*/ 04119000
*/*                                                          @OZ05079*/ 04120000
*/********************************************************** @OZ05079*/ 04121000
*                                                                  1231 04122000
*PAGE:                                                             1231 04123000
*   PROCEDURE;                      /*                       @OZ05079*/ 04124000
PAGE     STM   @14,@06,@SA00014                                    1231 04125000
         STM   @08,@12,@SA00014+36                                 1231 04126000
*STARTPG:                           /*                       @OZ05079*/ 04127000
*   IF LINECNT>52 THEN                                             1232 04128000
STARTPG  C     LINECNT,@CF00040                                    1232 04129000
         BNH   @RF01232                                            1232 04130000
*     CALL NEWPAGE;                 /*                       @Y30LB40*/ 04131000
         BAL   @14,NEWPAGE                                         1233 04132000
*   RFY                                                            1234 04133000
*    (R0,                                                          1234 04134000
*     R1,                                                          1234 04135000
*     R14,                                                         1234 04136000
*     R15) RSTD;                    /*                       @Y30LB40*/ 04137000
@RF01232 DS    0H                                                  1235 04138000
*   GEN(PUT   PRNTDCB,HDNG6);       /* PRINT PAGE LIST HEADLINES 1 1235 04139000
*                                      AND 2                         */ 04140000
         PUT   PRNTDCB,HDNG6                                            04141000
*   GEN(PUT   PRNTDCB,HDNG7);       /*                       @Y30LB40*/ 04142000
         PUT   PRNTDCB,HDNG7                                            04143000
*   RFY                                                            1237 04144000
*    (R0,                                                          1237 04145000
*     R1,                                                          1237 04146000
*     R14,                                                         1237 04147000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 04148000
*   LINECNT=LINECNT+3;              /*                       @Y30LB40*/ 04149000
         AL    LINECNT,@CF00117                                    1238 04150000
*   DO WHILE(K¬=J);                 /* NUMBER PAGES EQUAL COUNT    1239 04151000
*                                                            @Y30LB40*/ 04152000
         B     @DE01239                                            1239 04153000
@DL01239 DS    0H                                                  1240 04154000
*     IF LINECNT>55                 /* PAGE FULL             @Y30LB40*/ 04155000
*       THEN                                                       1240 04156000
         C     LINECNT,@CF01089                                    1240 04157000
         BNH   @RF01240                                            1240 04158000
*       DO;                         /*                       @Y30LB40*/ 04159000
*         CALL NEWPAGE;             /*                       @Y30LB40*/ 04160000
         BAL   @14,NEWPAGE                                         1242 04161000
*         GO TO STARTPG;            /*                       @OZ05079*/ 04162000
         B     STARTPG                                             1243 04163000
*       END;                        /*                       @Y30LB40*/ 04164000
*     PAGELINE=' ';                 /*                       @Y30LB40*/ 04165000
@RF01240 MVI   PAGELINE+1,C' '                                     1245 04166000
         MVC   PAGELINE+2(119),PAGELINE+1                          1245 04167000
         MVI   PAGELINE,C' '                                       1245 04168000
*     K=K+1;                        /*                       @Y30LB40*/ 04169000
         LA    @06,1                                               1246 04170000
         AH    @06,K                                               1246 04171000
         STH   @06,K                                               1246 04172000
*     FLD2=SAVESDG;                 /* SDG PART OF DASD SSID @OZ08841*/ 04173000
         MVC   FLD2(1),SAVESDG                                     1247 04174000
*     IF DEVICE(K,1:1)='1'B THEN                                   1248 04175000
         SLA   @06,2                                               1248 04176000
         L     @01,PTR2                                            1248 04177000
         ALR   @01,@06                                             1248 04178000
         TM    DEVICE-4(@01),B'00000100'                           1248 04179000
         BNO   @RF01248                                            1248 04180000
*       FLD2(6:6)='1'B;             /*                       @Y30LB40*/ 04181000
         OI    FLD2,B'00000100'                                    1249 04182000
*     IF DEVICE(K,2:2)='1'B THEN                                   1250 04183000
@RF01248 LH    @06,K                                               1250 04184000
         SLA   @06,2                                               1250 04185000
         L     @01,PTR2                                            1250 04186000
         ALR   @01,@06                                             1250 04187000
         TM    DEVICE-4(@01),B'00000010'                           1250 04188000
         BNO   @RF01250                                            1250 04189000
*       FLD2(7:7)='1'B;             /*                       @Y30LB40*/ 04190000
         OI    FLD2,B'00000010'                                    1251 04191000
*     IF DEVICE(K,3:3)='1'B THEN                                   1252 04192000
@RF01250 LH    @06,K                                               1252 04193000
         SLA   @06,2                                               1252 04194000
         L     @01,PTR2                                            1252 04195000
         ALR   @01,@06                                             1252 04196000
         TM    DEVICE-4(@01),B'00000001'                           1252 04197000
         BNO   @RF01252                                            1252 04198000
*       FLD2(8:8)='1'B;             /*                       @Y30LB40*/ 04199000
         OI    FLD2,B'00000001'                                    1253 04200000
*     CALL EDITHEX(ADDR(FLD2),1);   /* 2 LOW-ORDER DIGITS    @OZ08841*/ 04201000
@RF01252 LA    @06,FLD2                                            1254 04202000
         ST    @06,@AFTEMPS+12                                     1254 04203000
         LA    @06,@AFTEMPS+12                                     1254 04204000
         ST    @06,@AL00001                                        1254 04205000
         LA    @06,@CF00045                                        1254 04206000
         ST    @06,@AL00001+4                                      1254 04207000
         LA    @01,@AL00001                                        1254 04208000
         BAL   @14,EDITHEX                                         1254 04209000
*     PAGEDEV(2:3)=HEXOUT(1:2);     /* TO PRINT LINE         @OZ08841*/ 04210000
         MVC   PAGEDEV+1(2),HEXOUT                                 1255 04211000
*     PAGEDEV(1:1)='0';             /* HIGH-ORDER DIGIT      @OZ08841*/ 04212000
         MVI   PAGEDEV,C'0'                                        1256 04213000
*     CALL EDITFIX(ADDR(VIRTPAGE(K)),1,'S');/*               @Y30LB40*/ 04214000
         MVC   @AL00001+4(8),@AL01257                              1257 04215000
         LH    @06,K                                               1257 04216000
         SLA   @06,2                                               1257 04217000
         L     @01,PTR2                                            1257 04218000
         LA    @06,VIRTPAGE-4(@06,@01)                             1257 04219000
         ST    @06,@AFTEMPS+12                                     1257 04220000
         LA    @06,@AFTEMPS+12                                     1257 04221000
         ST    @06,@AL00001                                        1257 04222000
         LA    @01,@AL00001                                        1257 04223000
         BAL   @14,EDITFIX                                         1257 04224000
*     PAGEVP=FIXOUT(11:13);         /* PRINT VIRTUAL PAGE NUMBER   1258 04225000
*                                                            @Y30LB40*/ 04226000
         MVC   PAGEVP(3),FIXOUT+10                                 1258 04227000
*     CALL EDITFIX(ADDR(REALPAGE(K)),1,'S');/*               @Y30LB40*/ 04228000
         MVC   @AL00001+4(8),@AL01259                              1259 04229000
         LH    @06,K                                               1259 04230000
         SLA   @06,2                                               1259 04231000
         L     @01,PTR2                                            1259 04232000
         LA    @06,REALPAGE-4(@06,@01)                             1259 04233000
         ST    @06,@AFTEMPS+12                                     1259 04234000
         LA    @06,@AFTEMPS+12                                     1259 04235000
         ST    @06,@AL00001                                        1259 04236000
         LA    @01,@AL00001                                        1259 04237000
         BAL   @14,EDITFIX                                         1259 04238000
*     PAGERP=FIXOUT(11:13);         /* PRINT REAL PAGE NUMBER      1260 04239000
*                                                            @Y30LB40*/ 04240000
         MVC   PAGERP(3),FIXOUT+10                                 1260 04241000
*     CALL EDITBIT(ADDR(CYLIND(K)));/*                       @Y30LB40*/ 04242000
         LH    @06,K                                               1261 04243000
         SLA   @06,2                                               1261 04244000
         L     @01,PTR2                                            1261 04245000
         LA    @06,CYLIND-4(@06,@01)                               1261 04246000
         ST    @06,@AFTEMPS+12                                     1261 04247000
         LA    @06,@AFTEMPS+12                                     1261 04248000
         ST    @06,@AL00001                                        1261 04249000
         LA    @01,@AL00001                                        1261 04250000
         BAL   @14,EDITBIT                                         1261 04251000
*     PAGECYL=BITOUT;               /* PRINT CYLINDER INDICATORS   1262 04252000
*                                                            @Y30LB40*/ 04253000
         MVC   PAGECYL(8),BITOUT                                   1262 04254000
*     RFY                                                          1263 04255000
*      (R0,                                                        1263 04256000
*       R1,                                                        1263 04257000
*       R14,                                                       1263 04258000
*       R15) RSTD;                  /*                       @Y30LB40*/ 04259000
*     GEN(PUT   PRNTDCB,PAGELINE);  /* PRINT PAGE LIST LINE  @Y30LB40*/ 04260000
         PUT   PRNTDCB,PAGELINE                                         04261000
*     RFY                                                          1265 04262000
*      (R0,                                                        1265 04263000
*       R1,                                                        1265 04264000
*       R14,                                                       1265 04265000
*       R15) UNRSTD;                /*                       @Y30LB40*/ 04266000
*     LINECNT=LINECNT+1;            /*                       @Y30LB40*/ 04267000
         AL    LINECNT,@CF00045                                    1266 04268000
*   END;                            /*                       @Y30LB40*/ 04269000
@DE01239 CLC   K(2),J                                              1267 04270000
         BNE   @DL01239                                            1267 04271000
*   END PAGE;                       /*                       @OZ05079*/ 04272000
@EL00014 DS    0H                                                  1268 04273000
@EF00014 DS    0H                                                  1268 04274000
@ER00014 LM    @14,@06,@SA00014                                    1268 04275000
         LM    @08,@12,@SA00014+36                                 1268 04276000
         BR    @14                                                 1268 04277000
*                                                                  1269 04278000
*/********************************************************** @OZ09557*/ 04279000
*/*                                                          @OZ09557*/ 04280000
*/* PROCEDURE NAME - SDTABLE                                 @OZ09557*/ 04281000
*/*                                                          @OZ09557*/ 04282000
*/* FUNCTION - THIS PROCEDURE IS CALLED TO PROCESS THE FIRST @OZ09557*/ 04283000
*/*            STAGE OR DESTAGE MINI IN EACH TRACE DETAIL    @OZ09557*/ 04284000
*/*            RECORD.  IF A TRACE HEADER HAS BEEN           @OZ09557*/ 04285000
*/*            PROCESSED, THE MSC TIME IN THE DETAIL RECORD  @OZ09557*/ 04286000
*/*            IS CONVERTED TO SECONDS FROM HUNDREDTHS OF A  @OZ09557*/ 04287000
*/*            SECOND, AND COMPARED TO THE MSC TIME IN THE   @OZ09557*/ 04288000
*/*            LAST HEADER RECORD.                           @OZ09557*/ 04289000
*/********************************************************** @OZ09557*/ 04290000
*                                                                  1269 04291000
*SDTABLE:                                                          1269 04292000
*   PROC OPTIONS(SAVE);                                            1269 04293000
SDTABLE  STM   @14,@12,12(@13)                                     1269 04294000
*   CKTIME=CKTIME&&CKTIME;          /* CLEAR DATES AND TIME  @Y30LB40*/ 04295000
         XC    CKTIME(7),CKTIME                                    1270 04296000
*   IF M>0                          /* WAS A HEADER STORED   @Y30LB40*/ 04297000
*     THEN                                                         1271 04298000
         LH    @15,M                                               1271 04299000
         LTR   @15,@15                                             1271 04300000
         BNP   @RF01271                                            1271 04301000
*     DO;                           /* CONVERT DATE AND TIME @Y30LB40*/ 04302000
*       RCDTME=T1TIME;              /* SAVE TIME             @Y30LB40*/ 04303000
         L     @01,PTR2                                            1273 04304000
         L     @15,T1TIME(,@01)                                    1273 04305000
         ST    @15,RCDTME                                          1273 04306000
*       SRL(RCDTME,8);              /* TO QUARTER SECONDS    @Y30LB40*/ 04307000
         SRL   @15,8                                               1274 04308000
         ST    @15,RCDTME                                          1274 04309000
*       RCDTME=RCDTME/4;            /* REDUCE TO SECONDS     @Y30LB40*/ 04310000
*                                                                  1275 04311000
         L     @00,RCDTME                                          1275 04312000
         SRDA  @00,32                                              1275 04313000
         D     @00,@CF00104                                        1275 04314000
         ST    @01,RCDTME                                          1275 04315000
*       /*************************************************************/ 04316000
*       /*                                                           */ 04317000
*       /* ************************************************* @OZ09557*/ 04318000
*       /* IF THE MSC TIME IN THE DETAIL RECORD IS GREATER   @OZ09557*/ 04319000
*       /* THAN THE MSC TIME IN THE HEADER RECORD, THEN      @OZ09557*/ 04320000
*       /* CALCULATE THE EQUIVALENT JULIAN DATE AND TIME FOR @OZ09557*/ 04321000
*       /* THIS RECORD FROM THE RELATIVE HOST DATE AND TIME  @OZ09557*/ 04322000
*       /* IN THE HEADER RECORD.                             @OZ09557*/ 04323000
*       /* ************************************************* @OZ09557*/ 04324000
*       /*                                                           */ 04325000
*       /*************************************************************/ 04326000
*                                                                  1276 04327000
*       IF RCDTME>HDRTME            /* RCD TIME LATER THAN HDR TIME     04328000
*                                                            @OZ09557*/ 04329000
*         THEN                                                     1276 04330000
         L     @15,HDRTME                                          1276 04331000
         CR    @01,@15                                             1276 04332000
         BNH   @RF01276                                            1276 04333000
*         DO;                       /* YES                   @Y30LB40*/ 04334000
*           SVETME=HOSTTME+(RCDTME-HDRTME);/* CALC TOD       @OZ09557*/ 04335000
         SLR   @01,@15                                             1278 04336000
         AL    @01,HOSTTME                                         1278 04337000
         ST    @01,SVETME                                          1278 04338000
*           SVEYEAR=HOSTYEAR;       /* SET YEAR              @OZ09557*/ 04339000
         LH    @15,HOSTYEAR                                        1279 04340000
         STC   @15,SVEYEAR                                         1279 04341000
*           SVEJUL=HOSTJUL;         /* SET JULIAN DAY        @OZ09557*/ 04342000
         LH    @15,HOSTJUL                                         1280 04343000
         STH   @15,SVEJUL                                          1280 04344000
*           DO WHILE(SVETME>86399); /* A FULL DAY OR MORE    @Y30LB40*/ 04345000
         B     @DE01281                                            1281 04346000
@DL01281 DS    0H                                                  1282 04347000
*             SVEJUL=SVEJUL+1;      /* BUMP DAY              @Y30LB40*/ 04348000
         LA    @15,1                                               1282 04349000
         AH    @15,SVEJUL                                          1282 04350000
         STH   @15,SVEJUL                                          1282 04351000
*             SVETME=SVETME-86400;  /* DECREMENT BY 1 DAY    @Y30LB40*/ 04352000
         L     @14,SVETME                                          1283 04353000
         SL    @14,@CF01088                                        1283 04354000
         ST    @14,SVETME                                          1283 04355000
*             IF SVEJUL>365         /* ADJUST YEAR AND DATE  @Y30LB40*/ 04356000
*               THEN                                               1284 04357000
         C     @15,@CF01095                                        1284 04358000
         BNH   @RF01284                                            1284 04359000
*               DO;                 /* CHECK FOR LEAP YEAR   @Y30LB40*/ 04360000
*                 IF(CKTIME(1:1)&'00000011'B)='00000000'B THEN     1286 04361000
         MVC   @TS00001(1),CKTIME                                  1286 04362000
         NI    @TS00001,B'00000011'                                1286 04363000
         CLI   @TS00001,B'00000000'                                1286 04364000
         BNE   @RF01286                                            1286 04365000
*                   IF SVEJUL=366   /* LEARYR,IS DAY 366     @Y30LB40*/ 04366000
*                     THEN                                         1287 04367000
         C     @15,@CF01110                                        1287 04368000
         BE    @RT01287                                            1287 04369000
*                     ;             /* YES,LEAVE YEAR ALONE          */ 04370000
*                   ELSE                                           1289 04371000
*                     DO;           /* NO                    @Y30LB40*/ 04372000
*                       SVEYEAR=SVEYEAR+1;/* BUMP YEAR       @Y30LB40*/ 04373000
         LA    @15,1                                               1290 04374000
         SLR   @14,@14                                             1290 04375000
         IC    @14,SVEYEAR                                         1290 04376000
         ALR   @14,@15                                             1290 04377000
         STC   @14,SVEYEAR                                         1290 04378000
*                       SVEJUL=1;   /* RESET DAY             @Y30LB40*/ 04379000
         STH   @15,SVEJUL                                          1291 04380000
*                     END;          /*                       @Y30LB40*/ 04381000
*                 ELSE                                             1293 04382000
*                   DO;             /* NOT LEAP YEAR         @Y30LB40*/ 04383000
         B     @RC01286                                            1293 04384000
@RF01286 DS    0H                                                  1294 04385000
*                     SVEYEAR=SVEYEAR+1;/* BUMP YEAR         @Y30LB40*/ 04386000
         LA    @15,1                                               1294 04387000
         SLR   @14,@14                                             1294 04388000
         IC    @14,SVEYEAR                                         1294 04389000
         ALR   @14,@15                                             1294 04390000
         STC   @14,SVEYEAR                                         1294 04391000
*                     SVEJUL=1;     /* RESET DAY             @Y30LB40*/ 04392000
         STH   @15,SVEJUL                                          1295 04393000
*                   END;            /*                       @Y30LB40*/ 04394000
*               END;                /*                       @Y30LB40*/ 04395000
@RC01286 DS    0H                                                  1298 04396000
*           END;                    /*                       @Y30LB40*/ 04397000
@RF01284 DS    0H                                                  1298 04398000
@DE01281 L     @15,SVETME                                          1298 04399000
         C     @15,@CF01096                                        1298 04400000
         BH    @DL01281                                            1298 04401000
*         END;                      /*                       @Y30LB40*/ 04402000
*                                                                  1299 04403000
*       /*************************************************************/ 04404000
*       /*                                                           */ 04405000
*       /* ************************************************* @OZ09557*/ 04406000
*       /* IF THE MSC TIME IN THE DETAIL RECORD IS LESS THAN @OZ09557*/ 04407000
*       /* THE MSC TIME IN THE HEADER RECORD, EITHER THE     @OZ09557*/ 04408000
*       /* DETAIL RECORD WAS PROCESSED BEFORE THE HEADER     @OZ09557*/ 04409000
*       /* RECORD (UNLIKELY), OR THE MSC CLOCK HAS ROLLED    @OZ09557*/ 04410000
*       /* OVER. THIS ROUTINE IGNORES THE POSSIBILITY OF     @OZ09557*/ 04411000
*       /* CLOCK ROLL-OVER, AND ATTEMPTS TO PROCESS RESIDUAL @OZ09557*/ 04412000
*       /* DATA LEFT FROM A DUMP MAXIMUM.                    @OZ09557*/ 04413000
*       /* ************************************************* @OZ09557*/ 04414000
*       /*                                                           */ 04415000
*       /*************************************************************/ 04416000
*                                                                  1300 04417000
*       ELSE                                                       1300 04418000
*         DO;                       /*                       @OZ09557*/ 04419000
         B     @RC01276                                            1300 04420000
@RF01276 DS    0H                                                  1301 04421000
*           SVETME=HOSTTME-(HDRTME-RCDTME);/* CALC TOD       @OZ09557*/ 04422000
         L     @15,RCDTME                                          1301 04423000
         SL    @15,HDRTME                                          1301 04424000
         AL    @15,HOSTTME                                         1301 04425000
         ST    @15,SVETME                                          1301 04426000
*           SVEYEAR=HOSTYEAR;       /* SET YEAR              @OZ09557*/ 04427000
         LH    @15,HOSTYEAR                                        1302 04428000
         STC   @15,SVEYEAR                                         1302 04429000
*           SVEJUL=HOSTJUL;         /* SET JULIAN DAY        @OZ09557*/ 04430000
         LH    @15,HOSTJUL                                         1303 04431000
         STH   @15,SVEJUL                                          1303 04432000
*           DO WHILE(SVETME<0);     /* A FULL DAY OR MORE    @Y30LB40*/ 04433000
         B     @DE01304                                            1304 04434000
@DL01304 DS    0H                                                  1305 04435000
*             SVEJUL=SVEJUL-1;      /* DECREMENT DAY         @Y30LB40*/ 04436000
         LH    @15,SVEJUL                                          1305 04437000
         BCTR  @15,0                                               1305 04438000
         STH   @15,SVEJUL                                          1305 04439000
*             SVETME=SVETME+86400;  /* BUMP BY 1 DAY         @Y30LB40*/ 04440000
         L     @14,@CF01088                                        1306 04441000
         AL    @14,SVETME                                          1306 04442000
         ST    @14,SVETME                                          1306 04443000
*             IF SVEJUL<1           /* ADJUST YEAR AND DATE  @Y30LB40*/ 04444000
*               THEN                                               1307 04445000
         LTR   @15,@15                                             1307 04446000
         BP    @RF01307                                            1307 04447000
*               DO;                 /* CHECK FOR LEAP YEAR   @Y30LB40*/ 04448000
*                 SVEYEAR=SVEYEAR-1;/* DECREMENT YEAR        @Y30LB40*/ 04449000
         SLR   @15,@15                                             1309 04450000
         IC    @15,SVEYEAR                                         1309 04451000
         BCTR  @15,0                                               1309 04452000
         STC   @15,SVEYEAR                                         1309 04453000
*                 IF(CKTIME(1:1)&'00000011'B)='00000000'B THEN     1310 04454000
         MVC   @TS00001(1),CKTIME                                  1310 04455000
         NI    @TS00001,B'00000011'                                1310 04456000
         CLI   @TS00001,B'00000000'                                1310 04457000
         BNE   @RF01310                                            1310 04458000
*                   SVEJUL=366;     /* LEAP YEAR             @Y30LB40*/ 04459000
         MVC   SVEJUL(2),@CH01110                                  1311 04460000
*                 ELSE                                             1312 04461000
*                   SVEJUL=365;     /* NOT LEAP YEAR         @Y30LB40*/ 04462000
         B     @RC01310                                            1312 04463000
@RF01310 MVC   SVEJUL(2),@CH01095                                  1312 04464000
*               END;                /*                       @Y30LB40*/ 04465000
@RC01310 DS    0H                                                  1314 04466000
*           END;                    /*                       @Y30LB40*/ 04467000
@RF01307 DS    0H                                                  1314 04468000
@DE01304 L     @15,SVETME                                          1314 04469000
         LTR   @15,@15                                             1314 04470000
         BM    @DL01304                                            1314 04471000
*         END;                      /*                       @Y30LB40*/ 04472000
*       N=(RCDTME/86400);           /* CHECK DAY LATER       @OZ09557*/ 04473000
@RC01276 L     @00,RCDTME                                          1316 04474000
         SRDA  @00,32                                              1316 04475000
         D     @00,@CF01088                                        1316 04476000
         STH   @01,N                                               1316 04477000
*       P=M+N;                      /* MAYBE NEW BUCKET      @OZ09557*/ 04478000
         AH    @01,M                                               1317 04479000
         LR    P,@01                                               1317 04480000
*       IF P>750                    /* CHECK BUCKET CTR      @OZ09557*/ 04481000
*         THEN                      /*                       @OZ09557*/ 04482000
         LA    @03,750                                             1318 04483000
         CR    P,@03                                               1318 04484000
         BNH   @RF01318                                            1318 04485000
*         P=750;                    /* MAXIMUM BUCKETS       @OZ09557*/ 04486000
         LR    P,@03                                               1319 04487000
*       DATECNT(P)=DATECNT(P)+1;    /* COUNT FOR DAY         @OZ09557*/ 04488000
@RF01318 LR    @03,P                                               1320 04489000
         SLA   @03,4                                               1320 04490000
         LA    @15,1                                               1320 04491000
         AL    @15,DATECNT-16(@03)                                 1320 04492000
         ST    @15,DATECNT-16(@03)                                 1320 04493000
*       STOREYR(P)=SVEYEAR;         /* SAVE JULIAN YEAR      @OZ09557*/ 04494000
         SLR   @15,@15                                             1321 04495000
         IC    @15,SVEYEAR                                         1321 04496000
         STH   @15,STOREYR-16(@03)                                 1321 04497000
*       STOREJUL(P)=SVEJUL;         /* SAVE JULIAN DAY       @OZ09557*/ 04498000
*                                                                  1322 04499000
         LH    @15,SVEJUL                                          1322 04500000
         STH   @15,STOREJUL-16(@03)                                1322 04501000
*       /*************************************************************/ 04502000
*       /*                                                           */ 04503000
*       /* ************************************************* @OZ09557*/ 04504000
*       /* THE VALUES SAVED FOR MSC TIME AND CONVERTED TIME  @OZ09557*/ 04505000
*       /* ARE THE ENDING TIMES FOR THE TRACE PERIOD. (THE   @OZ09557*/ 04506000
*       /* TRACE HEADERS CONTAIN THE STARTING TIMES OF THE   @OZ09557*/ 04507000
*       /* TRACE PERIODS.                                    @OZ09557*/ 04508000
*       /* ************************************************* @OZ09557*/ 04509000
*       /*                                                           */ 04510000
*       /*************************************************************/ 04511000
*                                                                  1323 04512000
*       IF RCDTME>STOREDSM(P)       /*                       @OZ09557*/ 04513000
*         THEN                                                     1323 04514000
         L     @15,RCDTME                                          1323 04515000
         C     @15,STOREDSM-16(@03)                                1323 04516000
         BNH   @RF01323                                            1323 04517000
*         DO;                       /*                       @Y30LB40*/ 04518000
*           STORETIM(P)=SVETME;     /*                       @OZ09557*/ 04519000
         L     @14,SVETME                                          1325 04520000
         ST    @14,STORETIM-16(@03)                                1325 04521000
*           STOREDSM(P)=RCDTME;     /*                       @OZ09557*/ 04522000
         ST    @15,STOREDSM-16(@03)                                1326 04523000
*         END;                      /*                       @Y30LB40*/ 04524000
*     END;                          /*                       @Y30LB40*/ 04525000
*   END SDTABLE;                    /*                       @Y30LB40*/ 04526000
@EL00015 DS    0H                                                  1329 04527000
@EF00015 DS    0H                                                  1329 04528000
@ER00015 LM    @14,@12,12(@13)                                     1329 04529000
         BR    @14                                                 1329 04530000
*                                                                  1330 04531000
*/********************************************************************  04532000
*                                                                    */ 04533000
*/**ROUTINE TO CONVERT TIME TO HH MM SS*                     @Y30LB40*/ 04534000
*/********************************************************************  04535000
*                                                                    */ 04536000
*                                                                  1330 04537000
*CONVERTM:                                                         1330 04538000
*   PROC OPTIONS(SAVE);             /*                       @Y30LB40*/ 04539000
CONVERTM STM   @14,@12,12(@13)                                     1330 04540000
*   HOUR=(DAYS/3600);               /* CALCULATE HOUR OF THE DAY     */ 04541000
         L     @15,DAYS                                            1331 04542000
         LA    @14,3600                                            1331 04543000
         LR    @00,@15                                             1331 04544000
         SRDA  @00,32                                              1331 04545000
         DR    @00,@14                                             1331 04546000
         STH   @01,HOUR                                            1331 04547000
*   MINUTE=(DAYS-(HOUR*3600))/60;   /* CALCULATE MINUTES OF DAY      */ 04548000
         LA    @07,60                                              1332 04549000
         MR    @00,@14                                             1332 04550000
         LR    @02,@15                                             1332 04551000
         SLR   @02,@01                                             1332 04552000
         SRDA  @02,32                                              1332 04553000
         DR    @02,@07                                             1332 04554000
         STH   @03,MINUTE                                          1332 04555000
*   SECOND=DAYS-((HOUR*3600)+(MINUTE*60));/* CALC SECONDS            */ 04556000
         MR    @02,@07                                             1333 04557000
         ALR   @01,@03                                             1333 04558000
         SLR   @15,@01                                             1333 04559000
         STH   @15,SECOND                                          1333 04560000
*   END CONVERTM;                   /*                       @Y30LB40*/ 04561000
@EL00016 DS    0H                                                  1334 04562000
@EF00016 DS    0H                                                  1334 04563000
@ER00016 LM    @14,@12,12(@13)                                     1334 04564000
         BR    @14                                                 1334 04565000
*                                                                  1335 04566000
*/********************************************************************  04567000
*                                                                    */ 04568000
*/* ROUTINE TO PRINT NEW PAGE HEADINGS                       @Y30LB40*/ 04569000
*/********************************************************************  04570000
*                                                                    */ 04571000
*                                                                  1335 04572000
*NEWPAGE:                                                          1335 04573000
*   PROC OPTIONS(SAVE);             /*                       @Y30LB40*/ 04574000
NEWPAGE  STM   @14,@06,@SA00017                                    1335 04575000
         STM   @08,@12,@SA00017+36                                 1335 04576000
*   LINECNT=1;                      /* RESET LINE COUNT      @Y30LB40*/ 04577000
         LA    @15,1                                               1336 04578000
         LR    LINECNT,@15                                         1336 04579000
*   PAGECNT=PAGECNT+1;              /* UPDATE PAGE COUNT     @Y30LB40*/ 04580000
         AH    @15,PAGECNT                                         1337 04581000
         STH   @15,PAGECNT                                         1337 04582000
*   BLKLINE=HDNG1;                  /*                       @Y30LB40*/ 04583000
         MVC   BLKLINE(121),HDNG1                                  1338 04584000
*   CALL EDITFIX(ADDR(PAGECNT),2,'S');/*                     @Y30LB40*/ 04585000
         MVC   @AL00001+4(8),@AL01339                              1339 04586000
         LA    @06,PAGECNT                                         1339 04587000
         ST    @06,@AFTEMPS+16                                     1339 04588000
         LA    @06,@AFTEMPS+16                                     1339 04589000
         ST    @06,@AL00001                                        1339 04590000
         LA    @01,@AL00001                                        1339 04591000
         BAL   @14,EDITFIX                                         1339 04592000
*   BLKLINE(118:121)=FIXOUT(10:13); /*                       @Y30LB40*/ 04593000
         MVC   BLKLINE+117(4),FIXOUT+9                             1340 04594000
*   BLKLINE(107:111)=TODAY;         /*                       @Y30LB40*/ 04595000
         MVC   BLKLINE+106(5),TODAY                                1341 04596000
*   RFY                                                            1342 04597000
*    (R0,                                                          1342 04598000
*     R1,                                                          1342 04599000
*     R14,                                                         1342 04600000
*     R15) RSTD;                    /*                       @Y30LB40*/ 04601000
*   GEN(PUT   PRNTDCB,BLKLINE);     /*                       @Y30LB40*/ 04602000
         PUT   PRNTDCB,BLKLINE                                          04603000
*   RFY                                                            1344 04604000
*    (R0,                                                          1344 04605000
*     R1,                                                          1344 04606000
*     R14,                                                         1344 04607000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 04608000
*   END NEWPAGE;                    /*                       @Y30LB40*/ 04609000
@EL00017 DS    0H                                                  1345 04610000
@EF00017 DS    0H                                                  1345 04611000
@ER00017 LM    @14,@06,@SA00017                                    1345 04612000
         LM    @08,@12,@SA00017+36                                 1345 04613000
         BR    @14                                                 1345 04614000
*                                                                  1346 04615000
*/********************************************************************  04616000
*                                                                    */ 04617000
*/* ROUTINE TO CONVERT A BYTE TO PRINTABLE BIT STRING        @Y30LB40*/ 04618000
*/********************************************************************  04619000
*                                                                    */ 04620000
*                                                                  1346 04621000
*EDITBIT:                                                          1346 04622000
*   PROC(BITADDR) OPTIONS(SAVE);    /*                       @Y30LB40*/ 04623000
EDITBIT  STM   @14,@12,@SA00018                                    1346 04624000
         MVC   @PC00018(4),0(@01)                                  1346 04625000
*   DCL                                                            1347 04626000
*     BITADDR PTR(31);              /* ADDRESS OF BYTE TO BE       1347 04627000
*                                      CONVERTED             @Y30LB40*/ 04628000
*   DCL                                                            1348 04629000
*     EIGHT0 CHAR(8) STATIC INIT('00000000');/*              @Y30LB40*/ 04630000
*   RFY                                                            1349 04631000
*    (R2) RSTD;                     /*                       @Y30LB40*/ 04632000
*   R2=BITADDR;                     /*                       @Y30LB40*/ 04633000
         L     @15,@PC00018                                        1350 04634000
         L     R2,BITADDR(,@15)                                    1350 04635000
*   GEN;                                                           1351 04636000
*                                                         /*@Y30LB40*/  04637000
         MVC   BITOUT,EIGHT0                                            04638000
         TM    0(R2),X'80'                                              04639000
         BZ    EB1                                                      04640000
         MVI   BITOUT,C'1'                                              04641000
EB1      EQU   *                                                        04642000
         TM    0(R2),X'40'                                              04643000
         BZ    EB2                                                      04644000
         MVI   BITOUT+1,C'1'                                            04645000
EB2      EQU   *                                                        04646000
         TM    0(R2),X'20'                                              04647000
         BZ    EB3                                                      04648000
         MVI   BITOUT+2,C'1'                                            04649000
EB3      EQU   *                                                        04650000
         TM    0(R2),X'10'                                              04651000
         BZ    EB4                                                      04652000
         MVI   BITOUT+3,C'1'                                            04653000
EB4      EQU   *                                                        04654000
         TM    0(R2),X'08'                                              04655000
         BZ    EB5                                                      04656000
         MVI   BITOUT+4,C'1'                                            04657000
EB5      EQU   *                                                        04658000
         TM    0(R2),X'04'                                              04659000
         BZ    EB6                                                      04660000
         MVI   BITOUT+5,C'1'                                            04661000
EB6      EQU   *                                                        04662000
         TM    0(R2),X'02'                                              04663000
         BZ    EB7                                                      04664000
         MVI   BITOUT+6,C'1'                                            04665000
EB7      EQU   *                                                        04666000
         TM    0(R2),X'01'                                              04667000
         BZ    EB8                                                      04668000
         MVI   BITOUT+7,C'1'                                            04669000
EB8      EQU   *                                                        04670000
*   RFY                                                            1352 04671000
*    (R2) UNRSTD;                   /*                       @Y30LB40*/ 04672000
*   END EDITBIT;                    /*                       @Y30LB40*/ 04673000
@EL00018 DS    0H                                                  1353 04674000
@EF00018 DS    0H                                                  1353 04675000
@ER00018 LM    @14,@12,@SA00018                                    1353 04676000
         BR    @14                                                 1353 04677000
*                                                                  1354 04678000
*/********************************************************************  04679000
*                                                                    */ 04680000
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */ 04681000
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */ 04682000
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/ 04683000
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1, 2, OR 4  04684000
*                                                                    */ 04685000
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/ 04686000
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/ 04687000
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/ 04688000
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/ 04689000
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */ 04690000
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/ 04691000
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */ 04692000
*/* LONG.                                                    @Y30LB40*/ 04693000
*/********************************************************************  04694000
*                                                                    */ 04695000
*                                                                  1354 04696000
*EDITFIX:                                                          1354 04697000
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/ 04698000
EDITFIX  STM   @14,@12,@SA00019                                    1354 04699000
         MVC   @PC00019(12),0(@01)                                 1354 04700000
*   DCL                                                            1355 04701000
*     FIXADDR PTR(31);              /* ADDRESS OF INPUT FIELD      1355 04702000
*                                                            @Y30LB40*/ 04703000
*   DCL                                                            1356 04704000
*     FIXLEN PTR(31);               /* LENGTH OF INPUT FIELD @Y30LB40*/ 04705000
*   DCL                                                            1357 04706000
*     FIXOPT CHAR(1);               /* EDITING OPTION DESIRED      1357 04707000
*                                                            @Y30LB40*/ 04708000
*   RFY                                                            1358 04709000
*    (R2,                                                          1358 04710000
*     R3) RSTD;                     /*                       @Y30LB40*/ 04711000
*   R2=FIXADDR;                     /*                       @Y30LB40*/ 04712000
         L     @15,@PC00019                                        1359 04713000
         L     R2,FIXADDR(,@15)                                    1359 04714000
*   DOUBLEWD=DOUBLEWD&&DOUBLEWD;    /*                       @Y30LB40*/ 04715000
         XC    DOUBLEWD(8),DOUBLEWD                                1360 04716000
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE   04717000
*                                                            @Y30LB40*/ 04718000
*     THEN                                                         1361 04719000
         L     @15,@PC00019+4                                      1361 04720000
         CLC   FIXLEN(4,@15),@CF00045                              1361 04721000
         BNE   @RF01361                                            1361 04722000
*     DO;                           /*                       @Y30LB40*/ 04723000
*       GEN(MVC   DOUBLEWD+3(1),0(R2));/*                    @Y30LB40*/ 04724000
         MVC   DOUBLEWD+3(1),0(R2)                                      04725000
*     END;                          /*                       @Y30LB40*/ 04726000
*   ELSE                                                           1365 04727000
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   1365 04728000
*                                      BYTES                 @Y30LB40*/ 04729000
*       THEN                                                       1365 04730000
         B     @RC01361                                            1365 04731000
@RF01361 L     @15,@PC00019+4                                      1365 04732000
         CLC   FIXLEN(4,@15),@CF00052                              1365 04733000
         BNE   @RF01365                                            1365 04734000
*       DO;                         /*                       @Y30LB40*/ 04735000
*         GEN(MVC   DOUBLEWD+2(2),0(R2));/*                  @Y30LB40*/ 04736000
         MVC   DOUBLEWD+2(2),0(R2)                                      04737000
*       END;                        /*                       @Y30LB40*/ 04738000
*     ELSE                                                         1369 04739000
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/ 04740000
         B     @RC01365                                            1369 04741000
@RF01365 DS    0H                                                  1370 04742000
*         GEN(MVC   DOUBLEWD(4),0(R2));/*                    @Y30LB40*/ 04743000
         MVC   DOUBLEWD(4),0(R2)                                        04744000
*       END;                        /*                       @Y30LB40*/ 04745000
*   GEN;                                                           1372 04746000
@RC01365 DS    0H                                                  1372 04747000
@RC01361 DS    0H                                                  1372 04748000
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/  04749000
  L     R2,DOUBLEWD                                                     04750000
  CVD   R2,DOUBLEWD                                                     04751000
  OI    DOUBLEWD+7,X'0F'                                                04752000
  UNPK  FIXOUT(13),DOUBLEWD+2(6)                                        04753000
*   IF FIXOPT='N' THEN                                             1373 04754000
         L     @15,@PC00019+8                                      1373 04755000
         CLI   FIXOPT(@15),C'N'                                    1373 04756000
         BE    @RT01373                                            1373 04757000
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */ 04758000
*   IF FIXOPT='S' THEN                                             1375 04759000
         CLI   FIXOPT(@15),C'S'                                    1375 04760000
         BE    @RT01375                                            1375 04761000
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       1376 04762000
*                                      INSERTION                     */ 04763000
*   GEN;                                                           1377 04764000
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/  04765000
  MVC   FIXOUT(1),FIXOUT+3                                              04766000
  MVI   FIXOUT+1,C','                                                   04767000
  MVC   FIXOUT+2(3),FIXOUT+4                                            04768000
  MVI   FIXOUT+5,C','                                                   04769000
  MVC   FIXOUT+6(3),FIXOUT+7                                            04770000
  MVI   FIXOUT+9,C','                                                   04771000
*EF4:                               /* ZERO AND COMMA SUPPRESS     1378 04772000
*                                                            @Y30LB40*/ 04773000
*   GEN;                                                           1378 04774000
EF4      DS    0H                                                  1378 04775000
*                                                         /*@Y30LB40*/  04776000
         LA    R2,FIXOUT                                                04777000
         LA    R3,12                                                    04778000
EF5      EQU   *                                                        04779000
         CLI   0(R2),C','                                               04780000
         BE    EF6                                                      04781000
         CLI   0(R2),C'0'                                               04782000
         BNE   EFEND                                                    04783000
EF6      EQU   *                                                        04784000
         MVI   0(R2),C' '                                               04785000
         LA    R2,1(R2)                                                 04786000
         BCT   R3,EF5                                                   04787000
*EFEND:                                                            1379 04788000
*   RFY                                                            1379 04789000
*    (R2,                                                          1379 04790000
*     R3) UNRSTD;                   /*                       @Y30LB40*/ 04791000
*   END EDITFIX;                    /*                       @Y30LB40*/ 04792000
@EL00019 DS    0H                                                  1380 04793000
@EF00019 DS    0H                                                  1380 04794000
@ER00019 LM    @14,@12,@SA00019                                    1380 04795000
         BR    @14                                                 1380 04796000
*                                                                  1381 04797000
*/********************************************************************  04798000
*                                                                    */ 04799000
*/* ROUTINE TO CONVERT BYTES TO PRINTABLE HEXADECIMAL        @Y30LB40*/ 04800000
*/********************************************************************  04801000
*                                                                    */ 04802000
*                                                                  1381 04803000
*EDITHEX:                                                          1381 04804000
*   PROC(HEXADDR,HEXLEN) OPTIONS(SAVE);/*                    @Y30LB40*/ 04805000
EDITHEX  STM   @14,@12,@SA00020                                    1381 04806000
         MVC   @PC00020(8),0(@01)                                  1381 04807000
*   DCL                                                            1382 04808000
*     HEXADDR PTR(31);              /* ADDRESS OF BYTES TO BE      1382 04809000
*                                      CONVERTED             @Y30LB40*/ 04810000
*   DCL                                                            1383 04811000
*     HEXLEN PTR(31);               /* NUMBER OF BYTES TO BE       1383 04812000
*                                      CONVERTED             @Y30LB40*/ 04813000
*   DCL                                                            1384 04814000
*     NINE FIXED(15) STATIC INIT(9);/*                       @Y30LB40*/ 04815000
*   DCL                                                            1385 04816000
*     MASK FIXED(31) STATIC INIT('0000000F'X);/*             @Y30LB40*/ 04817000
*   RFY                                                            1386 04818000
*    (R2,                                                          1386 04819000
*     R3,                                                          1386 04820000
*     R4,                                                          1386 04821000
*     R5) RSTD;                     /*                       @Y30LB40*/ 04822000
*   R2=HEXADDR;                     /*                       @Y30LB40*/ 04823000
         L     @15,@PC00020                                        1387 04824000
         L     R2,HEXADDR(,@15)                                    1387 04825000
*   R3=HEXLEN;                      /*                       @Y30LB40*/ 04826000
         L     @15,@PC00020+4                                      1388 04827000
         L     R3,HEXLEN(,@15)                                     1388 04828000
*   R4=0;                           /*                       @Y30LB40*/ 04829000
         SLR   R4,R4                                               1389 04830000
*   R5=ADDR(HEXOUT);                /*                       @Y30LB40*/ 04831000
         LA    R5,HEXOUT                                           1390 04832000
*   GEN;                                                           1391 04833000
*                                                         /*@Y30LB40*/  04834000
EH0      EQU   *                                                        04835000
         IC    R4,0(R2)                                                 04836000
         SRA   R4,4                                                     04837000
         STC   R4,0(R5)                                                 04838000
         CH    R4,NINE                                                  04839000
         BNH   EH1                                                      04840000
         SH    R4,NINE                                                  04841000
         STC   R4,0(R5)                                                 04842000
         OI    0(R5),X'C0'                                              04843000
         B     EH2                                                      04844000
EH1      EQU   *                                                        04845000
         OI    0(R5),X'F0'                                              04846000
EH2      EQU   *                                                        04847000
         LA    R5,1(R5)                                                 04848000
         IC    R4,0(R2)                                                 04849000
         N     R4,MASK                                                  04850000
         STC   R4,0(R5)                                                 04851000
         CH    R4,NINE                                                  04852000
         BNH   EH3                                                      04853000
         SH    R4,NINE                                                  04854000
         STC   R4,0(R5)                                                 04855000
         OI    0(R5),X'C0'                                              04856000
         B     EH4                                                      04857000
EH3      EQU   *                                                        04858000
         OI    0(R5),X'F0'                                              04859000
EH4      EQU   *                                                        04860000
         LA    R5,1(R5)                                                 04861000
         LA    R2,1(R2)                                                 04862000
         BCT   R3,EH0                                                   04863000
*   RFY                                                            1392 04864000
*    (R2,                                                          1392 04865000
*     R3,                                                          1392 04866000
*     R4,                                                          1392 04867000
*     R5) UNRSTD;                   /*                       @Y30LB40*/ 04868000
*   END EDITHEX;                    /*                       @Y30LB40*/ 04869000
@EL00020 DS    0H                                                  1393 04870000
@EF00020 DS    0H                                                  1393 04871000
@ER00020 LM    @14,@12,@SA00020                                    1393 04872000
         BR    @14                                                 1393 04873000
*                                                                  1394 04874000
*/********************************************************** @OZ05079*/ 04875000
*/*                                                          @OZ05079*/ 04876000
*/* PROCEDURE NAME - GENCONFG                                @OZ05079*/ 04877000
*/*                                                          @OZ05079*/ 04878000
*/* FUNCTION - THIS PROCEDURE EXTRACTS FROM THE TRACE        @OZ05079*/ 04879000
*/*            HEADER (COPY OF VERIFICATION RECORD 6) THE    @OZ05079*/ 04880000
*/*            NUMBER OF DATA RECORDING DEVICES THAT         @OZ05079*/ 04881000
*/*            ARE VALID FOR EACH MSF.  THIS INFORMATION     @OZ05079*/ 04882000
*/*            IS USED TO TRANSLATE THE LOGICAL DRD/DRD PATH @OZ05079*/ 04883000
*/*            INTO THE SSIDS FOR THE DATA RECORDING         @OZ05079*/ 04884000
*/*            CONTROLLER AND DATA RECORDING DEVICE.         @OZ05079*/ 04885000
*/*            THE ONLY MSF SIZE THAT REQUIRES SPECIAL       @OZ05079*/ 04886000
*/*            HANDLING IS A3/B3.                            @OZ05079*/ 04887000
*/*                                                          @OZ05079*/ 04888000
*/********************************************************** @OZ05079*/ 04889000
*                                                                  1394 04890000
*GENCONFG:                                                         1394 04891000
*   PROCEDURE;                      /*                       @OZ05079*/ 04892000
GENCONFG STM   @14,@12,12(@13)                                     1394 04893000
*   DO INDEX=1 TO MAXMSF;           /*                       @OZ05079*/ 04894000
         LA    INDEX,1                                             1395 04895000
@DL01395 DS    0H                                                  1396 04896000
*     MSFCONFG(INDEX)=NOSIZE;       /*                       @OZ05079*/ 04897000
         SLR   @03,@03                                             1396 04898000
         STC   @03,MSFCONFG-1(INDEX)                               1396 04899000
*     IF VRW(INDEX)=SIZEA3B3        /*                       @OZ05079*/ 04900000
*       THEN                        /*                       @OZ05079*/ 04901000
         LA    @03,VRW-1(INDEX)                                    1397 04902000
         CLI   0(@03),B'11111100'                                  1397 04903000
         BNE   @RF01397                                            1397 04904000
*       MSFCONFG(INDEX)=MSFA3B3;    /*                       @OZ05079*/ 04905000
         LA    @03,3                                               1398 04906000
         STC   @03,MSFCONFG-1(INDEX)                               1398 04907000
*   END;                            /*                       @OZ05079*/ 04908000
@RF01397 AL    INDEX,@CF00045                                      1399 04909000
         C     INDEX,@CF00104                                      1399 04910000
         BNH   @DL01395                                            1399 04911000
*   END GENCONFG;                   /*                       @OZ05079*/ 04912000
@EL00021 DS    0H                                                  1400 04913000
@EF00021 DS    0H                                                  1400 04914000
@ER00021 LM    @14,@12,12(@13)                                     1400 04915000
         BR    @14                                                 1400 04916000
*                                                                  1401 04917000
*/********************************************************** @OZ05079*/ 04918000
*/*                                                          @OZ05079*/ 04919000
*/* PROCEDURE NAME - TRDRCDRD                                @OZ05079*/ 04920000
*/*                                                          @OZ05079*/ 04921000
*/* FUNCTION - THIS PROCEDURE TRANSLATES CONTROLLER AND      @OZ05079*/ 04922000
*/*            AND LOGICAL DATA RECORDING DEVICE FOR THE     @OZ05079*/ 04923000
*/*            DRC INTO THE SSIDS FOR BOTH DRC AND DRD BASED @OZ05079*/ 04924000
*/*            ON THE CONFIGURATION OF THE MSF AS SPECIFIED  @OZ05079*/ 04925000
*/*            IN THE TRACE HEADER RECORD.                   @OZ05079*/ 04926000
*/*                                                          @OZ05079*/ 04927000
*/********************************************************** @OZ05079*/ 04928000
*                                                                  1401 04929000
*TRDRCDRD:                                                         1401 04930000
*   PROCEDURE;                      /*                       @OZ05079*/ 04931000
TRDRCDRD STM   @14,@12,12(@13)                                     1401 04932000
*   DRDINDEX=0;                     /*                       @OZ05079*/ 04933000
         SLR   DRDINDEX,DRDINDEX                                   1402 04934000
*   DRCINDEX=0;                     /*                       @OZ05079*/ 04935000
*                                                                  1403 04936000
         SLR   DRCINDEX,DRCINDEX                                   1403 04937000
*   /*****************************************************************/ 04938000
*   /*                                                               */ 04939000
*   /* ***********************************************       @OZ05079*/ 04940000
*   /* DETERMINE THE LOW-ORDER DIGIT OF THE SSID OF          @OZ05079*/ 04941000
*   /* THE DATA RECORDING CONTROLLER FROM THE FIFTH          @OZ05079*/ 04942000
*   /* AND SIXTH BITS OF 'DRD ADDRESS'.                      @OZ05079*/ 04943000
*   /* ***********************************************       @OZ05079*/ 04944000
*   /*                                                               */ 04945000
*   /*****************************************************************/ 04946000
*                                                                  1404 04947000
*   IF CONTRLR=ZEROZERO             /* DRC = 4X0             @OZ05079*/ 04948000
*     THEN                          /*                       @OZ05079*/ 04949000
         TM    CONTRLR,B'00001100'                                 1404 04950000
         BNZ   @RF01404                                            1404 04951000
*     DO;                           /*                       @OZ05079*/ 04952000
*       DRCPRINT='0';               /* PRINT LOW-ORDER       @OZ05079*/ 04953000
         MVI   DRCPRINT,C'0'                                       1406 04954000
*       DRCINDEX=1;                 /* TO DEVELOP DRD        @OZ05079*/ 04955000
         LA    DRCINDEX,1                                          1407 04956000
*     END;                          /*                       @OZ05079*/ 04957000
*   ELSE                                                           1409 04958000
*     ;                             /*                       @OZ05079*/ 04959000
@RF01404 DS    0H                                                  1410 04960000
*   IF CONTRLR=ZEROONE              /* DRC = 4X1             @OZ05079*/ 04961000
*     THEN                          /*                       @OZ05079*/ 04962000
         TM    CONTRLR,B'00000100'                                 1410 04963000
         BNO   @RF01410                                            1410 04964000
         TM    CONTRLR,B'00001000'                                 1410 04965000
         BNZ   @RF01410                                            1410 04966000
*     DO;                           /*                       @OZ05079*/ 04967000
*       DRCPRINT='1';               /* PRINT LOW-ORDER       @OZ05079*/ 04968000
         MVI   DRCPRINT,C'1'                                       1412 04969000
*       DRCINDEX=2;                 /* TO DEVELOP DRD        @OZ05079*/ 04970000
         LA    DRCINDEX,2                                          1413 04971000
*     END;                          /*                       @OZ05079*/ 04972000
*   ELSE                                                           1415 04973000
*     ;                             /*                       @OZ05079*/ 04974000
@RF01410 DS    0H                                                  1416 04975000
*   IF CONTRLR=ONEZERO              /* DRC = 4X2             @OZ05079*/ 04976000
*     THEN                          /*                       @OZ05079*/ 04977000
         TM    CONTRLR,B'00001000'                                 1416 04978000
         BNO   @RF01416                                            1416 04979000
         TM    CONTRLR,B'00000100'                                 1416 04980000
         BNZ   @RF01416                                            1416 04981000
*     DO;                           /*                       @OZ05079*/ 04982000
*       DRCPRINT='2';               /* PRINT LOW-ORDER       @OZ05079*/ 04983000
         MVI   DRCPRINT,C'2'                                       1418 04984000
*       DRCINDEX=3;                 /* TO DEVELOP DRD        @OZ05079*/ 04985000
         LA    DRCINDEX,3                                          1419 04986000
*     END;                          /*                       @OZ05079*/ 04987000
*   ELSE                                                           1421 04988000
*     ;                             /*                       @OZ05079*/ 04989000
@RF01416 DS    0H                                                  1422 04990000
*   IF CONTRLR=ONEONE               /* DRC = 4X3             @OZ05079*/ 04991000
*     THEN                          /*                       @OZ05079*/ 04992000
         TM    CONTRLR,B'00001100'                                 1422 04993000
         BNO   @RF01422                                            1422 04994000
*     DO;                           /*                       @OZ05079*/ 04995000
*       DRCPRINT='3';               /* PRINT LOW-ORDER       @OZ05079*/ 04996000
         MVI   DRCPRINT,C'3'                                       1424 04997000
*       DRCINDEX=4;                 /* TO DEVELOP DRD        @OZ05079*/ 04998000
         LA    DRCINDEX,4                                          1425 04999000
*     END;                          /*                       @OZ05079*/ 05000000
*   ELSE                                                           1427 05001000
*     ;                             /*                       @OZ05079*/ 05002000
*                                                                  1427 05003000
@RF01422 DS    0H                                                  1428 05004000
*   /*****************************************************************/ 05005000
*   /*                                                               */ 05006000
*   /* ***********************************************       @OZ05079*/ 05007000
*   /* DETERMINE THE INDEX VALUE FOR LOGICAL DRD BY          @OZ05079*/ 05008000
*   /* EXTRACTING THE TWO LOW-ORDER BITS FROM THE DRD        @OZ05079*/ 05009000
*   /* FIELD AND ADDING BINARY ONE.                          @OZ05079*/ 05010000
*   /* ***********************************************       @OZ05079*/ 05011000
*   /*                                                               */ 05012000
*   /*****************************************************************/ 05013000
*                                                                  1428 05014000
*   IF RWU=ZEROZERO                 /*                       @OZ05079*/ 05015000
*     THEN                          /*                       @OZ05079*/ 05016000
         TM    RWU,B'00000011'                                     1428 05017000
         BNZ   @RF01428                                            1428 05018000
*     DRDINDEX=1;                   /*                       @OZ05079*/ 05019000
         LA    DRDINDEX,1                                          1429 05020000
*   IF RWU=ZEROONE                  /*                       @OZ05079*/ 05021000
*     THEN                          /*                       @OZ05079*/ 05022000
@RF01428 TM    RWU,B'00000001'                                     1430 05023000
         BNO   @RF01430                                            1430 05024000
         TM    RWU,B'00000010'                                     1430 05025000
         BNZ   @RF01430                                            1430 05026000
*     DRDINDEX=2;                   /*                       @OZ05079*/ 05027000
         LA    DRDINDEX,2                                          1431 05028000
*   IF RWU=ONEZERO                  /*                       @OZ05079*/ 05029000
*     THEN                          /*                       @OZ05079*/ 05030000
@RF01430 TM    RWU,B'00000010'                                     1432 05031000
         BNO   @RF01432                                            1432 05032000
         TM    RWU,B'00000001'                                     1432 05033000
         BNZ   @RF01432                                            1432 05034000
*     DRDINDEX=3;                   /*                       @OZ05079*/ 05035000
         LA    DRDINDEX,3                                          1433 05036000
*   IF RWU=ONEONE                   /*                       @OZ05079*/ 05037000
*     THEN                          /*                       @OZ05079*/ 05038000
@RF01432 TM    RWU,B'00000011'                                     1434 05039000
         BNO   @RF01434                                            1434 05040000
*     DRDINDEX=4;                   /*                       @OZ05079*/ 05041000
*                                                                  1435 05042000
         LA    DRDINDEX,4                                          1435 05043000
*   /*****************************************************************/ 05044000
*   /*                                                               */ 05045000
*   /* ***********************************************       @OZ05079*/ 05046000
*   /* IF THIS MSF WAS DESCRIBED IN THE TRACE HEADER         @OZ05079*/ 05047000
*   /* RECORD AS AN A3/B3 MODEL, USE SPECIAL A3/B3           @OZ05079*/ 05048000
*   /* TRANSLATE ROUTINE. OTHERWISE, USE REGULAR             @OZ05079*/ 05049000
*   /* TRANSLATE ROUTINE.                                    @OZ05079*/ 05050000
*   /* ***********************************************       @OZ05079*/ 05051000
*   /*                                                               */ 05052000
*   /*****************************************************************/ 05053000
*                                                                  1436 05054000
*   IF MSFCONFG(LIBRID+1)=MSFA3B3   /*                       @OZ05079*/ 05055000
*     THEN                          /*                       @OZ05079*/ 05056000
@RF01434 SLR   @01,@01                                             1436 05057000
         IC    @01,LIBRID                                          1436 05058000
         SLR   @00,@00                                             1436 05059000
         IC    @00,MSFCONFG(@01)                                   1436 05060000
         C     @00,@CF00831                                        1436 05061000
         BNE   @RF01436                                            1436 05062000
*     DRDPRINT=SPECLKUP(DRCINDEX,DRDINDEX);/*                @OZ05079*/ 05063000
         LR    @15,DRCINDEX                                        1437 05064000
         SLA   @15,2                                               1437 05065000
         ALR   @15,DRDINDEX                                        1437 05066000
         LA    @14,SPECLKUP-5(@15)                                 1437 05067000
         MVC   DRDPRINT(1),0(@14)                                  1437 05068000
*   ELSE                            /*                       @OZ05079*/ 05069000
*     DRDPRINT=REGLOKUP(DRCINDEX,DRDINDEX);/*                @OZ05079*/ 05070000
         B     @RC01436                                            1438 05071000
@RF01436 LR    @15,DRCINDEX                                        1438 05072000
         SLA   @15,2                                               1438 05073000
         ALR   @15,DRDINDEX                                        1438 05074000
         LA    @14,REGLOKUP-5(@15)                                 1438 05075000
         MVC   DRDPRINT(1),0(@14)                                  1438 05076000
*   END TRDRCDRD;                   /*                       @OZ05079*/ 05077000
@EL00022 DS    0H                                                  1439 05078000
@EF00022 DS    0H                                                  1439 05079000
@ER00022 LM    @14,@12,12(@13)                                     1439 05080000
         BR    @14                                                 1439 05081000
*                                                                  1440 05082000
*/********************************************************** @OZ05124*/ 05083000
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/ 05084000
*/********************************************************** @OZ05124*/ 05085000
*                                                                  1440 05086000
*READERR:                                                          1440 05087000
*   ;                               /*                       @OZ05124*/ 05088000
READERR  DS    0H                                                  1441 05089000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/ 05090000
         SYNADAF ACSMETH=QSAM                                           05091000
*   PRNTLINE=' ';                   /*                       @ZA17158*/ 05092000
         MVI   PRNTLINE+1,C' '                                     1442 05093000
         MVC   PRNTLINE+2(119),PRNTLINE+1                          1442 05094000
         MVI   PRNTLINE,C' '                                       1442 05095000
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/ 05096000
         MVC   PRNTLINE+30(79),49(R1)                                   05097000
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/ 05098000
         MVC   PRNTLINE(30),ICGTR904                               1444 05099000
*   INCNT1=INCNT1+1;                /*                       @ZA17158*/ 05100000
         LH    @07,INCNT1                                          1445 05101000
         LA    @07,1(,@07)                                         1445 05102000
         STH   @07,INCNT1                                          1445 05103000
*   SAVE14=R14;                     /*                       @OZ09522*/ 05104000
         LR    SAVE14,R14                                          1446 05105000
*   RFY                                                            1447 05106000
*    (R0,                                                          1447 05107000
*     R1,                                                          1447 05108000
*     R14,                                                         1447 05109000
*     R15) RSTD;                    /*                       @OZ05124*/ 05110000
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/ 05111000
         PUT PRNTDCB,PRNTLINE                                           05112000
*   RFY                                                            1449 05113000
*    (R0,                                                          1449 05114000
*     R1,                                                          1449 05115000
*     R14,                                                         1449 05116000
*     R15) UNRSTD;                  /*                       @OZ05124*/ 05117000
*   R14=SAVE14;                     /*                       @OZ09522*/ 05118000
         LR    R14,SAVE14                                          1450 05119000
*   GEN(SYNADRLS);                  /*                       @OZ05124*/ 05120000
         SYNADRLS                                                       05121000
*   RETURNCD=4;                     /*                       @OZ05124*/ 05122000
         MVC   RETURNCD(2),@CH00104                                1452 05123000
*   IF INCNT1=>100                  /*                       @ZA17158*/ 05124000
*     THEN                          /*                       @ZA17158*/ 05125000
         LH    @15,INCNT1                                          1453 05126000
         C     @15,@CF01050                                        1453 05127000
         BL    @RF01453                                            1453 05128000
*     DO;                           /*                       @ZA17158*/ 05129000
*       DCBPTR=ADDR(INDCB);         /*                       @ZA17158*/ 05130000
         LA    DCBPTR,INDCB                                        1455 05131000
*       DCBERACC=OFF;               /*                       @ZA17158*/ 05132000
*       DCBERSKP=OFF;               /*                       @ZA17158*/ 05133000
*       DCBERABE=ON;                /*                       @ZA17158*/ 05134000
         OI    DCBERABE+72(DCBPTR),B'00100000'                     1458 05135000
         NI    DCBERACC+72(DCBPTR),B'00111111'                     1458 05136000
*     END;                          /*                       @ZA17158*/ 05137000
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/ 05138000
@RF01453 DS    0H                                                  1460 05139000
         BR    R14                                                      05140000
*                                                                  1461 05141000
*/********************************************************** @OZ05124*/ 05142000
*/* SYNAD EXIT FOR TRACEOUT, TAKEN FOR WRITE ERRORS.         @OZ05124*/ 05143000
*/********************************************************** @OZ05124*/ 05144000
*                                                                  1461 05145000
*WRITEERR:                                                         1461 05146000
*   ;                               /*                       @OZ05124*/ 05147000
WRITEERR DS    0H                                                  1462 05148000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/ 05149000
         SYNADAF ACSMETH=QSAM                                           05150000
*   PRNTLINE=' ';                   /*                       @ZA17158*/ 05151000
         MVI   PRNTLINE+1,C' '                                     1463 05152000
         MVC   PRNTLINE+2(119),PRNTLINE+1                          1463 05153000
         MVI   PRNTLINE,C' '                                       1463 05154000
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/ 05155000
         MVC   PRNTLINE+30(79),49(R1)                                   05156000
*   PRNTLINE(1:30)=ICGTR905;        /*                       @OZ05124*/ 05157000
         MVC   PRNTLINE(30),ICGTR905                               1465 05158000
*   SAVE14=R14;                     /*                       @OZ09522*/ 05159000
         LR    SAVE14,R14                                          1466 05160000
*   RFY                                                            1467 05161000
*    (R0,                                                          1467 05162000
*     R1,                                                          1467 05163000
*     R14,                                                         1467 05164000
*     R15) RSTD;                    /*                       @OZ05124*/ 05165000
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/ 05166000
         PUT PRNTDCB,PRNTLINE                                           05167000
*   RFY                                                            1469 05168000
*    (R0,                                                          1469 05169000
*     R1,                                                          1469 05170000
*     R14,                                                         1469 05171000
*     R15) UNRSTD;                  /*                       @OZ05124*/ 05172000
*   R14=SAVE14;                     /*                       @OZ09522*/ 05173000
         LR    R14,SAVE14                                          1470 05174000
*   GEN(SYNADRLS);                  /*                       @OZ05124*/ 05175000
         SYNADRLS                                                       05176000
*   RETURNCD=4;                     /*                       @OZ05124*/ 05177000
         MVC   RETURNCD(2),@CH00104                                1472 05178000
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/ 05179000
         BR    R14                                                      05180000
*                                                                  1474 05181000
*/********************************************************** @ZA13498*/ 05182000
*/*                                                          @ZA13498*/ 05183000
*/* PROCEDURE NAME - TIME2345                                @ZA13498*/ 05184000
*/*                                                          @ZA13498*/ 05185000
*/* FUNCTION - T2TIME, T3TIME, T4,TIME, OR T5TIME IS         @ZA13498*/ 05186000
*/*            PASSED AS 'HOLDTXTM'.  COMPARE HOLDTXTM TO    @ZA13498*/ 05187000
*/*            TO THE MIDDLE TWO BYTE OF T1TIME TO           @ZA13498*/ 05188000
*/*            DETERMINE WHETHER THE HOLDTXTM SHOULD BE      @ZA13498*/ 05189000
*/*            INCREMENTED BY 65,536 (10000 HEX).  EXTRACT   @ZA13498*/ 05190000
*/*            THE HIGH-ORDER BYTE OF T1TIME AND USE IT FOR  @ZA13498*/ 05191000
*/*            THE HIGH-ORDER BYTE OF HOLDTXTM.  CONVERT     @ZA13498*/ 05192000
*/*            HOLDTXTM FROM QUARTER-SECONDS TO SECONDS.     @ZA13498*/ 05193000
*/*            EXTRACT TIME PORTION OF DATE RELATIVE TO THE  @ZA13498*/ 05194000
*/*            TO THE JULIAN DATE IN THE TRACE HEADER.       @ZA13498*/ 05195000
*/*            CONVERT BINARY TIME TO HOURS/MINUTES/SECONDS. @ZA13498*/ 05196000
*/*                                                          @ZA13498*/ 05197000
*/********************************************************** @ZA13498*/ 05198000
*                                                                  1474 05199000
*TIME2345:                                                         1474 05200000
*   PROCEDURE;                      /*                       @ZA13498*/ 05201000
         B     @PB00023                                            1474 05202000
TIME2345 STM   @14,@12,@SA00023                                    1474 05203000
*   HOLDT1TM=T1TIME;                /*                       @ZA13498*/ 05204000
         L     @01,PTR2                                            1475 05205000
         L     HOLDT1TM,T1TIME(,@01)                               1475 05206000
*   SLL(HOLDT1TM,8);                /*                       @ZA13498*/ 05207000
         SLL   HOLDT1TM,8                                          1476 05208000
*   SRL(HOLDT1TM,16);               /*                       @ZA13498*/ 05209000
         SRL   HOLDT1TM,16                                         1477 05210000
*   IF HOLDT1TM>HOLDTXTM            /*                       @ZA13498*/ 05211000
*     THEN                          /*                       @ZA13498*/ 05212000
         CR    HOLDT1TM,HOLDTXTM                                   1478 05213000
         BNH   @RF01478                                            1478 05214000
*     HOLDTXTM=HOLDTXTM+ROLLOVER;   /*                       @ZA13498*/ 05215000
         AL    HOLDTXTM,ROLLOVER                                   1479 05216000
*   HOLDT1TM=T1TIME;                /*                       @ZA13498*/ 05217000
@RF01478 L     @01,PTR2                                            1480 05218000
         L     HOLDT1TM,T1TIME(,@01)                               1480 05219000
*   SRL(HOLDT1TM,24);               /*                       @ZA13498*/ 05220000
         SRL   HOLDT1TM,24                                         1481 05221000
*   SLL(HOLDT1TM,16);               /*                       @ZA13498*/ 05222000
         SLL   HOLDT1TM,16                                         1482 05223000
*   HOLDTXTM=HOLDTXTM+HOLDT1TM;     /*                       @ZA13498*/ 05224000
         ALR   HOLDTXTM,HOLDT1TM                                   1483 05225000
*   HOLDTXTM=HOLDTXTM/4;            /*                       @ZA13498*/ 05226000
         LR    @00,HOLDTXTM                                        1484 05227000
         SRDA  @00,32                                              1484 05228000
         D     @00,@CF00104                                        1484 05229000
         LR    HOLDTXTM,@01                                        1484 05230000
*   IF HOLDTXTM>HDRTME              /*                       @ZA13498*/ 05231000
*     THEN                          /*                       @ZA13498*/ 05232000
         L     @02,HDRTME                                          1485 05233000
         CR    HOLDTXTM,@02                                        1485 05234000
         BNH   @RF01485                                            1485 05235000
*     DO;                           /*                       @ZA13498*/ 05236000
*       SAVETIME=HOSTTME+(HOLDTXTM-HDRTME);/*                @ZA13498*/ 05237000
         L     @15,HDRTME                                          1487 05238000
         LCR   @15,@15                                             1487 05239000
         ALR   @15,HOLDTXTM                                        1487 05240000
         AL    @15,HOSTTME                                         1487 05241000
         LR    SAVETIME,@15                                        1487 05242000
*       DO WHILE(SAVETIME>86399);   /*                       @ZA13498*/ 05243000
         B     @DE01488                                            1488 05244000
@DL01488 DS    0H                                                  1489 05245000
*         SAVETIME=SAVETIME-86400;  /*                       @ZA13498*/ 05246000
         SL    SAVETIME,@CF01088                                   1489 05247000
*       END;                        /*                       @ZA13498*/ 05248000
@DE01488 C     SAVETIME,@CF01096                                   1490 05249000
         BH    @DL01488                                            1490 05250000
*     END;                          /*                       @ZA13498*/ 05251000
*   ELSE                            /*                       @ZA13498*/ 05252000
*     DO;                           /*                       @ZA13498*/ 05253000
         B     @RC01485                                            1492 05254000
@RF01485 DS    0H                                                  1493 05255000
*       SAVETIME=HOSTTME-(HDRTME-HOLDTXTM);/*                @ZA28189*/ 05256000
         LR    SAVETIME,HOLDTXTM                                   1493 05257000
         SL    SAVETIME,HDRTME                                     1493 05258000
         AL    SAVETIME,HOSTTME                                    1493 05259000
*       DO WHILE(SAVETIME<0);       /*                       @ZA13498*/ 05260000
         B     @DE01494                                            1494 05261000
@DL01494 DS    0H                                                  1495 05262000
*         SAVETIME=SAVETIME+86400;  /*                       @ZA13498*/ 05263000
         AL    SAVETIME,@CF01088                                   1495 05264000
*       END;                        /*                       @ZA13498*/ 05265000
@DE01494 LTR   SAVETIME,SAVETIME                                   1496 05266000
         BM    @DL01494                                            1496 05267000
*     END;                          /*                       @ZA13498*/ 05268000
*   DAYS=SAVETIME;                  /*                       @ZA13498*/ 05269000
@RC01485 ST    SAVETIME,DAYS                                       1498 05270000
*   CALL CONVERTM;                  /*                       @ZA13498*/ 05271000
         BAL   @14,CONVERTM                                        1499 05272000
*   END TIME2345;                   /*                       @ZA13498*/ 05273000
@EL00023 DS    0H                                                  1500 05274000
@EF00023 DS    0H                                                  1500 05275000
@ER00023 LM    @14,@12,@SA00023                                    1500 05276000
         BR    @14                                                 1500 05277000
*   END ICGTRINT                    /*                       @ZA13498*/ 05278000
*                                                                  1501 05279000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05280000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 05281000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 05282000
*                                                                  1501 05283000
*       ;                                                          1501 05284000
@EL00001 L     @13,4(,@13)                                         1501 05285000
@EF00001 L     @00,@SIZDATD                                        1501 05286000
         LR    @01,@08                                             1501 05287000
         FREEMAIN R,LV=(0),A=(1)                                        05288000
@ER00001 LM    @14,@12,12(@13)                                     1501 05289000
         BR    @14                                                 1501 05290000
@DATA    DS    0H                                                       05291000
@CH00339 DC    H'60'                                                    05292000
@CH01112 DC    H'3600'                                                  05293000
@SC01278 CLC   HOLDVOL(0),VOLID                                         05294000
@SM01280 MVC   SELECTID(0),HOLDVOL                                      05295000
@SM01283 MVC   PARMHOLD(0),PARMS(PARMPTR)                               05296000
         DS    0F                                                       05297000
@AL00224 EQU   *                       LIST WITH   2 ARGUMENT(S)        05298000
@AL00228 EQU   *                       LIST WITH   2 ARGUMENT(S)        05299000
@AL00579 EQU   *                       LIST WITH   2 ARGUMENT(S)        05300000
@AL00582 EQU   *                       LIST WITH   2 ARGUMENT(S)        05301000
@AL00650 EQU   *                       LIST WITH   2 ARGUMENT(S)        05302000
@AL00655 EQU   *                       LIST WITH   2 ARGUMENT(S)        05303000
@AL00732 EQU   *                       LIST WITH   2 ARGUMENT(S)        05304000
@AL01069 EQU   *                       LIST WITH   2 ARGUMENT(S)        05305000
@AL01124 DC    A(@CF00045)             LIST WITH   2 ARGUMENT(S)        05306000
         DC    A(@CC01083)                                              05307000
@AL00226 EQU   *                       LIST WITH   2 ARGUMENT(S)        05308000
@AL00230 EQU   *                       LIST WITH   2 ARGUMENT(S)        05309000
@AL00234 EQU   *                       LIST WITH   2 ARGUMENT(S)        05310000
@AL00236 EQU   *                       LIST WITH   2 ARGUMENT(S)        05311000
@AL00240 EQU   *                       LIST WITH   2 ARGUMENT(S)        05312000
@AL00242 EQU   *                       LIST WITH   2 ARGUMENT(S)        05313000
@AL00267 EQU   *                       LIST WITH   2 ARGUMENT(S)        05314000
@AL00269 EQU   *                       LIST WITH   2 ARGUMENT(S)        05315000
@AL00273 EQU   *                       LIST WITH   2 ARGUMENT(S)        05316000
@AL00275 EQU   *                       LIST WITH   2 ARGUMENT(S)        05317000
@AL00277 EQU   *                       LIST WITH   2 ARGUMENT(S)        05318000
@AL00284 EQU   *                       LIST WITH   2 ARGUMENT(S)        05319000
@AL00286 EQU   *                       LIST WITH   2 ARGUMENT(S)        05320000
@AL00288 EQU   *                       LIST WITH   2 ARGUMENT(S)        05321000
@AL01035 EQU   *                       LIST WITH   2 ARGUMENT(S)        05322000
@AL01038 EQU   *                       LIST WITH   2 ARGUMENT(S)        05323000
@AL01045 EQU   *                       LIST WITH   2 ARGUMENT(S)        05324000
@AL01048 EQU   *                       LIST WITH   2 ARGUMENT(S)        05325000
@AL01126 EQU   *                       LIST WITH   2 ARGUMENT(S)        05326000
@AL01132 EQU   *                       LIST WITH   2 ARGUMENT(S)        05327000
@AL01134 EQU   *                       LIST WITH   2 ARGUMENT(S)        05328000
@AL01150 EQU   *                       LIST WITH   2 ARGUMENT(S)        05329000
@AL01152 EQU   *                       LIST WITH   2 ARGUMENT(S)        05330000
@AL01187 EQU   *                       LIST WITH   2 ARGUMENT(S)        05331000
@AL01190 EQU   *                       LIST WITH   2 ARGUMENT(S)        05332000
@AL01197 EQU   *                       LIST WITH   2 ARGUMENT(S)        05333000
@AL01200 DC    A(@CF00052)             LIST WITH   2 ARGUMENT(S)        05334000
         DC    A(@CC01083)                                              05335000
@AL00244 EQU   *                       LIST WITH   2 ARGUMENT(S)        05336000
@AL00246 EQU   *                       LIST WITH   2 ARGUMENT(S)        05337000
@AL00265 EQU   *                       LIST WITH   2 ARGUMENT(S)        05338000
@AL00280 EQU   *                       LIST WITH   2 ARGUMENT(S)        05339000
@AL00558 EQU   *                       LIST WITH   2 ARGUMENT(S)        05340000
@AL00560 EQU   *                       LIST WITH   2 ARGUMENT(S)        05341000
@AL01174 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        05342000
         DC    A(@CC01085)                                              05343000
@AL01032 EQU   *                       LIST WITH   2 ARGUMENT(S)        05344000
@AL01042 EQU   *                       LIST WITH   2 ARGUMENT(S)        05345000
@AL01130 EQU   *                       LIST WITH   2 ARGUMENT(S)        05346000
@AL01148 EQU   *                       LIST WITH   2 ARGUMENT(S)        05347000
@AL01184 EQU   *                       LIST WITH   2 ARGUMENT(S)        05348000
@AL01194 EQU   *                       LIST WITH   2 ARGUMENT(S)        05349000
@AL01339 DC    A(@CF00052)             LIST WITH   2 ARGUMENT(S)        05350000
         DC    A(@CC01085)                                              05351000
@AL01085 EQU   *                       LIST WITH   2 ARGUMENT(S)        05352000
@AL01087 EQU   *                       LIST WITH   2 ARGUMENT(S)        05353000
@AL01212 EQU   *                       LIST WITH   2 ARGUMENT(S)        05354000
@AL01257 EQU   *                       LIST WITH   2 ARGUMENT(S)        05355000
@AL01259 DC    A(@CF00045)             LIST WITH   2 ARGUMENT(S)        05356000
         DC    A(@CC01085)                                              05357000
@AL01179 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        05358000
         DC    A(@CC01083)                                              05359000
@DATD    DSECT                                                          05360000
         DS    0F                                                       05361000
@SA00001 DS    18F                                                      05362000
@SA00003 DS    15F                                                      05363000
@SA00004 DS    15F                                                      05364000
@SA00006 DS    15F                                                      05365000
@SA00013 DS    14F                                                      05366000
@SA00007 DS    14F                                                      05367000
@SA00009 DS    15F                                                      05368000
@SA00017 DS    14F                                                      05369000
@SA00019 DS    15F                                                      05370000
@PC00019 DS    3F                                                       05371000
@SA00008 DS    13F                                                      05372000
@SA00020 DS    15F                                                      05373000
@PC00020 DS    2F                                                       05374000
@SA00010 DS    15F                                                      05375000
@SA00012 DS    14F                                                      05376000
@SA00018 DS    15F                                                      05377000
@PC00018 DS    1F                                                       05378000
@SA00023 DS    15F                                                      05379000
@SA00014 DS    14F                                                      05380000
@AL00001 DS    3A                                                       05381000
@TF00001 DS    F                                                        05382000
@AFTEMPS DS    6F                                                       05383000
ICGTRINT CSECT                                                          05384000
         DS    0F                                                       05385000
@CF00045 DC    F'1'                                                     05386000
@CF00052 DC    F'2'                                                     05387000
@CF00117 DC    F'3'                                                     05388000
@CF00104 DC    F'4'                                                     05389000
@CH00104 EQU   @CF00104+2                                               05390000
@CF00376 DC    F'5'                                                     05391000
@CF00344 DC    F'6'                                                     05392000
@CF00036 DC    F'8'                                                     05393000
@CH00036 EQU   @CF00036+2                                               05394000
@CF00035 DC    F'9'                                                     05395000
@CF00033 DC    F'11'                                                    05396000
@CF01111 DC    F'23'                                                    05397000
@CF00869 DC    F'28'                                                    05398000
@CF00447 DC    F'30'                                                    05399000
@CF00484 DC    F'51'                                                    05400000
@CF00040 DC    F'52'                                                    05401000
@CF01089 DC    F'55'                                                    05402000
@CF01113 DC    F'59'                                                    05403000
@CF01050 DC    F'100'                                                   05404000
@CF00528 DC    F'121'                                                   05405000
@CF01095 DC    F'365'                                                   05406000
@CH01095 EQU   @CF01095+2                                               05407000
@CF01110 DC    F'366'                                                   05408000
@CH01110 EQU   @CF01110+2                                               05409000
@CF01035 DC    F'750'                                                   05410000
@CF01096 DC    F'86399'                                                 05411000
@CF01088 DC    F'86400'                                                 05412000
@CF01285 DC    XL4'0000FFFF'                                            05413000
@CF00831 DC    BL4'00000011'                                            05414000
@DATD    DSECT                                                          05415000
         DS    0D                                                       05416000
PTR2     DS    A                                                        05417000
OPENCLOS DS    FL4                                                      05418000
         ORG   OPENCLOS                                                 05419000
OPCLB1   DS    BL1                                                      05420000
OPCLB234 DS    CL3                                                      05421000
         ORG   OPENCLOS+4                                               05422000
RCDCOUNT DS    F                                                        05423000
OUTCOUNT DS    F                                                        05424000
HOLDT2TM DS    F                                                        05425000
HOLDT3TM DS    F                                                        05426000
DAYS     DS    F                                                        05427000
RCDTME   DS    F                                                        05428000
LENVOLID DS    H                                                        05429000
RETURNCD DS    H                                                        05430000
INCNT1   DS    H                                                        05431000
J        DS    H                                                        05432000
K        DS    H                                                        05433000
M        DS    H                                                        05434000
N        DS    H                                                        05435000
HOUR     DS    H                                                        05436000
MINUTE   DS    H                                                        05437000
SECOND   DS    H                                                        05438000
PAGECNT  DS    H                                                        05439000
CONVERT  DS    H                                                        05440000
WORK1    DS    FL1                                                      05441000
         DS    0D                                                       05442000
@TS00001 DS    CL8                                                      05443000
RECIN    DS    CL264                                                    05444000
RCDOUT   DS    CL72                                                     05445000
         ORG   RCDOUT                                                   05446000
STGD     DS    FL4                                                      05447000
CFAULT   DS    FL4                                                      05448000
SYSSGTM  DS    FL4                                                      05449000
DEVSGTM  DS    FL4                                                      05450000
DSTGD    DS    FL4                                                      05451000
SALLOC   DS    FL4                                                      05452000
SYSDSTM  DS    FL4                                                      05453000
DEVDSTM  DS    FL4                                                      05454000
BUSYTIME DS    FL4                                                      05455000
LOADTIME DS    FL4                                                      05456000
LOADNUM  DS    FL1                                                      05457000
CKTIME   DS    CL7                                                      05458000
         ORG   CKTIME                                                   05459000
SVEYEAR  DS    FL1                                                      05460000
SVEJUL   DS    FL2                                                      05461000
SVETME   DS    FL4                                                      05462000
         ORG   RCDOUT+48                                                05463000
PAGES    DS    FL1                                                      05464000
MININUM  DS    FL1                                                      05465000
HITNUM   DS    FL1                                                      05466000
STGDNUM  DS    FL1                                                      05467000
DSTGDNUM DS    FL1                                                      05468000
VTOCSTG  DS    FL1                                                      05469000
VTOCDSTG DS    FL1                                                      05470000
LIBRARY  DS    BL1                                                      05471000
DSPORT   DS    BL1                                                      05472000
DSCU     DS    BL1                                                      05473000
RCOZ     DS    BL1                                                      05474000
RCOY     DS    BL1                                                      05475000
RCOX     DS    BL1                                                      05476000
CARTPAIR DS    BL1                                                      05477000
READWRIT DS    FL1                                                      05478000
RCOVOLID DS    CL6                                                      05479000
CHARDRC  DS    CL1                                                      05480000
SDGINBIN DS    CL1                                                      05481000
@NM00044 DS    CL1                                                      05482000
         ORG   RCDOUT+72                                                05483000
BLKLINE  DS    CL121                                                    05484000
         ORG   BLKLINE                                                  05485000
@NM00045 DS    CL11                                                     05486000
BLKFLAG  DS    CL8                                                      05487000
@NM00046 DS    CL3                                                      05488000
BLKMINPT DS    CL2                                                      05489000
@NM00047 DS    CL2                                                      05490000
BLKLIBID DS    CL2                                                      05491000
@NM00048 DS    CL4                                                      05492000
BLKRSPPT DS    CL2                                                      05493000
@NM00049 DS    CL2                                                      05494000
SA1SSID  DS    CL3                                                      05495000
         ORG   SA1SSID                                                  05496000
CHAR8SA1 DS    CL1                                                      05497000
SA1ID    DS    CL1                                                      05498000
CHAR0SA1 DS    CL1                                                      05499000
         ORG   BLKLINE+39                                               05500000
@NM00050 DS    CL2                                                      05501000
SA2SSID  DS    CL3                                                      05502000
         ORG   SA2SSID                                                  05503000
CHAR8SA2 DS    CL1                                                      05504000
SA2ID    DS    CL1                                                      05505000
CHAR0SA2 DS    CL1                                                      05506000
         ORG   BLKLINE+44                                               05507000
@NM00051 DS    CL3                                                      05508000
BLKVV1   DS    CL2                                                      05509000
@NM00052 DS    CL2                                                      05510000
BLKVV2   DS    CL2                                                      05511000
@NM00053 DS    CL2                                                      05512000
BLKQCB   DS    CL12                                                     05513000
@NM00054 DS    CL2                                                      05514000
DRCSSID  DS    CL3                                                      05515000
         ORG   DRCSSID                                                  05516000
CHAR4    DS    CL1                                                      05517000
MSFDRC   DS    CL1                                                      05518000
PRINTDRC DS    CL1                                                      05519000
         ORG   BLKLINE+72                                               05520000
@NM00055 DS    CL2                                                      05521000
DRDSSID  DS    CL3                                                      05522000
         ORG   DRDSSID                                                  05523000
CHAR2    DS    CL1                                                      05524000
MSFDRD   DS    CL1                                                      05525000
PRINTDRD DS    CL1                                                      05526000
         ORG   BLKLINE+77                                               05527000
@NM00056 DS    CL3                                                      05528000
BLKQCBPT DS    CL2                                                      05529000
@NM00057 DS    CL2                                                      05530000
BLKVOLID DS    CL6                                                      05531000
@NM00058 DS    CL2                                                      05532000
BLKL     DS    CL1                                                      05533000
@NM00059 DS    CL1                                                      05534000
BLKX     DS    CL3                                                      05535000
@NM00060 DS    CL1                                                      05536000
BLKY     DS    CL2                                                      05537000
@NM00061 DS    CL1                                                      05538000
BLKZ     DS    CL1                                                      05539000
@NM00062 DS    CL2                                                      05540000
BLKT2TIM DS    CL8                                                      05541000
         ORG   BLKT2TIM                                                 05542000
T2HOUR   DS    CL2                                                      05543000
T2SEP1   DS    CL1                                                      05544000
T2MINUTE DS    CL2                                                      05545000
T2SEP2   DS    CL1                                                      05546000
T2SECOND DS    CL2                                                      05547000
         ORG   BLKLINE+112                                              05548000
@NM00063 DS    CL1                                                      05549000
BLKT3TIM DS    CL8                                                      05550000
         ORG   BLKT3TIM                                                 05551000
T3HOUR   DS    CL2                                                      05552000
T3SEP1   DS    CL1                                                      05553000
T3MINUTE DS    CL2                                                      05554000
T3SEP2   DS    CL1                                                      05555000
T3SECOND DS    CL2                                                      05556000
         ORG   BLKLINE+121                                              05557000
PRNTLINE DS    CL121                                                    05558000
HOLDHDG4 DS    CL121                                                    05559000
         ORG   HOLDHDG4                                                 05560000
@NM00117 DS    CL2                                                      05561000
HOLDDEST DS    CL6                                                      05562000
@NM00118 DS    CL113                                                    05563000
         ORG   HOLDHDG4+121                                             05564000
DRCPRINT DS    CL1                                                      05565000
DRDPRINT DS    CL1                                                      05566000
SAWORK   DS    BL1                                                      05567000
SDGSELSW DS    BL1                                                      05568000
VOLSELSW DS    BL1                                                      05569000
STDESTSW DS    BL1                                                      05570000
HOLDSDG  DS    BL1                                                      05571000
HOLDVOL  DS    CL6                                                      05572000
SDGSAVE  DS    CL6                                                      05573000
STATMASK DS    BL1                                                      05574000
         DS    CL1                                                      05575000
STARTTIM DS    CL16                                                     05576000
         ORG   STARTTIM                                                 05577000
@NM00141 DS    CL1                                                      05578000
CKSTIME  DS    CL7                                                      05579000
         ORG   CKSTIME                                                  05580000
HLDSYR   DS    FL1                                                      05581000
HLDSDAY  DS    FL2                                                      05582000
HLDSTIME DS    FL4                                                      05583000
         ORG   STARTTIM+8                                               05584000
@NM00142 DS    CL1                                                      05585000
CKETIME  DS    CL7                                                      05586000
         ORG   CKETIME                                                  05587000
HLDEYR   DS    FL1                                                      05588000
HLDEDAY  DS    FL2                                                      05589000
HLDETIME DS    FL4                                                      05590000
         ORG   STARTTIM+16                                              05591000
FRSTSW   DS    BL1                                                      05592000
FOUNDSW  DS    BL1                                                      05593000
MINI1SW  DS    BL1                                                      05594000
PARMERR  DS    BL1                                                      05595000
DATEINSW DS    BL1                                                      05596000
DECODCYL DS    BL1                                                      05597000
         DS    CL2                                                      05598000
DOUBLEWD DS    CL8                                                      05599000
DATETABL DS    CL12                                                     05600000
         ORG   DATETABL                                                 05601000
HOSTYEAR DS    FL2                                                      05602000
HOSTJUL  DS    FL2                                                      05603000
HOSTTME  DS    FL4                                                      05604000
HDRTME   DS    FL4                                                      05605000
         ORG   DATETABL+12                                              05606000
PARMSW   DS    CL1                                                      05607000
BITOUT   DS    CL8                                                      05608000
HEXOUT   DS    CL16                                                     05609000
FIXOUT   DS    CL13                                                     05610000
TODAY    DS    CL5                                                      05611000
DATEWORK DS    CL4                                                      05612000
PARMHOLD DS    CL29                                                     05613000
PRNTDCB  DS    CL100                                                    05614000
INDCB    DS    CL100                                                    05615000
OUTDCB   DS    CL100                                                    05616000
SAVESDG  DS    BL1                                                      05617000
IMLSAVE  DS    CL2                                                      05618000
IMLFLAG  DS    CL1                                                      05619000
MSFCONFG DS    4AL1                                                     05620000
DATETABA DS    CL16                                                     05621000
         ORG   DATETABA+0                                               05622000
STOREYR  DS    FL2                                                      05623000
STOREJUL DS    FL2                                                      05624000
STORETIM DS    FL4                                                      05625000
STOREDSM DS    FL4                                                      05626000
DATECNT  DS    FL4                                                      05627000
         ORG   DATETABA+12000                                           05628000
ICGTRINT CSECT                                                          05629000
         DS    0F                                                       05630000
@SIZDATD DC    AL1(0)                                                   05631000
         DC    AL3(@ENDDATD-@DATD)                                      05632000
         DS    0D                                                       05633000
ROLLOVER DC    XL4'00010000'                                            05634000
MASK     DC    XL4'0000000F'                                            05635000
NINE     DC    H'9'                                                     05636000
@CC01145 DC    C'DATA RECORDING CONTROLLERS'                            05637000
@CC01136 DC    C'DATA RECORDING DEVICES'                                05638000
@CC01149 DC    C'STAGING DRIVE GROUP XX'                                05639000
@CC01154 DC    C'STAGING DRIVE GROUPS'                                  05640000
@CC01158 DC    C'ACCESSOR CONTROLS'                                     05641000
@CC01141 DC    C'STAGING ADAPTERS'                                      05642000
@CC01201 DC    C'  :  :  '                                              05643000
@CC01086 DC    C'******'                                                05644000
@CC01087 DC    C'NONE  '                                                05645000
@CC01120 DC    C'      '                                                05646000
@CC01200 DC    C'  /   '                                                05647000
@CC01202 DC    C'DESTGE'                                                05648000
@CC01138 DC    C'200-V'                                                 05649000
@CC01143 DC    C'800-V'                                                 05650000
@CC01148 DC    C'400-V'                                                 05651000
@CC01153 DC    C'000-V'                                                 05652000
@CC01161 DC    C'101-V'                                                 05653000
@CC01162 DC    C'102-V'                                                 05654000
@CC01156 EQU   @CC01087                                                 05655000
@CC01119 DC    C'SDG'                                                   05656000
@CC01192 EQU   @CC01086                                                 05657000
@CC01083 EQU   @CC01087                                                 05658000
@CC01085 EQU   @CC01149                                                 05659000
HDNG1    DS    CL121                                                    05660000
         ORG   HDNG1                                                    05661000
@NM00102 DC    CL41'1ICGTRINT'                                          05662000
@NM00103 DC    CL60'MSS TRACE DATA INTERPRETATION'                      05663000
@NM00104 DC    CL20'DATE        PAGE    '                               05664000
         ORG   HDNG1+121                                                05665000
HDNG2    DS    CL121                                                    05666000
         ORG   HDNG2                                                    05667000
@NM00105 DC    CL1'0'                                                   05668000
@NM00106 DC    CL40'*BLOCK *    BLOCK   M/H  MSF  SDG  SA1  '           05669000
@NM00107 DC    CL40'SA2   VVA VVA               DRC  DRD  QC'           05670000
@NM00108 DC    CL40'B          COORDINATES      T2       T3 '           05671000
         ORG   HDNG2+121                                                05672000
HDNG3    DS    CL121                                                    05673000
         ORG   HDNG3                                                    05674000
@NM00109 DC    CL1' '                                                   05675000
@NM00110 DC    CL40'*HEADER*    FLAG    PTR  ID   PTR  SSID '           05676000
@NM00111 DC    CL40'SSID  1   2   QCB ENTRIES   SSID SSID PT'           05677000
@NM00112 DC    CL40'R  VOLID   L   X  Y Z      TIME     TIME'           05678000
         ORG   HDNG3+121                                                05679000
HDNG4    DS    CL121                                                    05680000
         ORG   HDNG4                                                    05681000
@NM00113 DC    CL1'0'                                                   05682000
@NM00114 DC    CL40'*STAGE *                      NXT  FUNC '           05683000
@NM00115 DC    CL40' CPU   P-LIST   NO.OF             UNCONV'           05684000
@NM00116 DC    CL40'ERTED     T1       T1       T4       T5 '           05685000
         ORG   HDNG4+121                                                05686000
HDNG5    DS    CL121                                                    05687000
         ORG   HDNG5                                                    05688000
@NM00119 DC    CL1' '                                                   05689000
@NM00120 DC    CL40'* MINI *  SEQUENCE    FLAG    M/H   ID  '           05690000
@NM00121 DC    CL40' ID     FLAG    PAGES  VUA  VVA     T1 T'           05691000
@NM00122 DC    CL40'IME      DATE     TIME     TIME     TIME'           05692000
         ORG   HDNG5+121                                                05693000
HDNG6    DS    CL121                                                    05694000
         ORG   HDNG6                                                    05695000
@NM00123 DC    CL1'0'                                                   05696000
@NM00124 DC    CL40'* PAGE *  DASD  VIRT  REAL              '           05697000
@NM00125 DC    CL80' '                                                  05698000
         ORG   HDNG6+121                                                05699000
HDNG7    DS    CL121                                                    05700000
         ORG   HDNG7                                                    05701000
@NM00126 DC    CL1' '                                                   05702000
@NM00127 DC    CL40'* LIST *  SSID  PAGE  PAGE  CYLINDERS   '           05703000
@NM00128 DC    CL80' '                                                  05704000
         ORG   HDNG7+121                                                05705000
HDLINE   DS    CL121                                                    05706000
         ORG   HDLINE                                                   05707000
@NM00129 DC    CL1'0'                                                   05708000
@NM00130 DC    CL40'*FILE HEADER*  HOST DATE - YYDDD        '           05709000
@NM00131 DC    CL40'HOST TIME - XXXXX             MSC TIME -'           05710000
@NM00132 DC    CL40' XXXXXXXX                               '           05711000
         ORG   HDLINE+121                                               05712000
TRLINE   DS    CL121                                                    05713000
         ORG   TRLINE                                                   05714000
@NM00133 DC    CL121'0*FILE TRAILER*'                                   05715000
         ORG   TRLINE+121                                               05716000
DTLHDR   DS    CL121                                                    05717000
         ORG   DTLHDR                                                   05718000
@NM00134 DC    CL1'-'                                                   05719000
@NM00135 DC    CL40'PARM OPTION X, DATES YYDDD-YYDDD, TIMES '           05720000
@NM00136 DC    CL40'HHMM-HHMM, INPUT RECORD COUNT XXXXXX, OU'           05721000
@NM00137 DC    CL40'TPUT RECORD COUNT XXXXXX, SELECT XXXXXX '           05722000
         ORG   DTLHDR+121                                               05723000
DATEHDR2 DS    CL121                                                    05724000
         ORG   DATEHDR2                                                 05725000
@NM00138 DC    CL1'0'                                                   05726000
@NM00139 DC    CL40'FILE DATES ENCOUNTERED    MSC TIME    JU'           05727000
@NM00140 DC    CL80'LIAN CONVERSION    COUNT'                           05728000
         ORG   DATEHDR2+121                                             05729000
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'                       05730000
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'                    05731000
TROUTMSG DC    CL32'1ICG902I OPEN ERROR FOR TRACEOUT'                   05732000
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '                     05733000
ICGTR905 DC    CL30' ICG905I I/O ERROR ON TRACEOUT'                     05734000
ICGTR906 DC    CL121' ICG906I IML COUNT MISMATCH'                       05735000
FLAGONE  DC    X'FF'                                                    05736000
FOXES    DC    X'FFFF'                                                  05737000
         DS    CL2                                                      05738000
FIXAREA  DS    CL200                                                    05739000
         ORG   FIXAREA                                                  05740000
@NM00143 DC    200CL1'Z'                                                05741000
         ORG   FIXAREA+200                                              05742000
EIGHT0   DC    CL8'00000000'                                            05743000
REGLOKUP DC    X'00'                                                    05744000
         DC    X'01'                                                    05745000
         DC    X'02'                                                    05746000
         DC    X'03'                                                    05747000
         DC    X'02'                                                    05748000
         DC    X'03'                                                    05749000
         DC    X'00'                                                    05750000
         DC    X'01'                                                    05751000
         DC    X'04'                                                    05752000
         DC    X'05'                                                    05753000
         DC    X'06'                                                    05754000
         DC    X'07'                                                    05755000
         DC    X'06'                                                    05756000
         DC    X'07'                                                    05757000
         DC    X'04'                                                    05758000
         DC    X'05'                                                    05759000
SPECLKUP DC    X'00'                                                    05760000
         DC    X'01'                                                    05761000
         DC    X'04'                                                    05762000
         DC    X'05'                                                    05763000
         DC    X'02'                                                    05764000
         DC    X'03'                                                    05765000
         DC    X'00'                                                    05766000
         DC    X'01'                                                    05767000
         DC    X'04'                                                    05768000
         DC    X'05'                                                    05769000
         DC    X'02'                                                    05770000
         DC    X'03'                                                    05771000
SALOOKUP DC    CL1'0'                                                   05772000
         DC    CL1'1'                                                   05773000
         DC    CL1'2'                                                   05774000
         DC    CL1'3'                                                   05775000
         DC    CL1'4'                                                   05776000
         DC    CL1'5'                                                   05777000
         DC    CL1'6'                                                   05778000
         DC    CL1'7'                                                   05779000
         DC    CL1'8'                                                   05780000
         DC    CL1'9'                                                   05781000
         DC    CL1'A'                                                   05782000
         DC    CL1'B'                                                   05783000
         DC    CL1'C'                                                   05784000
         DC    CL1'D'                                                   05785000
         DC    CL1'E'                                                   05786000
         DC    CL1'F'                                                   05787000
SDGLOKUP DC    CL2'00'                                                  05788000
         DC    CL2'01'                                                  05789000
         DC    CL2'02'                                                  05790000
         DC    CL2'03'                                                  05791000
         DC    CL2'04'                                                  05792000
         DC    CL2'05'                                                  05793000
         DC    CL2'06'                                                  05794000
         DC    CL2'07'                                                  05795000
         DC    CL2'08'                                                  05796000
         DC    CL2'09'                                                  05797000
         DC    CL2'10'                                                  05798000
         DC    CL2'11'                                                  05799000
         DC    CL2'12'                                                  05800000
         DC    CL2'13'                                                  05801000
         DC    CL2'14'                                                  05802000
         DC    CL2'15'                                                  05803000
         DC    CL2'16'                                                  05804000
         DC    CL2'17'                                                  05805000
         DC    CL2'18'                                                  05806000
         DC    CL2'19'                                                  05807000
         DC    CL2'20'                                                  05808000
         DC    CL2'21'                                                  05809000
         DC    CL2'22'                                                  05810000
         DC    CL2'23'                                                  05811000
         DC    CL2'24'                                                  05812000
         DC    CL2'25'                                                  05813000
         DC    CL2'26'                                                  05814000
         DC    CL2'27'                                                  05815000
ICGTRINT CSECT                                                          05816000
*                                                         /*@Y30LB40*/  05817000
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=264,   **05818000
               EODAD=EOJ,EROPT=SKP,SYNAD=READERR                        05819000
IDCBL    EQU   *-IPATDCB                                                05820000
OPATDCB  DCB   DSORG=PS,DDNAME=TRACEOUT,MACRF=PM,RECFM=FB,LRECL=72,   **05821000
               EROPT=ABE,SYNAD=WRITEERR                                 05822000
ODCBL    EQU   *-OPATDCB                                                05823000
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121    05824000
PDCBL    EQU   *-PPATDCB                                                05825000
@DATD    DSECT                                                          05826000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05827000
@ENDDATD EQU   *                                                        05828000
ICGTRINT CSECT                                                          05829000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05830000
@01      EQU   01                                                       05831000
@02      EQU   02                                                       05832000
@03      EQU   03                                                       05833000
@04      EQU   04                                                       05834000
@05      EQU   05                                                       05835000
@06      EQU   06                                                       05836000
@07      EQU   07                                                       05837000
@08      EQU   08                                                       05838000
@09      EQU   09                                                       05839000
@10      EQU   10                                                       05840000
@11      EQU   11                                                       05841000
@12      EQU   12                                                       05842000
@13      EQU   13                                                       05843000
@14      EQU   14                                                       05844000
@15      EQU   15                                                       05845000
HOLDTXTM EQU   @03                                                      05846000
SAVETIME EQU   @02                                                      05847000
LINECNT  EQU   @07                                                      05848000
P        EQU   @02                                                      05849000
I        EQU   @06                                                      05850000
LSTMINAD EQU   @06                                                      05851000
SS       EQU   @02                                                      05852000
HIT5TIME EQU   @07                                                      05853000
HOLDT5TM EQU   @03                                                      05854000
HOLDT4TM EQU   @05                                                      05855000
HOLDT1TM EQU   @02                                                      05856000
HOLDCYLS EQU   @04                                                      05857000
HOLDVTOC EQU   @06                                                      05858000
TIMEWORK EQU   @03                                                      05859000
PARMPTR  EQU   @03                                                      05860000
SAVE14   EQU   @06                                                      05861000
SDGINDEX EQU   @03                                                      05862000
INDEX    EQU   @02                                                      05863000
DRDINDEX EQU   @03                                                      05864000
DRCINDEX EQU   @02                                                      05865000
DCBPTR   EQU   @02                                                      05866000
R0       EQU   @00                                                      05867000
R1       EQU   @01                                                      05868000
R2       EQU   @02                                                      05869000
R3       EQU   @03                                                      05870000
R4       EQU   @04                                                      05871000
R5       EQU   @05                                                      05872000
R14      EQU   @14                                                      05873000
R15      EQU   @15                                                      05874000
IHADCB   EQU   0                                                        05875000
IHADCS05 EQU   0                                                        05876000
DCBMODE  EQU   IHADCS05                                                 05877000
DCBSTACK EQU   DCBMODE                                                  05878000
DCBFUNC  EQU   IHADCS05+3                                               05879000
IHADCS11 EQU   0                                                        05880000
DCBRELB  EQU   IHADCS11                                                 05881000
DCBREL   EQU   DCBRELB+1                                                05882000
DCBBUFCB EQU   IHADCS11+4                                               05883000
DCBDSORG EQU   IHADCS11+10                                              05884000
DCBDSRG1 EQU   DCBDSORG                                                 05885000
DCBDSRG2 EQU   DCBDSORG+1                                               05886000
DCBIOBAD EQU   IHADCS11+12                                              05887000
DCBODEB  EQU   DCBIOBAD                                                 05888000
DCBLNP   EQU   DCBODEB                                                  05889000
DCBQSLM  EQU   DCBLNP                                                   05890000
DCBIOBAA EQU   DCBODEB+1                                                05891000
IHADCS50 EQU   0                                                        05892000
DCBSVCXL EQU   IHADCS50                                                 05893000
DCBEODAD EQU   IHADCS50+4                                               05894000
DCBBFALN EQU   DCBEODAD                                                 05895000
DCBHIARC EQU   DCBBFALN                                                 05896000
DCBBFTEK EQU   DCBHIARC                                                 05897000
DCBBFT   EQU   DCBBFTEK                                                 05898000
DCBEXLST EQU   IHADCS50+8                                               05899000
DCBRECFM EQU   DCBEXLST                                                 05900000
DCBRECLA EQU   DCBRECFM                                                 05901000
IHADCS24 EQU   0                                                        05902000
DCBOFLGS EQU   IHADCS24+8                                               05903000
DCBOFLWR EQU   DCBOFLGS                                                 05904000
DCBIFLG  EQU   IHADCS24+9                                               05905000
DCBIBPCT EQU   DCBIFLG                                                  05906000
DCBMACR  EQU   IHADCS24+10                                              05907000
DCBMACR1 EQU   DCBMACR                                                  05908000
DCBMRFE  EQU   DCBMACR1                                                 05909000
DCBMRGET EQU   DCBMRFE                                                  05910000
DCBMRAPG EQU   DCBMACR1                                                 05911000
DCBMRRD  EQU   DCBMRAPG                                                 05912000
DCBMRCI  EQU   DCBMACR1                                                 05913000
DCBMRMVG EQU   DCBMRCI                                                  05914000
DCBMRLCG EQU   DCBMACR1                                                 05915000
DCBMRABC EQU   DCBMACR1                                                 05916000
DCBMRPT1 EQU   DCBMRABC                                                 05917000
DCBMRSBG EQU   DCBMRPT1                                                 05918000
DCBMRCRL EQU   DCBMACR1                                                 05919000
DCBMRCHK EQU   DCBMRCRL                                                 05920000
DCBMRRDX EQU   DCBMRCHK                                                 05921000
DCBMRDMG EQU   DCBMACR1                                                 05922000
DCBMACR2 EQU   DCBMACR+1                                                05923000
DCBMRPUT EQU   DCBMACR2                                                 05924000
DCBMRWRT EQU   DCBMACR2                                                 05925000
DCBMRMVP EQU   DCBMACR2                                                 05926000
DCBMR5WD EQU   DCBMACR2                                                 05927000
DCBMRLDM EQU   DCBMR5WD                                                 05928000
DCBMRLCP EQU   DCBMRLDM                                                 05929000
DCBMR4WD EQU   DCBMACR2                                                 05930000
DCBMRPT2 EQU   DCBMR4WD                                                 05931000
DCBMRTMD EQU   DCBMRPT2                                                 05932000
DCBMR3WD EQU   DCBMACR2                                                 05933000
DCBMRCTL EQU   DCBMR3WD                                                 05934000
DCBMRSTK EQU   DCBMRCTL                                                 05935000
DCBMR1WD EQU   DCBMACR2                                                 05936000
DCBMRSWA EQU   DCBMR1WD                                                 05937000
DCBMRDMD EQU   DCBMRSWA                                                 05938000
IHADCS25 EQU   0                                                        05939000
DCBMACRF EQU   IHADCS25+2                                               05940000
DCBMACF1 EQU   DCBMACRF                                                 05941000
DCBMFFE  EQU   DCBMACF1                                                 05942000
DCBMFGET EQU   DCBMFFE                                                  05943000
DCBMFAPG EQU   DCBMACF1                                                 05944000
DCBMFRD  EQU   DCBMFAPG                                                 05945000
DCBMFCI  EQU   DCBMACF1                                                 05946000
DCBMFMVG EQU   DCBMFCI                                                  05947000
DCBMFLCG EQU   DCBMACF1                                                 05948000
DCBMFABC EQU   DCBMACF1                                                 05949000
DCBMFPT1 EQU   DCBMFABC                                                 05950000
DCBMFSBG EQU   DCBMFPT1                                                 05951000
DCBMFCRL EQU   DCBMACF1                                                 05952000
DCBMFCHK EQU   DCBMFCRL                                                 05953000
DCBMFDMG EQU   DCBMACF1                                                 05954000
DCBMACF2 EQU   DCBMACRF+1                                               05955000
DCBMFPUT EQU   DCBMACF2                                                 05956000
DCBMFWRT EQU   DCBMACF2                                                 05957000
DCBMFMVP EQU   DCBMACF2                                                 05958000
DCBMF5WD EQU   DCBMACF2                                                 05959000
DCBMFLDM EQU   DCBMF5WD                                                 05960000
DCBMFLCP EQU   DCBMFLDM                                                 05961000
DCBMF4WD EQU   DCBMACF2                                                 05962000
DCBMFPT2 EQU   DCBMF4WD                                                 05963000
DCBMFTMD EQU   DCBMFPT2                                                 05964000
DCBMF3WD EQU   DCBMACF2                                                 05965000
DCBMFCTL EQU   DCBMF3WD                                                 05966000
DCBMFSTK EQU   DCBMFCTL                                                 05967000
DCBMF1WD EQU   DCBMACF2                                                 05968000
DCBMFSWA EQU   DCBMF1WD                                                 05969000
DCBMFDMD EQU   DCBMFSWA                                                 05970000
DCBDEBAD EQU   IHADCS25+4                                               05971000
DCBIFLGS EQU   DCBDEBAD                                                 05972000
DCBIFPCT EQU   DCBIFLGS                                                 05973000
IHADCS26 EQU   0                                                        05974000
DCBWRITE EQU   IHADCS26                                                 05975000
DCBREAD  EQU   DCBWRITE                                                 05976000
DCBWRITA EQU   DCBREAD+1                                                05977000
IHADCS27 EQU   0                                                        05978000
DCBGET   EQU   IHADCS27                                                 05979000
DCBPUT   EQU   DCBGET                                                   05980000
DCBGETA  EQU   DCBPUT+1                                                 05981000
IHADCS36 EQU   0                                                        05982000
DCBGERR  EQU   IHADCS36                                                 05983000
DCBPERR  EQU   DCBGERR                                                  05984000
DCBCHECK EQU   DCBPERR                                                  05985000
DCBOPTCD EQU   DCBCHECK                                                 05986000
DCBOPTH  EQU   DCBOPTCD                                                 05987000
DCBOPTO  EQU   DCBOPTH                                                  05988000
DCBOPTZ  EQU   DCBOPTCD                                                 05989000
DCBGERRA EQU   DCBCHECK+1                                               05990000
DCBPERRA EQU   DCBGERRA                                                 05991000
DCBSYNAD EQU   IHADCS36+4                                               05992000
DCBCIND1 EQU   IHADCS36+8                                               05993000
DCBCIND2 EQU   IHADCS36+9                                               05994000
DCBIOBA  EQU   IHADCS36+16                                              05995000
DCBCICB  EQU   DCBIOBA                                                  05996000
IHADCS52 EQU   0                                                        05997000
DCBDIRCT EQU   IHADCS52                                                 05998000
DCBQSWS  EQU   DCBDIRCT                                                 05999000
DCBUSASI EQU   DCBQSWS                                                  06000000
DCBQADFS EQU   DCBUSASI                                                 06001000
DCBBUFOF EQU   DCBDIRCT+1                                               06002000
IHADCS37 EQU   0                                                        06003000
DCBFLAG1 EQU   IHADCS37                                                 06004000
IHADCS38 EQU   0                                                        06005000
DCBEOBR  EQU   IHADCS38                                                 06006000
DCBPOINT EQU   IHADCS38+12                                              06007000
DCBCNTRL EQU   DCBPOINT                                                 06008000
IHADCS40 EQU   0                                                        06009000
DCBEOBAD EQU   IHADCS40                                                 06010000
DCBCCCW  EQU   IHADCS40+4                                               06011000
DCBRECAD EQU   DCBCCCW                                                  06012000
DCBRECBT EQU   DCBRECAD                                                 06013000
DCBRCREL EQU   DCBRECBT                                                 06014000
@NM00027 EQU   IHADCS40+12                                              06015000
DCBEROPT EQU   @NM00027                                                 06016000
DCBERACC EQU   DCBEROPT                                                 06017000
DCBERSKP EQU   DCBEROPT                                                 06018000
DCBERABE EQU   DCBEROPT                                                 06019000
MINIHDR  EQU   0                                                        06020000
SEQUENCE EQU   MINIHDR                                                  06021000
FLAG     EQU   MINIHDR+1                                                06022000
NXTMINAD EQU   MINIHDR+3                                                06023000
T1TIME   EQU   MINIHDR+4                                                06024000
T4TIME   EQU   MINIHDR+8                                                06025000
T5TIME   EQU   MINIHDR+10                                               06026000
FUNCID   EQU   MINIHDR+12                                               06027000
CPUID    EQU   MINIHDR+13                                               06028000
PLFLAG   EQU   MINIHDR+16                                               06029000
PLSTDEST EQU   PLFLAG                                                   06030000
PLNOTU   EQU   PLFLAG                                                   06031000
COUNT    EQU   MINIHDR+17                                               06032000
VUA      EQU   MINIHDR+18                                               06033000
VVA      EQU   MINIHDR+19                                               06034000
PAGELIST EQU   MINIHDR+20                                               06035000
RUA      EQU   PAGELIST                                                 06036000
DEVICE   EQU   RUA                                                      06037000
VIRTPAGE EQU   PAGELIST+1                                               06038000
REALPAGE EQU   PAGELIST+2                                               06039000
CYLIND   EQU   PAGELIST+3                                               06040000
PARMVALS EQU   0                                                        06041000
PARMLEN  EQU   PARMVALS                                                 06042000
PARMS    EQU   PARMVALS+2                                               06043000
BITADDR  EQU   0                                                        06044000
FIXADDR  EQU   0                                                        06045000
FIXLEN   EQU   0                                                        06046000
FIXOPT   EQU   0                                                        06047000
HEXADDR  EQU   0                                                        06048000
HEXLEN   EQU   0                                                        06049000
BLOCKHDR EQU   RECIN                                                    06050000
CCHHRR   EQU   BLOCKHDR                                                 06051000
TID      EQU   CCHHRR                                                   06052000
CYL      EQU   CCHHRR+1                                                 06053000
HEAD     EQU   CCHHRR+2                                                 06054000
RECORD   EQU   CCHHRR+3                                                 06055000
IMLCNT   EQU   CCHHRR+4                                                 06056000
BLOCKFLG EQU   BLOCKHDR+8                                               06057000
DS2VALID EQU   BLOCKFLG                                                 06058000
DS2IOS   EQU   BLOCKFLG                                                 06059000
MINIPTR  EQU   BLOCKHDR+9                                               06060000
LIBRID   EQU   BLOCKHDR+10                                              06061000
RSPINDGP EQU   BLOCKHDR+11                                              06062000
DS1ADDR  EQU   BLOCKHDR+12                                              06063000
DS1PORT  EQU   DS1ADDR                                                  06064000
DS1CU    EQU   DS1ADDR                                                  06065000
DS2ADDR  EQU   BLOCKHDR+13                                              06066000
DS2PORT  EQU   DS2ADDR                                                  06067000
DS2CU    EQU   DS2ADDR                                                  06068000
VVADDR1  EQU   BLOCKHDR+14                                              06069000
VVADDR2  EQU   BLOCKHDR+15                                              06070000
QCBENTS  EQU   BLOCKHDR+16                                              06071000
@NM00033 EQU   QCBENTS+2                                                06072000
PAIRNUM  EQU   @NM00033                                                 06073000
RWADDR   EQU   BLOCKHDR+22                                              06074000
CONTRLR  EQU   RWADDR                                                   06075000
RWU      EQU   RWADDR                                                   06076000
QCBADDR  EQU   BLOCKHDR+23                                              06077000
VOLID    EQU   BLOCKHDR+24                                              06078000
LZYX     EQU   BLOCKHDR+30                                              06079000
L        EQU   LZYX                                                     06080000
Z        EQU   LZYX                                                     06081000
Y        EQU   LZYX                                                     06082000
X        EQU   LZYX+1                                                   06083000
T2TIME   EQU   BLOCKHDR+32                                              06084000
T3TIME   EQU   BLOCKHDR+34                                              06085000
FIRSTMIN EQU   BLOCKHDR+40                                              06086000
BLKHDROV EQU   RECIN                                                    06087000
BLKOFLG  EQU   BLKHDROV+8                                               06088000
HOSTDATE EQU   BLKHDROV+12                                              06089000
HOSTTIME EQU   BLKHDROV+16                                              06090000
DSMTIME  EQU   BLKHDROV+20                                              06091000
VRW      EQU   BLKHDROV+24                                              06092000
VDS      EQU   BLKHDROV+28                                              06093000
VRWC     EQU   BLKHDROV+30                                              06094000
VRSG     EQU   BLKHDROV+32                                              06095000
VL       EQU   BLKHDROV+63                                              06096000
ORW      EQU   BLKHDROV+64                                              06097000
ODS      EQU   BLKHDROV+68                                              06098000
ORWC     EQU   BLKHDROV+70                                              06099000
ORSG     EQU   BLKHDROV+72                                              06100000
OL       EQU   BLKHDROV+103                                             06101000
RRW      EQU   BLKHDROV+104                                             06102000
RDS      EQU   BLKHDROV+108                                             06103000
RRWC     EQU   BLKHDROV+110                                             06104000
RRSG     EQU   BLKHDROV+112                                             06105000
RL       EQU   BLKHDROV+143                                             06106000
MINILINE EQU   PRNTLINE                                                 06107000
MINISEQ  EQU   MINILINE+11                                              06108000
MINIFLAG EQU   MINILINE+21                                              06109000
MINIADDR EQU   MINILINE+32                                              06110000
MINIFUNC EQU   MINILINE+37                                              06111000
MINICPU  EQU   MINILINE+42                                              06112000
MINIPGFL EQU   MINILINE+47                                              06113000
MINICNT  EQU   MINILINE+58                                              06114000
MINIVUA  EQU   MINILINE+65                                              06115000
MINIVVA  EQU   MINILINE+70                                              06116000
MINIT1A  EQU   MINILINE+74                                              06117000
MINIT1B  EQU   MINILINE+82                                              06118000
MINIT1C  EQU   MINILINE+83                                              06119000
MINICDAT EQU   MINILINE+88                                              06120000
MINICTIM EQU   MINILINE+95                                              06121000
MINIT4TM EQU   MINILINE+104                                             06122000
T4HOUR   EQU   MINIT4TM                                                 06123000
T4SEP1   EQU   MINIT4TM+2                                               06124000
T4MINUTE EQU   MINIT4TM+3                                               06125000
T4SEP2   EQU   MINIT4TM+5                                               06126000
T4SECOND EQU   MINIT4TM+6                                               06127000
MINIT5TM EQU   MINILINE+113                                             06128000
T5HOUR   EQU   MINIT5TM                                                 06129000
T5SEP1   EQU   MINIT5TM+2                                               06130000
T5MINUTE EQU   MINIT5TM+3                                               06131000
T5SEP2   EQU   MINIT5TM+5                                               06132000
T5SECOND EQU   MINIT5TM+6                                               06133000
PAGELINE EQU   BLKLINE                                                  06134000
PAGEDEV  EQU   PAGELINE+12                                              06135000
PAGEVP   EQU   PAGELINE+18                                              06136000
PAGERP   EQU   PAGELINE+24                                              06137000
PAGECYL  EQU   PAGELINE+30                                              06138000
DTLCOUNT EQU   BLKLINE                                                  06139000
OPT      EQU   DTLCOUNT+13                                              06140000
UDATE1   EQU   DTLCOUNT+22                                              06141000
UDATE2   EQU   DTLCOUNT+28                                              06142000
UTIME1   EQU   DTLCOUNT+41                                              06143000
UTIME2   EQU   DTLCOUNT+46                                              06144000
INCNT    EQU   DTLCOUNT+71                                              06145000
OUTCNT   EQU   DTLCOUNT+99                                              06146000
SELECTID EQU   DTLCOUNT+114                                             06147000
DATELINE EQU   BLKLINE                                                  06148000
DLF2     EQU   DATELINE+25                                              06149000
DLF4     EQU   DATELINE+28                                              06150000
DLF6     EQU   DATELINE+31                                              06151000
DLF8     EQU   DATELINE+34                                              06152000
DLF10    EQU   DATELINE+40                                              06153000
DLF10A   EQU   DATELINE+42                                              06154000
DLF12    EQU   DATELINE+47                                              06155000
DLF14    EQU   DATELINE+50                                              06156000
DLF16    EQU   DATELINE+53                                              06157000
DLF18    EQU   DATELINE+59                                              06158000
OVLYCONV EQU   CONVERT                                                  06159000
CONVERTO EQU   CONVERT                                                  06160000
FLD2     EQU   CONVERTO+1                                               06161000
*                                      START UNREFERENCED COMPONENTS    06162000
FLD1     EQU   CONVERTO                                                 06163000
FIELD3   EQU   OVLYCONV+1                                               06164000
FIELD2   EQU   OVLYCONV+1                                               06165000
FIELD1   EQU   OVLYCONV                                                 06166000
@NM00101 EQU   DATELINE+65                                              06167000
@NM00100 EQU   DATELINE+55                                              06168000
@NM00099 EQU   DATELINE+52                                              06169000
@NM00098 EQU   DATELINE+49                                              06170000
@NM00097 EQU   DATELINE+45                                              06171000
@NM00096 EQU   DATELINE+36                                              06172000
@NM00095 EQU   DATELINE+33                                              06173000
@NM00094 EQU   DATELINE+30                                              06174000
@NM00093 EQU   DATELINE+27                                              06175000
@NM00092 EQU   DATELINE                                                 06176000
@NM00091 EQU   DTLCOUNT+120                                             06177000
@NM00090 EQU   DTLCOUNT+105                                             06178000
@NM00089 EQU   DTLCOUNT+77                                              06179000
@NM00088 EQU   DTLCOUNT+50                                              06180000
@NM00087 EQU   DTLCOUNT+45                                              06181000
@NM00086 EQU   DTLCOUNT+33                                              06182000
@NM00085 EQU   DTLCOUNT+27                                              06183000
@NM00084 EQU   DTLCOUNT+14                                              06184000
@NM00083 EQU   DTLCOUNT                                                 06185000
@NM00082 EQU   PAGELINE+38                                              06186000
@NM00081 EQU   PAGELINE+27                                              06187000
@NM00080 EQU   PAGELINE+21                                              06188000
@NM00079 EQU   PAGELINE+15                                              06189000
@NM00078 EQU   PAGELINE                                                 06190000
@NM00077 EQU   MINILINE+112                                             06191000
@NM00076 EQU   MINILINE+103                                             06192000
@NM00075 EQU   MINILINE+94                                              06193000
@NM00074 EQU   MINILINE+86                                              06194000
@NM00073 EQU   MINILINE+72                                              06195000
@NM00072 EQU   MINILINE+67                                              06196000
@NM00071 EQU   MINILINE+61                                              06197000
@NM00070 EQU   MINILINE+55                                              06198000
@NM00069 EQU   MINILINE+44                                              06199000
@NM00068 EQU   MINILINE+39                                              06200000
@NM00067 EQU   MINILINE+34                                              06201000
@NM00066 EQU   MINILINE+29                                              06202000
@NM00065 EQU   MINILINE+19                                              06203000
@NM00064 EQU   MINILINE                                                 06204000
@NM00042 EQU   BLKHDROV+142                                             06205000
@NM00041 EQU   BLKHDROV+102                                             06206000
@NM00040 EQU   BLKHDROV+62                                              06207000
@NM00039 EQU   BLKHDROV+9                                               06208000
@NM00038 EQU   BLKHDROV                                                 06209000
SPAREBYT EQU   BLOCKHDR+39                                              06210000
JLWAIT   EQU   BLOCKHDR+38                                              06211000
BRSAVE   EQU   BLOCKHDR+37                                              06212000
STSAVE   EQU   BLOCKHDR+36                                              06213000
@NM00037 EQU   RWADDR                                                   06214000
@NM00036 EQU   QCBENTS+3                                                06215000
@NM00035 EQU   @NM00033                                                 06216000
@NM00034 EQU   @NM00033                                                 06217000
@NM00032 EQU   QCBENTS                                                  06218000
DS2NOTU  EQU   DS2ADDR                                                  06219000
DS1NOTU  EQU   DS1ADDR                                                  06220000
BITS67   EQU   BLOCKFLG                                                 06221000
BIT4     EQU   BLOCKFLG                                                 06222000
BITS123  EQU   BLOCKFLG                                                 06223000
@NM00031 EQU   CCHHRR+6                                                 06224000
@NM00043 EQU   RUA                                                      06225000
RESERVED EQU   MINIHDR+14                                               06226000
SPARE    EQU   MINIHDR+2                                                06227000
BITS38   EQU   SEQUENCE                                                 06228000
MVEDATA  EQU   SEQUENCE                                                 06229000
VERIFY   EQU   SEQUENCE                                                 06230000
DCBEOB   EQU   IHADCS40+20                                              06231000
DCBPRECL EQU   IHADCS40+18                                              06232000
@NM00030 EQU   IHADCS40+16                                              06233000
@NM00029 EQU   @NM00027+1                                               06234000
@NM00028 EQU   DCBEROPT                                                 06235000
@NM00026 EQU   IHADCS40+10                                              06236000
@NM00025 EQU   IHADCS40+9                                               06237000
@NM00024 EQU   IHADCS40+8                                               06238000
DCBRECA  EQU   DCBRECAD+1                                               06239000
@NM00023 EQU   DCBRECBT                                                 06240000
DCBRCFGT EQU   DCBRCREL                                                 06241000
DCBRCTRU EQU   DCBRCREL                                                 06242000
DCBLCCW  EQU   DCBEOBAD                                                 06243000
DCBNOTE  EQU   DCBCNTRL                                                 06244000
DCBLRECL EQU   IHADCS38+10                                              06245000
@NM00022 EQU   IHADCS38+8                                               06246000
DCBEOBW  EQU   IHADCS38+4                                               06247000
DCBEOBRA EQU   DCBEOBR+1                                                06248000
DCBNCP   EQU   DCBEOBR                                                  06249000
@NM00021 EQU   DCBFLAG1                                                 06250000
DCBSTFLS EQU   DCBFLAG1                                                 06251000
DCBSTQCK EQU   DCBFLAG1                                                 06252000
DCBDIRCQ EQU   DCBBUFOF                                                 06253000
DCBQSTRU EQU   DCBUSASI                                                 06254000
@NM00020 EQU   DCBUSASI                                                 06255000
DCBQADF3 EQU   DCBQADFS                                                 06256000
DCBQADF2 EQU   DCBQADFS                                                 06257000
DCBQADF1 EQU   DCBQADFS                                                 06258000
DCBBLBP  EQU   DCBUSASI                                                 06259000
@NM00019 EQU   DCBUSASI                                                 06260000
DCBCICBA EQU   DCBCICB+1                                                06261000
@NM00018 EQU   DCBCICB                                                  06262000
DCBOFFSW EQU   IHADCS36+15                                              06263000
DCBOFFSR EQU   IHADCS36+14                                              06264000
DCBWCPL  EQU   IHADCS36+13                                              06265000
DCBWCPO  EQU   IHADCS36+12                                              06266000
DCBBLKSI EQU   IHADCS36+10                                              06267000
DCBCNQSM EQU   DCBCIND2                                                 06268000
DCBCNFEO EQU   DCBCIND2                                                 06269000
DCBCNCHS EQU   DCBCIND2                                                 06270000
DCBCNBFP EQU   DCBCIND2                                                 06271000
DCBCNIOE EQU   DCBCIND2                                                 06272000
DCBCNCLO EQU   DCBCIND2                                                 06273000
DCBCNWRO EQU   DCBCIND2                                                 06274000
DCBCNSTO EQU   DCBCIND2                                                 06275000
DCBCNEXB EQU   DCBCIND1                                                 06276000
@NM00017 EQU   DCBCIND1                                                 06277000
DCBCNBRM EQU   DCBCIND1                                                 06278000
@NM00016 EQU   DCBCIND1                                                 06279000
DCBCNEVA EQU   DCBCIND1                                                 06280000
DCBCNEVB EQU   DCBCIND1                                                 06281000
DCBCNSRD EQU   DCBCIND1                                                 06282000
DCBCNTOV EQU   DCBCIND1                                                 06283000
DCBSYNA  EQU   DCBSYNAD+1                                               06284000
DCBIOBL  EQU   DCBSYNAD                                                 06285000
DCBCHCKA EQU   DCBPERRA                                                 06286000
DCBOPTJ  EQU   DCBOPTCD                                                 06287000
DCBOPTT  EQU   DCBOPTCD                                                 06288000
DCBSRCHD EQU   DCBOPTZ                                                  06289000
DCBOPTQ  EQU   DCBOPTCD                                                 06290000
DCBBCKPT EQU   DCBOPTO                                                  06291000
DCBOPTC  EQU   DCBOPTCD                                                 06292000
DCBOPTU  EQU   DCBOPTCD                                                 06293000
DCBOPTW  EQU   DCBOPTCD                                                 06294000
DCBPUTA  EQU   DCBGETA                                                  06295000
@NM00015 EQU   DCBPUT                                                   06296000
DCBREADA EQU   DCBWRITA                                                 06297000
@NM00014 EQU   DCBREAD                                                  06298000
DCBDEBA  EQU   DCBDEBAD+1                                               06299000
@NM00013 EQU   DCBIFLGS                                                 06300000
DCBIFIOE EQU   DCBIFLGS                                                 06301000
DCBCH12  EQU   DCBIFPCT                                                 06302000
DCBCH9   EQU   DCBIFPCT                                                 06303000
DCBIFEC  EQU   DCBIFLGS                                                 06304000
DCBMFSTI EQU   DCBMFDMD                                                 06305000
DCBMFAWR EQU   DCBMFSTK                                                 06306000
DCBMFUIP EQU   DCBMFTMD                                                 06307000
DCBMFIDW EQU   DCBMFLCP                                                 06308000
DCBMFWRK EQU   DCBMFMVP                                                 06309000
DCBMFRDQ EQU   DCBMFWRT                                                 06310000
DCBMFGTQ EQU   DCBMFPUT                                                 06311000
DCBMFSTL EQU   DCBMACF2                                                 06312000
DCBMFCK  EQU   DCBMFDMG                                                 06313000
DCBMFRDX EQU   DCBMFCHK                                                 06314000
DCBMFDBF EQU   DCBMFSBG                                                 06315000
DCBMFRDI EQU   DCBMFLCG                                                 06316000
DCBMFRDK EQU   DCBMFMVG                                                 06317000
DCBMFWRQ EQU   DCBMFRD                                                  06318000
DCBMFPTQ EQU   DCBMFGET                                                 06319000
DCBMFECP EQU   DCBMACF1                                                 06320000
DCBTIOT  EQU   IHADCS25                                                 06321000
DCBMRSTI EQU   DCBMRDMD                                                 06322000
DCBMRAWR EQU   DCBMRSTK                                                 06323000
DCBMRUIP EQU   DCBMRTMD                                                 06324000
DCBMRIDW EQU   DCBMRLCP                                                 06325000
DCBMRWRK EQU   DCBMRMVP                                                 06326000
DCBMRRDQ EQU   DCBMRWRT                                                 06327000
DCBMRGTQ EQU   DCBMRPUT                                                 06328000
DCBMRSTL EQU   DCBMACR2                                                 06329000
DCBMRCK  EQU   DCBMRDMG                                                 06330000
DCBPGFXA EQU   DCBMRRDX                                                 06331000
DCBMRDBF EQU   DCBMRSBG                                                 06332000
DCBMRRDI EQU   DCBMRLCG                                                 06333000
DCBMRRDK EQU   DCBMRMVG                                                 06334000
DCBMRWRQ EQU   DCBMRRD                                                  06335000
DCBMRPTQ EQU   DCBMRGET                                                 06336000
DCBMRECP EQU   DCBMACR1                                                 06337000
@NM00012 EQU   DCBIFLG                                                  06338000
DCBIBIOE EQU   DCBIFLG                                                  06339000
DCBICH12 EQU   DCBIBPCT                                                 06340000
DCBICH9  EQU   DCBIBPCT                                                 06341000
DCBIBEC  EQU   DCBIFLG                                                  06342000
DCBOFIOF EQU   DCBOFLGS                                                 06343000
DCBOFUEX EQU   DCBOFLGS                                                 06344000
DCBOFTM  EQU   DCBOFLGS                                                 06345000
DCBOFPPC EQU   DCBOFLGS                                                 06346000
DCBOFOPN EQU   DCBOFLGS                                                 06347000
DCBOFEOV EQU   DCBOFLGS                                                 06348000
DCBOFLRB EQU   DCBOFLGS                                                 06349000
DCBOFIOD EQU   DCBOFLWR                                                 06350000
DCBDDNAM EQU   IHADCS24                                                 06351000
DCBEXLSA EQU   DCBEXLST+1                                               06352000
DCBRECKL EQU   DCBRECFM                                                 06353000
DCBRECCC EQU   DCBRECFM                                                 06354000
DCBRECSB EQU   DCBRECFM                                                 06355000
DCBRECBR EQU   DCBRECFM                                                 06356000
DCBRECTO EQU   DCBRECLA                                                 06357000
DCBRECL  EQU   DCBRECLA                                                 06358000
DCBEODA  EQU   DCBEODAD+1                                               06359000
DCBBFA   EQU   DCBBFTEK                                                 06360000
DCBH0    EQU   DCBBFTEK                                                 06361000
DCBBFTKD EQU   DCBBFTEK                                                 06362000
DCBBFTE  EQU   DCBBFT                                                   06363000
DCBBFTKR EQU   DCBBFT                                                   06364000
DCBBFTS  EQU   DCBBFT                                                   06365000
DCBH1    EQU   DCBBFTEK                                                 06366000
DCBSVCXA EQU   DCBSVCXL+1                                               06367000
@NM00011 EQU   DCBSVCXL                                                 06368000
DCBODEBA EQU   DCBIOBAA                                                 06369000
@NM00010 EQU   DCBQSLM                                                  06370000
DCBUPDBT EQU   DCBQSLM                                                  06371000
DCBUPDCM EQU   DCBQSLM                                                  06372000
DCB1DVDS EQU   DCBQSLM                                                  06373000
@NM00009 EQU   DCBDSRG2                                                 06374000
DCBDSGTR EQU   DCBDSRG2                                                 06375000
DCBACBM  EQU   DCBDSRG2                                                 06376000
@NM00008 EQU   DCBDSRG2                                                 06377000
DCBDSGTQ EQU   DCBDSRG2                                                 06378000
DCBDSGTX EQU   DCBDSRG2                                                 06379000
DCBDSGGS EQU   DCBDSRG2                                                 06380000
DCBDSGU  EQU   DCBDSRG1                                                 06381000
DCBDSGPO EQU   DCBDSRG1                                                 06382000
@NM00007 EQU   DCBDSRG1                                                 06383000
@NM00006 EQU   DCBDSRG1                                                 06384000
DCBDSGCX EQU   DCBDSRG1                                                 06385000
DCBDSGDA EQU   DCBDSRG1                                                 06386000
DCBDSGPS EQU   DCBDSRG1                                                 06387000
DCBDSGIS EQU   DCBDSRG1                                                 06388000
DCBBUFL  EQU   IHADCS11+8                                               06389000
DCBBUFCA EQU   DCBBUFCB+1                                               06390000
DCBBUFNO EQU   DCBBUFCB                                                 06391000
DCBDEVT  EQU   DCBREL                                                   06392000
DCBKEYLE EQU   DCBRELB                                                  06393000
@NM00005 EQU   DCBFUNC                                                  06394000
DCBFNCBT EQU   DCBFUNC                                                  06395000
DCBFNCBX EQU   DCBFUNC                                                  06396000
DCBFNCBD EQU   DCBFUNC                                                  06397000
DCBFNCBW EQU   DCBFUNC                                                  06398000
DCBFNCBP EQU   DCBFUNC                                                  06399000
DCBFNCBR EQU   DCBFUNC                                                  06400000
DCBFNCBI EQU   DCBFUNC                                                  06401000
@NM00004 EQU   IHADCS05+2                                               06402000
@NM00003 EQU   IHADCS05+1                                               06403000
DCBSTCK1 EQU   DCBSTACK                                                 06404000
DCBSTCK2 EQU   DCBSTACK                                                 06405000
@NM00002 EQU   DCBSTACK                                                 06406000
DCBMODER EQU   DCBSTACK                                                 06407000
DCBMODEO EQU   DCBSTACK                                                 06408000
DCBMODEE EQU   DCBSTACK                                                 06409000
DCBMODEC EQU   DCBSTACK                                                 06410000
@NM00001 EQU   IHADCB                                                   06411000
*                                      END UNREFERENCED COMPONENTS      06412000
@RT00162 EQU   CLOSEFIL                                                 06413000
@RT00166 EQU   CLOSEFIL                                                 06414000
@RT00170 EQU   CLOSEFIL                                                 06415000
@RT00182 EQU   RDTRACE                                                  06416000
@RT00204 EQU   RDTRACE                                                  06417000
@RT00206 EQU   RDTRACE                                                  06418000
@RT00208 EQU   RDTRACE                                                  06419000
@RF00217 EQU   RDTRACE                                                  06420000
@RF00370 EQU   @EL00003                                                 06421000
@RT00410 EQU   PARMEND                                                  06422000
@RF00425 EQU   @RC00423                                                 06423000
@RF00435 EQU   @RC00433                                                 06424000
@RT00449 EQU   PARMEND                                                  06425000
@RT00462 EQU   PARMEND                                                  06426000
@RF00493 EQU   @EL00004                                                 06427000
@RF00529 EQU   @EL00006                                                 06428000
@RC00644 EQU   @RC00643                                                 06429000
@RC00722 EQU   @EL00007                                                 06430000
@RT00793 EQU   @EL00009                                                 06431000
@RF00791 EQU   CKREC                                                    06432000
@RT00807 EQU   @EL00009                                                 06433000
@RT00820 EQU   @EL00009                                                 06434000
@RF00878 EQU   @RC00870                                                 06435000
@RT00959 EQU   @EL00011                                                 06436000
@RF00962 EQU   @EL00011                                                 06437000
@RT01111 EQU   @EL00013                                                 06438000
@RT01137 EQU   @EL00013                                                 06439000
@RT01225 EQU   @EL00013                                                 06440000
@RT01287 EQU   @RC01286                                                 06441000
@RF01271 EQU   @EL00015                                                 06442000
@RF01323 EQU   @EL00015                                                 06443000
@RT01375 EQU   EF4                                                      06444000
EFEND    EQU   @EL00019                                                 06445000
@RC01436 EQU   @EL00022                                                 06446000
@PB00023 EQU   @EL00001                                                 06447000
@RT01373 EQU   EFEND                                                    06448000
@ENDDATA EQU   *                                                        06449000
         END   ICGTRINT,(C'PLS2133',0701,77354)                         06450000
./  ADD  SSI=70890125,NAME=ICGTRSUM
         TITLE '***** ICGTRSUM MSS TRACE SDG AND RWU SUMMARY REPORT ****00001000
               ***      '                                               00002000
ICGTRSUM CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGTRSUM  77.089'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@11                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @10,@01                                             0001 00017000
         LA    @09,4095(,@10)                                      0001 00018000
         USING @DATD,@10                                           0001 00019000
         USING @DATD+4095,@09                                      0001 00020000
         ST    @13,@SA00001+4                                      0001 00021000
         LM    @00,@01,20(@13)                                     0001 00022000
         ST    @10,8(,@13)                                         0001 00023000
         LR    @13,@10                                             0001 00024000
         L     R1,0(R1)                                                 00025000
*   PARMPTR=R1;                     /* SAVE JCL PARMS ADDRESS      0086 00026000
*                                                            @Y30LB40*/ 00027000
         LR    PARMPTR,R1                                          0086 00028000
*   RFY                                                            0087 00029000
*     R1 UNRSTD;                    /*                       @Y30LB40*/ 00030000
*   CALL INIT;                      /* INITIALIZE VALUES     @OZ11673*/ 00031000
         BAL   @14,INIT                                            0088 00032000
*   CALL OPENFILE;                  /* OPEN PRINT, TRACEIN   @OZ11673*/ 00033000
         BAL   @14,OPENFILE                                        0089 00034000
*   IF RETURNCD=4                   /* SYSPRINT NOT OPEN     @OZ11673*/ 00035000
*     THEN                          /*                       @OZ11673*/ 00036000
         LH    @06,RETURNCD                                        0090 00037000
         C     @06,@CF00104                                        0090 00038000
         BNE   @RF00090                                            0090 00039000
*     RETURN CODE(RETURNCD);        /* RETURN, NO MESSAGE    @OZ11673*/ 00040000
         L     @13,4(,@13)                                         0091 00041000
         L     @00,@SIZDATD                                        0091 00042000
         LR    @01,@10                                             0091 00043000
         FREEMAIN R,LV=(0),A=(1)                                        00044000
         LR    @15,@06                                             0091 00045000
         L     @14,12(,@13)                                        0091 00046000
         LM    @00,@12,20(@13)                                     0091 00047000
         BR    @14                                                 0091 00048000
*   ELSE                                                           0092 00049000
*     IF RETURNCD=8                 /* TRACEIN NOT OPEN      @OZ11673*/ 00050000
*       THEN                        /*                       @OZ11673*/ 00051000
@RF00090 CLC   RETURNCD(2),@CH00069                                0092 00052000
         BE    @RT00092                                            0092 00053000
*       GO TO CLOSEFIL;             /* CLOSE OPENED FILES    @OZ11673*/ 00054000
*   IF PARMLEN¬=0                   /* IF PARMS PASSED       @OZ11673*/ 00055000
*     THEN                          /*                       @OZ11673*/ 00056000
         LH    @06,PARMLEN(,PARMPTR)                               0094 00057000
         LTR   @06,@06                                             0094 00058000
         BZ    @RF00094                                            0094 00059000
*     CALL GETPARMS;                /* PROCESS PARMS         @OZ11673*/ 00060000
         BAL   @14,GETPARMS                                        0095 00061000
*   IF RETURNCD=8                   /* IF ERROR IN           @OZ11673*/ 00062000
*     THEN                          /* PROCESSING PARMS      @OZ11673*/ 00063000
@RF00094 CLC   RETURNCD(2),@CH00069                                0096 00064000
         BE    @RT00096                                            0096 00065000
*     GO TO CLOSEFIL;               /* CLOSE OPENED FILES    @OZ11673*/ 00066000
*   RFY                                                            0098 00067000
*    (R0,                                                          0098 00068000
*     R1,                                                          0098 00069000
*     R14,                                                         0098 00070000
*     R15) RSTD;                    /*                       @OZ11673*/ 00071000
*   GEN(TIME);                      /* GET AND CONVERT TODAYS DATE 0099 00072000
*                                                            @OZ11673*/ 00073000
         TIME                                                           00074000
*   GEN(ST    R1,DOUBLEWD);         /*                       @OZ11673*/ 00075000
         ST    R1,DOUBLEWD                                              00076000
*   RFY                                                            0101 00077000
*    (R0,                                                          0101 00078000
*     R1,                                                          0101 00079000
*     R14,                                                         0101 00080000
*     R15) UNRSTD;                  /*                       @OZ11673*/ 00081000
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @OZ11673*/ 00082000
*                                                                  0102 00083000
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0102 00084000
*   /*****************************************************************/ 00085000
*   /*                                                               */ 00086000
*   /* ************************************************      @OZ11673*/ 00087000
*   /* SET UP INITIAL TIMESLICE COMPARE RECORD USING         @OZ11673*/ 00088000
*   /* THE STARTING TIME SPECIFIED IN THE DATE AND           @OZ11673*/ 00089000
*   /* TIME PARAMETERS, OR THE DEFAULT VALUES.               @OZ11673*/ 00090000
*   /* ************************************************      @OZ11673*/ 00091000
*   /*                                                               */ 00092000
*   /*****************************************************************/ 00093000
*                                                                  0103 00094000
*   TSBEG=CKSTIME;                  /*                       @OZ11673*/ 00095000
         MVC   TSBEG(7),CKSTIME                                    0103 00096000
*   TSEND=CKSTIME;                  /*                       @OZ11673*/ 00097000
         MVC   TSEND(7),CKSTIME                                    0104 00098000
*   TSETIME=TSETIME+TIMESL;         /*                       @OZ11673*/ 00099000
         L     @06,TSETIME                                         0105 00100000
         AL    @06,TIMESL                                          0105 00101000
         ST    @06,TSETIME                                         0105 00102000
*   GO TO RDTRACE;                                                 0106 00103000
         B     RDTRACE                                             0106 00104000
*                                                                  0107 00105000
*/********************************************************** @OZ11673*/ 00106000
*/*                                                          @OZ11673*/ 00107000
*/* PRODEDURE NAME - RDTRACE (SUBSECTION WITHIN MAINLINE)    @OZ11673*/ 00108000
*/*                                                          @OZ11673*/ 00109000
*/* FUNCTION - READ A RECORD FROM TRACEIN, AND DETERMINE     @OZ11673*/ 00110000
*/********************************************************** @OZ11673*/ 00111000
*                                                                  0107 00112000
*RDTRACE:                                                          0107 00113000
*   RFY                                                            0107 00114000
*    (R0,                                                          0107 00115000
*     R1,                                                          0107 00116000
*     R14,                                                         0107 00117000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00118000
RDTRACE  DS    0H                                                  0108 00119000
*   GEN(GET   INDCB,RCDIN);         /* READ AN INPUT RECORD  @Y30LB40*/ 00120000
         GET   INDCB,RCDIN                                              00121000
*   RFY                                                            0109 00122000
*    (R0,                                                          0109 00123000
*     R1,                                                          0109 00124000
*     R14,                                                         0109 00125000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00126000
*   IF CKTIME<CKSTIME|CKTIME>CKETIME/* IF NOT IN TIME RANGE          */ 00127000
*     THEN                                                         0110 00128000
         CLC   CKTIME(7),CKSTIME                                   0110 00129000
         BL    @RT00110                                            0110 00130000
         CLC   CKTIME(7),CKETIME                                   0110 00131000
         BH    @RT00110                                            0110 00132000
*     GO TO RDTRACE;                /* READ NEXT RECORD              */ 00133000
*   IF SELECTSW='1'B                /* WAS SDG OR LU ENTERED @ZA16140*/ 00134000
*     THEN                                                         0112 00135000
         TM    SELECTSW,B'10000000'                                0112 00136000
         BNO   @RF00112                                            0112 00137000
*     IF PARMSW='D' THEN                                           0113 00138000
         CLI   PARMSW,C'D'                                         0113 00139000
         BNE   @RF00113                                            0113 00140000
*       DO;                         /* SDG ENTERED,IS THIS THE     0114 00141000
*                                      DESIRED SDG           @ZA16140*/ 00142000
*         IF SDGINBIN¬=SELSDG THEN                                 0115 00143000
         CLC   SDGINBIN(1),SELSDG                                  0115 00144000
         BNE   @RT00115                                            0115 00145000
*           GO TO RDTRACE;          /* NO,READ NEXT RECORD   @Y30LB40*/ 00146000
*       END;                        /*                       @Y30LB40*/ 00147000
*     ELSE                                                         0118 00148000
*       DO;                         /* LU ENTERED,IS THIS THE DESIRED   00149000
*                                      LU                    @Y30LB40*/ 00150000
         B     @RC00113                                            0118 00151000
@RF00113 DS    0H                                                  0119 00152000
*         IF L¬=LIBRARY|U¬=READWRIT THEN                           0119 00153000
         SLR   @06,@06                                             0119 00154000
         IC    @06,LIBRARY                                         0119 00155000
         CR    L,@06                                               0119 00156000
         BNE   @RT00119                                            0119 00157000
         SLR   @06,@06                                             0119 00158000
         IC    @06,READWRIT                                        0119 00159000
         CR    U,@06                                               0119 00160000
         BNE   @RT00119                                            0119 00161000
*           GO TO RDTRACE;          /* NO,READ NEXT RECORD   @Y30LB40*/ 00162000
*       END;                        /*                       @Y30LB40*/ 00163000
*   IF(DSTGD+STGD)¬>0 THEN                                         0122 00164000
@RC00113 DS    0H                                                  0122 00165000
@RF00112 L     @06,DSTGD                                           0122 00166000
         AL    @06,STGD                                            0122 00167000
         LTR   @06,@06                                             0122 00168000
         BNP   @RT00122                                            0122 00169000
*     GO TO RDTRACE;                /* BYPASS ZERO RCDS              */ 00170000
*   IF FIRSTSW='1'B                 /* TEST IF FIRST RECORD  @Y30LB40*/ 00171000
*     THEN                                                         0124 00172000
         TM    FIRSTSW,B'10000000'                                 0124 00173000
         BNO   @RF00124                                            0124 00174000
*     DO;                           /*                       @Y30LB40*/ 00175000
*       FIRSTSW='0'B;               /* TURN OFF 1ST RECORD SWITCH    */ 00176000
         NI    FIRSTSW,B'01111111'                                 0126 00177000
*       CKSEQ=CKTIME;               /* SETUP TIME SLICE START AND END*/ 00178000
         MVC   CKSEQ(7),CKTIME                                     0127 00179000
*       CALL GETSLICE;              /*                       @OZ11673*/ 00180000
         BAL   @14,GETSLICE                                        0128 00181000
*     END;                          /*                       @Y30LB40*/ 00182000
*   IF CKTIME<CKSEQ                 /* CHECK INPUT SEQUENCE  @Y30LB40*/ 00183000
*     THEN                                                         0130 00184000
@RF00124 CLC   CKTIME(7),CKSEQ                                     0130 00185000
         BNL   @RF00130                                            0130 00186000
*     DO;                           /* OUT OF SEQUENCE,PRINT MESSAGE    00187000
*                                      AND                   @Y30LB40*/ 00188000
*       DSLINE=SEQMSG;              /* EXIT WITH RC=8        @Y30LB40*/ 00189000
         MVI   DSLINE+43,C' '                                      0132 00190000
         MVC   DSLINE+44(81),DSLINE+43                             0132 00191000
         MVC   DSLINE(43),SEQMSG                                   0132 00192000
*       RFY                                                        0133 00193000
*        (R0,                                                      0133 00194000
*         R1,                                                      0133 00195000
*         R14,                                                     0133 00196000
*         R15) RSTD;                /*                       @Y30LB40*/ 00197000
*       GEN(PUT   PRNTDCB,DSLINE);  /*                       @Y30LB40*/ 00198000
         PUT   PRNTDCB,DSLINE                                           00199000
*       RFY                                                        0135 00200000
*        (R0,                                                      0135 00201000
*         R1,                                                      0135 00202000
*         R14,                                                     0135 00203000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00204000
*       RETURNCD=8;                 /*                       @Y30LB40*/ 00205000
         MVC   RETURNCD(2),@CH00069                                0136 00206000
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/ 00207000
         B     CLOSEFIL                                            0137 00208000
*     END;                          /*                       @Y30LB40*/ 00209000
*   CKSEQ=CKTIME;                   /* UPDATE SEQUENCE CHECK @Y30LB40*/ 00210000
@RF00130 MVC   CKSEQ(7),CKTIME                                     0139 00211000
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT INPUT RECORDS   @Y30LB40*/ 00212000
         LA    @06,1                                               0140 00213000
         AL    @06,RCDCOUNT                                        0140 00214000
         ST    @06,RCDCOUNT                                        0140 00215000
*CHECKEOF:                                                         0141 00216000
*   IF CKTIME>TSEND                 /*                       @OZ11673*/ 00217000
*       |EOFSW='1'B                 /* END OF JOB YET        @OZ11673*/ 00218000
*     THEN                          /*                       @OZ11673*/ 00219000
CHECKEOF CLC   CKTIME(7),TSEND                                     0141 00220000
         BH    @RT00141                                            0141 00221000
         TM    EOFSW,B'10000000'                                   0141 00222000
         BNO   @RF00141                                            0141 00223000
@RT00141 DS    0H                                                  0142 00224000
*     DO;                           /*                       @OZ11673*/ 00225000
*       IF PARMSW='R'               /*                       @OZ11673*/ 00226000
*         THEN                      /*                       @OZ11673*/ 00227000
         CLI   PARMSW,C'R'                                         0143 00228000
         BNE   @RF00143                                            0143 00229000
*         CALL RWCTLBRK;            /*                       @OZ11673*/ 00230000
         BAL   @14,RWCTLBRK                                        0144 00231000
*       ELSE                        /*                       @OZ11673*/ 00232000
*         CALL DSCTLBRK;            /*                       @OZ11673*/ 00233000
         B     @RC00143                                            0145 00234000
@RF00143 BAL   @14,DSCTLBRK                                        0145 00235000
*       CALL GETSLICE;              /*                       @OZ11673*/ 00236000
@RC00143 BAL   @14,GETSLICE                                        0146 00237000
*     END;                          /*                       @OZ11673*/ 00238000
*   IF EOFSW='1'B                   /* END OF JOB YET        @OZ11673*/ 00239000
*     THEN                          /*                       @OZ11673*/ 00240000
@RF00141 TM    EOFSW,B'10000000'                                   0148 00241000
         BNO   @RF00148                                            0148 00242000
*     DO;                           /*                       @OZ11673*/ 00243000
*       CALL TESTEOF;               /*                       @OZ11673*/ 00244000
         BAL   @14,TESTEOF                                         0150 00245000
*       IF I=2                      /* REPORT TOTALS WRITTEN,GETOUT  */ 00246000
*         THEN                      /*                       @OZ11673*/ 00247000
         C     I,@CF00051                                          0151 00248000
         BNE   @RF00151                                            0151 00249000
*         DO;                       /*                       @OZ11673*/ 00250000
*           CALL EOJ;               /*                       @OZ11673*/ 00251000
         BAL   @14,EOJ                                             0153 00252000
*           GO TO CLOSEFIL;         /*                       @OZ11673*/ 00253000
         B     CLOSEFIL                                            0154 00254000
*         END;                      /*                       @OZ11673*/ 00255000
*     END;                          /*                       @OZ11673*/ 00256000
@RF00151 DS    0H                                                  0157 00257000
*   IF PARMSW='R'                   /*                       @OZ11673*/ 00258000
*     THEN                          /*                       @OZ11673*/ 00259000
@RF00148 CLI   PARMSW,C'R'                                         0157 00260000
         BNE   @RF00157                                            0157 00261000
*     CALL RWACCUM;                 /*                       @OZ11673*/ 00262000
         BAL   @14,RWACCUM                                         0158 00263000
*   ELSE                            /*                       @OZ11673*/ 00264000
*     CALL DSACCUM;                 /*                       @OZ11673*/ 00265000
         B     @RC00157                                            0159 00266000
@RF00157 BAL   @14,DSACCUM                                         0159 00267000
*   GO TO RDTRACE;                  /*                       @OZ11673*/ 00268000
         B     RDTRACE                                             0160 00269000
*CLOSEFIL:                                                         0161 00270000
*   RFY                                                            0161 00271000
*    (R0,                                                          0161 00272000
*     R1,                                                          0161 00273000
*     R14,                                                         0161 00274000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00275000
CLOSEFIL DS    0H                                                  0162 00276000
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/ 00277000
         CLOSE INDCB,MF=(E,OPENCLOS)                                    00278000
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/ 00279000
         CLOSE PRNTDCB,MF=(E,OPENCLOS)                                  00280000
*   RFY                                                            0164 00281000
*    (R0,                                                          0164 00282000
*     R1,                                                          0164 00283000
*     R14,                                                         0164 00284000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00285000
*   RETURN CODE(RETURNCD);          /* TERMINATE WITH RETURN CODE  0165 00286000
*                                                            @Y30LB40*/ 00287000
         LH    @08,RETURNCD                                        0165 00288000
         L     @13,4(,@13)                                         0165 00289000
         L     @00,@SIZDATD                                        0165 00290000
         LR    @01,@10                                             0165 00291000
         FREEMAIN R,LV=(0),A=(1)                                        00292000
         LR    @15,@08                                             0165 00293000
         L     @14,12(,@13)                                        0165 00294000
         LM    @00,@12,20(@13)                                     0165 00295000
         BR    @14                                                 0165 00296000
*                                                                  0166 00297000
*/********************************************************** @OZ11673*/ 00298000
*/*                                                          @OZ11673*/ 00299000
*/* PROCEDURE NAME - INIT                                    @OZ11673*/ 00300000
*/*                                                          @OZ11673*/ 00301000
*/* FUNCTION - INITIALIZE LOCAL VARIABLES                    @OZ11673*/ 00302000
*/*                                                          @OZ11673*/ 00303000
*/********************************************************** @OZ11673*/ 00304000
*                                                                  0166 00305000
*INIT:                                                             0166 00306000
*   PROCEDURE;                      /*                       @OZ11673*/ 00307000
INIT     STM   @14,@12,12(@13)                                     0166 00308000
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/ 00309000
         SLR   @08,@08                                             0167 00310000
         ST    @08,RCDCOUNT                                        0167 00311000
*   RETURNCD=0;                     /*                       @Y30LB40*/ 00312000
         STH   @08,RETURNCD                                        0168 00313000
*   TIMESL=600;                     /*                       @Y30LB40*/ 00314000
         MVC   TIMESL(4),@CF00700                                  0169 00315000
*   HOUR=0;                         /*                       @Y30LB40*/ 00316000
         ST    @08,HOUR                                            0170 00317000
*   MINUTE=0;                       /*                       @Y30LB40*/ 00318000
         ST    @08,MINUTE                                          0171 00319000
*   SECOND=0;                       /*                       @Y30LB40*/ 00320000
         ST    @08,SECOND                                          0172 00321000
*   SELECTSW='0'B;                  /*                       @Y30LB40*/ 00322000
         NI    SELECTSW,B'01111111'                                0173 00323000
*   LINECNT=56;                     /*                       @Y30LB40*/ 00324000
         MVC   LINECNT(2),@CH00701                                 0174 00325000
*   OPENCLOS=0;                     /*                       @Y30LB40*/ 00326000
         ST    @08,OPENCLOS                                        0175 00327000
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/ 00328000
         MVI   OPCLB1,B'10000000'                                  0176 00329000
*   PAGECNT=0;                      /*                       @Y30LB40*/ 00330000
         ST    @08,PAGECNT                                         0177 00331000
*   EOFSW='0'B;                     /*                       @Y30LB40*/ 00332000
         NI    EOFSW,B'01111111'                                   0178 00333000
*   HLDSYR=0;                       /*                       @Y30LB40*/ 00334000
         MVI   HLDSYR,X'00'                                        0179 00335000
*   HLDSDAY=1;                      /*                       @Y30LB40*/ 00336000
         LA    @15,1                                               0180 00337000
         STH   @15,HLDSDAY                                         0180 00338000
*   HLDSTIME=0;                     /*                       @Y30LB40*/ 00339000
         ST    @08,HLDSTIME                                        0181 00340000
*   HLDEYR=99;                      /*                       @Y30LB40*/ 00341000
         MVI   HLDEYR,X'63'                                        0182 00342000
*   HLDEDAY=365;                    /*                       @Y30LB40*/ 00343000
         MVC   HLDEDAY(2),@CH00704                                 0183 00344000
*   HLDETIME=86399;                 /*                       @Y30LB40*/ 00345000
         MVC   HLDETIME(4),@CF00705                                0184 00346000
*   PARMSW='D';                     /*                       @Y30LB40*/ 00347000
         MVI   PARMSW,C'D'                                         0185 00348000
*   FIRSTSW='1'B;                   /*                       @Y30LB40*/ 00349000
         OI    FIRSTSW,B'10000000'                                 0186 00350000
*   PARMERR='0'B;                   /*                       @Y30LB40*/ 00351000
         NI    PARMERR,B'01111111'                                 0187 00352000
*   DATEINSW='0'B;                  /*                       @Y30LB40*/ 00353000
         NI    DATEINSW,B'01111111'                                0188 00354000
*   SPACE1=' ';                     /*                       @Y30LB40*/ 00355000
         MVI   SPACE1+1,C' '                                       0189 00356000
         MVC   SPACE1+2(119),SPACE1+1                              0189 00357000
         MVI   SPACE1,C' '                                         0189 00358000
*   DO I=1 TO 2;                    /*                       @Y30LB40*/ 00359000
         LR    I,@15                                               0190 00360000
@DL00190 DS    0H                                                  0191 00361000
*     DO J=1 TO 2;                  /*                       @ZA16140*/ 00362000
         LA    J,1                                                 0191 00363000
@DL00191 DS    0H                                                  0192 00364000
*       DO K=1 TO 29;               /*                       @ZA16140*/ 00365000
         LA    K,1                                                 0192 00366000
@DL00192 DS    0H                                                  0193 00367000
*         BKT1(I,J,K)=0;            /*                       @Y30LB40*/ 00368000
         SLR   @15,@15                                             0193 00369000
         LR    @14,I                                               0193 00370000
         ALR   @14,@14                                             0193 00371000
         ALR   @14,J                                               0193 00372000
         MH    @14,@CH00643                                        0193 00373000
         ALR   @14,K                                               0193 00374000
         SLA   @14,2                                               0193 00375000
         ST    @15,BKT1-352(@14)                                   0193 00376000
*         BKT2(I,J,K)=0;            /*                       @Y30LB40*/ 00377000
         ST    @15,BKT2-352(@14)                                   0194 00378000
*         BKT3(I,J,K)=0;            /*                       @Y30LB40*/ 00379000
         ST    @15,BKT3-352(@14)                                   0195 00380000
*         BKT4(I,J,K)=0;            /*                       @Y30LB40*/ 00381000
         ST    @15,BKT4-352(@14)                                   0196 00382000
*         BKT5(I,J,K)=0;            /*                       @Y30LB40*/ 00383000
         ST    @15,BKT5-352(@14)                                   0197 00384000
*         BKT6(I,J,K)=0;            /*                       @Y30LB40*/ 00385000
         ST    @15,BKT6-352(@14)                                   0198 00386000
*         BKT7(I,J,K)=0;            /*                       @Y30LB40*/ 00387000
         ST    @15,BKT7-352(@14)                                   0199 00388000
*       END;                        /*                       @Y30LB40*/ 00389000
         AL    K,@CF00044                                          0200 00390000
         C     K,@CF00643                                          0200 00391000
         BNH   @DL00192                                            0200 00392000
*     END;                          /*                       @Y30LB40*/ 00393000
         AL    J,@CF00044                                          0201 00394000
         C     J,@CF00051                                          0201 00395000
         BNH   @DL00191                                            0201 00396000
*   END;                            /*                       @Y30LB40*/ 00397000
         AL    I,@CF00044                                          0202 00398000
         C     I,@CF00051                                          0202 00399000
         BNH   @DL00190                                            0202 00400000
*   END INIT;                       /*                       @OZ11673*/ 00401000
@EL00002 DS    0H                                                  0203 00402000
@EF00002 DS    0H                                                  0203 00403000
@ER00002 LM    @14,@12,12(@13)                                     0203 00404000
         BR    @14                                                 0203 00405000
*                                                                  0204 00406000
*/********************************************************** @OZ11673*/ 00407000
*/*                                                          @OZ11673*/ 00408000
*/* PROCEDURE NAME - OPENFILE                                @OZ11673*/ 00409000
*/*                                                          @OZ11673*/ 00410000
*/* FUNCTION - SET UP DCBS FOR SYSPRINT AND TRACEIN.  IF     @OZ11673*/ 00411000
*/*            SYSPRINT CANNOT BE OPENED,SET A RETURN CODE   @OZ11673*/ 00412000
*/*            OF 4 AND RETURN TO THE MAINLINE.  IF TRACEIN  @OZ11673*/ 00413000
*/*            CANNOT BE OPENED, WRITE MESSAGE 'ICG901I      @OZ11673*/ 00414000
*/*            TRACEIN CANNOT BE OPENED', SET A RETURN CODE  @OZ11673*/ 00415000
*/*            OF 8, AND RETURN TO THE MAINLINE.             @OZ11673*/ 00416000
*/*                                                          @OZ11673*/ 00417000
*/********************************************************** @OZ11673*/ 00418000
*                                                                  0204 00419000
*OPENFILE:                                                         0204 00420000
*   PROCEDURE;                      /*                       @OZ11673*/ 00421000
OPENFILE STM   @14,@12,@SA00003                                    0204 00422000
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/ 00423000
         MVC   PRNTDCB(PDCBL),PPATDCB                                   00424000
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/ 00425000
         MVC   INDCB(IDCBL),IPATDCB                                     00426000
*   RFY                                                            0207 00427000
*    (R0,                                                          0207 00428000
*     R1,                                                          0207 00429000
*     R14,                                                         0207 00430000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00431000
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */ 00432000
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)                       00433000
*   RFY                                                            0209 00434000
*    (R0,                                                          0209 00435000
*     R1,                                                          0209 00436000
*     R14,                                                         0209 00437000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00438000
*   IF(PRNTDCB(49:49)&'00010000'B)¬='00010000'B THEN               0210 00439000
         MVC   @TS00001(1),PRNTDCB+48                              0210 00440000
         NI    @TS00001,B'00010000'                                0210 00441000
         CLI   @TS00001,B'00010000'                                0210 00442000
         BE    @RF00210                                            0210 00443000
*     DO;                           /*                       @Y30LB40*/ 00444000
*       RETURNCD=4;                 /* SET RETURN CODE = 4   @OZ11673*/ 00445000
         MVC   RETURNCD(2),@CH00104                                0212 00446000
*       RETURN;                     /* RETURN TO MAINLINE    @OZ11673*/ 00447000
@EL00003 DS    0H                                                  0213 00448000
@EF00003 DS    0H                                                  0213 00449000
@ER00003 LM    @14,@12,@SA00003                                    0213 00450000
         BR    @14                                                 0213 00451000
*     END;                          /*                       @Y30LB40*/ 00452000
*   RFY                                                            0215 00453000
*    (R0,                                                          0215 00454000
*     R1,                                                          0215 00455000
*     R14,                                                         0215 00456000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00457000
@RF00210 DS    0H                                                  0216 00458000
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */ 00459000
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)                          00460000
*   RFY                                                            0217 00461000
*    (R0,                                                          0217 00462000
*     R1,                                                          0217 00463000
*     R14,                                                         0217 00464000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00465000
*   IF(INDCB(49:49)&'00010000'B)¬='00010000'B THEN                 0218 00466000
         MVC   @TS00001(1),INDCB+48                                0218 00467000
         NI    @TS00001,B'00010000'                                0218 00468000
         CLI   @TS00001,B'00010000'                                0218 00469000
         BE    @RF00218                                            0218 00470000
*     DO;                           /* OPEN BAD,PRINT MESSAGE,EXIT 0219 00471000
*                                      WITH RC=8             @Y30LB40*/ 00472000
*       DSLINE=TRINMSG;             /*                       @Y30LB40*/ 00473000
         MVI   DSLINE+31,C' '                                      0220 00474000
         MVC   DSLINE+32(93),DSLINE+31                             0220 00475000
         MVC   DSLINE(31),TRINMSG                                  0220 00476000
*       RFY                                                        0221 00477000
*        (R0,                                                      0221 00478000
*         R1,                                                      0221 00479000
*         R14,                                                     0221 00480000
*         R15) RSTD;                /*                       @Y30LB40*/ 00481000
*       GEN(PUT   PRNTDCB,DSLINE);  /*                       @Y30LB40*/ 00482000
         PUT   PRNTDCB,DSLINE                                           00483000
*       RFY                                                        0223 00484000
*        (R0,                                                      0223 00485000
*         R1,                                                      0223 00486000
*         R14,                                                     0223 00487000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00488000
*       RETURNCD=8;                 /*                       @Y30LB40*/ 00489000
         MVC   RETURNCD(2),@CH00069                                0224 00490000
*       RETURN;                     /* RETURN TO MAINLINE    @OZ11673*/ 00491000
         B     @EL00003                                            0225 00492000
*     END;                          /*                       @Y30LB40*/ 00493000
*   END OPENFILE;                   /*                       @OZ11673*/ 00494000
         B     @EL00003                                            0227 00495000
*                                                                  0228 00496000
*/********************************************************** @OZ11673*/ 00497000
*/*                                                          @OZ11673*/ 00498000
*/* PROCEDURE NAME - GETPARMS                                @OZ11673*/ 00499000
*/*                                                          @OZ11673*/ 00500000
*/* FUNCTION - SCAN THE PARAMETERS PASSED IN THE PARM FIELD  @OZ11673*/ 00501000
*/*            OF THE EXEC STATEMENT FOR VALID PARAMETERS.   @OZ11673*/ 00502000
*/*            IF AN INVALID PARAMETER IS FOUND, WRITE MSG   @OZ11673*/ 00503000
*/*            'ICG900I INVALID PARM VALUES', SET A RETURN   @OZ11673*/ 00504000
*/*            CODE OF 8, AND RETURN TO THE MAINLINE.  IF    @OZ11673*/ 00505000
*/*            PARAMETERS ARE GOOD, RETURN TO THE MAINLINE   @OZ11673*/ 00506000
*/*            WITH A RETURN CODE OF 0.                      @OZ11673*/ 00507000
*/*                                                          @OZ11673*/ 00508000
*/********************************************************** @OZ11673*/ 00509000
*                                                                  0228 00510000
*GETPARMS:                                                         0228 00511000
*   PROCEDURE;                      /*                       @OZ11673*/ 00512000
GETPARMS STM   @14,@06,@SA00004                                    0228 00513000
         STM   @09,@12,@SA00004+36                                 0228 00514000
*   IF PARMLEN>31                   /*                       @OZ05079*/ 00515000
*     THEN                                                         0229 00516000
         LH    @06,PARMLEN(,PARMPTR)                               0229 00517000
         C     @06,@CF00067                                        0229 00518000
         BNH   @RF00229                                            0229 00519000
*     DO;                           /* IF PARMS TOO LONG,SET ERROR 0230 00520000
*                                      AND GETOUT            @Y30LB40*/ 00521000
*       PARMERR='1'B;               /*                       @Y30LB40*/ 00522000
         OI    PARMERR,B'10000000'                                 0231 00523000
*       GO TO PARMEND;              /*                       @Y30LB40*/ 00524000
         B     PARMEND                                             0232 00525000
*     END;                          /*                       @Y30LB40*/ 00526000
*   PARMHOLD(1:1)=',';              /* SET PARMHOLD TO ALL COMMAS  0234 00527000
*                                                            @Y30LB40*/ 00528000
@RF00229 MVI   PARMHOLD,C','                                       0234 00529000
*   MVC(PARMHOLD(2:31),PARMHOLD);   /*                       @OZ05079*/ 00530000
         MVC   PARMHOLD+1(30),PARMHOLD                             0235 00531000
*   SS=1;                           /* SET SUBSTRING POINTER TO 1  0236 00532000
*                                                            @Y30LB40*/ 00533000
         LA    SS,1                                                0236 00534000
*   PARMHOLD(1:PARMLEN)=PARMS;      /* MOVE PARMS TO PARMHOLD      0237 00535000
*                                                            @Y30LB40*/ 00536000
         LH    @06,PARMLEN(,PARMPTR)                               0237 00537000
         BCTR  @06,0                                               0237 00538000
         EX    @06,@SM00832                                        0237 00539000
*                                                                  0238 00540000
*/********************************************************** @OZ11673*/ 00541000
*/*                                                          @OZ11673*/ 00542000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00543000
*/*                                                          @OZ11673*/ 00544000
*/* FUNCTION - SCAN FOR EITHER 'D' (SDG REPORT)              @ZA16140*/ 00545000
*/*            OR 'R' (DATA RECORDING DEVICE REPORT) IN THE  @OZ11673*/ 00546000
*/*            FIRST PARAMETER.  (IF NEITHER SPECIFIED, 'D'  @OZ11673*/ 00547000
*/*            IS DEFAULTED.)  IF AN ERROR IS FOUND, SCAN OF @OZ11673*/ 00548000
*/*            PARAMETERS IS DISCONTINUED.                   @OZ11673*/ 00549000
*/*                                                          @OZ11673*/ 00550000
*/********************************************************** @OZ11673*/ 00551000
*                                                                  0238 00552000
*   IF PARMHOLD(1:1)=','            /* WAS REPORT SELECTOR ENTERED 0238 00553000
*                                                            @Y30LB40*/ 00554000
*     THEN                                                         0238 00555000
         CLI   PARMHOLD,C','                                       0238 00556000
         BNE   @RF00238                                            0238 00557000
*     SS=2;                         /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00558000
         LA    SS,2                                                0239 00559000
*   ELSE                                                           0240 00560000
*     DO;                           /* YES,CHECK FOR D OR R  @Y30LB40*/ 00561000
         B     @RC00238                                            0240 00562000
@RF00238 DS    0H                                                  0241 00563000
*       IF PARMHOLD(1:1)='D'|PARMHOLD(1:1)='R' THEN                0241 00564000
         CLI   PARMHOLD,C'D'                                       0241 00565000
         BE    @RT00241                                            0241 00566000
         CLI   PARMHOLD,C'R'                                       0241 00567000
         BNE   @RF00241                                            0241 00568000
@RT00241 DS    0H                                                  0242 00569000
*         DO;                       /*                       @Y30LB40*/ 00570000
*           PARMSW=PARMHOLD(1:1);   /* SELECTOR OK SAVE IT   @Y30LB40*/ 00571000
         MVC   PARMSW(1),PARMHOLD                                  0243 00572000
*           SS=3;                   /* BUMP POINTER TO NEXT VALUE    */ 00573000
         LA    SS,3                                                0244 00574000
*         END;                      /*                       @Y30LB40*/ 00575000
*       ELSE                                                       0246 00576000
*         DO;                       /*                       @Y30LB40*/ 00577000
         B     @RC00241                                            0246 00578000
@RF00241 DS    0H                                                  0247 00579000
*           PARMERR='1'B;           /* INVALID SELECTOR,ERROR        */ 00580000
         OI    PARMERR,B'10000000'                                 0247 00581000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00582000
         B     PARMEND                                             0248 00583000
*         END;                      /*                       @Y30LB40*/ 00584000
*     END;                          /*                       @Y30LB40*/ 00585000
@RC00241 DS    0H                                                  0251 00586000
*                                                                  0251 00587000
*/********************************************************** @OZ11673*/ 00588000
*/*                                                          @OZ11673*/ 00589000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00590000
*/*                                                          @OZ11673*/ 00591000
*/* FUNCTION - SCAN FOR THE TIME SLICE SPECIFIED IN MINUTES. @OZ11673*/ 00592000
*/*            (IF NO TIMESLICE IS SPECIFIED, DEFAULT IS     @OZ11673*/ 00593000
*/*            010.)  IF AN ERROR IS FOUND, SCAN OF          @OZ11673*/ 00594000
*/*            PARAMETERS IS DISCONTINUED.                   @OZ11673*/ 00595000
*/*                                                          @OZ11673*/ 00596000
*/********************************************************** @OZ11673*/ 00597000
*                                                                  0251 00598000
*   IF PARMHOLD(SS:SS)=','          /* WAS TIME SLICE ENTERED      0251 00599000
*                                                            @Y30LB40*/ 00600000
*     THEN                                                         0251 00601000
@RC00238 LA    @06,PARMHOLD-1(SS)                                  0251 00602000
         CLI   0(@06),C','                                         0251 00603000
         BNE   @RF00251                                            0251 00604000
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00605000
         AL    SS,@CF00044                                         0252 00606000
*   ELSE                                                           0253 00607000
*     DO;                           /* YES,CHECK TIME SLICE  @Y30LB40*/ 00608000
         B     @RC00251                                            0253 00609000
@RF00251 DS    0H                                                  0254 00610000
*       DO I=SS TO(SS+2);           /* CHECK FOR NON NUMERICS      0254 00611000
*                                                            @Y30LB40*/ 00612000
         LR    I,SS                                                0254 00613000
         B     @DE00254                                            0254 00614000
@DL00254 DS    0H                                                  0255 00615000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0255 00616000
         LA    @03,PARMHOLD-1(I)                                   0255 00617000
         CLI   0(@03),C'0'                                         0255 00618000
         BL    @RF00255                                            0255 00619000
         LA    @03,PARMHOLD-1(I)                                   0255 00620000
         CLI   0(@03),C'9'                                         0255 00621000
         BNH   @RT00255                                            0255 00622000
*           ;                       /*                       @Y30LB40*/ 00623000
*         ELSE                                                     0257 00624000
*           PARMERR='1'B;           /* NON NUMERIC FOUND,ERROR     0257 00625000
*                                                            @Y30LB40*/ 00626000
@RF00255 OI    PARMERR,B'10000000'                                 0257 00627000
*       END;                        /*                       @Y30LB40*/ 00628000
@RT00255 AL    I,@CF00044                                          0258 00629000
@DE00254 LA    @03,2                                               0258 00630000
         ALR   @03,SS                                              0258 00631000
         CR    I,@03                                               0258 00632000
         BNH   @DL00254                                            0258 00633000
*       IF PARMERR='1'B THEN                                       0259 00634000
         TM    PARMERR,B'10000000'                                 0259 00635000
         BO    @RT00259                                            0259 00636000
*         GO TO PARMEND;            /* IF ERRORS FOUND,GETOUT        */ 00637000
*       IF PARMHOLD(SS:SS+2)='000' THEN                            0261 00638000
         LA    @06,PARMHOLD-1(SS)                                  0261 00639000
         CLC   0(3,@06),@CC00717                                   0261 00640000
         BNE   @RF00261                                            0261 00641000
*         DO;                       /*                       @Y30LB40*/ 00642000
*           PARMERR='1'B;           /* TIME SLICE CANNOT BE 000,ERROR*/ 00643000
         OI    PARMERR,B'10000000'                                 0263 00644000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00645000
         B     PARMEND                                             0264 00646000
*         END;                      /*                       @Y30LB40*/ 00647000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+2));/*                  @Y30LB40*/ 00648000
@RF00261 LA    @06,PARMHOLD-1(SS)                                  0266 00649000
         PACK  DOUBLEWD(8),0(3,@06)                                0266 00650000
*       CVB(TIMESL,DOUBLEWD);       /*                       @Y30LB40*/ 00651000
         CVB   @06,DOUBLEWD                                        0267 00652000
         ST    @06,TIMESL                                          0267 00653000
*       TIMESL=TIMESL*60;           /* CONVERT TIME SLICE TO SECONDS    00654000
*                                                            @Y30LB40*/ 00655000
         MH    @06,@CH00335                                        0268 00656000
         ST    @06,TIMESL                                          0268 00657000
*       SS=SS+4;                    /*                       @Y30LB40*/ 00658000
         AL    SS,@CF00104                                         0269 00659000
*     END;                          /*                       @Y30LB40*/ 00660000
*                                                                  0271 00661000
*/********************************************************** @OZ11673*/ 00662000
*/*                                                          @OZ11673*/ 00663000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00664000
*/*                                                          @OZ11673*/ 00665000
*/* FUNCTION - SCAN FOR JULIAN DATES.                        @OZ11673*/ 00666000
*/*                                                          @OZ11673*/ 00667000
*/********************************************************** @OZ11673*/ 00668000
*                                                                  0271 00669000
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/ 00670000
*     THEN                                                         0271 00671000
@RC00251 LA    @06,PARMHOLD-1(SS)                                  0271 00672000
         CLI   0(@06),C','                                         0271 00673000
         BNE   @RF00271                                            0271 00674000
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00675000
         AL    SS,@CF00044                                         0272 00676000
*   ELSE                                                           0273 00677000
*     DO;                           /* YES,CHECK DATES       @Y30LB40*/ 00678000
         B     @RC00271                                            0273 00679000
@RF00271 DS    0H                                                  0274 00680000
*       DO I=SS TO(SS+9);           /* CHECK FOR NON NUMERICS      0274 00681000
*                                                            @Y30LB40*/ 00682000
         LR    I,SS                                                0274 00683000
         B     @DE00274                                            0274 00684000
@DL00274 DS    0H                                                  0275 00685000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0275 00686000
         LA    @03,PARMHOLD-1(I)                                   0275 00687000
         CLI   0(@03),C'0'                                         0275 00688000
         BL    @RF00275                                            0275 00689000
         LA    @03,PARMHOLD-1(I)                                   0275 00690000
         CLI   0(@03),C'9'                                         0275 00691000
         BNH   @RT00275                                            0275 00692000
*           ;                       /*                       @Y30LB40*/ 00693000
*         ELSE                                                     0277 00694000
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0277 00695000
*                                                            @Y30LB40*/ 00696000
@RF00275 OI    PARMERR,B'10000000'                                 0277 00697000
*       END;                        /*                       @Y30LB40*/ 00698000
@RT00275 AL    I,@CF00044                                          0278 00699000
@DE00274 LA    @03,9                                               0278 00700000
         ALR   @03,SS                                              0278 00701000
         CR    I,@03                                               0278 00702000
         BNH   @DL00274                                            0278 00703000
*       IF PARMERR='1'B THEN                                       0279 00704000
         TM    PARMERR,B'10000000'                                 0279 00705000
         BO    @RT00279                                            0279 00706000
*         GO TO PARMEND;            /* IF ERRORS FOUND GETOUT        */ 00707000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT DATES    @Y30LB40*/ 00708000
         LA    @06,PARMHOLD-1(SS)                                  0281 00709000
         PACK  DOUBLEWD(8),0(2,@06)                                0281 00710000
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/ 00711000
         CVB   @06,DOUBLEWD                                        0282 00712000
         STC   @06,HLDSYR                                          0282 00713000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/ 00714000
         LA    @06,PARMHOLD+1(SS)                                  0283 00715000
         PACK  DOUBLEWD(8),0(3,@06)                                0283 00716000
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00717000
         CVB   @06,DOUBLEWD                                        0284 00718000
         STH   @06,HLDSDAY                                         0284 00719000
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/ 00720000
         LA    @03,PARMHOLD+4(SS)                                  0285 00721000
         PACK  DOUBLEWD(8),0(2,@03)                                0285 00722000
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/ 00723000
         CVB   @03,DOUBLEWD                                        0286 00724000
         STC   @03,HLDEYR                                          0286 00725000
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/ 00726000
         LA    @03,PARMHOLD+6(SS)                                  0287 00727000
         PACK  DOUBLEWD(8),0(3,@03)                                0287 00728000
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00729000
         CVB   @03,DOUBLEWD                                        0288 00730000
         STH   @03,HLDEDAY                                         0288 00731000
*       IF HLDSDAY>0&HLDSDAY<366    /* CHECK FOR VALID DAY   @Y30LB40*/ 00732000
*         THEN                                                     0289 00733000
         LTR   @06,@06                                             0289 00734000
         BNP   @RF00289                                            0289 00735000
         C     @06,@CF00720                                        0289 00736000
         BL    @RT00289                                            0289 00737000
*         ;                         /*                       @Y30LB40*/ 00738000
*       ELSE                                                       0291 00739000
*         DO;                       /*                       @Y30LB40*/ 00740000
@RF00289 DS    0H                                                  0292 00741000
*           IF HLDSDAY=366 THEN                                    0292 00742000
         CLC   HLDSDAY(2),@CH00720                                 0292 00743000
         BNE   @RF00292                                            0292 00744000
*             DO;                   /* CHECK FOR LEAP YEAR   @Y30LB40*/ 00745000
*               IF(CKSTIME(1:1)&'00000011'B)¬='00000000'B THEN     0294 00746000
         MVC   @TS00001(1),CKSTIME                                 0294 00747000
         NI    @TS00001,B'00000011'                                0294 00748000
         CLI   @TS00001,B'00000000'                                0294 00749000
         BE    @RF00294                                            0294 00750000
*                 PARMERR='1'B;     /* ERROR,BAD DAY         @Y30LB40*/ 00751000
         OI    PARMERR,B'10000000'                                 0295 00752000
*             END;                  /*                       @Y30LB40*/ 00753000
*           ELSE                                                   0297 00754000
*             PARMERR='1'B;         /* ERROR,BAD DAY         @Y30LB40*/ 00755000
         B     @RC00292                                            0297 00756000
@RF00292 OI    PARMERR,B'10000000'                                 0297 00757000
*         END;                      /*                       @Y30LB40*/ 00758000
@RC00292 DS    0H                                                  0299 00759000
*       IF HLDEDAY>0&HLDEDAY<366    /* SAME AS FOR START DAY         */ 00760000
*         THEN                                                     0299 00761000
@RT00289 LH    @06,HLDEDAY                                         0299 00762000
         LTR   @06,@06                                             0299 00763000
         BNP   @RF00299                                            0299 00764000
         C     @06,@CF00720                                        0299 00765000
         BL    @RT00299                                            0299 00766000
*         ;                         /*                       @Y30LB40*/ 00767000
*       ELSE                                                       0301 00768000
*         DO;                       /*                       @Y30LB40*/ 00769000
@RF00299 DS    0H                                                  0302 00770000
*           IF HLDEDAY=366 THEN                                    0302 00771000
         CLC   HLDEDAY(2),@CH00720                                 0302 00772000
         BNE   @RF00302                                            0302 00773000
*             DO;                   /*                       @Y30LB40*/ 00774000
*               IF(CKETIME(1:1)&'00000011'B)¬='00000000'B THEN     0304 00775000
         MVC   @TS00001(1),CKETIME                                 0304 00776000
         NI    @TS00001,B'00000011'                                0304 00777000
         CLI   @TS00001,B'00000000'                                0304 00778000
         BE    @RF00304                                            0304 00779000
*                 PARMERR='1'B;     /*                       @Y30LB40*/ 00780000
         OI    PARMERR,B'10000000'                                 0305 00781000
*             END;                  /*                       @Y30LB40*/ 00782000
*           ELSE                                                   0307 00783000
*             PARMERR='1'B;         /*                       @Y30LB40*/ 00784000
         B     @RC00302                                            0307 00785000
@RF00302 OI    PARMERR,B'10000000'                                 0307 00786000
*         END;                      /*                       @Y30LB40*/ 00787000
@RC00302 DS    0H                                                  0309 00788000
*       IF HLDSYR<=HLDEYR           /* START YEAR MUST BE <= END YEAR   00789000
*                                                            @Y30LB40*/ 00790000
*         THEN                                                     0309 00791000
@RT00299 CLC   HLDSYR(1),HLDEYR                                    0309 00792000
         BNH   @RT00309                                            0309 00793000
*         ;                         /*                       @Y30LB40*/ 00794000
*       ELSE                                                       0311 00795000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00796000
         OI    PARMERR,B'10000000'                                 0311 00797000
*       IF HLDSDAY<=HLDEDAY         /* CHECK YEARS AND DAYS TOGETHER */ 00798000
*         THEN                                                     0312 00799000
@RT00309 LH    @06,HLDSDAY                                         0312 00800000
         CH    @06,HLDEDAY                                         0312 00801000
         BNH   @RT00312                                            0312 00802000
*         ;                         /*                       @Y30LB40*/ 00803000
*       ELSE                                                       0314 00804000
*         DO;                       /*                       @Y30LB40*/ 00805000
*           IF HLDSYR=HLDEYR THEN                                  0315 00806000
         CLC   HLDSYR(1),HLDEYR                                    0315 00807000
         BNE   @RF00315                                            0315 00808000
*             PARMERR='1'B;         /*                       @Y30LB40*/ 00809000
         OI    PARMERR,B'10000000'                                 0316 00810000
*         END;                      /*                       @Y30LB40*/ 00811000
@RF00315 DS    0H                                                  0318 00812000
*       IF PARMERR='1'B THEN                                       0318 00813000
@RT00312 TM    PARMERR,B'10000000'                                 0318 00814000
         BO    @RT00318                                            0318 00815000
*         GO TO PARMEND;            /* IF ERRORS FOUND,GETOUT        */ 00816000
*       DATEINSW='1'B;              /* DATES VALID,SET INDICATOR   0320 00817000
*                                                            @Y30LB40*/ 00818000
         OI    DATEINSW,B'10000000'                                0320 00819000
*       SS=SS+11;                   /* BUMP TO NEXT VALUE    @Y30LB40*/ 00820000
         AL    SS,@CF00033                                         0321 00821000
*     END;                          /*                       @Y30LB40*/ 00822000
*                                                                  0323 00823000
*/********************************************************** @OZ11673*/ 00824000
*/*                                                          @OZ11673*/ 00825000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00826000
*/*                                                          @OZ11673*/ 00827000
*/* FUNCTION - SCAN FOR TIME-OF-DAY PARAMETER                @OZ11673*/ 00828000
*/*                                                          @OZ11673*/ 00829000
*/********************************************************** @OZ11673*/ 00830000
*                                                                  0323 00831000
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/ 00832000
*     THEN                                                         0323 00833000
@RC00271 LA    @06,PARMHOLD-1(SS)                                  0323 00834000
         CLI   0(@06),C','                                         0323 00835000
         BNE   @RF00323                                            0323 00836000
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00837000
         AL    SS,@CF00044                                         0324 00838000
*   ELSE                                                           0325 00839000
*     DO;                           /* YES,CHECK TIMES       @Y30LB40*/ 00840000
         B     @RC00323                                            0325 00841000
@RF00323 DS    0H                                                  0326 00842000
*       DO I=SS TO(SS+7);           /* CHECK FOR NON NUMERICS      0326 00843000
*                                                            @Y30LB40*/ 00844000
         LR    I,SS                                                0326 00845000
         B     @DE00326                                            0326 00846000
@DL00326 DS    0H                                                  0327 00847000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0327 00848000
         LA    @03,PARMHOLD-1(I)                                   0327 00849000
         CLI   0(@03),C'0'                                         0327 00850000
         BL    @RF00327                                            0327 00851000
         LA    @03,PARMHOLD-1(I)                                   0327 00852000
         CLI   0(@03),C'9'                                         0327 00853000
         BNH   @RT00327                                            0327 00854000
*           ;                       /*                       @Y30LB40*/ 00855000
*         ELSE                                                     0329 00856000
*           PARMERR='1'B;           /* NON NUMERIC FOUND,ERROR     0329 00857000
*                                                            @Y30LB40*/ 00858000
@RF00327 OI    PARMERR,B'10000000'                                 0329 00859000
*       END;                        /*                       @Y30LB40*/ 00860000
@RT00327 AL    I,@CF00044                                          0330 00861000
@DE00326 LA    @03,7                                               0330 00862000
         ALR   @03,SS                                              0330 00863000
         CR    I,@03                                               0330 00864000
         BNH   @DL00326                                            0330 00865000
*       IF PARMERR='1'B THEN                                       0331 00866000
         TM    PARMERR,B'10000000'                                 0331 00867000
         BO    @RT00331                                            0331 00868000
*         GO TO PARMEND;            /*                       @Y30LB40*/ 00869000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/ 00870000
         LA    @06,PARMHOLD-1(SS)                                  0333 00871000
         PACK  DOUBLEWD(8),0(2,@06)                                0333 00872000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00873000
         CVB   TIMEWORK,DOUBLEWD                                   0334 00874000
*       IF TIMEWORK>23 THEN                                        0335 00875000
         C     TIMEWORK,@CF00723                                   0335 00876000
         BNH   @RF00335                                            0335 00877000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00878000
         OI    PARMERR,B'10000000'                                 0336 00879000
*       ELSE                                                       0337 00880000
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00881000
         B     @RC00335                                            0337 00882000
@RF00335 LR    @06,TIMEWORK                                        0337 00883000
         MH    @06,@CH00724                                        0337 00884000
         ST    @06,HLDSTIME                                        0337 00885000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/ 00886000
@RC00335 LA    @06,PARMHOLD+1(SS)                                  0338 00887000
         PACK  DOUBLEWD(8),0(2,@06)                                0338 00888000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00889000
         CVB   TIMEWORK,DOUBLEWD                                   0339 00890000
*       IF TIMEWORK>59 THEN                                        0340 00891000
         C     TIMEWORK,@CF00725                                   0340 00892000
         BNH   @RF00340                                            0340 00893000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00894000
         OI    PARMERR,B'10000000'                                 0341 00895000
*       ELSE                                                       0342 00896000
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/ 00897000
         B     @RC00340                                            0342 00898000
@RF00340 LR    @06,TIMEWORK                                        0342 00899000
         MH    @06,@CH00335                                        0342 00900000
         AL    @06,HLDSTIME                                        0342 00901000
         ST    @06,HLDSTIME                                        0342 00902000
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/ 00903000
@RC00340 LA    @06,PARMHOLD+3(SS)                                  0343 00904000
         PACK  DOUBLEWD(8),0(2,@06)                                0343 00905000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00906000
         CVB   TIMEWORK,DOUBLEWD                                   0344 00907000
*       IF TIMEWORK>23 THEN                                        0345 00908000
         C     TIMEWORK,@CF00723                                   0345 00909000
         BNH   @RF00345                                            0345 00910000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00911000
         OI    PARMERR,B'10000000'                                 0346 00912000
*       ELSE                                                       0347 00913000
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00914000
         B     @RC00345                                            0347 00915000
@RF00345 LR    @06,TIMEWORK                                        0347 00916000
         MH    @06,@CH00724                                        0347 00917000
         ST    @06,HLDETIME                                        0347 00918000
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/ 00919000
@RC00345 LA    @06,PARMHOLD+5(SS)                                  0348 00920000
         PACK  DOUBLEWD(8),0(2,@06)                                0348 00921000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00922000
         CVB   TIMEWORK,DOUBLEWD                                   0349 00923000
*       IF TIMEWORK>59 THEN                                        0350 00924000
         C     TIMEWORK,@CF00725                                   0350 00925000
         BNH   @RF00350                                            0350 00926000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00927000
         OI    PARMERR,B'10000000'                                 0351 00928000
*       ELSE                                                       0352 00929000
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/ 00930000
         B     @RC00350                                            0352 00931000
@RF00350 LR    @06,TIMEWORK                                        0352 00932000
         MH    @06,@CH00335                                        0352 00933000
         AL    @06,HLDETIME                                        0352 00934000
         AL    @06,@CF00725                                        0352 00935000
         ST    @06,HLDETIME                                        0352 00936000
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY THEN                      0353 00937000
@RC00350 CLC   HLDSYR(1),HLDEYR                                    0353 00938000
         BNE   @RF00353                                            0353 00939000
         CLC   HLDSDAY(2),HLDEDAY                                  0353 00940000
         BNE   @RF00353                                            0353 00941000
*         IF HLDSTIME>HLDETIME THEN                                0354 00942000
         L     @06,HLDSTIME                                        0354 00943000
         C     @06,HLDETIME                                        0354 00944000
         BNH   @RF00354                                            0354 00945000
*           PARMERR='1'B;           /*                       @Y30LB40*/ 00946000
         OI    PARMERR,B'10000000'                                 0355 00947000
*       IF PARMERR='0'B&DATEINSW='0'B THEN                         0356 00948000
@RF00354 DS    0H                                                  0356 00949000
@RF00353 TM    PARMERR,B'10000000'                                 0356 00950000
         BNZ   @RF00356                                            0356 00951000
         TM    DATEINSW,B'10000000'                                0356 00952000
         BNZ   @RF00356                                            0356 00953000
*         PARMERR='1'B;             /* IF DATES NOT ENTERED,ERROR  0357 00954000
*                                                            @Y30LB40*/ 00955000
         OI    PARMERR,B'10000000'                                 0357 00956000
*       SS=SS+9;                    /* OK SO FAR,BUMP TO NEXT VALUE     00957000
*                                                            @Y30LB40*/ 00958000
@RF00356 AL    SS,@CF00035                                         0358 00959000
*     END;                          /*                       @Y30LB40*/ 00960000
*                                                                  0360 00961000
*/********************************************************** @OZ11673*/ 00962000
*/*                                                          @OZ11673*/ 00963000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00964000
*/*                                                          @OZ11673*/ 00965000
*/* FUNCTION - SCAN FOR THE SSID OR SDG OF THE DEVICE        @ZA16140*/ 00966000
*/*            SELECTED FOR                                  @ZA16140*/ 00967000
*/*            THE REPORT TO BE PRODUCED.                    @OZ11673*/ 00968000
*/*                                                          @OZ11673*/ 00969000
*/********************************************************** @OZ11673*/ 00970000
*                                                                  0360 00971000
*   IF PARMERR='1'B THEN                                           0360 00972000
@RC00323 TM    PARMERR,B'10000000'                                 0360 00973000
         BO    @RT00360                                            0360 00974000
*     GO TO PARMEND;                /* IF ERRORS FOUND,GETOUT        */ 00975000
*   IF PARMHOLD(SS:SS)=','          /* WERE SDG OR LU ENTERED      0362 00976000
*                                                            @ZA16140*/ 00977000
*     THEN                                                         0362 00978000
         LA    @06,PARMHOLD-1(SS)                                  0362 00979000
         CLI   0(@06),C','                                         0362 00980000
         BE    @RT00362                                            0362 00981000
*     ;                             /* NO,FINISH PROCESS     @Y30LB40*/ 00982000
*   ELSE                                                           0364 00983000
*     DO;                           /* YES,CHECK VALUES      @Y30LB40*/ 00984000
*       SELECTSW='1'B;              /* SET SELECTOR SWITCH   @Y30LB40*/ 00985000
         OI    SELECTSW,B'10000000'                                0365 00986000
*       IF PARMSW='D'               /* IF SDG REPORT         @ZA16140*/ 00987000
*         THEN                                                     0366 00988000
         CLI   PARMSW,C'D'                                         0366 00989000
         BNE   @RF00366                                            0366 00990000
*         DO;                       /* CHECK FOR VALID SDG VALUES  0367 00991000
*                                                            @ZA16140*/ 00992000
*           IF((PARMHOLD(SS:SS+2)='SDG')&(PARMHOLD(SS+3:SS+3)>='0')&(   00993000
*               PARMHOLD(SS+3:SS+3)<='2')&(PARMHOLD(SS+4:SS+4)>='0')&(  00994000
*               PARMHOLD(SS+4:SS+4)<='9')&(PARMHOLD(SS+3:SS+4)<='27'))  00995000
*             THEN                                                 0368 00996000
         LA    @06,PARMHOLD-1(SS)                                  0368 00997000
         CLC   0(3,@06),@CC00726                                   0368 00998000
         BNE   @RF00368                                            0368 00999000
         LA    @06,PARMHOLD+2(SS)                                  0368 01000000
         CLI   0(@06),C'0'                                         0368 01001000
         BL    @RF00368                                            0368 01002000
         LA    @06,PARMHOLD+2(SS)                                  0368 01003000
         CLI   0(@06),C'2'                                         0368 01004000
         BH    @RF00368                                            0368 01005000
         LA    @06,PARMHOLD+3(SS)                                  0368 01006000
         CLI   0(@06),C'0'                                         0368 01007000
         BL    @RF00368                                            0368 01008000
         LA    @06,PARMHOLD+3(SS)                                  0368 01009000
         CLI   0(@06),C'9'                                         0368 01010000
         BH    @RF00368                                            0368 01011000
         LA    @06,PARMHOLD+2(SS)                                  0368 01012000
         CLC   0(2,@06),@CC00727                                   0368 01013000
         BH    @RF00368                                            0368 01014000
*             DO;                   /*                       @ZA16140*/ 01015000
*               PACK(DOUBLEWD,PARMHOLD(SS+3:SS+4));/*        @ZA16140*/ 01016000
         LA    @06,PARMHOLD+2(SS)                                  0370 01017000
         PACK  DOUBLEWD(8),0(2,@06)                                0370 01018000
*               CVB(SELSDG,DOUBLEWD);/*                      @ZA16140*/ 01019000
         CVB   @06,DOUBLEWD                                        0371 01020000
         STC   @06,SELSDG                                          0371 01021000
*             END;                  /*                       @ZA16140*/ 01022000
*           ELSE                                                   0373 01023000
*             DO;                   /*                       @ZA16140*/ 01024000
         B     @RC00368                                            0373 01025000
@RF00368 DS    0H                                                  0374 01026000
*               PARMERR='1'B;       /*                       @ZA16140*/ 01027000
         OI    PARMERR,B'10000000'                                 0374 01028000
*               GO TO PARMEND;      /*                       @ZA16140*/ 01029000
         B     PARMEND                                             0375 01030000
*             END;                  /*                       @ZA16140*/ 01031000
*         END;                      /*                       @ZA16140*/ 01032000
*       ELSE                                                       0378 01033000
*         DO;                       /* CHECK LIBRARY AND RWU @Y30LB40*/ 01034000
         B     @RC00366                                            0378 01035000
@RF00366 DS    0H                                                  0379 01036000
*           IF PARMHOLD(SS:SS)¬='2' /* 1ST DIGIT ALWAYS 2    @OZ05079*/ 01037000
*             THEN                  /*                       @OZ05079*/ 01038000
         LA    @06,PARMHOLD-1(SS)                                  0379 01039000
         CLI   0(@06),C'2'                                         0379 01040000
         BE    @RF00379                                            0379 01041000
*             DO;                   /*                       @OZ05079*/ 01042000
*               PARMERR='1'B;       /*                       @OZ05079*/ 01043000
         OI    PARMERR,B'10000000'                                 0381 01044000
*               GO TO PARMEND;      /*                       @OZ05079*/ 01045000
         B     PARMEND                                             0382 01046000
*             END;                  /*                       @OZ05079*/ 01047000
*           IF PARMHOLD(SS+1:SS+1)='0'/* MSF = 0             @OZ05079*/ 01048000
*               |PARMHOLD(SS+1:SS+1)='1'/* MSF = 1           @OZ05079*/ 01049000
*             THEN                                                 0384 01050000
@RF00379 LA    @06,PARMHOLD(SS)                                    0384 01051000
         CLI   0(@06),C'0'                                         0384 01052000
         BE    @RT00384                                            0384 01053000
         LA    @06,PARMHOLD(SS)                                    0384 01054000
         CLI   0(@06),C'1'                                         0384 01055000
         BNE   @RF00384                                            0384 01056000
@RT00384 DS    0H                                                  0385 01057000
*             DO;                   /*                       @Y30LB40*/ 01058000
*               PACK(DOUBLEWD,PARMHOLD(SS+1:SS+1));/* LIB OK @OZ05079*/ 01059000
         LA    @06,PARMHOLD(SS)                                    0386 01060000
         PACK  DOUBLEWD(8),0(1,@06)                                0386 01061000
*               CVB(L,DOUBLEWD);    /*                       @Y30LB40*/ 01062000
         CVB   L,DOUBLEWD                                          0387 01063000
*             END;                  /*                       @Y30LB40*/ 01064000
*           ELSE                                                   0389 01065000
*             DO;                   /*                       @Y30LB40*/ 01066000
         B     @RC00384                                            0389 01067000
@RF00384 DS    0H                                                  0390 01068000
*               PARMERR='1'B;       /* LIB BAD,SET ERROR     @Y30LB40*/ 01069000
         OI    PARMERR,B'10000000'                                 0390 01070000
*               GO TO PARMEND;      /*                       @Y30LB40*/ 01071000
         B     PARMEND                                             0391 01072000
*             END;                  /*                       @Y30LB40*/ 01073000
*           IF PARMHOLD(SS+2:SS+2)>='0'/* VALID RANGE        @OZ05079*/ 01074000
*               &PARMHOLD(SS+2:SS+2)<='7'/*                  @OZ05079*/ 01075000
*             THEN                                                 0393 01076000
@RC00384 LA    @06,PARMHOLD+1(SS)                                  0393 01077000
         CLI   0(@06),C'0'                                         0393 01078000
         BL    @RF00393                                            0393 01079000
         LA    @06,PARMHOLD+1(SS)                                  0393 01080000
         CLI   0(@06),C'7'                                         0393 01081000
         BH    @RF00393                                            0393 01082000
*             DO;                   /*                       @Y30LB40*/ 01083000
*               PACK(DOUBLEWD,PARMHOLD(SS+2:SS+2));/* RWU OK @OZ05079*/ 01084000
         LA    @06,PARMHOLD+1(SS)                                  0395 01085000
         PACK  DOUBLEWD(8),0(1,@06)                                0395 01086000
*               CVB(U,DOUBLEWD);    /*                       @Y30LB40*/ 01087000
         CVB   U,DOUBLEWD                                          0396 01088000
*             END;                  /*                       @Y30LB40*/ 01089000
*           ELSE                                                   0398 01090000
*             DO;                   /*                       @Y30LB40*/ 01091000
         B     @RC00393                                            0398 01092000
@RF00393 DS    0H                                                  0399 01093000
*               PARMERR='1'B;       /* RWU BAD,SET ERROR     @Y30LB40*/ 01094000
         OI    PARMERR,B'10000000'                                 0399 01095000
*               GO TO PARMEND;      /*                       @Y30LB40*/ 01096000
         B     PARMEND                                             0400 01097000
*             END;                  /*                       @Y30LB40*/ 01098000
*         END;                      /*                       @Y30LB40*/ 01099000
@RC00393 DS    0H                                                  0403 01100000
*     END;                          /*                       @Y30LB40*/ 01101000
@RC00366 DS    0H                                                  0404 01102000
*                                                                  0404 01103000
*/********************************************************** @OZ11673*/ 01104000
*/*                                                          @OZ11673*/ 01105000
*/* PROCEDURE NAME - PARMEND (SUBSECTION WITHIN GETPARMS)    @OZ11673*/ 01106000
*/*                                                          @OZ11673*/ 01107000
*/* FUNCTION - TEST FOR ERROR INDICATOR FOR BAD SCAN OF A    @OZ11673*/ 01108000
*/*            PARAMETER.  IF ERROR WAS ENCOUNTERED, SET     @OZ11673*/ 01109000
*/*            UP ERROR MESSAGE ICG910, SET RETURN CODE TO   @OZ11673*/ 01110000
*/*            8.  IN ANY CASE, RETURN TO MAINLINE.          @OZ11673*/ 01111000
*/*                                                          @OZ11673*/ 01112000
*/********************************************************** @OZ11673*/ 01113000
*                                                                  0404 01114000
*PARMEND:                                                          0404 01115000
*   IF PARMERR='1'B                 /* WERE THERE ANY ERRORS @Y30LB40*/ 01116000
*     THEN                                                         0404 01117000
@RT00362 DS    0H                                                  0404 01118000
PARMEND  TM    PARMERR,B'10000000'                                 0404 01119000
         BNO   @RF00404                                            0404 01120000
*     DO;                           /* YES,PRINT MESSAGE     @Y30LB40*/ 01121000
*       DSLINE=PARMMSG;             /*                       @Y30LB40*/ 01122000
         MVI   DSLINE+28,C' '                                      0406 01123000
         MVC   DSLINE+29(96),DSLINE+28                             0406 01124000
         MVC   DSLINE(28),PARMMSG                                  0406 01125000
*       RFY                                                        0407 01126000
*        (R0,                                                      0407 01127000
*         R1,                                                      0407 01128000
*         R14,                                                     0407 01129000
*         R15) RSTD;                /*                       @Y30LB40*/ 01130000
*       GEN(PUT   PRNTDCB,DSLINE);  /*                       @Y30LB40*/ 01131000
         PUT   PRNTDCB,DSLINE                                           01132000
*       RFY                                                        0409 01133000
*        (R0,                                                      0409 01134000
*         R1,                                                      0409 01135000
*         R14,                                                     0409 01136000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01137000
*       RETURNCD=8;                 /* SET RC=8 AND TERMINATE      0410 01138000
*                                                            @Y30LB40*/ 01139000
         MVC   RETURNCD(2),@CH00069                                0410 01140000
*     END;                          /*                       @Y30LB40*/ 01141000
*   END GETPARMS;                   /*                       @OZ11673*/ 01142000
@EL00004 DS    0H                                                  0412 01143000
@EF00004 DS    0H                                                  0412 01144000
@ER00004 LM    @14,@06,@SA00004                                    0412 01145000
         LM    @09,@12,@SA00004+36                                 0412 01146000
         BR    @14                                                 0412 01147000
*                                                                  0413 01148000
*/********************************************************** @OZ11673*/ 01149000
*/*                                                          @OZ11673*/ 01150000
*/* PROCEDURE NAME - DSACCUM                                 @OZ11673*/ 01151000
*/*                                                          @OZ11673*/ 01152000
*/* FUNCTION - ACCUUMLATE TOTALS FROM THE DETAIL ACTIVITY    @OZ11673*/ 01153000
*/*            WITHIN A TIME SLICE FOR THE SDG               @ZA16140*/ 01154000
*/*            ACTIVITY REPORT.                              @OZ11673*/ 01155000
*/*                                                          @OZ11673*/ 01156000
*/********************************************************** @OZ11673*/ 01157000
*                                                                  0413 01158000
*DSACCUM:                                                          0413 01159000
*   PROCEDURE;                      /*                       @OZ11673*/ 01160000
DSACCUM  STM   @14,@12,@SA00005                                    0413 01161000
*   J=1;                            /* SET ARRAY POINTER     @ZA16140*/ 01162000
         LA    @06,1                                               0414 01163000
         LR    J,@06                                               0414 01164000
*   K=SDGINBIN+1;                   /* SET ARRAY POINTER     @ZA16140*/ 01165000
         SLR   K,K                                                 0415 01166000
         IC    K,SDGINBIN                                          0415 01167000
         ALR   K,@06                                               0415 01168000
*   IF K>8 THEN                                                    0416 01169000
         C     K,@CF00069                                          0416 01170000
         BNH   @RF00416                                            0416 01171000
*     K=K+1;                        /* BYPASS INDEX 9        @ZA16140*/ 01172000
         ALR   K,@06                                               0417 01173000
*   DO I=1 TO 2;                    /* ACCUM TIME SLICE AND REPORT 0418 01174000
*                                      TOTALS                @Y30LB40*/ 01175000
@RF00416 LA    I,1                                                 0418 01176000
@DL00418 DS    0H                                                  0419 01177000
*     CALL BUCKETS;                                                0419 01178000
         BAL   @14,BUCKETS                                         0419 01179000
*     DSBKT6(I,J,K)=DSBKT6(I,J,K)+MININUM;/* NUMBER OF MINI HDRS     */ 01180000
         LR    @15,I                                               0420 01181000
         ALR   @15,@15                                             0420 01182000
         ALR   @15,J                                               0420 01183000
         MH    @15,@CH00643                                        0420 01184000
         ALR   @15,K                                               0420 01185000
         SLA   @15,2                                               0420 01186000
         SLR   @14,@14                                             0420 01187000
         IC    @14,MININUM                                         0420 01188000
         AL    @14,DSBKT6-352(@15)                                 0420 01189000
         ST    @14,DSBKT6-352(@15)                                 0420 01190000
*     DSBKT7(I,J,K)=DSBKT7(I,J,K)+HITNUM;/* NUMBER OF PRELOADS       */ 01191000
         SLR   @14,@14                                             0421 01192000
         IC    @14,HITNUM                                          0421 01193000
         AL    @14,DSBKT7-352(@15)                                 0421 01194000
         ST    @14,DSBKT7-352(@15)                                 0421 01195000
*   END;                            /*                       @Y30LB40*/ 01196000
         AL    I,@CF00044                                          0422 01197000
         C     I,@CF00051                                          0422 01198000
         BNH   @DL00418                                            0422 01199000
*   END DSACCUM;                    /* GO READ NEXT RECORD   @Y30LB40*/ 01200000
@EL00005 DS    0H                                                  0423 01201000
@EF00005 DS    0H                                                  0423 01202000
@ER00005 LM    @14,@12,@SA00005                                    0423 01203000
         BR    @14                                                 0423 01204000
*                                                                  0424 01205000
*/********************************************************** @OZ11673*/ 01206000
*/*                                                          @OZ11673*/ 01207000
*/* PROCEDURE NAME - DATETIME                                @OZ11673*/ 01208000
*/*                                                          @OZ11673*/ 01209000
*/* FUNCTION - SET UP DATE AND TIME IN THE FIRST LINE OF     @OZ11673*/ 01210000
*/*            THE TIMESLICE SUMMARY FOR EITHER A STAGING    @OZ11673*/ 01211000
*/*            ADAPTER ACTIVITY REPORT OR A DATA RECORDING   @OZ11673*/ 01212000
*/*            DEVICE ACTIVITY REPORT.                       @OZ11673*/ 01213000
*/*                                                          @OZ11673*/ 01214000
*/********************************************************** @OZ11673*/ 01215000
*                                                                  0424 01216000
*DATETIME:                                                         0424 01217000
*   PROCEDURE;                      /*                       @OZ11673*/ 01218000
DATETIME STM   @14,@12,@SA00006                                    0424 01219000
*   DSLINE=' ';                     /* CLEAR PRINT LINE      @Y30LB40*/ 01220000
         MVI   DSLINE+1,C' '                                       0425 01221000
         MVC   DSLINE+2(123),DSLINE+1                              0425 01222000
         MVI   DSLINE,C' '                                         0425 01223000
*   FLD1='0';                       /*                       @OZ11673*/ 01224000
         MVI   FLD1,C'0'                                           0426 01225000
*   FLD2='  /   ';                  /*                       @OZ11673*/ 01226000
         MVC   FLD2(6),@CC00737                                    0427 01227000
*   CALL EDITFIX(ADDR(TSSYR),1,'N');/*                       @Y30LB40*/ 01228000
         MVC   @AL00001+4(8),@AL00428                              0428 01229000
         LA    @08,TSSYR                                           0428 01230000
         ST    @08,@AFTEMPS                                        0428 01231000
         LA    @08,@AFTEMPS                                        0428 01232000
         ST    @08,@AL00001                                        0428 01233000
         LA    @01,@AL00001                                        0428 01234000
         BAL   @14,EDITFIX                                         0428 01235000
*   FLD2(1:2)=FIXOUT(12:13);        /*                       @OZ11673*/ 01236000
         MVC   FLD2(2),FIXOUT+11                                   0429 01237000
*   CALL EDITFIX(ADDR(TSSDAY),2,'N');/*                      @Y30LB40*/ 01238000
         MVC   @AL00001+4(8),@AL00430                              0430 01239000
         LA    @08,TSSDAY                                          0430 01240000
         ST    @08,@AFTEMPS                                        0430 01241000
         LA    @08,@AFTEMPS                                        0430 01242000
         ST    @08,@AL00001                                        0430 01243000
         LA    @01,@AL00001                                        0430 01244000
         BAL   @14,EDITFIX                                         0430 01245000
*   FLD2(4:6)=FIXOUT(11:13);        /*                       @OZ11673*/ 01246000
         MVC   FLD2+3(3),FIXOUT+10                                 0431 01247000
*   HOUR=TSSTIME/3600;              /*                       @Y30LB40*/ 01248000
         L     @08,TSSTIME                                         0432 01249000
         LA    @15,3600                                            0432 01250000
         LR    @00,@08                                             0432 01251000
         SRDA  @00,32                                              0432 01252000
         DR    @00,@15                                             0432 01253000
         ST    @01,HOUR                                            0432 01254000
*   MINUTE=(TSSTIME-(HOUR*3600))/60;/*                       @Y30LB40*/ 01255000
         LA    @14,60                                              0433 01256000
         MR    @00,@15                                             0433 01257000
         LR    @02,@08                                             0433 01258000
         SLR   @02,@01                                             0433 01259000
         SRDA  @02,32                                              0433 01260000
         DR    @02,@14                                             0433 01261000
         ST    @03,MINUTE                                          0433 01262000
*   SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));/*              @Y30LB40*/ 01263000
         MR    @02,@14                                             0434 01264000
         ALR   @01,@03                                             0434 01265000
         SLR   @08,@01                                             0434 01266000
         ST    @08,SECOND                                          0434 01267000
*   FLD2A='  :  :  ';               /*                       @OZ11673*/ 01268000
         MVC   FLD2A(8),@CC00740                                   0435 01269000
*   CALL EDITFIX(ADDR(HOUR),4,'S'); /*                       @Y30LB40*/ 01270000
         MVC   @AL00001+4(8),@AL00436                              0436 01271000
         LA    @08,HOUR                                            0436 01272000
         ST    @08,@AFTEMPS                                        0436 01273000
         LA    @08,@AFTEMPS                                        0436 01274000
         ST    @08,@AL00001                                        0436 01275000
         LA    @01,@AL00001                                        0436 01276000
         BAL   @14,EDITFIX                                         0436 01277000
*   FLD2A(1:2)=FIXOUT(12:13);       /*                       @OZ11673*/ 01278000
         MVC   FLD2A(2),FIXOUT+11                                  0437 01279000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 01280000
         MVC   @AL00001+4(8),@AL00438                              0438 01281000
         LA    @08,MINUTE                                          0438 01282000
         ST    @08,@AFTEMPS                                        0438 01283000
         LA    @08,@AFTEMPS                                        0438 01284000
         ST    @08,@AL00001                                        0438 01285000
         LA    @01,@AL00001                                        0438 01286000
         BAL   @14,EDITFIX                                         0438 01287000
*   FLD2A(4:5)=FIXOUT(12:13);       /*                       @OZ11673*/ 01288000
         MVC   FLD2A+3(2),FIXOUT+11                                0439 01289000
*   CALL EDITFIX(ADDR(SECOND),4,'N');/*                      @Y30LB40*/ 01290000
         MVC   @AL00001+4(8),@AL00440                              0440 01291000
         LA    @08,SECOND                                          0440 01292000
         ST    @08,@AFTEMPS                                        0440 01293000
         LA    @08,@AFTEMPS                                        0440 01294000
         ST    @08,@AL00001                                        0440 01295000
         LA    @01,@AL00001                                        0440 01296000
         BAL   @14,EDITFIX                                         0440 01297000
*   FLD2A(7:8)=FIXOUT(12:13);       /*                       @OZ11673*/ 01298000
         MVC   FLD2A+6(2),FIXOUT+11                                0441 01299000
*   END DATETIME;                   /*                       @OZ11673*/ 01300000
@EL00006 DS    0H                                                  0442 01301000
@EF00006 DS    0H                                                  0442 01302000
@ER00006 LM    @14,@12,@SA00006                                    0442 01303000
         BR    @14                                                 0442 01304000
*                                                                  0443 01305000
*/********************************************************** @OZ11673*/ 01306000
*/*                                                          @OZ11673*/ 01307000
*/* PROCEDURE NAME - DSCTLBRK                                @OZ11673*/ 01308000
*/*                                                          @OZ11673*/ 01309000
*/* FUNCTION - PRINT ONE LINE FOR EACH STAGING ADAPTER THAT  @OZ11673*/ 01310000
*/*            HAD ACTIVITY DURING THE SELECTED TIMESLICE.   @OZ11673*/ 01311000
*/*                                                          @OZ11673*/ 01312000
*/********************************************************** @OZ11673*/ 01313000
*                                                                  0443 01314000
*DSCTLBRK:                                                         0443 01315000
*   PROCEDURE;                      /*                       @OZ11673*/ 01316000
DSCTLBRK STM   @14,@12,@SA00007                                    0443 01317000
*   ACCUMTOT=BKT5(1,1,9);           /* T-SLICE TOT STAGNG    @ZA16140*/ 01318000
         L     @08,BKT5+32                                         0444 01319000
         ST    @08,ACCUMTOT                                        0444 01320000
*   BKT5(1,1,9)=0;                  /* CLEAR TIME SLICE TOT STGNG  0445 01321000
*                                      BUCKTS                        */ 01322000
         SLR   @08,@08                                             0445 01323000
         ST    @08,BKT5+32                                         0445 01324000
*   I=1;                            /* SET I TO DETAIL BUCKETS     0446 01325000
*                                                            @Y30LB40*/ 01326000
         LA    I,1                                                 0446 01327000
*   CALL DATETIME;                  /* PRINT DATE & TIME     @OZ11673*/ 01328000
         BAL   @14,DATETIME                                        0447 01329000
*   CALL PROCDSBK;                                                 0448 01330000
         BAL   @14,PROCDSBK                                        0448 01331000
*   END DSCTLBRK;                                                  0449 01332000
@EL00007 DS    0H                                                  0449 01333000
@EF00007 DS    0H                                                  0449 01334000
@ER00007 LM    @14,@12,@SA00007                                    0449 01335000
         BR    @14                                                 0449 01336000
*                                                                  0450 01337000
*/********************************************************** @OZ11673*/ 01338000
*/*                                                          @OZ11673*/ 01339000
*/* PROCEDURE NAME - PROCDSBK                                @OZ11673*/ 01340000
*/*                                                          @OZ11673*/ 01341000
*/* FUNCTION -                                               @OZ11673*/ 01342000
*/*                                                          @OZ11673*/ 01343000
*/********************************************************** @OZ11673*/ 01344000
*                                                                  0450 01345000
*PROCDSBK:                                                         0450 01346000
*   PROCEDURE;                                                     0450 01347000
PROCDSBK STM   @14,@12,@SA00008                                    0450 01348000
*   J=1;                            /*                       @ZA16140*/ 01349000
         LA    @07,1                                               0451 01350000
         LR    J,@07                                               0451 01351000
*   DO K=1 TO 29;                   /* LOOP THROUGH SDGS 0 - 27    0452 01352000
*                                                            @ZA16140*/ 01353000
         LA    @15,1                                               0452 01354000
         LR    K,@15                                               0452 01355000
@DL00452 DS    0H                                                  0453 01356000
*     IF LINECNT>55 THEN                                           0453 01357000
         LH    @15,LINECNT                                         0453 01358000
         C     @15,@CF00749                                        0453 01359000
         BNH   @RF00453                                            0453 01360000
*       DO;                         /* SKIP TO A NEW PAGE    @Y30LB40*/ 01361000
*         LINECNT=5;                /* RESET LINE COUNT      @Y30LB40*/ 01362000
         MVC   LINECNT(2),@CH00372                                 0455 01363000
*         PAGECNT=PAGECNT+1;        /* UP PAGE COUNTER       @Y30LB40*/ 01364000
         LA    @15,1                                               0456 01365000
         AL    @15,PAGECNT                                         0456 01366000
         ST    @15,PAGECNT                                         0456 01367000
*         HEADHOLD=HDNG1;           /*                       @Y30LB40*/ 01368000
         MVC   HEADHOLD(121),HDNG1                                 0457 01369000
*         CALL EDITFIX(ADDR(PAGECNT),4,'S');/*               @Y30LB40*/ 01370000
         MVC   @AL00001+4(8),@AL00458                              0458 01371000
         LA    @15,PAGECNT                                         0458 01372000
         ST    @15,@AFTEMPS+4                                      0458 01373000
         LA    @15,@AFTEMPS+4                                      0458 01374000
         ST    @15,@AL00001                                        0458 01375000
         LA    @01,@AL00001                                        0458 01376000
         BAL   @14,EDITFIX                                         0458 01377000
*         HEADHOLD(118:121)=FIXOUT(10:13);/*                 @Y30LB40*/ 01378000
         MVC   HEADHOLD+117(4),FIXOUT+9                            0459 01379000
*         HEADHOLD(107:111)=TODAY;  /*                       @Y30LB40*/ 01380000
         MVC   HEADHOLD+106(5),TODAY                               0460 01381000
*         RFY                                                      0461 01382000
*          (R0,                                                    0461 01383000
*           R1,                                                    0461 01384000
*           R14,                                                   0461 01385000
*           R15) RSTD;              /*                       @Y30LB40*/ 01386000
*         GEN(PUT   PRNTDCB,HEADHOLD);/* PRINT REPORT HEADLINES      */ 01387000
         PUT   PRNTDCB,HEADHOLD                                         01388000
*         GEN(PUT   PRNTDCB,HDNG2); /*                       @Y30LB40*/ 01389000
         PUT   PRNTDCB,HDNG2                                            01390000
*         GEN(PUT   PRNTDCB,HDNG3); /*                       @Y30LB40*/ 01391000
         PUT   PRNTDCB,HDNG3                                            01392000
*         GEN(PUT   PRNTDCB,SPACE1);/*                       @Y30LB40*/ 01393000
         PUT   PRNTDCB,SPACE1                                           01394000
*         RFY                                                      0466 01395000
*          (R0,                                                    0466 01396000
*           R1,                                                    0466 01397000
*           R14,                                                   0466 01398000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 01399000
*         FLD1=' ';                 /*                       @Y30LB40*/ 01400000
         MVI   FLD1,C' '                                           0467 01401000
*       END;                        /*                       @Y30LB40*/ 01402000
*     IF(K¬=9&BKT5(I,J,K)¬=0) THEN                                 0469 01403000
@RF00453 LA    @15,9                                               0469 01404000
         CR    K,@15                                               0469 01405000
         BE    @RF00469                                            0469 01406000
         LR    @14,I                                               0469 01407000
         ALR   @14,@14                                             0469 01408000
         ALR   @14,J                                               0469 01409000
         MH    @14,@CH00643                                        0469 01410000
         ALR   @14,K                                               0469 01411000
         SLA   @14,2                                               0469 01412000
         L     @14,BKT5-352(@14)                                   0469 01413000
         LTR   @14,@14                                             0469 01414000
         BZ    @RF00469                                            0469 01415000
*       DO;                         /*                       @ZA16140*/ 01416000
*         IF K>9 THEN                                              0471 01417000
         CR    K,@15                                               0471 01418000
         BNH   @RF00471                                            0471 01419000
*           CALCFLD=K-2;            /* GET SDG NO.           @ZA16140*/ 01420000
         LR    @15,K                                               0472 01421000
         BCTR  @15,0                                               0472 01422000
         BCTR  @15,0                                               0472 01423000
         ST    @15,CALCFLD                                         0472 01424000
*         ELSE                                                     0473 01425000
*           CALCFLD=K-1;            /* GET SDG NO.           @ZA16140*/ 01426000
         B     @RC00471                                            0473 01427000
@RF00471 LR    @15,K                                               0473 01428000
         BCTR  @15,0                                               0473 01429000
         ST    @15,CALCFLD                                         0473 01430000
*         CALL EDITFIX(ADDR(CALCFLD),4,'N');/* EDIT SDG      @ZA16140*/ 01431000
@RC00471 MVC   @AL00001+4(8),@AL00474                              0474 01432000
         LA    @15,CALCFLD                                         0474 01433000
         ST    @15,@AFTEMPS+4                                      0474 01434000
         LA    @15,@AFTEMPS+4                                      0474 01435000
         ST    @15,@AL00001                                        0474 01436000
         LA    @01,@AL00001                                        0474 01437000
         BAL   @14,EDITFIX                                         0474 01438000
*         SDGFLD=FIXOUT(12:13);     /*                       @ZA16140*/ 01439000
         MVC   SDGFLD(2),FIXOUT+11                                 0475 01440000
*         IF DSBKT6(I,J,K)¬=0 THEN                                 0476 01441000
         LR    @15,I                                               0476 01442000
         ALR   @15,@15                                             0476 01443000
         ALR   @15,J                                               0476 01444000
         MH    @15,@CH00643                                        0476 01445000
         ALR   @15,K                                               0476 01446000
         SLA   @15,2                                               0476 01447000
         L     @14,DSBKT6-352(@15)                                 0476 01448000
         LTR   @14,@14                                             0476 01449000
         BZ    @RF00476                                            0476 01450000
*           DO;                     /* CALC PRELOAD PERCENT          */ 01451000
*             CALCFLD=DSBKT7(I,J,K)*1000;/*                  @Y30LB40*/ 01452000
         L     @03,DSBKT7-352(@15)                                 0478 01453000
         MH    @03,@CH00753                                        0478 01454000
         ST    @03,CALCFLD                                         0478 01455000
*             CALCFLD2=DSBKT6(I,J,K);/*                      @Y30LB40*/ 01456000
         LR    CALCFLD2,@14                                        0479 01457000
*             CALCFLD=((CALCFLD/CALCFLD2)+5)/10;                   0480 01458000
         LR    @00,@03                                             0480 01459000
         SRDA  @00,32                                              0480 01460000
         DR    @00,CALCFLD2                                        0480 01461000
         LR    @04,@01                                             0480 01462000
         AL    @04,@CF00372                                        0480 01463000
         SRDA  @04,32                                              0480 01464000
         D     @04,@CF00034                                        0480 01465000
         ST    @05,CALCFLD                                         0480 01466000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01467000
         MVC   @AL00001+4(8),@AL00481                              0481 01468000
         LA    @15,CALCFLD                                         0481 01469000
         ST    @15,@AFTEMPS+4                                      0481 01470000
         LA    @15,@AFTEMPS+4                                      0481 01471000
         ST    @15,@AL00001                                        0481 01472000
         LA    @01,@AL00001                                        0481 01473000
         BAL   @14,EDITFIX                                         0481 01474000
*             DSFLD18=FIXOUT(11:13);/*                       @Y30LB40*/ 01475000
         MVC   DSFLD18(3),FIXOUT+10                                0482 01476000
*           END;                    /*                       @Y30LB40*/ 01477000
*         ELSE                                                     0484 01478000
*           DSFLD18(3:3)='0';       /* PRELOAD PERCENT       @Y30LB40*/ 01479000
         B     @RC00476                                            0484 01480000
@RF00476 MVI   DSFLD18+2,C'0'                                      0484 01481000
*         DSBKT6(I,J,K)=0;          /* CLEAR MININUM BUCKET  @Y30LB40*/ 01482000
@RC00476 SLR   @15,@15                                             0485 01483000
         LR    @14,I                                               0485 01484000
         ALR   @14,@14                                             0485 01485000
         ALR   @14,J                                               0485 01486000
         MH    @14,@CH00643                                        0485 01487000
         ALR   @14,K                                               0485 01488000
         SLA   @14,2                                               0485 01489000
         ST    @15,DSBKT6-352(@14)                                 0485 01490000
*         DSBKT7(I,J,K)=0;          /* CLEAR HITNUM BUCKET   @Y30LB40*/ 01491000
         ST    @15,DSBKT7-352(@14)                                 0486 01492000
*         CALL DOCOMMON;                                           0487 01493000
         BAL   @14,DOCOMMON                                        0487 01494000
*         RFY                                                      0488 01495000
*          (R0,                                                    0488 01496000
*           R1,                                                    0488 01497000
*           R14,                                                   0488 01498000
*           R15) RSTD;              /*                       @Y30LB40*/ 01499000
*         GEN(PUT   PRNTDCB,DSLINE);/* PRINT DETAIL LINE             */ 01500000
         PUT   PRNTDCB,DSLINE                                           01501000
*         RFY                                                      0490 01502000
*          (R0,                                                    0490 01503000
*           R1,                                                    0490 01504000
*           R14,                                                   0490 01505000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 01506000
*         IF FLD1='0'               /* BUMP LINECOUNT        @Y30LB40*/ 01507000
*           THEN                                                   0491 01508000
         CLI   FLD1,C'0'                                           0491 01509000
         BNE   @RF00491                                            0491 01510000
*           LINECNT=LINECNT+2;      /*                       @Y30LB40*/ 01511000
         LA    @15,2                                               0492 01512000
         AH    @15,LINECNT                                         0492 01513000
         STH   @15,LINECNT                                         0492 01514000
*         ELSE                                                     0493 01515000
*           LINECNT=LINECNT+1;      /*                       @Y30LB40*/ 01516000
         B     @RC00491                                            0493 01517000
@RF00491 LA    @15,1                                               0493 01518000
         AH    @15,LINECNT                                         0493 01519000
         STH   @15,LINECNT                                         0493 01520000
*         FLD1=' ';                 /* CLEAR CONSTANT INFO   @Y30LB40*/ 01521000
@RC00491 MVI   FLD1,C' '                                           0494 01522000
*         FLD2=' ';                 /*                       @Y30LB40*/ 01523000
         MVI   FLD2+1,C' '                                         0495 01524000
         MVC   FLD2+2(4),FLD2+1                                    0495 01525000
         MVI   FLD2,C' '                                           0495 01526000
*         FLD2A=' ';                /*                       @Y30LB40*/ 01527000
         MVI   FLD2A+1,C' '                                        0496 01528000
         MVC   FLD2A+2(6),FLD2A+1                                  0496 01529000
         MVI   FLD2A,C' '                                          0496 01530000
*       END;                        /*                       @Y30LB40*/ 01531000
*   END;                            /*                       @Y30LB40*/ 01532000
@RF00469 AL    K,@CF00044                                          0498 01533000
         C     K,@CF00643                                          0498 01534000
         BNH   @DL00452                                            0498 01535000
*   END PROCDSBK;                   /*                       @OZ11673*/ 01536000
@EL00008 DS    0H                                                  0499 01537000
@EF00008 DS    0H                                                  0499 01538000
@ER00008 LM    @14,@12,@SA00008                                    0499 01539000
         BR    @14                                                 0499 01540000
*                                                                  0500 01541000
*/********************************************************** @OZ11673*/ 01542000
*/*                                                          @OZ11673*/ 01543000
*/* PROCEDURE NAME - TESTEOF                                 @OZ11673*/ 01544000
*/*                                                          @OZ11673*/ 01545000
*/* FUNCTION - IF THE LAST RECORD HAS BEEN ENCOUNTERED,      @OZ11673*/ 01546000
*/*            FIRST WRITE TOTALS FOR THE REPORT TYPE, AND   @OZ11673*/ 01547000
*/*            THEN WRITE COMMON JOB-END TOTALS.             @OZ11673*/ 01548000
*/*                                                          @OZ11673*/ 01549000
*/********************************************************** @OZ11673*/ 01550000
*                                                                  0500 01551000
*TESTEOF:                                                          0500 01552000
*   PROCEDURE;                      /*                       @OZ11673*/ 01553000
TESTEOF  STM   @14,@05,@SA00009                                    0500 01554000
         STM   @07,@12,@SA00009+32                                 0500 01555000
*   RFY                                                            0501 01556000
*    (R0,                                                          0501 01557000
*     R1,                                                          0501 01558000
*     R14,                                                         0501 01559000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01560000
*   GEN(PUT   PRNTDCB,SPACE1);      /* SKIP A LINE           @Y30LB40*/ 01561000
         PUT   PRNTDCB,SPACE1                                           01562000
*   RFY                                                            0503 01563000
*    (R0,                                                          0503 01564000
*     R1,                                                          0503 01565000
*     R14,                                                         0503 01566000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01567000
*   LINECNT=LINECNT+1;              /*                       @Y30LB40*/ 01568000
         LA    @08,1                                               0504 01569000
         AH    @08,LINECNT                                         0504 01570000
         STH   @08,LINECNT                                         0504 01571000
*   I=2;                            /* INDICATE REPORT TOTALS WANTED */ 01572000
         LA    I,2                                                 0505 01573000
*   DSLINE=' ';                     /*                       @Y30LB40*/ 01574000
         MVI   DSLINE+1,C' '                                       0506 01575000
         MVC   DSLINE+2(123),DSLINE+1                              0506 01576000
         MVI   DSLINE,C' '                                         0506 01577000
*   FLD2='TOTALS';                  /* SETUP CONSTANT INFO   @OZ11673*/ 01578000
         MVC   FLD2(6),@CC00758                                    0507 01579000
*   IF PARMSW='R' THEN                                             0508 01580000
         CLI   PARMSW,C'R'                                         0508 01581000
         BNE   @RF00508                                            0508 01582000
*     ACCUMTOT=BKT5(2,1,9)+BKT5(2,2,9);/*                    @OZ11673*/ 01583000
         L     @08,BKT5+264                                        0509 01584000
         AL    @08,BKT5+380                                        0509 01585000
         ST    @08,ACCUMTOT                                        0509 01586000
*   ELSE                                                           0510 01587000
*     ACCUMTOT=BKT5(2,1,9);         /*                       @ZA16140*/ 01588000
         B     @RC00508                                            0510 01589000
@RF00508 L     @08,BKT5+264                                        0510 01590000
         ST    @08,ACCUMTOT                                        0510 01591000
*   IF PARMSW='R'                   /*                       @OZ11673*/ 01592000
*     THEN                          /*                       @OZ11673*/ 01593000
@RC00508 CLI   PARMSW,C'R'                                         0511 01594000
         BNE   @RF00511                                            0511 01595000
*     CALL PROCRWBK;                /*                       @OZ11673*/ 01596000
         BAL   @14,PROCRWBK                                        0512 01597000
*   ELSE                            /*                       @OZ11673*/ 01598000
*     CALL PROCDSBK;                /* WRITE REPORT TOTALS   @OZ11673*/ 01599000
         B     @RC00511                                            0513 01600000
@RF00511 BAL   @14,PROCDSBK                                        0513 01601000
*   END TESTEOF;                    /* NEXT SLICE PERIOD     @OZ11673*/ 01602000
@EL00009 DS    0H                                                  0514 01603000
@EF00009 DS    0H                                                  0514 01604000
@ER00009 LM    @14,@05,@SA00009                                    0514 01605000
         LM    @07,@12,@SA00009+32                                 0514 01606000
         BR    @14                                                 0514 01607000
*                                                                  0515 01608000
*/********************************************************** @OZ11673*/ 01609000
*/*                                                          @OZ11673*/ 01610000
*/* PROCEDURE NAME - GETSLICE                                @OZ11673*/ 01611000
*/*                                                          @OZ11673*/ 01612000
*/* FUNCTION - BUMP THE TIMESLICE COMPARE VALUE UNTIL THE    @OZ11673*/ 01613000
*/*            CURRENT TIME IN THE DETAIL RECORD FALLS       @OZ11673*/ 01614000
*/*            WITHIN THE TIMESLICE RANGE.                   @OZ11673*/ 01615000
*/*                                                          @OZ11673*/ 01616000
*/********************************************************** @OZ11673*/ 01617000
*                                                                  0515 01618000
*GETSLICE:                                                         0515 01619000
*   PROCEDURE;                      /*                       @OZ11673*/ 01620000
GETSLICE STM   @14,@12,12(@13)                                     0515 01621000
*   DO WHILE(CKTIME>TSEND);         /* SETUP NEXT TIME SLICE INTERVAL*/ 01622000
         B     @DE00516                                            0516 01623000
@DL00516 DS    0H                                                  0517 01624000
*     TSBEG=TSEND;                  /*                       @Y30LB40*/ 01625000
         MVC   TSBEG(7),TSEND                                      0517 01626000
*     TSETIME=TSETIME+TIMESL;       /*                       @Y30LB40*/ 01627000
         L     @08,TSETIME                                         0518 01628000
         AL    @08,TIMESL                                          0518 01629000
         ST    @08,TSETIME                                         0518 01630000
*     IF TSETIME>86399 THEN                                        0519 01631000
         C     @08,@CF00705                                        0519 01632000
         BNH   @RF00519                                            0519 01633000
*       DO;                         /*                       @Y30LB40*/ 01634000
*         TSETIME=TSETIME-86400;    /*                       @Y30LB40*/ 01635000
         SL    @08,@CF00763                                        0521 01636000
         ST    @08,TSETIME                                         0521 01637000
*         TSEDAY=TSEDAY+1;          /*                       @Y30LB40*/ 01638000
         LA    @08,1                                               0522 01639000
         LH    @15,TSEDAY                                          0522 01640000
         ALR   @15,@08                                             0522 01641000
         STH   @15,TSEDAY                                          0522 01642000
*         IF TSEDAY>365 THEN                                       0523 01643000
         C     @15,@CF00704                                        0523 01644000
         BNH   @RF00523                                            0523 01645000
*           DO;                     /*                       @Y30LB40*/ 01646000
*             IF(TSEND(1:1)&'00000011'B)='00000000'B THEN          0525 01647000
         MVC   @TS00001(1),TSEND                                   0525 01648000
         NI    @TS00001,B'00000011'                                0525 01649000
         CLI   @TS00001,B'00000000'                                0525 01650000
         BNE   @RF00525                                            0525 01651000
*               IF TSEDAY>366 THEN                                 0526 01652000
         LA    @14,366                                             0526 01653000
         CR    @15,@14                                             0526 01654000
         BNH   @RF00526                                            0526 01655000
*                 DO;               /*                       @Y30LB40*/ 01656000
*                   TSEDAY=TSEDAY-366;/*                     @Y30LB40*/ 01657000
         SLR   @15,@14                                             0528 01658000
         STH   @15,TSEDAY                                          0528 01659000
*                   TSEYR=TSEYR+1;  /*                       @Y30LB40*/ 01660000
         SLR   @15,@15                                             0529 01661000
         IC    @15,TSEYR                                           0529 01662000
         ALR   @08,@15                                             0529 01663000
         STC   @08,TSEYR                                           0529 01664000
*                 END;              /*                       @Y30LB40*/ 01665000
*               ELSE                                               0531 01666000
*                 ;                 /*                       @Y30LB40*/ 01667000
@RF00526 DS    0H                                                  0532 01668000
*             ELSE                                                 0532 01669000
*               DO;                 /*                       @Y30LB40*/ 01670000
         B     @RC00525                                            0532 01671000
@RF00525 DS    0H                                                  0533 01672000
*                 TSEDAY=TSEDAY-365;/*                       @Y30LB40*/ 01673000
         LH    @08,TSEDAY                                          0533 01674000
         SL    @08,@CF00704                                        0533 01675000
         STH   @08,TSEDAY                                          0533 01676000
*                 TSEYR=TSEYR+1;    /*                       @Y30LB40*/ 01677000
         LA    @08,1                                               0534 01678000
         SLR   @15,@15                                             0534 01679000
         IC    @15,TSEYR                                           0534 01680000
         ALR   @08,@15                                             0534 01681000
         STC   @08,TSEYR                                           0534 01682000
*               END;                /*                       @Y30LB40*/ 01683000
*           END;                    /*                       @Y30LB40*/ 01684000
@RC00525 DS    0H                                                  0537 01685000
*       END;                        /*                       @Y30LB40*/ 01686000
@RF00523 DS    0H                                                  0538 01687000
*   END;                            /*                       @Y30LB40*/ 01688000
@RF00519 DS    0H                                                  0538 01689000
@DE00516 CLC   CKTIME(7),TSEND                                     0538 01690000
         BH    @DL00516                                            0538 01691000
*   END GETSLICE;                   /*                       @OZ11673*/ 01692000
@EL00010 DS    0H                                                  0539 01693000
@EF00010 DS    0H                                                  0539 01694000
@ER00010 LM    @14,@12,12(@13)                                     0539 01695000
         BR    @14                                                 0539 01696000
*                                                                  0540 01697000
*/********************************************************** @OZ11673*/ 01698000
*/*                                                          @OZ11673*/ 01699000
*/* PROCEDURE NAME - BUCKETS                                 @OZ11673*/ 01700000
*/*                                                          @OZ11673*/ 01701000
*/* FUNCTION - UPDATE THOSE BUCKETS THAT ARE COMMON TO BOTH  @OZ11673*/ 01702000
*/*            THE STAGING ADAPTER ACTIVITY REPORT ABD THE   @OZ11673*/ 01703000
*/*            DATA RECORDING DEVICE ACTIVITY REPORT.        @OZ11673*/ 01704000
*/*                                                          @OZ11673*/ 01705000
*/********************************************************** @OZ11673*/ 01706000
*                                                                  0540 01707000
*BUCKETS:                                                          0540 01708000
*   PROCEDURE;                      /*                       @OZ11673*/ 01709000
BUCKETS  STM   @14,@12,12(@13)                                     0540 01710000
*   BKT1(I,J,K)=BKT1(I,J,K)+STGD;   /* CYLS STAGED           @OZ11673*/ 01711000
         LR    @15,I                                               0541 01712000
         ALR   @15,@15                                             0541 01713000
         ALR   @15,J                                               0541 01714000
         LR    @14,@15                                             0541 01715000
         MH    @14,@CH00643                                        0541 01716000
         ALR   @14,K                                               0541 01717000
         SLA   @14,2                                               0541 01718000
         L     @05,STGD                                            0541 01719000
         L     @04,BKT1-352(@14)                                   0541 01720000
         ALR   @04,@05                                             0541 01721000
         ST    @04,BKT1-352(@14)                                   0541 01722000
*   BKT2(I,J,K)=BKT2(I,J,K)+CFAULT; /* C FAULT CSD           @OZ11673*/ 01723000
         L     @04,BKT2-352(@14)                                   0542 01724000
         AL    @04,CFAULT                                          0542 01725000
         ST    @04,BKT2-352(@14)                                   0542 01726000
*   BKT3(I,J,K)=BKT3(I,J,K)+DSTGD;  /* CYLS DESTAGED         @OZ11673*/ 01727000
         L     @04,DSTGD                                           0543 01728000
         L     @03,BKT3-352(@14)                                   0543 01729000
         ALR   @03,@04                                             0543 01730000
         ST    @03,BKT3-352(@14)                                   0543 01731000
*   BKT4(I,J,K)=BKT4(I,J,K)+SALLOC; /* S ALLOC CSD           @OZ11673*/ 01732000
         L     @03,BKT4-352(@14)                                   0544 01733000
         AL    @03,SALLOC                                          0544 01734000
         ST    @03,BKT4-352(@14)                                   0544 01735000
*   BKT5(I,J,K)=BKT5(I,J,K)+(STGD+DSTGD);/* TOT STAGING              */ 01736000
         ALR   @05,@04                                             0545 01737000
         L     @04,BKT5-352(@14)                                   0545 01738000
         ALR   @04,@05                                             0545 01739000
         ST    @04,BKT5-352(@14)                                   0545 01740000
*   BKT5(I,J,9)=BKT5(I,J,9)+(STGD+DSTGD);/*                  @OZ11673*/ 01741000
         MH    @15,@CH00823                                        0546 01742000
         AL    @05,BKT5-316(@15)                                   0546 01743000
         ST    @05,BKT5-316(@15)                                   0546 01744000
*   END BUCKETS;                    /*                       @OZ11673*/ 01745000
@EL00011 DS    0H                                                  0547 01746000
@EF00011 DS    0H                                                  0547 01747000
@ER00011 LM    @14,@12,12(@13)                                     0547 01748000
         BR    @14                                                 0547 01749000
*                                                                  0548 01750000
*/********************************************************** @OZ11673*/ 01751000
*/*                                                          @OZ11673*/ 01752000
*/* PROCEDURE NAME - RWACCUM                                 @OZ11673*/ 01753000
*/*                                                          @OZ11673*/ 01754000
*/* FUNCTION - ACCUMULATE TOTALS FROM DETAIL FOR DATA        @OZ11673*/ 01755000
*/*            RECORDING DEVICE ACTIVITY REPORT.             @OZ11673*/ 01756000
*/*                                                          @OZ11673*/ 01757000
*/********************************************************** @OZ11673*/ 01758000
*                                                                  0548 01759000
*RWACCUM:                                                          0548 01760000
*   PROCEDURE;                      /*                       @OZ11673*/ 01761000
RWACCUM  STM   @14,@12,@SA00012                                    0548 01762000
*   J=LIBRARY+1;                    /* ALLOW FOR LIBRARY 0   @Y30LB40*/ 01763000
         LA    @06,1                                               0549 01764000
         SLR   J,J                                                 0549 01765000
         IC    J,LIBRARY                                           0549 01766000
         ALR   J,@06                                               0549 01767000
*   K=READWRIT+1;                   /* ALLOW FOR READ/WRITE UNIT 0   */ 01768000
         SLR   K,K                                                 0550 01769000
         IC    K,READWRIT                                          0550 01770000
         ALR   @06,K                                               0550 01771000
         LR    K,@06                                               0550 01772000
*   IF K>8 THEN                                                    0551 01773000
         LA    @06,8                                               0551 01774000
         CR    K,@06                                               0551 01775000
         BNH   @RF00551                                            0551 01776000
*     K=8;                          /* SET TO MAX VALUE      @Y30LB40*/ 01777000
         LR    K,@06                                               0552 01778000
*   DO I=1 TO 2;                    /* ACCUM TIME SLICE AND REPORT 0553 01779000
*                                      TOTALS                @Y30LB40*/ 01780000
@RF00551 LA    I,1                                                 0553 01781000
@DL00553 DS    0H                                                  0554 01782000
*     CALL BUCKETS;                                                0554 01783000
         BAL   @14,BUCKETS                                         0554 01784000
*     BKT6(I,J,K)=BKT6(I,J,K)+LOADNUM;/* NO. OF LOADS                */ 01785000
         LR    @15,I                                               0555 01786000
         ALR   @15,@15                                             0555 01787000
         ALR   @15,J                                               0555 01788000
         MH    @15,@CH00643                                        0555 01789000
         ALR   @15,K                                               0555 01790000
         SLA   @15,2                                               0555 01791000
         SLR   @14,@14                                             0555 01792000
         IC    @14,LOADNUM                                         0555 01793000
         AL    @14,BKT6-352(@15)                                   0555 01794000
         ST    @14,BKT6-352(@15)                                   0555 01795000
*     BKT7(I,J,K)=BKT7(I,J,K)+LOADTIME;/* LOAD TIME          @Y30LB40*/ 01796000
         L     @14,BKT7-352(@15)                                   0556 01797000
         AL    @14,LOADTIME                                        0556 01798000
         ST    @14,BKT7-352(@15)                                   0556 01799000
*   END;                            /*                       @Y30LB40*/ 01800000
         AL    I,@CF00044                                          0557 01801000
         C     I,@CF00051                                          0557 01802000
         BNH   @DL00553                                            0557 01803000
*   END RWACCUM;                    /*                       @OZ11673*/ 01804000
@EL00012 DS    0H                                                  0558 01805000
@EF00012 DS    0H                                                  0558 01806000
@ER00012 LM    @14,@12,@SA00012                                    0558 01807000
         BR    @14                                                 0558 01808000
*                                                                  0559 01809000
*/********************************************************** @OZ11673*/ 01810000
*/*                                                          @OZ11673*/ 01811000
*/* PROCEDURE NAME - RWCTLBRK                                @OZ11673*/ 01812000
*/*                                                          @OZ11673*/ 01813000
*/********************************************************** @OZ11673*/ 01814000
*                                                                  0559 01815000
*RWCTLBRK:                                                         0559 01816000
*   PROCEDURE;                                                     0559 01817000
RWCTLBRK STM   @14,@12,@SA00013                                    0559 01818000
*   ACCUMTOT=0;                     /*                       @Y30LB40*/ 01819000
         SLR   @08,@08                                             0560 01820000
         ST    @08,ACCUMTOT                                        0560 01821000
*   DO J=1 TO 2;                    /*                       @ZA16140*/ 01822000
         LA    J,1                                                 0561 01823000
@DL00561 DS    0H                                                  0562 01824000
*     ACCUMTOT=ACCUMTOT+BKT5(1,J,9);/* TSLICE TOT STGNG              */ 01825000
         LR    @15,J                                               0562 01826000
         MH    @15,@CH00823                                        0562 01827000
         L     @14,ACCUMTOT                                        0562 01828000
         AL    @14,BKT5-84(@15)                                    0562 01829000
         ST    @14,ACCUMTOT                                        0562 01830000
*     BKT5(1,J,9)=0;                /*                       @Y30LB40*/ 01831000
         SLR   @14,@14                                             0563 01832000
         ST    @14,BKT5-84(@15)                                    0563 01833000
*   END;                            /*                       @Y30LB40*/ 01834000
         AL    J,@CF00044                                          0564 01835000
         C     J,@CF00051                                          0564 01836000
         BNH   @DL00561                                            0564 01837000
*   I=1;                            /* SET I TO DETAIL BUCKETS     0565 01838000
*                                                            @Y30LB40*/ 01839000
         LA    I,1                                                 0565 01840000
*   CALL DATETIME;                  /*                       @OZ11673*/ 01841000
         BAL   @14,DATETIME                                        0566 01842000
*   CALL PROCRWBK;                                                 0567 01843000
         BAL   @14,PROCRWBK                                        0567 01844000
*   END RWCTLBRK;                                                  0568 01845000
@EL00013 DS    0H                                                  0568 01846000
@EF00013 DS    0H                                                  0568 01847000
@ER00013 LM    @14,@12,@SA00013                                    0568 01848000
         BR    @14                                                 0568 01849000
*                                                                  0569 01850000
*/********************************************************** @OZ11673*/ 01851000
*/*                                                          @OZ11673*/ 01852000
*/* PROCEDURE NAME - PROCRWBK                                @OZ11673*/ 01853000
*/*                                                          @OZ11673*/ 01854000
*/********************************************************** @OZ11673*/ 01855000
*                                                                  0569 01856000
*PROCRWBK:                                                         0569 01857000
*   PROCEDURE;                                                     0569 01858000
PROCRWBK STM   @14,@12,@SA00014                                    0569 01859000
*   DO J=1 TO 2;                    /* LOOP THROUGH LIBRARIES      0570 01860000
*                                                            @ZA16140*/ 01861000
         LA    J,1                                                 0570 01862000
@DL00570 DS    0H                                                  0571 01863000
*     DO K=1 TO 8;                  /* LOOP THROUGH READ WRITE UNITS    01864000
*                                                            @ZA16140*/ 01865000
         LA    K,1                                                 0571 01866000
@DL00571 DS    0H                                                  0572 01867000
*       IF LINECNT>55 THEN                                         0572 01868000
         LH    @15,LINECNT                                         0572 01869000
         C     @15,@CF00749                                        0572 01870000
         BNH   @RF00572                                            0572 01871000
*         DO;                       /* SKIP TO A NEW PAGE    @Y30LB40*/ 01872000
*           LINECNT=5;              /* RESET LINE COUNT      @Y30LB40*/ 01873000
         MVC   LINECNT(2),@CH00372                                 0574 01874000
*           PAGECNT=PAGECNT+1;      /* UP PAGE COUNTER       @Y30LB40*/ 01875000
         LA    @15,1                                               0575 01876000
         AL    @15,PAGECNT                                         0575 01877000
         ST    @15,PAGECNT                                         0575 01878000
*           HEADHOLD=HDNGA;         /*                       @Y30LB40*/ 01879000
         MVC   HEADHOLD(121),HDNGA                                 0576 01880000
*           CALL EDITFIX(ADDR(PAGECNT),4,'S');/*             @Y30LB40*/ 01881000
         MVC   @AL00001+4(8),@AL00577                              0577 01882000
         LA    @15,PAGECNT                                         0577 01883000
         ST    @15,@AFTEMPS+8                                      0577 01884000
         LA    @15,@AFTEMPS+8                                      0577 01885000
         ST    @15,@AL00001                                        0577 01886000
         LA    @01,@AL00001                                        0577 01887000
         BAL   @14,EDITFIX                                         0577 01888000
*           HEADHOLD(118:121)=FIXOUT(10:13);/*               @Y30LB40*/ 01889000
         MVC   HEADHOLD+117(4),FIXOUT+9                            0578 01890000
*           HEADHOLD(107:111)=TODAY;/*                       @Y30LB40*/ 01891000
         MVC   HEADHOLD+106(5),TODAY                               0579 01892000
*           RFY                                                    0580 01893000
*            (R0,                                                  0580 01894000
*             R1,                                                  0580 01895000
*             R14,                                                 0580 01896000
*             R15) RSTD;            /*                       @Y30LB40*/ 01897000
*           GEN(PUT   PRNTDCB,HEADHOLD);/* PRINT REPORT HEADLINES    */ 01898000
         PUT   PRNTDCB,HEADHOLD                                         01899000
*           GEN(PUT   PRNTDCB,HDNGB);/*                      @Y30LB40*/ 01900000
         PUT   PRNTDCB,HDNGB                                            01901000
*           GEN(PUT   PRNTDCB,HDNGC);/*                      @Y30LB40*/ 01902000
         PUT   PRNTDCB,HDNGC                                            01903000
*           GEN(PUT   PRNTDCB,SPACE1);/*                     @Y30LB40*/ 01904000
         PUT   PRNTDCB,SPACE1                                           01905000
*           RFY                                                    0585 01906000
*            (R0,                                                  0585 01907000
*             R1,                                                  0585 01908000
*             R14,                                                 0585 01909000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 01910000
*           FLD1=' ';               /*                       @Y30LB40*/ 01911000
         MVI   FLD1,C' '                                           0586 01912000
*         END;                      /*                       @Y30LB40*/ 01913000
*       IF BKT5(I,J,K)¬=0 THEN                                     0588 01914000
@RF00572 LR    @15,I                                               0588 01915000
         ALR   @15,@15                                             0588 01916000
         ALR   @15,J                                               0588 01917000
         MH    @15,@CH00643                                        0588 01918000
         ALR   @15,K                                               0588 01919000
         SLA   @15,2                                               0588 01920000
         L     @15,BKT5-352(@15)                                   0588 01921000
         LTR   @15,@15                                             0588 01922000
         BZ    @RF00588                                            0588 01923000
*         DO;                       /* PROCESS ALL NON 0 BUCKETS     */ 01924000
*           RWFLD4=SSIDEQ(J);       /* 2ND INDEX = MSF       @OZ05079*/ 01925000
         LA    @01,SSIDEQ-1(J)                                     0590 01926000
         MVC   RWFLD4(1),0(@01)                                    0590 01927000
*           CHAR2='2';              /* ALWAYS 2 FOR DRD      @OZ05079*/ 01928000
         MVI   CHAR2,C'2'                                          0591 01929000
*           DRDMSFID=SSIDEQ(J);     /* 2ND CHAR = MSF        @OZ05079*/ 01930000
         LA    @01,SSIDEQ-1(J)                                     0592 01931000
         MVC   DRDMSFID(1),0(@01)                                  0592 01932000
*           RWFLD6=SSIDEQ(K);       /* PHYSICAL DRD          @OZ05079*/ 01933000
         LA    @01,SSIDEQ-1(K)                                     0593 01934000
         MVC   RWFLD6(1),0(@01)                                    0593 01935000
*           CALL DOCOMMON;          /*                       @OZ11673*/ 01936000
         BAL   @14,DOCOMMON                                        0594 01937000
*           CALL EDITFIX(ADDR(BKT6(I,J,K)),4,'E');/*         @OZ11673*/ 01938000
         MVC   @AL00001+4(8),@AL00595                              0595 01939000
         LR    @15,I                                               0595 01940000
         ALR   @15,@15                                             0595 01941000
         ALR   @15,J                                               0595 01942000
         MH    @15,@CH00643                                        0595 01943000
         ALR   @15,K                                               0595 01944000
         SLA   @15,2                                               0595 01945000
         LA    @15,BKT6-352(@15)                                   0595 01946000
         ST    @15,@AFTEMPS+8                                      0595 01947000
         LA    @15,@AFTEMPS+8                                      0595 01948000
         ST    @15,@AL00001                                        0595 01949000
         LA    @01,@AL00001                                        0595 01950000
         BAL   @14,EDITFIX                                         0595 01951000
*           RWFLD18=FIXOUT(8:13);   /* NO. OF CARTRIDGE LOADS        */ 01952000
         MVC   RWFLD18(6),FIXOUT+7                                 0596 01953000
*           BKT7(I,J,K)=BKT7(I,J,K)/4;/* LOAD TIME TO SECS           */ 01954000
         LR    @15,I                                               0597 01955000
         ALR   @15,@15                                             0597 01956000
         ALR   @15,J                                               0597 01957000
         MH    @15,@CH00643                                        0597 01958000
         ALR   @15,K                                               0597 01959000
         SLA   @15,2                                               0597 01960000
         L     @00,BKT7-352(@15)                                   0597 01961000
         SRDA  @00,32                                              0597 01962000
         D     @00,@CF00104                                        0597 01963000
         ST    @01,BKT7-352(@15)                                   0597 01964000
*           CALL EDITFIX(ADDR(BKT7(I,J,K)),4,'E');/*         @OZ11673*/ 01965000
         MVC   @AL00001+4(8),@AL00598                              0598 01966000
         LA    @15,BKT7-352(@15)                                   0598 01967000
         ST    @15,@AFTEMPS+8                                      0598 01968000
         LA    @15,@AFTEMPS+8                                      0598 01969000
         ST    @15,@AL00001                                        0598 01970000
         LA    @01,@AL00001                                        0598 01971000
         BAL   @14,EDITFIX                                         0598 01972000
*           RWFLD20=FIXOUT(8:13);   /* LOAD TIME             @Y30LB40*/ 01973000
         MVC   RWFLD20(6),FIXOUT+7                                 0599 01974000
*           IF BKT6(I,J,K)>0 THEN                                  0600 01975000
         LR    @15,I                                               0600 01976000
         ALR   @15,@15                                             0600 01977000
         ALR   @15,J                                               0600 01978000
         MH    @15,@CH00643                                        0600 01979000
         ALR   @15,K                                               0600 01980000
         SLA   @15,2                                               0600 01981000
         L     @14,BKT6-352(@15)                                   0600 01982000
         LTR   @14,@14                                             0600 01983000
         BNP   @RF00600                                            0600 01984000
*             DO;                   /*                       @OZ11673*/ 01985000
*               CALCFLD=(BKT7(I,J,K)/BKT6(I,J,K));/* C RATE          */ 01986000
         L     @00,BKT7-352(@15)                                   0602 01987000
         SRDA  @00,32                                              0602 01988000
         DR    @00,@14                                             0602 01989000
         ST    @01,CALCFLD                                         0602 01990000
*               CALL EDITFIX(ADDR(CALCFLD),4,'E');/*         @OZ11673*/ 01991000
         MVC   @AL00001+4(8),@AL00603                              0603 01992000
         LA    @15,CALCFLD                                         0603 01993000
         ST    @15,@AFTEMPS+8                                      0603 01994000
         LA    @15,@AFTEMPS+8                                      0603 01995000
         ST    @15,@AL00001                                        0603 01996000
         LA    @01,@AL00001                                        0603 01997000
         BAL   @14,EDITFIX                                         0603 01998000
*               RWFLD22=FIXOUT(8:13);/* C RATE               @Y30LB40*/ 01999000
         MVC   RWFLD22(6),FIXOUT+7                                 0604 02000000
*             END;                  /*                       @Y30LB40*/ 02001000
*           ELSE                                                   0606 02002000
*             RWFLD22(6:6)='0';     /*                       @Y30LB40*/ 02003000
         B     @RC00600                                            0606 02004000
@RF00600 MVI   RWFLD22+5,C'0'                                      0606 02005000
*           BKT6(I,J,K)=0;          /*                       @OZ11673*/ 02006000
@RC00600 SLR   @15,@15                                             0607 02007000
         LR    @14,I                                               0607 02008000
         ALR   @14,@14                                             0607 02009000
         ALR   @14,J                                               0607 02010000
         MH    @14,@CH00643                                        0607 02011000
         ALR   @14,K                                               0607 02012000
         SLA   @14,2                                               0607 02013000
         ST    @15,BKT6-352(@14)                                   0607 02014000
*           BKT7(I,J,K)=0;          /*                       @OZ11673*/ 02015000
         ST    @15,BKT7-352(@14)                                   0608 02016000
*           RFY                                                    0609 02017000
*            (R0,                                                  0609 02018000
*             R1,                                                  0609 02019000
*             R14,                                                 0609 02020000
*             R15) RSTD;            /*                       @Y30LB40*/ 02021000
*           GEN(PUT   PRNTDCB,DSLINE);/* PRINT DETAIL PRINT LINE     */ 02022000
         PUT   PRNTDCB,DSLINE                                           02023000
*           RFY                                                    0611 02024000
*            (R0,                                                  0611 02025000
*             R1,                                                  0611 02026000
*             R14,                                                 0611 02027000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 02028000
*           IF FLD1='0'             /* BUMP LINE COUNT       @OZ11673*/ 02029000
*             THEN                                                 0612 02030000
         CLI   FLD1,C'0'                                           0612 02031000
         BNE   @RF00612                                            0612 02032000
*             LINECNT=LINECNT+2;    /*                       @Y30LB40*/ 02033000
         LA    @15,2                                               0613 02034000
         AH    @15,LINECNT                                         0613 02035000
         STH   @15,LINECNT                                         0613 02036000
*           ELSE                                                   0614 02037000
*             LINECNT=LINECNT+1;    /*                       @Y30LB40*/ 02038000
         B     @RC00612                                            0614 02039000
@RF00612 LA    @15,1                                               0614 02040000
         AH    @15,LINECNT                                         0614 02041000
         STH   @15,LINECNT                                         0614 02042000
*           FLD1=' ';               /*                       @OZ11673*/ 02043000
@RC00612 MVI   FLD1,C' '                                           0615 02044000
*           FLD2=' ';               /* CLEAR CONSTANT INFO   @OZ11673*/ 02045000
         MVI   FLD2+1,C' '                                         0616 02046000
         MVC   FLD2+2(4),FLD2+1                                    0616 02047000
         MVI   FLD2,C' '                                           0616 02048000
*           FLD2A=' ';              /*                       @OZ11673*/ 02049000
         MVI   FLD2A+1,C' '                                        0617 02050000
         MVC   FLD2A+2(6),FLD2A+1                                  0617 02051000
         MVI   FLD2A,C' '                                          0617 02052000
*         END;                      /*                       @Y30LB40*/ 02053000
*       ELSE                                                       0619 02054000
*         ;                         /*                       @Y30LB40*/ 02055000
@RF00588 DS    0H                                                  0620 02056000
*     END;                          /*                       @Y30LB40*/ 02057000
         AL    K,@CF00044                                          0620 02058000
         C     K,@CF00069                                          0620 02059000
         BNH   @DL00571                                            0620 02060000
*   END;                            /*                       @Y30LB40*/ 02061000
         AL    J,@CF00044                                          0621 02062000
         C     J,@CF00051                                          0621 02063000
         BNH   @DL00570                                            0621 02064000
*   END PROCRWBK;                                                  0622 02065000
@EL00014 DS    0H                                                  0622 02066000
@EF00014 DS    0H                                                  0622 02067000
@ER00014 LM    @14,@12,@SA00014                                    0622 02068000
         BR    @14                                                 0622 02069000
*                                                                  0623 02070000
*/********************************************************** @OZ11673*/ 02071000
*/*                                                          @OZ11673*/ 02072000
*/* PROCEDURE NAME - DOCOMMON                                @OZ11673*/ 02073000
*/*                                                          @OZ11673*/ 02074000
*/* FUNCTION - SET UP PRINT FOR BUCKETS THAT ARE COMMON TO   @OZ11673*/ 02075000
*/*            BOTH THE STAGING ADAPTER ACTIVITY REPORT AND  @OZ11673*/ 02076000
*/*            THE DATA RECORDING DEVICE ACTIVITY REPORT.    @OZ11673*/ 02077000
*/*                                                          @OZ11673*/ 02078000
*/********************************************************** @OZ11673*/ 02079000
*                                                                  0623 02080000
*DOCOMMON:                                                         0623 02081000
*   PROCEDURE;                      /*                       @OZ11673*/ 02082000
DOCOMMON STM   @14,@12,@SA00015                                    0623 02083000
*   CALL EDITFIX(ADDR(BKT1(I,J,K)),4,'E');/*                 @OZ11673*/ 02084000
         MVC   @AL00001+4(8),@AL00624                              0624 02085000
         LR    @15,I                                               0624 02086000
         ALR   @15,@15                                             0624 02087000
         ALR   @15,J                                               0624 02088000
         MH    @15,@CH00643                                        0624 02089000
         ALR   @15,K                                               0624 02090000
         SLA   @15,2                                               0624 02091000
         LA    @15,BKT1-352(@15)                                   0624 02092000
         ST    @15,@AFTEMPS+12                                     0624 02093000
         LA    @15,@AFTEMPS+12                                     0624 02094000
         ST    @15,@AL00001                                        0624 02095000
         LA    @01,@AL00001                                        0624 02096000
         BAL   @14,EDITFIX                                         0624 02097000
*   FLD8=FIXOUT(3:13);              /* CYLINDERS STAGED      @OZ11673*/ 02098000
         MVC   FLD8(11),FIXOUT+2                                   0625 02099000
*   BKT1(I,J,K)=0;                  /* CLEAR CYLS STAGED     @OZ11673*/ 02100000
         LR    @15,I                                               0626 02101000
         ALR   @15,@15                                             0626 02102000
         ALR   @15,J                                               0626 02103000
         MH    @15,@CH00643                                        0626 02104000
         ALR   @15,K                                               0626 02105000
         SLA   @15,2                                               0626 02106000
         SLR   @14,@14                                             0626 02107000
         ST    @14,BKT1-352(@15)                                   0626 02108000
*   CALL EDITFIX(ADDR(BKT2(I,J,K)),4,'E');/*                 @OZ11673*/ 02109000
         MVC   @AL00001+4(8),@AL00627                              0627 02110000
         LA    @15,BKT2-352(@15)                                   0627 02111000
         ST    @15,@AFTEMPS+12                                     0627 02112000
         LA    @15,@AFTEMPS+12                                     0627 02113000
         ST    @15,@AL00001                                        0627 02114000
         LA    @01,@AL00001                                        0627 02115000
         BAL   @14,EDITFIX                                         0627 02116000
*   FLD9=FIXOUT(3:13);              /* CYL FAULT CAUSED      @OZ11673*/ 02117000
         MVC   FLD9(11),FIXOUT+2                                   0628 02118000
*   BKT2(I,J,K)=0;                  /* CLEAR CYL FAULT CAUSED      0629 02119000
*                                                            @OZ11673*/ 02120000
         LR    @15,I                                               0629 02121000
         ALR   @15,@15                                             0629 02122000
         ALR   @15,J                                               0629 02123000
         MH    @15,@CH00643                                        0629 02124000
         ALR   @15,K                                               0629 02125000
         SLA   @15,2                                               0629 02126000
         SLR   @14,@14                                             0629 02127000
         ST    @14,BKT2-352(@15)                                   0629 02128000
*   CALL EDITFIX(ADDR(BKT3(I,J,K)),4,'E');/*                 @OZ11673*/ 02129000
         MVC   @AL00001+4(8),@AL00630                              0630 02130000
         LA    @15,BKT3-352(@15)                                   0630 02131000
         ST    @15,@AFTEMPS+12                                     0630 02132000
         LA    @15,@AFTEMPS+12                                     0630 02133000
         ST    @15,@AL00001                                        0630 02134000
         LA    @01,@AL00001                                        0630 02135000
         BAL   @14,EDITFIX                                         0630 02136000
*   FLD11=FIXOUT(3:13);             /* CYLINDERS DESTAGED    @OZ11673*/ 02137000
         MVC   FLD11(11),FIXOUT+2                                  0631 02138000
*   BKT3(I,J,K)=0;                  /* CLEAR CYLS DESTAGED   @OZ11673*/ 02139000
         LR    @15,I                                               0632 02140000
         ALR   @15,@15                                             0632 02141000
         ALR   @15,J                                               0632 02142000
         MH    @15,@CH00643                                        0632 02143000
         ALR   @15,K                                               0632 02144000
         SLA   @15,2                                               0632 02145000
         SLR   @14,@14                                             0632 02146000
         ST    @14,BKT3-352(@15)                                   0632 02147000
*   CALL EDITFIX(ADDR(BKT4(I,J,K)),4,'E');/*                 @OZ11673*/ 02148000
         MVC   @AL00001+4(8),@AL00633                              0633 02149000
         LA    @15,BKT4-352(@15)                                   0633 02150000
         ST    @15,@AFTEMPS+12                                     0633 02151000
         LA    @15,@AFTEMPS+12                                     0633 02152000
         ST    @15,@AL00001                                        0633 02153000
         LA    @01,@AL00001                                        0633 02154000
         BAL   @14,EDITFIX                                         0633 02155000
*   FLD12=FIXOUT(3:13);             /* SPACE ALLOC CAUSED    @OZ11673*/ 02156000
         MVC   FLD12(11),FIXOUT+2                                  0634 02157000
*   BKT4(I,J,K)=0;                  /* CLEAR SPACE ALLOC     @OZ11673*/ 02158000
         LR    @15,I                                               0635 02159000
         ALR   @15,@15                                             0635 02160000
         ALR   @15,J                                               0635 02161000
         MH    @15,@CH00643                                        0635 02162000
         ALR   @15,K                                               0635 02163000
         SLA   @15,2                                               0635 02164000
         SLR   @14,@14                                             0635 02165000
         ST    @14,BKT4-352(@15)                                   0635 02166000
*   CALL EDITFIX(ADDR(BKT5(I,J,K)),4,'E');/*                 @OZ11673*/ 02167000
         MVC   @AL00001+4(8),@AL00636                              0636 02168000
         LA    @15,BKT5-352(@15)                                   0636 02169000
         ST    @15,@AFTEMPS+12                                     0636 02170000
         LA    @15,@AFTEMPS+12                                     0636 02171000
         ST    @15,@AL00001                                        0636 02172000
         LA    @01,@AL00001                                        0636 02173000
         BAL   @14,EDITFIX                                         0636 02174000
*   FLD14=FIXOUT(3:13);             /* TOTAL STAGING ACTIVITY      0637 02175000
*                                                            @OZ11673*/ 02176000
         MVC   FLD14(11),FIXOUT+2                                  0637 02177000
*   CALCFLD=BKT5(I,J,K)*1000;       /*                       @OZ11673*/ 02178000
         LR    @15,I                                               0638 02179000
         ALR   @15,@15                                             0638 02180000
         ALR   @15,J                                               0638 02181000
         MH    @15,@CH00643                                        0638 02182000
         ALR   @15,K                                               0638 02183000
         SLA   @15,2                                               0638 02184000
         L     @15,BKT5-352(@15)                                   0638 02185000
         MH    @15,@CH00753                                        0638 02186000
         ST    @15,CALCFLD                                         0638 02187000
*   CALCFLD=((CALCFLD/ACCUMTOT)+5)/10;/*                     @OZ11673*/ 02188000
         LR    @00,@15                                             0639 02189000
         SRDA  @00,32                                              0639 02190000
         D     @00,ACCUMTOT                                        0639 02191000
         LR    @02,@01                                             0639 02192000
         AL    @02,@CF00372                                        0639 02193000
         SRDA  @02,32                                              0639 02194000
         D     @02,@CF00034                                        0639 02195000
         ST    @03,CALCFLD                                         0639 02196000
*   CALL EDITFIX(ADDR(CALCFLD),4,'S');/*                     @OZ11673*/ 02197000
         MVC   @AL00001+4(8),@AL00640                              0640 02198000
         LA    @15,CALCFLD                                         0640 02199000
         ST    @15,@AFTEMPS+12                                     0640 02200000
         LA    @15,@AFTEMPS+12                                     0640 02201000
         ST    @15,@AL00001                                        0640 02202000
         LA    @01,@AL00001                                        0640 02203000
         BAL   @14,EDITFIX                                         0640 02204000
*   FLD16=FIXOUT(11:13);            /* TIME SLICE PERCENT    @OZ11673*/ 02205000
         MVC   FLD16(3),FIXOUT+10                                  0641 02206000
*   BKT5(I,J,K)=0;                  /* CLEAR TOT STAGING     @OZ11673*/ 02207000
         LR    @15,I                                               0642 02208000
         ALR   @15,@15                                             0642 02209000
         ALR   @15,J                                               0642 02210000
         MH    @15,@CH00643                                        0642 02211000
         ALR   @15,K                                               0642 02212000
         SLA   @15,2                                               0642 02213000
         SLR   @14,@14                                             0642 02214000
         ST    @14,BKT5-352(@15)                                   0642 02215000
*   END DOCOMMON;                   /*                       @OZ11673*/ 02216000
@EL00015 DS    0H                                                  0643 02217000
@EF00015 DS    0H                                                  0643 02218000
@ER00015 LM    @14,@12,@SA00015                                    0643 02219000
         BR    @14                                                 0643 02220000
*EOF:                               /* END OF FILE FOUND     @Y30LB40*/ 02221000
*   EOFSW='1'B;                     /* INDICATE END OF FILE HIT    0644 02222000
*                                                            @Y30LB40*/ 02223000
EOF      OI    EOFSW,B'10000000'                                   0644 02224000
*   GO TO CHECKEOF;                                                0645 02225000
         B     CHECKEOF                                            0645 02226000
*                                                                  0646 02227000
*/********************************************************************  02228000
*                                                                    */ 02229000
*/* END OF JOB, CLOSE FILES, PROCESSING COMPLETE.            @Y30LB40*/ 02230000
*/********************************************************************  02231000
*                                                                    */ 02232000
*                                                                  0646 02233000
*EOJ:                                                              0646 02234000
*   PROCEDURE;                                                     0646 02235000
EOJ      STM   @14,@12,@SA00016                                    0646 02236000
*   DSLINE=RCDTOTAL;                /*                       @Y30LB40*/ 02237000
         MVI   DSLINE+121,C' '                                     0647 02238000
         MVC   DSLINE+122(3),DSLINE+121                            0647 02239000
         MVC   DSLINE(121),RCDTOTAL                                0647 02240000
*   DSLINE(16:16)=PARMSW;           /*                       @Y30LB40*/ 02241000
         MVC   DSLINE+15(1),PARMSW                                 0648 02242000
*   TIMESL=TIMESL/60;               /*                       @Y30LB40*/ 02243000
         L     @00,TIMESL                                          0649 02244000
         SRDA  @00,32                                              0649 02245000
         D     @00,@CF00335                                        0649 02246000
         ST    @01,TIMESL                                          0649 02247000
*   CALL EDITFIX(ADDR(TIMESL),4,'S');/*                      @Y30LB40*/ 02248000
         MVC   @AL00001+4(8),@AL00650                              0650 02249000
         LA    @06,TIMESL                                          0650 02250000
         ST    @06,@AFTEMPS+16                                     0650 02251000
         LA    @06,@AFTEMPS+16                                     0650 02252000
         ST    @06,@AL00001                                        0650 02253000
         LA    @01,@AL00001                                        0650 02254000
         BAL   @14,EDITFIX                                         0650 02255000
*   DSLINE(29:31)=FIXOUT(11:13);    /*                       @Y30LB40*/ 02256000
         MVC   DSLINE+28(3),FIXOUT+10                              0651 02257000
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/ 02258000
         MVC   @AL00001+4(8),@AL00652                              0652 02259000
         LA    @06,HLDSYR                                          0652 02260000
         ST    @06,@AFTEMPS+16                                     0652 02261000
         LA    @06,@AFTEMPS+16                                     0652 02262000
         ST    @06,@AL00001                                        0652 02263000
         LA    @01,@AL00001                                        0652 02264000
         BAL   @14,EDITFIX                                         0652 02265000
*   DSLINE(42:43)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02266000
         MVC   DSLINE+41(2),FIXOUT+11                              0653 02267000
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/ 02268000
         MVC   @AL00001+4(8),@AL00654                              0654 02269000
         LA    @06,HLDSDAY                                         0654 02270000
         ST    @06,@AFTEMPS+16                                     0654 02271000
         LA    @06,@AFTEMPS+16                                     0654 02272000
         ST    @06,@AL00001                                        0654 02273000
         LA    @01,@AL00001                                        0654 02274000
         BAL   @14,EDITFIX                                         0654 02275000
*   DSLINE(44:46)=FIXOUT(11:13);    /*                       @Y30LB40*/ 02276000
         MVC   DSLINE+43(3),FIXOUT+10                              0655 02277000
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/ 02278000
         MVC   @AL00001+4(8),@AL00656                              0656 02279000
         LA    @06,HLDEYR                                          0656 02280000
         ST    @06,@AFTEMPS+16                                     0656 02281000
         LA    @06,@AFTEMPS+16                                     0656 02282000
         ST    @06,@AL00001                                        0656 02283000
         LA    @01,@AL00001                                        0656 02284000
         BAL   @14,EDITFIX                                         0656 02285000
*   DSLINE(48:49)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02286000
         MVC   DSLINE+47(2),FIXOUT+11                              0657 02287000
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/ 02288000
         MVC   @AL00001+4(8),@AL00658                              0658 02289000
         LA    @06,HLDEDAY                                         0658 02290000
         ST    @06,@AFTEMPS+16                                     0658 02291000
         LA    @06,@AFTEMPS+16                                     0658 02292000
         ST    @06,@AL00001                                        0658 02293000
         LA    @01,@AL00001                                        0658 02294000
         BAL   @14,EDITFIX                                         0658 02295000
*   DSLINE(50:52)=FIXOUT(11:13);    /*                       @Y30LB40*/ 02296000
         MVC   DSLINE+49(3),FIXOUT+10                              0659 02297000
*   HOUR=HLDSTIME/3600;             /*                       @Y30LB40*/ 02298000
         L     @06,HLDSTIME                                        0660 02299000
         LA    @15,3600                                            0660 02300000
         LR    @00,@06                                             0660 02301000
         SRDA  @00,32                                              0660 02302000
         DR    @00,@15                                             0660 02303000
         ST    @01,HOUR                                            0660 02304000
*   MINUTE=(HLDSTIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 02305000
         MR    @00,@15                                             0661 02306000
         LR    @02,@06                                             0661 02307000
         SLR   @02,@01                                             0661 02308000
         SRDA  @02,32                                              0661 02309000
         D     @02,@CF00335                                        0661 02310000
         ST    @03,MINUTE                                          0661 02311000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 02312000
         MVC   @AL00001+4(8),@AL00662                              0662 02313000
         LA    @06,HOUR                                            0662 02314000
         ST    @06,@AFTEMPS+16                                     0662 02315000
         LA    @06,@AFTEMPS+16                                     0662 02316000
         ST    @06,@AL00001                                        0662 02317000
         LA    @01,@AL00001                                        0662 02318000
         BAL   @14,EDITFIX                                         0662 02319000
*   DSLINE(63:64)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02320000
         MVC   DSLINE+62(2),FIXOUT+11                              0663 02321000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 02322000
         MVC   @AL00001+4(8),@AL00664                              0664 02323000
         LA    @06,MINUTE                                          0664 02324000
         ST    @06,@AFTEMPS+16                                     0664 02325000
         LA    @06,@AFTEMPS+16                                     0664 02326000
         ST    @06,@AL00001                                        0664 02327000
         LA    @01,@AL00001                                        0664 02328000
         BAL   @14,EDITFIX                                         0664 02329000
*   DSLINE(65:66)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02330000
         MVC   DSLINE+64(2),FIXOUT+11                              0665 02331000
*   HOUR=HLDETIME/3600;             /*                       @Y30LB40*/ 02332000
         L     @06,HLDETIME                                        0666 02333000
         LA    @15,3600                                            0666 02334000
         LR    @00,@06                                             0666 02335000
         SRDA  @00,32                                              0666 02336000
         DR    @00,@15                                             0666 02337000
         ST    @01,HOUR                                            0666 02338000
*   MINUTE=(HLDETIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 02339000
         MR    @00,@15                                             0667 02340000
         LR    @02,@06                                             0667 02341000
         SLR   @02,@01                                             0667 02342000
         SRDA  @02,32                                              0667 02343000
         D     @02,@CF00335                                        0667 02344000
         ST    @03,MINUTE                                          0667 02345000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 02346000
         MVC   @AL00001+4(8),@AL00668                              0668 02347000
         LA    @06,HOUR                                            0668 02348000
         ST    @06,@AFTEMPS+16                                     0668 02349000
         LA    @06,@AFTEMPS+16                                     0668 02350000
         ST    @06,@AL00001                                        0668 02351000
         LA    @01,@AL00001                                        0668 02352000
         BAL   @14,EDITFIX                                         0668 02353000
*   DSLINE(68:69)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02354000
         MVC   DSLINE+67(2),FIXOUT+11                              0669 02355000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 02356000
         MVC   @AL00001+4(8),@AL00670                              0670 02357000
         LA    @06,MINUTE                                          0670 02358000
         ST    @06,@AFTEMPS+16                                     0670 02359000
         LA    @06,@AFTEMPS+16                                     0670 02360000
         ST    @06,@AL00001                                        0670 02361000
         LA    @01,@AL00001                                        0670 02362000
         BAL   @14,EDITFIX                                         0670 02363000
*   DSLINE(70:71)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02364000
         MVC   DSLINE+69(2),FIXOUT+11                              0671 02365000
*   IF SELECTSW='1'B                /* PRINT THE SDG OR LU IF      0672 02366000
*                                      SELECTSW ON           @ZA16140*/ 02367000
*     THEN                                                         0672 02368000
         TM    SELECTSW,B'10000000'                                0672 02369000
         BNO   @RF00672                                            0672 02370000
*     IF PARMSW='D' THEN                                           0673 02371000
         CLI   PARMSW,C'D'                                         0673 02372000
         BNE   @RF00673                                            0673 02373000
*       DO;                         /*                       @Y30LB40*/ 02374000
*         DSLINE(73:80)='SDGXX   '; /*                       @ZA16140*/ 02375000
         MVC   DSLINE+72(8),@CC00795                               0675 02376000
*         CALL EDITFIX(ADDR(SELSDG),1,'N');/*                @ZA16140*/ 02377000
         MVC   @AL00001+4(8),@AL00676                              0676 02378000
         LA    @08,SELSDG                                          0676 02379000
         ST    @08,@AFTEMPS+16                                     0676 02380000
         LA    @08,@AFTEMPS+16                                     0676 02381000
         ST    @08,@AL00001                                        0676 02382000
         LA    @01,@AL00001                                        0676 02383000
         BAL   @14,EDITFIX                                         0676 02384000
*         DSLINE(76:77)=FIXOUT(12:13);/*                     @ZA16140*/ 02385000
         MVC   DSLINE+75(2),FIXOUT+11                              0677 02386000
*       END;                        /*                       @Y30LB40*/ 02387000
*     ELSE                                                         0679 02388000
*       DO;                         /*                       @Y30LB40*/ 02389000
         B     @RC00673                                            0679 02390000
@RF00673 DS    0H                                                  0680 02391000
*         DSLINE(78:78)='2';        /*                       @OZ05079*/ 02392000
         MVI   DSLINE+77,C'2'                                      0680 02393000
*         DSLINE(79:79)=SSIDEQ(L+1);/*                       @OZ05079*/ 02394000
         LA    @06,SSIDEQ(L)                                       0681 02395000
         MVC   DSLINE+78(1),0(@06)                                 0681 02396000
*         DSLINE(80:80)=SSIDEQ(U+1);/*                       @OZ05079*/ 02397000
         LA    @01,SSIDEQ(U)                                       0682 02398000
         MVC   DSLINE+79(1),0(@01)                                 0682 02399000
*       END;                        /*                       @Y30LB40*/ 02400000
*   ELSE                                                           0684 02401000
*     DSLINE(73:80)='       ';      /*                       @OZ05079*/ 02402000
         B     @RC00672                                            0684 02403000
@RF00672 MVI   DSLINE+79,C' '                                      0684 02404000
         MVC   DSLINE+72(7),@CC00800                               0684 02405000
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/ 02406000
@RC00672 MVC   @AL00001+4(8),@AL00685                              0685 02407000
         LA    @08,RCDCOUNT                                        0685 02408000
         ST    @08,@AFTEMPS+16                                     0685 02409000
         LA    @08,@AFTEMPS+16                                     0685 02410000
         ST    @08,@AL00001                                        0685 02411000
         LA    @01,@AL00001                                        0685 02412000
         BAL   @14,EDITFIX                                         0685 02413000
*   DSLINE(108:113)=FIXOUT(8:13);   /*                       @Y30LB40*/ 02414000
         MVC   DSLINE+107(6),FIXOUT+7                              0686 02415000
*   RFY                                                            0687 02416000
*    (R0,                                                          0687 02417000
*     R1,                                                          0687 02418000
*     R14,                                                         0687 02419000
*     R15) RSTD;                    /*                       @Y30LB40*/ 02420000
*   GEN(PUT   PRNTDCB,DSLINE);      /* PRINT PARM LINE       @Y30LB40*/ 02421000
         PUT   PRNTDCB,DSLINE                                           02422000
*   RFY                                                            0689 02423000
*    (R0,                                                          0689 02424000
*     R1,                                                          0689 02425000
*     R14,                                                         0689 02426000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 02427000
*   END EOJ;                                                       0690 02428000
@EL00016 DS    0H                                                  0690 02429000
@EF00016 DS    0H                                                  0690 02430000
@ER00016 LM    @14,@12,@SA00016                                    0690 02431000
         BR    @14                                                 0690 02432000
*                                                                  0691 02433000
*/********************************************************************  02434000
*                                                                    */ 02435000
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */ 02436000
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */ 02437000
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/ 02438000
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1, 2, OR 4  02439000
*                                                                    */ 02440000
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/ 02441000
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/ 02442000
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/ 02443000
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/ 02444000
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */ 02445000
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/ 02446000
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */ 02447000
*/* LONG.                                                    @Y30LB40*/ 02448000
*/********************************************************************  02449000
*                                                                    */ 02450000
*                                                                  0691 02451000
*EDITFIX:                                                          0691 02452000
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/ 02453000
EDITFIX  STM   @14,@12,@SA00017                                    0691 02454000
         MVC   @PC00017(12),0(@01)                                 0691 02455000
*   DCL                                                            0692 02456000
*     FIXADDR PTR(31);              /* ADDRESS OF INPUT FIELD      0692 02457000
*                                                            @Y30LB40*/ 02458000
*   DCL                                                            0693 02459000
*     FIXLEN PTR(31);               /* LENGTH OF INPUT FIELD @Y30LB40*/ 02460000
*   DCL                                                            0694 02461000
*     FIXOPT CHAR(1);               /* EDITING OPTION DESIRED      0694 02462000
*                                                            @Y30LB40*/ 02463000
*   RFY                                                            0695 02464000
*    (R2,                                                          0695 02465000
*     R3) RSTD;                     /*                       @Y30LB40*/ 02466000
*   R2=FIXADDR;                     /*                       @Y30LB40*/ 02467000
         L     @08,@PC00017                                        0696 02468000
         L     R2,FIXADDR(,@08)                                    0696 02469000
*   R3=0;                           /*                       @Y30LB40*/ 02470000
         SLR   R3,R3                                               0697 02471000
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE   02472000
*                                                            @Y30LB40*/ 02473000
*     THEN                                                         0698 02474000
         L     @08,@PC00017+4                                      0698 02475000
         CLC   FIXLEN(4,@08),@CF00044                              0698 02476000
         BNE   @RF00698                                            0698 02477000
*     DO;                           /*                       @Y30LB40*/ 02478000
*       GEN(IC    R3,0(R2));        /*                       @Y30LB40*/ 02479000
         IC    R3,0(R2)                                                 02480000
*     END;                          /*                       @Y30LB40*/ 02481000
*   ELSE                                                           0702 02482000
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   0702 02483000
*                                      BYTES                 @Y30LB40*/ 02484000
*       THEN                                                       0702 02485000
         B     @RC00698                                            0702 02486000
@RF00698 L     @08,@PC00017+4                                      0702 02487000
         CLC   FIXLEN(4,@08),@CF00051                              0702 02488000
         BNE   @RF00702                                            0702 02489000
*       DO;                         /*                       @Y30LB40*/ 02490000
*         GEN(LH    R3,0(R2));      /*                       @Y30LB40*/ 02491000
         LH    R3,0(R2)                                                 02492000
*       END;                        /*                       @Y30LB40*/ 02493000
*     ELSE                                                         0706 02494000
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/ 02495000
         B     @RC00702                                            0706 02496000
@RF00702 DS    0H                                                  0707 02497000
*         GEN(L     R3,0(R2));      /*                       @Y30LB40*/ 02498000
         L     R3,0(R2)                                                 02499000
*       END;                        /*                       @Y30LB40*/ 02500000
*   GEN;                                                           0709 02501000
@RC00702 DS    0H                                                  0709 02502000
@RC00698 DS    0H                                                  0709 02503000
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/  02504000
  CVD   R3,DOUBLEWD                                                     02505000
  OI    DOUBLEWD+7,X'0F'                                                02506000
  UNPK  FIXOUT(13),DOUBLEWD+2(6)                                        02507000
*   IF FIXOPT='N' THEN                                             0710 02508000
         L     @08,@PC00017+8                                      0710 02509000
         CLI   FIXOPT(@08),C'N'                                    0710 02510000
         BE    @RT00710                                            0710 02511000
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */ 02512000
*   IF FIXOPT='S' THEN                                             0712 02513000
         CLI   FIXOPT(@08),C'S'                                    0712 02514000
         BE    @RT00712                                            0712 02515000
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       0713 02516000
*                                      INSERTION                     */ 02517000
*   GEN;                                                           0714 02518000
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/  02519000
  MVC   FIXOUT(1),FIXOUT+3                                              02520000
  MVI   FIXOUT+1,C','                                                   02521000
  MVC   FIXOUT+2(3),FIXOUT+4                                            02522000
  MVI   FIXOUT+5,C','                                                   02523000
  MVC   FIXOUT+6(3),FIXOUT+7                                            02524000
  MVI   FIXOUT+9,C','                                                   02525000
*EF4:                               /* ZERO AND COMMA SUPPRESS     0715 02526000
*                                                            @Y30LB40*/ 02527000
*   GEN;                                                           0715 02528000
EF4      DS    0H                                                  0715 02529000
*                                                         /*@Y30LB40*/  02530000
         LA    R2,FIXOUT                                                02531000
         LA    R3,12                                                    02532000
EF5      EQU   *                                                        02533000
         CLI   0(R2),C','                                               02534000
         BE    EF6                                                      02535000
         CLI   0(R2),C'0'                                               02536000
         BNE   EFEND                                                    02537000
EF6      EQU   *                                                        02538000
         MVI   0(R2),C' '                                               02539000
         LA    R2,1(R2)                                                 02540000
         BCT   R3,EF5                                                   02541000
*EFEND:                                                            0716 02542000
*   RFY                                                            0716 02543000
*    (R2,                                                          0716 02544000
*     R3) UNRSTD;                   /*                       @Y30LB40*/ 02545000
*   END EDITFIX;                    /*                       @Y30LB40*/ 02546000
@EL00017 DS    0H                                                  0717 02547000
@EF00017 DS    0H                                                  0717 02548000
@ER00017 LM    @14,@12,@SA00017                                    0717 02549000
         BR    @14                                                 0717 02550000
*                                                                  0718 02551000
*/********************************************************** @OZ05124*/ 02552000
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/ 02553000
*/********************************************************** @OZ05124*/ 02554000
*                                                                  0718 02555000
*READERR:                                                          0718 02556000
*   ;                               /*                       @OZ05124*/ 02557000
READERR  DS    0H                                                  0719 02558000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/ 02559000
         SYNADAF ACSMETH=QSAM                                           02560000
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/ 02561000
         MVC   PRNTLINE+30(79),49(R1)                                   02562000
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/ 02563000
         MVC   PRNTLINE(30),ICGTR904                               0721 02564000
*   SAVE14=R14;                     /*                       @OZ09522*/ 02565000
         LR    SAVE14,R14                                          0722 02566000
*   RFY                                                            0723 02567000
*    (R0,                                                          0723 02568000
*     R1,                                                          0723 02569000
*     R14,                                                         0723 02570000
*     R15) RSTD;                    /*                       @OZ05124*/ 02571000
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/ 02572000
         PUT PRNTDCB,PRNTLINE                                           02573000
*   RFY                                                            0725 02574000
*    (R0,                                                          0725 02575000
*     R1,                                                          0725 02576000
*     R14,                                                         0725 02577000
*     R15) UNRSTD;                  /*                       @OZ05124*/ 02578000
*   R14=SAVE14;                     /*                       @OZ09522*/ 02579000
         LR    R14,SAVE14                                          0726 02580000
*   GEN(SYNADRLS);                  /*                       @OZ05124*/ 02581000
         SYNADRLS                                                       02582000
*   RETURNCD=4;                     /*                       @OZ05124*/ 02583000
         MVC   RETURNCD(2),@CH00104                                0728 02584000
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/ 02585000
         BR    R14                                                      02586000
*   END ICGTRSUM                    /*                       @Y30LB40*/ 02587000
*                                                                  0730 02588000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02589000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 02590000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 02591000
*                                                                  0730 02592000
*       ;                                                          0730 02593000
@EL00001 L     @13,4(,@13)                                         0730 02594000
@EF00001 L     @00,@SIZDATD                                        0730 02595000
         LR    @01,@10                                             0730 02596000
         FREEMAIN R,LV=(0),A=(1)                                        02597000
@ER00001 LM    @14,@12,12(@13)                                     0730 02598000
         BR    @14                                                 0730 02599000
@DATA    DS    0H                                                       02600000
@CH00701 DC    H'56'                                                    02601000
@CH00823 DC    H'116'                                                   02602000
@CH00753 DC    H'1000'                                                  02603000
@CH00724 DC    H'3600'                                                  02604000
@SM00832 MVC   PARMHOLD(0),PARMS(PARMPTR)                               02605000
         DS    0F                                                       02606000
@AL00428 EQU   *                       LIST WITH   2 ARGUMENT(S)        02607000
@AL00652 EQU   *                       LIST WITH   2 ARGUMENT(S)        02608000
@AL00656 EQU   *                       LIST WITH   2 ARGUMENT(S)        02609000
@AL00676 DC    A(@CF00044)             LIST WITH   2 ARGUMENT(S)        02610000
         DC    A(@CC00739)                                              02611000
@AL00430 EQU   *                       LIST WITH   2 ARGUMENT(S)        02612000
@AL00654 EQU   *                       LIST WITH   2 ARGUMENT(S)        02613000
@AL00658 DC    A(@CF00051)             LIST WITH   2 ARGUMENT(S)        02614000
         DC    A(@CC00739)                                              02615000
@AL00436 EQU   *                       LIST WITH   2 ARGUMENT(S)        02616000
@AL00458 EQU   *                       LIST WITH   2 ARGUMENT(S)        02617000
@AL00481 EQU   *                       LIST WITH   2 ARGUMENT(S)        02618000
@AL00577 EQU   *                       LIST WITH   2 ARGUMENT(S)        02619000
@AL00640 EQU   *                       LIST WITH   2 ARGUMENT(S)        02620000
@AL00650 EQU   *                       LIST WITH   2 ARGUMENT(S)        02621000
@AL00685 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        02622000
         DC    A(@CC00741)                                              02623000
@AL00438 EQU   *                       LIST WITH   2 ARGUMENT(S)        02624000
@AL00440 EQU   *                       LIST WITH   2 ARGUMENT(S)        02625000
@AL00474 EQU   *                       LIST WITH   2 ARGUMENT(S)        02626000
@AL00662 EQU   *                       LIST WITH   2 ARGUMENT(S)        02627000
@AL00664 EQU   *                       LIST WITH   2 ARGUMENT(S)        02628000
@AL00668 EQU   *                       LIST WITH   2 ARGUMENT(S)        02629000
@AL00670 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        02630000
         DC    A(@CC00739)                                              02631000
@AL00595 EQU   *                       LIST WITH   2 ARGUMENT(S)        02632000
@AL00598 EQU   *                       LIST WITH   2 ARGUMENT(S)        02633000
@AL00603 EQU   *                       LIST WITH   2 ARGUMENT(S)        02634000
@AL00624 EQU   *                       LIST WITH   2 ARGUMENT(S)        02635000
@AL00627 EQU   *                       LIST WITH   2 ARGUMENT(S)        02636000
@AL00630 EQU   *                       LIST WITH   2 ARGUMENT(S)        02637000
@AL00633 EQU   *                       LIST WITH   2 ARGUMENT(S)        02638000
@AL00636 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        02639000
         DC    A(@CC00668)                                              02640000
@DATD    DSECT                                                          02641000
         DS    0F                                                       02642000
@SA00001 DS    18F                                                      02643000
@SA00003 DS    15F                                                      02644000
@SA00004 DS    13F                                                      02645000
@SA00013 DS    15F                                                      02646000
@SA00007 DS    15F                                                      02647000
@SA00009 DS    14F                                                      02648000
@SA00016 DS    15F                                                      02649000
@SA00012 DS    15F                                                      02650000
@SA00005 DS    15F                                                      02651000
@SA00006 DS    15F                                                      02652000
@SA00017 DS    15F                                                      02653000
@PC00017 DS    3F                                                       02654000
@SA00008 DS    15F                                                      02655000
@SA00015 DS    15F                                                      02656000
@SA00014 DS    15F                                                      02657000
@AL00001 DS    3A                                                       02658000
@AFTEMPS DS    5F                                                       02659000
ICGTRSUM CSECT                                                          02660000
         DS    0F                                                       02661000
@CF00044 DC    F'1'                                                     02662000
@CF00051 DC    F'2'                                                     02663000
@CF00104 DC    F'4'                                                     02664000
@CH00104 EQU   @CF00104+2                                               02665000
@CF00372 DC    F'5'                                                     02666000
@CH00372 EQU   @CF00372+2                                               02667000
@CF00069 DC    F'8'                                                     02668000
@CH00069 EQU   @CF00069+2                                               02669000
@CF00035 DC    F'9'                                                     02670000
@CF00034 DC    F'10'                                                    02671000
@CF00033 DC    F'11'                                                    02672000
@CF00723 DC    F'23'                                                    02673000
@CF00643 DC    F'29'                                                    02674000
@CH00643 EQU   @CF00643+2                                               02675000
@CF00067 DC    F'31'                                                    02676000
@CF00749 DC    F'55'                                                    02677000
@CF00725 DC    F'59'                                                    02678000
@CF00335 DC    F'60'                                                    02679000
@CH00335 EQU   @CF00335+2                                               02680000
@CF00704 DC    F'365'                                                   02681000
@CH00704 EQU   @CF00704+2                                               02682000
@CF00720 DC    F'366'                                                   02683000
@CH00720 EQU   @CF00720+2                                               02684000
@CF00700 DC    F'600'                                                   02685000
@CF00705 DC    F'86399'                                                 02686000
@CF00763 DC    F'86400'                                                 02687000
@DATD    DSECT                                                          02688000
         DS    0D                                                       02689000
DCBPTR   DS    A                                                        02690000
RCDCOUNT DS    F                                                        02691000
PAGECNT  DS    F                                                        02692000
OPENCLOS DS    FL4                                                      02693000
         ORG   OPENCLOS                                                 02694000
OPCLB1   DS    BL1                                                      02695000
OPCLB234 DS    CL3                                                      02696000
         ORG   OPENCLOS+4                                               02697000
TIMESL   DS    F                                                        02698000
HOUR     DS    F                                                        02699000
MINUTE   DS    F                                                        02700000
SECOND   DS    F                                                        02701000
ACCUMTOT DS    F                                                        02702000
CALCFLD  DS    F                                                        02703000
LINECNT  DS    H                                                        02704000
RETURNCD DS    H                                                        02705000
SAINDEX  DS    H                                                        02706000
SELSDG   DS    FL1                                                      02707000
@TS00001 DS    CL1                                                      02708000
RCDIN    DS    CL72                                                     02709000
         ORG   RCDIN                                                    02710000
STGD     DS    FL4                                                      02711000
CFAULT   DS    FL4                                                      02712000
SYSSGTM  DS    FL4                                                      02713000
DEVSGTM  DS    FL4                                                      02714000
DSTGD    DS    FL4                                                      02715000
SALLOC   DS    FL4                                                      02716000
SYSDSTM  DS    FL4                                                      02717000
DEVDSTM  DS    FL4                                                      02718000
BUSYTIME DS    FL4                                                      02719000
LOADTIME DS    FL4                                                      02720000
LOADNUM  DS    FL1                                                      02721000
CKTIME   DS    CL7                                                      02722000
         ORG   CKTIME                                                   02723000
SVEYEAR  DS    FL1                                                      02724000
SVEJUL   DS    FL2                                                      02725000
SVETIME  DS    FL4                                                      02726000
         ORG   RCDIN+48                                                 02727000
PAGES    DS    FL1                                                      02728000
MININUM  DS    FL1                                                      02729000
HITNUM   DS    FL1                                                      02730000
STGDNUM  DS    FL1                                                      02731000
DSTGDNUM DS    FL1                                                      02732000
VTOCSTG  DS    FL1                                                      02733000
VTOCDSTG DS    FL1                                                      02734000
LIBRARY  DS    FL1                                                      02735000
DSPORT   DS    FL1                                                      02736000
DSCU     DS    FL1                                                      02737000
Z        DS    FL1                                                      02738000
Y        DS    FL1                                                      02739000
X        DS    FL1                                                      02740000
CARTPAIR DS    FL1                                                      02741000
READWRIT DS    FL1                                                      02742000
VOLID    DS    CL6                                                      02743000
CHARDRC  DS    CL1                                                      02744000
SDGINBIN DS    FL1                                                      02745000
@NM00030 DS    CL1                                                      02746000
         ORG   RCDIN+72                                                 02747000
DSLINE   DS    CL125                                                    02748000
         ORG   DSLINE                                                   02749000
FLD1     DS    CL1                                                      02750000
FLD2     DS    CL6                                                      02751000
@NM00031 DS    CL1                                                      02752000
FLD2A    DS    CL8                                                      02753000
@NM00032 DS    CL2                                                      02754000
RWFLD4   DS    CL1                                                      02755000
@NM00033 DS    CL1                                                      02756000
SDGID    DS    CL3                                                      02757000
         ORG   SDGID                                                    02758000
@NM00034 DS    CL1                                                      02759000
SDGFLD   DS    CL2                                                      02760000
         ORG   DSLINE+23                                                02761000
@NM00035 DS    CL1                                                      02762000
FLD8     DS    CL11                                                     02763000
@NM00036 DS    CL1                                                      02764000
FLD9     DS    CL11                                                     02765000
@NM00037 DS    CL1                                                      02766000
FLD11    DS    CL11                                                     02767000
@NM00038 DS    CL2                                                      02768000
FLD12    DS    CL11                                                     02769000
@NM00039 DS    CL2                                                      02770000
FLD14    DS    CL11                                                     02771000
@NM00040 DS    CL6                                                      02772000
FLD16    DS    CL3                                                      02773000
@NM00041 DS    CL7                                                      02774000
DSFLD18  DS    CL3                                                      02775000
@NM00042 DS    CL21                                                     02776000
         ORG   DSLINE+125                                               02777000
SPACE1   DS    CL121                                                    02778000
HEADHOLD DS    CL121                                                    02779000
PRNTLINE DS    CL121                                                    02780000
PRNTDCB  DS    CL100                                                    02781000
INDCB    DS    CL100                                                    02782000
STARTTIM DS    CL16                                                     02783000
         ORG   STARTTIM                                                 02784000
@NM00073 DS    CL1                                                      02785000
CKSTIME  DS    CL7                                                      02786000
         ORG   CKSTIME                                                  02787000
HLDSYR   DS    FL1                                                      02788000
HLDSDAY  DS    FL2                                                      02789000
HLDSTIME DS    FL4                                                      02790000
         ORG   STARTTIM+8                                               02791000
@NM00074 DS    CL1                                                      02792000
CKETIME  DS    CL7                                                      02793000
         ORG   CKETIME                                                  02794000
HLDEYR   DS    FL1                                                      02795000
HLDEDAY  DS    FL2                                                      02796000
HLDETIME DS    FL4                                                      02797000
         ORG   STARTTIM+16                                              02798000
TSTIMES  DS    CL16                                                     02799000
         ORG   TSTIMES                                                  02800000
@NM00075 DS    CL1                                                      02801000
TSBEG    DS    CL7                                                      02802000
         ORG   TSBEG                                                    02803000
TSSYR    DS    FL1                                                      02804000
TSSDAY   DS    FL2                                                      02805000
TSSTIME  DS    FL4                                                      02806000
         ORG   TSTIMES+8                                                02807000
@NM00076 DS    CL1                                                      02808000
TSEND    DS    CL7                                                      02809000
         ORG   TSEND                                                    02810000
TSEYR    DS    FL1                                                      02811000
TSEDAY   DS    FL2                                                      02812000
TSETIME  DS    FL4                                                      02813000
         ORG   TSTIMES+16                                               02814000
DOUBLEWD DS    CL8                                                      02815000
TODAY    DS    CL5                                                      02816000
PARMSW   DS    CL1                                                      02817000
PARMHOLD DS    CL31                                                     02818000
CKSEQ    DS    CL7                                                      02819000
FIXOUT   DS    CL13                                                     02820000
PARMERR  DS    BL1                                                      02821000
DATEINSW DS    BL1                                                      02822000
SELECTSW DS    BL1                                                      02823000
FIRSTSW  DS    BL1                                                      02824000
EOFSW    DS    BL1                                                      02825000
         DS    CL2                                                      02826000
ARRAY1   DS    CL2320                                                   02827000
         ORG   ARRAY1                                                   02828000
RWTBLE   DS    CL2320                                                   02829000
         ORG   RWTBLE                                                   02830000
BKT1     DS    116F                                                     02831000
BKT2     DS    116F                                                     02832000
BKT3     DS    116F                                                     02833000
BKT4     DS    116F                                                     02834000
BKT5     DS    116F                                                     02835000
         ORG   ARRAY1+2320                                              02836000
ARRAY1A  DS    CL928                                                    02837000
         ORG   ARRAY1A                                                  02838000
BKT6     DS    116F                                                     02839000
BKT7     DS    116F                                                     02840000
         ORG   ARRAY1A+928                                              02841000
ICGTRSUM CSECT                                                          02842000
         DS    0F                                                       02843000
@SIZDATD DC    AL1(0)                                                   02844000
         DC    AL3(@ENDDATD-@DATD)                                      02845000
         DS    0D                                                       02846000
@CC00740 DC    C'  :  :  '                                              02847000
@CC00795 DC    C'SDGXX   '                                              02848000
@CC00800 DC    C'       '                                               02849000
@CC00737 DC    C'  /   '                                                02850000
@CC00758 DC    C'TOTALS'                                                02851000
@CC00717 DC    C'000'                                                   02852000
@CC00726 EQU   @CC00795                                                 02853000
@CC00727 DC    C'27'                                                    02854000
@CC00668 DC    C'E'                                                     02855000
@CC00739 DC    C'N'                                                     02856000
@CC00741 EQU   @CC00795                                                 02857000
HDNG1    DS    CL121                                                    02858000
         ORG   HDNG1                                                    02859000
@NM00047 DC    CL36'1ICGTRSUM'                                          02860000
@NM00048 DC    CL65'MSS TRACE STAGING DRIVE GROUP ACTIVITY'             02861000
@NM00049 DC    CL20'DATE YYDDD  PAGEXXXX'                               02862000
         ORG   HDNG1+121                                                02863000
HDNG2    DS    CL121                                                    02864000
         ORG   HDNG2                                                    02865000
@NM00050 DC    CL1'0'                                                   02866000
@NM00051 DC    CL40'                           CYLINDERS   C'           02867000
@NM00052 DC    CL40'YL FAULT   CYLINDERS  SPACE ALLOC  TOTAL'           02868000
@NM00053 DC    CL40' STGNG  % TOTAL  % CARTG                '           02869000
         ORG   HDNG2+121                                                02870000
HDNG3    DS    CL121                                                    02871000
         ORG   HDNG3                                                    02872000
@NM00054 DC    CL1' '                                                   02873000
@NM00055 DC    CL40' DATE    TIME       SDG      STAGED     '           02874000
@NM00056 DC    CL40' CAUSED     DESTAGED     CAUSED      ACT'           02875000
@NM00057 DC    CL40'IVITY   T-SLICE  PRELOADED              '           02876000
         ORG   HDNG3+121                                                02877000
HDNGA    DS    CL121                                                    02878000
         ORG   HDNGA                                                    02879000
@NM00058 DC    CL35'1ICGTRSUM'                                          02880000
@NM00059 DC    CL66'MSS TRACE DATA RECORDING DEVICE ACTIVITY'           02881000
@NM00060 DC    CL20'DATE YYDDD  PAGEXXXX'                               02882000
         ORG   HDNGA+121                                                02883000
HDNGB    DS    CL121                                                    02884000
         ORG   HDNGB                                                    02885000
@NM00061 DC    CL1'0'                                                   02886000
@NM00062 DC    CL40'                           CYLINDERS   C'           02887000
@NM00063 DC    CL40'YL FAULT   CYLINDERS  SPACE ALLOC  TOTAL'           02888000
@NM00064 DC    CL40' STGNG  % TOTAL  CARTG   LOAD  EFFECTIVE'           02889000
         ORG   HDNGB+121                                                02890000
HDNGC    DS    CL121                                                    02891000
         ORG   HDNGC                                                    02892000
@NM00065 DC    CL1' '                                                   02893000
@NM00066 DC    CL40' DATE    TIME   MSF DRD      STAGED     '           02894000
@NM00067 DC    CL40' CAUSED     DESTAGED     CAUSED      ACT'           02895000
@NM00068 DC    CL40'IVITY   T-SLICE  LOADS   TIME CARTG RATE'           02896000
         ORG   HDNGC+121                                                02897000
RCDTOTAL DS    CL121                                                    02898000
         ORG   RCDTOTAL                                                 02899000
@NM00069 DC    CL1'1'                                                   02900000
@NM00070 DC    CL40'PARM OPTION - X  T-SLICE - XXX  DATES - '           02901000
@NM00071 DC    CL40'YYDDD-YYDDD  TIMES - HHMM-HHMM SSID-XXX '           02902000
@NM00072 DC    CL40' INPUT RECORDS SELECTED - XXXXXX        '           02903000
         ORG   RCDTOTAL+121                                             02904000
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'                       02905000
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'                    02906000
SEQMSG   DC    CL43'1ICG903I INPUT FILE TRACEIN OUT OF SEQUENCE'        02907000
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '                     02908000
         DS    CL3                                                      02909000
FIXAREA  DS    CL200                                                    02910000
         ORG   FIXAREA                                                  02911000
@NM00077 DC    200CL1'Z'                                                02912000
         ORG   FIXAREA+200                                              02913000
SSIDEQ   DC    CL1'0'                                                   02914000
         DC    CL1'1'                                                   02915000
         DC    CL1'2'                                                   02916000
         DC    CL1'3'                                                   02917000
         DC    CL1'4'                                                   02918000
         DC    CL1'5'                                                   02919000
         DC    CL1'6'                                                   02920000
         DC    CL1'7'                                                   02921000
         DC    CL1'8'                                                   02922000
         DC    CL1'9'                                                   02923000
         DC    CL1'A'                                                   02924000
         DC    CL1'B'                                                   02925000
         DC    CL1'C'                                                   02926000
         DC    CL1'D'                                                   02927000
         DC    CL1'E'                                                   02928000
         DC    CL1'F'                                                   02929000
ICGTRSUM CSECT                                                          02930000
*                                                         /*@Y30LB40*/  02931000
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=72,    **02932000
               EODAD=EOF,EROPT=SKP,SYNAD=READERR                        02933000
IDCBL    EQU   *-IPATDCB                                                02934000
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121    02935000
PDCBL    EQU   *-PPATDCB                                                02936000
@DATD    DSECT                                                          02937000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02938000
@ENDDATD EQU   *                                                        02939000
ICGTRSUM CSECT                                                          02940000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02941000
@01      EQU   01                                                       02942000
@02      EQU   02                                                       02943000
@03      EQU   03                                                       02944000
@04      EQU   04                                                       02945000
@05      EQU   05                                                       02946000
@06      EQU   06                                                       02947000
@07      EQU   07                                                       02948000
@08      EQU   08                                                       02949000
@09      EQU   09                                                       02950000
@10      EQU   10                                                       02951000
@11      EQU   11                                                       02952000
@12      EQU   12                                                       02953000
@13      EQU   13                                                       02954000
@14      EQU   14                                                       02955000
@15      EQU   15                                                       02956000
U        EQU   @08                                                      02957000
L        EQU   @07                                                      02958000
SS       EQU   @02                                                      02959000
CALCFLD2 EQU   @02                                                      02960000
PARMPTR  EQU   @03                                                      02961000
TIMEWORK EQU   @03                                                      02962000
SAVE14   EQU   @06                                                      02963000
K        EQU   @07                                                      02964000
J        EQU   @08                                                      02965000
I        EQU   @06                                                      02966000
R0       EQU   @00                                                      02967000
R1       EQU   @01                                                      02968000
R2       EQU   @02                                                      02969000
R3       EQU   @03                                                      02970000
R14      EQU   @14                                                      02971000
R15      EQU   @15                                                      02972000
IHADCB   EQU   0                                                        02973000
IHADCS05 EQU   0                                                        02974000
DCBMODE  EQU   IHADCS05                                                 02975000
DCBSTACK EQU   DCBMODE                                                  02976000
DCBFUNC  EQU   IHADCS05+3                                               02977000
IHADCS11 EQU   0                                                        02978000
DCBRELB  EQU   IHADCS11                                                 02979000
DCBREL   EQU   DCBRELB+1                                                02980000
DCBBUFCB EQU   IHADCS11+4                                               02981000
DCBDSORG EQU   IHADCS11+10                                              02982000
DCBDSRG1 EQU   DCBDSORG                                                 02983000
DCBDSRG2 EQU   DCBDSORG+1                                               02984000
DCBIOBAD EQU   IHADCS11+12                                              02985000
DCBODEB  EQU   DCBIOBAD                                                 02986000
DCBLNP   EQU   DCBODEB                                                  02987000
DCBQSLM  EQU   DCBLNP                                                   02988000
DCBIOBAA EQU   DCBODEB+1                                                02989000
IHADCS50 EQU   0                                                        02990000
DCBSVCXL EQU   IHADCS50                                                 02991000
DCBEODAD EQU   IHADCS50+4                                               02992000
DCBBFALN EQU   DCBEODAD                                                 02993000
DCBHIARC EQU   DCBBFALN                                                 02994000
DCBBFTEK EQU   DCBHIARC                                                 02995000
DCBBFT   EQU   DCBBFTEK                                                 02996000
DCBEXLST EQU   IHADCS50+8                                               02997000
DCBRECFM EQU   DCBEXLST                                                 02998000
DCBRECLA EQU   DCBRECFM                                                 02999000
IHADCS24 EQU   0                                                        03000000
DCBOFLGS EQU   IHADCS24+8                                               03001000
DCBOFLWR EQU   DCBOFLGS                                                 03002000
DCBIFLG  EQU   IHADCS24+9                                               03003000
DCBMACR  EQU   IHADCS24+10                                              03004000
DCBMACR1 EQU   DCBMACR                                                  03005000
DCBMRFE  EQU   DCBMACR1                                                 03006000
DCBMRGET EQU   DCBMRFE                                                  03007000
DCBMRAPG EQU   DCBMACR1                                                 03008000
DCBMRRD  EQU   DCBMRAPG                                                 03009000
DCBMRCI  EQU   DCBMACR1                                                 03010000
DCBMRMVG EQU   DCBMRCI                                                  03011000
DCBMRLCG EQU   DCBMACR1                                                 03012000
DCBMRABC EQU   DCBMACR1                                                 03013000
DCBMRPT1 EQU   DCBMRABC                                                 03014000
DCBMRSBG EQU   DCBMRPT1                                                 03015000
DCBMRCRL EQU   DCBMACR1                                                 03016000
DCBMRCHK EQU   DCBMRCRL                                                 03017000
DCBMRRDX EQU   DCBMRCHK                                                 03018000
DCBMRDMG EQU   DCBMACR1                                                 03019000
DCBMACR2 EQU   DCBMACR+1                                                03020000
DCBMRPUT EQU   DCBMACR2                                                 03021000
DCBMRWRT EQU   DCBMACR2                                                 03022000
DCBMRMVP EQU   DCBMACR2                                                 03023000
DCBMR5WD EQU   DCBMACR2                                                 03024000
DCBMRLDM EQU   DCBMR5WD                                                 03025000
DCBMRLCP EQU   DCBMRLDM                                                 03026000
DCBMR4WD EQU   DCBMACR2                                                 03027000
DCBMRPT2 EQU   DCBMR4WD                                                 03028000
DCBMRTMD EQU   DCBMRPT2                                                 03029000
DCBMR3WD EQU   DCBMACR2                                                 03030000
DCBMRCTL EQU   DCBMR3WD                                                 03031000
DCBMRSTK EQU   DCBMRCTL                                                 03032000
DCBMR1WD EQU   DCBMACR2                                                 03033000
DCBMRSWA EQU   DCBMR1WD                                                 03034000
DCBMRDMD EQU   DCBMRSWA                                                 03035000
IHADCS25 EQU   0                                                        03036000
DCBMACRF EQU   IHADCS25+2                                               03037000
DCBMACF1 EQU   DCBMACRF                                                 03038000
DCBMFFE  EQU   DCBMACF1                                                 03039000
DCBMFGET EQU   DCBMFFE                                                  03040000
DCBMFAPG EQU   DCBMACF1                                                 03041000
DCBMFRD  EQU   DCBMFAPG                                                 03042000
DCBMFCI  EQU   DCBMACF1                                                 03043000
DCBMFMVG EQU   DCBMFCI                                                  03044000
DCBMFLCG EQU   DCBMACF1                                                 03045000
DCBMFABC EQU   DCBMACF1                                                 03046000
DCBMFPT1 EQU   DCBMFABC                                                 03047000
DCBMFSBG EQU   DCBMFPT1                                                 03048000
DCBMFCRL EQU   DCBMACF1                                                 03049000
DCBMFCHK EQU   DCBMFCRL                                                 03050000
DCBMFDMG EQU   DCBMACF1                                                 03051000
DCBMACF2 EQU   DCBMACRF+1                                               03052000
DCBMFPUT EQU   DCBMACF2                                                 03053000
DCBMFWRT EQU   DCBMACF2                                                 03054000
DCBMFMVP EQU   DCBMACF2                                                 03055000
DCBMF5WD EQU   DCBMACF2                                                 03056000
DCBMFLDM EQU   DCBMF5WD                                                 03057000
DCBMFLCP EQU   DCBMFLDM                                                 03058000
DCBMF4WD EQU   DCBMACF2                                                 03059000
DCBMFPT2 EQU   DCBMF4WD                                                 03060000
DCBMFTMD EQU   DCBMFPT2                                                 03061000
DCBMF3WD EQU   DCBMACF2                                                 03062000
DCBMFCTL EQU   DCBMF3WD                                                 03063000
DCBMFSTK EQU   DCBMFCTL                                                 03064000
DCBMF1WD EQU   DCBMACF2                                                 03065000
DCBMFSWA EQU   DCBMF1WD                                                 03066000
DCBMFDMD EQU   DCBMFSWA                                                 03067000
DCBDEBAD EQU   IHADCS25+4                                               03068000
DCBIFLGS EQU   DCBDEBAD                                                 03069000
IHADCS26 EQU   0                                                        03070000
DCBWRITE EQU   IHADCS26                                                 03071000
DCBREAD  EQU   DCBWRITE                                                 03072000
DCBWRITA EQU   DCBREAD+1                                                03073000
IHADCS27 EQU   0                                                        03074000
DCBGET   EQU   IHADCS27                                                 03075000
DCBPUT   EQU   DCBGET                                                   03076000
DCBGETA  EQU   DCBPUT+1                                                 03077000
IHADCS36 EQU   0                                                        03078000
DCBGERR  EQU   IHADCS36                                                 03079000
DCBPERR  EQU   DCBGERR                                                  03080000
DCBCHECK EQU   DCBPERR                                                  03081000
DCBOPTCD EQU   DCBCHECK                                                 03082000
DCBOPTH  EQU   DCBOPTCD                                                 03083000
DCBOPTO  EQU   DCBOPTH                                                  03084000
DCBOPTZ  EQU   DCBOPTCD                                                 03085000
DCBGERRA EQU   DCBCHECK+1                                               03086000
DCBPERRA EQU   DCBGERRA                                                 03087000
DCBSYNAD EQU   IHADCS36+4                                               03088000
DCBCIND1 EQU   IHADCS36+8                                               03089000
DCBCIND2 EQU   IHADCS36+9                                               03090000
DCBIOBA  EQU   IHADCS36+16                                              03091000
DCBCICB  EQU   DCBIOBA                                                  03092000
IHADCS52 EQU   0                                                        03093000
DCBDIRCT EQU   IHADCS52                                                 03094000
DCBQSWS  EQU   DCBDIRCT                                                 03095000
DCBUSASI EQU   DCBQSWS                                                  03096000
DCBQADFS EQU   DCBUSASI                                                 03097000
DCBBUFOF EQU   DCBDIRCT+1                                               03098000
IHADCS37 EQU   0                                                        03099000
DCBFLAG1 EQU   IHADCS37                                                 03100000
IHADCS38 EQU   0                                                        03101000
DCBEOBR  EQU   IHADCS38                                                 03102000
DCBPOINT EQU   IHADCS38+12                                              03103000
DCBCNTRL EQU   DCBPOINT                                                 03104000
IHADCS40 EQU   0                                                        03105000
DCBEOBAD EQU   IHADCS40                                                 03106000
DCBCCCW  EQU   IHADCS40+4                                               03107000
DCBRECAD EQU   DCBCCCW                                                  03108000
DCBRECBT EQU   DCBRECAD                                                 03109000
DCBRCREL EQU   DCBRECBT                                                 03110000
@NM00026 EQU   IHADCS40+12                                              03111000
DCBEROPT EQU   @NM00026                                                 03112000
PARMVALS EQU   0                                                        03113000
PARMLEN  EQU   PARMVALS                                                 03114000
PARMS    EQU   PARMVALS+2                                               03115000
FIXADDR  EQU   0                                                        03116000
FIXLEN   EQU   0                                                        03117000
FIXOPT   EQU   0                                                        03118000
RW       EQU   SDGID                                                    03119000
DRDSSID  EQU   RW                                                       03120000
CHAR2    EQU   DRDSSID                                                  03121000
DRDMSFID EQU   DRDSSID+1                                                03122000
RWFLD6   EQU   DRDSSID+2                                                03123000
RWLINE   EQU   FLD16                                                    03124000
RWFLD18  EQU   RWLINE+6                                                 03125000
RWFLD20  EQU   RWLINE+13                                                03126000
RWFLD22  EQU   RWLINE+22                                                03127000
ARRAY2   EQU   ARRAY1A                                                  03128000
DSTABLE  EQU   ARRAY2                                                   03129000
DSBKT6   EQU   DSTABLE                                                  03130000
DSBKT7   EQU   DSTABLE+464                                              03131000
*                                      START UNREFERENCED COMPONENTS    03132000
@NM00046 EQU   RWLINE+28                                                03133000
@NM00045 EQU   RWLINE+19                                                03134000
@NM00044 EQU   RWLINE+12                                                03135000
@NM00043 EQU   RWLINE                                                   03136000
DCBEOB   EQU   IHADCS40+20                                              03137000
DCBPRECL EQU   IHADCS40+18                                              03138000
@NM00029 EQU   IHADCS40+16                                              03139000
@NM00028 EQU   @NM00026+1                                               03140000
@NM00027 EQU   DCBEROPT                                                 03141000
DCBERABE EQU   DCBEROPT                                                 03142000
DCBERSKP EQU   DCBEROPT                                                 03143000
DCBERACC EQU   DCBEROPT                                                 03144000
@NM00025 EQU   IHADCS40+10                                              03145000
@NM00024 EQU   IHADCS40+9                                               03146000
@NM00023 EQU   IHADCS40+8                                               03147000
DCBRECA  EQU   DCBRECAD+1                                               03148000
@NM00022 EQU   DCBRECBT                                                 03149000
DCBRCFGT EQU   DCBRCREL                                                 03150000
DCBRCTRU EQU   DCBRCREL                                                 03151000
DCBLCCW  EQU   DCBEOBAD                                                 03152000
DCBNOTE  EQU   DCBCNTRL                                                 03153000
DCBLRECL EQU   IHADCS38+10                                              03154000
@NM00021 EQU   IHADCS38+8                                               03155000
DCBEOBW  EQU   IHADCS38+4                                               03156000
DCBEOBRA EQU   DCBEOBR+1                                                03157000
DCBNCP   EQU   DCBEOBR                                                  03158000
@NM00020 EQU   DCBFLAG1                                                 03159000
DCBSTFLS EQU   DCBFLAG1                                                 03160000
DCBSTQCK EQU   DCBFLAG1                                                 03161000
DCBDIRCQ EQU   DCBBUFOF                                                 03162000
DCBQSTRU EQU   DCBUSASI                                                 03163000
@NM00019 EQU   DCBUSASI                                                 03164000
DCBQADF3 EQU   DCBQADFS                                                 03165000
DCBQADF2 EQU   DCBQADFS                                                 03166000
DCBQADF1 EQU   DCBQADFS                                                 03167000
DCBBLBP  EQU   DCBUSASI                                                 03168000
@NM00018 EQU   DCBUSASI                                                 03169000
DCBCICBA EQU   DCBCICB+1                                                03170000
@NM00017 EQU   DCBCICB                                                  03171000
DCBOFFSW EQU   IHADCS36+15                                              03172000
DCBOFFSR EQU   IHADCS36+14                                              03173000
DCBWCPL  EQU   IHADCS36+13                                              03174000
DCBWCPO  EQU   IHADCS36+12                                              03175000
DCBBLKSI EQU   IHADCS36+10                                              03176000
DCBCNQSM EQU   DCBCIND2                                                 03177000
DCBCNFEO EQU   DCBCIND2                                                 03178000
DCBCNCHS EQU   DCBCIND2                                                 03179000
DCBCNBFP EQU   DCBCIND2                                                 03180000
DCBCNIOE EQU   DCBCIND2                                                 03181000
DCBCNCLO EQU   DCBCIND2                                                 03182000
DCBCNWRO EQU   DCBCIND2                                                 03183000
DCBCNSTO EQU   DCBCIND2                                                 03184000
DCBCNEXB EQU   DCBCIND1                                                 03185000
@NM00016 EQU   DCBCIND1                                                 03186000
DCBCNBRM EQU   DCBCIND1                                                 03187000
@NM00015 EQU   DCBCIND1                                                 03188000
DCBCNEVA EQU   DCBCIND1                                                 03189000
DCBCNEVB EQU   DCBCIND1                                                 03190000
DCBCNSRD EQU   DCBCIND1                                                 03191000
DCBCNTOV EQU   DCBCIND1                                                 03192000
DCBSYNA  EQU   DCBSYNAD+1                                               03193000
DCBIOBL  EQU   DCBSYNAD                                                 03194000
DCBCHCKA EQU   DCBPERRA                                                 03195000
@NM00014 EQU   DCBOPTCD                                                 03196000
DCBOPTT  EQU   DCBOPTCD                                                 03197000
DCBSRCHD EQU   DCBOPTZ                                                  03198000
DCBOPTQ  EQU   DCBOPTCD                                                 03199000
DCBBCKPT EQU   DCBOPTO                                                  03200000
DCBOPTC  EQU   DCBOPTCD                                                 03201000
DCBOPTU  EQU   DCBOPTCD                                                 03202000
DCBOPTW  EQU   DCBOPTCD                                                 03203000
DCBPUTA  EQU   DCBGETA                                                  03204000
@NM00013 EQU   DCBPUT                                                   03205000
DCBREADA EQU   DCBWRITA                                                 03206000
@NM00012 EQU   DCBREAD                                                  03207000
DCBDEBA  EQU   DCBDEBAD+1                                               03208000
@NM00011 EQU   DCBIFLGS                                                 03209000
DCBIFIOE EQU   DCBIFLGS                                                 03210000
DCBIFPCT EQU   DCBIFLGS                                                 03211000
DCBIFEC  EQU   DCBIFLGS                                                 03212000
DCBMFSTI EQU   DCBMFDMD                                                 03213000
DCBMFAWR EQU   DCBMFSTK                                                 03214000
DCBMFUIP EQU   DCBMFTMD                                                 03215000
DCBMFIDW EQU   DCBMFLCP                                                 03216000
DCBMFWRK EQU   DCBMFMVP                                                 03217000
DCBMFRDQ EQU   DCBMFWRT                                                 03218000
DCBMFGTQ EQU   DCBMFPUT                                                 03219000
DCBMFSTL EQU   DCBMACF2                                                 03220000
DCBMFCK  EQU   DCBMFDMG                                                 03221000
DCBMFRDX EQU   DCBMFCHK                                                 03222000
DCBMFDBF EQU   DCBMFSBG                                                 03223000
DCBMFRDI EQU   DCBMFLCG                                                 03224000
DCBMFRDK EQU   DCBMFMVG                                                 03225000
DCBMFWRQ EQU   DCBMFRD                                                  03226000
DCBMFPTQ EQU   DCBMFGET                                                 03227000
DCBMFECP EQU   DCBMACF1                                                 03228000
DCBTIOT  EQU   IHADCS25                                                 03229000
DCBMRSTI EQU   DCBMRDMD                                                 03230000
DCBMRAWR EQU   DCBMRSTK                                                 03231000
DCBMRUIP EQU   DCBMRTMD                                                 03232000
DCBMRIDW EQU   DCBMRLCP                                                 03233000
DCBMRWRK EQU   DCBMRMVP                                                 03234000
DCBMRRDQ EQU   DCBMRWRT                                                 03235000
DCBMRGTQ EQU   DCBMRPUT                                                 03236000
DCBMRSTL EQU   DCBMACR2                                                 03237000
DCBMRCK  EQU   DCBMRDMG                                                 03238000
DCBPGFXA EQU   DCBMRRDX                                                 03239000
DCBMRDBF EQU   DCBMRSBG                                                 03240000
DCBMRRDI EQU   DCBMRLCG                                                 03241000
DCBMRRDK EQU   DCBMRMVG                                                 03242000
DCBMRWRQ EQU   DCBMRRD                                                  03243000
DCBMRPTQ EQU   DCBMRGET                                                 03244000
DCBMRECP EQU   DCBMACR1                                                 03245000
@NM00010 EQU   DCBIFLG                                                  03246000
DCBIBIOE EQU   DCBIFLG                                                  03247000
DCBIBPCT EQU   DCBIFLG                                                  03248000
DCBIBEC  EQU   DCBIFLG                                                  03249000
DCBOFIOF EQU   DCBOFLGS                                                 03250000
DCBOFUEX EQU   DCBOFLGS                                                 03251000
DCBOFTM  EQU   DCBOFLGS                                                 03252000
DCBOFPPC EQU   DCBOFLGS                                                 03253000
DCBOFOPN EQU   DCBOFLGS                                                 03254000
DCBOFEOV EQU   DCBOFLGS                                                 03255000
DCBOFLRB EQU   DCBOFLGS                                                 03256000
DCBOFIOD EQU   DCBOFLWR                                                 03257000
DCBDDNAM EQU   IHADCS24                                                 03258000
DCBEXLSA EQU   DCBEXLST+1                                               03259000
DCBRECKL EQU   DCBRECFM                                                 03260000
DCBRECCC EQU   DCBRECFM                                                 03261000
DCBRECSB EQU   DCBRECFM                                                 03262000
DCBRECBR EQU   DCBRECFM                                                 03263000
DCBRECTO EQU   DCBRECLA                                                 03264000
DCBRECL  EQU   DCBRECLA                                                 03265000
DCBEODA  EQU   DCBEODAD+1                                               03266000
DCBBFA   EQU   DCBBFTEK                                                 03267000
DCBH0    EQU   DCBBFTEK                                                 03268000
DCBBFTKD EQU   DCBBFTEK                                                 03269000
DCBBFTE  EQU   DCBBFT                                                   03270000
DCBBFTKR EQU   DCBBFT                                                   03271000
DCBBFTS  EQU   DCBBFT                                                   03272000
DCBH1    EQU   DCBBFTEK                                                 03273000
DCBSVCXA EQU   DCBSVCXL+1                                               03274000
@NM00009 EQU   DCBSVCXL                                                 03275000
DCBODEBA EQU   DCBIOBAA                                                 03276000
@NM00008 EQU   DCBQSLM                                                  03277000
DCBUPDBT EQU   DCBQSLM                                                  03278000
DCBUPDCM EQU   DCBQSLM                                                  03279000
DCB1DVDS EQU   DCBQSLM                                                  03280000
@NM00007 EQU   DCBDSRG2                                                 03281000
DCBDSGTR EQU   DCBDSRG2                                                 03282000
DCBACBM  EQU   DCBDSRG2                                                 03283000
@NM00006 EQU   DCBDSRG2                                                 03284000
DCBDSGTQ EQU   DCBDSRG2                                                 03285000
DCBDSGTX EQU   DCBDSRG2                                                 03286000
DCBDSGGS EQU   DCBDSRG2                                                 03287000
DCBDSGU  EQU   DCBDSRG1                                                 03288000
DCBDSGPO EQU   DCBDSRG1                                                 03289000
DCBDSGMQ EQU   DCBDSRG1                                                 03290000
DCBDSGCQ EQU   DCBDSRG1                                                 03291000
DCBDSGCX EQU   DCBDSRG1                                                 03292000
DCBDSGDA EQU   DCBDSRG1                                                 03293000
DCBDSGPS EQU   DCBDSRG1                                                 03294000
DCBDSGIS EQU   DCBDSRG1                                                 03295000
DCBBUFL  EQU   IHADCS11+8                                               03296000
DCBBUFCA EQU   DCBBUFCB+1                                               03297000
DCBBUFNO EQU   DCBBUFCB                                                 03298000
DCBDEVT  EQU   DCBREL                                                   03299000
DCBKEYLE EQU   DCBRELB                                                  03300000
@NM00005 EQU   DCBFUNC                                                  03301000
DCBFNCBT EQU   DCBFUNC                                                  03302000
DCBFNCBX EQU   DCBFUNC                                                  03303000
DCBFNCBD EQU   DCBFUNC                                                  03304000
DCBFNCBW EQU   DCBFUNC                                                  03305000
DCBFNCBP EQU   DCBFUNC                                                  03306000
DCBFNCBR EQU   DCBFUNC                                                  03307000
DCBFNCBI EQU   DCBFUNC                                                  03308000
@NM00004 EQU   IHADCS05+2                                               03309000
@NM00003 EQU   IHADCS05+1                                               03310000
DCBSTCK1 EQU   DCBSTACK                                                 03311000
DCBSTCK2 EQU   DCBSTACK                                                 03312000
@NM00002 EQU   DCBSTACK                                                 03313000
DCBMODER EQU   DCBSTACK                                                 03314000
DCBMODEO EQU   DCBSTACK                                                 03315000
DCBMODEE EQU   DCBSTACK                                                 03316000
DCBMODEC EQU   DCBSTACK                                                 03317000
@NM00001 EQU   IHADCB                                                   03318000
*                                      END UNREFERENCED COMPONENTS      03319000
@RT00092 EQU   CLOSEFIL                                                 03320000
@RT00096 EQU   CLOSEFIL                                                 03321000
@RT00110 EQU   RDTRACE                                                  03322000
@RT00115 EQU   RDTRACE                                                  03323000
@RT00119 EQU   RDTRACE                                                  03324000
@RT00122 EQU   RDTRACE                                                  03325000
@RC00157 EQU   RDTRACE                                                  03326000
@RF00218 EQU   @EL00003                                                 03327000
@RT00259 EQU   PARMEND                                                  03328000
@RT00279 EQU   PARMEND                                                  03329000
@RF00294 EQU   @RC00292                                                 03330000
@RF00304 EQU   @RC00302                                                 03331000
@RT00318 EQU   PARMEND                                                  03332000
@RT00331 EQU   PARMEND                                                  03333000
@RT00360 EQU   PARMEND                                                  03334000
@RC00368 EQU   @RC00366                                                 03335000
@RF00404 EQU   @EL00004                                                 03336000
@RC00511 EQU   @EL00009                                                 03337000
@RC00673 EQU   @RC00672                                                 03338000
@RT00712 EQU   EF4                                                      03339000
EFEND    EQU   @EL00017                                                 03340000
@RT00710 EQU   EFEND                                                    03341000
@ENDDATA EQU   *                                                        03342000
         END   ICGTRSUM,(C'PLS1449',0603,77089)                         03343000
./  ADD  SSI=61980338,NAME=ICGTRVID
         TITLE '***** ICGTRVID MSS TRACE VOLUME IDENTIFICATION REPORT **00001000
               *****    '                                               00002000
ICGTRVID CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGTRVID  76.198'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@11                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @10,@01                                             0001 00017000
         USING @DATD,@10                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @10,8(,@13)                                         0001 00021000
         LR    @13,@10                                             0001 00022000
         L     R1,0(R1)                                                 00023000
*   PARMPTR=R1;                     /* SAVE PTR TO PARMS     @Y30LB40*/ 00024000
         ST    R1,PARMPTR                                          0077 00025000
*   RFY                                                            0078 00026000
*     R1 UNRSTD;                    /*                       @Y30LB40*/ 00027000
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/ 00028000
         SLR   @15,@15                                             0079 00029000
         ST    @15,RCDCOUNT                                        0079 00030000
*   RETURNCD=0;                     /*                       @Y30LB40*/ 00031000
         LR    RETURNCD,@15                                        0080 00032000
*   TIMESL=600;                     /*                       @Y30LB40*/ 00033000
         MVC   TIMESL(4),@CF00631                                  0081 00034000
*   HOUR=0;                         /*                       @Y30LB40*/ 00035000
         ST    @15,HOUR                                            0082 00036000
*   MINUTE=0;                       /*                       @Y30LB40*/ 00037000
         ST    @15,MINUTE                                          0083 00038000
*   SECOND=0;                       /*                       @Y30LB40*/ 00039000
         ST    @15,SECOND                                          0084 00040000
*   LINECNT=56;                     /*                       @Y30LB40*/ 00041000
         LA    LINECNT,56                                          0085 00042000
*   OPENCLOS=0;                     /*                       @Y30LB40*/ 00043000
         ST    @15,OPENCLOS                                        0086 00044000
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/ 00045000
         MVI   OPCLB1,B'10000000'                                  0087 00046000
*   PAGECNT=0;                      /*                       @Y30LB40*/ 00047000
         ST    @15,PAGECNT                                         0088 00048000
*   EOFSW='0'B;                     /*                       @Y30LB40*/ 00049000
         NI    EOFSW,B'01111111'                                   0089 00050000
*   HLDSYR=0;                       /*                       @Y30LB40*/ 00051000
         MVI   HLDSYR,X'00'                                        0090 00052000
*   HLDSDAY=1;                      /*                       @Y30LB40*/ 00053000
         LA    @14,1                                               0091 00054000
         STH   @14,HLDSDAY                                         0091 00055000
*   HLDSTIME=0;                     /*                       @Y30LB40*/ 00056000
         ST    @15,HLDSTIME                                        0092 00057000
*   HLDEYR=99;                      /*                       @Y30LB40*/ 00058000
         MVI   HLDEYR,X'63'                                        0093 00059000
*   HLDEDAY=365;                    /*                       @Y30LB40*/ 00060000
         MVC   HLDEDAY(2),@CH00636                                 0094 00061000
*   HLDETIME=86399;                 /*                       @Y30LB40*/ 00062000
         MVC   HLDETIME(4),@CF00637                                0095 00063000
*   FIRSTSW='1'B;                   /*                       @Y30LB40*/ 00064000
         OI    FIRSTSW,B'10000000'                                 0096 00065000
*   PARMERR='0'B;                   /*                       @Y30LB40*/ 00066000
         NI    PARMERR,B'01111111'                                 0097 00067000
*   DATEINSW='0'B;                  /*                       @Y30LB40*/ 00068000
         NI    DATEINSW,B'01111111'                                0098 00069000
*   VOL=' ';                        /*                       @Y30LB40*/ 00070000
         MVI   VOL+1,C' '                                          0099 00071000
         MVC   VOL+2(4),VOL+1                                      0099 00072000
         MVI   VOL,C' '                                            0099 00073000
*   LIBSW='0'B;                     /*                       @Y30LB40*/ 00074000
         NI    LIBSW,B'01111111'                                   0100 00075000
*   VOLSW='0'B;                     /*                       @Y30LB40*/ 00076000
         NI    VOLSW,B'01111111'                                   0101 00077000
*   TMESW='0'B;                     /*                       @Y30LB40*/ 00078000
         NI    TMESW,B'01111111'                                   0102 00079000
*   SPACE1=' ';                     /*                       @Y30LB40*/ 00080000
         MVI   SPACE1+1,C' '                                       0103 00081000
         MVC   SPACE1+2(119),SPACE1+1                              0103 00082000
         MVI   SPACE1,C' '                                         0103 00083000
*   DO I=1 TO 2;                    /*                       @Y30LB40*/ 00084000
         LR    I,@14                                               0104 00085000
@DL00104 DS    0H                                                  0105 00086000
*     DO J=1 TO 2;                  /*                       @Y30LB40*/ 00087000
         LA    J,1                                                 0105 00088000
@DL00105 DS    0H                                                  0106 00089000
*       SMSTGD(I,J)=0;              /*                       @Y30LB40*/ 00090000
         SLR   @15,@15                                             0106 00091000
         LR    @14,I                                               0106 00092000
         ALR   @14,@14                                             0106 00093000
         ALR   @14,J                                               0106 00094000
         MH    @14,@CH00729                                        0106 00095000
         ST    @15,SMSTGD-108(@14)                                 0106 00096000
*       SMCFAULT(I,J)=0;            /*                       @Y30LB40*/ 00097000
         ST    @15,SMCFAULT-108(@14)                               0107 00098000
*       SMDSTGD(I,J)=0;             /*                       @Y30LB40*/ 00099000
         ST    @15,SMDSTGD-108(@14)                                0108 00100000
*       SMSALLOC(I,J)=0;            /*                       @Y30LB40*/ 00101000
         ST    @15,SMSALLOC-108(@14)                               0109 00102000
*       LOADS(I,J)=0;               /*                       @Y30LB40*/ 00103000
         ST    @15,LOADS-108(@14)                                  0110 00104000
*       STGDTOT(I,J)=0;             /*                       @Y30LB40*/ 00105000
         ST    @15,STGDTOT-108(@14)                                0111 00106000
*       VTOCSG(I,J)=0;              /*                       @Y30LB40*/ 00107000
         ST    @15,VTOCSG-108(@14)                                 0112 00108000
*       DSTGDTOT(I,J)=0;            /*                       @Y30LB40*/ 00109000
         ST    @15,DSTGDTOT-108(@14)                               0113 00110000
*       VTOCDS(I,J)=0;              /*                       @Y30LB40*/ 00111000
         ST    @15,VTOCDS-108(@14)                                 0114 00112000
*     END;                          /*                       @Y30LB40*/ 00113000
         AL    J,@CF00043                                          0115 00114000
         C     J,@CF00050                                          0115 00115000
         BNH   @DL00105                                            0115 00116000
*   END;                            /*                       @Y30LB40*/ 00117000
         AL    I,@CF00043                                          0116 00118000
         C     I,@CF00050                                          0116 00119000
         BNH   @DL00104                                            0116 00120000
*   SEQOLD=SEQOLD&&SEQOLD;          /*                       @Y30LB40*/ 00121000
         XC    SEQOLD(14),SEQOLD                                   0117 00122000
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/ 00123000
         MVC   PRNTDCB(PDCBL),PPATDCB                                   00124000
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/ 00125000
         MVC   INDCB(IDCBL),IPATDCB                                     00126000
*   RFY                                                            0120 00127000
*    (R0,                                                          0120 00128000
*     R1,                                                          0120 00129000
*     R14,                                                         0120 00130000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00131000
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */ 00132000
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)                       00133000
*   RFY                                                            0122 00134000
*    (R0,                                                          0122 00135000
*     R1,                                                          0122 00136000
*     R14,                                                         0122 00137000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00138000
*   IF(PRNTDCB(49:49)&'00010000'B)¬='00010000'B THEN               0123 00139000
         MVC   @TS00001(1),PRNTDCB+48                              0123 00140000
         NI    @TS00001,B'00010000'                                0123 00141000
         CLI   @TS00001,B'00010000'                                0123 00142000
         BE    @RF00123                                            0123 00143000
*     DO;                           /* IF OPEN BAD EXIT WITH RC=4  0124 00144000
*                                                            @Y30LB40*/ 00145000
*       RETURN CODE(4);             /*                       @Y30LB40*/ 00146000
         L     @13,4(,@13)                                         0125 00147000
         L     @00,@SIZDATD                                        0125 00148000
         LR    @01,@10                                             0125 00149000
         FREEMAIN R,LV=(0),A=(1)                                        00150000
         LA    @15,4                                               0125 00151000
         L     @14,12(,@13)                                        0125 00152000
         LM    @00,@12,20(@13)                                     0125 00153000
         BR    @14                                                 0125 00154000
*     END;                          /*                       @Y30LB40*/ 00155000
*   RFY                                                            0127 00156000
*    (R0,                                                          0127 00157000
*     R1,                                                          0127 00158000
*     R14,                                                         0127 00159000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00160000
@RF00123 DS    0H                                                  0128 00161000
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */ 00162000
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)                          00163000
*   RFY                                                            0129 00164000
*    (R0,                                                          0129 00165000
*     R1,                                                          0129 00166000
*     R14,                                                         0129 00167000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00168000
*   IF(INDCB(49:49)&'00010000'B)¬='00010000'B THEN                 0130 00169000
         MVC   @TS00001(1),INDCB+48                                0130 00170000
         NI    @TS00001,B'00010000'                                0130 00171000
         CLI   @TS00001,B'00010000'                                0130 00172000
         BE    @RF00130                                            0130 00173000
*     DO;                           /* IF OPEN BAD,PRINT ERROR MSG 0131 00174000
*                                      AND EXIT WITH RC=8            */ 00175000
*       PRINTLN=TRINMSG;            /*                       @Y30LB40*/ 00176000
         MVI   PRINTLN+31,C' '                                     0132 00177000
         MVC   PRINTLN+32(89),PRINTLN+31                           0132 00178000
         MVC   PRINTLN(31),TRINMSG                                 0132 00179000
*       RFY                                                        0133 00180000
*        (R0,                                                      0133 00181000
*         R1,                                                      0133 00182000
*         R14,                                                     0133 00183000
*         R15) RSTD;                /*                       @Y30LB40*/ 00184000
*       GEN(PUT   PRNTDCB,PRINTLN); /*                       @Y30LB40*/ 00185000
         PUT   PRNTDCB,PRINTLN                                          00186000
*       RFY                                                        0135 00187000
*        (R0,                                                      0135 00188000
*         R1,                                                      0135 00189000
*         R14,                                                     0135 00190000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00191000
*       RETURNCD=8;                 /*                       @Y30LB40*/ 00192000
         LA    RETURNCD,8                                          0136 00193000
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/ 00194000
         B     CLOSEFIL                                            0137 00195000
*     END;                          /*                       @Y30LB40*/ 00196000
*   IF PARMLEN=0 THEN                                              0139 00197000
@RF00130 L     @01,PARMPTR                                         0139 00198000
         LH    @15,PARMLEN(,@01)                                   0139 00199000
         LTR   @15,@15                                             0139 00200000
         BZ    @RT00139                                            0139 00201000
*     GO TO PARMEND;                /* IF NO PARMS BYPASS PROCESS    */ 00202000
*   IF PARMLEN>30                   /* ARE PARMS TOO LONG    @Y30LB40*/ 00203000
*     THEN                                                         0141 00204000
         C     @15,@CF00539                                        0141 00205000
         BNH   @RF00141                                            0141 00206000
*     DO;                           /* YES,SET ERROR SWITCH AND EXIT    00207000
*                                                            @Y30LB40*/ 00208000
*       PARMERR='1'B;               /*                       @Y30LB40*/ 00209000
         OI    PARMERR,B'10000000'                                 0143 00210000
*       GO TO PARMEND;              /*                       @Y30LB40*/ 00211000
         B     PARMEND                                             0144 00212000
*     END;                          /*                       @Y30LB40*/ 00213000
*   PARMHOLD(1:1)=',';              /* SET PARMHOLD TO ALL COMMAS  0146 00214000
*                                                            @Y30LB40*/ 00215000
@RF00141 MVI   PARMHOLD,C','                                       0146 00216000
*   MVC(PARMHOLD(2:31),PARMHOLD);   /*                       @Y30LB40*/ 00217000
         MVC   PARMHOLD+1(30),PARMHOLD                             0147 00218000
*   SS=1;                           /* SET SUBSTRING PTR TO 1      0148 00219000
*                                                            @Y30LB40*/ 00220000
         LA    @15,1                                               0148 00221000
         LR    SS,@15                                              0148 00222000
*   PARMHOLD(1:PARMLEN)=PARMS;      /* MOVE PARMS TO PARMHOLD      0149 00223000
*                                                            @Y30LB40*/ 00224000
         L     @03,PARMPTR                                         0149 00225000
         LH    @14,PARMLEN(,@03)                                   0149 00226000
         BCTR  @14,0                                               0149 00227000
         EX    @14,@SM00738                                        0149 00228000
*   IF PARMHOLD(SS:SS)=','          /* WAS TIME SLICE ENTERED      0150 00229000
*                                                            @Y30LB40*/ 00230000
*     THEN                                                         0150 00231000
         LA    @03,PARMHOLD-1(SS)                                  0150 00232000
         CLI   0(@03),C','                                         0150 00233000
         BNE   @RF00150                                            0150 00234000
*     SS=SS+1;                      /* NO, BUMP POINTER      @Y30LB40*/ 00235000
         ALR   SS,@15                                              0151 00236000
*   ELSE                                                           0152 00237000
*     DO;                           /* YES,VALIDATE AND CONVERT TIME    00238000
*                                      SLICE                         */ 00239000
         B     @RC00150                                            0152 00240000
@RF00150 DS    0H                                                  0153 00241000
*       DO J=SS TO(SS+2);           /* CHECK FOR NUMERICS    @Y30LB40*/ 00242000
         LR    J,SS                                                0153 00243000
         B     @DE00153                                            0153 00244000
@DL00153 DS    0H                                                  0154 00245000
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0154 00246000
         LA    @07,PARMHOLD-1(J)                                   0154 00247000
         CLI   0(@07),C'0'                                         0154 00248000
         BL    @RF00154                                            0154 00249000
         LA    @07,PARMHOLD-1(J)                                   0154 00250000
         CLI   0(@07),C'9'                                         0154 00251000
         BNH   @RT00154                                            0154 00252000
*           ;                       /*                       @Y30LB40*/ 00253000
*         ELSE                                                     0156 00254000
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0156 00255000
*                                                            @Y30LB40*/ 00256000
@RF00154 OI    PARMERR,B'10000000'                                 0156 00257000
*       END;                        /*                       @Y30LB40*/ 00258000
@RT00154 AL    J,@CF00043                                          0157 00259000
@DE00153 LA    @07,2                                               0157 00260000
         ALR   @07,SS                                              0157 00261000
         CR    J,@07                                               0157 00262000
         BNH   @DL00153                                            0157 00263000
*       IF PARMERR='1'B THEN                                       0158 00264000
         TM    PARMERR,B'10000000'                                 0158 00265000
         BO    @RT00158                                            0158 00266000
*         GO TO PARMEND;            /* IF ERROR EXIT         @Y30LB40*/ 00267000
*       IF PARMHOLD(SS:SS+2)='000'  /* TIME SLICE 000 NOT ALLOWED    */ 00268000
*         THEN                                                     0160 00269000
         LA    @03,PARMHOLD-1(SS)                                  0160 00270000
         CLC   0(3,@03),@CC00646                                   0160 00271000
         BNE   @RF00160                                            0160 00272000
*         DO;                       /*                       @Y30LB40*/ 00273000
*           PARMERR='1'B;           /* SET ERROR AND EXIT    @Y30LB40*/ 00274000
         OI    PARMERR,B'10000000'                                 0162 00275000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00276000
         B     PARMEND                                             0163 00277000
*         END;                      /*                       @Y30LB40*/ 00278000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+2));/*                  @Y30LB40*/ 00279000
@RF00160 LA    @03,PARMHOLD-1(SS)                                  0165 00280000
         PACK  DOUBLEWD(8),0(3,@03)                                0165 00281000
*       CVB(TIMESL,DOUBLEWD);       /* CONVERT TIME SLICE TO SECONDS */ 00282000
         CVB   @03,DOUBLEWD                                        0166 00283000
         ST    @03,TIMESL                                          0166 00284000
*       TIMESL=TIMESL*60;           /*                       @Y30LB40*/ 00285000
         MH    @03,@CH00334                                        0167 00286000
         ST    @03,TIMESL                                          0167 00287000
*       SS=SS+4;                    /* BUMP POINTER TO NEXT VALUE  0168 00288000
*                                                            @Y30LB40*/ 00289000
         AL    SS,@CF00103                                         0168 00290000
*     END;                          /*                       @Y30LB40*/ 00291000
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/ 00292000
*     THEN                                                         0170 00293000
@RC00150 LA    @03,PARMHOLD-1(SS)                                  0170 00294000
         CLI   0(@03),C','                                         0170 00295000
         BNE   @RF00170                                            0170 00296000
*     SS=SS+1;                      /* NO, BUMP POINTER TO NEXT VALUE   00297000
*                                                            @Y30LB40*/ 00298000
         AL    SS,@CF00043                                         0171 00299000
*   ELSE                                                           0172 00300000
*     DO;                           /* YES,VALIDATE AND CONVERT DATES   00301000
*                                                            @Y30LB40*/ 00302000
         B     @RC00170                                            0172 00303000
@RF00170 DS    0H                                                  0173 00304000
*       DO J=SS TO(SS+9);           /* CHECK FOR NUMERICS    @Y30LB40*/ 00305000
         LR    J,SS                                                0173 00306000
         B     @DE00173                                            0173 00307000
@DL00173 DS    0H                                                  0174 00308000
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0174 00309000
         LA    @07,PARMHOLD-1(J)                                   0174 00310000
         CLI   0(@07),C'0'                                         0174 00311000
         BL    @RF00174                                            0174 00312000
         LA    @07,PARMHOLD-1(J)                                   0174 00313000
         CLI   0(@07),C'9'                                         0174 00314000
         BNH   @RT00174                                            0174 00315000
*           ;                       /*                       @Y30LB40*/ 00316000
*         ELSE                                                     0176 00317000
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0176 00318000
*                                                            @Y30LB40*/ 00319000
@RF00174 OI    PARMERR,B'10000000'                                 0176 00320000
*       END;                        /*                       @Y30LB40*/ 00321000
@RT00174 AL    J,@CF00043                                          0177 00322000
@DE00173 LA    @07,9                                               0177 00323000
         ALR   @07,SS                                              0177 00324000
         CR    J,@07                                               0177 00325000
         BNH   @DL00173                                            0177 00326000
*       IF PARMERR='1'B THEN                                       0178 00327000
         TM    PARMERR,B'10000000'                                 0178 00328000
         BO    @RT00178                                            0178 00329000
*         GO TO PARMEND;            /* IF ERROR,EXIT         @Y30LB40*/ 00330000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT DATES    @Y30LB40*/ 00331000
         LA    @03,PARMHOLD-1(SS)                                  0180 00332000
         PACK  DOUBLEWD(8),0(2,@03)                                0180 00333000
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/ 00334000
         CVB   @03,DOUBLEWD                                        0181 00335000
         STC   @03,HLDSYR                                          0181 00336000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/ 00337000
         LA    @03,PARMHOLD+1(SS)                                  0182 00338000
         PACK  DOUBLEWD(8),0(3,@03)                                0182 00339000
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00340000
         CVB   @03,DOUBLEWD                                        0183 00341000
         STH   @03,HLDSDAY                                         0183 00342000
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/ 00343000
         LA    @01,PARMHOLD+4(SS)                                  0184 00344000
         PACK  DOUBLEWD(8),0(2,@01)                                0184 00345000
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/ 00346000
         CVB   @15,DOUBLEWD                                        0185 00347000
         STC   @15,HLDEYR                                          0185 00348000
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/ 00349000
         LA    @01,PARMHOLD+6(SS)                                  0186 00350000
         PACK  DOUBLEWD(8),0(3,@01)                                0186 00351000
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00352000
         CVB   @15,DOUBLEWD                                        0187 00353000
         STH   @15,HLDEDAY                                         0187 00354000
*       IF HLDSDAY>0&HLDSDAY<366    /* CHECK FOR VALID DAYS          */ 00355000
*         THEN                                                     0188 00356000
         LTR   @03,@03                                             0188 00357000
         BNP   @RF00188                                            0188 00358000
         C     @03,@CF00649                                        0188 00359000
         BL    @RT00188                                            0188 00360000
*         ;                         /*                       @Y30LB40*/ 00361000
*       ELSE                                                       0190 00362000
*         DO;                       /*                       @Y30LB40*/ 00363000
@RF00188 DS    0H                                                  0191 00364000
*           IF HLDSDAY=366 THEN                                    0191 00365000
         CLC   HLDSDAY(2),@CH00649                                 0191 00366000
         BNE   @RF00191                                            0191 00367000
*             DO;                   /* DAY = 366 CHECK FOR LEAP YEAR    00368000
*                                                            @Y30LB40*/ 00369000
*               IF(CKSTIME(1:1)&'00000011'B)¬='00000000'B THEN     0193 00370000
         MVC   @TS00001(1),CKSTIME                                 0193 00371000
         NI    @TS00001,B'00000011'                                0193 00372000
         CLI   @TS00001,B'00000000'                                0193 00373000
         BE    @RF00193                                            0193 00374000
*                 PARMERR='1'B;     /* BAD DAY,ERROR         @Y30LB40*/ 00375000
         OI    PARMERR,B'10000000'                                 0194 00376000
*             END;                  /*                       @Y30LB40*/ 00377000
*           ELSE                                                   0196 00378000
*             PARMERR='1'B;         /* BAD DAY,ERROR         @Y30LB40*/ 00379000
         B     @RC00191                                            0196 00380000
@RF00191 OI    PARMERR,B'10000000'                                 0196 00381000
*         END;                      /*                       @Y30LB40*/ 00382000
@RC00191 DS    0H                                                  0198 00383000
*       IF HLDEDAY>0&HLDEDAY<366    /* CHECK END DAY FOR SAME        */ 00384000
*         THEN                                                     0198 00385000
@RT00188 LH    @03,HLDEDAY                                         0198 00386000
         LTR   @03,@03                                             0198 00387000
         BNP   @RF00198                                            0198 00388000
         C     @03,@CF00649                                        0198 00389000
         BL    @RT00198                                            0198 00390000
*         ;                         /*                       @Y30LB40*/ 00391000
*       ELSE                                                       0200 00392000
*         DO;                       /*                       @Y30LB40*/ 00393000
@RF00198 DS    0H                                                  0201 00394000
*           IF HLDEDAY=366 THEN                                    0201 00395000
         CLC   HLDEDAY(2),@CH00649                                 0201 00396000
         BNE   @RF00201                                            0201 00397000
*             DO;                   /*                       @Y30LB40*/ 00398000
*               IF(CKETIME(1:1)&'00000011'B)¬='00000000'B THEN     0203 00399000
         MVC   @TS00001(1),CKETIME                                 0203 00400000
         NI    @TS00001,B'00000011'                                0203 00401000
         CLI   @TS00001,B'00000000'                                0203 00402000
         BE    @RF00203                                            0203 00403000
*                 PARMERR='1'B;     /*                       @Y30LB40*/ 00404000
         OI    PARMERR,B'10000000'                                 0204 00405000
*             END;                  /*                       @Y30LB40*/ 00406000
*           ELSE                                                   0206 00407000
*             PARMERR='1'B;         /*                       @Y30LB40*/ 00408000
         B     @RC00201                                            0206 00409000
@RF00201 OI    PARMERR,B'10000000'                                 0206 00410000
*         END;                      /*                       @Y30LB40*/ 00411000
@RC00201 DS    0H                                                  0208 00412000
*       IF HLDSYR<=HLDEYR           /* END YEAR MUST BE >= START YEAR   00413000
*                                                            @Y30LB40*/ 00414000
*         THEN                                                     0208 00415000
@RT00198 CLC   HLDSYR(1),HLDEYR                                    0208 00416000
         BNH   @RT00208                                            0208 00417000
*         ;                         /*                       @Y30LB40*/ 00418000
*       ELSE                                                       0210 00419000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00420000
         OI    PARMERR,B'10000000'                                 0210 00421000
*       IF HLDSDAY<=HLDEDAY         /* END DAY MUST BE >= END DAY  0211 00422000
*                                      UNLESS                        */ 00423000
*         THEN                                                     0211 00424000
@RT00208 LH    @03,HLDSDAY                                         0211 00425000
         CH    @03,HLDEDAY                                         0211 00426000
         BNH   @RT00211                                            0211 00427000
*         ;                         /* YEARS ARE DIFFERENT   @Y30LB40*/ 00428000
*       ELSE                                                       0213 00429000
*         DO;                       /*                       @Y30LB40*/ 00430000
*           IF HLDSYR=HLDEYR THEN                                  0214 00431000
         CLC   HLDSYR(1),HLDEYR                                    0214 00432000
         BNE   @RF00214                                            0214 00433000
*             PARMERR='1'B;         /* ERROR                         */ 00434000
         OI    PARMERR,B'10000000'                                 0215 00435000
*         END;                      /*                       @Y30LB40*/ 00436000
@RF00214 DS    0H                                                  0217 00437000
*       IF PARMERR='1'B THEN                                       0217 00438000
@RT00211 TM    PARMERR,B'10000000'                                 0217 00439000
         BO    @RT00217                                            0217 00440000
*         GO TO PARMEND;            /* IF ERRORS FOUND,EXIT          */ 00441000
*       DATEINSW='1'B;              /* INDICATE VALID DATES ENTERED     00442000
*                                                            @Y30LB40*/ 00443000
         OI    DATEINSW,B'10000000'                                0219 00444000
*       SS=SS+11;                   /* BUMP POINTER TO NEXT VALUE  0220 00445000
*                                                            @Y30LB40*/ 00446000
         AL    SS,@CF00033                                         0220 00447000
*     END;                          /*                       @Y30LB40*/ 00448000
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/ 00449000
*     THEN                                                         0222 00450000
@RC00170 LA    @03,PARMHOLD-1(SS)                                  0222 00451000
         CLI   0(@03),C','                                         0222 00452000
         BNE   @RF00222                                            0222 00453000
*     SS=SS+1;                      /* NO, BUMP POINTER TO NEXT VALUE   00454000
*                                                            @Y30LB40*/ 00455000
         AL    SS,@CF00043                                         0223 00456000
*   ELSE                                                           0224 00457000
*     DO;                           /* YES                   @Y30LB40*/ 00458000
         B     @RC00222                                            0224 00459000
@RF00222 DS    0H                                                  0225 00460000
*       DO J=SS TO(SS+7);           /* VALIDATE AND CONVERT TIMES  0225 00461000
*                                                            @Y30LB40*/ 00462000
         LR    J,SS                                                0225 00463000
         B     @DE00225                                            0225 00464000
@DL00225 DS    0H                                                  0226 00465000
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0226 00466000
         LA    @07,PARMHOLD-1(J)                                   0226 00467000
         CLI   0(@07),C'0'                                         0226 00468000
         BL    @RF00226                                            0226 00469000
         LA    @07,PARMHOLD-1(J)                                   0226 00470000
         CLI   0(@07),C'9'                                         0226 00471000
         BNH   @RT00226                                            0226 00472000
*           ;                       /*                       @Y30LB40*/ 00473000
*         ELSE                                                     0228 00474000
*           PARMERR='1'B;           /* NON NUMERIC FOUND,ERROR     0228 00475000
*                                                            @Y30LB40*/ 00476000
@RF00226 OI    PARMERR,B'10000000'                                 0228 00477000
*       END;                        /*                       @Y30LB40*/ 00478000
@RT00226 AL    J,@CF00043                                          0229 00479000
@DE00225 LA    @07,7                                               0229 00480000
         ALR   @07,SS                                              0229 00481000
         CR    J,@07                                               0229 00482000
         BNH   @DL00225                                            0229 00483000
*       IF PARMERR='1'B THEN                                       0230 00484000
         TM    PARMERR,B'10000000'                                 0230 00485000
         BO    @RT00230                                            0230 00486000
*         GO TO PARMEND;            /* IF ERRORS FOUND,EXIT          */ 00487000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/ 00488000
         LA    @01,PARMHOLD-1(SS)                                  0232 00489000
         PACK  DOUBLEWD(8),0(2,@01)                                0232 00490000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00491000
         CVB   TIMEWORK,DOUBLEWD                                   0233 00492000
*       IF TIMEWORK>23 THEN                                        0234 00493000
         C     TIMEWORK,@CF00652                                   0234 00494000
         BNH   @RF00234                                            0234 00495000
*         PARMERR='1'B;             /* HOUR MUST BE <= 23            */ 00496000
         OI    PARMERR,B'10000000'                                 0235 00497000
*       ELSE                                                       0236 00498000
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00499000
         B     @RC00234                                            0236 00500000
@RF00234 LR    @15,TIMEWORK                                        0236 00501000
         MH    @15,@CH00653                                        0236 00502000
         ST    @15,HLDSTIME                                        0236 00503000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/ 00504000
@RC00234 LA    @01,PARMHOLD+1(SS)                                  0237 00505000
         PACK  DOUBLEWD(8),0(2,@01)                                0237 00506000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00507000
         CVB   TIMEWORK,DOUBLEWD                                   0238 00508000
*       IF TIMEWORK>59 THEN                                        0239 00509000
         C     TIMEWORK,@CF00654                                   0239 00510000
         BNH   @RF00239                                            0239 00511000
*         PARMERR='1'B;             /* MINUTE MUST BE <= 59          */ 00512000
         OI    PARMERR,B'10000000'                                 0240 00513000
*       ELSE                                                       0241 00514000
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/ 00515000
         B     @RC00239                                            0241 00516000
@RF00239 LR    @15,TIMEWORK                                        0241 00517000
         MH    @15,@CH00334                                        0241 00518000
         AL    @15,HLDSTIME                                        0241 00519000
         ST    @15,HLDSTIME                                        0241 00520000
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/ 00521000
@RC00239 LA    @01,PARMHOLD+3(SS)                                  0242 00522000
         PACK  DOUBLEWD(8),0(2,@01)                                0242 00523000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00524000
         CVB   TIMEWORK,DOUBLEWD                                   0243 00525000
*       IF TIMEWORK>23 THEN                                        0244 00526000
         C     TIMEWORK,@CF00652                                   0244 00527000
         BNH   @RF00244                                            0244 00528000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00529000
         OI    PARMERR,B'10000000'                                 0245 00530000
*       ELSE                                                       0246 00531000
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00532000
         B     @RC00244                                            0246 00533000
@RF00244 LR    @15,TIMEWORK                                        0246 00534000
         MH    @15,@CH00653                                        0246 00535000
         ST    @15,HLDETIME                                        0246 00536000
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/ 00537000
@RC00244 LA    @01,PARMHOLD+5(SS)                                  0247 00538000
         PACK  DOUBLEWD(8),0(2,@01)                                0247 00539000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00540000
         CVB   TIMEWORK,DOUBLEWD                                   0248 00541000
*       IF TIMEWORK>59 THEN                                        0249 00542000
         C     TIMEWORK,@CF00654                                   0249 00543000
         BNH   @RF00249                                            0249 00544000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00545000
         OI    PARMERR,B'10000000'                                 0250 00546000
*       ELSE                                                       0251 00547000
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/ 00548000
         B     @RC00249                                            0251 00549000
@RF00249 LR    @15,TIMEWORK                                        0251 00550000
         MH    @15,@CH00334                                        0251 00551000
         AL    @15,HLDETIME                                        0251 00552000
         AL    @15,@CF00654                                        0251 00553000
         ST    @15,HLDETIME                                        0251 00554000
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY THEN                      0252 00555000
@RC00249 CLC   HLDSYR(1),HLDEYR                                    0252 00556000
         BNE   @RF00252                                            0252 00557000
         CLC   HLDSDAY(2),HLDEDAY                                  0252 00558000
         BNE   @RF00252                                            0252 00559000
*         IF HLDSTIME>HLDETIME THEN                                0253 00560000
         L     @03,HLDSTIME                                        0253 00561000
         C     @03,HLDETIME                                        0253 00562000
         BNH   @RF00253                                            0253 00563000
*           PARMERR='1'B;           /*                       @Y30LB40*/ 00564000
         OI    PARMERR,B'10000000'                                 0254 00565000
*       IF PARMERR='0'B&DATEINSW='0'B/* WERE DATES ENTERED           */ 00566000
*         THEN                                                     0255 00567000
@RF00253 DS    0H                                                  0255 00568000
@RF00252 TM    PARMERR,B'10000000'                                 0255 00569000
         BNZ   @RF00255                                            0255 00570000
         TM    DATEINSW,B'10000000'                                0255 00571000
         BNZ   @RF00255                                            0255 00572000
*         PARMERR='1'B;             /* NO,ERROR              @Y30LB40*/ 00573000
         OI    PARMERR,B'10000000'                                 0256 00574000
*       SS=SS+9;                    /* YES,BUMP TO NEXT VALUE        */ 00575000
@RF00255 AL    SS,@CF00423                                         0257 00576000
*     END;                          /*                       @Y30LB40*/ 00577000
*   IF PARMERR='1'B THEN                                           0259 00578000
@RC00222 TM    PARMERR,B'10000000'                                 0259 00579000
         BO    @RT00259                                            0259 00580000
*     GO TO PARMEND;                /* IF ERRORS FOUND,EXIT          */ 00581000
*   IF PARMHOLD(SS:SS)=','          /* WAS VOLID SPECIFIED   @Y30LB40*/ 00582000
*     THEN                                                         0261 00583000
         LA    @03,PARMHOLD-1(SS)                                  0261 00584000
         CLI   0(@03),C','                                         0261 00585000
         BE    @RT00261                                            0261 00586000
*     ;                             /* NO, PROCESS FINISHED  @Y30LB40*/ 00587000
*   ELSE                                                           0263 00588000
*     DO;                           /* YES,CHECK FOR SIX BYTES     0263 00589000
*                                      ENTERED                       */ 00590000
*       DO J=SS TO(SS+5);           /*                       @Y30LB40*/ 00591000
         LR    J,SS                                                0264 00592000
         B     @DE00264                                            0264 00593000
@DL00264 DS    0H                                                  0265 00594000
*         IF PARMHOLD(J:J)=',' THEN                                0265 00595000
         LA    @07,PARMHOLD-1(J)                                   0265 00596000
         CLI   0(@07),C','                                         0265 00597000
         BNE   @RF00265                                            0265 00598000
*           DO;                     /*                       @Y30LB40*/ 00599000
*             PARMERR='1'B;         /* COMMA FOUND BEFORE END,ERROR     00600000
*                                                            @Y30LB40*/ 00601000
         OI    PARMERR,B'10000000'                                 0267 00602000
*             J=SS+5;               /* STOP LOOP             @Y30LB40*/ 00603000
         LA    J,5                                                 0268 00604000
         ALR   J,SS                                                0268 00605000
*           END;                    /*                       @Y30LB40*/ 00606000
*       END;                        /*                       @Y30LB40*/ 00607000
@RF00265 AL    J,@CF00043                                          0270 00608000
@DE00264 LA    @07,5                                               0270 00609000
         ALR   @07,SS                                              0270 00610000
         CR    J,@07                                               0270 00611000
         BNH   @DL00264                                            0270 00612000
*       IF PARMERR='1'B             /* IF ERROR FOUND,EXIT   @Y30LB40*/ 00613000
*         THEN                                                     0271 00614000
         TM    PARMERR,B'10000000'                                 0271 00615000
         BO    @RT00271                                            0271 00616000
*         GO TO PARMEND;            /*                       @Y30LB40*/ 00617000
*       ELSE                                                       0273 00618000
*         VOL=PARMHOLD(SS:SS+5);    /* NO ERROR,SAVE VOLID   @Y30LB40*/ 00619000
         LA    @03,PARMHOLD-1(SS)                                  0273 00620000
         MVC   VOL(6),0(@03)                                       0273 00621000
*     END;                          /*                       @Y30LB40*/ 00622000
*PARMEND:                                                          0275 00623000
*   IF PARMERR='1'B                 /* IF ERRORS FOUND,PRINT ERROR 0275 00624000
*                                      MSG,EXIT WITH                 */ 00625000
*     THEN                                                         0275 00626000
@RT00261 DS    0H                                                  0275 00627000
PARMEND  TM    PARMERR,B'10000000'                                 0275 00628000
         BNO   @RF00275                                            0275 00629000
*     DO;                           /* RETURN CODE = 8       @Y30LB40*/ 00630000
*       PRINTLN=PARMMSG;            /*                       @Y30LB40*/ 00631000
         MVI   PRINTLN+28,C' '                                     0277 00632000
         MVC   PRINTLN+29(92),PRINTLN+28                           0277 00633000
         MVC   PRINTLN(28),PARMMSG                                 0277 00634000
*       RFY                                                        0278 00635000
*        (R0,                                                      0278 00636000
*         R1,                                                      0278 00637000
*         R14,                                                     0278 00638000
*         R15) RSTD;                /*                       @Y30LB40*/ 00639000
*       GEN(PUT   PRNTDCB,PRINTLN); /*                       @Y30LB40*/ 00640000
         PUT   PRNTDCB,PRINTLN                                          00641000
*       RFY                                                        0280 00642000
*        (R0,                                                      0280 00643000
*         R1,                                                      0280 00644000
*         R14,                                                     0280 00645000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00646000
*       RETURNCD=8;                 /*                       @Y30LB40*/ 00647000
         LA    RETURNCD,8                                          0281 00648000
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/ 00649000
         B     CLOSEFIL                                            0282 00650000
*     END;                          /*                       @Y30LB40*/ 00651000
*   RFY                                                            0284 00652000
*    (R0,                                                          0284 00653000
*     R1,                                                          0284 00654000
*     R14,                                                         0284 00655000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00656000
@RF00275 DS    0H                                                  0285 00657000
*   GEN(TIME);                      /* GET AND CONVERT TODAYS DATE 0285 00658000
*                                                            @Y30LB40*/ 00659000
         TIME                                                           00660000
*   GEN(ST    R1,DOUBLEWD);         /*                       @Y30LB40*/ 00661000
         ST    R1,DOUBLEWD                                              00662000
*   RFY                                                            0287 00663000
*    (R0,                                                          0287 00664000
*     R1,                                                          0287 00665000
*     R14,                                                         0287 00666000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00667000
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @Y30LB40*/ 00668000
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0288 00669000
*                                                                  0289 00670000
*/********************************************************************  00671000
*                                                                    */ 00672000
*/* BEGIN PROCESSING THE FILE                                @Y30LB40*/ 00673000
*/********************************************************************  00674000
*                                                                    */ 00675000
*                                                                  0289 00676000
*RDTRACE:                                                          0289 00677000
*   RFY                                                            0289 00678000
*    (R0,                                                          0289 00679000
*     R1,                                                          0289 00680000
*     R14,                                                         0289 00681000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00682000
RDTRACE  DS    0H                                                  0290 00683000
*   GEN(GET   INDCB,RCDIN);         /* READ AN INPUT RECORD  @Y30LB40*/ 00684000
         GET   INDCB,RCDIN                                              00685000
*   RFY                                                            0291 00686000
*    (R0,                                                          0291 00687000
*     R1,                                                          0291 00688000
*     R14,                                                         0291 00689000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00690000
*   IF CKTIME<CKSTIME|CKTIME>CKETIME/* IF NOT IN DATE AND TIME       */ 00691000
*     THEN                                                         0292 00692000
         CLC   CKTIME(7),CKSTIME                                   0292 00693000
         BL    @RT00292                                            0292 00694000
         CLC   CKTIME(7),CKETIME                                   0292 00695000
         BH    @RT00292                                            0292 00696000
*     GO TO RDTRACE;                /* RANGE,READ NEXT RECORD        */ 00697000
*   IF(DSTGD+STGD)¬>0 THEN                                         0294 00698000
         L     @15,DSTGD                                           0294 00699000
         AL    @15,STGD                                            0294 00700000
         LTR   @15,@15                                             0294 00701000
         BNP   @RT00294                                            0294 00702000
*     GO TO RDTRACE;                /* BYPASS ZERO RCDS              */ 00703000
*   IF VOL¬='      '                /* IF VOLID SPECIFIED AND      0296 00704000
*                                                            @Y30LB40*/ 00705000
*     THEN                                                         0296 00706000
         CLC   VOL(6),@CC00659                                     0296 00707000
         BE    @RF00296                                            0296 00708000
*     IF VOLID¬=VOL                 /* RECORD DOES NOT MATCH @Y30LB40*/ 00709000
*       THEN                                                       0297 00710000
         CLC   VOLID(6),VOL                                        0297 00711000
         BNE   @RT00297                                            0297 00712000
*       GO TO RDTRACE;              /* THEN READ NEXT RECORD @Y30LB40*/ 00713000
*   SNL=LIBRARY;                    /* SET UP NEW LIBRARY    @Y30LB40*/ 00714000
@RF00296 MVC   SNL(1),LIBRARY                                      0299 00715000
*   SNV=VOLID;                      /* SET UP NEW VOLID      @Y30LB40*/ 00716000
         MVC   SNV(6),VOLID                                        0300 00717000
*   SNT=CKTIME;                     /* SET UP NEW DATE AND TIME    0301 00718000
*                                                            @Y30LB40*/ 00719000
         MVC   SNT(7),CKTIME                                       0301 00720000
*   IF SEQNEW<SEQOLD                /* IS FILE OUT OF SEQUENCE     0302 00721000
*                                                            @Y30LB40*/ 00722000
*     THEN                                                         0302 00723000
         CLC   SEQNEW(14),SEQOLD                                   0302 00724000
         BNL   @RF00302                                            0302 00725000
*     DO;                           /* YES                   @Y30LB40*/ 00726000
*       PRINTLN=SEQMSG;             /* SET UP ERROR MESSAGE  @Y30LB40*/ 00727000
         MVI   PRINTLN+43,C' '                                     0304 00728000
         MVC   PRINTLN+44(77),PRINTLN+43                           0304 00729000
         MVC   PRINTLN(43),SEQMSG                                  0304 00730000
*       RFY                                                        0305 00731000
*        (R0,                                                      0305 00732000
*         R1,                                                      0305 00733000
*         R14,                                                     0305 00734000
*         R15) RSTD;                /*                       @Y30LB40*/ 00735000
*       GEN(PUT   PRNTDCB,PRINTLN); /* PRINT MESSAGE         @Y30LB40*/ 00736000
         PUT   PRNTDCB,PRINTLN                                          00737000
*       RFY                                                        0307 00738000
*        (R0,                                                      0307 00739000
*         R1,                                                      0307 00740000
*         R14,                                                     0307 00741000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00742000
*       RETURNCD=8;                 /* SET UP RETURN CODE    @Y30LB40*/ 00743000
         LA    RETURNCD,8                                          0308 00744000
*       GO TO CLOSEFIL;             /* GET OUT OF PROGRAM    @Y30LB40*/ 00745000
         B     CLOSEFIL                                            0309 00746000
*     END;                          /*                       @Y30LB40*/ 00747000
*   ELSE                                                           0311 00748000
*     SEQOLD=SEQNEW;                /* FILE OK,SAVE SEQUENCE @Y30LB40*/ 00749000
@RF00302 MVC   SEQOLD(14),SEQNEW                                   0311 00750000
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT INPUT RECORDS   @Y30LB40*/ 00751000
         LA    @15,1                                               0312 00752000
         AL    @15,RCDCOUNT                                        0312 00753000
         ST    @15,RCDCOUNT                                        0312 00754000
*   IF FIRSTSW='1'B                 /* TEST IF FIRST RECORD  @Y30LB40*/ 00755000
*     THEN                                                         0313 00756000
         TM    FIRSTSW,B'10000000'                                 0313 00757000
         BNO   @RF00313                                            0313 00758000
*     DO;                           /*                       @Y30LB40*/ 00759000
*       FIRSTSW='0'B;               /* TURN OFF 1ST RECORD SWITCH    */ 00760000
         NI    FIRSTSW,B'01111111'                                 0315 00761000
*NEWLIB:                                                           0316 00762000
*                                                                  0316 00763000
*       /*************************************************************/ 00764000
*       /*                                                           */ 00765000
*       /* ************************************************  @OZ11673*/ 00766000
*       /* SET UP INITIAL TIMESLICE COMPARE RECORD USING     @OZ11673*/ 00767000
*       /* THE STARTING TIME SPECIFIED IN THE DATE AND       @OZ11673*/ 00768000
*       /* TIME PARAMETERS, OR THE DEFAULT VALUES.           @OZ11673*/ 00769000
*       /* ************************************************  @OZ11673*/ 00770000
*       /*                                                           */ 00771000
*       /*************************************************************/ 00772000
*                                                                  0316 00773000
*       TSBEG=CKSTIME;              /*                       @OZ11673*/ 00774000
NEWLIB   MVC   TSBEG(7),CKSTIME                                    0316 00775000
*       TSEND=CKSTIME;              /*                       @OZ11673*/ 00776000
         MVC   TSEND(7),CKSTIME                                    0317 00777000
*       TSEYR=SVEYEAR;              /*                       @OZ11673*/ 00778000
         MVC   TSEYR(1),SVEYEAR                                    0318 00779000
*       TSETIME=TSETIME+TIMESL;     /*                       @OZ11673*/ 00780000
         L     @15,TSETIME                                         0319 00781000
         AL    @15,TIMESL                                          0319 00782000
         ST    @15,TSETIME                                         0319 00783000
*       CALL GETSLICE;              /*                       @OZ11673*/ 00784000
         BAL   @14,GETSLICE                                        0320 00785000
*       VOLUME=VOLID;               /* STORE 1ST VOLUME IDENT      0321 00786000
*                                                            @Y30LB40*/ 00787000
         MVC   VOLUME(6),VOLID                                     0321 00788000
*       LIB=LIBRARY;                /* STORE 1ST LIBRARY     @Y30LB40*/ 00789000
         MVC   LIB(1),LIBRARY                                      0322 00790000
*     END;                          /*                       @Y30LB40*/ 00791000
*CHECKTIM:                          /* CHECK FOR CONTROL BREAKS    0324 00792000
*                                                            @Y30LB40*/ 00793000
*   IF LIBRARY¬=LIB THEN                                           0324 00794000
@RF00313 DS    0H                                                  0324 00795000
CHECKTIM CLC   LIBRARY(1),LIB                                      0324 00796000
         BE    @RF00324                                            0324 00797000
*     DO;                           /* IF LIBRARY CHANGED,CONTROL  0325 00798000
*                                      BREAK                 @Y30LB40*/ 00799000
*       LIBSW='1'B;                 /*                       @Y30LB40*/ 00800000
         OI    LIBSW,B'10000000'                                   0326 00801000
*       GO TO VOLIDBRK;             /*                       @Y30LB40*/ 00802000
         B     VOLIDBRK                                            0327 00803000
*     END;                          /*                       @Y30LB40*/ 00804000
*   IF VOLUME¬=VOLID THEN                                          0329 00805000
@RF00324 CLC   VOLUME(6),VOLID                                     0329 00806000
         BE    @RF00329                                            0329 00807000
*     DO;                           /* IF VOLUME CHANGED,CONTROL   0330 00808000
*                                      BREAK                 @Y30LB40*/ 00809000
*       VOLSW='1'B;                 /*                       @Y30LB40*/ 00810000
         OI    VOLSW,B'10000000'                                   0331 00811000
*       GO TO VOLIDBRK;             /*                       @Y30LB40*/ 00812000
         B     VOLIDBRK                                            0332 00813000
*     END;                          /*                       @Y30LB40*/ 00814000
*   IF CKTIME>TSEND THEN                                           0334 00815000
@RF00329 CLC   CKTIME(7),TSEND                                     0334 00816000
         BNH   @RF00334                                            0334 00817000
*     DO;                           /* IF TIME SLICE EXCEEDED,CONTROL   00818000
*                                      BREAK                 @Y30LB40*/ 00819000
*       TMESW='1'B;                 /*                       @Y30LB40*/ 00820000
         OI    TMESW,B'10000000'                                   0336 00821000
*       GO TO VOLIDBRK;             /*                       @Y30LB40*/ 00822000
         B     VOLIDBRK                                            0337 00823000
*     END;                          /*                       @Y30LB40*/ 00824000
*SUMIT:                             /* ACCUM VALUES FOR TIMESLICE AND   00825000
*                                      VOLID                 @Y30LB40*/ 00826000
*   DO I=1 TO 2;                    /*                       @Y30LB40*/ 00827000
@RF00334 DS    0H                                                  0339 00828000
SUMIT    LA    I,1                                                 0339 00829000
@DL00339 DS    0H                                                  0340 00830000
*     IF CARTPAIR=0                 /* SET J ACCORDING TO CARTRIDGE     00831000
*                                      PAIR NUMBER                   */ 00832000
*       THEN                                                       0340 00833000
         CLI   CARTPAIR,0                                          0340 00834000
         BNE   @RF00340                                            0340 00835000
*       J=1;                        /*                       @Y30LB40*/ 00836000
         LA    J,1                                                 0341 00837000
*     ELSE                                                         0342 00838000
*       J=2;                        /*                       @Y30LB40*/ 00839000
         B     @RC00340                                            0342 00840000
@RF00340 LA    J,2                                                 0342 00841000
*     SMSTGD(I,J)=SMSTGD(I,J)+STGD; /* ACCUM CYLS STAGED     @Y30LB40*/ 00842000
@RC00340 LR    @15,I                                               0343 00843000
         ALR   @15,@15                                             0343 00844000
         ALR   @15,J                                               0343 00845000
         MH    @15,@CH00729                                        0343 00846000
         L     @14,SMSTGD-108(@15)                                 0343 00847000
         AL    @14,STGD                                            0343 00848000
         ST    @14,SMSTGD-108(@15)                                 0343 00849000
*     SMCFAULT(I,J)=SMCFAULT(I,J)+CFAULT;/* ACCUM CYL FAULT CAUSED   */ 00850000
         L     @14,SMCFAULT-108(@15)                               0344 00851000
         AL    @14,CFAULT                                          0344 00852000
         ST    @14,SMCFAULT-108(@15)                               0344 00853000
*     SMDSTGD(I,J)=SMDSTGD(I,J)+DSTGD;/* ACCUM CYLS DESTAGED         */ 00854000
         L     @14,SMDSTGD-108(@15)                                0345 00855000
         AL    @14,DSTGD                                           0345 00856000
         ST    @14,SMDSTGD-108(@15)                                0345 00857000
*     SMSALLOC(I,J)=SMSALLOC(I,J)+SALLOC;/* ACCUM SPACE ALLOC CAUSED */ 00858000
         L     @14,SMSALLOC-108(@15)                               0346 00859000
         AL    @14,SALLOC                                          0346 00860000
         ST    @14,SMSALLOC-108(@15)                               0346 00861000
*     LOADS(I,J)=LOADS(I,J)+LOADNUM;/* ACCUM NUMBER OF LOADS         */ 00862000
         SLR   @14,@14                                             0347 00863000
         IC    @14,LOADNUM                                         0347 00864000
         AL    @14,LOADS-108(@15)                                  0347 00865000
         ST    @14,LOADS-108(@15)                                  0347 00866000
*     STGDTOT(I,J)=STGDTOT(I,J)+STGDNUM;/* ACCUM NUMBER OF STAGES    */ 00867000
         SLR   @14,@14                                             0348 00868000
         IC    @14,STGDNUM                                         0348 00869000
         AL    @14,STGDTOT-108(@15)                                0348 00870000
         ST    @14,STGDTOT-108(@15)                                0348 00871000
*     DSTGDTOT(I,J)=DSTGDTOT(I,J)+DSTGDNUM;/* ACCUM DESTAGES         */ 00872000
         SLR   @14,@14                                             0349 00873000
         IC    @14,DSTGDNUM                                        0349 00874000
         AL    @14,DSTGDTOT-108(@15)                               0349 00875000
         ST    @14,DSTGDTOT-108(@15)                               0349 00876000
*     IF CARTPAIR=0                 /* IF PAIR 0 ACCUM VTOC STAGES 0350 00877000
*                                      AND                   @Y30LB40*/ 00878000
*       THEN                                                       0350 00879000
         CLI   CARTPAIR,0                                          0350 00880000
         BNE   @RF00350                                            0350 00881000
*       DO;                         /* DESTAGES              @Y30LB40*/ 00882000
*         VTOCSG(I,J)=VTOCSG(I,J)+VTOCSTG;/*                 @Y30LB40*/ 00883000
         SLR   @14,@14                                             0352 00884000
         IC    @14,VTOCSTG                                         0352 00885000
         AL    @14,VTOCSG-108(@15)                                 0352 00886000
         ST    @14,VTOCSG-108(@15)                                 0352 00887000
*         VTOCDS(I,J)=VTOCDS(I,J)+VTOCDSTG;/*                @Y30LB40*/ 00888000
         SLR   @14,@14                                             0353 00889000
         IC    @14,VTOCDSTG                                        0353 00890000
         AL    @14,VTOCDS-108(@15)                                 0353 00891000
         ST    @14,VTOCDS-108(@15)                                 0353 00892000
*       END;                        /*                       @Y30LB40*/ 00893000
*   END;                            /*                       @Y30LB40*/ 00894000
@RF00350 AL    I,@CF00043                                          0355 00895000
         C     I,@CF00050                                          0355 00896000
         BNH   @DL00339                                            0355 00897000
*   GO TO RDTRACE;                  /* GO READ NEXT RECORD   @Y30LB40*/ 00898000
         B     RDTRACE                                             0356 00899000
*                                                                  0357 00900000
*/********************************************************************  00901000
*                                                                    */ 00902000
*/**ROUTINE TO PRINT VOL ID DETAIL AND PROCESS CONTROL BREAKS*       */ 00903000
*/********************************************************************  00904000
*                                                                    */ 00905000
*                                                                  0357 00906000
*VOLIDBRK:                                                         0357 00907000
*   I=1;                            /* SET I FOR TIME SLICE TOTAL  0357 00908000
*                                                            @Y30LB40*/ 00909000
VOLIDBRK LA    I,1                                                 0357 00910000
*PROCBRK:                                                          0358 00911000
*   CALL SETLINE;                   /* GET PRINT LINE CONSTANT INFO     00912000
*                                                            @Y30LB40*/ 00913000
PROCBRK  BAL   @14,SETLINE                                         0358 00914000
*   IF I=2                          /* IF DOING VOLID TOTALS @Y30LB40*/ 00915000
*     THEN                                                         0359 00916000
         C     I,@CF00050                                          0359 00917000
         BNE   @RF00359                                            0359 00918000
*     DO;                           /*                       @Y30LB40*/ 00919000
*       PF1='TOTALS';               /* INDICATE VOLID TOTALS @Y30LB40*/ 00920000
         MVC   PF1(6),@CC00672                                     0361 00921000
*       PF3='        ';             /*                       @Y30LB40*/ 00922000
         MVC   PF3(8),@CC00673                                     0362 00923000
*     END;                          /*                       @Y30LB40*/ 00924000
*   DO J=1 TO 2;                    /* CHECK FOR BOTH CARTRIDGE PAIRS   00925000
*                                                            @Y30LB40*/ 00926000
@RF00359 LA    J,1                                                 0364 00927000
@DL00364 DS    0H                                                  0365 00928000
*     IF LINECNT>55 THEN                                           0365 00929000
         C     LINECNT,@CF00674                                    0365 00930000
         BNH   @RF00365                                            0365 00931000
*       DO;                         /* FORCE NEW PAGE HEADING      0366 00932000
*                                                            @Y30LB40*/ 00933000
*         LINECNT=6;                /* RESET PAGE COUNTER AND PRINT  */ 00934000
         LA    LINECNT,6                                           0367 00935000
*         PAGECNT=PAGECNT+1;        /* HEADINGS              @Y30LB40*/ 00936000
         LA    @15,1                                               0368 00937000
         AL    @15,PAGECNT                                         0368 00938000
         ST    @15,PAGECNT                                         0368 00939000
*         HEADHOLD=HDNG1;           /*                       @Y30LB40*/ 00940000
         MVC   HEADHOLD(121),HDNG1                                 0369 00941000
*         CALL EDITFIX(ADDR(PAGECNT),4,'S');/*               @Y30LB40*/ 00942000
         MVC   @AL00001+4(8),@AL00370                              0370 00943000
         LA    @15,PAGECNT                                         0370 00944000
         ST    @15,@AFTEMPS+4                                      0370 00945000
         LA    @15,@AFTEMPS+4                                      0370 00946000
         ST    @15,@AL00001                                        0370 00947000
         LA    @01,@AL00001                                        0370 00948000
         BAL   @14,EDITFIX                                         0370 00949000
*         HEADHOLD(118:121)=FIXOUT(10:13);/*                 @Y30LB40*/ 00950000
         MVC   HEADHOLD+117(4),FIXOUT+9                            0371 00951000
*         HEADHOLD(107:111)=TODAY;  /*                       @Y30LB40*/ 00952000
         MVC   HEADHOLD+106(5),TODAY                               0372 00953000
*         RFY                                                      0373 00954000
*          (R0,                                                    0373 00955000
*           R1,                                                    0373 00956000
*           R14,                                                   0373 00957000
*           R15) RSTD;              /*                       @Y30LB40*/ 00958000
*         GEN(PUT   PRNTDCB,HEADHOLD);/*                     @Y30LB40*/ 00959000
         PUT   PRNTDCB,HEADHOLD                                         00960000
*         GEN(PUT   PRNTDCB,HDNG2); /*                       @Y30LB40*/ 00961000
         PUT   PRNTDCB,HDNG2                                            00962000
*         GEN(PUT   PRNTDCB,HDNG3); /*                       @Y30LB40*/ 00963000
         PUT   PRNTDCB,HDNG3                                            00964000
*         GEN(PUT   PRNTDCB,HDNG4); /*                       @Y30LB40*/ 00965000
         PUT   PRNTDCB,HDNG4                                            00966000
*         GEN(PUT   PRNTDCB,SPACE1);/*                       @Y30LB40*/ 00967000
         PUT   PRNTDCB,SPACE1                                           00968000
*         RFY                                                      0379 00969000
*          (R0,                                                    0379 00970000
*           R1,                                                    0379 00971000
*           R14,                                                   0379 00972000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 00973000
*       END;                        /*                       @Y30LB40*/ 00974000
*     IF SMSTGD(I,J)+SMDSTGD(I,J)¬=0 THEN                          0381 00975000
@RF00365 LR    @15,I                                               0381 00976000
         ALR   @15,@15                                             0381 00977000
         ALR   @15,J                                               0381 00978000
         MH    @15,@CH00729                                        0381 00979000
         L     @14,SMSTGD-108(@15)                                 0381 00980000
         AL    @14,SMDSTGD-108(@15)                                0381 00981000
         LTR   @14,@14                                             0381 00982000
         BZ    @RF00381                                            0381 00983000
*       DO;                         /* IF ANY ACTIVITY,PRINT VALUES     00984000
*                                                            @Y30LB40*/ 00985000
*         IF J=1 THEN                                              0383 00986000
         C     J,@CF00043                                          0383 00987000
         BNE   @RF00383                                            0383 00988000
*           PF13A='0';              /* SET CARTRIDGE PAIR NUMBER   0384 00989000
*                                                            @Y30LB40*/ 00990000
         MVI   PF13A,C'0'                                          0384 00991000
*         ELSE                                                     0385 00992000
*           PF13A='1';              /*                       @Y30LB40*/ 00993000
         B     @RC00383                                            0385 00994000
@RF00383 MVI   PF13A,C'1'                                          0385 00995000
*         CALL EDITFIX(ADDR(SMSTGD(I,J)),4,'E');/*           @Y30LB40*/ 00996000
@RC00383 MVC   @AL00001+4(8),@AL00386                              0386 00997000
         LR    @15,I                                               0386 00998000
         ALR   @15,@15                                             0386 00999000
         ALR   @15,J                                               0386 01000000
         MH    @15,@CH00729                                        0386 01001000
         LA    @15,SMSTGD-108(@15)                                 0386 01002000
         ST    @15,@AFTEMPS+4                                      0386 01003000
         LA    @15,@AFTEMPS+4                                      0386 01004000
         ST    @15,@AL00001                                        0386 01005000
         LA    @01,@AL00001                                        0386 01006000
         BAL   @14,EDITFIX                                         0386 01007000
*         PF15=FIXOUT(5:13);        /* CYLINDERS STAGED      @Y30LB40*/ 01008000
         MVC   PF15(9),FIXOUT+4                                    0387 01009000
*         CALL EDITFIX(ADDR(SMCFAULT(I,J)),4,'E');/*         @Y30LB40*/ 01010000
         MVC   @AL00001+4(8),@AL00388                              0388 01011000
         LR    @15,I                                               0388 01012000
         ALR   @15,@15                                             0388 01013000
         ALR   @15,J                                               0388 01014000
         MH    @15,@CH00729                                        0388 01015000
         LA    @15,SMCFAULT-108(@15)                               0388 01016000
         ST    @15,@AFTEMPS+4                                      0388 01017000
         LA    @15,@AFTEMPS+4                                      0388 01018000
         ST    @15,@AL00001                                        0388 01019000
         LA    @01,@AL00001                                        0388 01020000
         BAL   @14,EDITFIX                                         0388 01021000
*         PF17=FIXOUT(5:13);        /* CYLINDER FAULT CAUSED @Y30LB40*/ 01022000
         MVC   PF17(9),FIXOUT+4                                    0389 01023000
*         CALL EDITFIX(ADDR(SMDSTGD(I,J)),4,'E');/*          @Y30LB40*/ 01024000
         MVC   @AL00001+4(8),@AL00390                              0390 01025000
         LR    @15,I                                               0390 01026000
         ALR   @15,@15                                             0390 01027000
         ALR   @15,J                                               0390 01028000
         MH    @15,@CH00729                                        0390 01029000
         LA    @15,SMDSTGD-108(@15)                                0390 01030000
         ST    @15,@AFTEMPS+4                                      0390 01031000
         LA    @15,@AFTEMPS+4                                      0390 01032000
         ST    @15,@AL00001                                        0390 01033000
         LA    @01,@AL00001                                        0390 01034000
         BAL   @14,EDITFIX                                         0390 01035000
*         PF19=FIXOUT(5:13);        /* CYLINDERS DESTAGED    @Y30LB40*/ 01036000
         MVC   PF19(9),FIXOUT+4                                    0391 01037000
*         CALL EDITFIX(ADDR(SMSALLOC(I,J)),4,'E');/*         @Y30LB40*/ 01038000
         MVC   @AL00001+4(8),@AL00392                              0392 01039000
         LR    @15,I                                               0392 01040000
         ALR   @15,@15                                             0392 01041000
         ALR   @15,J                                               0392 01042000
         MH    @15,@CH00729                                        0392 01043000
         LA    @15,SMSALLOC-108(@15)                               0392 01044000
         ST    @15,@AFTEMPS+4                                      0392 01045000
         LA    @15,@AFTEMPS+4                                      0392 01046000
         ST    @15,@AL00001                                        0392 01047000
         LA    @01,@AL00001                                        0392 01048000
         BAL   @14,EDITFIX                                         0392 01049000
*         PF21=FIXOUT(5:13);        /* SPACE ALLOCATOR CAUSED      0393 01050000
*                                                            @Y30LB40*/ 01051000
         MVC   PF21(9),FIXOUT+4                                    0393 01052000
*         SMSTGD(I,J)=SMSTGD(I,J)+SMDSTGD(I,J);/* TOT STAGING        */ 01053000
         LR    @15,I                                               0394 01054000
         ALR   @15,@15                                             0394 01055000
         ALR   @15,J                                               0394 01056000
         MH    @15,@CH00729                                        0394 01057000
         L     @14,SMSTGD-108(@15)                                 0394 01058000
         AL    @14,SMDSTGD-108(@15)                                0394 01059000
         ST    @14,SMSTGD-108(@15)                                 0394 01060000
*         CALL EDITFIX(ADDR(SMSTGD(I,J)),4,'E');/*           @Y30LB40*/ 01061000
         MVC   @AL00001+4(8),@AL00395                              0395 01062000
         LA    @15,SMSTGD-108(@15)                                 0395 01063000
         ST    @15,@AFTEMPS+4                                      0395 01064000
         LA    @15,@AFTEMPS+4                                      0395 01065000
         ST    @15,@AL00001                                        0395 01066000
         LA    @01,@AL00001                                        0395 01067000
         BAL   @14,EDITFIX                                         0395 01068000
*         PF23=FIXOUT(5:13);        /*                       @Y30LB40*/ 01069000
         MVC   PF23(9),FIXOUT+4                                    0396 01070000
*         CALL EDITFIX(ADDR(LOADS(I,J)),4,'S');/*            @Y30LB40*/ 01071000
         MVC   @AL00001+4(8),@AL00397                              0397 01072000
         LR    @15,I                                               0397 01073000
         ALR   @15,@15                                             0397 01074000
         ALR   @15,J                                               0397 01075000
         MH    @15,@CH00729                                        0397 01076000
         LA    @15,LOADS-108(@15)                                  0397 01077000
         ST    @15,@AFTEMPS+4                                      0397 01078000
         LA    @15,@AFTEMPS+4                                      0397 01079000
         ST    @15,@AL00001                                        0397 01080000
         LA    @01,@AL00001                                        0397 01081000
         BAL   @14,EDITFIX                                         0397 01082000
*         PF31=FIXOUT(10:13);       /* NUMBER OF LOADS       @Y30LB40*/ 01083000
         MVC   PF31(4),FIXOUT+9                                    0398 01084000
*         CALL EDITFIX(ADDR(STGDTOT(I,J)),4,'S');/*          @Y30LB40*/ 01085000
         MVC   @AL00001+4(8),@AL00399                              0399 01086000
         LR    @15,I                                               0399 01087000
         ALR   @15,@15                                             0399 01088000
         ALR   @15,J                                               0399 01089000
         MH    @15,@CH00729                                        0399 01090000
         LA    @15,STGDTOT-108(@15)                                0399 01091000
         ST    @15,@AFTEMPS+4                                      0399 01092000
         LA    @15,@AFTEMPS+4                                      0399 01093000
         ST    @15,@AL00001                                        0399 01094000
         LA    @01,@AL00001                                        0399 01095000
         BAL   @14,EDITFIX                                         0399 01096000
*         PF33=FIXOUT(10:13);       /* NUMBER OF STAGES      @Y30LB40*/ 01097000
         MVC   PF33(4),FIXOUT+9                                    0400 01098000
*         IF J=1 THEN                                              0401 01099000
         C     J,@CF00043                                          0401 01100000
         BNE   @RF00401                                            0401 01101000
*           DO;                     /* VTOC STAGES IF CART PAIR 0  0402 01102000
*                                                            @Y30LB40*/ 01103000
*             CALL EDITFIX(ADDR(VTOCSG(I,J)),4,'S');/*       @Y30LB40*/ 01104000
         MVC   @AL00001+4(8),@AL00403                              0403 01105000
         LR    @15,I                                               0403 01106000
         ALR   @15,@15                                             0403 01107000
         ALR   @15,J                                               0403 01108000
         MH    @15,@CH00729                                        0403 01109000
         LA    @15,VTOCSG-108(@15)                                 0403 01110000
         ST    @15,@AFTEMPS+4                                      0403 01111000
         LA    @15,@AFTEMPS+4                                      0403 01112000
         ST    @15,@AL00001                                        0403 01113000
         LA    @01,@AL00001                                        0403 01114000
         BAL   @14,EDITFIX                                         0403 01115000
*             PF35=FIXOUT(10:13);   /*                       @Y30LB40*/ 01116000
         MVC   PF35(4),FIXOUT+9                                    0404 01117000
*           END;                    /*                       @Y30LB40*/ 01118000
*         ELSE                                                     0406 01119000
*           PF35='    ';            /*                       @Y30LB40*/ 01120000
         B     @RC00401                                            0406 01121000
@RF00401 MVC   PF35(4),@CC00681                                    0406 01122000
*         CALL EDITFIX(ADDR(DSTGDTOT(I,J)),4,'S');/*         @Y30LB40*/ 01123000
@RC00401 MVC   @AL00001+4(8),@AL00407                              0407 01124000
         LR    @15,I                                               0407 01125000
         ALR   @15,@15                                             0407 01126000
         ALR   @15,J                                               0407 01127000
         MH    @15,@CH00729                                        0407 01128000
         LA    @15,DSTGDTOT-108(@15)                               0407 01129000
         ST    @15,@AFTEMPS+4                                      0407 01130000
         LA    @15,@AFTEMPS+4                                      0407 01131000
         ST    @15,@AL00001                                        0407 01132000
         LA    @01,@AL00001                                        0407 01133000
         BAL   @14,EDITFIX                                         0407 01134000
*         PF37=FIXOUT(10:13);       /* NUMBER OF DESTAGES    @Y30LB40*/ 01135000
         MVC   PF37(4),FIXOUT+9                                    0408 01136000
*         IF J=1 THEN                                              0409 01137000
         C     J,@CF00043                                          0409 01138000
         BNE   @RF00409                                            0409 01139000
*           DO;                     /* VTOC DESTAGES IF CART PAIR 0     01140000
*                                                            @Y30LB40*/ 01141000
*             CALL EDITFIX(ADDR(VTOCDS(I,J)),4,'S');/*       @Y30LB40*/ 01142000
         MVC   @AL00001+4(8),@AL00411                              0411 01143000
         LR    @15,I                                               0411 01144000
         ALR   @15,@15                                             0411 01145000
         ALR   @15,J                                               0411 01146000
         MH    @15,@CH00729                                        0411 01147000
         LA    @15,VTOCDS-108(@15)                                 0411 01148000
         ST    @15,@AFTEMPS+4                                      0411 01149000
         LA    @15,@AFTEMPS+4                                      0411 01150000
         ST    @15,@AL00001                                        0411 01151000
         LA    @01,@AL00001                                        0411 01152000
         BAL   @14,EDITFIX                                         0411 01153000
*             PF39=FIXOUT(10:13);   /*                       @Y30LB40*/ 01154000
         MVC   PF39(4),FIXOUT+9                                    0412 01155000
*           END;                    /*                       @Y30LB40*/ 01156000
*         ELSE                                                     0414 01157000
*           PF39='    ';            /*                       @Y30LB40*/ 01158000
         B     @RC00409                                            0414 01159000
@RF00409 MVC   PF39(4),@CC00681                                    0414 01160000
*         RFY                                                      0415 01161000
*          (R0,                                                    0415 01162000
*           R1,                                                    0415 01163000
*           R14,                                                   0415 01164000
*           R15) RSTD;              /*                       @Y30LB40*/ 01165000
@RC00409 DS    0H                                                  0416 01166000
*         GEN(PUT   PRNTDCB,PRINTLN);/* PRINT THE LINE       @Y30LB40*/ 01167000
         PUT   PRNTDCB,PRINTLN                                          01168000
*         RFY                                                      0417 01169000
*          (R0,                                                    0417 01170000
*           R1,                                                    0417 01171000
*           R14,                                                   0417 01172000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 01173000
*         LINECNT=LINECNT+1;        /* INCREMENT LINE COUNTER      0418 01174000
*                                                            @Y30LB40*/ 01175000
         AL    LINECNT,@CF00043                                    0418 01176000
*         PF1='      ';             /* CLEAR CONSTANT INFO   @Y30LB40*/ 01177000
         MVC   PF1(6),@CC00659                                     0419 01178000
*         PF3='        ';           /*                       @Y30LB40*/ 01179000
         MVC   PF3(8),@CC00673                                     0420 01180000
*         PF0A=' ';                 /*                       @Y30LB40*/ 01181000
         MVI   PF0A,C' '                                           0421 01182000
*         PF13='      ';            /*                       @Y30LB40*/ 01183000
*                                                                  0422 01184000
         MVC   PF13(6),@CC00659                                    0422 01185000
*         /***********************************************************/ 01186000
*         /*                                                         */ 01187000
*         /* ** CLEAR ARRAY **                               @Y30LB40*/ 01188000
*         /*                                                         */ 01189000
*         /***********************************************************/ 01190000
*                                                                  0423 01191000
*         SMSTGD(I,J)=0;            /*                       @Y30LB40*/ 01192000
         SLR   @15,@15                                             0423 01193000
         LR    @14,I                                               0423 01194000
         ALR   @14,@14                                             0423 01195000
         ALR   @14,J                                               0423 01196000
         MH    @14,@CH00729                                        0423 01197000
         ST    @15,SMSTGD-108(@14)                                 0423 01198000
*         SMCFAULT(I,J)=0;          /*                       @Y30LB40*/ 01199000
         ST    @15,SMCFAULT-108(@14)                               0424 01200000
*         SMDSTGD(I,J)=0;           /*                       @Y30LB40*/ 01201000
         ST    @15,SMDSTGD-108(@14)                                0425 01202000
*         SMSALLOC(I,J)=0;          /*                       @Y30LB40*/ 01203000
         ST    @15,SMSALLOC-108(@14)                               0426 01204000
*         LOADS(I,J)=0;             /*                       @Y30LB40*/ 01205000
         ST    @15,LOADS-108(@14)                                  0427 01206000
*         STGDTOT(I,J)=0;           /*                       @Y30LB40*/ 01207000
         ST    @15,STGDTOT-108(@14)                                0428 01208000
*         VTOCSG(I,J)=0;            /*                       @Y30LB40*/ 01209000
         ST    @15,VTOCSG-108(@14)                                 0429 01210000
*         DSTGDTOT(I,J)=0;          /*                       @Y30LB40*/ 01211000
         ST    @15,DSTGDTOT-108(@14)                               0430 01212000
*         VTOCDS(I,J)=0;            /*                       @Y30LB40*/ 01213000
         ST    @15,VTOCDS-108(@14)                                 0431 01214000
*       END;                        /*                       @Y30LB40*/ 01215000
*   END;                            /*                       @Y30LB40*/ 01216000
@RF00381 AL    J,@CF00043                                          0433 01217000
         C     J,@CF00050                                          0433 01218000
         BNH   @DL00364                                            0433 01219000
*   IF EOFSW='1'B THEN                                             0434 01220000
         TM    EOFSW,B'10000000'                                   0434 01221000
         BNO   @RF00434                                            0434 01222000
*     DO;                           /* IF END OF FILE REACHED      0435 01223000
*                                                            @Y30LB40*/ 01224000
*       IF I=2 THEN                                                0436 01225000
         C     I,@CF00050                                          0436 01226000
         BE    @RT00436                                            0436 01227000
*         GO TO EOJ;                /* IF VOLID TOTAL WRITTEN,EXIT   */ 01228000
*       RFY                                                        0438 01229000
*        (R0,                                                      0438 01230000
*         R1,                                                      0438 01231000
*         R14,                                                     0438 01232000
*         R15) RSTD;                /*                       @Y30LB40*/ 01233000
*       GEN(PUT   PRNTDCB,SPACE1);  /* SKIP A LINE           @Y30LB40*/ 01234000
         PUT   PRNTDCB,SPACE1                                           01235000
*       RFY                                                        0440 01236000
*        (R0,                                                      0440 01237000
*         R1,                                                      0440 01238000
*         R14,                                                     0440 01239000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01240000
*       LINECNT=LINECNT+1;          /* BUMP LINE COUNTER     @Y30LB40*/ 01241000
         AL    LINECNT,@CF00043                                    0441 01242000
*       I=2;                        /* SET FOR VOLID TOTALS  @Y30LB40*/ 01243000
         LA    I,2                                                 0442 01244000
*       GO TO PROCBRK;              /* GO PRINT VOLID TOTALS @Y30LB40*/ 01245000
         B     PROCBRK                                             0443 01246000
*     END;                          /*                       @Y30LB40*/ 01247000
*   IF LIBSW='1'B THEN                                             0445 01248000
@RF00434 TM    LIBSW,B'10000000'                                   0445 01249000
         BNO   @RF00445                                            0445 01250000
*     DO;                           /* IF LIBRARY CONTROL BREAK    0446 01251000
*                                                            @Y30LB40*/ 01252000
*       IF I=2                      /* IF VOLID TOTALS WRITTEN     0447 01253000
*                                                            @Y30LB40*/ 01254000
*         THEN                                                     0447 01255000
         C     I,@CF00050                                          0447 01256000
         BNE   @RF00447                                            0447 01257000
*         DO;                       /* FORCE NEW PAGE        @Y30LB40*/ 01258000
*           LIBSW='0'B;             /*                       @Y30LB40*/ 01259000
         NI    LIBSW,B'01111111'                                   0449 01260000
*           LINECNT=56;             /*                       @Y30LB40*/ 01261000
         LA    LINECNT,56                                          0450 01262000
*           GO TO NEWLIB;           /* GO SETUP NEW TIME SLICE     0451 01263000
*                                                            @Y30LB40*/ 01264000
         B     NEWLIB                                              0451 01265000
*         END;                      /*                       @Y30LB40*/ 01266000
*       ELSE                                                       0453 01267000
*         DO;                       /* VOLID TOTALS NOT YET WRITTEN     01268000
*                                                            @Y30LB40*/ 01269000
@RF00447 DS    0H                                                  0454 01270000
*           RFY                                                    0454 01271000
*            (R0,                                                  0454 01272000
*             R1,                                                  0454 01273000
*             R14,                                                 0454 01274000
*             R15) RSTD;            /*                       @Y30LB40*/ 01275000
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/ 01276000
         PUT   PRNTDCB,SPACE1                                           01277000
*           RFY                                                    0456 01278000
*            (R0,                                                  0456 01279000
*             R1,                                                  0456 01280000
*             R14,                                                 0456 01281000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 01282000
*           LINECNT=LINECNT+1;      /* INCREMENT LINE COUNTER      0457 01283000
*                                                            @Y30LB40*/ 01284000
         AL    LINECNT,@CF00043                                    0457 01285000
*           I=2;                    /* SET FOR VOLID TOTALS  @Y30LB40*/ 01286000
         LA    I,2                                                 0458 01287000
*           GO TO PROCBRK;          /* GO PRINT VOLID TOTALS @Y30LB40*/ 01288000
         B     PROCBRK                                             0459 01289000
*         END;                      /*                       @Y30LB40*/ 01290000
*     END;                          /*                       @Y30LB40*/ 01291000
*   IF VOLSW='1'B THEN                                             0462 01292000
@RF00445 TM    VOLSW,B'10000000'                                   0462 01293000
         BNO   @RF00462                                            0462 01294000
*     DO;                           /* IF VOLUME CONTROL BREAK     0463 01295000
*                                                            @Y30LB40*/ 01296000
*       IF I=2                      /* IF VOLID TOTALS WRITTEN     0464 01297000
*                                                            @Y30LB40*/ 01298000
*         THEN                                                     0464 01299000
         C     I,@CF00050                                          0464 01300000
         BNE   @RF00464                                            0464 01301000
*         DO;                       /* SKIP TWO LINES        @Y30LB40*/ 01302000
*           VOLSW='0'B;             /*                       @Y30LB40*/ 01303000
         NI    VOLSW,B'01111111'                                   0466 01304000
*           RFY                                                    0467 01305000
*            (R0,                                                  0467 01306000
*             R1,                                                  0467 01307000
*             R14,                                                 0467 01308000
*             R15) RSTD;            /*                       @Y30LB40*/ 01309000
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/ 01310000
         PUT   PRNTDCB,SPACE1                                           01311000
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/ 01312000
         PUT   PRNTDCB,SPACE1                                           01313000
*           RFY                                                    0470 01314000
*            (R0,                                                  0470 01315000
*             R1,                                                  0470 01316000
*             R14,                                                 0470 01317000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 01318000
*           LINECNT=LINECNT+2;      /* INCREMENT LINE COUNTER      0471 01319000
*                                                            @Y30LB40*/ 01320000
         AL    LINECNT,@CF00050                                    0471 01321000
*           GO TO NEWLIB;           /* GO SETUP NEW TIME SLICE     0472 01322000
*                                                            @Y30LB40*/ 01323000
         B     NEWLIB                                              0472 01324000
*         END;                      /*                       @Y30LB40*/ 01325000
*       ELSE                                                       0474 01326000
*         DO;                       /* VOLID TOTALS NOT YET WRITTEN     01327000
*                                                            @Y30LB40*/ 01328000
@RF00464 DS    0H                                                  0475 01329000
*           RFY                                                    0475 01330000
*            (R0,                                                  0475 01331000
*             R1,                                                  0475 01332000
*             R14,                                                 0475 01333000
*             R15) RSTD;            /*                       @Y30LB40*/ 01334000
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/ 01335000
         PUT   PRNTDCB,SPACE1                                           01336000
*           RFY                                                    0477 01337000
*            (R0,                                                  0477 01338000
*             R1,                                                  0477 01339000
*             R14,                                                 0477 01340000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 01341000
*           LINECNT=LINECNT+1;      /* INCREMENT LINE COUNTER      0478 01342000
*                                                            @Y30LB40*/ 01343000
         AL    LINECNT,@CF00043                                    0478 01344000
*           I=2;                    /* SET FOR VOLID TOTALS  @Y30LB40*/ 01345000
         LA    I,2                                                 0479 01346000
*           GO TO PROCBRK;          /* GO PRINT VOLID TOTALS @Y30LB40*/ 01347000
         B     PROCBRK                                             0480 01348000
*         END;                      /*                       @Y30LB40*/ 01349000
*     END;                          /*                       @Y30LB40*/ 01350000
*   IF TMESW='1'B THEN                                             0483 01351000
@RF00462 TM    TMESW,B'10000000'                                   0483 01352000
         BNO   @RF00483                                            0483 01353000
*     DO;                           /* TIME SLICE EXCEEDED   @Y30LB40*/ 01354000
*       TMESW='0'B;                 /*                       @Y30LB40*/ 01355000
         NI    TMESW,B'01111111'                                   0485 01356000
*       RFY                                                        0486 01357000
*        (R0,                                                      0486 01358000
*         R1,                                                      0486 01359000
*         R14,                                                     0486 01360000
*         R15) RSTD;                /*                       @Y30LB40*/ 01361000
*       GEN(PUT   PRNTDCB,SPACE1);  /* SKIP A LINE           @Y30LB40*/ 01362000
         PUT   PRNTDCB,SPACE1                                           01363000
*       RFY                                                        0488 01364000
*        (R0,                                                      0488 01365000
*         R1,                                                      0488 01366000
*         R14,                                                     0488 01367000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01368000
*       LINECNT=LINECNT+1;          /* INCREMENT LINE COUNTER      0489 01369000
*                                                            @Y30LB40*/ 01370000
         AL    LINECNT,@CF00043                                    0489 01371000
*       CALL GETSLICE;              /*                       @OZ11673*/ 01372000
         BAL   @14,GETSLICE                                        0490 01373000
*     END;                          /*                       @OZ11673*/ 01374000
*   GO TO CHECKTIM;                 /* GO ACCUMULATE TOTALS  @Y30LB40*/ 01375000
         B     CHECKTIM                                            0492 01376000
*/********************************************************************  01377000
*                                                                    */ 01378000
*                                                                  0493 01379000
*EOF:                               /* IF END OF FILE REACHED      0493 01380000
*                                                            @Y30LB40*/ 01381000
*   EOFSW='1'B;                     /* INDICATE END OF FILE  @Y30LB40*/ 01382000
EOF      OI    EOFSW,B'10000000'                                   0493 01383000
*   GO TO VOLIDBRK;                 /* GO PRINT FINAL TOTALS @Y30LB40*/ 01384000
         B     VOLIDBRK                                            0494 01385000
*                                                                  0495 01386000
*/********************************************************************  01387000
*                                                                    */ 01388000
*/* END OF JOB, CLOSE FILES, PROCESSING COMPLETE.            @Y30LB40*/ 01389000
*/********************************************************************  01390000
*                                                                    */ 01391000
*                                                                  0495 01392000
*EOJ:                                                              0495 01393000
*   PRINTLN=RCDTOTAL;               /* PRINT JCL PARMS AND RECORD  0495 01394000
*                                      TOTALS                @Y30LB40*/ 01395000
EOJ      MVC   PRINTLN(121),RCDTOTAL                               0495 01396000
*   TIMESL=TIMESL/60;               /*                       @Y30LB40*/ 01397000
         L     @00,TIMESL                                          0496 01398000
         SRDA  @00,32                                              0496 01399000
         D     @00,@CF00334                                        0496 01400000
         ST    @01,TIMESL                                          0496 01401000
*   CALL EDITFIX(ADDR(TIMESL),4,'S');/*                      @Y30LB40*/ 01402000
         MVC   @AL00001+4(8),@AL00497                              0497 01403000
         LA    @15,TIMESL                                          0497 01404000
         ST    @15,@AFTEMPS+4                                      0497 01405000
         LA    @15,@AFTEMPS+4                                      0497 01406000
         ST    @15,@AL00001                                        0497 01407000
         LA    @01,@AL00001                                        0497 01408000
         BAL   @14,EDITFIX                                         0497 01409000
*   PRINTLN(12:14)=FIXOUT(11:13);   /*                       @Y30LB40*/ 01410000
         MVC   PRINTLN+11(3),FIXOUT+10                             0498 01411000
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/ 01412000
         MVC   @AL00001+4(8),@AL00499                              0499 01413000
         LA    @15,HLDSYR                                          0499 01414000
         ST    @15,@AFTEMPS+4                                      0499 01415000
         LA    @15,@AFTEMPS+4                                      0499 01416000
         ST    @15,@AL00001                                        0499 01417000
         LA    @01,@AL00001                                        0499 01418000
         BAL   @14,EDITFIX                                         0499 01419000
*   PRINTLN(25:26)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01420000
         MVC   PRINTLN+24(2),FIXOUT+11                             0500 01421000
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/ 01422000
         MVC   @AL00001+4(8),@AL00501                              0501 01423000
         LA    @15,HLDSDAY                                         0501 01424000
         ST    @15,@AFTEMPS+4                                      0501 01425000
         LA    @15,@AFTEMPS+4                                      0501 01426000
         ST    @15,@AL00001                                        0501 01427000
         LA    @01,@AL00001                                        0501 01428000
         BAL   @14,EDITFIX                                         0501 01429000
*   PRINTLN(27:29)=FIXOUT(11:13);   /*                       @Y30LB40*/ 01430000
         MVC   PRINTLN+26(3),FIXOUT+10                             0502 01431000
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/ 01432000
         MVC   @AL00001+4(8),@AL00503                              0503 01433000
         LA    @15,HLDEYR                                          0503 01434000
         ST    @15,@AFTEMPS+4                                      0503 01435000
         LA    @15,@AFTEMPS+4                                      0503 01436000
         ST    @15,@AL00001                                        0503 01437000
         LA    @01,@AL00001                                        0503 01438000
         BAL   @14,EDITFIX                                         0503 01439000
*   PRINTLN(31:32)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01440000
         MVC   PRINTLN+30(2),FIXOUT+11                             0504 01441000
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/ 01442000
         MVC   @AL00001+4(8),@AL00505                              0505 01443000
         LA    @15,HLDEDAY                                         0505 01444000
         ST    @15,@AFTEMPS+4                                      0505 01445000
         LA    @15,@AFTEMPS+4                                      0505 01446000
         ST    @15,@AL00001                                        0505 01447000
         LA    @01,@AL00001                                        0505 01448000
         BAL   @14,EDITFIX                                         0505 01449000
*   PRINTLN(33:35)=FIXOUT(11:13);   /*                       @Y30LB40*/ 01450000
         MVC   PRINTLN+32(3),FIXOUT+10                             0506 01451000
*   HOUR=HLDSTIME/3600;             /*                       @Y30LB40*/ 01452000
         L     @15,HLDSTIME                                        0507 01453000
         LA    @14,3600                                            0507 01454000
         LR    @00,@15                                             0507 01455000
         SRDA  @00,32                                              0507 01456000
         DR    @00,@14                                             0507 01457000
         ST    @01,HOUR                                            0507 01458000
*   MINUTE=(HLDSTIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 01459000
         MR    @00,@14                                             0508 01460000
         LR    @02,@15                                             0508 01461000
         SLR   @02,@01                                             0508 01462000
         SRDA  @02,32                                              0508 01463000
         D     @02,@CF00334                                        0508 01464000
         ST    @03,MINUTE                                          0508 01465000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 01466000
         MVC   @AL00001+4(8),@AL00509                              0509 01467000
         LA    @15,HOUR                                            0509 01468000
         ST    @15,@AFTEMPS+4                                      0509 01469000
         LA    @15,@AFTEMPS+4                                      0509 01470000
         ST    @15,@AL00001                                        0509 01471000
         LA    @01,@AL00001                                        0509 01472000
         BAL   @14,EDITFIX                                         0509 01473000
*   PRINTLN(46:47)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01474000
         MVC   PRINTLN+45(2),FIXOUT+11                             0510 01475000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 01476000
         MVC   @AL00001+4(8),@AL00511                              0511 01477000
         LA    @15,MINUTE                                          0511 01478000
         ST    @15,@AFTEMPS+4                                      0511 01479000
         LA    @15,@AFTEMPS+4                                      0511 01480000
         ST    @15,@AL00001                                        0511 01481000
         LA    @01,@AL00001                                        0511 01482000
         BAL   @14,EDITFIX                                         0511 01483000
*   PRINTLN(48:49)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01484000
         MVC   PRINTLN+47(2),FIXOUT+11                             0512 01485000
*   HOUR=HLDETIME/3600;             /*                       @Y30LB40*/ 01486000
         L     @15,HLDETIME                                        0513 01487000
         LA    @14,3600                                            0513 01488000
         LR    @00,@15                                             0513 01489000
         SRDA  @00,32                                              0513 01490000
         DR    @00,@14                                             0513 01491000
         ST    @01,HOUR                                            0513 01492000
*   MINUTE=(HLDETIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 01493000
         MR    @00,@14                                             0514 01494000
         LR    @02,@15                                             0514 01495000
         SLR   @02,@01                                             0514 01496000
         SRDA  @02,32                                              0514 01497000
         D     @02,@CF00334                                        0514 01498000
         ST    @03,MINUTE                                          0514 01499000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 01500000
         MVC   @AL00001+4(8),@AL00515                              0515 01501000
         LA    @15,HOUR                                            0515 01502000
         ST    @15,@AFTEMPS+4                                      0515 01503000
         LA    @15,@AFTEMPS+4                                      0515 01504000
         ST    @15,@AL00001                                        0515 01505000
         LA    @01,@AL00001                                        0515 01506000
         BAL   @14,EDITFIX                                         0515 01507000
*   PRINTLN(51:52)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01508000
         MVC   PRINTLN+50(2),FIXOUT+11                             0516 01509000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 01510000
         MVC   @AL00001+4(8),@AL00517                              0517 01511000
         LA    @15,MINUTE                                          0517 01512000
         ST    @15,@AFTEMPS+4                                      0517 01513000
         LA    @15,@AFTEMPS+4                                      0517 01514000
         ST    @15,@AL00001                                        0517 01515000
         LA    @01,@AL00001                                        0517 01516000
         BAL   @14,EDITFIX                                         0517 01517000
*   PRINTLN(53:54)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01518000
         MVC   PRINTLN+52(2),FIXOUT+11                             0518 01519000
*   IF VOL¬='      '                /* IF VOLUME SPECIFIED   @Y30LB40*/ 01520000
*     THEN                                                         0519 01521000
         CLC   VOL(6),@CC00659                                     0519 01522000
         BE    @RF00519                                            0519 01523000
*     PRINTLN(66:71)=VOL;           /* PRINT IT              @Y30LB40*/ 01524000
         MVC   PRINTLN+65(6),VOL                                   0520 01525000
*   ELSE                                                           0521 01526000
*     PRINTLN(57:71)='               ';/* ELSE BLANK IT              */ 01527000
         B     @RC00519                                            0521 01528000
@RF00519 MVC   PRINTLN+56(15),@CC00701                             0521 01529000
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/ 01530000
@RC00519 MVC   @AL00001+4(8),@AL00522                              0522 01531000
         LA    @15,RCDCOUNT                                        0522 01532000
         ST    @15,@AFTEMPS+4                                      0522 01533000
         LA    @15,@AFTEMPS+4                                      0522 01534000
         ST    @15,@AL00001                                        0522 01535000
         LA    @01,@AL00001                                        0522 01536000
         BAL   @14,EDITFIX                                         0522 01537000
*   PRINTLN(99:104)=FIXOUT(8:13);   /*                       @Y30LB40*/ 01538000
         MVC   PRINTLN+98(6),FIXOUT+7                              0523 01539000
*   RFY                                                            0524 01540000
*    (R0,                                                          0524 01541000
*     R1,                                                          0524 01542000
*     R14,                                                         0524 01543000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01544000
*   GEN(PUT   PRNTDCB,PRINTLN);     /*                       @Y30LB40*/ 01545000
         PUT   PRNTDCB,PRINTLN                                          01546000
*   RFY                                                            0526 01547000
*    (R0,                                                          0526 01548000
*     R1,                                                          0526 01549000
*     R14,                                                         0526 01550000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01551000
*CLOSEFIL:                                                         0527 01552000
*   RFY                                                            0527 01553000
*    (R0,                                                          0527 01554000
*     R1,                                                          0527 01555000
*     R14,                                                         0527 01556000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01557000
CLOSEFIL DS    0H                                                  0528 01558000
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/ 01559000
         CLOSE INDCB,MF=(E,OPENCLOS)                                    01560000
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/ 01561000
         CLOSE PRNTDCB,MF=(E,OPENCLOS)                                  01562000
*   RFY                                                            0530 01563000
*    (R0,                                                          0530 01564000
*     R1,                                                          0530 01565000
*     R14,                                                         0530 01566000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01567000
*   RETURN CODE(RETURNCD);          /* EXIT WITH RETURN CODE @Y30LB40*/ 01568000
         L     @13,4(,@13)                                         0531 01569000
         L     @00,@SIZDATD                                        0531 01570000
         LR    @01,@10                                             0531 01571000
         FREEMAIN R,LV=(0),A=(1)                                        01572000
         LR    @15,@09                                             0531 01573000
         L     @14,12(,@13)                                        0531 01574000
         LM    @00,@12,20(@13)                                     0531 01575000
         BR    @14                                                 0531 01576000
*/********************************************************************  01577000
*                                                                    */ 01578000
*                                                                  0532 01579000
*                                                                  0532 01580000
*/********************************************************** @OZ11673*/ 01581000
*/*                                                          @OZ11673*/ 01582000
*/* PROCEDURE NAME - GETSLICE                                @OZ11673*/ 01583000
*/*                                                          @OZ11673*/ 01584000
*/* FUNCTION - BUMP THE TIMESLICE COMPARE VALUE UNTIL THE    @OZ11673*/ 01585000
*/*            CURRENT TIME IN THE DETAIL RECORD FALLS       @OZ11673*/ 01586000
*/*            WITHIN THE TIMESLICE RANGE.                   @OZ11673*/ 01587000
*/*                                                          @OZ11673*/ 01588000
*/********************************************************** @OZ11673*/ 01589000
*                                                                  0532 01590000
*GETSLICE:                                                         0532 01591000
*   PROCEDURE;                      /*                       @OZ11673*/ 01592000
GETSLICE STM   @14,@12,12(@13)                                     0532 01593000
*   DO WHILE(CKTIME>TSEND);         /* SETUP NEXT TIME SLICE INTERVAL*/ 01594000
         B     @DE00533                                            0533 01595000
@DL00533 DS    0H                                                  0534 01596000
*     TSBEG=TSEND;                  /*                       @Y30LB40*/ 01597000
         MVC   TSBEG(7),TSEND                                      0534 01598000
*     TSETIME=TSETIME+TIMESL;       /*                       @Y30LB40*/ 01599000
         L     @15,TSETIME                                         0535 01600000
         AL    @15,TIMESL                                          0535 01601000
         ST    @15,TSETIME                                         0535 01602000
*     IF TSETIME>86399 THEN                                        0536 01603000
         C     @15,@CF00637                                        0536 01604000
         BNH   @RF00536                                            0536 01605000
*       DO;                         /*                       @Y30LB40*/ 01606000
*         TSETIME=TSETIME-86400;    /*                       @Y30LB40*/ 01607000
         SL    @15,@CF00708                                        0538 01608000
         ST    @15,TSETIME                                         0538 01609000
*         TSEDAY=TSEDAY+1;          /*                       @Y30LB40*/ 01610000
         LA    @15,1                                               0539 01611000
         LH    @14,TSEDAY                                          0539 01612000
         ALR   @14,@15                                             0539 01613000
         STH   @14,TSEDAY                                          0539 01614000
*         IF TSEDAY>365 THEN                                       0540 01615000
         C     @14,@CF00636                                        0540 01616000
         BNH   @RF00540                                            0540 01617000
*           DO;                     /*                       @Y30LB40*/ 01618000
*             IF(TSEND(1:1)&'00000011'B)='00000000'B THEN          0542 01619000
         MVC   @TS00001(1),TSEND                                   0542 01620000
         NI    @TS00001,B'00000011'                                0542 01621000
         CLI   @TS00001,B'00000000'                                0542 01622000
         BNE   @RF00542                                            0542 01623000
*               IF TSEDAY>366 THEN                                 0543 01624000
         LA    @07,366                                             0543 01625000
         CR    @14,@07                                             0543 01626000
         BNH   @RF00543                                            0543 01627000
*                 DO;               /*                       @Y30LB40*/ 01628000
*                   TSEDAY=TSEDAY-366;/*                     @Y30LB40*/ 01629000
         SLR   @14,@07                                             0545 01630000
         STH   @14,TSEDAY                                          0545 01631000
*                   TSEYR=TSEYR+1;  /*                       @Y30LB40*/ 01632000
         SLR   @14,@14                                             0546 01633000
         IC    @14,TSEYR                                           0546 01634000
         ALR   @15,@14                                             0546 01635000
         STC   @15,TSEYR                                           0546 01636000
*                 END;              /*                       @Y30LB40*/ 01637000
*               ELSE                                               0548 01638000
*                 ;                 /*                       @Y30LB40*/ 01639000
@RF00543 DS    0H                                                  0549 01640000
*             ELSE                                                 0549 01641000
*               DO;                 /*                       @Y30LB40*/ 01642000
         B     @RC00542                                            0549 01643000
@RF00542 DS    0H                                                  0550 01644000
*                 TSEDAY=TSEDAY-365;/*                       @Y30LB40*/ 01645000
         LH    @15,TSEDAY                                          0550 01646000
         SL    @15,@CF00636                                        0550 01647000
         STH   @15,TSEDAY                                          0550 01648000
*                 TSEYR=TSEYR+1;    /*                       @Y30LB40*/ 01649000
         LA    @15,1                                               0551 01650000
         SLR   @14,@14                                             0551 01651000
         IC    @14,TSEYR                                           0551 01652000
         ALR   @15,@14                                             0551 01653000
         STC   @15,TSEYR                                           0551 01654000
*               END;                /*                       @Y30LB40*/ 01655000
*           END;                    /*                       @Y30LB40*/ 01656000
@RC00542 DS    0H                                                  0554 01657000
*       END;                        /*                       @Y30LB40*/ 01658000
@RF00540 DS    0H                                                  0555 01659000
*   END;                            /*                       @Y30LB40*/ 01660000
@RF00536 DS    0H                                                  0555 01661000
@DE00533 CLC   CKTIME(7),TSEND                                     0555 01662000
         BH    @DL00533                                            0555 01663000
*   END GETSLICE;                   /*                       @OZ11673*/ 01664000
@EL00002 DS    0H                                                  0556 01665000
@EF00002 DS    0H                                                  0556 01666000
@ER00002 LM    @14,@12,12(@13)                                     0556 01667000
         BR    @14                                                 0556 01668000
*                                                                  0557 01669000
*/********************************************************************  01670000
*                                                                    */ 01671000
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */ 01672000
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */ 01673000
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/ 01674000
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1, 2, OR 4  01675000
*                                                                    */ 01676000
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/ 01677000
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/ 01678000
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/ 01679000
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/ 01680000
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */ 01681000
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/ 01682000
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */ 01683000
*/* LONG.                                                    @Y30LB40*/ 01684000
*/********************************************************************  01685000
*                                                                    */ 01686000
*                                                                  0557 01687000
*EDITFIX:                                                          0557 01688000
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/ 01689000
EDITFIX  STM   @14,@12,@SA00003                                    0557 01690000
         MVC   @PC00003(12),0(@01)                                 0557 01691000
*   DCL                                                            0558 01692000
*     FIXADDR PTR(31);              /* ADDRESS OF INPUT FIELD      0558 01693000
*                                                            @Y30LB40*/ 01694000
*   DCL                                                            0559 01695000
*     FIXLEN PTR(31);               /* LENGTH OF INPUT FIELD @Y30LB40*/ 01696000
*   DCL                                                            0560 01697000
*     FIXOPT CHAR(1);               /* EDITING OPTION DESIRED      0560 01698000
*                                                            @Y30LB40*/ 01699000
*   RFY                                                            0561 01700000
*    (R2,                                                          0561 01701000
*     R3) RSTD;                     /*                       @Y30LB40*/ 01702000
*   R2=FIXADDR;                     /*                       @Y30LB40*/ 01703000
         L     @15,@PC00003                                        0562 01704000
         L     R2,FIXADDR(,@15)                                    0562 01705000
*   R3=0;                           /*                       @Y30LB40*/ 01706000
         SLR   R3,R3                                               0563 01707000
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE   01708000
*                                                            @Y30LB40*/ 01709000
*     THEN                                                         0564 01710000
         L     @15,@PC00003+4                                      0564 01711000
         CLC   FIXLEN(4,@15),@CF00043                              0564 01712000
         BNE   @RF00564                                            0564 01713000
*     DO;                           /*                       @Y30LB40*/ 01714000
*       GEN(IC    R3,0(R2));        /*                       @Y30LB40*/ 01715000
         IC    R3,0(R2)                                                 01716000
*     END;                          /*                       @Y30LB40*/ 01717000
*   ELSE                                                           0568 01718000
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   0568 01719000
*                                      BYTES                 @Y30LB40*/ 01720000
*       THEN                                                       0568 01721000
         B     @RC00564                                            0568 01722000
@RF00564 L     @15,@PC00003+4                                      0568 01723000
         CLC   FIXLEN(4,@15),@CF00050                              0568 01724000
         BNE   @RF00568                                            0568 01725000
*       DO;                         /*                       @Y30LB40*/ 01726000
*         GEN(LH    R3,0(R2));      /*                       @Y30LB40*/ 01727000
         LH    R3,0(R2)                                                 01728000
*       END;                        /*                       @Y30LB40*/ 01729000
*     ELSE                                                         0572 01730000
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/ 01731000
         B     @RC00568                                            0572 01732000
@RF00568 DS    0H                                                  0573 01733000
*         GEN(L     R3,0(R2));      /*                       @Y30LB40*/ 01734000
         L     R3,0(R2)                                                 01735000
*       END;                        /*                       @Y30LB40*/ 01736000
*   GEN;                                                           0575 01737000
@RC00568 DS    0H                                                  0575 01738000
@RC00564 DS    0H                                                  0575 01739000
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/  01740000
  CVD   R3,DOUBLEWD                                                     01741000
  OI    DOUBLEWD+7,X'0F'                                                01742000
  UNPK  FIXOUT(13),DOUBLEWD+2(6)                                        01743000
*   IF FIXOPT='N' THEN                                             0576 01744000
         L     @15,@PC00003+8                                      0576 01745000
         CLI   FIXOPT(@15),C'N'                                    0576 01746000
         BE    @RT00576                                            0576 01747000
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */ 01748000
*   IF FIXOPT='S' THEN                                             0578 01749000
         CLI   FIXOPT(@15),C'S'                                    0578 01750000
         BE    @RT00578                                            0578 01751000
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       0579 01752000
*                                      INSERTION                     */ 01753000
*   GEN;                                                           0580 01754000
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/  01755000
  MVC   FIXOUT(1),FIXOUT+3                                              01756000
  MVI   FIXOUT+1,C','                                                   01757000
  MVC   FIXOUT+2(3),FIXOUT+4                                            01758000
  MVI   FIXOUT+5,C','                                                   01759000
  MVC   FIXOUT+6(3),FIXOUT+7                                            01760000
  MVI   FIXOUT+9,C','                                                   01761000
*EF4:                               /* ZERO AND COMMA SUPPRESS     0581 01762000
*                                                            @Y30LB40*/ 01763000
*   GEN;                                                           0581 01764000
EF4      DS    0H                                                  0581 01765000
*                                                         /*@Y30LB40*/  01766000
         LA    R2,FIXOUT                                                01767000
         LA    R3,12                                                    01768000
EF5      EQU   *                                                        01769000
         CLI   0(R2),C','                                               01770000
         BE    EF6                                                      01771000
         CLI   0(R2),C'0'                                               01772000
         BNE   EFEND                                                    01773000
EF6      EQU   *                                                        01774000
         MVI   0(R2),C' '                                               01775000
         LA    R2,1(R2)                                                 01776000
         BCT   R3,EF5                                                   01777000
*EFEND:                                                            0582 01778000
*   RFY                                                            0582 01779000
*    (R2,                                                          0582 01780000
*     R3) UNRSTD;                   /*                       @Y30LB40*/ 01781000
*   END EDITFIX;                    /*                       @Y30LB40*/ 01782000
@EL00003 DS    0H                                                  0583 01783000
@EF00003 DS    0H                                                  0583 01784000
@ER00003 LM    @14,@12,@SA00003                                    0583 01785000
         BR    @14                                                 0583 01786000
*                                                                  0584 01787000
*/********************************************************************  01788000
*                                                                    */ 01789000
*/* ROUTINE TO SETUP CONSTANT INFO IN PRINT LINE             @Y30LB40*/ 01790000
*/********************************************************************  01791000
*                                                                    */ 01792000
*                                                                  0584 01793000
*SETLINE:                                                          0584 01794000
*   PROC OPTIONS(SAVE);             /*                       @Y30LB40*/ 01795000
SETLINE  STM   @14,@12,@SA00004                                    0584 01796000
*   PRINTLN=' ';                    /* CLEAR PRINT LINE      @Y30LB40*/ 01797000
         MVI   PRINTLN+1,C' '                                      0585 01798000
         MVC   PRINTLN+2(119),PRINTLN+1                            0585 01799000
         MVI   PRINTLN,C' '                                        0585 01800000
*   PF1='  /   ';                   /*                       @Y30LB40*/ 01801000
         MVC   PF1(6),@CC00725                                     0586 01802000
*   CALL EDITFIX(ADDR(TSSYR),1,'N');/*                       @Y30LB40*/ 01803000
         MVC   @AL00001+4(8),@AL00587                              0587 01804000
         LA    @15,TSSYR                                           0587 01805000
         ST    @15,@AFTEMPS                                        0587 01806000
         LA    @15,@AFTEMPS                                        0587 01807000
         ST    @15,@AL00001                                        0587 01808000
         LA    @01,@AL00001                                        0587 01809000
         BAL   @14,EDITFIX                                         0587 01810000
*   PF1(1:2)=FIXOUT(12:13);         /* PRINT TIME SLICE YEAR @Y30LB40*/ 01811000
         MVC   PF1(2),FIXOUT+11                                    0588 01812000
*   CALL EDITFIX(ADDR(TSSDAY),2,'N');/*                      @Y30LB40*/ 01813000
         MVC   @AL00001+4(8),@AL00589                              0589 01814000
         LA    @15,TSSDAY                                          0589 01815000
         ST    @15,@AFTEMPS                                        0589 01816000
         LA    @15,@AFTEMPS                                        0589 01817000
         ST    @15,@AL00001                                        0589 01818000
         LA    @01,@AL00001                                        0589 01819000
         BAL   @14,EDITFIX                                         0589 01820000
*   PF1(4:6)=FIXOUT(11:13);         /* PRINT TIME SLICE DAY  @Y30LB40*/ 01821000
         MVC   PF1+3(3),FIXOUT+10                                  0590 01822000
*   HOUR=TSSTIME/3600;              /*                       @Y30LB40*/ 01823000
         L     @15,TSSTIME                                         0591 01824000
         LA    @14,3600                                            0591 01825000
         LR    @00,@15                                             0591 01826000
         SRDA  @00,32                                              0591 01827000
         DR    @00,@14                                             0591 01828000
         ST    @01,HOUR                                            0591 01829000
*   MINUTE=(TSSTIME-(HOUR*3600))/60;/*                       @Y30LB40*/ 01830000
         LA    @07,60                                              0592 01831000
         MR    @00,@14                                             0592 01832000
         LR    @02,@15                                             0592 01833000
         SLR   @02,@01                                             0592 01834000
         SRDA  @02,32                                              0592 01835000
         DR    @02,@07                                             0592 01836000
         ST    @03,MINUTE                                          0592 01837000
*   SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));/*              @Y30LB40*/ 01838000
         MR    @02,@07                                             0593 01839000
         ALR   @01,@03                                             0593 01840000
         SLR   @15,@01                                             0593 01841000
         ST    @15,SECOND                                          0593 01842000
*   PF3='  :  :  ';                 /*                       @Y30LB40*/ 01843000
         MVC   PF3(8),@CC00726                                     0594 01844000
*   CALL EDITFIX(ADDR(HOUR),4,'S'); /*                       @Y30LB40*/ 01845000
         MVC   @AL00001+4(8),@AL00595                              0595 01846000
         LA    @15,HOUR                                            0595 01847000
         ST    @15,@AFTEMPS                                        0595 01848000
         LA    @15,@AFTEMPS                                        0595 01849000
         ST    @15,@AL00001                                        0595 01850000
         LA    @01,@AL00001                                        0595 01851000
         BAL   @14,EDITFIX                                         0595 01852000
*   PF3(1:2)=FIXOUT(12:13);         /* PRINT TIME SLICE HOURS      0596 01853000
*                                                            @Y30LB40*/ 01854000
         MVC   PF3(2),FIXOUT+11                                    0596 01855000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 01856000
         MVC   @AL00001+4(8),@AL00597                              0597 01857000
         LA    @15,MINUTE                                          0597 01858000
         ST    @15,@AFTEMPS                                        0597 01859000
         LA    @15,@AFTEMPS                                        0597 01860000
         ST    @15,@AL00001                                        0597 01861000
         LA    @01,@AL00001                                        0597 01862000
         BAL   @14,EDITFIX                                         0597 01863000
*   PF3(4:5)=FIXOUT(12:13);         /* PRINT TIME SLICE MINUTES    0598 01864000
*                                                            @Y30LB40*/ 01865000
         MVC   PF3+3(2),FIXOUT+11                                  0598 01866000
*   CALL EDITFIX(ADDR(SECOND),4,'N');/*                      @Y30LB40*/ 01867000
         MVC   @AL00001+4(8),@AL00599                              0599 01868000
         LA    @15,SECOND                                          0599 01869000
         ST    @15,@AFTEMPS                                        0599 01870000
         LA    @15,@AFTEMPS                                        0599 01871000
         ST    @15,@AL00001                                        0599 01872000
         LA    @01,@AL00001                                        0599 01873000
         BAL   @14,EDITFIX                                         0599 01874000
*   PF3(7:8)=FIXOUT(12:13);         /* PRINT TIME SLICE SECONDS    0600 01875000
*                                                            @Y30LB40*/ 01876000
         MVC   PF3+6(2),FIXOUT+11                                  0600 01877000
*   PF13=VOLUME;                    /* PRINT VOLUME IDENTIFICATION 0601 01878000
*                                                            @Y30LB40*/ 01879000
         MVC   PF13(6),VOLUME                                      0601 01880000
*   CALL EDITFIX(ADDR(LIB),1,'N');  /*                       @Y30LB40*/ 01881000
         MVC   @AL00001+4(8),@AL00602                              0602 01882000
         LA    @15,LIB                                             0602 01883000
         ST    @15,@AFTEMPS                                        0602 01884000
         LA    @15,@AFTEMPS                                        0602 01885000
         ST    @15,@AL00001                                        0602 01886000
         LA    @01,@AL00001                                        0602 01887000
         BAL   @14,EDITFIX                                         0602 01888000
*   PF0A=FIXOUT(13:13);             /* PRINT LIBRARY NUMBER  @Y30LB40*/ 01889000
         MVC   PF0A(1),FIXOUT+12                                   0603 01890000
*   END SETLINE;                    /*                       @Y30LB40*/ 01891000
@EL00004 DS    0H                                                  0604 01892000
@EF00004 DS    0H                                                  0604 01893000
@ER00004 LM    @14,@12,@SA00004                                    0604 01894000
         BR    @14                                                 0604 01895000
*                                                                  0605 01896000
*/********************************************************** @OZ05124*/ 01897000
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/ 01898000
*/********************************************************** @OZ05124*/ 01899000
*                                                                  0605 01900000
*READERR:                                                          0605 01901000
*   ;                               /*                       @OZ05124*/ 01902000
READERR  DS    0H                                                  0606 01903000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/ 01904000
         SYNADAF ACSMETH=QSAM                                           01905000
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/ 01906000
         MVC   PRNTLINE+30(79),49(R1)                                   01907000
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/ 01908000
         MVC   PRNTLINE(30),ICGTR904                               0608 01909000
*   SAVE14=R14;                     /*                       @OZ09522*/ 01910000
         LR    SAVE14,R14                                          0609 01911000
*   RFY                                                            0610 01912000
*    (R0,                                                          0610 01913000
*     R1,                                                          0610 01914000
*     R14,                                                         0610 01915000
*     R15) RSTD;                    /*                       @OZ05124*/ 01916000
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/ 01917000
         PUT PRNTDCB,PRNTLINE                                           01918000
*   RFY                                                            0612 01919000
*    (R0,                                                          0612 01920000
*     R1,                                                          0612 01921000
*     R14,                                                         0612 01922000
*     R15) UNRSTD;                  /*                       @OZ05124*/ 01923000
*   R14=SAVE14;                     /*                       @OZ09522*/ 01924000
         LR    R14,SAVE14                                          0613 01925000
*   GEN(SYNADRLS);                  /*                       @OZ05124*/ 01926000
         SYNADRLS                                                       01927000
*   RETURNCD=4;                     /*                       @OZ05124*/ 01928000
         LA    RETURNCD,4                                          0615 01929000
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/ 01930000
         BR    R14                                                      01931000
*   END ICGTRVID                    /*                       @Y30LB40*/ 01932000
*                                                                  0617 01933000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01934000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 01935000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 01936000
*                                                                  0617 01937000
*       ;                                                          0617 01938000
@EL00001 L     @13,4(,@13)                                         0617 01939000
@EF00001 L     @00,@SIZDATD                                        0617 01940000
         LR    @01,@10                                             0617 01941000
         FREEMAIN R,LV=(0),A=(1)                                        01942000
@ER00001 LM    @14,@12,12(@13)                                     0617 01943000
         BR    @14                                                 0617 01944000
@DATA    DS    0H                                                       01945000
@CH00729 DC    H'36'                                                    01946000
@CH00653 DC    H'3600'                                                  01947000
@SM00738 MVC   PARMHOLD(0),PARMS(@03)                                   01948000
         DS    0F                                                       01949000
@AL00370 EQU   *                       LIST WITH   2 ARGUMENT(S)        01950000
@AL00397 EQU   *                       LIST WITH   2 ARGUMENT(S)        01951000
@AL00399 EQU   *                       LIST WITH   2 ARGUMENT(S)        01952000
@AL00403 EQU   *                       LIST WITH   2 ARGUMENT(S)        01953000
@AL00407 EQU   *                       LIST WITH   2 ARGUMENT(S)        01954000
@AL00411 EQU   *                       LIST WITH   2 ARGUMENT(S)        01955000
@AL00497 EQU   *                       LIST WITH   2 ARGUMENT(S)        01956000
@AL00522 EQU   *                       LIST WITH   2 ARGUMENT(S)        01957000
@AL00595 DC    A(@CF00103)             LIST WITH   2 ARGUMENT(S)        01958000
         DC    A(@CC00676)                                              01959000
@AL00386 EQU   *                       LIST WITH   2 ARGUMENT(S)        01960000
@AL00388 EQU   *                       LIST WITH   2 ARGUMENT(S)        01961000
@AL00390 EQU   *                       LIST WITH   2 ARGUMENT(S)        01962000
@AL00392 EQU   *                       LIST WITH   2 ARGUMENT(S)        01963000
@AL00395 DC    A(@CF00103)             LIST WITH   2 ARGUMENT(S)        01964000
         DC    A(@CC00680)                                              01965000
@AL00499 EQU   *                       LIST WITH   2 ARGUMENT(S)        01966000
@AL00503 EQU   *                       LIST WITH   2 ARGUMENT(S)        01967000
@AL00587 EQU   *                       LIST WITH   2 ARGUMENT(S)        01968000
@AL00602 DC    A(@CF00043)             LIST WITH   2 ARGUMENT(S)        01969000
         DC    A(@CC00686)                                              01970000
@AL00501 EQU   *                       LIST WITH   2 ARGUMENT(S)        01971000
@AL00505 EQU   *                       LIST WITH   2 ARGUMENT(S)        01972000
@AL00589 DC    A(@CF00050)             LIST WITH   2 ARGUMENT(S)        01973000
         DC    A(@CC00686)                                              01974000
@AL00509 EQU   *                       LIST WITH   2 ARGUMENT(S)        01975000
@AL00511 EQU   *                       LIST WITH   2 ARGUMENT(S)        01976000
@AL00515 EQU   *                       LIST WITH   2 ARGUMENT(S)        01977000
@AL00517 EQU   *                       LIST WITH   2 ARGUMENT(S)        01978000
@AL00597 EQU   *                       LIST WITH   2 ARGUMENT(S)        01979000
@AL00599 DC    A(@CF00103)             LIST WITH   2 ARGUMENT(S)        01980000
         DC    A(@CC00686)                                              01981000
@DATD    DSECT                                                          01982000
         DS    0F                                                       01983000
@SA00001 DS    18F                                                      01984000
@SA00004 DS    15F                                                      01985000
@SA00003 DS    15F                                                      01986000
@PC00003 DS    3F                                                       01987000
@AL00001 DS    3A                                                       01988000
@AFTEMPS DS    2F                                                       01989000
ICGTRVID CSECT                                                          01990000
         DS    0F                                                       01991000
@CF00043 DC    F'1'                                                     01992000
@CF00050 DC    F'2'                                                     01993000
@CF00103 DC    F'4'                                                     01994000
@CF00423 DC    F'9'                                                     01995000
@CF00033 DC    F'11'                                                    01996000
@CF00652 DC    F'23'                                                    01997000
@CF00539 DC    F'30'                                                    01998000
@CF00674 DC    F'55'                                                    01999000
@CF00654 DC    F'59'                                                    02000000
@CF00334 DC    F'60'                                                    02001000
@CH00334 EQU   @CF00334+2                                               02002000
@CF00636 DC    F'365'                                                   02003000
@CH00636 EQU   @CF00636+2                                               02004000
@CF00649 DC    F'366'                                                   02005000
@CH00649 EQU   @CF00649+2                                               02006000
@CF00631 DC    F'600'                                                   02007000
@CF00637 DC    F'86399'                                                 02008000
@CF00708 DC    F'86400'                                                 02009000
@DATD    DSECT                                                          02010000
         DS    0D                                                       02011000
DCBPTR   DS    A                                                        02012000
TIMESL   DS    F                                                        02013000
PARMPTR  DS    A                                                        02014000
OPENCLOS DS    FL4                                                      02015000
         ORG   OPENCLOS                                                 02016000
OPCLB1   DS    BL1                                                      02017000
OPCLB234 DS    CL3                                                      02018000
         ORG   OPENCLOS+4                                               02019000
RCDCOUNT DS    F                                                        02020000
PAGECNT  DS    F                                                        02021000
HOUR     DS    F                                                        02022000
MINUTE   DS    F                                                        02023000
SECOND   DS    F                                                        02024000
LIB      DS    FL1                                                      02025000
@TS00001 DS    CL1                                                      02026000
         DS    CL2                                                      02027000
RCDIN    DS    CL72                                                     02028000
         ORG   RCDIN                                                    02029000
STGD     DS    FL4                                                      02030000
CFAULT   DS    FL4                                                      02031000
SYSSGTM  DS    FL4                                                      02032000
DEVSGTM  DS    FL4                                                      02033000
DSTGD    DS    FL4                                                      02034000
SALLOC   DS    FL4                                                      02035000
SYSDSTM  DS    FL4                                                      02036000
DEVDSTM  DS    FL4                                                      02037000
BUSYTIME DS    FL4                                                      02038000
LOADTIME DS    FL4                                                      02039000
LOADNUM  DS    FL1                                                      02040000
CKTIME   DS    CL7                                                      02041000
         ORG   CKTIME                                                   02042000
SVEYEAR  DS    FL1                                                      02043000
SVEJUL   DS    FL2                                                      02044000
SVETIME  DS    FL4                                                      02045000
         ORG   RCDIN+48                                                 02046000
PAGES    DS    FL1                                                      02047000
MININUM  DS    FL1                                                      02048000
HITNUM   DS    FL1                                                      02049000
STGDNUM  DS    FL1                                                      02050000
DSTGDNUM DS    FL1                                                      02051000
VTOCSTG  DS    FL1                                                      02052000
VTOCDSTG DS    FL1                                                      02053000
LIBRARY  DS    FL1                                                      02054000
DSPORT   DS    FL1                                                      02055000
DSCU     DS    FL1                                                      02056000
Z        DS    FL1                                                      02057000
Y        DS    FL1                                                      02058000
X        DS    FL1                                                      02059000
CARTPAIR DS    FL1                                                      02060000
READWRIT DS    FL1                                                      02061000
VOLID    DS    CL6                                                      02062000
@NM00030 DS    CL3                                                      02063000
         ORG   RCDIN+72                                                 02064000
PRINTLN  DS    CL121                                                    02065000
         ORG   PRINTLN                                                  02066000
PF0      DS    CL1                                                      02067000
PF1      DS    CL6                                                      02068000
@NM00031 DS    CL1                                                      02069000
PF3      DS    CL8                                                      02070000
@NM00032 DS    CL1                                                      02071000
PF0A     DS    CL1                                                      02072000
@NM00033 DS    CL1                                                      02073000
PF13     DS    CL6                                                      02074000
@NM00034 DS    CL4                                                      02075000
PF13A    DS    CL1                                                      02076000
@NM00035 DS    CL5                                                      02077000
PF15     DS    CL9                                                      02078000
@NM00036 DS    CL1                                                      02079000
PF17     DS    CL9                                                      02080000
@NM00037 DS    CL1                                                      02081000
PF19     DS    CL9                                                      02082000
@NM00038 DS    CL1                                                      02083000
PF21     DS    CL9                                                      02084000
@NM00039 DS    CL1                                                      02085000
PF23     DS    CL9                                                      02086000
@NM00040 DS    CL2                                                      02087000
PF31     DS    CL4                                                      02088000
@NM00041 DS    CL2                                                      02089000
PF33     DS    CL4                                                      02090000
@NM00042 DS    CL2                                                      02091000
PF35     DS    CL4                                                      02092000
@NM00043 DS    CL2                                                      02093000
PF37     DS    CL4                                                      02094000
@NM00044 DS    CL2                                                      02095000
PF39     DS    CL4                                                      02096000
@NM00045 DS    CL7                                                      02097000
         ORG   PRINTLN+121                                              02098000
SPACE1   DS    CL121                                                    02099000
HEADHOLD DS    CL121                                                    02100000
PRNTLINE DS    CL121                                                    02101000
PRNTDCB  DS    CL100                                                    02102000
INDCB    DS    CL100                                                    02103000
STARTTIM DS    CL16                                                     02104000
         ORG   STARTTIM                                                 02105000
@NM00065 DS    CL1                                                      02106000
CKSTIME  DS    CL7                                                      02107000
         ORG   CKSTIME                                                  02108000
HLDSYR   DS    FL1                                                      02109000
HLDSDAY  DS    FL2                                                      02110000
HLDSTIME DS    FL4                                                      02111000
         ORG   STARTTIM+8                                               02112000
@NM00066 DS    CL1                                                      02113000
CKETIME  DS    CL7                                                      02114000
         ORG   CKETIME                                                  02115000
HLDEYR   DS    FL1                                                      02116000
HLDEDAY  DS    FL2                                                      02117000
HLDETIME DS    FL4                                                      02118000
         ORG   STARTTIM+16                                              02119000
TSTIMES  DS    CL16                                                     02120000
         ORG   TSTIMES                                                  02121000
@NM00067 DS    CL1                                                      02122000
TSBEG    DS    CL7                                                      02123000
         ORG   TSBEG                                                    02124000
TSSYR    DS    FL1                                                      02125000
TSSDAY   DS    FL2                                                      02126000
TSSTIME  DS    FL4                                                      02127000
         ORG   TSTIMES+8                                                02128000
@NM00068 DS    CL1                                                      02129000
TSEND    DS    CL7                                                      02130000
         ORG   TSEND                                                    02131000
TSEYR    DS    FL1                                                      02132000
TSEDAY   DS    FL2                                                      02133000
TSETIME  DS    FL4                                                      02134000
         ORG   TSTIMES+16                                               02135000
         DS    CL4                                                      02136000
DOUBLEWD DS    CL8                                                      02137000
TODAY    DS    CL5                                                      02138000
PARMHOLD DS    CL31                                                     02139000
SEQOLD   DS    CL14                                                     02140000
         ORG   SEQOLD                                                   02141000
SOL      DS    FL1                                                      02142000
SOV      DS    CL6                                                      02143000
SOT      DS    CL7                                                      02144000
         ORG   SEQOLD+14                                                02145000
SEQNEW   DS    CL14                                                     02146000
         ORG   SEQNEW                                                   02147000
SNL      DS    FL1                                                      02148000
SNV      DS    CL6                                                      02149000
SNT      DS    CL7                                                      02150000
         ORG   SEQNEW+14                                                02151000
DATEINSW DS    BL1                                                      02152000
FIXOUT   DS    CL13                                                     02153000
VOL      DS    CL6                                                      02154000
PARMERR  DS    BL1                                                      02155000
LIBSW    DS    BL1                                                      02156000
VOLSW    DS    BL1                                                      02157000
TMESW    DS    BL1                                                      02158000
FIRSTSW  DS    BL1                                                      02159000
EOFSW    DS    BL1                                                      02160000
VOLUME   DS    CL6                                                      02161000
SUMARRAY DS    CL36                                                     02162000
         ORG   SUMARRAY+0                                               02163000
SMSTGD   DS    FL4                                                      02164000
SMCFAULT DS    FL4                                                      02165000
SMDSTGD  DS    FL4                                                      02166000
SMSALLOC DS    FL4                                                      02167000
LOADS    DS    FL4                                                      02168000
STGDTOT  DS    FL4                                                      02169000
VTOCSG   DS    FL4                                                      02170000
DSTGDTOT DS    FL4                                                      02171000
VTOCDS   DS    FL4                                                      02172000
         ORG   SUMARRAY+144                                             02173000
ICGTRVID CSECT                                                          02174000
         DS    0F                                                       02175000
@SIZDATD DC    AL1(0)                                                   02176000
         DC    AL3(@ENDDATD-@DATD)                                      02177000
         DS    0D                                                       02178000
@CC00701 DC    C'               '                                       02179000
@CC00673 EQU   @CC00701                                                 02180000
@CC00726 DC    C'  :  :  '                                              02181000
@CC00659 EQU   @CC00701                                                 02182000
@CC00672 DC    C'TOTALS'                                                02183000
@CC00725 DC    C'  /   '                                                02184000
@CC00681 EQU   @CC00701                                                 02185000
@CC00646 DC    C'000'                                                   02186000
@CC00676 DC    C'S'                                                     02187000
@CC00680 DC    C'E'                                                     02188000
@CC00686 DC    C'N'                                                     02189000
HDNG1    DS    CL121                                                    02190000
         ORG   HDNG1                                                    02191000
@NM00046 DC    CL43'1ICGTRVID'                                          02192000
@NM00047 DC    CL58'MSS TRACE VOLUME ACTIVITY'                          02193000
@NM00048 DC    CL20'DATE YYDDD  PAGEXXXX'                               02194000
         ORG   HDNG1+121                                                02195000
HDNG2    DS    CL121                                                    02196000
         ORG   HDNG2                                                    02197000
@NM00049 DC    CL1'0'                                                   02198000
@NM00050 DC    CL40'                                        '           02199000
@NM00051 DC    CL40'       CYLINDER            SPACE   TOTAL'           02200000
@NM00052 DC    CL40'                                        '           02201000
         ORG   HDNG2+121                                                02202000
HDNG3    DS    CL121                                                    02203000
         ORG   HDNG3                                                    02204000
@NM00053 DC    CL1' '                                                   02205000
@NM00054 DC    CL40'                         CARTRIDGE   CYL'           02206000
@NM00055 DC    CL40'INDERS FAULT    CYLINDERS  ALLOC   STAGI'           02207000
@NM00056 DC    CL40'NG   CARTG       VTOC        VTOC       '           02208000
         ORG   HDNG3+121                                                02209000
HDNG4    DS    CL121                                                    02210000
         ORG   HDNG4                                                    02211000
@NM00057 DC    CL1' '                                                   02212000
@NM00058 DC    CL40' DATE    TIME  MSF VOLID  NUMBER     STA'           02213000
@NM00059 DC    CL40'GED    CAUSED   DESTAGED   CAUSED  ACTIV'           02214000
@NM00060 DC    CL40'ITY  LOADS STGS  STGS  DSTGS DSTGS      '           02215000
         ORG   HDNG4+121                                                02216000
RCDTOTAL DS    CL121                                                    02217000
         ORG   RCDTOTAL                                                 02218000
@NM00061 DC    CL1'1'                                                   02219000
@NM00062 DC    CL40'T-SLICE - XXX  DATES - YYDDD-YYDDD  TIME'           02220000
@NM00063 DC    CL40'S - HHMM-HHMM  VOLUME - VVVVVV  INPUT RE'           02221000
@NM00064 DC    CL40'CORDS SELECTED - XXXXXX                 '           02222000
         ORG   RCDTOTAL+121                                             02223000
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'                       02224000
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'                    02225000
SEQMSG   DC    CL43'1ICG903I INPUT FILE TRACEIN OUT OF SEQUENCE'        02226000
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '                     02227000
         DS    CL2                                                      02228000
FIXAREA  DS    CL200                                                    02229000
         ORG   FIXAREA                                                  02230000
@NM00069 DC    200CL1'Z'                                                02231000
         ORG   FIXAREA+200                                              02232000
ICGTRVID CSECT                                                          02233000
*                                                         /*@Y30LB40*/  02234000
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=72,    **02235000
               EODAD=EOF,EROPT=SKP,SYNAD=READERR                        02236000
IDCBL    EQU   *-IPATDCB                                                02237000
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121    02238000
PDCBL    EQU   *-PPATDCB                                                02239000
@DATD    DSECT                                                          02240000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02241000
@ENDDATD EQU   *                                                        02242000
ICGTRVID CSECT                                                          02243000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02244000
@01      EQU   01                                                       02245000
@02      EQU   02                                                       02246000
@03      EQU   03                                                       02247000
@04      EQU   04                                                       02248000
@05      EQU   05                                                       02249000
@06      EQU   06                                                       02250000
@07      EQU   07                                                       02251000
@08      EQU   08                                                       02252000
@09      EQU   09                                                       02253000
@10      EQU   10                                                       02254000
@11      EQU   11                                                       02255000
@12      EQU   12                                                       02256000
@13      EQU   13                                                       02257000
@14      EQU   14                                                       02258000
@15      EQU   15                                                       02259000
J        EQU   @06                                                      02260000
I        EQU   @07                                                      02261000
SS       EQU   @02                                                      02262000
RETURNCD EQU   @09                                                      02263000
TIMEWORK EQU   @03                                                      02264000
SAVE14   EQU   @06                                                      02265000
LINECNT  EQU   @08                                                      02266000
R0       EQU   @00                                                      02267000
R1       EQU   @01                                                      02268000
R2       EQU   @02                                                      02269000
R3       EQU   @03                                                      02270000
R14      EQU   @14                                                      02271000
R15      EQU   @15                                                      02272000
IHADCB   EQU   0                                                        02273000
IHADCS05 EQU   0                                                        02274000
DCBMODE  EQU   IHADCS05                                                 02275000
DCBSTACK EQU   DCBMODE                                                  02276000
DCBFUNC  EQU   IHADCS05+3                                               02277000
IHADCS11 EQU   0                                                        02278000
DCBRELB  EQU   IHADCS11                                                 02279000
DCBREL   EQU   DCBRELB+1                                                02280000
DCBBUFCB EQU   IHADCS11+4                                               02281000
DCBDSORG EQU   IHADCS11+10                                              02282000
DCBDSRG1 EQU   DCBDSORG                                                 02283000
DCBDSRG2 EQU   DCBDSORG+1                                               02284000
DCBIOBAD EQU   IHADCS11+12                                              02285000
DCBODEB  EQU   DCBIOBAD                                                 02286000
DCBLNP   EQU   DCBODEB                                                  02287000
DCBQSLM  EQU   DCBLNP                                                   02288000
DCBIOBAA EQU   DCBODEB+1                                                02289000
IHADCS50 EQU   0                                                        02290000
DCBSVCXL EQU   IHADCS50                                                 02291000
DCBEODAD EQU   IHADCS50+4                                               02292000
DCBBFALN EQU   DCBEODAD                                                 02293000
DCBHIARC EQU   DCBBFALN                                                 02294000
DCBBFTEK EQU   DCBHIARC                                                 02295000
DCBBFT   EQU   DCBBFTEK                                                 02296000
DCBEXLST EQU   IHADCS50+8                                               02297000
DCBRECFM EQU   DCBEXLST                                                 02298000
DCBRECLA EQU   DCBRECFM                                                 02299000
IHADCS24 EQU   0                                                        02300000
DCBOFLGS EQU   IHADCS24+8                                               02301000
DCBOFLWR EQU   DCBOFLGS                                                 02302000
DCBIFLG  EQU   IHADCS24+9                                               02303000
DCBMACR  EQU   IHADCS24+10                                              02304000
DCBMACR1 EQU   DCBMACR                                                  02305000
DCBMRFE  EQU   DCBMACR1                                                 02306000
DCBMRGET EQU   DCBMRFE                                                  02307000
DCBMRAPG EQU   DCBMACR1                                                 02308000
DCBMRRD  EQU   DCBMRAPG                                                 02309000
DCBMRCI  EQU   DCBMACR1                                                 02310000
DCBMRMVG EQU   DCBMRCI                                                  02311000
DCBMRLCG EQU   DCBMACR1                                                 02312000
DCBMRABC EQU   DCBMACR1                                                 02313000
DCBMRPT1 EQU   DCBMRABC                                                 02314000
DCBMRSBG EQU   DCBMRPT1                                                 02315000
DCBMRCRL EQU   DCBMACR1                                                 02316000
DCBMRCHK EQU   DCBMRCRL                                                 02317000
DCBMRRDX EQU   DCBMRCHK                                                 02318000
DCBMRDMG EQU   DCBMACR1                                                 02319000
DCBMACR2 EQU   DCBMACR+1                                                02320000
DCBMRPUT EQU   DCBMACR2                                                 02321000
DCBMRWRT EQU   DCBMACR2                                                 02322000
DCBMRMVP EQU   DCBMACR2                                                 02323000
DCBMR5WD EQU   DCBMACR2                                                 02324000
DCBMRLDM EQU   DCBMR5WD                                                 02325000
DCBMRLCP EQU   DCBMRLDM                                                 02326000
DCBMR4WD EQU   DCBMACR2                                                 02327000
DCBMRPT2 EQU   DCBMR4WD                                                 02328000
DCBMRTMD EQU   DCBMRPT2                                                 02329000
DCBMR3WD EQU   DCBMACR2                                                 02330000
DCBMRCTL EQU   DCBMR3WD                                                 02331000
DCBMRSTK EQU   DCBMRCTL                                                 02332000
DCBMR1WD EQU   DCBMACR2                                                 02333000
DCBMRSWA EQU   DCBMR1WD                                                 02334000
DCBMRDMD EQU   DCBMRSWA                                                 02335000
IHADCS25 EQU   0                                                        02336000
DCBMACRF EQU   IHADCS25+2                                               02337000
DCBMACF1 EQU   DCBMACRF                                                 02338000
DCBMFFE  EQU   DCBMACF1                                                 02339000
DCBMFGET EQU   DCBMFFE                                                  02340000
DCBMFAPG EQU   DCBMACF1                                                 02341000
DCBMFRD  EQU   DCBMFAPG                                                 02342000
DCBMFCI  EQU   DCBMACF1                                                 02343000
DCBMFMVG EQU   DCBMFCI                                                  02344000
DCBMFLCG EQU   DCBMACF1                                                 02345000
DCBMFABC EQU   DCBMACF1                                                 02346000
DCBMFPT1 EQU   DCBMFABC                                                 02347000
DCBMFSBG EQU   DCBMFPT1                                                 02348000
DCBMFCRL EQU   DCBMACF1                                                 02349000
DCBMFCHK EQU   DCBMFCRL                                                 02350000
DCBMFDMG EQU   DCBMACF1                                                 02351000
DCBMACF2 EQU   DCBMACRF+1                                               02352000
DCBMFPUT EQU   DCBMACF2                                                 02353000
DCBMFWRT EQU   DCBMACF2                                                 02354000
DCBMFMVP EQU   DCBMACF2                                                 02355000
DCBMF5WD EQU   DCBMACF2                                                 02356000
DCBMFLDM EQU   DCBMF5WD                                                 02357000
DCBMFLCP EQU   DCBMFLDM                                                 02358000
DCBMF4WD EQU   DCBMACF2                                                 02359000
DCBMFPT2 EQU   DCBMF4WD                                                 02360000
DCBMFTMD EQU   DCBMFPT2                                                 02361000
DCBMF3WD EQU   DCBMACF2                                                 02362000
DCBMFCTL EQU   DCBMF3WD                                                 02363000
DCBMFSTK EQU   DCBMFCTL                                                 02364000
DCBMF1WD EQU   DCBMACF2                                                 02365000
DCBMFSWA EQU   DCBMF1WD                                                 02366000
DCBMFDMD EQU   DCBMFSWA                                                 02367000
DCBDEBAD EQU   IHADCS25+4                                               02368000
DCBIFLGS EQU   DCBDEBAD                                                 02369000
IHADCS26 EQU   0                                                        02370000
DCBWRITE EQU   IHADCS26                                                 02371000
DCBREAD  EQU   DCBWRITE                                                 02372000
DCBWRITA EQU   DCBREAD+1                                                02373000
IHADCS27 EQU   0                                                        02374000
DCBGET   EQU   IHADCS27                                                 02375000
DCBPUT   EQU   DCBGET                                                   02376000
DCBGETA  EQU   DCBPUT+1                                                 02377000
IHADCS36 EQU   0                                                        02378000
DCBGERR  EQU   IHADCS36                                                 02379000
DCBPERR  EQU   DCBGERR                                                  02380000
DCBCHECK EQU   DCBPERR                                                  02381000
DCBOPTCD EQU   DCBCHECK                                                 02382000
DCBOPTH  EQU   DCBOPTCD                                                 02383000
DCBOPTO  EQU   DCBOPTH                                                  02384000
DCBOPTZ  EQU   DCBOPTCD                                                 02385000
DCBGERRA EQU   DCBCHECK+1                                               02386000
DCBPERRA EQU   DCBGERRA                                                 02387000
DCBSYNAD EQU   IHADCS36+4                                               02388000
DCBCIND1 EQU   IHADCS36+8                                               02389000
DCBCIND2 EQU   IHADCS36+9                                               02390000
DCBIOBA  EQU   IHADCS36+16                                              02391000
DCBCICB  EQU   DCBIOBA                                                  02392000
IHADCS52 EQU   0                                                        02393000
DCBDIRCT EQU   IHADCS52                                                 02394000
DCBQSWS  EQU   DCBDIRCT                                                 02395000
DCBUSASI EQU   DCBQSWS                                                  02396000
DCBQADFS EQU   DCBUSASI                                                 02397000
DCBBUFOF EQU   DCBDIRCT+1                                               02398000
IHADCS37 EQU   0                                                        02399000
DCBFLAG1 EQU   IHADCS37                                                 02400000
IHADCS38 EQU   0                                                        02401000
DCBEOBR  EQU   IHADCS38                                                 02402000
DCBPOINT EQU   IHADCS38+12                                              02403000
DCBCNTRL EQU   DCBPOINT                                                 02404000
IHADCS40 EQU   0                                                        02405000
DCBEOBAD EQU   IHADCS40                                                 02406000
DCBCCCW  EQU   IHADCS40+4                                               02407000
DCBRECAD EQU   DCBCCCW                                                  02408000
DCBRECBT EQU   DCBRECAD                                                 02409000
DCBRCREL EQU   DCBRECBT                                                 02410000
@NM00026 EQU   IHADCS40+12                                              02411000
DCBEROPT EQU   @NM00026                                                 02412000
PARMVALS EQU   0                                                        02413000
PARMLEN  EQU   PARMVALS                                                 02414000
PARMS    EQU   PARMVALS+2                                               02415000
FIXADDR  EQU   0                                                        02416000
FIXLEN   EQU   0                                                        02417000
FIXOPT   EQU   0                                                        02418000
*                                      START UNREFERENCED COMPONENTS    02419000
DCBEOB   EQU   IHADCS40+20                                              02420000
DCBPRECL EQU   IHADCS40+18                                              02421000
@NM00029 EQU   IHADCS40+16                                              02422000
@NM00028 EQU   @NM00026+1                                               02423000
@NM00027 EQU   DCBEROPT                                                 02424000
DCBERABE EQU   DCBEROPT                                                 02425000
DCBERSKP EQU   DCBEROPT                                                 02426000
DCBERACC EQU   DCBEROPT                                                 02427000
@NM00025 EQU   IHADCS40+10                                              02428000
@NM00024 EQU   IHADCS40+9                                               02429000
@NM00023 EQU   IHADCS40+8                                               02430000
DCBRECA  EQU   DCBRECAD+1                                               02431000
@NM00022 EQU   DCBRECBT                                                 02432000
DCBRCFGT EQU   DCBRCREL                                                 02433000
DCBRCTRU EQU   DCBRCREL                                                 02434000
DCBLCCW  EQU   DCBEOBAD                                                 02435000
DCBNOTE  EQU   DCBCNTRL                                                 02436000
DCBLRECL EQU   IHADCS38+10                                              02437000
@NM00021 EQU   IHADCS38+8                                               02438000
DCBEOBW  EQU   IHADCS38+4                                               02439000
DCBEOBRA EQU   DCBEOBR+1                                                02440000
DCBNCP   EQU   DCBEOBR                                                  02441000
@NM00020 EQU   DCBFLAG1                                                 02442000
DCBSTFLS EQU   DCBFLAG1                                                 02443000
DCBSTQCK EQU   DCBFLAG1                                                 02444000
DCBDIRCQ EQU   DCBBUFOF                                                 02445000
DCBQSTRU EQU   DCBUSASI                                                 02446000
@NM00019 EQU   DCBUSASI                                                 02447000
DCBQADF3 EQU   DCBQADFS                                                 02448000
DCBQADF2 EQU   DCBQADFS                                                 02449000
DCBQADF1 EQU   DCBQADFS                                                 02450000
DCBBLBP  EQU   DCBUSASI                                                 02451000
@NM00018 EQU   DCBUSASI                                                 02452000
DCBCICBA EQU   DCBCICB+1                                                02453000
@NM00017 EQU   DCBCICB                                                  02454000
DCBOFFSW EQU   IHADCS36+15                                              02455000
DCBOFFSR EQU   IHADCS36+14                                              02456000
DCBWCPL  EQU   IHADCS36+13                                              02457000
DCBWCPO  EQU   IHADCS36+12                                              02458000
DCBBLKSI EQU   IHADCS36+10                                              02459000
DCBCNQSM EQU   DCBCIND2                                                 02460000
DCBCNFEO EQU   DCBCIND2                                                 02461000
DCBCNCHS EQU   DCBCIND2                                                 02462000
DCBCNBFP EQU   DCBCIND2                                                 02463000
DCBCNIOE EQU   DCBCIND2                                                 02464000
DCBCNCLO EQU   DCBCIND2                                                 02465000
DCBCNWRO EQU   DCBCIND2                                                 02466000
DCBCNSTO EQU   DCBCIND2                                                 02467000
DCBCNEXB EQU   DCBCIND1                                                 02468000
@NM00016 EQU   DCBCIND1                                                 02469000
DCBCNBRM EQU   DCBCIND1                                                 02470000
@NM00015 EQU   DCBCIND1                                                 02471000
DCBCNEVA EQU   DCBCIND1                                                 02472000
DCBCNEVB EQU   DCBCIND1                                                 02473000
DCBCNSRD EQU   DCBCIND1                                                 02474000
DCBCNTOV EQU   DCBCIND1                                                 02475000
DCBSYNA  EQU   DCBSYNAD+1                                               02476000
DCBIOBL  EQU   DCBSYNAD                                                 02477000
DCBCHCKA EQU   DCBPERRA                                                 02478000
@NM00014 EQU   DCBOPTCD                                                 02479000
DCBOPTT  EQU   DCBOPTCD                                                 02480000
DCBSRCHD EQU   DCBOPTZ                                                  02481000
DCBOPTQ  EQU   DCBOPTCD                                                 02482000
DCBBCKPT EQU   DCBOPTO                                                  02483000
DCBOPTC  EQU   DCBOPTCD                                                 02484000
DCBOPTU  EQU   DCBOPTCD                                                 02485000
DCBOPTW  EQU   DCBOPTCD                                                 02486000
DCBPUTA  EQU   DCBGETA                                                  02487000
@NM00013 EQU   DCBPUT                                                   02488000
DCBREADA EQU   DCBWRITA                                                 02489000
@NM00012 EQU   DCBREAD                                                  02490000
DCBDEBA  EQU   DCBDEBAD+1                                               02491000
@NM00011 EQU   DCBIFLGS                                                 02492000
DCBIFIOE EQU   DCBIFLGS                                                 02493000
DCBIFPCT EQU   DCBIFLGS                                                 02494000
DCBIFEC  EQU   DCBIFLGS                                                 02495000
DCBMFSTI EQU   DCBMFDMD                                                 02496000
DCBMFAWR EQU   DCBMFSTK                                                 02497000
DCBMFUIP EQU   DCBMFTMD                                                 02498000
DCBMFIDW EQU   DCBMFLCP                                                 02499000
DCBMFWRK EQU   DCBMFMVP                                                 02500000
DCBMFRDQ EQU   DCBMFWRT                                                 02501000
DCBMFGTQ EQU   DCBMFPUT                                                 02502000
DCBMFSTL EQU   DCBMACF2                                                 02503000
DCBMFCK  EQU   DCBMFDMG                                                 02504000
DCBMFRDX EQU   DCBMFCHK                                                 02505000
DCBMFDBF EQU   DCBMFSBG                                                 02506000
DCBMFRDI EQU   DCBMFLCG                                                 02507000
DCBMFRDK EQU   DCBMFMVG                                                 02508000
DCBMFWRQ EQU   DCBMFRD                                                  02509000
DCBMFPTQ EQU   DCBMFGET                                                 02510000
DCBMFECP EQU   DCBMACF1                                                 02511000
DCBTIOT  EQU   IHADCS25                                                 02512000
DCBMRSTI EQU   DCBMRDMD                                                 02513000
DCBMRAWR EQU   DCBMRSTK                                                 02514000
DCBMRUIP EQU   DCBMRTMD                                                 02515000
DCBMRIDW EQU   DCBMRLCP                                                 02516000
DCBMRWRK EQU   DCBMRMVP                                                 02517000
DCBMRRDQ EQU   DCBMRWRT                                                 02518000
DCBMRGTQ EQU   DCBMRPUT                                                 02519000
DCBMRSTL EQU   DCBMACR2                                                 02520000
DCBMRCK  EQU   DCBMRDMG                                                 02521000
DCBPGFXA EQU   DCBMRRDX                                                 02522000
DCBMRDBF EQU   DCBMRSBG                                                 02523000
DCBMRRDI EQU   DCBMRLCG                                                 02524000
DCBMRRDK EQU   DCBMRMVG                                                 02525000
DCBMRWRQ EQU   DCBMRRD                                                  02526000
DCBMRPTQ EQU   DCBMRGET                                                 02527000
DCBMRECP EQU   DCBMACR1                                                 02528000
@NM00010 EQU   DCBIFLG                                                  02529000
DCBIBIOE EQU   DCBIFLG                                                  02530000
DCBIBPCT EQU   DCBIFLG                                                  02531000
DCBIBEC  EQU   DCBIFLG                                                  02532000
DCBOFIOF EQU   DCBOFLGS                                                 02533000
DCBOFUEX EQU   DCBOFLGS                                                 02534000
DCBOFTM  EQU   DCBOFLGS                                                 02535000
DCBOFPPC EQU   DCBOFLGS                                                 02536000
DCBOFOPN EQU   DCBOFLGS                                                 02537000
DCBOFEOV EQU   DCBOFLGS                                                 02538000
DCBOFLRB EQU   DCBOFLGS                                                 02539000
DCBOFIOD EQU   DCBOFLWR                                                 02540000
DCBDDNAM EQU   IHADCS24                                                 02541000
DCBEXLSA EQU   DCBEXLST+1                                               02542000
DCBRECKL EQU   DCBRECFM                                                 02543000
DCBRECCC EQU   DCBRECFM                                                 02544000
DCBRECSB EQU   DCBRECFM                                                 02545000
DCBRECBR EQU   DCBRECFM                                                 02546000
DCBRECTO EQU   DCBRECLA                                                 02547000
DCBRECL  EQU   DCBRECLA                                                 02548000
DCBEODA  EQU   DCBEODAD+1                                               02549000
DCBBFA   EQU   DCBBFTEK                                                 02550000
DCBH0    EQU   DCBBFTEK                                                 02551000
DCBBFTKD EQU   DCBBFTEK                                                 02552000
DCBBFTE  EQU   DCBBFT                                                   02553000
DCBBFTKR EQU   DCBBFT                                                   02554000
DCBBFTS  EQU   DCBBFT                                                   02555000
DCBH1    EQU   DCBBFTEK                                                 02556000
DCBSVCXA EQU   DCBSVCXL+1                                               02557000
@NM00009 EQU   DCBSVCXL                                                 02558000
DCBODEBA EQU   DCBIOBAA                                                 02559000
@NM00008 EQU   DCBQSLM                                                  02560000
DCBUPDBT EQU   DCBQSLM                                                  02561000
DCBUPDCM EQU   DCBQSLM                                                  02562000
DCB1DVDS EQU   DCBQSLM                                                  02563000
@NM00007 EQU   DCBDSRG2                                                 02564000
DCBDSGTR EQU   DCBDSRG2                                                 02565000
DCBACBM  EQU   DCBDSRG2                                                 02566000
@NM00006 EQU   DCBDSRG2                                                 02567000
DCBDSGTQ EQU   DCBDSRG2                                                 02568000
DCBDSGTX EQU   DCBDSRG2                                                 02569000
DCBDSGGS EQU   DCBDSRG2                                                 02570000
DCBDSGU  EQU   DCBDSRG1                                                 02571000
DCBDSGPO EQU   DCBDSRG1                                                 02572000
DCBDSGMQ EQU   DCBDSRG1                                                 02573000
DCBDSGCQ EQU   DCBDSRG1                                                 02574000
DCBDSGCX EQU   DCBDSRG1                                                 02575000
DCBDSGDA EQU   DCBDSRG1                                                 02576000
DCBDSGPS EQU   DCBDSRG1                                                 02577000
DCBDSGIS EQU   DCBDSRG1                                                 02578000
DCBBUFL  EQU   IHADCS11+8                                               02579000
DCBBUFCA EQU   DCBBUFCB+1                                               02580000
DCBBUFNO EQU   DCBBUFCB                                                 02581000
DCBDEVT  EQU   DCBREL                                                   02582000
DCBKEYLE EQU   DCBRELB                                                  02583000
@NM00005 EQU   DCBFUNC                                                  02584000
DCBFNCBT EQU   DCBFUNC                                                  02585000
DCBFNCBX EQU   DCBFUNC                                                  02586000
DCBFNCBD EQU   DCBFUNC                                                  02587000
DCBFNCBW EQU   DCBFUNC                                                  02588000
DCBFNCBP EQU   DCBFUNC                                                  02589000
DCBFNCBR EQU   DCBFUNC                                                  02590000
DCBFNCBI EQU   DCBFUNC                                                  02591000
@NM00004 EQU   IHADCS05+2                                               02592000
@NM00003 EQU   IHADCS05+1                                               02593000
DCBSTCK1 EQU   DCBSTACK                                                 02594000
DCBSTCK2 EQU   DCBSTACK                                                 02595000
@NM00002 EQU   DCBSTACK                                                 02596000
DCBMODER EQU   DCBSTACK                                                 02597000
DCBMODEO EQU   DCBSTACK                                                 02598000
DCBMODEE EQU   DCBSTACK                                                 02599000
DCBMODEC EQU   DCBSTACK                                                 02600000
@NM00001 EQU   IHADCB                                                   02601000
*                                      END UNREFERENCED COMPONENTS      02602000
@RT00139 EQU   PARMEND                                                  02603000
@RT00158 EQU   PARMEND                                                  02604000
@RT00178 EQU   PARMEND                                                  02605000
@RF00193 EQU   @RC00191                                                 02606000
@RF00203 EQU   @RC00201                                                 02607000
@RT00217 EQU   PARMEND                                                  02608000
@RT00230 EQU   PARMEND                                                  02609000
@RT00259 EQU   PARMEND                                                  02610000
@RT00271 EQU   PARMEND                                                  02611000
@RT00292 EQU   RDTRACE                                                  02612000
@RT00294 EQU   RDTRACE                                                  02613000
@RT00297 EQU   RDTRACE                                                  02614000
@RT00436 EQU   EOJ                                                      02615000
@RF00483 EQU   CHECKTIM                                                 02616000
@RT00578 EQU   EF4                                                      02617000
EFEND    EQU   @EL00003                                                 02618000
@RT00576 EQU   EFEND                                                    02619000
@ENDDATA EQU   *                                                        02620000
         END   ICGTRVID,(C'PLS2119',0603,76198)                         02621000
